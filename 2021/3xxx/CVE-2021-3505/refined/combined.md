=== Content from github.com_973a88cf_20250115_125209.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fblob%2Fstable-0.7.0%2FCHANGES)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fblob%2Fstable-0.7.0%2FCHANGES)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=stefanberger%2Flibtpms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stefanberger](/stefanberger)
/
**[libtpms](/stefanberger/libtpms)**
Public

* [Notifications](/login?return_to=%2Fstefanberger%2Flibtpms) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2Fstefanberger%2Flibtpms)
* [Star
   228](/login?return_to=%2Fstefanberger%2Flibtpms)

* [Code](/stefanberger/libtpms/tree/stable-0.7.0)
* [Issues
  3](/stefanberger/libtpms/issues)
* [Pull requests
  4](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects
  0](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

Additional navigation options

* [Code](/stefanberger/libtpms/tree/stable-0.7.0)
* [Issues](/stefanberger/libtpms/issues)
* [Pull requests](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

## Files

 stable-0.7.0
## Breadcrumbs

1. [libtpms](/stefanberger/libtpms/tree/stable-0.7.0)
/
# CHANGES

Copy path Blame  Blame
## Latest commit

## History

[History](/stefanberger/libtpms/commits/stable-0.7.0/CHANGES)98 lines (81 loc) · 3.6 KB stable-0.7.0
## Breadcrumbs

1. [libtpms](/stefanberger/libtpms/tree/stable-0.7.0)
/
# CHANGES

Top
## File metadata and controls

* Code
* Blame

98 lines (81 loc) · 3.6 KB[Raw](https://github.com/stefanberger/libtpms/raw/refs/heads/stable-0.7.0/CHANGES)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798CHANGES - changes for libtpms
version 0.7.11: - tpm2: Do not set RSA\_FLAG\_NO\_BLINDING on RSA keys anymore - tpm2: Fix a potential overflow expression (coverity) - tpm2: Fix size check in CryptSecretDecrypt - tpm2: Check return code of BN\_div() - tpm2: Do not write permanent state if only clock changed
version 0.7.10: - tpm2: Marshal event sequence objects' hash state - tpm2: Fixes for building and running with OpenSSL 3.0
version 0.7.9 - tpm2: NVMarshal: Handle index orderly RAM without 0-sized terminating node - tpm2: Initialize a whole OBJECT before using it
version 0.7.8 - tpm2: Reset too large size indicators in TPM2B to avoid access beyond buffer - tpm2: Restore original value in buffer if unmarshalled one was illegal
version 0.7.7 - CryptSym: fix AES output IV A CVE has been filed for this bugfix. Unfortunately multi-step encrypted data won't decrypt anymore but are now compatible with other TPM 2 devices.
version 0.7.6 - tpm2: Fix public key context save due to ANY\_OBJECT\_Marshal usage This fixes a suspend/resume problem when public keys are loaded - tpm2: Address some Coverity issues (false positives) - tpm1.2: Backported ASAN/UBSAN related fixes
version 0.7.5 - Note: The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TPM 2 key creation algo that cannot easily be fixed. The bug is in RsaAjustPrimeCandidate, which is called before the prime number check. - tpm2: Return properly sized array for b parameter for NIST P521 (HLK) - tpm2: Addressed issues detected by UBSAN - tpm2: Addressed issues detected by cppcheck (false positives)
version 0.7.4 - Addressed potential constant-time related issues in TPM 1.2 and TPM 2 code TPM 1.2: RSA decryption TPM 2: EcSchnorr and EcSM2 signatures; Ecsda is handled by OpenSSL - Fixed some compilation issues
version 0.7.3 - Fixed the set of PCRs belonging to the TCB group. This affects the pcrUpdateCounter in TPM2\_Pcrread() responses, thus needs latest `swtpm` (master, stable branches) for test cases to succeed there.
version 0.7.2 - Fix output buffer parameter and size for RSA decryption that could cause stack corruption under certain circumstances - Set the RSA PSS salt length to the digest length rathern than max. possible - Fixes to symmetric decrytion related to input size check, defer padding to the user [EVP\_CIPHER\_CTX\_set\_padding(ctx, 0)] and to always use a temporary malloc'ed buffer for decryption
version 0.7.1 - tpm2: Fix TDES key creation by adding missing un-/marshalling functions - tpm2: Fix a bug in CheckAuthSession - compilation fixes for TPM 1.2 & TPM 2 and various architectures and gcc versions - Fix support for NIST curves P{192,224,521} and SM2 P256 and BN P648 that would not work; - Runtime filter elliptic curves (that OpenSSL does not support) and do not advertise those curves as capabilities - Removed unnecessary space in MANUFACTURER "IBM " -> "IBM"
version 0.7.0 - use OpenSSL crypto for AES, TDES, EC, and RSA operations when possible
version 0.6.0 - added TPM 2 support (revision 150)
 - New API calls: - TPMLIB\_CancelCommand - TPMLIB\_ChooseTPMVersion - TPMLIB\_SetDebugFD - TPMLIB\_SetDebugLevel - TPMLIB\_SetDebugPrefix - TPMLIB\_SetBufferSize - TPMLIB\_ValidateState - TPMLIB\_SetState - TPMLIB\_GetState
version 0.5.1 first public release
 - release 7 increased NVRAM area for being able to store more data in the TPM's NVRAM areas, i.e., X.509 certificates
 - release 9 added two more APIs: - TPM\_Free - TPMLIB\_DecodeBlob

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fa469041_20250115_125212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2Fc1f7bf55099fcd427715aa65e130475c6e836a6b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2Fc1f7bf55099fcd427715aa65e130475c6e836a6b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=stefanberger%2Flibtpms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stefanberger](/stefanberger)
/
**[libtpms](/stefanberger/libtpms)**
Public

* [Notifications](/login?return_to=%2Fstefanberger%2Flibtpms) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2Fstefanberger%2Flibtpms)
* [Star
   228](/login?return_to=%2Fstefanberger%2Flibtpms)

* [Code](/stefanberger/libtpms)
* [Issues
  3](/stefanberger/libtpms/issues)
* [Pull requests
  4](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects
  0](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

Additional navigation options

* [Code](/stefanberger/libtpms)
* [Issues](/stefanberger/libtpms/issues)
* [Pull requests](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

## Commit

[Permalink](/stefanberger/libtpms/commit/c1f7bf55099fcd427715aa65e130475c6e836a6b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

tpm2: Activate SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX

[Browse files](/stefanberger/libtpms/tree/c1f7bf55099fcd427715aa65e130475c6e836a6b)
Browse the repository at this point in the history

```
Signed-off-by: Stefan Berger <stefanb@linux.ibm.com>
```

* Loading branch information

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=40&v=4)](/stefanberger)

[stefanberger](/stefanberger/libtpms/commits?author=stefanberger "View all commits by stefanberger")
committed
Apr 14, 2020

1 parent
[5b8200d](/stefanberger/libtpms/commit/5b8200d7f51468b6957c2a69281bfdd276c8cd20)

commit c1f7bf5

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**5 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/tpm2

  + src/tpm2/BackwardsCompatibility.h
    [BackwardsCompatibility.h](#diff-e8ef9384dad322799de70be0914cf627094c33d5216020375c9c9773296baf0c)
  + crypto/openssl

    - src/tpm2/crypto/openssl/CryptPrime.c
      [CryptPrime.c](#diff-b6baa967ff23646be73b04231aa04f1010e37b244d3c3b4054098255df1c756a)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/tpm2/BackwardsCompatibility.h](#diff-e8ef9384dad322799de70be0914cf627094c33d5216020375c9c9773296baf0c "src/tpm2/BackwardsCompatibility.h")

Show comments

[View file](/stefanberger/libtpms/blob/c1f7bf55099fcd427715aa65e130475c6e836a6b/src/tpm2/BackwardsCompatibility.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,7 +43,7 @@ typedef UINT8 SEED\_COMPAT\_LEVEL; |
|  |  | enum { |
|  |  | SEED\_COMPAT\_LEVEL\_ORIGINAL = 0, /\* original TPM 2 code up to rev155 \*/ |
|  |  | SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX = 1, /\* RsaAdjustPrimeCandidate was fixed \*/ |
|  |  | SEED\_COMPAT\_LEVEL\_LAST = SEED\_COMPAT\_LEVEL\_ORIGINAL |
|  |  | SEED\_COMPAT\_LEVEL\_LAST = SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX |
|  |  | }; |
|  |  |  |
|  |  | #endif /\* BACKWARDS\_COMPATIBILITY\_H \*/ |

8 changes: 4 additions & 4 deletions

8
[src/tpm2/crypto/openssl/CryptPrime.c](#diff-b6baa967ff23646be73b04231aa04f1010e37b244d3c3b4054098255df1c756a "src/tpm2/crypto/openssl/CryptPrime.c")

Show comments

[View file](/stefanberger/libtpms/blob/c1f7bf55099fcd427715aa65e130475c6e836a6b/src/tpm2/crypto/openssl/CryptPrime.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -372,8 +372,8 @@ RsaAdjustPrimeCandidate( |
|  |  | case SEED\_COMPAT\_LEVEL\_ORIGINAL: |
|  |  | RsaAdjustPrimeCandidate\_PreRev155(prime); |
|  |  | break; |
|  |  | /\* case SEED\_COMPAT\_LEVEL\_LAST: \*/ |
|  |  | case SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX: |
|  |  | case SEED\_COMPAT\_LEVEL\_LAST: |
|  |  | /\* case SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX: \*/ |
|  |  | RsaAdjustPrimeCandidate\_New(prime); |
|  |  | break; |
|  |  | default: |
| Expand Down  Expand Up | | @@ -414,8 +414,8 @@ BnGeneratePrimeForRSA( |
|  |  | if (g\_inFailureMode) |
|  |  | return TPM\_RC\_FAILURE; |
|  |  | break; |
|  |  | /\* case SEED\_COMPAT\_LEVEL\_LAST: \*/ |
|  |  | case SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX: |
|  |  | case SEED\_COMPAT\_LEVEL\_LAST: |
|  |  | /\* case SEED\_COMPAT\_LEVEL\_RSA\_PRIME\_ADJUST\_FIX: \*/ |
|  |  | if(!BnGetRandomBits(prime, bits, rand)) // new |
|  |  | return TPM\_RC\_FAILURE; |
|  |  | break; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c1f7bf5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2Fc1f7bf55099fcd427715aa65e130475c6e836a6b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_54acdd69_20250114_224628.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ.mbox.gz?message=NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/#NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ)

# [SECURITY] Fedora 33 Update: libtpms-0.8.2-0.20210426git729fc6a4ca.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

4 May
2021

4 May
'21

8:54 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-cfdc434610
2021-05-05 00:52:51.707339
--------------------------------------------------------------------------------

Name : libtpms
Product : Fedora 33
Version : 0.8.2
Release : 0.20210426git729fc6a4ca.fc33
URL : <http://github.com/stefanberger/libtpms>
Summary : Library providing Trusted Platform Module (TPM) functionality
Description :
A library providing TPM functionality for VMs. Targeted for integration
into Qemu.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-3505
--------------------------------------------------------------------------------
ChangeLog:

\* Mon Apr 26 2021 Stefan Berger stefanb@linux.ibm.com - 0.8.2-0.20210426git729fc6a4ca
- tpm2: CryptSym: fix AES output IV; a CVE has been filed for this issue
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1950046 - CVE-2021-3505 libtpms: RSA keys weaker than expected
<https://bugzilla.redhat.com/show_bug.cgi?id=1950046>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-cfdc434610' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ/#NUCZX4S53TUNTSGTCRDNOQZV2V2RI4RJ)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from access.redhat.com_0f619b3d_20250115_201656.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_22a34b6c_20250115_125209.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F625171be0c8225824740b5d0fb7e8562f6a1c6a8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F625171be0c8225824740b5d0fb7e8562f6a1c6a8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=stefanberger%2Flibtpms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stefanberger](/stefanberger)
/
**[libtpms](/stefanberger/libtpms)**
Public

* [Notifications](/login?return_to=%2Fstefanberger%2Flibtpms) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2Fstefanberger%2Flibtpms)
* [Star
   228](/login?return_to=%2Fstefanberger%2Flibtpms)

* [Code](/stefanberger/libtpms)
* [Issues
  3](/stefanberger/libtpms/issues)
* [Pull requests
  4](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects
  0](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

Additional navigation options

* [Code](/stefanberger/libtpms)
* [Issues](/stefanberger/libtpms/issues)
* [Pull requests](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

## Commit

[Permalink](/stefanberger/libtpms/commit/625171be0c8225824740b5d0fb7e8562f6a1c6a8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

tpm2: rev155: Add new RsaAdjustPrimeCandidate code but do not use

[Browse files](/stefanberger/libtpms/tree/625171be0c8225824740b5d0fb7e8562f6a1c6a8)
Browse the repository at this point in the history

```
Add in the new RsaAdjustPrimeCandidate() function but do not use it
so far since it creates slightly different primes than the previous
code and we would get different derived keys if we were to use it with
'old' seeds.

Adjust the code to return the same results for 64 bit and 32 bit machines.

Signed-off-by: Stefan Berger <stefanb@linux.ibm.com>
```

* Loading branch information

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=40&v=4)](/stefanberger)

[stefanberger](/stefanberger/libtpms/commits?author=stefanberger "View all commits by stefanberger")
committed
Apr 14, 2020

1 parent
[c97d016](/stefanberger/libtpms/commit/c97d016d276683195b5ce16b35ce4b8ec852c07d)

commit 625171b

Showing
**1 changed file**
with
**89 additions**
and
**23 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

112 changes: 89 additions & 23 deletions

112
[src/tpm2/crypto/openssl/CryptPrime.c](#diff-b6baa967ff23646be73b04231aa04f1010e37b244d3c3b4054098255df1c756a "src/tpm2/crypto/openssl/CryptPrime.c")

Show comments

[View file](/stefanberger/libtpms/blob/625171be0c8225824740b5d0fb7e8562f6a1c6a8/src/tpm2/crypto/openssl/CryptPrime.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,7 @@ |
|  |  | /\* Code for prime validation. \*/ |
|  |  | /\* Written by Ken Goldman \*/ |
|  |  | /\* IBM Thomas J. Watson Research Center \*/ |
|  |  | /\* $Id: CryptPrime.c 1262 2018-07-11 21:03:43Z kgoldman $ \*/ |
|  |  | /\* $Id: CryptPrime.c 1476 2019-06-10 19:32:03Z kgoldman $ \*/ |
|  |  | /\* \*/ |
|  |  | /\* Licenses and Notices \*/ |
|  |  | /\* \*/ |
| Expand Down  Expand Up | | @@ -55,7 +55,7 @@ |
|  |  | /\* arising in any way out of use or reliance upon this specification or any \*/ |
|  |  | /\* information herein. \*/ |
|  |  | /\* \*/ |
|  |  | /\* (c) Copyright IBM Corp. and others, 2016 - 2018 \*/ |
|  |  | /\* (c) Copyright IBM Corp. and others, 2016 - 2019 \*/ |
|  |  | /\* \*/ |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  |  |
| Expand Down  Expand Up | | @@ -295,19 +295,14 @@ RsaCheckPrime( |
|  |  | return PrimeSelectWithSieve(prime, exponent, rand); |
|  |  | #endif |
|  |  | } |
|  |  | /\* 10.2.16.1.7 AdjustPrimeCandiate() \*/ |
|  |  | /\* This function adjusts the candidate prime so that it is odd and > root(2)/2. This allows the |
|  |  | product of these two numbers to be .5, which, in fixed point notation means that the most |
|  |  | significant bit is 1. For this routine, the root(2)/2 is approximated with 0xB505 which is, in |
|  |  | fixed point is 0.7071075439453125 or an error of 0.0001%. Just setting the upper two bits would |
|  |  | give a value > 0.75 which is an error of > 6%. Given the amount of time all the other |
|  |  | computations take, reducing the error is not much of a cost, but it isn't totally required |
|  |  | either. \*/ |
|  |  | /\* The function also puts the number on a field boundary. \*/ |
|  |  | LIB\_EXPORT void |
|  |  | RsaAdjustPrimeCandidate( |
|  |  | bigNum prime |
|  |  | ) |
|  |  | /\* |
|  |  | \* RsaAdjustPrimeCandidate\_PreRev155 is the pre-rev.155 algorithm used; we |
|  |  | \* still have to use it for old seeds to maintain backwards compatibility. |
|  |  | \*/ |
|  |  | static void |
|  |  | RsaAdjustPrimeCandidate\_PreRev155( |
|  |  | bigNum prime |
|  |  | ) |
|  |  | { |
|  |  | UINT16 highBytes; |
|  |  | crypt\_uword\_t \*msw = &prime->d[prime->size - 1]; |
| Expand All | | @@ -319,14 +314,74 @@ RsaAdjustPrimeCandidate( |
|  |  | \*msw = ((crypt\_uword\_t)(highBytes) << (RADIX\_BITS - 16)) + (\*msw & MASK); |
|  |  | prime->d[0] |= 1; |
|  |  | } |
|  |  | /\* 10.2.16.1.8 BnGeneratePrimeForRSA() \*/ |
|  |  |  |
|  |  | /\* 10.2.14.1.7 RsaAdjustPrimeCandidate() \*/ |
|  |  |  |
|  |  | /\* For this math, we assume that the RSA numbers are fixed-point numbers with the decimal point to |
|  |  | the left of the most significant bit. This approach helps make it clear what is happening with |
|  |  | the MSb of the values. The two RSA primes have to be large enough so that their product will be a |
|  |  | number with the necessary number of significant bits. For example, we want to be able to multiply |
|  |  | two 1024-bit numbers to produce a number with 2028 significant bits. If we accept any 1024-bit |
|  |  | prime that has its MSb set, then it is possible to produce a product that does not have the MSb |
|  |  | SET. For example, if we use tiny keys of 16 bits and have two 8-bit primes of 0x80, then the |
|  |  | public key would be 0x4000 which is only 15-bits. So, what we need to do is made sure that each |
|  |  | of the primes is large enough so that the product of the primes is twice as large as each |
|  |  | prime. A little arithmetic will show that the only way to do this is to make sure that each of |
|  |  | the primes is no less than root(2)/2. That's what this functions does. This function adjusts the |
|  |  | candidate prime so that it is odd and >= root(2)/2. This allows the product of these two numbers |
|  |  | to be .5, which, in fixed point notation means that the most significant bit is 1. For this |
|  |  | routine, the root(2)/2 (0.7071067811865475) approximated with 0xB505 which is, in fixed point, |
|  |  | 0.7071075439453125 or an error of 0.000108%. Just setting the upper two bits would give a value > |
|  |  | 0.75 which is an error of > 6%. Given the amount of time all the other computations take, |
|  |  | reducing the error is not much of a cost, but it isn't totally required either. \*/ |
|  |  | /\* This function can be replaced with a function that just sets the two most significant bits of |
|  |  | each prime candidate without introducing any computational issues. \*/ |
|  |  |  |
|  |  | static void |
|  |  | RsaAdjustPrimeCandidate\_New( |
|  |  | bigNum prime |
|  |  | ) |
|  |  | { |
|  |  | UINT32 msw; |
|  |  | UINT32 adjusted; |
|  |  |  |
|  |  | // If the radix is 32, the compiler should turn this into a simple assignment |
|  |  | msw = prime->d[prime->size - 1] >> ((RADIX\_BITS == 64) ? 32 : 0); |
|  |  | // Multiplying 0xff...f by 0x4AFB gives 0xff..f - 0xB5050...0 |
|  |  | adjusted = (msw >> 16) \* 0x4AFB; |
|  |  | adjusted += ((msw & 0xFFFF) \* 0x4AFB) >> 16; |
|  |  | adjusted += 0xB5050000UL; |
|  |  | #if RADIX\_BITS == 64 |
|  |  | // Save the low-order 32 bits |
|  |  | prime->d[prime->size - 1] &= 0xFFFFFFFFUL; |
|  |  | // replace the upper 32-bits |
|  |  | prime->d[prime->size -1] |= ((crypt\_uword\_t)adjusted << 32); |
|  |  | #else |
|  |  | prime->d[prime->size - 1] = (crypt\_uword\_t)adjusted; |
|  |  | #endif |
|  |  | // make sure the number is odd |
|  |  | prime->d[0] |= 1; |
|  |  | } |
|  |  | LIB\_EXPORT void |
|  |  | RsaAdjustPrimeCandidate( |
|  |  | bigNum prime |
|  |  | ) |
|  |  | { |
|  |  | if (1) |
|  |  | RsaAdjustPrimeCandidate\_PreRev155(prime); |
|  |  | else |
|  |  | RsaAdjustPrimeCandidate\_New(prime); |
|  |  | } |
|  |  | /\* 10.2.14.1.8 BnGeneratePrimeForRSA() \*/ |
|  |  | /\* Function to generate a prime of the desired size with the proper attributes for an RSA prime. \*/ |
|  |  |  |
|  |  | TPM\_RC |
|  |  | BnGeneratePrimeForRSA( |
|  |  | bigNum prime, |
|  |  | UINT32 bits, |
|  |  | UINT32 exponent, |
|  |  | RAND\_STATE \*rand |
|  |  | bigNum prime, // IN/OUT: points to the BN that will get the |
|  |  | // random value |
|  |  | UINT32 bits, // IN: number of bits to get |
|  |  | UINT32 exponent, // IN: the exponent |
|  |  | RAND\_STATE \*rand // IN: the random state |
|  |  | ) |
|  |  | { |
|  |  | BOOL found = FALSE; |
| Expand All | | @@ -340,10 +395,21 @@ BnGeneratePrimeForRSA( |
|  |  |  |
|  |  | while(!found) |
|  |  | { |
|  |  | DRBG\_Generate(rand, (BYTE \*)prime->d, (UINT16)BITS\_TO\_BYTES(bits)); |
|  |  | if(g\_inFailureMode) |
|  |  | return TPM\_RC\_FAILURE; |
|  |  | // The change below is to make sure that all keys that are generated from the same |
|  |  | // seed value will be the same regardless of the endianess or word size of the CPU. |
|  |  | // DRBG\_Generate(rand, (BYTE \*)prime->d, (UINT16)BITS\_TO\_BYTES(bits));// old |
|  |  | // if(g\_inFailureMode) // old |
|  |  | // libtpms changed begin |
|  |  | if (1) { |
|  |  | DRBG\_Generate(rand, (BYTE \*)prime->d, (UINT16)BITS\_TO\_BYTES(bits)); |
|  |  | if (g\_inFailureMode) |
|  |  | return TPM\_RC\_FAILURE; |
|  |  | } else { |
|  |  | if(!BnGetRandomBits(prime, bits, rand)) // new |
|  |  | return TPM\_RC\_FAILURE; |
|  |  | } |
|  |  | RsaAdjustPrimeCandidate(prime); |
|  |  | // libtpms changed end |
|  |  | found = RsaCheckPrime(prime, exponent, rand) == TPM\_RC\_SUCCESS; |
|  |  | } |
|  |  | return TPM\_RC\_SUCCESS; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `625171b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F625171be0c8225824740b5d0fb7e8562f6a1c6a8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_733c9b21_20250115_125213.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fissues%2F183)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fissues%2F183)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=stefanberger%2Flibtpms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stefanberger](/stefanberger)
/
**[libtpms](/stefanberger/libtpms)**
Public

* [Notifications](/login?return_to=%2Fstefanberger%2Flibtpms) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2Fstefanberger%2Flibtpms)
* [Star
   228](/login?return_to=%2Fstefanberger%2Flibtpms)

* [Code](/stefanberger/libtpms)
* [Issues
  3](/stefanberger/libtpms/issues)
* [Pull requests
  4](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects
  0](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

Additional navigation options

* [Code](/stefanberger/libtpms)
* [Issues](/stefanberger/libtpms/issues)
* [Pull requests](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fstefanberger%2Flibtpms%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fstefanberger%2Flibtpms%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [libtpms 0.7] TPM2\_CreatePrimary creates prime numbers with 32 zero bits #183

Closed

[fishilico](/fishilico) opened this issue
Feb 17, 2021
· 8 comments

Closed

# [[libtpms 0.7] TPM2\_CreatePrimary creates prime numbers with 32 zero bits](#top) #183

[fishilico](/fishilico) opened this issue
Feb 17, 2021
· 8 comments

## Comments

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=80&v=4)](/fishilico)

Copy link

### **[fishilico](/fishilico)** commented [Feb 17, 2021](#issue-810084843)

| **Describe the bug** When running `tpm2_createprimary` on swtpm with libtpms 0.7.4 to generate an RSA-2048 key, the modulus of the key always contains many zeros in its high bits. By extracting the prime factors from file holding the persistent TPM state, they always have 32 bits set to zero. For example:   * Modulus `n = 0xc8f8f77a0000bacc2f18e6a43f600d9990b9079654f85b23da5b26896a7cab24d52ea3dcae0bc754b2cf0aefd3ac036459d4a2bd1ec1c25d56f7822a633c1bd29ad54f4ec7a7e3e8d64697c737283c4b77ec01c9eb0dd36371dfb7fd160b1b6f946db24f0eda15997e488f7427c87f173d5d3baecf98d0d6832a97d28c3da99835cf22a83c39d6dd61f880422541b80d958a0f8756f804a65571c7937768717648deb6f8ccc8343a42a2b672ecd4e523f0ded37822db4b1af769416e4dcdb3d55ad4c7b78f47904a47f1418bc59295c2b2a6e2ea9f3c40caaf1f23a79ed18aab4bfb9754676b47759e705d5ab1ba8fd96be01ac7e475485a4577e105d6dc5e4f` * First prime number `p = 0xdd7500000000a998d562fd94dd501fbaedbd693474333472bab4a5889a021b5ae79d4bf98c87d2509831103be119297abdc09e315a66bf1918a2d27a19ed805b01ea87f01e433c14bb6dde779bb70de6878b0697b9f2d1b064fe48bd06c83d11d3170d99a7f1637d2c10f0e00a0f04bd21ce3e02a2fa8803fd8fe5d9512b60b9` * Second prime number `q = 0x0xe8520000000026049bfad92bbdea021f996acd0c55557fd42d16acb73fbd94cd908a636fc5da4e635707f7aa1e2f3041f144755520094b6ac322dfd57f5f3b98b679725a7bd33373fd67a11f2d51bbef4cf486bf60db2c89093bfcbc229f640be853f04d98b27aa0b5a613d5edd4350d8c90e7189a4097f0703f4f88f0556347`   (Observe the eight `0` hexdigits after the 4 first hexdigits of the prime numbers).  This is due to a bug in function `RsaAdjustPrimeCandidate`   [libtpms/src/tpm2/crypto/openssl/CryptPrime.c](https://github.com/stefanberger/libtpms/blob/2452a24dabd7b5596f429a1e8de00e064a5566de/src/tpm2/crypto/openssl/CryptPrime.c#L304-L318)  Lines 304 to 318 in [2452a24](/stefanberger/libtpms/commit/2452a24dabd7b5596f429a1e8de00e064a5566de)   |  | LIB\_EXPORT void | | --- | --- | |  | RsaAdjustPrimeCandidate( | |  | bigNum prime | |  | ) | |  | { | |  | UINT16 highBytes; | |  | crypt\_uword\_t \*msw = &prime->d[prime->size - 1]; | |  | #define MASK (MAX\_CRYPT\_UWORD >> (RADIX\_BITS - 16)) | |  | highBytes = \*msw >> (RADIX\_BITS - 16); | |  | // This is fixed point arithmetic on 16-bit values | |  | highBytes = ((UINT32)highBytes \* (UINT32)0x4AFB) >> 16; | |  | highBytes += 0xB505; | |  | \*msw = ((crypt\_uword\_t)(highBytes) << (RADIX\_BITS - 16)) + (\*msw & MASK); | |  | prime->d[0] |= 1; | |  | } |      The issue is that on 64-bit systems, `MASK` is not `0x0000ffffffffffff` but `0x000000000000ffff` when `RADIX_BITS` is 64, so only the 16 lowest bits of `*msw` are kept instead of the 48 lowest bits. More precisely, in `#define MASK (MAX_CRYPT_UWORD >> (RADIX_BITS - 16))`, the shift operand should have been `16`.  This bug is present in TCG specification (<https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-4-Supporting-Routines-01.38-code.pdf> section `10.2.15.7 AdjustPrimeCandiate()`). This specification was updated and the current version does not have this bug (<https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part4_SuppRoutines_code_pub.pdf> section `10.2.14.1.6 AdjustPrimeCandiate()`). This new version was implemented in April 2020 in [625171b](https://github.com/stefanberger/libtpms/commit/625171be0c8225824740b5d0fb7e8562f6a1c6a8) (branch `master`) but no release of `libtpms` includes the new version yet.  Therefore I have three questions:   * Could `RsaAdjustPrimeCandidate` be fixed in branch `stable-0.7.0` so that generating new RSA keys do not use prime numbers with many zeros, on 64-bit systems? * If no, could a comment be added which clearly state that this prime number generator generates prime numbers that have 32 bits always set to zero and that the TCG already fixed this issue in a newer version of "Trusted Platform Module Library Family "2.0" Specification - Part 4: Routines - Code"? * When will the next release of `libtpms` (version `0.8`?) occur?   **To Reproduce** Steps to reproduce the behavior:   1. On Arch Linux on an x86-64 system, install `swtpm`, `tpm2-tools` and `tpm2-abrmd`. 2. Launch `swtpm` in TPM2-mode and `tpm2-abrmd`, for example with:  ``` swtpm socket --tpm2 --server port=2321 --daemon --ctrl type=tcp,port=2322 --flags not-need-init --tpmstate dir=/tmp tpm2-abrmd --allow-root --tcti swtpm:host=127.0.0.1,port=2321 ```  3. Generate a persistent RSA key on the software TPM, for example with:  ``` export TPM2TOOLS_TCTI=tabrmd:bus_type=system tpm2_createprimary -c /tmp/context.out -g sha256 -G rsa tpm2_evictcontrol -c /tmp/context.out 0x81000001 ```  4. Analyze the content of `/tmp/tpm2-00.permall` to retrieve the modulus and the prime numbers of the generated RSA key.   **Expected behavior** `tpm2_createprimary` should create an RSA key with prime numbers which really look random, instead of with 32 bits always set to zero.  **Desktop (please complete the following information):**   * OS: Arch Linux on an x86-64 CPU (64-bit system)   **Versions of relevant components**   * libtpms: 0.7.4 * swtpm: 0.5.2 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=40&v=4)](/fishilico)
[fishilico](/fishilico)
changed the title
~~[libtpms 0.7] TPM2\_CreatePrimary creates prime numbers with 32 zeros bits~~
[libtpms 0.7] TPM2\_CreatePrimary creates prime numbers with 32 zero bits
[Feb 17, 2021](#event-4340794514)

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 17, 2021](#issuecomment-780547832)

| I am aware of this issue and cannot solve it for 0.7.x. Users may have encrypted data with this key and we cannot just fix the key creation algorithm and create different keys derived from seeds that then cannot decrypt the data anymore. The created keys have to be the same. So the solution is more complicated than just fixing the key creation algorithm. It involves tracking the 'age' of the seed and only switch to the new key creation algorithm when new seeds are created and creating it with the broken algorithm for as long as the old seed is used. Backporting the fixes would disturb the way the TPM 2 state is written and so I don't want to do that - no backports of fixes that change the state that is being written out otherwise we may loose the upgrade path. The issue is solved for the 0.8.0 release (Commit [c1f7bf5](https://github.com/stefanberger/libtpms/commit/c1f7bf55099fcd427715aa65e130475c6e836a6b) in master activates the fix.) but this version is on hold due to issue [#147](https://github.com/stefanberger/libtpms/issues/147) related to Linux not being able to deal with 3072 bit keys - or at least the fix that I provided for that has to be distributed first to distros before we can use it |
| --- |

All reactions

Sorry, something went wrong.

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 17, 2021](#issuecomment-780549396) • edited Loading

| If no, could a comment be added which clearly state that this prime number generator generates prime numbers that have 32 bits always set to zero and that the TCG already fixed this issue in a newer version of "Trusted Platform Module Library Family "2.0" Specification - Part 4: Routines - Code"?  Where do you want me to add a comment? |
| --- |

All reactions

Sorry, something went wrong.

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=80&v=4)](/fishilico)

Copy link

Author

### **[fishilico](/fishilico)** commented [Feb 17, 2021](#issuecomment-780602167)

| Thanks for your quick reply. I understand that 0.7.x cannot be easily modified without disturbing things and I agree with your approach.  Where do you want me to add a comment?  I was thinking of modifying (in `stable-0.7.0`)   [libtpms/src/tpm2/crypto/openssl/CryptPrime.c](https://github.com/stefanberger/libtpms/blob/2452a24dabd7b5596f429a1e8de00e064a5566de/src/tpm2/crypto/openssl/CryptPrime.c#L311)  Line 311 in [2452a24](/stefanberger/libtpms/commit/2452a24dabd7b5596f429a1e8de00e064a5566de)   |  | #define MASK (MAX\_CRYPT\_UWORD >> (RADIX\_BITS - 16)) | | --- | --- |     to:   ``` /* This computation is known to be buggy on 64-bit systems, as MASK=0xffff                                    * instead of 0x0000ffffffffffff and this introduces 32 zero bits in the          * adjusted prime number. But fixing this would modify keys which were  * previously generated, so keep it this way for now.                                                  * This was fixed in the current version of "Trusted Platform Module Library  * Family 2.0 Specification - Part 4: Routines - Code" (from TCG) and this issue      * will be fixed for newly-generated prime numbers for the version of libtpms                                   * which will come after 0.7.x.                                                      */ #define MASK (MAX_CRYPT_UWORD >> (RADIX_BITS - 16)) ```  For issue [#147](https://github.com/stefanberger/libtpms/issues/147), the last comment seems to indicate that the stable versions of the Linux kernel were patched and that the issue was fixed. Why is this comment still open? (It would be helpful to add a sentence about what is now blocking this issue) |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 17, 2021](#issuecomment-780607838)

| The primary reason is that I wanted to give it some time for the fix the be propagated through distros and people have had a chance to update their systems. The bad keys won't go away for existing VMs but will be fixed primarily for new ones.  I am going to make a 0.7.5 release now and added this comment to the CHANGES file:  ``` version 0.7.5   - Note: The TPM 2 implementation returns 2048 bit keys with ~1984 bit           strength due to a bug in the TPM 2 key creation algo that cannot           easily be fixed. The bug is in RsaAjustPrimeCandidate, which is           called before the prime number check.  ```  Ok, so let me update the code as well with your additional text. |
| --- |

All reactions

Sorry, something went wrong.

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 17, 2021](#issuecomment-780613224)

| I added this patch now to the PR including your Reported-by: line: [0e3d5d0](https://github.com/stefanberger/libtpms/commit/0e3d5d05f0b86091d714100b854e07f16d90e86b) |
| --- |

All reactions

Sorry, something went wrong.

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 17, 2021](#issuecomment-780628571)

| There's another unfortunate problem with 3072 bit RSA key support. If someone was to use an older version of a Linux distro where tools may not support the larger size of the context then they are stuck. I believe the Intel tools did have some issues with larger sized key contexts at some point. Downgrading libtpms from 0.8 to 0.7.y would not work then. So this is a tricky issue and I may have to modify libtpms 0.8 in such a way that the older short context is returned for 2048 bit RSA keys... I wished I didn't have to change this code. |
| --- |

All reactions

Sorry, something went wrong.

[![@salahcoronya](https://avatars.githubusercontent.com/u/46760879?s=40&v=4)](/salahcoronya)
[salahcoronya](/salahcoronya)
mentioned this issue
[Feb 24, 2021](#ref-pullrequest-815599513)

[app-crypt/libtpms: Bump to 0.8.2
gentoo/gentoo#19630](/gentoo/gentoo/pull/19630)
 Closed

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=80&v=4)](/stefanberger)

Copy link

Owner

### **[stefanberger](/stefanberger)** commented [Feb 24, 2021](#issuecomment-785305911)

| I just released v0.8.0 that should resolve the prime number issue for new instances of swtpm or when a user changes the seeds, possibly using a vFirmware menu in case a VM is used. The user has to be aware that keys that depended on those seeds or data/keys that were encrypted with those keys, will be lost then. |
| --- |

All reactions

Sorry, something went wrong.

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=80&v=4)](/fishilico)

Copy link

Author

### **[fishilico](/fishilico)** commented [Mar 1, 2021](#issuecomment-787839723)

| Thanks! I confirm that libtpms v0.8.1 works nicely (on Arch Linux on an x86-64 computer), and that I successfully upgraded from 0.7.5:   * `tpm2_createprimary -g sha256 -G rsa -C e`, `tpm2_createprimary -g sha256 -G rsa -C o` and `tpm2_createprimary -g sha256 -G rsa -C p` continued to produce the same RSA keys (which were issued from prime numbers with 32 zero bits), as expected. * After changing the seeds (with `tpm2_changeeps` and `tpm2_changepps`) the keys changed, as expected. * The persistent TPM state saved `EPSeedCompatLevel = 1` and `PPSeedCompatLevel = 1`, as expected.   Moreover for my use-case, not being able to downgrade from 0.8.x to 0.7.y is not an issue.  So from my perspective, the issue is fixed and you did an excellent work for this. Thanks again! |
| --- |

All reactions

Sorry, something went wrong.

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=40&v=4)](/fishilico)
[fishilico](/fishilico)
closed this as [completed](/stefanberger/libtpms/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 1, 2021](#event-4388712540)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fissues%2F183)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@fishilico](https://avatars.githubusercontent.com/u/1040594?s=52&v=4)](/fishilico) [![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=52&v=4)](/stefanberger)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_2839a15e_20250115_201655.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1950046)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1950046)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1950046)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1950046

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1950046**](show_bug.cgi?id=1950046)
(CVE-2021-3505)
- [CVE-2021-3505](https://access.redhat.com/security/cve/CVE-2021-3505) libtpms: RSA keys weaker than expected

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-3505 libtpms: RSA keys weaker than expected

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-3505 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1942902](show_bug.cgi?id=1942902) [1950048](show_bug.cgi?id=1950048 "CLOSED ERRATA - CVE-2021-3505 libtpms: RSA keys weaker than expected [fedora-all]") [1950063](show_bug.cgi?id=1950063) [1950064](show_bug.cgi?id=1950064) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1945068](show_bug.cgi?id=1945068) [1950378](show_bug.cgi?id=1950378) | | TreeView+ | [depends on](buglist.cgi?bug_id=1950046&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1950046&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-04-15 16:06 UTC by Mauro Matteo Cascella | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-10-29 08:57 UTC ([History](show_activity.cgi?id=1950046)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  davide marcandre.lureau stefanb virt-maint | | Fixed In Version: | libtpms 0.8.0 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in libtpms. The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TCG specification. The bug is in the key creation algorithm in RsaAdjustPrimeCandidate(), which is called before the prime number check. The highest threat from this vulnerability is to data confidentiality. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-10-29 08:57:48 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1950046#c0)  Mauro Matteo Cascella    2021-04-15 16:06:34 UTC  ``` The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TPM 2 key creation algorithm that cannot easily be fixed. The bug is in RsaAjustPrimeCandidate, which is called before the prime number check. Upgrading to a fixed release (0.8.0+) is not sufficient. The only way to fix it is to unseal all data, delete the old TPM state file, generate a new one, then reseal the data.  Note: the bug is based on the TCG reference code. The TCG specification was updated in late 2019 and libtpms' key creation algorithm fixed in version 0.8.0.  Upstream issue: <https://github.com/stefanberger/libtpms/issues/183>  Upstream commits: <https://github.com/stefanberger/libtpms/commit/625171be0c8225824740b5d0fb7e8562f6a1c6a8> <https://github.com/stefanberger/libtpms/commit/c1f7bf55099fcd427715aa65e130475c6e836a6b>   ```  [Comment 1](show_bug.cgi?id=1950046#c1)  Mauro Matteo Cascella    2021-04-15 16:07:11 UTC  ``` Created libtpms tracking bugs for this issue:  Affects: fedora-all [[bug 1950048](show_bug.cgi?id=1950048 "CLOSED ERRATA - CVE-2021-3505 libtpms: RSA keys weaker than expected [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=1950046#c5)  Marc-Andre Lureau    2021-04-16 10:59:33 UTC  ``` It is likely a breaking change, as it was not introduced in 0.7 branch (see <https://github.com/stefanberger/libtpms/commit/153a9579e84c83c38d404bd12fd5267f82fd07a1>). Also, I think a CVE was requested earlier and not accepted.   ```  [Comment 6](show_bug.cgi?id=1950046#c6)  Stefan Berger    2021-04-16 13:07:50 UTC  ``` When a TPM 2 (instance) is upgraded from libtpms 0.7.x to 0.8.x it will continue using the weak key generation algorithm since otherwise nothing would decrypt anymore with keys derived from the TPM 2's current seeds. If the seeds are reset, which is only possible via firmware, then the code will switch to use the new key generation algorithm for seed-derive keys since after resetting the seeds the keys are expected to be different than before and nothing is expected to decrypt anymore with seeed-derived keys. So it shouldn't break anything from the point of view of the user, he just doesn't get the better keys because we cannot just switch over. Newly created TPM 2 instance using libtpms 0.8 would use the fixed key generation algorithm.   ```  [Comment 7](show_bug.cgi?id=1950046#c7)  Marc-Andre Lureau    2021-04-16 14:27:28 UTC  ``` Stefan, why is the fix not backported to 0.7 branch then?   ```  [Comment 8](show_bug.cgi?id=1950046#c8)  Stefan Berger    2021-04-16 14:43:38 UTC  ``` (In reply to Marc-Andre Lureau from [comment #7](show_bug.cgi?id=1950046#c7)) > Stefan, why is the fix not backported to 0.7 branch then?  Because it changes the state file of the TPM 2 to keep track of the 'age' of the seeds. I don't backport these kind of changes.   ```  [Comment 9](show_bug.cgi?id=1950046#c9)  Marc-Andre Lureau    2021-04-16 14:46:57 UTC  ``` (In reply to Stefan Berger from [comment #8](show_bug.cgi?id=1950046#c8)) > (In reply to Marc-Andre Lureau from [comment #7](show_bug.cgi?id=1950046#c7)) > > Stefan, why is the fix not backported to 0.7 branch then? >  > Because it changes the state file of the TPM 2 to keep track of the 'age' of > the seeds. I don't backport these kind of changes.  Could it keep the current age instead? Only newly state would get a new age. (if that makes sense)   ```  [Comment 10](show_bug.cgi?id=1950046#c10)  Stefan Berger    2021-04-16 14:52:53 UTC  ``` (In reply to Marc-Andre Lureau from [comment #9](show_bug.cgi?id=1950046#c9)) > (In reply to Stefan Berger from [comment #8](show_bug.cgi?id=1950046#c8)) > > (In reply to Marc-Andre Lureau from [comment #7](show_bug.cgi?id=1950046#c7)) > > > Stefan, why is the fix not backported to 0.7 branch then? > >  > > Because it changes the state file of the TPM 2 to keep track of the 'age' of > > the seeds. I don't backport these kind of changes. >  > Could it keep the current age instead? Only newly state would get a new age. > (if that makes sense)  How do you distinguish between an old seed requiring to run the weak key generation algorithm and a new seed then? Sorry, but this doesn't make sense. You need to track that 1 bit of information. Besides that, the patches have already been merged a long time ago and libtpms 0.8.x fixes the issue.   ```  [Comment 11](show_bug.cgi?id=1950046#c11)  Marc-Andre Lureau    2021-04-16 15:07:06 UTC  ``` (In reply to Stefan Berger from [comment #10](show_bug.cgi?id=1950046#c10)) > How do you distinguish between an old seed requiring to run the weak key > generation algorithm and a new seed then? Sorry, but this doesn't make  The age doesn't let you make that difference? What's the age for then?  > sense. You need to track that 1 bit of information. Besides that, the > patches have already been merged a long time ago and libtpms 0.8.x fixes the > issue.  We don't usually rebase versions in RHEL released products, we backport fixes or just WONTFIX.  Please help us make the best decision   ```  [Comment 12](show_bug.cgi?id=1950046#c12)  Stefan Berger    2021-04-16 15:21:07 UTC  ``` (In reply to Marc-Andre Lureau from [comment #11](show_bug.cgi?id=1950046#c11)) > (In reply to Stefan Berger from [comment #10](show_bug.cgi?id=1950046#c10)) > > How do you distinguish between an old seed requiring to run the weak key > > generation algorithm and a new seed then? Sorry, but this doesn't make >  > The age doesn't let you make that difference? What's the age for then?  Yes, the age let's you make the difference but the age was introduced as part of the patches to fix the issue. This changes the state format the TPM 2's state is written in and I don't want to backport it since it's too easy to loose the upgrade path.  >  > > sense. You need to track that 1 bit of information. Besides that, the > > patches have already been merged a long time ago and libtpms 0.8.x fixes the > > issue. >  > We don't usually rebase versions in RHEL released products, we backport > fixes or just WONTFIX. >  > Please help us make the best decision  In this case I would say that if you start a new version of RHEL you could still go with libtpms-0.8.x, if you cannot upgrade it then mark it as WONTFIX.   ```  [Comment 13](show_bug.cgi?id=1950046#c13)  Marc-Andre Lureau    2021-04-16 15:40:34 UTC  ``` (In reply to Stefan Berger from [comment #12](show_bug.cgi?id=1950046#c12)) > > The age doesn't let you make that difference? What's the age for then? >  > Yes, the age let's you make the difference but the age was introduced as > part of the patches to fix the issue. This changes the state format the TPM > 2's state is written in and I don't want to backport it since it's too easy > to loose the upgrade path.  How did you handle migration from 0.7/non-aged to 0.8 ? In CHANGES, it is said downgrade is not possible, not upgrade. There must be a way to distinguish fixed from non-fixed version then.   > > > sense. You need to track that 1 bit of information. Besides that, the > > > patches have already been merged a long time ago and libtpms 0.8.x fixes the > > > issue. > >  > > We don't usually rebase versions in RHEL released products, we backport > > fixes or just WONTFIX. > >  > > Please help us make the best decision >  > In this case I would say that if you start a new version of RHEL you could > still go with libtpms-0.8.x, if you cannot upgrade it then mark it as > WONTFIX.  If it would just be me, I would upgrade to 0.8, but this brings a lot of other changes that might be too risky too.  Mauro, what do you think?   ```  [Comment 14](show_bug.cgi?id=1950046#c14)  Marc-Andre Lureau    2021-04-16 15:47:39 UTC  ``` > In CHANGES, it is said downgrade is not possible, not upgrade. There must be a way to distinguish fixed from non-fixed version then.  The new state wouldnt be backward compatible though, but it's not worse that forcefully upgrading to 0.8.   ```  [Comment 15](show_bug.cgi?id=1950046#c15)  Stefan Berger    2021-04-16 15:48:42 UTC  ``` (In reply to Marc-Andre Lureau from [comment #13](show_bug.cgi?id=1950046#c13)) > (In reply to Stefan Berger from [comment #12](show_bug.cgi?id=1950046#c12)) > > > The age doesn't let you make that difference? What's the age for then? > >  > > Yes, the age let's you make the difference but the age was introduced as > > part of the patches to fix the issue. This changes the state format the TPM > > 2's state is written in and I don't want to backport it since it's too easy > > to loose the upgrade path. >  > How did you handle migration from 0.7/non-aged to 0.8 ? In CHANGES, it is > said downgrade is not possible, not upgrade. There must be a way to > distinguish fixed from non-fixed version then.  When TPM 2 reads the statefile of the TPM 2 and the blob containing a seed is of version <x, where version <x does not track the age of the seed, it assigns it the default value representing the state of an old seed. The state writing side will write the blob in version x which now contains the age of the seed and the next time we read the state from the file we pick up the age from the blob.   ```  [Comment 16](show_bug.cgi?id=1950046#c16)  Mauro Matteo Cascella    2021-04-17 14:53:45 UTC  ``` In reply to [comment #13](show_bug.cgi?id=1950046#c13): > (In reply to Stefan Berger from [comment #12](show_bug.cgi?id=1950046#c12)) > > > We don't usually rebase versions in RHEL released products, we backport > > > fixes or just WONTFIX. > > >  > > > Please help us make the best decision > >  > > In this case I would say that if you start a new version of RHEL you could > > still go with libtpms-0.8.x, if you cannot upgrade it then mark it as > > WONTFIX. >  > If it would just be me, I would upgrade to 0.8, but this brings a lot of > other changes that might be too risky too. >  > Mauro, what do you think?  I was aware that backporting the fix to 0.7.x (the only versions we currently ship) would have been tricky, but decided to allocate a CVE anyway because that was the right thing to do. I would probably lean towards WONTFIX here: this is not an important/critical issue and probably not worth the effort given the above comments.  As for whether or not to rebase, I don't know what implications - mostly from a functional/compatibility point of view - an upgrade to 0.8 would entail. That said, as you know, a number of potentially-security-sensitive fixes didn't get CVEs in the past (e.g., <https://github.com/stefanberger/libtpms/blob/stable-0.7.0/CHANGES>) and I see the risk of not backporting a security fix just because it didn't get a CVE. With this in mind IMHO rebasing should be a serious option to consider - if possible - alongside a more thorough handling of CVEs going forward (we can help with the latter part).   ```  [Comment 17](show_bug.cgi?id=1950046#c17)  Mauro Matteo Cascella    2021-04-17 15:30:00 UTC  ``` Statement:  Versions of `libtpms` prior to 0.8.0 generate weaker than expected TPM 2 RSA keys due to the flawed key creation algorithm. Red Hat Enterprise Linux 8 Advanced Virtualization is therefore affected by this flaw, as it ships an older version of the package (0.7.x).   ```  [Comment 18](show_bug.cgi?id=1950046#c18)  Mauro Matteo Cascella    2021-04-17 15:30:02 UTC  ``` Mitigation:  There is no mitigation for this issue. Upgrading to a fixed release (0.8.0+) is necessary but not sufficient. The only way to fix it is to unseal all data, delete the old TPM state file, generate a new one with the fixed key generation algorithm, then reseal the data.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1950046&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_f47e63ff_20250115_125210.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F153a9579e84c83c38d404bd12fd5267f82fd07a1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F153a9579e84c83c38d404bd12fd5267f82fd07a1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=stefanberger%2Flibtpms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stefanberger](/stefanberger)
/
**[libtpms](/stefanberger/libtpms)**
Public

* [Notifications](/login?return_to=%2Fstefanberger%2Flibtpms) You must be signed in to change notification settings
* [Fork
  96](/login?return_to=%2Fstefanberger%2Flibtpms)
* [Star
   228](/login?return_to=%2Fstefanberger%2Flibtpms)

* [Code](/stefanberger/libtpms)
* [Issues
  3](/stefanberger/libtpms/issues)
* [Pull requests
  4](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects
  0](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

Additional navigation options

* [Code](/stefanberger/libtpms)
* [Issues](/stefanberger/libtpms/issues)
* [Pull requests](/stefanberger/libtpms/pulls)
* [Actions](/stefanberger/libtpms/actions)
* [Projects](/stefanberger/libtpms/projects)
* [Wiki](/stefanberger/libtpms/wiki)
* [Security](/stefanberger/libtpms/security)
* [Insights](/stefanberger/libtpms/pulse)

## Commit

[Permalink](/stefanberger/libtpms/commit/153a9579e84c83c38d404bd12fd5267f82fd07a1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

tpm2: Add comment to buggy RSAAdjustPrimeCandidate

[Browse files](/stefanberger/libtpms/tree/153a9579e84c83c38d404bd12fd5267f82fd07a1)
Browse the repository at this point in the history

```
This patch adds a description to the buggy RSAAdjustPrimeCandidate
implementation that can only be properly fixed after 0.7.x.

Reported-by: Nicolas Iooss <nicolas.iooss@ledger.fr>
Signed-off-by: Stefan Berger <stefanb@linux.ibm.com>
```

* Loading branch information

[![@stefanberger](https://avatars.githubusercontent.com/u/1873348?s=40&v=4)](/stefanberger)

[stefanberger](/stefanberger/libtpms/commits?author=stefanberger "View all commits by stefanberger")
committed
Feb 18, 2021

1 parent
[8001ad0](/stefanberger/libtpms/commit/8001ad0b968b18d4b002ea0ac6a5cd3fd8be3eeb)

commit 153a957

Showing
**1 changed file**
with
**10 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[src/tpm2/crypto/openssl/CryptPrime.c](#diff-b6baa967ff23646be73b04231aa04f1010e37b244d3c3b4054098255df1c756a "src/tpm2/crypto/openssl/CryptPrime.c")

Show comments

[View file](/stefanberger/libtpms/blob/153a9579e84c83c38d404bd12fd5267f82fd07a1/src/tpm2/crypto/openssl/CryptPrime.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -308,6 +308,16 @@ RsaAdjustPrimeCandidate( |
|  |  | { |
|  |  | UINT16 highBytes; |
|  |  | crypt\_uword\_t \*msw = &prime->d[prime->size - 1]; |
|  |  |  |
|  |  | /\* This computation is known to be buggy on 64-bit systems, as MASK=0xffff |
|  |  | \* instead of 0x0000ffffffffffff and this introduces 32 zero bits in the |
|  |  | \* adjusted prime number. But fixing this would modify keys which were |
|  |  | \* previously generated, so keep it this way for now. |
|  |  | \* This was fixed in the current version of "Trusted Platform Module Library |
|  |  | \* Family 2.0 Specification - Part 4: Routines - Code" (from TCG) and this issue |
|  |  | \* will be fixed for newly-generated prime numbers for the version of libtpms |
|  |  | \* which will come after 0.7.x. |
|  |  | \*/ |
|  |  | #define MASK (MAX\_CRYPT\_UWORD >> (RADIX\_BITS - 16)) |
|  |  | highBytes = \*msw >> (RADIX\_BITS - 16); |
|  |  | // This is fixed point arithmetic on 16-bit values |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `153a957`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstefanberger%2Flibtpms%2Fcommit%2F153a9579e84c83c38d404bd12fd5267f82fd07a1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


