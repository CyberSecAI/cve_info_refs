```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "related": true,
      "content": "The vulnerability is caused by missing length checks in the `hdrblobInit()` function within `lib/header.c` of the RPM package. This allows an attacker who can modify the rpmdb to cause an out-of-bounds read. An attacker can achieve this by crafting a malicious RPM package with a malformed header, specifically by adding an unknown tag in the signature header, which gets copied into the RPM metadata header during the package installation process.\n\nWeaknesses/vulnerabilities:\n- Out-of-bounds read due to missing length checks in `hdrblobInit()`.\n- The `headerMergeLegacySigs()` function copies unknown tags from the signature header to the main RPM header, leading to potential string injection.\n\nImpact of exploitation:\n- System availability can be compromised due to the out-of-bounds read.  \n- Corruption of the RPM database, leading to data integrity issues.\n- Inaccessible headers within the RPM database.\n- Bad tag errors when rpm reads the database.\n- Installed packages may not be retrievable or shown as not installed.\n- Seemingly missing dependencies that are actually installed.\n- It may be possible to insert an erroneous and/or malicious OpenPGP signature into a signed package.\n\nAttack vectors:\n- Modifying the rpmdb. An attacker can achieve this by convincing a victim to install a seemingly verifiable package or by compromising an RPM repository.\n- Direct manipulation of the rpmdb contents.\n\nRequired attacker capabilities/position:\n- The attacker needs the ability to modify the rpmdb or to directly manipulate the rpmdb contents, typically requiring root privileges on the system.\n- The attacker needs to be able to create a malformed RPM package with a specially crafted header containing malicious/untrusted data.",
      "additional_information": "The vulnerability also affects headerImport() function. The vulnerability can be mitigated by ensuring that the size of the blob (uc argument) is passed to both headerCheck() and headerImport(), and that it is large enough to at least hold the header intro. The deprecated functions headerLoad(), headerCopyLoad(), and headerUnload() should not be used.\n\nIt requires running rpm against a malicious or malformed package which should never be in the official supported package repositories - so a Man-in-the-middle or attempting to install an unsupported or modified package would be required to trigger this."
    },
    {
      "related": true,
      "content": "A flaw was found in the RPM package that leads to RPM database corruption. This occurs due to missing length checks in `hdrblobInit()` within `lib/header.c`.  Specifically, the `headerMergeLegacySigs()` function allows copying of unknown tags from the signature header into the RPM header. By crafting a malicious RPM package with an unsigned signature header containing unknown tags, an attacker can inject strings into the RPM database. This leads to an out-of-bounds read condition which can corrupt the RPM database. \n\nWeaknesses/vulnerabilities:\n- Missing length checks in `hdrblobInit()`, allowing an out-of-bounds read. \n- Unsigned signature header allows for string injection into the RPM database via `headerMergeLegacySigs()`.\n\nImpact of exploitation:\n- Corruption of the RPM database.\n- Potential for data integrity issues.\n- Possible injection of erroneous or malicious OpenPGP signatures.\n\nAttack vectors:\n- The attacker needs to either compromise an RPM repository or convince an administrator to install an untrusted RPM package.\n- The attacker must be able to provide a crafted RPM package with a modified signature header to trigger the vulnerability.\n\nRequired attacker capabilities/position:\n- The attacker needs the ability to modify RPM packages and persuade users or system administrators to install these packages.",
       "additional_information": "This vulnerability does not cause data loss or permanent damage to the database. The database can be repaired using the `rpmdb --rebuilddb` or `rpm --rebuilddb` commands."
    },
    {
      "related": true,
      "content": "A vulnerability in the RPM package allows an attacker to cause RPM database corruption. The vulnerability stems from a flaw in the `rpmReadPackageFile()` function which internally calls `headerMergeLegacySigs()`. This function copies signature tags from the signature header into the main RPM metadata header. The logic within `headerMergeLegacySigs()` allows for copying of unknown tags from the signature header into the RPM header which results into a corrupt header tag if the package is installed, even when the `_pkgverify_level` is set to `all`. This is due to a missing length check during header initialization in `hdrblobInit()`, where data from the signature header is copied to the main header. \n\nWeaknesses/vulnerabilities:\n- Missing length checks in `hdrblobInit()` function, leading to an out-of-bounds read.\n- `headerMergeLegacySigs()` function copies unknown tags from an unsigned signature header to the main RPM metadata header.\n\nImpact of exploitation:\n- Corruption of the RPM database.\n- Inaccessible headers within the RPM database.\n- Bad tag errors when rpm reads the database.\n- Installed packages may be shown as not installed.\n- Seemingly missing dependencies, which are actually installed.\n- Potential for string injection into the RPM database.\n\nAttack vectors:\n- An attacker can compromise an RPM repository.\n- An attacker can trick a victim into installing a malicious or malformed RPM package.\n\nRequired attacker capabilities/position:\n- An attacker needs the ability to create or modify RPM packages and convince an administrator to install the untrusted package.",
      "additional_information": "The vulnerability does not cause data loss or permanent damage to the database, which can be repaired using the `rpmdb --rebuilddb` or `rpm --rebuilddb` commands."
    }
  ]
}
```