The provided content is related to a commit that fixes a vulnerability by using DOMPurify to sanitize user-provided content.

- **Root cause of vulnerability**: The application was vulnerable to style injection via HTML content in messages. This could lead to issues with displaying the content properly and potentially other attacks. The commit addresses this vulnerability by sanitizing the HTML content using DOMPurify.
- **Weaknesses/vulnerabilities present**: The primary vulnerability was the lack of sanitization of HTML content, allowing for the injection of malicious styles and potentially other types of attacks. The application was not properly stripping or sanitizing style tags and attributes from user input.
- **Impact of exploitation**: An attacker could inject malicious styles into messages, potentially disrupting the user interface or even leading to more severe attacks such as phishing or cross-site scripting (XSS) if the unsanitized HTML was mishandled elsewhere.
- **Attack vectors**: The attacker could inject malicious content through messages within the chat application. This includes embedding malicious `style` tags or using attributes that can alter the layout or behavior of the application's display.
- **Required attacker capabilities/position**: The attacker would need to be in a position to send messages, meaning they would likely need to be a user of the chat application or have compromised an existing user's account.

The commit introduces DOMPurify to remove style tags and attributes.
The following specific changes were made:

- The `EmailContentParser.js` file, which was previously responsible for stripping style characters, was removed.
- The `stripStyleCharacters` function was moved to `messageFormatterMixin.js` and now utilizes `DOMPurify.sanitize` to remove potentially malicious tags and attributes. The function specifically forbids 'style' tags and the attributes 'id', 'class', 'style', 'bgcolor', 'valign', 'width', 'face', 'color', 'height', 'lang', 'align', and 'size'.
- The `Message.vue` component was updated to use the new `stripStyleCharacters` function from the mixin.
- A test case was added to `messageFormatterMixin.spec.js` to ensure the `stripStyleCharacters` function correctly removes style tags and attributes.