=== Content from gitlab.gnome.org_098985be_20250115_080337.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# backends/native: Use rtkit to get realtime priority

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/GNOME/mutter/-/merge_requests/2060.patch)
* [Plain diff](/GNOME/mutter/-/merge_requests/2060.diff)

[Carlos Garnacho](/carlosg) requested to merge [wip/carlosg/rtkit](/GNOME/mutter/-/tree/wip/carlosg/rtkit "wip/carlosg/rtkit")
 into [main](/GNOME/mutter/-/tree/main "main") Oct 21, 2021

* [Overview
  10](/GNOME/mutter/-/merge_requests/2060)
* [Commits
  1](/GNOME/mutter/-/merge_requests/2060/commits)
* [Pipelines
  12](/GNOME/mutter/-/merge_requests/2060/pipelines)
* [Changes
  4](/GNOME/mutter/-/merge_requests/2060/diffs)

Expand

Instead of using sched\_setscheduler directly (and relying that we
somehow got CAP\_SYS\_NICE), use rtkit to do this for us.

Fixes: [gnome-shell#2284 (closed)](https://gitlab.gnome.org/GNOME/gnome-shell/-/issues/2284 "Reevaluate usage of CAP_SYS_NICE (conflicts with AT_SECURE checks)")

## Merge request reports

Assignee
Loading

Reviewers
Loading

Request review fromRequest review fromLoading

Time tracking
Loading

Loading



=== Content from gitlab.gnome.org_55bba18a_20250115_080336.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# Reevaluate usage of CAP\_SYS\_NICE (conflicts with AT\_SECURE checks)

If a binary program has set one or more capabilities, `new_for_uri()` returns a `g_dummy_file()` instead of a `g_daemon_file()`. It happens, at least, for "http://" URIs and the "trash:///" URI.

Also, in the same case, using `set_attributes_from_info()` fails to set a `metadata::` attribute in a file.

I attach an example code that tests these three cases. Compile it with `valac --pkg glib-2.0 --pkg gio-2.0 test_gvfs.vala` and run it. It should work fine.

Now set a capability on the binary with `sudo setcap cap_sys_nice+ep test_gvfs`; running it again should fail.

Now remove the capabilities on the binary with `sudo setcap -r test_gvfs`; it should work again.

[test\_gvfs.vala](/-/project/546/uploads/e5dd73f2b9d7962f16874895f3ed2dbf/test_gvfs.vala)

Edited Feb 28, 2020 by [Carlos Garnacho](/carlosg)

Assignee
Loading

Time tracking
Loading


