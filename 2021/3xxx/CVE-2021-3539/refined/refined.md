- **Root cause of vulnerability:** The EspoCRM application allows users to upload avatars. However, the API for uploading avatars does not properly sanitize user-provided input. Specifically, it allows executable JavaScript code within the `avatarId` field, instead of just image data.
- **Weaknesses/vulnerabilities present:** Persistent Cross-Site Scripting (XSS) vulnerability (CWE-79)
- **Impact of exploitation:** An attacker can inject malicious JavaScript code, leading to a persistent XSS vulnerability. An attacker could coerce a high-privilege administrator into installing a malicious extension, granting the attacker persistent control of the application.
- **Attack vectors:** A low privileged user can upload a crafted avatar to the application using a PUT request to the API. When another user views the crafted avatar, the malicious JavaScript will execute in the browser of the user.
- **Required attacker capabilities/position:** The attacker needs a valid account that has permission to upload an avatar.