=== Content from ledgersmb.org_7f61c559_20250114_182730.html ===

[Skip to main content](#main-content)
[![Home](/sites/default/files/ledgersmb.png)](/)
[LedgerSMB](/)

The foundation for your business

## Main navigation

[Show — Main navigation](#show-block-lsmb-bartik-mainnavigation-5)
[Hide — Main navigation](#hide-block-lsmb-bartik-mainnavigation-5)

* [Home](/content/open-source-erp-accounting-invoicing-and-more)
* [Features](/content/features)
* [Download](/content/download "LedgerSMB Downloads")
* [Documentation](/content/documentation)
* [FAQ](/faq)
* [Community](/content/community-guide)
* [Support](/topics/support)
* [Testimonials](/testimonials)
* [Demo](/content/demo)

## Breadcrumb

1. [Home](/)

# Security advisory for CVE-2021-3882 (non-Secure session cookie)

Submitted by ehu
on Tue, 10/12/2021 - 11:41

# Sensitive Cookie in HTTPS Session Without 'Secure' Attribute

## Summary

LedgerSMB does not set the 'Secure' attribute on the session authorization

  cookie when the client uses HTTPS and the LedgerSMB server is behind a

  reverse proxy.  By tricking a user to use an unencrypted connection (HTTP),

  an attacker may be able to obtain the authentication data by capturing

  network traffic.

## Known vulnerable

All of:

- 1.8.0 upto 1.8.21 (including)

## Known fixed

- 1.8.22

## Details

LedgerSMB 1.8 and newer switched from Basic authentication to using cookie

  authentication with encrypted cookies.  Although an attacker can't access

  the information inside the cookie, nor the password of the user, possession

  of the cookie is enough to access the application as the user from which the

  cookie has been obtained.

In order for the attacker to obtain the cookie, first of all the server

  must be configured to respond to unencrypted requests, the attacker must be

  suitably positioned to eavesdrop on the network traffic between the client

  and the server \*and\* the user must be tricked into using unencrypted HTTP

  traffic.

Proper audit control and separation of duties limit Integrity impact of

  the attack vector.

## Severity

CVSSv3.1 Base Score: 5.9 (Medium)

CVSSv3.1 Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N

## Recommendations

Users of LedgerSMB 1.8 are urged to upgrade to known-fixed versions. Users

  of LedgerSMB 1.7 or 1.9 are unaffected by this vulnerability and don't need

  to take action.

As a workaround, users may configure their Apache or Nginx reverse proxy

  to add the Secure attribute at the network boundary instead of relying on

  LedgerSMB.

For Apache, please refer to the 'Header always edit' configuration command

  in the mod\_headers module.

  For Nginx, please refer to the 'proxy\_cookie\_flags' configuration command.

## References

CVE-2021-3882  (LedgerSMB)

https://ledgersmb.org/cve-2021-3882-sensitive-non-secure-cookie

https://huntr.dev/bounties/7061d97a-98a5-495a-8ba0-3a4c66091e9d/

## Reported by

0xdhinu, user of the huntr.dev platform

Attachments
File
 [CVE-2021-3882.patch\_.txt](/sites/default/files/2021-10/CVE-2021-3882.patch_.txt)

Topic
[Security advisory](/topics/security-advisory)

Release
[1.8](/taxonomy/term/147)

Search

## News

[1.12.1 Released](/content/1121-released)
[1.12.0 Released](/content/1120-released)
[1.11.19 Released](/content/11119-released)
[1.11.18 Released](/content/11118-released)
[1.10.38 Released](/content/11038-released)

[Subscribe to News](https://ledgersmb.org/news.xml)

## Recent content

* [1.13 Release notes](/content/113-release-notes)
* [Community overview 2024](/content/community-overview-2024)
* [Documentation](/content/documentation)
* [Installing LedgerSMB 1.11](/index.php/content/installing-ledgersmb-111)
* [Roadmap](/content/roadmap)

[Subscribe to Recent content](https://ledgersmb.org/recent.xml)

## Book navigation

* [Technical documentation](/content/technical-documentation)

* [Community guide](/content/community-guide)

## User login

Username

Password

* [Create new account](/user/register "Create a new user account.")
* [Reset your password](/user/password "Send password reset instructions via email.")

## Tools

[Show — Tools](#show-block-lsmb-bartik-tools)
[Hide — Tools](#hide-block-lsmb-bartik-tools)

* [Sitemap](/sitemap)
* [Sources](/aggregator/sources)
* [Aggregator](/aggregator)

## FAQ Categories

* [Installation](/faq?field_faq_category_target_id=2)
* [Localization / Internationalization](/faq?field_faq_category_target_id=51)
* [Contributing](/faq?field_faq_category_target_id=52)
* [Administration](/faq?field_faq_category_target_id=53)
* [Integration](/faq?field_faq_category_target_id=54)
* [Accounting](/faq?field_faq_category_target_id=64)
* [Support](/faq?field_faq_category_target_id=66)

## Transifex translations

[Top translations: ledgersmb » LedgerSMB

![](https://www.transifex.com/_/charts/redirects/ledgersmb/ledgersmb/image_png/LedgerSMB/)](https://www.transifex.com/ledgersmb/ledgersmb/ "See more information on Transifex.com")

[![](https://ds0k0en9abmn1.cloudfront.net/static/charts/images/tx-logo-micro.646b0065fce6.png)](https://www.transifex.com/ledgersmb/ledgersmb/)

## Random FAQs

* [How can I login to several companies with one user?](/faq/installation/how-can-i-login-several-companies-one-user)
* [How do I fix out-of-balance overpayments?](/faq/how-do-i-fix-out-balance-overpayments)
* [Can I use IBANs with LedgerSMB?](/faq/can-i-use-ibans-ledgersmb)
* [Is there a way to attach an online store to LedgerSMB?](/faq/there-way-attach-online-store-ledgersmb)
* [Can I use the webservices using curl?](/faq/can-i-use-webservices-using-curl)

[more](/faq)

## OpenHUB Stats

Content ©2007-2021 by the original authors. Site hosting and maintenance donated by [Freelock](http://www.freelock.com).



=== Content from github.com_7d49f6e4_20250114_182729.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2Fc242f5a2abf4b99b0da205473cbba034f306bfe2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2Fc242f5a2abf4b99b0da205473cbba034f306bfe2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ledgersmb%2FLedgerSMB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ledgersmb](/ledgersmb)
/
**[LedgerSMB](/ledgersmb/LedgerSMB)**
Public

* [Notifications](/login?return_to=%2Fledgersmb%2FLedgerSMB) You must be signed in to change notification settings
* [Fork
  150](/login?return_to=%2Fledgersmb%2FLedgerSMB)
* [Star
   433](/login?return_to=%2Fledgersmb%2FLedgerSMB)

* [Code](/ledgersmb/LedgerSMB)
* [Issues
  122](/ledgersmb/LedgerSMB/issues)
* [Pull requests
  0](/ledgersmb/LedgerSMB/pulls)
* [Discussions](/ledgersmb/LedgerSMB/discussions)
* [Actions](/ledgersmb/LedgerSMB/actions)
* [Projects
  13](/ledgersmb/LedgerSMB/projects)
* [Wiki](/ledgersmb/LedgerSMB/wiki)
* [Security](/ledgersmb/LedgerSMB/security)
* [Insights](/ledgersmb/LedgerSMB/pulse)

Additional navigation options

* [Code](/ledgersmb/LedgerSMB)
* [Issues](/ledgersmb/LedgerSMB/issues)
* [Pull requests](/ledgersmb/LedgerSMB/pulls)
* [Discussions](/ledgersmb/LedgerSMB/discussions)
* [Actions](/ledgersmb/LedgerSMB/actions)
* [Projects](/ledgersmb/LedgerSMB/projects)
* [Wiki](/ledgersmb/LedgerSMB/wiki)
* [Security](/ledgersmb/LedgerSMB/security)
* [Insights](/ledgersmb/LedgerSMB/pulse)

## Commit

[Permalink](/ledgersmb/LedgerSMB/commit/c242f5a2abf4b99b0da205473cbba034f306bfe2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Use HTTPS environment setting to detect https connections

[Browse files](/ledgersmb/LedgerSMB/tree/c242f5a2abf4b99b0da205473cbba034f306bfe2)
Browse the repository at this point in the history

```
the ReverseProxy module doesn't rewrite SERVER_PROTOCOL but it does
change HTTPS based on X-Forwarded-* headers.
```

* Loading branch information

[![@ehuelsmann](https://avatars.githubusercontent.com/u/2326559?s=40&v=4)](/ehuelsmann)

[ehuelsmann](/ledgersmb/LedgerSMB/commits?author=ehuelsmann "View all commits by ehuelsmann")
committed
Oct 10, 2021

1 parent
[e9d657d](/ledgersmb/LedgerSMB/commit/e9d657da8bb83532dc6e0665d7268724e78cfbf5)

commit c242f5a

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[lib/LedgerSMB/Middleware/AuthenticateSession.pm](#diff-6254e0d49272475cae4b03c241700e962e5bb8fc3ccea1e853360e25c44b7430 "lib/LedgerSMB/Middleware/AuthenticateSession.pm")

Show comments

[View file](/ledgersmb/LedgerSMB/blob/c242f5a2abf4b99b0da205473cbba034f306bfe2/lib/LedgerSMB/Middleware/AuthenticateSession.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -209,7 +209,7 @@ sub call { |
|  |  | $dbh->rollback; |
|  |  | $dbh->disconnect; |
|  |  |  |
|  |  | my $secure = ($env->{SERVER\_PROTOCOL} eq 'https') ? '; Secure' : ''; |
|  |  | my $secure = ($env->{HTTPS} eq 'ON') ? '; Secure' : ''; |
|  |  | my $path = LedgerSMB::PSGI::Util::cookie\_path($env->{SCRIPT\_NAME}); |
|  |  | return Plack::Util::response\_cb( |
|  |  | $res, sub { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c242f5a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2Fc242f5a2abf4b99b0da205473cbba034f306bfe2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from huntr.dev_f0eaf026_20250114_182729.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by [Protect AI](https://protectai.com/) and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)
