Based on the provided information, here's an analysis of CVE-2021-3590:

**Root cause of vulnerability:**
- The vulnerability stems from a flaw in the Foreman project, specifically within the Azure Compute Profile functionality. The Azure Compute Profile password was exposed through the JSON output of the API.

**Weaknesses/vulnerabilities present:**
- **Credential Leak:** The primary weakness is the exposure of sensitive credentials (Azure Compute Profile password) within the API's JSON output.

**Impact of exploitation:**
- **Data Confidentiality and Integrity:** The exposure of the Azure Compute Profile password can lead to unauthorized access and potential manipulation of resources.
- **System Availability:** Compromise of credentials can lead to service disruption or denial of service attacks.

**Attack vectors:**
- **API Access:** The vulnerability is accessible through the Foreman API.
- **Authenticated Users:**  Authenticated users with the "view_compute_profiles" permission can access the leaked credentials.

**Required attacker capabilities/position:**
- **Authentication:** Attackers must be authenticated users with the "view_compute_profiles" permission.
- **API Access:**  The attacker must be able to make requests to the Foreman API.

**Additional Details:**
- The vulnerability was introduced in Foreman version 1.6.0 with the introduction of the compute profiles v2 API.
- The bug report indicates a dependency on bug 1969259 and blocks bugs 1958870 and 1969838.