=== Content from www.debian.org_d6e2f3a6_20250114_185520.html ===


---

[[Date Prev](msg00145.html)][[Date Next](msg00147.html)]
[[Thread Prev](msg00145.html)][[Thread Next](msg00147.html)]
[[Date Index](maillist.html#00146)]
[[Thread Index](threads.html#00146)]

# [SECURITY] [DSA 4962-1] ledgersmb security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4962-1] ledgersmb security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 23 Aug 2021 19:23:23 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20210823192323.GA15242%40seger.debian.org)Â [20210823192323.GA15242@seger.debian.org](msg00146.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4962-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
August 23, 2021                       <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ledgersmb
CVE ID         : CVE-2021-3731 CVE-2021-3693 CVE-2021-3694

Several vulnerabilities were discovered in LedgerSMB, a financial
accounting and ERP program, which could result in cross-site scripting
or clickjacking.

For the oldstable distribution (buster), this problem has been fixed
in version 1.6.9+ds-1+deb10u2.

For the stable distribution (bullseye), this problem has been fixed in
version 1.6.9+ds-2+deb11u2.

We recommend that you upgrade your ledgersmb packages.

For the detailed security status of ledgersmb please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ledgersmb>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmEj9N0ACgkQEMKTtsN8
TjYA/RAAtBkVMeus8egb1BF7IZEp8ZZM/AudI8m0lWqX/TsLyxR77yQXzPT4LEMv
lmQJ1T+Le7L4D+XmLtAmg2p5FfPAI5THZOdZSk06OnSEty4xzt+MNMgf5VkssqWX
wC9IWFrkpVk+xUJ3SKWO2ZgSnW7abV6jjT1qZqCcfKlImtLV69lOCvFfZ2fjmE5Z
vuxTRlXSZ9bKdhfEO90NJ4ALJMZVyFRBrxAc8VmRqkDV2dQADRM3U3eLQZqzEibw
UPbVczpjPo6Gj6MCSFqdtQmnHyg4U2yOcDHNQM14t4MHb889MgFHlbFrTdRR70wV
Vd4Uj+RMH15qIm9uQBJT1WMksEpzR5PV2HZXI3VTT86CDNxo89MXgAiGX8cH9LZH
wwz3Dj/KZqPvy3x5iL0UDLnijt2P7MM+68jUPZCNevcP5wgCeC0vnvgIQ8Hpmv/a
8mfdz1zsBJX/asOAs2UwZM/GMkRAaW/PPX7X9kL/Ft5UNbTmXiBZkqYc74LbkIZJ
8ZSo3RFAjsnkW1W+GOJ9fGGOmBFn3Aa/wAHUF/Sc/xQygXyEaNKDiJTih0xoFvlb
LSKMoMu0+ULmblpuagLCjrmCBrdRIYTJsSD/fsRJLwAyYk4zquP51Ir3I/1Ncvx9
4W3/qxvGy9cuOZCT3eK8NQnzqrTB//G0MBvA+9TkZn9+LgvpUqw=
=AAl/
-----END PGP SIGNATURE-----

```

---



=== Content from ledgersmb.org_0f9dd4e3_20250114_185518.html ===

[Skip to main content](#main-content)
[![Home](/sites/default/files/ledgersmb.png)](/)
[LedgerSMB](/)

The foundation for your business

## Main navigation

[Show â€” Main navigation](#show-block-lsmb-bartik-mainnavigation-5)
[Hide â€” Main navigation](#hide-block-lsmb-bartik-mainnavigation-5)

* [Home](/content/open-source-erp-accounting-invoicing-and-more)
* [Features](/content/features)
* [Download](/content/download "LedgerSMB Downloads")
* [Documentation](/content/documentation)
* [FAQ](/faq)
* [Community](/content/community-guide)
* [Support](/topics/support)
* [Testimonials](/testimonials)
* [Demo](/content/demo)

## Breadcrumb

1. [Home](/)

# Security advisory for CVE-2021-3694 (Cross site scripting)

Submitted by ehu
on Fri, 08/20/2021 - 03:13

# Reflected cross-site scripting of authenticated users in LedgerSMB

## Summary

LedgerSMB does not sufficiently HTML-encode error messages sent to the browser.Â  By sending a specially crafted URL to an authenticated user, this flaw can be abused for remote code execution and information disclosure.

## Known vulnerable

All of:

- 1.1.0 upto 1.1.12 (including)

Â  - 1.2.0 upto 1.2.26 (including)

Â  - 1.3.0 upto 1.3.47 (including)

Â  - 1.4.0 upto 1.4.42 (including)

Â  - 1.5.0 upto 1.5.30 (including)

Â  - 1.6.0 upto 1.6.33 (including)

Â  - 1.7.0 upto 1.7.32 (including)

Â  - 1.8.0 upto 1.8.17 (including)

## Known fixed

- 1.7.33

Â  - 1.8.18

## Details

When encountering an error, LedgerSMB sends the user feedback which may

Â  include user-provided input.Â  This input was not sufficiently sanitized

Â  before being included in the error report.Â  This allows an attacker inject

Â  a script in the error response page by send a specially crafted URL to an

Â  authenticated user.Â  As the error page itself does not contain any sensitive

Â  information, a sophisticated payload in addition to targetting a sufficiently

Â  privileged user, is required for information disclosure.

Proper audit control and separation of duties limit Integrity impact of

Â  the attack vector.

The vulnerable code to provide this user-feedback dates back to version 1.0.

Â  Please note that not error messages are vulnerable to this attack as not all

Â  messages report the problematic input to the user.

## Severity

CVSSv3.1 Base Score: 8.2 (High)

CVSSv3.1 Vector: AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N

## Recommendations

We recommend all users to upgrade to known-fixed versions. Versions prior

Â  to 1.7 are end-of-life and will not receive security fixes from the

Â  LedgerSMB project.

Users who cannot upgrade, may apply the included patches or are advised

Â  to contact a vendor for custom support.

There are no workarounds available for this vulnerability.

## References

 [CVE-2021-3694Â  (LedgerSMB)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3694)

<https://ledgersmb.org/cve-2021-3694-cross-site-scripting>

<https://huntr.dev/bounties/ef7f4cf7-3a81-4516-b261-f5b6ac21430c/>

## Reported by

[ranjit-git, user of the huntr.dev platform](https://huntr.dev/users/ranjit-git/)

Attachments
File
 [1.7-cve-2021-3694.patch\_.txt](/index.php/sites/default/files/2021-08/1.7-cve-2021-3694.patch_.txt)

File
 [1.8-cve-2021-3694.patch\_.txt](/index.php/sites/default/files/2021-08/1.8-cve-2021-3694.patch_.txt)

Topic
[Security advisory](/topics/security-advisory)

Release
[1.0](/release/10)
[1.1](/release/11)
[1.2](/release/12)
[1.3](/release/13)
[1.4](/release/14)
[1.5](/release/15)
[1.6](/taxonomy/term/142)
[1.7](/taxonomy/term/146)
[1.8](/taxonomy/term/147)

Search

## News

[1.12.1 Released](/content/1121-released)
[1.12.0 Released](/content/1120-released)
[1.11.19 Released](/content/11119-released)
[1.11.18 Released](/content/11118-released)
[1.10.38 Released](/content/11038-released)

[Subscribe to News](https://ledgersmb.org/news.xml)

## Recent content

* [1.13 Release notes](/content/113-release-notes)
* [Community overview 2024](/content/community-overview-2024)
* [Documentation](/content/documentation)
* [Installing LedgerSMB 1.11](/index.php/content/installing-ledgersmb-111)
* [Roadmap](/content/roadmap)

[Subscribe to Recent content](https://ledgersmb.org/recent.xml)

## Book navigation

* [Technical documentation](/content/technical-documentation)

* [Community guide](/content/community-guide)

## User login

Username

Password

* [Create new account](/user/register "Create a new user account.")
* [Reset your password](/user/password "Send password reset instructions via email.")

## Tools

[Show â€” Tools](#show-block-lsmb-bartik-tools)
[Hide â€” Tools](#hide-block-lsmb-bartik-tools)

* [Sitemap](/sitemap)
* [Sources](/aggregator/sources)
* [Aggregator](/aggregator)

## FAQ Categories

* [Installation](/faq?field_faq_category_target_id=2)
* [Localization / Internationalization](/faq?field_faq_category_target_id=51)
* [Contributing](/faq?field_faq_category_target_id=52)
* [Administration](/faq?field_faq_category_target_id=53)
* [Integration](/faq?field_faq_category_target_id=54)
* [Accounting](/faq?field_faq_category_target_id=64)
* [Support](/faq?field_faq_category_target_id=66)

## Transifex translations

[Top translations: ledgersmb Â» LedgerSMB

![](https://www.transifex.com/_/charts/redirects/ledgersmb/ledgersmb/image_png/LedgerSMB/)](https://www.transifex.com/ledgersmb/ledgersmb/ "See more information on Transifex.com")

[![](https://ds0k0en9abmn1.cloudfront.net/static/charts/images/tx-logo-micro.646b0065fce6.png)](https://www.transifex.com/ledgersmb/ledgersmb/)

## Random FAQs

* [How can I login to several companies with one user?](/faq/installation/how-can-i-login-several-companies-one-user)
* [How do I fix out-of-balance overpayments?](/faq/how-do-i-fix-out-balance-overpayments)
* [Can I use IBANs with LedgerSMB?](/faq/can-i-use-ibans-ledgersmb)
* [Is there a way to attach an online store to LedgerSMB?](/faq/there-way-attach-online-store-ledgersmb)
* [Can I use the webservices using curl?](/faq/can-i-use-webservices-using-curl)

[more](/faq)

## OpenHUB Stats

Content Â©2007-2021 by the original authors. Site hosting and maintenance donated by [Freelock](http://www.freelock.com).



=== Content from github.com_1661a4f5_20250114_185514.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2F98fa476d46a4a7e5e9492ed69b4fa190be5547fc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2F98fa476d46a4a7e5e9492ed69b4fa190be5547fc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ledgersmb%2FLedgerSMB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ledgersmb](/ledgersmb)
/
**[LedgerSMB](/ledgersmb/LedgerSMB)**
Public

* [Notifications](/login?return_to=%2Fledgersmb%2FLedgerSMB) You must be signed in to change notification settings
* [Fork
  150](/login?return_to=%2Fledgersmb%2FLedgerSMB)
* [Star
   433](/login?return_to=%2Fledgersmb%2FLedgerSMB)

* [Code](/ledgersmb/LedgerSMB)
* [Issues
  122](/ledgersmb/LedgerSMB/issues)
* [Pull requests
  0](/ledgersmb/LedgerSMB/pulls)
* [Discussions](/ledgersmb/LedgerSMB/discussions)
* [Actions](/ledgersmb/LedgerSMB/actions)
* [Projects
  13](/ledgersmb/LedgerSMB/projects)
* [Wiki](/ledgersmb/LedgerSMB/wiki)
* [Security](/ledgersmb/LedgerSMB/security)
* [Insights](/ledgersmb/LedgerSMB/pulse)

Additional navigation options

* [Code](/ledgersmb/LedgerSMB)
* [Issues](/ledgersmb/LedgerSMB/issues)
* [Pull requests](/ledgersmb/LedgerSMB/pulls)
* [Discussions](/ledgersmb/LedgerSMB/discussions)
* [Actions](/ledgersmb/LedgerSMB/actions)
* [Projects](/ledgersmb/LedgerSMB/projects)
* [Wiki](/ledgersmb/LedgerSMB/wiki)
* [Security](/ledgersmb/LedgerSMB/security)
* [Insights](/ledgersmb/LedgerSMB/pulse)

## Commit

[Permalink](/ledgersmb/LedgerSMB/commit/98fa476d46a4a7e5e9492ed69b4fa190be5547fc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#5744](https://github.com/ledgersmb/LedgerSMB/pull/5744) from ledgersmb/html-escape-error-messages

[Browse files](/ledgersmb/LedgerSMB/tree/98fa476d46a4a7e5e9492ed69b4fa190be5547fc)
Browse the repository at this point in the history

```
Html escape error messages
```

* Loading branch information

[![@ehuelsmann](https://avatars.githubusercontent.com/u/2326559?s=40&v=4)](/ehuelsmann)

[ehuelsmann](/ledgersmb/LedgerSMB/commits?author=ehuelsmann "View all commits by ehuelsmann")
authored
Aug 6, 2021

2 parents
[2a818cd](/ledgersmb/LedgerSMB/commit/2a818cd42cf4a106af051c59cd112c8a4003dd3c)
+
[555eb1d](/ledgersmb/LedgerSMB/commit/555eb1d019fca296db73a8b7a97eb1efa5e5befc)

commit 98fa476

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**8 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/LedgerSMB/PSGI

  + lib/LedgerSMB/PSGI/Util.pm
    [Util.pm](#diff-fd9ad383913347c730e5ae372f8e5348fda3ef6fda26d2e6be1098c99c727213)
* old/lib/LedgerSMB

  + old/lib/LedgerSMB/oldHandler.pm
    [oldHandler.pm](#diff-7c645e30164d08165892e57520ed3328feb7da89e259df80940f008e08c924a7)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[lib/LedgerSMB/PSGI/Util.pm](#diff-fd9ad383913347c730e5ae372f8e5348fda3ef6fda26d2e6be1098c99c727213 "lib/LedgerSMB/PSGI/Util.pm")

Show comments

[View file](/ledgersmb/LedgerSMB/blob/98fa476d46a4a7e5e9492ed69b4fa190be5547fc/lib/LedgerSMB/PSGI/Util.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,7 @@ use strict; |
|  |  | use warnings; |
|  |  |  |
|  |  | use Carp; |
|  |  | use HTML::Escape; |
|  |  | use HTTP::Status qw( HTTP\_OK HTTP\_INTERNAL\_SERVER\_ERROR HTTP\_SEE\_OTHER |
|  |  | HTTP\_BAD\_REQUEST ); |
|  |  |  |
| Expand All | | @@ -41,7 +42,7 @@ Returns a standard error representation for HTTP status 500 |
|  |  |  |
|  |  |  |
|  |  | sub internal\_server\_error { |
|  |  | my ($msg, $title, $company, $dbversion) = @\_; |
|  |  | my ($msg, $title, $company, $dbversion) = map { escape\_html($\_ // '') } @\_; |
|  |  |  |
|  |  | $title //= 'Error!'; |
|  |  | $msg =~ s/\n/<br>/g; |
| Expand Down | |  |

8 changes: 6 additions & 2 deletions

8
[old/lib/LedgerSMB/oldHandler.pm](#diff-7c645e30164d08165892e57520ed3328feb7da89e259df80940f008e08c924a7 "old/lib/LedgerSMB/oldHandler.pm")

Show comments

[View file](/ledgersmb/LedgerSMB/blob/98fa476d46a4a7e5e9492ed69b4fa190be5547fc/old/lib/LedgerSMB/oldHandler.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,6 +57,7 @@ use LedgerSMB::Sysconfig; |
|  |  |  |
|  |  | use Cookie::Baker; |
|  |  | use Digest::MD5; |
|  |  | use HTML::Escape; |
|  |  | use Log::Log4perl; |
|  |  | use Feature::Compat::Try; |
|  |  |  |
| Expand Down  Expand Up | | @@ -183,14 +184,17 @@ sub handle { |
|  |  | sub \_error { |
|  |  | my ($form, $msg, $status) = @\_; |
|  |  | $msg = "? \_error" if !defined $msg; |
|  |  | my $html\_msg = escape\_html($msg); |
|  |  | my $html\_dbversion = escape\_html($form->{dbversion}); |
|  |  | my $html\_company = escape\_html($form->{company}); |
|  |  | $status = 500 if ! defined $status; |
|  |  |  |
|  |  | print qq|Status: $status ISE |
|  |  | Content-Type: text/html; charset=utf-8 |
|  |  |  |
|  |  | <html> |
|  |  | <body><h2 class="error">Error!</h2> <p><b>$msg</b></p> |
|  |  | <p>dbversion: $form->{dbversion}, company: $form->{company}</p> |
|  |  | <body><h2 class="error">Error!</h2> <p><b>$html\_msg</b></p> |
|  |  | <p>dbversion: $html\_dbversion, company: $html\_company</p> |
|  |  | </body> |
|  |  | </html> |
|  |  | |; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `98fa476`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fledgersmb%2Fledgersmb%2Fcommit%2F98fa476d46a4a7e5e9492ed69b4fa190be5547fc) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from huntr.dev_8519b6da_20250114_185516.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported byÂ [Protect AI](https://protectai.com/)Â and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

Â© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)
