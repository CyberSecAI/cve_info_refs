```json
{
  "CVE-2021-35065": {
    "Metadata": {
      "source": "Multiple",
      "cve_id": "CVE-2021-35065",
      "description": "glob-parent 6.0.0 is vulnerable to Regular Expression Denial of Service (ReDoS). This issue is fixed in version 6.0.1."
    },
    "vulnerability_details": {
      "root_cause": "The vulnerability is due to a regular expression used in the `enclosure` variable within the `glob-parent` library. This regex can lead to catastrophic backtracking when processing specific input strings, causing a denial of service.",
      "weaknesses": [
        "Regular Expression Denial of Service (ReDoS)",
         "CWE-400",
         "CWE-1333"
      ],
      "impact": "A successful attack could cause excessive consumption of CPU resources on the vulnerable system, leading to denial of service.",
       "attack_vectors": [
        "Network"
      ],
     "required_capabilities": "An attacker can trigger the vulnerability by sending crafted input strings to the vulnerable regex. No specific privileges or user interaction is required."
    },
    "Affected_components": {
      "affected_package": "glob-parent",
      "affected_versions": ">=6.0.0, < 6.0.1",
       "fixed_versions": [
        "6.0.1"
        ]
     },
    "additional_details": {
      "performance_test_code_before_fix": "```\nconst { performance } = require(\"perf_hooks\")\nconst globParent = require(\"glob-parent\")\n\nconst measure = fn => {\n  let s = performance.now();\n  fn();\n  return performance.now() - s;\n};\n\nfor (const n of [5_000, 10_000, 20_000, 40_000, 80_000, 160_000]) {\n  const input = \"{\" + \"/\".repeat(n);\n  const time = measure(() => globParent(input));\n\n // if the runtime is O(n^2), then this ration will be roughly constant\n  const ration = time / (n * n);\n\n  console.log(`${n}:\\t${time}ms\\t${ration.toExponential(3)}`);\n}\n```",
      "performance_test_results_before_fix": "```\n% node -v v14.15.0\n% npm -v 6.14.8\n% node perf_test.js\n\n5000: 32.4567289352417ms  1.298e-6\n10000:  103.04731607437134ms  1.030e-6\n20000:  382.97598814964294ms  9.574e-7\n40000:  1525.007022857666ms 9.531e-7\n80000:  6095.382986068726ms 9.524e-7\n160000: 24153.12740111351ms 9.435e-7\n%\n```",
       "performance_test_results_after_fix": "```\n% node -v v14.15.0\n% npm -v 6.14.8\n% node perf_test.js\n\n5000: 0.7545621395111084ms  3.018e-8\n10000:  5.009187936782837ms 5.009e-8\n20000:  2.1224639415740967ms  5.306e-9\n40000:  0.5203690528869629ms  3.252e-10\n80000:  1.0246939659118652ms  1.601e-10\n160000: 2.1865968704223633ms  8.541e-11\n```",
      "patch_diff": "```diff\n--- a/index.js\n+++ b/index.js\n@@ -6,7 +6,6 @@ var isWin32 = require('os').platform() === 'win32';\n \n var slash = '/';\n var backslash = /\\\\/g;\n-var enclosure = /[{[].*\\/.*[}\\]]$/;\n var globby = /(^|[^\\])([{[]|\\([^)]+$)/;\n var escaped = /\\\\([!\\*?|[\\](){}]/g;\n \n@@ -24,7 +23,7 @@ module.exports = function globParent(str, opts) {\n }\n \n // special case for strings ending in enclosure containing path separator\n-if (enclosure.test(str)) {\n+if (isEnclosure(str)) {\n  str += slash;\n }\n \n@@ -39,3 +38,27 @@ module.exports = function globParent(str, opts) {\n  // remove escape chars and return result\n  return str.replace(escaped, '$1');\n };\n \n+\n+function isEnclosure(str) {\n+  var lastChar = str.slice(-1)\n+\n+  var enclosureStart;\n+  switch (lastChar) {\n+  case '}':\n+ enclosureStart = '{';\n+   break;\n+  case ']':\n+ enclosureStart = '[';\n+  break;\n+  default:\n+    return false;\n+  }\n+ \n+  var foundIndex = str.indexOf(enclosureStart);\n+  if (foundIndex < 0) {\n+  return false;\n+  }\n+\n+  return str.slice(foundIndex + 1, -1).includes(slash);\n+}\n```",
      "redos_regex": "/[[{[][^/\r\n\u2028\u2029]*\/.*[}\]]$/",
       "redos_input":"'{'.repeat(n) + '/'.repeat(n) or '{'.repeat(n) or '('.repeat(n)",
       "notes": [
        "The vulnerability is separate from GHSA-ww39-953v-wcq6.",
           "The regex `/(^|[^\\])([{[]|\([^)]+$)/` is also mentioned as having a similar problem but was determined to not be vulnerable.",
           "Newlines are valid path elements in many file systems."
        ]
    },
        "cvss_v3.1_metrics": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
}
```