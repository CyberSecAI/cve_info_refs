=== Content from sec.cloudapps.cisco.com_af48fb9a_20250115_120019.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryVulnerabilities in Layer 2 Network Security Controls Affecting Cisco Products: September 2022 Medium   Advisory ID:  cisco-sa-VU855201-J3z8CKTX  First Published: 2022 September 27 16:00 GMT  Last Updated:  2022 October 5 18:16 GMT  Version 1.1:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154)  [CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743)  [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758)  More...  ,[CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154),[CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743),[CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758),[CSCvx35085](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085),[CSCvx35087](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087),[CSCvx37987](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx37987),[CSCvz88705](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705),[CSCvz89602](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602),[CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291),[CSCvz96133](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133),[CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097),[CSCwa04809](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809),[CSCwa06145](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145),[CSCwa06265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265),[CSCwa09081](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081),[CSCwa14271](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271),[CSCwa14282](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282),[CSCwa14942](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942),[CSCwa14950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950),[CSCwa18093](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093),[CSCwa18209](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209),[CSCwa18310](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310),[CSCwb01481](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481)   CVE-2021-27853 CVE-2021-27854 CVE-2021-27861  More...     CVE-2021-27853,CVE-2021-27854,CVE-2021-27861,CVE-2021-27862  CWE-284       CVSS Score: [Base 4.7](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2021-27853 CVE-2021-27854 CVE-2021-27861  More...     CVE-2021-27853,CVE-2021-27854,CVE-2021-27861,CVE-2021-27862  CWE-284       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX/csaf/cisco-sa-VU855201-J3z8CKTX.json)   Email      Summary  * On September 27, 2022, the following vulnerabilities affecting Cisco products were disclosed by Cert/CC as part of VU855201, titled  [L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers](https://kb.cert.org/vuls/id/855201):    + CVE-2021-27853: Layer 2 network filtering capabilities such as IPv6 RA guard or ARP inspection can be bypassed using a combination of VLAN 0 headers and LLC/SNAP headers.   + CVE-2021-27854: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using a combination of VLAN 0 headers, LLC/SNAP headers in Ethernet to Wifi frame translation, and in the reverse-Wifi to Ethernet.   + CVE-2021-27861: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length (and optionally VLAN0 headers).   + CVE-2021-27862: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length and Ethernet to Wifi frame conversion (and optionally VLAN0 headers). Exploitation of these vulnerabilities could allow an adjacent attacker to bypass configured first-hop security (FHS) features on the affected Cisco products.  For more information about these vulnerabilities, see the [Details](#details) section of this advisory.  This advisory is available at the following link: <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX>  Affected Products  * The [Vulnerable Products](#vp) section includes Cisco bug IDs for each affected product. The bugs are accessible through the [Cisco Bug Search Tool](https://bst.cloudapps.cisco.com/bugsearch/bug/BUGID) and will contain additional platform-specific information, including workarounds (if available) and fixed software releases (if available).  Any product or service not listed in the [Vulnerable Products](#vp) section of this advisory is to be considered not vulnerable.    Vulnerable ProductsCVE-2021-27853 The following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27853. See the [Details](#details) section of this advisory for more information about affected configurations.  **Note:** End of life products have not been evaluated.       | Cisco Product | Cisco Bug ID | Additional Information |   | --- | --- | --- |   | Cisco IOS Software - Switches | | |   | Catalyst 6500 and 6800 Series Switches | [CSCwa06145](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145) | Fixed software will not be made available. |   | Catalyst Digital Building Series Switches | [CSCwa14942](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942) | Fixed software will not be made available. |   | Industrial Ethernet Switches | [CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743) | Fixed software will not be made available. |   | Micro Switches | [CSCwa14271](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271) | Fixed software will not be made available. |   | Cisco IOS XE Software - Switches | | |   | Catalyst 4500 IOS-XE Switches | [CSCwa18093](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093) | Fixed software will not be made available. |   | IOS XE Switches | [CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291)[CSCwb01481](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481) | CSCvz91291 affects Cisco IOS XE Software releases 17.6.1 and later. A fix is available for all FHS features except Dynamic ARP inspection.CSCwb01481 is relevant for Dynamic ARP Inspection and impacts all releases. Fixed Software will not be made available. |   | Cisco IOS XE Software - Routers | | |   | IOS XE Routers configured with Ethernet virtual circuits | [CSCvz96133](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133) | Fixed software will not be made available. |   | Cisco IOS XR Software | | |   | IOS XR Routers configured with L2 Transport services | [CSCvz88705](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705)[CSCvz89602](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602) | Fixed software will not be made available. |   | Cisco Meraki - Switches | | |   | MS390 | N/A | Impact is only for Dynamic ARP Inspection. Fixed software will not be made available. |   | MS210MS225MS250MS350MS355MS410MS420MS425MS450 | N/A | Fixed software will not be made available. |   | Cisco NX-OS Software | | |   | Nexus 3000 Series Switches | [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758) | Fixed software will not be made available. |   | Nexus 5500 Platform SwitchesNexus 5600 Platform SwitchesNexus 6000 Series Switches | [CSCvx35087](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087) | Fixed software will not be made available. |   | Nexus 7000 Series Switches | [CSCvx35085](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085) | Fixed software will not be made available. |   | Nexus 9000 Series Switches (Standalone Mode) | [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758) | Fixed software will not be made available. |   | Cisco Small Business Switches | | |   | 250 Series Smart Switches350 Series Managed Switches350X Series Stackable Managed Switches550X Series Stackable Managed SwitchesBusiness 250 Series Smart SwitchesBusiness 350 Series Managed Switches | [CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154) | Fixed software will not be made available. |      CVE-2021-27854 **Cisco Access Points**  Cisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access Points. No impact was observed.  As part of the investigation into the impact to Cisco Access Points, another vulnerability was found, and a companion advisory has been published: [Cisco Access Points VLAN Bypass from Native VLAN Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY). CVE-2021-27861 The following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27861. See the [Details](#details) section of this advisory for more information about affected configurations.  **Note**: End of life products have not been evaluated.       | Cisco Product | Cisco Bug ID | Additional Information |   | --- | --- | --- |   | Cisco IOS Software - Switches | | |   | Catalyst 6500 and 6800 Series Switches | [CSCwa06265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265) | Fixed software will not be made available. |   | Catalyst Digital Building Series Switches | [CSCwa14950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950) | Fixed software will not be made available. |   | Micro Switches | [CSCwa14282](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282) | Fixed software will not be made available. |   | Cisco IOS XR Software | | |   | IOS XR Routers configured with L2 Transport services | [CSCwa04809](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809) | Fixed software will not be made available. |   | Cisco Meraki - Switches | | |   | MS210MS225MS250MS350MS355MS410MS420MS425MS450 | N/A | Fixed software will not be made available. |   | Cisco NX-OS Software | | |   | Nexus 3000 Series Switches | [CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097) | Fixed software will not be made available. |   | Nexus 5500 Platform SwitchesNexus 5600 Platform SwitchesNexus 6000 Series Switches | [CSCwa18209](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209) | Fixed software will not be made available. |   | Nexus 7000 Series Switches | [CSCwa18310](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310) | Fixed software will not be made available. |   | Nexus 9000 Series Switches (Standalone Mode) | [CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097) | Fixed software will not be made available. |   | Cisco Small Business Switches | | |   | 250 Series Smart Switches350 Series Managed Switches350X Series Stackable Managed Switches550X Series Stackable Managed SwitchesBusiness 250 Series Smart SwitchesBusiness 350 Series Managed Switches | [CSCwa09081](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081) | Fixed software will not be made available. |      CVE-2021-27862 Cisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access points. No impact was observed. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability. CVE-2021-27853 Cisco has confirmed that this vulnerability does not affect the following Cisco products:  **ONT Switches**    + Catalyst PON Series Switches **IOS Switches**    + Catalyst 1000 Series Switches **IOS XE Platforms**    + Catalyst 8000 Series Edge Platforms **NX-OS Software**    + MDS 9000 Series Multilayer Switches   + Nexus 1000V Series Switches   + Nexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode   + UCS 6x00 Series Fabric Interconnects **Meraki Switches**    + GS110 Switches   + MS22 Switches   + MS42 Switches   + MS120 Switches   + MS125 Switches   + MS220 Switches   + MS320 SwitchesCVE-2021-27854 Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Access Points   + AireOS Access Points   + Meraki Access PointsCVE-2021-27861 Cisco has confirmed that this vulnerability does not affect the following Cisco products:  **ONT Switches**    + Catalyst PON Series Switches **IOS Switches**    + Catalyst 1000 Series Switches   + Industrial Ethernet Switches **IOS XE Routers**    + IOS XE Routers when configured with Ethernet virtual circuits **IOS XE Software Switches**    + Catalyst 3650 Series Switches   + Catalyst 3850 Series Switches   + Catalyst 4500E and 4500X Series Switches   + Catalyst 9000 Series Switches **Meraki Switches**    + GS110 Switches   + MS22 Switches   + MS42 Switches   + MS120 Switches   + MS125 Switches   + MS220 Switches   + MS320 Switches   + MS390 Switches **NX-OS Software**    + MDS 9000 Series Multilayer Switches   + Nexus 1000V Series Switches   + Nexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode   + UCS 6x00 Series Fabric InterconnectsCVE-2021-27862 Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Access Points   + AireOS Access Points   + Meraki Access Points  Details  * The vulnerabilities are not dependent on one another. Exploitation of one of the vulnerabilities is not required to exploit another vulnerability. In addition, a software release that is affected by one of the vulnerabilities may not be affected by the other vulnerabilities. CVE-2021-27853 A vulnerability in the processing of stacked Ethernet tag headers of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.  This vulnerability is due to the platforms forwarding frames when the upper-layer protocol cannot be determined to invoke a Layer 3 FHS feature. An attacker could exploit this vulnerability by sending packets with stacked VLAN Ethernet headers. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.  Cisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability.  CVE ID: CVE-2021-27853Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N  **CVE-2021-27853: Additional Details**  The IEEE Std 802.1Q-2018 standard incorporates a priority-tagged frame whose tag header carries priority information but no VLAN identification information. The VLAN identifier is set to 0 and is typically carried in a single 802.1Q header between the source MAC address and the **Ethertype/size** field.  In networks where VLAN tagging is used, there is typically a single 802.1Q header between the source MAC address and the **Ethertype/size** field. IEEE 802.1AD has double tagging and includes the S-TAG and C-TAG headers between the source MAC address and the **Ethertype/size** field.  The IEEE Std 802.1Q-2018 does not specify that there should be no more than two tags present, but Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols (determined by the **Ethertype**field), whether a packet is classified as IPv4 or IPv6, and whether it is subject to additional Layer 3 feature processing. If these things cannot be determined, the packet is forwarded based on the Layer 2 information, depending on the device configuration.  Depending on the implementation of the next device that receives the frame, the frame may be dropped as invalid or the priority tags may be removed and processed. These actions are dependent on the implementation of the receiving host operating system. CVE-2021-27853: Cisco Network Operating Systems This section provides specific details about how the different affected Cisco network operating systems handle Ethernet frames with a VLAN ID 0 tag.  **Cisco IOS Software - Switches**  By default, all of the affected Cisco IOS Switches process inbound packets with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  **Note**: Cisco IOS Switches that have reached end of life have not been evaluated by the Cisco Product Security Incident Response Team (PSIRT).  **Cisco IOS XE Software - Switches**  By default, Cisco Catalyst 4500E Series switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  The default behavior of a Cisco IOS XE Switch is to drop all traffic that has a frame header that contains a VLAN ID 0 tag. The switch only processes frames with a VLAN ID 0 tag if the access port is configured as follows:  ```   switchport voice vlan dot1p   ```  **Cisco IOS XE Software - Routers**  Cisco IOS XE devices that are configured with service instances handle the VLAN ID 0 tag in accordance with their configurations. For VLAN-based services, the top one or two tags are inspected based on configuration and map to the appropriate service instance on the longest match rules.  Service instance-based configurations that contain **encapsulation dot1q priority-tagged**, **encapsulation dot1q priority-tagged exact**, or **encapsulation default** are affected by this vulnerability.  The order of matching a service instance for VLAN ID 0 is based on **encapsulation dot1q priority-tagged** first and then **encapsulation default**. Cisco IOS XE Software does not match on **encapsulation dot1q any** for VLAN ID 0 tags.  **Cisco IOS XR Software**  Cisco IOS XR Software running on Layer 2 Transport interfaces handles a VLAN ID 0 tag in accordance with the configurations applied to the device. For port-based services, the packets are forwarded with no inspection. For VLAN-based services, either the top tag or the top two tags are inspected based on configuration and map to the appropriate attachment circuit based on the longest match rules. Fore more information, see [IOS XR L2VPN Services and Features](https://www.cisco.com/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.html#anc6).  Configurations that contain **encapsulation dot1q priority-tagged**, **encapsulation dot1q priority-tagged exact**, or **encapsulation default** on Layer 2 Transport VLAN-based configurations are affected by this vulnerability.  **Cisco NX-OS Software**  By default, Cisco NX-OS Software processes an inbound packet with the frame header containing a VLAN ID 0 tag. The initial VLAN ID 0 tag is stripped and then processed in accordance with the rest of the packet contents. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  **Cisco Small Business Switches**  By default, Cisco Small Business Switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols. CVE-2021-27854 CVE-2021-27854 examines the way frames are converted between 802.11 and 802.3 with the injection of VLAN tags in the SNAP headers.  Cisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.  CVE ID: CVE-2021-27854Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N CVE-2021-27861 A vulnerability in the Ethernet processing of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.  This vulnerability is due to insufficient validation of SNAP/LLC Ethernet frames. An attacker could exploit this vulnerability by sending packets with a crafted (or not crafted, depending on the product) SNAP/LLC Ethernet header. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.  Cisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability for some products.  CVE ID: CVE-2021-27861Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N CVE-2021-27861: Cisco Network Operating Systems This section provides specific details about how the different affected Cisco network operating systems handle SNAP/LLC Ethernet frames.  **Cisco IOS Software - Switches**  The affected Cisco IOS Software products forward SNAP/LLC frames without additional FHS feature inspection.  **Cisco IOS XR Software**  The affected Cisco IOS XR Software products forward SNAP/LLC frames without additional FHS feature inspection.  **Cisco NX-OS Software**  The affected Cisco NX-OS Software products forward SNAP/LLC frames without any additional FHS feature inspection.  **Cisco Small Business Switches**  The affected Cisco Small Business Switches correctly apply FHS features for SNAP/LLC frames with a length field of up to 1,500. However, SNAP/LLC frames with lengths of 1,501 through 1,535 are forwarded without additional FHS feature inspection. CVE-2021-27862 CVE-2021-27862 examines the way frames are converted between 802.3 to 802.11 and the length field.  Cisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.  CVE ID: CVE-2021-27862Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N  Workarounds  * There are workarounds that address some of these vulnerabilities. CVE-2021-27853 Administrators may drop packets that cannot have their **ethertype** detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.  The following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:  **Cisco IOS Software - Switches**  ```   !mac access-list extended CSCwa14271 permit any any 0x86DD 0x0 permit any any 0x800 0x0 permit any any 0x806 0x0 deny   any any!interface GigabitEthernet1/0/1 switchport access vlan 5 switchport voice vlan dot1p ipv6 nd raguard attach-policy HOSTS mac access-group CSCwa14271 in!   ```  **Cisco IOS XE Software - Switches**  For Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if **interface vlan 5** is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.  For Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.  **Cisco IOS XE Software - Routers**  For configurations that have a service instance with **encapsulation priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword **exact** after the **encapsulation priority-tagged** or filter on the **ethertype** field with **encapsulation priority-tagged etype ipv4 , ipv6**.  For environments that do not have **encapsulation priority-tagged** assigned to a service instance, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with **encapsulation priority-tagged.**  **Cisco IOS XR Software**  For configurations that have an l2transportsub interface configured with **encapsulation dot1q|dot1ad priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword **exact** after the **encapsulation dot1q|dot1ad priority-tagged.**  For environments that do not have ***e*****ncapsulation dot1q|dot1ad priority-tagged** assigned to an l2transport sub interface, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with **encapsulation dot1q priority-tagged** and **encapsulation dot1ad priority-tagged**.  **Cisco NX-OS Software**  ```   !mac access-list drop_three_tags deny any any 0x8100 deny any any 0x88a8 permit any any !interface ethernet 1/4 mac port access-group drop_three_tags!        ```  **Cisco Small Business Switches**  To ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:  ```   mac access-list extended arp-ip-ip6 permit any any 806 0000 ace-priority 1 permit any any 800 0000 ace-priority 2 permit any any 86dd 0000 ace-priority 3   ```   CVE-2021-27861 The principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.  The following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:  **Cisco IOS Software - Switches**  No mitigations or workarounds.  **Cisco IOS XR Software**  No mitigations or workarounds.  **Cisco NX-OS Software**  ```   !interface Ethernet1/3  switchport  switchport access vlan 5  mac port access-group drop_non  ipv6 nd raguard attach-policy HOSTS!interface Ethernet1/4  switchport  switchport access vlan 5  mac port access-group drop_non  ipv6 nd raguard attach-policy CSCvw92154!mac access-list drop_non  10 permit any any 0x86dd  20 permit any any ip  30 permit any any 0x806  35 permit any 0100.0ccc.cccc 0000.0000.0000  40 deny any any!   ```  **Cisco Small Business Switches**  No mitigations or workarounds.  While these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed ReleasesCVE-2021-27853 At the time of publication, the release information in the following table was accurate. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.       | Product | Cisco Bug ID | First Fixed Release |   | --- | --- | --- |   | Cisco IOS XE Switches | [CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291) | 17.6.317.8.1 |      CVE-2021-27854 Cisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed. CVE-2021-27861 At the time of publication, Cisco had not released updates that address this vulnerability for any Cisco product. CVE-2021-27862 Cisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed.  The Cisco PSIRT validates only the affected and fixed release information that is documented in this advisory.  Exploitation and Public Announcements  * The Cisco PSIRT is aware that proof-of-concept exploit code is available for the vulnerabilities that are described in this advisory.  The Cisco PSIRT is not aware of any malicious use of the vulnerabilities that are described in this advisory.  Source  * Cisco would like to thank Etienne Champetier for reporting these vulnerabilities and Cert/CC for the coordination.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.1 | Corrected affected product information. | Details | Final | 2022-OCT-05 |   | 1.0 | Initial public release. | - | Final | 2022-SEP-27 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_ef3142b9_20250115_120014.html ===
{
"document": {
"acknowledgments": [
{
"summary": "Cisco would like to thank Etienne Champetier for reporting these vulnerabilities and Cert/CC for the coordination."
}
],
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"notes": [
{
"category": "summary",
"title": "Summary",
"text": "On September 27, 2022, the following vulnerabilities affecting Cisco products were disclosed by Cert/CC as part of VU855201, titled L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers [\"https://kb.cert.org/vuls/id/855201\"]:\r\n\r\nCVE-2021-27853: Layer 2 network filtering capabilities such as IPv6 RA guard or ARP inspection can be bypassed using a combination of VLAN 0 headers and LLC/SNAP headers.\r\nCVE-2021-27854: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using a combination of VLAN 0 headers, LLC/SNAP headers in Ethernet to Wifi frame translation, and in the reverse—Wifi to Ethernet.\r\nCVE-2021-27861: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length (and optionally VLAN0 headers).\r\nCVE-2021-27862: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length and Ethernet to Wifi frame conversion (and optionally VLAN0 headers).\r\n\r\nExploitation of these vulnerabilities could allow an adjacent attacker to bypass configured first-hop security (FHS) features on the affected Cisco products.\r\n\r\nFor more information about these vulnerabilities, see the Details [\"#details\"] section of this advisory.\r\n\r\nThis advisory is available at the following link: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX [\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX\"]"
},
{
"category": "general",
"title": "Affected Products",
"text": "The Vulnerable Products [\"#vp\"] section includes Cisco bug IDs for each affected product. The bugs are accessible through the Cisco Bug Search Tool [\"https://bst.cloudapps.cisco.com/bugsearch/bug/BUGID\"] and will contain additional platform-specific information, including workarounds (if available) and fixed software releases (if available).\r\n\r\nAny product or service not listed in the Vulnerable Products [\"#vp\"] section of this advisory is to be considered not vulnerable."
},
{
"category": "general",
"title": "Vulnerable Products",
"text": "CVE-2021-27853\r\nThe following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27853. See the Details [\"#details\"] section of this advisory for more information about affected configurations.\r\n\r\nNote: End of life products have not been evaluated.\r\n Cisco Product Cisco Bug ID Additional Information Cisco IOS Software - Switches Catalyst 6500 and 6800 Series Switches CSCwa06145 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145\"] Fixed software will not be made available. Catalyst Digital Building Series Switches CSCwa14942 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942\"] Fixed software will not be made available. Industrial Ethernet Switches CSCvw99743 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743\"] Fixed software will not be made available. Micro Switches CSCwa14271 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271\"] Fixed software will not be made available. Cisco IOS XE Software - Switches Catalyst 4500 IOS-XE Switches CSCwa18093 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093\"] Fixed software will not be made available. IOS XE Switches CSCvz91291 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291\"]\r\nCSCwb01481 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481\"] CSCvz91291 affects Cisco IOS XE Software releases 17.6.1 and later. A fix is available for all FHS features except Dynamic ARP inspection.\r\n\r\nCSCwb01481 is relevant for Dynamic ARP Inspection and impacts all releases. Fixed Software will not be made available. Cisco IOS XE Software - Routers IOS XE Routers configured with Ethernet virtual circuits CSCvz96133 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133\"] Fixed software will not be made available. Cisco IOS XR Software IOS XR Routers configured with L2 Transport services CSCvz88705 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705\"]\r\nCSCvz89602 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602\"] Fixed software will not be made available. Cisco Meraki - Switches MS390 N/A Impact is only for Dynamic ARP Inspection. Fixed software will not be made available. MS210\r\nMS225\r\nMS250\r\nMS350\r\nMS355\r\nMS410\r\nMS420\r\nMS425\r\nMS450 N/A Fixed software will not be made available. Cisco NX-OS Software Nexus 3000 Series Switches CSCvx33758 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758\"] Fixed software will not be made available. Nexus 5500 Platform Switches\r\nNexus 5600 Platform Switches\r\nNexus 6000 Series Switches CSCvx35087 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087\"] Fixed software will not be made available. Nexus 7000 Series Switches CSCvx35085 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085\"] Fixed software will not be made available. Nexus 9000 Series Switches (Standalone Mode) CSCvx33758 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758\"] Fixed software will not be made available. Cisco Small Business Switches 250 Series Smart Switches\r\n350 Series Managed Switches\r\n350X Series Stackable Managed Switches\r\n550X Series Stackable Managed Switches\r\nBusiness 250 Series Smart Switches\r\nBusiness 350 Series Managed Switches CSCvw92154 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154\"] Fixed software will not be made available. CVE-2021-27854\r\nCisco Access Points\r\n\r\nCisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access Points. No impact was observed.\r\n\r\nAs part of the investigation into the impact to Cisco Access Points, another vulnerability was found, and a companion advisory has been published: Cisco Access Points VLAN Bypass from Native VLAN Vulnerability [\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY\"].\r\n CVE-2021-27861\r\nThe following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27861. See the Details [\"#details\"] section of this advisory for more information about affected configurations.\r\n\r\nNote: End of life products have not been evaluated.\r\n Cisco Product Cisco Bug ID Additional Information Cisco IOS Software - Switches Catalyst 6500 and 6800 Series Switches CSCwa06265 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265\"] Fixed software will not be made available. Catalyst Digital Building Series Switches CSCwa14950 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950\"] Fixed software will not be made available. Micro Switches CSCwa14282 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282\"] Fixed software will not be made available. Cisco IOS XR Software IOS XR Routers configured with L2 Transport services CSCwa04809 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809\"] Fixed software will not be made available. Cisco Meraki - Switches MS210\r\nMS225\r\nMS250\r\nMS350\r\nMS355\r\nMS410\r\nMS420\r\nMS425\r\nMS450 N/A Fixed software will not be made available. Cisco NX-OS Software Nexus 3000 Series Switches CSCwa01097 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097\"] Fixed software will not be made available. Nexus 5500 Platform Switches\r\nNexus 5600 Platform Switches\r\nNexus 6000 Series Switches CSCwa18209 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209\"] Fixed software will not be made available. Nexus 7000 Series Switches CSCwa18310 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310\"] Fixed software will not be made available. Nexus 9000 Series Switches (Standalone Mode) CSCwa01097 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097\"] Fixed software will not be made available. Cisco Small Business Switches 250 Series Smart Switches\r\n350 Series Managed Switches\r\n350X Series Stackable Managed Switches\r\n550X Series Stackable Managed Switches\r\nBusiness 250 Series Smart Switches\r\nBusiness 350 Series Managed Switches CSCwa09081 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081\"] Fixed software will not be made available. CVE-2021-27862\r\nCisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access points. No impact was observed."
},
{
"category": "general",
"title": "Products Confirmed Not Vulnerable",
"text": "Only products listed in the Vulnerable Products [\"#vp\"] section of this advisory are known to be affected by this vulnerability.\r\n CVE-2021-27853\r\nCisco has confirmed that this vulnerability does not affect the following Cisco products:\r\n\r\nONT Switches\r\n\r\nCatalyst PON Series Switches\r\n\r\nIOS Switches\r\n\r\nCatalyst 1000 Series Switches\r\n\r\nIOS XE Platforms\r\n\r\nCatalyst 8000 Series Edge Platforms\r\n\r\nNX-OS Software\r\n\r\n\r\nMDS 9000 Series Multilayer Switches\r\nNexus 1000V Series Switches\r\nNexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode\r\nUCS 6x00 Series Fabric Interconnects\r\n\r\nMeraki Switches\r\n\r\nGS110 Switches\r\nMS22 Switches\r\nMS42 Switches\r\nMS120 Switches\r\nMS125 Switches\r\nMS220 Switches\r\nMS320 Switches\r\n CVE-2021-27854\r\nCisco has confirmed that this vulnerability does not affect the following Cisco products:\r\n\r\nAccess Points\r\nAireOS Access Points\r\nMeraki Access Points\r\n CVE-2021-27861\r\nCisco has confirmed that this vulnerability does not affect the following Cisco products:\r\n\r\nONT Switches\r\n\r\nCatalyst PON Series Switches\r\n\r\nIOS Switches\r\n\r\nCatalyst 1000 Series Switches\r\nIndustrial Ethernet Switches\r\n\r\nIOS XE Routers\r\n\r\nIOS XE Routers when configured with Ethernet virtual circuits\r\n\r\nIOS XE Software Switches\r\n\r\nCatalyst 3650 Series Switches\r\nCatalyst 3850 Series Switches\r\nCatalyst 4500E and 4500X Series Switches\r\nCatalyst 9000 Series Switches\r\n\r\nMeraki Switches\r\n\r\nGS110 Switches\r\nMS22 Switches\r\nMS42 Switches\r\nMS120 Switches\r\nMS125 Switches\r\nMS220 Switches\r\nMS320 Switches\r\nMS390 Switches\r\n\r\nNX-OS Software\r\n\r\n\r\nMDS 9000 Series Multilayer Switches\r\nNexus 1000V Series Switches\r\nNexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode\r\nUCS 6x00 Series Fabric Interconnects\r\n CVE-2021-27862\r\nCisco has confirmed that this vulnerability does not affect the following Cisco products:\r\n\r\nAccess Points\r\nAireOS Access Points\r\nMeraki Access Points"
},
{
"category": "general",
"title": "Details",
"text": "The vulnerabilities are not dependent on one another. Exploitation of one of the vulnerabilities is not required to exploit another vulnerability. In addition, a software release that is affected by one of the vulnerabilities may not be affected by the other vulnerabilities.\r\n CVE-2021-27853\r\nA vulnerability in the processing of stacked Ethernet tag headers of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.\r\n\r\nThis vulnerability is due to the platforms forwarding frames when the upper-layer protocol cannot be determined to invoke a Layer 3 FHS feature. An attacker could exploit this vulnerability by sending packets with stacked VLAN Ethernet headers. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.\r\n\r\nCisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability.\r\n\r\nCVE ID: CVE-2021-27853\r\nSecurity Impact Rating (SIR): Medium\r\nCVSS Base Score: 4.7\r\nCVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N\r\n\r\nCVE-2021-27853: Additional Details\r\n\r\nThe IEEE Std 802.1Q-2018 standard incorporates a priority-tagged frame whose tag header carries priority information but no VLAN identification information. The VLAN identifier is set to 0 and is typically carried in a single 802.1Q header between the source MAC address and the Ethertype/size field.\r\n\r\nIn networks where VLAN tagging is used, there is typically a single 802.1Q header between the source MAC address and the Ethertype/size field. IEEE 802.1AD has double tagging and includes the S-TAG and C-TAG headers between the source MAC address and the Ethertype/size field.\r\n\r\nThe IEEE Std 802.1Q-2018 does not specify that there should be no more than two tags present, but Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols (determined by the Ethertype field), whether a packet is classified as IPv4 or IPv6, and whether it is subject to additional Layer 3 feature processing. If these things cannot be determined, the packet is forwarded based on the Layer 2 information, depending on the device configuration.\r\n\r\nDepending on the implementation of the next device that receives the frame, the frame may be dropped as invalid or the priority tags may be removed and processed. These actions are dependent on the implementation of the receiving host operating system.\r\n CVE-2021-27853: Cisco Network Operating Systems\r\nThis section provides specific details about how the different affected Cisco network operating systems handle Ethernet frames with a VLAN ID 0 tag.\r\n\r\nCisco IOS Software – Switches\r\n\r\nBy default, all of the affected Cisco IOS Switches process inbound packets with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.\r\n\r\nNote: Cisco IOS Switches that have reached end of life have not been evaluated by the Cisco Product Security Incident Response Team (PSIRT).\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nBy default, Cisco Catalyst 4500E Series switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.\r\n\r\nThe default behavior of a Cisco IOS XE Switch is to drop all traffic that has a frame header that contains a VLAN ID 0 tag. The switch only processes frames with a VLAN ID 0 tag if the access port is configured as follows:\r\n\r\n\r\nswitchport voice vlan dot1p\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nCisco IOS XE devices that are configured with service instances handle the VLAN ID 0 tag in accordance with their configurations. For VLAN-based services, the top one or two tags are inspected based on configuration and map to the appropriate service instance on the longest match rules.\r\n\r\nService instance-based configurations that contain encapsulation dot1q priority-tagged, encapsulation dot1q priority-tagged exact, or encapsulation default are affected by this vulnerability.\r\n\r\nThe order of matching a service instance for VLAN ID 0 is based on encapsulation dot1q priority-tagged first and then encapsulation default. Cisco IOS XE Software does not match on encapsulation dot1q any for VLAN ID 0 tags.\r\n\r\nCisco IOS XR Software\r\n\r\nCisco IOS XR Software running on Layer 2 Transport interfaces handles a VLAN ID 0 tag in accordance with the configurations applied to the device. For port-based services, the packets are forwarded with no inspection. For VLAN-based services, either the top tag or the top two tags are inspected based on configuration and map to the appropriate attachment circuit based on the longest match rules. Fore more information, see IOS XR L2VPN Services and Features [\"https://www.cisco.com/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.html#anc6\"].\r\n\r\nConfigurations that contain encapsulation dot1q priority-tagged, encapsulation dot1q priority-tagged exact, or encapsulation default on Layer 2 Transport VLAN-based configurations are affected by this vulnerability.\r\n\r\nCisco NX-OS Software\r\n\r\nBy default, Cisco NX-OS Software processes an inbound packet with the frame header containing a VLAN ID 0 tag. The initial VLAN ID 0 tag is stripped and then processed in accordance with the rest of the packet contents. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.\r\n\r\nCisco Small Business Switches\r\n\r\nBy default, Cisco Small Business Switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.\r\n CVE-2021-27854\r\nCVE-2021-27854 examines the way frames are converted between 802.11 and 802.3 with the injection of VLAN tags in the SNAP headers.\r\n\r\nCisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.\r\n\r\nCVE ID: CVE-2021-27854\r\nSecurity Impact Rating (SIR): Medium\r\nCVSS Base Score: 4.7\r\nCVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N\r\n CVE-2021-27861\r\nA vulnerability in the Ethernet processing of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.\r\n\r\nThis vulnerability is due to insufficient validation of SNAP/LLC Ethernet frames. An attacker could exploit this vulnerability by sending packets with a crafted (or not crafted, depending on the product) SNAP/LLC Ethernet header. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.\r\n\r\nCisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability for some products.\r\n\r\nCVE ID: CVE-2021-27861\r\nSecurity Impact Rating (SIR): Medium\r\nCVSS Base Score: 4.7\r\nCVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N\r\n CVE-2021-27861: Cisco Network Operating Systems\r\nThis section provides specific details about how the different affected Cisco network operating systems handle SNAP/LLC Ethernet frames.\r\n\r\nCisco IOS Software – Switches\r\n\r\nThe affected Cisco IOS Software products forward SNAP/LLC frames without additional FHS feature inspection.\r\n\r\nCisco IOS XR Software\r\n\r\nThe affected Cisco IOS XR Software products forward SNAP/LLC frames without additional FHS feature inspection.\r\n\r\nCisco NX-OS Software\r\n\r\nThe affected Cisco NX-OS Software products forward SNAP/LLC frames without any additional FHS feature inspection.\r\n\r\nCisco Small Business Switches\r\n\r\nThe affected Cisco Small Business Switches correctly apply FHS features for SNAP/LLC frames with a length field of up to 1,500. However, SNAP/LLC frames with lengths of 1,501 through 1,535 are forwarded without additional FHS feature inspection.\r\n CVE-2021-27862\r\nCVE-2021-27862 examines the way frames are converted between 802.3 to 802.11 and the length field.\r\n\r\nCisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.\r\n\r\nCVE ID: CVE-2021-27862\r\nSecurity Impact Rating (SIR): Medium\r\nCVSS Base Score: 4.7\r\nCVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N"
},
{
"category": "general",
"title": "Workarounds",
"text": "There are workarounds that address some of these vulnerabilities.\r\n CVE-2021-27853\r\nAdministrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\n\r\n!\r\nmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if interface vlan 5 is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nFor configurations that have a service instance with encapsulation priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword exact after the encapsulation priority-tagged or filter on the ethertype field with encapsulation priority-tagged etype ipv4 , ipv6.\r\n\r\nFor environments that do not have encapsulation priority-tagged assigned to a service instance, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with encapsulation priority-tagged.\r\n\r\nCisco IOS XR Software\r\n\r\nFor configurations that have an l2transport sub interface configured with encapsulation dot1q|dot1ad priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword exact after the encapsulation dot1q|dot1ad priority-tagged.\r\n\r\nFor environments that do not have encapsulation dot1q|dot1ad priority-tagged assigned to an l2transport sub interface, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with encapsulation dot1q priority-tagged and encapsulation dot1ad priority-tagged.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\nmac access-list drop\_three\_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop\_three\_tags\r\n!\r\n\r\n\r\nCisco Small Business Switches\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n\r\n\r\n CVE-2021-27861\r\nThe principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco IOS XR Software\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\ninterface Ethernet1/3\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy HOSTS\r\n!\r\ninterface Ethernet1/4\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy CSCvw92154\r\n!\r\nmac access-list drop\_non\r\n 10 permit any any 0x86dd\r\n 20 permit any any ip\r\n 30 permit any any 0x806\r\n 35 permit any 0100.0ccc.cccc 0000.0000.0000\r\n 40 deny any any\r\n!\r\n\r\nCisco Small Business Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nWhile these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment."
},
{
"category": "general",
"title": "Fixed Software",
"text": "When considering software upgrades [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes\"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.\r\n Fixed Releases CVE-2021-27853\r\nAt the time of publication, the release information in the following table was accurate. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.\r\n Product Cisco Bug ID First Fixed Release Cisco IOS XE Switches CSCvz91291 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291\"] 17.6.3\r\n17.8.1 CVE-2021-27854\r\nCisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed.\r\n CVE-2021-27861\r\nAt the time of publication, Cisco had not released updates that address this vulnerability for any Cisco product.\r\n CVE-2021-27862\r\nCisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed.\r\n\r\nThe Cisco PSIRT validates only the affected and fixed release information that is documented in this advisory."
},
{
"category": "general",
"title": "Vulnerability Policy",
"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco."
},
{
"category": "general",
"title": "Exploitation and Public Announcements",
"text": "The Cisco PSIRT is aware that proof-of-concept exploit code is available for the vulnerabilities that are described in this advisory.\r\n\r\nThe Cisco PSIRT is not aware of any malicious use of the vulnerabilities that are described in this advisory."
},
{
"category": "general",
"title": "Source",
"text": "Cisco would like to thank Etienne Champetier for reporting these vulnerabilities and Cert/CC for the coordination."
},
{
"category": "legal\_disclaimer",
"title": "Legal Disclaimer",
"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products."
}
],
"publisher": {
"category": "vendor",
"contact\_details": "Emergency Support:\r\n+1 877 228 7302 (toll-free within North America)\r\n+1 408 525 6532 (International direct-dial)\r\nNon-emergency Support:\r\nEmail: psirt@cisco.com\r\nSupport requests that are received via e-mail are typically acknowledged within 48 hours.",
"issuing\_authority": "Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.\r\nMore information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html",
"name": "Cisco",
"namespace": "https://wwww.cisco.com"
},
"references": [
{
"category": "self",
"summary": "Vulnerabilities in Layer 2 Network Security Controls Affecting Cisco Products: September 2022",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX"
},
{
"category": "external",
"summary": "Cisco Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
},
{
"category": "external",
"summary": "L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers",
"url": "https://kb.cert.org/vuls/id/855201"
},
{
"category": "external",
"summary": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX"
},
{
"category": "external",
"summary": "Cisco Bug Search Tool",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/BUGID"
},
{
"category": "external",
"summary": "CSCwa06145",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145"
},
{
"category": "external",
"summary": "CSCwa14942",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942"
},
{
"category": "external",
"summary": "CSCvw99743",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743"
},
{
"category": "external",
"summary": "CSCwa14271",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271"
},
{
"category": "external",
"summary": "CSCwa18093",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093"
},
{
"category": "external",
"summary": "CSCvz91291",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291"
},
{
"category": "external",
"summary": "CSCwb01481",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481"
},
{
"category": "external",
"summary": "CSCvz96133",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133"
},
{
"category": "external",
"summary": "CSCvz88705",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705"
},
{
"category": "external",
"summary": "CSCvz89602",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602"
},
{
"category": "external",
"summary": "CSCvx33758",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758"
},
{
"category": "external",
"summary": "CSCvx35087",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087"
},
{
"category": "external",
"summary": "CSCvx35085",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085"
},
{
"category": "external",
"summary": "CSCvx33758",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758"
},
{
"category": "external",
"summary": "CSCvw92154",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154"
},
{
"category": "external",
"summary": "Cisco Access Points VLAN Bypass from Native VLAN Vulnerability",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY"
},
{
"category": "external",
"summary": "CSCwa06265",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265"
},
{
"category": "external",
"summary": "CSCwa14950",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950"
},
{
"category": "external",
"summary": "CSCwa14282",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282"
},
{
"category": "external",
"summary": "CSCwa04809",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809"
},
{
"category": "external",
"summary": "CSCwa01097",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097"
},
{
"category": "external",
"summary": "CSCwa18209",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209"
},
{
"category": "external",
"summary": "CSCwa18310",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310"
},
{
"category": "external",
"summary": "CSCwa01097",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097"
},
{
"category": "external",
"summary": "CSCwa09081",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081"
},
{
"category": "external",
"summary": "IOS XR L2VPN Services and Features",
"url": "https://www.cisco.com/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.html#anc6"
},
{
"category": "external",
"summary": "considering software upgrades",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes"
},
{
"category": "external",
"summary": "Cisco Security Advisories page",
"url": "https://www.cisco.com/go/psirt"
},
{
"category": "external",
"summary": "CSCvz91291",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291"
},
{
"category": "external",
"summary": "Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
}
],
"title": "Vulnerabilities in Layer 2 Network Security Controls Affecting Cisco Products: September 2022",
"tracking": {
"current\_release\_date": "2022-10-05T18:16:08+00:00",
"generator": {
"date": "2022-10-22T03:15:47+00:00",
"engine": {
"name": "TVCE"
}
},
"id": "cisco-sa-VU855201-J3z8CKTX",
"initial\_release\_date": "2022-09-27T16:00:00+00:00",
"revision\_history": [
{
"date": "2022-09-27T16:38:06+00:00",
"number": "1.0.0",
"summary": "Initial public release."
},
{
"date": "2022-10-05T18:16:08+00:00",
"number": "1.1.0",
"summary": "Corrected affected product information."
}
],
"status": "final",
"version": "1.1.0"
}
},
"product\_tree": {
"branches": [
{
"name": "Cisco",
"category": "vendor",
"branches": [
{
"name": "IOS",
"category": "product\_family",
"product": {
"name": "Cisco IOS ",
"product\_id": "CSAFPID-2097"
}
},
{
"name": "Cisco IOS XR Software",
"category": "product\_family",
"product": {
"name": "Cisco IOS XR Software ",
"product\_id": "CSAFPID-5834"
}
},
{
"name": "Cisco NX-OS Software",
"category": "product\_family",
"product": {
"name": "Cisco NX-OS Software ",
"product\_id": "CSAFPID-80720"
}
},
{
"name": "Cisco IOS XE Software",
"category": "product\_family",
"product": {
"name": "Cisco IOS XE Software ",
"product\_id": "CSAFPID-93036"
}
},
{
"name": "Cisco Aironet Access Point Software",
"category": "product\_family",
"product": {
"name": "Cisco Aironet Access Point Software ",
"product\_id": "CSAFPID-190024"
}
},
{
"name": "Cisco Small Business Smart and Managed Switches",
"category": "product\_family",
"product": {
"name": "Cisco Small Business Smart and Managed Switches ",
"product\_id": "CSAFPID-278027"
}
}
]
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2021-27862",
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Not available."
}
],
"remediations": [
{
"category": "workaround",
"details": "There are workarounds that address some of these vulnerabilities.\r\n CVE-2021-27853\r\nAdministrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\n\r\n!\r\nmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if interface vlan 5 is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nFor configurations that have a service instance with encapsulation priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword exact after the encapsulation priority-tagged or filter on the ethertype field with encapsulation priority-tagged etype ipv4 , ipv6.\r\n\r\nFor environments that do not have encapsulation priority-tagged assigned to a service instance, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with encapsulation priority-tagged.\r\n\r\nCisco IOS XR Software\r\n\r\nFor configurations that have an l2transport sub interface configured with encapsulation dot1q|dot1ad priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword exact after the encapsulation dot1q|dot1ad priority-tagged.\r\n\r\nFor environments that do not have encapsulation dot1q|dot1ad priority-tagged assigned to an l2transport sub interface, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with encapsulation dot1q priority-tagged and encapsulation dot1ad priority-tagged.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\nmac access-list drop\_three\_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop\_three\_tags\r\n!\r\n\r\n\r\nCisco Small Business Switches\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n\r\n\r\n CVE-2021-27861\r\nThe principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco IOS XR Software\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\ninterface Ethernet1/3\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy HOSTS\r\n!\r\ninterface Ethernet1/4\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy CSCvw92154\r\n!\r\nmac access-list drop\_non\r\n 10 permit any any 0x86dd\r\n 20 permit any any ip\r\n 30 permit any any 0x806\r\n 35 permit any 0100.0ccc.cccc 0000.0000.0000\r\n 40 deny any any\r\n!\r\n\r\nCisco Small Business Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nWhile these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment."
}
],
"title": "VU855201: When converting from 802.3 (LLC/SNAP) to 802.11, Linux ignore the length field. "
},
{
"cve": "CVE-2021-27853",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCvz96133"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa18093"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvz91291"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwb01481"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa14271"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa06145"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa14942"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvw99743"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvx33758"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvx35087"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvx35085"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvz89602"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvz88705"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCvw92154"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-93036",
"CSAFPID-2097",
"CSAFPID-80720",
"CSAFPID-5834",
"CSAFPID-278027"
]
},
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-93036",
"CSAFPID-80720",
"CSAFPID-278027",
"CSAFPID-2097",
"CSAFPID-5834"
],
"url": "https://software.cisco.com"
},
{
"category": "workaround",
"details": "There are workarounds that address some of these vulnerabilities.\r\n CVE-2021-27853\r\nAdministrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\n\r\n!\r\nmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if interface vlan 5 is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nFor configurations that have a service instance with encapsulation priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword exact after the encapsulation priority-tagged or filter on the ethertype field with encapsulation priority-tagged etype ipv4 , ipv6.\r\n\r\nFor environments that do not have encapsulation priority-tagged assigned to a service instance, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with encapsulation priority-tagged.\r\n\r\nCisco IOS XR Software\r\n\r\nFor configurations that have an l2transport sub interface configured with encapsulation dot1q|dot1ad priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword exact after the encapsulation dot1q|dot1ad priority-tagged.\r\n\r\nFor environments that do not have encapsulation dot1q|dot1ad priority-tagged assigned to an l2transport sub interface, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with encapsulation dot1q priority-tagged and encapsulation dot1ad priority-tagged.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\nmac access-list drop\_three\_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop\_three\_tags\r\n!\r\n\r\n\r\nCisco Small Business Switches\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n\r\n\r\n CVE-2021-27861\r\nThe principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco IOS XR Software\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\ninterface Ethernet1/3\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy HOSTS\r\n!\r\ninterface Ethernet1/4\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy CSCvw92154\r\n!\r\nmac access-list drop\_non\r\n 10 permit any any 0x86dd\r\n 20 permit any any ip\r\n 30 permit any any 0x806\r\n 35 permit any 0100.0ccc.cccc 0000.0000.0000\r\n 40 deny any any\r\n!\r\n\r\nCisco Small Business Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nWhile these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.",
"product\_ids": [
"CSAFPID-93036",
"CSAFPID-2097",
"CSAFPID-80720",
"CSAFPID-5834",
"CSAFPID-278027"
]
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 4.7,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
"version": "3.1"
},
"products": [
"CSAFPID-93036",
"CSAFPID-2097",
"CSAFPID-80720",
"CSAFPID-5834",
"CSAFPID-278027"
]
}
],
"title": "VU855201: 802.1Q VID0 Headers can bypass First Hop Security Affecting Cisco Products"
},
{
"cve": "CVE-2021-27861",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa18209"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa01097"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa18310"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa14282"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa14950"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa06265"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa09081"
},
{
"system\_name": "Cisco Bug ID",
"text": "CSCwa04809"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-80720",
"CSAFPID-2097",
"CSAFPID-278027",
"CSAFPID-5834"
]
},
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-80720",
"CSAFPID-278027",
"CSAFPID-2097",
"CSAFPID-5834"
],
"url": "https://software.cisco.com"
},
{
"category": "workaround",
"details": "There are workarounds that address some of these vulnerabilities.\r\n CVE-2021-27853\r\nAdministrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\n\r\n!\r\nmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if interface vlan 5 is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nFor configurations that have a service instance with encapsulation priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword exact after the encapsulation priority-tagged or filter on the ethertype field with encapsulation priority-tagged etype ipv4 , ipv6.\r\n\r\nFor environments that do not have encapsulation priority-tagged assigned to a service instance, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with encapsulation priority-tagged.\r\n\r\nCisco IOS XR Software\r\n\r\nFor configurations that have an l2transport sub interface configured with encapsulation dot1q|dot1ad priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword exact after the encapsulation dot1q|dot1ad priority-tagged.\r\n\r\nFor environments that do not have encapsulation dot1q|dot1ad priority-tagged assigned to an l2transport sub interface, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with encapsulation dot1q priority-tagged and encapsulation dot1ad priority-tagged.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\nmac access-list drop\_three\_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop\_three\_tags\r\n!\r\n\r\n\r\nCisco Small Business Switches\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n\r\n\r\n CVE-2021-27861\r\nThe principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco IOS XR Software\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\ninterface Ethernet1/3\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy HOSTS\r\n!\r\ninterface Ethernet1/4\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy CSCvw92154\r\n!\r\nmac access-list drop\_non\r\n 10 permit any any 0x86dd\r\n 20 permit any any ip\r\n 30 permit any any 0x806\r\n 35 permit any 0100.0ccc.cccc 0000.0000.0000\r\n 40 deny any any\r\n!\r\n\r\nCisco Small Business Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nWhile these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.",
"product\_ids": [
"CSAFPID-80720",
"CSAFPID-2097",
"CSAFPID-278027",
"CSAFPID-5834"
]
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 4.7,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
"version": "3.1"
},
"products": [
"CSAFPID-80720",
"CSAFPID-2097",
"CSAFPID-278027",
"CSAFPID-5834"
]
}
],
"title": "VU855201: SNAP/LLC Headers can bypass First Hop Security Affecting Cisco Products"
},
{
"cve": "CVE-2021-27854",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCvx37987"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-190024"
]
},
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-190024"
],
"url": "https://software.cisco.com"
},
{
"category": "workaround",
"details": "There are workarounds that address some of these vulnerabilities.\r\n CVE-2021-27853\r\nAdministrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\n\r\n!\r\nmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n\r\nCisco IOS XE Software – Switches\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if interface vlan 5 is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\nCisco IOS XE Software – Routers\r\n\r\nFor configurations that have a service instance with encapsulation priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword exact after the encapsulation priority-tagged or filter on the ethertype field with encapsulation priority-tagged etype ipv4 , ipv6.\r\n\r\nFor environments that do not have encapsulation priority-tagged assigned to a service instance, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with encapsulation priority-tagged.\r\n\r\nCisco IOS XR Software\r\n\r\nFor configurations that have an l2transport sub interface configured with encapsulation dot1q|dot1ad priority-tagged and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword exact after the encapsulation dot1q|dot1ad priority-tagged.\r\n\r\nFor environments that do not have encapsulation dot1q|dot1ad priority-tagged assigned to an l2transport sub interface, to prevent packets that are tagged with dot1p at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with encapsulation dot1q priority-tagged and encapsulation dot1ad priority-tagged.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\nmac access-list drop\_three\_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop\_three\_tags\r\n!\r\n\r\n\r\nCisco Small Business Switches\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n\r\n\r\n CVE-2021-27861\r\nThe principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:\r\n\r\nCisco IOS Software – Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco IOS XR Software\r\n\r\nNo mitigations or workarounds.\r\n\r\nCisco NX-OS Software\r\n\r\n\r\n!\r\ninterface Ethernet1/3\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy HOSTS\r\n!\r\ninterface Ethernet1/4\r\n switchport\r\n switchport access vlan 5\r\n mac port access-group drop\_non\r\n ipv6 nd raguard attach-policy CSCvw92154\r\n!\r\nmac access-list drop\_non\r\n 10 permit any any 0x86dd\r\n 20 permit any any ip\r\n 30 permit any any 0x806\r\n 35 permit any 0100.0ccc.cccc 0000.0000.0000\r\n 40 deny any any\r\n!\r\n\r\nCisco Small Business Switches\r\n\r\nNo mitigations or workarounds.\r\n\r\nWhile these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.",
"product\_ids": [
"CSAFPID-190024"
]
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 4.7,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
"version": "3.1"
},
"products": [
"CSAFPID-190024"
]
}
],
"title": "VU855201: 802.3/802.11 frame conversion can bypass First Hop Security Affecting Cisco Products"
}
]
}

=== Content from www.ieee802.org_c5972dd6_20250115_180601.html ===
VLAN Tag encoding and recognition

Re: Q-rev/D1.0 SA ballot comment I-65.

Mick Seaman
mickseaman@gmail.com

Note:  This  presentation  discusses  what  is  standardized,  not  proprietary  solutions  (whether  arguably
standards ‘compatible’ or not) or what changes might be desirable in networks using those solutions.

9 Jan 2022

VLAN Tag encoding and recognition

Page 1

Overview

Simple cases first:

• C-VLAN Bridge Forwarding

— Forwarding between Ethernet interfaces
— Transparent bridging (now and for the future)

• Network configuration for VLAN traffic segregation

— Peer-to-peer, sub-layered architecture
— Ethernet-attached end-station behavior

Mixing it up:

• Tags and forwarding for different media

9 Jan 2022

VLAN Tag encoding and recognition

Page 2

C-VLAN Bridge Forwarding—Steps

Assign each received frame to a VLAN:
• If the initial octets of the frame (following the MAC SA) are recognized as a
VLAN Tag with non-zero VID, the assigned VLAN ID is the VID in the Tag.
— Discard if Acceptable Frame Types is Admit Only Untagged and Priority-tagged frames
— Remove the Tag

• If the initial octets of the frame (following the MAC SA) are recognized as a

VLAN Tag with zero VID, the assigned VLAN ID is the PVID .
— Discard if Acceptable Frame Types is Admit Only VLAN-tagged frames
— Remove the TAG

• Otherwise frame’s VID is the PVID.

— Discard if Acceptable Frame Types is Admit Only VLAN-tagged frames

Forward to other Ports (conditionally on DA and VLAN ID)

Conditionally tag transmitted frames:
• Prepend a VLAN Tag if the Port is not in the untagged set for the VID.
• Otherwise transmit the frame without adding a Tag

9 Jan 2022

VLAN Tag encoding and recognition

Page 3

C-VLAN Bridge Forwarding—Summary

If the initial octets of a received frame comprise a recognized
C-VLAN Tag:
• The Tag is removed on receipt, and a Tag may be added on transmit

If the initial octets of a received frame do not comprise a
recognized C-VLAN Tag:
• A Tag can be added on transmit

Frame forwarding by a series of N simple C-VLAN Bridges:
• Initially untagged frames can be transmitted with zero or one prepended Tags
• Initially tagged frame can be transmitted with the same (possibly VID

translated) Tag or with the removal of up to N consecutive C-VLAN Tags

Note: Interface stacks that intentionally add other tags, e.g. the MACsec SecTAG can hide C-VLAN Tags
from the reception process. Nonsensical network configuration, e.g. random addition of S-VLAN Bridges
can also restart the tagging process.

9 Jan 2022

VLAN Tag encoding and recognition

Page 4

C-VLAN Bridge Forwarding—Ethernet examples

DA, SA precedes all octet sequences shown in these examples.

IPv4 frame, transmitted untagged or tagged  by end station. Assigned to VLAN 1:
08-00 ..

→ 08-00 ..

08-00 ..

81-00 00-01 08-00 ..

81-00 00-01 08-00 ..

→ 81-00 00-01 08-00 ..

→ 81-00 00-01 08-00 ..

→ 08-00 ..

Adversary includes hidden VLAN Tag:
81-00 00-01 81-00 00-02 08-00 ..  → 81-00 00-01  81-00 00-02 08-00 ..

81-00 00-01 81-00 00-02 08-00 ..  → 81-00 00-02 08-00 .. !!

Adversary hides an extra VLAN Tag behind a CN-TAG:
81-00 00-01 22-E9 57-57 81-00 00-02 08-00 ..

→ 81-00 00-01 81-00 00-02 08-00 .. → 81-00 00-02 08-00 .. !!

All the above examples use VLAN VID 1 or VLAN VID 2, because a 0 in the VID field in a VLAN Tag  indicates that the
frame has not yet been assigned to a VLAN. In that case the VLAN Tag just carries priority and drop_eligible information.

9 Jan 2022

VLAN Tag encoding and recognition

Page 5

Discarding illegitimate tags

Problem: Bridges will no longer be ‘transparent’ or
cost-effective if they need to parse and reject frames with
‘unknown’ or stacked protocol identifiers.

Solution: Enforce peer-to-peer (sub-layered network
architecture) relationships:
• Every interface stack entity that adds a Tag (of any type) has a peer (or peers)

that removes that Tag.

• Discard  any  frame  with  an  unexpected  Tag  (apparent  presence  of  an

unknown/unauthorized peer) as unknown protocol.

• Existing  802.1  protocols  use  ‘domain’  or  ‘address  scope’  concepts  to  bound
network regions with legitimate peers, discarding data frames or control frames
that might otherwise enter the domain e.g. by Reserved MAC address filtering.

9 Jan 2022

VLAN Tag encoding and recognition

Page 6

Network config for VLAN traffic segregation

Example network uses 802.1X at exposed access interfaces:
• Bridge serving that interface adds C-VLAN Tag (with VID appropriate to

accessing system authorization) or verifies frame already has that Tag, before
transmitting into the protected network.

• Tag is not removed as it transits the protected, traffic segregated, network

domain.

• Tag can be removed when frame leaves the traffic segregated network domain
(the bridge that removes the Tag is a peer of the bridge that added it), but is not
removed for ‘efficiency’ reasons within the domain.
— Tag removal appropriate for transmission to a VLAN-unaware end station.
— Exposes  VLAN-aware  end  stations  to  a  potentially  ‘hidden  tag’.  Protected  network  domain

needs to ensure those end stations cannot return frames on an inappropriate VLAN.
• Tag not removed when delivering frames to a VLAN-aware end station. The

protocol shim that recognizes the C-VLAN Tag is a protocol peer of the bridge
that added it.
— End  station  needs  to  treat  any  further  C-VLAN  Tag  (or  an  inappropriately  placed  S-TAG,  for

example) as unrecognized protocol, and discard the frame.

9 Jan 2022

VLAN Tag encoding and recognition

Page 7

Tags and forwarding for different media

Whatever the media type all Tags (all protocol identifers allocated by IEEE 802) in a frame, apart from the
first, are Length/Type encoded (see 802.1Q-2018 G.3).

Alternative descriptions of C-VLAN Bridge forwarding:
1. Recognize VLAN Tag on receipt (remove if present), select VLAN for

forwarding. Forward to selected transmission ports.
If VLAN Tag on receipt but not on transmit, translate received initial protocol id
encoding for transmit media type.
If VLAN Tag not on receipt, but on transmit, translate received initial protocol id
encoding to Length/Type.
If VLAN Tag on transmit, add with encoding for transmit media type.
2. On receipt, translate initial protocol id encoding to Length/Type (media

dependent support of the ISS).
Recognize VLAN Tag EtherType, remove Tag if present, select VLAN for
forwarding. Forward to selected transmission ports.
Add VLAN Tag (if required), update assigned VID (if required).
Translate initial protocol id encoding to type required by media (media
dependent support of the ISS).

9 Jan 2022

VLAN Tag encoding and recognition

Page 8



=== Content from sec.cloudapps.cisco.com_3f8a2f74_20250115_120011.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from datatracker.ietf.org_b51660ce_20250115_180554.html ===


[Skip to main content](#content)
[![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor-white.svg)
![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor.svg)
Datatracker](/)

* Groups
  + By area/parent
  + [Apps & Realtime](/wg/#ART)
  + [General](/wg/#GEN)
  + [Internet](/wg/#INT)
  + [Ops & Management](/wg/#OPS)
  + [Routing](/wg/#RTG)
  + [Security](/wg/#SEC)
  + [Web and Internet Transport](/wg/#WIT)
  + [IAB](/program/)
  + [IRTF](/rg/)
  + [IETF LLC](/adm/)
  + [RFC Editor](/rfcedtyp/)
  + [Other](/group/)
    - [Active AGs](/ag/)
    - [Active Areas](/area/)
    - [Active Directorates](/dir/)
    - [Active IAB Workshops](/iabworkshop/)
    - [Active Programs](/program/)
    - [Active RAGs](/rag/)
    - [Active Teams](/team/)
  + ---
  + New work
  + [Chartering groups](/group/chartering/)
  + [BOFs](/wg/bofs/)
  + [BOF Requests](/doc/bof-requests)
  + ---
  + Other groups
  + [Concluded groups](/group/concluded/)
  + [Non-WG lists](/list/nonwg)
* Documents
  + [Search](/doc/search)
  + [Recent I-Ds](/doc/recent)
  + [I-D submission](/submit/)
  + [IESG dashboard](/doc/ad)
  + ---
  + RFC streams
  + [IAB](/stream/iab/)
  + [IRTF](/stream/irtf/)
  + [ISE](/stream/ise/)
  + [Editorial](/stream/editorial/)
  + ---
  + Subseries
  + [STD](/doc/std)
    [BCP](/doc/bcp)
    [FYI](/doc/fyi)
* Meetings
  + [Agenda](/meeting/agenda)
  + [Materials](/meeting/materials)
  + [Floor plan](/meeting/floor-plan)
  + [Registration](https://www.ietf.org/how/meetings/register/)
  + [Important dates](/meeting/important-dates/)
  + [Request a session](/secr/sreq/)
  + [Session requests](/meeting/requests)
  + ---
  + Upcoming meetings
  + [Upcoming meetings](/meeting/upcoming)
  + ---
  + Past meetings
  + [Past meetings](/meeting/past)
  + [Meeting proceedings](https://www.ietf.org/how/meetings/past/)
* Other
  + [IPR disclosures](/ipr/)
  + [Liaison statements](/liaison/)
  + [IESG agenda](/iesg/agenda/)
  + [NomComs](/nomcom/)
  + [Downref registry](/doc/downref)
  + [Statistics](/stats/)
    - [I-Ds/RFCs](/stats/document/)
    - [Meetings](/stats/meeting/)
  + [API Help](/api/)
  + [Release notes](/release/)
  + [System status](https://status.ietf.org)
  + ---
  + [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
* User
  + [Sign in](/accounts/login/?next=/doc/rfc4861/)
  + [Password reset](/accounts/reset/)
  + [Preferences](/accounts/settings/)
  + [New account](/accounts/create/)

[Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
[Sign in](/accounts/login/?next=/doc/rfc4861/)

**Javascript disabled?** Like other modern websites, the IETF Datatracker relies on Javascript.
Please enable Javascript for full functionality.

# Neighbor Discovery for IP version 6 (IPv6) RFC 4861

* [Status](/doc/rfc4861/)
* [Email expansions](/doc/rfc4861/email/)
* [History](/doc/rfc4861/history/)

| Document | Type |  | RFC - Draft Standard  (September 2007) [Errata](https://www.rfc-editor.org/errata_search.php?rfc=4861 "Click to view errata.") Updated by [RFC 8319](/doc/rfc8319/ "Support for Adjustable Maximum Router Lifetimes per Link"), [RFC 8425](/doc/rfc8425/ "IANA Considerations for IPv6 Neighbor Discovery Prefix Information Option Flags"), [RFC 9131](/doc/rfc9131/ "Gratuitous Neighbor Discovery: Creating Neighbor Cache Entries on First-Hop Routers"), [RFC 5942](/doc/rfc5942/ "IPv6 Subnet Model: The Relationship between Links and Subnet Prefixes"), [RFC 6980](/doc/rfc6980/ "Security Implications of IPv6 Fragmentation with IPv6 Neighbor Discovery"), [RFC 7048](/doc/rfc7048/ "Neighbor Unreachability Detection Is Too Impatient"), [RFC 7527](/doc/rfc7527/ "Enhanced Duplicate Address Detection"), [RFC 7559](/doc/rfc7559/ "Packet-Loss Resiliency for Router Solicitations"), [RFC 8028](/doc/rfc8028/ "First-Hop Router Selection by Hosts in a Multi-Prefix Network"), [RFC 9685](/doc/rfc9685/ "Listener Subscription for IPv6 Neighbor Discovery Multicast and Anycast Addresses") Obsoletes [RFC 2461](/doc/rfc2461/ "Neighbor Discovery for IP Version 6 (IPv6)") Was [draft-ietf-ipv6-2461bis](/doc/draft-ietf-ipv6-2461bis/11/) ([ipv6 WG](/wg/ipv6/about/)) |
| --- | --- | --- | --- |
|  | Authors |  | [William A. Simpson](/person/wsimpson%40umich.edu "Datatracker profile of William A. Simpson") , [Dr. Thomas Narten](/person/narten%40cs.duke.edu "Datatracker profile of Dr. Thomas Narten") , [Erik Nordmark](/person/nordmark%40sonic.net "Datatracker profile of Erik Nordmark") , [Hesham Soliman](/person/hesham.soliman%40era.ericsson.se "Datatracker profile of Hesham Soliman") |
|  | Last updated |  | 2020-01-21 |
|  | RFC stream |  | Internet Engineering Task Force (IETF) |
|  | Formats |  | [txt](https://www.rfc-editor.org/rfc/rfc4861.txt) [html](https://www.rfc-editor.org/rfc/rfc4861.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc4861.txt.pdf) [htmlized](/doc/html/rfc4861) [w/errata](https://www.rfc-editor.org/rfc/inline-errata/rfc4861.html) [bibtex](/doc/rfc4861/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/ipv6?q=rfc4861 OR %22draft-ietf-ipv6-2461bis%22) |
| IESG | Responsible AD |  | [Jari Arkko](/person/jari.arkko%40ericsson.com "Datatracker profile of Jari Arkko") |
| --- | --- | --- | --- |
|  | Send notices to |  | (None) |

Email authors
Email WG
[IPR](/ipr/search/?submit=draft&id=rfc4861)
[References](/doc/rfc4861/references/)
[Referenced by](/doc/rfc4861/referencedby/)
[Search Lists](https://mailarchive.ietf.org/arch/search?q=%22rfc4861%22)

RFC 4861

```
Network Working Group                                          T. Narten
Request for Comments: 4861                                           IBM
Obsoletes: 2461                                              E. Nordmark
Category: Standards Track                               Sun Microsystems
                                                              W. Simpson
                                                              Daydreamer
                                                              H. Soliman
                                                    Elevate Technologies
                                                          September 2007

               Neighbor Discovery for IP version 6 (IPv6)

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   This document specifies the Neighbor Discovery protocol for IP
   Version 6.  IPv6 nodes on the same link use Neighbor Discovery to
   discover each other's presence, to determine each other's link-layer
   addresses, to find routers, and to maintain reachability information
   about the paths to active neighbors.

Narten, et al.              Standards Track                     [Page 1]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Table of Contents

   1. Introduction ....................................................4
   2. Terminology .....................................................4
      2.1. General ....................................................4
      2.2. Link Types .................................................8
      2.3. Addresses ..................................................9
      2.4. Requirements ..............................................10
   3. Protocol Overview ..............................................10
      3.1. Comparison with IPv4 ......................................14
      3.2. Supported Link Types ......................................16
      3.3. Securing Neighbor Discovery Messages ......................18
   4. Message Formats ................................................18
      4.1. Router Solicitation Message Format ........................18
      4.2. Router Advertisement Message Format .......................19
      4.3. Neighbor Solicitation Message Format ......................22
      4.4. Neighbor Advertisement Message Format .....................23
      4.5. Redirect Message Format ...................................26
      4.6. Option Formats ............................................28
           4.6.1. Source/Target Link-layer Address ...................28
           4.6.2. Prefix Information .................................29
           4.6.3. Redirected Header ..................................31
           4.6.4. MTU ................................................32
   5. Conceptual Model of a Host .....................................33
      5.1. Conceptual Data Structures ................................33
      5.2. Conceptual Sending Algorithm ..............................36
      5.3. Garbage Collection and Timeout Requirements ...............37
   6. Router and Prefix Discovery ....................................38
      6.1. Message Validation ........................................39
           6.1.1. Validation of Router Solicitation Messages .........39
           6.1.2. Validation of Router Advertisement Messages ........39
      6.2. Router Specification ......................................40
           6.2.1. Router Configuration Variables .....................40
           6.2.2. Becoming an Advertising Interface ..................45
           6.2.3. Router Advertisement Message Content ...............45
           6.2.4. Sending Unsolicited Router Advertisements ..........47
           6.2.5. Ceasing To Be an Advertising Interface .............47
           6.2.6. Processing Router Solicitations ....................48
           6.2.7. Router Advertisement Consistency ...................50
           6.2.8. Link-local Address Change ..........................50
      6.3. Host Specification ........................................51
           6.3.1. Host Configuration Variables .......................51
           6.3.2. Host Variables .....................................51
           6.3.3. Interface Initialization ...........................52
           6.3.4. Processing Received Router Advertisements ..........53
           6.3.5. Timing out Prefixes and Default Routers ............56
           6.3.6. Default Router Selection ...........................56
           6.3.7. Sending Router Solicitations .......................57

Narten, et al.              Standards Track                     [Page 2]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   7. Address Resolution and Neighbor Unreachability Detection .......59
      7.1. Message Validation ........................................59
           7.1.1. Validation of Neighbor Solicitations ...............59
           7.1.2. Validation of Neighbor Advertisements ..............60
      7.2. Address Resolution ........................................60
           7.2.1. Interface Initialization ...........................61
           7.2.2. Sending Neighbor Solicitations .....................61
           7.2.3. Receipt of Neighbor Solicitations ..................62
           7.2.4. Sending Solicited Neighbor Advertisements ..........63
           7.2.5. Receipt of Neighbor Advertisements .................64
           7.2.6. Sending Unsolicited Neighbor Advertisements ........66
           7.2.7. Anycast Neighbor Advertisements ....................67
           7.2.8. Proxy Neighbor Advertisements ......................68
      7.3. Neighbor Unreachability Detection .........................68
           7.3.1. Reachability Confirmation ..........................69
           7.3.2. Neighbor Cache Entry States ........................70
           7.3.3. Node Behavior ......................................71
   8. Redirect Function ..............................................73
      8.1. Validation of Redirect Messages ...........................74
      8.2. Router Specification ......................................75
      8.3. Host Specification ........................................76
   9. Extensibility - Option Processing ..............................76
   10. Protocol Constants ............................................78
   11. Security Considerations .......................................79
      11.1. Threat Analysis ..........................................79
      11.2. Securing Neighbor Discovery Messages .....................81
   12. Renumbering Considerations ....................................81
   13. IANA Considerations ...........................................83
   14. References ....................................................84
      14.1. Normative References .....................................84
      14.2. Informative References ...................................84
   Appendix A: Multihomed Hosts ......................................87
   Appendix B: Future Extensions .....................................88
   Appendix C: State Machine for the Reachability State ..............89
   Appendix D: Summary of IsRouter Rules .............................91
   Appendix E: Implementation Issues .................................92
   Appendix F: Changes from RFC 2461 .................................94
   Acknowledgments ...................................................95

Narten, et al.              Standards Track                     [Page 3]
RFC 4861               Neighbor Discovery in IPv6         September 2007

1.  Introduction

   This specification defines the Neighbor Discovery (ND) protocol for
   Internet Protocol Version 6 (IPv6).  Nodes (hosts and routers) use
   Neighbor Discovery to determine the link-layer addresses for
   neighbors known to reside on attached links and to quickly purge
   cached values that become invalid.  Hosts also use Neighbor Discovery
   to find neighboring routers that are willing to forward packets on
   their behalf.  Finally, nodes use the protocol to actively keep track
   of which neighbors are reachable and which are not, and to detect
   changed link-layer addresses.  When a router or the path to a router
   fails, a host actively searches for functioning alternates.

   Unless specified otherwise (in a document that covers operating IP
   over a particular link type) this document applies to all link types.
   However, because ND uses link-layer multicast for some of its
   services, it is possible that on some link types (e.g., Non-Broadcast
   Multi-Access (NBMA) links), alternative protocols or mechanisms to
   implement those services will be specified (in the appropriate
   document covering the operation of IP over a particular link type).
   The services described in this document that are not directly
   dependent on multicast, such as Redirects, Next-hop determination,
   Neighbor Unreachability Detection, etc., are expected to be provided
   as specified in this document.  The details of how one uses ND on
   NBMA links are addressed in [IPv6-NBMA].  In addition, [IPv6-3GPP]
   and[IPv6-CELL] discuss the use of this protocol over some cellular
   links, which are examples of NBMA links.

2.  Terminology

2.1.  General

   IP          - Internet Protocol Version 6.  The terms IPv4 and IPv6
                 are used only in contexts where necessary to avoid
                 ambiguity.

   ICMP        - Internet Control Message Protocol for the Internet
                 Protocol Version 6.  The terms ICMPv4 and ICMPv6 are
                 used only in contexts where necessary to avoid
                 ambiguity.

   node        - a device that implements IP.

   router      - a node that forwards IP packets not explicitly
                 addressed to itself.

   host        - any node that is not a router.

Narten, et al.              Standards Track                     [Page 4]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   upper layer - a protocol layer immediately above IP.  Examples are
                 transport protocols such as TCP and UDP, control
                 protocols such as ICMP, routing protocols such as OSPF,
                 and Internet-layer (or lower-layer) protocols being
                 "tunneled" over (i.e., encapsulated in) IP such as
                 Internetwork Packet Exchange (IPX), AppleTalk, or IP
                 itself.

   link        - a communication facility or medium over which nodes can
                 communicate at the link layer, i.e., the layer
                 immediately below IP.  Examples are Ethernets (simple
                 or bridged), PPP links, X.25, Frame Relay, or ATM
                 networks as well as Internet-layer (or higher-layer)
                 "tunnels", such as tunnels over IPv4 or IPv6 itself.

   interface   - a node's attachment to a link.

   neighbors   - nodes attached to the same link.

   address     - an IP-layer identifier for an interface or a set of
                 interfaces.

   anycast address
               - an identifier for a set of interfaces (typically
                 belonging to different nodes).  A packet sent to an
                 anycast address is delivered to one of the interfaces
                 identified by that address (the "nearest" one,
                 according to the routing protocol's measure of
                 distance).  See [ADDR-ARCH].

                 Note that an anycast address is syntactically
                 indistinguishable from a unicast address.  Thus, nodes
                 sending packets to anycast addresses don't generally
                 know that an anycast address is being used.  Throughout
                 the rest of this document, references to unicast
                 addresses also apply to anycast addresses in those
                 cases where the node is unaware that a unicast address
                 is actually an anycast address.

   prefix      - a bit string that consists of some number of initial
                 bits of an address.

   link-layer address
               - a link-layer identifier for an interface.  Examples
                 include IEEE 802 addresses for Ethernet links.

Narten, et al.              Standards Track                     [Page 5]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   on-link     - an address that is assigned to an interface on a
                 specified link.  A node considers an address to be on-
                 link if:

                    - it is covered by one of the link's prefixes (e.g.,
                      as indicated by the on-link flag in the Prefix
                      Information option), or

                    - a neighboring router specifies the address as the
                      target of a Redirect message, or

                    - a Neighbor Advertisement message is received for
                      the (target) address, or

                    - any Neighbor Discovery message is received from
                      the address.

   off-link    - the opposite of "on-link"; an address that is not
                 assigned to any interfaces on the specified link.

   longest prefix match
               - the process of determining which prefix (if any) in a
                 set of prefixes covers a target address.  A target
                 address is covered by a prefix if all of the bits in
                 the prefix match the left-most bits of the target
                 address.  When multiple prefixes cover an address, the
                 longest prefix is the one that matches.

   reachability
               - whether or not the one-way "forward" path to a neighbor
                 is functioning properly.  In particular, whether
                 packets sent to a neighbor are reaching the IP layer on
                 the neighboring machine and are being processed
                 properly by the receiving IP layer.  For neighboring
                 routers, reachability means that packets sent by a
                 node's IP layer are delivered to the router's IP layer,
                 and the router is indeed forwarding packets (i.e., it
                 is configured as a router, not a host).  For hosts,
                 reachability means that packets sent by a node's IP
                 layer are delivered to the neighbor host's IP layer.

   packet      - an IP header plus payload.

   link MTU    - the maximum transmission unit, i.e., maximum packet
                 size in octets, that can be conveyed in one
                 transmission unit over a link.

Narten, et al.              Standards Track                     [Page 6]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   target      - an address about which address resolution information
                 is sought, or an address that is the new first hop when
                 being redirected.

   proxy       - a node that responds to Neighbor Discovery query
                 messages on behalf of another node.  A router acting on
                 behalf of a mobile node that has moved off-link could
                 potentially act as a proxy for the mobile node.

   ICMP destination unreachable indication
               - an error indication returned to the original sender of
                 a packet that cannot be delivered for the reasons
                 outlined in [ICMPv6].  If the error occurs on a node
                 other than the node originating the packet, an ICMP
                 error message is generated.  If the error occurs on the
                 originating node, an implementation is not required to
                 actually create and send an ICMP error packet to the
                 source, as long as the upper-layer sender is notified
                 through an appropriate mechanism (e.g., return value
                 from a procedure call).  Note, however, that an
                 implementation may find it convenient in some cases to
                 return errors to the sender by taking the offending
                 packet, generating an ICMP error message, and then
                 delivering it (locally) through the generic error-
                 handling routines.

   random delay
               - when sending out messages, it is sometimes necessary to
                 delay a transmission for a random amount of time in
                 order to prevent multiple nodes from transmitting at
                 exactly the same time, or to prevent long-range
                 periodic transmissions from synchronizing with each
                 other [SYNC].  When a random component is required, a
                 node calculates the actual delay in such a way that the
                 computed delay forms a uniformly distributed random
                 value that falls between the specified minimum and
                 maximum delay times.  The implementor must take care to
                 ensure that the granularity of the calculated random
                 component and the resolution of the timer used are both
                 high enough to ensure that the probability of multiple
                 nodes delaying the same amount of time is small.

   random delay seed
               - if a pseudo-random number generator is used in
                 calculating a random delay component, the generator
                 should be initialized with a unique seed prior to being
                 used.  Note that it is not sufficient to use the
                 interface identifier alone as the seed, since interface

Narten, et al.              Standards Track                     [Page 7]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                 identifiers will not always be unique.  To reduce the
                 probability that duplicate interface identifiers cause
                 the same seed to be used, the seed should be calculated
                 from a variety of input sources (e.g., machine
                 components) that are likely to be different even on
                 identical "boxes".  For example, the seed could be
                 formed by combining the CPU's serial number with an
                 interface identifier.  Additional information on
                 randomness and random number generation can be found in
                 [RAND].

2.2.  Link Types

   Different link layers have different properties.  The ones of concern
   to Neighbor Discovery are:

   multicast capable
                  - a link that supports a native mechanism at the link
                    layer for sending packets to all (i.e., broadcast)
                    or a subset of all neighbors.

   point-to-point - a link that connects exactly two interfaces.  A
                    point-to-point link is assumed to have multicast
                    capability and a link-local address.

   non-broadcast multi-access (NBMA)
                  - a link to which more than two interfaces can attach,
                    but that does not support a native form of multicast
                    or broadcast (e.g., X.25, ATM, frame relay, etc.).
                    Note that all link types (including NBMA) are
                    expected to provide multicast service for
                    applications that need it (e.g., using multicast
                    servers).  However, it is an issue for further study
                    whether ND should use such facilities or an
                    alternate mechanism that provides the equivalent
                    multicast capability for ND.

   shared media   - a link that allows direct communication among a
                    number of nodes, but attached nodes are configured
                    in such a way that they do not have complete prefix
                    information for all on-link destinations.  That is,
                    at the IP level, nodes on the same link may not know
                    that they are neighbors; by default, they
                    communicate through a router.  Examples are large
                    (switched) public data networks such as Switched
                    Multimegabit Data Service (SMDS) and Broadband
                    Integrated Services Digital Network (B-ISDN).  Also
                    known as "large clouds".  See [SH-MEDIA].

Narten, et al.              Standards Track                     [Page 8]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   variable MTU   - a link that does not have a well-defined MTU (e.g.,
                    IEEE 802.5 token rings).  Many links (e.g.,
                    Ethernet) have a standard MTU defined by the link-
                    layer protocol or by the specific document
                    describing how to run IP over the link layer.

   asymmetric reachability
                  - a link where non-reflexive and/or non-transitive
                    reachability is part of normal operation.  (Non-
                    reflexive reachability means packets from A reach B,
                    but packets from B don't reach A.  Non-transitive
                    reachability means packets from A reach B, and
                    packets from B reach C, but packets from A don't
                    reach C.)  Many radio links exhibit these
                    properties.

2.3.  Addresses

   Neighbor Discovery makes use of a number of different addresses
   defined in [ADDR-ARCH], including:

   all-nodes multicast address
               - the link-local scope address to reach all nodes,
                 FF02::1.

   all-routers multicast address
               - the link-local scope address to reach all routers,
                 FF02::2.

   solicited-node multicast address
               - a link-local scope multicast address that is computed
                 as a function of the solicited target's address.  The
                 function is described in [ADDR-ARCH].  The function is
                 chosen so that IP addresses that differ only in the
                 most significant bits, e.g., due to multiple prefixes
                 associated with different providers, will map to the
                 same solicited-node address thereby reducing the number
                 of multicast addresses a node must join at the link
                 layer.

   link-local address
               - a unicast address having link-only scope that can be
                 used to reach neighbors.  All interfaces on routers
                 MUST have a link-local address.  Also, [ADDRCONF]
                 requires that interfaces on hosts have a link-local
                 address.

Narten, et al.              Standards Track                     [Page 9]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   unspecified address
               - a reserved address value that indicates the lack of an
                 address (e.g., the address is unknown).  It is never
                 used as a destination address, but may be used as a
                 source address if the sender does not (yet) know its
                 own address (e.g., while verifying an address is unused
                 during stateless address autoconfiguration [ADDRCONF]).
                 The unspecified address has a value of 0:0:0:0:0:0:0:0.

   Note that this specification does not strictly comply with the
   consistency requirements in [ADDR-SEL] for the scopes of source and
   destination addresses.  It is possible in some cases for hosts to use
   a source address of a larger scope than the destination address in
   the IPv6 header.

2.4.  Requirements

   The keywords MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD,
   SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in this
   document, are to be interpreted as described in [KEYWORDS].

   This document also makes use of internal conceptual variables to
   describe protocol behavior and external variables that an
   implementation must allow system administrators to change.  The
   specific variable names, how their values change, and how their
   settings influence protocol behavior are provided to demonstrate
   protocol behavior.  An implementation is not required to have them in
   the exact form described here, so long as its external behavior is
   consistent with that described in this document.

3.  Protocol Overview

   This protocol solves a set of problems related to the interaction
   between nodes attached to the same link.  It defines mechanisms for
   solving each of the following problems:

     Router Discovery: How hosts locate routers that reside on an
                attached link.

     Prefix Discovery: How hosts discover the set of address prefixes
                that define which destinations are on-link for an
                attached link.  (Nodes use prefixes to distinguish
                destinations that reside on-link from those only
                reachable through a router.)

     Parameter Discovery: How a node learns link parameters (such as the
                link MTU) or Internet parameters (such as the hop limit
                value) to place in outgoing packets.

Narten, et al.              Standards Track                    [Page 10]
RFC 4861               Neighbor Discovery in IPv6         September 2007

     Address Autoconfiguration: Introduces the mechanisms needed in
                order to allow nodes to configure an address for an
                interface in a stateless manner.  Stateless address
                autoconfiguration is specified in [ADDRCONF].

     Address resolution: How nodes determine the link-layer address of
                an on-link destination (e.g., a neighbor) given only the
                destination's IP address.

     Next-hop determination: The algorithm for mapping an IP destination
                address into the IP address of the neighbor to which
                traffic for the destination should be sent.  The next-
                hop can be a router or the destination itself.

     Neighbor Unreachability Detection: How nodes determine that a
                neighbor is no longer reachable.  For neighbors used as
                routers, alternate default routers can be tried.  For
                both routers and hosts, address resolution can be
                performed again.

     Duplicate Address Detection: How a node determines whether or not
                an address it wishes to use is already in use by another
                node.

     Redirect:  How a router informs a host of a better first-hop node
                to reach a particular destination.

   Neighbor Discovery defines five different ICMP packet types: A pair
   of Router Solicitation and Router Advertisement messages, a pair of
   Neighbor Solicitation and Neighbor Advertisements messages, and a
   Redirect message.  The messages serve the following purpose:

     Router Solicitation: When an interface becomes enabled, hosts may
                send out Router Solicitations that request routers to
                generate Router Advertisements immediately rather than
                at their next scheduled time.

     Router Advertisement: Routers advertise their presence together
                with various link and Internet parameters either
                periodically, or in response to a Router Solicitation
                message.  Router Advertisements contain prefixes that
                are used for determining whether another address shares
                the same link (on-link determination) and/or address
                configuration, a suggested hop limit value, etc.

Narten, et al.              Standards Track                    [Page 11]
RFC 4861               Neighbor Discovery in IPv6         September 2007

     Neighbor Solicitation: Sent by a node to determine the link-layer
                address of a neighbor, or to verify that a neighbor is
                still reachable via a cached link-layer address.
                Neighbor Solicitations are also used for Duplicate
                Address Detection.

     Neighbor Advertisement: A response to a Neighbor Solicitation
                message.  A node may also send unsolicited Neighbor
                Advertisements to announce a link-layer address change.

     Redirect:  Used by routers to inform hosts of a better first hop
                for a destination.

   On multicast-capable links, each router periodically multicasts a
   Router Advertisement packet announcing its availability.  A host
   receives Router Advertisements from all routers, building a list of
   default routers.  Routers generate Router Advertisements frequently
   enough that hosts will learn of their presence within a few minutes,
   but not frequently enough to rely on an absence of advertisements to
   detect router failure; a separate Neighbor Unreachability Detection
   algorithm provides failure detection.

   Router Advertisements contain a list of prefixes used for on-link
   determination and/or autonomous address configuration; flags
   associated with the prefixes specify the intended uses of a
   particular prefix.  Hosts use the advertised on-link prefixes to
   build and maintain a list that is used in deciding when a packet's
   destination is on-link or beyond a router.  Note that a destination
   can be on-link even though it is not covered by any advertised on-
   link prefix.  In such cases, a router can send a Redirect informing
   the sender that the destination is a neighbor.

   Router Advertisements (and per-prefix flags) allow routers to inform
   hosts how to perform Address Autoconfiguration.  For example, routers
   can specify whether hosts should use DHCPv6 and/or autonomous
   (stateless) address configuration.

   Router Advertisement messages also contain Internet parameters such
   as the hop limit that hosts should use in outgoing packets and,
   optionally, link parameters such as the link MTU.  This facilitates
   centralized administration of critical parameters that can be set on
   routers and automatically propagated to all attached hosts.

   Nodes accomplish address resolution by multicasting a Neighbor
   Solicitation that asks the target node to return its link-layer
   address.  Neighbor Solicitation messages are multicast to the
   solicited-node multicast address of the target address.  The target
   returns its link-layer address in a unicast Neighbor Advertisement

Narten, et al.              Standards Track                    [Page 12]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   message.  A single request-response pair of packets is sufficient for
   both the initiator and the target to resolve each other's link-layer
   addresses; the initiator includes its link-layer address in the
   Neighbor Solicitation.

   Neighbor Solicitation messages can also be used to determine if more
   than one node has been assigned the same unicast address.  The use of
   Neighbor Solicitation messages for Duplicate Address Detection is
   specified in [ADDRCONF].

   Neighbor Unreachability Detection detects the failure of a neighbor
   or the failure of the forward path to the neighbor.  Doing so
   requires positive confirmation that packets sent to a neighbor are
   actually reaching that neighbor and being processed properly by its
   IP layer.  Neighbor Unreachability Detection uses confirmation from
   two sources.  When possible, upper-layer protocols provide a positive
   confirmation that a connection is making "forward progress", that is,
   previously sent data is known to have been delivered correctly (e.g.,
   new acknowledgments were received recently).  When positive
   confirmation is not forthcoming through such "hints", a node sends
   unicast Neighbor Solicitation messages that solicit Neighbor
   Advertisements as reachability confirmation from the next hop.  To
   reduce unnecessary network traffic, probe messages are only sent to
   neighbors to which the node is actively sending packets.

   In addition to addressing the above general problems, Neighbor
   Discovery also handles the following situations:

     Link-layer address change - A node that knows its link-layer
           address has changed can multicast a few (unsolicited)
           Neighbor Advertisement packets to all nodes to quickly update
           cached link-layer addresses that have become invalid.  Note
           that the sending of unsolicited advertisements is a
           performance enhancement only (e.g., unreliable).  The
           Neighbor Unreachability Detection algorithm ensures that all
           nodes will reliably discover the new address, though the
           delay may be somewhat longer.

     Inbound load balancing - Nodes with replicated interfaces may want
           to load balance the reception of incoming packets across
           multiple network interfaces on the same link.  Such nodes
           have multiple link-layer addresses assigned to the same
           interface.  For example, a single network driver could
           represent multiple network interface cards as a single
           logical interface having multiple link-layer addresses.

Narten, et al.              Standards Track                    [Page 13]
RFC 4861               Neighbor Discovery in IPv6         September 2007

           Neighbor Discovery allows a router to perform load balancing
           for traffic addressed to itself by allowing routers to omit
           the source link-layer address from Router Advertisement
           packets, thereby forcing neighbors to use Neighbor
           Solicitation messages to learn link-layer addresses of
           routers.  Returned Neighbor Advertisement messages can then
           contain link-layer addresses that differ depending on, e.g.,
           who issued the solicitation.  This specification does not
           define a mechanism that allows hosts to Load-balance incoming
           packets.  See [LD-SHRE].

     Anycast addresses - Anycast addresses identify one of a set of
           nodes providing an equivalent service, and multiple nodes on
           the same link may be configured to recognize the same anycast
           address.  Neighbor Discovery handles anycasts by having nodes
           expect to receive multiple Neighbor Advertisements for the
           same target.  All advertisements for anycast addresses are
           tagged as being non-Override advertisements.  A non-Override
           advertisement is one that does not update or replace the
           information sent by another advertisement.  These
           advertisements are discussed later in the context of Neighbor
           advertisement messages.  This invokes specific rules to
           determine which of potentially multiple advertisements should
           be used.

     Proxy advertisements - A node willing to accept packets on behalf
           of a target address that is unable to respond to Neighbor
           Solicitations can issue non-Override Neighbor Advertisements.
           Proxy advertisements are used by Mobile IPv6 Home Agents to
           defend mobile nodes' addresses when they move off-link.
           However, it is not intended as a general mechanism to handle
           nodes that, e.g., do not implement this protocol.

3.1.  Comparison with IPv4

   The IPv6 Neighbor Discovery protocol corresponds to a combination of
   the IPv4 protocols Address Resolution Protocol [ARP], ICMP Router
   Discovery [RDISC], and ICMP Redirect [ICMPv4].  In IPv4 there is no
   generally agreed upon protocol or mechanism for Neighbor
   Unreachability Detection, although the Hosts Requirements document
   [HR-CL] does specify some possible algorithms for Dead Gateway
   Detection (a subset of the problems Neighbor Unreachability Detection
   tackles).

Narten, et al.              Standards Track                    [Page 14]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   The Neighbor Discovery protocol provides a multitude of improvements
   over the IPv4 set of protocols:

      Router Discovery is part of the base protocol set; there is no
      need for hosts to "snoop" the routing protocols.

      Router Advertisements carry link-layer addresses; no additional
      packet exchange is needed to resolve the router's link-layer
      address.

      Router Advertisements carry prefixes for a link; there is no need
      to have a separate mechanism to configure the "netmask".

      Router Advertisements enable Address Autoconfiguration.

      Routers can advertise an MTU for hosts to use on the link,
      ensuring that all nodes use the same MTU value on links lacking a
      well-defined MTU.

      Address resolution multicasts are "spread" over 16 million (2^24)
      multicast addresses, greatly reducing address-resolution-related
      interrupts on nodes other than the target.  Moreover, non-IPv6
      machines should not be interrupted at all.

      Redirects contain the link-layer address of the new first hop;
      separate address resolution is not needed upon receiving a
      redirect.

      Multiple prefixes can be associated with the same link.  By
      default, hosts learn all on-link prefixes from Router
      Advertisements.  However, routers may be configured to omit some
      or all prefixes from Router Advertisements.  In such cases hosts
      assume that destinations are off-link and send traffic to routers.
      A router can then issue redirects as appropriate.

      Unlike IPv4, the recipient of an IPv6 redirect assumes that the
      new next-hop is on-link.  In IPv4, a host ignores redirects
      specifying a next-hop that is not on-link according to the link's
      network mask.  The IPv6 redirect mechanism is analogous to the
      XRedirect facility specified in [SH-MEDIA].  It is expected to be
      useful on non-broadcast and shared media links in which it is
      undesirable or not possible for nodes to know all prefixes for
      on-link destinations.

      Neighbor Unreachability Detection is part of the base, which
      significantly improves the robustness of packet delivery in the
      presence of failing routers, partially failing or partitioned
      links, or nodes that change their link-layer addresses.  For

Narten, et al.              Standards Track                    [Page 15]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      instance, mobile nodes can move off-link without losing any
      connectivity due to stale ARP caches.

      Unlike ARP, Neighbor Discovery detects half-link failures (using
      Neighbor Unreachability Detection) and avoids sending traffic to
      neighbors with which two-way connectivity is absent.

      Unlike in IPv4 Router Discovery, the Router Advertisement messages
      do not contain a preference field.  The preference field is not
      needed to handle routers of different "stability"; the Neighbor
      Unreachability Detection will detect dead routers and switch to a
      working one.

      The use of link-local addresses to uniquely identify routers (for
      Router Advertisement and Redirect messages) makes it possible for
      hosts to maintain the router associations in the event of the site
      renumbering to use new global prefixes.

      By setting the Hop Limit to 255, Neighbor Discovery is immune to
      off-link senders that accidentally or intentionally send ND
      messages.  In IPv4, off-link senders can send both ICMP Redirects
      and Router Advertisement messages.

      Placing address resolution at the ICMP layer makes the protocol
      more media-independent than ARP and makes it possible to use
      generic IP-layer authentication and security mechanisms as
      appropriate.

3.2.  Supported Link Types

   Neighbor Discovery supports links with different properties.  In the
   presence of certain properties, only a subset of the ND protocol
   mechanisms are fully specified in this document:

     point-to-point - Neighbor Discovery handles such links just like
                      multicast links.  (Multicast can be trivially
                      provided on point-to-point links, and interfaces
                      can be assigned link-local addresses.)

     multicast      - Neighbor Discovery operates over multicast capable
                      links as described in this document.

     non-broadcast multiple access (NBMA)
                    - Redirect, Neighbor Unreachability Detection and
                      next-hop determination should be implemented as
                      described in this document.  Address resolution,
                      and the mechanism for delivering Router
                      Solicitations and Advertisements on NBMA links are

Narten, et al.              Standards Track                    [Page 16]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                      not specified in this document.  Note that if
                      hosts support manual configuration of a list of
                      default routers, hosts can dynamically acquire the
                      link-layer addresses for their neighbors from
                      Redirect messages.

     shared media   - The Redirect message is modeled after the
                      XRedirect message in [SH-MEDIA] in order to
                      simplify use of the protocol on shared media
                      links.

                      This specification does not address shared media
                      issues that only relate to routers, such as:

                       - How routers exchange reachability information
                         on a shared media link.

                       - How a router determines the link-layer address
                         of a host, which it needs to send redirect
                         messages to the host.

                       - How a router determines that it is the first-
                         hop router for a received packet.

                      The protocol is extensible (through the definition
                      of new options) so that other solutions might be
                      possible in the future.

     variable MTU   - Neighbor Discovery allows routers to specify an
                      MTU for the link, which all nodes then use.  All
                      nodes on a link must use the same MTU (or Maximum
                      Receive Unit) in order for multicast to work
                      properly.  Otherwise, when multicasting, a sender,
                      which can not know which nodes will receive the
                      packet, could not determine a minimum packet size
                      that all receivers can process (or Maximum Receive
                      Unit).

     asymmetric reachability
                    - Neighbor Discovery detects the absence of
                      symmetric reachability; a node avoids paths to a
                      neighbor with which it does not have symmetric
                      connectivity.

                      The Neighbor Unreachability Detection will
                      typically identify such half-links and the node
                      will refrain from using them.

Narten, et al.              Standards Track                    [Page 17]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                      The protocol can presumably be extended in the
                      future to find viable paths in environments that
                      lack reflexive and transitive connectivity.

3.3.  Securing Neighbor Discovery Messages

   Neighbor Discovery messages are needed for various functions.
   Several functions are designed to allow hosts to ascertain the
   ownership of an address or the mapping between link-layer and IP-
   layer addresses.  Vulnerabilities related to Neighbor Discovery are
   discussed in Section 11.1.  A general solution for securing Neighbor
   Discovery is outside the scope of this specification and is discussed
   in [SEND].  However, Section 11.2 explains how and under which
   constraints IPsec Authentication Header (AH) or Encapsulating
   Security Payload (ESP) can be used to secure Neighbor Discovery.

4.  Message Formats

   This section introduces message formats for all messages used in this
   specification.

4.1.  Router Solicitation Message Format

   Hosts send Router Solicitations in order to prompt routers to
   generate Router Advertisements quickly.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                            Reserved                           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-

   IP Fields:

      Source Address
                     An IP address assigned to the sending interface, or
                     the unspecified address if no address is assigned
                     to the sending interface.

      Destination Address
                     Typically the all-routers multicast address.

      Hop Limit      255

Narten, et al.              Standards Track                    [Page 18]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   ICMP Fields:

      Type           133

      Code           0

      Checksum       The ICMP checksum.  See [ICMPv6].

      Reserved       This field is unused.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.
   Valid Options:

      Source link-layer address The link-layer address of the sender, if
                     known.  MUST NOT be included if the Source Address
                     is the unspecified address.  Otherwise, it SHOULD
                     be included on link layers that have addresses.

      Future versions of this protocol may define new option types.
      Receivers MUST silently ignore any options they do not recognize
      and continue processing the message.

4.2.  Router Advertisement Message Format

   Routers send out Router Advertisement messages periodically, or in
   response to Router Solicitations.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Cur Hop Limit |M|O|  Reserved |       Router Lifetime         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Reachable Time                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Retrans Timer                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-

   IP Fields:

      Source Address
                     MUST be the link-local address assigned to the
                     interface from which this message is sent.

Narten, et al.              Standards Track                    [Page 19]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Destination Address
                     Typically the Source Address of an invoking Router
                     Solicitation or the all-nodes multicast address.

      Hop Limit      255

   ICMP Fields:

      Type           134

      Code           0

      Checksum       The ICMP checksum.  See [ICMPv6].

      Cur Hop Limit  8-bit unsigned integer.  The default value that
                     should be placed in the Hop Count field of the IP
                     header for outgoing IP packets.  A value of zero
                     means unspecified (by this router).

      M              1-bit "Managed address configuration" flag.  When
                     set, it indicates that addresses are available via
                     Dynamic Host Configuration Protocol [DHCPv6].

                     If the M flag is set, the O flag is redundant and
                     can be ignored because DHCPv6 will return all
                     available configuration information.

      O              1-bit "Other configuration" flag.  When set, it
                     indicates that other configuration information is
                     available via DHCPv6.  Examples of such information
                     are DNS-related information or information on other
                     servers within the network.

        Note: If neither M nor O flags are set, this indicates that no
        information is available via DHCPv6.

      Reserved       A 6-bit unused field.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      Router Lifetime
                     16-bit unsigned integer.  The lifetime associated
                     with the default router in units of seconds.  The
                     field can contain values up to 65535 and receivers
                     should handle any value, while the sending rules in
                     Section 6 limit the lifetime to 9000 seconds.  A
                     Lifetime of 0 indicates that the router is not a
                     default router and SHOULD NOT appear on the default

Narten, et al.              Standards Track                    [Page 20]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                     router list.  The Router Lifetime applies only to
                     the router's usefulness as a default router; it
                     does not apply to information contained in other
                     message fields or options.  Options that need time
                     limits for their information include their own
                     lifetime fields.

      Reachable Time 32-bit unsigned integer.  The time, in
                     milliseconds, that a node assumes a neighbor is
                     reachable after having received a reachability
                     confirmation.  Used by the Neighbor Unreachability
                     Detection algorithm (see Section 7.3).  A value of
                     zero means unspecified (by this router).

      Retrans Timer  32-bit unsigned integer.  The time, in
                     milliseconds, between retransmitted Neighbor
                     Solicitation messages.  Used by address resolution
                     and the Neighbor Unreachability Detection algorithm
                     (see Sections 7.2 and 7.3).  A value of zero means
                     unspecified (by this router).

   Possible options:

      Source link-layer address
                     The link-layer address of the interface from which
                     the Router Advertisement is sent.  Only used on
                     link layers that have addresses.  A router MAY omit
                     this option in order to enable inbound load sharing
                     across multiple link-layer addresses.

      MTU            SHOULD be sent on links that have a variable MTU
                     (as specified in the document that describes how to
                     run IP over the particular link type).  MAY be sent
                     on other links.

      Prefix Information
                     These options specify the prefixes that are on-link
                     and/or are used for stateless address
                     autoconfiguration.  A router SHOULD include all its
                     on-link prefixes (except the link-local prefix) so
                     that multihomed hosts have complete prefix
                     information about on-link destinations for the
                     links to which they attach.  If complete
                     information is lacking, a host with multiple
                     interfaces may not be able to choose the correct
                     outgoing interface when sending traffic to its
                     neighbors.

Narten, et al.              Standards Track                    [Page 21]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Future versions of this protocol may define new option types.
      Receivers MUST silently ignore any options they do not recognize
      and continue processing the message.

4.3.  Neighbor Solicitation Message Format

   Nodes send Neighbor Solicitations to request the link-layer address
   of a target node while also providing their own link-layer address to
   the target.  Neighbor Solicitations are multicast when the node needs
   to resolve an address and unicast when the node seeks to verify the
   reachability of a neighbor.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                           Reserved                            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     +                                                               +
     |                                                               |
     +                       Target Address                          +
     |                                                               |
     +                                                               +
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-

    IP Fields:

      Source Address
                     Either an address assigned to the interface from
                     which this message is sent or (if Duplicate Address
                     Detection is in progress [ADDRCONF]) the
                     unspecified address.
      Destination Address
                     Either the solicited-node multicast address
                     corresponding to the target address, or the target
                     address.
      Hop Limit      255

   ICMP Fields:

      Type           135

      Code           0

Narten, et al.              Standards Track                    [Page 22]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Checksum       The ICMP checksum.  See [ICMPv6].

      Reserved       This field is unused.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      Target Address The IP address of the target of the solicitation.
                     It MUST NOT be a multicast address.

   Possible options:

      Source link-layer address
                     The link-layer address for the sender.  MUST NOT be
                     included when the source IP address is the
                     unspecified address.  Otherwise, on link layers
                     that have addresses this option MUST be included in
                     multicast solicitations and SHOULD be included in
                     unicast solicitations.

      Future versions of this protocol may define new option types.
      Receivers MUST silently ignore any options they do not recognize
      and continue processing the message.

4.4.  Neighbor Advertisement Message Format

   A node sends Neighbor Advertisements in response to Neighbor
   Solicitations and sends unsolicited Neighbor Advertisements in order
   to (unreliably) propagate new information quickly.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |R|S|O|                     Reserved                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +                       Target Address                          +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   Options ...
      +-+-+-+-+-+-+-+-+-+-+-+-

Narten, et al.              Standards Track                    [Page 23]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   IP Fields:

      Source Address
                     An address assigned to the interface from which the
                     advertisement is sent.
      Destination Address
                     For solicited advertisements, the Source Address of
                     an invoking Neighbor Solicitation or, if the
                     solicitation's Source Address is the unspecified
                     address, the all-nodes multicast address.

                     For unsolicited advertisements typically the all-
                     nodes multicast address.

      Hop Limit      255

   ICMP Fields:

      Type           136

      Code           0

      Checksum       The ICMP checksum.  See [ICMPv6].

      R              Router flag.  When set, the R-bit indicates that
                     the sender is a router.  The R-bit is used by
                     Neighbor Unreachability Detection to detect a
                     router that changes to a host.

      S              Solicited flag.  When set, the S-bit indicates that
                     the advertisement was sent in response to a
                     Neighbor Solicitation from the Destination address.
                     The S-bit is used as a reachability confirmation
                     for Neighbor Unreachability Detection.  It MUST NOT
                     be set in multicast advertisements or in
                     unsolicited unicast advertisements.

      O              Override flag.  When set, the O-bit indicates that
                     the advertisement should override an existing cache
                     entry and update the cached link-layer address.
                     When it is not set the advertisement will not
                     update a cached link-layer address though it will
                     update an existing Neighbor Cache entry for which
                     no link-layer address is known.  It SHOULD NOT be
                     set in solicited advertisements for anycast
                     addresses and in solicited proxy advertisements.
                     It SHOULD be set in other solicited advertisements
                     and in unsolicited advertisements.

Narten, et al.              Standards Track                    [Page 24]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Reserved       29-bit unused field.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      Target Address
                     For solicited advertisements, the Target Address
                     field in the Neighbor Solicitation message that
                     prompted this advertisement.  For an unsolicited
                     advertisement, the address whose link-layer address
                     has changed.  The Target Address MUST NOT be a
                     multicast address.

   Possible options:

      Target link-layer address
                     The link-layer address for the target, i.e., the
                     sender of the advertisement.  This option MUST be
                     included on link layers that have addresses when
                     responding to multicast solicitations.  When
                     responding to a unicast Neighbor Solicitation this
                     option SHOULD be included.

                     The option MUST be included for multicast
                     solicitations in order to avoid infinite Neighbor
                     Solicitation "recursion" when the peer node does
                     not have a cache entry to return a Neighbor
                     Advertisements message.  When responding to unicast
                     solicitations, the option can be omitted since the
                     sender of the solicitation has the correct link-
                     layer address; otherwise, it would not be able to
                     send the unicast solicitation in the first place.
                     However, including the link-layer address in this
                     case adds little overhead and eliminates a
                     potential race condition where the sender deletes
                     the cached link-layer address prior to receiving a
                     response to a previous solicitation.

      Future versions of this protocol may define new option types.
      Receivers MUST silently ignore any options they do not recognize
      and continue processing the message.

Narten, et al.              Standards Track                    [Page 25]
RFC 4861               Neighbor Discovery in IPv6         September 2007

4.5.  Redirect Message Format

   Routers send Redirect packets to inform a host of a better first-hop
   node on the path to a destination.  Hosts can be redirected to a
   better first-hop router but can also be informed by a redirect that
   the destination is in fact a neighbor.  The latter is accomplished by
   setting the ICMP Target Address equal to the ICMP Destination
   Address.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           Reserved                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +                       Target Address                          +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +                     Destination Address                       +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   Options ...
      +-+-+-+-+-+-+-+-+-+-+-+-

   IP Fields:

      Source Address
                     MUST be the link-local address assigned to the
                     interface from which this message is sent.

     Destination Address
                     The Source Address of the packet that triggered the
                     redirect.

      Hop Limit      255

Narten, et al.              Standards Track                    [Page 26]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   ICMP Fields:

      Type           137

      Code           0

      Checksum       The ICMP checksum.  See [ICMPv6].

      Reserved       This field is unused.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      Target Address
                     An IP address that is a better first hop to use for
                     the ICMP Destination Address.  When the target is
                     the actual endpoint of communication, i.e., the
                     destination is a neighbor, the Target Address field
                     MUST contain the same value as the ICMP Destination
                     Address field.  Otherwise, the target is a better
                     first-hop router and the Target Address MUST be the
                     router's link-local address so that hosts can
                     uniquely identify routers.

      Destination Address
                     The IP address of the destination that is
                     redirected to the target.

   Possible options:

      Target link-layer address
                     The link-layer address for the target.  It SHOULD
                     be included (if known).  Note that on NBMA links,
                     hosts may rely on the presence of the Target Link-
                     Layer Address option in Redirect messages as the
                     means for determining the link-layer addresses of
                     neighbors.  In such cases, the option MUST be
                     included in Redirect messages.

      Redirected Header
                     As much as possible of the IP packet that triggered
                     the sending of the Redirect without making the
                     redirect packet exceed the minimum MTU specified in
                     [IPv6].

Narten, et al.              Standards Track                    [Page 27]
RFC 4861               Neighbor Discovery in IPv6         September 2007

4.6.  Option Formats

   Neighbor Discovery messages include zero or more options, some of
   which may appear multiple times in the same message.  Options should
   be padded when necessary to ensure that they end on their natural
   64-bit boundaries.  All options are of the form:

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |    Length     |              ...              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                              ...                              ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Fields:

      Type           8-bit identifier of the type of option.  The
                     options defined in this document are:

                           Option Name                             Type

                        Source Link-Layer Address                    1
                        Target Link-Layer Address                    2
                        Prefix Information                           3
                        Redirected Header                            4
                        MTU                                          5

      Length         8-bit unsigned integer.  The length of the option
                     (including the type and length fields) in units of
                     8 octets.  The value 0 is invalid.  Nodes MUST
                     silently discard an ND packet that contains an
                     option with length zero.

4.6.1.  Source/Target Link-layer Address

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |    Length     |    Link-Layer Address ...
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Fields:

      Type
                     1 for Source Link-layer Address
                     2 for Target Link-layer Address

Narten, et al.              Standards Track                    [Page 28]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Length         The length of the option (including the type and
                     length fields) in units of 8 octets.  For example,
                     the length for IEEE 802 addresses is 1
                     [IPv6-ETHER].

      Link-Layer Address
                     The variable length link-layer address.

                     The content and format of this field (including
                     byte and bit ordering) is expected to be specified
                     in specific documents that describe how IPv6
                     operates over different link layers.  For instance,
                     [IPv6-ETHER].

   Description
                     The Source Link-Layer Address option contains the
                     link-layer address of the sender of the packet.  It
                     is used in the Neighbor Solicitation, Router
                     Solicitation, and Router Advertisement packets.

                     The Target Link-Layer Address option contains the
                     link-layer address of the target.  It is used in
                     Neighbor Advertisement and Redirect packets.

                     These options MUST be silently ignored for other
                     Neighbor Discovery messages.

4.6.2.  Prefix Information

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Length     | Prefix Length |L|A| Reserved1 |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Valid Lifetime                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       Preferred Lifetime                      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           Reserved2                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +                            Prefix                             +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Narten, et al.              Standards Track                    [Page 29]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Fields:

      Type           3

      Length         4

      Prefix Length  8-bit unsigned integer.  The number of leading bits
                     in the Prefix that are valid.  The value ranges
                     from 0 to 128.  The prefix length field provides
                     necessary information for on-link determination
                     (when combined with the L flag in the prefix
                     information option).  It also assists with address
                     autoconfiguration as specified in [ADDRCONF], for
                     which there may be more restrictions on the prefix
                     length.

      L              1-bit on-link flag.  When set, indicates that this
                     prefix can be used for on-link determination.  When
                     not set the advertisement makes no statement about
                     on-link or off-link properties of the prefix.  In
                     other words, if the L flag is not set a host MUST
                     NOT conclude that an address derived from the
                     prefix is off-link.  That is, it MUST NOT update a
                     previous indication that the address is on-link.

      A              1-bit autonomous address-configuration flag.  When
                     set indicates that this prefix can be used for
                     stateless address configuration as specified in
                     [ADDRCONF].

      Reserved1      6-bit unused field.  It MUST be initialized to zero
                     by the sender and MUST be ignored by the receiver.

      Valid Lifetime
                     32-bit unsigned integer.  The length of time in
                     seconds (relative to the time the packet is sent)
                     that the prefix is valid for the purpose of on-link
                     determination.  A value of all one bits
                     (0xffffffff) represents infinity.  The Valid
                     Lifetime is also used by [ADDRCONF].

      Preferred Lifetime
                     32-bit unsigned integer.  The length of time in
                     seconds (relative to the time the packet is sent)
                     that addresses generated from the prefix via
                     stateless address autoconfiguration remain
                     preferred [ADDRCONF].  A value of all one bits
                     (0xffffffff) represents infinity.  See [ADDRCONF].

Narten, et al.              Standards Track                    [Page 30]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                     Note that the value of this field MUST NOT exceed
                     the Valid Lifetime field to avoid preferring
                     addresses that are no longer valid.

      Reserved2      This field is unused.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      Prefix         An IP address or a prefix of an IP address.  The
                     Prefix Length field contains the number of valid
                     leading bits in the prefix.  The bits in the prefix
                     after the prefix length are reserved and MUST be
                     initialized to zero by the sender and ignored by
                     the receiver.  A router SHOULD NOT send a prefix
                     option for the link-local prefix and a host SHOULD
                     ignore such a prefix option.

   Description
                     The Prefix Information option provide hosts with
                     on-link prefixes and prefixes for Address
                     Autoconfiguration.  The Prefix Information option
                     appears in Router Advertisement packets and MUST be
                     silently ignored for other messages.

4.6.3.  Redirected Header

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Length     |            Reserved           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           Reserved                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      ~                       IP header + data                        ~
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Fields:

      Type           4

      Length         The length of the option in units of 8 octets.

      Reserved       These fields are unused.  They MUST be initialized
                     to zero by the sender and MUST be ignored by the
                     receiver.

Narten, et al.              Standards Track                    [Page 31]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      IP header + data
                     The original packet truncated to ensure that the
                     size of the redirect message does not exceed the
                     minimum MTU required to support IPv6 as specified
                     in [IPv6].

   Description
                     The Redirected Header option is used in Redirect
                     messages and contains all or part of the packet
                     that is being redirected.

                     This option MUST be silently ignored for other
                     Neighbor Discovery messages.

4.6.4.  MTU

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Length     |           Reserved            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              MTU                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Fields:

      Type           5

      Length         1

      Reserved       This field is unused.  It MUST be initialized to
                     zero by the sender and MUST be ignored by the
                     receiver.

      MTU            32-bit unsigned integer.  The recommended MTU for
                     the link.

   Description
                     The MTU option is used in Router Advertisement
                     messages to ensure that all nodes on a link use the
                     same MTU value in those cases where the link MTU is
                     not well known.

                     This option MUST be silently ignored for other
                     Neighbor Discovery messages.

Narten, et al.              Standards Track                    [Page 32]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                     In configurations in which heterogeneous
                     technologies are bridged together, the maximum
                     supported MTU may differ from one segment to
                     another.  If the bridges do not generate ICMP
                     Packet Too Big messages, communicating nodes will
                     be unable to use Path MTU to dynamically determine
                     the appropriate MTU on a per-neighbor basis.  In
                     such cases, routers can be configured to use the
                     MTU option to specify the maximum MTU value that is
                     supported by all segments.

5.  Conceptual Model of a Host

   This section describes a conceptual model of one possible data
   structure organization that hosts (and, to some extent, routers) will
   maintain in interacting with neighboring nodes.  The described
   organization is provided to facilitate the explanation of how the
   Neighbor Discovery protocol should behave.  This document does not
   mandate that implementations adhere to this model as long as their
   external behavior is consistent with that described in this document.

   This model is only concerned with the aspects of host behavior
   directly related to Neighbor Discovery.  In particular, it does not
   concern itself with such issues as source address selection or the
   selecting of an outgoing interface on a multihomed host.

5.1.  Conceptual Data Structures

   Hosts will need to maintain the following pieces of information for
   each interface:

      Neighbor Cache
                   - A set of entries about individual neighbors to
                     which traffic has been sent recently.  Entries are
                     keyed on the neighbor's on-link unicast IP address
                     and contain such information as its link-layer
                     address, a flag indicating whether the neighbor is
                     a router or a host (called IsRouter in this
                     document), a pointer to any queued packets waiting
                     for address resolution to complete, etc.  A
                     Neighbor Cache entry also contains information used
                     by the Neighbor Unreachability Detection algorithm,
                     including the reachability state, the number of
                     unanswered probes, and the time the next Neighbor
                     Unreachability Detection event is scheduled to take
                     place.

Narten, et al.              Standards Track                    [Page 33]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      Destination Cache
                   - A set of entries about destinations to which
                     traffic has been sent recently.  The Destination
                     Cache includes both on-link and off-link
                     destinations and provides a level of indirection
                     into the Neighbor Cache; the Destination Cache maps
                     a destination IP address to the IP address of the
                     next-hop neighbor.  This cache is updated with
                     information learned from Redirect messages.
                     Implementations may find it convenient to store
                     additional information not directly related to
                     Neighbor Discovery in Destination Cache entries,
                     such as the Path MTU (PMTU) and round-trip timers
                     maintained by transport protocols.

      Prefix List  - A list of the prefixes that define a set of
                     addresses that are on-link.  Prefix List entries
                     are created from information received in Router
                     Advertisements.  Each entry has an associated
                     invalidation timer value (extracted from the
                     advertisement) used to expire prefixes when they
                     become invalid.  A special "infinity" timer value
                     specifies that a prefix remains valid forever,
                     unless a new (finite) value is received in a
                     subsequent advertisement.

                     The link-local prefix is considered to be on the
                     prefix list with an infinite invalidation timer
                     regardless of whether routers are advertising a
                     prefix for it.  Received Router Advertisements
                     SHOULD NOT modify the invalidation timer for the
                     link-local prefix.

      Default Router List
                   - A list of routers to which packets may be sent.
                     Router list entries point to entries in the
                     Neighbor Cache; the algorithm for selecting a
                     default router favors routers known to be reachable
                     over those whose reachability is suspect.  Each
                     entry also has an associated invalidation timer
                     value (extracted from Router Advertisements) used
                     to delete entries that are no longer advertised.

Narten, et al.              Standards Track                    [Page 34]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Note that the above conceptual data structures can be implemented
   using a variety of techniques.  One possible implementation is to use
   a single longest-match routing table for all of the above data
   structures.  Regardless of the specific implementation, it is
   critical that the Neighbor Cache entry for a router is shared by all
   Destination Cache entries using that router in order to prevent
   redundant Neighbor Unreachability Detection probes.

   Note also that other protocols (e.g., Mobile IPv6) might add
   additional conceptual data structures.  An implementation is at
   liberty to implement such data structures in any way it pleases.  For
   example, an implementation could merge all conceptual data structures
   into a single routing table.

   The Neighbor Cache contains information maintained by the Neighbor
   Unreachability Detection algorithm.  A key piece of information is a
   neighbor's reachability state, which is one of five possible values.
   The following definitions are informal; precise definitions can be
   found in Section 7.3.2.

      INCOMPLETE  Address resolution is in progress and the link-layer
                  address of the neighbor has not yet been determined.

      REACHABLE   Roughly speaking, the neighbor is known to have been
                  reachable recently (within tens of seconds ago).

      STALE       The neighbor is no longer known to be reachable but
                  until traffic is sent to the neighbor, no attempt
                  should be made to verify its reachability.

      DELAY       The neighbor is no longer known to be reachable, and
                  traffic has recently been sent to the neighbor.
                  Rather than probe the neighbor immediately, however,
                  delay sending probes for a short while in order to
                  give upper-layer protocols a chance to provide
                  reachability confirmation.

      PROBE       The neighbor is no longer known to be reachable, and
                  unicast Neighbor Solicitation probes are being sent to
                  verify reachability.

Narten, et al.              Standards Track                    [Page 35]
RFC 4861               Neighbor Discovery in IPv6         September 2007

5.2.  Conceptual Sending Algorithm

   When sending a packet to a destination, a node uses a combination of
   the Destination Cache, the Prefix List, and the Default Router List
   to determine the IP address of the appropriate next hop, an operation
   known as "next-hop determination".  Once the IP address of the next
   hop is known, the Neighbor Cache is consulted for link-layer
   information about that neighbor.

   Next-hop determination for a given unicast destination operates as
   follows.  The sender performs a longest prefix match against the
   Prefix List to determine whether the packet's destination is on- or
   off-link.  If the destination is on-link, the next-hop address is the
   same as the packet's destination address.  Otherwise, the sender
   selects a router from the Default Router List (following the rules
   described in Section 6.3.6).

   For efficiency reasons, next-hop determination is not performed on
   every packet that is sent.  Instead, the results of next-hop
   determination computations are saved in the Destination Cache (which
   also contains updates learned from Redirect messages).  When the
   sending node has a packet to send, it first examines the Destination
   Cache.  If no entry exists for the destination, next-hop
   determination is invoked to create a Destination Cache entry.

   Once the IP address of the next-hop node is known, the sender
   examines the Neighbor Cache for link-layer information about that
   neighbor.  If no entry exists, the sender creates one, sets its state
   to INCOMPLETE, initiates Address Resolution, and then queues the data
   packet pending completion of address resolution.  For multicast-
   capable interfaces Address Resolution consists of sending a Neighbor
   Solicitation message and waiting for a Neighbor Advertisement.  When
   a Neighbor Advertisement response is received, the link-layer
   addresses is entered in the Neighbor Cache entry and the queued
   packet is transmitted.  The address resolution mechanism is described
   in detail in Section 7.2.

   For multicast packets, the next-hop is always the (multicast)
   destination address and is considered to be on-link.  The procedure
   for determining the link-layer address corresponding to a given IP
   multicast address can be found in a separate document that covers
   operating IP over a particular link type (e.g., [IPv6-ETHER]).

Narten, et al.              Standards Track                    [Page 36]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Each time a Neighbor Cache entry is accessed while transmitting a
   unicast packet, the sender checks Neighbor Unreachability Detection
   related information according to the Neighbor Unreachability
   Detection algorithm (Section 7.3).  This unreachability check might
   result in the sender transmitting a unicast Neighbor Solicitation to
   verify that the neighbor is still reachable.

   Next-hop determination is done the first time traffic is sent to a
   destination.  As long as subsequent communication to that destination
   proceeds successfully, the Destination Cache entry continues to be
   used.  If at some point communication ceases to proceed, as
   determined by the Neighbor Unreachability Detection algorithm, next-
   hop determination may need to be performed again.  For example,
   traffic through a failed router should be switched to a working
   router.  Likewise, it may be possible to reroute traffic destined for
   a mobile node to a "mobility agent".

   Note that when a node redoes next-hop determination there is no need
   to discard the complete Destination Cache entry.  In fact, it is
   generally beneficial to retain such cached information as the PMTU
   and round-trip timer values that may also be kept in the Destination
   Cache entry.

   Routers and multihomed hosts have multiple interfaces.  The remainder
   of this document assumes that all sent and received Neighbor
   Discovery messages refer to the interface of appropriate context.
   For example, when responding to a Router Solicitation, the
   corresponding Router Advertisement is sent out the interface on which
   the solicitation was received.

5.3.  Garbage Collection and Timeout Requirements

   The conceptual data structures described above use different
   mechanisms for discarding potentially stale or unused information.

   From the perspective of correctness, there is no need to periodically
   purge Destination and Neighbor Cache entries.  Although stale
   information can potentially remain in the cache indefinitely, the
   Neighbor Unreachability Detection algorithm ensures that stale
   information is purged quickly if it is actually being used.

   To limit the storage needed for the Destination and Neighbor Caches,
   a node may need to garbage-collect old entries.  However, care must
   be taken to ensure that sufficient space is always present to hold
   the working set of active entries.  A small cache may result in an
   excessive number of Neighbor Discovery messages if entries are
   discarded and rebuilt in quick succession.  Any Least Recently Used
   (LRU)-based policy that only reclaims entries that have not been used

Narten, et al.              Standards Track                    [Page 37]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   in some time (e.g., ten minutes or more) should be adequate for
   garbage-collecting unused entries.

   A node should retain entries in the Default Router List and the
   Prefix List until their lifetimes expire.  However, a node may
   garbage-collect entries prematurely if it is low on memory.  If not
   all routers are kept on the Default Router list, a node should retain
   at least two entries in the Default Router List (and preferably more)
   in order to maintain robust connectivity for off-link destinations.

   When removing an entry from the Prefix List, there is no need to
   purge any entries from the Destination or Neighbor Caches.  Neighbor
   Unreachability Detection will efficiently purge any entries in these
   caches that have become invalid.  When removing an entry from the
   Default Router List, however, any entries in the Destination Cache
   that go through that router must perform next-hop determination again
   to select a new default router.

6.  Router and Prefix Discovery

   This section describes router and host behavior related to the Router
   Discovery portion of Neighbor Discovery.  Router Discovery is used to
   locate neighboring routers as well as learn prefixes and
   configuration parameters related to stateless address
   autoconfiguration.

   Prefix Discovery is the process through which hosts learn the ranges
   of IP addresses that reside on-link and can be reached directly
   without going through a router.  Routers send Router Advertisements
   that indicate whether the sender is willing to be a default router.
   Router Advertisements also contain Prefix Information options that
   list the set of prefixes that identify on-link IP addresses.

   Stateless Address Autoconfiguration must also obtain subnet prefixes
   as part of configuring addresses.  Although the prefixes used for
   address autoconfiguration are logically distinct from those used for
   on-link determination, autoconfiguration information is piggybacked
   on Router Discovery messages to reduce network traffic.  Indeed, the
   same prefixes can be advertised for on-link determination and address
   autoconfiguration by specifying the appropriate flags in the Prefix
   Information options.  See [ADDRCONF] for details on how
   autoconfiguration information is processed.

Narten, et al.              Standards Track                    [Page 38]
RFC 4861               Neighbor Discovery in IPv6         September 2007

6.1.  Message Validation

6.1.1.  Validation of Router Solicitation Messages

   Hosts MUST silently discard any received Router Solicitation
   Messages.

   A router MUST silently discard any received Router Solicitation
   messages that do not satisfy all of the following validity checks:

      - The IP Hop Limit field has a value of 255, i.e., the packet
        could not possibly have been forwarded by a router.

      - ICMP Checksum is valid.

      - ICMP Code is 0.

      - ICMP length (derived from the IP length) is 8 or more octets.

      - All included options have a length that is greater than zero.

      - If the IP source address is the unspecified address, there is no
        source link-layer address option in the message.

   The contents of the Reserved field, and of any unrecognized options,
   MUST be ignored.  Future, backward-compatible changes to the protocol
   may specify the contents of the Reserved field or add new options;
   backward-incompatible changes may use different Code values.

   The contents of any defined options that are not specified to be used
   with Router Solicitation messages MUST be ignored and the packet
   processed as normal.  The only defined option that may appear is the
   Source Link-Layer Address option.

   A solicitation that passes the validity checks is called a "valid
   solicitation".

6.1.2.  Validation of Router Advertisement Messages

   A node MUST silently discard any received Router Advertisement
   messages that do not satisfy all of the following validity checks:

      - IP Source Address is a link-local address.  Routers must use
        their link-local address as the source for Router Advertisement
        and Redirect messages so that hosts can uniquely identify
        routers.

Narten, et al.              Standards Track                    [Page 39]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      - The IP Hop Limit field has a value of 255, i.e., the packet
        could not possibly have been forwarded by a router.

      - ICMP Checksum is valid.

      - ICMP Code is 0.

      - ICMP length (derived from the IP length) is 16 or more octets.

      - All included options have a length that is greater than zero.

   The contents of the Reserved field, and of any unrecognized options,
   MUST be ignored.  Future, backward-compatible changes to the protocol
   may specify the contents of the Reserved field or add new options;
   backward-incompatible changes may use different Code values.

   The contents of any defined options that are not specified to be used
   with Router Advertisement messages MUST be ignored and the packet
   processed as normal.  The only defined options that may appear are
   the Source Link-Layer Address, Prefix Information and MTU options.

   An advertisement that passes the validity checks is called a "valid
   advertisement".

6.2.  Router Specification

6.2.1.  Router Configuration Variables

   A router MUST allow for the following conceptual variables to be
   configured by system management.  The specific variable names are
   used for demonstration purposes only, and an implementation is not
   required to have them, so long as its external behavior is consistent
   with that described in this document.  Default values are specified
   to simplify configuration in common cases.

   The default values for some of the variables listed below may be
   overridden by specific documents that describe how IPv6 operates over
   different link layers.  This rule simplifies the configuration of
   Neighbor Discovery over link types with widely differing performance
   characteristics.

Narten, et al.              Standards Track                    [Page 40]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   For each interface:

      IsRouter       A flag indicating whether routing is enabled on
                     this interface.  Enabling routing on the interface
                     would imply that a router can forward packets to or
                     from the interface.

                     Default: FALSE

      AdvSendAdvertisements
                     A flag indicating whether or not the router sends
                     periodic Router Advertisements and responds to
                     Router Solicitations.

                     Default: FALSE

                     Note that AdvSendAdvertisements MUST be FALSE by
                     default so that a node will not accidentally start
                     acting as a router unless it is explicitly
                     configured by system management to send Router
                     Advertisements.

      MaxRtrAdvInterval
                     The maximum time allowed between sending
                     unsolicited multicast Router Advertisements from
                     the interface, in seconds.  MUST be no less than 4
                     seconds and no greater than 1800 seconds.

                     Default: 600 seconds

      MinRtrAdvInterval
                     The minimum time allowed between sending
                     unsolicited multicast Router Advertisements from
                     the interface, in seconds.  MUST be no less than 3
                     seconds and no greater than .75 *
                     MaxRtrAdvInterval.

                     Default: 0.33 * MaxRtrAdvInterval If
                     MaxRtrAdvInterval >= 9 seconds; otherwise, the
                     Default is MaxRtrAdvInterval.

      AdvManagedFlag
                     The TRUE/FALSE value to be placed in the "Managed
                     address configuration" flag field in the Router
                     Advertisement.  See [ADDRCONF].

                     Default: FALSE

Narten, et al.              Standards Track                    [Page 41]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      AdvOtherConfigFlag
                     The TRUE/FALSE value to be placed in the "Other
                     configuration" flag field in the Router
                     Advertisement.  See [ADDRCONF].

                     Default: FALSE

      AdvLinkMTU     The value to be placed in MTU options sent by the
                     router.  A value of zero indicates that no MTU
                     options are sent.

                     Default: 0

      AdvReachableTime
                     The value to be placed in the Reachable Time field
                     in the Router Advertisement messages sent by the
                     router.  The value zero means unspecified (by this
                     router).  MUST be no greater than 3,600,000
                     milliseconds (1 hour).

                     Default: 0

      AdvRetransTimer The value to be placed in the Retrans Timer field
                     in the Router Advertisement messages sent by the
                     router.  The value zero means unspecified (by this
                     router).

                     Default: 0

      AdvCurHopLimit
                     The default value to be placed in the Cur Hop Limit
                     field in the Router Advertisement messages sent by
                     the router.  The value should be set to the current
                     diameter of the Internet.  The value zero means
                     unspecified (by this router).

                     Default:  The value specified in the "Assigned
                     Numbers" [ASSIGNED] that was in effect at the time
                     of implementation.

Narten, et al.              Standards Track                    [Page 42]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      AdvDefaultLifetime
                     The value to be placed in the Router Lifetime field
                     of Router Advertisements sent from the interface,
                     in seconds.  MUST be either zero or between
                     MaxRtrAdvInterval and 9000 seconds.  A value of
                     zero indicates that the router is not to be used as
                     a default router.  These limits may be overridden
                     by specific documents that describe how IPv6
                     operates over different link layers.  For instance,
                     in a point-to-point link the peers may have enough
                     information about the number and status of devices
                     at the other end so that advertisements are needed
                     less frequently.

                     Default: 3 * MaxRtrAdvInterval

      AdvPrefixList
                     A list of prefixes to be placed in Prefix
                     Information options in Router Advertisement
                     messages sent from the interface.

                     Default: all prefixes that the router advertises
                     via routing protocols as being on-link for the
                     interface from which the advertisement is sent.
                     The link-local prefix SHOULD NOT be included in the
                     list of advertised prefixes.

                     Each prefix has an associated:

                        AdvValidLifetime
                             The value to be placed in the Valid
                             Lifetime in the Prefix Information option,
                             in seconds.  The designated value of all
                             1's (0xffffffff) represents infinity.
                             Implementations MAY allow AdvValidLifetime
                             to be specified in two ways:

                               - a time that decrements in real time,
                                 that is, one that will result in a
                                 Lifetime of zero at the specified time
                                 in the future, or

                               - a fixed time that stays the same in
                                 consecutive advertisements.

                             Default: 2592000 seconds (30 days), fixed
                             (i.e., stays the same in consecutive
                             advertisements).

Narten, et al.              Standards Track                    [Page 43]
RFC 4861               Neighbor Discovery in IPv6         September 2007

                        AdvOnLinkFlag
                             The value to be placed in the on-link flag
                             ("L-bit") field in the Prefix Information
                             option.

                             Default: TRUE

                   Stateless address configuration [ADDRCONF] defines
                   additional information associated with each of the
                   prefixes:

                        AdvPreferredLifetime
                             The value to be placed in the Preferred
                             Lifetime in the Prefix Information option,
                             in seconds.  The designated value of all
                             1's (0xffffffff) represents infinity.  See
                             [ADDRCONF] for details on how this value is
                             used.  Implementations MAY allow
                             AdvPreferredLifetime to be specified in two
                             ways:

                               - a time that decrements in real time,
                                 that is, one that will result in a
                                 Lifetime of zero at a specified time in
                                 the future, or

                               - a fixed time that stays the same in
                                 consecutive advertisements.

                             Default: 604800 seconds (7 days), fixed
                             (i.e., stays the same in consecutive
                             advertisements).  This value MUST NOT be
                             larger than AdvValidLifetime.

                        AdvAutonomousFlag
                             The value to be placed in the Autonomous
                             Flag field in the Prefix Information
                             option.  See [ADDRCONF].

                             Default: TRUE

   The above variables contain information that is placed in outgoing
   Router Advertisement messages.  Hosts use the received information to
   initialize a set of analogous variables that control their external
   behavior (see Section 6.3.2).  Some of these host variables (e.g.,
   CurHopLimit, RetransTimer, and ReachableTime) apply to all nodes
   including routers.  In practice, these variables may not actually be
   present on routers, since their contents can be derived from the

Narten, et al.              Standards Track                    [Page 44]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   variables described above.  However, external router behavior MUST be
   the same as host behavior with respect to these variables.  In
   particular, this includes the occasional randomization of the
   ReachableTime value as described in Section 6.3.2.

   Protocol constants are defined in Section 10.

6.2.2.  Becoming an Advertising Interface

   The term "advertising interface" refers to any functioning and
   enabled interface that has at least one unicast IP address assigned
   to it and whose corresponding AdvSendAdvertisements flag is TRUE.  A
   router MUST NOT send Router Advertisements out any interface that is
   not an advertising interface.

   An interface may become an advertising interface at times other than
   system startup.  For example:

      - changing the AdvSendAdvertisements flag on an enabled interface
        from FALSE to TRUE, or

      - administratively enabling the interface, if it had been
        administratively disabled, and its AdvSendAdvertisements flag is
        TRUE, or

      - enabling IP forwarding capability (i.e., changing the system
        from being a host to being a router), when the interface's
        AdvSendAdvertisements flag is TRUE.

   A router MUST join the all-routers multicast address on an
   advertising interface.  Routers respond to Router Solicitations sent
   to the all-routers address and verify the consistency of Router
   Advertisements sent by neighboring routers.

6.2.3.  Router Advertisement Message Content

   A router sends periodic as well as solicited Router Advertisements
   out its advertising interfaces.  Outgoing Router Advertisements are
   filled with the following values consistent with the message format
   given in Section 4.2:

      - In the Router Lifetime field: the interface's configured
        AdvDefaultLifetime.

      - In the M and O flags: the interface's configured AdvManagedFlag
        and AdvOtherConfigFlag, respectively.

Narten, et al.              Standards Track                    [Page 45]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      - In the Cur Hop Limit field: the interface's configured
        CurHopLimit.

      - In the Reachable Time field: the interface's configured
        AdvReachableTime.

      - In the Retrans Timer field: the interface's configured
        AdvRetransTimer.

      - In the options:

           o Source Link-Layer Address option: link-layer address of the
             sending interface.  This option MAY be omitted to
             facilitate in-bound load balancing over replicated
             interfaces.

           o MTU option: the interface's configured AdvLinkMTU value if
             the value is non-zero.  If AdvLinkMTU is zero, the MTU
             option is not sent.

           o Prefix Information options: one Prefix Information option
             for each prefix listed in AdvPrefixList with the option
             fields set from the information in the AdvPrefixList entry
             as follows:

                - In the "on-link" flag: the entry's AdvOnLinkFlag.

                - In the Valid Lifetime field: the entry's
                  AdvValidLifetime.

                - In the "Autonomous address configuration" flag: the
                  entry's AdvAutonomousFlag.

                - In the Preferred Lifetime field: the entry's
                  AdvPreferredLifetime.

   A router might want to send Router Advertisements without advertising
   itself as a default router.  For instance, a router might advertise
   prefixes for stateless address autoconfiguration while not wishing to
   forward packets.  Such a router sets the Router Lifetime field in
   outgoing advertisements to zero.

   A router MAY choose not to include some or all options when sending
   unsolicited Router Advertisements.  For example, if prefix lifetimes
   are much longer than AdvDefaultLifetime, including them every few
   advertisements may be sufficient.  However, when responding to a
   Router Solicitation or while sending the first few initial

Narten, et al.              Standards Track                    [Page 46]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   unsolicited advertisements, a router SHOULD include all options so
   that all information (e.g., prefixes) is propagated quickly during
   system initialization.

   If including all options causes the size of an advertisement to
   exceed the link MTU, multiple advertisements can be sent, each
   containing a subset of the options.

6.2.4.  Sending Unsolicited Router Advertisements

   A host MUST NOT send Router Advertisement messages at any time.

   Unsolicited Router Advertisements are not strictly periodic: the
   interval between subsequent transmissions is randomized to reduce the
   probability of synchronization with the advertisements from other
   routers on the same link [SYNC].  Each advertising interface has its
   own timer.  Whenever a multicast advertisement is sent from an
   interface, the timer is reset to a uniformly distributed random value
   between the interface's configured MinRtrAdvInterval and
   MaxRtrAdvInterval; expiration of the timer causes the next
   advertisement to be sent and a new random value to be chosen.

   For the first few advertisements (up to
   MAX_INITIAL_RTR_ADVERTISEMENTS) sent from an interface when it
   becomes an advertising interface, if the randomly chosen interval is
   greater than MAX_INITIAL_RTR_ADVERT_INTERVAL, the timer SHOULD be set
   to MAX_INITIAL_RTR_ADVERT_INTERVAL instead.  Using a smaller interval
   for the initial advertisements increases the likelihood of a router
   being discovered quickly when it first becomes available, in the
   presence of possible packet loss.

   The information contained in Router Advertisements may change through
   actions of system management.  For instance, the lifetime of
   advertised prefixes may change, new prefixes could be added, a router
   could cease to be a router (i.e., switch from being a router to being
   a host), etc.  In such cases, the router MAY transmit up to
   MAX_INITIAL_RTR_ADVERTISEMENTS unsolicited advertisements, using the
   same rules as when an interface becomes an advertising interface.

6.2.5.  Ceasing To Be an Advertising Interface

   An interface may cease to be an advertising interface, through
   actions of system management such as:

      - changing the AdvSendAdvertisements flag of an enabled interface
        from TRUE to FALSE, or

      - administratively disabling the interface, or

Narten, et al.              Standards Track                    [Page 47]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      - shutting down the system.

   In such cases, the router SHOULD transmit one or more (but not more
   than MAX_FINAL_RTR_ADVERTISEMENTS) final multicast Router
   Advertisements on the interface with a Router Lifetime field of zero.
   In the case of a router becoming a host, the system SHOULD also
   depart from the all-routers IP multicast group on all interfaces on
   which the router supports IP multicast (whether or not they had been
   advertising interfaces).  In addition, the host MUST ensure that
   subsequent Neighbor Advertisement messages sent from the interface
   have the Router flag set to zero.

   Note that system management may disable a router's IP forwarding
   capability (i.e., changing the system from being a router to being a
   host), a step that does not necessarily imply that the router's
   interfaces stop being advertising interfaces.  In such cases,
   subsequent Router Advertisements MUST set the Router Lifetime field
   to zero.

6.2.6.  Processing Router Solicitations

   A host MUST silently discard any received Router Solicitation
   messages.

   In addition to sending periodic, unsolicited advertisements, a router
   sends advertisements in response to valid solicitations received on
   an advertising interface.  A router MAY choose to unicast the
   response directly to the soliciting host's address (if the
   solicitation's source address is not the unspecified address), but
   the usual case is to multicast the response to the all-nodes group.
   In the latter case, the interface's interval timer is reset to a new
   random value, as if an unsolicited advertisement had just been sent
   (see Section 6.2.4).

   In all cases, Router Advertisements sent in response to a Router
   Solicitation MUST be delayed by a random time between 0 and
   MAX_RA_DELAY_TIME seconds. (If a single advertisement is sent in
   response to multiple solicitations, the delay is relative to the
   first solicitation.)  In addition, consecutive Router Advertisements
   sent to the all-nodes multicast address MUST be rate limited to no
   more than one advertisement every MIN_DELAY_BETWEEN_RAS seconds.

Narten, et al.              Standards Track                    [Page 48]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   A router might process Router Solicitations as follows:

    - Upon receipt of a Router Solicitation, compute a random delay
      within the range 0 through MAX_RA_DELAY_TIME.  If the computed
      value corresponds to a time later than the time the next multicast
      Router Advertisement is scheduled to be sent, ignore the random
      delay and send the advertisement at the already-scheduled time.

    - If the router sent a multicast Router Advertisement (solicited or
      unsolicited) within the last MIN_DELAY_BETWEEN_RAS seconds,
      schedule the advertisement to be sent at a time corresponding to
      MIN_DELAY_BETWEEN_RAS plus the random value after the previous
      advertisement was sent.  This ensures that the multicast Router
      Advertisements are rate limited.

    - Otherwise, schedule the sending of a Router Advertisement at the
      time given by the random value.

   Note that a router is permitted to send multicast Router
   Advertisements more frequently than indicated by the
   MinRtrAdvInterval configuration variable so long as the more frequent
   advertisements are responses to Router Solicitations.  In all cases,
   however, unsolicited multicast advertisements MUST NOT be sent more
   frequently than indicated by MinRtrAdvInterval.

   Router Solicitations in which the Source Address is the unspecified
   address MUST NOT update the router's Neighbor Cache; solicitations
   with a proper source address update the Neighbor Cache as follows.
   If the router already has a Neighbor Cache entry for the
   solicitation's sender, the solicitation contains a Source Link-Layer
   Address option, and the received link-layer address differs from that
   already in the cache, then the link-layer address SHOULD be updated
   in the appropriate Neighbor Cache entry, and its reachability state
   MUST also be set to STALE.  If there is no existing Neighbor Cache
   entry for the solicitation's sender, the router creates one, installs
   the link- layer address and sets its reachability state to STALE as
   specified in Section 7.3.3.  If there is no existing Neighbor Cache
   entry and no Source Link-Layer Address option was present in the
   solicitation, the router may respond with either a multicast or a
   unicast router advertisement.  Whether or not a Source Link-Layer
   Address option is provided, if a Neighbor Cache entry for the
   solicitation's sender exists (or is created) the entry's IsRouter
   flag MUST be set to FALSE.

Narten, et al.              Standards Track                    [Page 49]
RFC 4861               Neighbor Discovery in IPv6         September 2007

6.2.7.  Router Advertisement Consistency

   Routers SHOULD inspect valid Router Advertisements sent by other
   routers and verify that the routers are advertising consistent
   information on a link.  Detected inconsistencies indicate that one or
   more routers might be misconfigured and SHOULD be logged to system or
   network management.  The minimum set of information to check
   includes:

    - Cur Hop Limit values (except for the unspecified value of zero
      other inconsistencies SHOULD be logged to system network
      management).

    - Values of the M or O flags.

    - Reachable Time values (except for the unspecified value of zero).

    - Retrans Timer values (except for the unspecified value of zero).

    - Values in the MTU options.

    - Preferred and Valid Lifetimes for the same prefix.  If
      AdvPreferredLifetime and/or AdvValidLifetime decrement in real
      time as specified in Section 6.2.1 then the comparison of the
      lifetimes cannot compare the content of the fields in the Router
      Advertisement, but must instead compare the time at which the
      prefix will become deprecated and invalidated, respectively.  Due
      to link propagation delays and potentially poorly synchronized
      clocks between the routers such comparison SHOULD allow some time
      skew.

   Note that it is not an error for different routers to advertise
   different sets of prefixes.  Also, some routers might leave some
   fields as unspecified, i.e., with the value zero, while other routers
   specify values.  The logging of errors SHOULD be restricted to
   conflicting information that causes hosts to switch from one value to
   another with each received advertisement.

   Any other action on reception of Router Advertisement messages by a
   router is beyond the scope of this document.

6.2.8.  Link-local Address Change

   The link-local address on a router should rarely change, if ever.
   Nodes receiving Neighbor Discovery messages use the source address to
   identify the sender.  If multiple packets from the same router
   contain different source addresses, nodes will assume they come from
   different routers, leading to undesirable behavior.  For example, a

Narten, et al.              Standards Track                    [Page 50]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   node will ignore Redirect messages that are believed to have been
   sent by a router other than the current first-hop router.  Thus, the
   source address used in Router Advertisements sent by a particular
   router must be identical to the target address in a Redirect message
   when redirecting to that router.

   Using the link-local address to uniquely identify routers on the link
   has the benefit that the address a router is known by should not
   change when a site renumbers.

   If a router changes the link-local address for one of its interfaces,
   it SHOULD inform hosts of this change.  The router SHOULD multicast a
   few Router Advertisements from the old link-local address with the
   Router Lifetime field set to zero and also multicast a few Router
   Advertisements from the new link-local address.  The overall effect
   should be the same as if one interface ceases being an advertising
   interface, and a different one starts being an advertising interface.

6.3.  Host Specification

6.3.1.  Host Configuration Variables

   None.

6.3.2.  Host Variables

   A host maintains certain Neighbor-Discovery-related variables in
   addition to the data structures defined in Section 5.1.  The specific
   variable names are used for demonstration purposes only, and an
   implementation is not required to have them, so long as its external
   behavior is consistent with that described in this document.

   These variables have default values that are overridden by
   information received in Router Advertisement messages.  The default
   values are used when there is no router on the link or when all
   received Router Advertisements have left a particular value
   unspecified.

   The default values in this specification may be overridden by
   specific documents that describe how IP operates over different link
   layers.  This rule allows Neighbor Discovery to operate over links
   with widely varying performance characteristics.

Narten, et al.              Standards Track                    [Page 51]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   For each interface:

        LinkMTU        The MTU of the link.
                       Default: The valued defined in the specific
                       document that describes how IPv6 operates over
                       the particular link layer (e.g., [IPv6-ETHER]).

        CurHopLimit    The default hop limit to be used when sending IP
                       packets.

                       Default: The value specified in the "Assigned
                       Numbers" [ASSIGNED] that was in effect at the
                       time of implementation.

        BaseReachableTime
                       A base value used for computing the random
                       ReachableTime value.

                       Default: REACHABLE_TIME milliseconds.

        ReachableTime  The time a neighbor is considered reachable after
                       receiving a reachability confirmation.

                       This value should be a uniformly distributed
                       random value between MIN_RANDOM_FACTOR and
                       MAX_RANDOM_FACTOR times BaseReachableTime
                       milliseconds.  A new random value should be
                       calculated when BaseReachableTime changes (due to
                       Router Advertisements) or at least every few
                       hours even if no Router Advertisements are
                       received.

        RetransTimer   The time between retransmissions of Neighbor
                       Solicitation messages to a neighbor when
                       resolving the address or when probing the
                       reachability of a neighbor.

                       Default: RETRANS_TIMER milliseconds

6.3.3.  Interface Initialization

   The host joins the all-nodes multicast address on all multicast-
   capable interfaces.

Narten, et al.              Standards Track                    [Page 52]
RFC 4861               Neighbor Discovery in IPv6         September 2007

6.3.4.  Processing Received Router Advertisements

   When multiple routers are present, the information advertised
   collectively by all routers may be a superset of the information
   contained in a single Router Advertisement.  Moreover, information
   may also be obtained through other dynamic means like DHCPv6.  Hosts
   accept the union of all received information; the receipt of a Router
   Advertisement MUST NOT invalidate all information received in a
   previous advertisement or from another source.  However, when
   received information for a specific parameter (e.g., Link MTU) or
   option (e.g., Lifetime on a specific Prefix) differs from information
   received earlier, and the parameter/option can only have one value,
   the most recently received information is considered authoritative.

   A Router Advertisement field (e.g., Cur Hop Limit, Reachable Time,
   and Retrans Timer) may contain a value denoting that it is
   unspecified.  In such cases, the parameter should be ignored and the
   host should continue using whatever value it is already using.  In
   particular, a host MUST NOT interpret the unspecified value as
   meaning change back to the default value that was in use before the
   first Router Advertisement was received.  This rule prevents hosts
   from continually changing an internal variable when one router
   advertises a specific value, but other routers advertise the
   unspecified value.

   On receipt of a valid Router Advertisement, a host extracts the
   source address of the packet and does the following:

      - If the address is not already present in the host's Default
        Router List, and the advertisement's Router Lifetime is non-
        zero, create a new entry in the list, and initialize its
        invalidation timer value from the advertisement's Router
        Lifetime field.

      - If the address is already present in the host's Default Router
        List as a result of a previously received advertisement, reset
        its invalidation timer to the Router Lifetime value in the newly
        received advertisement.

      - If the address is already present in the host's Default Router
        List and the received Router Lifetime value is zero, immediately
        time-out the entry as specified in Section 6.3.5.

   To limit the storage needed for the Default Router List, a host MAY
   choose not to store all of the router addresses discovered via
   advertisements.  However, a host MUST retain at least two router
   addresses and SHOULD retain more.  Default router selections are made
   whenever communication to a destination appears to be failing.  Thus,

Narten, et al.              Standards Track                    [Page 53]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   the more routers on the list, the more likely an alternative working
   router can be found quickly (e.g., without having to wait for the
   next advertisement to arrive).

   If the received Cur Hop Limit value is non-zero, the host SHOULD set
   its CurHopLimit variable to the received value.

   If the received Reachable Time value is non-zero, the host SHOULD set
   its BaseReachableTime variable to the received value.  If the new
   value differs from the previous value, the host SHOULD re-compute a
   new random ReachableTime value.  ReachableTime is computed as a
   uniformly distributed random value between MIN_RANDOM_FACTOR and
   MAX_RANDOM_FACTOR times the BaseReachableTime.  Using a random
   component eliminates the possibility that Neighbor Unreachability
   Detection messages will synchronize with each other.

   In most cases, the advertised Reachable Time value will be the same
   in consecutive Router Advertisements, and a host's BaseReachableTime
   rarely changes.  In such cases, an implementation SHOULD ensure that
   a new random value gets re-computed at least once every few hours.

   The RetransTimer variable SHOULD be copied from the Retrans Timer
   field, if the received value is non-zero.

   After extracting information from the fixed part of the Router
   Advertisement message, the advertisement is scanned for valid
   options.  If the advertisement contains a Source Link-Layer Address
   option, the link-layer address SHOULD be recorded in the Neighbor
   Cache entry for the router (creating an entry if necessary) and the
   IsRouter flag in the Neighbor Cache entry MUST be set to TRUE.  If no
   Source Link-Layer Address is included, but a corresponding Neighbor
   Cache entry exists, its IsRouter flag MUST be set to TRUE.  The
   IsRouter flag is used by Neighbor Unreachability Detection to
   determine when a router changes to being a host (i.e., no longer
   capable of forwarding packets).  If a Neighbor Cache entry is created
   for the router, its reachability state MUST be set to STALE as
   specified in Section 7.3.3.  If a cache entry already exists and is
   updated with a different link-layer address, the reachability state
   MUST also be set to STALE.

   If the MTU option is present, hosts SHOULD copy the option's value
   into LinkMTU so long as the value is greater than or equal to the
   minimum link MTU [IPv6] and does not exceed the maximum LinkMTU value
   specified in the link-type-specific document (e.g., [IPv6-ETHER]).

   Prefix Information options that have the "on-link" (L) flag set
   indicate a prefix identifying a range of addresses that should be
   considered on-link.  Note, however, that a Prefix Information option

Narten, et al.              Standards Track                    [Page 54]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   with the on-link flag set to zero conveys no information concerning
   on-link determination and MUST NOT be interpreted to mean that
   addresses covered by the prefix are off-link.  The only way to cancel
   a previous on-link indication is to advertise that prefix with the
   L-bit set and the Lifetime set to zero.  The default behavior (see
   Section 5.2) when sending a packet to an address for which no
   information is known about the on-link status of the address is to
   forward the packet to a default router; the reception of a Prefix
   Information option with the "on-link" (L) flag set to zero does not
   change this behavior.  The reasons for an address being treated as
   on-link is specified in the definition of "on-link" in Section 2.1.
   Prefixes with the on-link flag set to zero would normally have the
   autonomous flag set and be used by [ADDRCONF].

   For each Prefix Information option with the on-link flag set, a host
   does the following:

      - If the prefix is the link-local prefix, silently ignore the
        Prefix Information option.

      - If the prefix is not already present in the Prefix List, and the
        Prefix Information option's Valid Lifetime field is non-zero,
        create a new entry for the prefix and initialize its
        invalidation timer to the Valid Lifetime value in the Prefix
        Information option.

      - If the prefix is already present in the host's Prefix List as
        the result of a previously received advertisement, reset its
        invalidation timer to the Valid Lifetime value in the Prefix
        Information option.  If the new Lifetime value is zero, time-out
        the prefix immediately (see Section 6.3.5).

      - If the Prefix Information option's Valid Lifetime field is zero,
        and the prefix is not present in the host's Prefix List,
        silently ignore the option.

   Stateless address autoconfiguration [ADDRCONF] may in some
   circumstances use a larger Valid Lifetime of a prefix or ignore it
   completely in order to prevent a particular denial-of-service attack.
   However, since the effect of the same denial of service targeted at
   the on-link prefix list is not catastrophic (hosts would send packets
   to a default router and receive a redirect rather than sending
   packets directly to a neighbor), the Neighbor Discovery protocol does
   not impose such a check on the prefix lifetime values.  Similarly,
   [ADDRCONF] may impose certain restrictions on the prefix length for
   address configuration purposes.  Therefore, the prefix might be
   rejected by [ADDRCONF] implementation in the host.  However, the

Narten, et al.              Standards Track                    [Page 55]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   prefix length is still valid for on-link determination when combined
   with other flags in the prefix option.

      Note: Implementations can choose to process the on-link aspects of
      the prefixes separately from the stateless address
      autoconfiguration aspects of the prefixes by, e.g., passing a copy
      of each valid Router Advertisement message to both an "on-link"
      and an "addrconf" function.  Each function can then operate
      independently on the prefixes that have the appropriate flag set.

6.3.5.  Timing out Prefixes and Default Routers

   Whenever the invalidation timer expires for a Prefix List entry, that
   entry is discarded.  No existing Destination Cache entries need be
   updated, however.  Should a reachability problem arise with an
   existing Neighbor Cache entry, Neighbor Unreachability Detection will
   perform any needed recovery.

   Whenever the Lifetime of an entry in the Default Router List expires,
   that entry is discarded.  When removing a router from the Default
   Router list, the node MUST update the Destination Cache in such a way
   that all entries using the router perform next-hop determination
   again rather than continue sending traffic to the (deleted) router.

6.3.6.  Default Router Selection

   The algorithm for selecting a router depends in part on whether or
   not a router is known to be reachable.  The exact details of how a
   node keeps track of a neighbor's reachability state are covered in
   Section 7.3.  The algorithm for selecting a default router is invoked
   during next-hop determination when no Destination Cache entry exists
   for an off-link destination or when communication through an existing
   router appears to be failing.  Under normal conditions, a router
   would be selected the first time traffic is sent to a destination,
   with subsequent traffic for that destination using the same router as
   indicated in the Destination Cache modulo any changes to the
   Destination Cache caused by Redirect messages.

   The policy for selecting routers from the Default Router List is as
   follows:

     1) Routers that are reachable or probably reachable (i.e., in any
        state other than INCOMPLETE) SHOULD be preferred over routers
        whose reachability is unknown or suspect (i.e., in the
        INCOMPLETE state, or for which no Neighbor Cache entry exists).
        Further implementation hints on default router selection when
        multiple equivalent routers are available are discussed in
        [LD-SHRE].

Narten, et al.              Standards Track                    [Page 56]
RFC 4861               Neighbor Discovery in IPv6         September 2007

     2) When no routers on the list are known to be reachable or
        probably reachable, routers SHOULD be selected in a round-robin
        fashion, so that subsequent requests for a default router do not
        return the same router until all other routers have been
        selected.

        Cycling through the router list in this case ensures that all
        available routers are actively probed by the Neighbor
        Unreachability Detection algorithm.  A request for a default
        router is made in conjunction with the sending of a packet to a
        router, and the selected router will be probed for reachability
        as a side effect.

6.3.7.  Sending Router Solicitations

   When an interface becomes enabled, a host may be unwilling to wait
   for the next unsolicited Router Advertisement to locate default
   routers or learn prefixes.  To obtain Router Advertisements quickly,
   a host SHOULD transmit up to MAX_RTR_SOLICITATIONS Router
   Solicitation messages, each separated by at least
   RTR_SOLICITATION_INTERVAL seconds.  Router Solicitations may be sent
   after any of the following events:

      - The interface is initialized at system startup time.

      - The interface is reinitialized after a temporary interface
        failure or after being temporarily disabled by system
        management.

      - The system changes from being a router to being a host, by
        having its IP forwarding capability turned off by system
        management.

      - The host attaches to a link for the first time.

      - The host re-attaches to a link after being detached for some
        time.

   A host sends Router Solicitations to the all-routers multicast
   address.  The IP source address is set to either one of the
   interface's unicast addresses or the unspecified address.  The Source
   Link-Layer Address option SHOULD be set to the host's link-layer
   address, if the IP source address is not the unspecified address.

   Before a host sends an initial solicitation, it SHOULD delay the
   transmission for a random amount of time between 0 and
   MAX_RTR_SOLICITATION_DELAY.  This serves to alleviate congestion when
   many hosts start up on a link at the same time, such as might happen

Narten, et al.              Standards Track                    [Page 57]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   after recovery from a power failure.  If a host has already performed
   a random delay since the interface became (re)enabled (e.g., as part
   of Duplicate Address Detection [ADDRCONF]), there is no need to delay
   again before sending the first Router Solicitation message.

   In some cases, the random delay MAY be omitted if necessary.  For
   instance, a mobile node, using [MIPv6], moving to a new link would
   need to discover such movement as soon as possible to minimize the
   amount of packet losses resulting from the change in its topological
   movement.  Router Solicitations provide a useful tool for movement
   detection in Mobile IPv6 as they allow mobile nodes to determine
   movement to new links.  Hence, if a mobile node received link-layer
   information indicating that movement might have taken place, it MAY
   send a Router Solicitation immediately, without random delays.  The
   strength of such indications should be assessed by the mobile node's
   implementation depending on the level of certainty of the link-layer
   hints, and it is outside the scope of this specification.  Note that
   using this mechanism inappropriately (e.g., based on weak or
   transient indications) may result in Router Solicitation storms.
   Furthermore, simultaneous mobility of a large number of mobile nodes
   that use this mechanism can result in a large number of solicitations
   sent simultaneously.

   Once the host sends a Router Solicitation, and receives a valid
   Router Advertisement with a non-zero Router Lifetime, the host MUST
   desist from sending additional solicitations on that interface, until
   the next time one of the above events occurs.  Moreover, a host
   SHOULD send at least one solicitation in the case where an
   advertisement is received prior to having sent a solicitation.
   Responses to solicited advertisements may contain more information
   than unsolicited advertisements.

   If a host sends MAX_RTR_SOLICITATIONS solicitations, and receives no
   Router Advertisements after having waited MAX_RTR_SOLICITATION_DELAY
   seconds after sending the last solicitation, the host concludes that
   there are no routers on the link for the purpose of [ADDRCONF].
   However, the host continues to receive and process Router
   Advertisements messages in the event that routers appear on the link.

Narten, et al.              Standards Track                    [Page 58]
RFC 4861               Neighbor Discovery in IPv6         September 2007

7.  Address Resolution and Neighbor Unreachability Detection

   This section describes the functions related to Neighbor Solicitation
   and Neighbor Advertisement messages and includes descriptions of
   address resolution and the Neighbor Unreachability Detection
   algorithm.

   Neighbor Solicitation and Advertisement messages are also used for
   Duplicate Address Detection as specified by [ADDRCONF].  In
   particular, Duplicate Address Detection sends Neighbor Solicitation
   messages with an unspecified source address targeting its own
   "tentative" address.  Such messages trigger nodes already using the
   address to respond with a multicast Neighbor Advertisement indicating
   that the address is in use.

7.1.  Message Validation

7.1.1.  Validation of Neighbor Solicitations

   A node MUST silently discard any received Neighbor Solicitation
   messages that do not satisfy all of the following validity checks:

      - The IP Hop Limit field has a value of 255, i.e., the packet
        could not possibly have been forwarded by a router.

      - ICMP Checksum is valid.

      - ICMP Code is 0.

      - ICMP length (derived from the IP length) is 24 or more octets.

      - Target Address is not a multicast address.

      - All included options have a length that is greater than zero.

      - If the IP source address is the unspecified address, the IP
        destination address is a solicited-node multicast address.

      - If the IP source address is the unspecified address, there is no
        source link-layer address option in the message.

   The contents of the Reserved field, and of any unrecognized options,
   MUST be ignored.  Future, backward-compatible changes to the protocol
   may specify the contents of the Reserved field or add new options;
   backward-incompatible changes may use different Code values.

Narten, et al.              Standards Track                    [Page 59]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   The contents of any defined options that are not specified to be used
   with Neighbor Solicitation messages MUST be ignored and the packet
   processed as normal.  The only defined option that may appear is the
   Source Link-Layer Address option.

   A Neighbor Solicitation that passes the validity checks is called a
   "valid solicitation".

7.1.2.  Validation of Neighbor Advertisements

   A node MUST silently discard any received Neighbor Advertisement
   messages that do not satisfy all of the following validity checks:

      - The IP Hop Limit field has a value of 255, i.e., the packet
        could not possibly have been forwarded by a router.

      - ICMP Checksum is valid.

      - ICMP Code is 0.

      - ICMP length (derived from the IP length) is 24 or more octets.

      - Target Address is not a multicast address.

      - If the IP Destination Address is a multicast address the
        Solicited flag is zero.

      - All included options have a length that is greater than zero.

   The contents of the Reserved field, and of any unrecognized options,
   MUST be ignored.  Future, backward-compatible changes to the protocol
   may specify the contents of the Reserved field or add new options;
   backward-incompatible changes may use different Code values.

   The contents of any defined options that are not specified to be used
   with Neighbor Advertisement messages MUST be ignored and the packet
   processed as normal.  The only defined option that may appear is the
   Target Link-Layer Address option.

   A Neighbor Advertisements that passes the validity checks is called a
   "valid advertisement".

7.2.  Address Resolution

   Address resolution is the process through which a node determines the
   link-layer address of a neighbor given only its IP address.  Address
   resolution is performed only on addresses that are determined to be
   on-link and for which the sender does not know the corresponding

Narten, et al.              Standards Track                    [Page 60]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   link-layer address (see Section 5.2).  Address resolution is never
   performed on multicast addresses.

   It is possible that a host may receive a solicitation, a router
   advertisement, or a Redirect message without a link-layer address
   option included.  These messages MUST NOT create or update neighbor
   cache entries, except with respect to the IsRouter flag as specified
   in Sections 6.3.4 and 7.2.5.  If a Neighbor Cache entry does not
   exist for the source of such a message, Address Resolution will be
   required before unicast communications with that address can begin.
   This is particularly relevant for unicast responses to solicitations
   where an additional packet exchange is required for advertisement
   delivery.

7.2.1.  Interface Initialization

   When a multicast-capable interface becomes enabled, the node MUST
   join the all-nodes multicast address on that interface, as well as
   the solicited-node multicast address corresponding to each of the IP
   addresses assigned to the interface.

   The set of addresses assigned to an interface may change over time.
   New addresses might be added and old addresses might be removed
   [ADDRCONF].  In such cases the node MUST join and leave the
   solicited-node multicast address corresponding to the new and old
   addresses, respectively.  Joining the solicited-node multicast
   address is done using a Multicast Listener Discovery such as [MLD] or
   [MLDv2] protocols.  Note that multiple unicast addresses may map into
   the same solicited-node multicast address; a node MUST NOT leave the
   solicited-node multicast group until all assigned addresses
   corresponding to that multicast address have been removed.

7.2.2.  Sending Neighbor Solicitations

   When a node has a unicast packet to send to a neighbor, but does not
   know the neighbor's link-layer address, it performs address
   resolution.  For multicast-capable interfaces, this entails creating
   a Neighbor Cache entry in the INCOMPLETE state and transmitting a
   Neighbor Solicitation message targeted at the neighbor.  The
   solicitation is sent to the solicited-node multicast address
   corresponding to the target address.

   If the source address of the packet prompting the solicitation is the
   same as one of the addresses assigned to the outgoing interface, that
   address SHOULD be placed in the IP Source Address of the outgoing
   solicitation.  Otherwise, any one of the addresses assigned to the
   interface should be used.  Using the prompting packet's source
   address when possible ensures that the recipient of the Neighbor

Narten, et al.              Standards Track                    [Page 61]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Solicitation installs in its Neighbor Cache the IP address that is
   highly likely to be used in subsequent return traffic belonging to
   the prompting packet's "connection".

   If the solicitation is being sent to a solicited-node multicast
   address, the sender MUST include its link-layer address (if it has
   one) as a Source Link-Layer Address option.  Otherwise, the sender
   SHOULD include its link-layer address (if it has one) as a Source
   Link-Layer Address option.  Including the source link-layer address
   in a multicast solicitation is required to give the target an address
   to which it can send the Neighbor Advertisement.  On unicast
   solicitations, an implementation MAY omit the Source Link-Layer
   Address option.  The assumption here is that if the sender has a
   peer's link-layer address in its cache, there is a high probability
   that the peer will also have an entry in its cache for the sender.
   Consequently, it need not be sent.

   While waiting for address resolution to complete, the sender MUST,
   for each neighbor, retain a small queue of packets waiting for
   address resolution to complete.  The queue MUST hold at least one
   packet, and MAY contain more.  However, the number of queued packets
   per neighbor SHOULD be limited to some small value.  When a queue
   overflows, the new arrival SHOULD replace the oldest entry.  Once
   address resolution completes, the node transmits any queued packets.

   While awaiting a response, the sender SHOULD retransmit Neighbor
   Solicitation messages approximately every RetransTimer milliseconds,
   even in the absence of additional traffic to the neighbor.
   Retransmissions MUST be rate-limited to at most one solicitation per
   neighbor every RetransTimer milliseconds.

   If no Neighbor Advertisement is received after MAX_MULTICAST_SOLICIT
   solicitations, address resolution has failed.  The sender MUST return
   ICMP destination unreachable indications with code 3 (Address
   Unreachable) for each packet queued awaiting address resolution.

7.2.3.  Receipt of Neighbor Solicitations

   A valid Neighbor Solicitation that does not meet any of the following
   requirements MUST be silently discarded:

    - The Target Address is a "valid" unicast or anycast address
      assigned to the receiving interface [ADDRCONF],

    - The Target Address is a unicast or anycast address for which the
      node is offering proxy service, or

Narten, et al.              Standards Track                    [Page 62]
RFC 4861               Neighbor Discovery in IPv6         September 2007

    - The Target Address is a "tentative" address on which Duplicate
      Address Detection is being performed [ADDRCONF].

   If the Target Address is tentative, the Neighbor Solicitation should
   be processed as described in [ADDRCONF].  Otherwise, the following
   description applies.  If the Source Address is not the unspecified
   address and, on link layers that have addresses, the solicitation
   includes a Source Link-Layer Address option, then the recipient
   SHOULD create or update the Neighbor Cache entry for the IP Source
   Address of the solicitation.  If an entry does not already exist, the
   node SHOULD create a new one and set its reachability state to STALE
   as specified in Section 7.3.3.  If an entry already exists, and the
   cached link-layer address differs from the one in the received Source
   Link-Layer option, the cached address should be replaced by the
   received address, and the entry's reachability state MUST be set to
   STALE.

   If a Neighbor Cache entry is created, the IsRouter flag SHOULD be set
   to FALSE.  This will be the case even if the Neighbor Solicitation is
   sent by a router since the Neighbor Solicitation messages do not
   contain an indication of whether or not the sender is a router.  In
   the event that the sender is a router, subsequent Neighbor
   Advertisement or Router Advertisement messages will set the correct
   IsRouter value.  If a Neighbor Cache entry already exists, its
   IsRouter flag MUST NOT be modified.

   If the Source Address is the unspecified address, the node MUST NOT
   create or update the Neighbor Cache entry.

   After any updates to the Neighbor Cache, the node sends a Neighbor
   Advertisement response as described in the next section.

7.2.4.  Sending Solicited Neighbor Advertisements

   A node sends a Neighbor Advertisement in response to a valid Neighbor
   Solicitation targeting one of the node's assigned addresses.  The
   Target Address of the advertisement is copied from the Target Address
   of the solicitation.  If the solicitation's IP Destination Address is
   not a multicast address, the Target Link-Layer Address option MAY be
   omitted; the neighboring node's cached value must already be current
   in order for the solicitation to have been received.  If the
   solicitation's IP Destination Address is a multicast address, the
   Target Link-Layer option MUST be included in the advertisement.
   Furthermore, if the node is a router, it MUST set the Router flag to
   one; otherwise, it MUST set the flag to zero.

Narten, et al.              Standards Track                    [Page 63]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   If the Target Address is either an anycast address or a unicast
   address for which the node is providing proxy service, or the Target
   Link-Layer Address option is not included, the Override flag SHOULD
   be set to zero.  Otherwise, the Override flag SHOULD be set to one.
   Proper setting of the Override flag ensures that nodes give
   preference to non-proxy advertisements, even when received after
   proxy advertisements, and also ensures that the first advertisement
   for an anycast address "wins".

   If the source of the solicitation is the unspecified address, the
   node MUST set the Solicited flag to zero and multicast the
   advertisement to the all-nodes address.  Otherwise, the node MUST set
   the Solicited flag to one and unicast the advertisement to the Source
   Address of the solicitation.

   If the Target Address is an anycast address, the sender SHOULD delay
   sending a response for a random time between 0 and
   MAX_ANYCAST_DELAY_TIME seconds.

   Because unicast Neighbor Solicitations are not required to include a
   Source Link-Layer Address, it is possible that a node sending a
   solicited Neighbor Advertisement does not have a corresponding link-
   layer address for its neighbor in its Neighbor Cache.  In such
   situations, a node will first have to use Neighbor Discovery to
   determine the link-layer address of its neighbor (i.e., send out a
   multicast Neighbor Solicitation).

7.2.5.  Receipt of Neighbor Advertisements

   When a valid Neighbor Advertisement is received (either solicited or
   unsolicited), the Neighbor Cache is searched for the target's entry.
   If no entry exists, the advertisement SHOULD be silently discarded.
   There is no need to create an entry if none exists, since the
   recipient has apparently not initiated any communication with the
   target.

   Once the appropriate Neighbor Cache entry has been located, the
   specific actions taken depend on the state of the Neighbor Cache
   entry, the flags in the advertisement, and the actual link-layer
   address supplied.

   If the target's Neighbor Cache entry is in the INCOMPLETE state when
   the advertisement is received, one of two things happens.  If the
   link layer has addresses and no Target Link-Layer Address option is
   included, the receiving node SHOULD silently discard the received
   advertisement.  Otherwise, the receiving node performs the following
   steps:

Narten, et al.              Standards Track                    [Page 64]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   - It records the link-layer address in the Neighbor Cache entry.

   - If the advertisement's Solicited flag is set, the state of the
     entry is set to REACHABLE; otherwise, it is set to STALE.

   - It sets the IsRouter flag in the cache entry based on the Router
     flag in the received advertisement.

   - It sends any packets queued for the neighbor awaiting address
     resolution.

   Note that the Override flag is ignored if the entry is in the
   INCOMPLETE state.

   If the target's Neighbor Cache entry is in any state other than
   INCOMPLETE when the advertisement is received, the following actions
   take place:

   I.  If the Override flag is clear and the supplied link-layer address
       differs from that in the cache, then one of two actions takes
       place:
       a. If the state of the entry is REACHABLE, set it to STALE, but
          do not update the entry in any other way.
       b. Otherwise, the received advertisement should be ignored and
          MUST NOT update the cache.

   II. If the Override flag is set, or the supplied link-layer address
       is the same as that in the cache, or no Target Link-Layer Address
       option was supplied, the received advertisement MUST update the
       Neighbor Cache entry as follows:

       - The link-layer address in the Target Link-Layer Address option
         MUST be inserted in the cache (if one is supplied and differs
         from the already recorded address).

       - If the Solicited flag is set, the state of the entry MUST be
         set to REACHABLE.  If the Solicited flag is zero and the link-
         layer address was updated with a different address, the state
         MUST be set to STALE.  Otherwise, the entry's state remains
         unchanged.

         An advertisement's Solicited flag should only be set if the
         advertisement is a response to a Neighbor Solicitation.
         Because Neighbor Unreachability Detection Solicitations are
         sent to the cached link-layer address, receipt of a solicited
         advertisement indicates that the forward path is working.
         Receipt of an unsolicited advertisement, however, may indicate
         that a neighbor has urgent information to announce (e.g., a

Narten, et al.              Standards Track                    [Page 65]
RFC 4861               Neighbor Discovery in IPv6         September 2007

         changed link-layer address).  If the urgent information
         indicates a change from what a node is currently using, the
         node should verify the reachability of the (new) path when it
         sends the next packet.  There is no need to update the state
         for unsolicited advertisements that do not change the contents
         of the cache.

       - The IsRouter flag in the cache entry MUST be set based on the
         Router flag in the received advertisement.  In those cases
         where the IsRouter flag changes from TRUE to FALSE as a result
         of this update, the node MUST remove that router from the
         Default Router List and update the Destination Cache entries
         for all destinations using that neighbor as a router as
         specified in Section 7.3.3.  This is needed to detect when a
         node that is used as a router stops forwarding packets due to
         being configured as a host.

   The above rules ensure that the cache is updated either when the
   Neighbor Advertisement takes precedence (i.e., the Override flag is
   set) or when the Neighbor Advertisement refers to the same link-layer
   address that is currently recorded in the cache.  If none of the
   above apply, the advertisement prompts future Neighbor Unreachability
   Detection (if it is not already in progress) by changing the state in
   the cache entry.

7.2.6.  Sending Unsolicited Neighbor Advertisements

   In some cases, a node may be able to determine that its link-layer
   address has changed (e.g., hot-swap of an interface card) and may
   wish to inform its neighbors of the new link-layer address quickly.
   In such cases, a node MAY send up to MAX_NEIGHBOR_ADVERTISEMENT
   unsolicited Neighbor Advertisement messages to the all-nodes
   multicast address.  These advertisements MUST be separated by at
   least RetransTimer seconds.

   The Target Address field in the unsolicited advertisement is set to
   an IP address of the interface, and the Target Link-Layer Address
   option is filled with the new link-layer address.  The Solicited flag
   MUST be set to zero, in order to avoid confusing the Neighbor
   Unreachability Detection algorithm.  If the node is a router, it MUST
   set the Router flag to one; otherwise, it MUST set it to zero.  The
   Override flag MAY be set to either zero or one.  In either case,
   neighboring nodes will immediately change the state of their Neighbor
   Cache entries for the Target Address to STALE, prompting them to
   verify the path for reachability.  If the Override flag is set to
   one, neighboring nodes will install the new link-layer address in
   their caches.  Otherwise, they will ignore the new link-layer
   address, choosing instead to probe the cached address.

Narten, et al.              Standards Track                    [Page 66]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   A node that has multiple IP addresses assigned to an interface MAY
   multicast a separate Neighbor Advertisement for each address.  In
   such a case, the node SHOULD introduce a small delay between the
   sending of each advertisement to reduce the probability of the
   advertisements being lost due to congestion.

   A proxy MAY multicast Neighbor Advertisements when its link-layer
   address changes or when it is configured (by system management or
   other mechanisms) to proxy for an address.  If there are multiple
   nodes that are providing proxy services for the same set of
   addresses, the proxies should provide a mechanism that prevents
   multiple proxies from multicasting advertisements for any one
   address, in order to reduce the risk of excessive multicast traffic.
   This is a requirement on other protocols that need to use proxies for
   Neighbor Advertisements.  An example of a node that performs proxy
   advertisements is the Home Agent specified in [MIPv6].

   Also, a node belonging to an anycast address MAY multicast
   unsolicited Neighbor Advertisements for the anycast address when the
   node's link-layer address changes.

   Note that because unsolicited Neighbor Advertisements do not reliably
   update caches in all nodes (the advertisements might not be received
   by all nodes), they should only be viewed as a performance
   optimization to quickly update the caches in most neighbors.  The
   Neighbor Unreachability Detection algorithm ensures that all nodes
   obtain a reachable link-layer address, though the delay may be
   slightly longer.

7.2.7.  Anycast Neighbor Advertisements

   From the perspective of Neighbor Discovery, anycast addresses are
   treated just like unicast addresses in most cases.  Because an
   anycast address is syntactically the same as a unicast address, nodes
   performing address resolution or Neighbor Unreachability Detection on
   an anycast address treat it as if it were a unicast address.  No
   special processing takes place.

   Nodes that have an anycast address assigned to an interface treat
   them exactly the same as if they were unicast addresses with two
   exceptions.  First, Neighbor Advertisements sent in response to a
   Neighbor Solicitation SHOULD be delayed by a random time between 0
   and MAX_ANYCAST_DELAY_TIME to reduce the probability of network
   congestion.  Second, the Override flag in Neighbor Advertisements
   SHOULD be set to 0, so that when multiple advertisements are
   received, the first received advertisement is used rather than the
   most recently received advertisement.

Narten, et al.              Standards Track                    [Page 67]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   As with unicast addresses, Neighbor Unreachability Detection ensures
   that a node quickly detects when the current binding for an anycast
   address becomes invalid.

7.2.8.  Proxy Neighbor Advertisements

   Under limited circumstances, a router MAY proxy for one or more other
   nodes, that is, through Neighbor Advertisements indicate that it is
   willing to accept packets not explicitly addressed to itself.  For
   example, a router might accept packets on behalf of a mobile node
   that has moved off-link.  The mechanisms used by proxy are
   essentially the same as the mechanisms used with anycast addresses.

   A proxy MUST join the solicited-node multicast address(es) that
   correspond to the IP address(es) assigned to the node for which it is
   proxying.  This SHOULD be done using a multicast listener discovery
   protocol such as [MLD] or [MLDv2].

   All solicited proxy Neighbor Advertisement messages MUST have the
   Override flag set to zero.  This ensures that if the node itself is
   present on the link, its Neighbor Advertisement (with the Override
   flag set to one) will take precedence of any advertisement received
   from a proxy.  A proxy MAY send unsolicited advertisements with the
   Override flag set to one as specified in Section 7.2.6, but doing so
   may cause the proxy advertisement to override a valid entry created
   by the node itself.

   Finally, when sending a proxy advertisement in response to a Neighbor
   Solicitation, the sender should delay its response by a random time
   between 0 and MAX_ANYCAST_DELAY_TIME seconds to avoid collisions due
   to multiple responses sent by several proxies.  However, in some
   cases (e.g., Mobile IPv6) where only one proxy is present, such delay
   is not necessary.

7.3.  Neighbor Unreachability Detection

   Communication to or through a neighbor may fail for numerous reasons
   at any time, including hardware failure, hot-swap of an interface
   card, etc.  If the destination has failed, no recovery is possible
   and communication fails.  On the other hand, if it is the path that
   has failed, recovery may be possible.  Thus, a node actively tracks
   the reachability "state" for the neighbors to which it is sending
   packets.

   Neighbor Unreachability Detection is used for all paths between hosts
   and neighboring nodes, including host-to-host, host-to-router, and
   router-to-host communication.  Neighbor Unreachability Detection may
   also be used between routers, but is not required if an equivalent

Narten, et al.              Standards Track                    [Page 68]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   mechanism is available, for example, as part of the routing
   protocols.

   When a path to a neighbor appears to be failing, the specific
   recovery procedure depends on how the neighbor is being used.  If the
   neighbor is the ultimate destination, for example, address resolution
   should be performed again.  If the neighbor is a router, however,
   attempting to switch to another router would be appropriate.  The
   specific recovery that takes place is covered under next-hop
   determination; Neighbor Unreachability Detection signals the need for
   next-hop determination by deleting a Neighbor Cache entry.

   Neighbor Unreachability Detection is performed only for neighbors to
   which unicast packets are sent; it is not used when sending to
   multicast addresses.

7.3.1.  Reachability Confirmation

   A neighbor is considered reachable if the node has recently received
   a confirmation that packets sent recently to the neighbor were
   received by its IP layer.  Positive confirmation can be gathered in
   two ways: hints from upper-layer protocols that indicate a connection
   is making "forward progress", or receipt of a Neighbor Advertisement
   message that is a response to a Neighbor Solicitation message.

   A connection makes "forward progress" if the packets received from a
   remote peer can only be arriving if recent packets sent to that peer
   are actually reaching it.  In TCP, for example, receipt of a (new)
   acknowledgment indicates that previously sent data reached the peer.
   Likewise, the arrival of new (non-duplicate) data indicates that
   earlier acknowledgments are being delivered to the remote peer.  If
   packets are reaching the peer, they must also be reaching the
   sender's next-hop neighbor; thus, "forward progress" is a
   confirmation that the next-hop neighbor is reachable.  For off-link
   destinations, forward progress implies that the first-hop router is
   reachable.  When available, this upper-layer information SHOULD be
   used.

   In some cases (e.g., UDP-based protocols and routers forwarding
   packets to hosts), such reachability information may not be readily
   available from upper-layer protocols.  When no hints are available
   and a node is sending packets to a neighbor, the node actively probes
   the neighbor using unicast Neighbor Solicitation messages to verify
   that the forward path is still working.

   The receipt of a solicited Neighbor Advertisement serves as
   reachability confirmation, since advertisements with the Solicited
   flag set to one are sent only in response to a Neighbor Solicitation.

Narten, et al.              Standards Track                    [Page 69]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Receipt of other Neighbor Discovery messages, such as Router
   Advertisements and Neighbor Advertisement with the Solicited flag set
   to zero, MUST NOT be treated as a reachability confirmation.  Receipt
   of unsolicited messages only confirms the one-way path from the
   sender to the recipient node.  In contrast, Neighbor Unreachability
   Detection requires that a node keep track of the reachability of the
   forward path to a neighbor from its perspective, not the neighbor's
   perspective.  Note that receipt of a solicited advertisement
   indicates that a path is working in both directions.  The
   solicitation must have reached the neighbor, prompting it to generate
   an advertisement.  Likewise, receipt of an advertisement indicates
   that the path from the sender to the recipient is working.  However,
   the latter fact is known only to the recipient; the advertisement's
   sender has no direct way of knowing that the advertisement it sent
   actually reached a neighbor.  From the perspective of Neighbor
   Unreachability Detection, only the reachability of the forward path
   is of interest.

7.3.2.  Neighbor Cache Entry States

   A Neighbor Cache entry can be in one of five states:

      INCOMPLETE  Address resolution is being performed on the entry.
                  Specifically, a Neighbor Solicitation has been sent to
                  the solicited-node multicast address of the target,
                  but the corresponding Neighbor Advertisement has not
                  yet been received.

      REACHABLE   Positive confirmation was received within the last
                  ReachableTime milliseconds that the forward path to
                  the neighbor was functioning properly.  While
                  REACHABLE, no special action takes place as packets
                  are sent.

      STALE       More than ReachableTime milliseconds have elapsed
                  since the last positive confirmation was received that
                  the forward path was functioning properly.  While
                  stale, no action takes place until a packet is sent.

                  The STALE state is entered upon receiving an
                  unsolicited Neighbor Discovery message that updates
                  the cached link-layer address.  Receipt of such a
                  message does not confirm reachability, and entering
                  the STALE state ensures reachability is verified
                  quickly if the entry is actually being used.  However,
                  reachability is not actually verified until the entry
                  is actually used.

Narten, et al.              Standards Track                    [Page 70]
RFC 4861               Neighbor Discovery in IPv6         September 2007

      DELAY       More than ReachableTime milliseconds have elapsed
                  since the last positive confirmation was received that
                  the forward path was functioning properly, and a
                  packet was sent within the last DELAY_FIRST_PROBE_TIME
                  seconds.  If no reachability confirmation is received
                  within DELAY_FIRST_PROBE_TIME seconds of entering the
                  DELAY state, send a Neighbor Solicitation and change
                  the state to PROBE.

                  The DELAY state is an optimization that gives upper-
                  layer protocols additional time to provide
                  reachability confirmation in those cases where
                  ReachableTime milliseconds have passed since the last
                  confirmation due to lack of recent traffic.  Without
                  this optimization, the opening of a TCP connection
                  after a traffic lull would initiate probes even though
                  the subsequent three-way handshake would provide a
                  reachability confirmation almost immediately.

      PROBE       A reachability confirmation is actively sought by
                  retransmitting Neighbor Solicitations every
                  RetransTimer milliseconds until a reachability
                  confirmation is received.

7.3.3.  Node Behavior

   Neighbor Unreachability Detection operates in parallel with the
   sending of packets to a neighbor.  While reasserting a neighbor's
   reachability, a node continues sending packets to that neighbor using
   the cached link-layer address.  If no traffic is sent to a neighbor,
   no probes are sent.

   When a node needs to perform address resolution on a neighboring
   address, it creates an entry in the INCOMPLETE state and initiates
   address resolution as specified in Section 7.2.  If address
   resolution fails, the entry SHOULD be deleted, so that subsequent
   traffic to that neighbor invokes the next-hop determination procedure
   again.  Invoking next-hop determination at this point ensures that
   alternate default routers are tried.

   When a reachability confirmation is received (either through upper-
   layer advice or a solicited Neighbor Advertisement), an entry's state
   changes to REACHABLE.  The one exception is that upper-layer advice
   has no effect on entries in the INCOMPLETE state (e.g., for which no
   link-layer address is cached).

Narten, et al.              Standards Track                    [Page 71]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   When ReachableTime milliseconds have passed since receipt of the last
   reachability confirmation for a neighbor, the Neighbor Cache entry's
   state changes from REACHABLE to STALE.

      Note: An implementation may actually defer changing the state from
      REACHABLE to STALE until a packet is sent to the neighbor, i.e.,
      there need not be an explicit timeout event associated with the
      expiration of ReachableTime.

   The first time a node sends a packet to a neighbor whose entry is
   STALE, the sender changes the state to DELAY and sets a timer to
   expire in DELAY_FIRST_PROBE_TIME seconds.  If the entry is still in
   the DELAY state when the timer expires, the entry's state changes to
   PROBE.  If reachability confirmation is received, the entry's state
   changes to REACHABLE.

   Upon entering the PROBE state, a node sends a unicast Neighbor
   Solicitation message to the neighbor using the cached link-layer
   address.  While in the PROBE state, a node retransmits Neighbor
   Solicitation messages every RetransTimer milliseconds until
   reachability confirmation is obtained.  Probes are retransmitted even
   if no additional packets are sent to the neighbor.  If no response is
   received after waiting RetransTimer milliseconds after sending the
   MAX_UNICAST_SOLICIT solicitations, retransmissions cease and the
   entry SHOULD be deleted.  Subsequent traffic to that neighbor will
   recreate the entry and perform address resolution again.

   Note that all Neighbor Solicitations are rate-limited on a per-
   neighbor basis.  A node MUST NOT send Neighbor Solicitations to the
   same neighbor more frequently than once every RetransTimer
   milliseconds.

   A Neighbor Cache entry enters the STALE state when created as a
   result of receiving packets other than solicited Neighbor
   Advertisements (i.e., Router Solicitations, Router Advertisements,
   Redirects, and Neighbor Solicitations).  These packets contain the
   link-layer address of either the sender or, in the case of Redirect,
   the redirection target.  However, receipt of these link-layer
   addresses does not confirm reachability of the forward-direction path
   to that node.  Placing a newly created Neighbor Cache entry for which
   the link-layer address is known in the STALE state provides assurance
   that path failures are detected quickly.  In addition, should a
   cached link-layer address be modified due to receiving one of the
   above messages, the state SHOULD also be set to STALE to provide
   prompt verification that the path to the new link-layer address is
   working.

Narten, et al.              Standards Track                    [Page 72]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   To properly detect the case where a router switches from being a
   router to being a host (e.g., if its IP forwarding capability is
   turned off by system management), a node MUST compare the Router flag
   field in all received Neighbor Advertisement messages with the
   IsRouter flag recorded in the Neighbor Cache entry.  When a node
   detects that a neighbor has changed from being a router to being a
   host, the node MUST remove that router from the Default Router List
   and update the Destination Cache as described in Section 6.3.5.  Note
   that a router may not be listed in the Default Router List, even
   though a Destination Cache entry is using it (e.g., a host was
   redirected to it).  In such cases, all Destination Cache entries that
   reference the (former) router must perform next-hop determination
   again before using the entry.

   In some cases, link-specific information may indicate that a path to
   a neighbor has failed (e.g., the resetting of a virtual circuit).  In
   such cases, link-specific information may be used to purge Neighbor
   Cache entries before the Neighbor Unreachability Detection would do
   so.  However, link-specific information MUST NOT be used to confirm
   the reachability of a neighbor; such information does not provide
   end-to-end confirmation between neighboring IP layers.

8.  Redirect Function

   This section describes the functions related to the sending and
   processing of Redirect messages.

   Redirect messages are sent by routers to redirect a host to a better
   first-hop router for a specific destination or to inform hosts that a
   destination is in fact a neighbor (i.e., on-link).  The latter is
   accomplished by having the ICMP Target Address be equal to the ICMP
   Destination Address.

   A router MUST be able to determine the link-local address for each of
   its neighboring routers in order to ensure that the target address in
   a Redirect message identifies the neighbor router by its link-local
   address.  For static routing, this requirement implies that the next-
   hop router's address should be specified using the link-local address
   of the router.  For dynamic routing, this requirement implies that
   all IPv6 routing protocols must somehow exchange the link-local
   addresses of neighboring routers.

Narten, et al.              Standards Track                    [Page 73]
RFC 4861               Neighbor Discovery in IPv6         September 2007

8.1.  Validation of Redirect Messages

   A host MUST silently discard any received Redirect message that does
   not satisfy all of the following validity checks:

      - IP Source Address is a link-local address.  Routers must use
        their link-local address as the source for Router Advertisement
        and Redirect messages so that hosts can uniquely identify
        routers.

      - The IP Hop Limit field has a value of 255, i.e., the packet
        could not possibly have been forwarded by a router.

      - ICMP Checksum is valid.

      - ICMP Code is 0.

      - ICMP length (derived from the IP length) is 40 or more octets.

      - The IP source address of the Redirect is the same as the current
        first-hop router for the specified ICMP Destination Address.

      - The ICMP Destination Address field in the redirect message does
        not contain a multicast address.

      - The ICMP Target Address is either a link-local address (when
        redirected to a router) or the same as the ICMP Destination
        Address (when redirected to the on-link destination).

      - All included options have a length that is greater than zero.

   The contents of the Reserved field, and of any unrecognized options,
   MUST be ignored.  Future, backward-compatible changes to the protocol
   may specify the contents of the Reserved field or add new options;
   backward-incompatible changes may use different Code values.

   The contents of any defined options that are not specified to be used
   with Redirect messages MUST be ignored and the packet processed as
   normal.  The only defined options that may appear are the Target
   Link-Layer Address option and the Redirected Header option.

   A host MUST NOT consider a redirect invalid just because the Target
   Address of the redirect is not covered under one of the link's
   prefixes.  Part of the semantics of the Redirect message is that the
   Target Address is on-link.

   A redirect that passes the validity checks is called a "valid
   redirect".

Narten, et al.              Standards Track                    [Page 74]
RFC 4861               Neighbor Discovery in IPv6         September 2007

8.2.  Router Specification

   A router SHOULD send a redirect message, subject to rate limiting,
   whenever it forwards a packet that is not explicitly addressed to
   itself (i.e., a packet that is not source routed through the router)
   in which:

      - the Source Address field of the packet identifies a neighbor,
        and

      - the router determines (by means outside the scope of this
        specification) that a better first-hop node resides on the same
        link as the sending node for the Destination Address of the
        packet being forwarded, and

      - the Destination Address of the packet is not a multicast
        address.

   The transmitted redirect packet contains, consistent with the message
   format given in Section 4.5:

      - In the Target Address field: the address to which subsequent
        packets for the destination should be sent.  If the target is a
        router, that router's link-local address MUST be used.  If the
        target is a host, the target address field MUST be set to the
        same value as the Destination Address field.

      - In the Destination Address field: the destination address of the
        invoking IP packet.

      - In the options:

           o Target Link-Layer Address option: link-layer address of the
             target, if known.

           o Redirected Header: as much of the forwarded packet as can
             fit without the redirect packet exceeding the minimum MTU
             required to support IPv6 as specified in [IPv6].

   A router MUST limit the rate at which Redirect messages are sent, in
   order to limit the bandwidth and processing costs incurred by the
   Redirect messages when the source does not correctly respond to the
   Redirects, or the source chooses to ignore unauthenticated Redirect
   messages.  More details on the rate-limiting of ICMP error messages
   can be found in [ICMPv6].

   A router MUST NOT update its routing tables upon receipt of a
   Redirect.

Narten, et al.              Standards Track                    [Page 75]
RFC 4861               Neighbor Discovery in IPv6         September 2007

8.3.  Host Specification

   A host receiving a valid redirect SHOULD update its Destination Cache
   accordingly so that subsequent traffic goes to the specified target.
   If no Destination Cache entry exists for the destination, an
   implementation SHOULD create such an entry.

   If the redirect contains a Target Link-Layer Address option, the host
   either creates or updates the Neighbor Cache entry for the target.
   In both cases, the cached link-layer address is copied from the
   Target Link-Layer Address option.  If a Neighbor Cache entry is
   created for the target, its reachability state MUST be set to STALE
   as specified in Section 7.3.3.  If a cache entry already existed and
   it is updated with a different link-layer address, its reachability
   state MUST also be set to STALE.  If the link-layer address is the
   same as that already in the cache, the cache entry's state remains
   unchanged.

   If the Target and Destination Addresses are the same, the host MUST
   treat the Target as on-link.  If the Target Address is not the same
   as the Destination Address, the host MUST set IsRouter to TRUE for
   the target.  If the Target and Destination Addresses are the same,
   however, one cannot reliably determine whether the Target Address is
   a router.  Consequently, newly created Neighbor Cache entries should
   set the IsRouter flag to FALSE, while existing cache entries should
   leave the flag unchanged.  If the Target is a router, subsequent
   Neighbor Advertisement or Router Advertisement messages will update
   IsRouter accordingly.

   Redirect messages apply to all flows that are being sent to a given
   destination.  That is, upon receipt of a Redirect for a Destination
   Address, all Destination Cache entries to that address should be
   updated to use the specified next-hop, regardless of the contents of
   the Flow Label field that appears in the Redirected Header option.

   A host MUST NOT send Redirect messages.

9.  Extensibility - Option Processing

   Options provide a mechanism for encoding variable length fields,
   fields that may appear multiple times in the same packet, or
   information that may not appear in all packets.  Options can also be
   used to add additional functionality to future versions of ND.

   In order to ensure that future extensions properly coexist with
   current implementations, all nodes MUST silently ignore any options
   they do not recognize in received ND packets and continue processing
   the packet.  All options specified in this document MUST be

Narten, et al.              Standards Track                    [Page 76]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   recognized.  A node MUST NOT ignore valid options just because the ND
   message contains unrecognized ones.

   The current set of options is defined in such a way that receivers
   can process multiple options in the same packet independently of each
   other.  In order to maintain these properties, future options SHOULD
   follow the simple rule:

      The option MUST NOT depend on the presence or absence of any other
      options.  The semantics of an option should depend only on the
      information in the fixed part of the ND packet and on the
      information contained in the option itself.

   Adhering to the above rule has the following benefits:

     1) Receivers can process options independently of one another.  For
        example, an implementation can choose to process the Prefix
        Information option contained in a Router Advertisement message
        in a user-space process while the link-layer address option in
        the same message is processed by routines in the kernel.

     2) Should the number of options cause a packet to exceed a link's
        MTU, multiple packets can carry subsets of the options without
        any change in semantics.

     3) Senders MAY send a subset of options in different packets.  For
        instance, if a prefix's Valid and Preferred Lifetime are high
        enough, it might not be necessary to include the Prefix
        Information option in every Router Advertisement.  In addition,
        different routers might send different sets of options.  Thus, a
        receiver MUST NOT associate any action with the absence of an
        option in a particular packet.  This protocol specifies that
        receivers should only act on the expiration of timers and on the
        information that is received in the packets.

   Options in Neighbor Discovery packets can appear in any order;
   receivers MUST be prepared to process them independently of their
   order.  There can also be multiple instances of the same option in a
   message (e.g., Prefix Information options).

   If the number of included options in a Router Advertisement causes
   the advertisement's size to exceed the link MTU, the router can send
   multiple separate advertisements, each containing a subset of the
   options.

   The amount of data to include in the Redirected Header option MUST be
   limited so that the entire redirect packet does not exceed the
   minimum MTU required to support IPv6 as specified in [IPv6].

Narten, et al.              Standards Track                    [Page 77]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   All options are a multiple of 8 octets of length, ensuring
   appropriate alignment without any "pad" options.  The fields in the
   options (as well as the fields in ND packets) are defined to align on
   their natural boundaries (e.g., a 16-bit field is aligned on a 16-bit
   boundary) with the exception of the 128-bit IP addresses/prefixes,
   which are aligned on a 64-bit boundary.  The link-layer address field
   contains an uninterpreted octet string; it is aligned on an 8-bit
   boundary.

   The size of an ND packet including the IP header is limited to the
   link MTU.  When adding options to an ND packet, a node MUST NOT
   exceed the link MTU.

   Future versions of this protocol may define new option types.
   Receivers MUST silently ignore any options they do not recognize and
   continue processing the message.

10.  Protocol Constants

   Router constants:

            MAX_INITIAL_RTR_ADVERT_INTERVAL  16 seconds

            MAX_INITIAL_RTR_ADVERTISEMENTS    3 transmissions

            MAX_FINAL_RTR_ADVERTISEMENTS      3 transmissions

            MIN_DELAY_BETWEEN_RAS             3 seconds

            MAX_RA_DELAY_TIME                 .5 seconds

   Host constants:

            MAX_RTR_SOLICITATION_DELAY        1 second

            RTR_SOLICITATION_INTERVAL         4 seconds

            MAX_RTR_SOLICITATIONS             3 transmissions

   Node constants:

            MAX_MULTICAST_SOLICIT             3 transmissions

            MAX_UNICAST_SOLICIT               3 transmissions

            MAX_ANYCAST_DELAY_TIME            1 second

            MAX_NEIGHBOR_ADVERTISEMENT        3 transmissions

Narten, et al.              Standards Track                    [Page 78]
RFC 4861               Neighbor Discovery in IPv6         September 2007

            REACHABLE_TIME               30,000 milliseconds

            RETRANS_TIMER                 1,000 milliseconds

            DELAY_FIRST_PROBE_TIME            5 seconds

            MIN_RANDOM_FACTOR                 .5

            MAX_RANDOM_FACTOR                 1.5

   Additional protocol constants are defined with the message formats in
   Section 4.

   All protocol constants are subject to change in future revisions of
   the protocol.

   The constants in this specification may be overridden by specific
   documents that describe how IPv6 operates over different link layers.
   This rule allows Neighbor Discovery to operate over links with widely
   varying performance characteristics.

11.  Security Considerations

   Neighbor Discovery is subject to attacks that cause IP packets to
   flow to unexpected places.  Such attacks can be used to cause denial
   of service but also allow nodes to intercept and optionally modify
   packets destined for other nodes.  This section deals with the main
   threats related to Neighbor Discovery messages and possible security
   mechanisms that can mitigate these threats.

11.1.  Threat Analysis

   This section discusses the main threats associated with Neighbor
   Discovery.  A more detailed analysis can be found in [PSREQ].  The
   main vulnerabilities of the protocol fall under three categories:

   - Denial-of-Service (DoS) attacks.
   - Address spoofing attacks.
   - Router spoofing attacks.

   An example of denial of service attacks is that a node on the link
   that can send packets with an arbitrary IP source address can both
   advertise itself as a default router and also send "forged" Router
   Advertisement messages that immediately time out all other default
   routers as well as all on-link prefixes.  An intruder can achieve
   this by sending out multiple Router Advertisements, one for each
   legitimate router, with the source address set to the address of
   another router, the Router Lifetime field set to zero, and the

Narten, et al.              Standards Track                    [Page 79]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   Preferred and Valid lifetimes set to zero for all the prefixes.  Such
   an attack would cause all packets, for both on-link and off-link
   destinations, to go to the rogue router.  That router can then
   selectively examine, modify, or drop all packets sent on the link.
   The Neighbor Unreachability Detection (NUD) will not detect such a
   black hole as long as the rogue router politely answers the NUD
   probes with a Neighbor Advertisement with the R-bit set.

   It is also possible for any host to launch a DoS attack on another
   host by preventing it from configuring an address using [ADDRCONF].
   The protocol does not allow hosts to verify whether the sender of a
   Neighbor Advertisement is the true owner of the IP address included
   in the message.

   Redirect attacks can also be achieved by any host in order to flood a
   victim or steal its traffic.  A host can send a Neighbor
   Advertisement (in response to a solicitation) that contains its IP
   address and a victim's link-layer address in order to flood the
   victim with unwanted traffic.  Alternatively, the host can send a
   Neighbor Advertisement that includes a victim's IP address and its
   own link-layer address to overwrite an existing entry in the sender's
   destination cache, thereby forcing the sender to forward all of the
   victim's traffic to itself.

   The trust model for redirects is the same as in IPv4.  A redirect is
   accepted only if received from the same router that is currently
   being used for that destination.  If a host has been redirected to
   another node (i.e., the destination is on-link), there is no way to
   prevent the target from issuing another redirect to some other
   destination.  However, this exposure is no worse than it was before
   being redirected; the target host, once subverted, could always act
   as a hidden router to forward traffic elsewhere.

   The protocol contains no mechanism to determine which neighbors are
   authorized to send a particular type of message (e.g., Router
   Advertisements); any neighbor, presumably even in the presence of
   authentication, can send Router Advertisement messages thereby being
   able to cause denial of service.  Furthermore, any neighbor can send
   proxy Neighbor Advertisements as well as unsolicited Neighbor
   Advertisements as a potential denial-of-service attack.

   Many link layers are also subject to different denial-of-service
   attacks such as continuously occupying the link in CSMA/CD (Carrier
   Sense Multiple Access with Collision Detection) networks (e.g., by
   sending packets closely back-to-back or asserting the collision
   signal on the link), or originating packets with somebody else's
   source MAC address to confuse, e.g., Ethernet switches.  On the other
   hand, many of the threats discussed in this section are less

Narten, et al.              Standards Track                    [Page 80]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   effective, or non-existent, on point-to-point links, or cellular
   links where a host shares a link with only one neighbor, i.e., the
   default router.

11.2.  Securing Neighbor Discovery Messages

   The protocol reduces the exposure to the above threats in the absence
   of authentication by ignoring ND packets received from off-link
   senders.  The Hop Limit field of all received packets is verified to
   contain 255, the maximum legal value.  Because routers decrement the
   Hop Limit on all packets they forward, received packets containing a
   Hop Limit of 255 must have originated from a neighbor.

   Cryptographic security mechanisms for Neighbor Discovery are outside
   the scope of this document and are defined in [SEND].  Alternatively,
   IPsec can be used for IP layer authentication [IPv6-SA].  The use of
   the Internet Key Exchange (IKE) is not suited for creating dynamic
   security associations that can be used to secure address resolution
   or neighbor solicitation messages as documented in [ICMPIKE].

   In some cases, it may be acceptable to use statically configured
   security associations with either [IPv6-AUTH] or [IPv6-ESP] to secure
   Neighbor Discovery messages.  However, it is important to note that
   statically configured security associations are not scalable
   (especially when considering multicast links) and are therefore
   limited to small networks with known hosts.  In any case, if either
   [IPv6-AUTH] or [IPv6-ESP] is used, ND packets MUST be verified for
   the purpose of authentication.  Packets that fail authentication
   checks MUST be silently discarded.

12.  Renumbering Considerations

   The Neighbor Discovery protocol together with IPv6 Address
   Autoconfiguration [ADDRCONF] provides mechanisms to aid in
   renumbering -- new prefixes and addresses can be introduced and old
   ones can be deprecated and removed.

   The robustness of these mechanisms is based on all the nodes on the
   link receiving the Router Advertisement messages in a timely manner.
   However, a host might be turned off or be unreachable for an extended
   period of time (i.e., a machine is powered down for months after a
   project terminates).  It is possible to preserve robust renumbering
   in such cases, but it does place some constraints on how long
   prefixes must be advertised.

   Consider the following example in which a prefix is initially
   advertised with a lifetime of 2 months, but on August 1st it is
   determined that the prefix needs to be deprecated and removed due to

Narten, et al.              Standards Track                    [Page 81]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   renumbering by September 1st.  This can be done by reducing the
   advertised lifetime to 1 week starting on August 1st, and as the
   cutoff gets closer, the lifetimes can be made shorter until by
   September 1st the prefix is advertised with a lifetime of 0.  The
   point is that, if one or more nodes were unplugged from the link
   prior to September 1st, they might still think that the prefix is
   valid since the last lifetime they received was 2 months.  Thus, if a
   node was unplugged on July 31st, it thinks the prefix is valid until
   September 30th.  If that node is plugged back in prior to September
   30th, it may continue to use the old prefix.  The only way to force a
   node to stop using a prefix that was previously advertised with a
   long lifetime is to have that node receive an advertisement for that
   prefix that changes the lifetime downward.  The solution in this
   example is simple: continue advertising the prefix with a lifetime of
   0 from September 1st until October 1st.

   In general, in order to be robust against nodes that might be
   unplugged from the link, it is important to track the furthest into
   the future that a particular prefix can be viewed as valid by any
   node on the link.  The prefix must then be advertised with a 0
   lifetime until that point in the future.  This "furthest into the
   future" time is simply the maximum, over all Router Advertisements,
   of the time the advertisement was sent, plus the prefix's lifetime
   contained in the advertisement.

   The above has an important implication on using infinite lifetimes.
   If a prefix is advertised with an infinite lifetime, and that prefix
   later needs to be renumbered, it is undesirable to continue
   advertising that prefix with a zero lifetime forever.  Thus, either
   infinite lifetimes should be avoided or there must be a limit on how
   long of a time a node can be unplugged from the link before it is
   plugged back in again.  However, it is unclear how the network
   administrator can enforce a limit on how long time hosts such as
   laptops can be unplugged from the link.

   Network administrators should give serious consideration to using
   relatively short lifetimes (i.e., no more than a few weeks).  While
   it might appear that using long lifetimes would help ensure
   robustness, in reality, a host will be unable to communicate in the
   absence of properly functioning routers.  Such routers will be
   sending Router Advertisements that contain appropriate (and current)
   prefixes.  A host connected to a network that has no functioning
   routers is likely to have more serious problems than just a lack of a
   valid prefix and address.

Narten, et al.              Standards Track                    [Page 82]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   The above discussion does not distinguish between the preferred and
   valid lifetimes.  For all practical purposes, it is probably
   sufficient to track the valid lifetime since the preferred lifetime
   will not exceed the valid lifetime.

13.  IANA Considerations

   This document does not require any new ICMPv6 types or codes to be
   allocated.  However, existing ICMPv6 types have been updated to point
   to this document instead of RFC 2461.  The procedure for the
   assignment of ICMPv6 types/codes is described in Section 6 of
   [ICMPv6].

   This document continues to use the following ICMPv6 message types
   introduced in RFC 2461 and already assigned by IANA:

      Message name                            ICMPv6 Type

      Router Solicitation                      133
      Router Advertisement                     134
      Neighbor Solicitation                    135
      Neighbor Advertisement                   136
      Redirect                                 137

   This document continues to use the following Neighbor Discovery
   option types introduced in RFC 2461 and already assigned by IANA:

      Option Name                             Type

      Source Link-Layer Address                    1
      Target Link-Layer Address                    2
      Prefix Information                           3
      Redirected Header                            4
      MTU                                          5

   Neighbor Discovery option types are allocated using the following
   procedure:

   1. The IANA should allocate and permanently register new option types
   from IETF RFC publication.  This is for all RFC types including
   standards track, informational, and experimental status that
   originate from the IETF and have been approved by the IESG for
   publication.

   2. IETF working groups with working group consensus and area director
   approval can request reclaimable Neighbor Discovery option type
   assignments from the IANA.  The IANA will tag the values as
   "reclaimable in future".

Narten, et al.              Standards Track                    [Page 83]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   The "reclaimable in the future" tag will be removed when an RFC is
   published documenting the protocol as defined in 1).  This will make
   the assignment permanent and update the reference on the IANA Web
   pages.

   At the point where the option type values are 85% assigned, the IETF
   will review the assignments tagged "reclaimable in the future" and
   inform the IANA which ones should be reclaimed and reassigned.

   3. Requests for new option type value assignments from outside the
   IETF are only made through the publication of an IETF document, per
   1) above.  Note also that documents published as "RFC Editor
   contributions" [RFC3667] are not considered to be IETF documents.

14.  References

14.1.  Normative References

   [ADDR-ARCH]  Hinden, R. and S. Deering, "IP Version 6 Addressing
                Architecture", RFC 4291, February 2006.

   [ICMPv6]     Conta, A., Deering, S., and M. Gupta, Ed., "Internet
                Control Message Protocol (ICMPv6) for the Internet
                Protocol Version 6 (IPv6) Specification", RFC 4443,
                March 2006.

   [IPv6]       Deering, S. and R. Hinden, "Internet Protocol, Version 6
                (IPv6) Specification", RFC 2460, December 1998.

   [KEYWORDS]   Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", BCP 14, RFC 2119, March 1997.

14.2.  Informative References

   [ADDRCONF]   Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
                Address Autoconfiguration", RFC 4862, September 2007.

   [ADDR-SEL]   Draves, R., "Default Address Selection for Internet
                Protocol version 6 (IPv6)", RFC 3484, February 2003.

   [ARP]        Plummer, D., "Ethernet Address Resolution Protocol: Or
                Converting Network Protocol Addresses to 48.bit Ethernet
                Address for Transmission on Ethernet Hardware", STD 37,
                RFC 826, November 1982.

   [ASSIGNED]   Reynolds, J., Ed., "Assigned Numbers: RFC 1700 is
                Replaced by an On-line Database", RFC 3232, January
                2002.

Narten, et al.              Standards Track                    [Page 84]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   [DHCPv6]     Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,
                C., and M. Carney, "Dynamic Host Configuration Protocol
                for IPv6 (DHCPv6)", RFC 3315, July 2003.

   [HR-CL]      Braden, R., Ed., "Requirements for Internet Hosts -
                Communication Layers", STD 3, RFC 1122, October 1989.

   [ICMPIKE]    Arkko, J., "Effects of ICMPv6 on IKE", Work in Progress,
                March 2003.

   [ICMPv4]     Postel, J., "Internet Control Message Protocol", STD 5,
                RFC 792, September 1981.

   [IPv6-3GPP]  Wasserman, M., Ed., "Recommendations for IPv6 in Third
                Generation Partnership Project (3GPP) Standards", RFC
                3314, September 2002.

   [IPv6-CELL]  Arkko, J., Kuijpers, G., Soliman, H., Loughney, J., and
                J. Wiljakka, "Internet Protocol Version 6 (IPv6) for
                Some Second and Third Generation Cellular Hosts", RFC
                3316, April 2003.

   [IPv6-ETHER] Crawford, M., "Transmission of IPv6 Packets over
                Ethernet Networks", RFC 2464, December 1998.

   [IPv6-SA]    Kent, S. and K. Seo, "Security Architecture for the
                Internet Protocol", RFC 4301, December 2005.

   [IPv6-AUTH]  Kent, S., "IP Authentication Header", RFC 4302, December
                2005.

   [IPv6-ESP]   Kent, S., "IP Encapsulating Security Payload (ESP)", RFC
                4303, December 2005.

   [IPv6-NBMA]  Armitage, G., Schulter, P., Jork, M., and G. Harter,
                "IPv6 over Non-Broadcast Multiple Access (NBMA)
                networks", RFC 2491, January 1999.

   [LD-SHRE]    Hinden, R. and D. Thaler, "IPv6 Host-to-Router Load
                Sharing", RFC 4311, November 2005.

   [MIPv6]      Johnson, D., Perkins, C., and J. Arkko, "Mobility
                Support in IPv6", RFC 3775, June 2004.

   [MLD]        Deering, S., Fenner, W., and B. Haberman, "Multicast
                Listener Discovery (MLD) for IPv6", RFC 2710, October
                1999.

Narten, et al.              Standards Track                    [Page 85]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   [MLDv2]      Vida, R., Ed., and L. Costa, Ed., "Multicast Listener
                Discovery Version 2 (MLDv2) for IPv6", RFC 3810, June
                2004.

   [PSREQ]      Nikander, P., Ed., Kempf, J., and E. Nordmark, "IPv6
                Neighbor Discovery (ND) Trust Models and Threats", RFC
                3756, May 2004.

   [RAND]       Eastlake, D., 3rd, Schiller, J., and S. Crocker,
                "Randomness Requirements for Security", BCP 106, RFC
                4086, June 2005.

   [RDISC]      Deering, S., Ed., "ICMP Router Discovery Messages", RFC
                1256, September 1991.

   [RFC3667]    Bradner, S., "IETF Rights in Contributions", RFC 3667,
                February 2004.

   [RTSEL]      Draves, R. and D. Thaler, "Default Router Preferences
                and More-Specific Routes", RFC 4191, November 2005.

   [SH-MEDIA]   Braden, B., Postel, J., and Y. Rekhter, "Internet
                Architecture Extensions for Shared Media", RFC 1620, May
                1994.

   [SEND]       Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,
                "SEcure Neighbor Discovery (SEND)", RFC 3971, March
                2005.

   [SYNC]       S. Floyd, V. Jacobson, "The Synchronization of Periodic
                Routing Messages", IEEE/ACM Transactions on Networking,
                April 1994.  ftp://ftp.ee.lbl.gov/papers/sync_94.ps.Z

Narten, et al.              Standards Track                    [Page 86]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Appendix A: Multihomed Hosts

   There are a number of complicating issues that arise when Neighbor
   Discovery is used by hosts that have multiple interfaces.  This
   section does not attempt to define the proper operation of multihomed
   hosts with regard to Neighbor Discovery.  Rather, it identifies
   issues that require further study.  Implementors are encouraged to
   experiment with various approaches to making Neighbor Discovery work
   on multihomed hosts and to report their experiences.  Further work
   related to this problem can be found in [RTSEL].

   If a multihomed host receives Router Advertisements on all of its
   interfaces, it will (probably) have learned on-link prefixes for the
   addresses residing on each link.  When a packet must be sent through
   a router, however, selecting the "wrong" router can result in a
   suboptimal or non-functioning path.  There are number of issues to
   consider:

     1) In order for a router to send a redirect, it must determine that
        the packet it is forwarding originates from a neighbor.  The
        standard test for this case is to compare the source address of
        the packet to the list of on-link prefixes associated with the
        interface on which the packet was received.  If the originating
        host is multihomed, however, the source address it uses may
        belong to an interface other than the interface from which it
        was sent.  In such cases, a router will not send redirects, and
        suboptimal routing is likely.  In order to be redirected, the
        sending host must always send packets out the interface
        corresponding to the outgoing packet's source address.  Note
        that this issue never arises with non-multihomed hosts; they
        only have one interface.  Additional discussion on this topic
        can be found in RFC 1122 under Section 3.3.4.2.

     2) If the selected first-hop router does not have a route at all
        for the destination, it will be unable to deliver the packet.
        However, the destination may be reachable through a router on
        one of the other interfaces.  Neighbor Discovery does not
        address this scenario; it does not arise in the non-multihomed
        case.

     3) Even if the first-hop router does have a route for a
        destination, there may be a better route via another interface.
        No mechanism exists for the multihomed host to detect this
        situation.

   If a multihomed host fails to receive Router Advertisements on one or
   more of its interfaces, it will not know (in the absence of
   configured information) which destinations are on-link on the

Narten, et al.              Standards Track                    [Page 87]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   affected interface(s).  This leads to the following problem: If
   Router Advertisements are received on some, but not all, interfaces,
   a multihomed host could choose to only send packets out on the
   interfaces on which it has received Router Advertisements.  A key
   assumption made here, however, is that routers on those other
   interfaces will be able to route packets to the ultimate destination,
   even when those destinations reside on the subnet to which the sender
   connects, but has no on-link prefix information.  Should the
   assumption be FALSE, communication would fail.  Even if the
   assumption holds, packets will traverse a suboptimal path.

Appendix B: Future Extensions

   Possible extensions for future study are:

    o Using dynamic timers to be able to adapt to links with widely
      varying delay.  Measuring round-trip times, however, requires
      acknowledgments and sequence numbers in order to match received
      Neighbor Advertisements with the actual Neighbor Solicitation that
      triggered the advertisement.  Implementors wishing to experiment
      with such a facility could do so in a backwards-compatible way by
      defining a new option carrying the necessary information.  Nodes
      not understanding the option would simply ignore it.

    o Adding capabilities to facilitate the operation over links that
      currently require hosts to register with an address resolution
      server.  This could, for instance, enable routers to ask hosts to
      send them periodic unsolicited advertisements.  Once again, this
      can be added using a new option sent in the Router Advertisements.

    o Adding additional procedures for links where asymmetric and non-
      transitive reachability is part of normal operations.  Such
      procedures might allow hosts and routers to find usable paths on,
      e.g., radio links.

Narten, et al.              Standards Track                    [Page 88]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Appendix C: State Machine for the Reachability State

   This appendix contains a summary of the rules specified in Sections
   7.2 and 7.3.  This document does not mandate that implementations
   adhere to this model as long as their external behavior is consistent
   with that described in this document.

   When performing address resolution and Neighbor Unreachability
   Detection the following state transitions apply using the conceptual
   model:

   State           Event                   Action             New state

   -               Packet to send.        Create entry.       INCOMPLETE
                                          Send multicast NS.
                                          Start retransmit timer

   INCOMPLETE      Retransmit timeout,    Retransmit NS       INCOMPLETE
                   less than N            Start retransmit
                   retransmissions.       timer

   INCOMPLETE      Retransmit timeout,    Discard entry          -
                   N or more              Send ICMP error
                   retransmissions.

   INCOMPLETE      NA, Solicited=0,       Record link-layer      STALE
                   Override=any           address. Send queued
                                          packets.

   INCOMPLETE      NA, Solicited=1,       Record link-layer    REACHABLE
                   Override=any           address. Send queued
                                          packets.

   INCOMPLETE      NA, Solicited=any,     Update content of    unchanged
                   Override=any, No       IsRouter flag
                   Link-layer address

    -              NS, RS, Redirect             -                 -
                   No link-layer address

   !INCOMPLETE     NA, Solicited=1,        -                   REACHABLE
                   Override=0
                   Same link-layer
                   address as cached.

   !INCOMPLETE     NA, Solicited=any,     Update content of    unchanged
                   Override=any, No       IsRouter flag.
                   link-layer address

Narten, et al.              Standards Track                    [Page 89]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   REACHABLE       NA, Solicited=1,        -                     STALE
                   Override=0
                   Different link-layer
                   address than cached.

   STALE, PROBE    NA, Solicited=1,        -                   unchanged
   Or DELAY        Override=0
                   Different link-layer
                   address than cached.

   !INCOMPLETE     NA, Solicited=1,       Record link-layer   REACHABLE
                   Override=1             address (if
                                          different).

   !INCOMPLETE     NA, Solicited=0,        -                  unchanged
                   Override=0

   !INCOMPLETE     NA, Solicited=0,        -                  unchanged
                   Override=1
                   Same link-layer
                   address as cached.

   !INCOMPLETE     NA, Solicited=0,        Record link-layer     STALE
                   Override=1              address.
                   Different link-layer
                   address than cached.

   !INCOMPLETE     upper-layer reachability  -                 REACHABLE
                   confirmation

   REACHABLE       timeout, more than        -                   STALE
                   N seconds since
                   reachability confirm.

   STALE           Sending packet          Start delay timer     DELAY

   DELAY           Delay timeout           Send unicast NS probe PROBE
                                           Start retransmit timer

   PROBE           Retransmit timeout,     Retransmit NS         PROBE
                   less than N
                   retransmissions.

   PROBE           Retransmit timeout,     Discard entry         -
                   N or more
                   retransmissions.

Narten, et al.              Standards Track                    [Page 90]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   The state transitions for receiving unsolicited information other
   than Neighbor Advertisement messages apply to either the source of
   the packet (for Neighbor Solicitation, Router Solicitation, and
   Router Advertisement messages) or the target address (for Redirect
   messages) as follows:

   State           Event                   Action              New state

   -               NS, RS, RA, Redirect    Create entry.         STALE

   INCOMPLETE      NS, RS, RA, Redirect    Record link-layer     STALE
                                           address. Send queued
                                           packets.

   !INCOMPLETE     NS, RS, RA, Redirect    Update link-layer     STALE
                   Different link-layer    address
                   address than cached.

   INCOMPLETE      NS, RS No link-layer    -                   unchanged
                   address

   !INCOMPLETE     NS, RS, RA, Redirect    -                   unchanged
                   Same link-layer
                   address as cached.

Appendix D: Summary of IsRouter Rules

   This appendix presents a summary of the rules for maintaining the
   IsRouter flag as specified in this document.

   The background for these rules is that the ND messages contain,
   either implicitly or explicitly, information that indicates whether
   or not the sender (or Target Address) is a host or a router.  The
   following assumptions are used:

    - The sender of a Router Advertisement is implicitly assumed to be a
      router.

    - Neighbor Solicitation messages do not contain either an implicit
      or explicit indication about the sender.  Both hosts and routers
      send such messages.

    - Neighbor Advertisement messages contain an explicit "IsRouter
      flag", the R-bit.

Narten, et al.              Standards Track                    [Page 91]
RFC 4861               Neighbor Discovery in IPv6         September 2007

    - The target of the redirect, when the target differs from the
      destination address in the packet being redirected, is implicitly
      assumed to be a router.  This is a natural assumption since that
      node is expected to be able to forward the packets towards the
      destination.

    - The target of the redirect, when the target is the same as the
      destination, does not carry any host vs. router information.  All
      that is known is that the destination (i.e., target) is on-link
      but it could be either a host or a router.

   The rules for setting the IsRouter flag are based on the information
   content above.  If an ND message contains explicit or implicit
   information, the receipt of the message will cause the IsRouter flag
   to be updated.  But when there is no host vs. router information in
   the ND message, the receipt of the message MUST NOT cause a change to
   the IsRouter state.  When the receipt of such a message causes a
   Neighbor Cache entry to be created, this document specifies that the
   IsRouter flag be set to FALSE.  There is greater potential for
   mischief when a node incorrectly thinks a host is a router, than the
   other way around.  In these cases, a subsequent Neighbor
   Advertisement or Router Advertisement message will set the correct
   IsRouter value.

Appendix E: Implementation Issues

E.1.  Reachability Confirmations

   Neighbor Unreachability Detection requires explicit confirmation that
   a forward-path is functioning properly.  To avoid the need for
   Neighbor Solicitation probe messages, upper-layer protocols should
   provide such an indication when the cost of doing so is small.
   Reliable connection-oriented protocols such as TCP are generally
   aware when the forward-path is working.  When TCP sends (or receives)
   data, for instance, it updates its window sequence numbers, sets and
   cancels retransmit timers, etc.  Specific scenarios that usually
   indicate a properly functioning forward-path include:

    - Receipt of an acknowledgment that covers a sequence number (e.g.,
      data) not previously acknowledged indicates that the forward path
      was working at the time the data was sent.

    - Completion of the initial three-way handshake is a special case of
      the previous rule; although no data is sent during the handshake,
      the SYN flags are counted as data from the sequence number
      perspective.  This applies to both the SYN+ACK for the active open
      and the ACK of that packet on the passively opening peer.

Narten, et al.              Standards Track                    [Page 92]
RFC 4861               Neighbor Discovery in IPv6         September 2007

    - Receipt of new data (i.e., data not previously received) indicates
      that the forward-path was working at the time an acknowledgment
      was sent that advanced the peer's send window that allowed the new
      data to be sent.

   To minimize the cost of communicating reachability information
   between the TCP and IP layers, an implementation may wish to rate-
   limit the reachability confirmations its sends IP.  One possibility
   is to process reachability only every few packets.  For example, one
   might update reachability information once per round-trip time, if an
   implementation only has one round-trip timer per connection.  For
   those implementations that cache Destination Cache entries within
   control blocks, it may be possible to update the Neighbor Cache entry
   directly (i.e., without an expensive lookup) once the TCP packet has
   been demultiplexed to its corresponding control block.  For other
   implementations, it may be possible to piggyback the reachability
   confirmation on the next packet submitted to IP assuming that the
   implementation guards against the piggybacked confirmation becoming
   stale when no packets are sent to IP for an extended period of time.

   TCP must also guard against thinking "stale" information indicates
   current reachability.  For example, new data received 30 minutes
   after a window has opened up does not constitute a confirmation that
   the path is currently working; it merely indicates that 30 minutes
   ago the window update reached the peer, i.e., the path was working at
   that point in time.  An implementation must also take into account
   TCP zero-window probes that are sent even if the path is broken and
   the window update did not reach the peer.

   For UDP-based applications (Remote Procedure Call (RPC), DNS), it is
   relatively simple to make the client send reachability confirmations
   when the response packet is received.  It is more difficult and in
   some cases impossible for the server to generate such confirmations
   since there is no flow control, i.e., the server cannot determine
   whether a received request indicates that a previous response reached
   the client.

   Note that an implementation cannot use negative upper-layer advice as
   a replacement for the Neighbor Unreachability Detection algorithm.
   Negative advice (e.g., from TCP when there are excessive
   retransmissions) could serve as a hint that the forward path from the
   sender of the data might not be working.  But it would fail to detect
   when the path from the receiver of the data is not functioning,
   causing none of the acknowledgment packets to reach the sender.

Narten, et al.              Standards Track                    [Page 93]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Appendix F: Changes from RFC 2461

   o Removed references to IPsec AH and ESP for securing messages or as
     part of validating the received message.

   o Added Section 3.3.

   o Updated Section 11 to include more detailed discussion on threats,
     IPsec limitations, and use of SEND.

   o Removed the on-link assumption in Section 5.2 based on RFC 4942,
     "IPv6 Neighbor Discovery On-Link Assumption Considered Harmful".

   o Clarified the definition of the Router Lifetime field in Section
     4.2.

   o Updated the text in Sections 4.6.2 and 6.2.1 to indicate that the
     preferred lifetime must not be larger than valid lifetime.

   o Removed the reference to stateful configuration and added reference
     for DHCPv6 instead.

   o Added the IsRouter flag definition to Section 6.2.1 to allow for
     mixed host/router behavior.

   o Allowed mobile nodes to be exempt from adding random delays before
     sending an RS during a handover.

   o Updated the definition of the prefix length in the prefix option.

   o Updated the applicability to NBMA links in the introduction and
     added references to 3GPP RFCs.

   o Clarified that support for load balancing is limited to routers.

   o Clarified router behavior when receiving a Router Solicitation
     without Source Link-Layer Address Option (SLLAO).

   o Clarified that inconsistency checks for CurHopLimit are done for
     non-zero values only.

   o Rearranged Section 7.2.5 for clarity, and described the processing
     when receiving the NA in INCOMPLETE state.

   o Added clarifications in Section 7.2 on how a node should react upon
     receiving a message without SLLAO.

   o Added new IANA section.

Narten, et al.              Standards Track                    [Page 94]
RFC 4861               Neighbor Discovery in IPv6         September 2007

   o Miscellaneous editorials.

Acknowledgments

   The authors of RFC 2461 would like to acknowledge the contributions
   of the IPV6 working group and, in particular, (in alphabetical order)
   Ran Atkinson, Jim Bound, Scott Bradner, Alex Conta, Stephen Deering,
   Richard Draves, Francis Dupont, Robert Elz, Robert Gilligan, Robert
   Hinden, Tatuya Jinmei, Allison Mankin, Dan McDonald, Charles Perkins,
   Matt Thomas, and Susan Thomson.

   The editor of this document (Hesham Soliman) would like to thank the
   IPV6 working group for the numerous contributions to this revision --
   in particular (in alphabetical order), Greg Daley, Elwyn Davies,
   Ralph Droms, Brian Haberman, Bob Hinden, Tatuya Jinmei, Pekka Savola,
   Fred Templin, and Christian Vogt.

Narten, et al.              Standards Track                    [Page 95]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Authors' Addresses

   Thomas Narten
   IBM Corporation
   P.O. Box 12195
   Research Triangle Park, NC 27709-2195
   USA

   Phone: +1 919 254 7798
   EMail: narten@us.ibm.com

   Erik Nordmark
   Sun Microsystems, Inc.
   17 Network Circle
   Menlo Park, CA 94025
   USA

   Phone: +1 650 786 2921
   Fax:   +1 650 786 5896
   EMail: erik.nordmark@sun.com

   William Allen Simpson
   Daydreamer
   Computer Systems Consulting Services
   1384 Fontaine
   Madison Heights, Michigan  48071
   USA

   EMail: william.allen.simpson@gmail.com

   Hesham Soliman
   Elevate Technologies

   EMail: hesham@elevatemobile.com

Narten, et al.              Standards Track                    [Page 96]
RFC 4861               Neighbor Discovery in IPv6         September 2007

Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Narten, et al.              Standards Track                    [Page 97]

```

[IETF](https://www.ietf.org/)
[IESG](https://www.ietf.org/iesg/)
[IAB](https://www.iab.org/)
[IRTF](https://www.irtf.org/)
[IETF LLC](https://www.ietf.org/llc/)
[IETF Trust](https://trustee.ietf.org/)
[RFC Editor](https://www.rfc-editor.org/)
[IANA](https://www.iana.org/)
[Privacy Statement](https://www.ietf.org/privacy-statement/)
[About IETF Datatracker](/release/about)
[Version 12.32.0
(release - 2c04f36)](https://github.com/ietf-tools/datatracker/releases/tag/12.32.0)

[System Status](https://status.ietf.org)

Report a bug:
[GitHub](https://github.com/ietf-tools/datatracker/issues/new/choose)
Email

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from blog.champtar.fr_afafd1a6_20250114_200843.html ===

[# blog.champtar.fr](/)
##

[View on GitHub](https://github.com/champtar/blog)

# Layer 2 network security bypass using VLAN 0, LLC/SNAP headers and invalid length

## TLDR

You should always drop unknown/unclassified traffic.
Using VLAN 0, LLC/SNAP headers and invalid length gives you multiple ways to
encapsulate the same L3 payload on Ethernet/Wifi, allowing to bypass some
L2 network security control implementations like IPv6 Router Advertisement Guard.

## Intro

Following my previous article on [VLAN 0](/VLAN0/), I had two itches to scratch.

First, after reading [Proper isolation of a Linux bridge article from Vincent Bernat](https://vincent.bernat.ch/en/blog/2017-linux-bridge-isolation) some time ago and seeing:

```
$ cat /proc/net/ptype
Type Device      Function
0800          ip_rcv
0011          llc_rcv [llc]
0004          llc_rcv [llc]
0806          arp_rcv
86dd          ipv6_rcv

```

I wanted to understand what were those `llc` packets and what I could do with them,
but it took me a long time and some luck to craft some useful packets with LLC/SNAP headers.

Second, I wanted to test bypassing layer 2 security on managed switches. As I was staying home for the end of 2020 (COVID …),
I decided to buy myself one of the cheapest Cisco switches with IPv6 first-hop security (CBS350-8T-E-2G), and was able to bypass its IPv6 RA Guard implementation using VLAN 0 and/or LLC/SNAP headers.

After reporting my findings to Cisco PSIRT, I reported these same bypasses to Juniper SIRT, but I didn’t have time to continue reporting to all network vendors and coordinate between them. Thankfully I discovered that you can [report vulnerabilities that affect multiple vendors to CERT/CC](https://www.kb.cert.org/vuls/report/) and they will take care of reporting to and coordinating between all vendors.

The packet syntax in this article is the one used by [Scapy](https://scapy.readthedocs.io/).
If you want to try the examples you might need to replace `Dot3()` with `Dot3(src=get_if_hwaddr(ifname))`.

## Ethernet frame types

If you want to know everything, the following pages will do a better job than me:

* [Wikipedia - Ethernet frame](https://en.wikipedia.org/wiki/Ethernet_frame)
* [Wikipedia - IEEE 802.2](https://en.wikipedia.org/wiki/IEEE_802.2)
* [Wikipedia - IEEE 802.3](https://en.wikipedia.org/wiki/IEEE_802.3)
* [RFC 894 - A Standard for the Transmission of IP Datagrams over Ethernet Networks](https://www.rfc-editor.org/rfc/rfc894)
* [RFC 948 - Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks](https://www.rfc-editor.org/rfc/rfc948)
* [RFC 1042 - A Standard for the Transmission of IP Datagrams over IEEE 802 Networks](https://www.rfc-editor.org/rfc/rfc1042)
* [RFC 1122 - Requirements for Internet Hosts – Communication Layers](https://www.rfc-editor.org/rfc/rfc1122)
* [RFC 2464 - Transmission of IPv6 Packets over Ethernet Networks](https://www.rfc-editor.org/rfc/rfc2464)
* [RFC 4840 - Multiple Encapsulation Methods Considered Harmful](https://www.rfc-editor.org/rfc/rfc4840)
* [RFC Draft - Extended Ethernet Frame Size Support](https://datatracker.ietf.org/doc/html/draft-ietf-isis-ext-eth)
* [RFC 5342 - Ethernet Protocol Parameters](https://www.rfc-editor.org/rfc/rfc5342#section-3)
* [Ask Wiresark - IEEE802a OUI Extended Ethertype](https://ask.wireshark.org/question/21547/ieee802a-oui-extended-ethertype/)
* [Novell - Migrating Ethernet Frame Types from 802.3 Raw to IEEE 802.2](https://support.novell.com/techcenter/articles/ana19930905.html)

To make it short, an Ethernet frame always starts with a preamble, start frame delimiter, MAC destination, MAC source, then VLAN headers (if used), and then the content depends on which of the 4 frame types you are using:

* Ethernet II: also known as DIX Ethernet, this is the most common, and starts with EtherType (2 bytes) that identifies the upper layer (0x0800 == IPv4, 0x0806 == ARP, 0x86DD == IPv6). See [RFC 894](%28https%3A//www.rfc-editor.org/rfc/rfc894%29) and [RFC 2464](https://www.rfc-editor.org/rfc/rfc2464).
* Novell raw IEEE 802.3: This was used to transport IPX until the mid-nineties, starts with 2 bytes length then 0xFFFF.
* IEEE 802.2 LLC: in IEEE 802.3 standard a frame starts with 2 bytes length followed by 802.2 LLC (logical link control) header. 802.2 defines 3 operational modes, but we are only interested in unacknowledged connection-less mode. IPv4 and ARP can be encapsulated in 802.2 LLC headers as defined in [RFC 948](https://www.rfc-editor.org/rfc/rfc948), but as said in [RFC 1010](https://www.rfc-editor.org/rfc/rfc1010) from 1987 “The use of the IP LSAP is to be phased out as quickly as possible”.
* IEEE 802.2 LLC/SNAP: [RFC 1042](https://datatracker.ietf.org/doc/html/rfc1042) defines how to encapsulate IP using LLC/SNAP, and this is the default for all 802 networks except Ethernet, DSAP == SSAP == 170 == 0xAA (SNAP Headers), Control == 3 (unacknowledged connectionless mode / U-format PDUs), SNAP OUI 24 bits == 0x000000 or 0x0000F8, SNAP protocol id 16 bits == EtherType.

![The 4 Ethernet frame formats](/VLAN0_LLC_SNAP/Ethernet-frame-formats.svg)

LLC/SNAP with OUI 0x000000 can be called “SNAP RFC1042”, and LLC/SNAP with OUI 0x0000f8 called “SNAP 802.1H”.
I found “SNAP 802.1H” by chance while looking at Linux mac80211 code.

Using Scapy notation, here are 3 ways to encapsulate an ICMP Echo request to 192.168.1.2:

```
Ether()/IP(dst='192.168.1.2')/ICMP()
Dot3()/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()
Dot3()/LLC(ctrl=3)/SNAP(OUI=0x0000f8)/IP(dst='192.168.1.2')/ICMP()

```

Scapy is computing a lot of values for us, here the same packets expanded a bit:

```
Ether(type=0x0800)/IP(dst='192.168.1.2')/ICMP()
Dot3()/LLC(dsap=0xaa,ssap=0xaa,ctrl=3)/SNAP(OUI=0x000000,code=0x0800)/IP(dst='192.168.1.2')/ICMP()
Dot3()/LLC(dsap=0xaa,ssap=0xaa,ctrl=3)/SNAP(OUI=0x0000f8,code=0x0800)/IP(dst='192.168.1.2')/ICMP()

```

[RFC1122 - Section 2.3.3](https://www.rfc-editor.org/rfc/rfc1122#section-2.3.3) states that:
“Every Internet host connected to a 10Mbps Ethernet cable:

* MUST be able to send and receive packets using RFC-894 encapsulation;
* SHOULD be able to receive RFC-1042 packets, intermixed with RFC-894 packets; and
* MAY be able to send packets using RFC-1042 encapsulation.
  An Internet host that implements sending both the RFC-894 and the RFC-1042 encapsulation MUST provide a configuration switch to select which is sent, and this switch MUST default to RFC-894.”

After reading section 2.3.3, it’s less surprising to know that Microsoft Windows has a boolean [ArpUseEtherSNAP](https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/setarpuseethersnap-method-in-class-win32-networkadapterconfiguration) that ‘enables TCP/IP to transmit Ethernet packets using 802.3 SNAP encoding’ and ‘by default, the stack transmits packets in Digital, Intel, Xerox (DIX) Ethernet format (but) it always receives both formats’, ie Windows accepts Ethernet II, “SNAP RFC1042” and “SNAP 802.1H” format.

LLC/SNAP Frames on 802.3 have a maximum size of 1500, so in 2001 [Extended Ethernet Frame Size Support RFC](https://datatracker.ietf.org/doc/html/draft-ietf-isis-ext-eth)
was sent out. In short, instead of having the length, use `0x8870` Ethertype. This RFC was never accepted, but Wireshark decodes such frame and Scapy forge them:

```
Ether()/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

(notice the `Ether()` instead of `Dot3()`)

To finish in 2003 the IEEE defined “OUI Extended Ethertype”, Ethertype `0x88B7` followed by 3 octets OUI and 2 octets protocol. We could say it’s LLC/SNAP without the LLC header.

```
Ether(type=0x88B7)/SNAP(OUI=0x000000)/IP(dst='192.168.1.2')/ICMP()
Ether(type=0x88B7)/SNAP(OUI=0x0000f8)/IP(dst='192.168.1.2')/ICMP()

```

And of course OUI Extended Ethertype can be encapsulated inside LLC/SNAP

```
Dot3()/LLC(ctrl=3)/SNAP(OUI=0x000000,code=0x88b7)/SNAP(OUI=0x000000)/IP(dst='192.168.1.2')/ICMP()

```
## Invalid 802.3 length

In an Ethernet frame, the 2 bytes after the source MAC can either be a length or an EtherType.
Values greater than or equal to 1536 (0x0600) indicates that the field is an EtherType and the frame an Ethernet II frame.
Values less than or equal to 1500 (0x05dc) indicates that the field is the length and the frame is Novell raw, 802.2 LLC or 802.2 LLC/SNAP.
Values between 1500 and 1536, exclusive, are undefined.

The 802.3 length is redundant with the frame length, so a simple implementation can ignore if the value is coherent and just do:

```
if (pkt[12:13] >= 1536):
    handle_ethernet2()
elif (pkt[14:15] == 0xaaaa):
    handle_llc_snap()
elif (pkt[14:15] == 0xffff):
    handle_novell_raw()
else:
    handle_llc()

```

Microsoft Windows accept 802.3 headers with any length between 0 and 1535 (0x05ff) inclusive.
On it’s own this is not an issue, but some devices doing L2 security ignore packets with length between 1501 and 1535 or with length that is not coherent with the frame length (they are not valid 802.3 packets after all), meaning they let rogue packets thru that are then accepted by Windows.

Here 2 simple example:

```
# bypass hyperv
Dot3(src=get_if_hwaddr(ifname),len=0)/LLC(ctrl=3)/SNAP()/ra
# bypass cisco
Dot3(src=get_if_hwaddr(ifname),len=0x05ff)/LLC(ctrl=3)/SNAP()/ra

```
## Frame conversion between 802.3/Ethernet and 802.11

If you open Wireshark, look at some packets on your wired interface and some packets on your wireless, you will likely see that all packets are using Ethernet II headers. You might also have seen in the past TCP packets bigger than the interface MTU. For some (good) reasons, your OS and Wireshark are lying to you.
If you want to see what real 802.11 traffic looks like, Wireshark wiki has some [802.11 sample captures](https://gitlab.com/wireshark/wireshark/-/wikis/SampleCaptures#wifi-wireless-lan-captures-80211).

Linux accepts IP packets with multiple VLAN 0 headers (see previous write-up) but not with LLC/SNAP encapsulation, what if we could combine both ?

When a frame is forwarded from 802.3/Ethernet to 802.11 (Wifi), the layer 2 part of the frame needs to be rewritten.
Linux 802.11 wireless stack (mac80211) accepts frames with both Ethernet II and 802.2 LLC/SNAP encapsulation as input, so both

```
Ether()/IP(dst='192.168.1.2')/ICMP()
Dot3()/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

become something that looks like

```
Dot11()/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

and if we mix VLAN 0 between LLC/SNAP and IP headers

```
Dot3()/LLC(ctrl=3)/SNAP()/Dot1Q(vlan=0)/IP(dst='192.168.1.2')/ICMP()

```

becomes something like

```
Dot11()/LLC(ctrl=3)/SNAP()/Dot1Q(vlan=0)/IP(dst='192.168.1.2')/ICMP()

```

For 802.3, VLAN headers should be between the source MAC and the length, whereas for all other 802 networks, VLAN headers are after the LLC/SNAP header.
By putting VLAN headers after the LLC/SNAP header for 802.3, we can bypass some L2 filtering, and still be accepted by most OS.

![Ethernet II / 802.3 / 802.11 / VLAN 0](/VLAN0_LLC_SNAP/Ethernet-8023-80211.svg)

If we send the following packet using Scapy on a wireless interface

```
Ether()/Dot1Q(vlan=0,type=len(LLC()/SNAP()/IP()/ICMP()))/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

Linux will actually send

```
Dot11()/LLC(ctrl=3)/SNAP()/Dot1Q(vlan=0,type=len(LLC()/SNAP()/IP()/ICMP()))/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

and when converted from 802.11 to Ethernet II we end up with

```
Ether()/Dot1Q(vlan=0,type=len(LLC()/SNAP()/IP()/ICMP()))/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

To finish, Linux will happily ignore the 802.3 length while converting from 802.3 to 802.11, so

```
Dot3(len=0)/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```

becomes a valid packet

```
Dot11()/LLC(ctrl=3)/SNAP()/IP(dst='192.168.1.2')/ICMP()

```
## How to test your network

As there are a lot of possible combinations, I’ve written a small script that uses Scapy to send many of them: [l2-security-whack-a-mole.py](/VLAN0_LLC_SNAP/l2-security-whack-a-mole.py).
Perform the attacks via both wired and wireless interfaces.
An example to send Router Advertisements

```
sudo python3 l2-security-whack-a-mole.py -i eth0 --i-want-to-break-my-network ipv6_ra <IPv6 Link Local addr of eth0> ff02::1

```
## Going deeper

While researching for those L2 attacks, I stumbled upon an awesome research from 2013 injecting specially crafted packets at L1 to confuse some switches and NICs:
[Fully arbitrary 802.3 packet injection Maximizing the Ethernet attack surface](http://dev.inversepath.com/download/802.3/whitepaper.txt)

## Impacted software / hardware

* Microsoft Hyper-V / OpenStack / LXD: [See previous write up](/VLAN0/#tested-software)
* Microsoft Hyper-V: [CVE-2021-28444](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28444) / [CVE-2022-21905](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21905)
* Cisco CBS350-8T-E-2G
* See list in [CERT/CC vulnerability note VU#855201](https://kb.cert.org/vuls/id/855201)

## Timeline

* 2020-12-14: Initial report to Microsoft of LLC/SNAP attack (VLAN 0 attack was reported earlier)
* 2020-12-30: Receive my CBS350-8T-E-2G
* 2020-01-01: Initial report to Cisco PSIRT / PSIRT-0213940748
* 2020-01-01: Initial report to Juniper SIRT / SIR-2021-001
* 2020-01-04: Initial report to CERT/CC / VU#855201
* 2021-02-05: Microsoft confirm the issue
* 2021-04-13: Microsoft release fixes for [CVE-2021-28444](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28444)
* 2021-04-20: RedHat reports that the kernel behaves as expected, it’s the user space responsibility to build correct filtering rules
* 2021-08-13: Ask if any vendors plan on releasing advisories / fixes
* 2021-08-23: All networks vendors really notified
* 2021-09-10: Initial report to Microsoft of 802.3 invalid length attack for both HyperV and Windows
* 2021-10-07: Share the 802.3 invalid length attack with everyone
* 2022-01-11: Microsoft releases fix for 802.3 invalid length attack for HyperV [CVE-2022-21905](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21905)
* 2022-01-25: Resubmit 802.3 invalid length attack for Windows
* 2022-01-11: [IEEE meeting](https://1.ieee802.org/maintenance-tg-electronic-meeting-agenda-january-11-2022-11-am-et/) discussing those bypass
* 2022-03-25: Microsoft won’t fix Windows accepting 802.3 packets with invalid length
* 2022-09-27: Public disclosure of [CVE-2021-27853 / CVE-2021-27854 / CVE-2021-27861 / CVE-2021-27862](https://kb.cert.org/vuls/id/855201)

## Acknowledgments

* Thanks to Microsoft for their bounties
* Thanks to RedHat engineers for their time discussing what was wrong in my initial report
* Thanks to CERT/CC Team for the coordination work



=== Content from datatracker.ietf.org_5111764b_20250114_200846.html ===


[Skip to main content](#content)
[![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor-white.svg)
![IETF Logo](https://static.ietf.org/dt/12.32.0/ietf/images/ietf-logo-nor.svg)
Datatracker](/)

* Groups
  + By area/parent
  + [Apps & Realtime](/wg/#ART)
  + [General](/wg/#GEN)
  + [Internet](/wg/#INT)
  + [Ops & Management](/wg/#OPS)
  + [Routing](/wg/#RTG)
  + [Security](/wg/#SEC)
  + [Web and Internet Transport](/wg/#WIT)
  + [IAB](/program/)
  + [IRTF](/rg/)
  + [IETF LLC](/adm/)
  + [RFC Editor](/rfcedtyp/)
  + [Other](/group/)
    - [Active AGs](/ag/)
    - [Active Areas](/area/)
    - [Active Directorates](/dir/)
    - [Active IAB Workshops](/iabworkshop/)
    - [Active Programs](/program/)
    - [Active RAGs](/rag/)
    - [Active Teams](/team/)
  + ---
  + New work
  + [Chartering groups](/group/chartering/)
  + [BOFs](/wg/bofs/)
  + [BOF Requests](/doc/bof-requests)
  + ---
  + Other groups
  + [Concluded groups](/group/concluded/)
  + [Non-WG lists](/list/nonwg)
* Documents
  + [Search](/doc/search)
  + [Recent I-Ds](/doc/recent)
  + [I-D submission](/submit/)
  + [IESG dashboard](/doc/ad)
  + ---
  + RFC streams
  + [IAB](/stream/iab/)
  + [IRTF](/stream/irtf/)
  + [ISE](/stream/ise/)
  + [Editorial](/stream/editorial/)
  + ---
  + Subseries
  + [STD](/doc/std)
    [BCP](/doc/bcp)
    [FYI](/doc/fyi)
* Meetings
  + [Agenda](/meeting/agenda)
  + [Materials](/meeting/materials)
  + [Floor plan](/meeting/floor-plan)
  + [Registration](https://www.ietf.org/how/meetings/register/)
  + [Important dates](/meeting/important-dates/)
  + [Request a session](/secr/sreq/)
  + [Session requests](/meeting/requests)
  + ---
  + Upcoming meetings
  + [Upcoming meetings](/meeting/upcoming)
  + ---
  + Past meetings
  + [Past meetings](/meeting/past)
  + [Meeting proceedings](https://www.ietf.org/how/meetings/past/)
* Other
  + [IPR disclosures](/ipr/)
  + [Liaison statements](/liaison/)
  + [IESG agenda](/iesg/agenda/)
  + [NomComs](/nomcom/)
  + [Downref registry](/doc/downref)
  + [Statistics](/stats/)
    - [I-Ds/RFCs](/stats/document/)
    - [Meetings](/stats/meeting/)
  + [API Help](/api/)
  + [Release notes](/release/)
  + [System status](https://status.ietf.org)
  + ---
  + [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
* User
  + [Sign in](/accounts/login/?next=/doc/draft-ietf-v6ops-ra-guard/08/)
  + [Password reset](/accounts/reset/)
  + [Preferences](/accounts/settings/)
  + [New account](/accounts/create/)

[Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose)
[Sign in](/accounts/login/?next=/doc/draft-ietf-v6ops-ra-guard/08/)

**Javascript disabled?** Like other modern websites, the IETF Datatracker relies on Javascript.
Please enable Javascript for full functionality.

# IPv6 Router Advertisement Guard draft-ietf-v6ops-ra-guard-08

* [Status](/doc/draft-ietf-v6ops-ra-guard/)
* [IESG evaluation record](/doc/draft-ietf-v6ops-ra-guard/ballot/)
* [IESG writeups](/doc/draft-ietf-v6ops-ra-guard/writeup/)
* [Email expansions](/doc/draft-ietf-v6ops-ra-guard/email/)
* [History](/doc/draft-ietf-v6ops-ra-guard/history/)

Versions:

* [08](/doc/draft-ietf-v6ops-ra-guard/08/)
* [RFC 6105](/doc/rfc6105/)

The information below is for an old version of the document that is already published as an RFC.

| Document | Type |  | This is an older version of an Internet-Draft that was ultimately published as [RFC 6105](/doc/rfc6105/). |
| --- | --- | --- | --- |
|  | Authors |  | [Gunter Van de Velde](/person/gunter%40vandevelde.cc "Datatracker profile of Gunter Van de Velde") , [János Mohácsi](/person/mohacsi%40niif.hu "Datatracker profile of János Mohácsi") , [Eric Levy-Abegnoli](/person/elevyabe%40gmail.com "Datatracker profile of Eric Levy-Abegnoli") , [Chip Popoviciu](/person/cpopovic%40cisco.com "Datatracker profile of Chip Popoviciu") |
|  | Last updated |  | 2015-10-14 (Latest revision 2010-09-02) |
|  | RFC stream |  | Internet Engineering Task Force (IETF) |
|  | Intended RFC status |  | Informational |
|  | Formats |  | [txt](https://www.ietf.org/archive/id/draft-ietf-v6ops-ra-guard-08.txt) [html](https://www.ietf.org/archive/id/draft-ietf-v6ops-ra-guard-08.html) [xml](https://www.ietf.org/archive/id/draft-ietf-v6ops-ra-guard-08.xml) [htmlized](/doc/html/draft-ietf-v6ops-ra-guard-08) [bibtex](/doc/draft-ietf-v6ops-ra-guard/08/bibtex/) [bibxml](/doc/bibxml3/draft-ietf-v6ops-ra-guard-08.xml) |
|  | Reviews |  | [SECDIR Early review by Nicolás Williams](/doc/review-ietf-v6ops-ra-guard-secdir-early-williams-2010-06-21/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/v6ops/?q=draft-ietf-v6ops-ra-guard) |
| Stream | [WG state](/doc/help/state/draft-stream-ietf/) |  | (None) |
| --- | --- | --- | --- |
|  | Document shepherd |  | (None) |
| IESG | [IESG state](/doc/help/state/draft-iesg/) |  | Became [RFC 6105](/doc/rfc6105/) (Informational) |
| --- | --- | --- | --- |
|  | Action Holders |  | (None) |
|  | Consensus boilerplate |  | Unknown |
|  | Telechat date |  | (None) |
|  | Responsible AD |  | [Ron Bonica](/person/rbonica%40juniper.net "Datatracker profile of Ron Bonica") |
|  | Send notices to |  | (None) |

Email authors
Email WG
[IPR
1](/ipr/search/?submit=draft&id=draft-ietf-v6ops-ra-guard)
[References](/doc/draft-ietf-v6ops-ra-guard/references/)
[Referenced by](/doc/draft-ietf-v6ops-ra-guard/referencedby/)
[Nits](https://author-tools.ietf.org/api/idnits?url=https://www.ietf.org/archive/id/draft-ietf-v6ops-ra-guard-08.txt)
[Search email archive](https://mailarchive.ietf.org/arch/search/?q=%22draft-ietf-v6ops-ra-guard%22)

draft-ietf-v6ops-ra-guard-08

```
v6ops Working Group                                     E. Levy-Abegnoli
Internet-Draft                                           G. Van de Velde
Intended status: Informational                              C. Popoviciu
Expires: March 6, 2011                                     Cisco Systems
                                                              J. Mohacsi
                                                          NIIF/Hungarnet
                                                      September 02, 2010

                    IPv6 Router Advertisement Guard
                   <draft-ietf-v6ops-ra-guard-08.txt>

Abstract

   Routed protocols are often susceptible to spoof attacks.  The
   canonical solution for IPv6 is Secure Neighbor Discovery (SEND), a
   solution that is non-trivial to deploy.  This document proposes a
   light-weight alternative and complement to SEND based on filtering in
   the layer-2 network fabric, using a variety of filtering criteria,
   including, for example, SEND status.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on March 6, 2011.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 1]
Internet-Draft                IPv6 RA-Guard               September 2010

   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 2]
Internet-Draft                IPv6 RA-Guard               September 2010

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Model and Applicability  . . . . . . . . . . . . . . . . . . .  4
   3.  Stateless RA-Guard . . . . . . . . . . . . . . . . . . . . . .  6
   4.  Stateful RA-Guard  . . . . . . . . . . . . . . . . . . . . . .  6
     4.1.  State Machine  . . . . . . . . . . . . . . . . . . . . . .  7
     4.2.  SEND-based RA-Guard  . . . . . . . . . . . . . . . . . . .  8
   5.  RA-Guard Use Considerations  . . . . . . . . . . . . . . . . .  9
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  9
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . .  9
   8.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  9
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 10
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 10
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 10
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 10

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 3]
Internet-Draft                IPv6 RA-Guard               September 2010

1.  Introduction

   When operating IPv6 in a shared L2 network segment without complete
   SEND support by all devices connected or without the availability of
   the infrastructure necessary to support Secure Neighbor Discovery
   (SEND) [RFC3971], there is always the risk of facing operational
   problems due to rogue Router Advertisements generated maliciously or
   unintentionally by unauthorized or improperly configured routers
   connecting to the segment.

   There are several examples of work done on this topic which resulted
   in several related studies [reference1] [reference2]
   [reference3].This document describes a solution framework for the
   rogue-RA problem where network segments are designed around a single
   or a set of L2-switching devices capable of identifying invalid RAs
   and blocking them.  The solutions developed within this framework can
   span the spectrum from basic (where the port of the L2 device is
   statically instructed to forward or not to forward RAs received from
   the connected device) to advanced (where a criteria is used by the L2
   device to dynamically validate or invalidate a received RA, this
   criteria can even be based on SEND mechanisms).

2.  Model and Applicability

   RA-Guard applies to an environment where all messages between IPv6
   end-devices traverse the controlled L2 networking devices.  It does
   not apply to a shared media, when devices can communicate directly
   without going through an RA-Guard capable L2 networking device.

   Figure 1 illustrates a deployment scenario for RA-Guard.

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 4]
Internet-Draft                IPv6 RA-Guard               September 2010

                     Block                Allow
      +------+       incoming +---------+ incoming     +--------+
      |Host  |       RA       |    L2   | RA           | Router |
      |      |----------------|  device |--------------|        |
      +------+                +----+----+              +--------+
                                   |
                                   |Block
                                   |incoming
                                   |RA
                                   |
                                   |
                                   |
                               +---+---+
                               |  Host |
                               |       |
                               +-------+

   Figure 1

   RA-Guard does not intend to provide a substitute for SEND based
   solutions.  It actually intends to provide complementary solutions in
   those environments where SEND might not be suitable or fully
   supported by all devices involved.  It may take time until SEND is
   ubiquitous in IPv6 networks and some of its large scale deployment
   aspects are sorted out such as provisioning hosts with trust anchors.
   It is also reasonable to expect that some devices might not consider
   implementing SEND at all such as IPv6 enabled sensors.  An RA-Guard
   implementation which SEND-validates RAs on behalf of hosts would
   potentially simplify some of these challenges.

   RA-Guard can be seen as a superset of SEND with regard to router
   authorization.  Its purpose is to filter Router Advertisements based
   on a set of criteria, from a simplistic "RA disallowed on a given
   interface" to "RA allowed from pre-defined sources" and up to full
   fledge SEND "RA allowed from authorized sources only".

   In addition to this granularity on the criteria for filtering out
   Router Advertisements, RA-Guard introduces the concept of router
   authorization proxy.  Instead of each node on the link analyzing RAs
   and making an individual decision, a legitimate node-in-the-middle
   performs the analysis on behalf of all other nodes on the link.  The
   analysis itself is not different from what each node would do: if
   SEND is enabled, the RA is checked against X.509 certificates
   [RFC4861].  If any other criteria is in use, such as known L3
   (addresses) or L2 (link-layer address, port number) legitimate
   sources of RAs, the node-in-the middle can use this criteria and
   filter out any RA that does not comply.  If this node-in-the-middle
   is a L2 device, it will not change the content of the validated RA,

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 5]
Internet-Draft                IPv6 RA-Guard               September 2010

   and avoid any of the ND-proxy pitfalls.

   RA-Guard intends to provide simple solutions to the rogue-RA problem
   in contexts where simplicity is required while leveraging SEND in an
   context environment consisting of with a mix of SEND capable devices
   (L2 switches and routers) and devices that do not consistently use
   SEND.  Furthermore, RA-Guard is useful to simplify SEND deployments,
   as only the L2 switch and the routers are required to carry
   certificates (their own and the trust anchor certificates).

3.  Stateless RA-Guard

   Stateless RA-Guard examines incoming RAs and decide whether to
   forward or block them based solely on information found in the
   message or in the L2-device configuration.  Typical information
   available in the frames received, useful for RA validation is:

   o  Link-layer address of the sender
   o  Port on which the frame was received
   o  IP source address
   o  Prefix list

   The following configuration information created on the L2-device can
   be made available to RA-Guard, to validate against the information
   found in the received RA frame:

   o  Allowed/Disallowed link-layer address of RA-sender
   o  Allowed/Disallowed ports for receiving RAs
   o  Allowed/Disallowed IP source addresses of RA-sender
   o  Allowed Prefix list and Prefix ranges
   o  Router Priority

   Once the L2 device has validated the content of the RA frame against
   the configuration, it forwards the RA to destination, whether unicast
   or multicast.  Otherwise, the RA is dropped.

   An example of a very simple stateless RA-Guard implementation could
   be a small L2-switch for which there is one interface "statically-
   configured" as the interface connecting to a router, while all other
   interfaces are for non-router devices.  With his small static setup
   the only interface forwarding RAs will be the pre-assigned router
   interface, while the non-router interfaces block all RAs.

4.  Stateful RA-Guard

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 6]
Internet-Draft                IPv6 RA-Guard               September 2010

4.1.  State Machine

   Stateful RA-Guard learns dynamically about legitimate RA senders, and
   store this information for allowing subsequent RAs.  A simple
   stateful scheme would be for the L2-device to listen to RAs during a
   certain manual determined period of time, where the start of the
   listening-period and the duration of the listening-period for a
   single instance is controled by the manual intervention.  As result
   the L2-device can then allow subsequent RAs only on those ports on
   which valid RAs were received during this period.  Often the LEARNING
   state will only be activated by manual configuration when a new IPv6
   router is provisioned on the L2-network.

   A more sophisticated stateful scheme is based on SEND, and is
   described in Section 4.2.

   The state machine for stateful RA-Guard can be global, per-interface,
   or per-peer, depending on the scheme used for authorizing RAs.

   When RA-Guard is SEND-based, the state machine is per-peer and
   defined in [RFC3971].

   When RA-Guard is using a discovery method, the state-machine of the
   RA-Guard capability consists of four different states:

   o  State 1: OFF
         A device or interface in RA-Guard "OFF" state, operates as if
         the RA-Guard capability is not available.
   o  State 2: LEARNING
         A device or interface in the RA-Guard "Learning" state is
         actively acquiring information about the IPv6 routing devices
         connected.  The learning process takes place over a pre-defined
         unique period in time, set by manual configuration or it can be
         event triggered.  The information gathered is compared against
         pre-defined criteria; criteria similar as the stateless RA-
         Guard rules to qualify the validity of the RAs.
         In this state, the RA-Guard enabled device or interface is
         either blocking "all" RAs until their validity is verified or,
         alternatively it can temporarily forward "all" the RAs until
         their validity is verified.
         Once the L2-device has identified through "Learning" the valid
         IPv6 routers and hence also identified the valid RAs, it
         transtions each interface from "LEARNING" into either BLOCKING
         state if there was no valid IPv6 router discovered at the
         interface, or transitions the interface into FORWARDING state
         if there was a valid IPv6 router discovered.

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 7]
Internet-Draft                IPv6 RA-Guard               September 2010

   o  State 3: BLOCKING
         A device or interface running RA-Guard and in Blocking state
         will block ingress RA-messages.
         An interface can transition from BLOCKING state into FORWARDING
         state directly if explicitly instructed by the L2-device
         operator.
         An interface can transition from BLOCKING state into LEARNING
         state if either explicitly told by the L2-device operator or by
         a triggered event.
   o  State 4: FORWARDING
         A device or interface running RA-Guard and in Forwarding state
         will accept valid ingress RAs and forward them to their
         destination.
         An interface can transition from FORWARDING state into BLOCKING
         state directly if explicitly instructed by the L2-device
         operator.
         An interface can transition from FORWARDING state into LEARNING
         state if either explicitly told by the L2-device operator or by
         a triggered event.

   The transition between these states can be triggered by manual
   configuration or by meeting a pre-defined criteria.

4.2.  SEND-based RA-Guard

   In this scenario, the L2 device is blocking or forwarding RAs based
   on SEND considerations.  Upon capturing an RA on the interface, the
   L2-device will first verify the Cryptographically Generated Addresses
   (CGA) [RFC3971] address and the RSA (Rivest, Shamir and Adleman
   algorithm for public-key cryptography) signature, as specified in
   section 5 of [RFC3971].  RA should be dropped in case of failure of
   this verification.  It will then apply host behavior as described in
   section 6.4.6 of [RFC3971].  In particular, the L2 device will
   attempt to retrieve a valid certificate from its cache for the public
   key referred to in the RA.  If such certificate is found, the L2
   device will forward the RA to destination.  If not, the L2 device
   will generate a Certification Path Solicitation (CPS) [RFC3971],
   sourced with UNSPECIFIED address, to query the router certificate(s).
   It will then capture the Certification Path Advertisements (CPA)
   [RFC3971], and attempt to validate the certificate chain.  Failure to
   validate the chain will result in dropping the RA.  Upon validation
   success, the L2 device will forward the RA to destination and and
   store the router certificate in its cache.

   In order to operate in this scenario, the L2-device should be
   provisioned with a trust anchor certificate, as specified in section
   6 of [RFC3971].  It may also establish a layer-3 connectivity with a
   Certificate Revocation List (CRL) Certification Path Advertisement

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 8]
Internet-Draft                IPv6 RA-Guard               September 2010

   server and/or with and NTP server.  Bootstrapping issue in this case
   can be resolved by using the configuration method to specify a
   trusted port to a first router, and SEND-based RA-Guard method on all
   other ports.  The first router can then be used for Network Time
   Protocol (NTP) [RFC5905] and CRL connectivity.

5.  RA-Guard Use Considerations

   The RA-Guard mechanism is effective only when all messages between
   IPv6 devices in the target environment traverse controlled L2
   networking devices.  In the case of environments such as Ethernet
   hubs, devices can communicate directly without going through an RA-
   Guard capable L2 networking device, the RA-Guard feature cannot
   protect against rogue-RAs.

   RA-Guard mechanisms do not offer protection in environments where
   IPv6 traffic is tunneled.

6.  IANA Considerations

   There are no extra IANA consideration for this document.

7.  Security Considerations

   Once RA-Guard has setup the proper criteria, for example, it
   identified that a port is allowed to receive RAs, or it identified
   legitimate sources of RA, or certificate base [RFC4861], then there
   is no possible instances of accidently filtered legitimate Router
   advertisements assuming the RA-Guard filter enforcement follows
   strictly the RA-Guard set criteria.

   in Section 4.1 a simple mechanism to learn dynamical the valid IPv6
   routers connected to a L2-device is explained.  It is important that
   this LEARN state is only entered intentionally by manual
   configuration.  The list of learned IPv6 routers should be verified
   by the network manager to make sure that it corresponds with the
   expected valid RA list.  This procedure will make sure that either
   accidently or intentionally rogue RAs are blocked by RA-guard.

8.  Acknowledgements

   The authors dedicate this document to the memory of Jun-ichiro Hagino
   (itojun) for his contributions to the development and deployment of
   IPv6.

Levy-Abegnoli, et al.     Expires March 6, 2011                 [Page 9]
Internet-Draft                IPv6 RA-Guard               September 2010

9.  References

9.1.  Normative References

   [RFC3971]  Arkko, J., Kempf, J., Zill, B., and P. Nikander, "SEcure
              Neighbor Discovery (SEND)", RFC 3971, March 2005.

   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", RFC 4861,
              September 2007.

   [RFC4158]  Cooper, M., Dzambasow, Y., Hesse, P., Joseph, S., and R.
              Nicholas, "Internet X.509 Public Key Infrastructure:
              Certification Path Building", RFC 4158, September 2005.

   [RFC5905]  Mills, D., Martin, J., Burbank, J., and W. Kasch, "Network
              Time Protocol Version 4: Protocol and Algorithms
              Specification", RFC 5905, June 2010.

9.2.  Informative References

   [reference1]
              LORIA/INRIA, "NDPMon - IPv6 Neighbor Discovery Protocol
              Monitor (http://ndpmon.sourceforge.net/)", November 2007.

   [reference2]
              KAME Project, "rafixd - developed at KAME - An active
              rogue RA nullifier (http://www.kame.net/dev/cvsweb2.cgi/
              kame/kame/kame/rafixd/)", November 2007.

   [reference3]
              Hagino (itojun), Jun-ichiro., "Discussion of the various
              solutions (http://ipv6samurais.com/ipv6samurais/
              demystified/rogue-RA.html)", 2007.

   [reference4]
              Chown, Tim. and Stig. Venaas, "Rogue IPv6 Router
              Advertisement Problem (draft-ietf-v6ops-rogue-ra-00.txt)",
              May 2009.

Levy-Abegnoli, et al.     Expires March 6, 2011                [Page 10]
Internet-Draft                IPv6 RA-Guard               September 2010

Authors' Addresses

   Eric Levy Abegnoli
   Cisco Systems
   Village d'Entreprises Green Side - 400, Avenue Roumanille
   Biot - Sophia Antipolis, PROVENCE-ALPES-COTE D'AZUR  06410
   France

   Phone: +33 49 723 2620
   Email: elevyabe@cisco.com

   Gunter Van de Velde
   Cisco Systems
   De Kleetlaan 6a
   Diegem  1831
   Belgium

   Phone: +32 2704 5473
   Email: gunter@cisco.com

   Ciprian Popoviciu
   Cisco Systems
   7025-6 Kit Creek Road
   Research Triangle Park, North Carolina  NC 27709-4987
   USA

   Phone: +1 919 392-3723
   Email: cpopovic@cisco.com

   Janos Mohacsi
   NIIF/Hungarnet
   18-22 Victor Hugo
   Budapest  H-1132
   Hungary

   Phone: tbc
   Email: mohacsi@niif.hu

Levy-Abegnoli, et al.     Expires March 6, 2011                [Page 11]

```

[IETF](https://www.ietf.org/)
[IESG](https://www.ietf.org/iesg/)
[IAB](https://www.iab.org/)
[IRTF](https://www.irtf.org/)
[IETF LLC](https://www.ietf.org/llc/)
[IETF Trust](https://trustee.ietf.org/)
[RFC Editor](https://www.rfc-editor.org/)
[IANA](https://www.iana.org/)
[Privacy Statement](https://www.ietf.org/privacy-statement/)
[About IETF Datatracker](/release/about)
[Version 12.32.0
(release - 2c04f36)](https://github.com/ietf-tools/datatracker/releases/tag/12.32.0)

[System Status](https://status.ietf.org)

Report a bug:
[GitHub](https://github.com/ietf-tools/datatracker/issues/new/choose)
Email

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from www.cisco.com_abe025ae_20250115_120008.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/%3Clocale%3E/support/index.html)
# My Notifications

Create custom subscriptions for Cisco products, series, or software to receive email alerts or consume RSS feeds when new announcements are released for the following notices:

* Cisco Security Advisories
* Field Notices
* End of Sale and End-of-Support Announcements
* Software Updates
* Updates to Known Bugs

[Log In to My Notifications](/c/login/index.html?referer=https://cway.cisco.com/mynotifications)![](/etc/designs/cdc/fw/i/icon_lock_small.png "Login Required")

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from standards.ieee.org_421c8fde_20250114_200851.html ===


* [IEEE.org](https://www.ieee.org/ "IEEE.org")
* [IEEE *Xplore*
  Digital Library](https://ieeexplore.ieee.org/Xplore/home.jsp "IEEE Xplore Digital Library")
* [IEEE Standards](https://standards.ieee.org/ "IEEE Standards")
* [IEEE Spectrum](https://spectrum.ieee.org/ "IEEE Spectrum")
* [More Sites](https://www.ieee.org/sitemap.html "More Sites")

* [eTools](/develop/etools/ "eTools")

[![IEEE Standards Association (IEEE SA) Logo](data:image/gif;base64...)](/ "IEEE Standards Association")

[![IEEE Logo](data:image/gif;base64...)](https://www.ieee.org/ "Visit IEEE.org")

* Standards
  + [Access Standards](https://standards.ieee.org/access-standards/)
  + [Search Standards](https://standards.ieee.org/standard/)
  + [Standards Development](https://standards.ieee.org/develop/)
  + [Standards Adoption](https://standards.ieee.org/develop/standards-adoption/)
  + [Where Life Meets Standards](https://standards.ieee.org/about/standards-in-action/)
* Products & Programs
  + [Alliance Management Services](https://standards.ieee.org/products-programs/ams/)
  + [Conformity Assessment & Certification](https://standards.ieee.org/products-programs/icap/)
  + [IEEE SA Open Source](https://standards.ieee.org/initiatives/opensource/)
  + [Industry Affiliate Network (IAN)](https://standards.ieee.org/products-programs/industry-affiliate-network/)
  + [Industry Connections](https://standards.ieee.org/industry-connections/)
  + [The National Electrical Safety Code® (NESC®)](https://standards.ieee.org/products-programs/nesc/)
  + [Registration Authority](https://standards.ieee.org/products-programs/regauth/)
  + [Government Engagement Program on Standards (GEPS)](https://standards.ieee.org/about/intl/government-engagement-program/)
  + [Standards Fellowship](https://standards.ieee.org/about/intl/standards-fellowship-program/)
  + [All Products & Programs](https://standards.ieee.org/products-programs/)
* Focuses
  + [Autonomous and Intelligent Systems (AIS)](https://standards.ieee.org/initiatives/autonomous-intelligence-systems/)
  + [Connectivity & Telecom](https://standards.ieee.org/practices/connectivity-telecom/)
  + [Energy](https://standards.ieee.org/practices/energy/)
  + [Foundational Technologies](https://standards.ieee.org/practices/foundational/)
  + [Government Engagement](https://standards.ieee.org/about/intl/)
  + [Healthcare and Life Sciences](https://standards.ieee.org/practices/healthcare-life-sciences/)
  + [Mobility](https://standards.ieee.org/practices/mobility/)
* Get Involved
  + [How to Get Involved](https://standards.ieee.org/participate/)
  + [Events](https://standards.ieee.org/events/)
  + [IEEE SA Membership](https://standards.ieee.org/about/membership/)
* Resources
  + [Training & Development](https://standards.ieee.org/about/training/)
  + [News](https://standards.ieee.org/news/)
  + [IEEE SA Newsletter](https://standards.ieee.org/news/swire/)
  + [Standards Store](https://store.accuristech.com/ieee?utm_source=standards&utm_medium=web&utm_campaign=standards-referral "Standards Store (Opens in a New Tab)")
  + [Beyond Standards Blog](https://standards.ieee.org/beyond-standards/)
  + [Where Life Meets Standards](https://standards.ieee.org/about/standards-in-action/)
  + [About Us](https://standards.ieee.org/about/)
  + [Contact Us](https://standards.ieee.org/about/contact/)
  + [Provide Feedback](https://standards.ieee.org/about/feedback/)
* [MAC ADDRESS](https://standards.ieee.org/products-programs/regauth/mac/)

## Featured Links

* [IEEE Conformity Assessment Program (ICAP)](https://standards.ieee.org/products-programs/icap/)
* [IEEE SA Entity Membership](https://standards.ieee.org/about/membership/organizations/)
* [Strong Sustainability by Design: IEEE Planet Positive 2030](https://sagroups.ieee.org/planetpositive2030/our-work/)

## Quick Links

* [Search Standards](https://standards.ieee.org/standard/)
* [Access Standards](https://standards.ieee.org/access-standards/)
* [IEEE SA Membership](https://standards.ieee.org/about/membership/)

## Most Viewed Pages

* [Search](https://standards.ieee.org/search/ "Search")
* [Home](https://standards.ieee.org/ "Home")
* [Registration Authority](https://standards.ieee.org/products-programs/regauth/ "Registration Authority")

Search the IEEE SA Website...

[MAC ADDRESS](/products-programs/regauth/)

Inactive-Withdrawn Standard

# IEEE/ISO 802.2-1989

## ISO/IEEE International Standard - Information processing systems – Local area networks - Part 2: Logic Link Control

[Purchase](https://store.accuristech.com/ieee/products/vendor_id/1048)
[Access via Subscription](http://ieeexplore.ieee.org/servlet/opac?punumber=5776619)

1. [Home](https://standards.ieee.org "Home")
2. [Standards](https://standards.ieee.org/search/?q=Standard "Standards")
3. ISO/IEEE International Standard – Information processing systems – Local area networks – Part 2: Logic Link Control

This standard is part of a family of local area network (LAN) standards dealing with the physical and data link layers as defined by the ISO Open Systems Interconnection Reference Model. It describes the functions, features, protocol, and services of the logical link control (LLC) sublayer, which constitutes the top sublayer in the data link layer of the ISO 8802 Local Area Network Protocol. The services required of, or by, the LLC sublayer at the logical interfaces with the network layer, the MAC sublayer, and the LLC sublayer management function are specified. The protocol data unit (PDU) structure for data communication systems is defined using bit-oriented procedures, as are two types of operation for data communication between service access points. In one type of operation, PDUs are exchanged between LLCs without the need for the establishment of a data link connection. In the other, a data link connection is established between two LLCs prior to any exchange of information-bearing PDUs.

Standard Committee
[C/LAN/MAN - LAN/MAN Standards Committee](http://www.ieee802.org/)

Status
Inactive-Withdrawn Standard
Superseded by
[802.5p-1993](https://standards.ieee.org/ieee/802.5p/1120)

Amendments
[802.2a-1993](https://standards.ieee.org/ieee/802.2a/1049)

[802.2b-1993](https://standards.ieee.org/ieee/802.2b/1050)

[802.2c-1997](https://standards.ieee.org/ieee/802.2c/1051)

[802.2d-1993](https://standards.ieee.org/ieee/802.2d/1052)

[802.2e-1993](https://standards.ieee.org/ieee/802.2e/1053)

[802.2f-1997](https://standards.ieee.org/ieee/802.2f/1054)

[802.2h-1997](https://standards.ieee.org/ieee/802.2h/1056)

Board Approval
1989-08-17
History
Withdrawn:
2011-01-13
ANSI Approved:
1990-01-12
Published:
1989-12-31
Reaffirmed:
2003-12-10

### Working Group Details

Society
[IEEE Computer Society](http://www.computer.org "IEEE Computer Society")
Standard Committee
[C/LAN/MAN - LAN/MAN Standards Committee](http://www.ieee802.org/ "C/LAN/MAN - LAN/MAN Standards Committee")

Working Group
WG802.2 - Logical Link Working Group

IEEE Program Manager
Jodi Haasz
Contact Jodi Haasz

#### Other Activities From This Working Group

* Active Projects
* Active Standards
* Superseded
  Standards
* Inactive-Withdrawn Standards
* Inactive-Reserved Standards

**Current projects that have been authorized by the IEEE SA Standards
Board to develop a standard.**

---

No Active Projects

**Standards approved by the IEEE SA Standards Board that are within the
10-year lifecycle.**

---

No Active Standards

**These standards have been replaced with a revised version of the
standard, or by a compilation of the original active standard and all
its existing amendments, corrigenda, and errata.**

---

No Superseded Standards

**These standards have been removed from active status through a ballot
where the standard is made inactive as a consensus decision of a
balloting group.**

---

##### 802.2a-1993

###### Standard for Flow Control Techniques for Bridged Local Area Networks

Provide updates to the existing 802.2 Standard.

[Learn More
About 802.2a-1993](https://standards.ieee.org/ieee/802.2a/1049 "Learn More")

##### 802.2b-1993

###### Standard for Acknowledged Connectionless-Mode Service and Protocol (Type 3 Operation)

Abstract not available. See ISO/IEC 8802-2.

[Learn More
About 802.2b-1993](https://standards.ieee.org/ieee/802.2b/1050 "Learn More")

##### 802.2c-1997

###### Part 2: Logical link control--Supplement 3: Conformance requirements

This IEEE Standards product is part of the 802 family on LAN/MAN. This standard is part of a family of standards for local area networks (LANs) and metropolitan area networks (MANs) that deals with the physical and data link layers as defined by the ISO Open Systems Interconnection Basic Reference Model. The functions, features, protocol, and services of the Logical Link Control (LLC) sublayer, which constitutes the top sublayer in the data link layer of the ISO/IEC 8802 LAN protocol, are described. The services required of, or by, the LLC sublayer at the logical interfaces with the network layer, the medium access control (MAC) sublayer, and the LLC sublayer management function are specified. The protocol data unit (PDU) structure for data communication systems is defined using bit-oriented procedures, as are three types of operation for data communication between service access points. In the first type of operation, PDUs are exchanged between LLCs without the need for the establishment of a data link connection. In the second type of operation, a data link connection is established between two LLCs prior to any exchange of information-bearing PDUs. In the third type of operation, PDUs are exchanged between LLCs without the need for the establishment of a data link connection, but stations are permitted to both send data and request the return of data simultaneously.

[Learn More
About 802.2c-1997](https://standards.ieee.org/ieee/802.2c/1051 "Learn More")

##### 802.2d-1993

###### Supplement to 802.2, Information Processing Systems - Local Area Networks - Part 2: Logical Link Control

Abstract not available. See ISO/IEC 8802-2.

[Learn More
About 802.2d-1993](https://standards.ieee.org/ieee/802.2d/1052 "Learn More")

##### 802.2e-1993

###### Supplement to 802.2, Information Processing Systems - Local Area Networks - Part 2: Logical Link Control - Bit Referencing

Abstract not available. See ISO/IEC 8802-2.

[Learn More
About 802.2e-1993](https://standards.ieee.org/ieee/802.2e/1053 "Learn More")

##### 802.2f-1997

###### Managed objects definition for logical link control (LLC)

Define LLC Management Objects for Type 1, Type 2, and Type 3 Operations, including their attributes, actions, and event notifications.

[Learn More
About 802.2f-1997](https://standards.ieee.org/ieee/802.2f/1054 "Learn More")

##### 802.2h-1997

###### Optional toleration of duplicate information transfer format protocol data units (IPDUs)

Provide a procedural option in Type 2 operation that will allow a receiver to tolerate the receipt of an already correctly received I PDU by discarding it instead of initiating a Frame Reject (FRMR) exception condition that would require the reset of the logical link control procedure.

[Learn More
About 802.2h-1997](https://standards.ieee.org/ieee/802.2h/1056 "Learn More")

##### 802.5p-1993

###### Standard for Information Processing Systems--Local Area Networks--Part 2: Logical Link Control--Annex X: End system Route Determination

Abstract not available. See ISO/IEC 8802-5.

[Learn More
About 802.5p-1993](https://standards.ieee.org/ieee/802.5p/1120 "Learn More")

**These standards are removed from active status through an
administrative process for standards that have not undergone a revision
process within 10 years.**

---

No Inactive-Reserved Standards

[![IEEE logo](data:image/gif;base64...)](https://www.ieee.org/ "Visit IEEE.org")

* [LinkedIn](https://www.linkedin.com/company/ieee-sa-ieee-standards-association/ "LinkedIn")
* [Facebook](https://www.facebook.com/ieeesa/ "Facebook")
* [Instagram](https://www.instagram.com/ieeesa/ "Instagram")
* [YouTube](https://www.youtube.com/ieeesa "YouTube")
* [X](https://twitter.com/ieeesa "X")
* [Beyond Standards RSS Feed](/category/beyond-standards/feed/ "Beyond Standards RSS Feed")

IEEE SA

* [About Us](https://standards.ieee.org/about/)
* [IEEE SA Membership](https://standards.ieee.org/about/membership/)
* [Distributor Partner Program](https://standards.ieee.org/about/distrib/)
* [Training & Development](https://standards.ieee.org/about/training/)
* [Policies & Procedures](https://standards.ieee.org/about/policies/)
* [Contact Us](https://standards.ieee.org/about/contact/)
* [Provide Feedback](https://standards.ieee.org/about/feedback/)

Board of Governors

* [About Board of Governors](https://standards.ieee.org/about/bog/)
* [Awards Committee](https://standards.ieee.org/about/bog/arcom/)
* [Entity Collaborative Activities Governance Board](https://standards.ieee.org/about/bog/cag/)
* [Industry Connections Committee](https://standards.ieee.org/about/bog/iccom/)
* [Registration Authority Committee (RAC)](https://standards.ieee.org/about/bog/rac/)

Standards Board

* [About Standards Board](https://standards.ieee.org/about/sasb/)
* [Board Approvals](https://standards.ieee.org/about/sasb/sba/)
* [Audit Committee](https://standards.ieee.org/about/sasb/audcom/)
* [New Standards Committee](https://standards.ieee.org/about/sasb/nescom/)
* [Patent Committee](https://standards.ieee.org/about/sasb/patcom/)
* [Procedures Committee](https://standards.ieee.org/about/sasb/procom/)
* [Standards Review Committee](https://standards.ieee.org/about/sasb/revcom/)

News & Events

* [News](https://standards.ieee.org/news/)
* [IEEE SA Newsletter](https://standards.ieee.org/news/swire/)
* [Events](https://standards.ieee.org/events/)
* [Beyond Standards Blog](https://standards.ieee.org/beyond-standards/)

* [Home](/ "Home")
* [Sitemap](/sitemap/ "Sitemap")
* [Contact & Support](https://www.ieee.org/about/contact.html "Contact & Support")
* [Accessibility](https://www.ieee.org/accessibility-statement.html "Accessibility")
* [Nondiscrimination Policy](https://www.ieee.org/about/corporate/governance/p9-26.html "Nondiscrimination Policy")
* [IEEE Ethics Reporting](https://secure.ethicspoint.com/domain/media/en/gui/20410/index.html "IEEE Ethics Reporting")
* [IEEE Privacy Policy](https://www.ieee.org/security-privacy.html "IEEE Privacy Policy")
* [Terms & Disclosures](https://www.ieee.org/about/help/site-terms-conditions.html "Terms & Disclosures")
* [IEEE SA Copyright Policy](/ipr/ "IEEE SA Copyright Policy")

© Copyright 2021 IEEE – All rights reserved. A public charity, IEEE is the world's largest technical professional organization dedicated to advancing technology for the benefit of humanity.

Subscribe
##### Subscribe to our Newsletter

Sign up for our monthly newsletter to learn about new developments, including resources, insights and more.

**Thank you for signing up for the IEEE SA Newsletter. Check your email for a confirmation message.**



=== Content from datatracker.ietf.org_5d26f28b_20250115_180554.html ===


* Light
* Dark
* Auto

[RFC 6105

Informational](/doc/rfc6105/)

|  | Title |  | IPv6 Router Advertisement Guard |
| --- | --- | --- | --- |
| Document | Document type |  | RFC - Informational  February 2011  [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Updated by [RFC 7113](/doc/html/rfc7113 "Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)") Was [draft-ietf-v6ops-ra-guard](/doc/draft-ietf-v6ops-ra-guard/08/) ([v6ops WG](/wg/v6ops/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [08](/doc/html/draft-ietf-v6ops-ra-guard-08) * [RFC 6105](/doc/html/rfc6105) |
|  | Compare versions |  | RFC 6105  draft-ietf-v6ops-ra-guard-08  draft-ietf-v6ops-ra-guard-07  draft-ietf-v6ops-ra-guard-06  draft-ietf-v6ops-ra-guard-05  draft-ietf-v6ops-ra-guard-04  draft-ietf-v6ops-ra-guard-03  draft-ietf-v6ops-ra-guard-02  draft-ietf-v6ops-ra-guard-01  draft-ietf-v6ops-ra-guard-00   RFC 6105  draft-ietf-v6ops-ra-guard-08  draft-ietf-v6ops-ra-guard-07  draft-ietf-v6ops-ra-guard-06  draft-ietf-v6ops-ra-guard-05  draft-ietf-v6ops-ra-guard-04  draft-ietf-v6ops-ra-guard-03  draft-ietf-v6ops-ra-guard-02  draft-ietf-v6ops-ra-guard-01  draft-ietf-v6ops-ra-guard-00   Side-by-side  Inline |
|  | Authors |  | [Gunter Van de Velde](/person/gunter%40vandevelde.cc "Datatracker profile of Gunter Van de Velde") , [János Mohácsi](/person/mohacsi%40niif.hu "Datatracker profile of János Mohácsi") , [Eric Levy-Abegnoli](/person/elevyabe%40gmail.com "Datatracker profile of Eric Levy-Abegnoli") , [Chip Popoviciu](/person/cpopovic%40cisco.com "Datatracker profile of Chip Popoviciu")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc6105.txt) [html](https://www.rfc-editor.org/rfc/rfc6105.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc6105.txt.pdf) [bibtex](/doc/rfc6105/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/v6ops/?q=rfc6105 OR %22draft-ietf-v6ops-ra-guard%22) |
|  |  |  | [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose) |

```
Internet Engineering Task Force (IETF)                  E. Levy-Abegnoli
Request for Comments: 6105                               G. Van de Velde
Category: Informational                                    Cisco Systems
ISSN: 2070-1721                                             C. Popoviciu
                                                              Technodyne
                                                              J. Mohacsi
                                                          NIIF/Hungarnet
                                                           February 2011

                    IPv6 Router Advertisement Guard

Abstract

   Routed protocols are often susceptible to spoof attacks.  The
   canonical solution for IPv6 is Secure Neighbor Discovery (SEND), a
   solution that is non-trivial to deploy.  This document proposes a
   light-weight alternative and complement to SEND based on filtering in
   the layer-2 network fabric, using a variety of filtering criteria,
   including, for example, SEND status.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see [Section 2 of RFC 5741](/doc/html/rfc5741#section-2).

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <http://www.rfc-editor.org/info/rfc6105>.

Levy-Abegnoli, et al.         Informational                     [Page 1]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to [BCP 78](/doc/html/bcp78) and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<http://trustee.ietf.org/license-info>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   [1](#section-1). Introduction ....................................................[3](#page-3)
   [2](#section-2). Model and Applicability .........................................[3](#page-3)
   [3](#section-3). Stateless RA-Guard ..............................................[5](#page-5)
   [4](#section-4). Stateful RA-Guard ...............................................[6](#page-6)
      [4.1](#section-4.1). State Machine ..............................................[6](#page-6)
      [4.2](#section-4.2). SEND-Based RA-Guard ........................................[8](#page-8)
   [5](#section-5). RA-Guard Use Considerations .....................................[8](#page-8)
   [6](#section-6). Security Considerations .........................................[9](#page-9)
   [7](#section-7). Acknowledgements ................................................[9](#page-9)
   [8](#section-8). References ......................................................[9](#page-9)
      [8.1](#section-8.1). Normative References .......................................[9](#page-9)
      [8.2](#section-8.2). Informative References .....................................[9](#page-9)

Levy-Abegnoli, et al.         Informational                     [Page 2]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

[1](#section-1).  Introduction

   When operating IPv6 in a shared layer-2 (L2) network segment without
   complete SEcure Neighbor Discovery (SEND) support by all devices
   connected or without the availability of the infrastructure necessary
   to support SEND [[RFC3971](/doc/html/rfc3971 "\"SEcure Neighbor Discovery (SEND)\"")], there is always the risk of facing
   operational problems due to rogue Router Advertisements (RAs)
   generated maliciously or unintentionally by unauthorized or
   improperly configured routers connecting to the segment.

   There are several examples of work done on this topic that resulted
   in related studies and code, including [[NDPMON](#ref-NDPMON "\"NDPMon - IPv6 Neighbor Discovery Protocol Monitor\"")] [[KAME](#ref-KAME "\"rafixd - developed at KAME - An active rogue RA nullifier\"")]
   [[IPv6-SAMURAIS](#ref-IPv6-SAMURAIS)].  This document describes a solution framework for
   the rogue-RA problem [[RFC6104](/doc/html/rfc6104 "\"Rogue IPv6 Router Advertisement Problem Statement\"")] where network segments are designed
   around a single L2-switching device or a set of L2-switching devices
   capable of identifying invalid RAs and blocking them.  The solutions
   developed within this framework can span the spectrum from basic
   (where the port of the L2 device is statically instructed to forward
   or not to forward RAs received from the connected device) to advanced
   (where a criterion is used by the L2 device to dynamically validate
   or invalidate a received RA, this criterion can even be based on SEND
   mechanisms).

[2](#section-2).  Model and Applicability

   RA-Guard applies to an environment where all messages between IPv6
   end-devices traverse the controlled L2 networking devices.  It does
   not apply to shared media, when devices can communicate directly
   without going through an RA-Guard-capable L2 networking device.

   Figure 1 illustrates a deployment scenario for RA-Guard.

Levy-Abegnoli, et al.         Informational                     [Page 3]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

                      Block                Allow
       +------+       incoming +---------+ incoming     +--------+
       |Host  |       RA       |    L2   | RA           | Router |
       |      |----------------|  device |--------------|        |
       +------+                +----+----+              +--------+
                                    |
                                    |Block
                                    |incoming
                                    |RA
                                    |
                                    |
                                    |
                                +---+---+
                                |  Host |
                                |       |
                                +-------+

                                Figure 1

   RA-Guard does not intend to provide a substitute for SEND-based
   solutions.  It actually intends to provide complementary solutions in
   those environments where SEND might not be suitable or fully
   supported by all devices involved.  It may take time until SEND is
   ubiquitous in IPv6 networks and some of its large-scale deployment
   aspects are sorted out, such as provisioning hosts with trust
   anchors.  It is also reasonable to expect that some devices, such as
   IPv6-enabled sensors, might not consider implementing SEND at all.
   An RA-Guard implementation that SEND-validates RAs on behalf of hosts
   would potentially simplify some of these challenges.

   RA-Guard can be seen as a superset of SEND with regard to router
   authorization.  Its purpose is to filter Router Advertisements based
   on a set of criteria, from a simplistic "RA disallowed on a given
   interface" to "RA allowed from pre-defined sources" and up to a full-
   fledged SEND "RA allowed from authorized sources only".

   In addition to this granularity on the criteria for filtering out
   Router Advertisements, RA-Guard introduces the concept of router
   authorization proxy.  Instead of each node on the link analyzing RAs
   and making an individual decision, a legitimate "node-in-the-middle"
   performs the analysis on behalf of all other nodes on the link.  The
   analysis itself is not different from what each node would do: if
   SEND is enabled, the RA is checked against X.509 certificates

Levy-Abegnoli, et al.         Informational                     [Page 4]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

   [[RFC4861](/doc/html/rfc4861 "\"Neighbor Discovery for IP version 6 (IPv6)\"")].  If any other criterion is in use, such as known L3
   (addresses) or L2 (link-layer address, port number) legitimate
   sources of RAs, the node-in-the middle can use this criterion and
   filter out any RA that does not comply.  If this node-in-the-middle
   is an L2 device, it will not change the content of the validated RA
   and will avoid any of the ND-proxy pitfalls.

   RA-Guard intends to provide simple solutions to the rogue-RA problem
   in contexts where simplicity is required while leveraging SEND in a
   context environment consisting of a mix of SEND-capable devices (L2
   switches and routers) and devices that do not consistently use SEND.
   Furthermore, RA-Guard is useful to simplify SEND deployments, as only
   the L2 switch and the routers are required to carry certificates
   (their own and the trust anchor certificates).

[3](#section-3).  Stateless RA-Guard

   Stateless RA-Guard examines incoming RAs and decides whether to
   forward or block them based solely on information found in the
   message or in the L2-device configuration.  Typical information
   available in the frames received, useful for RA validation, is as
   follows:

   o  Link-layer address of the sender

   o  Port on which the frame was received

   o  IP source address

   o  Prefix list

   The following configuration information created on the L2 device can
   be made available to RA-Guard, to validate against the information
   found in the received RA frame:

   o  Allowed/Disallowed link-layer address of the RA sender

   o  Allowed/Disallowed ports for receiving RAs

   o  Allowed/Disallowed IP source addresses of the RA sender

   o  Allowed Prefix list and Prefix ranges

   o  Router Priority

   Once the L2 device has validated the content of the RA frame against
   the configuration, it forwards the RA to its destination, whether
   unicast or multicast.  Otherwise, the RA is dropped.

Levy-Abegnoli, et al.         Informational                     [Page 5]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

   An example of a very simple stateless RA-Guard implementation could
   be a small L2 switch for which there is one interface "statically
   configured" as the interface connecting to a router, while all other
   interfaces are for non-router devices.  With this small static setup,
   the only interface forwarding RAs will be the pre-assigned router
   interface, while the non-router interfaces block all RAs.

[4](#section-4).  Stateful RA-Guard

[4.1](#section-4.1).  State Machine

   Stateful RA-Guard learns dynamically about legitimate RA senders and
   stores this information for allowing subsequent RAs.  A simple
   stateful scheme would be for the L2 device to listen to RAs during a
   certain manually configured period of time, where the start of the
   listening period and the duration of the listening period for a
   single instance are controlled by the manual intervention.  As a
   result, the L2 device can then allow subsequent RAs only on those
   ports on which valid RAs were received during this period.  Often,
   the "LEARNING" state will only be activated by manual configuration
   when a new IPv6 router is provisioned on the L2 network.

   A more sophisticated stateful scheme is based on SEND and is
   described in [Section 4.2](#section-4.2).

   The state machine for stateful RA-Guard can be global, per-interface,
   or per-peer, depending on the scheme used for authorizing RAs.

   When RA-Guard is SEND-based, the state machine is per-peer and
   defined in [[RFC3971](/doc/html/rfc3971 "\"SEcure Neighbor Discovery (SEND)\"")].

   When RA-Guard is using a discovery method, the state machine of the
   RA-Guard capability consists of four different states:

   o  State 1: OFF

      A device or interface in the RA-Guard "OFF" state operates as if
      the RA-Guard capability is not available.

   o  State 2: LEARNING

      A device or interface in the RA-Guard "LEARNING" state is actively
      acquiring information about the IPv6 routing devices connected to
      its interfaces.  The learning process takes place over a
      pre-defined unique period of time, as set by manual configuration;

Levy-Abegnoli, et al.         Informational                     [Page 6]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

      or it can be event-triggered.  The information gathered is
      compared against pre-defined criteria (criteria similar to the
      stateless RA-Guard rules) to qualify the validity of the RAs.

      In this state, the RA-Guard-enabled device or interface is either
      blocking "all" RAs until their validity is verified or,
      alternatively, it can temporarily forward "all" of the RAs until
      their validity is verified.

      When the L2 device reaches the end of the LEARNING state, it has a
      record of which interfaces are attached to links with valid IPv6
      routers.  The L2 device transitions each interface from the
      LEARNING state into either the BLOCKING state if there was no
      valid IPv6 router discovered at the interface, or into the
      FORWARDING state if there was a valid IPv6 router discovered.

   o  State 3: BLOCKING

      A device or interface running RA-Guard and in the BLOCKING state
      will block ingress RA messages.

      An interface can transition from the BLOCKING state into the
      FORWARDING state directly if explicitly instructed by the
      L2-device operator.

      An interface can transition from the BLOCKING state into the
      LEARNING state if either explicitly instructed by the L2-device
      operator or prompted by a triggered event.

   o  State 4: FORWARDING

      A device or interface running RA-Guard and in the FORWARDING state
      will accept valid ingress RAs and forward them to their
      destination.

      An interface can transition from the FORWARDING state into the
      BLOCKING state directly if explicitly instructed by the L2-device
      operator.

      An interface can transition from the FORWARDING state into the
      LEARNING state if either explicitly instructed by the L2-device
      operator or prompted by a triggered event.

   The transition between these states can be triggered by manual
   configuration or by meeting a pre-defined criterion.

Levy-Abegnoli, et al.         Informational                     [Page 7]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

[4.2](#section-4.2).  SEND-Based RA-Guard

   In this scenario, the L2 device is blocking or forwarding RAs based
   on SEND considerations.  Upon capturing an RA on the interface, the
   L2 device will first verify the Cryptographically Generated Address
   (CGA) [[RFC3971](/doc/html/rfc3971 "\"SEcure Neighbor Discovery (SEND)\"")] and the RSA (Rivest, Shamir, and Adleman algorithm
   for public-key cryptography) signature, as specified in [Section 5 of
   [RFC3971]](/doc/html/rfc3971#section-5).  The RA should be dropped in case of failure of this
   verification.  It will then apply host behavior as described in
   [Section 6.4.6 of [RFC3971]](/doc/html/rfc3971#section-6.4.6).  In particular, the L2 device will
   attempt to retrieve a valid certificate from its cache for the public
   key referred to in the RA.  If such a certificate is found, the L2
   device will forward the RA to its destination.  If not, the L2 device
   will generate a Certification Path Solicitation (CPS) [[RFC3971](/doc/html/rfc3971 "\"SEcure Neighbor Discovery (SEND)\"")] with
   an unspecified source address, to query the router certificate(s).
   It will then capture the Certification Path Advertisement (CPA)
   [[RFC3971](/doc/html/rfc3971 "\"SEcure Neighbor Discovery (SEND)\"")] and attempt to validate the certificate chain.  Failure to
   validate the chain will result in dropping the RA.  Upon validation
   success, the L2 device will forward the RA to its destination and
   store the router certificate in its cache.

   In order to operate in this scenario, the L2 device should be
   provisioned with a trust anchor certificate, as specified in
   [Section 6 of [RFC3971]](/doc/html/rfc3971#section-6).  It may also establish layer-3 connectivity
   with a Certificate Revocation List (CRL) Certification Path
   Advertisement server and/or with an NTP server.  A bootstrapping
   issue in this case can be resolved by using the configuration method
   to specify a trusted port to a first router, and the SEND-based
   RA-Guard method on all other ports.  The first router can then be
   used for Network Time Protocol (NTP) [[RFC5905](/doc/html/rfc5905 "\"Network Time Protocol Version 4: Protocol and Algorithms Specification\"")] and CRL connectivity.

[5](#section-5).  RA-Guard Use Considerations

   The RA-Guard mechanism is effective only when all messages between
   IPv6 devices in the target environment traverse controlled L2
   networking devices.  In the case of environments such as Ethernet
   hubs, devices can communicate directly without going through an
   RA-Guard-capable L2 networking device, and the RA-Guard feature
   cannot protect against rogue RAs.

   RA-Guard mechanisms do not offer protection in environments where
   IPv6 traffic is tunneled.

Levy-Abegnoli, et al.         Informational                     [Page 8]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

[6](#section-6).  Security Considerations

   Once RA-Guard has set up the proper criteria (for example, it
   specified that a port is allowed to receive RAs, or it identified
   legitimate sources of RAs or certificate bases [[RFC4861](/doc/html/rfc4861 "\"Neighbor Discovery for IP version 6 (IPv6)\"")]), then there
   are no possible instances of accidentally filtered legitimate Router
   Advertisements, assuming the RA-Guard filter enforcement strictly
   follows the RA-Guard set criteria.

   In [Section 4.1](#section-4.1), a simple mechanism to dynamically learn the valid
   IPv6 routers connected to an L2 device is explained.  It is important
   that this LEARNING state is only entered intentionally by manual
   configuration.  The list of learned IPv6 routers should be verified
   by the network manager to make sure that it corresponds with the
   expected valid RA list.  This procedure will make sure that either
   accidentally or intentionally generated rogue RAs are blocked by
   RA-Guard.

[7](#section-7).  Acknowledgements

   The authors dedicate this document to the memory of Jun-ichiro Hagino
   (itojun) for his contributions to the development and deployment of
   IPv6.

[8](#section-8).  References

[8.1](#section-8.1).  Normative References

   [RFC3971]   Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,
               "SEcure Neighbor Discovery (SEND)", [RFC 3971](/doc/html/rfc3971), March 2005.

   [RFC4861]   Narten, T., Nordmark, E., Simpson, W., and H.  Soliman,
               "Neighbor Discovery for IP version 6 (IPv6)", [RFC 4861](/doc/html/rfc4861),
               September 2007.

   [RFC5905]   Mills, D., Martin, J., Ed., Burbank, J., and W. Kasch,
               "Network Time Protocol Version 4: Protocol and Algorithms
               Specification", [RFC 5905](/doc/html/rfc5905), June 2010.

[8.2](#section-8.2).  Informative References

   [NDPMON]    LORIA/INRIA, "NDPMon - IPv6 Neighbor Discovery Protocol
               Monitor", November 2007,
               <<http://ndpmon.sourceforge.net/>>.

   [KAME]      KAME Project, "rafixd - developed at KAME - An active
               rogue RA nullifier", November 2007,
               <<http://www.kame.net/>>.

Levy-Abegnoli, et al.         Informational                     [Page 9]
```

---

```

[RFC 6105](/doc/html/rfc6105)                      IPv6 RA-Guard                February 2011

   [IPv6-SAMURAIS]
               Hagino (itojun), J., "IPv6 demystified: I have a problem
               with rogue RAs in my IPv6 network", 2007,
               <<http://ipv6samurais.com/>>.

   [RFC6104]   Chown, T. and S. Venaas, "Rogue IPv6 Router Advertisement
               Problem Statement", [RFC 6104](/doc/html/rfc6104), February 2011.

Authors' Addresses

   Eric Levy-Abegnoli
   Cisco Systems
   Village d'Entreprises Green Side - 400, Avenue Roumanille
   Biot - Sophia Antipolis, PROVENCE-ALPES-COTE D'AZUR  06410
   France

   Phone: +33 49 723 2620
   EMail: elevyabe@cisco.com

   Gunter Van de Velde
   Cisco Systems
   De Kleetlaan 6a
   Diegem  1831
   Belgium

   Phone: +32 2704 5473
   EMail: gunter@cisco.com

   Ciprian Popoviciu
   Technodyne
   111 Wood Ave. S.
   Iselin, NJ  08830
   USA

   Phone: +1 1 919 599-5666
   EMail: chip@technodyne.com

   Janos Mohacsi
   NIIF/Hungarnet
   18-22 Victor Hugo
   Budapest  H-1132
   Hungary

   EMail: mohacsi@niif.hu

Levy-Abegnoli, et al.         Informational                    [Page 10]

```

[Datatracker](/doc/rfc6105/)

RFC 6105

RFC
- Informational

* Info
* Contents
* Prefs

| Document | Document type |  | RFC - Informational  February 2011  [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Updated by [RFC 7113](/doc/html/rfc7113 "Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)") Was [draft-ietf-v6ops-ra-guard](/doc/draft-ietf-v6ops-ra-guard/08/) ([v6ops WG](/wg/v6ops/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [08](/doc/html/draft-ietf-v6ops-ra-guard-08) * [RFC 6105](/doc/html/rfc6105) |
|  | Compare versions |  | RFC 6105  draft-ietf-v6ops-ra-guard-08  draft-ietf-v6ops-ra-guard-07  draft-ietf-v6ops-ra-guard-06  draft-ietf-v6ops-ra-guard-05  draft-ietf-v6ops-ra-guard-04  draft-ietf-v6ops-ra-guard-03  draft-ietf-v6ops-ra-guard-02  draft-ietf-v6ops-ra-guard-01  draft-ietf-v6ops-ra-guard-00   RFC 6105  draft-ietf-v6ops-ra-guard-08  draft-ietf-v6ops-ra-guard-07  draft-ietf-v6ops-ra-guard-06  draft-ietf-v6ops-ra-guard-05  draft-ietf-v6ops-ra-guard-04  draft-ietf-v6ops-ra-guard-03  draft-ietf-v6ops-ra-guard-02  draft-ietf-v6ops-ra-guard-01  draft-ietf-v6ops-ra-guard-00   Side-by-side  Inline |
|  | Authors |  | [Gunter Van de Velde](/person/gunter%40vandevelde.cc "Datatracker profile of Gunter Van de Velde") , [János Mohácsi](/person/mohacsi%40niif.hu "Datatracker profile of János Mohácsi") , [Eric Levy-Abegnoli](/person/elevyabe%40gmail.com "Datatracker profile of Eric Levy-Abegnoli") , [Chip Popoviciu](/person/cpopovic%40cisco.com "Datatracker profile of Chip Popoviciu")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc6105.txt) [html](https://www.rfc-editor.org/rfc/rfc6105.html) [pdf](https://www.rfc-editor.org/rfc/pdfrfc/rfc6105.txt.pdf) [bibtex](/doc/rfc6105/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/v6ops/?q=rfc6105 OR %22draft-ietf-v6ops-ra-guard%22) |

[Report a datatracker bug](https://github.com/ietf-tools/datatracker/issues/new/choose)

Show sidebar by default

Yes

No

Tab to show by default

Info

Contents

HTMLization configuration

HTMLize the plaintext

Plaintextify the HTML

Maximum font size

Page dependencies

Inline

Reference

Citation links

 Go to reference section

Go to linked document

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from sec.cloudapps.cisco.com_c44a654d_20250115_115959.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.1 |
| Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Select Attack Vector Parameters  Attack Complexity AC: Low AC: High  Select Attack Complexity Parameters  Privileges Required PR: None PR: Low PR: High  Select Privileges Required Parameters  User Interaction UI: Required UI: None  Select User Interaction Parameters  Scope S: Unchanged S: Changed  Select Scope Parameters  Confidentiality Impact C: Low C: High C: None  Select Confidentiality Impact Parameters  Integrity Impact I: None I: Low I: High  Select Integrity Impact Parameters  Availability Impact A: Low A: High A: None  Select Availability Impact Parameters    Base Score: 4.7 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Functional  E: High  E: Not Defined  E: Proof-of-Concept  E: Unproven   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Not Defined  RC: Confirmed   Select Report Confidence Parameters     Temporal Score: 4.7 |
| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: High  CR: Not Defined   Select Confidentiality Requirement Parameters  Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Select Integrity Requirement Parameters  Availability Requirement AR: Low  AR: Medium  AR: High  AR: Not Defined   Select Availability Requirement Parameters  Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Select Modified Attack Vector Parameters  Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Select Modified Attack Complexity Parameters  Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Select Modified Privileges Required Parameters  Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Select Modified User Interaction Parameters  Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Select Modified Scope Parameters  Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Select Modified Confidentiality Parameters  Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Select Modified Integrity Parameters  Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined   Select Modified Availability Parameters    Environmental Score: 4.7 |
| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from kb.cert.org_576a1751_20250115_180549.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#855201

## L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers

#### Vulnerability Note VU#855201

Original Release Date: 2022-09-27 | Last Revised: 2023-06-14

---

### Overview

Layer-2 (L2) network security controls provided by various devices, such as switches, routers, and operating systems, can be bypassed by stacking Ethernet protocol headers. An attacker can send crafted packets through vulnerable devices to cause Denial-of-service (DoS) or to perform a man-in-the-middle (MitM) attack against a target network.

### Description

This vulnerability exists within Ethernet encapsulation protocols that allow for stacking of Virtual Local Area Network (VLAN) headers. Network standards such as [IEEE 802.1Q-1998](https://standards.ieee.org/standard/802_1Q-1998.html) and [IEEE 802.3](https://standards.ieee.org/standard/802_3-2018.html) define a system of tagging Ethernet frames that help isolate networks to provide virtual networking capability. IEEE standard [802.1ad](https://standards.ieee.org/standard/802_1ad-2005.html), also known as QinQ, allows for the stacking of these VLAN tags, extending the VLAN capability into multiple network segments. This widely adopted Ethernet feature is also referred to as "provider bridging" and "stacked VLANs". In order to properly isolate and protect these virtual networks, many network devices and operating systems provide an L2 network filtering capability. It is important to note that in modern computing environments , such as Cloud based virtualization and virtual networking, the L2 network capability is extended beyond the local area networks. This can lead to exposure of this vulnerabilities in unintended ways to the larger Internet.

The identified vulnerabilities allow an attacker to bypass the security controls by stacking encapsulating headers. This is done by stacking a combination of one or more VLAN 0 (priority tag) headers and [802.2](https://standards.ieee.org/standard/802_2-1985.html) LLC/SNAP headers. An attacker can send these crafted network packets and exploit vulnerable devices by bypassing their inspection and filtering capabilities. Some examples of bypassed L2 inspections include, but are not limited to, [Dynamic ARP inspection](https://blogs.nwkings.com/what-is-dai-dynamic-arp-inspection/), [IPv6 Neighbor Discovery](https://datatracker.ietf.org/doc/rfc4861/) (ND) protection, and [IPv6 RA Guard](https://datatracker.ietf.org/doc/html/rfc6105).

**CVE-2021-27853**
Layer 2 network filtering capabilities such as IPv6 RA guard or ARP inspection can be bypassed using combinations of VLAN 0 headers and LLC/SNAP headers.

**CVE-2021-27854**
Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using combinations of VLAN 0 headers, LLC/SNAP headers in Ethernet to Wifi frame translation and the reverse Wifi to Ethernet.

**CVE-2021-27861**
Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length (and optionally VLAN0 headers).

**CVE-2021-27862**
Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length and Ethernet to Wifi frame conversion (and optionally VLAN0 headers).

### Impact

An attacker can bypass security controls and deceive a locally connected target host to route traffic to arbitrary destinations. Victim devices experience either a DoS (blackholing traffic) or MitM (observing the unencrypted traffic and maybe breaking encryption).

### Solution

#### Apply Updates

Install vendor-provided patches and updates to ensure malicious content is blocked or rejected by the security controls (such as RA Guard), thereby blocking router advertisements or other network configuration related advertisements that originate on host ports.

#### Inspect and Block Router Advertisements

Utilize the interface security controls on your router or managed switch to perform DHCP snooping, IPv6 RA guard, IP source guard, and ARP/ND inspection. It is also recommended to only allow needed protocol on access ports (ARP/ICMP/IPv4/IPv6), some applications may have additional needs so be prepared to modify the allow list as needed.

### Acknowledgements

Thanks to Etienne Champetier for reporting this vulnerability.

This document was written by Timur Snoke.

### Vendor Information

855201
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Arista Networks](#Arista%20Networks) Affected

Notified:  2021-08-23
Updated: 2022-09-28

**Statement Date:   September 27, 2022**

| **CVE-2021-27853** | Affected |
| --- | --- |
| **CVE-2021-27854** | Affected |
| **CVE-2021-27861** | Affected |
| **CVE-2021-27862** | Affected |

#### Vendor Statement

Arista Networks has products affected by these issues. Complete details, including how to fix the issue, can be found at: https://www.arista.com/en/support/advisories-notices/security-advisory/16276-security-advisory-0080

### [Cisco](#Cisco) Affected

Notified:  2021-02-02
Updated: 2022-09-28

**Statement Date:   September 01, 2022**

| **CVE-2021-27853** | Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| Cisco will provide an advisory and update on affected products via a Cisco Security Advisory. | |
| **CVE-2021-27861** | Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

Cisco will publish an advisory regarding affected products and versions once the embargo is lifted. PSIRT-0213940748

### [Juniper Networks](#Juniper%20Networks) Affected

Notified:  2021-02-02
Updated: 2022-11-07

**Statement Date:   November 07, 2022**

| **CVE-2021-27853** | Affected |
| --- | --- |
| **Vendor Statement:** | |
| For devices using IPv6 RA Guard or devices using DHCP security services please upgrade to these releases if there is a concern: Junos OS 21.2R3-S3, 21.3R3-S1, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R2, 22.1R3, 22.2R2, 22.3R1, 22.4R1, or subsequent releases. There are no workarounds. | |
| **CVE-2021-27854** | Affected |
| **Vendor Statement:** | |
| For devices using IPv6 RA Guard or devices using DHCP security services please upgrade to these releases if there is a concern: Junos OS 21.2R3-S3, 21.3R3-S1, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R2, 22.1R3, 22.2R2, 22.3R1, 22.4R1, or subsequent releases. There are no workarounds. | |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

For devices using IPv6 RA Guard or devices using DHCP security services please upgrade to these releases if there is a concern: Junos OS 21.2R3-S3, 21.3R3-S1, 21.4R2-S2, 21.4R3, 22.1R1-S2, 22.1R2, 22.1R3, 22.2R2, 22.3R1, 22.4R1, or subsequent releases. There are no workarounds.

### [Actiontec](#Actiontec) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   August 30, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Advantech Czech](#Advantech%20Czech) Not Affected

Notified:  2021-08-31
Updated: 2022-09-27

**Statement Date:   September 07, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

Advantech ICR-xxxx products don't provide bridge VLAN firewalling.

### [Android Open Source Project](#Android%20Open%20Source%20Project) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 19, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

After review it has been determined that the Android OS has no security impact from these vulnerabilities.

### [Aruba Networks](#Aruba%20Networks) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 07, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [AVM GmbH](#AVM%20GmbH) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 23, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **Vendor Statement:** | |
| AVM products do not offer layer 2 security features and therefore those cannot be bypassed either. | |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| AVM products do not offer layer 2 security features and therefore those cannot be bypassed either. | |
| **CVE-2021-27861** | Not Affected |
| **Vendor Statement:** | |
| AVM products do not offer layer 2 security features and therefore those cannot be bypassed either. | |
| **CVE-2021-27862** | Not Affected |
| **Vendor Statement:** | |
| AVM products do not offer layer 2 security features and therefore those cannot be bypassed either. | |

### [Barracuda Networks](#Barracuda%20Networks) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 24, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Brocade Communication Systems](#Brocade%20Communication%20Systems) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   November 10, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **Vendor Statement:** | |
| No Brocade Fibre Channel Products from Broadcom products are currently known to be affected by this vulnerability. | |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| No Brocade Fibre Channel Products from Broadcom products are currently known to be affected by this vulnerability. | |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

No Brocade Fibre Channel Products from Broadcom products are currently known to be affected by this vulnerability.

### [Check Point](#Check%20Point) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   October 12, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Cradlepoint](#Cradlepoint) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 20, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Dell](#Dell) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 21, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Dell SecureWorks](#Dell%20SecureWorks) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   August 25, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Deutsche Telekom](#Deutsche%20Telekom) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 07, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have no Switches produced by any vendors for us

### [Digi International](#Digi%20International) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 23, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

we believe we are not susceptible to this attack due to design differences within our products.

### [D-Link Systems Inc.](#D-Link%20Systems%20Inc.) Not Affected

Notified:  2021-08-23
Updated: 2023-01-03

**Statement Date:   December 27, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **Vendor Statement:** | |
| D-Link is aware of the vulnerability and is investigating. | |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| D-Link is aware of the vulnerability and is investigating. | |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

### [eCosCentric](#eCosCentric) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 07, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **Vendor Statement:** | |
| Do not support VLAN capability in supported stack | |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| Do not support VLAN capability in supported stack | |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

### [Fastly](#Fastly) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 17, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [HCC Embedded](#HCC%20Embedded) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   December 15, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [HP Inc.](#HP%20Inc.) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 23, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

The teams at HP Inc. has confirmed that none of our products are affected by these issues.

### [Intel](#Intel) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 01, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [lwIP](#lwIP) Not Affected

Notified:  2021-08-23
Updated: 2022-09-28

**Statement Date:   September 28, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [McAfee](#McAfee) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 22, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [MikroTik](#MikroTik) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   January 24, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

MikroTik devices do no support IPv6 RA guard and are not affected.

### [Miredo](#Miredo) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 19, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Muonics Inc.](#Muonics%20Inc.) Not Affected

Notified:  2021-08-23
Updated: 2022-09-29

**Statement Date:   September 28, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

This vulnerability is not applicable to any Muonics, Inc. products that exist at this time.

### [netsnmp](#netsnmp) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   August 24, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NVIDIA](#NVIDIA) Not Affected

Notified:  2022-01-21
Updated: 2022-09-27

**Statement Date:   September 12, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenWRT](#OpenWRT) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   August 23, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

OpenWrt does not support Layer 2 security features like RA Guard and is not affected by this problem.

### [Paessler](#Paessler) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   April 22, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Palo Alto Networks](#Palo%20Alto%20Networks) Not Affected

Notified:  2021-08-23
Updated: 2023-06-14

**Statement Date:   May 25, 2023**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Peplink](#Peplink) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   June 07, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [QNAP](#QNAP) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   August 30, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Red Hat](#Red%20Hat) Not Affected

Notified:  2021-02-05
Updated: 2022-09-27

**Statement Date:   August 25, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **Vendor Statement:** | |
| There is no vulnerability in the Linux kernel itself, there is a lot of way to misuse the filtering facilities provided by the kernel and do insecure filtering rules, but you also have everything to do actual secure rules. | |
| **CVE-2021-27854** | Not Affected |
| **Vendor Statement:** | |
| There is no vulnerability in the Linux kernel itself, there is a lot of way to misuse the filtering facilities provided by the kernel and do insecure filtering rules, but you also have everything to do actual secure rules. | |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

### [Sierra Wireless](#Sierra%20Wireless) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   October 12, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Sophos](#Sophos) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   October 07, 2021**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Synology](#Synology) Not Affected

Notified:  2021-08-23
Updated: 2022-10-03

**Statement Date:   October 03, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

None of Synology's products are affected by CVE-2021-27853, CVE-2021-27854, CVE-2021-27861, and CVE-2021-27862 as these vulnerabilities only affect when Layer 2 security features like RA Guard is implemented.

### [Treck](#Treck) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   June 22, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Untangle](#Untangle) Not Affected

Notified:  2021-08-23
Updated: 2022-10-25

**Statement Date:   October 24, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Wind River](#Wind%20River) Not Affected

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   September 27, 2022**

| **CVE-2021-27853** | Not Affected |
| --- | --- |
| **CVE-2021-27854** | Not Affected |
| **CVE-2021-27861** | Not Affected |
| **CVE-2021-27862** | Not Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ceragon Networks Inc](#Ceragon%20Networks%20Inc) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

**Statement Date:   October 17, 2021**

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Microsoft](#Microsoft) Unknown

Notified:  2021-02-11
Updated: 2022-09-27

**Statement Date:   April 13, 2021**

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **Vendor Statement:** | |
| This was addressed as part of the April Patch Tuesday release. | |
| **References:**   * <https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-28444> | |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

### [A10 Networks](#A10%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ACCESS](#ACCESS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Actelis Networks](#Actelis%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ADATA](#ADATA) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ADTRAN](#ADTRAN) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Advantech B-B Technology](#Advantech%20B-B%20Technology) Unknown

Notified:  2021-08-31
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Advantech Taiwan](#Advantech%20Taiwan) Unknown

Notified:  2021-08-31
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Aerohive](#Aerohive) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [AhnLab Inc](#AhnLab%20Inc) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [AirWatch](#AirWatch) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Akamai Technologies Inc.](#Akamai%20Technologies%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Alcatel-Lucent Enterprise](#Alcatel-Lucent%20Enterprise) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Allied Telesis](#Allied%20Telesis) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Alpine Linux](#Alpine%20Linux) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Altran Intelligent Systems](#Altran%20Intelligent%20Systems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Amazon](#Amazon) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ANTlabs](#ANTlabs) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Apple](#Apple) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Arch Linux](#Arch%20Linux) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ARRIS](#ARRIS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ASUSTeK Computer Inc.](#ASUSTeK%20Computer%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Atheros Communications Inc](#Atheros%20Communications%20Inc) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [AT&T](#AT%26T) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Avaya](#Avaya) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Belden](#Belden) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Belkin Inc.](#Belkin%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Bell Canada Enterprises](#Bell%20Canada%20Enterprises) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [BlackBerry](#BlackBerry) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Blackberry QNX](#Blackberry%20QNX) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [BlueCat Networks Inc.](#BlueCat%20Networks%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Blue Coat Systems](#Blue%20Coat%20Systems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Blunk Microsystems](#Blunk%20Microsystems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [BoringSSL](#BoringSSL) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Broadcom](#Broadcom) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Buffalo Technology](#Buffalo%20Technology) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Cambium Networks](#Cambium%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [CA Technologies](#CA%20Technologies) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Cirpack](#Cirpack) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [CMX Systems](#CMX%20Systems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Comcast](#Comcast) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Commscope](#Commscope) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Contiki OS](#Contiki%20OS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Cricket Wireless](#Cricket%20Wireless) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Cypress Semiconductor](#Cypress%20Semiconductor) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [CZ.NIC](#CZ.NIC) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [dd-wrt](#dd-wrt) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Debian GNU/Linux](#Debian%20GNU/Linux) Unknown

Notified:  2021-02-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Dell EMC](#Dell%20EMC) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [DesktopBSD](#DesktopBSD) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Devicescape](#Devicescape) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [dnsmasq](#dnsmasq) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [DragonFly BSD Project](#DragonFly%20BSD%20Project) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [eero](#eero) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [EfficientIP](#EfficientIP) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ENEA](#ENEA) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ericsson](#Ericsson) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Espressif Systems](#Espressif%20Systems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [European Registry for Internet Domains](#European%20Registry%20for%20Internet%20Domains) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Express Logic](#Express%20Logic) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Extreme Networks](#Extreme%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [F5 Networks](#F5%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Fedora Project](#Fedora%20Project) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [FNet](#FNet) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Force10 Networks](#Force10%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Fortinet](#Fortinet) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [FreeBSD](#FreeBSD) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [FreeRTOS](#FreeRTOS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [F-Secure Corporation](#F-Secure%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Gentoo Linux](#Gentoo%20Linux) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [GFI Software](#GFI%20Software) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [GNU adns](#GNU%20adns) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [GNU glibc](#GNU%20glibc) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Google](#Google) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Grandstream](#Grandstream) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Green Hills Software](#Green%20Hills%20Software) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [HardenedBSD](#HardenedBSD) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Hewlett Packard Enterprise](#Hewlett%20Packard%20Enterprise) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Hitachi](#Hitachi) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Honeywell](#Honeywell) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [HTC](#HTC) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Huawei](#Huawei) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [IBM](#IBM) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [IBM Corporation (zseries)](#IBM%20Corporation%20%28zseries%29) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [IBM Numa-Q Division (Formerly Sequent)](#IBM%20Numa-Q%20Division%20%28Formerly%20Sequent%29) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ICASI](#ICASI) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Illumos](#Illumos) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Infoblox](#Infoblox) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [InfoExpress Inc.](#InfoExpress%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Inmarsat](#Inmarsat) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Internet Initiative Japan Inc.](#Internet%20Initiative%20Japan%20Inc.) Unknown

Notified:  2021-10-29
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Internet Systems Consortium](#Internet%20Systems%20Consortium) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Internet Systems Consortium - DHCP](#Internet%20Systems%20Consortium%20-%20DHCP) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [IP Infusion Inc.](#IP%20Infusion%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [JH Software](#JH%20Software) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Joyent](#Joyent) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [JPCERT/CC Vulnerability Handling Team](#JPCERT/CC%20Vulnerability%20Handling%20Team) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [LANCOM Systems GmbH](#LANCOM%20Systems%20GmbH) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Lancope](#Lancope) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Lantronix](#Lantronix) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Lenovo](#Lenovo) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [LG Electronics](#LG%20Electronics) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [LibreSSL](#LibreSSL) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Linksys](#Linksys) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [LITE-ON Technology Corporation](#LITE-ON%20Technology%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [LiteSpeed Technologies](#LiteSpeed%20Technologies) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Lynx Software Technologies](#Lynx%20Software%20Technologies) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [m0n0wall](#m0n0wall) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Marconi Inc.](#Marconi%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Marvell Semiconductor](#Marvell%20Semiconductor) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [MediaTek](#MediaTek) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Medtronic](#Medtronic) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Men & Mice](#Men%20%26%20Mice) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Metaswitch Networks](#Metaswitch%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Microchip Technology](#Microchip%20Technology) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Micro Focus](#Micro%20Focus) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Mitel Networks](#Mitel%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Motorola](#Motorola) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [National Cyber Security Center Netherlands](#National%20Cyber%20Security%20Center%20Netherlands) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [National Cyber Security Centre Finland](#National%20Cyber%20Security%20Centre%20Finland) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NCSC-FI Vulnerability Coordinator](#NCSC-FI%20Vulnerability%20Coordinator) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NEC Corporation](#NEC%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NetBSD](#NetBSD) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NetBurner](#NetBurner) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NetComm Wireless Limited](#NetComm%20Wireless%20Limited) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NETGEAR](#NETGEAR) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NETSCOUT](#NETSCOUT) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [netsnmpj](#netsnmpj) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Nexenta](#Nexenta) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NIKSUN](#NIKSUN) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Nixu](#Nixu) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [NLnet Labs](#NLnet%20Labs) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Nokia](#Nokia) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OleumTech](#OleumTech) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenBSD](#OpenBSD) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenConnect Ltd](#OpenConnect%20Ltd) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenDNS](#OpenDNS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenIndiana](#OpenIndiana) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [OpenSSL](#OpenSSL) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Openwall GNU/\*/Linux](#Openwall%20GNU/%2A/Linux) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Oracle Corporation](#Oracle%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Oryx Embedded](#Oryx%20Embedded) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [pfSense](#pfSense) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Philips Electronics](#Philips%20Electronics) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Phoenix Contact](#Phoenix%20Contact) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [PHPIDS](#PHPIDS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [PowerDNS](#PowerDNS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Proxim Inc.](#Proxim%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Pulse Secure](#Pulse%20Secure) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [QLogic](#QLogic) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Quadros Systems](#Quadros%20Systems) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Quagga](#Quagga) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Qualcomm](#Qualcomm) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Quantenna Communications](#Quantenna%20Communications) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Riverbed Technologies](#Riverbed%20Technologies) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Roku](#Roku) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ruckus Wireless](#Ruckus%20Wireless) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ruijie Networks](#Ruijie%20Networks) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Samsung](#Samsung) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Samsung Mobile](#Samsung%20Mobile) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Samsung Semiconductor](#Samsung%20Semiconductor) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Schneider Electric](#Schneider%20Electric) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Secure64 Software Corporation](#Secure64%20Software%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SEIKO EPSON Corp. / Epson America Inc.](#SEIKO%20EPSON%20Corp.%20/%20%20Epson%20America%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Slackware Linux Inc.](#Slackware%20Linux%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SMC Networks Inc.](#SMC%20Networks%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SmoothWall](#SmoothWall) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Snort](#Snort) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SonicWall](#SonicWall) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Sonos](#Sonos) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Sony](#Sony) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Sourcefire](#Sourcefire) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [SUSE Linux](#SUSE%20Linux) Unknown

Notified:  2021-02-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Symantec](#Symantec) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [systemd](#systemd) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [TCPWave](#TCPWave) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [TDS Telecom](#TDS%20Telecom) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Technicolor](#Technicolor) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Tenable Network Security](#Tenable%20Network%20Security) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [The OpenBSD project](#The%20OpenBSD%20project) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [TippingPoint Technologies Inc.](#TippingPoint%20Technologies%20Inc.) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Tizen](#Tizen) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Toshiba Commerce Solutions](#Toshiba%20Commerce%20Solutions) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [TP-LINK](#TP-LINK) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [TrueOS](#TrueOS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Turbolinux](#Turbolinux) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ubiquiti](#Ubiquiti) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Ubuntu](#Ubuntu) Unknown

Notified:  2021-02-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Unisys Corporation](#Unisys%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Univention](#Univention) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [VMware](#VMware) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Vultures List](#Vultures%20List) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [WizNET Technology](#WizNET%20Technology) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [wolfSSL](#wolfSSL) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Xiaomi](#Xiaomi) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [XigmaNAS](#XigmaNAS) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Xilinx](#Xilinx) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Zebra Technologies](#Zebra%20Technologies) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Zephyr Project](#Zephyr%20Project) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [ZTE Corporation](#ZTE%20Corporation) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

### [Zyxel](#Zyxel) Unknown

Notified:  2021-08-23
Updated: 2022-09-27

| **CVE-2021-27853** | Unknown |
| --- | --- |
| **CVE-2021-27854** | Unknown |
| **CVE-2021-27861** | Unknown |
| **CVE-2021-27862** | Unknown |

#### Vendor Statement

We have not received a statement from the vendor.

View all 243 vendorsView less vendors

### References

* <https://blog.champtar.fr/VLAN0/>
* <https://blog.champtar.fr/VLAN0_LLC_SNAP/>
* [https://lore.kernel.org/netdev/CAOdf3grDKBkYmt54ZAzG1zZ6zz1JXeoHSv67\_Fc9-nRiY662mQ@mail.gmail.com/](https://lore.kernel.org/netdev/CAOdf3grDKBkYmt54ZAzG1zZ6zz1JXeoHSv67_Fc9-nRiY662mQ%40mail.gmail.com/)
* [https://bugs.launchpad.net/neutron/+bug/1884341](https://bugs.launchpad.net/neutron/%2Bbug/1884341)
* <https://standards.ieee.org/standard/802_1Q-1998.html>
* <https://standards.ieee.org/standard/802_2-1985.html>
* <https://standards.ieee.org/standard/802_3-2018.html>
* <https://standards.ieee.org/standard/802_1ad-2005.html>
* <https://blogs.nwkings.com/what-is-dai-dynamic-arp-inspection/>
* <https://datatracker.ietf.org/doc/rfc4861/>
* <https://datatracker.ietf.org/doc/html/rfc6105>
* [https://www.ieee802.org/1/files/public/docs2022/q-rev-seaman-priority-in-tags-0122-v0.pdf](https://www.ieee802.org/1/files/public/docs2022/q-rev-seaman-priority-in-tags-0122-v0.pdf%20)
* <https://www.ieee802.org/1/files/public/docs2022/q-rev-seaman-vlan-tag-encoding-ppt-0122-v0.pdf>

### Other Information

| **CVE IDs:** | [CVE-2021-27853](http://web.nvd.nist.gov/vuln/detail/CVE-2021-27853)  [CVE-2021-27854](http://web.nvd.nist.gov/vuln/detail/CVE-2021-27854)  [CVE-2021-27861](http://web.nvd.nist.gov/vuln/detail/CVE-2021-27861)  [CVE-2021-27862](http://web.nvd.nist.gov/vuln/detail/CVE-2021-27862) |
| --- | --- |
| **API URL:** | [VINCE JSON](/vuls/api/855201/) | [CSAF](/vuls/api/855201/csaf/) |
| **Date Public:** | 2022-09-27 |
| **Date First Published:** | 2022-09-27 |
| **Date Last Updated:** | 2023-06-14 13:15 UTC |
| **Document Revision:** | 9 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from sec.cloudapps.cisco.com_53341f93_20250115_120012.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from bst.cloudapps.cisco.com_07992222_20250115_180511.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from software.cisco.com_5d30a85b_20250115_180514.html ===

[Skip to main](#csw-main)

#### Cisco Licensing

# Cisco Software Central

Access everything you need to activate and manage your Cisco Smart Licenses.

# Download and manage

# Smart Software Manager

Track and manage your licenses. Convert traditional licenses to Smart Licenses.

[Manage licenses](/software/smart-licensing/alerts)

# Download and Upgrade

Download new software or updates to your current software.

[Access downloads](/download/home)

# Traditional Licenses

Generate and manage PAK-based and other device licenses, including demo licenses.

[Access LRP](/software/swift/lrp/)

# Manage Smart Account

Update your profile information and manage users.

[Manage account](/software/csws/smartaccount/accountProperties)

# EA Workspace Generate and manage licenses purchased through a Cisco Enterprise Agreement. [Access EA Workspace](/software/ea/agreements)

# Manage Entitlements

eDelivery, version upgrade, and more management functionality is now available in our new portal.

[Access MCE](https://mce.cisco.com/mce/?vN=edelivery)

# Get started with Smart Licensing

# Cisco licensing made easy

Learn about licensing, how to purchase, deploy, and manage your software.

[Read the guide](https://www.cisco.com/c/en/us/buy/licensing/licensing-guide.html)

# Do it yourself

Get started with easy to follow "How-to" documents to troubleshoot common issues on your own.

[Licensing support](https://www.cisco.com/c/en/us/support/licensing/licensing-support.html)

# Smart Licensing

Cisco Smart Licensing is a flexible licensing model that streamlines how you activate and manage software.

## For customers

#### Existing account

Start by getting access to your company's existing Smart Account.

[Submit request](https://rpfa.cloudapps.cisco.com/rpfa/profile/smartaccount.do?submenu=2&requestExistingAccess=yes)

#### New account

Don't have an account? Create one now.

[Create account](/software/csws/smartaccount/accountCreation/createSmartAccount)

#### Account administration

Update information and manage your users.

[Manage account](/software/csws/smartaccount/accountProperties)

#### Smart Software Manager

Convert classic to Smart Licenses.

[Manage licenses](/software/smart-licensing/alerts)

#### Network Plug and Play

Automate device discovery and activation on-prem or from the cloud.

[Manage devices](/software/pnp/devices)

#### Delegate an account

Request an account for your company and delegate another administrator.

[Request account](/software/csws/smartaccount/accountCreation/requestAccountForCustomer)



=== Content from www.cisco.com_cf985588_20250115_120015.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

#### Cisco Security

# Cisco Security Advisories

 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
- Vulnerabilities
- Filter By Product

 Quick Search

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{SeverityDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
|
 | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC'}} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC'}} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Select at least one checkbox to view vulnerabilities that affect Cisco products

 Remove All

 [*Advanced Search*](/security/center/Search.x)
Add a Product

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{prdFltrSvrDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
| | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC' }} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC' }} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Add a product to see all related advisories

##### Do you really want to delete all products?

 OK
 Cancel

To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy.](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html) This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.

Cisco Security Advisories and other Cisco security content are provided on an "as is" basis and do not imply any kind of guarantee or warranty. Your use of the information in these publications or linked material is at your own risk. Cisco reserves the right to change or update this content without notice at any time.

![](https://sec.cloudapps.cisco.com/security/center/Resources/images/on.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/off.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-clear-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-down.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-up.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/delete-icon.png)

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)



=== Content from www.cisco.com_34e21554_20250115_120006.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Routers](/c/en/us/support/routers/index.html)
* [Cisco ASR 9000 Series Aggregation Services Routers](/c/en/us/support/routers/asr-9000-series-aggregation-services-routers/series.html)
* [Troubleshooting TechNotes](/c/en/us/support/routers/asr-9000-series-aggregation-services-routers/products-tech-notes-list.html)
# Understand IOS XR L2VPN Services and Features

![](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.pdf)
  (1.1 MB)

  View with Adobe Reader on a variety of devices
* [ePub](/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.epub)
  (725.1 KB)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi (Kindle)](/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.mobi)
  (1.0 MB)

  View on Kindle device or Kindle app on multiple devices

Updated:January 13, 2025
Document ID:116453

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

## Contents

[Introduction](#toc-hId--901974010)[Background Information](#toc-hId-840836325)[1. Point-to-Point and Multipoint Services](#toc-hId--1711320636)[1.1 Point-to-Point Service](#toc-hId--165023806)[1.2 Multipoint Service](#toc-hId-1577786529)[2. Attachment Circuits](#toc-hId--777856927)[2.1 ASR 9000 Ethernet Virtual Circuit](#toc-hId-768439903)[2.1.1 Incoming Interface Matching](#toc-hId--1980230563)[2.1.2 VLAN Manipulation](#toc-hId--237420228)[2.2 Cisco IOS® XR Non-EVC Router Behavior (CRS and XR12000)](#toc-hId-986742323)[3. Point-to-Point Service](#toc-hId-231536721)[3.1 Local Switching](#toc-hId-177395697)[3.1.1 Main Interface](#toc-hId-123254673)[3.1.2 Subinterfaces and VLAN Manipulation](#toc-hId-1866065008)[3.1.2.1 Main Interface and Dot1q Subinterface](#toc-hId--686091953)[3.1.2.2 Subinterface with Encapsulation](#toc-hId-1056718382)[3.1.2.3 Ingress Direction on GigabitEthernet0/1/0/1.1](#toc-hId--1495438579)[3.2 Virtual Private Wire Services](#toc-hId-2044323115)[3.2.1 Overview](#toc-hId-1990182091)[3.2.2 PW and AC Coupled Status](#toc-hId-1677303797)[3.2.3 Type 4 and Type 5 PWs](#toc-hId--874853164)[3.2.4 Multi-segment PW](#toc-hId-867957171)[3.2.5 Redundancy](#toc-hId--1684199790)[3.2.5.1 Core Redundancy](#toc-hId-58610545)[3.2.5.2 Bundle Over PWs](#toc-hId-1801420880)[3.2.5.3 PW Redundancy](#toc-hId--750736081)[3.2.5.4 ASR 9000 nV Edge Cluster](#toc-hId-992074254)[3.3 CDP](#toc-hId-236868652)[3.3.1 CDP Not Enabled on Main Interface of L2VPN PE](#toc-hId-182727628)[3.3.2 CDP Enabled on Main Interface of L2VPN PE](#toc-hId--130150666)[3.4 Spanning Tree](#toc-hId--885356268)[4. Multipoint Service](#toc-hId--1640561870)[4.1 Local Switching](#toc-hId--1694702894)[4.2 Full MST](#toc-hId-1790917776)[4.3 BVI](#toc-hId--761239185)[4.4 VPLS](#toc-hId-981571150)[4.4.1 Overview](#toc-hId-927430126)[4.4.2 PW Types and Transported Tags](#toc-hId--1624726835)[4.4.3 Autodiscovery and Signaling](#toc-hId--1937605129)[4.4.3.1 BGP Autodiscovery and BGP Signaling](#toc-hId--194794794)[4.4.3.2 BGP Autodiscovery and LDP Signaling](#toc-hId-1548015541)[4.4.4 MAC Flushes and Withdrawals](#toc-hId--1004141420)[4.4.5 H-VPLS](#toc-hId-738668915)[4.4.6 Split Horizon Groups (SHGs)](#toc-hId--1813488046)[4.4.7 Redundancy](#toc-hId--70677711)[4.4.7.1 Spanning Tree](#toc-hId-1672132624)[4.4.7.2 MSTAG](#toc-hId--880024337)[4.4.7.3 PVSTAG or PVRSTAG](#toc-hId-862785998)[4.4.7.4 MC-LAG](#toc-hId-549907704)[4.4.7.5 ASR 9000 nV Edge Cluster](#toc-hId--2002249257)[4.4.7.6ICCP-Based Service Multi-Homing (ICCP-SM) (PMCLAG (Pseudo MCLAG) and Active/Active)](#toc-hId--259438922)[4.5 Traffic Storm Control](#toc-hId--1014644524)[4.6 MAC Moves](#toc-hId-728165811)[4.7 IGMP and MLD Snooping](#toc-hId--1823991150)[5. Additional L2VPN Topics](#toc-hId-1715770544)[5.1 Loadbalancing](#toc-hId-1661629520)[5.2 Logging](#toc-hId--890527441)[5.3 ethernet-services access-list](#toc-hId-852282894)[5.4 ethernet egress-filter](#toc-hId-539404600)

##

## Introduction

This document describes basic Layer 2 (L2) VPN (L2VPN) topologies and presents basic examples to demonstrate design, services, and configuration.

## Background Information

See the [L2VPN and Ethernet Services Configuration Guide for Cisco ASR 9000 Series Routers, IOS XR Release 7.4.x](https://www.cisco.com/c/en/us/td/docs/routers/asr9000/software/asr9k-r7-4/lxvpn/configuration/guide/b-l2vpn-cg-asr9000-74x.html) for additional information.

## 1. Point-to-Point and Multipoint Services

The L2VPN feature provides the ability to provide point-to-point and multipoint services.

### 1.1 Point-to-Point Service

Point-to-point service basically emulates a transport circuit between two end nodes so the end nodes appear to be directly connected over a point-to-point link. This can be used to connect two sites.

![Point-to-Point Service Image 1](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-00.jpeg)

In reality, there can be multiple routers between the two end nodes, and there can be multiple designs to provide the point-to-point service.

One router can do local switching between two of its interfaces:

![Point-to-Point Service Image 2](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-01.jpeg)

There can also be a Multiprotocol Label Switching (MPLS) pseudowire (PW) between two routers:

![Point-to-Point Service Image 3](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-02.jpeg)

A router can switch frames between two PWs; in this case, this is a multi-segment PW:

![Point-to-Point Service Image 4](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-03.jpeg)

Redundancy is available through the PW redundancy feature:

![Point-to-Point Service Image 5](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-04.jpeg)

Other designs are available, but cannot all be listed here.

### 1.2 Multipoint Service

Multipoint service emulates a broadcast domain so that all hosts connected in that bridge-domain appear to be logically connected to the same Ethernet segment:

![Multipoint Service Image 1](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-05.jpeg)

All hosts can be connected to the same router/switch:

![Multipoint Service Image 2](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-06.jpeg)

Multiple switches can do traditional Ethernet switching; spanning tree must be used in order to break loops:

![Multipoint Service Image 3](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-07.jpeg)

Virtual Private LAN Services (VPLS) lets you extend the broadcast domain between multiple sites using MPLS PWs:

![Multipoint Service Image 4](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-08.jpeg)

Hierarchical VPLS can be used in order to increase scalability:

![Multipoint Service Image 5](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-09.jpeg)

## 2. Attachment Circuits

### 2.1 ASR 9000 Ethernet Virtual Circuit

#### 2.1.1 Incoming Interface Matching

Basic rules for attachment circuits (ACs) include:

* A packet must be received on an interface configured with the l2transport keyword in order to be processed by the L2VPN feature.
* This interface can be a main interface, where the **l2transport** command is configured under the interface config mode, or a subinterface, where the l2transport keyword is configured after the subinterface number.
* A longest match lookup determines the incoming interface of the packet. The longest match lookup checks these conditions in this order to match the incoming packet to a subinterface:

1. The incoming frame has two dot1q tags and matches a subinterface configured with the same two dot1q tags (802.1Q tunneling, or QinQ). This is the longest possible match.
2. The incoming frame has two dot1q  tags and matches a subinterface configured with the same dot1q first tag and any for the second tag.
3. The incoming frame has one dot1q tag and matches a subinterface configured with the same dot1q tag and the exact keyword.
4. The incoming frame has one or more dot1q tags and matches a subinterface configured with one of the dot1q tags.
5. The incoming frame has no dot1q tags and matches a subinterface configured with the **encapsulation untagged** command.
6. The incoming frame fails to match any other subinterface, so it matches a subinterface configured with the **encapsulation default** command.
7. The incoming frame  fails to match any other subinterface, so it matches the main interface that is configured for l2transport.

* On traditional routers that do not use the Ethernet Virtual Connection (EVC) model, the VLAN tags configured under the subinterface are removed (popped) from the frame before they are transported by the L2VPN feature.
* On a Cisco ASR 9000 Series Aggregation Services Router that uses the EVC infrastructure, the default action is to preserve the existing tags. Use the **rewrite** command to modify the default.
* If there is a Bridge Virtual Interface (BVI) in the bridge-domain, all incoming tags can be popped because the BVI is a routed interface without any tag. See the BVI section for details.

Here are several examples that illustrate these rules:

1. A basic example is when all traffic received on a physical port must be transported, whether or not it has a VLAN tag. If you configure l2transport under the main interface, all traffic received on that physical port is transported by the L2VPN feature:

   ```
   interface GigabitEthernet0/0/0/2
    l2transport
   ```
2. Bundle interfaces and subinterfaces can be configured as l2transport:

   ```
   interface Bundle-Ether1
    l2transport
   ```
3. Use **encapsulation default** under an l2transport subinterface to match any tagged or untagged traffic that has not been matched by another subinterface with a longest match. (See Example 4). The l2transport keyword is configured in the subinterface name, not under the subinterface as on the main interface:

   ```
   interface GigabitEthernet0/1/0/3.1 l2transport
    encapsulation default
   ```
   Configure **encapsulation untagged** if you want to match only untagged frames.
4. When there are multiple subinterfaces, run the longest match test on the incoming frame in order to determine the incoming interface:

   ```
   interface GigabitEthernet0/1/0/3.1 l2transport
    encapsulation default
   !
   interface GigabitEthernet0/1/0/3.2 l2transport
    encapsulation dot1q 2
   !
   interface GigabitEthernet0/1/0/3.3 l2transport
    encapsulation dot1q 2 second-dot1q 3

   ```
   In this configuration, note that:

* A QinQ frame with an outer VLAN tag 2 and an inner VLAN tag 3 could match the 1, 2, or 3 subinterfaces but it is assigned to the 3 subinterface because of the longest match rule. Two tags on 3 are longer than one tag on 2 and longer than no tags on 1.
* A QinQ frame with an outer VLAN tag 2 and an inner VLAN tag 4 is assigned to the .2 subinterface because encapsulation dot1q 2 can match dot1q frames with just the VLAN tag 2 but can also match QinQ frames with an outer tag 2. Refer to Example 5 (the exact keyword) if you do not want to match the QinQ frames.
* A QinQ frame with an outer VLAN tag 3 matches the 1 subinterface.
* A dot1q frame with a VLAN tag 2 matches the 2 subinterface.
* A dot1q frame with a VLAN tag 3 matches the 1 subinterface.

6. To match a dot1q frame and not a QinQ frame, use the exact keyword:

   ```
   interface GigabitEthernet0/1/0/3.2 l2transport
    encapsulation dot1q 2 exact
   ```
   This configuration does not match QinQ frames with an outer VLAN tag 2 because it matches only frames with exactly one VLAN tag.
7. Use the untagged keyword in order to match only untagged frames such as Cisco Discovery Protocol (CDP) packets or Multiple Spanning Tree (MST) Bridge Protocol Data Units (BPDUs):

   ```
   interface GigabitEthernet0/1/0/3.1 l2transport
    encapsulation default
   !
   interface GigabitEthernet0/1/0/3.2 l2transport
    encapsulation untagged
   !
   interface GigabitEthernet0/1/0/3.3 l2transport
    encapsulation dot1q 3

   ```
   In this configuration, note that:

* Dot1q frames with a VLAN tag 3 or QinQ frames with an outer tag 3 match the 3 subinterfaces.
* All other dot1q or QinQ frames match the 1 subinterface.
* Frames without a VLAN tag match the 2 subinterface.

9. The any keyword can be used as wildcard:

   ```
   interface GigabitEthernet0/1/0/3.4 l2transport
    encapsulation dot1q 4 second-dot1q any
   !
   interface GigabitEthernet0/1/0/3.5 l2transport
    encapsulation dot1q 4 second-dot1q 5

   ```
   Both subinterfaces 4 and 5 could match QinQ frames with tags 4 and 5, but the frames are assigned to the 5 subinterfaces because it is more specific. This is the longest match rule.
10. Ranges of VLAN tags can be used:

    ```
    interface GigabitEthernet0/1/0/3.6 l2transport
     encapsulation dot1q 6-10
    ```
11. Multiple VLAN tag values or ranges can be listed for the first or second dot1q tag:

    ```
    interface GigabitEthernet0/1/0/3.7 l2transport
     encapsulation dot1q 6 , 7 , 8-10
    !
    interface GigabitEthernet0/1/0/3.11 l2transport
     encapsulation dot1q 11 second-dot1q 1 , 2 , 3 , 4-6 , 10
    ```
    You can list a maximum of nine values. If more values are required, they must be assigned to another subinterface. Group values in a range in order to shorten the list.
12. The **encapsulation dot1q second-dot1q** command uses the Ethertype 0x8100 for the outer and inner tags because this is the Cisco method to encapsulate QinQ frames. According to IEEE, however, the Ethertype 0x8100 can be reserved for 802.1q frames with one VLAN tag, and an outer tag with Ethertype 0x88a8 can be used for QinQ frames. The outer tag with Ethertype 0x88a8 can be configured with the dot1ad keyword:

    ```
    interface GigabitEthernet0/1/0/3.12 l2transport
     encapsulation dot1ad 12 dot1q 100
    ```
13. In order to use the old Ethertype 0x9100 or 0x9200 for the QinQ outer tags, use the **dot1q tunneling ethertype** command under the main interface of the QinQ subinterface:

    ```
    interface GigabitEthernet0/1/0/3
     dot1q tunneling ethertype [0x9100|0x9200]
    !
    interface GigabitEthernet0/1/0/3.13 l2transport
     encapsulation dot1q 13 second-dot1q 100

    ```
    The outer tag has an Ethertype of 0x9100 or 0x9200, and the inner tag has the dot1q Ethertype 0x8100.
14. An incoming frame can be assigned to a subinterface, based on the source MAC address:

    ```
    interface GigabitEthernet0/1/0/3.14 l2transport
     encapsulation dot1q 14 ingress source-mac 1.1.1
    ```

#### 2.1.2 VLAN Manipulation

The default behavior of an EVC-based platform is to keep the VLAN tags on the incoming frame.

```
interface GigabitEthernet0/1/0/3.3 l2transport
 encapsulation dot1q 3

```

In this configuration, an incoming dot1q frame with a VLAN tag 3 keeps its VLAN tag 3 when the frame is forwarded. An incoming QinQ frame with an outer VLAN tag 3 and an inner tag 100 keeps both tags unchanged when the frame is forwarded.

But, the EVC infrastructure allows you to manipulate the tags with the **rewrite** command, so you can pop (remove), translate, or push (add) tags to the incoming VLAN tag stack.

Here are several examples:

* The pop keyword lets you remove a QinQ tag from an incoming dot1q frame. This example removes the outer tag 13 of the incoming QinQ frame and forwards the frame with the dot1q tag 100 on top:

> ```
> interface GigabitEthernet0/1/0/3.13 l2transport
>  encapsulation dot1q 13 second-dot1q 100
>  rewrite ingress tag pop 1 symmetric
> ```
>
> The behavior is always symmetric, which means that the outer tag 13 is popped in the ingress direction and pushed in the egress direction.

* The translate keyword lets you replace one or two incoming tags by one or two new tags:

> ```
> RP/0/RSP0/CPU0:router2(config-subif)#interface GigabitEthernet0/1/0/3.3
>    l2transport
> RP/0/RSP0/CPU0:router2(config-subif)# encapsulation dot1q 3
> RP/0/RSP0/CPU0:router2(config-subif)#rewrite ingress tag translate ?
>   1-to-1  Replace the outermost tag with another tag
>   1-to-2  Replace the outermost tag with two tags
>   2-to-1  Replace the outermost two tags with one tag
>   2-to-2  Replace the outermost two tags with two other tags
> RP/0/RSP0/CPU0:router2(config-subif)#rewrite ingress tag translate 1-to-1 ?
>   dot1ad  Push a Dot1ad tag
>   dot1q   Push a Dot1Q tag
> RP/0/RSP0/CPU0:router2(config-subif)#rewrite ingress tag translate 1-to-1
>    dot1q 4
> RP/0/RSP0/CPU0:router2(config-subif)#show config
> Building configuration...
> !! IOS XR Configuration 4.3.0
> interface GigabitEthernet0/1/0/3.3 l2transport
>  encapsulation dot1q 3
>  rewrite ingress tag translate 1-to-1 dot1q 4 symmetric
> !
> end
> ```
>
> The symmetric keyword is added automatically because it is the only supported mode.

* The push keyword lets you add a QinQ tag to an incoming dot1q frame:

> ```
> interface GigabitEthernet0/1/0/3.4 l2transport
>  encapsulation dot1q 4
>  rewrite ingress tag push dot1q 100 symmetric
>
> ```
>
> An outer QinQ tag 100 is added to the incoming frame with a dot1q tag 4. In the egress direction, the QinQ tag is popped.

### 2.2 Cisco IOS® XR Non-EVC Router Behavior (CRS and XR12000)

The syntax for VLAN matching on the non-EVC platforms does not use the encapsulation keyword:

```
RP/0/RP0/CPU0:router1#config
RP/0/RP0/CPU0:router1(config)#int gig 0/0/0/2.3 l2transport
RP/0/RP0/CPU0:router1(config-subif)#dot1q ?
  vlan  Configure a VLAN ID on the subinterface
RP/0/RP0/CPU0:router1(config-subif)#dot1q vlan ?
  <1-4094>  Configure first (outer) VLAN ID on the subinterface
RP/0/RP0/CPU0:router1(config-subif)#dot1q vlan 3 ?
  <1-4094>  Configure second (inner 802.1Q) VLAN ID on the subinterface
  any       Match frames with any second 802.1Q VLAN ID

RP/0/RP0/CPU0:router1(config-subif)#dot1q vlan 3 100
```

VLAN tag manipulation cannot be configured, because the only possible behavior is to pop all the tags that are specified in the **dot1q** or **dot1ad** commands. This is done by default, so there is no **rewrite** command.

## 3. Point-to-Point Service

### 3.1 Local Switching

#### 3.1.1 Main Interface

The basic topology is a local cross connect between two main interfaces:

![Main Interface](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-10.jpeg)

Router2 takes all traffic received on Gi 0/1/0/1 and forwards it to Te 0/0/0/3 and vice versa.

While router1 and router3 appear to have a direct back-to-back cable in this topology, this is not the case because router2 is actually translating between the TenGigE and GigabitEthernet interfaces. Router2 can run features on these two interfaces; an access control list (ACL), for example, can drop specific types of packets or a policy-map in order to shape or rate-limit low priority traffic.

A basic point-to-point cross connect is configured between two main interfaces that are configured as l2transport on router2:

```
interface GigabitEthernet0/1/0/1
 l2transport
 !
!
interface TenGigE0/0/0/3
 l2transport
 !
!
l2vpn
 xconnect group test
  p2p p2p1
   interface TenGigE0/0/0/3
   interface GigabitEthernet0/1/0/1
  !

```

On router1 and router3, the main interfaces are configured with CDP and an IPv4 address:

```
RP/0/RP0/CPU0:router1#sh run int Gi 0/0/0/1
interface GigabitEthernet0/0/0/1
 cdp
 ipv4 address 10.1.1.1 255.255.255.0
!

RP/0/RP0/CPU0:router1#
RP/0/RP0/CPU0:router1#sh cdp nei Gi 0/0/0/1
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater

Device ID       Local Intrfce    Holdtme Capability Platform  Port ID
router3.cisco.c Gi0/0/0/1        132     R          ASR9K Ser Te0/0/0/3
RP/0/RP0/CPU0:router1#ping 10.1.1.2
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 10.1.1.2, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 2/8/32 ms

```

Router1 sees router3 as a CDP neighbor and can ping 10.1.1.2 (the interface address of router3) as if the two routers were directly connected.

Because there is no subinterface configured on router2, incoming frames with a VLAN tag are transported transparently when dot1q subinterfaces are configured on router1 and router3:

```
RP/0/RP0/CPU0:router1#sh run int gig 0/0/0/1.2
interface GigabitEthernet0/0/0/1.2
 ipv4 address 10.1.2.1 255.255.255.0
 dot1q vlan 2
!

RP/0/RP0/CPU0:router1#ping 10.1.2.2
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 10.1.2.2, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 2/3/5 ms

```

After 10,000 pings from router1 to router3, you can use the **show interface** and **show l2vpn** commands in order to ensure that ping requests received by router2 on one AC are forwarded on the other AC and that ping replies are handled the same way in reverse.

```
RP/0/RSP0/CPU0:router2#sh int gig 0/1/0/1
GigabitEthernet0/1/0/1 is up, line protocol is up
  Interface state transitions: 1
  Hardware is GigabitEthernet, address is 0024.986c.63f1 (bia 0024.986c.63f1)
  Description: static lab connection to acdc 0/0/0/1 - dont change
  Layer 2 Transport Mode
  MTU 1514 bytes, BW 1000000 Kbit (Max: 1000000 Kbit)
     reliability 255/255, txload 0/255, rxload 0/255
  Encapsulation ARPA,
  Full-duplex, 1000Mb/s, SXFD, link type is force-up
  output flow control is off, input flow control is off
  loopback not set,
  Last input 00:00:00, output 00:00:00
  Last clearing of "show interface" counters 00:01:07
  5 minute input rate 28000 bits/sec, 32 packets/sec
  5 minute output rate 28000 bits/sec, 32 packets/sec
     10006 packets input, 1140592 bytes, 0 total input drops
     0 drops for unrecognized upper-level protocol
     Received 0 broadcast packets, 6 multicast packets
              0 runts, 0 giants, 0 throttles, 0 parity
     0 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored, 0 abort
     10007 packets output, 1140832 bytes, 0 total output drops
     Output 0 broadcast packets, 7 multicast packets
     0 output errors, 0 underruns, 0 applique, 0 resets
     0 output buffer failures, 0 output buffers swapped out
     0 carrier transitions

RP/0/RSP0/CPU0:router2#sh int ten 0/0/0/3
TenGigE0/0/0/3 is up, line protocol is up
  Interface state transitions: 3
  Hardware is TenGigE, address is 0024.98ea.038b (bia 0024.98ea.038b)
  Layer 1 Transport Mode is LAN
  Description: static lab connection to putin 0/0/0/3 - dont change
  Layer 2 Transport Mode
  MTU 1514 bytes, BW 10000000 Kbit (Max: 10000000 Kbit)
     reliability 255/255, txload 0/255, rxload 0/255
  Encapsulation ARPA,
  Full-duplex, 10000Mb/s, LR, link type is force-up
  output flow control is off, input flow control is off
  loopback not set,
  Last input 00:00:00, output 00:00:06
  Last clearing of "show interface" counters 00:01:15
  5 minute input rate 27000 bits/sec, 30 packets/sec
  5 minute output rate 27000 bits/sec, 30 packets/sec
     10008 packets input, 1140908 bytes, 0 total input drops
     0 drops for unrecognized upper-level protocol
     Received 0 broadcast packets, 8 multicast packets
              0 runts, 0 giants, 0 throttles, 0 parity
     0 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored, 0 abort
     10006 packets output, 1140592 bytes, 0 total output drops
     Output 0 broadcast packets, 6 multicast packets
     0 output errors, 0 underruns, 0 applique, 0 resets
     0 output buffer failures, 0 output buffers swapped out
     0 carrier transitions

RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                Segment 1                    Segment 2
Group      Name    ST   Description         ST       Description         ST
---------------------   --------------------------   --------------------------
test       p2p1    UP   Te0/0/0/3           UP       Gi0/1/0/1           UP
-------------------------------------------------------------------------------
RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test det

Group test, XC p2p1, state is up; Interworking none
  AC: TenGigE0/0/0/3, state is up
    Type Ethernet
    MTU 1500; XC ID 0x1080001; interworking none
    Statistics:
      packets: received 10008, sent 10006
      bytes: received 1140908, sent 1140592
  AC: GigabitEthernet0/1/0/1, state is up
    Type Ethernet
    MTU 1500; XC ID 0x1880003; interworking none
    Statistics:
      packets: received 10006, sent 10008
      bytes: received 1140592, sent 1140908

RP/0/RSP0/CPU0:router2#sh l2vpn forwarding interface gigabitEthernet 0/1/0/1
   hardware ingress detail location 0/1/CPU0
Local interface: GigabitEthernet0/1/0/1, Xconnect id: 0x1880003, Status: up
  Segment 1
    AC, GigabitEthernet0/1/0/1, Ethernet port mode, status: Bound
    Statistics:
      packets: received 10022, sent 10023
      bytes: received 1142216, sent 1142489
      packets dropped: PLU 0, tail 0
      bytes dropped: PLU 0, tail 0
  Segment 2
    AC, TenGigE0/0/0/3, Ethernet port mode, status: Bound

  Platform AC context:
  Ingress AC: Local Switch, State: Bound
    Flags: Remote is Simple AC
  XID: 0x00580003, SHG: None
  Ingress uIDB: 0x0003, Egress uIDB: 0x0003, NP: 3, Port Learn Key: 0
  NP3
    Ingress uIDB:
      Flags: L2, Status
      Stats Ptr: 0x0d842c, uIDB index: 0x0003, Wire Exp Tag: 0
      BVI Bridge Domain: 0, BVI Source XID: 0x01000000
      VLAN1: 0, VLAN1 etype: 0x0000, VLAN2: 0, VLAN2 etype: 0x0000
      L2 ACL Format: 0, L2 ACL ID: 0, IPV4 ACL ID: 0, IPV6 ACL ID: 0
      QOS ID: 0, QOS Format ID: 0
      Local Switch dest XID: 0x00000001
      UIDB IF Handle: 0x00000000, Source Port: 1, Num VLANs: 0
    Xconnect ID: 0x00580003, NP: 3
      Type: AC, Remote type: AC
      Flags: Learn enable
      uIDB Index: 0x0003, LAG pointer: 0x0000
      Split Horizon Group: None

RP/0/RSP0/CPU0:router2#sh l2vpn forwarding interface Te 0/0/0/3 hardware egress
   detail location 0/0/CPU0
Local interface: TenGigE0/0/0/3, Xconnect id: 0x1080001, Status: up
  Segment 1
    AC, TenGigE0/0/0/3, Ethernet port mode, status: Bound
    Statistics:
      packets: received 10028, sent 10027
      bytes: received 1143016, sent 1142732
      packets dropped: PLU 0, tail 0
      bytes dropped: PLU 0, tail 0
  Segment 2
    AC, GigabitEthernet0/1/0/1, Ethernet port mode, status: Bound

  Platform AC context:
  Egress AC: Local Switch, State: Bound
    Flags: Remote is Simple AC
  XID: 0x00000001, SHG: None
  Ingress uIDB: 0x0007, Egress uIDB: 0x0007, NP: 0, Port Learn Key: 0
  NP0
    Egress uIDB:
      Flags: L2, Status, Done
      Stats ptr: 0x000000
      VPLS SHG: None
      L2 ACL Format: 0, L2 ACL ID: 0, IPV4 ACL ID: 0, IPV6 ACL ID: 0
      VLAN1: 0, VLAN1 etype: 0x0000, VLAN2: 0, VLAN2 etype: 0x0000
      UIDB IF Handle: 0x04000240, Search VLAN Vector: 0
      QOS ID: 0, QOS format: 0
    Xconnect ID: 0x00000001, NP: 0
      Type: AC, Remote type: AC
      Flags: Learn enable
      uIDB Index: 0x0007, LAG pointer: 0x0000
      Split Horizon Group: None
```
#### 3.1.2 Subinterfaces and VLAN Manipulation

In Cisco IOS® software terminology, this example has one AC that is like a switchport mode access interface and a dot1q subinterface that is like a trunk:

![Subinterfaces and VLAN Manipulation](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-11.jpeg)

Typically this topology uses a bridge-domain because there are usually more than two ports in the VLAN, although you can use a point-to-point cross connect if there are only two ports. This section describes how flexible rewrite capabilities give you multiple ways to manipulate the VLAN.

#### 3.1.2.1 Main Interface and Dot1q Subinterface

In this example, the main interface is on one side, and the dot1q subinterface is on the other side:

This is the main interface on router1:

```
RP/0/RP0/CPU0:router1#sh run int gig 0/0/0/1
interface GigabitEthernet0/0/0/1
 description static lab connection to router2 0/1/0/1
 cdp
 ipv4 address 10.1.1.1 255.255.255.0
!

```

This is the dot1q subinterface on router2:

```
RP/0/RSP0/CPU0:router2#sh run int gig 0/1/0/1
interface GigabitEthernet0/1/0/1
 description static lab connection to router1 0/0/0/1
 l2transport

RP/0/RSP0/CPU0:router2#sh run int ten 0/0/0/3.2
interface TenGigE0/0/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric

RP/0/RSP0/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p2
   interface TenGigE0/0/0/3.2
   interface GigabitEthernet0/1/0/1

```

There is now an l2transport keyword in the subinterface name of TenGigE0/0/0/3.2. Router3 sends dot1q frames with tag 2, which match the TenGigE0/0/0/3.2 subinterface on router2.

The incoming tag 2 is removed in the ingress direction by the **rewrite ingress tag pop 1 symmetric** command. Since the tag has been removed in the ingress direction on the TenGigE0/0/0/3.2, the packets are sent untagged in the egress direction on GigabitEthernet0/1/0/1.

Router1 sends untagged frames, which match the main interface GigabitEthernet0/1/0/1.

There is no **rewrite** command on GigabitEthernet0/1/0/1, so no tag is popped, pushed, or translated.

When packets have to be forwarded out of TenGigE0/0/0/3.2, the dot1q tag 2 is pushed due to the symmetric keyword in the **rewrite ingress tag pop 1** command. The command pops one tag in the ingress direction but symmetrically pushes one tag in the egress direction. This is an example on router3:

```
RP/0/RSP0/CPU0:router3#sh run int ten 0/0/0/3.2
interface TenGigE0/0/0/3.2
 ipv4 address 10.1.1.2 255.255.255.0
 encapsulation dot1q 2

```

Monitor the subinterface counters with the same **show interface** and **show l2vpn** commands:

```
RP/0/RSP0/CPU0:router2#clear counters
Clear "show interface" counters on all interfaces [confirm]
RP/0/RSP0/CPU0:router2#clear l2vpn forwarding counters
RP/0/RSP0/CPU0:router2#
RP/0/RSP0/CPU0:router2#
RP/0/RSP0/CPU0:router2#sh int TenGigE0/0/0/3.2
TenGigE0/0/0/3.2 is up, line protocol is up
  Interface state transitions: 1
  Hardware is VLAN sub-interface(s), address is 0024.98ea.038b
  Layer 2 Transport Mode
  MTU 1518 bytes, BW 10000000 Kbit (Max: 10000000 Kbit)
     reliability Unknown, txload Unknown, rxload Unknown
  Encapsulation 802.1Q Virtual LAN,
    Outer Match: Dot1Q VLAN 2
    Ethertype Any, MAC Match src any, dest any
  loopback not set,
  Last input 00:00:00, output 00:00:00
  Last clearing of "show interface" counters 00:00:27
     1000 packets input, 122000 bytes
     0 input drops, 0 queue drops, 0 input errors
     1002 packets output, 122326 bytes
     0 output drops, 0 queue drops, 0 output errors

RP/0/RSP0/CPU0:router2#sh l2vpn xconnect detail

Group test, XC p2p2, state is up; Interworking none
  AC: TenGigE0/0/0/3.2, state is up
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1500; XC ID 0x1080001; interworking none
    Statistics:
      packets: received 1001, sent 1002
      bytes: received 118080, sent 118318
      drops: illegal VLAN 0, illegal length 0
  AC: GigabitEthernet0/1/0/1, state is up
    Type Ethernet
    MTU 1500; XC ID 0x1880003; interworking none
    Statistics:
      packets: received 1002, sent 1001
      bytes: received 114310, sent 114076

```

As expected, the number of packets received on TenGigE0/0/0/3.2 matches the number of packets sent on GigabitEthernet0/1/0/1 and vice versa.

#### 3.1.2.2 Subinterface with Encapsulation

Instead of the main interface on GigabitEthernet0/1/0/1, you can use a subinterface with encapsulation default in order to catch all frames or with encapsulation untagged in order to match only untagged frames:

```
RP/0/RSP0/CPU0:router2#sh run interface GigabitEthernet0/1/0/1.1
interface GigabitEthernet0/1/0/1.1 l2transport
 encapsulation untagged

RP/0/RSP0/CPU0:router2#sh run int TenGigE0/0/0/3.2
interface TenGigE0/0/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric

RP/0/RSP0/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p3
   interface TenGigE0/0/0/3.2
   interface GigabitEthernet0/1/0/1.1

```
#### 3.1.2.3 Ingress Direction on GigabitEthernet0/1/0/1.1

Rather than pop tag 2 in the ingress direction on TenGigE0/0/0/3.2, you can push tag 2 in the ingress direction on GigabitEthernet0/1/0/1.1 and not do anything on TenGigE0/0/0/3.2:

```
RP/0/RSP0/CPU0:router2#sh run int  TenGigE0/0/0/3.2
interface TenGigE0/0/0/3.2 l2transport
 encapsulation dot1q 2

RP/0/RSP0/CPU0:router2#sh run interface GigabitEthernet0/1/0/1.1
interface GigabitEthernet0/1/0/1.1 l2transport
 encapsulation untagged
 rewrite ingress tag push dot1q 2 symmetric

RP/0/RSP0/CPU0:router2#sh run int TenGigE0/0/0/3.2
interface TenGigE0/0/0/3.2 l2transport
 encapsulation dot1q 2

RP/0/RSP0/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p3
   interface TenGigE0/0/0/3.2
   interface GigabitEthernet0/1/0/1.1
```

Thus, you can see that the EVC model with the **encapsulation** and **rewrite** commands gives you great flexibility to match and manipulate VLAN tags.

### 3.2 Virtual Private Wire Services

#### 3.2.1 Overview

Virtual Private Wire Services (VPWS), also known as Ethernet over MPLS (EoMPLS), allow two L2VPN Provider Edge (PE) devices to tunnel the L2VPN traffic over an MPLS cloud. The two L2VPN PEs are typically connected at two different sites with an MPLS core between them. The two ACs connected at each L2VPN PE are linked by a PW over the MPLS network, which is the MPLS PW.

![Virtual Private Wire Services Overview](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-12.jpeg)

Each PE needs to have an MPLS label in order to reach the loopback of the remote PE. This label, usually called the Interior Gateway Protocol (IGP) label, can be learned through the MPLS Label Distribution Protocol (LDP) or MPLS Traffic Engineering (TE).

The two PEs establish a targeted MPLS LDP session between themselves so they can establish and control the status of the PW. One PE advertises to the other PE the MPLS label for PW identification.

**Note**: While BGP can be used for signaling, it is not covered in this document.

The traffic received by router2 on its local AC is encapsulated in an MPLS label stack:

* The outer MPLS label is the IGP label to reach the loopback of router3. This could be the implicit-null label if the labels are directly connected; this means that no IGP label would be appended.
* The inner MPLS label is the PW label advertised by router3 through the targeted LDP session.
* There can be a PW control word after the MPLS labels, depending on the configuration and the type of encapsulation. The control word is not used by default on Ethernet interfaces and must be explicitly configured when needed.
* The transported L2 frame follows in the packet.
* Some VLAN tags are transported over the PW, depending on the configuration and the PW type.

The penultimate hop, just before router3 in the MPLS core, pops the IGP label or replaces it with an explicit null label. Thus, the top meaningful label on the frame received by router3 is the PW label that router3 signaled to router2 for the PW. So, router3 knows that traffic received with that MPLS label can be switched to the AC connected to router4.

In the previous example, you can first check whether each L2VPN has an MPLS label for the loopback of the remote PE. This is an example of how to check labels on router2:

```
RP/0/RSP1/CPU0:router2#sh mpls forwarding prefix 10.0.0.11/32
Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes
Label  Label       or ID              Interface                    Switched
------ ----------- ------------------ ------------ --------------- ------------
16008  16009       10.0.0.11/32       Te0/0/0/1    10.0.23.2       681260

```

The AC configuration is still the same:

```
RP/0/RSP1/CPU0:router2#sh run int gig 0/0/0/1.2
Wed May  1 13:56:07.668 CEST
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2

```

Because there is no **rewrite ingress pop** command, the incoming VLAN tag 2 is transported over the PW. See Type 4 and 5 PWs for details.

The L2VPN configuration specifies the local AC and the remote L2VPN PE with a PW ID that must match on each side and must be unique for each neighbor:

```
RP/0/RSP1/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p4
   interface GigabitEthernet0/0/0/1.2
   neighbor 10.0.0.11 pw-id 222

```

The corresponding configuration on router3 is:

```
RP/0/RSP0/CPU0:router3#sh run int gig 0/1/0/3.2
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
!

RP/0/RSP0/CPU0:router3#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p4
   interface GigabitEthernet0/1/0/3.2
   neighbor 10.0.0.13 pw-id 222

```

Use the **show l2vpn xconnect detail** command in order to view details on the cross connect:

```
RP/0/RSP1/CPU0:router2#sh l2vpn xconnect group test xc-name p2p4 detail

Group test, XC p2p4, state is up; Interworking none
  AC: GigabitEthernet0/0/0/1.2, state is up
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1504; XC ID 0x840006; interworking none
    Statistics:
      packets: received 186, sent 38448
      bytes: received 12644, sent 2614356
      drops: illegal VLAN 0, illegal length 0
  PW: neighbor 10.0.0.11, PW ID 222, state is up ( established )
    PW class not set, XC ID 0xc0000004
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.13
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ -----------------------------
      Label        16026                          16031
      Group ID     0x4000280                      0x6000180
      Interface    GigabitEthernet0/0/0/1.2       GigabitEthernet0/1/0/3.2
      MTU          1504                           1504
      Control word disabled                       disabled
      PW type      Ethernet                       Ethernet
      VCCV CV type 0x2                            0x2
                   (LSP ping verification)        (LSP ping verification)
      VCCV CC type 0x6                            0x6
                   (router alert label)           (router alert label)
                   (TTL expiry)                   (TTL expiry)
      ------------ ------------------------------ -----------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    MIB cpwVcIndex: 3221225476
    Create time: 30/04/2013 16:30:58 (21:31:00 ago)
    Last time status changed: 30/04/2013 16:36:42 (21:25:16 ago)
    Statistics:
      packets: received 38448, sent 186
      bytes: received 2614356, sent 12644

```

In this configuration, note that:

* The maximum transmission unit (MTU) of the AC is 1504 because the incoming tag on the AC is not popped. The MTU must match on each side, or the PW does not come up.
* 186 packets were received on the AC and were sent on the PW as expected.
* 38448 packets were received on the PW and were sent on the AC as expected.
* The local label on router2 is 16026 and is the label that router3 uses as the inner label. The packets are received on router2 with that MPLS label as the top label because the IGP label has been popped by the penultimate MPLS hop. Router2 knows that incoming frames with that PW label can be switched to the AC Gi 0/0/0/1.2:

```
RP/0/RSP1/CPU0:router2#sh mpls forwarding labels 16026
Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes
Label  Label       or ID              Interface                    Switched
------ ----------- ------------------ ------------ --------------- ------------
16026  Pop         PW(10.0.0.11:222)  Gi0/0/0/1.2  point2point     2620952

```
#### 3.2.2 PW and AC Coupled Status

In a point-to-point cross connect, the AC and the PW are coupled. So, if the AC goes down, the L2VPN PE signals via LDP to the remote PE that the PW status can be down. This triggers convergence when PW redundancy is configured. See the Redundancy section for details.

In this example, the AC is down on router2 and is sending the AC Down PW status to router3:

```
RP/0/RSP1/CPU0:router2#sh l2vpn xconnect group test xc-name p2p4 detail
Wed May  1 23:38:55.542 CEST

Group test, XC p2p4, state is down; Interworking none
  AC: GigabitEthernet0/0/0/1.2, state is down
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1504; XC ID 0x840006; interworking none
    Statistics:
      packets: received 186, sent 38544
      bytes: received 12644, sent 2620884
      drops: illegal VLAN 0, illegal length 0
  PW: neighbor 10.0.0.11, PW ID 222, state is down ( remote standby )
    PW class not set, XC ID 0xc0000004
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.13
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ -----------------------------
      Label        16026                          16031
      Group ID     0x4000280                      0x6000180
      Interface    GigabitEthernet0/0/0/1.2       GigabitEthernet0/1/0/3.2
      MTU          1504                           1504
      Control word disabled                       disabled
      PW type      Ethernet                       Ethernet
      VCCV CV type 0x2                            0x2
                   (LSP ping verification)        (LSP ping verification)
      VCCV CC type 0x6                            0x6
                   (router alert label)           (router alert label)
                   (TTL expiry)                   (TTL expiry)
      ------------ ------------------------------ -----------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x6 (AC Down) in Notification message
    MIB cpwVcIndex: 3221225476
    Create time: 30/04/2013 16:30:58 (1d07h ago)
    Last time status changed: 01/05/2013 14:05:07 (09:33:47 ago)
    Statistics:
      packets: received 38544, sent 186
      bytes: received 2620884, sent 12644
```

Router3 knows that the PW can be down because the remote AC is down:

```
RP/0/RSP0/CPU0:router3#sh l2vpn xconnect group test xc-name p2p4 detail

Group test, XC p2p4, state is down; Interworking none
  AC: GigabitEthernet0/1/0/3.2, state is up
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1504; XC ID 0xc40003; interworking none
    Statistics:
      packets: received 38545, sent 186
      bytes: received 2620952, sent 12644
      drops: illegal VLAN 0, illegal length 0
  PW: neighbor 10.0.0.13, PW ID 222, state is down ( local ready )
    PW class not set, XC ID 0xc0000005
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.11
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ -----------------------------
      Label        16031                          16026
      Group ID     0x6000180                      0x4000280
      Interface    GigabitEthernet0/1/0/3.2       GigabitEthernet0/0/0/1.2
      MTU          1504                           1504
      Control word disabled                       disabled
      PW type      Ethernet                       Ethernet
      VCCV CV type 0x2                            0x2
                   (LSP ping verification)        (LSP ping verification)
      VCCV CC type 0x6                            0x6
                   (router alert label)           (router alert label)
                   (TTL expiry)                   (TTL expiry)
      ------------ ------------------------------ -----------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x6 (AC Down) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    MIB cpwVcIndex: 3221225477
    Create time: 30/04/2013 16:37:57 (1d07h ago)
    Last time status changed: 01/05/2013 14:11:33 (09:35:50 ago)
    Statistics:
      packets: received 186, sent 38545
      bytes: received 12644, sent 2620952
```
#### 3.2.3 Type 4 and Type 5 PWs

Two types of PWs can be used - type 4 and type 5.

* A type 4 PW is known as a VLAN-based PW. The ingress PE is not supposed to remove the incoming VLAN tags that are to be transported over the PW.

  On the EVC-based platforms such as the ASR 9000, the problem is that the incoming ACs can have a **rewrite** command that pops the incoming VLAN tags, so there can not be any VLAN tag to be transported over the PW. In order to address this possibility, the EVC platforms insert a dummy VLAN tag 0 on top of the frame for type 4 PWs. Type 4 PWs are configured with the **transport-mode vlan** command. The remote PE can be EVC-based and can understand that the top VLAN tag is the dummy tag to be stripped.

  However, if you use a type 4 PW between an EVC platform and a non-EVC platform, this can lead to interoperability problems. The non-EVC platform does not consider the top VLAN tag as the dummy VLAN tag and instead forwards the frame with the dummy VLAN tag 0 as the outer tag. The EVC platforms have the ability to manipulate the VLAN tags received on the incoming frame with the **rewrite** command. The results of that VLAN manipulation are transported over the type 4 PW with the extra dummy tag 0 on top.

  Recent Cisco IOS XR software releases offer the ability to use a type 4 PW without use of the dummy tag 0 with the **transport-mode vlan passthrough** command. The VLAN tag manipulation on the Ethernet Flow Point (EFP) must ensure that at least one tag remains because there must be a VLAN tag transported on a type 4 PW and because, in this case, there is no dummy tag that meets that requirement. The tags that remain on the frame after the incoming interface tag rewrite are transported transparently through the PW.

* A type 5 PW is known as an Ethernet port-based PW. The ingress PE transports frames received on a main interface or after the subinterface tags have been removed when the packet is received on a subinterface. There is no requirement to send a tagged frame over a type 5 PW, and no dummy tag is added by the EVC-based platforms. The EVC-based platforms have the ability to manipulate the VLAN tags received on the incoming frame with the **rewrite** command. The results of that VLAN manipulation are transported over the type 5 PW, whether tagged or untagged.

By default, the L2VPN PEs try to negotiate a type 5 PW, as seen in this example:

```
RP/0/RSP1/CPU0:router2#sh l2vpn xconnect group test det | i " PW type"
    PW type Ethernet, control word disabled, interworking none
      PW type      Ethernet                       Ethernet

```

The PW type Ethernet indicates a type 5 PW.

This is a sniffer capture of an ARP request sent by router1 and encapsulated by router2 over the PW to router3:

```
Frame 38: 82 bytes on wire (656 bits), 82 bytes captured (656 bits)
Ethernet II, Src: Cisco_2f:dc:04 (00:0b:60:2f:dc:04), Dst: Cisco_1e:93:50
   (00:24:f7:1e:93:50)
MultiProtocol Label Switching Header, Label: 16031, Exp: 0, S: 1, TTL: 251
Ethernet II, Src: Cisco_03:1f:46 (00:1d:46:03:1f:46), Dst: Broadcast
   (ff:ff:ff:ff:ff:ff)
802.1Q Virtual LAN, PRI: 0, CFI: 0, ID: 2
Address Resolution Protocol (request)
```

The MPLS label 16031 is the PW label advertised by router3. The sniffer capture has been taken between the penultimate hop and router3, so there is no IGP label.

The encapsulated Ethernet frame starts immediately after the PW label. There can be a PW control word, but it is not configured in this example.

Even if it is a type 5 PW, the incoming VLAN tag 2 received on the AC by router2 is transported because there is no **rewrite** command that pops it on the AC. The results that come from the AC after the rewrite processing are transported because there is no automatic tag popping on the EVC-based platforms. Notice that there is no dummy VLAN tag 0 with a type 5 PW.

If you configured with the **rewrite ingress tag pop 1 symmetric** command, there would be no VLAN tag transported over the PW.

Here is an example of a type 4 PW with configuration of a pw-class on router2 and router3.

**Note**: If you configure a type 4 on one side only, the PW stays down and reports **Error: PW type mismatched**.

```
l2vpn
 pw-class VLAN
  encapsulation mpls
   transport-mode vlan
  !
 !
 xconnect group test
  p2p p2p4
   neighbor 10.0.0.11 pw-id 222
    pw-class VLAN
   !
  !
 !
!

```

The PW type Ethernet VLAN indicates a type 4 PW.

```
RP/0/RSP1/CPU0:router2#sh l2vpn xconnect group test det | i " PW type"
    PW type Ethernet VLAN, control word disabled, interworking none
      PW type      Ethernet VLAN                  Ethernet VLAN

```

There is now a dummy tag 0 inserted on top of the frame being transported:

```
Frame 15: 86 bytes on wire (688 bits), 86 bytes captured (688 bits)
Ethernet II, Src: Cisco_2f:dc:04 (00:0b:60:2f:dc:04), Dst: Cisco_1e:93:50
   (00:24:f7:1e:93:50)
MultiProtocol Label Switching Header, Label: 16031, Exp: 0, S: 1, TTL: 251
Ethernet II, Src: Cisco_03:1f:46 (00:1d:46:03:1f:46), Dst: Broadcast
   (ff:ff:ff:ff:ff:ff)
802.1Q Virtual LAN, PRI: 0, CFI: 0, ID: 0
802.1Q Virtual LAN, PRI: 0, CFI: 0, ID: 2
Address Resolution Protocol (request)
```

The egress EVC-based PE removes the dummy tag and forwards the frame with the tag 2 on its local AC. The egress PE applies the local tag manipulation configured on its AC on the frame received on the PW. If its local AC is configured as **rewrite ingress tag pop 1 symmetric**, the configured tag must be pushed in the egress direction, so a new tag is pushed on top of the tag 2 received on the PW. The rewrite command is very flexible but you can carefully evaluate what you want to achieve at each side of the PW.

#### 3.2.4 Multi-segment PW

It is possible to have an L2VPN PE that has a PW, instead of a physical interface, as an AC:

![Multi-Segment PW](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-13.jpeg)

Router5 receives packets on the PW from router2 and switches the packets on its other PW to router3. So router5 is switching between PWs in order to create a multisegment PW between router2 and router3.

The configuration on router2 now points at router5 as the remote PE:

```
RP/0/RSP1/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p5
   interface GigabitEthernet0/0/0/1.2
   neighbor 10.0.0.12 pw-id 222
   !
  !
 !
!

```

The configuration on router5 is basic:

```
RP/0/RSP0/CPU0:router5#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p5
   neighbor 10.0.0.11 pw-id 223
   !
   neighbor 10.0.0.13 pw-id 222
   !
   description R2-R5-R3
  !
 !
!

```

The **description** command is optional and is inserted in a PW switching Type Length Value (TLV) that is sent by router5 to each remote PE (router2 and router3). The **description** is useful when you need to troubleshoot a PW problem when there is a router in the middle that does PW switching.

Enter the **sh l2vpn xconnect** command in order to review the PW switching TLV:

```
RP/0/RSP0/CPU0:router5#sh l2vpn xconnect group test det

Group test, XC p2p5, state is down; Interworking none
  Description: R2-R5-R3
  PW: neighbor 10.0.0.11, PW ID 223, state is down ( provisioned )
    PW class not set, XC ID 0xc0000002
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.12
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ -----------------------------
      Label        16042                          unknown
      Group ID     0x4000280                      0x0
      Interface    GigabitEthernet0/0/0/1.2       unknown
      MTU          1504                           unknown
      Control word disabled                       unknown
      PW type      Ethernet                       unknown
      VCCV CV type 0x2                            0x0
                                                  (none)
                   (LSP ping verification)
      VCCV CC type 0x4                            0x0
                                                  (none)
                   (TTL expiry)
      ------------ ------------------------------ -----------------------------
    Outgoing PW Switching TLVs (Label Mapping message):
      Local IP Address: 10.0.0.12, Remote IP Address: 10.0.0.13, PW ID: 222
      Description: R1-R5-R3
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Statistics for MS-PW:
      packets: received 0
      bytes: received 0
    MIB cpwVcIndex: 3221225474
    Create time: 02/05/2013 15:37:53 (00:34:43 ago)
    Last time status changed: 02/05/2013 16:12:30 (00:00:06 ago)
    Last time PW went down: 02/05/2013 16:12:30 (00:00:06 ago)
  PW: neighbor 10.0.0.13, PW ID 222, state is up ( established )
    PW class not set, XC ID 0xc0000001
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.12
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ -----------------------------
      Label        16043                          16056
      Group ID     0x6000180                      0x4000280
      Interface    GigabitEthernet0/1/0/3.2       GigabitEthernet0/0/0/1.2
      MTU          1504                           1504
      Control word disabled                       disabled
      PW type      Ethernet                       Ethernet
      VCCV CV type 0x2                            0x2
                   (LSP ping verification)        (LSP ping verification)
      VCCV CC type 0x4                            0x6
                                                  (router alert label)
                   (TTL expiry)                   (TTL expiry)
      ------------ ------------------------------ -----------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing PW Switching TLVs (Label Mapping message):
      Local IP Address: 10.0.0.12, Remote IP Address: 10.0.0.11, PW ID: 223
      Description: R2-R5-R3
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Statistics for MS-PW:
      packets: received 0
      bytes: received 0
    MIB cpwVcIndex: 0
    Create time: 02/05/2013 15:37:53 (00:34:43 ago)
    Last time status changed: 02/05/2013 16:12:35 (00:00:01 ago)
    Last time PW went down: 02/05/2013 16:12:30 (00:00:06 ago)

```

Router5 sends a PW switching TLV to router3 with the details of its PW to router2 and sends a PW switching TLV to router2 with the details of its PW to router3.

#### 3.2.5 Redundancy

A point-to-point PW can be used to connect two sites, but these two sites can remain connected in case of a PE or AC failure.

#### 3.2.5.1 Core Redundancy

If you make any topology change that affects rerouting in the MPLS core, the MPLS PW inherits the new path immediately.

#### 3.2.5.2 Bundle Over PWs

A Customer Edge (CE) device can be connected to the PE through an Ethernet bundle in order to provide link redundancy if there is a bundle member link failure between the CE and the PE. The bundle remains up even if one bundle link member goes down. This does not provide PE redundancy because a PE failure brings the entire bundle down.

One method for redundancy is to have multiple circuits transported by point-to-point PWs. Each circuit is a member of an Ethernet bundle between two CEs:

![Bundle over PWs](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-14.jpeg)

The PE does not terminate the bundle and instead transports frames transparently over the PW, including the Link Aggregation Control Protocol (LACP) frames that CEs exchange between them.

With this design, the loss of an AC or a PE causes a bundle member goes down, but the bundle remains up.

**Note**: LACP BPDUs were not transported over L2VPN by the ASR 9000 in releases earlier than Cisco IOS XR Software Release 4.2.1.

The CE is still a single point of failure in this design. Other redundancy features that can be used on the CE include:

* Multichassis Link Aggregation Group (MC-LAG)
* ASR 9000 Network Virtualization (nV) clustering
* Virtual Switching System (VSS) on Cisco IOS switches
* Virtual Port Channel (vPC) on Cisco Nexus Switches

From the perspective of the PE, there is a simple point-to-point connection between an AC and an MPLS PW.

#### 3.2.5.3 PW Redundancy

PEs can also provide redundancy with a feature called PW Redundancy.

![PW Redundancy](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-15.jpeg)

Router2 has a primary PW to router3. Traffic from router1 to router6 flows over that primary PW under normal circumstances. Router2 also has a backup PW to router4 in hot standby but, under normal circumstances, no traffic flows over that PW.

If there is a problem with the primary PW, with the remote PE of the primary PW (router3), or with the AC on the remote PE (router3), router2 immediately activates the backup PW, and the traffic starts flowing through it. Traffic moves back to primary PW when the problem is resolved.

The configuration on router2 is:

```
RP/0/RSP0/CPU0:router2#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p6
   interface GigabitEthernet0/1/0/3.2
   neighbor 10.0.0.13 pw-id 222
    backup neighbor 10.0.0.14 pw-id 222
    !
   !
  !
 !
!

```

The standard configuration on router3 and router4 is:

```
RP/0/RSP1/CPU0:router3#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p6
   interface GigabitEthernet0/0/0/1.2
   neighbor 10.0.0.11 pw-id 222
   !
  !
 !
!
```

Under stable conditions, the PW to router3 is active, and the PW to router4 is in a standby state:

```
RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                Segment 1              Segment 2
Group      Name    ST   Description   ST     Description          ST
---------------------   ------------------   ---------------------------
test       p2p6    UP   Gi0/1/0/3.2   UP     10.0.0.13     222    UP
                                             Backup
                                             10.0.0.14     222    SB
------------------------------------------------------------------------
RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test det

Group test, XC p2p6, state is up; Interworking none
  AC: GigabitEthernet0/1/0/3.2, state is up
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1504; XC ID 0xc40003; interworking none
    Statistics:
      packets: received 51412, sent 25628
      bytes: received 3729012, sent 1742974
      drops: illegal VLAN 0, illegal length 0
  PW: neighbor 10.0.0.13, PW ID 222, state is up ( established )
    PW class not set, XC ID 0xc0000005
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.11
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                      Remote
      ------------ -------------------------- --------------------------
      Label        16049                      16059
      Group ID     0x6000180                  0x4000280
      Interface    GigabitEthernet0/1/0/3.2   GigabitEthernet0/0/0/1.2
      MTU          1504                       1504
      Control word disabled                   disabled
      PW type      Ethernet                   Ethernet
      VCCV CV type 0x2                        0x2
                   (LSP ping verification)    (LSP ping verification)
      VCCV CC type 0x6                        0x6
                   (router alert label)       (router alert label)
                   (TTL expiry)               (TTL expiry)
      ------------ -------------------------- --------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    MIB cpwVcIndex: 3221225477
    Create time: 03/05/2013 15:04:03 (00:21:26 ago)
    Last time status changed: 03/05/2013 15:17:34 (00:07:55 ago)
    MAC withdraw message: send 0 receive 0
    Statistics:
      packets: received 25628, sent 51412
      bytes: received 1742974, sent 3729012

  Backup PW:
  PW: neighbor 10.0.0.14, PW ID 222, state is standby ( all ready )
    Backup for neighbor 10.0.0.13 PW ID 222 ( inactive )
    PW class not set, XC ID 0xc0000006
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.11
    PW type Ethernet, control word disabled, interworking none
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                       Remote
      ------------ --------------------------- --------------------------
      Label        16050                       289971
      Group ID     0x6000180                   0x4000100
      Interface    GigabitEthernet0/1/0/3.2    GigabitEthernet0/0/0/1.2
      MTU          1504                        1504
      Control word disabled                    disabled
      PW type      Ethernet                    Ethernet
      VCCV CV type 0x2                         0x2
                   (LSP ping verification)     (LSP ping verification)
      VCCV CC type 0x6                         0x6
                   (router alert label)        (router alert label)
                   (TTL expiry)                (TTL expiry)
      ------------ --------------------------- --------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x20 (Standby) in Notification message
    MIB cpwVcIndex: 3221225478
    Create time: 03/05/2013 15:04:03 (00:21:26 ago)
    Last time status changed: 03/05/2013 15:17:34 (00:07:55 ago)
    MAC withdraw message: send 0 receive 0
RP/0/RSP0/CPU0:router2#
```

Because the AC status and the PW status are coupled, router3 signals AC down to router2 when the AC on router3 goes down. Router2 brings its primary PW down and activates the backup PW:

```
RP/0/RSP0/CPU0:May  3 15:34:08.772 : l2vpn_mgr[1121]: %L2-L2VPN_PW-3-UPDOWN :
   Pseudowire with address 10.0.0.13, id  222, state is Down
RP/0/RSP0/CPU0:May  3 15:34:08.772 : l2vpn_mgr[1121]: %L2-L2VPN_PW-3-UPDOWN :
   Pseudowire with address 10.0.0.14, id  222, state is Up

RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1               Segment 2
Group      Name       ST   Description    ST       Description            ST
------------------------   ---------------------   ---------------------------
test       p2p6       UP   Gi0/1/0/3.2    UP       10.0.0.13       222    DN
                                                   Backup
                                                   10.0.0.14       222    UP
------------------------------------------------------------------------------
RP/0/RSP0/CPU0:router2#sh l2vpn xconnect group test det

Group test, XC p2p6, state is up; Interworking none
  AC: GigabitEthernet0/1/0/3.2, state is up
    Type VLAN; Num Ranges: 1
    VLAN ranges: [2, 2]
    MTU 1504; XC ID 0xc40003; interworking none
    Statistics:
      packets: received 51735, sent 25632
      bytes: received 3752406, sent 1743230
      drops: illegal VLAN 0, illegal length 0
  PW: neighbor 10.0.0.13, PW ID 222, state is down ( local ready )
    PW class not set, XC ID 0xc0000005
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.11
    PW type Ethernet, control word disabled, interworking none
    PW backup disable delay 0 sec
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                          Remote
      ------------ ------------------------------ ---------------------------
      Label        16049                          16059
      Group ID     0x6000180                      0x4000280
      Interface    GigabitEthernet0/1/0/3.2       GigabitEthernet0/0/0/1.2
      MTU          1504                           1504
      Control word disabled                       disabled
      PW type      Ethernet                       Ethernet
      VCCV CV type 0x2                            0x2
                   (LSP ping verification)        (LSP ping verification)
      VCCV CC type 0x6                            0x6
                   (router alert label)           (router alert label)
                   (TTL expiry)                   (TTL expiry)
      ------------ ------------------------------ ---------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x6 (AC Down) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    MIB cpwVcIndex: 3221225477
    Create time: 03/05/2013 15:04:03 (00:30:14 ago)
    Last time status changed: 03/05/2013 15:34:08 (00:00:09 ago)
    MAC withdraw message: send 0 receive 0

  Backup PW:
  PW: neighbor 10.0.0.14, PW ID 222, state is up ( established )
    Backup for neighbor 10.0.0.13 PW ID 222 ( active )
    PW class not set, XC ID 0xc0000006
    Encapsulation MPLS, protocol LDP
    Source address 10.0.0.11
    PW type Ethernet, control word disabled, interworking none
    Sequencing not set

    PW Status TLV in use
      MPLS         Local                     Remote
      ------------ ------------------------- -----------------------------
      Label        16050                     289971
      Group ID     0x6000180                 0x4000100
      Interface    GigabitEthernet0/1/0/3.2  GigabitEthernet0/0/0/1.2
      MTU          1504                      1504
      Control word disabled                  disabled
      PW type      Ethernet                  Ethernet
      VCCV CV type 0x2                       0x2
                   (LSP ping verification)   (LSP ping verification)
      VCCV CC type 0x6                       0x6
                   (router alert label)      (router alert label)
                   (TTL expiry)              (TTL expiry)
      ------------ ------------------------- -----------------------------
    Incoming Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    Outgoing Status (PW Status TLV):
      Status code: 0x0 (Up) in Notification message
    MIB cpwVcIndex: 3221225478
    Create time: 03/05/2013 15:04:03 (00:30:14 ago)
    Last time status changed: 03/05/2013 15:34:08 (00:00:09 ago)
    MAC withdraw message: send 0 receive 0
    Statistics:
      packets: received 25632, sent 51735
      bytes: received 1743230, sent 3752406
RP/0/RSP0/CPU0:router2#

```

When the AC on router3 comes back up, router2 reactivates the primary PW to router3, and the PW to router4 goes back to a standby state.

The backup PW is also activated when router3 goes down, and router2 loses the route to its loopback.

The next logical step is to introduce two-way PW redundancy with two PEs at each site:

![Two-Way PW Redundancy](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-16.jpeg)

However, this full mesh of PWs encounters a problem when two PWs are active at the same time a loop is introduced into the network. The loop needs to be broken, generally by use of the Spanning Tree Protocol (STP). However, you do not want spanning tree instability at one site to propagate to the other site. Thus, it is better not to run spanning tree on these PWs and not to merge the spanning tree between the two sites . It is simpler if there is just one logical link between the two sites so that no spanning tree is required.

One solution is to use an MC-LAG bundle between the two PEs at one site and their local CE. Only one of the two PEs has its bundle members active so that its PW to the remote site is active. The other PE has its bundle members in standby state and has its PW to the remote site down. With only one PW active between the two sites, no loop is introduced. The PE with the active PW also has a standby PW to the second PE at the remote site.

Under stable conditions, the active bundle members are on router2 and router3, and the active PW is between them. This is the configuration on router3:

```
RP/0/RSP1/CPU0:router3#sh run redundancy
redundancy
 iccp
  group 2
   mlacp node 1
   mlacp system mac 0200.0000.0002
   mlacp system priority 1
   mlacp connect timeout 0
   member
    neighbor 10.0.0.14
   !
   backbone
    interface TenGigE0/0/0/0
    interface TenGigE0/0/0/1
   !
   isolation recovery-delay 300
  !
 !
!

RP/0/RSP1/CPU0:router3#sh run int bundle-ether 222
interface Bundle-Ether222
 lacp switchover suppress-flaps 100
 mlacp iccp-group 2
 mlacp switchover type revertive
 mlacp switchover recovery-delay 40
 mlacp port-priority 1
 mac-address 0.0.2
 bundle wait-while 0
 bundle maximum-active links 1
 load-interval 30
!

RP/0/RSP1/CPU0:router3#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p7
   interface Bundle-Ether222.2
   neighbor 10.0.0.11 pw-id 222
    backup neighbor 10.0.0.12 pw-id 222
    !
   !
  !
 !
!

RP/0/RSP1/CPU0:router3#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1               Segment 2
Group      Name       ST   Description    ST       Description            ST
------------------------   ---------------------   ---------------------------
test       p2p7       UP   BE222.2        UP       10.0.0.11       222    UP
                                                   Backup
                                                   10.0.0.12       222    DN
------------------------------------------------------------------------------

RP/0/RSP1/CPU0:router3#sh bundle bundle-ether 222

Bundle-Ether222
  Status:                                    Up
  Local links :   1 / 0 / 1
  Local bandwidth :     1000000 (1000000) kbps
  MAC address (source):                      0000.0000.0002 (Configured)
  Inter-chassis link:                        No
  Minimum active links / bandwidth:          1 / 1 kbps
  Maximum active links:                      1
  Wait while timer:                          Off
  Load balancing:                            Default
  LACP:                                      Operational
    Flap suppression timer:                  100 ms
    Cisco extensions:                        Disabled
  mLACP:                                     Operational
    ICCP Group:                              2
    Role:                                    Active
    Foreign links :       0 / 1
    Switchover type:                         Revertive
    Recovery delay:                          40 s
    Maximize threshold:                      1 link
  IPv4 BFD:                                  Not configured

  Port                  Device           State     Port ID         B/W, kbps
  --------------------  ---------------  --------  --------------  ----------
  Gi0/0/0/1             Local            Active    0x8001, 0x9001     1000000
      Link is Active
  Gi0/0/0/1             10.0.0.14        Standby   0x8002, 0xa002     1000000
      Link is marked as Standby by mLACP peer

```

On router5, the local bundle member and the primary PW to router2 are in standby state, and the backup PW to router4 is down:

```
RP/0/RSP1/CPU0:router5#sh run redundancy
redundancy
 iccp
  group 2
   mlacp node 2
   mlacp system mac 0200.0000.0002
   mlacp system priority 1
   mlacp connect timeout 0
   member
    neighbor 10.0.0.13
   !
   backbone
    interface TenGigE0/1/0/0
    interface TenGigE0/1/0/1
   !
   isolation recovery-delay 300
  !
 !
!

RP/0/RSP1/CPU0:router5#sh run int bundle-ether 222
interface Bundle-Ether222
 lacp switchover suppress-flaps 100
 mlacp iccp-group 2
 mlacp switchover type revertive
 mlacp switchover recovery-delay 40
 mac-address 0.0.2
 bundle wait-while 0
 bundle maximum-active links 1
 load-interval 30
!

RP/0/RSP1/CPU0:router5#sh run l2vpn xconnect group test
l2vpn
 xconnect group test
  p2p p2p7
   interface Bundle-Ether222.2
   neighbor 10.0.0.11 pw-id 222
    backup neighbor 10.0.0.12 pw-id 222
    !
   !
  !
 !
!

RP/0/RSP1/CPU0:router5#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1                Segment 2
Group      Name       ST   Description     ST       Description            ST
------------------------   ----------------------   --------------------------
test       p2p7       DN   BE222.2         UP       10.0.0.11       222    SB
                                                    Backup
                                                    10.0.0.12       222    DN
------------------------------------------------------------------------------

RP/0/RSP1/CPU0:router5#sh bundle bundle-ether 222

Bundle-Ether222
  Status:                                    mLACP hot standby
  Local links :   0 / 1 / 1
  Local bandwidth :     0 (0) kbps
  MAC address (source):                      0000.0000.0002 (Configured)
  Inter-chassis link:                        No
  Minimum active links / bandwidth:          1 / 1 kbps
  Maximum active links:                      1
  Wait while timer:                          Off
  Load balancing:                            Default
  LACP:                                      Operational
    Flap suppression timer:                  100 ms
    Cisco extensions:                        Disabled
  mLACP:                                     Operational
    ICCP Group:                              2
    Role:                                    Standby
    Foreign links :       1 / 1
    Switchover type:                         Revertive
    Recovery delay:                          40 s
    Maximize threshold:                      1 link
  IPv4 BFD:                                  Not configured

  Port                  Device        State        Port ID         B/W, kbps
  --------------------  ------------  -----------  --------------  ----------
  Gi0/0/0/1             Local         Standby      0x8002, 0xa002     1000000
      mLACP peer is active
  Gi0/0/0/1             10.0.0.13     Active       0x8001, 0x9001     1000000
      Link is Active

```

On router6, the bundle member to router3 is active, while the bundle member to router5 is in standby state:

```
router6#sh etherchannel summary
Flags:  D - down        P - bundled in port-channel
        I - stand-alone s - suspended
        H - Hot-standby (LACP only)
        R - Layer3      S - Layer2
        U - in use      f - failed to allocate aggregator

        M - not in use, minimum links not met
        u - unsuitable for bundling
        w - waiting to be aggregated
        d - default port

Number of channel-groups in use: 1
Number of aggregators:           1

Group  Port-channel  Protocol    Ports
------+-------------+-----------+-----------------------------------------------
2      Po2(SU)         LACP      Gi0/1(P)    Gi0/2(w)

```

When the bundle member on router3 goes down, router6 has its active member to router5:

```
router6#sh etherchannel summary
Flags:  D - down        P - bundled in port-channel
        I - stand-alone s - suspended
        H - Hot-standby (LACP only)
        R - Layer3      S - Layer2
        U - in use      f - failed to allocate aggregator

        M - not in use, minimum links not met
        u - unsuitable for bundling
        w - waiting to be aggregated
        d - default port

Number of channel-groups in use: 1
Number of aggregators:           1

Group  Port-channel  Protocol    Ports
------+-------------+-----------+-----------------------------------------------
2      Po2(SU)         LACP      Gi0/1(D)    Gi0/2(P)

```

Since the bundle-ether222 is down on router5, the coupled PW to router2 goes down at the same time:

```
RP/0/RSP1/CPU0:router3#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1              Segment 2
Group      Name       ST   Description   ST       Description            ST
------------------------   --------------------   ---------------------------
test       p2p7       DN   BE222.2       DN       10.0.0.11       222    DN
                                                  Backup
                                                  10.0.0.12       222    DN
-----------------------------------------------------------------------------

```

Router2 detects that its PW to router3 is down and activates its backup PW to router5:

```
RP/0/RSP0/CPU0:router2#sh l2vpn xconnect
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1              Segment 2
Group      Name       ST   Description   ST       Description            ST
------------------------   --------------------   ---------------------------
test       p2p7       UP   BE222.2       UP       10.0.0.13       222    DN
                                                  Backup
                                                  10.0.0.14       222    UP
-----------------------------------------------------------------------------

```

Router5 has its bundle member active as well as its primary PW to router2:

```
RP/0/RSP1/CPU0:router5#sh bundle bundle-ether 222

Bundle-Ether222
  Status:                                    Up
  Local links :   1 / 0 / 1
  Local bandwidth :     1000000 (1000000) kbps
  MAC address (source):                      0000.0000.0002 (Configured)
  Inter-chassis link:                        No
  Minimum active links / bandwidth:          1 / 1 kbps
  Maximum active links:                      1
  Wait while timer:                          Off
  Load balancing:                            Default
  LACP:                                      Operational
    Flap suppression timer:                  100 ms
    Cisco extensions:                        Disabled
  mLACP:                                     Operational
    ICCP Group:                              2
    Role:                                    Active
    Foreign links :       0 / 1
    Switchover type:                         Revertive
    Recovery delay:                          40 s
    Maximize threshold:                      1 link
  IPv4 BFD:                                  Not configured

  Port                  Device       State        Port ID         B/W, kbps
  --------------------  -----------  -----------  --------------  ----------
  Gi0/0/0/1             Local        Active       0x8002, 0xa002     1000000
      Link is Active
  Gi0/0/0/1             10.0.0.13    Configured   0x8003, 0x9001     1000000
      Link is down

RP/0/RSP1/CPU0:router5#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1                Segment 2
Group      Name       ST   Description     ST       Description            ST
------------------------   ----------------------   ---------------------------
test       p2p7       UP   BE222.2         UP       10.0.0.11       222    UP
                                                    Backup
                                                    10.0.0.12       222    DN
-------------------------------------------------------------------------------
```
#### 3.2.5.4 ASR 9000 nV Edge Cluster

The previous design based on MC-LAG and PW redundancy works fine for redundancy but, because some bundle members are in standby state, they do not carry traffic under steady conditions.

If you want all bundle members active, even under stable conditions, you can use an ASR 9000 cluster with bundle members from the CE connected to each rack of the PE:

![ASR 9000nV Edge Cluster](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-17.jpeg)

This design offers redundancy against a bundle member link failure between the CE and the PE, a rack failure, and a core link failure - as long as the cluster is dually attached to the MPLS core and there is redundancy in the core. The two racks do not have to be co-located and could be at different locations. Inter-rack links are not represented in this diagram.

If you want redundancy on the CE, you can use a multichassis solution for the CE:

* MC-LAG
* ASR 9000 nV clustering
* VSS
* vPC

The configuration on the ASR 9000 cluster is very basic:

```
interface TenGigE0/0/0/8
 bundle id 222 mode on
!
interface TenGigE1/0/0/8
 bundle id 222 mode on
!
interface Bundle-Ether222
!
interface Bundle-Ether222.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
l2vpn
 xconnect group test
  p2p p2p8
   interface Bundle-Ether222.2
   neighbor 10.0.0.13 pw-id 8
   !
  !
 !
!

```

Cisco recommends you configure a static LACP system MAC address and a bundle MAC address in order to avoid a MAC address change caused by a designated shelf controller switchover. This example shows how to find the addresses:

```
RP/1/RSP0/CPU0:router2#sh int bundle-ether 222 | i address is
  Hardware is Aggregated Ethernet interface(s), address is 0024.f71e.d309
  Internet address is Unknown

RP/1/RSP0/CPU0:router2#
RP/1/RSP0/CPU0:router2#conf
RP/1/RSP0/CPU0:router2(config)#int bundle-ether 222
RP/1/RSP0/CPU0:router2(config-if)#mac-address 0024.f71e.d309
RP/1/RSP0/CPU0:router2(config-if)#commit
RP/1/RSP0/CPU0:router2(config-if)#end
RP/1/RSP0/CPU0:router2#
RP/1/RSP0/CPU0:router2#sh lacp system-id

Priority  MAC Address
--------  -----------------
  0x8000  00-24-f7-1e-d3-05
RP/1/RSP0/CPU0:router2#
RP/1/RSP0/CPU0:router2#conf
RP/1/RSP0/CPU0:router2(config)#lacp system mac 0024.f71e.d305
RP/1/RSP0/CPU0:router2(config)#commit
RP/1/RSP0/CPU0:router2(config)#end

```

In summary, this is the bundle-ether 222 with a member on each rack (ten 0/0/0/8 on rack 0 and ten 1/0/0/8 on rack 1) and the bundle subinterface configured for a point-to-point cross connect:

```
RP/1/RSP0/CPU0:router2#sh l2vpn xconnect group test
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1                Segment 2
Group      Name       ST   Description     ST       Description            ST
------------------------   ----------------------   ---------------------------
test       p2p8       UP   BE222.2         UP       10.0.0.13       8      UP
-------------------------------------------------------------------------------
```
### 3.3 CDP

Cisco routers and switches usually send CDP packets without dot1q tags. There are multiple scenarios that determine what happens to these CDP packets when they are received by an IOS XR router configured for a cross connect:

![CDP](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-18.jpeg)

In this topology, router1 can see its local PE router2 as a CDP neighbor or the remote CE router4, depending on the configuration.

#### 3.3.1 CDP Not Enabled on Main Interface of L2VPN PE

The CDP packets from the L2VPN CE are transported over the cross connect. The two L2VPN CEs see each other (with use of the **show cdp neighbors** command) if the main interface is configured as l2transport or if there is a subinterface matching the untagged CDP frames.

This is an example of the main interface:

```
interface GigabitEthernet0/0/0/1
 l2transport
 !
!
l2vpn
 xconnect group test
  p2p p2p8
   interface GigabitEthernet0/0/0/1
   neighbor 10.0.0.11 pw-id 8
   !
  !
 !
!

```

This is an example of an untagged subinterface:

```
interface GigabitEthernet0/0/0/1.1 l2transport
 encapsulation untagged
!
l2vpn
 xconnect group test
  p2p p2p8
   interface GigabitEthernet0/0/0/1.1
   neighbor 10.0.0.11 pw-id 8
   !
  !
 !
!

```

In these two examples, the CDP packets are transported over the cross connect, and the CEs see each other as CDP neighbors. The CE does not see the PE as a CDP neighbor:

```
router1#sh cdp nei gigabitEthernet 0/1
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone,
                  D - Remote, C - CVTA, M - Two-port Mac Relay

Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
router4          Gig 0/1           168              R S   ME-3400G- Gig 0/1

```
#### 3.3.2 CDP Enabled on Main Interface of L2VPN PE

The PE processes the untagged CDP packets, and the PE and CE see each other as neighbors. However, the CE does not see the remote CE when CDP is enabled on the main interface of the L2VPN PE.

Note that:

* You cannot configure CDP on a main interface that is configured as l2transport.
* The PE intercepts the CDP packets when CDP is configured on the main non-l2transport interface. This occurs even if there is an l2transport subinterface configured to match the untagged CDP packets (with use of the **encapsulation untagged** or **encapsulation default** commands). CDP packets are not transported to the remote site in this case.

### 3.4 Spanning Tree

If the L2VPN CE is an Ethernet switch and is sending spanning tree BPDUs to the L2VPN PE, these BPDUs are handled as regular traffic and are transported according to the L2VPN configuration.

STP or MST BPDUs are sent untagged and are transported through the point-to-point cross connect if the main interface is configured as l2transport or if there is a l2transport subinterface configured with the **encapsulation untagged** or **encapsulation default** commands.

Per VLAN Spanning Tree Plus (PVST+) or Rapid PVST+ (PVRST+) send tagged BPDUs that are transported if there is a l2transport subinterface that matches the dot1q tag of the BPDUs.

This is an example topology:

![Spanning Tree](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-19.jpeg)

Router2 and router3 are transporting untagged frames and frames with dot1q tag 2:

```
interface GigabitEthernet0/0/0/1.1 l2transport
 encapsulation untagged
!
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
l2vpn
 xconnect group test
  p2p p2p8
   interface GigabitEthernet0/0/0/1.2
   neighbor 10.0.0.11 pw-id 8
   !
  !
  p2p p2p9
   interface GigabitEthernet0/0/0/1.1
   neighbor 10.0.0.11 pw-id 9
   !
  !
 !
!

```

Switch1 receives the untagged BPDUs in VLAN 1 and the tagged BPDUs in VLAN2 from switch4; its root port is on Gi0/1 towards switch4:

```
switch1#sh spanning-tree vlan 1

VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    32768
             Address     0024.985e.6a00
             Cost        8
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 300

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/1               Root FWD 4         128.1    P2p

switch1#sh spanning-tree vlan 2

VLAN0002
  Spanning tree enabled protocol ieee
  Root ID    Priority    32770
             Address     0019.552b.b580
             Cost        4
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32770  (priority 32768 sys-id-ext 2)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 15

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/1               Root FWD 4         128.1    P2p

```

With this configuration, the spanning tree domain at site A is merged with the spanning tree domain at side B. A potential problem is that spanning tree instability at one site can propagate to the other site.

If you are confident that one site is connected only through one PW to another site and that there is no backdoor link that could introduce a physical loop, it is a good idea not to run spanning tree over the two sites. This keeps the two spanning tree domains isolated. To do this, configure a spanning tree bpdufilter on the CEs, or configure an ethernet-services access-list on the PEs to drop frames with the destination MAC address used by BPDUs. An ethernet-services access-list on the PEs can be used to drop frames with the BPDU destination MAC or other kinds of L2 protocols that you do not want to forward over the PW.

This is an access-list that you could use under each l2transport (sub)interface that is being transported between the two sites:

```
ethernet-services access-list block-invalid-frames
 10 deny any 0180.c200.0000 0000.0000.000f
 20 deny any host 0180.c200.0010
 30 deny any host 0100.0c00.0000
 40 deny any host 0100.0ccc.cccc
 50 deny any host 0100.0ccc.cccd
 60 deny any host 0100.0ccd.cdce
 70 permit any any
!

RP/0/RSP1/CPU0:router2#sh run int GigabitEthernet0/0/0/1.1
interface GigabitEthernet0/0/0/1.1 l2transport
 encapsulation untagged
 ethernet-services access-group block-invalid-frames ingress
 ethernet-services access-group block-invalid-frames egress
!

RP/0/RSP1/CPU0:router2#sh run int GigabitEthernet0/0/0/1.2
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group block-invalid-frames ingress
 ethernet-services access-group block-invalid-frames egress
!

```

The ethernet-services ACL starts to drop the BPDUs:

```
RP/0/RSP1/CPU0:router2#sh access-lists ethernet-services block-invalid-frames
   hardware ingress location 0/0/CPU0
ethernet-services access-list block-invalid-frames
 10 deny any 0180.c200.0000 0000.0000.000f (41 hw matches)
 20 deny any host 0180.c200.0010
 30 deny any host 0100.0c00.0000
 40 deny any host 0100.0ccc.cccc
 50 deny any host 0100.0ccc.cccd (63 hw matches)
 60 deny any host 0100.0ccd.cdce
 70 permit any any (8 hw matches)

```

Switch1 does not receive the BPDUs from switch4 anymore, so switch1 is now the root:

```
switch1#sh spanning-tree vlan 1

VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    32769
             Address     001d.4603.1f00
             This bridge is the root
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 15

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ----------------------
Gi0/1               Desg FWD 4         128.1    P2p

switch1#sh spanning-tree vlan 2

VLAN0002
  Spanning tree enabled protocol ieee
  Root ID    Priority    32770
             Address     001d.4603.1f00
             This bridge is the root
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32770  (priority 32768 sys-id-ext 2)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 15

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ----------------------
Gi0/1               Desg FWD 4         128.1    P2p
```

The risk of disabling spanning tree on a link is this: if a backdoor connection is created between the sites, it introduces a physical loop, and spanning tree cannot break the loop. So, when you disable spanning tree over a PW, ensure that there are no redundant links between sites and that the PW remains the only connection between the sites.

If there are multiple connections between sites, use a solution like VPLS along with an access gateway version of the spanning tree, such as MST Access Gateway (MSTAG) or PVST+ Access Gateway (PVSTAG). See the Multipoint Service section for details.

## 4. Multipoint Service

See [Implementing Multipoint Layer 2 Services](https://www.cisco.com/c/en/us/td/docs/routers/asr9000/software/asr9k-r7-4/lxvpn/configuration/guide/b-l2vpn-cg-asr9000-74x/implementing-multipoint-layer-2-services.html) for a complete description of the multipoint L2 features.

With only two interfaces in a point-to-point cross connect, an L2VPN switch takes everything received on side and forwards it on the other side.

When there are more than two interfaces in a bridge-domain, an Ethernet switch has to make a switching decision in order to determine where to forward frames based on their destination MAC address. The switch does MAC learning based on the source MAC address of the frames that it receives and builds a mac-address-table.

The switch forwards frames in this method:

* Broadcast frames are flooded to all ports. Use storm control in order to limit the broadcast flooding rate.
* Multicast frames are flooded to all ports in the bridge-domain, except when Internet Group Management Protocol (IGMP) or Multicast Listener Discovery (MLD) snooping is configured. Use storm control in order to limit the multicast flooding rate.
* Unicast frames with a destination MAC address that is not part of the mac-address-table of the bridge-domain (unknown unicast) are flooded on all ports in the bridge-domain. Use storm control in order to limit the unknown-unicast flooding rate.
* Unicast frames with a destination MAC address that is part of the mac-address-table of the bridge-domain are forwarded to the port where the destination MAC address has been learned.

In Cisco IOS XR software, a broadcast domain or an emulated LAN is called a bridge-domain. This is similar to a VLAN in Cisco IOS software terminology, except that a VLAN in IOS is linked to a VLAN number that is used as the dot1q tag on the trunks. A bridge-domain in Cisco IOS XR software is not linked to a dot1q VLAN tag number. You can use the EVC model in order to manipulate the dot1q tags and have dot1q subinterfaces with different dot1q VLAN numbers in the same bridge-domain or to have untagged interfaces.

A bridge-domain is basically one broadcast domain where broadcasts and multicast frames are flooded. One mac-address-table is associated with each bridge-domain (unless MAC learning is disabled manually by configuration, which is very rare). This usually corresponds to one IPv4 or IPv6 subnet where all hosts in the bridge-domain are directly connected.

Bridge-domains can be grouped within a bridge group. This is a convenient way to check the configuration. You can execute one show command for a bridge group instead of one show command for each bridge-domain. A bridge group does not have a mac-address-table or other associations; it is just used for configuration and show commands.

### 4.1 Local Switching

This is a very basic example:

![Local Switching](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-20.jpeg)

Router2, router3, and router4 are connected through an ASR 9000, which simulates a LAN between those three routers.

These are the interface configurations on those three routers:

```
RP/0/RSP0/CPU0:router2#sh run int gig 0/1/0/39.2
interface GigabitEthernet0/1/0/39.2
 ipv4 address 192.168.2.2 255.255.255.0
 encapsulation dot1q 2
!

router3#sh run int gig 0/1
Building configuration...

Current configuration : 203 bytes
!
interface GigabitEthernet0/1
 port-type nni
 switchport access vlan 2
 switchport trunk allowed vlan 1,2
 switchport mode trunk
end

router3#sh run int vlan 2
Building configuration...

Current configuration : 61 bytes
!
interface Vlan2
 ip address 192.168.2.3 255.255.255.0
end

router3#

RP/0/RSP0/CPU0:router4#sh run int ten 0/0/1/0.2
interface TenGigE0/0/1/0.2
 ipv4 address 192.168.2.4 255.255.255.0
 encapsulation dot1q 2
!

```

Packets are received by router1 with the dot1q tag 2 and are forwarded to the other routers with the dot1q tag 2.

In this basic scenario, there are two options on the ACs:

1. Since all ACs are using the dot1q tag 2, you can keep it on the frame and forward the frame on the egress interface with the same dot1q tag as received on the ingress interface. The **rewrite ingress tag pop 1 symmetric** command is not required.
2. You can pop the incoming dot1q tag 2 in the ingress direction and symmetrically push the dot1q tag 2 in the egress direction. While this is not required in this basic scenario, it is a good idea to configure the bridge-domain in this fashion at the start because it provides more flexibility for the future. Here are two examples of changes that can occur after initial configuration:

1. If a routed BVI interface is introduced later in the bridge-domain, packets must be processed on the BVI without tags. See the BVI section for details.
2. A new AC, which uses a different dot1q tag, is added later. The dot1q tag 2 would be popped in the ingress direction, and the other dot1q tag would be pushed on the new interface in the egress direction and vice versa.

Pop the dot1q tags on each AC on router1:

```
RP/0/RSP0/CPU0:router1#sh run int GigabitEthernet0/1/0/3.2
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP0/CPU0:router1#sh run int GigabitEthernet0/1/0/38.2
interface GigabitEthernet0/1/0/38.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP0/CPU0:router1#sh run int TenGigE0/2/0/4.2
interface TenGigE0/2/0/4.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
```

View the configuration of the bridge-domain with these three ACs:

```
RP/0/RSP0/CPU0:router1#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface TenGigE0/2/0/4.2
   !
   interface GigabitEthernet0/1/0/3.2
   !
   interface GigabitEthernet0/1/0/38.2
   !
  !
 !
!

```

The bridge-domain must be configured under a bridge group. If other bridge-domains from this customer are needed, they can be configured under the same bridge group, customer1. If new bridge-domains belong to a different customer, you can create a new bridge group. These examples use the customer in order to group bridge-domains, but bridge-domains can be grouped by any criteria.

Use the **show run l2vpn bridge group customer1 bridge-domain engineering** command in order to display the configuration of the bridge-domain.

Use the **show run l2vpn bridge group customer1** command in order to view the configuration of all bridge-domains.

Use the **show l2vpn bridge-domain bd-name engineering** command or the **show l2vpn bridge-domain group customer1** command in order to display information about the bridge-domain.

```
RP/0/RSP0/CPU0:router1#show l2vpn bridge-domain group customer1 bd-name
   engineering
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 3 (3 up), VFIs: 0, PWs: 0 (0 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.2, state: up, Static MAC addresses: 0
    Gi0/1/0/38.2, state: up, Static MAC addresses: 0
    Te0/2/0/4.2, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:

RP/0/RSP0/CPU0:router1#show l2vpn bridge-domain group customer1 bd-name
   engineering det
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 6
  Filter MAC addresses:
  Create time: 28/05/2013 17:17:03 (00:18:06 ago)
  No status change since creation
  ACs: 3 (3 up), VFIs: 0, PWs: 0 (0 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40003; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 185066, sent 465
        bytes: received 13422918, sent 34974
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
    AC: GigabitEthernet0/1/0/38.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40005; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 8, sent 12287
        bytes: received 770, sent 892418
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
    AC: TenGigE0/2/0/4.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0x1040001; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 463, sent 11839
        bytes: received 35110, sent 859028
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:

```

Use the **show l2vpn bridge-domain group customer1 bd-name engineering det** command if you want to check that packets are received and sent on each AC.

Add the mac-address keyword to the **show l2vpn forwarding bridge-domain** command if you want to check the mac-address-table:

```
RP/0/RSP0/CPU0:router1#show l2vpn forwarding bridge-domain customer1:
   engineering mac-address location 0/1/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on  LC learned Resync Age   Mapped to
------------------------------------------------------------------------------
0019.552b.b581 dynamic Gi0/1/0/3.2               0/1/CPU0   0d 0h 0m 0s   N/A
0019.552b.b5c3 dynamic Gi0/1/0/3.2               0/1/CPU0   0d 0h 0m 0s   N/A
0024.986c.6417 dynamic Gi0/1/0/38.2              0/1/CPU0   0d 0h 0m 0s   N/A
6c9c.ed3e.e484 dynamic Te0/2/0/4.2               0/2/CPU0   0d 0h 0m 0s   N/A
```

The MAC learning is executed in hardware by the linecards each time a frame is received in the bridge-domain. There is also a software cache of the mac-address-table, but this software table cannot be updated continuously in order to match the hardware entries. When the **show** command is entered in recent code, it tries to resynchronize the software table with the hardware table. After a maximum of 15 seconds, it prints the current state of the software mac-address-table, even if the resynchronization is not complete (for example, if the table is large). Use the **l2vpn resynchronize forwarding mac-address-table** command in order to resynchronize the software and hardware tables manually.

```
RP/0/RSP0/CPU0:router1#term mon
RP/0/RSP0/CPU0:router1#l2vpn resynchronize forwarding mac-address-table
   location 0/1/CPU0
RP/0/RSP0/CPU0:router1#LC/0/1/CPU0:May 28 18:25:35.734 : vkg_l2fib_mac_cache[357]
   %PLATFORM-
PLAT_L2FIB_MAC_CACHE-6-RESYNC_COMPLETE : The resynchronization of the MAC
   address table is complete
0/1/CPU0

RP/0/RSP0/CPU0:router1#show l2vpn forwarding bridge-domain customer1:engineering
   mac-address location 0/1/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age   Mapped to
-----------------------------------------------------------------------------
0019.552b.b581 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 0s  N/A
0019.552b.b5c3 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 0s  N/A
6c9c.ed3e.e484 dynamic Te0/2/0/4.2              0/2/CPU0   0d 0h 0m 0s  N/A

```

A syslog message indicates when the resynchronization process is complete, so it is useful to have **terminal monitor** enabled in order to see the message.

The Resync Age column displays the last time that the MAC address was resynchronized from the hardware table.

The location keyword is the location of an incoming or an outgoing linecard. The MAC addresses are exchanged between linecards in hardware, so MAC addresses can be known on each linecard where there is an AC or a PW. The detail keyword can provide a more up-to-date version of the software table:

```
RP/0/RSP0/CPU0:router1#show l2vpn forwarding bridge-domain customer1:
   engineering mac-address detail location 0/1/CPU0

Bridge-domain name: customer1:engineering, id: 5, state: up
 MAC learning: enabled
 MAC port down flush: enabled
 Flooding:
   Broadcast & Multicast: enabled
   Unknown unicast: enabled
 MAC aging time: 300 s, Type: inactivity
 MAC limit: 4000, Action: none, Notification: syslog
 MAC limit reached: no
 MAC Secure: disabled, Logging: disabled
 DHCPv4 snooping: profile not known on this node
 Dynamic ARP Inspection: disabled, Logging: disabled
 IP Source Guard: disabled, Logging: disabled
 IGMP snooping: disabled, flooding: enabled
 Bridge MTU: 1500 bytes
 Number of bridge ports: 3
 Number of MAC addresses: 4
 Multi-spanning tree instance: 0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

  GigabitEthernet0/1/0/3.2, state: oper up
    Number of MAC: 2
    Statistics:
      packets: received 187106, sent 757
      bytes: received 13571342, sent 57446
    Storm control drop counters:
      packets: broadcast 0, multicast 0, unknown unicast 0
      bytes: broadcast 0, multicast 0, unknown unicast 0
    Dynamic arp inspection drop counters:
      packets: 0, bytes: 0
    IP source guard drop counters:
      packets: 0, bytes: 0

 Mac Address: 0019.552b.b581, LC learned: 0/1/CPU0
   Resync Age: 0d 0h 0m 0s, Flag: local

 Mac Address: 0019.552b.b5c3, LC learned: 0/1/CPU0
   Resync Age: 0d 0h 0m 0s, Flag: local

  GigabitEthernet0/1/0/38.2, state: oper up
    Number of MAC: 1
    Statistics:
      packets: received 18, sent 14607
      bytes: received 1950, sent 1061882
    Storm control drop counters:
      packets: broadcast 0, multicast 0, unknown unicast 0
      bytes: broadcast 0, multicast 0, unknown unicast 0
    Dynamic arp inspection drop counters:
      packets: 0, bytes: 0
    IP source guard drop counters:
      packets: 0, bytes: 0

 Mac Address: 0024.986c.6417, LC learned: 0/1/CPU0
   Resync Age: 0d 0h 0m 0s, Flag: local

  TenGigE0/2/0/4.2, state: oper up
    Number of MAC: 1
    Statistics:
      packets: received 0, sent 0
      bytes: received 0, sent 0
    Storm control drop counters:
      packets: broadcast 0, multicast 0, unknown unicast 0
      bytes: broadcast 0, multicast 0, unknown unicast 0
    Dynamic arp inspection drop counters:
      packets: 0, bytes: 0
    IP source guard drop counters:
      packets: 0, bytes: 0

 Mac Address: 6c9c.ed3e.e484, LC learned: 0/2/CPU0
   Resync Age: 0d 0h 0m 0s, Flag: remote

```

The detailed version of the command provides the total number of MAC addresses learned in the bridge-domain, as well as the number of MAC addresses learned under each AC.

The hardware keyword polls the hardware mac-address-table directly from the ingress or egress forwarding engines:

```
RP/0/RSP0/CPU0:router1#show l2vpn forwarding bridge-domain customer1:
   engineering mac-address hardware ingress location 0/1/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-------------------------------------------------------------------------
0019.552b.b581 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 0s N/A
0019.552b.b5c3 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 0s N/A
0024.986c.6417 dynamic Gi0/1/0/38.2             0/1/CPU0   0d 0h 0m 0s N/A
6c9c.ed3e.e484 dynamic Te0/2/0/4.2              0/2/CPU0   0d 0h 0m 0s N/A
RP/0/RSP0/CPU0:router1#show l2vpn forwarding bridge-domain customer1:
   engineering mac-address hardware egress location 0/2/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age   Mapped to
-----------------------------------------------------------------------------
0019.552b.b581 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 14s N/A
0019.552b.b5c3 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 1s  N/A
0024.986c.6417 dynamic Gi0/1/0/38.2             0/1/CPU0   0d 0h 0m 10s N/A
6c9c.ed3e.e484 dynamic Te0/2/0/4.2              0/2/CPU0   0d 0h 0m 13s N/A
RP/0/RSP0/CPU0:router1#
```
###

### 4.2 Full MST

The previous examples of local switching were basic because only routers were connected to the bridge-domain. Once you start to connect L2 switches, however, you can introduce a loop and need the STP in order to break the loop:

![Full MST](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-21.jpeg)

In this topology, router1, router2, and router3 are each configured with a bridge-domain with all their interfaces in the diagram. If router4 sends a broadcast, such as an ARP request, to router1, router1 floods it to router2 and router3, router2 floods it to router3, and router3 floods it to router2. This results in a loop and a broadcast storm.

To break the loop, use an STP. There are multiple types of STPs, but Cisco IOS XR software offers only one full implementation, the MST.

There are also access gateway versions of the protocols supported in Cisco IOS XR software, such as PVSTAG and MSTAG. These are static, limited versions of the protocol to use in specific topologies, typically with VPLS, and are described in the MSTAG and PVSTAG sections. In Cisco IOS XR software, MST is the only option if there is a topology with multiple switches and if a full spanning tree implementation is required.

Two subinterfaces are configured on each router and added to a bridge-domain. For router1, the configuration is:

```
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface GigabitEthernet0/0/0/1.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!
interface TenGigE0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface TenGigE0/0/0/1.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!
l2vpn
 bridge group customer1
  bridge-domain finance
   interface TenGigE0/0/0/1.3
   !
   interface GigabitEthernet0/0/0/1.3
   !
  !
  bridge-domain engineering
   interface TenGigE0/0/0/1.2
   !
   interface GigabitEthernet0/0/0/1.2
   !
  !
 !
!
```

MST is configured on the main interface. In this example, VLAN 2 is assigned to instance 1, and all other VLANs remain the default instance 0. (A more realistic configuration would split VLANs evenly between instances.)

The selection of the root bridge within an STP network is determined by the configured priority and the embedded bridge ID of each device. The device with the lowest priority, or with equal lowest priority but the lowest bridge ID, is selected as the root bridge. In this example, router3 is configured with a lower priority then router1 for instance 0, so router3 is the root for instance 0. Router1 has a lower priority then router3 for instance 1, so router1 is the root for instance 1.

This is the configuration for router1:

```
spanning-tree mst customer1
 name customer1
 revision 1
 instance 0
  priority 28672
 !
 instance 1
  vlan-ids 2
  priority 24576
 !
 interface TenGigE0/0/0/1
 !
 interface GigabitEthernet0/0/0/1
 !
!
```

This is the configuration on router3:

```
spanning-tree mode mst
spanning-tree extend system-id
!
spanning-tree mst configuration
 name customer1
 revision 1
 instance 1 vlan 2
!
spanning-tree mst 0 priority 24576
spanning-tree mst 1 priority 28672
```

The name, revision, and VLAN-to-instance mapping must be the same on all switches.

Now, check the spanning tree status on router1:

```
RP/0/RSP1/CPU0:router1#sh spanning-tree mst customer1
Role:  ROOT=Root, DSGN=Designated, ALT=Alternate, BKP=Backup, MSTR=Master
State: FWD=Forwarding, LRN=Learning, BLK=Blocked, DLY=Bringup Delayed

Operating in dot1q mode

MSTI 0 (CIST):

  VLANS Mapped: 1,3-4094

  CIST Root  Priority    24576
             Address     001d.4603.1f00
             Ext Cost    0

  Root ID    Priority    24576
             Address     001d.4603.1f00
             Int Cost    20000
             Max Age 20 sec, Forward Delay 15 sec

  Bridge ID  Priority    28672 (priority 28672 sys-id-ext 0)
             Address     4055.3912.f1e6
             Max Age 20 sec, Forward Delay 15 sec
             Max Hops 20, Transmit Hold count  6

Interface    Port ID           Role State Designated           Port ID
             Pri.Nbr Cost                 Bridge ID            Pri.Nbr
------------ ------- --------- ---- ----- -------------------- -------
Gi0/0/0/1    128.2   20000     ROOT FWD   24576 001d.4603.1f00 128.1
Te0/0/0/1    128.1   2000      DSGN FWD   28672 4055.3912.f1e6 128.1

MSTI 1:

  VLANS Mapped: 2

  Root ID    Priority    24576
             Address     4055.3912.f1e6
             This bridge is the root
             Int Cost    0
             Max Age 20 sec, Forward Delay 15 sec

  Bridge ID  Priority    24576 (priority 24576 sys-id-ext 0)
             Address     4055.3912.f1e6
             Max Age 20 sec, Forward Delay 15 sec
             Max Hops 20, Transmit Hold count  6

Interface    Port ID           Role State Designated           Port ID
             Pri.Nbr Cost                 Bridge ID            Pri.Nbr
------------ ------- --------- ---- ----- -------------------- -------
Gi0/0/0/1    128.2   20000     DSGN FWD   24576 4055.3912.f1e6 128.2
Te0/0/0/1    128.1   2000      DSGN FWD   24576 4055.3912.f1e6 128.1
```

Router3 is the root for instance 0, so router1 has its root port on Gi0/0/0/1 towards router3. Router1 is the root for instance 1, so router1 is the designated bridge on all interfaces for that instance.

Router2 is blocked for instance 0 on Te0/1/0/0:

```
RP/0/RSP1/CPU0:router2#sh spanning-tree mst customer1
Role:  ROOT=Root, DSGN=Designated, ALT=Alternate, BKP=Backup, MSTR=Master
State: FWD=Forwarding, LRN=Learning, BLK=Blocked, DLY=Bringup Delayed

Operating in dot1q mode

MSTI 0 (CIST):

  VLANS Mapped: 1,3-4094

  CIST Root  Priority    24576
             Address     001d.4603.1f00
             Ext Cost    0

  Root ID    Priority    24576
             Address     001d.4603.1f00
             Int Cost    20000
             Max Age 20 sec, Forward Delay 15 sec

  Bridge ID  Priority    32768 (priority 32768 sys-id-ext 0)
             Address     f025.72a7.b13e
             Max Age 20 sec, Forward Delay 15 sec
             Max Hops 20, Transmit Hold count  6

Interface    Port ID           Role State Designated           Port ID
             Pri.Nbr Cost                 Bridge ID            Pri.Nbr
------------ ------- --------- ---- ----- -------------------- -------
Gi0/0/0/1    128.2   20000     ROOT FWD   24576 001d.4603.1f00 128.2
Te0/1/0/0    128.1   2000      ALT  BLK   28672 4055.3912.f1e6 128.1

MSTI 1:

  VLANS Mapped: 2

  Root ID    Priority    24576
             Address     4055.3912.f1e6
             Int Cost    2000
             Max Age 20 sec, Forward Delay 15 sec

  Bridge ID  Priority    32768 (priority 32768 sys-id-ext 0)
             Address     f025.72a7.b13e
             Max Age 20 sec, Forward Delay 15 sec
             Max Hops 20, Transmit Hold count  6

Interface    Port ID           Role State Designated           Port ID
             Pri.Nbr Cost                 Bridge ID            Pri.Nbr
------------ ------- --------- ---- ----- -------------------- -------
Gi0/0/0/1    128.2   20000     DSGN FWD   32768 f025.72a7.b13e 128.2
Te0/1/0/0    128.1   2000      ROOT FWD   24576 4055.3912.f1e6 128.1
RP/0/RSP1/CPU0:router2#

```

Te0/1/0/0.2 is forwarding while Te0/1/0/0.3 is blocked. When the STP Blocked value is 0x0, the condition is false, so the interface is forwarding; when the STP Blocked value is 0x1, the condition is true, so the interface is blocked.

Use the **show uidb data** command in order to confirm this and display the interface data that is present in the network processor:

```
RP/0/RSP1/CPU0:router2#sh uidb data location 0/1/CPU0 TenGigE0/1/0/0.2
   ingress | i Blocked
  STP Blocked                      0x0
RP/0/RSP1/CPU0:router2#sh uidb data location 0/1/CPU0 TenGigE0/1/0/0.3
   ingress | i Blocked
  STP Blocked                      0x1
```
### 4.3 BVI

Configuration of a bridge-domain creates an L2 domain. In order to exit that L2 domain, connect L3 routers that route between hosts inside the bridge-domain and the outside world. In the previous diagram, host1 could use router4 or router5 in order to exit the local subnet and reach the internet.

Router1 and router2 where the bridge-domains are configured are ASR 9000 routers, which can route IPv4 and IPv6 traffic. So these two routers could take the IP traffic out of the bridge-domain and route it to the internet themselves, instead of relying on L3 routers. To do this, you need to configure a BVI, which is an L3 interface that plugs into a bridge-domain in order to route packets in and out of the bridge-domain.

This is how it looks like logically:

![BVI](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-22.jpeg)

This is the configuration:

```
RP/0/RSP1/CPU0:router1#sh run int bvi 2
interface BVI2
 ipv4 address 192.168.2.1 255.255.255.0
!

RP/0/RSP1/CPU0:router1#sh run int bvi 3
interface BVI3
 ipv4 address 192.168.3.1 255.255.255.0
!

RP/0/RSP1/CPU0:router1#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface TenGigE0/0/0/1.3
   !
   interface GigabitEthernet0/0/0/1.3
   !
   routed interface BVI3
  !
  bridge-domain engineering
   interface TenGigE0/0/0/1.2
   !
   interface GigabitEthernet0/0/0/1.2
   !
   routed interface BVI2
  !
 !
!

RP/0/RSP1/CPU0:router1#sh run int gig 0/0/0/1.2
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!

```

A BVI is an untagged L3 interface, so if you want to have the BVI process the packets received on the ACs of the bridge-domain, the ACs must be configured to pop all incoming tags. Otherwise, the BVI cannot understand the tag and drops the packets. There is no way to configure a dot1q subinterface on a BVI, so the tags must be popped ingress on the ACs as was done on Gi0/0/0/1.2 in the previous example.

Since a BVI interface is a virtual interface, there are some restrictions on the features that can be enabled. These restrictions are documented in [Configuring Integrated Routing and Bridging on the Cisco ASR 9000 Series Router: Restrictions for Configuring IRB](http://www.cisco.com/en/US/docs/routers/asr9000/software/asr9k_r4.3/interfaces/configuration/guide/hc43irb.html#wp1011723). These features are not supported on the BVI interfaces on the ASR 9000:

* Access Control Lists (ACLs). However, L2 ACLs can be configured on each L2 port of the bridge-domain.
* IP Fast Reroute (FRR)
* NetFlow
* MoFRR (Multicast only Fast Re-Route)
* MPLS label switching
* mVPNv4
* Quality of Service (QoS)
* Traffic mirroring
* Unnumbered interface for BVI
* Video monitoring (Vidmon)

The BVI can be in a Virtual Routing and Forwarding (VRF) configuration, so that traffic received on the BVI is forwarded over MPLS, but per-vrf label-allocation-mode must be used.

If one of these restricted features is required, you cannot use a BVI. Another solution is to use an external loopback cable between two ports on the router, where one port is in the bridge-domain and one port is configured as a normal routed interface where all features can be configured.

### 4.4 VPLS

#### 4.4.1 Overview

VPLS provides the ability to combine bridge-domains at multiple sites into one large bridge-domain through MPLS PWs. Hosts at the different sites appear to be directly connected to the same L2 segment because their traffic is transparently encapsulated over the full mesh of MPLS PWs between L2VPN PEs:

![VPLS Overview](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-23.jpeg)

A full mesh of PWs is required in order to ensure that each host can receive traffic from all other hosts. The consequence is that a L2VPN PE does not forward a frame received on a VPLS PW over its other VPLS PWs. There can be a full mesh of PWs, so each PE receives the traffic directly and does not need to forward traffic between PWs since forwarding would cause a loop. This is called the split horizon rule.

The router is running MAC learning. Once a MAC address is present in the mac-address-table, you forward only the frame for that destination MAC address over the PW to the L2VPN PE where this MAC address has been learned from. This avoids unnecessary duplication of traffic in the core. Broadcasts and multicasts are flooded over all PWs in order to ensure that all hosts can receive them. A feature such as IGMP snooping is useful because it allows multicast frames to be sent to PEs only where there are receivers or multicast routers. This reduces the amount of traffic in the core, although there are still multiple copies of the same packets that must be sent to each PE when there is interest for that group.

The full mesh of PWs must be configured under a Virtual Forwarding Instance (VFI):

```
RP/0/RSP0/CPU0:router1#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/1/0/3.3
   !
   vfi customer1-finance
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!
```

The PWs configured under the VFI are those that are fully meshed in the core. They are part of the same split horizon group (SHG) in order to make sure that frames received on one PW are not forwarded to another PW.

It is possible to configure access PWs, which are considered a type of AC and are not configured under the VFI. See the H-VPLS section for details.

The configuration on router2, router3, and router4 is very similar, and all have the other three routers as neighbors under the VFI.

```
RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain bd-name engineering detail
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 6
  Filter MAC addresses:
  Create time: 28/05/2013 17:17:03 (23:06:02 ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40003; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 234039, sent 7824
        bytes: received 16979396, sent 584608
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc0000009
        Encapsulation MPLS, protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ----------------------
          Label        16049                          16042
          Group ID     0x5                            0x1
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ----------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225481
        Create time: 29/05/2013 15:36:17 (00:46:49 ago)
        Last time status changed: 29/05/2013 15:57:36 (00:25:29 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 555, sent 285
          bytes: received 36308, sent 23064
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.13, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc000000a
        Encapsulation MPLS, protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ----------------------
          Label        16050                          16040
          Group ID     0x5                            0x3
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ----------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225482
        Create time: 29/05/2013 15:36:17 (00:46:49 ago)
        Last time status changed: 29/05/2013 16:00:56 (00:22:09 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 184, sent 158
          bytes: received 12198, sent 14144
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc000000b
        Encapsulation MPLS, protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ----------------------
          Label        16051                          289974
          Group ID     0x5                            0x6
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ----------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225483
        Create time: 29/05/2013 15:36:17 (00:46:49 ago)
        Last time status changed: 29/05/2013 16:02:38 (00:20:27 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 137
          bytes: received 0, sent 12064
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      VFI Statistics:
        drops: illegal VLAN 0, illegal length 0
```

The local label for the PW to 10.0.0.12 is 16049, which means that Ethernet frames are received with the label 16049. The switching decision is based on this MPLS label because the penultimate MPLS hop can have popped the IGP label. There can still be an explicit null label, but the switching decision is based on the PW label:

```
RP/0/RSP0/CPU0:router1#sh mpls forwarding labels 16049
Local  Outgoing    Prefix             Outgoing     Next Hop        Bytes
Label  Label       or ID              Interface                    Switched
------ ----------- ------------------ ------------ --------------- ----------
16049  Pop         PW(10.0.0.12:2)    BD=5         point2point     58226
```

The **show mpls forwarding labels** command for the label gives the bridge-domain number, which you can use in order to find the destination mac-address and the PW (neighbor and pw-id) where the packet was received. You can then create entries in the mac-address-table that point at that neighbor:

```
RP/0/RSP0/CPU0:router1#sh l2vpn forwarding bridge-domain customer1:
   engineering mac-address location 0/1/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-----------------------------------------------------------------------------
0019.552b.b5c3 dynamic Gi0/1/0/3.2              0/1/CPU0   0d 0h 0m 0s N/A
0024.985e.6a01 dynamic (10.0.0.12, 2)           0/1/CPU0   0d 0h 0m 0s N/A
0024.985e.6a42 dynamic (10.0.0.12, 2)           0/1/CPU0   0d 0h 0m 0s N/A
001d.4603.1f42 dynamic (10.0.0.13, 2)           0/1/CPU0   0d 0h 0m 0s N/A
```
#### 4.4.2 PW Types and Transported Tags

VPLS PWs are negotiated as type 5 (Ethernet) PWs by default. Whatever comes into the AC after any VLAN tag manipulation (when the **rewrite** command is configured) is sent over the PW.

Cisco IOS XR Software Release 4.1.0 for LDP signaling and Release 4.3.1 with BGP let you configure a pw-class under a neighbor and configure **transport mode vlan passthrough** under the pw-class. This negotiates a virtual connection (VC)-type 4 (Ethernet VLAN) PW, which transports whatever comes out of the AC after the VLAN tag manipulation when the **rewrite** command is configured.

The VLAN tag manipulation on the EFP ensures that there is at least one VLAN tag left on the frame because you need a dot1q tag on the frame if there are VC-type 4 PWs. No dummy tag 0 is added to the frame when you use the transport mode vlan passthrough mode.

A mix of type 4 and type 5 PWs under the same VFI is not supported. All PWs must be of the same type.

```
RP/0/RSP0/CPU0:router1#sh run l2vpn bridge group customer1 bridge-domain
   engineering
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.12 pw-id 2
     pw-class VC4-PT
    !
    neighbor 10.0.0.13 pw-id 2
     pw-class VC4-PT
    !
    neighbor 10.0.0.14 pw-id 2
     pw-class VC4-PT
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain bd-name engineering detail |
   i "PW:|PW type"
    MAC withdraw for Access PW: enabled
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
        PW type Ethernet VLAN, control word disabled, interworking none
          PW type      Ethernet VLAN                  Ethernet VLAN
      PW: neighbor 10.0.0.13, PW ID 2, state is up ( established )
        PW type Ethernet VLAN, control word disabled, interworking none
          PW type      Ethernet VLAN                  Ethernet VLAN
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
        PW type Ethernet VLAN, control word disabled, interworking none
          PW type      Ethernet VLAN                  Ethernet VLAN
```
#### 4.4.3 Autodiscovery and Signaling

The previous examples were based on manual configuration of all the neighbors under the VFI. MPLS LDP was used for the signaling of the PW with the neighbor.

When you add a new VPLS PE to the network, configure the PE in order to have a PW to all existing PEs in each of its local bridge-domains. All existing PEs must then be reconfigured in order to have a PW to the new PE because all PEs must be fully meshed. This can become an operational challenge as the number of PEs and bridge-domains increase.

One solution is to have PEs discover other PEs automatically through BGP. While there is also a full-mesh requirement for IBGP, it can be lifted by the use of route-reflectors. So, a new PE is typically configured in order to peer with a small number of route-reflectors, all other PEs receive its updates, and the new PE receives the updates from the other PEs.

In order to discover other PEs through BGP, each PE is configured for the vpls-vpws address-family and advertises in BGP the bridge-domains in which they want to participate. Once the other PEs that are part of the same bridge-domain are discovered, a PW is established to each of them. BGP is the protocol used for this autodiscovery.

There are two options for the signaling of the PW to the autodiscovered PEs: BGP and LDP. In these examples, you convert the previous topology to BGP autodiscovery with BGP signaling and LDP signaling.

#### 4.4.3.1 BGP Autodiscovery and BGP Signaling

Configure the **address-family l2vpn vpls-vpws** under router bgp and the neighbors, which are other PEs or the route-reflectors:

```
router bgp 65000
 address-family l2vpn vpls-vpws
 !
 neighbor-group IOX-LAB-RR
  address-family l2vpn vpls-vpws
  !
 neighbor 10.0.0.3
  use neighbor-group IOX-LAB-RR
 !
 neighbor 10.0.0.10
  use neighbor-group IOX-LAB-RR
 !

```

The new address-family becomes active with the neighbors, but no PE has yet advertised its participation in a bridge-domain:

```
RP/0/RSP0/CPU0:router1#sh bgp neighbor 10.0.0.3 | i Address family L2VPN
    Address family L2VPN VPLS: advertised and received

P/0/RSP0/CPU0:router1#sh bgp l2vpn vpls summary
BGP router identifier 10.0.0.11, local AS number 65000
BGP generic scan interval 60 secs
BGP table state: Active
Table ID: 0x0   RD version: 3890838096
BGP main routing table version 77
BGP scan interval 60 secs

BGP is operating in STANDALONE mode.

Process     RcvTblVer   bRIB/RIB   LabelVer  ImportVer  SendTblVer  StandbyVer
Speaker            77         77         77         77          77          77

Neighbor      Spk    AS MsgRcvd MsgSent   TblVer  InQ OutQ  Up/Down  St/PfxRcd
10.0.0.3        0 65000  252950   53252       77    0    0     1w0d          0
10.0.0.10       0 65000  941101   47439       77    0    0 00:10:18          0

```

Configure **autodiscovery bgp** and **signaling-protocol bgp** under the L2VPN bridge-domain configuration mode. The configuration on router1 is:

```
RP/0/RSP0/CPU0:router1#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/1/0/3.3
   !
   vfi customer1-finance
    vpn-id 3
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:3
     signaling-protocol bgp
      ve-id 11
     !
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    vpn-id 2
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:2
     signaling-protocol bgp
      ve-id 11
     !
    !
   !
  !
 !
!

```

The configuration on router2 is:

```
RP/0/RSP1/CPU0:router2#sh run l2vpn bridge group customer1
Thu May 30 15:25:55.638 CEST
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/0/0/1.3
   !
   vfi customer1-finance
    vpn-id 3
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:3
     signaling-protocol bgp
      ve-id 13
     !
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/0/0/1.2
   !
   vfi customer1-engineering
    vpn-id 2
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:2
     signaling-protocol bgp
      ve-id 13
     !
    !
   !
  !
 !
!

```

The vpn-id and the route-target are the same on the different PEs for each bridge-domain, but each PE has a unique Virtual Edge Identifier (VE-ID). Each PE discovers the other PEs in the VPN through BGP and uses BGP in order to signal the PWs. The result is a full mesh of PWs:

```
RP/0/RSP0/CPU0:router1#sh bgp l2vpn vpls summary
BGP router identifier 10.0.0.11, local AS number 65000
BGP generic scan interval 60 secs
BGP table state: Active
Table ID: 0x0   RD version: 3890838096
BGP main routing table version 103
BGP scan interval 60 secs

BGP is operating in STANDALONE mode.

Process   RcvTblVer   bRIB/RIB   LabelVer  ImportVer  SendTblVer  StandbyVer
Speaker         103        103        103        103         103         103

Neighbor    Spk    AS MsgRcvd MsgSent   TblVer  InQ OutQ  Up/Down  St/PfxRcd
10.0.0.3      0 65000  254944   53346      103    0    0     1w0d          6
10.0.0.10     0 65000  944859   47532      103    0    0 01:40:22          6

RP/0/RSP0/CPU0:router1#sh bgp l2vpn vpls
BGP router identifier 10.0.0.11, local AS number 65000
BGP generic scan interval 60 secs
BGP table state: Active
Table ID: 0x0   RD version: 3890838096
BGP main routing table version 103
BGP scan interval 60 secs

Status codes: s suppressed, d damped, h history, * valid, > best
              i - internal, r RIB-failure, S stale
Origin codes: i - IGP, e - EGP, ? - incomplete
   Network            Next Hop        Rcvd Label      Local Label
Route Distinguisher: 10.0.0.11:32769 (default for vrf customer1:finance)
*> 11:10/32           0.0.0.0         nolabel         16060
*>i12:10/32           10.0.0.12       16060           nolabel
*>i13:10/32           10.0.0.13       16060           nolabel
*>i14:10/32           10.0.0.14       289959          nolabel
Route Distinguisher: 10.0.0.11:32770 (default for vrf customer1:engineering)
*> 11:10/32           0.0.0.0         nolabel         16075
*>i12:10/32           10.0.0.12       16075           nolabel
*>i13:10/32           10.0.0.13       16075           nolabel
*>i14:10/32           10.0.0.14       289944          nolabel
Route Distinguisher: 10.0.0.12:32768
*>i12:10/32           10.0.0.12       16060           nolabel
* i                   10.0.0.12       16060           nolabel
Route Distinguisher: 10.0.0.12:32769
*>i12:10/32           10.0.0.12       16075           nolabel
* i                   10.0.0.12       16075           nolabel
Route Distinguisher: 10.0.0.13:32769
*>i13:10/32           10.0.0.13       16060           nolabel
* i                   10.0.0.13       16060           nolabel
Route Distinguisher: 10.0.0.13:32770
*>i13:10/32           10.0.0.13       16075           nolabel
* i                   10.0.0.13       16075           nolabel
Route Distinguisher: 10.0.0.14:32768
*>i14:10/32           10.0.0.14       289959          nolabel
* i                   10.0.0.14       289959          nolabel
Route Distinguisher: 10.0.0.14:32769
*>i14:10/32           10.0.0.14       289944          nolabel
* i                   10.0.0.14       289944          nolabel

Processed 14 prefixes, 20 paths

```

These are the prefixes advertised by router3 (10.0.0.13) as seen on router1; the prefixes are received through the two route-reflectors, 10.0.0.3 and 10.0.0.10:

```
RP/0/RSP0/CPU0:router1#sh bgp l2vpn vpls rd 10.0.0.13:32770 13:10/32
BGP routing table entry for 13:10/32, Route Distinguisher: 10.0.0.13:32770
Versions:
  Process           bRIB/RIB  SendTblVer
  Speaker                 92          92
Last Modified: May 30 15:10:44.100 for 01:23:38
Paths: (2 available, best #1)
  Not advertised to any peer
  Path #1: Received by speaker 0
  Not advertised to any peer
  Local
    10.0.0.13 (metric 5) from 10.0.0.3 (10.0.0.13)
      Received Label 16075
      Origin IGP, localpref 100, valid, internal, best, group-best,
         import-candidate, not-in-vrf, import suspect
      Received Path ID 0, Local Path ID 1, version 92
      Extended community: RT:0.0.0.1:2 L2VPN:19:0:1500
      Originator: 10.0.0.13, Cluster list: 10.0.0.3
      Block Size:10
  Path #2: Received by speaker 0
  Not advertised to any peer
  Local
    10.0.0.13 (metric 5) from 10.0.0.10 (10.0.0.13)
      Received Label 16075
      Origin IGP, localpref 100, valid, internal, not-in-vrf, import suspect
      Received Path ID 0, Local Path ID 0, version 0
      Extended community: RT:0.0.0.1:2 L2VPN:19:0:1500
      Originator: 10.0.0.13, Cluster list: 10.0.0.10
      Block Size:10

RP/0/RSP0/CPU0:router1#sh bgp l2vpn vpls rd 10.0.0.13:32769 13:10/32
BGP routing table entry for 13:10/32, Route Distinguisher: 10.0.0.13:32769
Versions:
  Process           bRIB/RIB  SendTblVer
  Speaker                 93          93
Last Modified: May 30 15:10:44.100 for 01:25:02
Paths: (2 available, best #1)
  Not advertised to any peer
  Path #1: Received by speaker 0
  Not advertised to any peer
  Local
    10.0.0.13 (metric 5) from 10.0.0.3 (10.0.0.13)
      Received Label 16060
      Origin IGP, localpref 100, valid, internal, best, group-best,
         import-candidate, not-in-vrf, import suspect
      Received Path ID 0, Local Path ID 1, version 93
      Extended community: RT:0.0.0.1:3 L2VPN:19:0:1500
      Originator: 10.0.0.13, Cluster list: 10.0.0.3
      Block Size:10
  Path #2: Received by speaker 0
  Not advertised to any peer
  Local
    10.0.0.13 (metric 5) from 10.0.0.10 (10.0.0.13)
      Received Label 16060
      Origin IGP, localpref 100, valid, internal, not-in-vrf, import suspect
      Received Path ID 0, Local Path ID 0, version 0
      Extended community: RT:0.0.0.1:3 L2VPN:19:0:1500
      Originator: 10.0.0.13, Cluster list: 10.0.0.10
      Block Size:10

```

Router1 has established some PWs:

```
RP/0/RSP0/CPU0:router1#sh l2vpn discovery bridge-domain

Service Type: VPLS,  Connected
  List of VPNs (2 VPNs):
  Bridge group: customer1, bridge-domain: finance, id: 3, signaling
     protocol: BGP
    List of Local Edges (1 Edges):
      Local Edge ID: 11, Label Blocks (1 Blocks)
        Label base        Offset    Size   Time Created
        ----------        ------    ----   -------------------
        16060             10        10     05/30/2013 15:07:39
    List of Remote Edges (3 Edges):
      Remote Edge ID: 12, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        16060             10        10     10.0.0.12    05/30/2013 15:09:53
      Remote Edge ID: 13, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        16060             10        10     10.0.0.13    05/30/2013 15:10:43
      Remote Edge ID: 14, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        289959            10        10     10.0.0.14    05/30/2013 15:11:22

  Bridge group: customer1, bridge-domain: engineering, id: 5, signaling
     protocol: BGP
    List of Local Edges (1 Edges):
      Local Edge ID: 11, Label Blocks (1 Blocks)
        Label base        Offset    Size   Time Created
        ----------        ------    ----   -------------------
        16075             10        10     05/30/2013 15:08:54
    List of Remote Edges (3 Edges):
      Remote Edge ID: 12, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        16075             10        10     10.0.0.12    05/30/2013 15:09:53
      Remote Edge ID: 13, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        16075             10        10     10.0.0.13    05/30/2013 15:10:43
      Remote Edge ID: 14, NLRIs (1 NLRIs)
        Label base        Offset    Size   Peer ID      Time Created
        ----------        ------    ----   ------------ -------------------
        289944            10        10     10.0.0.14    05/30/2013 15:11:22

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain autodiscovery bgp
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of VFIs:
    VFI customer1-finance (up)
      Neighbor 10.0.0.12 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 3, state: up, Static MAC addresses: 0
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.12 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain group customer1
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.3, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      Neighbor 10.0.0.12 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 3, state: up, Static MAC addresses: 0
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.2, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.12 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain group customer1 detail
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 4
  Filter MAC addresses:
  Create time: 29/05/2013 15:36:17 (1d01h ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.3, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [3, 3]
      MTU 1500; XC ID 0xc40006; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 10120, sent 43948
        bytes: received 933682, sent 2989896
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      VPN-ID: 3, Auto Discovery: BGP, state is Provisioned
         (Service Connected)
      Route Distinguisher:  (auto) 10.0.0.11:32769
      Import Route Targets:
        0.0.0.1:3
      Export Route Targets:
        0.0.0.1:3
      Signaling protocol: BGP
      Local VE-ID: 11 ,  Advertised Local VE-ID : 11
      VE-Range: 10
      PW: neighbor 10.0.0.12, PW ID 3, state is up ( established )
        PW class not set, XC ID 0xc000000c
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16062                          16061
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             12
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225484
        Create time: 30/05/2013 15:09:52 (01:29:44 ago)
        Last time status changed: 30/05/2013 15:09:52 (01:29:44 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 2679, sent 575
          bytes: received 171698, sent 51784
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.13, PW ID 3, state is up ( established )
        PW class not set, XC ID 0xc000000e
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16063                          16061
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             13
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225486
        Create time: 30/05/2013 15:10:43 (01:28:54 ago)
        Last time status changed: 30/05/2013 15:10:43 (01:28:54 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 11, sent 574
          bytes: received 1200, sent 51840
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.14, PW ID 3, state is up ( established )
        PW class not set, XC ID 0xc0000010
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16064                          289960
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             14
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225488
        Create time: 30/05/2013 15:11:22 (01:28:15 ago)
        Last time status changed: 30/05/2013 15:11:22 (01:28:15 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 561
          bytes: received 0, sent 50454
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      VFI Statistics:
        drops: illegal VLAN 0, illegal length 0
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 6
  Filter MAC addresses:
  Create time: 28/05/2013 17:17:03 (1d23h ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40007; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 243532, sent 51089
        bytes: received 17865888, sent 3528732
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      VPN-ID: 2, Auto Discovery: BGP, state is Provisioned
         (Service Connected)
      Route Distinguisher:  (auto) 10.0.0.11:32770
      Import Route Targets:
        0.0.0.1:2
      Export Route Targets:
        0.0.0.1:2
      Signaling protocol: BGP
      Local VE-ID: 11 ,  Advertised Local VE-ID : 11
      VE-Range: 10
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc000000d
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16077                          16076
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             12
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225485
        Create time: 30/05/2013 15:09:52 (01:29:45 ago)
        Last time status changed: 30/05/2013 15:09:52 (01:29:45 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 2677, sent 574
          bytes: received 171524, sent 51670
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.13, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc000000f
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16078                          16076
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             13
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225487
        Create time: 30/05/2013 15:10:43 (01:28:54 ago)
        Last time status changed: 30/05/2013 15:10:43 (01:28:54 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 17, sent 572
          bytes: received 1560, sent 51636
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
        PW class not set, XC ID 0xc0000011
        Encapsulation MPLS, Auto-discovered (BGP), protocol BGP
        Source address 10.0.0.11
        PW type VPLS, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16079                          289945
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      VPLS                           VPLS
          VE-ID        11                             14
          ------------ ------------------------------ ------------------
        MIB cpwVcIndex: 3221225489
        Create time: 30/05/2013 15:11:22 (01:28:16 ago)
        Last time status changed: 30/05/2013 15:11:22 (01:28:16 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 559
          bytes: received 0, sent 50250
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      VFI Statistics:
        drops: illegal VLAN 0, illegal length 0
```
#### 4.4.3.2 BGP Autodiscovery and LDP Signaling

The BGP configuration with the **address-family l2vpn vpls-vpws** command is exactly the same as with BGP signaling. The L2VPN configuration is modified in order to use LDP signaling with the **signaling-protocol ldp** command.

The same configuration is used on all four PEs:

```
router bgp 65000
 address-family l2vpn vpls-vpws
 !
 neighbor-group IOX-LAB-RR
  address-family l2vpn vpls-vpws
  !
 neighbor 10.0.0.3
  use neighbor-group IOX-LAB-RR
 !
 neighbor 10.0.0.10
  use neighbor-group IOX-LAB-RR
 !
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/1/0/3.3
   !
   vfi customer1-finance
    vpn-id 3
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:3
     signaling-protocol ldp
      vpls-id 65000:3
     !
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    vpn-id 2
    autodiscovery bgp
     rd auto
     route-target 0.0.0.1:2
     signaling-protocol ldp
      vpls-id 65000:2
     !
    !
   !
  !
 !
!
```

The vpls-id is made of the BGP Autonomous System (AS) number and the vpn-id.

Three show commands from router1 illustrate that the PWs have been established with the discovered PEs:

```
RP/0/RSP0/CPU0:router1#sh l2vpn discovery

Service Type: VPLS,  Connected
  List of VPNs (2 VPNs):
  Bridge group: customer1, bridge-domain: finance, id: 3,
     signaling protocol: LDP
    VPLS-ID: 65000:3
    Local L2 router id: 10.0.0.11
    List of Remote NLRI (3 NLRIs):
    Local Addr      Remote Addr     Remote L2 RID   Time Created
    --------------- --------------- --------------- -------------------
    10.0.0.11       10.0.0.12       10.0.0.12       05/30/2013 17:10:18
    10.0.0.11       10.0.0.13       10.0.0.13       05/30/2013 17:10:18
    10.0.0.11       10.0.0.14       10.0.0.14       05/30/2013 17:11:46

  Bridge group: customer1, bridge-domain: engineering, id: 5,
     signaling protocol: LDP
    VPLS-ID: 65000:2
    Local L2 router id: 10.0.0.11
    List of Remote NLRI (3 NLRIs):
    Local Addr      Remote Addr     Remote L2 RID   Time Created
    --------------- --------------- --------------- -------------------
    10.0.0.11       10.0.0.12       10.0.0.12       05/30/2013 17:10:18
    10.0.0.11       10.0.0.13       10.0.0.13       05/30/2013 17:10:18
    10.0.0.11       10.0.0.14       10.0.0.14       05/30/2013 17:11:46

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain group customer1
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.3, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      Neighbor 10.0.0.12 pw-id 65000:3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 65000:3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 65000:3, state: up, Static MAC addresses: 0
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.2, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.12 pw-id 65000:2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 65000:2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 65000:2, state: up, Static MAC addresses: 0

RP/0/RSP0/CPU0:router1#sh l2vpn bridge-domain group customer1 det
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 4
  Filter MAC addresses:
  Create time: 29/05/2013 15:36:17 (1d01h ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.3, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [3, 3]
      MTU 1500; XC ID 0xc40006; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 10362, sent 45038
        bytes: received 956240, sent 3064016
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      VPN-ID: 3, Auto Discovery: BGP, state is Provisioned
         (Service Connected)
      Route Distinguisher:  (auto) 10.0.0.11:32769
      Import Route Targets:
        0.0.0.1:3
      Export Route Targets:
        0.0.0.1:3
      Signaling protocol: LDP
      AS Number: 65000
      VPLS-ID: 65000:3
      L2VPN Router ID: 10.0.0.11
      PW: neighbor 10.0.0.12, PW ID 65000:3, state is up ( established )
        PW class not set, XC ID 0xc0000003
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16006                          16033
          BGP Peer ID  10.0.0.11                      10.0.0.12
          LDP ID       10.0.0.11                      10.0.0.12
          AII          10.0.0.11                      10.0.0.12
          AGI          65000:3                        65000:3
          Group ID     0x3                            0x0
          Interface    customer1-finance              customer1-finance
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225475
        Create time: 30/05/2013 17:10:18 (00:06:32 ago)
        Last time status changed: 30/05/2013 17:10:24 (00:06:25 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 190, sent 40
          bytes: received 12160, sent 3600
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.13, PW ID 65000:3, state is up ( established )
        PW class not set, XC ID 0xc0000004
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16016                          16020
          BGP Peer ID  10.0.0.11                      10.0.0.13
          LDP ID       10.0.0.11                      10.0.0.13
          AII          10.0.0.11                      10.0.0.13
          AGI          65000:3                        65000:3
          Group ID     0x3                            0x4
          Interface    customer1-finance              customer1-finance
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225476
        Create time: 30/05/2013 17:10:18 (00:06:32 ago)
        Last time status changed: 30/05/2013 17:10:27 (00:06:22 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 40
          bytes: received 0, sent 3600
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.14, PW ID 65000:3, state is up ( established )
        PW class not set, XC ID 0xc0000009
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16049                          289970
          BGP Peer ID  10.0.0.11                      10.0.0.14
          LDP ID       10.0.0.11                      10.0.0.14
          AII          10.0.0.11                      10.0.0.14
          AGI          65000:3                        65000:3
          Group ID     0x3                            0x4
          Interface    customer1-finance              customer1-finance
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225481
        Create time: 30/05/2013 17:11:46 (00:05:04 ago)
        Last time status changed: 30/05/2013 17:11:51 (00:04:59 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 31
          bytes: received 0, sent 2790
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      VFI Statistics:
        drops: illegal VLAN 0, illegal length 0
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 6
  Filter MAC addresses:
  Create time: 28/05/2013 17:17:03 (1d23h ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40007; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control: disabled
      Static MAC addresses:
      Statistics:
        packets: received 243774, sent 52179
        bytes: received 17888446, sent 3602852
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      VPN-ID: 2, Auto Discovery: BGP, state is Provisioned (Service Connected)
      Route Distinguisher:  (auto) 10.0.0.11:32770
      Import Route Targets:
        0.0.0.1:2
      Export Route Targets:
        0.0.0.1:2
      Signaling protocol: LDP
      AS Number: 65000
      VPLS-ID: 65000:2
      L2VPN Router ID: 10.0.0.11
      PW: neighbor 10.0.0.12, PW ID 65000:2, state is up ( established )
        PW class not set, XC ID 0xc0000005
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16027                          16042
          BGP Peer ID  10.0.0.11                      10.0.0.12
          LDP ID       10.0.0.11                      10.0.0.12
          AII          10.0.0.11                      10.0.0.12
          AGI          65000:2                        65000:2
          Group ID     0x5                            0x1
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 0
        Create time: 30/05/2013 17:10:18 (00:06:33 ago)
        Last time status changed: 30/05/2013 17:10:24 (00:06:26 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 190, sent 41
          bytes: received 12160, sent 3690
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.13, PW ID 65000:2, state is up ( established )
        PW class not set, XC ID 0xc0000006
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16043                          16021
          BGP Peer ID  10.0.0.11                      10.0.0.13
          LDP ID       10.0.0.11                      10.0.0.13
          AII          10.0.0.11                      10.0.0.13
          AGI          65000:2                        65000:2
          Group ID     0x5                            0x3
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 0
        Create time: 30/05/2013 17:10:18 (00:06:33 ago)
        Last time status changed: 30/05/2013 17:10:27 (00:06:23 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 40
          bytes: received 0, sent 3600
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      PW: neighbor 10.0.0.14, PW ID 65000:2, state is up ( established )
        PW class not set, XC ID 0xc000000a
        Encapsulation MPLS, Auto-discovered (BGP), protocol LDP
        Source address 10.0.0.11
        PW type Ethernet, control word disabled, interworking none
        PW backup disable delay 0 sec
        Sequencing not set

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        16050                          289974
          BGP Peer ID  10.0.0.11                      10.0.0.14
          LDP ID       10.0.0.11                      10.0.0.14
          AII          10.0.0.11                      10.0.0.14
          AGI          65000:2                        65000:2
          Group ID     0x5                            0x6
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word disabled                       disabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x6                            0x6
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
        Incoming Status (PW Status TLV):
          Status code: 0x0 (Up) in Notification message
        MIB cpwVcIndex: 3221225482
        Create time: 30/05/2013 17:11:46 (00:05:05 ago)
        Last time status changed: 30/05/2013 17:11:51 (00:05:00 ago)
        MAC withdraw message: send 0 receive 0
        Static MAC addresses:
        Statistics:
          packets: received 0, sent 31
          bytes: received 0, sent 2790
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      VFI Statistics:
        drops: illegal VLAN 0, illegal length 0
```
#### 4.4.4 MAC Flushes and Withdrawals

Forwarding in VPLS is based on the mac-address-table, which is dynamically built by learning the source MAC addresses of the frames being received. If there is a topology change in a bridge-domain, a host can become reachable through a different AC or VPLS neighbor. Traffic for that host cannot reach its destination if frames continue to be forwarded according to the existing mac-address-table.

For a L2VPN PE, there are multiple ways to detect a topology change:

* A port in the bridge-domain goes up or down.
* A spanning tree Topology Change Notification (TCN) BPDU is processed when the L2VPN PE runs the full MST implementation or a spanning tree access gateway protocol. The failing link cannot be local on the PE but can be farther away in the topology. The PE intercepts the TCN.

When a L2VPN PE detects a topology change, it takes two actions:

1. The PE flushes the mac-address-table of the bridge-domains impacted by the topology change. When the PE is configured for PVSTAG or Per-VLAN Rapid Spanning Tree Access Gateway (PVRSTAG), a TCN BPDU detected in one VLAN subinterface affects all VLANs and bridge-domains on that physical interface.
2. The PE signals to the VPLS neighbors through an MPLS LDP MAC withdrawal message that they can flush their mac-address-table. All remote L2VPN PEs receiving the MAC withdrawal LDP message flush their mac-address-tables, and traffic is flooded again. The mac-address-tables are rebuilt based on the new topology.

The default behavior of the MAC withdrawal message in case of port flap has changed over time:

* Traditionally in Cisco IOS XR software, a L2VPN PE sent MAC withdrawal messages when an AC was going down. The intent was to have remote PEs flush their MAC address tables for the impacted bridge-domain so that the MAC addresses pointing behind the downed port would be learned from another port.
* However, this created an interoperability problem with some remote PEs that use RFC 4762 and purge MAC addresses that point at all PEs except the one which is sending the MAC withdrawal message. RFC 4762 assumes that a PE would send a MAC withdrawal message when an AC comes up but not when an AC goes down. After Cisco IOS XR Software Release 4.2.1, the default behavior is to send LDP MAC withdrawal messages only when a bridge-domain port comes up in order to better comply with the RFC. A configuration command was added in order to revert to the old behavior.

This is a show command with the default behavior after Cisco IOS XR Software Release 4.2.1:

```
RP/0/RSP1/CPU0:router3#sh l2vpn bridge-domain bd-name engineering det |
   i "PW:|VFI|neighbor|MAC w"
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of VFIs:
    VFI customer1-engineering (up)
      PW: neighbor 10.0.0.11, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 0
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 4
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 2
      VFI Statistics:

```

The important line is the MAC withdraw sent on bridge port down, which is now disabled by default after Cisco IOS XR Software Release 4.2.1. The command also gives the number of MAC withdrawal messages sent and received in the bridge-domain. A high number of withdrawal messages indicates instability in the bridge-domain.

This is the configuration that reverts to the old behavior:

```
l2vpn
 bridge group customer1
  bridge-domain finance
   mac
    withdraw state-down
   !
  !
 !
!
```
#### 4.4.5 H-VPLS

VPLS requires a full mesh of PWs between L2VPN PEs in order to ensure that any PE can reach, in one hop, a host behind any other PE without the need for one PE to reflect frames from one PW to another PW. This is the basis for the split horizon rule, which prevents a PE from forwarding frames from one PW to another PW. Even in special cases, where the destination MAC address in the mac-address-table points at another PW, the frame is dropped.

A full mesh of PWs means that the number of PWs can become very high as the number of PEs grows, so this can introduce scalability issues.

You can decrease the number of PWs in this topology with a hierarchy of PEs:

![H-VPLS](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-24.jpeg)

In this topology:

* A user Provider Edge (U-PE) device has ACs to the CEs.
* The U-PE device transports the CE traffic over an MPLS point-to-point PW to a network Provider Edge (N-PE) device.
* The N-PE is a core VPLS PE that is fully meshed with other N-PEs.
* On the N-PE, the PW coming from the U-PE is considered an access PW much like an AC. The U-PE is not part of the mesh with the other N-PEs, so the N-PE can consider the access PW as an AC and forward traffic from that access PW to the core PWs that are part of the VPLS full mesh.
* The core PWs between N-PEs are configured under a VFI in order to ensure that the split horizon rule is applied to all the core PWs configured under the VFI.
* Access PWs from U-PEs are not configured under a VFI, so they do not belong to the same SHG as the VFI PWs. Traffic can be forwarded from an access PW to a VFI PW and vice versa.
* U-PEs can use the PW redundancy feature in order to have a primary PW to a primary N-PE and have a standby PW to a standby N-PE. The standby takes over when the primary PW goes down.

This is an example where U-PE1 (10.0.0.15) is configured with PW redundancy to N-PE1 (10.0.0.11) and N-PE2 (10.0.0.12):

```
RP/0/RP0/CPU0:U-PE1#sh run int ten 0/1/0/5.2
interface TenGigE0/1/0/5.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!

RP/0/RP0/CPU0:U-PE1#sh run l2vpn xconnect group customer1
l2vpn
 xconnect group customer1
  p2p engineering-0-1-0-5
   interface TenGigE0/1/0/5.2
   neighbor 10.0.0.11 pw-id 15
    backup neighbor 10.0.0.12 pw-id 15
    !
   !
  !
 !
!

RP/0/RP0/CPU0:U-PE1#sh l2vpn xconnect group customer1
Legend: ST = State, UP = Up, DN = Down, AD = Admin Down, UR = Unresolved,
        SB = Standby, SR = Standby Ready, (PP) = Partially Programmed

XConnect                   Segment 1                Segment 2
Group      Name       ST   Description     ST       Description            ST
------------------------   ----------------------   -----------------------------
customer1  engineering-0-1-0-5
                      UP   Te0/1/0/5.2     UP       10.0.0.11       15     UP
                                                    Backup
                                                    10.0.0.12       15     SB
---------------------------------------------------------------------------------
```

The PW to 10.0.0.12 is in standby state. On N-PE1, there are an access PW to 10.0.0.15 and an AC that are not under the VFI.

N-PE1 is learning some MAC addresses over the access PW and the VFI PWs:

```
RP/0/RSP0/CPU0:N-PE1#sh run l2vpn bridge group customer1 bridge-domain
   engineering
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   neighbor 10.0.0.15 pw-id 15
   !
   vfi customer1-engineering
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:N-PE1#sh l2vpn bridge-domain bd-name engineering
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 4 (4 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.2, state: up, Static MAC addresses: 0
  List of Access PWs:
      Neighbor 10.0.0.15 pw-id 15, state: up, Static MAC addresses: 0
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.12 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0

RP/0/RSP0/CPU0:N-PE1#sh l2vpn forwarding bridge-domain customer1:engineering
   mac-address location 0/0/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-----------------------------------------------------------------------------
6c9c.ed3e.e46d dynamic (10.0.0.15, 15)          0/0/CPU0   0d 0h 0m 0s N/A
0019.552b.b5c3 dynamic (10.0.0.12, 2)           0/0/CPU0   0d 0h 0m 0s N/A
0024.985e.6a42 dynamic (10.0.0.12, 2)           0/0/CPU0   0d 0h 0m 0s N/A
001d.4603.1f42 dynamic (10.0.0.13, 2)           0/0/CPU0   0d 0h 0m 0s N/A
```

On N-PE2 (10.0.0.12), the access PW is in standby state:

```
RP/0/RSP0/CPU0:N-PE2#sh run l2vpn bridge group customer1 bridge-domain
   engineering
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   neighbor 10.0.0.15 pw-id 15
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:N-PE2#sh l2vpn bridge-domain bd-name engineering
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 1, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 4 (3 up), PBBs: 0 (0 up)
  List of ACs:
    Gi0/1/0/3.2, state: up, Static MAC addresses: 0
  List of Access PWs:
      Neighbor 10.0.0.15 pw-id 15, state: standby, Static MAC addresses: 0
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.11 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0
```
#### 4.4.6 Split Horizon Groups (SHGs)

The split horizon rule dictates that a frame received on one VFI PW cannot be forwarded over another VFI PW. VFI N-PEs can be fully meshed.

This split horizon is enforced through a SHG:

* Members from one SHG cannot forward frames to each other, but can forward frames to members of other SHGs.
* All VFI PWs are assigned to SHG 1 by default. This ensures that there is no forwarding between VFI PWs so that the split horizon rule is enforced. Packets received on a VFI PW can be forwarded to ACs and access PWs because they are not part of the same SHG.
* All ACs and access PWs are not part of a SHG group by default, which means that packets received on an AC or access PW can be forwarded to another AC or access PW in the same bridge-domain.
* ACs and access PWs can be assigned to the SHG 2 with the **split-horizon group** command if the goal is to prevent forwarding between them.

```
RP/0/RSP0/CPU0:N-PE1#sh run l2vpn bridge group customer1 bridge-domain
   engineering
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface GigabitEthernet0/0/0/1.2
    split-horizon group
   !
   interface GigabitEthernet0/1/0/3.2
    split-horizon group
   !
   neighbor 10.0.0.15 pw-id 15
    split-horizon group
   !
   vfi customer1-engineering
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

```

In this configuration, there is no forwarding between Gi 0/0/0/1.2 and Gi 0/1/0/3.2, Gi 0/0/0/1.2 and 10.0.0.15, or Gi 0/1/0/3.2 and 10.0.0.15. But there can still be traffic forwarding between the ACs and the VFI PWs because they are part of different SHGs (1 and 2).

```
RP/0/RSP0/CPU0:N-PE1#sh l2vpn bridge-domain bd-name engineering detail  |
   i "state is|List of|VFI|Split"
  Split Horizon Group: none
  ACs: 2 (1 up), VFIs: 1, PWs: 4 (4 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/0/0/1.2, state is unresolved
      Split Horizon Group: enabled
    AC: GigabitEthernet0/1/0/3.2, state is up
      Split Horizon Group: enabled
  List of Access PWs:
    PW: neighbor 10.0.0.15, PW ID 15, state is up ( established )
      Split Horizon Group: enabled
  List of VFIs:
    VFI customer1-engineering (up)
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
      PW: neighbor 10.0.0.13, PW ID 2, state is up ( established )
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
      VFI Statistics:
```
#### 4.4.7 Redundancy

In an attempt to introduce redundancy, you can have a site that is dual attached to the VPLS domain:

![Redundancy](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-25.jpeg)

If a host connected to switch1 sends a broadcast, switch1 forwards it to router1 and to switch2. Router1 has a full mesh of PWs, so there is a PW to router2, and router1 forwards the broadcast over that PW. Router2 forwards the broadcast to switch2, which forwards it to switch1. This results in a physical loop.

#### 4.4.7.1 Spanning Tree

The full MST implementation does not work with VPLS because that implementation sends MST BPDUs on a main interface in order to control the forwarding state of all VLANs on that interface. With VPLS, there are VFIs for each bridge-domain, so you cannot send BPDUs on a main interface for all of those VFIs.

Spanning tree BPDUs are transported over VPLS and point-to-point PWs by default.

If switch1 and switch2 are sending per-VLAN BPDUs or untagged MST BPDUs and if the BPDUs match l2transport subinterfaces on router1 and router2, the BPDUs are transported through VPLS. The switches see each other's BPDUs on the Gi 0/1 interfaces, and spanning tree breaks the loop and blocks one port.

Switch2 is the root for VLAN 2:

```
switch2#sh spanning-tree vlan 2

MST0
  Spanning tree enabled protocol mstp
  Root ID    Priority    32768
             Address     0024.985e.6a00
             This bridge is the root
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32768  (priority 32768 sys-id-ext 0)
             Address     0024.985e.6a00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Desg FWD 20000     128.1    P2p Bound(PVST)
Gi0/2               Desg FWD 20000     128.2    P2p Bound(PVST)
```

Switch1 has its root port on Gi 0/1 and is blocking Gi 0/2:

```
switch1#sh spanning-tree vlan 2

VLAN0002
  Spanning tree enabled protocol ieee
  Root ID    Priority    32768
             Address     0024.985e.6a00
             Cost        4
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32770  (priority 32768 sys-id-ext 2)
             Address     0019.552b.b580
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time  300 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 4         128.1    P2p
Gi0/2               Altn BLK 4         128.2    P2p
```

The problem is that the BPDUs are also transported to remote sites, and spanning tree instability in one site propagates to all sites connected to the VPLS domain. It is safer to isolate each site and not transport BPDUs over VPLS.

One solution is use of an access gateway version of the STP. This is a limited implementation of the protocol, where the L2VPN PEs are configured to send some static BPDUs in order to appear connected to the spanning tree root. The L2VPN PE does not transport the BPDUs received from the CEs to the remote sites, so each site has its own spanning tree domain.

#### 4.4.7.2 MSTAG

As explained in the Spanning Tree section, MST sends untagged BPDUs, but these BPDUs control the forwarding state of all VLANs on the interface.

VLANs can be grouped into multiple instances, and each instance has its own forwarding state.

VLANs are usually grouped so that traffic can be spread evenly between multiple paths. When there are two paths, half of the traffic belongs to an instance that is forwarding on the first path and blocking on the second path. The other half of the traffic belongs to an instance that is blocking on the first path and forwarding on the second path. This allows for loadbalancing between the two paths under stable conditions. Otherwise, you have one path that is ordinarily completely blocked and becomes active only when the primary path is down.

Here is a typical MSTAG topology:

![Typical MSTAG Topology](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-26.jpeg)

In this lab example, instance 1 has VLAN 2, and instance 0 has the other VLANs. (In a more realistic scenario, VLANs are spread between multiple instance in order to achieve good traffic loadbalancing between the instances.) Because some VLANs have much more traffic than others, there are not always the same number of VLANs in each instance.

This is the configuration for MST instance 0:

* Router1 and router2 are sending some static BPDUs based on the MSTAG configuration. They are not processing the incoming BPDUs from the network or trying to run a full implementation. With MSTAG, the two L2VPN PEs just send static BPDUs based on their MSTAG configuration.
* Router1 is configured in order to attract traffic of instance 0 by appearing to be the root for that instance.
* Router2 is configured with the second-best root priority for instance 0, so that it becomes the new root in case of router1 failure or AC failure between switch1 and router1.
* Switch2 is configured with a high spanning tree cost on the port Gi 0/1 to router2 in order to ensure that its primary path to the root is on Gig 0/2 through switch1 and router1.
* Switch2 selects Gi 0/2 as root port for instance0 and selects Gi 0/1 as an alternate port in case the root is lost.
* Thus, traffic from that site in the VLANs belonging to instance 0 reaches other sites over VPLS through router1.

For MST instance 1 (VLAN 2), the configuration is reversed:

* Router2 is configured in order to attract traffic of instance 1 by appearing to be the root for that instance.
* Router1 is configured with the second-best root priority for instance 1, so that it becomes the new root in case of router2 failure or AC failure between switch2 and router2.
* Switch1 is configured with an high spanning tree cost on the port Gi 0/1 to router1 in order to ensure that its primary path to the root is on Gig 0/2 through switch2 and router2.
* Switch1 selects Gi 0/2 as root port for instance 1 and selects Gi 0/1 as an alternate port in case the root is lost.
* Thus, traffic from that site in the VLANs belonging to instance 1 (VLAN 2 in this example) reaches other sites over VPLS through router2.
* There must be a subinterface on router1 and router2 in order to catch the untagged TCNs and forward them through a point-to-point PW to the other router. Because switch1 and switch2 could lose their direct links and become isolated from each other, router1 and router2 must forward the TCNs between them through that point-to-point PW.
* The PEs also intercept the TCNs, flush their mac-address-tables, and send LDP MAC withdrawal to remote PEs.

This is the configuration on router1:

```
RP/0/RSP0/CPU0:router1#sh run int gigabitEthernet 0/1/0/3.*
interface GigabitEthernet0/1/0/3.1 l2transport
 encapsulation untagged
!
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group filter-stp egress
!
interface GigabitEthernet0/1/0/3.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group filter-stp egress
!

RP/0/RSP0/CPU0:router1#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/1/0/3.3
   !
   vfi customer1-finance
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:router1#sh run l2vpn xconnect group customer1
l2vpn
 xconnect group customer1
  p2p mstag-gi-0-1-0-3
   interface GigabitEthernet0/1/0/3.1
   neighbor 10.0.0.13 pw-id 103
   !
  !
 !
!

RP/0/RSP0/CPU0:router1#sh run spanning-tree mstag customer1-0-1-0-3
spanning-tree mstag customer1-0-1-0-3
 interface GigabitEthernet0/1/0/3.1
  name customer1
  revision 1
  bridge-id 0000.0000.0001
  instance 0
   root-id 0000.0000.0001
   priority 4096
   root-priority 4096
  !
  instance 1
   vlan-ids 2
   root-id 0000.0000.0002
   priority 8192
   root-priority 4096
  !
 !
!

RP/0/RSP0/CPU0:router1#sh spanning-tree mstag customer1-0-1-0-3
GigabitEthernet0/1/0/3.1
  Pre-empt delay is disabled
  Name:            customer1
  Revision:        1
  Max Age:         20
  Provider Bridge: no
  Bridge ID:       0000.0000.0001
  Port ID:         1
  External Cost:   0
  Hello Time:      2
  Active:          yes
  BPDUs sent:      3048
  MSTI 0 (CIST):
    VLAN IDs:         1,3-4094
    Role:             Designated
    Bridge Priority:  4096
    Port Priority:    128
    Cost:             0
    Root Bridge:      0000.0000.0001
    Root Priority:    4096
    Topology Changes: 369
  MSTI 1
    VLAN IDs:         2
    Role:             Designated
    Bridge Priority:  8192
    Port Priority:    128
    Cost:             0
    Root Bridge:      0000.0000.0002
    Root Priority:    4096
    Topology Changes: 322

```

In this configuration, note that:

* In MST instance 0, the root bridge is 0000.0000.0001, which is the bridge ID of router1.
* In MST instance 1, the root bridge is 0000.0000.0002, which is the bridge ID of router2.
* The bridge priority of router1 is 4096 in instance 0 (to become the root) and 8192 in instance 1 (to become the second-best root).
* The bridge priority of router1 is 8192 in instance 0 (to become the second-best root) and 4096 in instance 1 (to become the root).
* The point-to-point cross connect on GigabitEthernet0/1/0/3.1 carries the untagged MST TCNs to the other router.

An egress ACL has been configured on the dot1q subinterfaces in order to drop per-VLAN BPDUs that can be sent by another site that has not been migrated to MST yet. This configuration prevents the CE switch from declaring that the interface as inconsistent when it receives a per-VLAN BPDU on an interface configured for MST.

The configuration on router2 is very similar:

```
RP/0/RSP0/CPU0:router2#sh run int gig 0/1/0/3.*
interface GigabitEthernet0/1/0/3.1 l2transport
 encapsulation untagged
!
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group filter-stp egress
!
interface GigabitEthernet0/1/0/3.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group filter-stp egress
!

RP/0/RSP0/CPU0:router2#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/1/0/3.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:router2#sh run l2vpn xconnect group customer1
l2vpn
 xconnect group customer1
  p2p mstag-gi-0-1-0-3
   interface GigabitEthernet0/1/0/3.1
   neighbor 10.0.0.13 pw-id 103
   !
  !
 !
!

RP/0/RSP0/CPU0:router2#sh run spanning-tree mstag customer1-0-1-0-3
spanning-tree mstag customer1-0-1-0-3
 interface GigabitEthernet0/1/0/3.1
  name customer1
  revision 1
  bridge-id 0000.0000.0002
  instance 0
   root-id 0000.0000.0001
   priority 8192
   root-priority 4096
  !
  instance 1
   vlan-ids 2
   root-id 0000.0000.0002
   priority 4096
   root-priority 4096
  !
 !
!

RP/0/RSP0/CPU0:router2#sh spanning-tree mstag customer1-0-1-0-3
GigabitEthernet0/1/0/3.1
  Pre-empt delay is disabled
  Name:            customer1
  Revision:        1
  Max Age:         20
  Provider Bridge: no
  Bridge ID:       0000.0000.0002
  Port ID:         1
  External Cost:   0
  Hello Time:      2
  Active:          yes
  BPDUs sent:      3186
  MSTI 0 (CIST):
    VLAN IDs:         1,3-4094
    Role:             Designated
    Bridge Priority:  8192
    Port Priority:    128
    Cost:             0
    Root Bridge:      0000.0000.0001
    Root Priority:    4096
    Topology Changes: 365
  MSTI 1
    VLAN IDs:         2
    Role:             Designated
    Bridge Priority:  4096
    Port Priority:    128
    Cost:             0
    Root Bridge:      0000.0000.0002
    Root Priority:    4096
    Topology Changes: 177

```

This is the basic configuration on switch 1:

```
switch1#sh run | b spanning-tree
spanning-tree mode mst
spanning-tree extend system-id
!
spanning-tree mst configuration
 name customer1
 revision 1
 instance 1 vlan 2
!

switch1#sh run int gig 0/1 | i spanning
 spanning-tree mst 1 cost 100000

switch1#sh spanning-tree

MST0
  Spanning tree enabled protocol mstp
  Root ID    Priority    4096
             Address     0000.0000.0001
             Cost        0
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32768  (priority 32768 sys-id-ext 0)
             Address     0019.552b.b580
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 20000     128.1    P2p
Gi0/2               Desg FWD 20000     128.2    P2p

MST1
  Spanning tree enabled protocol mstp
  Root ID    Priority    4097
             Address     0000.0000.0002
             Cost        40000
             Port        2 (GigabitEthernet0/2)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0019.552b.b580
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Altn BLK 100000    128.1    P2p
Gi0/2               Root FWD 20000     128.2    P2p

```

Thus, traffic in instance 0 is forwarded through router1 and the traffic in instance 1 is forwarded through switch2 and router2.

The configuration on switch2 uses the same commands as switch1:

```
switch2#sh run | b spanning
spanning-tree mode mst
spanning-tree extend system-id
!
spanning-tree mst configuration
 name customer1
 revision 1
 instance 1 vlan 2
!

switch2#sh run int gig 0/1 | i spanning
 spanning-tree mst 0 cost 100000

switch2#sh spanning-tree

MST0
  Spanning tree enabled protocol mstp
  Root ID    Priority    4096
             Address     0000.0000.0001
             Cost        0
             Port        2 (GigabitEthernet0/2)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32768  (priority 32768 sys-id-ext 0)
             Address     0024.985e.6a00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Altn BLK 100000    128.1    P2p
Gi0/2               Root FWD 20000     128.2    P2p

MST1
  Spanning tree enabled protocol mstp
  Root ID    Priority    4097
             Address     0000.0000.0002
             Cost        20000
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0024.985e.6a00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 20000     128.1    P2p
Gi0/2               Desg FWD 20000     128.2    P2p

```

Switch2 goes through switch1 and router1 for instance0 and through router2 for instance1.

The traffic is loadbalanced because one instance exits the site through router1 and the other instance exits the site through router2.

If the link between router1 and switch1 is down, both instances go through router2.

```
switch1#sh spanning-tree

MST0
  Spanning tree enabled protocol mstp
  Root ID    Priority    4096
             Address     0000.0000.0001
             Cost        0
             Port        2 (GigabitEthernet0/2)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32768  (priority 32768 sys-id-ext 0)
             Address     0019.552b.b580
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/2               Root FWD 20000     128.2    P2p

MST1
  Spanning tree enabled protocol mstp
  Root ID    Priority    4097
             Address     0000.0000.0002
             Cost        40000
             Port        2 (GigabitEthernet0/2)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0019.552b.b580
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/2               Root FWD 20000     128.2    P2p

switch2#sh spanning-tree

MST0
  Spanning tree enabled protocol mstp
  Root ID    Priority    4096
             Address     0000.0000.0001
             Cost        0
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32768  (priority 32768 sys-id-ext 0)
             Address     0024.985e.6a00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 100000    128.1    P2p
Gi0/2               Desg FWD 20000     128.2    P2p

MST1
  Spanning tree enabled protocol mstp
  Root ID    Priority    4097
             Address     0000.0000.0002
             Cost        20000
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0024.985e.6a00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 20000     128.1    P2p
Gi0/2               Desg FWD 20000     128.2    P2p

```

Rapid convergence can be achieved in this type of failure because the path through the second-best root was already selected as the alternate path. With MSTAG, MST BPDUs are not transported over VPLS so sites are isolated from the instability in other sites.

#### 4.4.7.3 PVSTAG or PVRSTAG

MSTAG is the preferred access gateway protocol for VPLS because it uses the rapid spanning tree and because it is scalable with its use of instances rather than BPDUs on each VLAN.

If a site cannot be migrated to MST and the only solution is to keep running PVST+ or PVRST, you can use PVSTAG or PVRSTAG, but the implementation is limited to one specific topology:

![PVSTAG or PVRSTAG](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-27.jpeg)

In this topology, the most important restriction is that there can be only one CE switch. You cannot have two switches as in the MSTAG topology. In MSTAG, you can configure a point-to-point PW in order to transport the untagged traffic (including the BPDU TCNs) from one PE to the other when the site is split into two parts. With PVST and PVRST, the TCNs are sent tagged so they match the same subinterface as the data traffic to be transported over VPLS. The router would have to identify the BPDUs based on the MAC address and protocol type in order to forward the TCNs to the other side. Because this is not currently supported, there is a requirement to have only one CE device.

Another requirement in releases earlier than Cisco IOS XR Software Release 4.3.0 is that bundle interfaces cannot be used as ACs. This restriction has been lifted in Cisco IOS XR Software Release 4.3.0.

The principle is very much the same as with MSTAG. The PVSTAG router sends static BPDUs so that the CE appears to be connected to switches that are directly connected to the (virtual) root with a cost 0. In order to loadbalance the traffic, some VLANs can be configured with the root on router3 and others with the root on router4.

This is a configuration example on router3:

```
RP/0/RSP1/CPU0:router3#sh run int gigabitEthernet 0/0/0/1.*
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface GigabitEthernet0/0/0/1.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP1/CPU0:router3#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/0/0/1.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/0/0/1.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP1/CPU0:router3#sh run spanning-tree pvstag customer1-0-0-0-1
spanning-tree pvstag customer1-0-0-0-1
 interface GigabitEthernet0/0/0/1
  vlan 2
   root-priority 0
   root-id 0000.0000.0000
   root-cost 0
   priority 0
   bridge-id 0000.0000.0001
  !
  vlan 3
   root-priority 0
   root-id 0000.0000.0000
   root-cost 0
   priority 1
   bridge-id 0000.0000.0001
  !
 !
!

RP/0/RSP1/CPU0:router3#sh spanning-tree pvstag customer1-0-0-0-1
GigabitEthernet0/0/0/1
  VLAN 2
    Pre-empt delay is disabled
    Sub-interface:    GigabitEthernet0/0/0/1.2 (Up)
    Max Age:          20
    Root Priority:    0
    Root Bridge:      0000.0000.0000
    Cost:             0
    Bridge Priority:  0
    Bridge ID:        0000.0000.0001
    Port Priority:    128
    Port ID           1
    Hello Time:       2
    Active:           Yes
    BPDUs sent:       202821
    Topology Changes: 0
  VLAN 3
    Pre-empt delay is disabled
    Sub-interface:    GigabitEthernet0/0/0/1.3 (Up)
    Max Age:          20
    Root Priority:    0
    Root Bridge:      0000.0000.0000
    Cost:             0
    Bridge Priority:  1
    Bridge ID:        0000.0000.0001
    Port Priority:    128
    Port ID           1
    Hello Time:       2
    Active:           Yes
    BPDUs sent:       202821
    Topology Changes: 0
```

This is a configuration example on router4:

```
RP/0/RSP1/CPU0:router4#sh run int gig 0/0/0/1.*
interface GigabitEthernet0/0/0/1.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface GigabitEthernet0/0/0/1.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP1/CPU0:router4#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface GigabitEthernet0/0/0/1.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface GigabitEthernet0/0/0/1.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP1/CPU0:router4#sh run spanning-tree pvstag customer1-0-0-0-1
spanning-tree pvstag customer1-0-0-0-1
 interface GigabitEthernet0/0/0/1
  vlan 2
   root-priority 0
   root-id 0000.0000.0000
   root-cost 0
   priority 1
   bridge-id 0000.0000.0002
  !
  vlan 3
   root-priority 0
   root-id 0000.0000.0000
   root-cost 0
   priority 0
   bridge-id 0000.0000.0002
  !
 !
!

RP/0/RSP1/CPU0:router4#sh spanning-tree pvstag customer1-0-0-0-1
GigabitEthernet0/0/0/1
  VLAN 2
    Pre-empt delay is disabled
    Sub-interface:    GigabitEthernet0/0/0/1.2 (Up)
    Max Age:          20
    Root Priority:    0
    Root Bridge:      0000.0000.0000
    Cost:             0
    Bridge Priority:  1
    Bridge ID:        0000.0000.0002
    Port Priority:    128
    Port ID           1
    Hello Time:       2
    Active:           Yes
    BPDUs sent:       202799
    Topology Changes: 0
  VLAN 3
    Pre-empt delay is disabled
    Sub-interface:    GigabitEthernet0/0/0/1.3 (Up)
    Max Age:          20
    Root Priority:    0
    Root Bridge:      0000.0000.0000
    Cost:             0
    Bridge Priority:  0
    Bridge ID:        0000.0000.0002
    Port Priority:    128
    Port ID           1
    Hello Time:       2
    Active:           Yes
    BPDUs sent:       202799
    Topology Changes: 0

```

This is a configuration example on the CE switch3:

```
switch3#sh spanning-tree vlan 2

VLAN0002
  Spanning tree enabled protocol ieee
  Root ID    Priority    0
             Address     0000.0000.0000
             Cost        4
             Port        1 (GigabitEthernet0/1)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32770  (priority 32768 sys-id-ext 2)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 300

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Root FWD 4         128.1    P2p
Gi0/2               Altn BLK 4         128.2    P2p

switch3#sh spanning-tree vlan 3

VLAN0003
  Spanning tree enabled protocol ieee
  Root ID    Priority    0
             Address     0000.0000.0000
             Cost        4
             Port        2 (GigabitEthernet0/2)
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32771  (priority 32768 sys-id-ext 3)
             Address     001d.4603.1f00
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time 300

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- ------------------------------
Gi0/1               Altn BLK 4         128.1    P2p
Gi0/2               Root FWD 4         128.2    P2p
```

The configuration for PVSTAG is very similar to MSTAG except that the root-priority and the priority of the primary gateway are configured as 4096 and the priority of the backup gateway is configured as 8192 in the MSTAG example.

All other switches in the domains can have priorities higher than the ones configured in PVSTAG or PVRSTAG.

You can tune the interface cost on the CE switches in order to influence which port becomes the root port and which port is blocked.

#### 4.4.7.4 MC-LAG

The MC-LAG configuration with VPLS is simpler than point-to-point PWs with two-way PW redundancy. Instead of one primary PW and three standby PWs, the PEs only need a full mesh of VPLS PWs, which is standard with VPLS:

![MC-LAG](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-28.jpeg)

In this topology, note that:

* MC-LAG runs between the two VPLS PEs on the left: router2 and router4.
* Under normal conditions, the bundle members are active between router1 and router2 and in standby state between router1 and router4.
* Router2 has the bundle subinterfaces configured under VPLS bridge-domains, so router2 forwards the traffic to remote VPLS PEs. There are two sites illustrated in the topology diagram but there could be many more.
* The remote PEs learn the MAC addresses from router1 and devices behind through router2, so the PEs forward traffic for these destination MAC addresses through router2.
* When the link between router1 and router2 goes down or when router2 goes down, the bundle member between router1 and router4 goes active.
* Like router 2, router4 has its bundle subinterfaces configured under VPLS bridge-domains.
* When the bundle subinterfaces come up on router4, router4 sends LDP MAC withdrawal messages to the remote VPLS PEs in order to let them know that there is a topology change.

This is the configuration on router3:

```
RP/0/RSP1/CPU0:router3#sh run redundancy
redundancy
 iccp
  group 2
   mlacp node 1
   mlacp system mac 0200.0000.0002
   mlacp system priority 1
   mlacp connect timeout 0
   member
    neighbor 10.0.0.14
   !
   backbone
    interface TenGigE0/0/0/0
    interface TenGigE0/0/0/1
   !
   isolation recovery-delay 300
  !
 !
!

RP/0/RSP1/CPU0:router3#sh run int bundle-ether 222
interface Bundle-Ether222
 lacp switchover suppress-flaps 100
 mlacp iccp-group 2
 mlacp switchover type revertive
 mlacp switchover recovery-delay 40
 mlacp port-priority 1
 mac-address 0.0.2
 bundle wait-while 0
 bundle maximum-active links 1
 load-interval 30
!

RP/0/RSP1/CPU0:router3#sh run int bundle-ether 222.*
interface Bundle-Ether222.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface Bundle-Ether222.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP1/CPU0:router3#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface Bundle-Ether222.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface Bundle-Ether222.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

```

Once the MC-LAG bundle is configured, add it under the VPLS configuration like any other AC.

This is the corresponding configuration on router5:

```
RP/0/RSP1/CPU0:router5#sh run redundancy
redundancy
 iccp
  group 2
   mlacp node 2
   mlacp system mac 0200.0000.0002
   mlacp system priority 1
   mlacp connect timeout 0
   member
    neighbor 10.0.0.13
   !
   backbone
    interface TenGigE0/1/0/0
    interface TenGigE0/1/0/1
   !
   isolation recovery-delay 300
  !
 !
!

RP/0/RSP1/CPU0:router5#sh run int bundle-ether 222
interface Bundle-Ether222
 lacp switchover suppress-flaps 100
 mlacp iccp-group 2
 mlacp switchover type revertive
 mlacp switchover recovery-delay 40
 mac-address 0.0.2
 bundle wait-while 0
 bundle maximum-active links 1
 load-interval 30
!

RP/0/RSP1/CPU0:router5#sh run int bundle-ether 222.*
interface Bundle-Ether222.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!
interface Bundle-Ether222.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!

RP/0/RSP1/CPU0:router5#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface Bundle-Ether222.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface Bundle-Ether222.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
   !
  !
 !
!

```

Under normal circumstances, the bundle member between router3 and router6 is active, and the member between router5 and router6 is in standby state:

```
RP/0/RSP1/CPU0:router3#sh bundle bundle-ether 222

Bundle-Ether222
  Status:                                    Up
  Local links :   1 / 0 / 1
  Local bandwidth :     1000000 (1000000) kbps
  MAC address (source):                      0000.0000.0002 (Configured)
  Inter-chassis link:                        No
  Minimum active links / bandwidth:          1 / 1 kbps
  Maximum active links:                      1
  Wait while timer:                          Off
  Load balancing:                            Default
  LACP:                                      Operational
    Flap suppression timer:                  100 ms
    Cisco extensions:                        Disabled
  mLACP:                                     Operational
    ICCP Group:                              2
    Role:                                    Active
    Foreign links :       0 / 1
    Switchover type:                         Revertive
    Recovery delay:                          40 s
    Maximize threshold:                      1 link
  IPv4 BFD:                                  Not configured

  Port                  Device        State        Port ID         B/W, kbps
  --------------------  ------------  -----------  --------------  ----------
  Gi0/0/0/1             Local         Active       0x0001, 0x9001     1000000
      Link is Active
  Gi0/0/0/1             10.0.0.14     Standby      0x8000, 0xa002     1000000
      Link is marked as Standby by mLACP peer
RP/0/RSP1/CPU0:router3#

router6#sh etherchannel summary
Flags:  D - down        P - bundled in port-channel
        I - stand-alone s - suspended
        H - Hot-standby (LACP only)
        R - Layer3      S - Layer2
        U - in use      f - failed to allocate aggregator

        M - not in use, minimum links not met
        u - unsuitable for bundling
        w - waiting to be aggregated
        d - default port

Number of channel-groups in use: 1
Number of aggregators:           1

Group  Port-channel  Protocol    Ports
------+-------------+-----------+---------------------------------------------
2      Po2(SU)         LACP      Gi0/1(P)    Gi0/2(w)

router6#

```

Traffic from the CE is received on router3 and forwarded to remote PEs:

```
RP/0/RSP1/CPU0:router3#sh l2vpn bridge-domain group customer1
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 4, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    BE222.3, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      Neighbor 10.0.0.11 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.12 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 3, state: up, Static MAC addresses: 0
Bridge group: customer1, bridge-domain: engineering, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 3 (3 up), PBBs: 0 (0 up)
  List of ACs:
    BE222.2, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.11 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.12 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0

RP/0/RSP1/CPU0:router3#sh l2vpn forwarding bridge-domain customer1:
   engineering mac location 0/0/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-----------------------------------------------------------------------------
001d.4603.1f01 dynamic BE222.2                  0/0/CPU0   0d 0h 0m 0s N/A
001d.4603.1f42 dynamic BE222.2                  0/0/CPU0   0d 0h 0m 0s N/A
6c9c.ed3e.e46d dynamic (10.0.0.11, 2)           0/0/CPU0   0d 0h 0m 0s N/A
0019.552b.b5c3 dynamic (10.0.0.12, 2)           0/0/CPU0   0d 0h 0m 0s N/A

```

The last command illustrates that router3 is learning some MAC addresses on its bundle and the active members are on router3. On router5, there is no MAC address learned over the bundle as the local member is in standby state:

```
RP/0/RSP1/CPU0:router5#sh l2vpn forwarding bridge-domain customer1:engineering
   mac location 0/0/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-----------------------------------------------------------------------------
6c9c.ed3e.e46d dynamic (10.0.0.11, 2)           0/0/CPU0   0d 0h 0m 0s N/A
0019.552b.b5c3 dynamic (10.0.0.12, 2)           0/0/CPU0   0d 0h 0m 0s N/A
001d.4603.1f01 dynamic (10.0.0.13, 2)           0/0/CPU0   0d 0h 0m 0s N/A

```

When the bundle member between router3 and router6 goes down, the bundle member becomes active on router5. The MC-LAG VPLS PEs send an LDP MAC withdrawal message so that remote PEs purge their mac-address-tables and learn the MAC address through the new active MC-LAG PE router5.

Router2 receives a MAC withdrawal messages from router3 and router5 when the active MC-LAG bundle member moves from router3 to router5:

```
RP/0/RSP0/CPU0:router2#sh l2vpn bridge-domain group customer1 detail |
   i "state is|withd|bridge-domain"
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
    AC: GigabitEthernet0/1/0/3.3, state is up
      PW: neighbor 10.0.0.12, PW ID 3, state is up ( established )
        MAC withdraw message: send 0 receive 0
      PW: neighbor 10.0.0.13, PW ID 3, state is up ( established )
        MAC withdraw message: send 0 receive 1
      PW: neighbor 10.0.0.14, PW ID 3, state is up ( established )
        MAC withdraw message: send 0 receive 1
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
    AC: GigabitEthernet0/0/0/1.2, state is unresolved
    AC: GigabitEthernet0/1/0/3.2, state is up
    PW: neighbor 10.0.0.15, PW ID 15, state is up ( established )
      MAC withdraw message: send 2 receive 0
      PW: neighbor 10.0.0.12, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 0
      PW: neighbor 10.0.0.13, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 1
      PW: neighbor 10.0.0.14, PW ID 2, state is up ( established )
        MAC withdraw message: send 0 receive 1

```

The MAC addresses on router2 move from router3 (10.0.0.13) to router5 (10.0.0.14):

```
RP/0/RSP0/CPU0:router2#sh l2vpn forwarding bridge-domain customer1:
   engineering mac-address location 0/0/CPU0
 To Resynchronize MAC table from the Network Processors, use the command...
    l2vpn resynchronize forwarding mac-address-table location

Mac Address    Type    Learned from/Filtered on LC learned Resync Age  Mapped to
-----------------------------------------------------------------------------
6c9c.ed3e.e46d dynamic (10.0.0.15, 15)          0/0/CPU0   0d 0h 0m 0s N/A
0019.552b.b5c3 dynamic (10.0.0.12, 2)           0/0/CPU0   0d 0h 0m 0s N/A
001d.4603.1f02 dynamic (10.0.0.14, 2)           0/0/CPU0   0d 0h 0m 0s N/A
001d.4603.1f42 dynamic (10.0.0.14, 2)           0/0/CPU0   0d 0h 0m 0s N/A

```

With MC-LAG, a site can use a single bundle to be attached to the other sites through VPLS. MC-LAG provides the link and PE redundancy, but logically it is still one bundle interface to reach other sites. Spanning tree is not required on that bundle, and a BPDU filter could be configured on the CE in order to ensure that BPDUs are not exchanged between sites over VPLS.

Another option is configuration of an ethernet-services access-list on the ACs on the bundle in order to drop the destination MAC addresses of the BPDUs so the BPDUs are not transported between sites. However, if a backdoor link is introduced between the sites, spanning tree cannot break the loop because it is not running on the MC-LAG bundle. So, evaluate carefully whether to disable spanning tree on the MC-LAG bundle. If the topology between sites is carefully maintained, it is nice to have redundancy through MC-LAG without the need for spanning tree.

#### 4.4.7.5 ASR 9000 nV Edge Cluster

The MC-LAG solution provided redundancy without the need to use spanning tree. One drawback is that the bundle members to one MC-LAG PE are in standby state, so it is an active-standby solution that does not maximize the link usage.

Another design option is use of an ASR 9000 nV Edge cluster so that CEs can have bundle members to each cluster rack that are all active at the same time:

![ASR 9000 nV Edge Cluster](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-29.jpeg)

Another benefit of this solution is that the number of PWs is reduced because there is only one PW per cluster for each of the clusters at each site. When there are two PEs per site, each PE must have a PW to each of the two PEs at each site.

The simplicity of the configuration is another benefit. The configuration looks like a very basic VPLS configuration with a bridge-domain with bundle ACs and VFI PWs:

```
RP/1/RSP0/CPU0:router2#sh bundle bundle-ether 222

Bundle-Ether222
  Status:                                    Up
  Local links :   2 / 0 / 2
  Local bandwidth :     20000000 (20000000) kbps
  MAC address (source):                      0024.f71e.d309 (Configured)
  Inter-chassis link:                        No
  Minimum active links / bandwidth:          1 / 1 kbps
  Maximum active links:                      64
  Wait while timer:                          2000 ms
  Load balancing:                            Default
  LACP:                                      Not operational
    Flap suppression timer:                  Off
    Cisco extensions:                        Disabled
  mLACP:                                     Not configured
  IPv4 BFD:                                  Not configured

  Port                  Device         State        Port ID         B/W, kbps
  --------------------  -------------  -----------  --------------  ----------
  Te0/0/0/8             Local          Active       0x8000, 0x0005    10000000
      Link is Active
  Te1/0/0/8             Local          Active       0x8000, 0x0001    10000000
      Link is Active

RP/1/RSP0/CPU0:router2#sh run int bundle-ether 222.2
interface Bundle-Ether222.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
!

RP/1/RSP0/CPU0:router2#sh run int bundle-ether 222.3
interface Bundle-Ether222.3 l2transport
 encapsulation dot1q 3
 rewrite ingress tag pop 1 symmetric
!

RP/1/RSP0/CPU0:router2#sh run l2vpn bridge group customer1
l2vpn
 bridge group customer1
  bridge-domain finance
   interface Bundle-Ether222.3
   !
   vfi customer1-finance
    neighbor 10.0.0.11 pw-id 3
    !
    neighbor 10.0.0.12 pw-id 3
    !
    neighbor 10.0.0.13 pw-id 3
    !
    neighbor 10.0.0.14 pw-id 3
    !
   !
  !
  bridge-domain engineering
   interface Bundle-Ether222.2
   !
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/1/RSP0/CPU0:router2#sh l2vpn bridge-domain group customer1
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: finance, id: 3, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 4 (4 up), PBBs: 0 (0 up)
  List of ACs:
    BE222.3, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-finance (up)
      Neighbor 10.0.0.11 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.12 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 3, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 3, state: up, Static MAC addresses: 0
Bridge group: customer1, bridge-domain: engineering, id: 4, state: up,
   ShgId: 0, MSTi: 0
  Aging: 300 s, MAC limit: 4000, Action: none, Notification: syslog
  Filter MAC addresses: 0
  ACs: 1 (1 up), VFIs: 1, PWs: 4 (4 up), PBBs: 0 (0 up)
  List of ACs:
    BE222.2, state: up, Static MAC addresses: 0
  List of Access PWs:
  List of VFIs:
    VFI customer1-engineering (up)
      Neighbor 10.0.0.11 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.12 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.13 pw-id 2, state: up, Static MAC addresses: 0
      Neighbor 10.0.0.14 pw-id 2, state: up, Static MAC addresses: 0

```

Redundancy is provided by the bundle AC dual homed to the two racks so that the bundle remains up in case of bundle member failure or rack failure.

When a site is attached to the VPLS domain only through a cluster, the topology is similar to MC-LAG with regards to spanning tree. So spanning tree is not required on that bundle, and a BPDU filter could be configured on the CE in order to ensure that BPDUs are not exchanged between sites over VPLS.

Another option is configuration of an ethernet-services access-list on the ACs on the bundle in order to drop the destination MAC addresses of the BPDUs so the BPDUs are not transported between sites. However, if a backdoor link is introduced between the sites, spanning tree cannot break the loop because it is not running on the CE-PE bundle. So, evaluate carefully whether to disable spanning tree on that CE-PE bundle. If the topology between sites is carefully maintained, it is nice to have redundancy through the cluster without the need for spanning tree.

#### 4.4.7.6 ICCP-Based Service Multi-Homing (ICCP-SM) (PMCLAG (Pseudo MCLAG) and Active/Active)

There is a new feature introduced in Version 4.3.1 in order to overcome the limitation of MC-LAG, where some bundle links are unused as they remain in standby mode. In the new feature, called Pseudo MCLAG, all of the links from the DHD to the points of attachments (PoA) are in use, but the VLANs are split between the different bundles.

![ICCP-SM (Pseudo MCLAG)](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-30.jpeg)

### 4.5 Traffic Storm Control

In an L2 broadcast domain, there is the risk that a host can misbehave and send a high rate of broadcast or multicast frames that must be flooded everywhere in the bridge-domain. Another risk is creation of an L2 loop (that is not broken by spanning tree), which results in broadcasts and multicasts packets looping. A high rate of broadcasts and multicasts packets impacts the performance of the hosts in the broadcast domains.

Performance of switching devices in the network can also be affected by the replication of one input frame (broadcast, multicast or a unknown unicast frame) to multiple egress ports in the bridge-domain. Creation of multiple copies of the same packet can be resource-intensive, depending upon the place inside the device where the packet has to be replicated. For instance, replicating a broadcast to multiple different slots is not a problem because of the multicast replication capabilities of the fabric. The performance of a network processor can be impacted when it has to create multiple copies of the same packet to be sent on some ports that the network processor is handling.

In order to protect devices in case of a storm, the traffic storm control feature lets you configure a maximum rate of broadcasts, multicast and unknown unicasts to be accepted on a bridge-domain AC. See [Implementing Traffic Storm Control under a VPLS Bridge](https://www.cisco.com/c/en/us/td/docs/routers/asr9000/software/asr9k-r7-9/system-security/configuration/guide/b-system-security-cg-asr9000-79x/implementing-traffic-storm-control-under-a-vpls-bridge.html) for details.

Traffic storm control is not supported on a bundle AC interfaces or VFI PWs, but is supported on non-bundle ACs and access PWs. The feature is disabled by default; unless you set up storm control, you accept any rate of broadcasts, multicast, and unknown unicasts.

Here is an example configuration:

```
RP/0/RSP0/CPU0:router2#sh run l2vpn bridge group customer1 bridge-domain
   engineering
l2vpn
 bridge group customer1
  bridge-domain engineering
   interface GigabitEthernet0/1/0/3.2
    storm-control unknown-unicast pps 10000
    storm-control multicast pps 10000
    storm-control broadcast pps 1000
   !
   neighbor 10.0.0.15 pw-id 15
    storm-control unknown-unicast pps 10000
    storm-control multicast pps 10000
    storm-control broadcast pps 1000
   !
   vfi customer1-engineering
    neighbor 10.0.0.10 pw-id 2
    !
    neighbor 10.0.0.12 pw-id 2
    !
    neighbor 10.0.0.13 pw-id 2
    !
    neighbor 10.0.0.14 pw-id 2
    !
   !
  !
 !
!

RP/0/RSP0/CPU0:router2#sh l2vpn bridge-domain bd-name engineering det
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 5, state: up,
   ShgId: 0, MSTi: 0
  Coupled state: disabled
  MAC learning: enabled
  MAC withdraw: enabled
    MAC withdraw for Access PW: enabled
    MAC withdraw sent on bridge port down: disabled
  Flooding:
    Broadcast & Multicast: enabled
    Unknown unicast: enabled
  MAC aging time: 300 s, Type: inactivity
  MAC limit: 4000, Action: none, Notification: syslog
  MAC limit reached: no
  MAC port down flush: enabled
  MAC Secure: disabled, Logging: disabled
  Split Horizon Group: none
  Dynamic ARP Inspection: disabled, Logging: disabled
  IP Source Guard: disabled, Logging: disabled
  DHCPv4 snooping: disabled
  IGMP Snooping profile: none
  Bridge MTU: 1500
  MIB cvplsConfigIndex: 6
  Filter MAC addresses:
  Create time: 28/05/2013 17:17:03 (1w1d ago)
  No status change since creation
  ACs: 1 (1 up), VFIs: 1, PWs: 5 (5 up), PBBs: 0 (0 up)
  List of ACs:
    AC: GigabitEthernet0/1/0/3.2, state is up
      Type VLAN; Num Ranges: 1
      VLAN ranges: [2, 2]
      MTU 1500; XC ID 0xc40007; interworking none
      MAC learning: enabled
      Flooding:
        Broadcast & Multicast: enabled
        Unknown unicast: enabled
      MAC aging time: 300 s, Type: inactivity
      MAC limit: 4000, Action: none, Notification: syslog
      MAC limit reached: no
      MAC port down flush: enabled
      MAC Secure: disabled, Logging: disabled
      Split Horizon Group: none
      Dynamic ARP Inspection: disabled, Logging: disabled
      IP Source Guard: disabled, Logging: disabled
      DHCPv4 snooping: disabled
      IGMP Snooping profile: none
      Storm Control:
       Broadcast: enabled(1000)
       Multicast: enabled(10000)
       Unknown unicast: enabled(10000)
      Static MAC addresses:
      Statistics:
        packets: received 251295, sent 3555258
        bytes: received 18590814, sent 317984884
      Storm control drop counters:
        packets: broadcast 0, multicast 0, unknown unicast 0
        bytes: broadcast 0, multicast 0, unknown unicast 0
      Dynamic ARP inspection drop counters:
        packets: 0, bytes: 0
      IP source guard drop counters:
        packets: 0, bytes: 0
<snip>

```

The storm control drop counters are always present in the output of the **show l2vpn bridge-domain detail** command. Because the feature is disabled by default, the counters start to report drops only when the feature has been configured.

The configured rates can vary upon the traffic pattern from one network to another network. Before configuring a rate, Cisco recommends you understand the rate of broadcast, multicast or unknown unicast frames under normal circumstances. Then add a margin in the configured rate greater than the normal rate.

### 4.6 MAC Moves

In case of network instability like an interface flap, a MAC address can be learned from a new interface. This is normal network convergence, and the mac-address-table is updated dynamically.

However, constant MAC moves often indicate network instability, such as severe instability during an L2 loop. The MAC address security feature lets you report MAC moves and take corrective actions such as shutting down an offending port.

Even if a corrective action is not configured, you can configure the **logging** command so you are alerted of network instability through the MAC move messages:

```
l2vpn
 bridge group customer1
  bridge-domain engineering
   mac
    secure
     action none
     logging
    !
   !
```

In this example, the action is configured to none, so nothing is done when a MAC move is detected except that a syslog message is logged. This is an example message:

```
LC/0/0/CPU0:Dec 13 13:38:23.396 : l2fib[239]:
   %L2-L2FIB-5-SECURITY_MAC_SECURE_VIOLATION_AC : MAC secure in AC
   GigabitEthernet0_0_0_4.1310 detected violated packet - source MAC:
   0000.0000.0001, destination MAC: 0000.0001.0001; action: none
```
### 4.7 IGMP and MLD Snooping

By default, multicast frames are flooded to all ports in a bridge-domain. When you are using high rate streams like IP television (IPTV) services, there can be a significant amount of traffic forwarded on all ports and replicated over multiple PWs. If all TV streams are forwarded over one interface, this can congest ports. The only option is configuration of a feature such as IGMP or MLD snooping, which intercepts multicast control packets in order to track the receivers and multicast routers and forward streams on the ports only when appropriate.

See the [Multicast Configuration Guide for Cisco ASR 9000 Series Routers, IOS XR Release 7.9.x](https://www.cisco.com/c/en/us/td/docs/routers/asr9000/software/asr9k-r7-9/configuration/guide/b-multicast-cg-asr9k-79x.html) for further information on these features.

## 5. Additional L2VPN Topics

### 5.1 Loadbalancing

When an L2VPN PE needs to send a frame over an MPLS PW, the Ethernet frame is encapsulated into an MPLS frame with one or more MPLS labels; there is at least one PW label and perhaps an IGP label in order to reach the remote PE.

The MPLS frame is transported by the MPLS network to the remote L2VPN PE. There are typically multiple paths to reach the destination PE:

![Loadbalancing](/c/dam/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00-31.jpeg)

**Note**: Not all links are represented in this diagram.

PE1 can choose between P1 and P2 as the first MPLS P router towards PE2. If P1 is selected, PE1 then chooses between P3 and P4, and so on. The available paths are based on IGP topology and the MPLS TE tunnel path.

MPLS service providers prefer to have all links equally utilized rather than one congested link with other underutilized links. This goal is not always easy to achieve because some PWs carry much more traffic than others and because the path taken by a PW traffic depends upon the hashing algorithm used in the core. Multiple high bandwidth PWs can be hashed to the same links, which creates congestion.

A very important requirement is that all packets from one flow can follow the same path. Otherwise, this leads to out-of-order frames, which can impact the quality or the performance of the applications.

Loadbalancing in an MPLS network on Cisco routers is typically based upon the data that follows the bottom MPLS label.

* If the data immediately after the bottom label starts with 0x4 or 0x6, an MPLS P router assumes that there is an IPv4 or IPv6 packet inside the MPLS packet and tries to loadbalance based on a hash of the source and destination IPv4 or IPv6 addresses extracted from the frame. In theory, this can not apply to an Ethernet frame that is encapsulated and transported over a PW because the destination MAC address follows the bottom label. But recently some MAC address ranges that start with 0x4 and 0x6 have been assigned. The MPLS P router can incorrectly consider that the Ethernet header is actually an IPv4 header and hash the frame based upon what it assumes is the IPv4 source and destination addresses. Ethernet frames from a PW can be hashed over different paths in the MPLS core, which leads to out-of-sequence frames in the PW and application quality issues. The solution is configuration of a control-word under a pw-class that can be attached to a point-to-point or VPLS PW. The control word is inserted immediately after the MPLS labels. The control word does not start with 0x4 or 0x6 so the problem is avoided.

  ```
  RP/1/RSP0/CPU0:router#sh run l2vpn bridge group customer1 bridge-domain
     engineering
  l2vpn
   pw-class control-word
    encapsulation mpls
     control-word
    !
   !
   bridge group customer1
    bridge-domain engineering
     vfi customer1-engineering
      neighbor 10.0.0.11 pw-id 2
       pw-class control-word
      !
  <snip>

  RP/1/RSP0/CPU0:router#sh l2vpn bridge-domain bd-name engineering det
  Legend: pp = Partially Programmed.
  Bridge group: customer1, bridge-domain: engineering, id: 4, state: up,
     ShgId: 0, MSTi: 0
  <snip>
    List of VFIs:
      VFI customer1-engineering (up)
        PW: neighbor 10.0.0.11, PW ID 2, state is up ( established )
          PW class control-word, XC ID 0xc000000a
          Encapsulation MPLS, protocol LDP
          Source address 10.0.0.10
          PW type Ethernet, control word enabled, interworking none
          Sequencing not set

          PW Status TLV in use
            MPLS         Local                          Remote
            ------------ ------------------------------ ------------------
            Label        281708                         16043
            Group ID     0x4                            0x5
            Interface    customer1-engineering          customer1-engineering
            MTU          1500                           1500
            Control word enabled                        enabled
            PW type      Ethernet                       Ethernet
            VCCV CV type 0x2                            0x2
                         (LSP ping verification)        (LSP ping verification)
            VCCV CC type 0x7                            0x7
                         (control word)                 (control word)
                         (router alert label)           (router alert label)
                         (TTL expiry)                   (TTL expiry)
            ------------ ------------------------------ ------------------
  ```
* If the data immediately after the bottom of the MPLS label stack does not start with 0x4 or 0x6, the P router loadbalances based upon the bottom label. All traffic from one PW follows the same path, so out-of-order packets do not occur, but this can lead to congestion on some links in case of high bandwidth PWs. With Cisco IOS XR Software Release 4.2.1, the ASR 9000 supports the Flow Aware Transport (FAT) PW feature. This feature runs on the L2VPN PEs, where it is negotiated between the two ends of a point-to-point or VPLS PW. The ingress L2VPN PE detects flows on the AC and the L2VPN configuration and inserts a new MPLS flow label under the PW MPLS label at the bottom of the MPLS label stack. The ingress PE detects flows based upon the source and destination MAC addresses (default) or the source and destination IPv4 addresses (configurable). Use of the MAC addresses is the default; use of IPv4 addresses is recommended, but must be configured manually.

  With the FAT PW feature, the ingress L2VPN PE inserts one bottom MPLS label per src-dst-mac or per src-dst-ip. The MPLS P routers (between the PEs) hash frames over the available paths, then reach the destination PE based on that FAT PW flow label at the bottom of the MPLS stack. This generally provides much better bandwidth utilization in the core unless a PW carries only a small number of src-dst-mac or src-dst-ip conversations. Cisco recommends that you use a control word so you can avoid having MAC addresses that start with 0x4 and 0x6 immediately after the flow label. This ensures the hash is correctly based upon the pseudo IP addresses and not based on the flow label.

  With this feature, the traffic from one PW is loadbalanced over multiple paths in the core when available. Application traffic does not suffer from out-of-order packets because all traffic from the same source (MAC or IP) to the same destination (MAC or IP) follows the same path.

This is an example configuration:

```
l2vpn
 pw-class fat-pw
  encapsulation mpls
   control-word
   load-balancing
    flow-label both
   !
  !
 !
 bridge group customer1
  bridge-domain engineering
   vfi customer1-engineering
    neighbor 10.0.0.11 pw-id 2
     pw-class fat-pw

RP/1/RSP0/CPU0:router#sh l2vpn bridge-domain bd-name engineering det
Legend: pp = Partially Programmed.
Bridge group: customer1, bridge-domain: engineering, id: 4, state: up,
   ShgId: 0, MSTi: 0
<snip>
  List of VFIs:
    VFI customer1-engineering (up)
      PW: neighbor 10.0.0.11, PW ID 2, state is up ( established )
        PW class fat-pw, XC ID 0xc000000a
        Encapsulation MPLS, protocol LDP
        Source address 10.0.0.10
        PW type Ethernet, control word enabled, interworking none
        Sequencing not set
        Load Balance Hashing: src-dst-ip
        Flow Label flags configured (Tx=1,Rx=1), negotiated (Tx=1,Rx=1)

        PW Status TLV in use
          MPLS         Local                          Remote
          ------------ ------------------------------ ------------------
          Label        281708                         16043
          Group ID     0x4                            0x5
          Interface    customer1-engineering          customer1-engineering
          MTU          1500                           1500
          Control word enabled                        enabled
          PW type      Ethernet                       Ethernet
          VCCV CV type 0x2                            0x2
                       (LSP ping verification)        (LSP ping verification)
          VCCV CC type 0x7                            0x7
                       (control word)                 (control word)
                       (router alert label)           (router alert label)
                       (TTL expiry)                   (TTL expiry)
          ------------ ------------------------------ ------------------
```
### 5.2 Logging

Different types of logging messages can be configured in the L2VPN configuration mode. Configure l2vpn logging in order to receive syslog alerts for L2VPN events, and configure logging pseudowire in order to determine when a PW status changes:

```
l2vpn
 logging
  bridge-domain
  pseudowire
  nsr
 !

```

If many PWs are configured, messages can flood the log.

### 5.3 ethernet-services access-list

You can use an ethernet-services access-list in order to drop traffic from specific hosts or verify if a router is getting packets from a host on an l2transport interface:

```
RP/0/RSP0/CPU0:router#sh run ethernet-services access-list count-packets
ethernet-services access-list count-packets
 10 permit host 001d.4603.1f42 host 0019.552b.b5c3
 20 permit any any
!

RP/0/RSP0/CPU0:router#sh run int gig 0/1/0/3.2
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
 ethernet-services access-group count-packets egress
!

RP/0/RSP0/CPU0:router#sh access-lists ethernet-services count-packets
   hardware egress location 0/1/CPU0
ethernet-services access-list count-packets
 10 permit host 001d.4603.1f42 host 0019.552b.b5c3 (5 hw matches)
 20 permit any any (30 hw matches)

```

The hardware matches can be seen only with the hardware keyword. Use the ingress or egress keyword depending upon the direction of the access-group. The linecard location of the interface where the access-list is applied is also specified.

You can also apply an ipv4 access-list on a l2transport interface as a security or troubleshooting feature:

```
RP/0/RSP0/CPU0:router#sh run ipv4 access-list count-pings
ipv4 access-list count-pings
 10 permit icmp host 192.168.2.1 host 192.168.2.2
 20 permit ipv4 any any
!

RP/0/RSP0/CPU0:router#sh run int gig 0/1/0/3.2
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
 rewrite ingress tag pop 1 symmetric
 ipv4 access-group count-pings ingress
!

RP/0/RSP0/CPU0:router#sh access-lists ipv4 count-pings hardware ingress
   location 0/1/CPU0
ipv4 access-list count-pings
 10 permit icmp host 192.168.2.1 host 192.168.2.2 (5 hw matches)
 20 permit ipv4 any any (6 hw matches)

```
### 5.4 ethernet egress-filter

In the egress direction of an AC, suppose there is no **rewrite ingress tag pop <> symmetric** command that determines the egress VLAN tags. In that case, there is no check in order to ensure that the outgoing frame has the correct VLAN tags according to the **encapsulation** command.

This is an example configuration:

```
interface GigabitEthernet0/1/0/3.2 l2transport
 encapsulation dot1q 2
!
interface GigabitEthernet0/1/0/3.3 l2transport
 encapsulation dot1q 3
!
interface GigabitEthernet0/1/0/39.2 l2transport
 encapsulation dot1q 2
!
l2vpn
 bridge group customer2
  bridge-domain test
   interface GigabitEthernet0/1/0/3.2
   !
   interface GigabitEthernet0/1/0/3.3
   !
   interface GigabitEthernet0/1/0/39.2
   !
  !
 !
!

```

In this configuration:

* A broadcast received with a dot1q tag 2 on GigabitEthernet0/1/0/39.2 keeps its incoming tag because there is no **rewrite ingress** command.
* That broadcast is flooded out of GigabitEthernet0/1/0/3.2 with its dot1q tag 2, but that does not cause a problem because GigabitEthernet0/1/0/3.2 is also configured with the dot1q tag 2.
* That broadcast is also flooded out of GigabitEthernet0/1/0/3.3, which keeps its original tag 2 because there is no **rewrite** command on GigabitEthernet0/1/0/3.3. The **encapsulation dot1q 3** command on GigabitEthernet0/1/0/3.3 is not checked in the egress direction.
* The result is that, for one broadcast received with tag 2 on GigabitEthernet0/1/0/39, there are two broadcasts with tag 2 going out of GigabitEthernet0/1/0/3. That duplicated traffic can cause some application issues.
* The solution is configuration of ethernet egress-filter strict in order to ensure that packets leave the subinterface with the correct VLAN tags. Otherwise, the packets are not forwarded and are dropped.

```
interface GigabitEthernet0/1/0/3.2 l2transport
 ethernet egress-filter strict
!
interface GigabitEthernet0/1/0/3.3 l2transport
 ethernet egress-filter strict
!
```

### Revision History

| Revision | Publish Date | Comments |
| --- | --- | --- |
| 2.0 | 13-Jan-2025 | Added Alt Text. Updated PII, SEO, Branding Requirements, Machine Translation, Style Requirements, Target Links, Article Descripton, and Formatting. |
| 1.0 | 07-Aug-2013 | Initial Release |

![TAC Authored](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

### Contributed by Cisco Engineers

* Jean-Christophe RodePrincipal Software Engineer
* David PowersHigh Touch Engineering Technical Leader

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [ASR 9000 Series Aggregation Services Routers](/c/en/us/support/routers/asr-9000-series-aggregation-services-routers/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_93a40bb9_20250115_120009.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco Access Points VLAN Bypass from Native VLAN Vulnerability Medium   Advisory ID:  cisco-sa-apvlan-TDTtb4FY  First Published: 2022 September 27 16:00 GMT  Last Updated:  2022 October 4 13:22 GMT  Version 1.1:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCvz99036](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz99036)     CVE-2022-20728     CWE-284       CVSS Score: [Base 4.7](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2022-20728     CWE-284       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY/csaf/cisco-sa-apvlan-TDTtb4FY.json)   Email      Summary  * A vulnerability in the client forwarding code of multiple Cisco Access Points (APs) could allow an unauthenticated, adjacent attacker to inject packets from the native VLAN to clients within nonnative VLANs on an affected device.  This vulnerability is due to a logic error on the AP that forwards packets that are destined to a wireless client if they are received on the native VLAN. An attacker could exploit this vulnerability by obtaining access to the native VLAN and directing traffic directly to the client through their MAC/IP combination. A successful exploit could allow the attacker to bypass VLAN separation and potentially also bypass any Layer 3 protection mechanisms that are deployed.  Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY>  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected the following Cisco products if they were running a vulnerable release of Cisco Aironet Series Access Points Software in either local or flex local switching modes:    + 6300 Series Embedded Services Access Points (ESW6300)   + Aironet 1540 Series Access Points   + Aironet 1560 Series Access Points   + Aironet 1800 Series Access Points   + Aironet 2800 Series Access Points   + Aironet 3800 Series Access Points   + Aironet 4800 Access Points   + Business 100 Series Access Points   + Business 200 Series Access Points   + Catalyst 9100 Access Points   + Catalyst IW 6300 Heavy Duty Series Access Points   + Integrated AP on 1100 Integrated Services Routers For information about which Cisco software releases were vulnerable at the time of publication, see the [Fixed Software](#fs) section of this advisory. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Cisco has confirmed that this vulnerability does not affect any Cisco Access Point series that is not listed in the [Vulnerable Products](#vp) section of this advisory.  Details  * In order to exploit this vulnerability, an attacker must be able to inject traffic into the native VLAN of an AP.  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed Releases At the time of publication, the release information in the following table(s) was accurate. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.  The left column lists Cisco software releases, and the right column indicates whether a release was affected by the vulnerability that is described in this advisory and which release included the fix for this vulnerability.  **Access Points Managed by Wireless LAN Controller**          | Cisco Wireless LAN Controller Software Release | First Fixed Release |   | --- | --- |   | 8.5 and earlier | Migrate to a fixed release. |   | 8.10 | 8.10.181.0 |       **Access Points Managed by Catalyst 9800 Wireless Controller**       | Cisco Catalyst 9800 Wireless Controller Software Release | First Fixed Release |   | --- | --- |   | 17.2 and earlier | Migrate to a fixed release. |   | 17.3 | Migrate to 17.3.6 and apply APSP patch (APSP patch no. TBD) |   | 17.4 | Migrate to a fixed release. |   | 17.5 | Migrate to a fixed release. |   | 17.6 | 17.6.2 |   | 17.7 and later | Not affected. |       The Cisco Product Security Incident Response Team (PSIRT) validates only the affected and fixed release information that is documented in this advisory.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.  Source  * This vulnerability was found by Javier Contreras of Cisco during internal security testing.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.1 | Updated Fixed Release information for Cisco Wireless LAN Controller Software Release. | Fixed Software | Final | 2022-OCT-04 |   | 1.0 | Initial public release. | - | Final | 2022-SEP-27 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_87286ed3_20250115_180550.html ===


# Cisco Security

## Cisco Security

| | The Page You Have Requested Is Not Available The Cisco Security that you are trying to access may have been relocated or removed.  If you typed the address, please verify that your entry was correct.  You may find what you are looking for through the [Advanced Search](https://tools.cisco.com/security/center/search.x) functionality of [Cisco Security](https://tools.cisco.com/security/center/home.x). Report a Broken Link Please use this form to report broken links on Cisco.com.  <<  Go Back to Previous Page |   Related LinksSolutions  * [Security Solutions](http://www.cisco.com/en/US/products/hw/vpndevc/solutions.html) * [E-mail Security](http://www.cisco.com/en/US/products/ps10154/index.html) * [Threat Control for Endpoints](http://www.cisco.com/en/US/netsol/ns681/index.html) * [Threat Control for Infrastructure](http://www.cisco.com/en/US/netsol/ns680/index.html)  Products & Services  * [Security Services](http://www.cisco.com/en/US/products/svcs/ps2961/ps2952/serv_group_home.html) * [Security Products](http://www.cisco.com/en/US/products/hw/vpndevc/index.html) * [Cisco IntelliShield Alert Manager](http://www.cisco.com/en/US/products/ps6834/serv_group_home.html)  About Cisco  * [Cisco Global Government Affairs](http://www.cisco.com/web/about/gov/index.html) * [High Tech Policy Blog](http://blogs.cisco.com/gov/) * [High Tech Policy Guide](http://www.cisco.com/web/about/gov/policy_guide.html) | | --- | --- | |
| --- | --- | --- |



=== Content from sec.cloudapps.cisco.com_6bc878d7_20250115_120010.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from standards.ieee.org_239a028e_20250114_200850.html ===


* [IEEE.org](https://www.ieee.org/ "IEEE.org")
* [IEEE *Xplore*
  Digital Library](https://ieeexplore.ieee.org/Xplore/home.jsp "IEEE Xplore Digital Library")
* [IEEE Standards](https://standards.ieee.org/ "IEEE Standards")
* [IEEE Spectrum](https://spectrum.ieee.org/ "IEEE Spectrum")
* [More Sites](https://www.ieee.org/sitemap.html "More Sites")

* [eTools](/develop/etools/ "eTools")

[![IEEE Standards Association (IEEE SA) Logo](data:image/gif;base64...)](/ "IEEE Standards Association")

[![IEEE Logo](data:image/gif;base64...)](https://www.ieee.org/ "Visit IEEE.org")

* Standards
  + [Access Standards](https://standards.ieee.org/access-standards/)
  + [Search Standards](https://standards.ieee.org/standard/)
  + [Standards Development](https://standards.ieee.org/develop/)
  + [Standards Adoption](https://standards.ieee.org/develop/standards-adoption/)
  + [Where Life Meets Standards](https://standards.ieee.org/about/standards-in-action/)
* Products & Programs
  + [Alliance Management Services](https://standards.ieee.org/products-programs/ams/)
  + [Conformity Assessment & Certification](https://standards.ieee.org/products-programs/icap/)
  + [IEEE SA Open Source](https://standards.ieee.org/initiatives/opensource/)
  + [Industry Affiliate Network (IAN)](https://standards.ieee.org/products-programs/industry-affiliate-network/)
  + [Industry Connections](https://standards.ieee.org/industry-connections/)
  + [The National Electrical Safety Code® (NESC®)](https://standards.ieee.org/products-programs/nesc/)
  + [Registration Authority](https://standards.ieee.org/products-programs/regauth/)
  + [Government Engagement Program on Standards (GEPS)](https://standards.ieee.org/about/intl/government-engagement-program/)
  + [Standards Fellowship](https://standards.ieee.org/about/intl/standards-fellowship-program/)
  + [All Products & Programs](https://standards.ieee.org/products-programs/)
* Focuses
  + [Autonomous and Intelligent Systems (AIS)](https://standards.ieee.org/initiatives/autonomous-intelligence-systems/)
  + [Connectivity & Telecom](https://standards.ieee.org/practices/connectivity-telecom/)
  + [Energy](https://standards.ieee.org/practices/energy/)
  + [Foundational Technologies](https://standards.ieee.org/practices/foundational/)
  + [Government Engagement](https://standards.ieee.org/about/intl/)
  + [Healthcare and Life Sciences](https://standards.ieee.org/practices/healthcare-life-sciences/)
  + [Mobility](https://standards.ieee.org/practices/mobility/)
* Get Involved
  + [How to Get Involved](https://standards.ieee.org/participate/)
  + [Events](https://standards.ieee.org/events/)
  + [IEEE SA Membership](https://standards.ieee.org/about/membership/)
* Resources
  + [Training & Development](https://standards.ieee.org/about/training/)
  + [News](https://standards.ieee.org/news/)
  + [IEEE SA Newsletter](https://standards.ieee.org/news/swire/)
  + [Standards Store](https://store.accuristech.com/ieee?utm_source=standards&utm_medium=web&utm_campaign=standards-referral "Standards Store (Opens in a New Tab)")
  + [Beyond Standards Blog](https://standards.ieee.org/beyond-standards/)
  + [Where Life Meets Standards](https://standards.ieee.org/about/standards-in-action/)
  + [About Us](https://standards.ieee.org/about/)
  + [Contact Us](https://standards.ieee.org/about/contact/)
  + [Provide Feedback](https://standards.ieee.org/about/feedback/)
* [MAC ADDRESS](https://standards.ieee.org/products-programs/regauth/mac/)

## Featured Links

* [IEEE Conformity Assessment Program (ICAP)](https://standards.ieee.org/products-programs/icap/)
* [IEEE SA Entity Membership](https://standards.ieee.org/about/membership/organizations/)
* [Strong Sustainability by Design: IEEE Planet Positive 2030](https://sagroups.ieee.org/planetpositive2030/our-work/)

## Quick Links

* [Search Standards](https://standards.ieee.org/standard/)
* [Access Standards](https://standards.ieee.org/access-standards/)
* [IEEE SA Membership](https://standards.ieee.org/about/membership/)

## Most Viewed Pages

* [Search](https://standards.ieee.org/search/ "Search")
* [Home](https://standards.ieee.org/ "Home")
* [Registration Authority](https://standards.ieee.org/products-programs/regauth/ "Registration Authority")

Search the IEEE SA Website...

[MAC ADDRESS](/products-programs/regauth/)

Active Standard

# IEEE 802.1Q-2022

## IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks

[Access via the IEEE Get Program](https://ieeexplore.ieee.org/browse/standards/get-program/page)
[Access via Subscription](http://ieeexplore.ieee.org/servlet/opac?punumber=10004496)

1. [Home](https://standards.ieee.org "Home")
2. [Standards](https://standards.ieee.org/search/?q=Standard "Standards")
3. IEEE Standard for Local and Metropolitan Area Networks–Bridges and Bridged Networks

This standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms. (The PDF of this standard is available at no cost compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

Standard Committee
[C/LAN/MAN - LAN/MAN Standards Committee](http://www.ieee802.org/)

Status
Active Standard
PAR Approval
[2020-06-03](https://development.standards.ieee.org/myproject-web/public/view.html#pardetail/8226)

Superseding
[802.1Q-2018](https://standards.ieee.org/ieee/802.1Q/6844)

Amendments
[802.1Qcj-2023](https://standards.ieee.org/ieee/802.1Qcj/6160)

[802.1Qcw-2023](https://standards.ieee.org/ieee/802.1Qcw/7134)

[802.1Qcz-2023](https://standards.ieee.org/ieee/802.1Qcz/7372)

[802.1Qdj-2024](https://standards.ieee.org/ieee/802.1Qdj/7669)

[802.1Qdx-2024](https://standards.ieee.org/ieee/802.1Qdx/11271)

Proposed Amendments
[P802.1Qdq](https://standards.ieee.org/ieee/802.1Qdq/10609)

[P802.1Qdt](https://standards.ieee.org/ieee/802.1Qdt/11256)

[P802.1Qdv](https://standards.ieee.org/ieee/802.1Qdv/11018)

[P802.1Qdw](https://standards.ieee.org/ieee/802.1Qdw/11019)

[P802.1Qdy](https://standards.ieee.org/ieee/802.1Qdy/11392)

Board Approval
2022-09-21
History
Published:
2022-12-22

### Working Group Details

Society
[IEEE Computer Society](http://www.computer.org "IEEE Computer Society")
Standard Committee
[C/LAN/MAN - LAN/MAN Standards Committee](http://www.ieee802.org/ "C/LAN/MAN - LAN/MAN Standards Committee")

Working Group
802.1 WG - Higher Layer LAN Protocols Working Group

IEEE Program Manager
Jodi Haasz
Contact Jodi Haasz

Working Group Chair
Glenn Parsons

#### Other Activities From This Working Group

* Active Projects
* Active Standards
* Superseded
  Standards
* Inactive-Withdrawn Standards
* Inactive-Reserved Standards

**Current projects that have been authorized by the IEEE SA Standards
Board to develop a standard.**

---

##### P60802

###### IEEE/IEC Draft International Standard Time-Sensitive Networking Profile for Industrial Automation

This document defines time-sensitive networking profiles for industrial automation. The profiles select features, options, configurations, defaults, protocols, and procedures of bridges, end stations, and LANs to build industrial automation networks. This document specifies YANG modules defining read-only information available online and offline as a digital data sheet. This document also specifies YANG modules for remote procedure calls and actions to address requirements arising from industrial automation networks.

[Learn More
About P60802](https://standards.ieee.org/ieee/60802/11358 "Learn More")

##### P802

###### IEEE Draft Standard for Local and Metropolitan Area Networks: Overview and Architecture

This standard provides an overview to the family of IEEE 802® standards. It describes the reference models for the IEEE 802 standards and explains the relationship of these standards to the higher layer protocols; it provides a standard for the structure of IEEE 802 MAC addresses; it provides a standard for identification of public, private, prototype, and standard protocols; it specifies an object identifier hierarchy used within IEEE 802 for uniform allocation of object identifiers used in IEEE 802 standards; and it specifies a method for higher layer protocol identification.

[Learn More
About P802](https://standards.ieee.org/ieee/802/10894 "Learn More")

##### P802.1AB

###### Standard for Local and metropolitan area networks - Station and Media Access Control Connectivity Discovery

The standard defines a protocol and management elements, suitable for advertising information to stations attached to the same IEEE 802 LAN, for the purpose of populating physical topology and device discovery management information databases. The protocol facilitates the identification of stations connected by IEEE 802 LANs/MANs, their points of interconnection, and access points for management protocols. This standard defines a protocol that a) Advertises connectivity and management information about the local station to adjacent stations on the same IEEE 802 LAN. b) Receives network management information from adjacent stations on the same IEEE 802 LAN. c) Operates with all IEEE 802 access protocols and network media. d) Establishes a network management information schema and object definitions that are suitable for storing connection information about adjacent stations. e) Provides compatibility with the IETF Physical Topology Management Information Base (MIB).

[Learn More
About P802.1AB](https://standards.ieee.org/ieee/802.1AB/11787 "Learn More")

##### P802.1AC

###### Standard for Local and metropolitan area networks -- Media Access Control (MAC) Service Definition

The standard defines the Media Access Control (MAC) Service provided by all IEEE 802(R) MACs, and the Internal Sublayer Service (ISS) provided within MAC Bridges, in abstract terms of the following: a) Their semantics, primitive actions, and events; and b) The parameters of, interrelationship between, and valid sequences of these actions and events.

[Learn More
About P802.1AC](https://standards.ieee.org/ieee/802.1AC/11788 "Learn More")

##### P802.1ACea

###### IEEE Standard for Local and metropolitan area networks -- Media Access Control (MAC) Service Definition Amendment: Support for IEEE Std 802.15.6

This project adds support of the Internal Sublayer Service by the IEEE Std 802.15.6 MAC entity. This amendment also includes technical and editorial corrections in the description of existing IEEE Std 802.1AC functionality.

[Learn More
About P802.1ACea](https://standards.ieee.org/ieee/802.1ACea/11526 "Learn More")

##### P802.1AS

###### Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications

This standard specifies protocols, procedures, and managed objects used to ensure that the synchronization requirements are met for time-sensitive applications, such as audio, video, and time-sensitive control, across networks, for example, IEEE 802 and similar media. This includes the maintenance of synchronized time during normal operation and following addition, removal, or failure of network components and network reconfiguration. It specifies the use of IEEE 1588(TM) specifications where applicable in the context of IEEE Std 802.1Q(TM). Synchronization to an externally provided timing signal [e.g., a recognized timing standard such as Coordinated Universal Time (UTC) or International Atomic Time (TAI)] is not part of this standard but is not precluded.

[Learn More
About P802.1AS](https://standards.ieee.org/ieee/802.1AS/11284 "Learn More")

##### P802.1ASds

###### Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications Amendment: Support for the IEEE Std 802.3 Clause 4 Media Access Control (MAC) operating in half-duplex

This amendment specifies protocols, procedures, and managed objects that support IEEE Std 802.3 Clause 4 Media Access Control (MAC) operating in half-duplex while retaining existing functionality and backward compatibility, and remaining a profile of IEEE Std 1588-2019.
This amendment addresses errors and omissions in the description of existing functionality.

[Learn More
About P802.1ASds](https://standards.ieee.org/ieee/802.1ASds/10835 "Learn More")

##### P802.1ASeb

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications Amendment: Optional Use of Announce

This amendment provides additions and modifications to enable the Announce message functionality to be optional on new implementations, while maintaining the ability for implementations to support backward compatibility, interoperability, and full conformance with IEEE Std 1588™-2019. Protocols, procedures, and managed objects are updated if and as required to reflect the availability and use of Announce.
This amendment also includes technical and editorial corrections in the description of existing IEEE Std 802.1AS functionality.

[Learn More
About P802.1ASeb](https://standards.ieee.org/ieee/802.1ASeb/11626 "Learn More")

##### P802.1ASed

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications Amendment: Fault-Tolerant Timing with Time Integrity

This amendment specifies protocols, processes, procedures, functions, mechanisms, and managed objects to enable fault-tolerant timing by increasing the availability of the time and adding time integrity. This is achieved using two or more generalized Precision Time Protocol (gPTP) domains, multiple time distribution paths, the local oscillator clock, and a time selection function with individual processes for times that have interdependencies and times that do not have interdependencies. Fault-tolerant timing includes fault-tolerant time generation and distribution.

[Learn More
About P802.1ASed](https://standards.ieee.org/ieee/802.1ASed/11749 "Learn More")

##### P802.1AXdz

###### IEEE Standard for Local and Metropolitan Area Networks--Link Aggregation Amendment: YANG for Link Aggregation

This amendment specifies YANG modules that allow configuration and status reporting for systems implementing Link Aggregation, and optionally Distributed Resilient Network Interconnect, based on the capabilities currently specified in clause 7 (management) and Annex D (Management Information Base definitions). This amendment also includes technical and editorial corrections in the description of existing IEEE Std 802.1AX functionality.

[Learn More
About P802.1AXdz](https://standards.ieee.org/ieee/802.1AXdz/11527 "Learn More")

##### P802.1CB-2017/Cor 1

###### IEEE Standard for Local and metropolitan area networks--Frame Replication and Elimination for Reliability - Corrigendum 1

Correction of technical and editorial errors identified and agreed by the IEEE 802.1 Working Group maintenance activity comprising: https://www.802-1.org/items/431, https://www.802-1.org/items/451, https://www.802-1.org/items/456, and https://www.802-1.org/items/471. The management module changes needed are applicable in the context of IEEE Std 802.1CBcv(TM)-2021.

[Learn More
About P802.1CB-2017/Cor 1](https://standards.ieee.org/ieee/802.1CB-2017_Cor_1/11528 "Learn More")

##### P802.1CQ

###### Standard for Local and Metropolitan Area Networks: Multicast and Local Address Assignment

This standard specifies protocols, procedures, and management objects for locally-unique assignment of 48-bit and 64-bit addresses in IEEE 802 networks. Peer-to-peer address claiming and address server capabilities are specified.

Learn More
About P802.1CQ

##### P802.1DD

###### Standard for Local and Metropolitan Area Networks - Resource Allocation Protocol

This standard specifies protocols, procedures, and managed objects for resource allocation in bridged local area networks for dynamic creation and maintenance of data streams. This standard supports control signaling through data paths and through separate control paths in support of centralized control. This standard makes provisions for backward compatibility with the Stream Reservation Protocol specified in IEEE Std 802.1Q.

[Learn More
About P802.1DD](https://standards.ieee.org/ieee/802.1DD/11750 "Learn More")

##### P802.1DG

###### IEEE Draft Standard for Time-Sensitive Networking Profile for Automotive In-Vehicle Ethernet Communications

This standard specifies profiles for secure, highly reliable, deterministic latency, automotive in-vehicle bridged IEEE 802.3 Ethernet networks based on IEEE 802.1 Time-Sensitive Networking (TSN) standards and IEEE 802.1 Security standards.

[Learn More
About P802.1DG](https://standards.ieee.org/ieee/802.1DG/7480 "Learn More")

##### P802.1DP

###### Standard for Local and Metropolitan Area Networks - Time-Sensitive Networking for Aerospace Onboard Ethernet Communications

This standard specifies profiles of IEEE 802.1 Time-Sensitive Networking (TSN) and IEEE 802.1 Security standards for aerospace onboard bridged IEEE 802.3 Ethernet networks. The profiles select features, options, configurations, defaults, protocols, and procedures of bridges, end stations, and Local Area Networks to build deterministic networks for aerospace onboard communications.

[Learn More
About P802.1DP](https://standards.ieee.org/ieee/802.1DP/10465 "Learn More")

##### P802.1DU

###### Standard for Local and Metropolitan Area Networks - Cut-Through Forwarding Bridges and Bridged Networks

This standard specifies Cut-Through Forwarding (CTF) bridges based on the IEEE 802.1Q bridge architecture, including protocols, procedures, and managed objects. CTF bridges interconnect individual local area networks (LANs) using different or identical media access control (MAC) methods with and without support for CTF. This standard also details the usage of CTF bridges in bridged networks.

[Learn More
About P802.1DU](https://standards.ieee.org/ieee/802.1DU/11270 "Learn More")

##### P802.1Q

###### Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks

This standard specifies Bridges that interconnect individual LANs, each supporting the IEEE 802 MAC Service using a different or identical media access control method, to provide Bridged Networks and VLANs.

[Learn More
About P802.1Q](https://standards.ieee.org/ieee/802.1Q/11285 "Learn More")

##### P802.1Qdq

###### Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment: Shaper Parameter Settings for Bursty Traffic Requiring Bounded Latency

This amendment adds an informative annex that describes recommended shaper parameter settings for bursty traffic requiring bounded latency.

[Learn More
About P802.1Qdq](https://standards.ieee.org/ieee/802.1Qdq/10609 "Learn More")

##### P802.1Qdt

###### Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment: Priority-based Flow Control Enhancements

This amendment specifies procedures and managed objects for automated Priority-based Flow Control (PFC) headroom calculation and Media Access Control Security (MACsec) protection of PFC frames, using point-to-point roundtrip measurement and enhancements to the Data Center Bridging Capability Exchange protocol (DCBX).
This amendment places emphasis on the requirements for low latency and lossless transmission in large-scale and geographically dispersed data centers.
This amendment also addresses errors of the existing IEEE Std 802.1Q functionality.

[Learn More
About P802.1Qdt](https://standards.ieee.org/ieee/802.1Qdt/11256 "Learn More")

##### P802.1Qdv

###### Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment: Enhancements to Cyclic Queuing and Forwarding

This amendment specifies procedures, protocols and managed objects to enhance Cyclic Queuing and Forwarding, comprising: a transmission selection procedure that organizes frames in a traffic class output queue into logical bins that are output in strict rotation at a constant frequency; a procedure for storing received frames into bins based on the time of reception of the frame; a procedure for storing received frames into bins based on per-flow octet counters; a protocol for determining the phase relationship between a transmitter's and a receiver's bin boundaries in time; managed objects, Management Information Base (MIB), and YANG modules for controlling these procedures; and an informative annex to provide guidance for applying these procedures. This amendment also addresses errors and omissions in the description of existing IEEE Std 802.1Q functionality.

[Learn More
About P802.1Qdv](https://standards.ieee.org/ieee/802.1Qdv/11018 "Learn More")

##### P802.1Qdw

###### Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment: Source Flow Control

This amendment specifies procedures, managed objects, and a YANG data model for the signaling and remote invocation of flow control at the source of transmission in a data center network. This amendment specifies enhancements to the Data Center Bridging Capability (DCBX) protocol to advertise the new capability. This amendment specifies the optional use of existing stream filters to allow bridges at the edge of the network to intercept and convert signaling messages to existing Priority-based Flow Control (PFC) frames. This amendment also addresses technical and editorial corrections to existing IEEE Std 802.1Q functionality.

[Learn More
About P802.1Qdw](https://standards.ieee.org/ieee/802.1Qdw/11019 "Learn More")

##### P802.1Qdy

###### IEEE Draft Standard for Local and Metropolitan Area Networks - Bridges and Bridged Networks -Amendment 40: YANG for the Multiple Spanning Tree Protocol

This amendment to IEEE Std 802.1Q-2022 as amended by IEEE Std 802.1Qcz-2023, IEEE Std 802.1Qcw-2023, IEEE Std 802.1Qcj-2023, IEEE Std 802.1Qdj-2024, and IEEE Std 802.1Qdx-2024 addresses Multiple Spanning Tree Protocol (MSTP) requirements arising from industrial automation networks. It specifies YANG for bridge and bridge component RSTP and MSTP configuration and status reporting.

[Learn More
About P802.1Qdy](https://standards.ieee.org/ieee/802.1Qdy/11392 "Learn More")

**Standards approved by the IEEE SA Standards Board that are within the
10-year lifecycle.**

---

##### 802-2014

###### IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture

This standard provides an overview to the family of IEEE 802u00ae standards. It describes the reference models for the IEEE 802 standards and explains the relationship of these standards to the higher layer protocols; it provides a standard for the structure of IEEE 802 MAC addresses; it provides a standard for identification of public, private, prototype, and standard protocols; it specifies an object identifier hierarchy used within IEEE 802 for uniform allocation of object identifiers used in IEEE 802 standards; and it specifies a method for higher layer protocol identification. (The PDF of this standard is available at no charge compliments of the IEEE GET Program. Visit https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68 for more details.)

[Learn More
About 802-2014](https://standards.ieee.org/ieee/802/4158 "Learn More")

##### 802.1AB-2016

###### IEEE Standard for Local and metropolitan area networks - Station and Media Access Control Connectivity Discovery

This document defines a protocol and a set of managed objects that can be used for discovering the physical topology from adjacent stations in IEEE 802(R) LANs. (The PDF of this standard is available at no cost compliments of the IEEE GET program. Additional downloads are attached or can be downloaded at https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AB-2016](https://standards.ieee.org/ieee/802.1AB/6047 "Learn More")

##### 802.1ABcu-2021

###### IEEE Standard for Local and metropolitan networks--Station and Media Access Control Connectivity Discovery Amendment 1: YANG Data Model

This amendment to IEEE Std 802.1AB-2016 specifies a Unified Modeling Language (UML)-based information model and a YANG data model that allows configuration and status reporting for bridges and bridge components with regards to topology discovery. (The PDF of this standard is available at no charge compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1ABcu-2021](https://standards.ieee.org/ieee/802.1ABcu/7131 "Learn More")

##### 802.1ABdh-2021

###### IEEE Standard for Local and metropolitan area networks-- Station and Media Access Control Connectivity Discovery Amendment 2: Support for Multiframe Protocol Data Units

This amendment to IEEE Std 802.1AB(TM)-2016 specifies protocols, procedures and managed objects that support the transmission and reception of a set of Link Layer Discovery Protocol (LLDP) Type/Length/Values (TLVs) that exceed the space available in a single frame. (The PDF of this standard is available at no charge compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1ABdh-2021](https://standards.ieee.org/ieee/802.1ABdh/7667 "Learn More")

##### 802.1AC-2016

###### IEEE Standard for Local and metropolitan area networks -- Media Access Control (MAC) Service Definition

The MAC Service and the Internal Sublayer Service (ISS) are defined in this standard. This standard specifies media-dependent convergence functions that map IEEE 802(R) MAC interfaces to the ISS. The MAC Service is derived from the ISS. (The PDF of this standard is available at no charge compliments of the IEEE GET Program https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AC-2016](https://standards.ieee.org/ieee/802.1AC/5720 "Learn More")

##### 802.1AC-2016/Cor 1-2018

###### IEEE Standard for Local and Metropolitan Area Networks--Media Access Control (MAC) Service Definition - Corrigendum 1: Logical Link Control (LLC) Encapsulation EtherType

This corrigendum to IEEE Std 802.1AC™-2016 corrects the value of the LLC Encapsulation EtherType.(The PDF of this standard is available at no cost to you compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AC-2016/Cor 1-2018](https://standards.ieee.org/ieee/802.1AC-2016_Cor_1/7132 "Learn More")

##### 802.1ACct-2021

###### IEEE Standard for Local and Metropolitan Area networks--Media Access Control (MAC) Service Definition-Amendment 1: Support for IEEE Std 802.15.3

The Internal Sublayer Service for the IEEE 802.15.3 MAC entity is defined in this amendment. (The PDF of this standard is available at no cost via the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1ACct-2021](https://standards.ieee.org/ieee/802.1ACct/7133 "Learn More")

##### 802.1AE-2018

###### IEEE Standard for Local and metropolitan area networks-Media Access Control (MAC) Security

How all or part of a network can be secured transparently to peer protocol entities that use the MAC Service provided by IEEE 802u00ae LANs to communicate is specified in this standard. MAC security (MACsec) provides connectionless user data confidentiality, frame data integrity, and data origin authenticity.(The PDF of this standard is available at no cost to you compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AE-2018](https://standards.ieee.org/ieee/802.1AE/7154 "Learn More")

##### 802.1AE-2018/Cor 1-2020

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Security Corrigendum 1: Tag Control Information Figure

How all or part of a network can be secured transparently to peer protocol entities that use the MAC Service provided by IEEE 802(R) LANs to communicate is specified in this standard. AC security (MACsec) provides connectionless user data confidentiality, data frame integrity, and data origin authenticity. (The PDF of this standard is available at no cost compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1AE-2018/Cor 1-2020](https://standards.ieee.org/ieee/802.1AE-2018_Cor_1/7588 "Learn More")

##### 802.1AEdk-2023

###### IEEE Standard for Local and metropolitan area networks-Media Access Control (MAC) Security Amendment 4: MAC Privacy protection

This amendment specifies a MAC Privacy protection encapsulating protocol and its use in conjunction with the MAC Security protocol (MACsec) to hide the source and destination MAC addresses of user data frames, and to reduce any correlation between observable frame sizes and transmission timing. This helps to protect user and application identities and to hide the purpose and content of communications. Management of MACsec and privacy protection is supported by YANG models and SNMP MIBs. Privacy considerations for bridged networks are reviewed. (The PDF of this standard is available at no cost compliments of the IEEE GET Program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1AEdk-2023](https://standards.ieee.org/ieee/802.1AEdk/10136 "Learn More")

##### 802.1AR-2018

###### IEEE Standard for Local and Metropolitan Area Networks - Secure Device Identity

A Secure Device Identifier (DevID) is cryptographically bound to a device and supports authentication of the device's identity. An Initial Device Identifier (IDevID) provide by the supplier of a device can be supplemented by Local Device Identifiers (LDevIDs) facilitating enrollment (provisioning of authentication and authorization credentials) by local network administrators. (The PDF of this standard is available at no cost compliments of the IEEE GET Program at https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AR-2018](https://standards.ieee.org/ieee/802.1AR/6995 "Learn More")

##### 802.1AS-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications

Protocols, procedures, and managed objects for the transport of timing over local area networks are defined in this standard. It includes the transport of synchronized time, the selection of the timing source (i.e., best master), and the indication of the occurrence and magnitude of timing impairments (i.e., phase and frequency discontinuities). (The PDF of this standards is available at no cost to you compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1AS-2020](https://standards.ieee.org/ieee/802.1AS/7121 "Learn More")

##### 802.1AS-2020/Cor 1-2021

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Time-Sensitive Applications - Corrigendum 1: Technical and Editorial Corrections

Technical and editorial corrections to IEEE Std 802.1AS™-2020 are provided in this corrigendum. (The PDF of this standard is available at no charge compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1AS-2020/Cor 1-2021](https://standards.ieee.org/ieee/802.1AS-2020_Cor_1/10524 "Learn More")

##### 802.1ASdm-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Timeu2010Sensitive Applications Amendment 3: Hot Standby and Clock Drift Error Reduction

This amendment to IEEE Std 802.1AS™-2020 specifies hot standby and addresses errors and omissions in the description of existing functionality.

[Learn More
About 802.1ASdm-2024](https://standards.ieee.org/ieee/802.1ASdm/11254 "Learn More")

##### 802.1ASdn-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Timeu2010Sensitive Applications Amendment 2: YANG Data Model

A YANG data model that allows configuration and state reporting for all managed objects of the base standard is specified in this amendment.

[Learn More
About 802.1ASdn-2024](https://standards.ieee.org/ieee/802.1ASdn/10364 "Learn More")

##### 802.1ASdr-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Timing and Synchronization for Timeu2010Sensitive Applications Amendment 1: Inclusive Terminology

This amendment to IEEE Std 802.1AS™-2020 replaces terminology with alternative terminology identified by IEEE Std 1588g™-2022. All changes made in figures are only to replace terminology. (The PDF of this standard is available at no cost compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1ASdr-2024](https://standards.ieee.org/ieee/802.1ASdr/10568 "Learn More")

##### 802.1AX-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Link Aggregation

Link Aggregation allows parallel point-to-point links to be used as if they were a single link and also supports the use of multiple links as a resilient load-sharing interconnect between multiple nodes in two separately administered networks. This standard defines a MAC-independent Link Aggregation capability and provides general information relevant to specific MAC types.

[Learn More
About 802.1AX-2020](https://standards.ieee.org/ieee/802.1AX/6768 "Learn More")

##### 802.1BA-2021

###### IEEE Standard for Local and Metropolitan Area Networks--Audio Video Bridging (AVB) Systems

Profiles that select features, options, configurations, defaults, protocols, and procedures of bridges, stations, and LANs that are necessary to build networks that are capable of transporting time-sensitive audio and/or video data streams are defined in this standard. The PDF of this standard is available at no cost via the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68

[Learn More
About 802.1BA-2021](https://standards.ieee.org/ieee/802.1BA/10547 "Learn More")

##### 802.1CB-2017

###### IEEE Standard for Local and metropolitan area networks--Frame Replication and Elimination for Reliability

This standard specifies procedures, managed objects, and protocols for bridges and end systems that provide identification and replication of packets for redundant transmission, identification of duplicate packets, and elimination of duplicate packets. It is not concerned with the creation of the multiple paths over which the duplicates are transmitted.

[Learn More
About 802.1CB-2017](https://standards.ieee.org/ieee/802.1CB/5703 "Learn More")

##### 802.1CBcv-2021

###### IEEE Standard for Local and metropolitan area networks -- Frame Replication and Elimination for Reliability - Amendment 1: Information Model, YANG Data Model, and Management Information Base Module

This amendment specifies YANG data models and MIB modules that allow configuration and status reporting for bridges and end systems with the capabilities for Frame Replication and Elimination for Reliability (FRER) and Stream identification. (The PDF of this standards is available at no cost to your thru the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1CBcv-2021](https://standards.ieee.org/ieee/802.1CBcv/7285 "Learn More")

##### 802.1CBdb-2021

###### IEEE Standard for Local and metropolitan area networks--Frame Replication and Elimination for Reliability Amendment 2: Extended Stream Identification Functions

This amendment specifies procedures, managed objects, and protocols for bridges and end systems that provide identification and replication of packets for redundant transmission, identification of duplicate packets, and elimination of duplicate packets. It is not concerned with the creation of the multiple paths over which the duplicates are transmitted.

[Learn More
About 802.1CBdb-2021](https://standards.ieee.org/ieee/802.1CBdb/7286 "Learn More")

##### 802.1CF-2019

###### IEEE Recommended Practice for Network Reference Model and Functional Description of IEEE 802(R) Access Network

An access network (which connects terminals to their access routers) utilizing technologies based on the family of IEEE 802(R) standards is specified in this recommended practice. An access network reference model (NRM) that includes entities and reference points along with behavioral and functional descriptions of communications among those entities is provided in this recommended practice. (The PDF of this standard is available at no cost to you compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1CF-2019](https://standards.ieee.org/ieee/802.1CF/5870 "Learn More")

##### 802.1CM-2018

###### IEEE Standard for Local and metropolitan area networks -- Time-Sensitive Networking for Fronthaul

This standard defines profiles that select features, options, configurations, defaults, protocols, and procedures of bridges, stations, and LANs that are necessary to build networks that are capable of transporting fronthaul streams, which are time sensitive. (The PDF of this standard is available at not cost compliments of the IEEE GET Program at https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1CM-2018](https://standards.ieee.org/ieee/802.1CM/6236 "Learn More")

##### 802.1CMde-2020

###### IEEE Standard for Local and metropolitan area networks -- Time-Sensitive Networking for Fronthaul - Amendment 1: Enhancements to Fronthaul Profiles to Support New Fronthaul Interface, Synchronization, and Syntonization Standards

Enhancements to fronthaul profiles are defined in this amendment to IEEE Std 802.1CM-2018 in order to address new developments in fronthaul interface standards and in related synchronization and syntonization standards. (The PDF of this standard is available at no cost to you compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1CMde-2020](https://standards.ieee.org/ieee/802.1CMde/7478 "Learn More")

##### 802.1CS-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Link-local Registration Protocol

Protocols, procedures, and managed objects for a Link-local Registration Protocol (LRP) to replicate a registration database from one end to the other of a point-to-point link and to replicate changes to parts of that database are specified in this standard. A facility is provided to purge the replicated database if the source becomes unresponsive. LRP is optimized for databases on the order of 1 Mbyte. (The PDF of this standard is available at no cost to you compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68.

[Learn More
About 802.1CS-2020](https://standards.ieee.org/ieee/802.1CS/10125 "Learn More")

##### 802.1CS-2020/Cor 1-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Link-local Registration Protocol Corrigendum 1: Corrections to Management Modules and Protocol Encoding

This corrigendum corrects errors in the YANG module, SNMP MIBs, and TLV encoding in IEEE Std 802.1CS-2020. (The PDF of this standard is available at no cost compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68)

[Learn More
About 802.1CS-2020/Cor 1-2024](https://standards.ieee.org/ieee/802.1CS-2020_Cor_1/11255 "Learn More")

##### 802.1DC-2024

###### IEEE Standard for Local and metropolitan area networks---Quality of Service Provision by Network Systems

This standard specifies procedures and managed objects for quality of service (QoS) features specified in IEEE Std 802.1Q, such as Per-Stream Filtering and Policing, queuing, transmission selection, stream control, and frame preemption, in a network system that is not a Bridge.

[Learn More
About 802.1DC-2024](https://standards.ieee.org/ieee/802.1DC/7318 "Learn More")

##### 802.1Qcj-2023

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 37: Automatic Attachment to Provider Backbone Bridging (PBB) Services

This amendment to IEEE Std 802.1Q-2022 as amended by IEEE Std 802.1Qcz-2023 and IEEE Std 802.1Qcw-2023 specifies protocols, procedures, and management objects for auto attachment of network devices to Provider Backbone service instances using Type, Length, Value (TLVs) within the Link Layer Discovery Protocol (LLDP). (PDF of this Standard is available at no charge, compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68).

[Learn More
About 802.1Qcj-2023](https://standards.ieee.org/ieee/802.1Qcj/6160 "Learn More")

##### 802.1Qcw-2023

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 36: YANG Data Models for Scheduled Traffic, Frame Preemption, and Peru2010Stream Filtering and Policing

This amendment specifies YANG data models that allow configuration and status reporting for Bridges and Bridge components with the capabilities of scheduled traffic, frame preemption, and Per-Stream Filtering and Policing. (The PDF of the standard is available at no cost, compliments of the IEEE GET program at https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68).

[Learn More
About 802.1Qcw-2023](https://standards.ieee.org/ieee/802.1Qcw/7134 "Learn More")

##### 802.1Qcz-2023

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks -- Amendment 35: Congestion Isolation

This amendment to IEEE Std 802.1Q™-2022 specifies protocols, procedures, and managed objects that support the isolation of congesting data flows within data center environments. The PDF of this standard is available at no cost compliments of the IEEE GET program https://ieeexplore.ieee.org/browse/standards/get-program/page/series?id=68.

[Learn More
About 802.1Qcz-2023](https://standards.ieee.org/ieee/802.1Qcz/7372 "Learn More")

##### 802.1Qdj-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 38: Configuration Enhancements for Timeu2010Sensitive Networking

This amendment to IEEE Std 802.1Q-2022 as amended by IEEE Std 802.1Qcz-2023, IEEE Std 802.1Qcw-2023, and IEEE Std 802.1Qcj-2023 describes the relationships and division of responsibilities between Centralized User Configuration (CUC) components, that can be used to configure end stations' use of Time-Sensitive Networking (TSN) capabilities, and a Centralized Network Configuration (CNC) component that can be used to configure network resources within an administrative Configuration Domain. A YANG model and modules that can be used by a network configuration protocol, such as NETCONF, to provide communication between the CNC and a CUC is specified.

[Learn More
About 802.1Qdj-2024](https://standards.ieee.org/ieee/802.1Qdj/7669 "Learn More")

##### 802.1Qdx-2024

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 39: YANG Data Models for the Credit-Based Shaper

A YANG data model that supports configuration and status reporting for credit-based shaper algorithm capabilities in Bridges and end stations is specified in this amendment to IEEE Std 802.1Q-2022 as amended by IEEE Std 802.1Qcz-2023, IEEE Std 802.1Qcw-2023, IEEE Std 802.1Qcj-2023, and IEEE Std 802.1Qdj-2024.

[Learn More
About 802.1Qdx-2024](https://standards.ieee.org/ieee/802.1Qdx/11271 "Learn More")

##### 802.1X-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Port-Based Network Access Control

Port-based network access control allows a network administrator to restrict the use of IEEE 802(R) LAN service access points (ports) to secure communication between authenticated and authorized devices. This standard specifies a common architecture, functional elements, and protocols that support mutual authentication between the clients of ports attached to the same LAN and that secure communication between the ports, including the media access method independent protocols that are used to discover and establish the security associations used by IEEE 802.1AE(TM) MAC Security.

[Learn More
About 802.1X-2020](https://standards.ieee.org/ieee/802.1X/7345 "Learn More")

##### 802c-2017

###### IEEE Standard for Local and Metropolitan Area Networks:Overview and Architecture--Amendment 2: Local Medium Access Control (MAC) Address Usage

An optional local medium access control (MAC) address space structure, known as the Structured Local Address Plan (SLAP), is provided in this amendment to IEEE Std 802u00ae-2014 in order to allow multiple administrations to coexist. This structure designates a range of local MAC addresses for protocols using a Company ID (CID) assigned by the IEEE Registration Authority. Another range of local MAC addresses is designated for assignment by administrators. The amendment recommends a range of local MAC addresses for use by IEEE 802u00ae protocols.(The PDF of this standard is available at no cost to you compliments of the IEEE GET program http://ieeexplore.ieee.org/servlet/opac?punumber=8016707.

[Learn More
About 802c-2017](https://standards.ieee.org/ieee/802c/6890 "Learn More")

##### 802d-2017

###### IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture Amendment 1: Allocation of Uniform Resource Name (URN) Values in IEEE 802(R) Standards

How Uniform Resource Name (URN) values are allocated in IEEE 802(R) standards is described in this amendment to IEEE Std 802(R)-2014. (The PDF of this standard is available at no cost compliments of the IEEE GET program at http://ieeexplore.ieee.org/browse/standards/get-program/page/)

[Learn More
About 802d-2017](https://standards.ieee.org/ieee/802d/6657 "Learn More")

##### 802E-2020

###### IEEE Recommended Practice for Privacy Considerations for IEEE 802(R) Technologies

A privacy threat model for IEEE 802u00ae technologies is specified by this recommended practice. The document also provides recommendations on how to protect against privacy threats and promotes a consistent approach to the mitigation of privacy threats by IEEE 802 protocol developers.

[Learn More
About 802E-2020](https://standards.ieee.org/ieee/802E/6242 "Learn More")

##### 802f-2023

###### IEEE Standard for Local and Metropolitan Area Network: Overview and Architecture Amendment 3: YANG Data Model for EtherTypes

The YANG module containing the EtherType information, including a compact humanreadable name and description, for a subset of EtherTypes taken from the IEEE Registration Authority EtherType public listing is specified in this amendment. This amendment also addresses errors and omissions in IEEE Std 802 description of existing functionality. (The PDF of the standard is available at no cost at http://ieeexplore.ieee.org/servlet/opac?punumber=10352373 compliments of the IEEE GET program)

[Learn More
About 802f-2023](https://standards.ieee.org/ieee/802f/10138 "Learn More")

##### 8802-1AB

###### ISO/IEC/IEEE Draft International Standard - Information technology – Telecommunications and information exchange between systems – Local and metropolitan area networks – Specific requirements – Part 1AB: Station and media access control connectivity discovery

A protocol and a set of managed objects that can be used for discovering the physical topology from adjacent stations in IEEE 802u00ae LANs are defined in this document

[Learn More
About 8802-1AB](https://standards.ieee.org/ieee/8802-1AB/7112 "Learn More")

##### 8802-1AB-2017

###### ISO/IEC/IEEE International Standard--Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Specific requirements--Part 1AB: Station and media access control connectivity discovery

A protocol and a set of managed objects that can be used for discovering the physical topology from adjacent stations in IEEE 802u00ae LANs are defined in this document.

[Learn More
About 8802-1AB-2017](https://standards.ieee.org/ieee/8802-1AB/11355 "Learn More")

##### 8802-1AB:2017/Amd 1-2023

###### IEEE/ISO/IEC International Standard--Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Specific requirements--Part 1AB: Station and media access control connectivity discovery AMENDMENT 1: YANG data model

This amendment to IEEE Std 802.1AB-2016 specifies a Unified Modeling Language (UML)-based information model and a YANG data model that allows configuration and status reporting for bridges and bridge components with regards to topology discovery.

[Learn More
About 8802-1AB:2017/Amd 1-2023](https://standards.ieee.org/ieee/8802-1AB_2017_Amd_1/11344 "Learn More")

##### 8802-1AB:2017/Amd 2-2023

###### IEEE/ISO/IEC International Standard--Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Specific requirements--Part 1AB: Station and media access control connectivity discovery AMENDMENT 2: Support for multiframe protocol data units

Abstract: This amendment to IEEE Std 802.1AB™-2016 specifies protocols, procedures, and managed objects that support the transmission and reception of a set of Link Layer Discovery Protocol (LLDP) Type/Length/Values (TLVs) that exceed the space available in a single frame.

[Learn More
About 8802-1AB:2017/Amd 2-2023](https://standards.ieee.org/ieee/8802-1AB_2017_Amd_2/11345 "Learn More")

##### 8802-1AC:2018/Amd 1-2023

###### ISO/IEC/IEEE International Standard - Information technology -- Telecommunications and information exchange between systems -- Local and metropolitan area networks -- Part 1AC: Media access control (MAC) service definition AMENDMENT 1: Support for ISO/IEC/ IEEE 8802-15-3

The Internal Sublayer Service for the IEEE 802.15.3 MAC entity is defined in this amendment.

[Learn More
About 8802-1AC:2018/Amd 1-2023](https://standards.ieee.org/ieee/8802-1AC_2018_Amd_1/11249 "Learn More")

##### 8802-1AE/Cor1-2021-2020

###### IEEE/ISO/IEC International Standard - Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1AE:Media access control (MAC) security

How all or part of a network can be secured transparently to peer protocol entities that use the MAC Service provided by IEEE 802u00ae LANs to communicate is specified in this standard. MAC security (MACsec) provides connectionless user data confidentiality, frame data integrity, and data origin authenticity.

[Learn More
About 8802-1AE/Cor1-2021-2020](https://standards.ieee.org/ieee/8802-1AE_Cor1-2021/10338 "Learn More")

##### 8802-1AE:2020/Amd.4:2024-2024

###### ISO/IEC/IEEE International Standard: Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1AE: Media access control (MAC) security AMENDMENT 4: MAC Privacy Protection

The scope of this standard is to specify provision of connectionless user data confidentiality, frame data integrity, and data origin authenticity by media access independent protocols and entities that operate transparently to MAC Clients. NOTE--The MAC Clients are as specified in IEEE Std 802, IEEE Std 802.1Q™, and IEEE Std 802.1X™.

[Learn More
About 8802-1AE:2020/Amd.4:2024-2024](https://standards.ieee.org/ieee/8802-1AE_2020_Amd.4_2024/11822 "Learn More")

##### 8802-1AS-2021

###### IEEE/ISO/IEC International Standard for Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Part 1AS:Timing and synchronization for time-sensitive applications in bridged local area networks

Protocols, procedures, and managed objects for the transport of timing over local area networks are defined in this standard. It includes the transport of synchronized time, the selection of the timing source (i.e., best master), and the indication of the occurrence and magnitude of timing impairments (i.e., phase and frequency discontinuities).

[Learn More
About 8802-1AS-2021](https://standards.ieee.org/ieee/8802-1AS/10767 "Learn More")

##### 8802-1AS:2021/Cor 1-2023

###### ISO/IEC/IEEE--Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Part 1AS: Timing and synchronization for time-sensitive applications in bridged local area networks TECHNICAL CORRIGENDUM 1: Technical and editorial corrections

Technical and editorial corrections to IEEE Std 802.1AS-2020 are provided in this corrigendum.

[Learn More
About 8802-1AS:2021/Cor 1-2023](https://standards.ieee.org/ieee/8802-1AS_2021_Cor_1/11158 "Learn More")

##### 8802-1AX-2021

###### IEEE/ISO/IEC International Standard - Telecommunications and exchange between information technology systems -- Requirements for local and metropolitan area networks -- Part 1AX: Link aggregation

Link Aggregation allows parallel point-to-point links to be used as if they were a single link and also supports the use of multiple links as a resilient load-sharing interconnect between multiple nodes in two separately administered networks. This standard defines a MAC-independent Link Aggregation capability and provides general information relevant to specific MAC types.

[Learn More
About 8802-1AX-2021](https://standards.ieee.org/ieee/8802-1AX/10670 "Learn More")

##### 8802-1BA-2023

###### ISO/IEC/IEEE International Standard--Information technology -- Telecommunications and information exchange between systems -- Local and metropolitan area networks -- Specific requirements -- Part 1BA: Audio video bridging (AVB) systems

Profiles that select features, options, configurations, defaults, protocols, and procedures of bridges, stations, and LANs that are necessary to build networks that are capable of transporting time-sensitive audio and/or video data streams are defined in this standard.

[Learn More
About 8802-1BA-2023](https://standards.ieee.org/ieee/8802-1BA/11250 "Learn More")

##### 8802-1BR-2016

###### ISO/IEC/IEEE International Standard for Information technology – Telecommunications and information exchange between systems – Local and metropolitan area networks – Specific requirements – Part 1BR: Virtual bridged local area networks – Bridge port extension

This standard specifies the operation of Bridge Port Extenders, including management, protocols, and algorithms. Bridge Port Extenders operate in support of the MAC Service by Extended Bridges.

[Learn More
About 8802-1BR-2016](https://standards.ieee.org/ieee/8802-1BR/6871 "Learn More")

##### 8802-1CB:2019/Amd 2-2023

###### IEEE/ISO/IEC International Standard--Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Specific requirements--Part 1CB: Frame replication and elimination for reliability AMENDMENT 2: Extend stream identification functions

This amendment specifies procedures, managed objects, and protocols for bridges and end systems that provide identification and replication of packets for redundant transmission, identification of duplicate packets, and elimination of duplicate packets. It is not concerned with the creation of the multiple paths over which the duplicates are transmitted.

[Learn More
About 8802-1CB:2019/Amd 2-2023](https://standards.ieee.org/ieee/8802-1CB_2019_Amd_2/11212 "Learn More")

##### 8802-1CM:2019/Amd1-2021

###### IEEE/ISO/IEC International Standard-Telecommunications and information exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1CM:Time-sensitive networking for fronthaul - AMENDMENT 1: Enhancements to fronthaul profiles to support new fronthaul interface, synchronization, and syntonization standards

Enhancements to fronthaul profiles are defined in this amendment to IEEE Std 802.1CM(TM)-2018 in order to address new developments in fronthaul interface standards and in related synchronization and syntonization standards.

[Learn More
About 8802-1CM:2019/Amd1-2021](https://standards.ieee.org/ieee/8802-1CM_2019_Amd1/10736 "Learn More")

##### 8802-1CS-2021

###### ISO/IEC/IEEE International Standard--Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1CS: Link-local registration protocol

Protocols, procedures, and managed objects for a Link-local Registration Protocol (LRP) to replicate a registration database from one end to the other of a point-to-point link and to replicate changes to parts of that database are specified in this standard. A facility is provided to purge the replicated database if the source becomes unresponsive. LRP is optimized for databases on the order of 1 Mbyte.

[Learn More
About 8802-1CS-2021](https://standards.ieee.org/ieee/8802-1CS/10986 "Learn More")

##### 8802-1Q-2020

###### IEEE/ISO/IEC International Standard - Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1Q: Bridges and bridged networks

This standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms.

[Learn More
About 8802-1Q-2020](https://standards.ieee.org/ieee/8802-1Q/10339 "Learn More")

##### 8802-1Q-2024

###### ISO/IEC/IEEE International Standard: Telecommunications and exchange between information technology systems -- Requirements for local and metropolitan area networks -- Part 1Q: Bridges and bridged networks

This standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms.

[Learn More
About 8802-1Q-2024](https://standards.ieee.org/ieee/8802-1Q/11825 "Learn More")

##### 8802-1Q-2020/Amd3-2021

###### ISO/IEC/IEEE International Standard-Telecommunications and exchange between information technology systems -- Requirements for local and metropolitan area networks -- Part 1Q: Bridges and bridged networks AMENDMENT 3: Virtual station interface (VSI) discovery and configuration protocol (VDP) extension to support network virtualization overlays over layer 3 (NVO3)

Extensions to the Virtual Station Interface (VSI) Discovery and Configuration Protocol (VDP) to support using the protocol between an end station and a device doing encapsulation/decapsulation for Network Virtualization Overlays Over Layer 3 (NVO3) are specified in this amendment to IEEE Std 802.1Q-2018. The extensions include adding format types [e.g., Internet Protocol (IP) addresses] and enhancing indication of migration events.

[Learn More
About 8802-1Q-2020/Amd3-2021](https://standards.ieee.org/ieee/8802-1Q-2020_Amd3/10668 "Learn More")

##### 8802-1Q-2020/Amd31-2021

###### IEEE/ISO/IEC International Standard-Telecommunications and exchange between information technology systems -- Requirements for local and metropolitan area networks -- Part 1Q: Bridges and bridged networks AMENDMENT 31: Stream Reservation Protocol (SRP) enhancements and performance improvements

Enhancements to the configuration of time-sensitive streams are provided by this amendment to IEEE Std 8802.1Q-2018.

[Learn More
About 8802-1Q-2020/Amd31-2021](https://standards.ieee.org/ieee/8802-1Q-2020_Amd31/10734 "Learn More")

##### 8802-1Q-2020\_Amd2-2021

###### IEEE/ISO/IEC International Standard -Telecommunications and exchange between information technology systems -- Requirements for local and metropolitan area networks--Part 1Q: Bridges and bridged networks AMENDMENT 2: YANG data model

A YANG data model in support of configuration and operational status information for a subset of Bridging capabilities is provided in this amendment to IEEE Std 802.1Q(TM)-2018.

[Learn More
About 8802-1Q-2020\_Amd2-2021](https://standards.ieee.org/ieee/8802-1Q-2020_Amd2/10669 "Learn More")

##### 8802-1Q:2016/Cor 1-2017

###### ISO/IEC/IEEE International Standard-Information technology--Telecommunications and information exchange between systems--Local and metropolitan area networks--Specific requirements--Part 1Q: Bridges and bridged networks TECHNICAL CORRIGENDUM 1: Technical and editorial corrections

Correction of technical and editorial errors identified by the IEEE 802.1 maintenance activity are presented in this document.

[Learn More
About 8802-1Q:2016/Cor 1-2017](https://standards.ieee.org/ieee/8802-1Q_2016_Cor_1/10024 "Learn More")

##### 8802-1Q:2024/Amd.35:2024-2024

###### ISO/IEC/IEEE International Standard: Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1Q: Bridges and bridged networks AMENDMENT 35: Congestion isolation

[Learn More
About 8802-1Q:2024/Amd.35:2024-2024](https://standards.ieee.org/ieee/8802-1Q_2024_Amd.35_2024/11823 "Learn More")

##### 8802-1Q\_Amd 1-2017

###### ISO/IEC/IEEE International Standard -- Information technology -- Telecommunications and information exchange between systems -- Local and metropolitan area networks -- Specific requirements -- Part 1Q: Bridges and bridged networks AMENDMENT 1: Path control and reservation

Explicit path control, bandwidth reservation, and redundancy (protection, restoration) for data flows are specified in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 8802-1Q\_Amd 1-2017](https://standards.ieee.org/ieee/8802-1Q_Amd_1/7111 "Learn More")

##### 8802-1Q\_Amd 3

###### ISO/IEC/IEEE International Standard -- Information technology -- Telecommunications and information exchange between systems -- Local and metropolitan area networks -- Specific requirements -- Part 1Q: Bridges and bridged networks AMENDMENT 3: Enhancements for scheduled traffic

Enhancements to the forwarding process that supports scheduled traffic is provided in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 8802-1Q\_Amd 3](https://standards.ieee.org/ieee/8802-1Q_Amd_3/7113 "Learn More")

##### 8802-1X-2021

###### IEEE/ISO/IEC International Standard-Telecommunications and exchange between information technology systems--Requirements for local and metropolitan area networks--Part 1X:Port-based network access control

Port-based network access control allows a network administrator to restrict the use of IEEE 802(R) LAN service access points (ports) to secure communication between authenticated and authorized devices. This standard specifies a common architecture, functional elements, and protocols that support mutual authentication between the clients of ports attached to the same LAN and that secure communication between the ports, including the media access method independent protocols that are used to discover and establish the security associations used by IEEE 802.1AE(TM) MAC Security.

[Learn More
About 8802-1X-2021](https://standards.ieee.org/ieee/8802-1X/10774 "Learn More")

**These standards have been replaced with a revised version of the
standard, or by a compilation of the original active standard and all
its existing amendments, corrigenda, and errata.**

---

##### 802-1990

###### Local and Metropolitan Area Networks: IEEE Standard: Overview and Architecture

Superseded by IEEE Std 802-2001 This IEEE Standards product is part of the 802 family on LAN/MAN. This document provides an overview to the family of IEEE 802 Standards, defines compliance with the family of IEEE 802 Standards, describes the relationship of the IEEE 802 Standards to the Open Systems Interconnections Basic Reference Model [ISO 7498:1984] and explains the relationship of these standards to the higher layer protocols, and provides a standard for identification of public, private, and standard protocols.

[Learn More
About 802-1990](https://standards.ieee.org/ieee/802/1024 "Learn More")

##### 802-2001

###### IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture

IEEE Std 802-2001, IEEE Standards for Local and Metropolitan Area Networks: Overview and Architecture, provides an overview to the family of IEEE 802 Standards. It defines compliance with the family of IEEE 802 Standards; it describes the relationship of the IEEE 802 Standards to the Open Systems Interconnection Basic Reference Model [ISO/IEC 7498-1:1994] and explains the relationship of these standards to the higher layer protocols; it provides a standard for the structure of LAN MAC addresses; and it provides a standard for identification of public, private, and standard protocols.

[Learn More
About 802-2001](https://standards.ieee.org/ieee/802/1025 "Learn More")

##### 802.1AB-2005

###### IEEE Standard for Local and metropolitan area networks -- Station and Media Access Control Connectivity Discovery

This document defines a protocol and a set of managed objects that can be used for discovering the physical topology from adjacent stations in 802 LANs.

[Learn More
About 802.1AB-2005](https://standards.ieee.org/ieee/802.1AB/3342 "Learn More")

##### 802.1AB-2009

###### IEEE Standard for Local and Metropolitan Area Networks-- Station and Media Access Control Connectivity Discovery

This document defines a protocol and a set of managed objects that can be used for discovering the physical topology from adjacent stations in IEEE 802 LANs.

[Learn More
About 802.1AB-2009](https://standards.ieee.org/ieee/802.1AB/4462 "Learn More")

##### 802.1AB-2009/Cor 1-2013

###### IEEE Standard for Local and metropolitan area networks--Station and Media Access Control Connectivity Discovery Corrigendum 1: Technical and Editorial Corrections

Technical and editorial errors identified by the IEEE 802.1 Working Group's maintenance activity are corrected by this corrigendum.

[Learn More
About 802.1AB-2009/Cor 1-2013](https://standards.ieee.org/ieee/802.1AB-2009_Cor_1/5516 "Learn More")

##### 802.1AB-2009/Cor 2-2015

###### IEEE Standard for Local and metropolitan area networks-- Station and Media Access Control Connectivity Discovery Corrigendum 2: Technical and Editorial Corrections

Technical and editorial errors identified by the IEEE 802.1 Working Group's maintenance activity are corrected by this corrigendum to IEEE 802.1AB(TM)-2009.

[Learn More
About 802.1AB-2009/Cor 2-2015](https://standards.ieee.org/ieee/802.1AB-2009_Cor_2/5869 "Learn More")

##### 802.1AC-2012

###### IEEE Standard for Local and metropolitan area networks-Media Access Control (MAC) Service Definition

The MAC service provided by all IEEE 802(R) MACs along with the Internal Sublayer Service (ISS) that is provided by IEEE 802 MACs to the relay function of a Media Access Control(MAC) Bridge are defined in this standard.

[Learn More
About 802.1AC-2012](https://standards.ieee.org/ieee/802.1AC/3839 "Learn More")

##### 802.1ad-2005

###### IEEE Standard for Local and Metropolitan Area Networks---Virtual Bridged Local Area Networks---Amendment 4: Provider Bridges

This amendment enables a service provider to use the architecture and protocols of IEEE Std 802.1Q to offer the equivalent of separate LANs, Bridged Local Area Networks, or Virtual Bridged Local Area Networks to a number of customers, while requiring no cooperation between the customers, and minimal cooperation between each customer and the service provider.

[Learn More
About 802.1ad-2005](https://standards.ieee.org/ieee/802.1ad/3374 "Learn More")

##### 802.1AE-2006

###### IEEE Standard for Local and Metropolitan Area Networks: Media Access Control (MAC) Security

This standard specifies how all or part of a network can be secured transparently to peer protocol entities that use the MAC Service provided by IEEE 802u00ae LANs to communicate. MAC security (MACsec) provides connectionless user data confidentiality, frame data integrity, and data origin authenticity.

[Learn More
About 802.1AE-2006](https://standards.ieee.org/ieee/802.1AE/3501 "Learn More")

##### 802.1AEbn-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Security Amendment 1: Galois Counter Mode--Advanced Encryption Standard-- 256 (GCM-AES-256) Cipher Suite

This amendment specifies the GCM-AES-256 Cipher Suite as an option in addition to the existing mandatory to implement Default Cipher Suite, GCM-AES-128.

[Learn More
About 802.1AEbn-2011](https://standards.ieee.org/ieee/802.1AEbn/5068 "Learn More")

##### 802.1AEbw-2013

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Security Amendment 2: Extended Packet Numbering

The optional use of Cipher Suites that make use of a 64-bit (PN) to allow more than 232 MACsec protected frames to be sent with a single Secure Association Key are specified by this amendment.

[Learn More
About 802.1AEbw-2013](https://standards.ieee.org/ieee/802.1AEbw/5463 "Learn More")

##### 802.1AEcg-2017

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Security - Amendment 3: Ethernet Data Encryption devices

Ethernet Data Encryption devices (EDEs) are specified in this amendment. An EDE is a two-port bridge that uses MACsec to provide secure connectivity for attached customer bridges, or for attached provider bridges. EDEs may allow the customer (or provider) bridges to continue to use a VLAN Identifier (VID) in transmitted frames to select

[Learn More
About 802.1AEcg-2017](https://standards.ieee.org/ieee/802.1AEcg/5968 "Learn More")

##### 802.1ag-2007

###### IEEE Standard for Local and Metropolitan Area Networks Virtual Bridged Local Area Networks Amendment 5: Connectivity Fault Management

This amendment specifies protocols, procedures, and managed objects to support connectivity fault management. These allow discovery and verification of the path, through bridges and LANs, taken for frames addressed to and from specified network users. Connectivity faults can be detected and isolated to an individual bridge or LAN.

[Learn More
About 802.1ag-2007](https://standards.ieee.org/ieee/802.1ag/3597 "Learn More")

##### 802.1ah-2008

###### IEEE Standard for Local and metropolitan area networks -- Virtual Bridged Local Area Networks Amendment 7: Provider Backbone Bridges

This amendment defines an architecture and bridge protocols for interconnection of multiple Provider Bridged Networks, allowing a Provider to support up tot 2^20 service instances.

[Learn More
About 802.1ah-2008](https://standards.ieee.org/ieee/802.1ah/3689 "Learn More")

##### 802.1aj-2009

###### IEEE Standard for Local and Metropolitan Area Networks--Virtual Bridged Local Area Networks Amendment 11: Two-Port Media Access Control (Mac) Relay

This amendment to IEEE Std 802.1Q specifies the function of a MAC Relay with two MACs, and the protocols and procedures to support its operation. A MAC Relay is transparent to all frame-based media independent protocols except those explicitly addressed to this device. It is remotely manageable through at least one of its external MACs, and signals a failure of either MAC's LAN through the other MAC.

[Learn More
About 802.1aj-2009](https://standards.ieee.org/ieee/802.1aj/3690 "Learn More")

##### 802.1ak-2007

###### IEEE Standard for Local and Metropolitan Area Networks - Virtual Bridged Local Area Networks - Amendment 07: Multiple Registration Protocol

This amendment specifies a set of protocols that replaces the GARP, GMRP, and GVRP protocols specified in earlier versions of IEEE Std 802.1Q.

[Learn More
About 802.1ak-2007](https://standards.ieee.org/ieee/802.1ak/3691 "Learn More")

##### 802.1ap-2008

###### IEEE Standard for Local and Metropolitan Area Networks -- Virtual Bridged Local Area Networks - Amendment 8: Management Information Base (MIB) Definitions for VLAN Bridges

This amendment includes management information base (MIB) definitions in IEEE Std 802.1Q.

[Learn More
About 802.1ap-2008](https://standards.ieee.org/ieee/802.1ap/3817 "Learn More")

##### 802.1aq-2012

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 20: Shortest Path Bridging

This amendment to IEEE Std 802.1Q-2011 specifies shortest path bridging of unicast and multicast frames, including protocols to calculate multiple active topologies that can share learned station information, and support of a virtual local area network (VLAN) by multiple, per topology VLAN identifiers (VIDs). (Additional downloads for this standard are attached or can be downloaded at http://standards.ieee.org/downloads/802.1/index.html)

[Learn More
About 802.1aq-2012](https://standards.ieee.org/ieee/802.1aq/3818 "Learn More")

##### 802.1AR-2009

###### IEEE Standard for Local and metropolitan area networks - Secure Device Identity

A secure device identifier (DevID) is cryptographically bound to a device and supports authentication of the device's identity. Locally significant identities can be securely associated with an initial manufacturer-provisioned DevID and used in provisioning and authentication protocols to allow a network administrator to establish the trustworthiness of a device and select appropriate policies for transmission and reception of data and control protocols to and from the device.

[Learn More
About 802.1AR-2009](https://standards.ieee.org/ieee/802.1AR/4678 "Learn More")

##### 802.1AS-2011

###### IEEE Standard for Local and Metropolitan Area Networks - Timing and Synchronization for Time-Sensitive Applications in Bridged Local Area Networks

This standard defines a protocol and procedures for the transport of timing over bridged and virtual bridged local area networks. It includes the transport of synchronized time, the selection of the timing source (i.e., best master), and the indication of the occurrence and magnitude of timing impairments (i.e., phase and frequency discontinuities).

[Learn More
About 802.1AS-2011](https://standards.ieee.org/ieee/802.1AS/3956 "Learn More")

##### 802.1AS-2011/Cor 1-2013

###### IEEE Standard for Local and metropolitan area networks– Timing and Synchronization for Time-Sensitive Applications in Bridged Local Area Networks– Corrigendum 1: Technical and Editorial Corrections

This corrigendum to IEEE Std 802.1AS - 2011 corrects minor errors, bugs, ambiguities, and inconsistencies that were missed when the document was balloted. It does not contain new material.

[Learn More
About 802.1AS-2011/Cor 1-2013](https://standards.ieee.org/ieee/802.1AS-2011_Cor_1/5301 "Learn More")

##### 802.1AS-2011/Cor 2-2015

###### IEEE Standard for Local and metropolitan area networks-- Timing and Synchronization for Time-Sensitive Applications in Bridged Local Area Networks-- Corrigendum 2: Technical and Editorial Corrections

Technical and editorial corrections are provided by this corrigendum to IEEE Std 802.1AS.

[Learn More
About 802.1AS-2011/Cor 2-2015](https://standards.ieee.org/ieee/802.1AS-2011_Cor_2/6022 "Learn More")

##### 802.1AX-2008

###### IEEE Standard for Local and metropolitan area networks--Link Aggregation

Link Aggregation allows one or more links to be aggregated together to form a Link Aggregation Group, such that a Media Access Control (MAC) Client can treat the Link Aggregation Group as if it were a single link. To this end, it specifies the establishment of data terminal equipu00adment (DTE) to DTE logical links, consisting of N parallel instances of full duplex point-to-point links operating at the same data rate. This standard defines the MAC independent Link Aggregation capability, and general information relevant to specific MAC types that support link aggregation.

[Learn More
About 802.1AX-2008](https://standards.ieee.org/ieee/802.1AX/4176 "Learn More")

##### 802.1AX-2014

###### IEEE Standard for Local and metropolitan area networks -- Link Aggregation

MAC-independent Link Aggregation capability and general information relevant to specific MAC types are defined in this standard. Link Aggregation allows parallel full-duplex point-to-point links to be used as if they were a single link and also supports the use of multiple links as a resilient load sharing interconnect between multiple nodes in two separately administered networks. (The PDF of this standard is available at no cost compliments of the IEEE GET program. Additional downloads are attached or can be downloaded at https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1AX-2014](https://standards.ieee.org/ieee/802.1AX/5800 "Learn More")

##### 802.1AX-2014/Cor 1-2017

###### IEEE Standard for Local and metropolitan area networks -- Link Aggregation -- Corrigendum 1: Technical and editorial corrections

Technical and editorial corrections are provided in this corrigendum to IEEE Std 802.1AX-2014.

[Learn More
About 802.1AX-2014/Cor 1-2017](https://standards.ieee.org/ieee/802.1AX-2014_Cor_1/6235 "Learn More")

##### 802.1AXbk-2012

###### IEEE Standard for Local and metropolitan area networks--Link Aggregation Amendment 1: Protocol Addressing

Link Aggregation allows one or more links to be aggregated together to form a Link Aggregation Group, such that a Media Access Control (MAC) Client can treat the Link Aggregation Group as if it were a single link. To this end, it specifies the establishment of data terminal equipment (DTE) to DTE logical links, consisting of N parallel instances of full-duplex, point-to-point links operating at the same data rate. The MAC independent Link Aggregation capability, and general information relevant to specific MAC types that support Link Aggregation, are defined in this standard.

[Learn More
About 802.1AXbk-2012](https://standards.ieee.org/ieee/802.1AXbk/4848 "Learn More")

##### 802.1BA-2011

###### IEEE Standard for Local and metropolitan area networks--Audio Video Bridging (AVB) Systems

Profiles that select features, options, configurations, defaults, protocols and procedures of bridges, stations and LANs that are necessary to build networks that are capable of transporting time-sensitive audio and/or video data streams are defined in this standard. (This PDF of this standard is available as part of the IEEE Get program. Through the IEEE SA and industry support, select IEEE standards are available for download at no charge. For more details go to our web page at https://ieeexplore.ieee.org/browse/standards/get-program/page.)

[Learn More
About 802.1BA-2011](https://standards.ieee.org/ieee/802.1BA/4396 "Learn More")

##### 802.1BA-2011/Cor 1-2016

###### IEEE Standard for Local and metropolitan area networks-- Audio Video Bridging (AVB) Systems-- Corrigendum 1: Technical and Editorial Corrections

Technical and editorial errors identified by the IEEE 802.1 Working Group's maintenance activity are corrected in this corrigendum to IEEE Std 802.1BA-2011.

[Learn More
About 802.1BA-2011/Cor 1-2016](https://standards.ieee.org/ieee/802.1BA-2011_Cor_1/6710 "Learn More")

##### 802.1D-2004

###### IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges

An architecture for the interconnection of IEEE 802(R) Local Area Networks (LANs) below the MAC Service boundary is defined. MAC Bridges, as specified by this standard, allow communications between end stations attached to separate LANs, each with its own separate MAC, to be transparent to logical link control (LLC) and network layer protocols, just as if the stations were attached to the same LAN.

[Learn More
About 802.1D-2004](https://standards.ieee.org/ieee/802.1D/3387 "Learn More")

##### 802.1Q-1998

###### IEEE Standards for Local and Metropolitan Area Networks: Virtual Bridged Local Area Networks

This IEEE Standards product is part of the 802 family on LAN/MAN. This standard defines an architecture for Virtual Bridged LANs, the services provided in Virtual Bridged LANs, and the protocols and algorithms involved in the provision of those services.

[Learn More
About 802.1Q-1998](https://standards.ieee.org/ieee/802.1Q/1039 "Learn More")

##### 802.1Q-2005

###### IEEE Standard for Local and Metropolitan Area Networks---Virtual Bridged Local Area Networks

This standard specifies how the MAC Service is supported by Virtual Bridged Local Area Networks, the principles of operation of those networks, and the operation of VLAN-aware Bridges, including management, protocols, and algorithms.

[Learn More
About 802.1Q-2005](https://standards.ieee.org/ieee/802.1Q/3495 "Learn More")

##### 802.1Q-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks

This standard specifies how the MAC Service is supported by Virtual Bridged Local Area Networks, the principles of operation of those networks, and the operation of VLAN-aware Bridges, including management, protocols, and algorithms. Incorporates IEEE Std 802.1Q-2005, IEEE Std 802.1ad-2005, IEEE Std 802.1ak-2007, IEEE Std 802.1ag-2007, IEEE Std 802.1ah-2008, IEEE Std 802-1Q-2005/Cor-1-2008, IEEE Std 802.1ap-2008, IEEE Std 802.1Qaw-2009, IEEE Std 802.1Qay-2009, IEEE Std 802.1aj-2009, IEEE Std 802.1Qav-2009, IEEE Std Qau-2010, and IEEE Std Qat-2010.

[Learn More
About 802.1Q-2011](https://standards.ieee.org/ieee/802.1Q/4410 "Learn More")

##### 802.1Q-2014

###### IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks

This standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms. This revision includes the following amendments and corrigenda: IEEE 802.1Qbe-2011 IEEE 802.1Qbc-2011 IEEE 802.1Qbb-2011 IEEE 802.1Qaz-2011 IEEE 802.1Qbf-2011 IEEE 802.1Qbg-2012 IEEE 802.1aq-2012 IEEE 802.1Q-2011/Cor 2-2012 IEEE 802.1Qbp-2014./index.html. It also supersedes IEEE 802.1D-2004.

[Learn More
About 802.1Q-2014](https://standards.ieee.org/ieee/802.1Q/5801 "Learn More")

##### 802.1Q-2018

###### IEEE Standard for Local and Metropolitan Area Networks–Bridges and Bridged Networks

This standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms. Supersedes 802.1Q™-2014. IEEE 802.1Qcd™-2015, IEEE 802.1Qca™-2015,IEEE 802.1Q™-2014\_Cor-1-2015, IEEE 802.1Qbv™-2015, IEEE 802.1Qbu™-2016, IEEE 802.1Qbz™-2016, IEEE 802.1Qci™-2017 and IEEE 802.1Qch™-2017.

[Learn More
About 802.1Q-2018](https://standards.ieee.org/ieee/802.1Q/6844 "Learn More")

##### 802.1Q, 2003 Edition-2003

###### IEEE Standards for Local and Metropolitan Area Networks: Virtual Bridged Local Area Networks

This standard defines an architecture for Virtual Bridged LANs, the services provided in Virtual Bridged LANs, and the protocols and algorithms involved in the provision of those services. (Incorporates IEEE Std 802.1Q-1998, IEEE Std 802.1u-2001, IEEE Std 802.1v-2001, and IEEE Std 802.1s-2002)

Learn More
About 802.1Q, 2003 Edition-2003

##### 802.1Q-2005/Cor 1-2008

###### IEEE Standard for Local and Metropolitan Area Networks - Virtual Bridged Local Area Networks - Corrigendum 1: Corrections to the Multiple Registration Protocol

This corrigendum to IEEE Std 802.1Q corrects errors in the MRP protocol specification.

[Learn More
About 802.1Q-2005/Cor 1-2008](https://standards.ieee.org/ieee/802.1Q-2005_Cor_1/4298 "Learn More")

##### 802.1Q-2011/Cor 2-2012

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Corrigendum 2: Technical and editorial corrections

This corrigendum to IEEE Std 802.1Q-2011 corrects technical and editorial errors identified by the IEEE 802.1 Working Group's maintenance activity.

[Learn More
About 802.1Q-2011/Cor 2-2012](https://standards.ieee.org/ieee/802.1Q-2011_Cor_2/5417 "Learn More")

##### 802.1Q-2014/Cor 1-2015

###### IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks--Corrigendum 1: Technical and editorial corrections

Correction of technical and editorial errors identified by the IEEE 802.1 maintenance activity are presented in this document.

[Learn More
About 802.1Q-2014/Cor 1-2015](https://standards.ieee.org/ieee/802.1Q-2014_Cor_1/6071 "Learn More")

##### 802.1Qat-2010

###### IEEE Standard for Local and metropolitan area networks--Virtual Bridged Local Area Networks Amendment 14: Stream Reservation Protocol (SRP)

This amendment specifies protocols, procedures, and managed objects, usable by existing higher layer mechanisms, that allow network resources to be reserved for specific traffic streams traversing a bridged local area network. (The PDF of this standard is available at not cost compliments of the GETIEEE802 program located at https://ieeexplore.ieee.org/browse/standards/get-program/page)

[Learn More
About 802.1Qat-2010](https://standards.ieee.org/ieee/802.1Qat/4050 "Learn More")

##### 802.1Qau-2010

###### IEEE Standard for Local and Metropolitan Area Networks-- Virtual Bridged Local Area Networks Amendment 13: Congestion Notification

This amendment specifies protocols, procedures and managed objects that support congestion management of long-lived data flows within network domains of limited bandwidth-delay product. This is achieved by enabling bridges to signal congestion to end stations capable of transmission rate limiting to avoid frame loss.

[Learn More
About 802.1Qau-2010](https://standards.ieee.org/ieee/802.1Qau/4051 "Learn More")

##### 802.1Qav-2009

###### IEEE Standard for Local and metropolitan area networks-- Virtual Bridged Local Area Networks Amendment 12: Forwarding and Queuing Enhancements for Time-Sensitive Streams

This amendment to IEEE Std 802.1Q defines enhancements to the forwarding and queueing functions of a VLAN Bridge to support the transmission of time sensitive data streams.

[Learn More
About 802.1Qav-2009](https://standards.ieee.org/ieee/802.1Qav/4401 "Learn More")

##### 802.1Qaw-2009

###### IEEE Standard for Local and metropolitan area networks-- Virtual Bridged Local Area Networks Amendment 9: Management of Data Driven and Data Dependent Connectivity Faults

This amendment extends the connectivity fault management capabilities introduced in IEEE Std 802.1ag-2007 to include tools to facilitate diagnosis and isolation of faults sensitive to, or caused by, particular data patterns in frames transmitted by a service user.

[Learn More
About 802.1Qaw-2009](https://standards.ieee.org/ieee/802.1Qaw/4149 "Learn More")

##### 802.1Qay-2009

###### IEEE Standard for Local and metropolitan area networks-- Virtual Bridged Local Area Networks Amendment 10: Provider Backbone Bridge Traffic Engineering

This amendment specifies changes to IEEE Std 802.1Q-2005, as amended by IEEE Std 802.1ad-2005, IEEE Std 802.1ag-2007, IEEE Std 802.1ak-2007, IEEE Std 802.1ah-2008, and IEEE Std 802.1ap-2008, that support provisioning systems that explicitly select traffic engineered paths within Provider Backbone Bridged Networks. Changes are applied to the base text of IEEE Std 802.1Q-2005 as amended by IEEE Std 802.1ad-2005, IEEE Std 802.1ak-2007, IEEE Std 802.1ag-2007, IEEE Std 802.1ah-2008, and IEEE Std 802.1ap-2008.

[Learn More
About 802.1Qay-2009](https://standards.ieee.org/ieee/802.1Qay/4191 "Learn More")

##### 802.1Qaz-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 18: Enhanced Transmission Selection for Bandwidth Sharing Between Traffic Classes

This amendment to IEEE Std 802.1Q-2011 defines enhancements to transmission selection to support allocation of bandwidth amongst traffic classes, plus a protocol for controlling the application of Data Center Bridging features.

[Learn More
About 802.1Qaz-2011](https://standards.ieee.org/ieee/802.1Qaz/4741 "Learn More")

##### 802.1Qbb-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 17: Priority-based Flow Control

This amendment to IEEE Std 802.1Q-2011 specifies protocols, procedures, and managed objects that enable flow control per traffic class on IEEE 802(R) point-to-point full duplex links. This is achieved by a mechanism similar to IEEE 802.3 Annex 31B PAUSE, but operating on individual priorities.

[Learn More
About 802.1Qbb-2011](https://standards.ieee.org/ieee/802.1Qbb/4361 "Learn More")

##### 802.1Qbc-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 16: Provider Bridging--Remote Customer Service Interfaces

This amendment to IEEE Std 802.1Q-2011 specifies the use of service virtual local area networks (S-VLANs) to provide customer service interfaces in one Provider Bridged Network for customer interface local area networks (LANs) attached to another Provider Bridged Network.

[Learn More
About 802.1Qbc-2011](https://standards.ieee.org/ieee/802.1Qbc/4685 "Learn More")

##### 802.1Qbe-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks-- Amendment 15: Multiple I-SID Registration Protocol

This amendment to IEEE Std 802.1Q-2011 specifies protocols, procedures, and managed objects to support topology change signaling to alter the binding (held in an I-Component) of Customer addresses to Backbone addresses on a per-I-SID basis. This is accomplished by extending the use of the Multiple Registration Protocol (MRP).

[Learn More
About 802.1Qbe-2011](https://standards.ieee.org/ieee/802.1Qbe/4686 "Learn More")

##### 802.1Qbf-2011

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 19: PBB-TE Infrastructure Segment Protection

This amendment to IEEE Std 802.1Q-2011 specifies localized protection of selected Traffic Engineered Service Instances traversing a common sequence of Provider Network Ports.

[Learn More
About 802.1Qbf-2011](https://standards.ieee.org/ieee/802.1Qbf/4687 "Learn More")

##### 802.1Qbg-2012

###### IEEE Standard for Local and metropolitan area networks--Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks--Amendment 21: Edge Virtual Bridging

This amendment to IEEE Std 802.1Q-2011 specifies protocols, procedures, and managed objects that -- Provide for the discovery, configuration, and control of a pair of direct-attached limited-function Service VLAN (S-VLAN) components to extend the services of a customer bridge to remote ports and enable coexistence of multiple services onstation-resident ports (e.g., embedded bridging). -- Provide for discovery, configuration, and control of a Reflective Relay Service for a bridge port. -- Provide for discovery of, and coordinated configuration of, edge relays (ERs) and other devices that utilize the reflective relay service. -- Provide for dynamic profile-driven port configuration. (Additional files are attached or can be found at http://standards.ieee.org/downloads/802.1/

[Learn More
About 802.1Qbg-2012](https://standards.ieee.org/ieee/802.1Qbg/4757 "Learn More")

##### 802.1Qbp-2014

###### IEEE Standard for Local and metropolitan area networks - Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks - Amendment 22: Equal Cost Multiple Path (ECMP)

Routing algorithms and relay behavior supporting equal cost multipath forwarding in shortest path bridged VLANs are specified in this amendment to IEEE Std 802.1Q.

[Learn More
About 802.1Qbp-2014](https://standards.ieee.org/ieee/802.1Qbp/5217 "Learn More")

##### 802.1Qbu-2016

###### IEEE Standard for Local and metropolitan area networks -- Bridges and Bridged Networks -- Amendment 26: Frame Preemption

Enhancements to the forwarding process that support frame preemption are provided in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 802.1Qbu-2016](https://standards.ieee.org/ieee/802.1Qbu/5464 "Learn More")

##### 802.1Qbv-2015

###### IEEE Standard for Local and metropolitan area networks -- Bridges and Bridged Networks - Amendment 25: Enhancements for Scheduled Traffic

Enhancements to the forwarding process that supports scheduled traffic is provided in this amendment to IEEE Std 802.1Q-2014. Additional downloads are attached or can be downloaded at http://standards.ieee.org/downloads/802.1/index.html)

[Learn More
About 802.1Qbv-2015](https://standards.ieee.org/ieee/802.1Qbv/6068 "Learn More")

##### 802.1Qbz-2016

###### IEEE Standard for Local and metropolitan area networks–Bridges and Bridged Networks–Amendment 27: Enhancements to Bridging of IEEE 802.11 Media

Protocols, procedures, and managed objects to allow IEEE 802.11 media to provide internal connections within bridged networks, as well as access to bridged networks, are provided in this amendment.

[Learn More
About 802.1Qbz-2016](https://standards.ieee.org/ieee/802.1Qbz/5556 "Learn More")

##### 802.1Qca-2015

###### IEEE Standard for Local and metropolitan area networks-- Bridges and Bridged Networks - Amendment 24: Path Control and Reservation

Explicit path control, bandwidth reservation, and redundancy (protection, restoration) for data flows are specified in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 802.1Qca-2015](https://standards.ieee.org/ieee/802.1Qca/5557 "Learn More")

##### 802.1Qcc-2018

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks -- Amendment 31: Stream Reservation Protocol (SRP) Enhancements and Performance Improvements

Enhancements to the configuration of time-sensitive streams are provided by this amendment to IEEE Std 802.1Q-2018.

[Learn More
About 802.1Qcc-2018](https://standards.ieee.org/ieee/802.1Qcc/5784 "Learn More")

##### 802.1Qcd-2015

###### IEEE Standard for Local and metropolitan area networks-- Bridges and Bridged Networks - Amendment 23: Application Virtual Local Area Network (VLAN) Type, Length, Value (TLV)

Enhancements to the set of TLVs used by the Data Center Bridging eXchange protocol (DCBX) for the purpose of simplifying the management of networks utilizing Data Center Bridging (DCB) features are defined in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 802.1Qcd-2015](https://standards.ieee.org/ieee/802.1Qcd/5924 "Learn More")

##### 802.1Qch-2017

###### IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks--Amendment 29: Cyclic Queuing and Forwarding

The use of traffic scheduling and per-stream filtering and policing to support cyclic queuing and forwarding are described in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 802.1Qch-2017](https://standards.ieee.org/ieee/802.1Qch/6072 "Learn More")

##### 802.1Qci-2017

###### IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks--Amendment 28: Per-Stream Filtering and Policing

Enhancements to the forwarding process that support per-stream filtering and policing are provided in this amendment to IEEE Std 802.1Q-2014.

[Learn More
About 802.1Qci-2017](https://standards.ieee.org/ieee/802.1Qci/6159 "Learn More")

##### 802.1Qcp-2018

###### IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks--Amendment 30: YANG Data Model

A YANG data model in support of configuration and operational status information for a subset of Bridging capabilities is provided in this amendment to IEEE Std 802.1Q-2018.

[Learn More
About 802.1Qcp-2018](https://standards.ieee.org/ieee/802.1Qcp/6238 "Learn More")

##### 802.1Qcr-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks - Amendment 34:Asynchronous Traffic Shaping

Procedures and managed objects for Bridges and end stations to perform Asynchronous Traffic Shaping over full-duplex links with constant bit data rates are specified in this amendment to IEEE Std 802.1Q(TM)-2018.

[Learn More
About 802.1Qcr-2020](https://standards.ieee.org/ieee/802.1Qcr/7420 "Learn More")

##### 802.1Qcx-2020

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 33: YANG Data Model for Connectivity Fault Management

YANG data model that supports configuration, status reporting, and monitoring for Connectivity Fault Management (CFM) for Two-Port MAC Relays, Customer VLAN Bridges, and Provider Bridges is further developed by this amendment to IEEE Std 802.1Q™-2018. See also IEEE Std 802.1Qcp™-2018 for the introduction of this YANG data model.

[Learn More
About 802.1Qcx-2020](https://standards.ieee.org/ieee/802.1Qcx/7135 "Learn More")

##### 802.1Qcy-2019

###### IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks Amendment 32: Virtual Station Interface (VSI) Discovery and Configuration Protocol (VDP) Extension to Support Network Virtualization Overlays Over Layer 3 (NVO3)

Extensions to the Virtual Station Interface (VSI) Discovery and Configuration Protocol (VDP) to support using the protocol between an end station and a device doing encapsulation/decapsulation for Network Virtualization Overlays Over Layer 3 (NVO3) are specified in this amendment to IEEE Std 802.1Q-2018. The extensions include adding format types [e.g., Internet Protocol (IP) addresses] and enhancing indication of migration events.

[Learn More
About 802.1Qcy-2019](https://standards.ieee.org/ieee/802.1Qcy/6237 "Learn More")

##### 802.1s-2002

###### IEEE Standards for Local and Metropolitan Area Networks - Amendment to 802.1Q Virtual Bridged Local Area Networks: Multiple Spanning Trees

This standard extends the architecture, protocols, and algorithms specified in IEEE Std 802.1Q, 1998 Edition, to allow data traffic belonging to different VLANs to be allocated to different spanning trees, while retaining interoperability with bridges conformant to that prior specification.

[Learn More
About 802.1s-2002](https://standards.ieee.org/ieee/802.1s/1042 "Learn More")

##### 802.1u-2001

###### IEEE Standard for Virtual Bridged Local Area Networks - Corrigendum 1: Technical and Editorial Corrections

This amendment to IEEE 802.1Q,1998 Edition is intended to document maintenance items identified in the text of IEEE Std 802.1Q, 1998 Edition.IEEE Std 802.1u-2001 identifies any proposed changes to IEEE Std 802.1Q, 1998 Edition that have arisen as a consequence of maintenance activity. The changes are documented in the usual form for an amendment to IEEE 802 standards; i.e., as an explicit set of editing instructions that, if correctly applied to the text of IEEE Std 802.1Q,1998 Edition, will create a corrected document.

[Learn More
About 802.1u-2001](https://standards.ieee.org/ieee/802.1u/1044 "Learn More")

##### 802.1v-2001

###### IEEE Standard for Local and metropolitan area networks--Virtual Bridged Local Area Networks -- Amendment 2: VLAN Classification by Protocol and Port

This amendment to IEEE Std 802.1Q,1998 Edition describes enhancements to allow for classification of incoming packets by methods other than source port. Specifically, it defines rules for classification based on data-link layer protocol identification. The document identifies proposed changes to the text of IEEE Std 802.1Q,1998 Edition that have arisen as a consequence of this activity. These are documented in the usual form for amendments to IEEE 802 standards; i.e., as an explicit set of editing instructions that, if correctly applied to the text of IEEE Std 802.1Q,1998 Edition, will create a corrected document.

[Learn More
About 802.1v-2001](https://standards.ieee.org/ieee/802.1v/1045 "Learn More")

##### 802.1X-2004

###### IEEE Standard for Local and metropolitan area networks - Port-Based Network Access Control

Revision of IEEE Std 802.1X-2001 Port-based network access control makes use of the physical access characteristics of IEEE 802 Local Area Networks (LAN) infrastructures in order to provide a means of authenticating and authorizing devices attached to a LAN port that has point-to-point connection characteristics, and of preventing access to that port in cases in which the authentication and authorization process fails.

[Learn More
About 802.1X-2004](https://standards.ieee.org/ieee/802.1X/3496 "Learn More")

##### 802.1X-2010

###### IEEE Standard for Local and metropolitan area networks--Port-Based Network Access Control

Port-based network access control allows a network administrator to restrict the use of IEEE 802 LAN service access points (ports) to secure communication between authenticated and authorized devices. This standard specifies a common architecture, functional elements, and protocols that support mutual authentication between the clients of ports attached to the same LAN and that secure communication between the ports, including the media access method independent protocols that are used to discover and establish the security associations used by IEEE 802.1AE MAC Security.

[Learn More
About 802.1X-2010](https://standards.ieee.org/ieee/802.1X/4384 "Learn More")

##### 802.1Xbx-2014

###### IEEE Standard for Local and metropolitan area networks -- Port-Based Network Access Control Amendment 1: MAC Security Key Agreement Protocol (MKA) Extensions

Media Access Control security (MACsec) Key Agreement protocol (MKA) data elements and procedures that provide additional security and manageability capabilities, including the ability to maintain secure communication while the operation of MKA is suspended, when used in conjunction with MACsec Cipher Suites that support Extended Packet Numbering are added in this amendment.

[Learn More
About 802.1Xbx-2014](https://standards.ieee.org/ieee/802.1Xbx/5466 "Learn More")

##### 802.1Xck-2018

###### IEEE Standard for Local and metropolitan area networks - Port-Based Network Access Control Amendment 2: YANG Data Model

The YANG data model specified in this amendment to IEEE Std 802.1X-2010 allows configuration and status reporting for port-based network access control, in the scenarios described in Clause 7 of this standard and Clause 11 of IEEE Std 802.1AE-2018, using the information model previously specified in this standard.

[Learn More
About 802.1Xck-2018](https://standards.ieee.org/ieee/802.1Xck/6239 "Learn More")

##### 802a-2003

###### IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture - Amendment 1: Ethertypes for Prototype and Vendor-Specific Protocol Development

IEEE Std 802-2001, IEEE Local and Metropolitan Area Networks: Overview and Architecture, provides an overview to the family of IEEE 802 Standards. This amendment to IEEE Std 802 identifies a set of Ethertypes that may be used for prototype and vendor specific use, and defines how the Ethertypes should be used.

[Learn More
About 802a-2003](https://standards.ieee.org/ieee/802a/3252 "Learn More")

##### 802b-2004

###### IEEE Standard for Local and Metropolitan Area Networks: Overview and Architecture - Amendment 2: Registration of Object Identifiers

IEEE Std 802-2001, IEEE Local and Metropolitan Area Networks: Overview and Architecture, provides an overview to the family of IEEE 802 standards. This amendment to IEEE Std 802-2001 specifies an Object Identifier hierarchy used within IEEE 802 for uniform allocation of Object Identifiers used in IEEE 802 standards.

[Learn More
About 802b-2004](https://standards.ieee.org/ieee/802b/3420 "Learn More")

##### 8802-1BA-2016

###### ISO/IEC/IEEE International Standard - Information technology – Telecommunications and information exchange between systems – Local and metropolitan area networks – Specific requirements – Part 1BA: Audio video bridging (AVB) systems

Profiles that select features, options, configurations, defaults, protocols and procedures of bridges, stations and LANs that are necessary to build networks that are capable of transporting time-sensitive audio and/or video data streams are defined in this standard.

[Learn More
About 8802-1BA-2016](https://standards.ieee.org/ieee/8802-1BA/6870 "Learn More")

##### 8802-1Q-2016

###### ISO/IEC/IEEE International Standard - Information technology -- Telecommunications and information exchange between systems -- Local and metropolitan area networks -- Specific requirements -- Part 1Q: Bridges and bridged networks

This international standard specifies how the Media Access Control (MAC) Service is supported by Bridged Networks, the principles of operation of those networks, and the operation of MAC Bridges and VLAN Bridges, including management, protocols, and algorithms

[Learn More
About 8802-1Q-2016](https://standards.ieee.org/ieee/8802-1Q/6205 "Learn More")

**These standards have been removed from active status through a ballot
where the standard is made inactive as a consensus decision of a
balloting group.**

---

##### 802.1F-1993

###### IEEE Standards for Local and Metropolitan Area Networks: Common Definitions and Procedures for IEEE 802 Management Information

Management information and procedures applicable across the entire family of IEEE 802 LAN/MAN standards within the architectural framework for LAN/MAN Management specified in IEEE Std 802-1990 are identified. Common management information, such as attributes to represent MAC address and managed objects to represent configurable gauges, are specified. The need of developers of LAN/MAN management specifications for common procedures to develop, describe, and register management information is addressed.

[Learn More
About 802.1F-1993](https://standards.ieee.org/ieee/802.1F/1031 "Learn More")

##### 802.1H-1995

###### IEEE Standards for Local and Metropolitan Area Networks: Recommended Practice for Media Access Control (MAC) Bridging of Ethernet V2.0 in IEEE 802 Local Area Networks

Administratively withdrawn January 2011. Extensions to the behavior of ISO/IEC 10038 (IEEE 802.1D) media access control (MAC) Bridges, in order to facilitate interoperability in bridged local area networks (LANs) comprising CSMA/CD networks interconnected with other types of LAN using MAC Bridges, where the CSMA/CD networks contain a mixture of ISO/IEC 8802-3 and Ethernet V2.0 end stations, are specified. Additionally, guidelines are provided for the development of nonstandard 802 protocols, with particular emphasis on conversion of existing Ethernet protocols and the behavior to be expected from a Bridge, for the purpose of avoiding future incompatibilities.

[Learn More
About 802.1H-1995](https://standards.ieee.org/ieee/802.1H/1033 "Learn More")

**These standards are removed from active status through an
administrative process for standards that have not undergone a revision
process within 10 years.**

---

##### 802.1BR-2012

###### IEEE Standard for Local and metropolitan area networks--Virtual Bridged Local Area Networks--Bridge Port Extension

This standard specifies the operation of Bridge Port Extenders, including management, protocols, and algorithms. Bridge Port Extenders operate in support of the MAC Service by Extended Bridges.

[Learn More
About 802.1BR-2012](https://standards.ieee.org/ieee/802.1BR/5304 "Learn More")

[![IEEE logo](data:image/gif;base64...)](https://www.ieee.org/ "Visit IEEE.org")

* [LinkedIn](https://www.linkedin.com/company/ieee-sa-ieee-standards-association/ "LinkedIn")
* [Facebook](https://www.facebook.com/ieeesa/ "Facebook")
* [Instagram](https://www.instagram.com/ieeesa/ "Instagram")
* [YouTube](https://www.youtube.com/ieeesa "YouTube")
* [X](https://twitter.com/ieeesa "X")
* [Beyond Standards RSS Feed](/category/beyond-standards/feed/ "Beyond Standards RSS Feed")

IEEE SA

* [About Us](https://standards.ieee.org/about/)
* [IEEE SA Membership](https://standards.ieee.org/about/membership/)
* [Distributor Partner Program](https://standards.ieee.org/about/distrib/)
* [Training & Development](https://standards.ieee.org/about/training/)
* [Policies & Procedures](https://standards.ieee.org/about/policies/)
* [Contact Us](https://standards.ieee.org/about/contact/)
* [Provide Feedback](https://standards.ieee.org/about/feedback/)

Board of Governors

* [About Board of Governors](https://standards.ieee.org/about/bog/)
* [Awards Committee](https://standards.ieee.org/about/bog/arcom/)
* [Entity Collaborative Activities Governance Board](https://standards.ieee.org/about/bog/cag/)
* [Industry Connections Committee](https://standards.ieee.org/about/bog/iccom/)
* [Registration Authority Committee (RAC)](https://standards.ieee.org/about/bog/rac/)

Standards Board

* [About Standards Board](https://standards.ieee.org/about/sasb/)
* [Board Approvals](https://standards.ieee.org/about/sasb/sba/)
* [Audit Committee](https://standards.ieee.org/about/sasb/audcom/)
* [New Standards Committee](https://standards.ieee.org/about/sasb/nescom/)
* [Patent Committee](https://standards.ieee.org/about/sasb/patcom/)
* [Procedures Committee](https://standards.ieee.org/about/sasb/procom/)
* [Standards Review Committee](https://standards.ieee.org/about/sasb/revcom/)

News & Events

* [News](https://standards.ieee.org/news/)
* [IEEE SA Newsletter](https://standards.ieee.org/news/swire/)
* [Events](https://standards.ieee.org/events/)
* [Beyond Standards Blog](https://standards.ieee.org/beyond-standards/)

* [Home](/ "Home")
* [Sitemap](/sitemap/ "Sitemap")
* [Contact & Support](https://www.ieee.org/about/contact.html "Contact & Support")
* [Accessibility](https://www.ieee.org/accessibility-statement.html "Accessibility")
* [Nondiscrimination Policy](https://www.ieee.org/about/corporate/governance/p9-26.html "Nondiscrimination Policy")
* [IEEE Ethics Reporting](https://secure.ethicspoint.com/domain/media/en/gui/20410/index.html "IEEE Ethics Reporting")
* [IEEE Privacy Policy](https://www.ieee.org/security-privacy.html "IEEE Privacy Policy")
* [Terms & Disclosures](https://www.ieee.org/about/help/site-terms-conditions.html "Terms & Disclosures")
* [IEEE SA Copyright Policy](/ipr/ "IEEE SA Copyright Policy")

© Copyright 2021 IEEE – All rights reserved. A public charity, IEEE is the world's largest technical professional organization dedicated to advancing technology for the benefit of humanity.

Subscribe
##### Subscribe to our Newsletter

Sign up for our monthly newsletter to learn about new developments, including resources, insights and more.

**Thank you for signing up for the IEEE SA Newsletter. Check your email for a confirmation message.**



=== Content from sec.cloudapps.cisco.com_89494d61_20250115_180547.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

Invalid CVSS vector, please try again with a valid CVSS vector.

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.1 |
| Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Select Attack Vector Parameters  Attack Complexity AC: Low AC: High  Select Attack Complexity Parameters  Privileges Required PR: None PR: Low PR: High  Select Privileges Required Parameters  User Interaction UI: Required UI: None  Select User Interaction Parameters  Scope S: Unchanged S: Changed  Select Scope Parameters  Confidentiality Impact C: Low C: High C: None  Select Confidentiality Impact Parameters  Integrity Impact I: None I: Low I: High  Select Integrity Impact Parameters  Availability Impact A: Low A: High A: None  Select Availability Impact Parameters    Base Score: |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Functional  E: High  E: Not Defined  E: Proof-of-Concept  E: Unproven   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Not Defined  RC: Confirmed   Select Report Confidence Parameters     Temporal Score: |
| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: High  CR: Not Defined   Select Confidentiality Requirement Parameters  Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Select Integrity Requirement Parameters  Availability Requirement AR: Low  AR: Medium  AR: High  AR: Not Defined   Select Availability Requirement Parameters  Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Select Modified Attack Vector Parameters  Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Select Modified Attack Complexity Parameters  Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Select Modified Privileges Required Parameters  Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Select Modified User Interaction Parameters  Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Select Modified Scope Parameters  Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Select Modified Confidentiality Parameters  Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Select Modified Integrity Parameters  Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined   Select Modified Availability Parameters    Environmental Score: |
| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from tools.cisco.com_37295f4c_20250114_200853.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryVulnerabilities in Layer 2 Network Security Controls Affecting Cisco Products: September 2022 Medium   Advisory ID:  cisco-sa-VU855201-J3z8CKTX  First Published: 2022 September 27 16:00 GMT  Last Updated:  2022 October 5 18:16 GMT  Version 1.1:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154)  [CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743)  [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758)  More...  ,[CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154),[CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743),[CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758),[CSCvx35085](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085),[CSCvx35087](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087),[CSCvx37987](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx37987),[CSCvz88705](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705),[CSCvz89602](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602),[CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291),[CSCvz96133](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133),[CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097),[CSCwa04809](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809),[CSCwa06145](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145),[CSCwa06265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265),[CSCwa09081](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081),[CSCwa14271](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271),[CSCwa14282](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282),[CSCwa14942](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942),[CSCwa14950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950),[CSCwa18093](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093),[CSCwa18209](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209),[CSCwa18310](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310),[CSCwb01481](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481)   CVE-2021-27853 CVE-2021-27854 CVE-2021-27861  More...     CVE-2021-27853,CVE-2021-27854,CVE-2021-27861,CVE-2021-27862  CWE-284       CVSS Score: [Base 4.7](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2021-27853 CVE-2021-27854 CVE-2021-27861  More...     CVE-2021-27853,CVE-2021-27854,CVE-2021-27861,CVE-2021-27862  CWE-284       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX/csaf/cisco-sa-VU855201-J3z8CKTX.json)   Email      Summary  * On September 27, 2022, the following vulnerabilities affecting Cisco products were disclosed by Cert/CC as part of VU855201, titled  [L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers](https://kb.cert.org/vuls/id/855201):    + CVE-2021-27853: Layer 2 network filtering capabilities such as IPv6 RA guard or ARP inspection can be bypassed using a combination of VLAN 0 headers and LLC/SNAP headers.   + CVE-2021-27854: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using a combination of VLAN 0 headers, LLC/SNAP headers in Ethernet to Wifi frame translation, and in the reverse-Wifi to Ethernet.   + CVE-2021-27861: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length (and optionally VLAN0 headers).   + CVE-2021-27862: Layer 2 network filtering capabilities such as IPv6 RA guard can be bypassed using LLC/SNAP headers with invalid length and Ethernet to Wifi frame conversion (and optionally VLAN0 headers). Exploitation of these vulnerabilities could allow an adjacent attacker to bypass configured first-hop security (FHS) features on the affected Cisco products.  For more information about these vulnerabilities, see the [Details](#details) section of this advisory.  This advisory is available at the following link: <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX>  Affected Products  * The [Vulnerable Products](#vp) section includes Cisco bug IDs for each affected product. The bugs are accessible through the [Cisco Bug Search Tool](https://bst.cloudapps.cisco.com/bugsearch/bug/BUGID) and will contain additional platform-specific information, including workarounds (if available) and fixed software releases (if available).  Any product or service not listed in the [Vulnerable Products](#vp) section of this advisory is to be considered not vulnerable.    Vulnerable ProductsCVE-2021-27853 The following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27853. See the [Details](#details) section of this advisory for more information about affected configurations.  **Note:** End of life products have not been evaluated.       | Cisco Product | Cisco Bug ID | Additional Information |   | --- | --- | --- |   | Cisco IOS Software - Switches | | |   | Catalyst 6500 and 6800 Series Switches | [CSCwa06145](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145) | Fixed software will not be made available. |   | Catalyst Digital Building Series Switches | [CSCwa14942](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942) | Fixed software will not be made available. |   | Industrial Ethernet Switches | [CSCvw99743](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743) | Fixed software will not be made available. |   | Micro Switches | [CSCwa14271](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271) | Fixed software will not be made available. |   | Cisco IOS XE Software - Switches | | |   | Catalyst 4500 IOS-XE Switches | [CSCwa18093](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093) | Fixed software will not be made available. |   | IOS XE Switches | [CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291)[CSCwb01481](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481) | CSCvz91291 affects Cisco IOS XE Software releases 17.6.1 and later. A fix is available for all FHS features except Dynamic ARP inspection.CSCwb01481 is relevant for Dynamic ARP Inspection and impacts all releases. Fixed Software will not be made available. |   | Cisco IOS XE Software - Routers | | |   | IOS XE Routers configured with Ethernet virtual circuits | [CSCvz96133](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133) | Fixed software will not be made available. |   | Cisco IOS XR Software | | |   | IOS XR Routers configured with L2 Transport services | [CSCvz88705](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705)[CSCvz89602](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602) | Fixed software will not be made available. |   | Cisco Meraki - Switches | | |   | MS390 | N/A | Impact is only for Dynamic ARP Inspection. Fixed software will not be made available. |   | MS210MS225MS250MS350MS355MS410MS420MS425MS450 | N/A | Fixed software will not be made available. |   | Cisco NX-OS Software | | |   | Nexus 3000 Series Switches | [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758) | Fixed software will not be made available. |   | Nexus 5500 Platform SwitchesNexus 5600 Platform SwitchesNexus 6000 Series Switches | [CSCvx35087](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087) | Fixed software will not be made available. |   | Nexus 7000 Series Switches | [CSCvx35085](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085) | Fixed software will not be made available. |   | Nexus 9000 Series Switches (Standalone Mode) | [CSCvx33758](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758) | Fixed software will not be made available. |   | Cisco Small Business Switches | | |   | 250 Series Smart Switches350 Series Managed Switches350X Series Stackable Managed Switches550X Series Stackable Managed SwitchesBusiness 250 Series Smart SwitchesBusiness 350 Series Managed Switches | [CSCvw92154](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154) | Fixed software will not be made available. |      CVE-2021-27854 **Cisco Access Points**  Cisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access Points. No impact was observed.  As part of the investigation into the impact to Cisco Access Points, another vulnerability was found, and a companion advisory has been published: [Cisco Access Points VLAN Bypass from Native VLAN Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apvlan-TDTtb4FY). CVE-2021-27861 The following table lists Cisco products that are affected by the vulnerability that is described in CVE-2021-27861. See the [Details](#details) section of this advisory for more information about affected configurations.  **Note**: End of life products have not been evaluated.       | Cisco Product | Cisco Bug ID | Additional Information |   | --- | --- | --- |   | Cisco IOS Software - Switches | | |   | Catalyst 6500 and 6800 Series Switches | [CSCwa06265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06265) | Fixed software will not be made available. |   | Catalyst Digital Building Series Switches | [CSCwa14950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14950) | Fixed software will not be made available. |   | Micro Switches | [CSCwa14282](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14282) | Fixed software will not be made available. |   | Cisco IOS XR Software | | |   | IOS XR Routers configured with L2 Transport services | [CSCwa04809](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa04809) | Fixed software will not be made available. |   | Cisco Meraki - Switches | | |   | MS210MS225MS250MS350MS355MS410MS420MS425MS450 | N/A | Fixed software will not be made available. |   | Cisco NX-OS Software | | |   | Nexus 3000 Series Switches | [CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097) | Fixed software will not be made available. |   | Nexus 5500 Platform SwitchesNexus 5600 Platform SwitchesNexus 6000 Series Switches | [CSCwa18209](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18209) | Fixed software will not be made available. |   | Nexus 7000 Series Switches | [CSCwa18310](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18310) | Fixed software will not be made available. |   | Nexus 9000 Series Switches (Standalone Mode) | [CSCwa01097](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa01097) | Fixed software will not be made available. |   | Cisco Small Business Switches | | |   | 250 Series Smart Switches350 Series Managed Switches350X Series Stackable Managed Switches550X Series Stackable Managed SwitchesBusiness 250 Series Smart SwitchesBusiness 350 Series Managed Switches | [CSCwa09081](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa09081) | Fixed software will not be made available. |      CVE-2021-27862 Cisco evaluated this vulnerability based on its impact on FHS features that are configured on Cisco Access points. No impact was observed. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability. CVE-2021-27853 Cisco has confirmed that this vulnerability does not affect the following Cisco products:  **ONT Switches**    + Catalyst PON Series Switches **IOS Switches**    + Catalyst 1000 Series Switches **IOS XE Platforms**    + Catalyst 8000 Series Edge Platforms **NX-OS Software**    + MDS 9000 Series Multilayer Switches   + Nexus 1000V Series Switches   + Nexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode   + UCS 6x00 Series Fabric Interconnects **Meraki Switches**    + GS110 Switches   + MS22 Switches   + MS42 Switches   + MS120 Switches   + MS125 Switches   + MS220 Switches   + MS320 SwitchesCVE-2021-27854 Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Access Points   + AireOS Access Points   + Meraki Access PointsCVE-2021-27861 Cisco has confirmed that this vulnerability does not affect the following Cisco products:  **ONT Switches**    + Catalyst PON Series Switches **IOS Switches**    + Catalyst 1000 Series Switches   + Industrial Ethernet Switches **IOS XE Routers**    + IOS XE Routers when configured with Ethernet virtual circuits **IOS XE Software Switches**    + Catalyst 3650 Series Switches   + Catalyst 3850 Series Switches   + Catalyst 4500E and 4500X Series Switches   + Catalyst 9000 Series Switches **Meraki Switches**    + GS110 Switches   + MS22 Switches   + MS42 Switches   + MS120 Switches   + MS125 Switches   + MS220 Switches   + MS320 Switches   + MS390 Switches **NX-OS Software**    + MDS 9000 Series Multilayer Switches   + Nexus 1000V Series Switches   + Nexus 9000 Series Fabric Switches in Application Centric Infrastructure (ACI) mode   + UCS 6x00 Series Fabric InterconnectsCVE-2021-27862 Cisco has confirmed that this vulnerability does not affect the following Cisco products:    + Access Points   + AireOS Access Points   + Meraki Access Points  Details  * The vulnerabilities are not dependent on one another. Exploitation of one of the vulnerabilities is not required to exploit another vulnerability. In addition, a software release that is affected by one of the vulnerabilities may not be affected by the other vulnerabilities. CVE-2021-27853 A vulnerability in the processing of stacked Ethernet tag headers of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.  This vulnerability is due to the platforms forwarding frames when the upper-layer protocol cannot be determined to invoke a Layer 3 FHS feature. An attacker could exploit this vulnerability by sending packets with stacked VLAN Ethernet headers. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.  Cisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability.  CVE ID: CVE-2021-27853Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N  **CVE-2021-27853: Additional Details**  The IEEE Std 802.1Q-2018 standard incorporates a priority-tagged frame whose tag header carries priority information but no VLAN identification information. The VLAN identifier is set to 0 and is typically carried in a single 802.1Q header between the source MAC address and the **Ethertype/size** field.  In networks where VLAN tagging is used, there is typically a single 802.1Q header between the source MAC address and the **Ethertype/size** field. IEEE 802.1AD has double tagging and includes the S-TAG and C-TAG headers between the source MAC address and the **Ethertype/size** field.  The IEEE Std 802.1Q-2018 does not specify that there should be no more than two tags present, but Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols (determined by the **Ethertype**field), whether a packet is classified as IPv4 or IPv6, and whether it is subject to additional Layer 3 feature processing. If these things cannot be determined, the packet is forwarded based on the Layer 2 information, depending on the device configuration.  Depending on the implementation of the next device that receives the frame, the frame may be dropped as invalid or the priority tags may be removed and processed. These actions are dependent on the implementation of the receiving host operating system. CVE-2021-27853: Cisco Network Operating Systems This section provides specific details about how the different affected Cisco network operating systems handle Ethernet frames with a VLAN ID 0 tag.  **Cisco IOS Software - Switches**  By default, all of the affected Cisco IOS Switches process inbound packets with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  **Note**: Cisco IOS Switches that have reached end of life have not been evaluated by the Cisco Product Security Incident Response Team (PSIRT).  **Cisco IOS XE Software - Switches**  By default, Cisco Catalyst 4500E Series switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  The default behavior of a Cisco IOS XE Switch is to drop all traffic that has a frame header that contains a VLAN ID 0 tag. The switch only processes frames with a VLAN ID 0 tag if the access port is configured as follows:  ```   switchport voice vlan dot1p   ```  **Cisco IOS XE Software - Routers**  Cisco IOS XE devices that are configured with service instances handle the VLAN ID 0 tag in accordance with their configurations. For VLAN-based services, the top one or two tags are inspected based on configuration and map to the appropriate service instance on the longest match rules.  Service instance-based configurations that contain **encapsulation dot1q priority-tagged**, **encapsulation dot1q priority-tagged exact**, or **encapsulation default** are affected by this vulnerability.  The order of matching a service instance for VLAN ID 0 is based on **encapsulation dot1q priority-tagged** first and then **encapsulation default**. Cisco IOS XE Software does not match on **encapsulation dot1q any** for VLAN ID 0 tags.  **Cisco IOS XR Software**  Cisco IOS XR Software running on Layer 2 Transport interfaces handles a VLAN ID 0 tag in accordance with the configurations applied to the device. For port-based services, the packets are forwarded with no inspection. For VLAN-based services, either the top tag or the top two tags are inspected based on configuration and map to the appropriate attachment circuit based on the longest match rules. Fore more information, see [IOS XR L2VPN Services and Features](https://www.cisco.com/c/en/us/support/docs/routers/asr-9000-series-aggregation-services-routers/116453-technote-ios-xr-l2vpn-00.html#anc6).  Configurations that contain **encapsulation dot1q priority-tagged**, **encapsulation dot1q priority-tagged exact**, or **encapsulation default** on Layer 2 Transport VLAN-based configurations are affected by this vulnerability.  **Cisco NX-OS Software**  By default, Cisco NX-OS Software processes an inbound packet with the frame header containing a VLAN ID 0 tag. The initial VLAN ID 0 tag is stripped and then processed in accordance with the rest of the packet contents. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols.  **Cisco Small Business Switches**  By default, Cisco Small Business Switches process an inbound packet with the frame header that contains a VLAN ID 0 tag. Cisco products have a limit on how many tags can be inspected to establish the upper-layer protocols. CVE-2021-27854 CVE-2021-27854 examines the way frames are converted between 802.11 and 802.3 with the injection of VLAN tags in the SNAP headers.  Cisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.  CVE ID: CVE-2021-27854Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N CVE-2021-27861 A vulnerability in the Ethernet processing of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device.  This vulnerability is due to insufficient validation of SNAP/LLC Ethernet frames. An attacker could exploit this vulnerability by sending packets with a crafted (or not crafted, depending on the product) SNAP/LLC Ethernet header. A successful exploit could allow the attacker to bypass the FHS feature of an affected device.  Cisco has not released software updates that address this vulnerability. There are workarounds that address this vulnerability for some products.  CVE ID: CVE-2021-27861Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N CVE-2021-27861: Cisco Network Operating Systems This section provides specific details about how the different affected Cisco network operating systems handle SNAP/LLC Ethernet frames.  **Cisco IOS Software - Switches**  The affected Cisco IOS Software products forward SNAP/LLC frames without additional FHS feature inspection.  **Cisco IOS XR Software**  The affected Cisco IOS XR Software products forward SNAP/LLC frames without additional FHS feature inspection.  **Cisco NX-OS Software**  The affected Cisco NX-OS Software products forward SNAP/LLC frames without any additional FHS feature inspection.  **Cisco Small Business Switches**  The affected Cisco Small Business Switches correctly apply FHS features for SNAP/LLC frames with a length field of up to 1,500. However, SNAP/LLC frames with lengths of 1,501 through 1,535 are forwarded without additional FHS feature inspection. CVE-2021-27862 CVE-2021-27862 examines the way frames are converted between 802.3 to 802.11 and the length field.  Cisco evaluated this vulnerability for any impact to the security features on wireless access points when handling these frame conversions. Cisco found that no configured FHS features were bypassed.  CVE ID: CVE-2021-27862Security Impact Rating (SIR): Medium CVSS Base Score: 4.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N  Workarounds  * There are workarounds that address some of these vulnerabilities. CVE-2021-27853 Administrators may drop packets that cannot have their **ethertype** detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.  The following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:  **Cisco IOS Software - Switches**  ```   !mac access-list extended CSCwa14271 permit any any 0x86DD 0x0 permit any any 0x800 0x0 permit any any 0x806 0x0 deny   any any!interface GigabitEthernet1/0/1 switchport access vlan 5 switchport voice vlan dot1p ipv6 nd raguard attach-policy HOSTS mac access-group CSCwa14271 in!   ```  **Cisco IOS XE Software - Switches**  For Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if **interface vlan 5** is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.  For Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.  **Cisco IOS XE Software - Routers**  For configurations that have a service instance with **encapsulation priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword **exact** after the **encapsulation priority-tagged** or filter on the **ethertype** field with **encapsulation priority-tagged etype ipv4 , ipv6**.  For environments that do not have **encapsulation priority-tagged** assigned to a service instance, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with **encapsulation priority-tagged.**  **Cisco IOS XR Software**  For configurations that have an l2transportsub interface configured with **encapsulation dot1q|dot1ad priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword **exact** after the **encapsulation dot1q|dot1ad priority-tagged.**  For environments that do not have ***e*****ncapsulation dot1q|dot1ad priority-tagged** assigned to an l2transport sub interface, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with **encapsulation dot1q priority-tagged** and **encapsulation dot1ad priority-tagged**.  **Cisco NX-OS Software**  ```   !mac access-list drop_three_tags deny any any 0x8100 deny any any 0x88a8 permit any any !interface ethernet 1/4 mac port access-group drop_three_tags!        ```  **Cisco Small Business Switches**  To ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:  ```   mac access-list extended arp-ip-ip6 permit any any 806 0000 ace-priority 1 permit any any 800 0000 ace-priority 2 permit any any 86dd 0000 ace-priority 3   ```   CVE-2021-27861 The principle for mitigating CVE-2021-27861 is to drop any packets that cannot have their Layer 3 protocol detected using a Layer 2 ACL.  The following are examples of Layer 2 ACLs that could be implemented on access ports where FHP has been configured:  **Cisco IOS Software - Switches**  No mitigations or workarounds.  **Cisco IOS XR Software**  No mitigations or workarounds.  **Cisco NX-OS Software**  ```   !interface Ethernet1/3  switchport  switchport access vlan 5  mac port access-group drop_non  ipv6 nd raguard attach-policy HOSTS!interface Ethernet1/4  switchport  switchport access vlan 5  mac port access-group drop_non  ipv6 nd raguard attach-policy CSCvw92154!mac access-list drop_non  10 permit any any 0x86dd  20 permit any any ip  30 permit any any 0x806  35 permit any 0100.0ccc.cccc 0000.0000.0000  40 deny any any!   ```  **Cisco Small Business Switches**  No mitigations or workarounds.  While these workarounds have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed ReleasesCVE-2021-27853 At the time of publication, the release information in the following table was accurate. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.       | Product | Cisco Bug ID | First Fixed Release |   | --- | --- | --- |   | Cisco IOS XE Switches | [CSCvz91291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291) | 17.6.317.8.1 |      CVE-2021-27854 Cisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed. CVE-2021-27861 At the time of publication, Cisco had not released updates that address this vulnerability for any Cisco product. CVE-2021-27862 Cisco evaluated this vulnerability based on its impact on FHS features configured on the access points. No impact was observed.  The Cisco PSIRT validates only the affected and fixed release information that is documented in this advisory.  Exploitation and Public Announcements  * The Cisco PSIRT is aware that proof-of-concept exploit code is available for the vulnerabilities that are described in this advisory.  The Cisco PSIRT is not aware of any malicious use of the vulnerabilities that are described in this advisory.  Source  * Cisco would like to thank Etienne Champetier for reporting these vulnerabilities and Cert/CC for the coordination.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.1 | Corrected affected product information. | Details | Final | 2022-OCT-05 |   | 1.0 | Initial public release. | - | Final | 2022-SEP-27 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from bst.cloudapps.cisco.com_422e213e_20250115_180509.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.


