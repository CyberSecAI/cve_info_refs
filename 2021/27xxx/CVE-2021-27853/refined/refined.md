```
{
  "CVE_data_meta": {
    "ASSIGNER": "psirt@cisco.com",
    "DATE_PUBLIC": "2022-09-27T16:00:00",
    "ID": "CVE-2021-27853",
    "STATE": "PUBLIC"
  },
  "affects": {
    "vendor": {
      "vendor_data": [
        {
          "product": {
            "product_data": [
              {
                "product_name": "Cisco IOS Software - Switches",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "Catalyst 6500 and 6800 Series Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Catalyst Digital Building Series Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Industrial Ethernet Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Micro Switches"
                    }
                  ]
                }
              },
			  {
                "product_name": "Cisco IOS XE Software - Switches",
                "version": {
                  "version_data": [
				    {
                      "version_affected": "=",
                      "version_value": "Catalyst 4500 IOS-XE Switches"
                    },
                    {
                      "version_affected": "<",
                      "version_value": "17.6.3"
                    },
					{
                      "version_affected": "<",
                      "version_value": "17.8.1"
                    }
                  ]
                }
              },
			    {
                "product_name": "Cisco IOS XE Software - Routers",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "IOS XE Routers configured with Ethernet virtual circuits"
                    }
                  ]
                }
              },
			    {
                "product_name": "Cisco IOS XR Software",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "IOS XR Routers configured with L2 Transport services"
                    }
                  ]
                }
              },
			   {
                "product_name": "Cisco Meraki - Switches",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "MS390"
                    },
					{
                      "version_affected": "=",
                      "version_value": "MS210MS225MS250MS350MS355MS410MS420MS425MS450"
                    }
                  ]
                }
              },
			  {
                "product_name": "Cisco NX-OS Software",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "Nexus 3000 Series Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Nexus 5500 Platform SwitchesNexus 5600 Platform SwitchesNexus 6000 Series Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Nexus 7000 Series Switches"
                    },
					{
                      "version_affected": "=",
                      "version_value": "Nexus 9000 Series Switches (Standalone Mode)"
                    }
                  ]
                }
              },
			 {
                "product_name": "Cisco Small Business Switches",
                "version": {
                  "version_data": [
                    {
                      "version_affected": "=",
                      "version_value": "250 Series Smart Switches350 Series Managed Switches350X Series Stackable Managed Switches550X Series Stackable Managed SwitchesBusiness 250 Series Smart SwitchesBusiness 350 Series Managed Switches"
                    }
                  ]
                }
              }
            ]
          },
          "vendor_name": "Cisco"
        }
      ]
    }
  },
  "data_format": "MITRE",
  "data_type": "CVE",
  "data_version": "4.0",
  "description": {
    "description_data": [
      {
        "lang": "eng",
        "value": "A vulnerability in the processing of stacked Ethernet tag headers of multiple Cisco products could allow an unauthenticated, adjacent attacker to bypass the FHS feature of an affected device. This vulnerability is due to the platforms forwarding frames when the upper-layer protocol cannot be determined to invoke a Layer 3 FHS feature. An attacker could exploit this vulnerability by sending packets with stacked VLAN Ethernet headers. A successful exploit could allow the attacker to bypass the FHS feature of an affected device."
      }
    ]
  },
  "impact": {
    "cvss": {
      "baseScore": "4.7",
      "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
      "version": "3.1"
    }
  },
  "problemtype": {
    "problemtype_data": [
      {
        "description": [
          {
            "lang": "eng",
            "value": "CWE-284"
          }
        ]
      }
    ]
  },
  "references": {
    "reference_data": [
      {
        "name": "cisco-sa-VU855201-J3z8CKTX",
        "refsource": "CISCO",
        "url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-VU855201-J3z8CKTX"
      },
      {
        "name": "CSCvz96133",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz96133"
      },
	  {
        "name": "CSCwa18093",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa18093"
      },
	   {
        "name": "CSCvz91291",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz91291"
      },
	  {
        "name": "CSCwb01481",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb01481"
      },
	  {
        "name": "CSCwa14271",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14271"
      },
	  {
        "name": "CSCwa06145",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa06145"
      },
		{
        "name": "CSCwa14942",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa14942"
      },
		{
        "name": "CSCvw99743",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw99743"
      },
	  {
        "name": "CSCvx33758",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx33758"
      },
	  {
        "name": "CSCvx35087",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35087"
      },
	  {
        "name": "CSCvx35085",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx35085"
      },
	  {
        "name": "CSCvz89602",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz89602"
      },
	  {
        "name": "CSCvz88705",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz88705"
      },
	  {
        "name": "CSCvw92154",
        "refsource": "CISCO",
        "url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw92154"
      },
      {
        "name": "L2 network security controls can be bypassed using VLAN 0 stacking and/or 802.3 headers",
        "refsource": "CERT/CC",
        "url": "https://kb.cert.org/vuls/id/855201"
      }
    ]
  },
  "source": {
    "discovery": "INTERNAL"
  },
    "work_around": [
        {
          "lang": "eng",
          "value": "Administrators may drop packets that cannot have their ethertype detected using a Layer 2 access control list (ACL) or where tags are not expected to drop tagged traffic. If a single dot1P header is received, it will still be processed correctly if the network operating system supports it.\r\n\r\nThe following are examples of Layer 2 ACLs that could be implemented on access ports where FHS has been configured:\r\n\r\n**Cisco IOS Software - Switches**\r\n\r\n```\r\n!\rmac access-list extended CSCwa14271\r\n permit any any 0x86DD 0x0\r\n permit any any 0x800 0x0\r\n permit any any 0x806 0x0\r\n deny any any\r\n!\r\ninterface GigabitEthernet1/0/1\r\n switchport access vlan 5\r\n switchport voice vlan dot1p\r\n ipv6 nd raguard attach-policy HOSTS\r\n mac access-group CSCwa14271 in\r\n!\r\n```\r\n\r\n**Cisco IOS XE Software - Switches**\r\n\r\nFor Cisco IOS XE Software on switches, impact to all FHS features occurs on Cisco IOS Software releases 17.6.1 and later, but earlier than the first fixed release. The issue will not be seen if the access port VLAN also has an active switched virtual interface (SVI). If there are access ports in VLAN 5, for example, this issue will be observed only if **interface vlan 5** is not configured. To mitigate this issue for vulnerable releases of Cisco IOS Software, administrators can ensure that each VLAN assigned to access ports has a corresponding SVI configured.\r\n\r\nFor Cisco IOS XE Software on switches, Dynamic ARP Inspection is affected on all releases. Administrators can configure static ARP entries for the default gateways and critical servers and hosts off the segments that are being protected to protect the critical assets in the environment.\r\n\r\n**Cisco IOS XE Software - Routers**\r\n\r\nFor configurations that have a service instance with **encapsulation priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can either add the keyword **exact** after the **encapsulation priority-tagged** or filter on the ethertype field with **encapsulation priority-tagged etype ipv4 , ipv6**.\r\n\r\nFor environments that do not have **encapsulation priority-tagged** assigned to a service instance, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure a service instance that is not assigned to a bridge domain with **encapsulation priority-tagged.**\r\n\r\n**Cisco IOS XR Software**\r\n\r\nFor configurations that have an l2transport sub interface configured with **encapsulation dot1q|dot1ad priority-tagged** and where the environment needs to examine only the first tag (depending on the platform), administrators can add the keyword **exact** after the **encapsulation dot1q|dot1ad priority-tagged.**\r\n\r\nFor environments that do not have ***e*****ncapsulation dot1q|dot1ad priority-tagged** assigned to an l2transport sub interface, to prevent packets that are tagged with **dot1p** at the front of the headers from being forwarded, administrators can configure l2transport sub interfaces that are not assigned to a bridge domain with **encapsulation dot1q priority-tagged** and **encapsulation dot1ad priority-tagged**.\r\n\r\n**Cisco NX-OS Software**\r\n\r\n```\r\n!\rmac access-list drop_three_tags\r\n deny any any 0x8100\r\n deny any any 0x88a8\r\n permit any any\r\n!\r\ninterface ethernet 1/4\r\n mac port access-group drop_three_tags\r\n!\r\n```\r\n\r\n**Cisco Small Business Switches**\r\n\r\nTo ensure that FHS works correctly on access ports, install a MAC ACL to deny only tagged frames (because they are not to be expected on an access port) or to permit only ARP, IPv4, and IPv6 on all access ports. The following is an example from the Cisco Sx250, 350, and 550 Series Smart Switches and the Cisco Business 250 and 350 Series Smart Switches:\r\n\r\n```\r\nmac access-list extended arp-ip-ip6\r\npermit any any 806 0000 ace-priority 1\r\npermit any any 800 0000 ace-priority 2\r\npermit any any 86dd 0000 ace-priority 3\r\n```"
        }
      ]
  },
"cvss": {
    "attackComplexity": "LOW",
    "attackVector": "ADJACENT_NETWORK",
    "availabilityImpact": "NONE",
    "baseScore": 4.7,
    "baseSeverity": "MEDIUM",
    "confidentialityImpact": "NONE",
    "integrityImpact": "LOW",
    "privilegesRequired": "NONE",
    "scope": "CHANGED",
    "userInteraction": "NONE",
    "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
    "version": "3.1"
  }
}
```