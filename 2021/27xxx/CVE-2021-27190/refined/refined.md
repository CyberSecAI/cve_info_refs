Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-27190

**Root Cause of Vulnerability:**
The vulnerability is due to the lack of proper input sanitization when handling the "Address" field in the "Change my credentials" form (`change_params.php`). User-supplied input in this field is echoed back within Javascript code in the HTML response without adequate escaping, leading to stored XSS.

**Weaknesses/Vulnerabilities Present:**
- Stored Cross-Site Scripting (XSS): Malicious JavaScript code can be injected into the "Address" field. This code is then stored and executed when the page is viewed by other users.
- Lack of input sanitization: The application does not properly sanitize or encode user-supplied input in the "Address" field before reflecting it back in the HTML.

**Impact of Exploitation:**
- An attacker can inject malicious JavaScript code that is stored in the application's database.
- When the affected page is viewed (e.g., when a user goes to their "Change my credentials" page), the stored malicious script is executed within the victim's browser.
- The attacker could potentially:
  - Steal cookies, allowing session hijacking.
  - Redirect users to malicious websites.
  - Perform other malicious actions within the context of the user's session.

**Attack Vectors:**
- The attack vector is through the "Address" field in the "Change my credentials" form.
- An attacker needs to be a logged in user of the application to access the vulnerable form.

**Required Attacker Capabilities/Position:**
- The attacker needs to have an account on the vulnerable application.
- The attacker needs to be logged in to the application to access the "Change my credentials" page.
- The attacker injects the malicious payload into the 'Address' field, and the payload gets stored in the application's database.
- The malicious script will execute when a user views the page containing the injected address.

**Additional Details:**

- **Affected Software:** Peel Shopping 9.3.0 and 9.4.0
- **Vulnerable Script:** `http://localhost/peelshopping_9_3_0/utilisateurs/change_params.php`
- **Vulnerable Parameter:** `Address`
- **Payload Example:**
  ```javascript
  jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e
  ```
- **Mitigation:**
  - The vulnerability can be mitigated by properly sanitizing user inputs, including encoding HTML entities using the `str_form_value` filter in the Smarty/Twig template file (`user_change_params_form.tpl`).
  - OWASP recommendations on XSS prevention should be followed, which include escaping all user input and output, using HTTP-only cookies, white-listing input validation, and employing security libraries such as OWASP Auto-Sanitization.