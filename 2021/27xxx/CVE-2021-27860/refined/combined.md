=== Content from www.ic3.gov_7f71a82d_20250114_195711.html ===
TLP:WHITE

16 NOV 2021

FLASH Number

The following information is being provided by the FBI, with no guarantees or warranties, for potential
use at the sole discretion of recipients to protect against cyber threats. This data is provided in order
to help cyber security professionals and system administrators to guard against the persistent malicious
actions of cyber actors. This FLASH was coordinated with DHS/CISA.

AC-000155-MW

This FLASH has been released TLP:WHITE

WE NEED YOUR HELP! If you identify any suspicious activity within your enterprise or have related information,
please contact your local FBI Cyber Squad immediately with respect to the procedures outlined in the
Reporting Notice section of this message.

*Note: By reporting any related information to FBI Cyber Squads, you are assisting in sharing information that allows the FBI to track
malicious actors and coordinate with private industry and the United States Government to prevent future intrusions and attacks.

An APT Group Exploiting a 0-day in FatPipe WARP,
MPVPN, and IPVPN Software

Summary

As of November 2021, FBI forensic analysis indicated exploitation of a 0-day vulnerability in the
FatPipe MPVPN® device software1 going back to at least May 2021. The vulnerability allowed
APT actors to gain access to an unrestricted file upload function to drop a webshell for
exploitation activity with root access, leading to elevated privileges and potential follow-on
activity. Exploitation of this vulnerability then served as a jumping off point into other
infrastructure for the APT actors. This vulnerability is not yet identified with a CVE number but
can be located with the FatPipe Security Advisory number FPSA006. The vulnerability affects all
FatPipe WARP®, MPVPN, and IPVPN® device software prior to the latest version releases
10.1.2r60p93 and 10.2.2r44p1.

1 A patented router clustering device.

TLP:WHITE

TLP:WHITE

The compromise of affected systems running FatPipe MPVPN software involves exploiting a
servlet at the URL path /fpui/uploadConfigServlet and dropping a webshell
/fpui/img/1.jsp with root privileges.

Technical Details

The following was executed for initial exploitation:
  GET request to /RELEASE-NOTES.txt
  POST request to /fpui/uploadConfigServlet?fileNumber=undefined

Immediately after the POST request, the following activity was observed:

  Download <attacker_ip>/sshd_config
  Download <attacker_ip>/authorized_keys
  Backup the system's current SSHd configuration file, sshd_config, and the "root"

user’s SSH authorized keys file, /root/.ssh/authorized_keys

  Overwrite the legitimate sshd_config and root user’s authorized_keys files with the

actor’s malicious versions
  Restart the SSHd service

During a varying length of time while the webshell was available, the actor(s) used the new SSH
access to route malicious traffic through the device and target additional U.S. infrastructure.

In most cases, after the exploitation activity was complete, the following activity was observed
as part of a "clean-up" process to hide the malicious actor’s activity and to protect their exploit
until a later date:

  Restore original sshd_config and authorized_keys files  and delete the

malicious copies

  Overwrite the btmp, wtmp, and lastlog entries to hide their session activity
  Restart the SSHd service
  Delete the webshell at <tomcat-installation-

path>/webapps/fpui/img/1.jsp

Indicators

  <tomcat-installation-path>/webapps/fpui/img/1.jsp
  /etc/ssh/sshd_config.bak
  /root/.ssh/authorized_keys.bak

TLP:WHITE

TLP:WHITE

  Search Tomcat access logs, located at

/var/log/tomcat/localhost_access_log*, for:

o  POST requests to the URL:

/fpui/uploadConfigServlet?fileNumber=undefined

o  GET requests to the URL, with commands: /fpui/img/1.jsp

  Search SSH access/secure logs under /var/log for successful SSH connections via
public key from unknown IP addresses: Accepted publickey for root

  Search wtmp and lastlog files for sessions from unknown IP addresses
  Search Tomcat error logs, located at /var/log/tomcat/catalina*, for the

following caught exception:

ERROR com.fatpipe.centralmanager.servlet.UploadConfigServlet-
Exception occurred while uploading config. Exception is : null

NOTE: Detection of exploitation activity may be difficult, as cleanup scripts designed to remove
traces of the actor(s) activity were discovered in most cases.

Yara Signatures

rule APT_Webshell_1_jsp {

    strings:

        $s1 = "Runtime.getRuntime().exec(request.getParameter("

        $s2 = "request.getParameter(\"pwd\")"

        $s3 = "while((a=in.read(b))!=-1){"

    condition:

        filesize < 25KB and 2 of them

}

Information Requested:

Please report to FBI the existence of any of the following:

Identification of indicators of compromise as outlined above.


  Presence of webshell code on compromised FatPipe WARP, MPVPN, and IPVPN

appliances.

  Unauthorized access to or use of accounts.

TLP:WHITE

TLP:WHITE

  Evidence of lateral movement by malicious actors with access to compromised systems.
  Malicious IPs identified through the conducted log file searches and session activity.
  Suspicious or malicious .bash_history contents.
  Other indicators of unauthorized access or compromise.

Recipients of this information are encouraged to contribute any additional information that
they may have related to this threat.

Recommended Mitigations:

Organizations that identify any activity related to these indicators of compromise within their
networks should take action immediately.

FatPipe released a patch and security advisory, FPSA006, on November 16, 2021, that fixes the
vulnerability. All FatPipe WARP, MPVPN, and IPVPN device software prior to releases
10.1.2r60p93 and 10.2.2r44p1 are vulnerable. The security advisory and additional details are
available at the following URL: https://fatpipeinc.com/support/cve-list.php.

FBI strongly urges system administrators to upgrade their devices immediately and to follow
other FatPipe security recommendations such as disabling UI and SSH access from the WAN
interface (externally facing) when not actively using it.

TLP:WHITE

Reporting Notice

The FBI encourages recipients of this document to report information concerning suspicious or

criminal activity to their local FBI field office. With regards to specific information that appears

in this communication: the context and individual indicators, particularly those of a non-

deterministic or ephemeral nature (such as filenames or IP addresses), may not be indicative of

a compromise. Indicators should always be evaluated in light of your complete information

security situation.

Field office contacts can be identified at www.fbi.gov/contact-us/field-offices. When available,

each report submitted should include the date, time, location, type of activity, number of

people, type of equipment used for the activity, the name of the submitting company or

organization, and a designated point of contact.

Administrative Note

This product is marked TLP:WHITE. Subject to standard copyright rules, the information in this product
may be shared without restriction.

Your Feedback Regarding this Product is Critical

Was this product of value to your organization? Was the content clear and concise?
Your comments are very important to us and can be submitted anonymously. Please take a
moment to complete the survey at the link below. Feedback should be specific to your
experience with our written products to enable the FBI to make quick and continuous
improvements to such products. Feedback may be submitted online here:
https://www.ic3.gov/PIFSurvey

Please note that this survey is for feedback on content and value only. Reporting of technical
information regarding FLASH reports must be submitted through your local FBI Field Office.



=== Content from www.fatpipeinc.com_0c037d29_20250114_195707.html ===


![Banner Image](../assets/img/contactus-001.png)
# Support

**CVE List**

**FPSA001:** Remote Privilege Escalation

Summary

A vulnerability in the web management interface of FatPipe software could allow an authenticated, remote attacker with read-only privileges to elevate privileges to the level of an Administrator user on an affected device.

Affected Products

WARP, MPVPN, IPVPN

10.1.2 and 10.2.2 versions prior to releases with the fix (see Fixed Software).

Details

A vulnerability in the web management interface of FatPipe software could allow an authenticated, remote attacker with read-only privileges to elevate privileges to the level of an Administrator user on an affected device.

The vulnerability is due to a lack of input and validation checking mechanisms for certain HTTP requests on an affected device. An attacker could exploit this vulnerability by sending a modified HTTP request to the affected device. An exploit could allow the attacker as a read-only user to execute functions as if they were an administrative user.

FatPipe has released software updates that address this vulnerability.

Workarounds

There are no workarounds that address this vulnerability. To mitigate the vulnerability, disable UI access on all the WAN interfaces or configure Access Lists on the interface page to allow access only from trusted sources.

Fixed Software

10.1.2r60p91 or later

10.2.2r42 or later

Source

<https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5685.php>

---

**FPSA002:** Hidden Backdoor Account (Write Access)

Summary

For centralized management, FatPipe uses a user account that allows the current logged in user to access multiple devices from the web management interface of FatPipe software. This was not intended to be used to directly log into the web management interface. Someone can use it to log into the web interface.

Affected Products

WARP, MPVPN, IPVPN

10.1.2 and 10.2.2 versions prior to releases with the fix (see Fixed Software).

Details

For centralized management, FatPipe uses a user account that allows the current logged in user to access multiple appliances from the web management interface of FatPipe software. This was not intended to be used to directly log into the web management interface. Someone can use it to log into the web management interface.

While this user account is not displayed in the Users list, the customer has control over the password for this user account. On the Users page, you can set the password in for this user.

FatPipe has released software updates that address this vulnerability. Newer versions of our software do not allow a user to login directly using this user account (see Fixed Software).

Workarounds

Disable "Central Manager Login".

Fixed Software

10.1.2r60p91 or later

10.2.2r42 or later

Source

<https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5684.php>

---

**FPSA003:** Unauthenticated Config Download

Summary

A user is able to create and download a backup file containing the FatPipe device's configuration using the web management interface of FatPipe software. A vulnerability exists where an unauthenticated user can access the backup file on the system.

Affected Products

WARP, MPVPN, IPVPN

10.1.2 and 10.2.2 versions prior to releases with the fix (see Fixed Software).

Details

A user is able to create and download a backup file containing the FatPipe device's configuration using the web management interface of FatPipe software. A vulnerability exists where an unauthenticated user can access the backup file on the system.

FatPipe has released software updates that address this vulnerability.

Workarounds

There are no workarounds that address this vulnerability. To mitigate the vulnerability, disable UI access on all the WAN interfaces or configure Access Lists on the interface page to allow access only from trusted sources.

Fixed Software

10.1.2r60p91 or later

10.2.2r42 or later

Source

<https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5683.php>

---

**FPSA004:** Authorization Bypass

Summary

Improper access control occurs when the application provides direct access to objects based on user-supplied input. As a result of this vulnerability attackers can bypass authorization and access resources behind protected pages.

Affected Products

WARP

10.1.2 and 10.2.2 versions prior to releases with the fix (see Fixed Software).

Details

Improper access control occurs when the application provides direct access to objects based on user-supplied input. As a result of this vulnerability attackers can bypass authorization and access resources behind protected pages.

Workarounds

There are no workarounds that address this vulnerability. To mitigate the vulnerability, disable UI access on all the WAN interfaces or configure Access Lists on the interface page to allow access only from trusted sources.

Fixed Software

10.1.2r60p91 or later

10.2.2r42 or later

Source

<https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5682.php>

---

**FPSA005:** CSRF Add Admin Exploit

Summary

A vulnerability in the web management interface of FatPipe software could allow an authenticated, remote attacker with read-only privileges to elevate privileges to the level of an Administrator user on an affected device by adding a user with Administrator privileges.

Affected Products

WARP, MPVPN, IPVPN

10.1.2 and 10.2.2 versions prior to releases with the fix (see Fixed Software).

Details

A vulnerability in the web management interface of FatPipe software could allow an authenticated, remote attacker with read-only privileges to elevate privileges to the level of an Administrator user on an affected device by adding a user with Administrator privileges.

The vulnerability is due to a lack of input and validation checking mechanisms for certain HTTP requests on an affected device. An attacker could exploit this vulnerability by sending a modified HTTP request to the affected device. An exploit could allow the attacker as a read-only user to execute functions as if they were an administrative user.

FatPipe has released software updates that address this vulnerability.

Workarounds

There are no workarounds that address this vulnerability. To mitigate the vulnerability, disable UI access on all the WAN interfaces or configure Access Lists on the interface page to allow access only from trusted sources.

Fixed Software

10.1.2r60p91 or later

10.2.2r42 or later

Source

<https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5681.php>

---

**FPSA006:** Config Upload Exploit

Summary

A vulnerability in the web management interface of FatPipe software could allow a remote attacker to upload a file to any location on the filesystem on an affected device.

Affected Products

WARP, MPVPN, IPVPN

Version 10 prior to the fixed releases (see Fixed Software). Version 9 is not affected by this vulnerability.

Details

A vulnerability in the web management interface of FatPipe software could allow a remote attacker to upload a file to any location on the filesystem on an affected device.

The vulnerability is due to a lack of input and validation checking mechanisms for certain HTTP requests on an affected device. An attacker could exploit this vulnerability by sending a modified HTTP request to the affected device.

FatPipe has released software updates that address this vulnerability.

Workarounds

There are no workarounds that address this vulnerability. To mitigate the vulnerability, disable UI access on all the WAN interfaces or configure Access Lists on the interface page to allow access only from trusted sources..

Fixed Software

10.1.2r60p92 or later

10.2.2r44p1 or later

Source

Found by code review after being made aware of active exploit activity.


