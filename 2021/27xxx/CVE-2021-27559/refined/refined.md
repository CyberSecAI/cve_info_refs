The provided content relates to CVE-2021-27559.

**Root cause of vulnerability:**
The root cause is improper handling of user-supplied input in the Monica application. Specifically, the application was using `{!! $log['description'] !!}` to render audit log descriptions, which bypasses Laravel's built-in XSS protection. This allowed HTML tags and JavaScript code to be executed when viewing contact details or accessing the /Storage endpoint in Settings.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability exists in the Contact Page and /Storage endpoint.
- The application was not sanitizing user-supplied input when rendering the contact names and description, allowing for execution of arbitrary JavaScript.
- The usage of  `{!! $log['description'] !!}` bypassed default XSS protection by rendering the HTML content directly.

**Impact of exploitation:**
- Execution of arbitrary JavaScript code in the user's browser, leading to potentially malicious actions such as:
  - Stealing cookies (as demonstrated by `alert(document.cookie)` in the provided payload)
  - Data theft
  - Session hijacking
  - Redirection to malicious websites
  - Other attacks that can be performed through client-side scripting.

**Attack vectors:**
- Malicious user input through the First name, Middle name, Last name, Nickname & Description fields of the Contact object.
- This data was not properly sanitized and stored in database.
- When viewed in contact page or settings/audit log pages, the XSS was triggered.

**Required attacker capabilities/position:**
- The attacker needs to be a user with the ability to create/modify contacts in the application.
- No special privileges are required besides creating a contact entry.
- The attacker is able to inject malicious input via the contact fields that will be stored in the database.
- Any user viewing the contact or the audit logs will trigger the XSS.