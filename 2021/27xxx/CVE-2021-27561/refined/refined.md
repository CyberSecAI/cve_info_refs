- **Root cause of vulnerability**: Improper input sanitization in the `fw_restful_service_get()` function of the `mod_firewall.so` module within the `smserver` daemon, leading to command injection. This is combined with a Server-Side Request Forgery (SSRF) vulnerability in the NodeJS application, which allows an attacker to send requests to the vulnerable `smserver` daemon.
- **Weaknesses/vulnerabilities present**:
    - **SSRF:** The `/premise/front/getPingData` API in the NodeJS application allows an attacker to specify an arbitrary URL, causing the server to make a request to that URL.
    - **Command Injection:** The `fw_restful_service_get()` function in the `smserver` daemon does not properly sanitize the `zone` GET parameter, allowing an attacker to inject arbitrary commands into a `firewall-cmd` command executed via `popen`.
- **Impact of exploitation**: An unauthenticated attacker can execute arbitrary commands with root privileges on the Yealink DM server.
- **Attack vectors**:
    - The attacker sends a crafted request to the vulnerable NodeJS application using the `/premise/front/getPingData` API.
    - This request utilizes the SSRF vulnerability to target the `smserver` daemon running on localhost:9600.
    - The request includes a malicious payload in the `zone` parameter of the `sm/api/v1/firewall/zone/services` API endpoint, leading to command injection in the `smserver` daemon.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the Yealink DM server. No prior authentication is required.

This content provides more detail than the official CVE description, detailing the vulnerable code, the attack chain, and a working exploit.