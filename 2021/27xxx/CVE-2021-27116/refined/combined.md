=== Content from github.com_6b3788c3_20250115_091818.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbeego%2Fbeego%2Fissues%2F4484)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbeego%2Fbeego%2Fissues%2F4484)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=beego%2Fbeego)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[beego](/beego)
/
**[beego](/beego/beego)**
Public

* [Notifications](/login?return_to=%2Fbeego%2Fbeego) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fbeego%2Fbeego)
* [Star
   31.8k](/login?return_to=%2Fbeego%2Fbeego)

* [Code](/beego/beego)
* [Issues
  9](/beego/beego/issues)
* [Pull requests
  2](/beego/beego/pulls)
* [Actions](/beego/beego/actions)
* [Projects
  0](/beego/beego/projects)
* [Wiki](/beego/beego/wiki)
* [Security](/beego/beego/security)
* [Insights](/beego/beego/pulse)

Additional navigation options

* [Code](/beego/beego)
* [Issues](/beego/beego/issues)
* [Pull requests](/beego/beego/pulls)
* [Actions](/beego/beego/actions)
* [Projects](/beego/beego/projects)
* [Wiki](/beego/beego/wiki)
* [Security](/beego/beego/security)
* [Insights](/beego/beego/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbeego%2Fbeego%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbeego%2Fbeego%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# get cpuprof and get memprof commands exist symlink-attacks vulnerability. #4484

Closed

[toptotu](/toptotu) opened this issue
Feb 7, 2021
· 6 comments

Closed

# [get cpuprof and get memprof commands exist symlink-attacks vulnerability.](#top) #4484

[toptotu](/toptotu) opened this issue
Feb 7, 2021
· 6 comments

Assignees
[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&v=4)](/flycash)

## Comments

[![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=80&v=4)](/toptotu)

Copy link

### **[toptotu](/toptotu)** commented [Feb 7, 2021](#issue-802908166)

| Dear beego Team,  I would like to report a security vulnerability in Beego's admin module.  The vulnerability code is in the profile.go file，MemProf and GetCPUProfile function does not correctly check whether the created file exists. As a result, Attackers can launch attacks symlink attacks locally.  poc code： <https://play.golang.org/p/TAvghgm_7fY>  func main() { file, err := os.Create("cpu-pid.pprof") if err != nil { fmt.Printf("Error creating file: %s", err) } \_, err = file.Write([]byte("My logs for this process")) if err != nil { fmt.Println(err) } }  $ ln -s other/logs cpu-pid.pprof $ go build symlink\_attack.go $ ./symlink\_attack $ cat other/logs   * My logs for this process   $ |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=40&v=4)](/toptotu)
[toptotu](/toptotu)
changed the title
~~The /proc interface parameter of the admin service is get cpuprof and get memprof commands, which have a symlink-attacks vulnerability.~~
get cpuprof and get memprof commands, which have a symlink-attacks vulnerability.
[Feb 7, 2021](#event-4300080021)

[![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=40&v=4)](/toptotu)
[toptotu](/toptotu)
changed the title
~~get cpuprof and get memprof commands, which have a symlink-attacks vulnerability.~~
get cpuprof and get memprof commands exist symlink-attacks vulnerability.
[Feb 7, 2021](#event-4300080295)

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)
[flycash](/flycash)
self-assigned this
[Feb 7, 2021](#event-4300351074)

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)
[flycash](/flycash)
added
[kind/bug](/beego/beego/labels/kind/bug)
Definite and accepted bugs
[priority/P0](/beego/beego/labels/priority/P0)
labels
[Feb 7, 2021](#event-4300351300)

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=80&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)

Copy link

Collaborator

### **[flycash](/flycash)** commented [Feb 10, 2021](#issuecomment-776768915)

| From my understanding, if attackers could run  `ln -s other/logs cpu-pid.pprof`, they could do something more dangerous. |
| --- |

All reactions

Sorry, something went wrong.

[![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=80&v=4)](/toptotu)

Copy link

Author

### **[toptotu](/toptotu)** commented [Feb 19, 2021](#issuecomment-781747561)

| From my understanding, if attackers could run  `ln -s other/logs cpu-pid.pprof`, they could do something more dangerous.  Exactly. Attackers can use this vulnerability to escalate privileges. |
| --- |

All reactions

Sorry, something went wrong.

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=80&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)

Copy link

Collaborator

### **[flycash](/flycash)** commented [Feb 19, 2021](#issuecomment-782000811)

| Exactly. Attackers can use this vulnerability to escalate privileges.  I am still confused.  Attackers ran `ln -s other/logs cpu-pid.pprof` and we output the profile data into this file, how did they escalate privileges.  I mean why they don't do something more dangerous directly insteead of running `ln -s other/logs cpu-pid.pprof`? |
| --- |

All reactions

Sorry, something went wrong.

[![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=80&v=4)](/toptotu)

Copy link

Author

### **[toptotu](/toptotu)** commented [Feb 20, 2021](#issuecomment-782604080)

| Exactly. Attackers can use this vulnerability to escalate privileges.  I am still confused.  Attackers ran `ln -s other/logs cpu-pid.pprof` and we output the profile data into this file, how did they escalate privileges.  I mean why they don't do something more dangerous directly insteead of running `ln -s other/logs cpu-pid.pprof`?  What I mean is that in special scenarios, there are unauthorized attacks. The beego application runs under the root permission, and the written pprof file can be created by a low-privilege user using the symlink method, which may cause unauthorized rewriting. |
| --- |

All reactions

Sorry, something went wrong.

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=80&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)

Copy link

Collaborator

### **[flycash](/flycash)** commented [Feb 21, 2021](#issuecomment-782790292)

| Got it. |
| --- |

All reactions

Sorry, something went wrong.

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=80&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)

Copy link

Collaborator

### **[flycash](/flycash)** commented [Apr 6, 2021](#issuecomment-813965894)

| There are many similar cases in Beego. For example, the log files. So I think we don't need to do more things about it because if we want to enhance this, we should enhance all similar cases. More importantly, I think users should be responsible for ensuring that their server are safe :( I don't have any good idea to resolve this problem. |
| --- |

All reactions

Sorry, something went wrong.

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)
[flycash](/flycash)
closed this as [completed](/beego/beego/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 6, 2021](#event-4555581466)

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&u=5b281bc9f91a5486fb61ddd46d23c09c576d54d7&v=4)](/flycash)
[flycash](/flycash)
removed
[priority/P0](/beego/beego/labels/priority/P0)
[kind/bug](/beego/beego/labels/kind/bug)
Definite and accepted bugs
labels
[Jun 17, 2022](#event-6825953361)

[![@julieqiu](https://avatars.githubusercontent.com/u/5943521?s=40&v=4)](/julieqiu)
[julieqiu](/julieqiu)
mentioned this issue
[Aug 22, 2022](#ref-issue-1324789813)

[x/vulndb: potential Go vuln in github.com/beego/beego: GHSA-2v6v-q994-xvxx
golang/vulndb#575](/golang/vulndb/issues/575)

Closed

[![@My-pleasure](https://avatars.githubusercontent.com/u/38413116?s=40&v=4)](/My-pleasure)
[My-pleasure](/My-pleasure)
mentioned this issue
[Jul 3, 2024](#ref-issue-2387499318)

[The component of KubeEdge is currently using has a security vulnerability
kubeedge/kubeedge#5701](/kubeedge/kubeedge/issues/5701)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbeego%2Fbeego%2Fissues%2F4484)

Assignees

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=40&v=4)](/flycash) [flycash](/flycash)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@flycash](https://avatars.githubusercontent.com/u/9923838?s=52&v=4)](/flycash) [![@toptotu](https://avatars.githubusercontent.com/u/12855513?s=52&v=4)](/toptotu)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


