- **Root cause of vulnerability**: Improper sanitization of user-supplied input on the firmware update page. Specifically, a malicious payload is embedded in a filename with the .img extension.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability is present due to the lack of sanitization or encoding of the user-supplied filename when processing firmware updates.
- **Impact of exploitation**: Successful exploitation leads to execution of arbitrary JavaScript code in the victim's browser within the context of the affected web application.
- **Attack vectors**: An attacker crafts a malicious filename containing an XSS payload (e.g., "><img src=x onerror=alert(1)>") saves it as a file with the .img extension and uploads it through the firmware update functionality.
- **Required attacker capabilities/position**: The attacker needs to have access to the device's firmware update page and the ability to upload a custom file.