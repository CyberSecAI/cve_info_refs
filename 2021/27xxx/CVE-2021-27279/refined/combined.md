=== Content from github.com_adcf77b6_20250115_100628.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmybb%2Fmybb%2Fcommit%2Fcb781b49116bf5c4d8deca3e17498122b701677a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmybb%2Fmybb%2Fcommit%2Fcb781b49116bf5c4d8deca3e17498122b701677a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mybb%2Fmybb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mybb](/mybb)
/
**[mybb](/mybb/mybb)**
Public

* [Notifications](/login?return_to=%2Fmybb%2Fmybb) You must be signed in to change notification settings
* [Fork
  409](/login?return_to=%2Fmybb%2Fmybb)
* [Star
   1.1k](/login?return_to=%2Fmybb%2Fmybb)

* [Code](/mybb/mybb)
* [Issues
  280](/mybb/mybb/issues)
* [Pull requests
  44](/mybb/mybb/pulls)
* [Actions](/mybb/mybb/actions)
* [Projects
  2](/mybb/mybb/projects)
* [Wiki](/mybb/mybb/wiki)
* [Security](/mybb/mybb/security)
* [Insights](/mybb/mybb/pulse)

Additional navigation options

* [Code](/mybb/mybb)
* [Issues](/mybb/mybb/issues)
* [Pull requests](/mybb/mybb/pulls)
* [Actions](/mybb/mybb/actions)
* [Projects](/mybb/mybb/projects)
* [Wiki](/mybb/mybb/wiki)
* [Security](/mybb/mybb/security)
* [Insights](/mybb/mybb/pulse)

## Commit

[Permalink](/mybb/mybb/commit/cb781b49116bf5c4d8deca3e17498122b701677a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix Nested Email MyCode Persistent XSS

[Browse files](/mybb/mybb/tree/cb781b49116bf5c4d8deca3e17498122b701677a)
Browse the repository at this point in the history

* Loading branch information

[![@dvz](https://avatars.githubusercontent.com/u/8020837?s=40&v=4)](/dvz)

[dvz](/mybb/mybb/commits?author=dvz "View all commits by dvz")
committed
Feb 22, 2021

1 parent
[5fe63c8](/mybb/mybb/commit/5fe63c81a0a6373d8f7bfd5c78311ee9977cf72d)

commit cb781b4

Showing
**1 changed file**
with
**2 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

10 changes: 2 additions & 8 deletions

10
[inc/class\_parser.php](#diff-7ad919b51e7204f9b1853df2ea4d68315653dec7299bd5d3e049d8f9d24d3072 "inc/class_parser.php")

Show comments

[View file](/mybb/mybb/blob/cb781b49116bf5c4d8deca3e17498122b701677a/inc/class_parser.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1347,14 +1347,8 @@ function mycode\_parse\_email($email, $name="") |
|  |  | { |
|  |  | $name = $email; |
|  |  | } |
|  |  | if(preg\_match("/^([a-zA-Z0-9-\_\+\.]+?)@[a-zA-Z0-9-]+\.[a-zA-Z0-9\.-]+$/si", $email)) |
|  |  | { |
|  |  | $email = $email; |
|  |  | } |
|  |  | elseif(preg\_match("/^([a-zA-Z0-9-\_\+\.]+?)@[a-zA-Z0-9-]+\.[a-zA-Z0-9\.-]+\?(.\*?)$/si", $email)) |
|  |  | { |
|  |  | $email = htmlspecialchars\_uni($email); |
|  |  | } |
|  |  |  |
|  |  | $email = $this->encode\_url($email); |
|  |  |  |
|  |  | eval("\$mycode\_email = \"".$templates->get("mycode\_email", 1, 0)."\";"); |
|  |  | return $mycode\_email; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cb781b4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmybb%2Fmybb%2Fcommit%2Fcb781b49116bf5c4d8deca3e17498122b701677a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mybb.com_a44185d5_20250115_100629.html ===

# [Page-1 MyBB](https://mybb.com/)

* [Home](https://mybb.com/)
* [Download](https://mybb.com/download/)
* [Community](https://community.mybb.com/)
* [Extend](https://community.mybb.com/mods.php)
* [Docs](https://docs.mybb.com/)
* [Blog](https://blog.mybb.com/)

Search
Cancel

MyBB 1.8.25

22 February 2021

Security

code 1825

Full Package

Install a new MyBB forum or upgrade from older versions.

.zip
– 2.14 MB

[Download from **MyBB.com**](https://resources.mybb.com/downloads/mybb_1825.zip)
[Download from **GitHub.com**
(mirror)](https://github.com/mybb/mybb/releases/download/mybb_1825/mybb_1825.zip)

sha512:

872ba823431e211cc4edb9a35d4073b536e5af76f52c87457d106e5fa2e587e827157ac146689ae7bd322c011c95c814122f92be74a71dd88bf544b8b5c8d9b5

More checksums…

sha256:

b8f92bbeb052c94f2e493769106fa00f3b83eb0605b572b8005bedaa186a13fd

sha1:

049d01722b62a75726136a331b40726607d2cd30

md5:

5e6e045e380f93349147df6da3c5cb8e

Changed Files

Upgrade from the previous version.

.zip
– 0.02 MB

[Download from **MyBB.com**](https://resources.mybb.com/downloads/changed_files_1825.zip)
[Download from **GitHub.com**
(mirror)](https://github.com/mybb/mybb/releases/download/mybb_1825/changed_files_1825.zip)

sha512:

201649ebbfefc115e900ba64eed02d80ec2d138db8debfd8f1018a3df4da2907e9fc3a7bd912d583f4d0220717012ff5e32fea12ea3bcf6fa4ed017ce232b674

More checksums…

sha256:

0046e4829ef35bb85e4171c78941f5c075e0988429e64b47aa399af0259934db

sha1:

48a14e1b4904a86a68c6294105eb663687a8ee82

md5:

df5832234edff77f1ff7671e1f6f73c5

[How to verify packages](/download/verifying/)

## Upgrading to this Version

To upgrade from the previous version: **copy and overwrite files** from the Changed Files package.

Upgrading from older versions may require running the `install/` upgrade script.

Before performing any upgrade, remember to **backup** your forum’s files and database and store them safely.

If you have edited core files, including language files, please make sure you make a changelog for these changes so you can make them again (if necessary) once the upgrade is complete.

Follow the [Upgrade Documentation](https://docs.mybb.com/1.8/install/upgrade/) for more detailed instructions.

# Security Vulnerabilities Addressed (1)

High risk
## Nested Email MyCode Persistent XSS [[1]](https://github.com/mybb/mybb/security/advisories/GHSA-6483-hcpp-p75w "Advisory: Nested Email MyCode Persistent XSS")

[CWE-79](https://cwe.mitre.org/data/definitions/79.html "Cross-site Scripting")

`CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H`

CVE-2021-27279

Reported by Igor Sak-Sakovskiy

[{"inc":["class\_core.php","class\_parser.php"]}]
# Changed Files ()

* [MyBB Project](https://mybb.com/about/)
* [Get Involved](https://mybb.com/get-involved/)
* [Support](https://mybb.com/support/)
* [Contact](https://mybb.com/contact/)

* [mybb](https://github.com/mybb)
* [mybboard](https://facebook.com/mybboard)
* [@mybb](https://twitter.com/mybb)
* [@mybbsecurity](https://twitter.com/mybbsecurity)
* [@mybb@…](https://fosstodon.org/%40mybb)

Copyright © 2002-2025 MyBB Group



=== Content from github.com_00e93bd2_20250115_100628.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmybb%2Fmybb%2Fsecurity%2Fadvisories%2FGHSA-6483-hcpp-p75w)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmybb%2Fmybb%2Fsecurity%2Fadvisories%2FGHSA-6483-hcpp-p75w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mybb%2Fmybb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mybb](/mybb)
/
**[mybb](/mybb/mybb)**
Public

* [Notifications](/login?return_to=%2Fmybb%2Fmybb) You must be signed in to change notification settings
* [Fork
  409](/login?return_to=%2Fmybb%2Fmybb)
* [Star
   1.1k](/login?return_to=%2Fmybb%2Fmybb)

* [Code](/mybb/mybb)
* [Issues
  280](/mybb/mybb/issues)
* [Pull requests
  44](/mybb/mybb/pulls)
* [Actions](/mybb/mybb/actions)
* [Projects
  2](/mybb/mybb/projects)
* [Wiki](/mybb/mybb/wiki)
* [Security](/mybb/mybb/security)
* [Insights](/mybb/mybb/pulse)

Additional navigation options

* [Code](/mybb/mybb)
* [Issues](/mybb/mybb/issues)
* [Pull requests](/mybb/mybb/pulls)
* [Actions](/mybb/mybb/actions)
* [Projects](/mybb/mybb/projects)
* [Wiki](/mybb/mybb/wiki)
* [Security](/mybb/mybb/security)
* [Insights](/mybb/mybb/pulse)

# Nested Email MyCode Persistent XSS

High

[dvz](/dvz)
published
GHSA-6483-hcpp-p75w
Feb 22, 2021

## Package

MyBB

## Affected versions

< 1.8.25

## Patched versions

1.8.25

## Description

### Impact

The parsing of messages containing unexpectedly nested `[email]` MyCode (BBCode) tags may result in malformed HTML output, leading to an XSS vulnerability.

The vulnerability can be exploited with minimal user interaction by pointing a victim to page where a maliciously crafted MyCode message is rendered. This may occur when:

* a new message form with instant preview is pre-filled through a POST or GET parameter, or
* a message previously saved on the server (e.g. as a post or Private Message) is displayed.

The impact may be reduced when:

* the `[email]` MyCode is disabled (*Admin CP → Configuration → Settings → Clickable Smilies and BB Code*: [*Allow Email MyCode*](https://github.com/mybb/mybb/blob/mybb_1824/install/resources/settings.xml#L2127-L2134) setting is set to *Off*), or
* MyCode is disabled for individual forums, Private Messages, user profile signatures, and calendars, or
* guest users are not allowed to submit messages where MyCode is supported, or posting access is otherwise limited or controlled.

[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

### Overview

The HTML output of the `[email]` MyCode may include opening `[` and closing `]` square brackets in the value of the `href=""` attribute of the `<a>` tag.

This may result in unexpected, further parsing of MyCode and insertion of output in the parameter value with unescaped, colliding quotation marks `"`, leading to an XSS vulnerability.

### Patches

MyBB 1.8.25 resolves this issue with the following changes:

* Commit: [cb781b4](https://github.com/mybb/mybb/commit/cb781b49116bf5c4d8deca3e17498122b701677a)
  + `.patch`: <https://github.com/mybb/mybb/commit/cb781b49116bf5c4d8deca3e17498122b701677a.patch>

### Workarounds

To reduce impact without upgrading MyBB, change the following setting (*Admin CP → Configuration → Settings*):

* *Clickable Smilies and BB Code → [*Allow Email MyCode*](https://github.com/mybb/mybb/blob/mybb_1824/install/resources/settings.xml#L2127-L2134)*: *Off*

### References

* Release Notes: <https://mybb.com/versions/1.8.25/>

### For more information

Go to [mybb.com/security](https://mybb.com/security/) to report possible security concerns or to learn more about security research at MyBB.

### Contact

The security team can be reached at security@mybb.com.

### Severity

High

### CVE ID

CVE-2021-27279

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


