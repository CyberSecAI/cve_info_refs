=== Content from www.l9group.com_9bee684a_20250115_100417.html ===


[![Level Nine Group](https://www.l9group.com/wp-content/uploads/2023/09/logo-level-nine-ForLightBG.png)](https://www.l9group.com/)

* [Cybersecurity Services](https://www.l9group.com/services/)
  + - * Cybersecurity Services

        Protect yourself from all external threats and create a lasting security infrastructure.

        [Cybersecurity Services](/services/)
    - * Professional Services
      * [Penetration TestingIdentify vulnerabilities and test your security systems with assessment and testing services.](https://www.l9group.com/services/penetration-testing/)
      * [Application SecurityProtect the integrity of applications, firmware, or operating systems with third-party component analysis and application security support.](https://www.l9group.com/services/application-security/)
      * [Architecture & DesignBuild a secure foundation for your organization with layered security that covers endpoints, networks, data, and people.](https://www.l9group.com/services/architecture-design/)
      * [Risk & RegulatoryComply with industry security standards and address risk systematically with risk management services.](https://www.l9group.com/services/risk-regulatory/)
      * [CISO AdvisoryPartner with our CISO advisory team to enhance your cybersecurity leadership practice and strengthen your communication skills.](https://www.l9group.com/services/ciso-advisory/)
    - * Managed Services
      * [Detection & ResponseOffload threat detection and response protocols to an experienced team of security professionals.](https://www.l9group.com/services/detection-response/)
      * [SBOM Monitoring & AnalysisIdentify and reduce risk in the software supply chain with managed SBOM monitoring and analysis.](https://www.l9group.com/services/monitoring-analysis/)
      * [Engineering SupportMaintain the security infrastructure of your organization with a team experienced in operating cybersecurity systems.](https://www.l9group.com/services/engineering-support/)
      * [Product SecurityShip secure products designed end-to-end with the security of you and your customers in mind.](https://www.l9group.com/services/product-security/)
* [Cybersecurity Solutions](https://www.l9group.com/solutions/)
  + - * Cybersecurity Solutions

        Protect yourself from every kind of trouble. Keep doing the work that matters most.

        [Cybersecurity Solutions](/solutions/)
    - * By Industry
      * [HealthcareProtect patient data, enhance patient and provider experiences, and secure product design and development](https://www.l9group.com/solutions/healthcare/)
      * [Financial ServicesDefend yourself from evolving cyberattack techniques and adhere to new regulations like DORA and GDPR](https://www.l9group.com/solutions/financial-services/)
      * [Food & AgricultureProtect your control systems, mission-critical data, traceability and food safety with cybersecurity for the food and agriculture industry](https://www.l9group.com/solutions/food-agriculture/)
      * [TransportationProtect the backbone of the nation’s economy from evolving threats to aviation, railways, maritime and more](https://www.l9group.com/solutions/transportation/)
      * [CommunicationProtect client information and prevent service disruptions for mobile networks, internet services, 5G, IoT, and satellite communications](https://www.l9group.com/solutions/communication/)
      * [UtilitiesProtect public health, energy, and critical infrastructure in the energy, water and wastewater sectors](https://www.l9group.com/solutions/utilities/)
    - * By Challenge
      * [Medical Device 524BMitigate the risk of security incidents and strengthen medical device cybersecurity by complying with section 524B of the FD&C Act](https://www.l9group.com/solutions/medical-device-524b/)
      * [ICS & OT ComplianceImprove your operational technology and industrial control systems’ (OT/ICS) security, and comply with critical infrastructure regulations](https://www.l9group.com/solutions/ics-ot-compliance/)
      * [Cloud SecurityProtect data in transit and at rest while securing your cloud infrastructure from vulnerabilities with enhanced cloud security](https://www.l9group.com/solutions/cloud-security/)
      * [Supply Chain SecurityDefend against digital warfare and supply chain attacks with end-to-end critical infrastructure cybersecurity solutions](https://www.l9group.com/solutions/supply-chain-services/)
      * [Secure-by-DesignEmbed cybersecurity practices into your products, software, services and processes by designing with a security-first approach](https://www.l9group.com/solutions/secure-by-design/)
* [Research & Advisories](https://www.l9group.com/research/)
  + [Insights](https://www.l9group.com/articles/)
  + [Advisories](https://www.l9group.com/advisories/)
* [Company](https://www.l9group.com/team/)
* [Contact Us](https://www.l9group.com/contact-us/)

Select Page

[Back to all Advisories](https://www.l9group.com/advisories/)

# ecobee3 lite Heap Overflow – Level Nine Group

Unranked

**Advisory ID:**

L9-15-330

**First Published:**

June, 28th, 2021

**Last Updated:**

January, 22nd, 2024

**Version:**

4.5.81.200

**Category:**

Heap-based Buffer Overflow

**Vendor:**

ecobee

**Product:**

ecobee3 lite

## Risk Summary

A heap overflow vulnerability exists in the ‘HKProcessConfig’ function that overflows inside the HKWAC object. This object is responsible for managing the Homekit Wireless Access Control setup process. A threat actor can craft a malicious payload to control values inside the object causing the ecobee3 device to connect to a separate WiFi access point.

Given the nature of memory attacks, it may be possible to extend this attack further to achieve code execution.

## Technical Details

The Wireless Access Configuration (WAC) server is present on the ecobee3 device on TCP port 1200. Usually this function is employed when connecting the device to a WiFi access point during initial setup via an iOS device. However, this service remains present after the device has been connected to a wireless network leaving it vulnerable to attack.

A threat actor can send a POST request to the endpoint ‘http://

:1200/config’ with a request body that is greater than 512 bytes, resulting in an overflow of the HKWAC object. The HKWAC object is provisioned with 604 bytes, therefore any requests larger than 604 bytes results in the next object on the heap being corrupted, which could be a path to achieve code execution.

#### Vulnerable HKWAC object

![Vulnerable HKWAC object](data:image/svg+xml...)![Vulnerable HKWAC object](https://www.datocms-assets.com/26611/1624921418-7vulnerablehwackobject.png)

#### HKWAC object as initially provisioned

![HKWAC object as initially provisioned](data:image/svg+xml...)![HKWAC object as initially provisioned](https://www.datocms-assets.com/26611/1624921421-8hkwacprovisioned.png)

However, a threat actor can send a payload greater than 512 bytes but less than 604 to control specific elements of the HKWAC object including flags which are used to validate whether previous steps of the WAC process have been complete, such as if the ecobee3 is in ‘Access Point’ (AP) mode. By exploiting the structure, a threat actor can ‘trick’ the ecobee3 into accepting a new WiFi access configuration resulting in the device disconnecting from the current access point and connecting to a threat actor controlled access point.

#### Overflow

![Overflow](data:image/svg+xml...)![Overflow](https://www.datocms-assets.com/26611/1624921424-9overflow.png)

#### Flags checked in HKWAC object

![Flags checked in HKWAC object](data:image/svg+xml...)![Flags checked in HKWAC object](https://www.datocms-assets.com/26611/1624921428-10flagschecked.png)

#### Byte 592 calls HKWifiConnectSetup function

![](data:image/svg+xml...)![](https://www.datocms-assets.com/26611/1624921431-11flagcheckedreturned.png)

As an example, the device was connected to the SSID ‘TheFlooNetwork’ using the typical setup procedures. The research team then sent a crafted payload which overflowed the HKWAC object and caused the device to connect to the SSID ‘hackpi’. The payload did not require authentication, and could potentially be used in cross-site request forgery (CSRF) attacks.

#### ecobee3 lite connected to “TheFlooNetwork”

![Network connection](data:image/svg+xml...)![Network connection](https://www.datocms-assets.com/26611/1624921391-1deviceconnectedtofloonetwork.png)

## Payload sent to device causing it to change WiFi access points

![Payload](data:image/svg+xml...)![Payload](https://www.datocms-assets.com/26611/1624921396-2sendingpayload.png)

## Serial output shows device chaning to “hackpi” WiFi access point

![Device chaning WiFi access point](data:image/svg+xml...)![Device chaning WiFi access point](https://www.datocms-assets.com/26611/1624921399-3serialoutputchaningwifi.png)

## Request sent on new access point to “/configured” to compelte the setup

![Complete setup request](data:image/svg+xml...)![Complete setup request](https://www.datocms-assets.com/26611/1624921403-4serialoutputchaningwifi.png)

## Serial output shows the device completing the setup process

![Device completing the setup process](data:image/svg+xml...)![Device completing the setup process](https://www.datocms-assets.com/26611/1624921411-5deviceconnectedtohackpi.png)

## Device is confirmed on “hackpi” access point

![Device on ](data:image/svg+xml...)![Device on ](https://www.datocms-assets.com/26611/1624921415-6hostnameupdated.png)

![Level Nine Group](https://www.l9group.com/wp-content/uploads/2023/09/logo-level-nine-ForLightBG.png)

Tomorrow's evolving threats can be stopped today. Connect with us to protect what matters most.

[Contact Us](https://www.l9group.com/contact-us/)

* [Cybersecurity Services](https://www.l9group.com/services/)
  + [Penetration Testing](https://www.l9group.com/services/penetration-testing/)
  + [Application Security](https://www.l9group.com/services/application-security/)
  + [Architecture & Design](https://www.l9group.com/services/architecture-design/)
  + [Risk & Regulatory](https://www.l9group.com/services/risk-regulatory/)
  + [CISO Advisory](https://www.l9group.com/services/ciso-advisory/)
  + [Detection & Response](https://www.l9group.com/services/detection-response/)
  + [SBOM Monitoring & Analysis](https://www.l9group.com/services/monitoring-analysis/)
  + [Engineering Support](https://www.l9group.com/services/engineering-support/)
  + [Product Security](https://www.l9group.com/services/product-security/)

* [Cybersecurity Solutions](https://www.l9group.com/solutions/)
  + [Healthcare](https://www.l9group.com/solutions/healthcare/)
  + [Financial Services](https://www.l9group.com/solutions/financial-services/)
  + [Food & Agriculture](https://www.l9group.com/solutions/food-agriculture/)
  + [Transportation](https://www.l9group.com/solutions/transportation/)
  + [Communication](https://www.l9group.com/solutions/communication/)
  + [Utilities](https://www.l9group.com/solutions/utilities/)
  + [Medical Device 524B](https://www.l9group.com/solutions/medical-device-524b/)
  + [ICS & OT Compliance](https://www.l9group.com/solutions/ics-ot-compliance/)
  + [Cloud Security](https://www.l9group.com/solutions/cloud-security/)
  + [Supply Chain Security](https://www.l9group.com/solutions/supply-chain-services/)
  + [Secure-by-Design](https://www.l9group.com/solutions/secure-by-design/)

* [Research & Advisories](https://www.l9group.com/research/)
  + [Advisories](/advisories/)
  + [Insights](/articles/)
* [Company](https://www.l9group.com/team/)
* [Contact](https://www.l9group.com/contact-us/)

2025 © Level Nine Group

* [Contact](https://www.l9group.com/contact-us/)
* [Privacy Policy](https://www.l9group.com/privacy-policy/)
* [Accessibility Statement](https://www.l9group.com/accessibility-statement/)
* [Sitemap](https://www.l9group.com/sitemap/)

* [Twitter](https://twitter.com/l9group)
* [LinkedIn](https://www.linkedin.com/company/levelninegroup/)


