```text
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2021-27332",
      "details": {
        "root_cause": "The application is vulnerable to Stored Cross-Site Scripting (XSS).",
        "weaknesses": [
          "Lack of input sanitization/validation when updating class data, specifically within the `update_class.php` file."
        ],
        "impact": "An attacker can inject malicious JavaScript code into the system, which will then be executed in the browsers of other users who view the affected data. This can lead to session hijacking, sensitive information theft, and defacement of the application.",
        "attack_vector": "The attacker injects malicious JavaScript through the class update form.",
        "attacker_capabilities": "The attacker must have the ability to modify class data, implying they need to have the necessary privileges or have compromised an account with such permissions."
      },
      "references": [
        {
          "url": "https://github.com/BigTiger2020/CASAP-Automated-Enrollment-System/blob/main/CASAP-Automated-Enrollment-System-6.md",
          "type": "exploit"
        }
      ]
    }
  ]
}
```