The provided content relates to CVE-2021-27677.

**Root Cause of Vulnerability:** The Batflat CMS 1.3.6 application suffers from a stored Cross-Site Scripting (XSS) vulnerability. The vulnerability exists due to insufficient sanitization of user-supplied input in the Navigation, Galleries, and Snippets features.

**Weaknesses/Vulnerabilities Present:**
- **Stored XSS:** The application stores user-provided malicious scripts in its database. When these scripts are rendered to other users, the scripts are executed in their browsers.
- **Insufficient Input Sanitization:** The application does not properly sanitize user input when adding links in navigation, adding galleries, or adding snippets. This allows an attacker to inject malicious HTML and JavaScript code into the application's data.

**Impact of Exploitation:**
- **Arbitrary Code Execution:** Successful exploitation of the stored XSS vulnerability allows an attacker to execute arbitrary JavaScript code in the context of a user's browser session.
- **Session Hijacking:** An attacker could potentially steal cookies, redirect users to malicious websites, or perform actions on behalf of the user.
- **Defacement:** An attacker can change the content of the webpage.
- **Phishing:** Malicious scripts could be injected to display fake login forms to steal credentials.

**Attack Vectors:**
- The attacker needs to be logged in as an editor with sufficient privileges to modify Navigation, Galleries, and Snippets.
- The attacker can inject malicious code into the following fields:
  - Navigation link payloads
  - Gallery payloads
  - Snippet payloads

**Required Attacker Capabilities/Position:**
- The attacker needs to be an authenticated user with editor rights.
- The attacker needs access to the CMS administration panel.