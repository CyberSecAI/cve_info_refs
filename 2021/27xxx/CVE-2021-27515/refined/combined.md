=== Content from lists.debian.org_4e57f213_20250115_081035.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 3336-1] node-url-parse security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3336-1] node-url-parse security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Thu, 23 Feb 2023 01:55:13 +0100
* *Message-id*: <Y/a5cbeMzR3LihNx@debian.org>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3336-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
February 23, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : node-url-parse
Version        : 1.2.0-2+deb10u2
CVE ID         : CVE-2021-3664 CVE-2021-27515 CVE-2022-0512 CVE-2022-0639
                 CVE-2022-0686 CVE-2022-0691
Debian Bug     : 985110 991577

Multiple vulnerabilities were found in node-types-url-parse, a Node.js
module used to parse URLs, which may result in authorization bypass or
redirection to untrusted sites.

CVE-2021-3664

    url-parse mishandles certain uses of a single (back)slash such as
    https:\ & https:/ and interprets the URI as a relative path.
    Browsers accept a single backslash after the protocol, and treat it
    as a normal slash, while url-parse sees it as a relative path.
    Depending on library usage, this may result in allow/block list
    bypasses, SSRF attacks, open redirects, or other undesired behavior.

CVE-2021-27515

    Using backslash in the protocol is valid in the browser, while
    url-parse thinks it's a relative path.  An application that
    validates a URL using url-parse might pass a malicious link.

CVE-2022-0512

    Incorrect handling of username and password can lead to failure to
    properly identify the hostname, which in turn could result in
    authorization bypass.

CVE-2022-0639

    Incorrect conversion of `@` characters in protocol in the `href`
    field can lead to lead to failure to properly identify the hostname,
    which in turn could result in authorization bypass.

CVE-2022-0686

    Rohan Sharma reported that url-parse is unable to find the correct
    hostname when no port number is provided in the URL, such as in
    `<http://example.com:`>.  This could in turn result in SSRF attacks,
    open redirects or any other vulnerability which depends on the
    `hostname` field of parsed URL.

CVE-2022-0691

    url-parse is unable to find the correct hostname when the URL
    contains a backspace `\b` character.  This tricks the parser into
    interpreting the URL as a relative path, bypassing all hostname
    checks.  It can also lead to false positive in `extractProtocol()`.

For Debian 10 buster, these problems have been fixed in version
1.2.0-2+deb10u2.

We recommend that you upgrade your node-url-parse packages.

For the detailed security status of node-url-parse please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/node-url-parse>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpbiaYpBB4dN.pgp)**

*Description:* PGP signature

---



=== Content from github.com_131d0b19_20250115_081033.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fpull%2F197)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fpull%2F197)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=unshiftio%2Furl-parse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[unshiftio](/unshiftio)
/
**[url-parse](/unshiftio/url-parse)**
Public

* [Notifications](/login?return_to=%2Funshiftio%2Furl-parse) You must be signed in to change notification settings
* [Fork
  107](/login?return_to=%2Funshiftio%2Furl-parse)
* [Star
   1k](/login?return_to=%2Funshiftio%2Furl-parse)

* [Code](/unshiftio/url-parse)
* [Issues
  12](/unshiftio/url-parse/issues)
* [Pull requests
  0](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects
  0](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

Additional navigation options

* [Code](/unshiftio/url-parse)
* [Issues](/unshiftio/url-parse/issues)
* [Pull requests](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Funshiftio%2Furl-parse%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Funshiftio%2Furl-parse%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [security] More backslash fixes #197

 Merged

[3rd-Eden](/3rd-Eden)
merged 1 commit into
[master](/unshiftio/url-parse/tree/master "unshiftio/url-parse:master")
from
[even-less-backslash](/unshiftio/url-parse/tree/even-less-backslash "unshiftio/url-parse:even-less-backslash")

Feb 17, 2021

 Merged

# [[security] More backslash fixes](#top) #197

[3rd-Eden](/3rd-Eden)
merged 1 commit into
[master](/unshiftio/url-parse/tree/master "unshiftio/url-parse:master")
from
[even-less-backslash](/unshiftio/url-parse/tree/even-less-backslash "unshiftio/url-parse:even-less-backslash")

Feb 17, 2021

[Conversation
6](/unshiftio/url-parse/pull/197)
[Commits
1](/unshiftio/url-parse/pull/197/commits)
[Checks
0](/unshiftio/url-parse/pull/197/checks)
[Files changed](/unshiftio/url-parse/pull/197/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=60&v=4)](/3rd-Eden)

Copy link

Member

### @3rd-Eden **[3rd-Eden](/3rd-Eden)** commented [Feb 17, 2021](#issue-810247795)

As per title, it seems that the previous security fix released in 1.4.5 only partially fixed the issue, with this adjustment to the regular expression we now have parity with the browser built-in URL parser as well. This change also exposed an issue where we didn't default pathnames to / when nothing was supplied in URL's.

That should now be resolved as well.

Sorry, something went wrong.

 👍
1
 afsaneh92117 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&v=4)](/3rd-Eden)

`[[security] More backslash fixes](/unshiftio/url-parse/pull/197/commits/0febed523500e1e19a796c8a18e2a063b4169901 "[security] More backslash fixes")`

`[0febed5](/unshiftio/url-parse/pull/197/commits/0febed523500e1e19a796c8a18e2a063b4169901)`

[![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&u=3338a04866970006ddc1c23e0d1a9b2dc48cc0ea&v=4)](/3rd-Eden)
[3rd-Eden](/3rd-Eden)
merged commit [`d1e7e88`](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)
into
master

[Feb 17, 2021](https://github.com/unshiftio/url-parse/pull/197#event-4341946042)

 [![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&u=3338a04866970006ddc1c23e0d1a9b2dc48cc0ea&v=4)](/3rd-Eden)
[3rd-Eden](/3rd-Eden)
deleted the
even-less-backslash

branch
[February 17, 2021 15:17](#event-4341946300)

[![lpinca](https://avatars.githubusercontent.com/u/1443911?s=60&v=4)](/lpinca)

**[lpinca](/lpinca)**
reviewed
[Feb 17, 2021](#pullrequestreview-592565595)

 [View reviewed changes](/unshiftio/url-parse/pull/197/files/0febed523500e1e19a796c8a18e2a063b4169901)

[test/test.js](/unshiftio/url-parse/pull/197/files/0febed523500e1e19a796c8a18e2a063b4169901#diff-a561630bb56b82342bc66697aee2ad96efddcbc9d150665abd6fb7ecb7c0ab2f)

|  |  | assume(parsed.hostname).equals('github.com'); |
| --- | --- | --- |
|  |  | assume(parsed.pathname).equals('/foo/bar'); |
|  |  |  |
|  |  | url = 'https:/\/\/\github.com/foo/bar'; |

Copy link

Member

### @lpinca **[lpinca](/lpinca)** [Feb 17, 2021](#discussion_r577898939)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@3rd-Eden](https://github.com/3rd-Eden) did you mean `/\\/\\/\\` here? 3 characters are currently unnecessarily escaped.

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @3rd-Eden **[3rd-Eden](/3rd-Eden)** [Feb 18, 2021](#discussion_r578457709)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's just testing that literally any slash (forward/backward) or combination of both is allowed.

Sorry, something went wrong.

All reactions

Copy link

Member

### @lpinca **[lpinca](/lpinca)** [Feb 18, 2021](#discussion_r578469852)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Ok, then it should be `url = 'https:/\\/\\/\\github.com/foo/bar'`.

Sorry, something went wrong.

All reactions

[![paranoidjk](https://avatars.githubusercontent.com/u/7971415?s=60&v=4)](/paranoidjk)

**[paranoidjk](/paranoidjk)**
reviewed
[Feb 18, 2021](#pullrequestreview-593071603)

 [View reviewed changes](/unshiftio/url-parse/pull/197/files/0febed523500e1e19a796c8a18e2a063b4169901)

[index.js](/unshiftio/url-parse/pull/197/files/0febed523500e1e19a796c8a18e2a063b4169901#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)

|  |  | // to always have a / |
| --- | --- | --- |
|  |  | // |
|  |  | if (url.pathname.charAt(0) !== '/' && url.hostname) { |
|  |  | url.pathname = '/' + url.pathname; |

Copy link

### @paranoidjk **[paranoidjk](/paranoidjk)** [Feb 18, 2021](#discussion_r578308451)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This cause break change, see below demo code:

```
// assume this code exec in page http://cone-cf8b5c0e.app-dev.alipay.net/cone/strategy
const { pathname} = url('/cone/operate');

```

This PR cause pathname change from 'cone/operate' to '/cone/cone/operate'

debugger snapshot:

input:

[![image](https://user-images.githubusercontent.com/7971415/108344002-8ff5d880-7217-11eb-823e-84dc73cec269.png)](https://user-images.githubusercontent.com/7971415/108344002-8ff5d880-7217-11eb-823e-84dc73cec269.png)

output:

[![image](https://user-images.githubusercontent.com/7971415/108344060-a308a880-7217-11eb-8ed1-e0855e8f121a.png)](https://user-images.githubusercontent.com/7971415/108344060-a308a880-7217-11eb-8ed1-e0855e8f121a.png)

i don't know of pass '/cone/operate' is a valid argument, if no, i think throw error is a better way

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @3rd-Eden

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Could you create an issue about this so we can track it? We do known issue with relative paths atm see [#200](https://github.com/unshiftio/url-parse/issues/200) so it might be related to this bug.

Sorry, something went wrong.

All reactions

[![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=80&v=4)](/abergmann)

Copy link

### **[abergmann](/abergmann)** commented [Feb 22, 2021](#issuecomment-783518070)

| [CVE-2021-27515](https://nvd.nist.gov/vuln/detail/CVE-2021-27515) was assigned to this PR. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Mar 16, 2021

[yarn(deps): bump url-parse from 1.4.7 to 1.5.1
iaebots/iae#50](/iaebots/iae/pull/50)
 Merged

[Bump url-parse from 1.4.0 to 1.5.1
GaloisInc/cryptol-vscode#5](/GaloisInc/cryptol-vscode/pull/5)
 Closed

[![@sync-by-unito](https://avatars.githubusercontent.com/in/64202?s=40&v=4)](/apps/sync-by-unito)
[sync-by-unito](/apps/sync-by-unito)
bot
mentioned this pull request
[May 9, 2021](#ref-pullrequest-882788070)

[Bump url-parse from 1.4.7 to 1.5.1
covidcanidoit/covidcanidoit#321](/covidcanidoit/covidcanidoit/pull/321)
 Closed

[lpinca](/lpinca)
added a commit
that referenced
this pull request
[May 13, 2021](#ref-commit-af84da0)
[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

`[[test] Fix multiple mixed slashes test](/unshiftio/url-parse/commit/af84da066add6daf843410bf0540a5620ac10b2b "[test] Fix multiple mixed slashes test

Refs: https://github.com/unshiftio/url-parse/pull/197#discussion_r577898939")`
…

`[af84da0](/unshiftio/url-parse/commit/af84da066add6daf843410bf0540a5620ac10b2b)`

```
Refs: [#197 (comment)](https://github.com/unshiftio/url-parse/pull/197#discussion_r577898939)
```

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Jul 9, 2021](#ref-pullrequest-940816399)

[Bulk vulnerability fix - Lockfile fix
WeDoSoftware/webAppBackend#253](/WeDoSoftware/webAppBackend/pull/253)
 Open

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Aug 9, 2021](#ref-pullrequest-963863351)

[Bulk vulnerability fix - Lockfile fix
debricked/react#2](/debricked/react/pull/2)
 Open

[![@nigelellis](https://avatars.githubusercontent.com/u/12142109?s=40&v=4)](/nigelellis)
[nigelellis](/nigelellis)
mentioned this pull request
[Aug 12, 2021](#ref-issue-290704875)

[`pathname` === '' ?
#96](/unshiftio/url-parse/issues/96)

Closed

[![@debricked](https://avatars.githubusercontent.com/in/24490?s=40&v=4)](/apps/debricked)
[debricked](/apps/debricked)
bot
mentioned this pull request
[Aug 31, 2021](#ref-pullrequest-983877294)

[Bulk vulnerability fix - Lockfile fix
eseite47/citizen#268](/eseite47/citizen/pull/268)
 Open

[![@Abdul1110](https://avatars.githubusercontent.com/u/47382380?s=40&v=4)](/Abdul1110)
[Abdul1110](/Abdul1110)
mentioned this pull request
[May 12, 2022](#ref-issue-1233398644)

[CVE-2021-27515 @ Npm-url-parse-1.4.7
Abdul1110/TEST\_ORION#79](/Abdul1110/TEST_ORION/issues/79)

Open

[![@Svetlana-github](https://avatars.githubusercontent.com/u/62244014?s=40&v=4)](/Svetlana-github)
[Svetlana-github](/Svetlana-github)
mentioned this pull request
[May 16, 2022](#ref-issue-1237103331)

[CVE-2021-27515 @ Npm-url-parse-1.4.4
Svetlana-github/test#121](/Svetlana-github/test/issues/121)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fpull%2F197)

Reviewers

[![@paranoidjk](https://avatars.githubusercontent.com/u/7971415?s=40&v=4)](/paranoidjk) [paranoidjk](/paranoidjk)

paranoidjk left review comments

[![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca) [lpinca](/lpinca)

lpinca left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=52&v=4)](/3rd-Eden) [![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=52&v=4)](/abergmann) [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=52&v=4)](/lpinca) [![@paranoidjk](https://avatars.githubusercontent.com/u/7971415?s=52&v=4)](/paranoidjk)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9a6cf248_20250115_081028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fcompare%2F1.4.7...1.5.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fcompare%2F1.4.7...1.5.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=unshiftio%2Furl-parse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[unshiftio](/unshiftio)
/
**[url-parse](/unshiftio/url-parse)**
Public

* [Notifications](/login?return_to=%2Funshiftio%2Furl-parse) You must be signed in to change notification settings
* [Fork
  107](/login?return_to=%2Funshiftio%2Furl-parse)
* [Star
   1k](/login?return_to=%2Funshiftio%2Furl-parse)

* [Code](/unshiftio/url-parse)
* [Issues
  12](/unshiftio/url-parse/issues)
* [Pull requests
  0](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects
  0](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

Additional navigation options

* [Code](/unshiftio/url-parse)
* [Issues](/unshiftio/url-parse/issues)
* [Pull requests](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

[Permalink](https://github.com/unshiftio/url-parse/compare/unshiftio%3A0cde3dc...unshiftio%3A267a0c6)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
unshiftio/url-parse

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
1.4.7

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/unshiftio/url-parse/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...1.5.0)

Could not load tags

Nothing to show

[{{ refName }}
default](/unshiftio/url-parse/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...1.5.0)

 Loading

...

*head repository:*
unshiftio/url-parse

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
1.5.0

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/unshiftio/url-parse/compare/1.4.7...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/unshiftio/url-parse/compare/1.4.7...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 12

  commits
* 9

  files changed
* 4

  contributors

### Commits on Jun 4, 2019

1. [[travis] Add node 12 and remove node 6](/unshiftio/url-parse/commit/ed3f53429db43e379b0c3fd0e2eb54dcc4ce4d55)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Jun 4, 2019

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/ed3f53429db43e379b0c3fd0e2eb54dcc4ce4d55)
   * Copy full SHA for ed3f534
   * [Browse repository at this point](/unshiftio/url-parse/tree/ed3f53429db43e379b0c3fd0e2eb54dcc4ce4d55)

   Copy the full SHA

    [ed3f534](/unshiftio/url-parse/commit/ed3f53429db43e379b0c3fd0e2eb54dcc4ce4d55)View commit details

   Browse the repository at this point in the history

### Commits on Dec 24, 2019

1. [[pkg] Update nyc to version 15.0.0 (](/unshiftio/url-parse/commit/3ce782446d48dca6f36ce68a15a33acf57f06bc8)[#188](https://github.com/unshiftio/url-parse/pull/188)[)](/unshiftio/url-parse/commit/3ce782446d48dca6f36ce68a15a33acf57f06bc8)

   [![@greenkeeper](https://avatars.githubusercontent.com/in/505?s=40&v=4)](/apps/greenkeeper) [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [greenkeeper[bot]](/unshiftio/url-parse/commits?author=greenkeeper%5Bbot%5D "View all commits by greenkeeper[bot]")
   authored and
   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Dec 24, 2019

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/3ce782446d48dca6f36ce68a15a33acf57f06bc8)
   * Copy full SHA for 3ce7824
   * [Browse repository at this point](/unshiftio/url-parse/tree/3ce782446d48dca6f36ce68a15a33acf57f06bc8)

   Copy the full SHA

    [3ce7824](/unshiftio/url-parse/commit/3ce782446d48dca6f36ce68a15a33acf57f06bc8)View commit details

   Browse the repository at this point in the history

### Commits on Feb 10, 2020

1. [[pkg] Update mocha to version 7.0.1 (](/unshiftio/url-parse/commit/08fd2cc712e61a664e8ce90059a12f4aee1df3ba)[#189](https://github.com/unshiftio/url-parse/pull/189)[)](/unshiftio/url-parse/commit/08fd2cc712e61a664e8ce90059a12f4aee1df3ba)

   [![@greenkeeper](https://avatars.githubusercontent.com/in/505?s=40&v=4)](/apps/greenkeeper)

   [greenkeeper[bot]](/unshiftio/url-parse/commits?author=greenkeeper%5Bbot%5D "View all commits by greenkeeper[bot]")
   authored
   Feb 10, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/08fd2cc712e61a664e8ce90059a12f4aee1df3ba)
   * Copy full SHA for 08fd2cc
   * [Browse repository at this point](/unshiftio/url-parse/tree/08fd2cc712e61a664e8ce90059a12f4aee1df3ba)

   Copy the full SHA

    [08fd2cc](/unshiftio/url-parse/commit/08fd2cc712e61a664e8ce90059a12f4aee1df3ba)View commit details

   Browse the repository at this point in the history

### Commits on May 24, 2020

1. [[travis] Test on node 14](/unshiftio/url-parse/commit/673c3a78802e515e628874a4fef1bf2f48d69faf)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   May 24, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/673c3a78802e515e628874a4fef1bf2f48d69faf)
   * Copy full SHA for 673c3a7
   * [Browse repository at this point](/unshiftio/url-parse/tree/673c3a78802e515e628874a4fef1bf2f48d69faf)

   Copy the full SHA

    [673c3a7](/unshiftio/url-parse/commit/673c3a78802e515e628874a4fef1bf2f48d69faf)View commit details

   Browse the repository at this point in the history

### Commits on Jun 17, 2020

1. [[pkg] Update mocha to version 8.0.1](/unshiftio/url-parse/commit/77c1184b39387ea705122b96002cb625dee8697a)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Jun 17, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/77c1184b39387ea705122b96002cb625dee8697a)
   * Copy full SHA for 77c1184
   * [Browse repository at this point](/unshiftio/url-parse/tree/77c1184b39387ea705122b96002cb625dee8697a)

   Copy the full SHA

    [77c1184](/unshiftio/url-parse/commit/77c1184b39387ea705122b96002cb625dee8697a)View commit details

   Browse the repository at this point in the history
2. [[test] Do not test on all available versions of Edge and Safari](/unshiftio/url-parse/commit/ce3783f4ea25753cfa36376769c14e4e2fe6ea80)
    …

   ```
   Use only the oldest and latest version.
   ```

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Jun 17, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/ce3783f4ea25753cfa36376769c14e4e2fe6ea80)
   * Copy full SHA for ce3783f
   * [Browse repository at this point](/unshiftio/url-parse/tree/ce3783f4ea25753cfa36376769c14e4e2fe6ea80)

   Copy the full SHA

    [ce3783f](/unshiftio/url-parse/commit/ce3783f4ea25753cfa36376769c14e4e2fe6ea80)View commit details

   Browse the repository at this point in the history
3. [[pkg] Add .npmrc](/unshiftio/url-parse/commit/190b2168035899a2a88f2dc2625963bf7e2f338f)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Jun 17, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/190b2168035899a2a88f2dc2625963bf7e2f338f)
   * Copy full SHA for 190b216
   * [Browse repository at this point](/unshiftio/url-parse/tree/190b2168035899a2a88f2dc2625963bf7e2f338f)

   Copy the full SHA

    [190b216](/unshiftio/url-parse/commit/190b2168035899a2a88f2dc2625963bf7e2f338f)View commit details

   Browse the repository at this point in the history

### Commits on Sep 9, 2020

1. [[pkg] Move coveralls to dev dependencies](/unshiftio/url-parse/commit/933809d630c7b21399b4e5df59fccccd80033b21)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Sep 9, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/933809d630c7b21399b4e5df59fccccd80033b21)
   * Copy full SHA for 933809d
   * [Browse repository at this point](/unshiftio/url-parse/tree/933809d630c7b21399b4e5df59fccccd80033b21)

   Copy the full SHA

    [933809d](/unshiftio/url-parse/commit/933809d630c7b21399b4e5df59fccccd80033b21)View commit details

   Browse the repository at this point in the history

### Commits on Oct 6, 2020

1. [[pkg] Replace nyc with c8](/unshiftio/url-parse/commit/422c8b5e4cac6a79cd35b4e86731476dcbeec7e4)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Oct 6, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/422c8b5e4cac6a79cd35b4e86731476dcbeec7e4)
   * Copy full SHA for 422c8b5
   * [Browse repository at this point](/unshiftio/url-parse/tree/422c8b5e4cac6a79cd35b4e86731476dcbeec7e4)

   Copy the full SHA

    [422c8b5](/unshiftio/url-parse/commit/422c8b5e4cac6a79cd35b4e86731476dcbeec7e4)View commit details

   Browse the repository at this point in the history
2. [[ignore] Remove npm-debug.log from .gitignore](/unshiftio/url-parse/commit/d99bf4cf259b7378c855f786edc253e70405ffdc)

   [![@lpinca](https://avatars.githubusercontent.com/u/1443911?s=40&v=4)](/lpinca)

   [lpinca](/unshiftio/url-parse/commits?author=lpinca "View all commits by lpinca")
   committed
   Oct 6, 2020

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/d99bf4cf259b7378c855f786edc253e70405ffdc)
   * Copy full SHA for d99bf4c
   * [Browse repository at this point](/unshiftio/url-parse/tree/d99bf4cf259b7378c855f786edc253e70405ffdc)

   Copy the full SHA

    [d99bf4c](/unshiftio/url-parse/commit/d99bf4cf259b7378c855f786edc253e70405ffdc)View commit details

   Browse the repository at this point in the history

### Commits on Feb 17, 2021

1. [[security] More backslash fixes (](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)[#197](https://github.com/unshiftio/url-parse/pull/197)[)](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)

   [![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&v=4)](/3rd-Eden)

   [3rd-Eden](/unshiftio/url-parse/commits?author=3rd-Eden "View all commits by 3rd-Eden")
   authored
   Feb 17, 2021

   [1](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0#comments)

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)
   * Copy full SHA for d1e7e88
   * [Browse repository at this point](/unshiftio/url-parse/tree/d1e7e8822f26e8a49794b757123b51386325b2b0)

   Copy the full SHA

    [d1e7e88](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)View commit details

   Browse the repository at this point in the history
2. [[dist] 1.5.0](/unshiftio/url-parse/commit/267a0c6f7ef1a58271be61611c5103daace602c9)

   [![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&v=4)](/3rd-Eden)

   [3rd-Eden](/unshiftio/url-parse/commits?author=3rd-Eden "View all commits by 3rd-Eden")
   committed
   Feb 17, 2021

   [1](/unshiftio/url-parse/commit/267a0c6f7ef1a58271be61611c5103daace602c9#comments)

   Configuration menu

   * [View commit details](/unshiftio/url-parse/commit/267a0c6f7ef1a58271be61611c5103daace602c9)
   * Copy full SHA for 267a0c6
   * [Browse repository at this point](/unshiftio/url-parse/tree/267a0c6f7ef1a58271be61611c5103daace602c9)

   Copy the full SHA

    [267a0c6](/unshiftio/url-parse/commit/267a0c6f7ef1a58271be61611c5103daace602c9)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff 1.4.7...1.5.0`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from advisory.checkmarx.net_2e7a8508_20250115_081021.html ===
![](data:image/svg+xml...)![logo](data:image/gif;base64...)![logo](/_next/static/media/logo.4a80e7ce.png)

* [Advisories](/)
* [Disclosure Policy](/disclosure-policy/)
* [Contact Us](https://www.checkmarx.com/contact-us/)
* [Check with SCA](https://checkmarx.com/product/cxsca-open-source-scanning/)
Defend your code againstÂ SpringShellÂ in two ways: read ourÂ [blog post](https://checkmarx.com/blog/springshell-remote-code-execution-via-spring-web/)with what-to-do advice, and useÂ Checkmarx SCAÂ to test your applications.

From time to time, our security researchers find zero-day vulnerabilities in open source projects. When this happens, we inform the relevant maintaners of the package and publish our findings here only after theyâve been remediated, or when a patch is available.

* 1
* 2
* 3
* 4
* 5
* 6
* 7
* 8
* 9
* 10
* 11
* 12
* 13
* 14
Â© 2024 Checkmarx Ltd.

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)

* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)
* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

Â© 2024 Checkmarx Ltd.

=== Content from github.com_bf8ad224_20250115_081025.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fcommit%2Fd1e7e8822f26e8a49794b757123b51386325b2b0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fcommit%2Fd1e7e8822f26e8a49794b757123b51386325b2b0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=unshiftio%2Furl-parse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[unshiftio](/unshiftio)
/
**[url-parse](/unshiftio/url-parse)**
Public

* [Notifications](/login?return_to=%2Funshiftio%2Furl-parse) You must be signed in to change notification settings
* [Fork
  107](/login?return_to=%2Funshiftio%2Furl-parse)
* [Star
   1k](/login?return_to=%2Funshiftio%2Furl-parse)

* [Code](/unshiftio/url-parse)
* [Issues
  12](/unshiftio/url-parse/issues)
* [Pull requests
  0](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects
  0](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

Additional navigation options

* [Code](/unshiftio/url-parse)
* [Issues](/unshiftio/url-parse/issues)
* [Pull requests](/unshiftio/url-parse/pulls)
* [Actions](/unshiftio/url-parse/actions)
* [Projects](/unshiftio/url-parse/projects)
* [Wiki](/unshiftio/url-parse/wiki)
* [Security](/unshiftio/url-parse/security)
* [Insights](/unshiftio/url-parse/pulse)

## Commit

[Permalink](/unshiftio/url-parse/commit/d1e7e8822f26e8a49794b757123b51386325b2b0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[security] More backslash fixes ([#197](https://github.com/unshiftio/url-parse/pull/197))

[Browse files](/unshiftio/url-parse/tree/d1e7e8822f26e8a49794b757123b51386325b2b0)
Browse the repository at this point in the history

* Loading branch information

[![@3rd-Eden](https://avatars.githubusercontent.com/u/28071?s=40&v=4)](/3rd-Eden)

[3rd-Eden](/unshiftio/url-parse/commits?author=3rd-Eden "View all commits by 3rd-Eden")
authored
Feb 17, 2021

1 parent
[d99bf4c](/unshiftio/url-parse/commit/d99bf4cf259b7378c855f786edc253e70405ffdc)

commit d1e7e88

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**85 additions**
and
**26 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* SECURITY.md
  [SECURITY.md](#diff-f6ed156e4bf5c791680662464b94ea5d753f219ee816b385f67870e2c0d7d4c7)
* index.js
  [index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)
* test

  + test/fuzzy.js
    [fuzzy.js](#diff-ddb69647f7fb5b3addf2f62b5186aecdf2c22a6e8cc07abe5f0d4bedd40e031a)
  + test/test.js
    [test.js](#diff-a561630bb56b82342bc66697aee2ad96efddcbc9d150665abd6fb7ecb7c0ab2f)

## There are no files selected for viewing

11 changes: 10 additions & 1 deletion

11
[SECURITY.md](#diff-f6ed156e4bf5c791680662464b94ea5d753f219ee816b385f67870e2c0d7d4c7 "SECURITY.md")

Show comments

[View file](/unshiftio/url-parse/blob/d1e7e8822f26e8a49794b757123b51386325b2b0/SECURITY.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -33,13 +33,22 @@ acknowledge your responsible disclosure, if you wish. |
|  |  |  |
|  |  | ## History |
|  |  |  |
|  |  | > Using backslash in the protocol is valid in the browser, while url-parse |
|  |  | > thinks it’s a relative path. An application that validates a url using |
|  |  | > url-parse might pass a malicious link. |
|  |  |  |
|  |  | - \*\*Reporter credits\*\* |
|  |  | - CxSCA AppSec team at Checkmarx. |
|  |  | - Twitter: [Yaniv Nizry](https://twitter.com/ynizry) |
|  |  | - Fixed in: 1.5.0 |
|  |  |  |
|  |  | > The `extractProtocol` method does not return the correct protocol when |
|  |  | > provided with unsanitized content which could lead to false positives. |
|  |  |  |
|  |  | - \*\*Reporter credits\*\* |
|  |  | - Reported through our security email & Twitter interaction. |
|  |  | - Twitter: [@ronperris](https://twitter.com/ronperris) |
|  |  | - Fixed in: 1.4.5 |
|  |  | - Fixed in: 1.4.5 |
|  |  |  |
|  |  | --- |
|  |  |  |
| Expand Down | |  |

21 changes: 16 additions & 5 deletions

21
[index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346 "index.js")

Show comments

[View file](/unshiftio/url-parse/blob/d1e7e8822f26e8a49794b757123b51386325b2b0/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,8 +2,8 @@ |
|  |  |  |
|  |  | var required = require('requires-port') |
|  |  | , qs = require('querystringify') |
|  |  | , slashes = /^[A-Za-z][A-Za-z0-9+-.]\*:\/\// |
|  |  | , protocolre = /^([a-z][a-z0-9.+-]\*:)?(\/\/)?([\S\s]\*)/i |
|  |  | , slashes = /^[A-Za-z][A-Za-z0-9+-.]\*:[\\/]+/ |
|  |  | , protocolre = /^([a-z][a-z0-9.+-]\*:)?([\\/]{1,})?([\S\s]\*)/i |
|  |  | , whitespace = '[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]' |
|  |  | , left = new RegExp('^'+ whitespace +'+'); |
|  |  |  |
| Expand Down  Expand Up | | @@ -115,11 +115,14 @@ function lolcation(loc) { |
|  |  | \*/ |
|  |  | function extractProtocol(address) { |
|  |  | address = trimLeft(address); |
|  |  | var match = protocolre.exec(address); |
|  |  |  |
|  |  | var match = protocolre.exec(address) |
|  |  | , protocol = match[1] ? match[1].toLowerCase() : '' |
|  |  | , slashes = !!(match[2] && match[2].length >= 2); |
|  |  |  |
|  |  | return { |
|  |  | protocol: match[1] ? match[1].toLowerCase() : '', |
|  |  | slashes: !!match[2], |
|  |  | protocol: protocol, |
|  |  | slashes: slashes, |
|  |  | rest: match[3] |
|  |  | }; |
|  |  | } |
| Expand Down  Expand Up | | @@ -280,6 +283,14 @@ function Url(address, location, parser) { |
|  |  | url.pathname = resolve(url.pathname, location.pathname); |
|  |  | } |
|  |  |  |
|  |  | // |
|  |  | // Default to a / for pathname if none exists. This normalizes the URL |
|  |  | // to always have a / |
|  |  | // |
|  |  | if (url.pathname.charAt(0) !== '/' && url.hostname) { |
|  |  | url.pathname = '/' + url.pathname; |
|  |  | } |
|  |  |  |
|  |  | // |
|  |  | // We should not add port numbers if they are already the default port number |
|  |  | // for a given protocol. As the host also contains the port number we're going |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[test/fuzzy.js](#diff-ddb69647f7fb5b3addf2f62b5186aecdf2c22a6e8cc07abe5f0d4bedd40e031a "test/fuzzy.js")

Show comments

[View file](/unshiftio/url-parse/blob/d1e7e8822f26e8a49794b757123b51386325b2b0/test/fuzzy.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,6 +103,8 @@ module.exports = function generate() { |
|  |  | , key; |
|  |  |  |
|  |  | spec.protocol = get('protocol'); |
|  |  | spec.slashes = true; |
|  |  |  |
|  |  | spec.hostname = get('hostname'); |
|  |  | spec.pathname = get('pathname'); |
|  |  |  |
| Expand Down | |  |

77 changes: 57 additions & 20 deletions

77
[test/test.js](#diff-a561630bb56b82342bc66697aee2ad96efddcbc9d150665abd6fb7ecb7c0ab2f "test/test.js")

Show comments

[View file](/unshiftio/url-parse/blob/d1e7e8822f26e8a49794b757123b51386325b2b0/test/test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -190,9 +190,10 @@ describe('url-parse', function () { |
|  |  | , parsed = parse(url); |
|  |  |  |
|  |  | assume(parsed.port).equals(''); |
|  |  | assume(parsed.pathname).equals('/'); |
|  |  | assume(parsed.host).equals('example.com'); |
|  |  | assume(parsed.hostname).equals('example.com'); |
|  |  | assume(parsed.href).equals('http://example.com'); |
|  |  | assume(parsed.href).equals('http://example.com/'); |
|  |  | }); |
|  |  |  |
|  |  | it('understands an / as pathname', function () { |
| Expand Down  Expand Up | | @@ -242,16 +243,30 @@ describe('url-parse', function () { |
|  |  | assume(parsed.hostname).equals('google.com'); |
|  |  | assume(parsed.hash).equals('#what\\is going on'); |
|  |  |  |
|  |  | parsed = parse('//\\what-is-up.com'); |
|  |  | parsed = parse('http://yolo.com\\what-is-up.com'); |
|  |  | assume(parsed.pathname).equals('/what-is-up.com'); |
|  |  | }); |
|  |  |  |
|  |  | it('correctly ignores multiple slashes //', function () { |
|  |  | var url = '////what-is-up.com' |
|  |  | , parsed = parse(url); |
|  |  |  |
|  |  | assume(parsed.host).equals(''); |
|  |  | assume(parsed.hostname).equals(''); |
|  |  | assume(parsed.host).equals('what-is-up.com'); |
|  |  | assume(parsed.href).equals('//what-is-up.com/'); |
|  |  | }); |
|  |  |  |
|  |  | it('does not see a slash after the protocol as path', function () { |
|  |  | var url = 'https:\\/github.com/foo/bar' |
|  |  | , parsed = parse(url); |
|  |  |  |
|  |  | assume(parsed.host).equals('github.com'); |
|  |  | assume(parsed.hostname).equals('github.com'); |
|  |  | assume(parsed.pathname).equals('/foo/bar'); |
|  |  |  |
|  |  | url = 'https:/\/\/\github.com/foo/bar'; |
|  |  | assume(parsed.host).equals('github.com'); |
|  |  | assume(parsed.hostname).equals('github.com'); |
|  |  | assume(parsed.pathname).equals('/foo/bar'); |
|  |  | }); |
|  |  |  |
|  |  | describe('origin', function () { |
| Expand Down  Expand Up | | @@ -327,32 +342,52 @@ describe('url-parse', function () { |
|  |  | it('extracts the right protocol from a url', function () { |
|  |  | var testData = [ |
|  |  | { |
|  |  | href: 'http://example.com', |
|  |  | href: 'http://example.com/', |
|  |  | protocol: 'http:', |
|  |  | pathname: '' |
|  |  | pathname: '/', |
|  |  | slashes: true |
|  |  | }, |
|  |  | { |
|  |  | href: 'ws://example.com/', |
|  |  | protocol: 'ws:', |
|  |  | pathname: '/', |
|  |  | slashes: true |
|  |  | }, |
|  |  | { |
|  |  | href: 'wss://example.com/', |
|  |  | protocol: 'wss:', |
|  |  | pathname: '/', |
|  |  | slashes: true |
|  |  | }, |
|  |  | { |
|  |  | href: 'mailto:test@example.com', |
|  |  | pathname: 'test@example.com', |
|  |  | protocol: 'mailto:' |
|  |  | protocol: 'mailto:', |
|  |  | slashes: false |
|  |  | }, |
|  |  | { |
|  |  | href: 'data:text/html,%3Ch1%3EHello%2C%20World!%3C%2Fh1%3E', |
|  |  | pathname: 'text/html,%3Ch1%3EHello%2C%20World!%3C%2Fh1%3E', |
|  |  | protocol: 'data:' |
|  |  | protocol: 'data:', |
|  |  | slashes: false, |
|  |  | }, |
|  |  | { |
|  |  | href: 'sip:alice@atlanta.com', |
|  |  | pathname: 'alice@atlanta.com', |
|  |  | protocol: 'sip:' |
|  |  | protocol: 'sip:', |
|  |  | slashes: false, |
|  |  | } |
|  |  | ]; |
|  |  |  |
|  |  | var data; |
|  |  | var data, test; |
|  |  | for (var i = 0, len = testData.length; i < len; ++i) { |
|  |  | data = parse(testData[i].href); |
|  |  | assume(data.protocol).equals(testData[i].protocol); |
|  |  | assume(data.pathname).equals(testData[i].pathname); |
|  |  | test = testData[i]; |
|  |  | data = parse(test.href); |
|  |  |  |
|  |  | assume(data.protocol).equals(test.protocol); |
|  |  | assume(data.pathname).equals(test.pathname); |
|  |  | assume(data.slashes).equals(test.slashes); |
|  |  | assume(data.href).equals(test.href); |
|  |  | } |
|  |  | }); |
|  |  |  |
| Expand Down  Expand Up | | @@ -391,13 +426,14 @@ describe('url-parse', function () { |
|  |  | }); |
|  |  |  |
|  |  | it('parses ipv6 with auth', function () { |
|  |  | var url = 'http://user:password@[3ffe:2a00:100:7031::1]:8080' |
|  |  | var url = 'http://user:password@[3ffe:2a00:100:7031::1]:8080/' |
|  |  | , parsed = parse(url); |
|  |  |  |
|  |  | assume(parsed.username).equals('user'); |
|  |  | assume(parsed.password).equals('password'); |
|  |  | assume(parsed.host).equals('[3ffe:2a00:100:7031::1]:8080'); |
|  |  | assume(parsed.hostname).equals('[3ffe:2a00:100:7031::1]'); |
|  |  | assume(parsed.pathname).equals('/'); |
|  |  | assume(parsed.href).equals(url); |
|  |  | }); |
|  |  |  |
| Expand Down  Expand Up | | @@ -467,7 +503,7 @@ describe('url-parse', function () { |
|  |  |  |
|  |  | assume(data.port).equals(''); |
|  |  | assume(data.host).equals('localhost'); |
|  |  | assume(data.href).equals('http://localhost'); |
|  |  | assume(data.href).equals('http://localhost/'); |
|  |  | }); |
|  |  |  |
|  |  | it('inherits port numbers for relative urls', function () { |
| Expand Down  Expand Up | | @@ -516,7 +552,8 @@ describe('url-parse', function () { |
|  |  | }); |
|  |  |  |
|  |  | it('inherits protocol for relative protocols', function () { |
|  |  | var data = parse('//foo.com/foo', parse('http://sub.example.com:808/')); |
|  |  | var lolcation = parse('http://sub.example.com:808/') |
|  |  | , data = parse('//foo.com/foo', lolcation); |
|  |  |  |
|  |  | assume(data.port).equals(''); |
|  |  | assume(data.host).equals('foo.com'); |
| Expand All | | @@ -529,13 +566,13 @@ describe('url-parse', function () { |
|  |  |  |
|  |  | assume(data.port).equals(''); |
|  |  | assume(data.host).equals('localhost'); |
|  |  | assume(data.href).equals('http://localhost'); |
|  |  | assume(data.href).equals('http://localhost/'); |
|  |  | }); |
|  |  |  |
|  |  | it('resolves pathname for relative urls', function () { |
|  |  | var data, i = 0; |
|  |  | var tests = [ |
|  |  | ['', 'http://foo.com', ''], |
|  |  | ['', 'http://foo.com', '/'], |
|  |  | ['', 'http://foo.com/', '/'], |
|  |  | ['', 'http://foo.com/a', '/a'], |
|  |  | ['a', 'http://foo.com', '/a'], |
| Expand Down  Expand Up | | @@ -722,12 +759,12 @@ describe('url-parse', function () { |
|  |  | data.set('hash', 'usage'); |
|  |  |  |
|  |  | assume(data.hash).equals('#usage'); |
|  |  | assume(data.href).equals('http://example.com#usage'); |
|  |  | assume(data.href).equals('http://example.com/#usage'); |
|  |  |  |
|  |  | data.set('hash', '#license'); |
|  |  |  |
|  |  | assume(data.hash).equals('#license'); |
|  |  | assume(data.href).equals('http://example.com#license'); |
|  |  | assume(data.href).equals('http://example.com/#license'); |
|  |  | }); |
|  |  |  |
|  |  | it('updates the port when updating host', function () { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d1e7e88`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funshiftio%2Furl-parse%2Fcommit%2Fd1e7e8822f26e8a49794b757123b51386325b2b0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


