=== Content from github.com_336e4ad4_20250115_113859.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-006.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-006.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=sickcodes%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sickcodes](/sickcodes)
/
**[security](/sickcodes/security)**
Public

* [Notifications](/login?return_to=%2Fsickcodes%2Fsecurity) You must be signed in to change notification settings
* [Fork
  18](/login?return_to=%2Fsickcodes%2Fsecurity)
* [Star
   86](/login?return_to=%2Fsickcodes%2Fsecurity)

* [Code](/sickcodes/security)
* [Issues
  1](/sickcodes/security/issues)
* [Pull requests
  0](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects
  0](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

Additional navigation options

* [Code](/sickcodes/security)
* [Issues](/sickcodes/security/issues)
* [Pull requests](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

## Files

¬†master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-006.md

Copy path Blame  Blame
## Latest commit

## History

[History](/sickcodes/security/commits/master/advisories/SICK-2021-006.md)162 lines (112 loc) ¬∑ 5.72 KB¬†master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-006.md

Top
## File metadata and controls

* Preview
* Code
* Blame

162 lines (112 loc) ¬∑ 5.72 KB[Raw](https://github.com/sickcodes/security/raw/refs/heads/master/advisories/SICK-2021-006.md)
### Title

Hestia Control Panel 1.4.0 and below - Subdomain Takeover - Improper Privilege Management

### CVE ID

CVE-2021-27231

### CVSS Score

5.4

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

### Internal ID

SICK-2021-006

### Vendor

Hestia Control Panel

### Product

Hestia Control Panel

### Product Versions:

HestiaCP Debian 9 v1.4.0 and below

HestiaCP Debian 10 v1.4.0 and below

HestiaCP Ubuntu 16.04 LTS v1.4.0 and below

HestiaCP Ubuntu 18.04 LTS v1.4.0 and below

HestiaCP Ubuntu 20.04 LTS v1.4.0 and below

### Vulnerability Details

A vulnerability in the Hestia Control Panel (HestiaCP) allows remote authenticated attackers on the same shared hosting environment to create domain aliases, or nginx vhosts, for subdomains that belong to other users. For example, an attacker on the same shared hosting service can perform subdomain takeover by creating an alias for a mail domain belonging to another user, resulting in all IMAP and POP requests going to the attacker's account.

### Vendor Response

Vendor patched.

### Proof of Concept/Exploit

```
BIND9 is not required.

user1 creates just a MAIL service
http://domain.com

user2 creates just a DOMAIN service (insufficient validation of root domain ownership)
http://test.domain.com

user2 can add vhost/alias:
http://domain.com
http://webmail.domain.com
http://mail.domain.com

Notably, user2 cannot add vhost/alias http://domain.com.

Results:

Stolen by user2
https://webmail.domain.com
We're working on it!
This site is currently under construction.
Please check back soon.
Domain: http://test.domain.com

Stolen by user2
https://mail.domain.com
We're working on it!
This site is currently under construction.
Please check back soon.
Domain: http://test.domain.com

user1's email account details are all stolen by user2
Username:
info@domain.com
Password:
IMAP Hostname:  http://mail.domain.com
SMTP Hostname:  http://mail.domain.com
Webmail Alias:  http://webmail.domain.com

- open webmail button in user1's email domain leads to user2's takeover.
- user2 can subsequently phish user1 at the webmail domain.
- user2 can steal credentials on next IMAP/POP request, e.g. mobile phone refresh emails.
- complete denial of service of user1's email accessibility
- complete email account takeover
- phishing the account for 1 stolen credential request, and then reverting the theft, will then allow user2 to access user1's emails.

DNS
@               ip.address
@www
            ip.address
@mail
           ip.address
@webmail
        ip.address
MX @            http://mail.domain.com

```

Original Issue by @ir\_kujoe <https://twitter.com/ir_kujoe>

```
# [BUG] Any user can create a subdomain for any domain using the HestiaCP DNS server even for other users. #1622

Describe the bug
Any user can create a subdomain for any domain on the server and create content using that domain. The Add Web Domain button does not validate whether or not the domain created is a subdomain for a domain already on the server. If user1 owns domain1.com and uses the nameservers for the HestiaCP server, user2 on the same server can create any subdomain for domain1.com and upload any content they want and act like they own the domain. As long as both users are on the same server and the domain is being managed by the same DNS server. This can be a problem for shared hosting environments. Additionally users can send e-mail from this subdomain which would appear legitimate for most e-mail clients since the SPF and DKIM records would be valid.

To Reproduce
What steps did you take when the issue occured?

    Point domain to the HestiaCP server using the nameservers.
    Add the TLD to one user using the Add Web Domain.
    Add a subdomain of the TLD to another user using the Add Web Domain and check "Create DNS Zone".
    View both domains in a browser.

Expected behavior
Throw an error if the user tries to add a subdomain using the Add Web Domain form if the TLD exists for another user (alternatively make a checkbox to enforce this or not).

NOTE: Please do not enforce this for command line and API calls since some shared hosts give out free subdomains. Enforcing this at a user level (i.e. the PHP form) would be a better option.

Operating system:
Ubuntu 20.04 LTS

Hestia Control Panel version:
v1.3.2

Additional context
DirectAdmin has added a checkbox to their settings for this, might be a better solution:
image
(Link to DA feature request for further info: https://www.directadmin.com/features.php?id=925)

For additional reference, here's an old thread from VestaCP with 2 possible solutions (mine being the worst of the 2):
https://forum.vestacp.com/viewtopic.php?f=13&t=9175

```

### Links

<https://sick.codes/sick-2021-006>

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-006.md>

[hestiacp/hestiacp#1622](https://github.com/hestiacp/hestiacp/issues/1622)

### Disclosure Timeline

* **2021-02-15** - Researchers discover vulnerability.
* **2021-02-15** - Vendor notified.
* **2021-02-16** - CVE assigned CVE-2021-27231.
* **2021-05-12** - Advisory published.

### Researchers

Sick Codes: <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

KuJoe: <https://github.com/KuJoe> || <https://twitter.com/ir_kujoe>

### CVE Links

<https://sick.codes/sick-2021-006>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27231>

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-27231>

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.hestiacp.com_7c67ad90_20250114_190810.html ===

 [Skip to content](#VPContent) [![](/logo.svg)Hestia Control Panel](/)Search`K`Main Navigation[Features](/features.html)[Install](/install.html)[Documentation](/docs/introduction/getting-started.html)[Team](/team.html)[Demo](https://demo.hestiacp.com:8083/)[Forum](https://forum.hestiacp.com/)[Donate](/donate.html)v1.8.12[Changelog](https://github.com/hestiacp/hestiacp/blob/main/CHANGELOG.md)[Contributing](https://github.com/hestiacp/hestiacp/blob/main/CONTRIBUTING.md)[Security policy](https://github.com/hestiacp/hestiacp/blob/main/SECURITY.md)[GitHub](https://github.com/hestiacp/hestiacp)[Twitter](https://twitter.com/HestiaPanel)[Facebook](https://www.facebook.com/hestiacp)

Appearance

[GitHub](https://github.com/hestiacp/hestiacp)[Twitter](https://twitter.com/HestiaPanel)[Facebook](https://www.facebook.com/hestiacp)
# Hestia Control Panel

Open-source web server control panel

Fast, reliable, open-source. The control panel you‚Äôve always wanted is just a command away.

[Get started](/docs/introduction/getting-started.html)[Try the demo](https://demo.hestiacp.com:8083/)[View on GitHub](https://github.com/hestiacp/hestiacp)![Hestia Logo](/logo.svg)[üöÄ
## Fast & easy to learn

Hestia is made with ease of use in mind. Creating a user or a website is as easy as clicking a button and filling out a couple of fields, while advanced features are easily accessible.

Documentation](/docs/introduction/getting-started.html)[‚ù§Ô∏è
## Made with love & pride

Hestia is open-source software that is built by passionate people from around the world. This means that the code is reviewed by multiple people and that anybody can contribute to it!

See the team](/team.html)[üõ†Ô∏è
## Extendable & powerful

Hestia is extendable while being easy to learn. You can build your own themes, web templates, quick install applications and can interact with it using third party software via its API.

Help develop Hestia](/docs/contributing/development.html)[ü§ù
## Supported by the community

Hestia has a great support community - join the forum! To keep the project running, we rely on donations, which can be made via PayPal or cryptocurrency.

Donate](/donate.html)

Released under the GPLv3 License.

Copyright ¬© 2019-present Hestia Control Panel



=== Content from sick.codes_3ef8c8cd_20250115_113900.html ===


* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

No Result
 View All Result

[![Sick Codes - Security Research, Hardware & Software Hacking, Consulting, Linux, IoT, Cloud, Embedded, Arch, Tweaks & Tips!](https://sick.codes/wp-content/uploads/2016/10/logo.png)](https://sick.codes/)

No Result
 View All Result

[Home](https://sick.codes)
[Security](https://sick.codes/category/security/)

# CVE-2021-27231 ‚Äì Hestia Control Panel 1.4.0 and below ‚Äì Subdomain Takeover ‚Äì Improper Privilege Management

by
[Sick Codes](https://sick.codes/author/admin/)
[May 12, 2021](https://sick.codes/sick-2021-006/)

in
[Security](https://sick.codes/category/security/)

 [2](https://sick.codes/sick-2021-006/#comments)

### Title

Hestia Control Panel 1.4.0 and below ‚Äì Subdomain Takeover ‚Äì Improper Privilege Management

### CVE ID

CVE-2021-27231

### CVSS Score

5.4

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N

### Internal ID

SICK-2021-006

### Vendor

Hestia Control Panel

### Product

Hestia Control Panel

### Product Versions:

HestiaCP Debian 9 v1.4.0 and below

HestiaCP Debian 10 v1.4.0 and below

HestiaCP Ubuntu 16.04 LTS v1.4.0 and below

HestiaCP Ubuntu 18.04 LTS v1.4.0 and below

HestiaCP Ubuntu 20.04 LTS v1.4.0 and below

### Vulnerability Details

A vulnerability in the Hestia Control Panel (HestiaCP) allows remote authenticated attackers on the same shared hosting environment to create domain aliases, or nginx vhosts, for subdomains that belong to other users. For example, an attacker on the same shared hosting service can perform subdomain takeover by creating an alias for a mail domain belonging to another user, resulting in all IMAP and POP requests going to the attacker‚Äôs account.

### Vendor Response

Vendor patched.

### Proof of Concept/Exploit

```
BIND9 is not required.

user1 creates just a MAIL service
http://domain.com

user2 creates just a DOMAIN service (insufficient validation of root domain ownership)
http://test.domain.com

user2 can add vhost/alias:
http://domain.com
http://webmail.domain.com
http://mail.domain.com

Notably, user2 cannot add vhost/alias http://domain.com.

Results:

Stolen by user2
https://webmail.domain.com
We're working on it!
This site is currently under construction.
Please check back soon.
Domain: http://test.domain.com

Stolen by user2
https://mail.domain.com
We're working on it!
This site is currently under construction.
Please check back soon.
Domain: http://test.domain.com

user1's email account details are all stolen by user2
Username:
info@domain.com
Password:
IMAP Hostname:  http://mail.domain.com
SMTP Hostname:  http://mail.domain.com
Webmail Alias:  http://webmail.domain.com

- open webmail button in user1's email domain leads to user2's takeover.
- user2 can subsequently phish user1 at the webmail domain.
- user2 can steal credentials on next IMAP/POP request, e.g. mobile phone refresh emails.
- complete denial of service of user1's email accessibility
- complete email account takeover
- phishing the account for 1 stolen credential request, and then reverting the theft, will then allow user2 to access user1's emails.

DNS
@               ip.address
@www
            ip.address
@mail
           ip.address
@webmail
        ip.address
MX @            http://mail.domain.com
```

Original Issue by @ir\_kujoe https://twitter.com/ir\_kujoe

```
# [BUG] Any user can create a subdomain for any domain using the HestiaCP DNS server even for other users. #1622

Describe the bug
Any user can create a subdomain for any domain on the server and create content using that domain. The Add Web Domain button does not validate whether or not the domain created is a subdomain for a domain already on the server. If user1 owns domain1.com and uses the nameservers for the HestiaCP server, user2 on the same server can create any subdomain for domain1.com and upload any content they want and act like they own the domain. As long as both users are on the same server and the domain is being managed by the same DNS server. This can be a problem for shared hosting environments. Additionally users can send e-mail from this subdomain which would appear legitimate for most e-mail clients since the SPF and DKIM records would be valid.

To Reproduce
What steps did you take when the issue occured?

    Point domain to the HestiaCP server using the nameservers.
    Add the TLD to one user using the Add Web Domain.
    Add a subdomain of the TLD to another user using the Add Web Domain and check "Create DNS Zone".
    View both domains in a browser.

Expected behavior
Throw an error if the user tries to add a subdomain using the Add Web Domain form if the TLD exists for another user (alternatively make a checkbox to enforce this or not).

NOTE: Please do not enforce this for command line and API calls since some shared hosts give out free subdomains. Enforcing this at a user level (i.e. the PHP form) would be a better option.

Operating system:
Ubuntu 20.04 LTS

Hestia Control Panel version:
v1.3.2

Additional context
DirectAdmin has added a checkbox to their settings for this, might be a better solution:
image
(Link to DA feature request for further info: https://www.directadmin.com/features.php?id=925)

For additional reference, here's an old thread from VestaCP with 2 possible solutions (mine being the worst of the 2):
https://forum.vestacp.com/viewtopic.php?f=13&t=9175
```
### Links

<https://sick.codes/sick-2021-006>

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-006.md>

<https://github.com/hestiacp/hestiacp/issues/1622>

### Disclosure Timeline

* **2021-02-15** ‚Äì Researchers discover vulnerability.
* **2021-02-15** ‚Äì Vendor notified.
* **2021-02-16** ‚Äì CVE assigned CVE-2021-27231.
* **2021-05-12** ‚Äì Advisory published.

### Researchers

Sick Codes: <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

KuJoe: <https://github.com/KuJoe> || <https://twitter.com/ir_kujoe>

### CVE Links

<https://sick.codes/sick-2021-006>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27231>

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-27231>

Next Post
[![SAP Business One Hana Chef Cookbook Vulnerability](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2021-026/)
### [CVE-2021-27613 - SAP Business One Hana (Chef Cookbook) - Insecure Temporary File For Incoming & Outgoing Payroll Data - SAP Business One Chef Cookbook.](https://sick.codes/sick-2021-026/)

[![SAP Business One Hana Chef Cookbook Vulnerability](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2021-028/)
### [CVE-2021-27614 - SAP Business One Hana (Chef Cookbook) - Incorrect Permission Assignment for Critical Resources - Root Privilege Escalation Vulnerability](https://sick.codes/sick-2021-028/)

[![SAP Business One Hana Chef Cookbook Vulnerability](https://sick.codes/wp-content/themes/jnews/assets/img/jeg-empty.png)](https://sick.codes/sick-2021-029/)
### [CVE-2021-27616 - SAP Business One Hana (Chef Cookbook) - Exposure of Backup File to an Unauthorized Control Sphere via Insecure Temporary File Storage.](https://sick.codes/sick-2021-029/)

### Comments 2

1. Pingback: [Vulnerabilidad en Control Panel (Hestiacp) - CVE-2021-27231 - Informaci√≥n y Soluciones](https://vulnerability.app/hestiacp/cve-2021-27231-control-panel-hestiacp/)
3. Rosmary Molina says:

   [4 years ago](https://sick.codes/sick-2021-006/#comment-41667)

   That was something I and a few others need to know. Both my phone‚Äôs have been completely taken over and I let Gmail and still I get nowhere. Both phones are about a week old. I‚Äôm glad I‚Äôve been doing my research and thank you very much for the help and information. Please continue to do what you do best. My love Rosemary Molina

   [Reply](#comment-41667)

### Leave a Reply [Cancel reply](/sick-2021-006/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name

Email

Website

No Result
 View All Result

* [Home](https://sick.codes/)
* [Releases](https://sick.codes/category/security/)
* [Submit Vuln](https://sick.codes/submit-vulnerability/)
* [Press](https://sick.codes/press-coverage/)
* [About](https://sick.codes/about/)
* [PGP](https://sick.codes/pgp-key/)
* [Contact](https://sick.codes/contact/)
  + [Contact](https://sick.codes/contact/)
  + [Submit Vuln](https://sick.codes/submit-vulnerability/)
  + [VDP](https://sick.codes/vdp/)
* [Tutorials](https://sick.codes/tutorials/)
  + [All Posts](https://sick.codes/tutorials/)
  + [Photoshop on Linux](https://sick.codes/how-to-install-100-working-photoshop-cs6-or-cc-on-ubuntu-debian-mint/)
  + [macOS on Linux](https://sick.codes/how-to-install-macos-virtual-machine-on-linux-arch-manjaro-catalina-mojave-or-high-sierra-xcode-working/)
* [Supporters](https://sick.codes/supporters/)
* [Projects](https://sick.codes/projects/)
* [Training](https://sick.codes/training/)

¬© 2017-2021 [Sick.Codes](/ "Sick Codes")

#### [@sickcodes](https://github.com/sickcodes)

#### [@sickcodes](https://twitter.com/sickcodes)

#### [@sickcodes](https://www.linkedin.com/in/sickcodes)

#### [Discord Server](https://discord.com/invite/mx8pPw39Yg)

#### [sickcodes.slack.com](https://join.slack.com/t/sickcodes/shared_invite/zt-tsi4f7gy-wkh46eeQVUMq5j3Naf7RrA)

#### [t.me/sickcodeschat](https://t.me/sickcodeschat)

#### [./contact\_form](https://sick.codes/contact)



=== Content from github.com_45548a3a_20250114_190809.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhestiacp%2Fhestiacp%2Fissues%2F1622)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhestiacp%2Fhestiacp%2Fissues%2F1622)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=hestiacp%2Fhestiacp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hestiacp](/hestiacp)
/
**[hestiacp](/hestiacp/hestiacp)**
Public

* [Notifications](/login?return_to=%2Fhestiacp%2Fhestiacp) You must be signed in to change notification settings
* [Fork
  693](/login?return_to=%2Fhestiacp%2Fhestiacp)
* [Star
   3.5k](/login?return_to=%2Fhestiacp%2Fhestiacp)

* [Code](/hestiacp/hestiacp)
* [Issues
  210](/hestiacp/hestiacp/issues)
* [Pull requests
  18](/hestiacp/hestiacp/pulls)
* [Actions](/hestiacp/hestiacp/actions)
* [Projects
  0](/hestiacp/hestiacp/projects)
* [Security](/hestiacp/hestiacp/security)
* [Insights](/hestiacp/hestiacp/pulse)

Additional navigation options

* [Code](/hestiacp/hestiacp)
* [Issues](/hestiacp/hestiacp/issues)
* [Pull requests](/hestiacp/hestiacp/pulls)
* [Actions](/hestiacp/hestiacp/actions)
* [Projects](/hestiacp/hestiacp/projects)
* [Security](/hestiacp/hestiacp/security)
* [Insights](/hestiacp/hestiacp/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fhestiacp%2Fhestiacp%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fhestiacp%2Fhestiacp%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [BUG] Any user can create a subdomain for any domain using the HestiaCP DNS server even for other users. #1622

Closed

[KuJoe](/KuJoe) opened this issue
Feb 15, 2021
¬∑ 5 comments

Closed

# [[BUG] Any user can create a subdomain for any domain using the HestiaCP DNS server even for other users.](#top) #1622

[KuJoe](/KuJoe) opened this issue
Feb 15, 2021
¬∑ 5 comments

Labels
[bug](/hestiacp/hestiacp/labels/bug)
Something isn't working
[security](/hestiacp/hestiacp/labels/security)
Issues related to security components

## Comments

[![@KuJoe](https://avatars.githubusercontent.com/u/1040086?s=80&u=aee4b1cab93ea4525d01c88a4638731d9c1e7207&v=4)](/KuJoe)

Copy link

### **[KuJoe](/KuJoe)** commented [Feb 15, 2021](#issue-808104591) ‚Ä¢ edited Loading

| **Describe the bug** Any user can create a subdomain for any domain on the server and create content using that domain. The Add Web Domain button does not validate whether or not the domain created is a subdomain for a domain already on the server. If user1 owns domain1.com and uses the nameservers for the HestiaCP server, user2 on the same server can create any subdomain for domain1.com and upload any content they want and act like they own the domain. As long as both users are on the same server and the domain is being managed by the same DNS server. This can be a problem for shared hosting environments. Additionally users can send e-mail from this subdomain which would appear legitimate for most e-mail clients since the SPF and DKIM records would be valid.  **To Reproduce** What steps did you take when the issue occured?   1. Point domain to the HestiaCP server using the nameservers. 2. Add the TLD to one user using the Add Web Domain. 3. Add a subdomain of the TLD to another user using the Add Web Domain and check "Create DNS Zone". 4. View both domains in a browser.   **Expected behavior** Throw an error if the user tries to add a subdomain using the Add Web Domain form if the TLD exists for another user (alternatively make a checkbox to enforce this or not).  NOTE: Please do not enforce this for command line and API calls since some shared hosts give out free subdomains. Enforcing this at a user level (i.e. the PHP form) would be a better option.  **Operating system:** Ubuntu 20.04 LTS  **Hestia Control Panel version:** v1.3.2  **Additional context** DirectAdmin has added a checkbox to their settings for this, might be a better solution: [image](https://user-images.githubusercontent.com/1040086/107896560-9da01b00-6f04-11eb-8723-fdfbf6e6f27c.png) (Link to DA feature request for further info: <https://www.directadmin.com/features.php?id=925>)  For additional reference, here's an old thread from VestaCP with 2 possible solutions (mine being the worst of the 2): <https://forum.vestacp.com/viewtopic.php?f=13&t=9175> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@sickcodes](https://avatars.githubusercontent.com/u/65906298?s=80&u=7b8ae9f1fb347ca4f74404d0b379b9779fad3419&v=4)](/sickcodes)

Copy link

### **[sickcodes](/sickcodes)** commented [Feb 15, 2021](#issuecomment-779124980)

| Validated all of the above with KuJoe. We have quite a few more concerns specific to Hestia, can someone at HestiaCP reach out privately? <https://twitter.com/sickcodes> |
| --- |

All reactions

Sorry, something went wrong.

[![@ScIT-Raphael](https://avatars.githubusercontent.com/u/13765400?s=80&u=8275ea111f16a070471760de4cb10f925f7fa276&v=4)](/ScIT-Raphael)

Copy link

Member

### **[ScIT-Raphael](/ScIT-Raphael)** commented [Feb 15, 2021](#issuecomment-779125601)

| [@sickcodes](https://github.com/sickcodes) please contact us under info@hestiacp.com. |
| --- |

 üëç
2
 sickcodes and Fameing reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@jaapmarcus](https://avatars.githubusercontent.com/u/9754650?s=40&u=3501043adb418c67fcdb80eaa134b82d91391d95&v=4)](/jaapmarcus)
[jaapmarcus](/jaapmarcus)
added
[bug](/hestiacp/hestiacp/labels/bug)
Something isn't working
[security](/hestiacp/hestiacp/labels/security)
Issues related to security components
labels
[Feb 15, 2021](#event-4331352695)

[![@jaapmarcus](https://avatars.githubusercontent.com/u/9754650?s=80&u=3501043adb418c67fcdb80eaa134b82d91391d95&v=4)](/jaapmarcus)

Copy link

Member

### **[jaapmarcus](/jaapmarcus)** commented [Feb 28, 2021](#issuecomment-787417717) ‚Ä¢ edited Loading

| We have fixed the issue in [#1642](https://github.com/hestiacp/hestiacp/pull/1642)  The suggested solve in your PHP script did't work as it allowed adding subdomains under different users via api. 2nd option used an outdated list and wasn't perfect.  Used the "offical" list from <https://github.com/publicsuffix/list/blob/master/public_suffix_list.dat>  We will update it every Hestia update to the last version. To change v-add-web-domain-allow-users / v-delete-web-domain-allow-users will to allow / disable the security check. For that domain only. To be used for developers / Or any other reason you might...  We will ship the fix together with 1.4.0 after beta testing. |
| --- |

All reactions

Sorry, something went wrong.

[![@ScIT-Raphael](https://avatars.githubusercontent.com/u/13765400?s=40&u=8275ea111f16a070471760de4cb10f925f7fa276&v=4)](/ScIT-Raphael)
[ScIT-Raphael](/ScIT-Raphael)
closed this as [completed](/hestiacp/hestiacp/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 28, 2021](#event-4385908678)

[![@sickcodes](https://avatars.githubusercontent.com/u/65906298?s=80&u=7b8ae9f1fb347ca4f74404d0b379b9779fad3419&v=4)](/sickcodes)

Copy link

### **[sickcodes](/sickcodes)** commented [Mar 2, 2021](#issuecomment-788776082)

| Good idea implanting the fix as optional feature as obviously not all end users need the security enhancements, mainly only those involved with sub-hosting or sub-usership.  I'll do some testing shortly myself and we'll publish the findings :) great work team! |
| --- |

 üëç
1
 Lupul reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@sickcodes](https://avatars.githubusercontent.com/u/65906298?s=80&u=7b8ae9f1fb347ca4f74404d0b379b9779fad3419&v=4)](/sickcodes)

Copy link

### **[sickcodes](/sickcodes)** commented [May 12, 2021](#issuecomment-839881177) ‚Ä¢ edited Loading

| Update:  This issue was assigned [CVE-2021-27231](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27231) and was fixed in 1.4.0 Advisory:  <https://sick.codes/sick-2021-006>  <https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-006.md> |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fhestiacp%2Fhestiacp%2Fissues%2F1622)

Assignees

No one assigned

Labels

[bug](/hestiacp/hestiacp/labels/bug)
Something isn't working
[security](/hestiacp/hestiacp/labels/security)
Issues related to security components

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@KuJoe](https://avatars.githubusercontent.com/u/1040086?s=52&v=4)](/KuJoe) [![@jaapmarcus](https://avatars.githubusercontent.com/u/9754650?s=52&v=4)](/jaapmarcus) [![@ScIT-Raphael](https://avatars.githubusercontent.com/u/13765400?s=52&v=4)](/ScIT-Raphael) [![@sickcodes](https://avatars.githubusercontent.com/u/65906298?s=52&v=4)](/sickcodes)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


