=== Content from seclists.org_cf633324_20250115_080957.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](31)
[By Date](date.html#32)
[![Next](/images/right-icon-16x16.png)](33)

[![Previous](/images/left-icon-16x16.png)](31)
[By Thread](index.html#32)
[![Next](/images/right-icon-16x16.png)](33)

![](/shared/images/nst-icons.svg#search)

# [KIS-2021-03] ExpressionEngine <= 6.0.2 (Translate::save) PHP Code Injection Vulnerability

---

*From*: research () karmainsecurity com

*Date*: Mon, 15 Mar 2021 20:13:46 +0100

---

```

----------------------------------------------------------------------------

```
ExpressionEngine <= 6.0.2 (Translate::save) PHP Code Injection
Vulnerability
```

----------------------------------------------------------------------------

[-] Software Link:

<https://expressionengine.com/>

[-] Affected Versions:

Version 6.0.2 and prior versions.
Version 5.4.1 and prior versions.

[-] Vulnerability Description:

```
The vulnerable code is located in the
"ExpressionEngine\Controller\Utilities\Translate::save()" method:
```

362.        private function save($language, $file)
363.        {
364.
365.            $file = ee()->security->sanitize_filename($file);
366.
367.            $dest_dir = $this->languages_dir . $language . '/';
368.            $filename = $file . '_lang.php';
369.            $dest_loc = $dest_dir . $filename;
370.
371.            $str = '<?php' . "\n" . '$lang = array(' . "\n\n\n";
372.
373.            ee()->lang->loadfile($file);
374.
375.            foreach ($_POST as $key => $val) {
376.                $val = str_replace('<script', '', $val);
377.                $val = str_replace('<iframe', '', $val);

```
378. $val = str\_replace(array("\\", "'"), array("\\\\",
"\'"), $val);
```

379.

```
380. $str .= '\'' . $key . '\' => ' . "\n" . '\'' . $val
. '\'' . ",\n\n";
```

381.            }
382.
383.            $str .= "''=>''\n);\n\n";
384.            $str .= "// End of File";

[...]

400.            $this->load->helper('file');
401.
402.            if (write_file($dest_loc, $str)) {
403.                ee('CP/Alert')->makeInline('shared-form')
404.                    ->asSuccess()
405.                    ->withTitle(lang('translations_saved'))

```
406. ->addToBody(sprintf(lang('file\_saved'),
$dest\_loc))
```

407.                    ->defer();

```
User input passed via keys of POST parameters is not properly sanitized
before being assigned
to the "$str" variable at line 380. Such a variable will be used in a
call to the "write\_file()"
```

function at line 402, trying to write user supplied content into the

```
/system/user/language/[lang]/[file]\_lang.php file. This can be exploited
to inject and execute arbitrary PHP code. Successful exploitation of
this vulnerability requires an account with
```

permissions to access the CP translation system utilities.

[-] Solution:

Upgrade to version 6.0.3, 5.4.2, or later.

[-] Disclosure Timeline:

[03/02/2021] - Vendor notified through HackerOne
[15/02/2021] - Vulnerability acknowledged by the vendor
[16/02/2021] - CVE number assigned
[17/02/2021] - Version 6.0.3 released
[04/03/2021] - Version 5.4.2 released
[15/03/2021] - Public disclosure

[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has assigned the name CVE-2021-27230 to this vulnerability.

[-] Credits:

Vulnerability discovered by Egidio Romano.

[-] Other References:

<https://hackerone.com/reports/1093444>

[-] Original Advisory:

<http://karmainsecurity.com/KIS-2021-03>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](31)
[By Date](date.html#32)
[![Next](/images/right-icon-16x16.png)](33)

[![Previous](/images/left-icon-16x16.png)](31)
[By Thread](index.html#32)
[![Next](/images/right-icon-16x16.png)](33)

### Current thread:

* **[KIS-2021-03] ExpressionEngine <= 6.0.2 (Translate::save) PHP Code Injection Vulnerability** *research (Mar 15)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_1b000104_20250115_080956.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from expressionengine.com_1a386c19_20250115_080959.html ===


We use cookies to improve your experience. No personal information is gathered and we don't serve ads. [Cookies Policy.](https://expressionengine.com/about/cookie-policy)

Got It!

[![ExpressionEngine Logo](/assets/images/ee-logo-dark.svg)](/)
[ExpressionEngine](/)
[Features](https://expressionengine.com/features)
[Pricing](https://expressionengine.com/store/purchase-pro)
[Support](https://expressionengine.com/support)
Find A Developer
[Partners](https://expressionengine.com/partners)
[Upgrades](https://expressionengine.com/upgrades)

[Blog](https://expressionengine.com/blog)
[Add-Ons](https://expressionengine.com/add-ons)
Learn
[Docs](https://docs.expressionengine.com/latest/)
[Forums](https://expressionengine.com/forums)
[University](https://u.expressionengine.com)

![Log In or Sign Up](/assets/images/grav-fallback.png)
[Log In](https://expressionengine.com/login)
[Sign Up](https://expressionengine.com/login#sign-up)

[![ExpressionEngine Logo](/assets/images/ee-logo-white.svg)](https://expressionengine.com/home)
[Features](https://expressionengine.com/features)
[Pro new](https://expressionengine.com/pro)
[Support](https://expressionengine.com/support)
Find A Developer
[Partners](https://expressionengine.com/partners)
[Upgrades](https://expressionengine.com/upgrades)

[Blog](https://expressionengine.com/blog)
[Add-Ons](https://expressionengine.com/add-ons)
Learn
[Docs](https://docs.expressionengine.com/latest/)
[Forums](https://expressionengine.com/forums)
[University](https://u.expressionengine.com)
[Blog](https://expressionengine.com/blog)

![Multi site manager illustration](https://expressionengine.com/asset/img/EE6-new-site/illustration-hero-features.svg)

FEATURES

## Your website. Your content. Your way.

Your design. Your markup. Your architecture. EE never interferes with your code or your vision.

[Free Download](https://expressionengine.com/?ACT=243)

[Explore the Features](#features)

CHANNELS

## Organize your content into flexible channels.

In ExpressionEngine, your site content is stored in channels—flexible data containers with fields for any type of information. Create channels for blogs, news, team bios, product or service descriptions, document downloads, you name it! Once your information is in a channel, it can be served anywhere on your site.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-channels.png)

FRONT-END EDITING

## Edit your content. No control panel needed.

ExpressionEngine makes managing your site's content as streamlined as possible. See something you want to change? Enter edit mode and start making your updates directly on the front end. It’s as simple as that.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-front-edit%402x.png)

THE DOCK

## Complete control of your front-end editing experience.

The Dock in ExpressionEngine is your front-end command center. It lets you jump into Edit mode to access all of your site's content, as well as other features to fine tune your site's functionality.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-dock.png)

TEMPLATES

## Your own code powered by ExpressionEngine tags.

In ExpressionEngine, a page (or a page component such as a header or footer) is called a Template. A Template may contain ANYTHING that a webpage might contain: HTML, JavaScript, PHP, whatever. Templates also usually contain ExpressionEngine Tags. These Tags are incredibly easy to learn, and they give you the power to create amazing, dynamic experiences.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-templates.png)

CUSTOM FIELDTYPES

## Pick the perfect fields to capture your content.

With over 20 different field types, no matter what you dream or design it's safe to say you can build it with ExpressionEngine.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-fieldtypes%402x.png)

ENTRY CLONING

## Clone any channel entry with a single click!

Save time with entry cloning. ExpressionEngine has the ability to easily clone entries, allowing for faster and more efficient entry creation.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/features/graphic-entry-cloning%402x.png)

ADD-ON PROLETS

## Bringing the power of add-ons to the front end.

Prolets in ExpressionEngine allow you to access the essence of add-ons that are crucial to your site's operation, all while browsing the front end of your site.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-prolets%402x.png)

USER MANAGEMENT

## Easily manage different types of members.

ExpressionEngine's incredible member management features let you build fantastic user experiences.

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-members%402x.png)

MULTIPLE SITES

## Manage multiple sites from a single control panel.

From a single ExpressionEngine installation you can manage all of your websites. Each website can be 100% unique, or you can share design, content, and members across your sites. How freaking cool is that?!

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-multiple-sites%402x.png)

LIVE PREVIEW

## Preview your content before you commit.

For content editors, Live Preview displays your content as you type, shown in your site's design. No guesswork. No reloading pages. Just create!

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-live-preview%402x.png)

FORUMS

## Build your own online community.

ExpressionEngine comes with a full-featured discussion forum module so you can keep the conversation going!

[Free Download](https://expressionengine.com/?ACT=243)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-forums%402x.png)

ADD-ONS

## Extend ExpressionEngine’s capabilities.

ExpressionEngine has a large community of developers making add-ons that extend system capabilities. With ExpressionEngine add-ons, no matter the task, you'll have a solution.

[Browse Add-Ons](https://expressionengine.com/add-ons)

![](https://expressionengine.com/asset/img/EE6-new-site/graphic-add-ons%402x.png)

SECURITY

## A proven track record of rock-solid security.

To say we're obsessed with security is an understatement. ExpressionEngine has never had a serious security issue in its 15-year history.

[Free Download](https://expressionengine.com/?ACT=243)

PRIVACY & CONSENT

## Implement cookie consent, GDPR compliance, and more.

ExpressionEngine has a robust set of consent and privacy tools that make it easy to implement cookie consent, GDPR compliance, and more!

[Free Download](https://expressionengine.com/?ACT=243)

And so much more…

#### One-Click Updates

Updating most CMSs can be a scary chore; taking your site offline, uploading files, changing configurations, and crossing your fingers. With ExpressionEngine a site update is one click, and seconds away. You won’t even have time to grab a cup of coffee.

#### Jump Menu

The Jump menu lets you navigate ExpressionEngine at lightning speed with a single shortcut. Go to any page, any setting, find or create entries in a specific channel, or set your color theme in a matter of keystrokes.

#### File Manager

Browse your files with the new, beautiful thumbnail view, then edit and preview a file’s information with one click.

#### Fluid Fields

A Fluid field is a collection of fields. The fields assigned to the Fluid field can then be used multiple times in the same entry when creating/editing the entry. The author also has control over the order of the fields.

#### Relationships

Relationships are an extremely powerful tool that allow you to connect entries in one Channel to those in another one, or even to other entries in the same Channel.

#### Categories

Categorize entries to your heart’s content. Each entry can be assigned to multiple categories, and you can create as many unique category groups as you want. Categories can also have images or other data tied to them.

#### Member Roles

Advanced permissions couldn’t be more simple. Instead of a single member group, each member can now be assigned to multiple member roles.

#### Template Caching

Both templates and embeds can be cached, producing an extremely fast rendering time.

#### Publish Layouts

Allows you to create unique layouts for each channel, including which fields are shown or hidden. You can even add tabs to the publish layout to bring field organization to another level.

#### Grid Fields

Provides a way to group fieldtypes in repeatable rows. This is useful for when you need to group a subset of data in your channel entry form that may or may not have a varying number of rows.

#### Rich Text Editing

The Rich Text Editor is like a word processor that allows you to create richly-formatted content without writing any HTML.

#### Template Partials

Template partials add flexibility and reusability, while making it simple to make site-wide changes by editing the Template partial’s source instead of having to modify many templates.

#### Send Emails

ExpressionEngine’s built in email system allows you to easily send emails via PHPMail, Sendmail, and SMTP, making it easy to hook up to many third party email service providers.

#### Command Line Interface

The Command Line Interface (CLI) makes the creating of add-ons, migrations, models, and prolets a matter of seconds, getting developers to the heart of their work faster.

#### Translations

Language packs provide localized versions of the control panel for many languages!

#### Database Backups

The Database Backup Utility allows you to make simple SQL dump backups of your ExpressionEngine database quick and easily.

#### SEO Friendly

ExpressionEngine’s structured content approach makes managing SEO an easy undertaking.

#### Entry Versioning

The Entry versioning feature lets you save previous revisions of your channel entries, so you never lose any edits you make.

#### Image Modifiers

Image modifiers make it easy to resize, crop, rotate, and even convert image formats right in your templates!

#### Duration Fieldtype

Duration is a fieldtype that allows you to store lengths of time. For instance, time results for races, running times of feature films, etc.

#### SQL Query Form

This section presents a form that you can use to submit any standard database query.

#### Data Search and Replace

Allows you to search for text within your site and replace it with another piece of text.

#### Template Exporting

Quickly and simply export a zip of your templates. Great to use as a starting point on sites, or as a quick backup.

#### Search

Powerful search module with simple and advanced search capability. You can search within channels, comments, members, and categories.

#### Search Term Log

The Search Term Logging feature lets you keep track of any search terms your site visitors use.

#### Access Throttling

Permits you to limit the number of page requests by a single IP address within a given time interval.

#### Control Panel Access Logs

Allows you to view access logs for your Control Panel. The system tracks all logins, logouts, and various other actions.

#### Query Module

The Query Module allows you to perform SQL queries, returning results from your database without having to use PHP all without leaving your templates.

#### HTTP Header

The HTTP Header plugin allows you to set HTTP headers in your templates.

#### RSS Parser

The RSS Parser plugin provides RSS parsing tags for your templates. It uses SimplePie to parse and render any RSS or Atom feed you throw at it.

#### Requests

Gives you access to GET, POST, cookie, ip\_address, user\_agent and request\_headers in templates.

#### Captcha

The built in CAPTCHA system allows you to use reCaptcha v3, or our native CAPTCHA system.

#### New Relic

ExpressionEngine supports deep application monitoring with New Relic out of the box. When New Relic is deployed on your server, you will instantly have visibility into performance metrics.

#### File Upload Manipulations

Allows you to add predefined manipulations to take place on files when they're initially uploaded. Great for creating thumbnails, or optimized images.

[Free Download](https://expressionengine.com/?ACT=243)

[View Changelog](https://docs.expressionengine.com/latest/installation/changelog.html)

Education

## Learn ExpressionEngine from the best.

Carefully collected, created, and discussed.

#### Documentation

Looking to better understand the big picture, or for a reference on specific features? The docs have you covered!

[View the Docs](https://docs.expressionengine.com/latest/)

#### Forums

The forum is a great place to ask questions, *answer questions,* and learn from the community at large!

[Visit the Forums](https://expressionengine.com/forums)

#### University

ExpressionEngine University is the source of learning for all things ExpressionEngine!

[Browse the Articles](https://u.expressionengine.com/)

![illustration cta download](https://expressionengine.com/asset/img/EE6-new-site/illustration-cta-download.svg)

## ExpressionEngine. Build something amazing!

Combining a thriving developer community with best-in-class support, ExpressionEngine is mission control for your website’s content.

[Free Download](https://expressionengine.com/?ACT=243)

[View Changelog](https://docs.expressionengine.com/latest/installation/changelog.html)

#### Installation

Ready to go? Follow our [simple installation instructions](https://docs.expressionengine.com/latest/installation/installation.html) to get up and running with ExpressionEngine in only a few minutes.

#### Getting Started

New to ExpressionEngine? [Watch the 10 Minute Primer](https://u.expressionengine.com/article/10-minute-expressionengine-primer)to learn how ExpressionEngine works and how to build a simple website.

#### Join the Community!

ExpressionEngine is more than just a CMS, it's a community. Join us by [contributing to the project in GitHub](https://github.com/ExpressionEngine/ExpressionEngine/blob/stability/CONTRIBUTING.md) or [joining the conversation on Slack.](https://expressionengine.com/blog/join-us-in-slack#join-us-on-slack)

ExpressionEngine
[Home](/)
[Features](https://expressionengine.com/features)
[Pro](/pro)
[Contact](/cdn-cgi/l/email-protection#c8bbbdb8b8a7babc88adb0b8baadbbbba1a7a6ada6afa1a6ade6aba7a5)
[Version Support](/support/version-support)

Learn
[Docs](https://docs.expressionengine.com/latest/)
[University](https://u.expressionengine.com)
[Forums](https://expressionengine.com/forums)

Resources
[Support](https://expressionengine.com/support)
[Add-Ons](https://expressionengine.com/add-ons)
[Partners](https://expressionengine.com/partners)
[Blog](https://expressionengine.com/blog)

Subscribe to ExpressionEngine News!

Subscribe

[Privacy](https://expressionengine.com/about/privacy-policy)
[Terms](https://expressionengine.com/about/terms-of-service)
[Trademark Use](https://expressionengine.com/about/trademark-use-policy)
[License](https://expressionengine.com/license)

Packet Tide owns and develops ExpressionEngine. © [Packet Tide](https://packettide.com), All Rights Reserved.



=== Content from karmainsecurity.com_58ec652f_20250115_080953.html ===

[egix@karmainsecurity ~ $](https://karmainsecurity.com/)

* [~/research](https://karmainsecurity.com/research)
* [~/blog](https://karmainsecurity.com/blog)
* [~/about](https://karmainsecurity.com/about)

# ExpressionEngine <= 6.0.2 (Translate::save) PHP Code Injection Vulnerability

#### â¢ Software Link:

<https://expressionengine.com>

#### â¢ Affected Versions:

Version 6.0.2 and prior versions.

Version 5.4.1 and prior versions.

#### â¢ Vulnerability Description:

The vulnerable code is located in the `ExpressionEngine\Controller\Utilities\Translate::save()` method:

```
362private function save($language, $file)
363{
364
365    $file = ee()->security->sanitize_filename($file);
366
367    $dest_dir = $this->languages_dir . $language . '/';
368    $filename = $file . '_lang.php';
369    $dest_loc = $dest_dir . $filename;
370
371    $str = '<?php' . "\n" . '$lang = array(' . "\n\n\n";
372
373    ee()->lang->loadfile($file);
374
375    foreach ($_POST as $key => $val) {
376        $val = str_replace('<script', '', $val);
377        $val = str_replace('<iframe', '', $val);
378        $val = str_replace(array("\\", "'"), array("\\\\", "\'"), $val);
379
380        $str .= '\'' . $key . '\' => ' . "\n" . '\'' . $val . '\'' . ",\n\n";
381    }
382
383    $str .= "''=>''\n);\n\n";
384    $str .= "// End of File";
```

```
400$this->load->helper('file');
401
402if (write_file($dest_loc, $str)) {
403    ee('CP/Alert')->makeInline('shared-form')
404        ->asSuccess()
405        ->withTitle(lang('translations_saved'))
406        ->addToBody(sprintf(lang('file_saved'), $dest_loc))
407        ->defer();
```

User input passed via keys of POST parameters is not properly sanitized before being assigned to the **"$str"** variable at line 380. Such a variable will be used in a call to the `write_file()` function at line 402, trying to write user supplied content into the **/system/user/language/[lang]/[file]\_lang.php** file. This can be exploited to inject and execute arbitrary PHP code. Successful exploitation of this vulnerability requires an account with permissions to access the CP translation system utilities.

#### â¢ Solution:

Upgrade to version 6.0.3, 5.4.2, or later.

#### â¢ Disclosure Timeline:

[03/02/2021] â Vendor notified through HackerOne

[15/02/2021] â Vulnerability acknowledged by the vendor

[16/02/2021] â CVE number assigned

[17/02/2021] â Version 6.0.3 released

[04/03/2021] â Version 5.4.2 released

[15/03/2021] â Public disclosure

#### â¢ CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org)) has assigned the name [CVE-2021-27230](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27230) to this vulnerability.

#### â¢ Credits:

Vulnerability discovered by Egidio Romano.

#### â¢ Other References:

<https://hackerone.com/reports/1093444>

Karma(In)Security © 2025


