=== Content from rustsec.org_40600570_20250115_084449.html ===


RUSTSEC-2021-0023: rand\_core: Incorrect check on buffer length when seeding RNGs › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/rand_core/RUSTSEC-2021-0023.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/rand_core/RUSTSEC-2021-0023.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0023)

# RUSTSEC-2021-0023

Incorrect check on buffer length when seeding RNGs

Reported
February 12, 2021

Issued
February 15, 2021

(last modified: June 13, 2023)

Package
[rand\_core](/packages/rand_core.html)
([crates.io](https://crates.io/crates/rand_core))

Type
Vulnerability

Categories

* [crypto-failure](/categories/crypto-failure.html)

Aliases

* [CVE-2021-27378](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27378)
* [GHSA-w7j2-35mf-95p7](https://github.com/advisories/GHSA-w7j2-35mf-95p7)

References

* <https://github.com/rust-random/rand/pull/1096>

CVSS Score
9.8
CRITICAL

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionNone
ScopeUnchanged
ConfidentialityHigh
IntegrityHigh
AvailabilityHigh

CVSS Vector
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
Patched

* `>=0.6.2`

Unaffected

* `<0.6.0`

Affected Functions
Version
`rand_core::le::read_u32_into`

* `<0.6.2, >=0.6.0`

`rand_core::le::read_u64_into`

* `<0.6.2, >=0.6.0`

### Description

Summary: rand\_core::le::read\_u32\_into and read\_u64\_into have incorrect checks on the source buffer length, allowing the destination buffer to be under-filled.

Implications: some downstream RNGs, including Hc128Rng (but not the more widely used ChaCha\*Rng), allow seeding using the SeedableRng::from\_seed trait-function with too short keys.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


