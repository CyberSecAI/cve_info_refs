=== Content from github.com_95198f11_20250115_112154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fblob%2Fmaster%2Fthird_party%2Fopenthread%2Fsrc%2Fncp%2Fspinel.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fblob%2Fmaster%2Fthird_party%2Fopenthread%2Fsrc%2Fncp%2Fspinel.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5afb8e9e_20250115_112159.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-qwc4-6769-3rhp)

**CVE-2021-33889**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-qwc4-6769-3rhp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2021-33889](/advisories/GHSA-qwc4-6769-3rhp)

## OpenThread wpantund through 2021-07-02 has a stack-based...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 30, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-qwc4-6769-3rhp/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

OpenThread wpantund through 2021-07-02 has a stack-based Buffer Overflow because of an inconsistency in the integer data type for metric\_len.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2021-33889>
* [openthread/wpantund#502](https://github.com/openthread/wpantund/issues/502)
* <https://github.com/fireeye/Vulnerability-Disclosures/blob/master/FEYE-2021-0019/FEYE-2021-0019.md>
* <https://github.com/openthread/wpantund/releases>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2021-33889)
Jul 2, 2021

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 30, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.123%
 (47th percentile)

### Weaknesses

[CWE-787](/advisories?query=cwe%3A787)

### CVE ID

CVE-2021-33889

### GHSA ID

GHSA-qwc4-6769-3rhp

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-qwc4-6769-3rhp/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8d18ac16_20250114_181725.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

# Releases: openthread/wpantund

[Releases](/openthread/wpantund/releases)
[Tags](/openthread/wpantund/tags)

Releases · openthread/wpantund

## There aren’t any releases here

You can create a release to package software, along with release notes and links to binary files, for other people to use. Learn more about releases in [our docs](https://docs.github.com/repositories/releasing-projects-on-github/about-releases).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0935fa54_20250115_112159.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2F4ae4619d7db67db8f316507ceb91879221da0c42)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2F4ae4619d7db67db8f316507ceb91879221da0c42)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

## Commit

[Permalink](/openthread/wpantund/commit/4ae4619d7db67db8f316507ceb91879221da0c42)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[link metrics] implement link metrics properties ([#484](https://github.com/openthread/wpantund/pull/484))

[Browse files](/openthread/wpantund/tree/4ae4619d7db67db8f316507ceb91879221da0c42)
Browse the repository at this point in the history

```

Co-authored-by: Konrad Derda <konrad.derda@nordicsemi.no>
```

* Loading branch information

[![@piotrkoziar](https://avatars.githubusercontent.com/u/44554861?s=40&v=4)](/piotrkoziar) [![@kderda](https://avatars.githubusercontent.com/u/55538957?s=40&v=4)](/kderda)

[piotrkoziar](/openthread/wpantund/commits?author=piotrkoziar "View all commits by piotrkoziar")
and
[kderda](/openthread/wpantund/commits?author=kderda "View all commits by kderda")
authored
Apr 10, 2021

1 parent
[d5b95c1](/openthread/wpantund/commit/d5b95c15aaaf5d752a3d34a71f76ec1a3ec3b849)

commit 4ae4619

 Show file tree

 Hide file tree

Showing
**17 changed files**
with
**1,576 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + ipc-dbus

    - src/ipc-dbus/DBusIPCAPI\_v1.cpp
      [DBusIPCAPI\_v1.cpp](#diff-702aa56877b7e030fd2a1b6a42c6c7256efe41cf1c9766ab8ab046afce4f3bb5)
    - src/ipc-dbus/DBusIPCAPI\_v1.h
      [DBusIPCAPI\_v1.h](#diff-30cfec68d1346e83676cd3d36c428339519b8b3b0a6c2ccb78610d3d25efc5d9)
    - src/ipc-dbus/wpan-dbus-v1.h
      [wpan-dbus-v1.h](#diff-c9421e7805f259704b322e250ae5384abc21580a94164c5fc5b9c84b3f640f39)
  + ncp-dummy

    - src/ncp-dummy/DummyNCPControlInterface.cpp
      [DummyNCPControlInterface.cpp](#diff-71bb294e90e9f25c63859312ea1f6faf131788d6b582b1fba322b33256686ff3)
    - src/ncp-dummy/DummyNCPControlInterface.h
      [DummyNCPControlInterface.h](#diff-52286c37853718af19da6f5514f965242ca507ed2fcdfc48b29f458ad88a81b6)
  + ncp-spinel

    - src/ncp-spinel/SpinelNCPControlInterface.cpp
      [SpinelNCPControlInterface.cpp](#diff-6417d0ba4bff1cb480fc9fe3235418e955b4b425c249b306e1659cec249a105c)
    - src/ncp-spinel/SpinelNCPControlInterface.h
      [SpinelNCPControlInterface.h](#diff-46a6f024e97860fc1c0756df454a20c63a77bcfed621d9fb18cfc27da3325097)
    - src/ncp-spinel/SpinelNCPInstance.cpp
      [SpinelNCPInstance.cpp](#diff-df9f454395c097523059a20bd63b13bc3d65b3095dbc6f6533d2fb52c24da1a6)
    - src/ncp-spinel/SpinelNCPInstance.h
      [SpinelNCPInstance.h](#diff-f104ff58cc83f645121e0ccff390d0750e17e997a18e909f59f6e80ff9e2f3e2)
  + wpanctl

    - src/wpanctl/Makefile.am
      [Makefile.am](#diff-9f95c50d9234b6aee27dcf65ff29c0d90401433902956d2c36316f42c65e559f)
    - src/wpanctl/tool-cmd-linkmetrics.c
      [tool-cmd-linkmetrics.c](#diff-2a6393c5dd23fda69a32699964c378a23a485c2b628c444c99888c461dcb9f33)
    - src/wpanctl/tool-cmd-linkmetrics.h
      [tool-cmd-linkmetrics.h](#diff-2663d7c8dfa03d1d7772ddedb3cedc0eb4d049a77afd45de0bcd802003896403)
    - src/wpanctl/wpanctl-cmds.h
      [wpanctl-cmds.h](#diff-714720507959cbf6883b883500036d10243f27bebdbbcc564ed43af9ab380e3c)
  + wpantund

    - src/wpantund/NCPControlInterface.h
      [NCPControlInterface.h](#diff-35361a5a425a84abe739c7bd47ec2cd97f2b533a7ce4aeef51ce8286a2d6f52f)
    - src/wpantund/wpan-properties.h
      [wpan-properties.h](#diff-d938d7bbf6696b5ee1331fd30336157ba6abd370e4fda9bd8b60b1e72838ce16)
* third\_party/openthread/src/ncp

  + third\_party/openthread/src/ncp/spinel.c
    [spinel.c](#diff-eb8185571856353fd8608ae0f3c8df2baf4558748ad91e67e0211a46532521ac)
  + third\_party/openthread/src/ncp/spinel.h
    [spinel.h](#diff-6ce03217659f4440c6b9629883e60abe09c7a7e70b8505610987aa9163ea6ce9)

## There are no files selected for viewing

172 changes: 172 additions & 0 deletions

172
[src/ipc-dbus/DBusIPCAPI\_v1.cpp](#diff-702aa56877b7e030fd2a1b6a42c6c7256efe41cf1c9766ab8ab046afce4f3bb5 "src/ipc-dbus/DBusIPCAPI_v1.cpp")

Show comments

[View file](/openthread/wpantund/blob/4ae4619d7db67db8f316507ceb91879221da0c42/src/ipc-dbus/DBusIPCAPI_v1.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -119,6 +119,11 @@ DBusIPCAPI\_v1::init\_callback\_tables() |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_PEEK, interface\_peek\_handler); |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_POKE, interface\_poke\_handler); |
|  |  |  |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_LINK\_METRICS\_QUERY, interface\_link\_metrics\_query\_handler); |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_LINK\_METRICS\_PROBE, interface\_link\_metrics\_probe\_handler); |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_LINK\_METRICS\_MGMT\_FORWARD, interface\_link\_metrics\_mgmt\_forward\_handler); |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_LINK\_METRICS\_MGMT\_ENH\_ACK, interface\_link\_metrics\_mgmt\_enh\_ack\_handler); |
|  |  |  |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_MLR\_REQUEST, interface\_mlr\_request\_handler); |
|  |  |  |
|  |  | INTERFACE\_CALLBACK\_CONNECT(WPANTUND\_IF\_CMD\_BACKBONE\_ROUTER\_CONFIG, interface\_backbone\_router\_config\_handler); |
| Expand Down  Expand Up | | @@ -2120,6 +2125,173 @@ DBusIPCAPI\_v1::interface\_poke\_handler( |
|  |  | return ret; |
|  |  | } |
|  |  |  |
|  |  | DBusHandlerResult |
|  |  | DBusIPCAPI\_v1::interface\_link\_metrics\_query\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ) { |
|  |  | DBusHandlerResult ret = DBUS\_HANDLER\_RESULT\_NOT\_YET\_HANDLED; |
|  |  | const uint8\_t \*dest\_addr = NULL; |
|  |  | int dest\_addr\_len; |
|  |  | struct in6\_addr dest; |
|  |  | uint8\_t series; |
|  |  | uint8\_t metrics = 0; |
|  |  | bool did\_succeed = false; |
|  |  |  |
|  |  | did\_succeed = dbus\_message\_get\_args( |
|  |  | message, NULL, |
|  |  | DBUS\_TYPE\_ARRAY, DBUS\_TYPE\_BYTE, &dest\_addr, &dest\_addr\_len, |
|  |  | DBUS\_TYPE\_BYTE, &series, |
|  |  | DBUS\_TYPE\_BYTE, &metrics, |
|  |  | DBUS\_TYPE\_INVALID |
|  |  | ); |
|  |  |  |
|  |  | require(did\_succeed, bail); |
|  |  | require(dest\_addr\_len == sizeof(dest), bail); |
|  |  |  |
|  |  | dbus\_message\_ref(message); |
|  |  |  |
|  |  | memcpy(dest.s6\_addr, dest\_addr, sizeof(dest)); |
|  |  |  |
|  |  | interface->link\_metrics\_query( |
|  |  | dest, |
|  |  | series, |
|  |  | metrics, |
|  |  | boost::bind(&DBusIPCAPI\_v1::CallbackWithStatus\_Helper, this, \_1, message) |
|  |  | ); |
|  |  |  |
|  |  | ret = DBUS\_HANDLER\_RESULT\_HANDLED; |
|  |  |  |
|  |  | bail: |
|  |  | return ret; |
|  |  | } |
|  |  |  |
|  |  | DBusHandlerResult |
|  |  | DBusIPCAPI\_v1::interface\_link\_metrics\_probe\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ) { |
|  |  | DBusHandlerResult ret = DBUS\_HANDLER\_RESULT\_NOT\_YET\_HANDLED; |
|  |  | const uint8\_t \*dest\_addr = NULL; |
|  |  | int dest\_addr\_len; |
|  |  | struct in6\_addr dest; |
|  |  | uint8\_t series; |
|  |  | uint8\_t length; |
|  |  | bool did\_succeed = false; |
|  |  |  |
|  |  | did\_succeed = dbus\_message\_get\_args( |
|  |  | message, NULL, |
|  |  | DBUS\_TYPE\_ARRAY, DBUS\_TYPE\_BYTE, &dest\_addr, &dest\_addr\_len, |
|  |  | DBUS\_TYPE\_BYTE, &series, |
|  |  | DBUS\_TYPE\_BYTE, &length, |
|  |  | DBUS\_TYPE\_INVALID |
|  |  | ); |
|  |  |  |
|  |  | require(did\_succeed, bail); |
|  |  | require(dest\_addr\_len == sizeof(dest), bail); |
|  |  |  |
|  |  | dbus\_message\_ref(message); |
|  |  |  |
|  |  | memcpy(dest.s6\_addr, dest\_addr, sizeof(dest)); |
|  |  |  |
|  |  | interface->link\_metrics\_probe( |
|  |  | dest, |
|  |  | series, |
|  |  | length, |
|  |  | boost::bind(&DBusIPCAPI\_v1::CallbackWithStatus\_Helper, this, \_1, message) |
|  |  | ); |
|  |  |  |
|  |  | ret = DBUS\_HANDLER\_RESULT\_HANDLED; |
|  |  |  |
|  |  | bail: |
|  |  | return ret; |
|  |  | } |
|  |  |  |
|  |  | DBusHandlerResult |
|  |  | DBusIPCAPI\_v1::interface\_link\_metrics\_mgmt\_forward\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ) { |
|  |  | DBusHandlerResult ret = DBUS\_HANDLER\_RESULT\_NOT\_YET\_HANDLED; |
|  |  | const uint8\_t \*dest\_addr = NULL; |
|  |  | int dest\_addr\_len; |
|  |  | struct in6\_addr dest; |
|  |  | uint8\_t series\_id = 0; |
|  |  | uint8\_t metrics = 0; |
|  |  | uint8\_t frame\_types = 0; |
|  |  | bool did\_succeed = false; |
|  |  |  |
|  |  | did\_succeed = dbus\_message\_get\_args( |
|  |  | message, NULL, |
|  |  | DBUS\_TYPE\_ARRAY, DBUS\_TYPE\_BYTE, &dest\_addr, &dest\_addr\_len, |
|  |  | DBUS\_TYPE\_BYTE, &series\_id, |
|  |  | DBUS\_TYPE\_BYTE, &frame\_types, |
|  |  | DBUS\_TYPE\_BYTE, &metrics, |
|  |  | DBUS\_TYPE\_INVALID |
|  |  | ); |
|  |  |  |
|  |  | require(did\_succeed, bail); |
|  |  | require(dest\_addr\_len == sizeof(dest), bail); |
|  |  |  |
|  |  | dbus\_message\_ref(message); |
|  |  |  |
|  |  | memcpy(dest.s6\_addr, dest\_addr, sizeof(dest)); |
|  |  |  |
|  |  | interface->link\_metrics\_mgmt\_forward( |
|  |  | dest, |
|  |  | series\_id, |
|  |  | frame\_types, |
|  |  | metrics, |
|  |  | boost::bind(&DBusIPCAPI\_v1::CallbackWithStatus\_Helper, this, \_1, message) |
|  |  | ); |
|  |  |  |
|  |  | ret = DBUS\_HANDLER\_RESULT\_HANDLED; |
|  |  |  |
|  |  | bail: |
|  |  | return ret; |
|  |  | } |
|  |  |  |
|  |  | DBusHandlerResult |
|  |  | DBusIPCAPI\_v1::interface\_link\_metrics\_mgmt\_enh\_ack\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ) { |
|  |  | DBusHandlerResult ret = DBUS\_HANDLER\_RESULT\_NOT\_YET\_HANDLED; |
|  |  | const uint8\_t \*dest\_addr = NULL; |
|  |  | int dest\_addr\_len; |
|  |  | struct in6\_addr dest; |
|  |  | uint8\_t metrics = 0; |
|  |  | uint8\_t flags = 0; |
|  |  | bool did\_succeed = false; |
|  |  |  |
|  |  | did\_succeed = dbus\_message\_get\_args( |
|  |  | message, NULL, |
|  |  | DBUS\_TYPE\_ARRAY, DBUS\_TYPE\_BYTE, &dest\_addr, &dest\_addr\_len, |
|  |  | DBUS\_TYPE\_BYTE, &flags, |
|  |  | DBUS\_TYPE\_BYTE, &metrics, |
|  |  | DBUS\_TYPE\_INVALID |
|  |  | ); |
|  |  |  |
|  |  | require(did\_succeed, bail); |
|  |  | require(dest\_addr\_len == sizeof(dest), bail); |
|  |  |  |
|  |  | dbus\_message\_ref(message); |
|  |  |  |
|  |  | memcpy(dest.s6\_addr, dest\_addr, sizeof(dest)); |
|  |  |  |
|  |  | interface->link\_metrics\_mgmt\_enh\_ack( |
|  |  | dest, |
|  |  | flags, |
|  |  | metrics, |
|  |  | boost::bind(&DBusIPCAPI\_v1::CallbackWithStatus\_Helper, this, \_1, message) |
|  |  | ); |
|  |  |  |
|  |  | ret = DBUS\_HANDLER\_RESULT\_HANDLED; |
|  |  |  |
|  |  | bail: |
|  |  | return ret; |
|  |  | } |
|  |  |  |
|  |  | DBusHandlerResult |
|  |  | DBusIPCAPI\_v1::interface\_mlr\_request\_handler( |
|  |  | NCPControlInterface\* interface, |
| Expand Down | |  |

20 changes: 20 additions & 0 deletions

20
[src/ipc-dbus/DBusIPCAPI\_v1.h](#diff-30cfec68d1346e83676cd3d36c428339519b8b3b0a6c2ccb78610d3d25efc5d9 "src/ipc-dbus/DBusIPCAPI_v1.h")

Show comments

[View file](/openthread/wpantund/blob/4ae4619d7db67db8f316507ceb91879221da0c42/src/ipc-dbus/DBusIPCAPI_v1.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -281,6 +281,26 @@ class DBusIPCAPI\_v1 { |
|  |  | DBusMessage \* message |
|  |  | ); |
|  |  |  |
|  |  | DBusHandlerResult interface\_link\_metrics\_query\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ); |
|  |  |  |
|  |  | DBusHandlerResult interface\_link\_metrics\_probe\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ); |
|  |  |  |
|  |  | DBusHandlerResult interface\_link\_metrics\_mgmt\_forward\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ); |
|  |  |  |
|  |  | DBusHandlerResult interface\_link\_metrics\_mgmt\_enh\_ack\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
|  |  | ); |
|  |  |  |
|  |  | DBusHandlerResult interface\_mlr\_request\_handler( |
|  |  | NCPControlInterface\* interface, |
|  |  | DBusMessage \* message |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[src/ipc-dbus/wpan-dbus-v1.h](#diff-c9421e7805f259704b322e250ae5384abc21580a94164c5fc5b9c84b3f640f39 "src/ipc-dbus/wpan-dbus-v1.h")

Show comments

[View file](/openthread/wpantund/blob/4ae4619d7db67db8f316507ceb91879221da0c42/src/ipc-dbus/wpan-dbus-v1.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -99,6 +99,11 @@ |
|  |  |  |
|  |  | #define WPANTUND\_IF\_SIGNAL\_NETWORK\_TIME\_UPDATE "NetworkTimeUpdate" |
|  |  |  |
|  |  | #define WPANTUND\_IF\_CMD\_LINK\_METRICS\_QUERY "LinkMetricsQuery" |
|  |  | #define WPANTUND\_IF\_CMD\_LINK\_METRICS\_PROBE "LinkMetricsProbe" |
|  |  | #define WPANTUND\_IF\_CMD\_LINK\_METRICS\_MGMT\_FORWARD "LinkMetricsMgmtForward" |
|  |  | #define WPANTUND\_IF\_CMD\_LINK\_METRICS\_MGMT\_ENH\_ACK "LinkMetricsMgmtEnhAck" |
|  |  |  |
|  |  | #define WPANTUND\_IF\_CMD\_MLR\_REQUEST "MlrRequest" |
|  |  |  |
|  |  | #define WPANTUND\_IF\_CMD\_BACKBONE\_ROUTER\_CONFIG "BackboneRouterConfig" |
| Expand Down | |  |

41 changes: 41 additions & 0 deletions

41
[src/ncp-dummy/DummyNCPControlInterface.cpp](#diff-71bb294e90e9f25c63859312ea1f6faf131788d6b582b1fba322b33256686ff3 "src/ncp-dummy/DummyNCPControlInterface.cpp")

Show comments

[View file](/openthread/wpantund/blob/4ae4619d7db67db8f316507ceb91879221da0c42/src/ncp-dummy/DummyNCPControlInterface.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -396,6 +396,47 @@ DummyNCPControlInterface::property\_remove\_value( |
|  |  | mNCPInstance->property\_remove\_value(key, value, cb); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | DummyNCPControlInterface::link\_metrics\_query( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb |
|  |  | ) { |
|  |  | cb(kWPANTUNDStatus\_FeatureNotImplemented); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | DummyNCPControlInterface::link\_metrics\_probe( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | uint8\_t length, |
|  |  | CallbackWithStatus cb |
|  |  | ) { |
|  |  | cb(kWPANTUNDStatus\_FeatureNotImplemented); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | DummyNCPControlInterface::link\_metrics\_mgmt\_forward( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | const uint8\_t frame\_types, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb |
|  |  | ) { |
|  |  | cb(kWPANTUNDStatus\_FeatureNotImplemented); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | DummyNCPControlInterface::link\_metrics\_mgmt\_enh\_ack( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb |
|  |  | ) { |
|  |  | cb(kWPANTUNDStatus\_FeatureNotImplemented); |
|  |  | } |
|  |  |  |
|  |  | void |
|  |  | DummyNCPControlInterface::mlr\_request( |
|  |  | const std::vector<struct in6\_addr> &addresses, |
| Expand Down | |  |

29 changes: 29 additions & 0 deletions

29
[src/ncp-dummy/DummyNCPControlInterface.h](#diff-52286c37853718af19da6f5514f965242ca507ed2fcdfc48b29f458ad88a81b6 "src/ncp-dummy/DummyNCPControlInterface.h")

Show comments

[View file](/openthread/wpantund/blob/4ae4619d7db67db8f316507ceb91879221da0c42/src/ncp-dummy/DummyNCPControlInterface.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -245,6 +245,35 @@ class DummyNCPControlInterface : public NCPControlInterface { |
|  |  |  |
|  |  | virtual NCPInstance& get\_ncp\_instance(void); |
|  |  |  |
|  |  | virtual void link\_metrics\_query( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb = NilReturn() |
|  |  | ); |
|  |  |  |
|  |  | virtual void link\_metrics\_probe( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | uint8\_t length, |
|  |  | CallbackWithStatus cb = NilReturn() |
|  |  | ); |
|  |  |  |
|  |  | virtual void link\_metrics\_mgmt\_forward( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t seriesId, |
|  |  | const uint8\_t frame\_types, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb = NilReturn() |
|  |  | ); |
|  |  |  |
|  |  | virtual void link\_metrics\_mgmt\_enh\_ack( |
|  |  | const struct in6\_addr &address, |
|  |  | uint8\_t flags, |
|  |  | const uint8\_t metrics, |
|  |  | CallbackWithStatus cb = NilReturn() |
|  |  | ); |
|  |  |  |
|  |  | virtual void mlr\_request( |
|  |  | const std::vector<struct in6\_addr> &addresses, |
|  |  | bool mlr\_timeout\_present, |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4ae4619`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2F4ae4619d7db67db8f316507ceb91879221da0c42) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1f9c6808_20250115_112157.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fblob%2Fmaster%2Fsrc%2Fncp-spinel%2FSpinelNCPInstance.cpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fblob%2Fmaster%2Fsrc%2Fncp-spinel%2FSpinelNCPInstance.cpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b8361d34_20250114_181724.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fissues%2F502)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fissues%2F502)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopenthread%2Fwpantund%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopenthread%2Fwpantund%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# stack-buffer-overflow in metric\_len #502

Open

[nandedkarhrishi](/nandedkarhrishi) opened this issue
Jun 28, 2021
· 0 comments

Open

# [stack-buffer-overflow in metric\_len](#top) #502

[nandedkarhrishi](/nandedkarhrishi) opened this issue
Jun 28, 2021
· 0 comments

## Comments

[![@nandedkarhrishi](https://avatars.githubusercontent.com/u/85898578?s=80&v=4)](/nandedkarhrishi)

Copy link

Contributor

### **[nandedkarhrishi](/nandedkarhrishi)** commented [Jun 28, 2021](#issue-931140190)

| Context:  Stack buffer overflow may be triggered while writing to a variable metric\_len, which is defined as unsigned short (ref: <https://github.com/openthread/wpantund/blob/master/src/ncp-spinel/SpinelNCPInstance.cpp#L2180>) but is considered as unsigned int (ref: <https://github.com/openthread/wpantund/blob/master/third_party/openthread/src/ncp/spinel.c#L597>).  Expected behavior and actual behavior:  Expected Behavior: Trigger an exception, because size of buffer needed, is not available.  Actual Behavior: The metric\_len variable triggers stack buffer overflow.  Version Details:  The issue was first found in wpantund: [4ae4619](https://github.com/openthread/wpantund/commit/4ae4619d7db67db8f316507ceb91879221da0c42)  Affected commits: [4ae4619](https://github.com/openthread/wpantund/commit/4ae4619d7db67db8f316507ceb91879221da0c42) to [bf45115](https://github.com/openthread/wpantund/commit/bf45115f41ba2b8029eda174be2b93dea73b9261)  CVE  [CVE-2021-33889](https://github.com/advisories/GHSA-qwc4-6769-3rhp "CVE-2021-33889") (Reserved) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@nandedkarhrishi](https://avatars.githubusercontent.com/u/85898578?s=40&v=4)](/nandedkarhrishi)
[nandedkarhrishi](/nandedkarhrishi)
mentioned this issue
[Jun 28, 2021](#ref-pullrequest-931174186)

[Fixed stack-buffer-overflow in metric\_len
#503](/openthread/wpantund/pull/503)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fissues%2F502)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@nandedkarhrishi](https://avatars.githubusercontent.com/u/85898578?s=52&v=4)](/nandedkarhrishi)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3f0b9c04_20250115_112201.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2Fbf45115f41ba2b8029eda174be2b93dea73b9261)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2Fbf45115f41ba2b8029eda174be2b93dea73b9261)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openthread%2Fwpantund)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openthread](/openthread)
/
**[wpantund](/openthread/wpantund)**
Public

* [Notifications](/login?return_to=%2Fopenthread%2Fwpantund) You must be signed in to change notification settings
* [Fork
  111](/login?return_to=%2Fopenthread%2Fwpantund)
* [Star
   175](/login?return_to=%2Fopenthread%2Fwpantund)

* [Code](/openthread/wpantund)
* [Issues
  24](/openthread/wpantund/issues)
* [Pull requests
  8](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

Additional navigation options

* [Code](/openthread/wpantund)
* [Issues](/openthread/wpantund/issues)
* [Pull requests](/openthread/wpantund/pulls)
* [Actions](/openthread/wpantund/actions)
* [Security](/openthread/wpantund/security)
* [Insights](/openthread/wpantund/pulse)

## Commit

[Permalink](/openthread/wpantund/commit/bf45115f41ba2b8029eda174be2b93dea73b9261)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

util/netif-mgmt: only include missing strlcpy header if actually miss…

[Browse files](/openthread/wpantund/tree/bf45115f41ba2b8029eda174be2b93dea73b9261)
Browse the repository at this point in the history

```
…ing ([#497](https://github.com/openthread/wpantund/pull/497))

In commit [4e2ef14](https://github.com/openthread/wpantund/commit/4e2ef143046a0c89afe6fd66acf5b7a7f35e8356) this header was
added unconditionally. For my system (Yocto with musl) this results in
strlcpy being redefined to __missing_strlcpy in all cases. No matter if
strlcpy is available or not.

Given it is available and the nl.m4 macros detects this, the libstrlcpy.la
helper is not build which results in:

netif-mgmt.c:386: more undefined references to `___missing_strlcpy' follow

Signed-off-by: Stefan Schmidt <stefan.schmidt@huawei.com>
```

* Loading branch information

[![@Stefan-Schmidt](https://avatars.githubusercontent.com/u/333215?s=40&v=4)](/Stefan-Schmidt)

[Stefan-Schmidt](/openthread/wpantund/commits?author=Stefan-Schmidt "View all commits by Stefan-Schmidt")
authored
Jun 1, 2021

1 parent
[8204681](/openthread/wpantund/commit/820468161c87816a3e94366ebbe2a932650416e3)

commit bf45115

Showing
**1 changed file**
with
**2 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[src/util/netif-mgmt.c](#diff-5af723a9153864de37df302c42e2c54badbed840f427f0e76c49bca67f8513cd "src/util/netif-mgmt.c")

Show comments

[View file](/openthread/wpantund/blob/bf45115f41ba2b8029eda174be2b93dea73b9261/src/util/netif-mgmt.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -69,7 +69,9 @@ |
|  |  | #define IFEF\_NOAUTOIPV6LL 0x2000 /\* Interface IPv6 LinkLocal address not provided by kernel \*/ |
|  |  | #endif |
|  |  |  |
|  |  | #ifdef MISSING\_STRLCPY |
|  |  | #include "missing/strlcpy/strlcpy.h" |
|  |  | #endif |
|  |  |  |
|  |  | #ifndef SIOCSIFLLADDR |
|  |  | #define SIOCSIFLLADDR SIOCSIFHWADDR |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bf45115`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenthread%2Fwpantund%2Fcommit%2Fbf45115f41ba2b8029eda174be2b93dea73b9261) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0b881309_20250114_181724.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiant%2FVulnerability-Disclosures%2Fblob%2Fmaster%2FFEYE-2021-0019%2FFEYE-2021-0019.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiant%2FVulnerability-Disclosures%2Fblob%2Fmaster%2FFEYE-2021-0019%2FFEYE-2021-0019.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mandiant%2FVulnerability-Disclosures)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mandiant](/mandiant)
/
**[Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures)**
Public

* [Notifications](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures) You must be signed in to change notification settings
* [Fork
  65](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures)
* [Star
   196](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures)

* [Code](/mandiant/Vulnerability-Disclosures)
* [Issues
  0](/mandiant/Vulnerability-Disclosures/issues)
* [Pull requests
  0](/mandiant/Vulnerability-Disclosures/pulls)
* [Actions](/mandiant/Vulnerability-Disclosures/actions)
* [Projects
  0](/mandiant/Vulnerability-Disclosures/projects)
* [Security](/mandiant/Vulnerability-Disclosures/security)
* [Insights](/mandiant/Vulnerability-Disclosures/pulse)

Additional navigation options

* [Code](/mandiant/Vulnerability-Disclosures)
* [Issues](/mandiant/Vulnerability-Disclosures/issues)
* [Pull requests](/mandiant/Vulnerability-Disclosures/pulls)
* [Actions](/mandiant/Vulnerability-Disclosures/actions)
* [Projects](/mandiant/Vulnerability-Disclosures/projects)
* [Security](/mandiant/Vulnerability-Disclosures/security)
* [Insights](/mandiant/Vulnerability-Disclosures/pulse)

## Files

 master
## Breadcrumbs

1. [Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures/tree/master)
2. /[FEYE-2021-0019](/mandiant/Vulnerability-Disclosures/tree/master/FEYE-2021-0019)
/
# FEYE-2021-0019.md

Copy path Blame  Blame
## Latest commit

## History

[History](/mandiant/Vulnerability-Disclosures/commits/master/FEYE-2021-0019/FEYE-2021-0019.md)30 lines (21 loc) · 1.29 KB master
## Breadcrumbs

1. [Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures/tree/master)
2. /[FEYE-2021-0019](/mandiant/Vulnerability-Disclosures/tree/master/FEYE-2021-0019)
/
# FEYE-2021-0019.md

Top
## File metadata and controls

* Preview
* Code
* Blame

30 lines (21 loc) · 1.29 KB[Raw](https://github.com/mandiant/Vulnerability-Disclosures/raw/refs/heads/master/FEYE-2021-0019/FEYE-2021-0019.md)
# FEYE-2021-0019

Wpantund contains stack overflow vulnerability for all the versions from 4ae4619d7db67db8f316507ceb91879221da0c42 to bf45115f41ba2b8029eda174be2b93dea73b9261 (both of the commits inclusive)

## Impact

Medium - 2 byte stack overflow may cause code execution or denial of service

## Exploitability

Low - An attacker must have access to the device.

## CVE Reference

CVE-2021-33889

## Technical Details

Stack buffer overflow may be triggered while writing to a variable metric\_len, which is defined as unsigned short (ref: <https://github.com/openthread/wpantund/blob/master/src/ncp-spinel/SpinelNCPInstance.cpp#L2180>) but is considered as unsigned int (ref: <https://github.com/openthread/wpantund/blob/master/third_party/openthread/src/ncp/spinel.c#L597>).

## Resolution

The issue is fixed in commit 2b6f6c54bba3ab397f0e83f9d5e9faee905ac559. The commit is yet to be merged as of 2 July 2021.

## Discovery Credits

* Rushikesh D. Nandedkar, FireEye Mandiant

## Disclosure Timeline

* Reported on: 28 June 2021
* Submitted Patch: 28 June 2021

## References

* [openthread/wpantund#502](https://github.com/openthread/wpantund/issues/502)
* <https://github.com/openthread/wpantund/pull/503/commits/2b6f6c54bba3ab397f0e83f9d5e9faee905ac559>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33889>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


