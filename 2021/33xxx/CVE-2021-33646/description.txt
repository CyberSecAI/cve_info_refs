The th_read() function doesnâ€™t free a variable t->th_buf.gnu_longname after allocating memory, which may cause a memory leak.