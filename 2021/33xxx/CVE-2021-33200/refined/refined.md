```
{
  "vulnerability": {
    "cve": "CVE-2021-33200",
    "description": "A flaw was found in kernel/bpf/verifier.c in BPF in the Linux kernel. An incorrect limit is enforced for pointer arithmetic operations which can be abused to perform out-of-bounds reads and writes in kernel memory, leading to local privilege escalation. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.",
    "root_cause": "An incorrect limit is enforced for pointer arithmetic operations by the BPF verifier. In a specific case, the offset register can cause the masking direction to change, leading to an incorrect alu_limit.",
    "weaknesses": [
      "Incorrect limit enforcement for pointer arithmetic operations in BPF programs",
      "Out-of-bounds reads and writes in kernel memory"
    ],
     "impact": "Successful exploitation can lead to out-of-bounds reads and writes in kernel memory, potentially enabling local privilege escalation, disclosure of sensitive information, data modification, or Denial of Service (DoS).",
    "attack_vectors": [
      "Local exploitation via a crafted BPF program",
    ],
    "attacker_capabilities": "An attacker needs to be a local user, and be able to load a BPF program."
  },
  "additional_details": {
   "mask_direction_swap": "The core issue involves an incorrect calculation of the masking direction (mask_to_left) during pointer arithmetic in the BPF verifier. This calculation, used to determine pointer limits, can be swapped when the offset register changes sign, leading to an incorrect aux->alu_limit.",
   "speculative_domain_sim_bypass": "A change in the speculative domain simulation process is also mentioned. The verifier no longer simulates the case for known constants, enabling a few test cases previously rejected."
  }
}
```