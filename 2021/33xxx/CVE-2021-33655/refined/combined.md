=== Content from lists.debian.org_99802e21_20250114_204021.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3131-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3131-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Sun, 2 Oct 2022 18:44:48 +0200
* *Message-id*: <[[üîé]](/msgid-search/YznAAAT4mGt5wZQb%40decadent.org.uk)¬†[YznAAAT4mGt5wZQb@decadent.org.uk](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3131-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
October 01, 2022                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.19.260-1
CVE ID         : CVE-2021-4159 CVE-2021-33655 CVE-2021-33656 CVE-2022-1462
                 CVE-2022-1679 CVE-2022-2153 CVE-2022-2318 CVE-2022-2586
                 CVE-2022-2588 CVE-2022-2663 CVE-2022-3028 CVE-2022-26365
                 CVE-2022-26373 CVE-2022-33740 CVE-2022-33741 CVE-2022-33742
                 CVE-2022-33744 CVE-2022-36879 CVE-2022-36946 CVE-2022-39188
                 CVE-2022-39842 CVE-2022-40307
Debian Bug     : 1018752

Several vulnerabilities have been discovered in the Linux kernel that
may lead to privilege escalation, denial of service or information
leaks.

CVE-2021-4159

    A flaw was found in the eBPF verifier which could lead to an
    out-of-bounds read.  If unprivileged use of eBPF is enabled, this
    could leak sensitive information.  This was already disabled by
    default, which would fully mitigate the vulnerability.

CVE-2021-33655

    A user with access to a framebuffer console device could cause a
    memory out-of-bounds write via the FBIOPUT_VSCREENINFO ioctl.

CVE-2021-33656

    A user with access to a framebuffer console device could cause a
    memory out-of-bounds write via some font setting ioctls.  These
    obsolete ioctls have been removed.

CVE-2022-1462

    ‰∏ÄÂè™Áãó reported a race condition in the pty (pseudo-terminal)
    subsystem that can lead to a slab out-of-bounds write.  A local
    user could exploit this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

CVE-2022-1679

    The syzbot tool found a race condition in the ath9k_htc driver
    which can lead to a use-after-free.  This might be exploitable to
    cause a denial service (crash or memory corruption) or possibly
    for privilege escalation.

CVE-2022-2153

    "kangel" reported a flaw in the KVM implementation for x86
    processors which could lead to a null pointer dereference. A local
    user permitted to access /dev/kvm could exploit this to cause a
    denial of service (crash).

CVE-2022-2318

    A use-after-free in the Amateur Radio X.25 PLP (Rose) support may
    result in denial of service.

CVE-2022-2586

    A use-after-free in the Netfilter subsystem may result in local
    privilege escalation for a user with the CAP_NET_ADMIN capability
    in any user or network namespace.

CVE-2022-2588

    Zhenpeng Lin discovered a use-after-free flaw in the cls_route
    filter implementation which may result in local privilege
    escalation for a user with the CAP_NET_ADMIN capability in any
    user or network namespace.

CVE-2022-2663

    David Leadbeater reported flaws in the nf_conntrack_irc
    connection-tracking protocol module.  When this module is enabled
    on a firewall, an external user on the same IRC network as an
    internal user could exploit its lax parsing to open arbitrary TCP
    ports in the firewall, to reveal their public IP address, or to
    block their IRC connection at the firewall.

CVE-2022-3028

    Abhishek Shah reported a race condition in the AF_KEY subsystem,
    which could lead to an out-of-bounds write or read.  A local user
    could exploit this to cause a denial of service (crash or memory
    corruption), to obtain sensitive information, or possibly for
    privilege escalation.

CVE-2022-26365, CVE-2022-33740, CVE-2022-33741, CVE-2022-33742

    Roger Pau Monne discovered that Xen block and network PV device
    frontends don't zero out memory regions before sharing them with
    the backend, which may result in information disclosure.
    Additionally it was discovered that the granularity of the grant
    table doesn't permit sharing less than a 4k page, which may also
    result in information disclosure.

CVE-2022-26373

    It was discovered that on certain processors with Intel's Enhanced
    Indirect Branch Restricted Speculation (eIBRS) capabilities there
    are exceptions to the documented properties in some situations,
    which may result in information disclosure.

    Intel's explanation of the issue can be found at
    <https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/advisory-guidance/post-barrier-return-stack-buffer-predictions.html>

CVE-2022-33744

    Oleksandr Tyshchenko discovered that ARM Xen guests can cause a
    denial of service to the Dom0 via paravirtual devices.

CVE-2022-36879

    A flaw was discovered in xfrm_expand_policies in the xfrm
    subsystem which can cause a reference count to be dropped twice.

CVE-2022-36946

    Domingo Dirutigliano and Nicola Guerrera reported a memory
    corruption flaw in the Netfilter subsystem which may result in
    denial of service.

CVE-2022-39188

    Jann Horn reported a race condition in the kernel's handling of
    unmapping of certain memory ranges.  When a driver created a
    memory mapping with the VM_PFNMAP flag, which many GPU drivers do,
    the memory mapping could be removed and freed before it was
    flushed from the CPU TLBs.  This could result in a page use-after-
    free.  A local user with access to such a device could exploit
    this to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2022-39842

    An integer overflow was discovered in the pxa3xx-gcu video driver
    which could lead to a heap out-of-bounds write.

    This driver is not enabled in Debian's official kernel
    configurations.

CVE-2022-40307

    A race condition was discovered in the EFI capsule-loader driver,
    which could lead to use-after-free.  A local user permitted to
    access this device (/dev/efi_capsule_loader) could exploit this to
    cause a denial of service (crash or memory corruption) or possibly
    for privilege escalation.  However, this device is normally only
    accessible by the root user.

For Debian 10 buster, these problems have been fixed in version
4.19.260-1.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp1gqvJkPWGE.pgp)**

*Description:* PGP signature

---



=== Content from www.debian.org_165337c9_20250114_204022.html ===


---

[[Date Prev](msg00159.html)][[Date Next](msg00161.html)]
[[Thread Prev](msg00159.html)][[Thread Next](msg00161.html)]
[[Date Index](maillist.html#00160)]
[[Thread Index](threads.html#00160)]

# [SECURITY] [DSA 5191-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5191-1] linux security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 26 Jul 2022 20:07:34 +0000
* *Message-id*: <[[üîé]](/msgid-search/20220726200734.GA5805%40seger.debian.org)¬†[20220726200734.GA5805@seger.debian.org](msg00160.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5191-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
July 26, 2022                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2021-33655 CVE-2022-2318 CVE-2022-26365 CVE-2022-33740
                 CVE-2022-33741 CVE-2022-33742 CVE-2022-33743 CVE-2022-33744
                 CVE-2022-34918

Several vulnerabilities have been discovered in the Linux kernel that may
lead to privilege escalation, denial of service or information leaks:

CVE-2021-33655

    A user with access to a framebuffer console driver could cause a
    memory out-of-bounds write via the FBIOPUT_VSCREENINFO ioctl.

CVE-2022-2318

    A use-after-free in the Amateur Radio X.25 PLP (Rose) support may
    result in denial of service.

CVE-2022-26365 / CVE-2022-33740 / CVE-2022-33741 / CVE-2022-33742

    Roger Pau Monne discovered that Xen block and network PV device
    frontends don't zero out memory regions before sharing them with the
    backend, which may result in information disclosure. Additionally it
    was discovered that the granularity of the grant table doesn't permit
    sharing less than a 4k page, which may also result in information
    disclosure.

CVE-2022-33743

    Jan Beulich discovered that incorrect memory handling in the Xen
    network backend may lead to denial of service.

CVE-2022-33744

    Oleksandr Tyshchenko discovered that ARM Xen guests can cause a denial
    of service to the Dom0 via paravirtual devices.

CVE-2022-34918

    Arthur Mongodin discovered a heap buffer overflow in the Netfilter
    subsystem which may result in local privilege escalation.

For the stable distribution (bullseye), these problems have been fixed in
version 5.10.127-2.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmLgSLUACgkQEMKTtsN8
TjYbNA//Yr3vv1aAt9hXCpI/r4QJRZ23CxQL1so2nBV7c5q7rMdbr42+0seQl/33
pc5dikZ79MzSxShQhHYWRYrya3alXSRmgDxe5rICnSLF8+nHRpQccGfPTFDlKLOg
4sNfvonxOUKEgfi5Rqd5FtWnhCtAX+I26lI/PnA4ciQE+VA4l6YeaxJnL42HugYw
q4Y8mEprEW7aZSpcK2Nk2ixXPNwJlAssvbIHvNJsaRP4X4w18iHSI/8AYlymkvfa
Eyf4vEQfKce7UQB3JoIfdJQFgX3cvz6oMXZ6q9S4i5GlK7GeWSo2NRfE3ulrlFOw
tCFfVN6V9tVQtuKqNma5tn4F8FG8YLafDzC0IwLq+JswrTbs5EQ/wzJhNnkXP86J
hSPpMeVmT/mBihjv6PRilOraOX8mACJSQKuWkDSc9VvZCeCUo0uc31d4/WfzaOCM
rxaMBHuQW7mq/Dd6htlbbGyUjWC9Zt5Wb+GtzXIb6jUOISUagMI4lnMVgOB4Tyhl
FiPp4PWz7jGVsrN/l/5JsPxhQd2wPmPC2zS2REunvXOMZxCgwOMB3aW5oJSufHTa
c/f9Z86s/HFZxjwJ3mEcebAzVAvGPfg9yuiD6nEEeYSTLhTCC5UTGw4WVZHjNtxB
3yn8Ju2Nqu3NbmyAlye/Y9wAlw3nIL3dkFkRU/NgzncnuXT7oLw=
=DZil
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_39c750ac_20250114_204020.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <420cd38c550a46e6abea9bcab3c09eb7@huawei.com>
Date: Tue, 19 Jul 2022 02:10:42 +0000
From: "Weigang (Jimmy)" <weigang12@...wei.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
CC: "openeuler-security@...neuler.org" <openeuler-security@...neuler.org>
Subject: CVE-2021-33655: Linux kernel: When sending malicous data to kernel by ioctl cmd
 FBIOPUT_VSCREENINFO,kernel will write memory out of bounds.(5.18 5.19.0-rc1)

Fix has been released by Linux kernel upstream in 5.19-rc7: <https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=086ff84617185393a0bbf25830c4f36412a7d3f4>.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_c2bdf68c_20250114_204021.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Linus Torvalds <torvalds@linux-foundation.org> | 2022-07-08 11:03:26 -0700 |
| --- | --- | --- |
| committer | Linus Torvalds <torvalds@linux-foundation.org> | 2022-07-08 11:03:26 -0700 |
| commit | [086ff84617185393a0bbf25830c4f36412a7d3f4](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=086ff84617185393a0bbf25830c4f36412a7d3f4) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)) | |
| tree | [a5771a4c2d845577c05b059547ff6a3a36d1cbd3](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=086ff84617185393a0bbf25830c4f36412a7d3f4) | |
| parent | [e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=086ff84617185393a0bbf25830c4f36412a7d3f4&id2=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee)) | |
| parent | [53a6e66b1b4fea4b52f8bc62e5f9530af9061027](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=53a6e66b1b4fea4b52f8bc62e5f9530af9061027) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=086ff84617185393a0bbf25830c4f36412a7d3f4&id2=53a6e66b1b4fea4b52f8bc62e5f9530af9061027)) | |
| download | [linux-086ff84617185393a0bbf25830c4f36412a7d3f4.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-086ff84617185393a0bbf25830c4f36412a7d3f4.tar.gz) | |

Merge tag 'for-5.19/fbdev-3' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/linux-fbdevPull fbdev fixes from Helge Deller:
- fbcon now prevents switching to screen resolutions which are smaller
than the font size, and prevents enabling a font which is bigger than
the current screen resolution. This fixes vmalloc-out-of-bounds
accesses found by KASAN.
- Guiling Deng fixed a bug where the centered fbdev logo wasn't
displayed correctly if the screen size matched the logo size.
- Hsin-Yi Wang provided a patch to include errno.h to fix build when
CONFIG\_OF isn't enabled.
\* tag 'for-5.19/fbdev-3' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/linux-fbdev:
fbcon: Use fbcon\_info\_from\_console() in fbcon\_modechange\_possible()
fbmem: Check virtual screen sizes in fb\_set\_var()
fbcon: Prevent that screen size is smaller than font size
fbcon: Disallow setting font bigger than screen size
video: of\_display\_timing.h: include errno.h
fbdev: fbmem: Fix logo center image dx issue
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=086ff84617185393a0bbf25830c4f36412a7d3f4)

| -rw-r--r-- | [drivers/video/fbdev/core/fbcon.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/video/fbdev/core/fbcon.c?id=086ff84617185393a0bbf25830c4f36412a7d3f4) | 33 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/video/fbdev/core/fbmem.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/drivers/video/fbdev/core/fbmem.c?id=086ff84617185393a0bbf25830c4f36412a7d3f4) | 16 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [include/linux/fbcon.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/linux/fbcon.h?id=086ff84617185393a0bbf25830c4f36412a7d3f4) | 4 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [include/video/of\_display\_timing.h](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/include/video/of_display_timing.h?id=086ff84617185393a0bbf25830c4f36412a7d3f4) | 2 | |  |  |  | | --- | --- | --- | |

4 files changed, 53 insertions, 2 deletions

| diff --git a/drivers/video/fbdev/core/fbcon.c b/drivers/video/fbdev/core/fbcon.cindex c4e91715ef0063..1a9aa12cf88608 100644--- a/[drivers/video/fbdev/core/fbcon.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/video/fbdev/core/fbcon.c?id=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee)+++ b/[drivers/video/fbdev/core/fbcon.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/video/fbdev/core/fbcon.c?id=086ff84617185393a0bbf25830c4f36412a7d3f4)@@ -2469,6 +2469,11 @@ static int fbcon\_set\_font(struct vc\_data \*vc, struct console\_font \*font, if (charcount != 256 && charcount != 512) return -EINVAL; + /\* font bigger than screen resolution ? \*/+ if (w > FBCON\_SWAP(info->var.rotate, info->var.xres, info->var.yres) ||+ h > FBCON\_SWAP(info->var.rotate, info->var.yres, info->var.xres))+ return -EINVAL;+ /\* Make sure drawing engine can handle the font \*/ if (!(info->pixmap.blit\_x & (1 << (font->width - 1))) || !(info->pixmap.blit\_y & (1 << (font->height - 1))))@@ -2731,6 +2736,34 @@ void fbcon\_update\_vcs(struct fb\_info \*info, bool all) } EXPORT\_SYMBOL(fbcon\_update\_vcs); +/\* let fbcon check if it supports a new screen resolution \*/+int fbcon\_modechange\_possible(struct fb\_info \*info, struct fb\_var\_screeninfo \*var)+{+ struct fbcon\_ops \*ops = info->fbcon\_par;+ struct vc\_data \*vc;+ unsigned int i;++ WARN\_CONSOLE\_UNLOCKED();++ if (!ops)+ return 0;++ /\* prevent setting a screen size which is smaller than font size \*/+ for (i = first\_fb\_vc; i <= last\_fb\_vc; i++) {+ vc = vc\_cons[i].d;+ if (!vc || vc->vc\_mode != KD\_TEXT ||+ fbcon\_info\_from\_console(i) != info)+ continue;++ if (vc->vc\_font.width > FBCON\_SWAP(var->rotate, var->xres, var->yres) ||+ vc->vc\_font.height > FBCON\_SWAP(var->rotate, var->yres, var->xres))+ return -EINVAL;+ }++ return 0;+}+EXPORT\_SYMBOL\_GPL(fbcon\_modechange\_possible);+ int fbcon\_mode\_deleted(struct fb\_info \*info, struct fb\_videomode \*mode) {diff --git a/drivers/video/fbdev/core/fbmem.c b/drivers/video/fbdev/core/fbmem.cindex 8afc4538558cd7..7ee6eb2fa71517 100644--- a/[drivers/video/fbdev/core/fbmem.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/video/fbdev/core/fbmem.c?id=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee)+++ b/[drivers/video/fbdev/core/fbmem.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/video/fbdev/core/fbmem.c?id=086ff84617185393a0bbf25830c4f36412a7d3f4)@@ -511,7 +511,7 @@ static int fb\_show\_logo\_line(struct fb\_info \*info, int rotate,  while (n && (n \* (logo->width + 8) - 8 > xres)) --n;- image.dx = (xres - n \* (logo->width + 8) - 8) / 2;+ image.dx = (xres - (n \* (logo->width + 8) - 8)) / 2; image.dy = y ?: (yres - logo->height) / 2; } else { image.dx = 0;@@ -1017,6 +1017,16 @@ fb\_set\_var(struct fb\_info \*info, struct fb\_var\_screeninfo \*var) if (ret) return ret; + /\* verify that virtual resolution >= physical resolution \*/+ if (var->xres\_virtual < var->xres ||+ var->yres\_virtual < var->yres) {+ pr\_warn("WARNING: fbcon: Driver '%s' missed to adjust virtual screen size (%ux%u vs. %ux%u)\n",+ info->fix.id,+ var->xres\_virtual, var->yres\_virtual,+ var->xres, var->yres);+ return -EINVAL;+ }+ if ((var->activate & FB\_ACTIVATE\_MASK) != FB\_ACTIVATE\_NOW) return 0; @@ -1107,7 +1117,9 @@ static long do\_fb\_ioctl(struct fb\_info \*info, unsigned int cmd, return -EFAULT; console\_lock(); lock\_fb\_info(info);- ret = fb\_set\_var(info, &var);+ ret = fbcon\_modechange\_possible(info, &var);+ if (!ret)+ ret = fb\_set\_var(info, &var); if (!ret) fbcon\_update\_vcs(info, var.activate & FB\_ACTIVATE\_ALL); unlock\_fb\_info(info);diff --git a/include/linux/fbcon.h b/include/linux/fbcon.hindex ff5596dd30f855..2382dec6d6ab8e 100644--- a/[include/linux/fbcon.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/fbcon.h?id=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee)+++ b/[include/linux/fbcon.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/linux/fbcon.h?id=086ff84617185393a0bbf25830c4f36412a7d3f4)@@ -15,6 +15,8 @@ void fbcon\_new\_modelist(struct fb\_info \*info); void fbcon\_get\_requirement(struct fb\_info \*info, struct fb\_blit\_caps \*caps); void fbcon\_fb\_blanked(struct fb\_info \*info, int blank);+int fbcon\_modechange\_possible(struct fb\_info \*info,+ struct fb\_var\_screeninfo \*var); void fbcon\_update\_vcs(struct fb\_info \*info, bool all); void fbcon\_remap\_all(struct fb\_info \*info); int fbcon\_set\_con2fb\_map\_ioctl(void \_\_user \*argp);@@ -33,6 +35,8 @@ static inline void fbcon\_new\_modelist(struct fb\_info \*info) {} static inline void fbcon\_get\_requirement(struct fb\_info \*info, struct fb\_blit\_caps \*caps) {} static inline void fbcon\_fb\_blanked(struct fb\_info \*info, int blank) {}+static inline int fbcon\_modechange\_possible(struct fb\_info \*info,+ struct fb\_var\_screeninfo \*var) { return 0; } static inline void fbcon\_update\_vcs(struct fb\_info \*info, bool all) {} static inline void fbcon\_remap\_all(struct fb\_info \*info) {} static inline int fbcon\_set\_con2fb\_map\_ioctl(void \_\_user \*argp) { return 0; }diff --git a/include/video/of\_display\_timing.h b/include/video/of\_display\_timing.hindex e1126a74882a5f..eff166fdd81b95 100644--- a/[include/video/of\_display\_timing.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/video/of_display_timing.h?id=e8a4e1c1bb697b1d9fc48f0e56dc0f50bc024bee)+++ b/[include/video/of\_display\_timing.h](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/video/of_display_timing.h?id=086ff84617185393a0bbf25830c4f36412a7d3f4)@@ -8,6 +8,8 @@ #ifndef \_\_LINUX\_OF\_DISPLAY\_TIMING\_H #define \_\_LINUX\_OF\_DISPLAY\_TIMING\_H +#include <linux/errno.h>+ struct device\_node; struct display\_timing; struct display\_timings; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:38:58 +0000


