- **Root cause of vulnerability:** When a key is decrypted using `rnp_key_unprotect`, the key protection settings are overwritten, and the key material is stored in an unprotected form. Subsequently, calling `rnp_key_protect` on this key does not restore the protection settings, leaving the key material exposed. This is due to the fact that `rnp_key_unprotect` overwrites the key protection settings, and `rnp_key_protect` was not designed to restore them in this specific scenario.

- **Weaknesses/vulnerabilities present:**
    - CWE-522: Insufficiently Protected Credentials
    - CWE-922: Insecure Storage of Sensitive Information
    - The core weakness is the failure of `rnp_key_protect` to re-establish protection settings after `rnp_key_unprotect` has been used.

- **Impact of exploitation:**
    - Sensitive key material is stored in the clear, potentially allowing unauthorized access to the keys.
    - The vulnerability allows for the retrieval of embedded sensitive data (CAPEC-37).
- **Attack vectors:** The attack vector is through improper use of the RNP API, specifically by calling `rnp_key_unprotect` followed by `rnp_key_protect`.
- **Required attacker capabilities/position:** The attacker would need to be able to call the RNP library functions and manipulate keys in the described way. This might involve having access to a program using the vulnerable versions of the library, or control over how the library functions are invoked.