- **Root cause of vulnerability:** User-controlled input from `request.getHeader("Referer")`, `request.getRequestURL()`, and `request.getQueryString()` are used to construct and execute a regular expression, leading to a potential ReDoS.
- **Weaknesses/vulnerabilities present:** Regex injection vulnerability, specifically ReDoS (Regular expression Denial of Service) due to insufficient sanitization of user-controlled input when constructing a regular expression.
- **Impact of exploitation:** An attacker can cause a denial of service (DoS) by crafting a malicious input string that results in catastrophic backtracking during regex processing, leading to excessive resource consumption and making the server unresponsive.
- **Attack vectors:** The attacker can exploit this vulnerability by sending a specially crafted "Referer" header or manipulating the request URL or query string. This can be done programmatically, without needing to use a web browser.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests with malicious "Referer" headers or craft request URLs/query strings to the vulnerable Apache Roller server. The attacker does not need any specific privileges to exploit this vulnerability. The vulnerability is triggered if the "Banned-words Referrer processing" feature is enabled in Roller, which is off by default.