=== Content from git.kernel.org_1a524734_20250115_090011.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Norbert Slusarek <nslusarek@gmx.net> | 2021-06-12 22:18:54 +0200 |
| --- | --- | --- |
| committer | Marc Kleine-Budde <mkl@pengutronix.de> | 2021-06-16 12:52:18 +0200 |
| commit | [5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)) | |
| tree | [65e6bfa6d5758582377e6be43fb1d799372f6571](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc) | |
| parent | [8d0caedb759683041d9db82069937525999ada53](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8d0caedb759683041d9db82069937525999ada53) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc&id2=8d0caedb759683041d9db82069937525999ada53)) | |
| download | [linux-5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc.tar.gz) | |

can: bcm: fix infoleak in struct bcm\_msg\_headOn 64-bit systems, struct bcm\_msg\_head has an added padding of 4 bytes between
struct members count and ival1. Even though all struct members are initialized,
the 4-byte hole will contain data from the kernel stack. This patch zeroes out
struct bcm\_msg\_head before usage, preventing infoleaks to userspace.
Fixes: ffd980f976e7 ("[CAN]: Add broadcast manager (bcm) protocol")
Link: [https://lore.kernel.org/r/trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177@3c-app-gmx-bs52](https://lore.kernel.org/r/trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52)
Cc: linux-stable <stable@vger.kernel.org>
Signed-off-by: Norbert Slusarek <nslusarek@gmx.net>
Acked-by: Oliver Hartkopp <socketcan@hartkopp.net>
Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)

| -rw-r--r-- | [net/can/bcm.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/can/bcm.c?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/net/can/bcm.c b/net/can/bcm.cindex f00176b2a6c30b..f3e4d9528fa387 100644--- a/[net/can/bcm.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/can/bcm.c?id=8d0caedb759683041d9db82069937525999ada53)+++ b/[net/can/bcm.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/can/bcm.c?id=5e87ddbe3942e27e939bdc02deb8579b0cbd8ecc)@@ -406,6 +406,7 @@ static enum hrtimer\_restart bcm\_tx\_timeout\_handler(struct hrtimer \*hrtimer) if (!op->count && (op->flags & TX\_COUNTEVT)) {  /\* create notification to user \*/+ memset(&msg\_head, 0, sizeof(msg\_head)); msg\_head.opcode = TX\_EXPIRED; msg\_head.flags = op->flags; msg\_head.count = op->count;@@ -443,6 +444,7 @@ static void bcm\_rx\_changed(struct bcm\_op \*op, struct canfd\_frame \*data) /\* this element is not throttled anymore \*/ data->flags &= (BCM\_CAN\_FLAGS\_MASK|RX\_RECV); + memset(&head, 0, sizeof(head)); head.opcode = RX\_CHANGED; head.flags = op->flags; head.count = op->count;@@ -564,6 +566,7 @@ static enum hrtimer\_restart bcm\_rx\_timeout\_handler(struct hrtimer \*hrtimer) }  /\* create notification to user \*/+ memset(&msg\_head, 0, sizeof(msg\_head)); msg\_head.opcode = RX\_TIMEOUT; msg\_head.flags = op->flags; msg\_head.count = op->count; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 08:58:48 +0000



=== Content from www.debian.org_ee242925_20250115_090013.html ===


---

[[Date Prev](msg00123.html)][[Date Next](msg00125.html)]
[[Thread Prev](msg00123.html)][[Thread Next](msg00125.html)]
[[Date Index](maillist.html#00124)]
[[Thread Index](threads.html#00124)]

# [SECURITY] [DSA 4941-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4941-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 20 Jul 2021 12:53:32 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1m5pFc-00076h-2M%40seger.debian.org)Â [E1m5pFc-00076h-2M@seger.debian.org](msg00124.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4941-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
July 20, 2021                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2020-36311 CVE-2021-3609 CVE-2021-33909 CVE-2021-34693

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2020-36311

    A flaw was discovered in the KVM subsystem for AMD CPUs, allowing an
    attacker to cause a denial of service by triggering destruction of a
    large SEV VM.

CVE-2021-3609

    Norbert Slusarek reported a race condition vulnerability in the CAN
    BCM networking protocol, allowing a local attacker to escalate
    privileges.

CVE-2021-33909

    The Qualys Research Labs discovered a size_t-to-int conversion
    vulnerability in the Linux kernel's filesystem layer. An
    unprivileged local attacker able to create, mount, and then delete a
    deep directory structure whose total path length exceeds 1GB, can
    take advantage of this flaw for privilege escalation.

    Details can be found in the Qualys advisory at
    <https://www.qualys.com/2021/07/20/cve-2021-33909/sequoia-local-privilege-escalation-linux.txt>

CVE-2021-34693

    Norbert Slusarek discovered an information leak in the CAN BCM
    networking protocol. A local attacker can take advantage of this
    flaw to obtain sensitive information from kernel stack memory.

For the stable distribution (buster), these problems have been fixed in
version 4.19.194-3.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmD2xvFfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0Tp/g//af2JkknfeqLs9FHFlqiYvIl1co4zEOW6e4BO8WAtvB3q5+scTNiFgN/W
66o9sDTi+Bnuhxja/lsZEkwM5QnrcPCSndUuY8EIOBDRdAla9R3xf4vUSYQ4KVb8
re3NmfzlkiLiGd6JRZXeV8+8stUjbLc6e0EG36S2HJ6hDs7pOA+vxcR/ui8yf15e
p9egIKOqznhsNFHgrZRm4R1yqgNzfkFBWeSgfuFZGsFi9b2I3FJQKDTx0TXwxerB
PKtvstJ1/xKbtK8m5IdntLOPeUPXuUlhoff4cN192IRNrPCcUXf7vRJoGg6A7WP2
dfvErldL8AsJHMBEs6YqEQSajFMoJX2590Bt8VK1xZwvhirSB7ZClk4+boh8OhlG
apKj/OPIi3KGPt2s8t23zq3cU6aAFyTp6VQacuS+kR/2bdF0H3iQKcB5I4HFSSx9
BxK0ZpcZSw4axt35lfVhqnoeARb2GtUBqO77CWOOdtXcxDACD3VQ8PiqxxfpGS26
V/ASWmWzCeoGs+FQ5iRoN2JC5i9VcJX32r0fbNVvj7BG+ZQBe5XZ30eOalQLPs4/
SQnBoWuMnIpl/5+6FxkPXiqzkDGnkUm2ep2gXhdFrJmn/3ugpMiAPEuETo7Q2Lfj
Ze6DKkHJPBK2BaKs1UgWPNvQBVQrcs0rKMLEf6LxS0eAJHlcCdo=
=dhUe
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_89078771_20250115_090010.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2021/06/14/1) [[next>]](../../../2021/06/16/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <trinity-755bb2d7-d377-4996-952b-6a5cebfff497-1623789198841@3c-app-gmx-bap35>
Date: Tue, 15 Jun 2021 22:33:18 +0200
From: Norbert Slusarek <nslusarek@....net>
To: oss-security@...ts.openwall.com
Cc: socketcan@...tkopp.net, mkl@...gutronix.de, menschel.p@...teo.de
Subject: CVE-2021-34693: Infoleak in CAN BCM protocol in Linux kernel

Hello,

this is an announcement for recently reported infoleaks in the CAN BCM
networking protocol in the Linux kernel.

The vulnerability has been assigned CVE-2021-34693 and was found in kernels
ranging from 2.6.25-rc1 to 5.12.10.

The infoleak can be found in struct bcm_msg_head, which is a structure used to
describe CAN BCM messages. Due to an automatically introduced padding,
the structure contains a 4-byte hole which is never initialized. The 4-byte hole
will contain data from the kernel stack as the structure is allocated on the
stack. Depending on the architecture, the leak happens at different places
within the structure.

On 64-bit systems,
the 4-byte hole can be found between struct members count and ival1.
In this case, kernel addresses can be partially revealed.

On 32-bit systems,
the 4-byte hole can be found between struct members nframes and frames[0].
In this case, kernel addresses can be fully revealed, resulting in a feasible
KASLR bypass.

The leak can be reached by an unprivileged user by
reproducing the following steps:

- open and connect a CAN BCM socket
- sendmsg() with RX_SETUP on socket to setup CAN BCM message receiver
- message will be received by the message receiver, packed with struct
  bcm_msg_head and queued for reception
- recvmsg() to receive the message, finally leaking the uninitialized bytes to
  userspace

The patch can be found in the link below or in the attachments.
[https://lore.kernel.org/netdev/trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076@3c-app-gmx-bs04/T/#me01c68ad3b6784f533f1b1509c95943bb5911457](https://lore.kernel.org/netdev/trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/T/#me01c68ad3b6784f533f1b1509c95943bb5911457)

A short PoC can be found in the link below or in the attachments.
<https://github.com/nrb547/kernel-exploitation/tree/main/cve-2021-34693>

Credits go out to Norbert Slusarek and Patrick Menschel.

View attachment "[0001-fix-infoleak.patch](1/1)" of type "text/x-patch" (1851 bytes)

View attachment "[poc.c](1/2)" of type "text/plain" (1543 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lore.kernel.org_7854310a_20250115_090012.html ===

```
[netdev.vger.kernel.org archive mirror](../../?t=20210615204022)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#ee01c68ad3b6784f533f1b1509c95943bb5911457) [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
@ 2021-06-12 21:09 Norbert Slusarek
  2021-06-13  9:51 ` [Oliver Hartkopp](#mca8e246a82bbe24388a85138669fa43101008ac9)
  2021-06-14  7:20 ` [Marc Kleine-Budde](#m542934b521e421063c1fe513f7e38cf314f29679)
  [0 siblings, 2 replies; 8+ messages in thread](#re01c68ad3b6784f533f1b1509c95943bb5911457)
From: Norbert Slusarek @ 2021-06-12 21:09 UTC ([permalink](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/) / [raw](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/raw))
  To: socketcan; +Cc: mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210612210937), [netdev](../../../netdev/?t=20210612210937)

From: Norbert Slusarek <nslusarek@gmx.net>
Date: Sat, 12 Jun 2021 22:18:54 +0200
Subject: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head

On 64-bit systems, struct bcm_msg_head has an added padding of 4 bytes between
struct members count and ival1. Even though all struct members are initialized,
the 4-byte hole will contain data from the kernel stack. This patch zeroes out
struct bcm_msg_head before usage, preventing infoleaks to userspace.

Fixes: ffd980f976e7 ("[CAN]: Add broadcast manager (bcm) protocol")
Signed-off-by: Norbert Slusarek <nslusarek@gmx.net>

---
 [net/can/bcm.c](#Z2e.:..:trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177::403c-app-gmx-bs52:1net:can:bcm.c) | 3 +++
 1 file [changed](#ee01c68ad3b6784f533f1b1509c95943bb5911457), 3 insertions(+)

[diff](#iZ2e.:..:trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177::403c-app-gmx-bs52:1net:can:bcm.c) --git a/net/can/bcm.c b/net/can/bcm.c
index 909b9e684e04..b03062f84fe7 100644
--- a/net/can/bcm.c
+++ b/net/can/bcm.c
@@ -402,6 +402,7 @@ static enum hrtimer_restart bcm_tx_timeout_handler(struct hrtimer *hrtimer)
                if (!op->count && (op->flags & TX_COUNTEVT)) {

                        /* create notification to user */
+                       memset(&msg_head, 0, sizeof(msg_head));
                        msg_head.opcode  = TX_EXPIRED;
                        msg_head.flags   = op->flags;
                        msg_head.count   = op->count;
@@ -439,6 +440,7 @@ static void bcm_rx_changed(struct bcm_op *op, struct canfd_frame *data)
        /* this element is not throttled anymore */
        data->flags &= (BCM_CAN_FLAGS_MASK|RX_RECV);

+       memset(&head, 0, sizeof(head));
        head.opcode  = RX_CHANGED;
        head.flags   = op->flags;
        head.count   = op->count;
@@ -560,6 +562,7 @@ static enum hrtimer_restart bcm_rx_timeout_handler(struct hrtimer *hrtimer)
        }

        /* create notification to user */
+       memset(&msg_head, 0, sizeof(msg_head));
        msg_head.opcode  = RX_TIMEOUT;
        msg_head.flags   = op->flags;
        msg_head.count   = op->count;
--
2.30.2

[^](#me01c68ad3b6784f533f1b1509c95943bb5911457) [permalink](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/) [raw](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/raw) [reply](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/#R) [related](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/#related)	[[flat](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/T/#u)|[nested](../../trinity-7c1b2e82-e34f-4885-8060-2cd7a13769ce-1623532166177%403c-app-gmx-bs52/t/#u)] [8+ messages in thread](#re01c68ad3b6784f533f1b1509c95943bb5911457)
```

---

```
[*](#eca8e246a82bbe24388a85138669fa43101008ac9) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-12 21:09 [[PATCH] can: bcm: fix infoleak in struct bcm_msg_head](#me01c68ad3b6784f533f1b1509c95943bb5911457) Norbert Slusarek
@ 2021-06-13  9:51 ` Oliver Hartkopp
  2021-06-13 11:18   ` [Patrick Menschel](#m8086578fbd88e880755332170c5e3efbc8150aca)
  2021-06-14  7:20 ` [Marc Kleine-Budde](#m542934b521e421063c1fe513f7e38cf314f29679)
  [1 sibling, 1 reply; 8+ messages in thread](#rca8e246a82bbe24388a85138669fa43101008ac9)
From: Oliver Hartkopp @ 2021-06-13  9:51 UTC ([permalink](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/) / [raw](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/raw))
  To: Norbert Slusarek; +Cc: mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210613095154), [netdev](../../../netdev/?t=20210613095154)

On 12.06.21 23:09, Norbert Slusarek wrote:
> From: Norbert Slusarek <nslusarek@gmx.net>
> Date: Sat, 12 Jun 2021 22:18:54 +0200
> Subject: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
>
> On 64-bit systems, struct bcm_msg_head has an added padding of 4 bytes between
> struct members count and ival1. Even though all struct members are initialized,
> the 4-byte hole will contain data from the kernel stack. This patch zeroes out
> struct bcm_msg_head before usage, preventing infoleaks to userspace.
>
> Fixes: ffd980f976e7 ("[CAN]: Add broadcast manager (bcm) protocol")
> Signed-off-by: Norbert Slusarek <nslusarek@gmx.net>

Acked-by: Oliver Hartkopp <socketcan@hartkopp.net>

Thanks Norbert!

Yes, when this data structure was created in 2003 either 64 bit machines
were far away for me and infoleaks were not a hot topic like today.

Would be interesting to check where data structures are used in the
Linux UAPI that became an infoleak in the 32-to-64-bit compilation
transistion.

Thanks for the heads up!

Best regards,
Oliver

>
> ---
>   net/can/bcm.c | 3 +++
>   1 file changed, 3 insertions(+)
>
> diff --git a/net/can/bcm.c b/net/can/bcm.c
> index 909b9e684e04..b03062f84fe7 100644
> --- a/net/can/bcm.c
> +++ b/net/can/bcm.c
> @@ -402,6 +402,7 @@ static enum hrtimer_restart bcm_tx_timeout_handler(struct hrtimer *hrtimer)
>                  if (!op->count && (op->flags & TX_COUNTEVT)) {
>
>                          /* create notification to user */
> +                       memset(&msg_head, 0, sizeof(msg_head));
>                          msg_head.opcode  = TX_EXPIRED;
>                          msg_head.flags   = op->flags;
>                          msg_head.count   = op->count;
> @@ -439,6 +440,7 @@ static void bcm_rx_changed(struct bcm_op *op, struct canfd_frame *data)
>          /* this element is not throttled anymore */
>          data->flags &= (BCM_CAN_FLAGS_MASK|RX_RECV);
>
> +       memset(&head, 0, sizeof(head));
>          head.opcode  = RX_CHANGED;
>          head.flags   = op->flags;
>          head.count   = op->count;
> @@ -560,6 +562,7 @@ static enum hrtimer_restart bcm_rx_timeout_handler(struct hrtimer *hrtimer)
>          }
>
>          /* create notification to user */
> +       memset(&msg_head, 0, sizeof(msg_head));
>          msg_head.opcode  = RX_TIMEOUT;
>          msg_head.flags   = op->flags;
>          msg_head.count   = op->count;
> --
> 2.30.2
>

[^](#mca8e246a82bbe24388a85138669fa43101008ac9) [permalink](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/) [raw](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/raw) [reply](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/#R)	[[flat](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/T/#u)|[nested](../../f9d008bc-2416-8032-0005-35d7c6d87fc1%40hartkopp.net/t/#u)] [8+ messages in thread](#rca8e246a82bbe24388a85138669fa43101008ac9)
```

---

```
[*](#e8086578fbd88e880755332170c5e3efbc8150aca) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-13  9:51 ` [Oliver Hartkopp](#mca8e246a82bbe24388a85138669fa43101008ac9)
@ 2021-06-13 11:18   ` Patrick Menschel
  2021-06-13 13:35     ` [Norbert Slusarek](#md2b6dde1aa527f3b41dfeda9897b0f2a523d5d01)
  [0 siblings, 1 reply; 8+ messages in thread](#r8086578fbd88e880755332170c5e3efbc8150aca)
From: Patrick Menschel @ 2021-06-13 11:18 UTC ([permalink](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/) / [raw](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/raw))
  To: Oliver Hartkopp, Norbert Slusarek; +Cc: mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210613111838), [netdev](../../../netdev/?t=20210613111838)

Am 13.06.21 um 11:51 schrieb Oliver Hartkopp:
>
>
> On 12.06.21 23:09, Norbert Slusarek wrote:
>> From: Norbert Slusarek <nslusarek@gmx.net>
>> Date: Sat, 12 Jun 2021 22:18:54 +0200
>> Subject: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
>>
>> On 64-bit systems, struct bcm_msg_head has an added padding of 4 bytes
>> between
>> struct members count and ival1. Even though all struct members are
>> initialized,
>> the 4-byte hole will contain data from the kernel stack. This patch
>> zeroes out
>> struct bcm_msg_head before usage, preventing infoleaks to userspace.
>>
>> Fixes: ffd980f976e7 ("[CAN]: Add broadcast manager (bcm) protocol")
>> Signed-off-by: Norbert Slusarek <nslusarek@gmx.net>
>
> Acked-by: Oliver Hartkopp <socketcan@hartkopp.net>
>
> Thanks Norbert!
>
> Yes, when this data structure was created in 2003 either 64 bit machines
> were far away for me and infoleaks were not a hot topic like today.
>
> Would be interesting to check where data structures are used in the
> Linux UAPI that became an infoleak in the 32-to-64-bit compilation
> transistion.
>
Hi,

1.
Are you sure this leak really happens on 64-bit and not on 32-bit instead?

I remember I got the problems with bcm msg head on the 32bit raspberry
pi because I missed the alignment by accident.

When I calculate the size of msg head on a Ryzen 1800X with Python
3.9.5, I get:

struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
(56, 56)

First Value is raw, the second value is the alignment hack with the zero
length quad word "0q".

On the 32bit raspberry pi, same op results in the gap.

struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
(36, 40)

2.
Finding stucts with non-zero-ed gaps should be easy with a skript or
even better with a GCC directive. I believe Syzbot does such a thing too.

Kind Regards,
Patrick Menschel

[^](#m8086578fbd88e880755332170c5e3efbc8150aca) [permalink](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/) [raw](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/raw) [reply](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/#R)	[[flat](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/T/#u)|[nested](../../34cc6b6a-6eb0-f3ce-1864-9057b80fab9e%40posteo.de/t/#u)] [8+ messages in thread](#r8086578fbd88e880755332170c5e3efbc8150aca)
```

---

```
[*](#ed2b6dde1aa527f3b41dfeda9897b0f2a523d5d01) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-13 11:18   ` [Patrick Menschel](#m8086578fbd88e880755332170c5e3efbc8150aca)
@ 2021-06-13 13:35     ` Norbert Slusarek
  2021-06-13 15:36       ` [Patrick Menschel](#mcee7524537c6d4a86b5126e99c81622c7bfcd211)
  [0 siblings, 1 reply; 8+ messages in thread](#rd2b6dde1aa527f3b41dfeda9897b0f2a523d5d01)
From: Norbert Slusarek @ 2021-06-13 13:35 UTC ([permalink](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/) / [raw](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/raw))
  To: Patrick Menschel; +Cc: Oliver Hartkopp, mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210613133601), [netdev](../../../netdev/?t=20210613133601)

>Hi,
>
>1.
>Are you sure this leak really happens on 64-bit and not on 32-bit instead?
>
>I remember I got the problems with bcm msg head on the 32bit raspberry
>pi because I missed the alignment by accident.
>
>When I calculate the size of msg head on a Ryzen 1800X with Python
>3.9.5, I get:
>
>struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
>(56, 56)
>
>First Value is raw, the second value is the alignment hack with the zero
>length quad word "0q".
>
>On the 32bit raspberry pi, same op results in the gap.
>
>struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
>(36, 40)

Hey Patrick,

having reproduced this leak I could only observe the issue on 64-bit systems.
I've just tested it on a 32-bit OS running on a raspberry pi and I couldn't observe
any leak. The offset difference on 32-bit between count and ival1 is 4.
On 64-bit systems, it's 8:

(gdb) ptype struct bcm_msg_head
type = struct bcm_msg_head {
    __u32 opcode;
    __u32 flags;
    __u32 count;
    struct bcm_timeval ival1;
    struct bcm_timeval ival2;
    canid_t can_id;
    __u32 nframes;
    struct can_frame frames[0];
}
(gdb) p/x &((struct bcm_msg_head *)0x0)->count
$1 = 0x8
(gdb) p/x &((struct bcm_msg_head *)0x0)->ival1
$2 = 0x10
(gdb) p sizeof(((struct bcm_msg_head *)0x0)->count)
$3 = 4

>2.
>Finding stucts with non-zero-ed gaps should be easy with a skript or
>even better with a GCC directive. I believe Syzbot does such a thing too.
>
>Kind Regards,
>Patrick Menschel

I didn't notice any syzbot report about this leak, nor did I find it with syzkaller.

Norbert

[^](#md2b6dde1aa527f3b41dfeda9897b0f2a523d5d01) [permalink](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/) [raw](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/raw) [reply](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/#R)	[[flat](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/T/#u)|[nested](../../trinity-0d8be729-1e3c-452c-8171-962963abed0d-1623591348277%403c-app-gmx-bap71/t/#u)] [8+ messages in thread](#rd2b6dde1aa527f3b41dfeda9897b0f2a523d5d01)
```

---

```
[*](#ecee7524537c6d4a86b5126e99c81622c7bfcd211) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-13 13:35     ` [Norbert Slusarek](#md2b6dde1aa527f3b41dfeda9897b0f2a523d5d01)
@ 2021-06-13 15:36       ` Patrick Menschel
  2021-06-13 18:33         ` [Norbert Slusarek](#m996da3b1741747afbb7a8be8a781f704b6b58936)
  [0 siblings, 1 reply; 8+ messages in thread](#rcee7524537c6d4a86b5126e99c81622c7bfcd211)
From: Patrick Menschel @ 2021-06-13 15:36 UTC ([permalink](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/) / [raw](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/raw))
  To: Norbert Slusarek; +Cc: Oliver Hartkopp, mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210613153656), [netdev](../../../netdev/?t=20210613153656)

Am 13.06.21 um 15:35 schrieb Norbert Slusarek:
>> Hi,
>>
>> 1.
>> Are you sure this leak really happens on 64-bit and not on 32-bit instead?
>>
>> I remember I got the problems with bcm msg head on the 32bit raspberry
>> pi because I missed the alignment by accident.
>>
>> When I calculate the size of msg head on a Ryzen 1800X with Python
>> 3.9.5, I get:
>>
>> struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
>> (56, 56)
>>
>> First Value is raw, the second value is the alignment hack with the zero
>> length quad word "0q".
>>
>> On the 32bit raspberry pi, same op results in the gap.
>>
>> struct.calcsize("IIIllllII"),struct.calcsize("IIIllllII0q")
>> (36, 40)
>
> Hey Patrick,
>
> having reproduced this leak I could only observe the issue on 64-bit systems.
> I've just tested it on a 32-bit OS running on a raspberry pi and I couldn't observe
> any leak. The offset difference on 32-bit between count and ival1 is 4.
> On 64-bit systems, it's 8:
>
> (gdb) ptype struct bcm_msg_head
> type = struct bcm_msg_head {
>     __u32 opcode;
>     __u32 flags;
>     __u32 count;
>     struct bcm_timeval ival1;
>     struct bcm_timeval ival2;
>     canid_t can_id;
>     __u32 nframes;
>     struct can_frame frames[0];
> }
> (gdb) p/x &((struct bcm_msg_head *)0x0)->count
> $1 = 0x8
> (gdb) p/x &((struct bcm_msg_head *)0x0)->ival1
> $2 = 0x10
> (gdb) p sizeof(((struct bcm_msg_head *)0x0)->count)
> $3 = 4
>

Ouch,

I should not skip lines while reading.
We're talking about different gaps as it seems. I didn't realize the gap
in front of ival1 before.

There is also a gap in between nframes and frames[0].
That one is caused by align(8) of data in struct can_frame.
It propagates upwards into that gap on 32bit arch.
You can find it if you actually fill frames[] with a frame.

I found it while concatenating bcm_msg_head and a can frame into a
python bytearray which was too short for the raspberry pi as I forgot
the alignment.

I came up with a format string "IIIllllII0q" for bcm_msg_head.

Kind Regards,
Patrick

[^](#mcee7524537c6d4a86b5126e99c81622c7bfcd211) [permalink](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/) [raw](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/raw) [reply](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/#R)	[[flat](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/T/#u)|[nested](../../a44df2a0-a403-40ba-3312-c6eb53ddf291%40posteo.de/t/#u)] [8+ messages in thread](#rcee7524537c6d4a86b5126e99c81622c7bfcd211)
```

---

```
[*](#e996da3b1741747afbb7a8be8a781f704b6b58936) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-13 15:36       ` [Patrick Menschel](#mcee7524537c6d4a86b5126e99c81622c7bfcd211)
@ 2021-06-13 18:33         ` Norbert Slusarek
  [0 siblings, 0 replies; 8+ messages in thread](#r996da3b1741747afbb7a8be8a781f704b6b58936)
From: Norbert Slusarek @ 2021-06-13 18:33 UTC ([permalink](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/) / [raw](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/raw))
  To: Patrick Menschel; +Cc: Oliver Hartkopp, mkl, davem, kuba, [linux-can](../../../linux-can/?t=20210613183348), [netdev](../../../netdev/?t=20210613183348)

>Ouch,
>
>I should not skip lines while reading.
>We're talking about different gaps as it seems. I didn't realize the gap
>in front of ival1 before.
>
>There is also a gap in between nframes and frames[0].
>That one is caused by align(8) of data in struct can_frame.
>It propagates upwards into that gap on 32bit arch.
>You can find it if you actually fill frames[] with a frame.
>
>I found it while concatenating bcm_msg_head and a can frame into a
>python bytearray which was too short for the raspberry pi as I forgot
>the alignment.
>
>I came up with a format string "IIIllllII0q" for bcm_msg_head.
>
>Kind Regards,
>Patrick

I confirm that there is a similar 4-byte leak happening on 32-bit systems.
It's possible to retrieve kernel addresses etc. which allows for a KASLR
bypass. I will request a CVE and publish a notice regarding
this on oss-security where I will mention Patrick too.

Anyways, this patch seems to be working for the leak on 32-bit systems as well.

Norbert

[^](#m996da3b1741747afbb7a8be8a781f704b6b58936) [permalink](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/) [raw](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/raw) [reply](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/#R)	[[flat](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/T/#u)|[nested](../../trinity-87eaea25-2a7d-4aa9-92a5-269b822e5d95-1623609211076%403c-app-gmx-bs04/t/#u)] [8+ messages in thread](#r996da3b1741747afbb7a8be8a781f704b6b58936)
```

---

```
[*](#e542934b521e421063c1fe513f7e38cf314f29679) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-12 21:09 [[PATCH] can: bcm: fix infoleak in struct bcm_msg_head](#me01c68ad3b6784f533f1b1509c95943bb5911457) Norbert Slusarek
  2021-06-13  9:51 ` [Oliver Hartkopp](#mca8e246a82bbe24388a85138669fa43101008ac9)
@ 2021-06-14  7:20 ` Marc Kleine-Budde
  2021-06-15 20:40   ` [Norbert Slusarek](#m0c40b5249344d205e3e1eaa26fdf0ed411d405a0)
  [1 sibling, 1 reply; 8+ messages in thread](#r542934b521e421063c1fe513f7e38cf314f29679)
From: Marc Kleine-Budde @ 2021-06-14  7:20 UTC ([permalink](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/) / [raw](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/raw))
  To: Norbert Slusarek; +Cc: socketcan, davem, kuba, [linux-can](../../../linux-can/?t=20210614072108), [netdev](../../../netdev/?t=20210614072108)

[[-- Attachment #1: Type: text/plain, Size: 1103 bytes --]](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/1-a.txt)

On 12.06.2021 23:09:26, Norbert Slusarek wrote:
> From: Norbert Slusarek <nslusarek@gmx.net>
> Date: Sat, 12 Jun 2021 22:18:54 +0200
> Subject: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
>
> On 64-bit systems, struct bcm_msg_head has an added padding of 4 bytes between
> struct members count and ival1. Even though all struct members are initialized,
> the 4-byte hole will contain data from the kernel stack. This patch zeroes out
> struct bcm_msg_head before usage, preventing infoleaks to userspace.
>
> Fixes: ffd980f976e7 ("[CAN]: Add broadcast manager (bcm) protocol")
> Signed-off-by: Norbert Slusarek <nslusarek@gmx.net>

Added to linux-can/testing.

regards,
Marc

P.S.: I think the gmx web interface mangled the patch and converted tabs
to spaces. Try to use git send-mail to avoid this.

--
Pengutronix e.K.                 | Marc Kleine-Budde           |
Embedded Linux                   | <https://www.pengutronix.de>  |
Vertretung West/Dortmund         | Phone: +49-231-2826-924     |
Amtsgericht Hildesheim, HRA 2686 | Fax:   +49-5121-206917-5555 |

[[-- Attachment #2: signature.asc --]
[-- Type: application/pgp-signature, Size: 488 bytes --]](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/2-signature.asc)

[^](#m542934b521e421063c1fe513f7e38cf314f29679) [permalink](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/) [raw](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/raw) [reply](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/#R)	[[flat](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/T/#u)|[nested](../../20210614072058.syvgyz7lexexsvxp%40pengutronix.de/t/#u)] [8+ messages in thread](#r542934b521e421063c1fe513f7e38cf314f29679)
```

---

```
[*](#e0c40b5249344d205e3e1eaa26fdf0ed411d405a0) Re: [PATCH] can: bcm: fix infoleak in struct bcm_msg_head
  2021-06-14  7:20 ` [Marc Kleine-Budde](#m542934b521e421063c1fe513f7e38cf314f29679)
@ 2021-06-15 20:40   ` Norbert Slusarek
  [0 siblings, 0 replies; 8+ messages in thread](#r0c40b5249344d205e3e1eaa26fdf0ed411d405a0)
From: Norbert Slusarek @ 2021-06-15 20:40 UTC ([permalink](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/) / [raw](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/raw))
  To: Marc Kleine-Budde; +Cc: socketcan, davem, kuba, [linux-can](../../../linux-can/?t=20210615204022), [netdev](../../../netdev/?t=20210615204022)

The issue has been assigned CVE-2021-34693 and the announcement on
oss-security is available in the link below.
<https://www.openwall.com/lists/oss-security/2021/06/15/1>

Norbert

[^](#m0c40b5249344d205e3e1eaa26fdf0ed411d405a0) [permalink](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/) [raw](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/raw) [reply](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/#R)	[[flat](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/T/#u)|[nested](../../trinity-b69ee8f7-2a39-428c-898e-1b55a48ff9cf-1623789610211%403c-app-gmx-bap35/t/#u)] [8+ messages in thread](#r0c40b5249344d205e3e1eaa26fdf0ed411d405a0)
```

---

```
end of thread, other threads:[[~2021-06-15 20:40 UTC](../../?t=20210615204022) | [newest](../../)]

Thread overview: 8+ messages (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2021-06-12 21:09 [[PATCH] can: bcm: fix infoleak in struct bcm_msg_head](#me01c68ad3b6784f533f1b1509c95943bb5911457) Norbert Slusarek
2021-06-13  9:51 ` [Oliver Hartkopp](#mca8e246a82bbe24388a85138669fa43101008ac9)
2021-06-13 11:18   ` [Patrick Menschel](#m8086578fbd88e880755332170c5e3efbc8150aca)
2021-06-13 13:35     ` [Norbert Slusarek](#md2b6dde1aa527f3b41dfeda9897b0f2a523d5d01)
2021-06-13 15:36       ` [Patrick Menschel](#mcee7524537c6d4a86b5126e99c81622c7bfcd211)
2021-06-13 18:33         ` [Norbert Slusarek](#m996da3b1741747afbb7a8be8a781f704b6b58936)
2021-06-14  7:20 ` [Marc Kleine-Budde](#m542934b521e421063c1fe513f7e38cf314f29679)
2021-06-15 20:40   ` [Norbert Slusarek](#m0c40b5249344d205e3e1eaa26fdf0ed411d405a0)

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from lists.debian.org_736065e8_20250115_090011.html ===


---

[[Date Prev](msg00013.html)][[Date Next](msg00015.html)]
[[Thread Prev](msg00013.html)][[Thread Next](msg00015.html)]
[[Date Index](maillist.html#00014)]
[[Thread Index](threads.html#00014)]

# [SECURITY] [DLA 2713-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2713-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Tue, 20 Jul 2021 21:50:49 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/YPcpGZ5Im3ihYONO%40decadent.org.uk)Â [YPcpGZ5Im3ihYONO@decadent.org.uk](msg00014.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2713-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
July 20, 2021                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.9.272-2
CVE ID         : CVE-2021-3609 CVE-2021-21781 CVE-2021-33909 CVE-2021-34693
Debian Bug     : 990072

Brief introduction

CVE-2021-3609

    Norbert Slusarek reported a race condition vulnerability in the CAN
    BCM networking protocol, allowing a local attacker to escalate
    privileges.

CVE-2021-21781

    "Lilith >_>" of Cisco Talos discovered that the Arm initialisation
    code does not fully initialise the "sigpage" that is mapped into
    user-space processes to support signal handling.  This could
    result in leaking sensitive information, particularly when the
    system is rebooted.

CVE-2021-33909

    The Qualys Research Labs discovered a size_t-to-int conversion
    vulnerability in the Linux kernel's filesystem layer. An
    unprivileged local attacker able to create, mount, and then delete a
    deep directory structure whose total path length exceeds 1GB, can
    take advantage of this flaw for privilege escalation.

    Details can be found in the Qualys advisory at
    <https://www.qualys.com/2021/07/20/cve-2021-33909/sequoia-local-privilege-escalation-linux.txt>

CVE-2021-34693

    Norbert Slusarek discovered an information leak in the CAN BCM
    networking protocol. A local attacker can take advantage of this
    flaw to obtain sensitive information from kernel stack memory.

For Debian 9 stretch, these problems have been fixed in version
4.9.272-2.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgpfLXSe9qkun.pgp)**

*Description:* PGP signature

---



=== Content from lists.debian.org_eb10daea_20250115_090011.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 2714-1] linux-4.19 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2714-1] linux-4.19 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Tue, 20 Jul 2021 21:58:55 +0200
* *Message-id*: <YPcq/xL10kB6yHO7@decadent.org.uk>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2714-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
July 20, 2021                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-4.19
Version        : 4.19.194-3~deb9u1
CVE ID         : CVE-2020-36311 CVE-2021-3609 CVE-2021-33909 CVE-2021-34693
Debian Bug     : 990072

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

This update is not yet available for the armhf (ARM EABI hard-float)
architecture.

CVE-2020-36311

    A flaw was discovered in the KVM subsystem for AMD CPUs, allowing an
    attacker to cause a denial of service by triggering destruction of a
    large SEV VM.

CVE-2021-3609

    Norbert Slusarek reported a race condition vulnerability in the CAN
    BCM networking protocol, allowing a local attacker to escalate
    privileges.

CVE-2021-33909

    The Qualys Research Labs discovered a size_t-to-int conversion
    vulnerability in the Linux kernel's filesystem layer. An
    unprivileged local attacker able to create, mount, and then delete a
    deep directory structure whose total path length exceeds 1GB, can
    take advantage of this flaw for privilege escalation.

    Details can be found in the Qualys advisory at
    <https://www.qualys.com/2021/07/20/cve-2021-33909/sequoia-local-privilege-escalation-linux.txt>

CVE-2021-34693

    Norbert Slusarek discovered an information leak in the CAN BCM
    networking protocol. A local attacker can take advantage of this
    flaw to obtain sensitive information from kernel stack memory.

For Debian 9 stretch, these problems have been fixed in version
4.19.194-3~deb9u1.  This additionally fixes a regression in the
previous update (#990072) that affected LXC.

We recommend that you upgrade your linux-4.19 packages.

For the detailed security status of linux-4.19 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-4.19>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgpsmmJY6uUMo.pgp)**

*Description:* PGP signature

---



=== Content from lists.debian.org_5a4fa090_20250115_090011.html ===


---

[[Date Prev](msg00015.html)][[Date Next](msg00017.html)]
[[Thread Prev](msg00015.html)][[Thread Next](msg00017.html)]
[[Date Index](maillist.html#00016)]
[[Thread Index](threads.html#00016)]

# [SECURITY] [DLA 2713-2] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2713-2] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Tue, 20 Jul 2021 22:03:38 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/YPcsGsuXGcPUx40W%40decadent.org.uk)Â [YPcsGsuXGcPUx40W@decadent.org.uk](msg00016.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2713-2                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
July 20, 2021                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.9.272-2
CVE ID         : CVE-2021-3609 CVE-2021-21781 CVE-2021-33909 CVE-2021-34693
Debian Bug     : 990072

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

This updated advisory text fills in information omitted in the
original advisory.

CVE-2021-3609

    Norbert Slusarek reported a race condition vulnerability in the CAN
    BCM networking protocol, allowing a local attacker to escalate
    privileges.

CVE-2021-21781

    "Lilith >_>" of Cisco Talos discovered that the Arm initialisation
    code does not fully initialise the "sigpage" that is mapped into
    user-space processes to support signal handling.  This could
    result in leaking sensitive information, particularly when the
    system is rebooted.

CVE-2021-33909

    The Qualys Research Labs discovered a size_t-to-int conversion
    vulnerability in the Linux kernel's filesystem layer. An
    unprivileged local attacker able to create, mount, and then delete a
    deep directory structure whose total path length exceeds 1GB, can
    take advantage of this flaw for privilege escalation.

    Details can be found in the Qualys advisory at
    <https://www.qualys.com/2021/07/20/cve-2021-33909/sequoia-local-privilege-escalation-linux.txt>

CVE-2021-34693

    Norbert Slusarek discovered an information leak in the CAN BCM
    networking protocol. A local attacker can take advantage of this
    flaw to obtain sensitive information from kernel stack memory.

For Debian 9 stretch, these problems have been fixed in version
4.9.272-2.  This additionally fixes a regression in the previous
update (#990072) that affected LXC.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgpE_NzNpz4wQ.pgp)**

*Description:* PGP signature

---


