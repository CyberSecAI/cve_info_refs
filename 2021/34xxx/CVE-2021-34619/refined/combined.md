=== Content from plugins.trac.wordpress.org_6c5d25c1_20250115_090406.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwoocommerce-stock-manager%2Ftrunk%2Fadmin%2Fviews%2Fimport-export.php%3Frev%3D2499178)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php?rev=2464820 "Revision 2464820")
* [Latest Revision](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php)
* [Next Revision](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php?rev=2538966 "Revision 2538966") →
* [Blame](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php?annotate=blame&rev=2499178 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/woocommerce-stock-manager/trunk/admin/views/import-export.php?rev=2499178)

---

# [source:](/browser?rev=2499178&order=name "Go to repository root") [woocommerce-stock-manager](/browser/woocommerce-stock-manager?rev=2499178&order=name "View woocommerce-stock-manager")/[trunk](/browser/woocommerce-stock-manager/trunk?rev=2499178&order=name "View trunk")/[admin](/browser/woocommerce-stock-manager/trunk/admin?rev=2499178&order=name "View admin")/[views](/browser/woocommerce-stock-manager/trunk/admin/views?rev=2499178&order=name "View views")/[import-export.php](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php?rev=2499178&order=name "View import-export.php") @ [2499178](/changeset/2499178/ "View changeset 2499178")

View diff against:

View revision:

| [Last change](/changeset/2499178/woocommerce-stock-manager/trunk/admin/views/import-export.php "View differences") on this file since 2499178 was [2499178](/changeset/2499178/ "View changeset 2499178"), checked in by storeapps, [4 years ago](/timeline?from=2021-03-19T06%3A40%3A11Z&precision=second "See timeline at 03/19/2021 06:40:11 AM") |
| --- |
| Preparing for 2.5.5 release |
| **File size:** 8.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* @author    StoreApps |
| [4](#L4) | \* @package   WooCommerce Stock Manager |
| [5](#L5) | \*/ |
| [6](#L6) |  |
| [7](#L7) | if ( ! defined( 'ABSPATH' ) ) { |
| [8](#L8) | exit; |
| [9](#L9) | } |
| [10](#L10) |  |
| [11](#L11) | $stock = $this->stock(); |
| [12](#L12) |  |
| [13](#L13) | function stockautoUTF($s){ |
| [14](#L14) | if (preg\_match('#[\x80-\x{1FF}\x{2000}-\x{3FFF}]#u', $s)) |
| [15](#L15) | return $s; |
| [16](#L16) |  |
| [17](#L17) | if (preg\_match('#[\x7F-\x9F\xBC]#', $s)) |
| [18](#L18) | return iconv('WINDOWS-1250', 'UTF-8', $s); |
| [19](#L19) |  |
| [20](#L20) | return iconv('ISO-8859-2', 'UTF-8', $s); |
| [21](#L21) | } |
| [22](#L22) |  |
| [23](#L23) |  |
| [24](#L24) | ?> |
| [25](#L25) | <script type="text/javascript"> |
| [26](#L26) | jQuery( function() { |
| [27](#L27) | function convertArrayOfObjectsToCSV(args) { |
| [28](#L28) | var result, ctr, keys, columnDelimiter, lineDelimiter, data; |
| [29](#L29) | data = args.datas || null; |
| [30](#L30) | if (data == null || !data.length) { |
| [31](#L31) | return null; |
| [32](#L32) | } |
| [33](#L33) | columnDelimiter = args.columnDelimiter || ','; |
| [34](#L34) | lineDelimiter = args.lineDelimiter || '\n'; |
| [35](#L35) | keys = Object.keys(data[0]); |
| [36](#L36) | result = ''; |
| [37](#L37) | result += keys.join(columnDelimiter); |
| [38](#L38) | result += lineDelimiter; |
| [39](#L39) | data.forEach(function(item) { |
| [40](#L40) | ctr = 0; |
| [41](#L41) | keys.forEach(function(key) { |
| [42](#L42) | if (ctr > 0) result += columnDelimiter; |
| [43](#L43) |  |
| [44](#L44) | result += item[key]; |
| [45](#L45) | ctr++; |
| [46](#L46) | }); |
| [47](#L47) | result += lineDelimiter; |
| [48](#L48) | }); |
| [49](#L49) | return result; |
| [50](#L50) | } |
| [51](#L51) | jQuery('.product-export').on( 'click', function(e){ |
| [52](#L52) | e.preventDefault(); |
| [53](#L53) | jQuery( '.export-output' ).empty(); |
| [54](#L54) | jQuery( '#csv' ).append( 'Generating csv file' ); |
| [55](#L55) | jQuery( '#csv' ).css( 'display','block' ); |
| [56](#L56) | var offset = '0'; |
| [57](#L57) | wsm\_export\_products( offset ); |
| [58](#L58) | function wsm\_export\_products( offset ) { |
| [59](#L59) | var data = { |
| [60](#L60) | 'action'  : 'wsm\_get\_products\_or\_export', |
| [61](#L61) | 'offset'   : offset |
| [62](#L62) | }; |
| [63](#L63) | jQuery.post(ajaxurl, data, function( response ) { |
| [64](#L64) | var result = jQuery.parseJSON( response ); |
| [65](#L65) | if( result.status != 'finish' ){ |
| [66](#L66) | var jsonObject = JSON.stringify(result.data); |
| [67](#L67) | jsonObject = jsonObject.slice( 1 ); |
| [68](#L68) | jsonObject = jsonObject.slice(0, -1); |
| [69](#L69) | jQuery( '.export-output' ).append( jsonObject + ',' ); |
| [70](#L70) | wsm\_export\_products( result.offset ); |
| [71](#L71) | } else { |
| [72](#L72) | var string = jQuery( '.export-output' ).text(); |
| [73](#L73) | string = string.slice(0, -1); |
| [74](#L74) | string = '{' + string + '}'; |
| [75](#L75) | jQuery( '#csv' ).empty(); |
| [76](#L76) | jQuery( '#csv' ).append( 'All done!' ); |
| [77](#L77) | var data = { |
| [78](#L78) | 'action'  : 'wsm\_get\_csv\_file', |
| [79](#L79) | 'data'   : string |
| [80](#L80) | }; |
| [81](#L81) | jQuery.post(ajaxurl, data, function( response ) { |
| [82](#L82) | var data, filename, link; |
| [83](#L83) | var csv = convertArrayOfObjectsToCSV({ |
| [84](#L84) | datas: JSON.parse( response ) |
| [85](#L85) | }); |
| [86](#L86) | if (csv == null) return; |
| [87](#L87) | filename = 'stock-manager-export.csv'; |
| [88](#L88) | if (!csv.match(/^data:text\/csv/i)) { |
| [89](#L89) | csv = 'data:text/csv;charset=utf-8,' + csv; |
| [90](#L90) | } |
| [91](#L91) | data = encodeURI(csv); |
| [92](#L92) | link = document.createElement('a'); |
| [93](#L93) | link.setAttribute('href', data); |
| [94](#L94) | link.setAttribute('download', filename); |
| [95](#L95) | link.click(); |
| [96](#L96) | }); |
| [97](#L97) | } |
| [98](#L98) | }); |
| [99](#L99) | } |
| [100](#L100) | }); |
| [101](#L101) | }); |
| [102](#L102) | </script> |
| [103](#L103) | <div class="wrap"> |
| [104](#L104) |  |
| [105](#L105) | <h2><?php echo esc\_html( get\_admin\_page\_title() ); ?></h2> |
| [106](#L106) |  |
| [107](#L107) | <div class="t-col-6"> |
| [108](#L108) | <div class="toret-box box-info"> |
| [109](#L109) | <div class="box-header"> |
| [110](#L110) | <h3 class="box-title"><?php \_e('Import','woocommerce-stock-manager'); ?></h3> |
| [111](#L111) | </div> |
| [112](#L112) | <div class="box-body"> |
| [113](#L113) | <h4><?php \_e('You can upload csv file, with your stock data. ','woocommerce-stock-manager'); ?></h4> |
| [114](#L114) | <p><?php \_e('CSV file must be in this format, or you can export file with exist data and edit them. ','woocommerce-stock-manager'); ?></p> |
| [115](#L115) | <p><?php \_e('If you have a lot of products and export/import not working, increase memory limit.. ','woocommerce-stock-manager'); ?></p> |
| [116](#L116) | <h3><?php \_e('File format','woocommerce-stock-manager'); ?></h3> |
| [117](#L117) | <table class="table-bordered"> |
| [118](#L118) | <tr> |
| [119](#L119) | <td><?php \_e('ID','woocommerce-stock-manager'); ?></td> |
| [120](#L120) | <td><?php \_e('SKU','woocommerce-stock-manager'); ?></td> |
| [121](#L121) | <td><?php \_e('Product name','woocommerce-stock-manager'); ?></td> |
| [122](#L122) | <td><?php \_e('Manage stock','woocommerce-stock-manager'); ?></td> |
| [123](#L123) | <td><?php \_e('Stock status','woocommerce-stock-manager'); ?></td> |
| [124](#L124) | <td><?php \_e('Backorders','woocommerce-stock-manager'); ?></td> |
| [125](#L125) | <td><?php \_e('Stock','woocommerce-stock-manager'); ?></td> |
| [126](#L126) | <td><?php \_e('Product type','woocommerce-stock-manager'); ?></td> |
| [127](#L127) | <td><?php \_e('Parent ID','woocommerce-stock-manager'); ?></td> |
| [128](#L128) | </tr> |
| [129](#L129) | <tr> |
| [130](#L130) | <td><?php \_e('123','woocommerce-stock-manager'); ?></td> |
| [131](#L131) | <td><?php \_e('abc111','woocommerce-stock-manager'); ?></td> |
| [132](#L132) | <td><?php \_e('T-shirt','woocommerce-stock-manager'); ?></td> |
| [133](#L133) | <td><?php \_e('yes','woocommerce-stock-manager'); ?></td> |
| [134](#L134) | <td><?php \_e('instock','woocommerce-stock-manager'); ?></td> |
| [135](#L135) | <td><?php \_e('yes','woocommerce-stock-manager'); ?></td> |
| [136](#L136) | <td><?php \_e('10','woocommerce-stock-manager'); ?></td> |
| [137](#L137) | <td><?php \_e('simple','woocommerce-stock-manager'); ?></td> |
| [138](#L138) | <td></td> |
| [139](#L139) | </tr> |
| [140](#L140) | </table> |
| [141](#L141) |  |
| [142](#L142) | <ul> |
| [143](#L143) | <li><strong><?php \_e('ID','woocommerce-stock-manager'); ?></strong> <?php \_e('product id, required. Neccessary for import and export.','woocommerce-stock-manager'); ?></li> |
| [144](#L144) | <li><strong><?php \_e('SKU','woocommerce-stock-manager'); ?></strong> <?php \_e('product unique identificator.','woocommerce-stock-manager'); ?></li> |
| [145](#L145) | <li><strong><?php \_e('Manage stock','woocommerce-stock-manager'); ?></strong> <?php \_e('values: "yes", "notify", "no". If is empty "no" will be save.','woocommerce-stock-manager'); ?></li> |
| [146](#L146) | <li><strong><?php \_e('Stock status','woocommerce-stock-manager'); ?></strong> <?php \_e('values: "instock", "outofstock". If is empty "outofstock" will be save.','woocommerce-stock-manager'); ?></li> |
| [147](#L147) | <li><strong><?php \_e('Backorders','woocommerce-stock-manager'); ?></strong> <?php \_e('values: "yes", "notify", "no". If is empty "no" will be save.','woocommerce-stock-manager'); ?></li> |
| [148](#L148) | <li><strong><?php \_e('Stock','woocommerce-stock-manager'); ?></strong> <?php \_e('quantity value. If is empty, 0 will be save.','woocommerce-stock-manager'); ?></li> |
| [149](#L149) | </ul> |
| [150](#L150) |  |
| [151](#L151) |  |
| [152](#L152) | <form method="post" action="" class="setting-form" enctype="multipart/form-data"> |
| [153](#L153) | <table class="table-bordered"> |
| [154](#L154) | <tr> |
| [155](#L155) | <th><?php \_e('Upload csv file', 'woocommerce-stock-manager'); ?></th> |
| [156](#L156) | <td> |
| [157](#L157) | <input type="file" name="uploadFile"> |
| [158](#L158) | </td> |
| [159](#L159) | </tr> |
| [160](#L160) | </table> |
| [161](#L161) | <div class="clear"></div> |
| [162](#L162) | <input type="hidden" name="upload" value="ok" /> |
| [163](#L163) | <input type="submit" class="btn btn-info" value="<?php \_e('Upload', 'woocommerce-stock-manager'); ?>" /> |
| [164](#L164) | </form> |
| [165](#L165) | <?php |
| [166](#L166) | if(isset($\_POST['upload'])){ |
| [167](#L167) |  |
| [168](#L168) | $target\_dir = STOCKDIR.'admin/views/upload/'; |
| [169](#L169) | $target\_dir = $target\_dir . basename( $\_FILES["uploadFile"]["name"]); |
| [170](#L170) | $uploadOk   = true; |
| [171](#L171) |  |
| [172](#L172) | if (move\_uploaded\_file($\_FILES["uploadFile"]["tmp\_name"], $target\_dir)) { |
| [173](#L173) |  |
| [174](#L174) | echo \_\_('The file '. basename( $\_FILES['uploadFile']['name']). ' has been uploaded.','woocommerce-stock-manager'); |
| [175](#L175) |  |
| [176](#L176) | $row = 1; |
| [177](#L177) | if (($handle = fopen($target\_dir, "r")) !== FALSE) { |
| [178](#L178) |  |
| [179](#L179) | while (($data = fgetcsv($handle, 1000, ',')) !== FALSE) { |
| [180](#L180) | $num = count($data); |
| [181](#L181) |  |
| [182](#L182) | $product\_id   = stockautoUTF($data[0]); |
| [183](#L183) | $sku          = stockautoUTF($data[1]); |
| [184](#L184) | $manage\_stock = stockautoUTF($data[3]); |
| [185](#L185) | $stock\_status = stockautoUTF($data[4]); |
| [186](#L186) | $backorders   = stockautoUTF($data[5]); |
| [187](#L187) | $stock        = stockautoUTF($data[6]); |
| [188](#L188) |  |
| [189](#L189) | if($row != 1){ |
| [190](#L190) |  |
| [191](#L191) | if( !empty( $product\_id ) ){ |
| [192](#L192) |  |
| [193](#L193) | $values = array( |
| [194](#L194) | 'sku' => $sku, |
| [195](#L195) | 'manage\_stock' => $manage\_stock, |
| [196](#L196) | 'stock\_status' => $stock\_status, |
| [197](#L197) | 'backorders' => $backorders, |
| [198](#L198) | 'stock' => $stock |
| [199](#L199) | ); |
| [200](#L200) |  |
| [201](#L201) | WCM\_Save::save\_one\_item( $values, $product\_id ); |
| [202](#L202) |  |
| [203](#L203) | echo '<p>'.\_\_('Product with ID: '.$product\_id.' was updated.','woocommerce-stock-manager').'</p>'; |
| [204](#L204) |  |
| [205](#L205) | } |
| [206](#L206) | } |
| [207](#L207) | $row++; |
| [208](#L208) |  |
| [209](#L209) | } |
| [210](#L210) | fclose($handle); |
| [211](#L211) | } |
| [212](#L212) |  |
| [213](#L213) | }else{ |
| [214](#L214) | echo '<p>'.\_\_('Sorry, there was an error uploading your file.','woocommerce-stock-manager').'</p>'; |
| [215](#L215) | } |
| [216](#L216) |  |
| [217](#L217) | } |
| [218](#L218) | ?> |
| [219](#L219) | </div> |
| [220](#L220) | </div> |
| [221](#L221) | </div> |
| [222](#L222) |  |
| [223](#L223) |  |
| [224](#L224) |  |
| [225](#L225) | <div class="t-col-6"> |
| [226](#L226) | <div class="toret-box box-info"> |
| [227](#L227) | <div class="box-header"> |
| [228](#L228) | <h3 class="box-title"><?php \_e('Export','woocommerce-stock-manager'); ?></h3> |
| [229](#L229) | </div> |
| [230](#L230) | <div class="box-body"> |
| [231](#L231) | <h4><?php \_e('You can download csv file, with your stock data. ','woocommerce-stock-manager'); ?></h4> |
| [232](#L232) | <p><a href="#" class="btn btn-danger product-export"><?php \_e('Create export file','woocommerce-stock-manager'); ?></a></p> |
| [233](#L233) | <div class="export-output" style="display:none;"></div> |
| [234](#L234) | <div id="csv" style="display:none;"></div> |
| [235](#L235) | </div> |
| [236](#L236) | </div> |
| [237](#L237) | </div> |
| [238](#L238) |  |
| [239](#L239) |  |
| [240](#L240) | </div> |
| [241](#L241) | <?php |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/woocommerce-stock-manager/trunk/admin/views/import-export.php?rev=2499178&format=txt)
* [Original Format](/export/2499178/woocommerce-stock-manager/trunk/admin/views/import-export.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_be0d2684_20250115_090407.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/06/High-Severity-Vulnerability-Patched-in-WooCommerce-Stock-Manager-Plugin-1.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

June 14, 2021

# High Severity Vulnerability Patched in WooCommerce Stock Manager Plugin

On May 21, 2021, the Wordfence Threat Intelligence team initiated the responsible disclosure process for a vulnerability that we discovered in [WooCommerce Stock Manager](https://wordpress.org/plugins/woocommerce-stock-manager/), a WordPress plugin installed on over 30,000 sites. This flaw made it possible for an attacker to upload arbitrary files to a vulnerable site and achieve remote code execution, as long as they could trick a site’s administrator into performing an action like clicking on a link.

We initially reached out to the plugin’s developer on May 21, 2021. After receiving confirmation of an appropriate communication channel, we provided the full disclosure details on May 24, 2021. A patch was quickly released on May 28, 2021 in version 2.6.0.

We highly recommend updating to the latest patched version available, 2.6.0, immediately.

Wordfence Premium users received a firewall rule to protect against any exploits targeting these vulnerabilities on May 21, 2021. Sites still using the free version of Wordfence will receive the same protection on June 20, 2021.

**Description:** Cross-Site Request Forgery (CSRF) to Arbitrary File Upload

**Affected Plugin:** WooCommerce Stock Manager

**Plugin Slug:** woocommerce-stock-manager

**Affected Versions:** <= 2.5.7

**CVE ID:** [CVE-2021-34619](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34619)

**CVSS Score:** 8.8 (HIGH)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 2.6.0

The WooCommerce Stock Manager plugin is a plugin designed as an extension to WooCommerce that provides site owners with the ability to centrally manage the stock and details of all of an e-commerce site’s products on one page. One of the features from the plugin is the ability to export all products and import new products. Unfortunately, this functionality had a flaw that made it possible for requests to be forged on behalf of an administrator in order to upload arbitrary files.

Taking a close look at the functionality, it was evident that the import function had no nonce check in place. This meant that there was no validation in place to verify the source of a request. This oversight made it possible for an attacker with a specifically crafted upload request to trick an administrator into infecting their own site by clicking on a link while authenticated to the vulnerable site.

```
	<form method="post" action="" class="setting-form" enctype="multipart/form-data">
		<table class="table-bordered">
		  <tr>
			<th><?php _e('Upload csv file', 'woocommerce-stock-manager'); ?></th>
			<td>
			  <input type="file" name="uploadFile">
			</td>
		  </tr>
		</table>
		<div class="clear"></div>
	  <input type="hidden" name="upload" value="ok" />
	  <input type="submit" class="btn btn-info" value="<?php _e('Upload', 'woocommerce-stock-manager'); ?>" />
	</form>
	<?php
	if(isset($_POST['upload'])){

		$target_dir = STOCKDIR.'admin/views/upload/';
		$target_dir = $target_dir . basename( $_FILES["uploadFile"]["name"]);
		$uploadOk   = true;

		if (move_uploaded_file($_FILES["uploadFile"]["tmp_name"], $target_dir)) {

			echo __('The file '. basename( $_FILES['uploadFile']['name']). ' has been uploaded.','woocommerce-stock-manager');

			$row = 1;
			if (($handle = fopen($target_dir, "r")) !== FALSE) {

				while (($data = fgetcsv($handle, 1000, ',')) !== FALSE) {
					$num = count($data);
```

In addition, there was no validation on the upload to verify that it was a CSV file, or at the very least not a malicious file. This meant that any file type could be uploaded to the site including, but not limited to, PHP files that could be used to obtain remote code execution.

If an attacker was able to successfully exploit this vulnerability, then they could potentially completely take over the vulnerable WordPress site through the use of remote commands by uploading a PHP webshell to the site.

As always, you can protect yourself against Cross-Site Request Forgery exploit attempts by remaining cautious when clicking on links or attachments from unknown sources, even if those links are in comments or form submissions from your own site.

## Disclosure Timeline

**May 21, 2021** – Conclusion of the plugin analysis that led to the discovery of several vulnerabilities in the WooCommerce Stock Manager plugin. We develop a firewall rule to protect Wordfence customers and release it to Wordfence Premium users. We initiate contact with the plugin developer.

**May 24, 2021** – The plugin developer confirms the inbox for handling discussion. We send over full disclosure details.

**May 25, 2021** – The plugin developer confirms they have received the details and will begin working on a fix.

**May 28, 2021** – A newly updated version of the plugin is released containing sufficient patches.

**June 20, 2021** – Wordfence free users receive firewall rules.

## Conclusion

In today’s post, we detailed a flaw in WooCommerce Product Manager that granted attackers the ability to upload malicious files to achieve remote code execution, if they could trick a site’s administrator into performing an action. This flaw has been fully patched in version 2.6.0. We recommend that users immediately update to the latest version available, which is version 2.6.0 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210614&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule to protect against any exploits targeting this vulnerability on May 21, 2021. Sites still using the free version of Wordfence will receive the same protection on June 20, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as this is a high severity vulnerability that can lead to full site takeover.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F06%2Fhigh-severity-vulnerability-patched-in-woocommerce-stock-manager-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F06%2Fhigh-severity-vulnerability-patched-in-woocommerce-stock-manager-plugin%2F&text=High%20Severity%20Vulnerability%20Patched%20in%20WooCommerce%20Stock%20Manager%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F06%2Fhigh-severity-vulnerability-patched-in-woocommerce-stock-manager-plugin%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


