- **Root cause of vulnerability:** Insufficient directory traversal protection in the WordPress Download Manager plugin. The plugin allows users to use templates to change how download pages are displayed.
- **Weaknesses/vulnerabilities present:**
    - Authenticated Directory Traversal: The plugin did not properly sanitize the `file[page_template]` parameter, allowing a user to traverse directories and access sensitive files like `wp-config.php`.
    - Stored Cross-Site Scripting (XSS): Due to the contents of `file[page_template]` being echoed into the page source, an attacker could upload a file with a malicious javascript and use this parameter to execute malicious javascript.
- **Impact of exploitation:**
    - Information disclosure: An attacker can retrieve sensitive information like database credentials from the `wp-config.php` file.
    - Site takeover: By obtaining database credentials or executing JavaScript in an administrator's browser session, an attacker can take over the site.
- **Attack vectors:**
    - The vulnerability is exploited by adding a new download and performing a directory traversal attack using the `file[page_template]` parameter.
    - Uploading a file with malicious JavaScript content with an image extension and setting the `file[page_template]` to the path of the uploaded file to perform XSS.
- **Required attacker capabilities/position:**
    - The attacker needs to have at least contributor-level permissions to perform directory traversal and access sensitive information.
    - Author level permissions or higher are needed to upload files and perform stored XSS.