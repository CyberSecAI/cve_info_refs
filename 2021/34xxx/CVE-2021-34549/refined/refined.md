```
{
  "vulnerability": {
    "root_cause": "The `chanid_circid_entry_hash()` function used in the circuit muxinfo hashtable employs an unsafe hash function, making it vulnerable to HashDoS attacks.",
    "weaknesses": [
      "The hash function `chanid_circid_entry_hash()` does not use SipHash, which is designed to prevent HashDoS attacks. This allows an attacker to create hash collisions."
    ],
    "impact": "An attacker can cause a denial-of-service (DoS) by creating many hash collisions, leading to excessive CPU usage by the Tor relay. Additionally, a timing oracle exists that can leak information about the number of circuits established by a relay.",
    "attack_vectors": [
      "An attacker needs to connect directly to an Onion Router.",
      "The attacker needs to craft specific circuit IDs to create hash collisions."
    ],
    "required_capabilities": "The attacker must know the number of channels established by the target Tor instance (or use the timing oracle to discover it). The attacker also needs the ability to connect to an Onion Router and send traffic to it."
  },
  "additional_information": {
    "timing_oracle": "A timing oracle exists where a ~3ms timing delta (amplified when queries are batched) reveals whether a Tor relay has established a specific number of channels.",
    "dos_traffic": "The DoS attack requires the attacker to send ~1.3 Mbit/s of traffic to the relay, potentially reaching 100% CPU utilization. The test program needed ~2.8 Mbits/s.",
        "mitigation": "The vulnerability is addressed by using SipHash instead of the naive hash function for circuit lookups in the circuitmux object. This change was included in Tor versions 0.3.5.15, 0.4.4.9, 0.4.5.9, and 0.4.6.5."
  }
}
```