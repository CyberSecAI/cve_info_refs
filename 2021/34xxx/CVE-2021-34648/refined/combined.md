=== Content from plugins.trac.wordpress.org_68af0098_20250115_090548.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fninja-forms%2Ftrunk%2Fincludes%2FRoutes%2FSubmissions.php%3Frev%3D2543837)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Latest Revision](/browser/ninja-forms/trunk/includes/Routes/Submissions.php)
* [Next Revision](/browser/ninja-forms/trunk/includes/Routes/Submissions.php?rev=2584052 "Revision 2584052") →
* [Blame](/browser/ninja-forms/trunk/includes/Routes/Submissions.php?annotate=blame&rev=2543837 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/ninja-forms/trunk/includes/Routes/Submissions.php?rev=2543837)

---

# [source:](/browser?rev=2543837&order=name "Go to repository root") [ninja-forms](/browser/ninja-forms?rev=2543837&order=name "View ninja-forms")/[trunk](/browser/ninja-forms/trunk?rev=2543837&order=name "View trunk")/[includes](/browser/ninja-forms/trunk/includes?rev=2543837&order=name "View includes")/[Routes](/browser/ninja-forms/trunk/includes/Routes?rev=2543837&order=name "View Routes")/[Submissions.php](/browser/ninja-forms/trunk/includes/Routes/Submissions.php?rev=2543837&order=name "View Submissions.php") @ [2543837](/changeset/2543837/ "View changeset 2543837")

View diff against:

View revision:

| [Last change](/changeset/2543837/ninja-forms/trunk/includes/Routes/Submissions.php "View differences") on this file since 2543837 was [2543837](/changeset/2543837/ "View changeset 2543837"), checked in by kstover, [4 years ago](/timeline?from=2021-06-07T17%3A40%3A12Z&precision=second "See timeline at 06/07/2021 05:40:12 PM") |
| --- |
| Release 3.5.5, see readme.txt for the changelog. |
| **File size:** 7.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php if ( ! defined( 'ABSPATH' ) ) exit; |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* Class NF\_Routes\_SubmissionsActions |
| [5](#L5) | \*/ |
| [6](#L6) | final class NF\_Routes\_Submissions extends NF\_Abstracts\_Routes |
| [7](#L7) | { |
| [8](#L8) |  |
| [9](#L9) | /\*\* |
| [10](#L10) | \* Set the API routes for submissions |
| [11](#L11) | \* |
| [12](#L12) | \*  @since 3.4.33 |
| [13](#L13) | \*/ |
| [14](#L14) | public function \_\_construct(){ |
| [15](#L15) | add\_action('rest\_api\_init', [ $this, 'register\_routes'] ); |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | /\*\* |
| [19](#L19) | \* Register REST API routes related to submissions actions |
| [20](#L20) | \* |
| [21](#L21) | \* @since 3.4.33 |
| [22](#L22) | \* |
| [23](#L23) | \* @route "ninja-forms-submissions/export" |
| [24](#L24) | \* @route 'ninja-forms-submissions/email-action" |
| [25](#L25) | \*/ |
| [26](#L26) | function register\_routes() { |
| [27](#L27) |  |
| [28](#L28) | register\_rest\_route('ninja-forms-submissions', 'export', array( |
| [29](#L29) | 'methods' => 'POST', |
| [30](#L30) | 'args' => [ |
| [31](#L31) | 'form\_ids' => [ |
| [32](#L32) | 'required' => true, |
| [33](#L33) | 'description' => esc\_attr\_\_('Array of Form IDs we want to get the submissions from.', 'ninja-forms'), |
| [34](#L34) | 'type' => 'JSON encoded array', |
| [35](#L35) | 'validate\_callback' => 'rest\_validate\_request\_arg', |
| [36](#L36) | ], |
| [37](#L37) | 'start\_date' => [ |
| [38](#L38) | 'required' => true, |
| [39](#L39) | 'description' => esc\_attr\_\_('strtotime($date) that represents the start date we will retrieve submssions at.', 'ninja-forms'), |
| [40](#L40) | 'type' => 'string', |
| [41](#L41) | 'validate\_callback' => 'rest\_validate\_request\_arg', |
| [42](#L42) | ], |
| [43](#L43) | 'end\_date' => [ |
| [44](#L44) | 'required' => true, |
| [45](#L45) | 'description' => esc\_attr\_\_('strtotime($date) that represents the end date we will retrieve submssions at.', 'ninja-forms'), |
| [46](#L46) | 'type' => 'string', |
| [47](#L47) | 'validate\_callback' => 'rest\_validate\_request\_arg', |
| [48](#L48) | ], |
| [49](#L49) | ], |
| [50](#L50) | 'callback' => [ $this, 'bulk\_export\_submissions' ], |
| [51](#L51) | 'permission\_callback' => [ $this, 'permission\_callback' ], |
| [52](#L52) | )); |
| [53](#L53) |  |
| [54](#L54) | register\_rest\_route('ninja-forms-submissions', 'email-action', array( |
| [55](#L55) | 'methods' => 'POST', |
| [56](#L56) | 'args' => [ |
| [57](#L57) | 'submission' => [ |
| [58](#L58) | 'required' => true, |
| [59](#L59) | 'description' => esc\_attr\_\_('Submission ID', 'ninja-forms'), |
| [60](#L60) | 'type' => 'int', |
| [61](#L61) | 'validate\_callback' => 'rest\_validate\_request\_arg', |
| [62](#L62) | ], |
| [63](#L63) | 'action\_settings' => [ |
| [64](#L64) | 'required' => true, |
| [65](#L65) | 'description' => esc\_attr\_\_('Email Action Settings', 'ninja-forms'), |
| [66](#L66) | 'type' => 'object', |
| [67](#L67) | 'validate\_callback' => 'rest\_validate\_request\_arg', |
| [68](#L68) | ], |
| [69](#L69) | ], |
| [70](#L70) | 'callback' => [ $this, 'trigger\_email\_action' ], |
| [71](#L71) | 'permission\_callback' => [ $this, 'permission\_callback' ], |
| [72](#L72) | )); |
| [73](#L73) |  |
| [74](#L74) | } |
| [75](#L75) |  |
| [76](#L76) | /\*\* |
| [77](#L77) | \* Secure endpoint to allowed users |
| [78](#L78) | \* |
| [79](#L79) | \* @since 3.4.33 |
| [80](#L80) | \* |
| [81](#L81) | \* Already passed Nonce validation via wp\_rest and x\_wp\_nonce header checked against rest\_cookie\_check\_errors() |
| [82](#L82) | \*/ |
| [83](#L83) | public function permission\_callback(WP\_REST\_Request $request) { |
| [84](#L84) |  |
| [85](#L85) | //Set default to false |
| [86](#L86) | $allowed = false; |
| [87](#L87) |  |
| [88](#L88) | //Check Capability of logged in users |
| [89](#L89) | $allowed = is\_user\_logged\_in(); |
| [90](#L90) |  |
| [91](#L91) | /\*\* |
| [92](#L92) | \* Filter permissions for Triggering Email Actions |
| [93](#L93) | \* |
| [94](#L94) | \* @param bool $allowed Is request authorized? |
| [95](#L95) | \* @param WP\_REST\_Request $request The current request |
| [96](#L96) | \*/ |
| [97](#L97) | return apply\_filters( 'ninja\_forms\_api\_allow\_email\_action', $allowed, $request ); |
| [98](#L98) | } |
| [99](#L99) |  |
| [100](#L100) | /\*\* |
| [101](#L101) | \* Bulk\_export\_submissions |
| [102](#L102) | \* |
| [103](#L103) | \* @since 3.4.33 |
| [104](#L104) | \* |
| [105](#L105) | \* @return array of CSVs by form |
| [106](#L106) | \*/ |
| [107](#L107) | public function bulk\_export\_submissions(WP\_REST\_Request $request) { |
| [108](#L108) |  |
| [109](#L109) | //Gather data from the request |
| [110](#L110) | $data = json\_decode($request->get\_body()); |
| [111](#L111) | if( !empty( $data->form\_ids ) && !empty( $data->start\_date ) && !empty( $data->end\_date ) ){ |
| [112](#L112) | $form\_ids = explode( ",", $data->form\_ids); |
| [113](#L113) | $start\_date = $data->start\_date; |
| [114](#L114) | $end\_date = $data->end\_date; |
| [115](#L115) | } else if( !empty(  $\_GET['form\_ids']  ) && !empty( $\_GET['start\_date'] ) && !empty( $\_GET['end\_date'] ) ) { |
| [116](#L116) | $form\_ids = explode( ",", $\_GET['form\_ids'] ); |
| [117](#L117) | $start\_date = $\_GET['start\_date']; |
| [118](#L118) | $end\_date = $\_GET['end\_date']; |
| [119](#L119) | } else { |
| [120](#L120) | return new WP\_Error( 'malformed\_request', \_\_('This request is missing data', 'ninja-forms') ); |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | //Set params to perform query |
| [124](#L124) | $params = (new NF\_Exports\_SubmissionCollectionFilterParameters()) |
| [125](#L125) | ->setStartDate($start\_date) |
| [126](#L126) | ->setEndDate($end\_date) |
| [127](#L127) | ->setHiddenFieldTypes(['submit', 'html', 'divider']) |
| [128](#L128) | ->setUseAdminLabels(true) |
| [129](#L129) | ; |
| [130](#L130) |  |
| [131](#L131) | // Construct a collection with provided parameters |
| [132](#L132) | foreach ($form\_ids as $formId) { |
| [133](#L133) |  |
| [134](#L134) | $submissionsCollection = (new NF\_Exports\_SubmissionCollectionCPT($formId)) |
| [135](#L135) | ->filterByParameters($params); |
| [136](#L136) |  |
| [137](#L137) | $csvObject = (new NF\_Exports\_SubmissionCsvExport()) |
| [138](#L138) | ->setSubmissionCollection($submissionsCollection); |
| [139](#L139) |  |
| [140](#L140) | $csv[$formId] = $csvObject->handle(true); |
| [141](#L141) | } |
| [142](#L142) |  |
| [143](#L143) | // Return CSV objects |
| [144](#L144) | return $csv; |
| [145](#L145) |  |
| [146](#L146) | } |
| [147](#L147) |  |
| [148](#L148) | /\*\* |
| [149](#L149) | \* Trigger Email Action endpoint callback |
| [150](#L150) | \* |
| [151](#L151) | \* @since 3.4.33 |
| [152](#L152) | \* |
| [153](#L153) | \* @return bool|int depending on the value returned by wp\_mail |
| [154](#L154) | \*/ |
| [155](#L155) | public function trigger\_email\_action(WP\_REST\_Request $request) { |
| [156](#L156) | //Extract required data |
| [157](#L157) | $data = json\_decode($request->get\_body()); |
| [158](#L158) | $form = Ninja\_Forms()->form( $data->formID ); |
| [159](#L159) | $sub = $form->get\_sub( $data->submission ); |
| [160](#L160) | $field\_values = $sub->get\_field\_values(); |
| [161](#L161) |  |
| [162](#L162) | //Throw error if we're missing data |
| [163](#L163) | if( !isset($data) || empty($form) || empty($sub) ) { |
| [164](#L164) | return new WP\_Error( 'malformed\_request', \_\_('This request is missing data', 'ninja-forms') ); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | //Process Merge tags |
| [168](#L168) | $action\_settings = $this->process\_merge\_tags( $data->action\_settings, $data->formID, $sub ); |
| [169](#L169) | //Process Email Action |
| [170](#L170) | $email\_action = new NF\_Actions\_Email(); |
| [171](#L171) | $result = $email\_action->process( (array) $action\_settings, $data->formID, (array) $field\_values ); |
| [172](#L172) |  |
| [173](#L173) | //Return true if wp\_mail returned true or the submission ID if it failed. |
| [174](#L174) | $return = !empty($result['actions']['email']['sent']) && true === $result['actions']['email']['sent'] ? $result['actions']['email']['sent'] : $sub->get\_seq\_num(); |
| [175](#L175) |  |
| [176](#L176) | return $return; |
| [177](#L177) |  |
| [178](#L178) | } |
| [179](#L179) |  |
| [180](#L180) | /\*\* |
| [181](#L181) | \* Process Merge tags for a given Value |
| [182](#L182) | \* |
| [183](#L183) | \* @since 3.4.33 |
| [184](#L184) | \* |
| [185](#L185) | \* @return object of Email Action Model with merge tags settingsprocessed |
| [186](#L186) | \* |
| [187](#L187) | \*/ |
| [188](#L188) | public function process\_merge\_tags( $data, $form\_id, $sub) { |
| [189](#L189) |  |
| [190](#L190) | // Init Field Merge Tags. |
| [191](#L191) | $fields\_merge\_tag\_object = Ninja\_Forms()->merge\_tags[ 'fields' ]; |
| [192](#L192) | $fields\_merge\_tag\_object->set\_form\_id($form\_id); |
| [193](#L193) |  |
| [194](#L194) | //Process Fields Merge Tags |
| [195](#L195) | $fields = Ninja\_Forms()->form( $form\_id )->get\_fields(); |
| [196](#L196) | $fields = new NF\_Adapters\_SubmissionsSubmission( $fields, $form\_id, $sub ); |
| [197](#L197) | foreach( $fields as $field\_id => $field){ |
| [198](#L198) | $fields\_merge\_tag\_object->add\_field( $field ); |
| [199](#L199) | } |
| [200](#L200) | //Add All Fields merge tags |
| [201](#L201) | $fields\_merge\_tag\_object->include\_all\_fields\_merge\_tags(); |
| [202](#L202) | //include fields to the {all\_fields\_table} and {fields\_table} mrerge tags |
| [203](#L203) | foreach( $fields as $field\_id => $field){ |
| [204](#L204) | $fields\_merge\_tag\_object->add\_field( $field ); |
| [205](#L205) | } |
| [206](#L206) | //Loop through Action settings and apply merge tags |
| [207](#L207) | $array\_data = (array) $data; |
| [208](#L208) | foreach( $array\_data as $ind => $value ){ |
| [209](#L209) | if( !empty($value) && is\_string($value) ){ |
| [210](#L210) | //Merge tag |
| [211](#L211) | $data->$ind = apply\_filters( 'ninja\_forms\_merge\_tags', $value ); |
| [212](#L212) | } |
| [213](#L213) | } |
| [214](#L214) |  |
| [215](#L215) | return $data; |
| [216](#L216) | } |
| [217](#L217) |  |
| [218](#L218) |  |
| [219](#L219) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/ninja-forms/trunk/includes/Routes/Submissions.php?rev=2543837&format=txt)
* [Original Format](/export/2543837/ninja-forms/trunk/includes/Routes/Submissions.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_2be1c875_20250115_090549.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/09/Recently-Patched-Vulnerabilities-in-Ninja-Forms-Plugin-Affects-Over-1-Million-Site-Owners.png)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

September 22, 2021

# Recently Patched Vulnerabilities in Ninja Forms Plugin Affect Over 1 Million Site Owners

On August 3, 2021 the Wordfence Threat Intelligence team initiated the responsible disclosure process for two vulnerabilities that were discovered in [Ninja Forms](https://wordpress.org/plugins/ninja-forms/), a WordPress plugin installed on over 1,000,000 sites. These flaws made it possible for an attacker to export sensitive information and send arbitrary emails from a vulnerable site that could be used to phish unsuspecting users.

Wordfence Premium users received a firewall rule to protect against any exploits targeting this vulnerability on August 2, 2021. Sites still using the free version of Wordfence received the same protection on September 1, 2021.

We sent the full disclosure details to Ninja Forms on August 3, 2021, as per the [security disclosure policy listed on Ninja Forms website](https://ninjaforms.com/security/). Ninja Forms quickly acknowledged the report the same day and informed us that they would start working on a patch immediately. A patch was released on September 7, 2021 in version 3.5.8.

We strongly recommend updating immediately to the latest patched version of Ninja Forms to patch these security issues, which is version 3.5.8.2 of Ninja Forms at the time of this publication.

---

**Description:** Unprotected REST-API to Sensitive Information Disclosure

**Affected Plugin:** Ninja Forms

**Plugin Slug:** ninja-forms

**Affected Versions:** <= 3.5.7

**CVE ID:** [CVE-2021-34647](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34647)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 3.5.8

Ninja Forms is one of the most popular form building plugins for WordPress websites. One feature the plugin offers is the ability to export all of a site’s form submissions for reviewing and analyzing submission data. Unfortunately, this was insecurely implemented making it possible for any authenticated user to export all of a site’s submission data.

The plugin registered a rest route `/ninja-forms-submissions/export` which did in fact use a `permissions_callback`. However, this check did nothing more than validate whether or not a user was logged in through the `is_user_logged_in()` function. There was no check to verify if a user had the appropriate permissions to execute the function.

```
    public function permission_callback(WP_REST_Request $request) {

        //Set default to false
        $allowed = false;

        //Check Capability of logged in users
        $allowed = is_user_logged_in();
```

This meant that any logged-in user could use the `/ninja-forms-submissions/export` endpoint and export everything that had ever been submitted to one of the site’s forms. Depending on how a site’s forms were configured this data could contain sensitive personally identifiable information (PII) that would provide an attacker with valuable information to conduct other attacks.

---

**Description:** Unprotected REST-API to Email Injection

**Affected Plugin:** Ninja Forms

**Plugin Slug:** ninja-forms

**Affected Versions:** <= 3.5.7

**CVE ID:** [CVE-2021-34648](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34648)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 3.5.8

In addition to the previous bulk submission export vulnerability, there was another functionality in the plugin that was insecurely implemented using the same vulnerable `permissions_callback` validation.

The plugin registered the `/ninja-forms-submissions/email-action` endpoint which was intended to trigger bulk email actions on form submissions. This functionality was intended to allow site owners to trigger a variety of email actions like sending an email confirmation, or email notification, in bulk in response to user submissions.

Unfortunately, due to the fact that this functionality used the same `permissions_callback` check, any authenticated user could trigger an email action using the REST-API endpoint. To make matters worse, the `trigger_email_action` function executed by the `email-action` endpoint crafted the email based on values that could be passed in the request. This made it possible for an attacker to craft a completely unique email, which included the body and subject, and then send it from the vulnerable site to any email address.

```
   public function trigger_email_action(WP_REST_Request $request) {
        //Extract required data
        $data = json_decode($request->get_body());
        $form = Ninja_Forms()->form( $data->formID );
        $sub = $form->get_sub( $data->submission );
        $field_values = $sub->get_field_values();

        //Throw error if we're missing data
        if( !isset($data) || empty($form) || empty($sub) ) {
            return new WP_Error( 'malformed_request', __('This request is missing data', 'ninja-forms') );
        }

        //Process Merge tags
        $action_settings = $this->process_merge_tags( $data->action_settings, $data->formID, $sub );
        //Process Email Action
        $email_action = new NF_Actions_Email();
        $result = $email_action->process( (array) $action_settings, $data->formID, (array) $field_values );

        //Return true if wp_mail returned true or the submission ID if it failed.
        $return = !empty($result['actions']['email']['sent']) && true === $result['actions']['email']['sent'] ? $result['actions']['email']['sent'] : $sub->get_seq_num();

        return $return;
```

This vulnerability could easily be used to create a phishing campaign that could trick unsuspecting users into performing unwanted actions by abusing the trust in the domain that was used to send the email. In addition, a more targeted spear phishing attack could be used to fool a site owner into believing that an email was coming from their own site. This could be used to trick an administrator into entering their password on a fake login page, or allow an attacker to take advantage of a second vulnerability requiring social engineering, such as Cross-Site Request Forgery or Cross-Site Scripting, which could be used for site takeover.

## Disclosure Timeline

**August 2, 2021** – Conclusion of the plugin analysis that led to the discovery of two vulnerabilities in the Ninja Forms WordPress plugin. We develop a firewall rule to protect Wordfence customers and release it to Wordfence Premium users.

**August 3, 2021** – We send over full disclosure details. The vendor confirms they have received the details and will begin working on a fix.

**August 31, 2021** – We follow-up with the vendor to check on the status of the security fixes.

**September 1, 2021** – Wordfence free users receive the firewall rule. We receive an update that the security fixes are in place and ready to be released. The vendor informs us that they will follow-up with an estimated release date.

**September 6, 2021** – We receive an update that the patched version will be released in a few days.

**September 7, 2021** – A newly updated version of the plugin, 3.5.8, is released containing sufficient patches.

## Conclusion

In today’s post, we detailed two flaws in Ninja Forms that granted attackers the ability to export sensitive data and send arbitrary emails from any vulnerable site. These flaws have been fully patched in version 3.5.8. We recommend that WordPress users immediately update to the latest version available, which is version 3.5.8.2 at the time of this publication.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210922&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule to protect against any exploits targeting this vulnerability on August 2, 2021. Sites still using the free version of Wordfence received the same protection on September 1, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as these are serious vulnerabilities that can lead to sensitive information disclosure.

[Click here to join the WordPress Security mailing list](https://www.wordfence.com/subscribe-to-the-wordfence-email-list/) and receive vulnerability reports like this the moment they are published.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F09%2Frecently-patched-vulnerabilities-in-ninja-forms-plugin-affects-over-1-million-site-owners%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F09%2Frecently-patched-vulnerabilities-in-ninja-forms-plugin-affects-over-1-million-site-owners%2F&text=Recently%20Patched%20Vulnerabilities%20in%20Ninja%20Forms%20Plugin%20Affect%20Over%201%20Million%20Site%20Owners&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F09%2Frecently-patched-vulnerabilities-in-ninja-forms-plugin-affects-over-1-million-site-owners%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


