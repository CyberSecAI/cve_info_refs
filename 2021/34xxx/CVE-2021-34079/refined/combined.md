=== Content from www.npmjs.com_9a03f204_20250114_214701.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## docker-tester

1.2.2Â â¢Â PublicÂ â¢Â Published 6 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [2 Dependencies](?activeTab=dependencies)
* [0 Dependents](?activeTab=dependents)
* [10 Versions](?activeTab=versions)

# docker-tester

Set up a testing environment with a docker-compose file and verify its up before running tests

![img](https://i.imgur.com/z5ozgeC.jpg)

[![](https://img.shields.io/npm/v/docker-tester.svg?style=for-the-badge)](https://www.npmjs.com/package/docker-tester)
[![](https://img.shields.io/david/mintzo/docker-tester.svg?style=for-the-badge)](https://www.npmjs.com/package/docker-tester)
![](https://img.shields.io/npm/l/docker-tester.svg?style=for-the-badge)

[![NPM](https://nodei.co/npm/docker-tester.png)](https://nodei.co/npm/docker-tester/)

---

## Install

```
npmÂ iÂ docker-testerÂ --save-dev
```

* *docker and docker-compose are required to be installed and acsecible from the terminal, you can [get it here](https://docs.docker.com/compose/install/)*

## Example

### running tests in mocha

```
///Â mocha_test_file.spec.jsÂ constÂ TestingEnvironmentÂ =Â require('docker-tester');Â constÂ testingEnvironmentÂ =Â newÂ TestingEnvironment({Â Â dockerComposeFileLocation:Â __dirname,Â Â dockerFileName:Â 'test.docker-compose.yml',Â Â verifications:Â {Â Â Â Â Â httpServer:Â {Â Â //Â 'verificationType'Â definedÂ inÂ theÂ docker-composeÂ fileÂ Â Â Â Â Â verificationFunction:Â asyncÂ (service)Â =>Â {Â Â Â Â Â Â Â Â Â //Â checkÂ thatÂ serviceÂ isÂ upÂ (usuallyÂ httpÂ request),Â rejectÂ ifÂ notÂ readyÂ Â Â Â Â Â },Â Â promiseRetryOptions:Â {Â retries:Â 4Â }Â }Â Â }Â });Â //Â startingÂ environmentÂ beforeÂ runningÂ testsbefore(asyncÂ functionÂ ()Â {Â Â this.timeout(0);Â Â awaitÂ testingEnvironment.start();});Â //Â stoppingÂ environmentÂ afterÂ testsÂ areÂ doneafter(asyncÂ functionÂ ()Â {Â Â this.timeout(0);Â Â awaitÂ testingEnvironment.stop();});Â describe('SimpleÂ Usage',Â ()Â =>Â {Â Â it('someÂ tests',Â ()Â =>Â {Â Â Â Â //Â testÂ codeÂ onlyÂ runsÂ afterÂ environmentÂ isÂ readyÂ Â Â Â constÂ serviceÂ =Â testingEnvironment.getActiveService('example-node-server')Â //Â gettingÂ serviceÂ configurationÂ Â Â Â });});
```
### docker-compose file

```
#Â test.docker-compose.ymlÂ version:Â '3.1'services:Â Â example-node-server:Â Â Â Â image:Â nodeÂ Â Â Â ports:Â Â Â Â Â Â -Â 7000:80Â Â Â Â environment:Â Â Â Â Â Â verificationType:Â httpServerÂ #Â verificationÂ typeÂ forÂ serviceÂ Â Â Â example-mongo:Â Â Â Â image:Â mongoÂ Â Â Â ports:Â Â Â Â Â Â -Â 80Â Â Â Â environment:Â Â Â Â Â Â verificationType:Â mongodb
```

[Full code for this and more examples available here](https://github.com/mintzo/docker-tester-examples)

## Usage

create a new TestingEnvironment instance, `.start()` and `.stop()` async function, use `docker-compose up` and `docker-compose down`

`.stop()` resolves when all containers have stopped.

`.start()` resolves when all containers are up and ready.

in the docker-compose file, services requiring verification that they are ready will be verified according to there defined verification type, found under environment -> verificationType

TestingEnvironment instance will match verifications key to `verificationType` in the docker-compose file.

## Documentation

### TestingEnvironment() Constructor

the testing environment can be configured by passing in an object with the fallowing properties

required parameters:

* `dockerComposeFileLocation` - the folder path where the docker-compose file is found
* `dockerFileName` - the docker-compose full file name

optional:

* `verifications` - verifications by type that check when services are ready
  + `verificationFunction` - *required* - an async function or a function that returns a promise to verify the service, receives the service information when called
  + `promiseRetryOptions` - *(optional)* - promise retry settings, same as [promise-retry](https://www.npmjs.com/package/promise-retry)
    - `retries` - number of retries , *default 5*
* `disableLogs` - disables logs docker-tester actions, when set to `true`

example options object:

```
newÂ TestingEnvironment({Â Â dockerComposeFileLocation:Â __dirname,Â Â dockerFileName:Â 'test.docker-compose.yml',Â Â verificationsÂ =Â {Â Â verificationType:Â {Â //Â theÂ verificationÂ toÂ runÂ matchingÂ theÂ verificationTypeÂ inÂ theÂ docker-composeÂ fileÂ Â Â Â verificationFunction,Â Â Â Â promiseRetryOptionsÂ Â }}
```
### .start({ stopIfUp, verifyUp })

starts all services found in the docker-compose file *(`docker-compose up -d`)*, verifies they are ready and then resolves, rejects if there was a problem or if verify promises are rejected

optional settings:

* `stopIfUp` - *(default: true)* - runs `.stop()` before starting services
* `verifyUp` - *(default: true)* - runs `.verifyAllServices()` after starting services

example code:

```
constÂ testingEnvironmentÂ =Â newÂ TestingEnvironment({Â Â //Â requiredÂ options...});Â awaitÂ testingEnvironment.start();
```
### .stop()

stops all services running services *(`docker-compose down`)* then resolves,rejects if there was a problem or if verify promises are rejected.

example code:

```
constÂ testingEnvironmentÂ =Â newÂ TestingEnvironment({Â Â //Â requiredÂ options...});Â awaitÂ testingEnvironment.start();awaitÂ testingEnvironment.stop();
```
### .verifyAllServices()

verifies all services are ready using the service `verificationType` then resolves,rejects if there was a problem or if verify promises are rejected.

example code:

```
constÂ testingEnvironmentÂ =Â newÂ TestingEnvironment({Â Â //Â requiredÂ options...});Â awaitÂ testingEnvironment.start({Â verifyUp:Â falseÂ });awaitÂ testingEnvironment.verifyAllServices();
```
### .getActiveService(serviceName)

returns an active service configuration by specified service name in the docker-compose file.

can be used to retrieve external exposed ip, not defining an exposed ip can enable running tests in parallel.

```
#Â exampleÂ docker-compose.ymlÂ example-service:Â Â Â Â environment:Â Â Â Â Â Â verificationType:Â httpServerÂ Â Â Â ports:Â Â Â Â Â Â -Â '3001:80'Â #preÂ definedÂ port,Â canÂ beÂ aÂ problemÂ whenÂ runningÂ inÂ parallelÂ Â Â Â example-service:Â Â Â Â environment:Â Â Â Â Â Â verificationType:Â httpServerÂ Â Â Â ports:Â Â Â Â Â Â -Â 80Â #noÂ exposedÂ port,Â dockerÂ willÂ attachÂ automaticallyÂ
```

example code:

```
constÂ testingEnvironmentÂ =Â newÂ TestingEnvironment({Â Â //Â requiredÂ options...});Â awaitÂ testingEnvironment.start();awaitÂ testingEnvironment.getActiveService('example-service');Â //Â .getActiveService()Â exampleÂ resultÂ {Â Â Â image:Â 'node',Â Â working_dir:Â '/service',Â Â volumes:Â [Â '../:/service'Â ],Â Â ports:Â [Â {Â external:Â "7000",Â internal:Â "3000"Â }Â ],Â Â command:Â 'npmÂ start',Â Â environment:Â {Â verificationType:Â 'httpServer'Â }Â }
```

## Readme

### Keywords

* [docker](/search?q=keywords:docker)
* [docker-compose](/search?q=keywords:docker-compose)
* [test](/search?q=keywords:test)
* [testing](/search?q=keywords:testing)
* [mocha](/search?q=keywords:mocha)
## Package Sidebar

### Install

`npm i docker-tester`

### Repository

[Gitgithub.com/mintzo/docker-testing](https://github.com/mintzo/docker-testing)

### Homepage

[github.com/mintzo/docker-tester#readme](https://github.com/mintzo/docker-tester#readme)

### DownloadsWeekly Downloads

40

### Version

1.2.2

### License

MIT

### Unpacked Size

18.2 kB

### Total Files

9

### Last publish

6 years ago

### Collaborators

* [![mintzo](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yNDM1ZmU3YzY2MWFjNGE0OWIzZWEzOTMyNDA2Yzk5OD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.WzwNSd-gIdEOgpciNMcHt1LLjNrMn9iR8UfuroV5pQ8 "mintzo")](/~mintzo)
[**Try** on RunKit](https://runkit.com/npm/docker-tester)[**Report** malware](/support?inquire=security&security-inquire=malware&package=docker-tester&version=1.2.2)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from advisory.checkmarx.net_ee7349e5_20250114_214658.html ===
![](data:image/svg+xml...)![logo](data:image/gif;base64...)![logo](/_next/static/media/logo.4a80e7ce.png)

* [Advisories](/)
* [Disclosure Policy](/disclosure-policy/)
* [Contact Us](https://www.checkmarx.com/contact-us/)
* [Check with SCA](https://checkmarx.com/product/cxsca-open-source-scanning/)
Defend your code againstÂ SpringShellÂ in two ways: read ourÂ [blog post](https://checkmarx.com/blog/springshell-remote-code-execution-via-spring-web/)with what-to-do advice, and useÂ Checkmarx SCAÂ to test your applications.

From time to time, our security researchers find zero-day vulnerabilities in open source projects. When this happens, we inform the relevant maintaners of the package and publish our findings here only after theyâve been remediated, or when a patch is available.

* 1
* 2
* 3
* 4
* 5
* 6
* 7
* 8
* 9
* 10
* 11
* 12
* 13
* 14
Â© 2024 Checkmarx Ltd.

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)

* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

* [Disclosure Policy](/disclosure-policy/)
* [Blog](https://www.checkmarx.com/blog/)
* [Terms of Use](https://www.checkmarx.com/terms-of-use/)
* [Privacy Policy](https://www.checkmarx.com/privacy-policy/)
* [Cookie Policy](https://www.checkmarx.com/cookie-policy/)

Â© 2024 Checkmarx Ltd.
