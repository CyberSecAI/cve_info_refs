=== Content from www.wordfence.com_5f75c2cb_20250115_093403.html ===


![](https://www.wordfence.com/wp-content/uploads/2021/08/XSS-Vulnerability-Patched-in-SEOPress-Affects-100000-sites.jpg)

[![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=80&d=mm&r=g)Chloe Chamberland](https://www.wordfence.com/blog/author/wfchloe/)

August 16, 2021

# XSS Vulnerability Patched in SEOPress Affects 100,000 sites

On July 29, 2021 the Wordfence Threat Intelligence team initiated the responsible disclosure process for a vulnerability that we discovered in [SEOPress](https://wordpress.org/plugins/wp-seopress/), a WordPress plugin installed on over 100,000 sites. This flaw made it possible for an attacker to inject arbitrary web scripts on a vulnerable site which would execute anytime a user accessed the “All Posts” page.

Wordfence Premium users received a firewall rule to protect against any exploits targeting this vulnerability on July 29, 2021. Sites still using the free version of Wordfence will receive the same protection on August 28, 2021.

We initially reached out to the plugin developer on July 29, 2021. After receiving confirmation of an appropriate communication channel the next day on July 30, 2021, we provided the full disclosure details. The vendor quickly acknowledged the report and a patch was released on August 4, 2021 in version 5.0.4.

We strongly recommend updating immediately to the latest patched version of SEOPress, version 5.0.4, if you are currently using a vulnerable version of the plugin.

---

**Description:** Stored Cross-Site Scripting via REST-API

**Affected Plugin:** [SEOPress](https://wordpress.org/plugins/wp-seopress/)

**Plugin Slug:** wp-seopress

**Affected Versions:** 5.0.0 – 5.0.3

**CVE ID:** [CVE-2021-34641](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34641)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Chloe Chamberland

**Fully Patched Version:** 5.0.4

SEOPress is a WordPress plugin designed to optimize the SEO of WordPress sites through many different features, like the ability to add SEO meta-data, breadcrumbs, schemas, and more. One feature the plugin implements is the ability to add a SEO title and description to posts, and this can be done while saving edits to a post or via a newly introduced REST-API endpoint.

```
        register_rest_route('seopress/v1', '/posts/(?P<id>\d+)/title-description-metas', [
            'methods'             => 'PUT',
            'callback'            => [$this, 'processPut'],
            'args'                => [
                'id' => [
                    'validate_callback' => function ($param, $request, $key) {
                        return is_numeric($param);
                    },
```

Unfortunately, this REST-API endpoint was insecurely implemented. The `permissions_callback` for the endpoint only verified if the user had a valid REST-API nonce in the request. A valid REST-API nonce can be generated by any authenticated user using the rest-nonce WordPress core AJAX action. This meant that any authenticated user, like a subscriber, could call the REST route with a valid nonce, and update the SEO title and description for any post.

```
            'permission_callback' => function ($request) {
                $nonce = $request->get_header('x-wp-nonce');
                if ( ! wp_verify_nonce($nonce, 'wp_rest')) {
                    return false;
                }

                return true;
```

The payload could include malicious web scripts, like JavaScript, due to a lack of sanitization or escaping on the stored parameters. These web scripts would then execute any time a user accessed the “All Posts” page. As always, cross-site scripting vulnerabilities such as this one can lead to a variety of malicious actions like new administrative account creation, webshell injection, arbitrary redirects, and more. This vulnerability could easily be used by an attacker to take over a WordPress site.

## Disclosure Timeline

**July 29, 2021** – Initial discovery and analysis of vulnerability. We develop a firewall rule to protect Wordfence customers and release it to Wordfence Premium users. We initiate contact with the plugin vendor.

**July 30, 2021** – The vendor confirms the inbox for handling disclosure. We send over full disclosure details.

**August 1, 2021** – The vendor confirms they have received the details and will begin working on a fix.

**August 4, 2021** – A newly updated version of the plugin is released containing sufficient patches.

**August 28, 2021** – Wordfence free users receive firewall rule.

## Conclusion

In today’s post, we detailed a flaw in SEOPress that granted attackers the ability to inject arbitrary web scripts that could ultimately allow attackers to take over WordPress sites. This flaw has been fully patched in version 5.0.4. We recommend that WordPress users immediately update to the latest version available, which is version 5.0.4 at the time of this publication, if running a vulnerable version of this plugin.

[Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20210812&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) users received a firewall rule to protect against any exploits targeting this vulnerability on July 29, 2021. Sites still using the free version of Wordfence will receive the same protection on August 28, 2021.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as this is a vulnerability that can lead to full site takeover.

[Click here to join the WordPress Security mailing list](https://www.wordfence.com/subscribe-to-the-wordfence-email-list/) and receive vulnerability reports like this the moment they are published.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F08%2Fxss-vulnerability-patched-in-seopress-affects-100000-sites%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F08%2Fxss-vulnerability-patched-in-seopress-affects-100000-sites%2F&text=XSS%20Vulnerability%20Patched%20in%20SEOPress%20Affects%20100%2C000%20sites&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F08%2Fxss-vulnerability-patched-in-seopress-affects-100000-sites%2F)

## Comments

2 Comments

* ![](https://secure.gravatar.com/avatar/e7f463bf6fe4f3319530beffe634007c?s=96&d=mm&r=g)
  Brent
  August 16, 2021
   9:37 am

  We're still on the latest 4.x version. Been avoiding going to 5.x till all the bugs are worked out. Is this vulnerability affecting 4.x?

+ ![](https://secure.gravatar.com/avatar/9bf72594e071c28445ed7a1be0de1a23?s=96&d=mm&r=g)
  Chloe Chamberland
  August 16, 2021
   12:36 pm

  Hi Brent,

  This vulnerability does not affect any versions prior to 5.0.0, so the 4.x versions are not vulnerable to this. Thanks!

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


