The provided content relates to CVE-2021-34070.

**Root cause of vulnerability:**
The vulnerability is caused by an out-of-bounds read in the `VC1SequenceHeader::decode_sequence_header_adv` function within `vc1Parser.cpp`. The code attempts to access an element of the `ff_vc1_fps_nr` array using an index derived from the input data, without proper bounds checking, leading to an out-of-bounds read.

**Weaknesses/vulnerabilities present:**
- **Out-of-bounds read:** The code reads memory outside the allocated boundaries of the `ff_vc1_fps_nr` array. This occurs when the calculated index `nr - 1` is out of range of the array.
- **Insufficient bounds checking:** The initial `if` condition `(nr && nr < 8 && dr && dr < 3)` does not prevent access to out of bound index of `ff_vc1_fps_nr` array.

**Impact of exploitation:**
- **Crash:** The out-of-bounds read can lead to a program crash due to accessing invalid memory locations.
- **Potential information disclosure:** Reading from invalid memory locations could potentially leak sensitive data although this is not clearly described.
- **Denial of service:** Repeated crashes can lead to denial of service.

**Attack vectors:**
- **Malicious media file:** A specially crafted VC-1 video file can be provided as input to trigger the vulnerability when parsed by `tsMuxer`.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide a malicious VC-1 video file to the application.
- No special privileges are required.

**Additional details:**
- The issue was discovered by Cem Onat Karagun of Diesec.
- The vulnerability was fixed by adding a more restrictive bounds check in the if condition to check whether the index variable nr is within the boundaries of the `ff_vc1_fps_nr` array and also added check for index variables `dr` and `nr` to be greater than or equal to 0 and also size of `ff_vc1_fps_nr` array was increased from 5 to 7.
- The fix involves changing the condition from `if (nr && nr < 8 && dr && dr < 3)` to `if (nr && nr < 5 && nr >= 0 && dr && dr < 3 && dr >= 0)` in `vc1Parser.cpp` and changing `const int ff_vc1_fps_nr[5]` to `const int ff_vc1_fps_nr[7]` in `vc1Parser.h`.
- The issue was reported as a "global-buffer-overflow" by AddressSanitizer, but is actually an out-of-bounds read.