The provided content is related to CVE-2021-34431.

**Root cause of vulnerability:**
- A memory leak occurs in the Mosquitto broker when a CONNECT packet with the will flag and a will property (will delay interval) is sent, but without a will topic and will message.

**Weaknesses/vulnerabilities present:**
- Missing release of memory after its effective lifetime (CWE-401). Specifically, the context allocated in `context__init` is not freed by calling `context__cleanup` when a crafted CONNECT packet is received.

**Impact of exploitation:**
- Denial of Service (DoS). By repeatedly sending crafted CONNECT messages, an attacker can cause a memory leak, eventually exhausting available memory and causing the broker to crash or become unresponsive.

**Attack vectors:**
- Sending a crafted MQTT CONNECT packet to the broker. This packet must have the will flag and the will delay interval property set, but without specifying the will topic and will message.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated client that has connected with MQTT v5.
- The attacker must have network access to the broker's port (typically 1883).