=== Content from beefaaubee.medium.com_2e97ba72_20250114_222132.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5760dc461bd0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbeefaaubee.medium.com%2Fcve-2021-26833-cleartext-storage-in-a-file-or-on-disk-in-timelybills-1-7-0-5760dc461bd0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbeefaaubee.medium.com%2Fcve-2021-26833-cleartext-storage-in-a-file-or-on-disk-in-timelybills-1-7-0-5760dc461bd0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2021–26833: Cleartext Storage in a File or on Disk in TimelyBills ≤ 1.7.0 for iOS and versions ≤ 1.21.115 for Android

[![BeeFaauBee](https://miro.medium.com/v2/resize:fill:88:88/1*FTM85kAqHwWhm6Y-Ccma_Q.png)](/?source=post_page---byline--5760dc461bd0--------------------------------)

[BeeFaauBee](/?source=post_page---byline--5760dc461bd0--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff5bf8dffcab3&operation=register&redirect=https%3A%2F%2Fbeefaaubee.medium.com%2Fcve-2021-26833-cleartext-storage-in-a-file-or-on-disk-in-timelybills-1-7-0-5760dc461bd0&user=BeeFaauBee&userId=f5bf8dffcab3&source=post_page-f5bf8dffcab3--byline--5760dc461bd0---------------------post_header-----------)

5 min read·Apr 6, 2021

--

Listen

Share

Clear text Storage in a File or on Disk in TimelyBills ≤ 1.7.0 for iOS and versions ≤ 1.21.115 for Android allows attacker who can locally read user’s files obtain JWT tokens for user’s account due to insufficient cache clearing mechanisms. A threat actor can obtain sensitive user data by decoding the tokens as JWT is signed and encoded, not encrypted

# Background

The application requires users to provide username and password or sign-in via social media accounts (Google,Facebook etc.). After validation of these accounts, a JWT token is generated which is further utilized in authentication and authorization while performing various user-level operations.

While conducting security research on the application, It was understood that these JWT tokens are stored in a local file located within the app directory. Furthermore, It was also discovered that the authorization token doesn’t expire and remains in the local directory after logging out of the application.

![]()

Image: Authorization Token stored in Local Directory

# Impact

This can really help malicious applications (If installed) to steal such sensitive information from device and utilize the same for application. Furthermore, threat actor can steal confidential information by decoding the JWT token which can reveal information about victim.

# Additional Discoveries of Vulnerabilities

While performing researching over the app it was understood that the application is mainly utilizing functionality as reminder to remind a person about paying their bills on recurring basis or one time. All one has to do is schedule the payments/bills you have to pay and it will remind you of your payments as per your schedule settings. While exploring the application, this thing caught my eye :

> PRIVACY POLICY
>
> TimelyBills knows that you care how information provided by you is used and shared, and we appreciate your trust that we will do so carefully and sensibly. At TimelyBills, we pride ourselves on our commitment to protecting your privacy. This Privacy Statement describes in greater detail the privacy policy at TimelyBills.

I was pretty much skeptical about their claims of ensuring security of customers data. Few pointers I noted from their privacy statement which were :

* Access of back-end services using secure **authenticated** tokens.
* Data from app, website to our backed servers is transferred over HTTPS which is secured and encrypted using SSL.
* **Security PIN:** You can enable a 4 digit security PIN which protects the app from unauthorized or unwanted access, and the app asks your security PIN to allow access to the app.
* **Password:** Your account and app data is additionally protected with a password encrypted with 256 bit SHA algorithm.

This was enough for me to give it a try and look for the security controls they claim to have implemented in their application. However, to my surprise, with only few hours spent in exploring the app, I had enough evidence to defend my claim about the application have poor security control implementation in their application as well as API. Some stats to share about the application

![]()

(Image : Stats for app)

I’ll begin with all of the findings one by one

# 1 — Account Takeover

This was very simple and required little information about the victim. All you need to have is account e-mail address or ID that is concatenated during password reset request. Consider the following Scenario :

![Image : Account Takeover Graphical Representation]()

Image: Account Takeover Graphical Representation

The part where ID has been highlighted is the interesting one. If an attacker manages to get ID of victim, their account password can be changed by just replacing the ID at the end of request, providing new password and Password is changed successfully.

![]()

Image: Link For Password Reset

![]()

Image: Link for Password Reset Request Manipulation and Response

# 2 — Uploading Malicious Files on Server

The application provides users to upload or attach their billing details by adding expenses or through different other resources by taking picture of the subjected item and then saving it through application.

On back-end, the application processes such requests as POST and uploads the same on their cloud infrastructure with unique identifier. While analyzing the application, It was discovered that the app doesn’t validate file extensions or content type that has been POST’d to the application API therefore allowing it to process and save the file on server.

![]()

Image: Initial Request of File upload

![]()

Image: Edited request for File upload

![]()

Image: File GET request

# Timeline

2020/10/28 — Contact made with Vendor for sharing Information regarding vulnerabilities.

2020/10/28 — Contact Established with Vendor.

2020/10/28 — Provided detailed report and explanation on vulnerabilities that required immediate attention.

2020/10/29 — Vendor Acknowledges details received and forwarded to engineering department.

2020/11/10 — Approached vendor for updates on patches/fixes (No Response)

2020/11/25 — Activity noticed on application new release. Requested if the vulnerabilities shared are highlighted/fixed (No Response)

2020/11/30 — Approached Vendor again and requested for sharing advisory/coordinated vulnerability disclosure for all customers.

2020/12/01 — Vendor acknowledges vulnerabilities and share timeline for fixation by 20th December, 2020

2020/12/21 — Approached Vendor to get update on vulnerabilities shared are fixed (No Response)

2020/12/23— Approached Vendor again and requested for sharing advisory/coordinated vulnerability disclosure for all customers.(No Response)

2020/12/26 — Vendor responded with teams away due to Christmas holidays.

2021/01/15 — Approached Vendor again and requested for sharing advisory/CVD for all customers. (No Response)

2021/02/28 — CVE ID requested from CNA against app

2021/03/31 — CVE issued

2021/04/05 — Public Disclosure

# Final Notes

InfoSec community is really one of the greatest one. Earlier, I had uploaded this write-up and few mistakes were identified to which I’m really thankful to [John Jackson](https://twitter.com/johnjhacking). Without his support I don’t think this whole research would have been compiled in a write-up properly.

[Responsible Dis](https://medium.com/tag/responsible-dis?source=post_page-----5760dc461bd0--------------------------------)[Android Security](https://medium.com/tag/android-security?source=post_page-----5760dc461bd0--------------------------------)[Api Security](https://medium.com/tag/api-security?source=post_page-----5760dc461bd0--------------------------------)[Application Security](https://medium.com/tag/application-security?source=post_page-----5760dc461bd0--------------------------------)[Information Security](https://medium.com/tag/information-security?source=post_page-----5760dc461bd0--------------------------------)

--

--

[![BeeFaauBee](https://miro.medium.com/v2/resize:fill:96:96/1*FTM85kAqHwWhm6Y-Ccma_Q.png)](/?source=post_page---post_author_info--5760dc461bd0--------------------------------)[![BeeFaauBee](https://miro.medium.com/v2/resize:fill:128:128/1*FTM85kAqHwWhm6Y-Ccma_Q.png)](/?source=post_page---post_author_info--5760dc461bd0--------------------------------)Follow[## Written by BeeFaauBee](/?source=post_page---post_author_info--5760dc461bd0--------------------------------)[88 Followers](/followers?source=post_page---post_author_info--5760dc461bd0--------------------------------)·[14 Following](/following?source=post_page---post_author_info--5760dc461bd0--------------------------------)

Dealing with Information Security as my Day Job and Information Security Research at night. Co-organizer for #BSidesIslamabad advocate for #HackingIsNotACrime

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----5760dc461bd0--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----5760dc461bd0--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----5760dc461bd0--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5760dc461bd0--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----5760dc461bd0--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----5760dc461bd0--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5760dc461bd0--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5760dc461bd0--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----5760dc461bd0--------------------------------)[Teams](https://medium.com/business?source=post_page-----5760dc461bd0--------------------------------)


