Based on the provided content, here's the breakdown of the vulnerability described in CVE-2021-26722:

**Root Cause of Vulnerability:**

- The root cause is a lack of proper HTML output encoding of the search query within the "No results found" message. The application displays the user-provided search query directly within the HTML of the "No results found" message without sanitizing or encoding it.

**Weaknesses/Vulnerabilities Present:**

- **Reflected Cross-Site Scripting (XSS):** The primary vulnerability is a reflected XSS. The application takes user input (the search query) and reflects it back in the response without proper encoding. This allows an attacker to inject malicious code into the search query, which is then executed in the user's browser.

**Impact of Exploitation:**

- **Full user compromise:** An attacker who successfully exploits this vulnerability can gain complete control over the user's browser session within the context of the vulnerable application. This can lead to:
    - **Stealing credentials:** Altering the login form to steal user credentials.
    - **Performing actions:** Executing any action the user is able to perform within the application.
    - **Viewing sensitive information:** Viewing any data the user can access.
    - **Modifying data:** Changing information the user has rights to modify.

**Attack Vectors:**

- **Manipulated search URL:** The attacker can craft a malicious link containing a payload within the search query. When the victim clicks this link, the malicious payload gets executed within their browser when the "No results found" message is displayed
- The vulnerable URL pattern is `http://[OnCallHost]/query/<malicious_payload>/all`

**Required Attacker Capabilities/Position:**

- The attacker needs the ability to craft a malicious URL with the XSS payload in the search query.
- The attacker needs to lure a victim to click on the crafted malicious URL. This could be achieved via phishing attacks, social media or other means.