=== Content from unparalleled.eu_86670af7_20250115_100341.html ===
Firejail: Insecure Use of OverlayFS as Sandbox File System
==========================================================
Advisory: UNPAR-2021-0
Component: Firejail
Vendor: https://firejail.wordpress.com
Version(s): Starting 0.9.30 (or earlier) till 0.9.64.2
Weakness(es): CWE-61: UNIX Symbolic Link (Symlink) Following
CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition
CVE: None assigned
CVSSv3.1: Base score 7.8: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
Author: Roman Fiedler
Summary:
========
Firejail is a SUID security sandbox program that reduces the
risk of security breaches by restricting the running environment
of untrusted applications using Linux namespaces and seccomp-bpf.
Therefore it may span an OverlayFS over the complete file system,
redirecting any file system modifications to a temporary space.
Thus malicious sandboxed processes cannot change files on the
"real" active file system. To create such a sandbox elevated
privileges are required.
When setting up the sandbox Firejail tries to ensure, that the
location for temporary OverlayFS file root is not writable by
any unprivileged user as that may allow privilege escalation.
Due to a race condition this check may report a wrong status
and thus both follow symbolic links and use an untrusted directory
as source. With crafted content using the untrusted directory
allows creation of or granting write access to arbitrary files.
Timeline:
\* 20201208: Reported to Linux distribution shipping firejail
as optional packet (not in default install)
\* 20201214: Triaged as (critical) without timeline
\* 20210121: Vulnerability out of scope for Linux distributon,
distributor contacted upstream.
\* 20210125: Firejail security contact notified by researcher
\* 20210131: Firejail security contact initial response
\* 20210208: Firejail patch released
Details:
========
OverlayFS Basics:
Firejail supports persistent overlays on the file system when
running an untrusted process. Thus the sandboxed process can
store information in files but these modifications are not
visible to other processes outside the sandbox. This feature
is provided by the "overlay" Linux file system type. It uses
an "upper" directory that contains changes put over the data
in "lower" before presenting the modified file system tree to
the user side. Therefore data in "upper" shadows what was there
on "lower".
When putting an overlay on top of the root file system, putting
a symbolic link as "etc" will effectively hide the real "etc"
directory and show the link instead. A user writable "upper"
directory therefore allows the user to add, replace or remove
any elements within the file system tree. Within the mounted
overlay all elements from "upper" will be shown with their
respective attributes. The unprivileged user therefore may
replace privileged files with unprivileged versions but not
the other way round (substitute root.root /usr/bin/ping with
one owned by user.users). See [2] for more information.
Firejail OverlayFS Use:
For Firejail this means that a writable "upper" directory will
modify the file system tree later to be presented to the sandboxed
process. This alone would not be problematic as the file system
is mounted in a separate namespace, where SUID binaries do not
work anymore (nonewprivs). Therefore the sandboxed process cannot
gain privileges e.g. due to a modified lib-c.
Even so Firejail wants to prevent any of those changes as a
writable upper directory would also void any assumptions on
the directory structure inside the sandbox. Firejail relies on
a sane directory structure as it will hide blacklisted files
and directories, that may allow leaking general system information
to the sandboxed process. With Firejail using an untrusted
"upper", sandbox setup will continue on the rogue overlay of
the real root file system.
The relevant source code is function "void fs\_overlayfs(void)"
in [3], line 943. The code performing the checks and the overlay
mount was introduced 20150816 with commit
980979d77ebd30ca1d6b518d48068a1e3660a4e8 named *--overlay
rework, adding a persistent directory; implemented --overlay-tmpfs
option*, see [4]. The code was first released 20150914 as
version 0.9.30. Due to changes in OverlayFS behavior functionality
should be disabled on kernels newer than 4.19, but the check
is broken, thus OverlayFS is again available on 5.x kernels.
943 void fs\_overlayfs(void) {
...
969 // we disable overlayfs for now, pending fixing
970 if (major >= 4 &&minor >= 19) {
971 fprintf(stderr, "Error: OverlayFS disabled for Linux kernels 4.19 and newer, pending fixing.\n");
972 exit(1);
973 }
...
1033 if (mkdirat(basefd, "odiff", 0755) == -1 && errno != EEXIST) {
1034 perror("mkdir");
1035 fprintf(stderr, "Error: cannot create overlay directory %s\n", odiff);
1036 exit(1);
1037 }
1038 ASSERT\_PERMS(odiff, 0, 0, 0755);
...
1065 else { // kernel 3.18 or newer
1066 if (asprintf(&option, "lowerdir=/,upperdir=%s,workdir=%s ", odiff, owork) == -1)
1067 errExit("asprintf");
1068 if (mount("overlay", oroot, "overlay", MS\_MGC\_VAL, optio n) < 0) {
...
Triggering the Vulnerability:
When Firejail is setting up the OverlayFS for use, it locates
the target directory starting from user home directory (which
cannot be replaced by the user itself) and then walks to the
storage location ".firejail/[name]" by opening only one path
component at a time. It also verifies that "[name]" is root
owned and not user/group writable. But instead of mounting the
overlay using the "/proc/self/fd/[num]" references to the
directory, Firejail will use the absolute path there.
Thus there is a short window of opportunity between the "stat"
call and the "mount" to move the whole directory and replace
it with one containing a user-writable and prefilled ".firejail/[name]"
directory. The following trace shows the Firejail process with
pid 465 losing the race versus the exploit [1] running as pid 446:
# Firejail (465) securely moving to the overlay source directories:
465 openat(AT\_FDCWD, "/", O\_RDONLY|O\_CLOEXEC|O\_PATH|O\_DIRECTORY ...
465 openat(4, "home", O\_RDONLY|O\_NOFOLLOW|O\_CLOEXEC|O\_PATH|O\_DIRECTORY ...
465 openat(5, "test", O\_RDONLY|O\_NOFOLLOW|O\_CLOEXEC|O\_PATH|O\_DIRECTORY ...
465 openat(4, ".firejail", O\_RDONLY|O\_NOFOLLOW|O\_CLOEXEC|O\_PATH|O\_DIRECTORY ...
465 mkdirat(5, "test", 0755 ...
465 openat(5, "test", O\_RDONLY|O\_NOFOLLOW|O\_CLOEXEC|O\_PATH|O\_DIRECTORY ...
465 mkdirat(4, "odiff", 0755 ...
465 stat("/home/test/.firejail/test/odiff", {st\_mode=S\_IFDIR|0755, st\_size=4096, ...}) = 0
465 stat("/home/test/.firejail/test/owork", {st\_mode=S\_IFDIR|0755, st\_size=4096, ...}) = 0
...
446 renameat2(7, ".firejail", 7, ".firejail-b", RENAME\_EXCHANGE) = 0
...
465 mount("overlay", "/run/firejail/mnt/oroot", "overlay",
. MS\_MGC\_VAL, "lowerdir=/,upperdir=/home/test/.firejail/test/odiff,
. workdir=/home/test/.firejail/test/owork"
Afterwards Firejail continues with sandbox setup and copies data
to untrusted locations on the mounted overlay. These operations
are redirected via other symlinks through /proc/self/cwd back
to the real file system outside the OverlayFS, thus modifying
files on the machine with full privileges.
Impact:
=======
The vulnerability gives full privileges to any user that has
an existing user-writable home directory set in "/etc/passwd"
and is able to invoke Firejail.
Mitigation:
===========
The maintainers of Firejail provided version 0.9.64.4 [5] that
disables Overlayfs code completely. Patches fixing the vulnerability
and still retaining overlay filesystem functionality are not
available yet.
Proof of Concept:
=================
The PoC "UnjailMyHeart.c" [1] was tested against Debian Bullseye
firejail package 0.9.64-1. See PoC file header for compile instructions.
References:
===========
[1] https://unparalleled.eu/blog/2021/20210208-rigged-race-against-firejail-for-local-root/UnjailMyHeart.c (to be published later)
[2] https://www.kernel.org/doc/html/latest/filesystems/overlayfs.html
[3] https://raw.githubusercontent.com/netblue30/firejail/da53c4ebf0b7f5c6d07cb14dd7ec3ff3910fe180/src/firejail/fs.c
[4] https://github.com/netblue30/firejail/commit/980979d77ebd30ca1d6b518d48068a1e3660a4e8
[5] https://github.com/netblue30/firejail/releases/tag/0.9.64.4


=== Content from github.com_2a243915_20250115_100338.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetblue30%2Ffirejail%2Fcommit%2F97d8a03cad19501f017587cc4e47d8418273834b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetblue30%2Ffirejail%2Fcommit%2F97d8a03cad19501f017587cc4e47d8418273834b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=netblue30%2Ffirejail)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netblue30](/netblue30)
/
**[firejail](/netblue30/firejail)**
Public

* [Notifications](/login?return_to=%2Fnetblue30%2Ffirejail) You must be signed in to change notification settings
* [Fork
  578](/login?return_to=%2Fnetblue30%2Ffirejail)
* [Star
   5.9k](/login?return_to=%2Fnetblue30%2Ffirejail)

* [Code](/netblue30/firejail)
* [Issues
  438](/netblue30/firejail/issues)
* [Pull requests
  21](/netblue30/firejail/pulls)
* [Discussions](/netblue30/firejail/discussions)
* [Actions](/netblue30/firejail/actions)
* [Projects
  7](/netblue30/firejail/projects)
* [Wiki](/netblue30/firejail/wiki)
* [Security](/netblue30/firejail/security)
* [Insights](/netblue30/firejail/pulse)

Additional navigation options

* [Code](/netblue30/firejail)
* [Issues](/netblue30/firejail/issues)
* [Pull requests](/netblue30/firejail/pulls)
* [Discussions](/netblue30/firejail/discussions)
* [Actions](/netblue30/firejail/actions)
* [Projects](/netblue30/firejail/projects)
* [Wiki](/netblue30/firejail/wiki)
* [Security](/netblue30/firejail/security)
* [Insights](/netblue30/firejail/pulse)

## Commit

[Permalink](/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

disabled overlayfs, 0.9.64.4 testing

[Browse files](/netblue30/firejail/tree/97d8a03cad19501f017587cc4e47d8418273834b)
Browse the repository at this point in the history

* Loading branch information

[![@netblue30](https://avatars.githubusercontent.com/u/13711990?s=40&v=4)](/netblue30)

[netblue30](/netblue30/firejail/commits?author=netblue30 "View all commits by netblue30")
committed
Feb 5, 2021

1 parent
[2d68073](/netblue30/firejail/commit/2d68073e71f69f14fc93fa876ac6ac2ac6fe1397)

commit 97d8a03

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**27 additions**
and
**28 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* configure
  [configure](#diff-90d08e583c4c9c6f391b2ae90f819f600a6326928ea9512c9e0c6d98e9f29ac2)
* configure.ac
  [configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810)

## There are no files selected for viewing

38 changes: 17 additions & 21 deletions

38
[configure](#diff-90d08e583c4c9c6f391b2ae90f819f600a6326928ea9512c9e0c6d98e9f29ac2 "configure")

Show comments

[View file](/netblue30/firejail/blob/97d8a03cad19501f017587cc4e47d8418273834b/configure)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | #! /bin/sh |
|  |  | # Guess values for system-dependent variables and create Makefiles. |
|  |  | # Generated by GNU Autoconf 2.69 for firejail 0.9.64.2. |
|  |  | # Generated by GNU Autoconf 2.69 for firejail 0.9.64.4. |
|  |  | # |
|  |  | # Report bugs to <netblue30@protonmail.com>. |
|  |  | # |
| Expand Down  Expand Up | | @@ -580,8 +580,8 @@ MAKEFLAGS= |
|  |  | # Identity of this package. |
|  |  | PACKAGE\_NAME='firejail' |
|  |  | PACKAGE\_TARNAME='firejail' |
|  |  | PACKAGE\_VERSION='0.9.64.2' |
|  |  | PACKAGE\_STRING='firejail 0.9.64.2' |
|  |  | PACKAGE\_VERSION='0.9.64.4' |
|  |  | PACKAGE\_STRING='firejail 0.9.64.4' |
|  |  | PACKAGE\_BUGREPORT='netblue30@protonmail.com' |
|  |  | PACKAGE\_URL='https://firejail.wordpress.com' |
|  |  |  |
| Expand Down  Expand Up | | @@ -711,7 +711,6 @@ enable\_option\_checking |
|  |  | enable\_analyzer |
|  |  | enable\_apparmor |
|  |  | enable\_dbusproxy |
|  |  | enable\_overlayfs |
|  |  | enable\_usertmpfs |
|  |  | enable\_man |
|  |  | enable\_firetunnel |
| Expand Down  Expand Up | | @@ -1294,7 +1293,7 @@ if test "$ac\_init\_help" = "long"; then |
|  |  | # Omit some internal or obsolete options to make the list less imposing. |
|  |  | # This message is too long to be a string in the A/UX 3.1 sh. |
|  |  | cat <<\_ACEOF |
|  |  | \`configure' configures firejail 0.9.64.2 to adapt to many kinds of systems. |
|  |  | \`configure' configures firejail 0.9.64.4 to adapt to many kinds of systems. |
|  |  |  |
|  |  | Usage: $0 [OPTION]... [VAR=VALUE]... |
|  |  |  |
| Expand Down  Expand Up | | @@ -1356,7 +1355,7 @@ fi |
|  |  |  |
|  |  | if test -n "$ac\_init\_help"; then |
|  |  | case $ac\_init\_help in |
|  |  | short | recursive ) echo "Configuration of firejail 0.9.64.2:";; |
|  |  | short | recursive ) echo "Configuration of firejail 0.9.64.4:";; |
|  |  | esac |
|  |  | cat <<\\_ACEOF |
|  |  |  |
| Expand All | | @@ -1367,7 +1366,6 @@ Optional Features: |
|  |  | --enable-analyzer enable GCC 10 static analyzer |
|  |  | --enable-apparmor enable apparmor |
|  |  | --disable-dbusproxy disable dbus proxy |
|  |  | --disable-overlayfs disable overlayfs |
|  |  | --disable-usertmpfs disable tmpfs as regular user |
|  |  | --disable-man disable man pages |
|  |  | --disable-firetunnel disable firetunnel |
| Expand Down  Expand Up | | @@ -1473,7 +1471,7 @@ fi |
|  |  | test -n "$ac\_init\_help" && exit $ac\_status |
|  |  | if $ac\_init\_version; then |
|  |  | cat <<\\_ACEOF |
|  |  | firejail configure 0.9.64.2 |
|  |  | firejail configure 0.9.64.4 |
|  |  | generated by GNU Autoconf 2.69 |
|  |  |  |
|  |  | Copyright (C) 2012 Free Software Foundation, Inc. |
| Expand Down  Expand Up | | @@ -1775,7 +1773,7 @@ cat >config.log <<\_ACEOF |
|  |  | This file contains any messages produced by compilers while |
|  |  | running configure, to aid debugging if configure makes a mistake. |
|  |  |  |
|  |  | It was created by firejail $as\_me 0.9.64.2, which was |
|  |  | It was created by firejail $as\_me 0.9.64.4, which was |
|  |  | generated by GNU Autoconf 2.69. Invocation command line was |
|  |  |  |
|  |  | $ $0 $@ |
| Expand Down  Expand Up | | @@ -3530,18 +3528,16 @@ if test "x$enable\_dbusproxy" != "xno"; then : |
|  |  |  |
|  |  | fi |
|  |  |  |
|  |  | # overlayfs features temporarely disabled pending fixes |
|  |  | HAVE\_OVERLAYFS="" |
|  |  | # Check whether --enable-overlayfs was given. |
|  |  | if test "${enable\_overlayfs+set}" = set; then : |
|  |  | enableval=$enable\_overlayfs; |
|  |  | fi |
|  |  |  |
|  |  | if test "x$enable\_overlayfs" != "xno"; then : |
|  |  |  |
|  |  | HAVE\_OVERLAYFS="-DHAVE\_OVERLAYFS" |
|  |  |  |
|  |  |  |
|  |  | fi |
|  |  | # |
|  |  | #AC\_ARG\_ENABLE([overlayfs], |
|  |  | # AS\_HELP\_STRING([--disable-overlayfs], [disable overlayfs])) |
|  |  | #AS\_IF([test "x$enable\_overlayfs" != "xno"], [ |
|  |  | # HAVE\_OVERLAYFS="-DHAVE\_OVERLAYFS" |
|  |  | # AC\_SUBST(HAVE\_OVERLAYFS) |
|  |  | #]) |
|  |  |  |
|  |  | HAVE\_USERTMPS="" |
|  |  | # Check whether --enable-usertmpfs was given. |
| Expand Down  Expand Up | | @@ -4817,7 +4813,7 @@ cat >>$CONFIG\_STATUS <<\\_ACEOF || ac\_write\_fail=1 |
|  |  | # report actual input values of CONFIG\_FILES etc. instead of their |
|  |  | # values after options handling. |
|  |  | ac\_log=" |
|  |  | This file was extended by firejail $as\_me 0.9.64.2, which was |
|  |  | This file was extended by firejail $as\_me 0.9.64.4, which was |
|  |  | generated by GNU Autoconf 2.69. Invocation command line was |
|  |  |  |
|  |  | CONFIG\_FILES = $CONFIG\_FILES |
| Expand Down  Expand Up | | @@ -4871,7 +4867,7 @@ \_ACEOF |
|  |  | cat >>$CONFIG\_STATUS <<\_ACEOF || ac\_write\_fail=1 |
|  |  | ac\_cs\_config="`$as\_echo "$ac\_configure\_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`" |
|  |  | ac\_cs\_version="\\ |
|  |  | firejail config.status 0.9.64.2 |
|  |  | firejail config.status 0.9.64.4 |
|  |  | configured by $0, generated by GNU Autoconf 2.69, |
|  |  | with options \\"\$ac\_cs\_config\\" |
|  |  |  |
| Expand Down | |  |

17 changes: 10 additions & 7 deletions

17
[configure.ac](#diff-49473dca262eeab3b4a43002adb08b4db31020d190caaad1594b47f1d5daa810 "configure.ac")

Show comments

[View file](/netblue30/firejail/blob/97d8a03cad19501f017587cc4e47d8418273834b/configure.ac)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,7 @@ |
|  |  | # |
|  |  |  |
|  |  | AC\_PREREQ([2.68]) |
|  |  | AC\_INIT(firejail, 0.9.64.2, netblue30@protonmail.com, , https://firejail.wordpress.com) |
|  |  | AC\_INIT(firejail, 0.9.64.4, netblue30@protonmail.com, , https://firejail.wordpress.com) |
|  |  | AC\_CONFIG\_SRCDIR([src/firejail/main.c]) |
|  |  |  |
|  |  | AC\_CONFIG\_MACRO\_DIR([m4]) |
| Expand Down  Expand Up | | @@ -66,13 +66,16 @@ AS\_IF([test "x$enable\_dbusproxy" != "xno"], [ |
|  |  | AC\_SUBST(HAVE\_DBUSPROXY) |
|  |  | ]) |
|  |  |  |
|  |  | # overlayfs features temporarely disabled pending fixes |
|  |  | HAVE\_OVERLAYFS="" |
|  |  | AC\_ARG\_ENABLE([overlayfs], |
|  |  | AS\_HELP\_STRING([--disable-overlayfs], [disable overlayfs])) |
|  |  | AS\_IF([test "x$enable\_overlayfs" != "xno"], [ |
|  |  | HAVE\_OVERLAYFS="-DHAVE\_OVERLAYFS" |
|  |  | AC\_SUBST(HAVE\_OVERLAYFS) |
|  |  | ]) |
|  |  | AC\_SUBST(HAVE\_OVERLAYFS) |
|  |  | # |
|  |  | #AC\_ARG\_ENABLE([overlayfs], |
|  |  | # AS\_HELP\_STRING([--disable-overlayfs], [disable overlayfs])) |
|  |  | #AS\_IF([test "x$enable\_overlayfs" != "xno"], [ |
|  |  | # HAVE\_OVERLAYFS="-DHAVE\_OVERLAYFS" |
|  |  | # AC\_SUBST(HAVE\_OVERLAYFS) |
|  |  | #]) |
|  |  |  |
|  |  | HAVE\_USERTMPS="" |
|  |  | AC\_ARG\_ENABLE([usertmpfs], |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `97d8a03`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetblue30%2Ffirejail%2Fcommit%2F97d8a03cad19501f017587cc4e47d8418273834b) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from lists.debian.org_ff6de338_20250115_100339.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 2554-1] firejail security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2554-1] firejail security update
* *From*: Utkarsh Gupta <utkarsh@debian.org>
* *Date*: Thu, 11 Feb 2021 12:15:23 +0530
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/CAPP0f942hLrofdkX%2BT4T356ZU%3Dk7aUBsjv3h52798M_rTskWmg%40mail.gmail.com)Â [CAPP0f942hLrofdkX+T4T356ZU=k7aUBsjv3h52798M\_rTskWmg@mail.gmail.com](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -----------------------------------------------------------------------
Debian LTS Advisory DLA-2554-1              debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Utkarsh Gupta
February 11, 2021                           <https://wiki.debian.org/LTS>
- -----------------------------------------------------------------------

Package        : firejail
Version        : 0.9.44.8-2+deb9u2
CVE ID         : CVE-2021-26910

Roman Fiedler discovered a vulnerability in the OverlayFS code in
firejail, a sandbox program to restrict the running environment of
untrusted applications, which could result in root privilege
escalation. This update disables OverlayFS support in firejail.

For Debian 9 stretch, this problem has been fixed in version
0.9.44.8-2+deb9u2.

We recommend that you upgrade your firejail packages.

For the detailed security status of firejail please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firejail>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmAk0lYACgkQgj6WdgbD
S5YuSQ//dEFgjFVddG1DfrWZH5mX5ppb8YwC5YbGHxRP0SV0Eh+JbT2mJb3p3/4L
tzFZFwEeQw+yHnAQyuv6rlbqvPW+MqrR/jANfm0OARe5NsnKmLq/2Ol8hcGxFEnp
nc0+ryBOHRyw2Gy9zMK8MujZHZPqpLKJQ3BANWLVwT05HeP9ZfANSjh+Dc4QzfZa
UWTcvrvWnGoYdIRcesGqOpSwPkQV4J3B7EFEM3Ja/cFboRC3LdOksock078PljT/
fdxpL8BaQGNy7Sgy1hLdBYVMLfalmsgfnEGBtcWWfqIKla3b3tEHRQUfX2jXbqED
cbTCpHPxQwgf5SIHtQAaAXDcv4fnh3waENpI0ZDhlY3HATEgKkhULErtiuCoG9MO
EoD7Mhen8VcWgeXSUTarw6CnaKUENelYb79KXTdoovIhdoPnUKhA4m9F173+K1TS
yUpAs8CbvIUkoFrvSwPGHCu/unY+wAuhdmj2K7eVj7zWUR3ziDH+NlOZ4j3udVb/
8k30Btyx5jHoDtSSk+M0ETtKS67aOS6pQNFan4jqKM/AfJeda/Cn1aB6hRg3xmLZ
ylFFhy/eEiMnABe8pIE1FSa80bZLJxCebNS2ayTyaoYogq27cn5MEfn2kWkSAjQC
+wb9cs8C6ZYlUOyiATFSelU7WXqyyiF0LMAwKIOSbx82Zq1XQvY=
=JT9m
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_85e76176_20250115_100339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetblue30%2Ffirejail%2Freleases%2Ftag%2F0.9.64.4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetblue30%2Ffirejail%2Freleases%2Ftag%2F0.9.64.4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=netblue30%2Ffirejail)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netblue30](/netblue30)
/
**[firejail](/netblue30/firejail)**
Public

* [Notifications](/login?return_to=%2Fnetblue30%2Ffirejail) You must be signed in to change notification settings
* [Fork
  578](/login?return_to=%2Fnetblue30%2Ffirejail)
* [Star
   5.9k](/login?return_to=%2Fnetblue30%2Ffirejail)

* [Code](/netblue30/firejail/tree/0.9.64.4)
* [Issues
  438](/netblue30/firejail/issues)
* [Pull requests
  21](/netblue30/firejail/pulls)
* [Discussions](/netblue30/firejail/discussions)
* [Actions](/netblue30/firejail/actions)
* [Projects
  7](/netblue30/firejail/projects)
* [Wiki](/netblue30/firejail/wiki)
* [Security](/netblue30/firejail/security)
* [Insights](/netblue30/firejail/pulse)

Additional navigation options

* [Code](/netblue30/firejail/tree/0.9.64.4)
* [Issues](/netblue30/firejail/issues)
* [Pull requests](/netblue30/firejail/pulls)
* [Discussions](/netblue30/firejail/discussions)
* [Actions](/netblue30/firejail/actions)
* [Projects](/netblue30/firejail/projects)
* [Wiki](/netblue30/firejail/wiki)
* [Security](/netblue30/firejail/security)
* [Insights](/netblue30/firejail/pulse)

1. [Releases](/netblue30/firejail/releases)
2. [0.9.64.4](/netblue30/firejail/releases/tag/0.9.64.4)

# Version 0.9.64.4

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/netblue30/firejail/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...0.9.64.4)

 Loading

[View all tags](/netblue30/firejail/tags)

![@netblue30](https://avatars.githubusercontent.com/u/13711990?s=40&v=4)
[netblue30](/netblue30)
released this
07 Feb 23:01

Â·
[5 commits](/netblue30/firejail/compare/0.9.64.4...release-0.9.64)
to release-0.9.64
since this release

[0.9.64.4](/netblue30/firejail/tree/0.9.64.4)

[`b818fc4`](/netblue30/firejail/commit/b818fc40cef9865b3202b7de227348dd26acf9fd)

* disabled overlayfs, pending multiple fixes

 Assets
8

 Loading

All reactions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.debian.org_5563b674_20250115_100343.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DSA 4849-1] firejail security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4849-1] firejail security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 09 Feb 2021 21:18:28 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1l9aOy-0000rj-8x%40seger.debian.org)Â [E1l9aOy-0000rj-8x@seger.debian.org](msg00030.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4849-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
February 09, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firejail
CVE ID         : CVE-2021-26910

Roman Fiedler discovered a vulnerability in the OverlayFS code in
firejail, a sandbox program to restrict the running environment of
untrusted applications, which could result in root privilege escalation.
This update disables OverlayFS support in firejail.

For the stable distribution (buster), this problem has been fixed in
version 0.9.58.2-2+deb10u2.

We recommend that you upgrade your firejail packages.

For the detailed security status of firejail please refer to its
security tracker page at:
<https://security-tracker.debian.org/tracker/firejail>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmAi+oVfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0TfcA/+Oql0UYg91bBhISV37airwVjjdiLubX6bBpd4F3T12TPDuPBMxofY+61o
M10BBbW8w7MQaQ+uePFT+rL8I3UNU6j3BtvdU8L11FIvkIFIYMKC5VkqThNsJaNK
r/LGxIQbxudY2yr7DFOao2pdF5KoorcTcK8Vw/ULiRIL1/jtfzM7tz6RZjVysKlC
tNfY7GGOMmHTFyxPkU6sAlAS9scUZuQEJHIAJuzbLHMudoFf5jE2+HbnhAuiYKYh
q34ewtuNSda2H4hMNC6U76StdKmWvqjVuPyt9kQ1HVF+gbcaNRz7XL0rC1YEcnpo
d3mGZem1Pa5TcFzjaH8OKfqTsNKU+gC5JbRt/JmQho0IS8BPdZxOiHWWplawjj/k
K1VfBIWNJBf2Z9guoTqBkfLB5B1nreO3opVhgveft9NiH5ydeFa1z92utLQPN8fN
Mr7quGK88F9EGlORHdCXoqp4WTAai5wwdUkjY+y+Zt1Cr7wTsdTSvcWNKQQP8EvT
fhFTvU/57f3/jqE2N/FStDdcJNt95Q81qiuM7Ot4c9UQBuSGhcUo1+eoCArj1niv
MqeHc+bMv/Wxrg6LGsAEnDTgQHVBul+hROFBqlUExsQSLwq5o0jjUGBT8V3ZkXs6
JU69tVRsNU6c2+BHjg8zclURqQ3mLTW0BCReKK5JqbL8eo1G2lA=
=+BOy
-----END PGP SIGNATURE-----

```

---



=== Content from unparalleled.eu_c62e4947_20250115_100341.html ===

Unparalleled IT Services e.U.

* [About](/)
* [Publications](/publications/)
* [Blog](/blog/)
* [Contact](/company/contact)
* [Legal](/company/legal-notice)

# Rigged Race Against Firejail for Local Root

This article describes a method that proofed useful in highly
reliable exploitation of a
[file system race condition](/publications/2021/advisory-unpar-2021-0.txt)
found in [Firejail](https://firejail.wordpress.com).
Instead of optimizing the exploit to win the real race, the timing
of Firejail stderr and stdout output was analyzed. With the correct
parameters known the Firejail process can be frozen exactly in
the right moment when attempting to write a message to a filled
pipe (blocking write). Thus the exploit has any time in the world
to modify the file system before restarting Firejail by emptying
the pipe again.

# TOCTOU and The Hard Life Winning Fair Races

When (privileged) programs process data under control of less
privileged users special precautions have to be taken. Even being
dangerous, the demand for such operations may be higher than
one might expect at first glance. For example Firejail (a SUID
program) uses configuration and persistency information provided
by the user invoking it. But also the privileged SSH daemon process
has to access user-owned private key material or an HTTP-daemon
may need to serve files from user directories.
Programs ignoring their due diligence accessing such files may
quite easily end up processing arbitrary files, pipes, special
devices,... as a lack of checks allows attackers to redirect
requests from safe locations to arbitrary targets, see
[CWE-61: UNIX Symbolic Link (Symlink) Following](https://cwe.mitre.org/data/definitions/61.html).

Luckily such blatant vulnerabilities in privileged code are
quite rare nowadays. Checking the file ownership, file type and
other properties BEFORE use of the data is common. Also Firejail
performed those checks related to activating per-user persistent
overlay storage for use inside the sandbox. But instead of using
the secure grab-and-check approach (get a handle/file descriptor
for the object of interest, check the handle and use the handle
when checks succeeded), Firejail performed a check on the path
using *stat()* calls before using the path in file system
operations later on (see trace snipplet below), thus creating
[CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition](https://cwe.mitre.org/data/definitions/367.html)
vulnerabilities.

To exploit such a vulnerability the attacker has to modify
the file system structure at some timepoint between the check
and the use of the resource. To do that reliably on a wide range
of systems may be harder than it sounds due to perfect timing
depending on various factors, e.g.

* The system load (concurrent processes)
* The number of CPUs
* RAM (caching of file system related data)
* The underlying file system type (huge differences
  e.g. between btrfs and ext4)
* Task scheduling of competing tasks (seems to have changed
  a lot due to Spectre/Meltdown patches - unproven)
* Security modules, auditing in place

To be still able to win the race quite reliably the attacker
may apply various techniques. But finding the right mix is often
time consuming, based on trial and error and the selected approach
may not work the same way on other systems than the one tested.
Nonetheless useful methods are:

* Use of [inotify](https://www.man7.org/linux/man-pages/man7/inotify.7.html)
  to monitor file system access of other (privileged) processes.
* Overloading the task scheduler by forking more processes
  than CPU cores available (not nice and stealthy).
* Using huge mmaped() files to purge cached file system structures
  from RAM and thus make the victim program slower.
* Fill directories with huge number of unrelated files to make
  the victim program loop through numerous directory entries before
  continuing.

Usually a mix of methods from above is sufficient to win the
race occasionally. Thus if the race can be triggered frequently
the privilege escalation will happen sooner or later. When the
vulnerable code cannot be triggered by the attacker, when losing
the race is not an option (e.g. events so rare, a miss would
be detected by the victim) or when the attacker just wants to
win each time for fun, then such complex or non-deterministic
races have to be avoided.

# The Joy of Being Unfair

To avoid the non-deterministic race the
[Firejail local root exploit (UnjailMyHeart.c)](UnjailMyHeart.c)
used Firejail logging output to block Firejail execution
in the right moment completely. Therefore the exploit creates
a pipe to capture Firejail stderr and a master/slave pty-pair
for stdout. Even being more complex the pty pair was needed to
cause stdout being line buffered. Without a terminal attached
stdout would enter byte buffered mode, which is way more efficient
but would cause a delay between e.g. a printf() and the flushing
of the buffer.

Before executing the victim program (Firejail) the pipe (stderr)
and the pty (stdout) are filled with test data till writing blocks.
The amount of data sucessfully written is recorded to know the
size of the pipe buffers. Next the buffers are emptied and filled
anew to such extent, that Firejail may only write some
of its messages before being blocked. Blocking will happen exactly
after the check of a file system resource and before using it.
Thus we just need to *win* the race against a sleeping horse
(a frozen process). The trace of such a rigged race looks like
that:

446 [UnjailMyHeart - the attacker process]
465 [Firejail - the victim process]
# The victim checks if the resource is sane to use.
465 stat("/home/test/.firejail/test/owork", {st\_mode=S\_IFDIR|0755, st\_size=4096, ...}) = 0
# The victim is happy with the result and tells the caller,
# but is blocked doing so.
465 write(1, "Mounting OverlayFS\n", 19 <unfinished ...>
# The attacker wakes up quite some time later and renames the
# directory.
446 <... clock\_nanosleep resumed>0x7fff70a09048) = 0
# Did I mention I like the RENAME\_EXCHANGE atomic operation?
446 renameat2(7, ".firejail", 7, ".firejail-b", RENAME\_EXCHANGE) = 0
...
# The attacker reads from the other end of the pipe to unblock
# the victim process.
446 read(5, <unfinished ...>
# The victim write operation from above is resumed, the problematic
# file system operation takes place using untrusted data.
465 <... write resumed>) = 19
465 mount("overlay", "/run/firejail/mnt/oroot", "overlay", MS\_MGC\_VAL,
"lowerdir=/,upperdir=/home/test/.firejail/test/odiff,
workdir=/home/test/.firejail/test/owork") = 0

# Attack Method Recipy

To apply the method mentioned above to other targets, following
steps should be performed:

**Increase verbosity:** Make the victim program as verbose
as possible. This includes both activating stdout/stderr messages
but may also include use of named pipes instead of log files.

**Check system call synteny:** Use system call tracing, e.g.
[strace](https://www.man7.org/linux/man-pages/man1/strace.1.html)
to monitor the sequence of file system requests and stdout, stderr
or logfile writes. For SUID-binaries like Firejail tracing has to
be performed as privileged user, e.g.
*strace -o result.dump -f -- /bin/su -c '[victim program]' [test user]*.

**Calibrate buffering:** Measure how much data is written
by the victim program till the point during program execution,
where you want to freeze the victim program.

**Prefill the buffers:** Fill the pipe buffers to such
extent so that the remaining space is just a little too small
to allow the victim program to write the last message before
the critical file system operation. Filling the pipes is deterministic
but there is some magic (not very intuitive behaviour) involved
that cause pipes or especially terminals to react differently when
they are filled for the first time or if they are only partially
emptied and refilled or completely emptied. Therefore they should
always be emptied and filled completely multiple times before
use.

Some victim programs may not perform write activity between
the two file system operations to race with. Still the method
can be useful to synchronize your exploit with the victim program.
Instead of timing the exploit actions in relation to e.g. the
starting time of the victim program, a much smaller time delay
(often only 1%) between synchronization signal and attack can
be used, thus increasing precision and chances tremendously.

**Notes:**

* 20210218: Exploits added, both improved Buster/Bullseye compatible
  version (sha1 68013d8f8f916c13d2dbae9d107090b02fe77fd1) and the
  previously announced
  [sha1 f756b79f3c0c682e69a99f472e7b67892a7c7b5d](UnjailMyHeart-20210208.c) version only valid for Bullseye (/proc mounting is different
  on Buster, so more generic approach was required).

**Comments** are welcome, but there is no forum system
im place yet. If there is something important to be added to
this page, please send it as [e-mail](/company/contact).
Legal: Appropriate comments will be published, there is no right
for you to get them published, use a "Nick:" entry in your comment
otherwise for attribution "Anonymous" is used, comment mails
are deleted after processing (GDPR), IPR rights for your comment
stay with you except that the content may be used to correct
or improve the page while referencing to your comment as source
of the change, comment data is not submitted to third parties.
Phuuu, inhale!



=== Content from www.openwall.com_93a4c7a2_20250115_100337.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2021/02/08/5) [[next>]](2) [[<thread-prev]](../../../2021/02/08/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20210209063615.GA25153@lorien.valinor.li>
Date: Tue, 9 Feb 2021 07:36:15 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: oss-security@...ts.openwall.com
Subject: Re: [cve-pending] Firejail: root privilege escalation
 in OverlayFS code

Hi,

On Mon, Feb 08, 2021 at 02:15:05PM +0000, netblue30 wrote:
>
> Security Advisory - Feb 8, 2021
>
> Summary: A vulnerability resulting in root privilege escalation was discovered in Firejail's OverlayFS code,
>
> Versions affected: Firejail software versions starting with 0.9.30.
> Long Term Support (LTS) Firejail branch is not affected by this bug.
>
> Workaround: Disable overlayfs feature at runtime. In a text editor open /etc/firejail/firejail.config file,
> and set "overlayfs" entry to "no".
>
>       $ grep overlayfs /etc/firejail/firejail.config
>       # Enable or disable overlayfs features, default enabled.
>       overlayfs no
>
> Fix: The bug is fixed in Firejail version 0.9.64.4
>
> GitHub commit: (file configure.ac)
> <https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b>
>
> Credit:  Security researcher Roman Fiedler analyzed the code and discovered the vulnerability.
> Functional PoC exploit code was provided to Firejail development team.
> A description of the problem is here on Roman's blog:
>
> <https://unparalleled.eu/publications/2021/advisory-unpar-2021-0.txt>
> <https://unparalleled.eu/blog/2021/20210208-rigged-race-against-firejail-for-local-root/>

CVE-2021-26910 was assigned for this issue according to
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26910> .

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_c31740b4_20250115_100340.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Firejail: Privilege escalation â€” GLSA **202105-19**

A vulnerability was discovered in Firejail which may allow local
attackers to gain root privileges.

### Affected packages

| Package | **sys-apps/firejail** on all architectures |
| --- | --- |
| Affected versions | < **0.9.64.4** |
| Unaffected versions | >= **0.9.64.4** |

### Background

A SUID program that reduces the risk of security breaches by restricting
the running environment of untrusted applications using Linux namespaces
and seccomp-bpf.

### Description

It was discovered that a flaw in Firejailâ€™s OverlayFS code allowed
restricted programs to escape sandbox.

### Impact

A local attacker could obtain arbitrary file system access via an
application running within a Firejail sandbox, possibly resulting in
privilege escalation.

### Workaround

There is no known workaround at this time.

### Resolution

All Firejail users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-apps/firejail-0.9.64.4"

```
### References

* [CVE-2021-26910](https://nvd.nist.gov/vuln/detail/CVE-2021-26910)

**Release date**

May 26, 2021

**Latest revision**

May 26, 2021: 1

**Severity**

high

**Exploitable**

local

**Bugzilla entries**

* [769542](https://bugs.gentoo.org/show_bug.cgi?id=769542)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**


