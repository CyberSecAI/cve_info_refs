The provided content is related to CVE-2021-26799.

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper HTML filtering on the "admin/files/edit" page within the Omeka application. While most pages filter HTML tags not in the whitelist when "Use HTML" is enabled, the "admin/files/edit" page failed to do so.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- Inadequate input sanitization and validation on the "admin/files/edit" page.
- Inconsistency in HTML filtering across different parts of the application.

**Impact of exploitation:**
- Client-side code execution within the context of other users' sessions.
- Potential for session hijacking even though the session cookie is httponly and csrf tokens are properly set.
- Could be leveraged to increase the impact of future vulnerabilities.

**Attack vectors:**
- By crafting malicious HTML payloads, for example an `<img src=x onerror=alert(1)>` tag, and entering this into one of the fields on the "admin/files/edit" page.
- Toggling the "Use HTML" option to on, saves the malicious payload.
- The XSS is triggered when a user access the page containing the file, and the malicious payload is rendered, leading to client-side code execution.

**Required attacker capabilities/position:**
- The attacker needs to be a contributor, admin, or superuser, to be able to access the "admin/files/edit" page.
- Ability to create an item with a file attachment.
- Ability to edit the file.