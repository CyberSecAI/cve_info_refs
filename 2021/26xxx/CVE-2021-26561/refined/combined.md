=== Content from www.synology.com_ef6db954_20250114_201945.html ===


* [Security Advisory](security/advisory)
# Synology-SA-20:26 DSM

Publish Time: 2020-11-26 11:52:20 UTC+8

Last Updated: 2022-05-18 09:59:54 UTC+8

Severity
Critical

Status
Accepted

**Abstract**

Multiple vulnerabilities allow remote attackers to execute arbitrary code via a susceptible version of DiskStation Manager (DSM).

**Affected Products**

| Product | Severity | Fixed Release Availability |
| --- | --- | --- |
| DSM 6.2 | Important | Upgrade to 6.2.3-25426-3 or above. |
| DSMUC 3.0 | Low | Upgrade to 3.1-23033 or above. |
| VS Firmware 2.3 | Moderate | Ongoing |

**Mitigation**

None

**Detail**

* CVE-2021-26560

  + Severity: Critical
  + CVSS3 Base Score: 9.0
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)
  + Cleartext transmission of sensitive information vulnerability in synoagentregisterd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to spoof servers via an HTTP session.
* CVE-2021-26561

  + Severity: Critical
  + CVSS3 Base Score: 9.0
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)
  + Stack-based buffer overflow vulnerability in synoagentregisterd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to execute arbitrary code via syno\_finder\_site HTTP header.
* CVE-2021-26562

  + Severity: Critical
  + CVSS3 Base Score: 9.0
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)
  + Out-of-bounds write vulnerability in synoagentregisterd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to execute arbitrary code via syno\_finder\_site HTTP header.
* CVE-2021-26569

  + Severity: Critical
  + CVSS3 Base Score: 9.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Race Condition within a Thread vulnerability in iscsi\_snapshot\_comm\_core in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to execute arbitrary code via crafted web requests.
* CVE-2021-27646

  + Severity: Critical
  + CVSS3 Base Score: 9.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Use After Free vulnerability in iscsi\_snapshot\_comm\_core in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to execute arbitrary code via crafted web requests.
* CVE-2021-27647

  + Severity: Critical
  + CVSS3 Base Score: 9.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Out-of-bounds Read vulnerability in iscsi\_snapshot\_comm\_core in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to execute arbitrary code via crafted web requests.
* CVE-2021-27649

  + Severity: Critical
  + CVSS3 Base Score: 9.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Use after free vulnerability in file transfer protocol component in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to execute arbitrary code via unspecified vectors.
* CVE-2021-31439

  + Severity: Critical
  + CVSS3 Base Score: 8.8
  + CVSS3 Vector: [CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Synology DiskStation Manager. Authentication is not required to exploit this vulnerablity. The specific flaw exists within the processing of DSI structures in Netatalk. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a heap-based buffer. An attacker can leverage this vulnerability to execute code in the context of the current process. Was ZDI-CAN-12326.
* CVE-2022-22687

  + Severity: Critical
  + CVSS3 Base Score: 9.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Buffer copy without checking size of input ('Classic Buffer Overflow') vulnerability in Authentication functionality in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to execute arbitrary code via unspecified vectors.
* CVE-2021-26564

  + Severity: Important
  + CVSS3 Base Score: 8.3
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H)
  + Cleartext transmission of sensitive information vulnerability in synorelayd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to spoof servers via an HTTP session.
* CVE-2021-26565

  + Severity: Important
  + CVSS3 Base Score: 8.3
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H)
  + Cleartext transmission of sensitive information vulnerability in synorelayd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to obtain sensitive information via an HTTP session.
* CVE-2021-26566

  + Severity: Important
  + CVSS3 Base Score: 8.3
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H)
  + Insertion of sensitive information into sent data vulnerability in synorelayd in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows man-in-the-middle attackers to execute arbitrary commands via inbound QuickConnect traffic.
* CVE-2021-26567

  + Severity: Important
  + CVSS3 Base Score: 8.8
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
  + Stack-based buffer overflow vulnerability in frontend/main.c in faad2 before 2.2.7.1 allow local attackers to execute arbitrary code via filename and pathname options.
* CVE-2021-29083

  + Severity: Important
  + CVSS3 Base Score: 7.2
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)
  + Improper neutralization of special elements used in an OS command in SYNO.Core.Network.PPPoE in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote authenticated users to execute arbitrary code via realname parameter.
* CVE-2021-29084

  + Severity: Important
  + CVSS3 Base Score: 7.5
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)
  + Improper neutralization of special elements in output used by a downstream component ('Injection') vulnerability in Security Advisor report management component in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to read arbitrary files via unspecified vectors.
* CVE-2021-29085

  + Severity: Important
  + CVSS3 Base Score: 8.6
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)
  + Improper neutralization of special elements in output used by a downstream component ('Injection') vulnerability in file sharing management component in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to read arbitrary files via unspecified vectors.
* CVE-2021-29087

  + Severity: Important
  + CVSS3 Base Score: 7.5
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N)
  + Improper limitation of a pathname to a restricted directory ('Path Traversal') vulnerability in webapi component in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to write arbitrary files via unspecified vectors.
* CVE-2021-29086

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
  + Exposure of sensitive information to an unauthorized actor vulnerability in webapi component in Synology DiskStation Manager (DSM) before 6.2.3-25426-3 allows remote attackers to obtain sensitive information via unspecified vectors.

**Acknowledgement**

* Justin Taft (@oneupsecurity) working with Trend Micro’s Zero Day Initiative
* Claudio Bozzato of Cisco Talos
* DEVCORE working with Trend Micro’s Zero Day Initiative
* STARLabs working with Trend Micro’s Zero Day Initiative
* ddaa of TrapaSecurity
* Chanyoung So

**Reference**

* [CVE-2021-26569](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26569)
* [CVE-2021-27646](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27646)
* [CVE-2021-27647](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27647)
* [CVE-2021-27649](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27649)
* [CVE-2021-26560](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26560)
* [CVE-2021-26561](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26561)
* [CVE-2021-26562](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26562)
* [CVE-2021-26564](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26564)
* [CVE-2021-26565](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26565)
* [CVE-2021-26566](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26566)
* [CVE-2021-26567](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26567)
* [CVE-2021-29083](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29083)
* [CVE-2021-29084](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29084)
* [CVE-2021-29085](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29085)
* [CVE-2021-29087](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29087)
* [CVE-2021-31439](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31439)
* [CVE-2021-29086](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29086)
* [CVE-2022-22687](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22687)

**Revision**

| Revision | Date | Description |
| --- | --- | --- |
| 1 | 2020-11-26 | Initial public release. |
| 2 | 2021-02-02 | Updated Acknowledgement for researchers. |
| 3 | 2021-02-03 | Updated Acknowledgement for researchers. |
| 4 | 2021-04-09 | Disclosed vulnerability details. |
| 5 | 2021-06-01 | Update for DSM UC is now available in Affected Products. |
| 6 | 2021-06-24 | Disclosed vulnerability details. |
| 7 | 2022-05-18 | Disclosed vulnerability details. |

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue



=== Content from www.talosintelligence.com_6ec0a04f_20250114_201947.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2020-1159

## Synology DSM synoagentregisterd server finder out-of-bounds write vulnerability

##### April 19, 2021

##### CVE Number

CVE-2021-26560, CVE-2021-26561, CVE-2021-26562

### Summary

An out-of-bounds write vulnerability exists in the synoagentregisterd server finder functionality of Synology DSM 6.2.3 25426 DS120j. A specially crafted HTTP response can lead to remote code execution. An attacker can use man-in-the-middle techniques to trigger this vulnerability.

### Tested Versions

Synology DSM 6.2.3 25426-2 DS120j

### Product URLs

<https://www.synology.com/en-global/dsm>

### CVSSv3 Score

9.6 - CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

### CWE

CWE-121 - Stack-based Buffer Overflow

### Details

Synology DiskStation Manager (DSM) is the Linux-based operating system for every Synology NAS.

Synology DSM runs a service called `synoagentregisterd`, whose task is to manage the registration of the device’s local network IP address with remote Synology servers.

The service is actually a symlink to the `synosearchagent` binary, which changes its behavior depending on `argv[0]`:

```
# ls -l /usr/syno/sbin/synoagentregisterd
lrwxrwxrwx 1 root root 29 Sep 22 13:18 /usr/syno/sbin/synoagentregisterd -> /usr/syno/bin/synosearchagent

```

In order for `synoagentregisterd` to register the device’s IP address, it first asks `global.quickconnect.to` for a server to reach out:

```
GET /finder/server HTTP/1.1
Host: global.quickconnect.to
User-Agent: synology_armada37xx_ds120j DSM6.2-25426 Update 2 (synoagentregisterd_dsm)
Accept: */*

HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 36
Connection: close
Server: nginx

syno_finder_site=dec.quickconnect.to          [1]

```

Then, it connects to the `syno_finder_site` specified in the response [1], and communicates its IP addresses (both IPv4 and IPv6):

```
GET /finder/set.php?token=somesynotoken&serial=someserial&ipv4=10.3.3.2&ipv6=ipv6addr&port=5000&https_port=5001 HTTP/1.1
Host: dec.quickconnect.to
User-Agent: synology_armada37xx_ds120j DSM6.2-25426 Update 2 (synoagentregisterd_dsm)
Accept: */*

HTTP/1.1 200 OK
Date: Tue, 22 Sep 2020 16:46:41 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 28
Connection: close
Server: nginx

{"errno":0,"interval":22800}

```

Both requests are sent in plaintext (over HTTP port 80), and can thus be easily modified by an attacker able to man-in-the-middle the connection.

In particular, the function that parses the `/finder/server` response data [1] is at `0x404248` in the `synosearchagent` binary:

```
undefined8 FUN_00404248(undefined8 param_1,char *param_2,int param_3)
{
  int iVar1;
  char *__format;
  undefined8 uVar2;
  undefined8 uVar3;
  longlong lVar4;
  longlong lVar5;
  longlong local_918;
  void *curl_writedata;
  undefined8 local_908;
  char acStack2304 [128];
  char local_880 [128];                                                              // [6]
  char url [2048];

  memset(url,0,0x800);
  memset(acStack2304,0,0x80);
  memset(local_880,0,0x80);
  ...
  snprintf(url,0x800,"http://%s/finder/server",param_1);                             // [2]
  if (DAT_00418468 != 0) {
    fprintf(stderr,"%s:%d Get finder site: [Url: %s, UserAgent: %s]\n","synoagentregisterd.c",0x171,
            url,&DAT_004183e8);
  }
  curl_writedata = malloc(0x400);
  ...
        curl_easy_setopt(lVar4,0x2712,url);                                          // [3]
        curl_easy_setopt(lVar4,0x2727,lVar5);
        curl_easy_setopt(lVar4,0x2722,&DAT_004183e8);
        curl_easy_setopt(lVar4,0x34,1);
        curl_easy_setopt(lVar4,0x3e9,1);
        curl_easy_setopt(lVar4,0x4e,0xf);
        curl_easy_setopt(lVar4,0xd,0x1e);
        curl_easy_setopt(lVar4,0x4e2b,curl_write_callback);
        curl_easy_setopt(lVar4,0x2711,&curl_writedata);                              // [4]
        iVar1 = curl_easy_perform(lVar4);
        if (iVar1 == 0) {
          curl_easy_getinfo(lVar4,0x200002,&local_918);
          ...
          iVar1 = __isoc99_sscanf(curl_writedata,"syno_finder_site=%s",local_880);   // [5]
          ...

```

At [2], the `/finder/server` URL is created, which is then passed to `libcurl` [3] along with other options. Among those options we can notice `CURLOPT_WRITEDATA` [4], which is where the HTTP response data is going to be stored.

At [5] the data in `curl_writedata` is parsed and the result stored in the local stack variable `local_880`, which has a size of 128 bytes [6], without any length constraints.

An attacker able to impersonate the remote `global.quickconnect.to` server (for example using a man-in-the-middle attack, via ARP or DNS poisoning), could inject an arbitrarily long domain at [1], which will write out-of-bounds on the stack [5], possibly leading to arbitrary code execution.

Note that, while `synoagentregisterd` runs as UID 0 (root), DSM uses AppArmor to restrict applications’ capabilities. However, as demonstrated in TALOS-2020-1158, it is possible to bypass the AppArmor profile for `synoagentregisterd` and gain unrestricted root access.

### Timeline

2020-09-28 - Vendor Disclosure

2021-02-26 - Vendor Patched

##### Credit

Discovered by Claudio Bozzato and Lilith >\_> of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2020-1160](/vulnerability_reports/TALOS-2020-1160) [Previous Report

TALOS-2020-1146](/vulnerability_reports/TALOS-2020-1146)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


