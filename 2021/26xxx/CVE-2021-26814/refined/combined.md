=== Content from documentation.wazuh.com_f97b5581_20250114_234058.html ===


* [Community](https://wazuh.com/community/)
* [Contact us](https://wazuh.com/contact-us/)

* [X](https://x.com/wazuh "Wazuh on X")
* [LinkedIn](https://www.linkedin.com/company/wazuh "Wazuh on LinkedIn")
* [Reddit](https://www.reddit.com/r/Wazuh/ "Wazuh on Reddit")
* [GitHub](https://github.com/wazuh "Wazuh on Github")
* [Slack](https://wazuh.com/community/join-us-on-slack/ "Join us on Slack")
* Mailing list

Search here

Close

Search

[Wazuh](https://wazuh.com)

* Platform
  + [Overview](https://wazuh.com/platform/overview/)
  + [XDR](https://wazuh.com/platform/xdr/)
  + [SIEM](https://wazuh.com/platform/siem/)
* [Cloud](https://wazuh.com/cloud/)
* [Documentation](https://documentation.wazuh.com/current/index.html)
* Services
  + [Professional support](https://wazuh.com/services/professional-support/)
  + [Consulting services](https://wazuh.com/services/consulting-services/)
  + [Training courses](https://wazuh.com/services/training-courses/)
* Partners
  + [Become a partner](https://wazuh.com/partners/)
  + [Find a partner](https://wazuh.com/partners/find-a-partner/)
* [Blog](https://wazuh.com/blog/)
* Company
  + [Customers](https://wazuh.com/our-customers/)
  + [About us](https://wazuh.com/about-us/)
  + [Our team](https://wazuh.com/our-team/)
  + [Newsroom](https://wazuh.com/newsroom/)

Search term

Search now!

* [Getting started](../getting-started/index.html)
  + [Components](../getting-started/components/index.html)
    - [Wazuh agent](../getting-started/components/wazuh_agent.html)
    - [Wazuh server](../getting-started/components/wazuh_server.html)
    - [Elastic Stack](../getting-started/components/elastic_stack.html)
  + [Architecture](../getting-started/architecture.html)
  + [Use cases](../getting-started/use_cases/index.html)
    - [Log data analysis](../getting-started/use_cases/log_analysis.html)
    - [File integrity monitoring](../getting-started/use_cases/file_integrity.html)
    - [Rootkits detection](../getting-started/use_cases/rootkits_detection.html)
    - [Active response](../getting-started/use_cases/active_response.html)
    - [Configuration assessment](../getting-started/use_cases/configuration_assessment.html)
    - [System inventory](../getting-started/use_cases/system_inventory.html)
    - [Vulnerability detection](../getting-started/use_cases/vulnerability_detection.html)
    - [Cloud security monitoring](../getting-started/use_cases/cloud_security.html)
    - [Containers security monitoring](../getting-started/use_cases/containers_security.html)
    - [Regulatory compliance](../getting-started/use_cases/regulatory_compliance.html)
* [Installation guide](../installation-guide/index.html)
  + [Requirements](../installation-guide/requirements.html)
  + [Wazuh server](../installation-guide/open-distro/index.html)
    - [All-in-one deployment](../installation-guide/open-distro/all-in-one-deployment/index.html)
      * [Unattended installation](../installation-guide/open-distro/all-in-one-deployment/unattended-installation.html)
      * [Step-by-step installation](../installation-guide/open-distro/all-in-one-deployment/all_in_one.html)
    - [Distributed deployment](../installation-guide/open-distro/distributed-deployment/index.html)
      * [Unattended installation](../installation-guide/open-distro/distributed-deployment/unattended/index.html)
        + [Elasticsearch & Kibana unattended installation](../installation-guide/open-distro/distributed-deployment/unattended/unattended-elasticsearch-cluster-installation.html)
        + [Wazuh server unattended installation](../installation-guide/open-distro/distributed-deployment/unattended/unattended-wazuh-cluster-installation.html)
      * [Step-by-step installation](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/index.html)
        + [Elasticsearch cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/elasticsearch-cluster/index.html)
          - [Elasticsearch single-node cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/elasticsearch-cluster/elasticsearch-single-node-cluster.html)
          - [Elasticsearch multi-node cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/elasticsearch-cluster/elasticsearch-multi-node-cluster.html)
        + [Wazuh cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/wazuh-cluster/index.html)
          - [Wazuh single-node cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/wazuh-cluster/wazuh_single_node_cluster.html)
          - [Wazuh multi-node cluster](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/wazuh-cluster/wazuh_multi_node_cluster.html)
        + [Kibana](../installation-guide/open-distro/distributed-deployment/step-by-step-installation/kibana/index.html)
  + [Wazuh agent](../installation-guide/wazuh-agent/index.html)
    - [AIX](../installation-guide/wazuh-agent/wazuh_agent_package_aix.html)
    - [HP-UX](../installation-guide/wazuh-agent/wazuh_agent_package_hpux.html)
    - [Linux](../installation-guide/wazuh-agent/wazuh_agent_package_linux.html)
    - [macOS](../installation-guide/wazuh-agent/wazuh_agent_package_macos.html)
    - [Solaris](../installation-guide/wazuh-agent/wazuh_agent_package_solaris.html)
    - [Windows](../installation-guide/wazuh-agent/wazuh_agent_package_windows.html)
    - [Deployment variables](../installation-guide/wazuh-agent/deployment_variables/deployment_variables.html)
      * [Deployment variables for AIX](../installation-guide/wazuh-agent/deployment_variables/deployment_variables_aix.html)
      * [Deployment variables for Linux](../installation-guide/wazuh-agent/deployment_variables/deployment_variables_linux.html)
        + [Deployment variables for Linux using apt repository](../installation-guide/wazuh-agent/deployment_variables/linux/deployment_variables_apt.html)
        + [Deployment variables for Linux using dnf repository](../installation-guide/wazuh-agent/deployment_variables/linux/deployment_variables_dnf.html)
        + [Deployment variables for Linux using yum repository](../installation-guide/wazuh-agent/deployment_variables/linux/deployment_variables_yum.html)
        + [Deployment variables for Linux using zypper repository](../installation-guide/wazuh-agent/deployment_variables/linux/deployment_variables_zypper.html)
      * [Deployment variables for macOS](../installation-guide/wazuh-agent/deployment_variables/deployment_variables_macos.html)
      * [Deployment variables for Windows](../installation-guide/wazuh-agent/deployment_variables/deployment_variables_windows.html)
  + [Packages list](../installation-guide/packages-list.html)
  + [More installation alternatives](../installation-guide/more-installation-alternatives/index.html)
    - [Wazuh with Elastic Stack basic license](../installation-guide/more-installation-alternatives/elastic-stack/index.html)
      * [All-in-one deployment](../installation-guide/more-installation-alternatives/elastic-stack/all-in-one-deployment/index.html)
        + [Unattended installation](../installation-guide/more-installation-alternatives/elastic-stack/all-in-one-deployment/unattended-installation.html)
        + [Step-by-step installation](../installation-guide/more-installation-alternatives/elastic-stack/all-in-one-deployment/all_in_one.html)
      * [Distributed deployment](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/index.html)
        + [Unattended installation](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/unattended/index.html)
          - [Elasticsearch & Kibana unattended installation](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/unattended/unattended-elasticsearch-cluster-installation.html)
          - [Wazuh server unattended installation](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/unattended/unattended-wazuh-cluster-installation.html)
        + [Step-by-step installation](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/step-by-step-installation/index.html)
          - [Elasticsearch cluster](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/step-by-step-installation/elasticsearch-cluster/index.html)
          - [Wazuh cluster](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/step-by-step-installation/wazuh-cluster/index.html)
          - [Kibana](../installation-guide/more-installation-alternatives/elastic-stack/distributed-deployment/step-by-step-installation/kibana/index.html)
    - [Wazuh with Splunk](https://documentation.wazuh.com/3.13/installation-guide/installing-splunk/index.html)
    - [Wazuh installation from sources](../installation-guide/more-installation-alternatives/wazuh-from-sources/index.html)
      * [Installing Wazuh server from sources](../installation-guide/more-installation-alternatives/wazuh-from-sources/wazuh-server/index.html)
      * [Installing Wazuh agent from sources](../installation-guide/more-installation-alternatives/wazuh-from-sources/wazuh-agent/index.html)
* [Upgrade guide](../upgrade-guide/index.html)
  + [Upgrading the Wazuh manager](../upgrade-guide/upgrading-wazuh.html)
  + [Upgrade Elasticsearch, Filebeat and Kibana](../upgrade-guide/elasticsearch-kibana-filebeat/index.html)
    - [Upgrading Open Distro for Elasticsearch](../upgrade-guide/elasticsearch-kibana-filebeat/upgrading-open-distro.html)
    - [Upgrading Elastic Stack basic license](../upgrade-guide/elasticsearch-kibana-filebeat/upgrading-elastic-stack.html)
  + [Upgrading the Wazuh agent](../upgrade-guide/upgrading-agent.html)
  + [Upgrading from a legacy version](../upgrade-guide/legacy/index.html)
    - [Upgrading the Wazuh server](../upgrade-guide/legacy/upgrading-wazuh-server/index.html)
      * [Upgrading the Wazuh server from 2.x to 3.x](../upgrade-guide/legacy/upgrading-wazuh-server/from-2.x-to-3.x.html)
        + [Restore the Wazuh alerts from Wazuh 2.x](../upgrade-guide/legacy/upgrading-wazuh-server/restore_alerts-from-2.x-to-3.x.html)
      * [Upgrading the Wazuh server from 1.x to 2.x](../upgrade-guide/legacy/upgrading-wazuh-server/from-1.x-to-2.x.html)
    - [Upgrading Elastic Stack](../upgrade-guide/legacy/upgrading-elastic-stack/index.html)
      * [Upgrading Elastic Stack from 6.8 to 7.x](../upgrade-guide/legacy/upgrading-elastic-stack/from-6.8-to-7.x.html)
      * [Upgrading Elastic Stack from 6.x to 6.8](../upgrade-guide/legacy/upgrading-elastic-stack/from-6.x-to-6.8.html)
      * [Upgrading Elastic Stack from 2.x to 5.x](../upgrade-guide/legacy/upgrading-elastic-stack/from-2.x-to-5.x.html)
    - [Upgrading the Wazuh agent](../upgrade-guide/legacy/upgrading-agent/index.html)
      * [Upgrading the Wazuh agent from 2.x to 3.x](../upgrade-guide/legacy/upgrading-agent/from-2.x-to-3.x.html)
      * [Upgrading the Wazuh agent from 1.x to 2.x](../upgrade-guide/legacy/upgrading-agent/from-1.x-to-2.x.html)
  + [Compatibility matrix](../upgrade-guide/compatibility_matrix/index.html)
* [User manual](../user-manual/index.html)
  + [Overview](../user-manual/overview.html)
  + [Wazuh server administration](../user-manual/manager/index.html)
    - [Remote service](../user-manual/manager/remote-service.html)
    - [Defining an alert level threshold](../user-manual/manager/alert-threshold.html)
    - [Integration with external APIs](../user-manual/manager/manual-integration.html)
    - [Configuring syslog output](../user-manual/manager/manual-syslog-output.html)
    - [Configuring database output](../user-manual/manager/manual-database-output.html)
    - [Generating automatic reports](../user-manual/manager/automatic-reports.html)
    - [Configuring email alerts](../user-manual/manager/manual-email-report/index.html)
      * [SMTP server with authentication](../user-manual/manager/manual-email-report/smtp_authentication.html)
  + [Certificates deployment](../user-manual/certificates.html)
  + [Registering Wazuh agents](../user-manual/registering/index.html)
    - [Registering the Wazuh agents using the command line (CLI)](../user-manual/registering/command-line-registration.html)
    - [Registering the Wazuh agents using the Wazuh API](../user-manual/registering/restful-api-registration.html)
    - [Registration service with password authorization](../user-manual/registering/password-authorization-registration.html)
    - [Registration service with host verification](../user-manual/registering/host-verification-registration.html)
    - [Registering Wazuh agents - additional information](../user-manual/registering/registering-agents-theory.html)
    - [Registering Wazuh agents - Troubleshooting](../user-manual/registering/registering-agents-troubleshooting.html)
  + [Agent management](../user-manual/agents/index.html)
    - [Agent life cycle](../user-manual/agents/agent-life-cycle.html)
    - [Listing agents](../user-manual/agents/listing/index.html)
      * [Listing agents using the CLI](../user-manual/agents/listing/using-command-line.html)
      * [Listing agents using the Wazuh API](../user-manual/agents/listing/listing.html)
      * [Listing agents using the Wazuh app](../user-manual/agents/listing/wazuh-app.html)
    - [Removing agents](../user-manual/agents/remove-agents/index.html)
      * [Remove agents using the CLI](../user-manual/agents/remove-agents/remove.html)
      * [Remove agents using the Wazuh API](../user-manual/agents/remove-agents/restful-api-remove.html)
    - [Checking connection with Manager](../user-manual/agents/agent-connection.html)
    - [Grouping agents](../user-manual/agents/grouping-agents.html)
    - [Remote upgrading](../user-manual/agents/remote-upgrading/index.html)
      * [Upgrading agent](../user-manual/agents/remote-upgrading/upgrading-agent.html)
      * [Adding a custom repository](../user-manual/agents/remote-upgrading/custom-repository.html)
      * [Custom WPK packages creation](../user-manual/agents/remote-upgrading/create-custom-wpk/create-wpk-key.html)
        + [WPK](../development/packaging/generate-wpk-package.html)
        + [Generate WPK packages manually](../user-manual/agents/remote-upgrading/create-custom-wpk/generate-wpk-package-manually.html)
      * [Installing a custom WPK package](../user-manual/agents/remote-upgrading/install-custom-wpk.html)
      * [WPK List](../user-manual/agents/remote-upgrading/wpk-list.html)
  + [Deploying a Wazuh cluster](../user-manual/configuring-cluster/index.html)
    - [Basics](../user-manual/configuring-cluster/basics.html)
    - [Agents connections](../user-manual/configuring-cluster/advanced-settings.html)
    - [Cluster management](../user-manual/configuring-cluster/cluster_management.html)
  + [Capabilities](../user-manual/capabilities/index.html)
    - [Log data collection](../user-manual/capabilities/log-data-collection/index.html)
      * [How it works](../user-manual/capabilities/log-data-collection/how-it-works.html)
      * [How to collect Windows logs](../user-manual/capabilities/log-data-collection/how-to-collect-wlogs.html)
      * [Configuration](../user-manual/capabilities/log-data-collection/log-data-configuration.html)
      * [FAQ](../user-manual/capabilities/log-data-collection/log-data-faq.html)
    - [File integrity monitoring](../user-manual/capabilities/file-integrity/index.html)
      * [How it works](../user-manual/capabilities/file-integrity/how-it-works.html)
      * [Configuration](../user-manual/capabilities/file-integrity/fim-configuration.html)
    - [Auditing who-data](../user-manual/capabilities/auditing-whodata/index.html)
      * [Auditing who-data in Linux](../user-manual/capabilities/auditing-whodata/who-linux.html)
      * [Auditing who-data in Windows](../user-manual/capabilities/auditing-whodata/who-windows.html)
      * [Manual configuration of the Local Audit Policies in Windows](../user-manual/capabilities/auditing-whodata/who-windows-policies.html)
    - [Anomaly and malware detection](../user-manual/capabilities/anomalies-detection/index.html)
      * [How it works](../user-manual/capabilities/anomalies-detection/how-it-works.html)
      * [Configuration](../user-manual/capabilities/anomalies-detection/anomaly-configuration.html)
      * [FAQ](../user-manual/capabilities/anomalies-detection/anomaly-faq.html)
    - [Security Configuration Assessment](../user-manual/capabilities/sec-config-assessment/index.html)
      * [What is SCA](../user-manual/capabilities/sec-config-assessment/what_is_it.html)
      * [How SCA works](../user-manual/capabilities/sec-config-assessment/how_it_works.html)
      * [How to configure SCA](../user-manual/capabilities/sec-config-assessment/how_to_configure.html)
      * [Creating custom SCA policies](../user-manual/capabilities/sec-config-assessment/creating_custom_policies.html)
      * [Use case: Getting an alert when a check changes its result value](../user-manual/capabilities/sec-config-assessment/use_case.html)
    - [Monitoring security policies](../user-manual/capabilities/policy-monitoring/index.html)
      * [Rootcheck](../user-manual/capabilities/policy-monitoring/rootcheck/index.html)
        + [How it works](../user-manual/capabilities/policy-monitoring/rootcheck/how-it-works.html)
        + [Configuration](../user-manual/capabilities/policy-monitoring/rootcheck/rootcheck-configuration.html)
        + [FAQ](../user-manual/capabilities/policy-monitoring/rootcheck/rootcheck-faq.html)
      * [OpenSCAP](../user-manual/capabilities/policy-monitoring/openscap/index.html)
        + [How it works](../user-manual/capabilities/policy-monitoring/openscap/how-it-works.html)
        + [Configuration](../user-manual/capabilities/policy-monitoring/openscap/oscap-configuration.html)
        + [FAQ](../user-manual/capabilities/policy-monitoring/openscap/oscap-faq.html)
      * [CIS-CAT integration](../user-manual/capabilities/policy-monitoring/ciscat/ciscat.html)
    - [Monitoring system calls](../user-manual/capabilities/system-calls-monitoring/index.html)
      * [How it works](../user-manual/capabilities/system-calls-monitoring/how-it-works.html)
      * [Configuration](../user-manual/capabilities/system-calls-monitoring/audit-configuration.html)
    - [Command monitoring](../user-manual/capabilities/command-monitoring/index.html)
      * [How it works](../user-manual/capabilities/command-monitoring/how-it-works.html)
      * [Configuration](../user-manual/capabilities/command-monitoring/command-configuration.html)
      * [FAQ](../user-manual/capabilities/command-monitoring/command-faq.html)
    - [Active response](../user-manual/capabilities/active-response/index.html)
      * [How it works](../user-manual/capabilities/active-response/how-it-works.html)
      * [Configuration](../user-manual/capabilities/active-response/remediation-configuration.html)
      * [FAQ](../user-manual/capabilities/active-response/remediation-faq.html)
    - [Agentless monitoring](../user-manual/capabilities/agentless-monitoring/index.html)
      * [How it works](../user-manual/capabilities/agentless-monitoring/how-it-works.html)
      * [Configuration](../user-manual/capabilities/agentless-monitoring/agentless-configuration.html)
      * [FAQ](../user-manual/capabilities/agentless-monitoring/agentless-faq.html)
    - [Anti-flooding mechanism](../user-manual/capabilities/antiflooding.html)
    - [Agent labels](../user-manual/capabilities/labels.html)
    - [System inventory](../user-manual/capabilities/syscollector.html)
    - [Vulnerability detection](../user-manual/capabilities/vulnerability-detection/index.html)
      * [How it works](../user-manual/capabilities/vulnerability-detection/how_it_works.html)
      * [Compatibility matrix](../user-manual/capabilities/vulnerability-detection/compatibility_matrix.html)
      * [Running a vulnerability scan](../user-manual/capabilities/vulnerability-detection/running_vu_scan.html)
      * [Offline Update](../user-manual/capabilities/vulnerability-detection/offline_update.html)
      * [Scan vulnerabilities on unsupported systems](../user-manual/capabilities/vulnerability-detection/allow_os.html)
      * [CPE Helper](../user-manual/capabilities/vulnerability-detection/cpe_helper.html)
    - [VirusTotal integration](../user-manual/capabilities/virustotal-scan/index.html)
      * [About VirusTotal](../user-manual/capabilities/virustotal-scan/about.html)
      * [How it works](../user-manual/capabilities/virustotal-scan/integration.html)
    - [Osquery](../user-manual/capabilities/osquery.html)
    - [Agent key polling](../user-manual/capabilities/agent-key-polling.html)
    - [Fluentd forwarder](../user-manual/capabilities/fluent-forwarder.html)
  + [Ruleset](../user-manual/ruleset/index.html)
    - [Getting started](../user-manual/ruleset/getting-started.html)
    - [Update ruleset](../user-manual/ruleset/update.html)
    - [JSON decoder](../user-manual/ruleset/json-decoder.html)
    - [Custom rules and decoders](../user-manual/ruleset/custom.html)
    - [Dynamic fields](../user-manual/ruleset/dynamic-fields.html)
    - [Ruleset XML syntax](../user-manual/ruleset/ruleset-xml-syntax/index.html)
      * [Decoders Syntax](../user-manual/ruleset/ruleset-xml-syntax/decoders.html)
      * [Rules Syntax](../user-manual/ruleset/ruleset-xml-syntax/rules.html)
      * [Regular Expression Syntax](../user-manual/ruleset/ruleset-xml-syntax/regex.html)
      * [Sibling Decoders](../user-manual/ruleset/ruleset-xml-syntax/sibling-decoders.html)
    - [Testing decoders and rules](../user-manual/ruleset/testing.html)
    - [Using CDB lists](../user-manual/ruleset/cdb-list.html)
    - [Enhancing with MITRE](../user-manual/ruleset/mitre.html)
    - [Contribute to the ruleset](../user-manual/ruleset/contribute.html)
    - [Rules classification](../user-manual/ruleset/rules-classification.html)
  + [RESTful API](../user-manual/api/index.html)
    - [Getting started](../user-manual/api/getting-started.html)
    - [Configuration](../user-manual/api/configuration.html)
    - [Securing the Wazuh API](../user-manual/api/securing_api.html)
    - [Migrating from the Wazuh API 3.X](../user-manual/api/equivalence.html)
    - [Role-Based Access Control](../user-manual/api/rbac/index.html)
      * [How it works](../user-manual/api/rbac/how-it-works.html)
      * [Configuration](../user-manual/api/rbac/configuration.html)
      * [Authorization Context](../user-manual/api/rbac/auth_context.html)
      * [RBAC Reference](../user-manual/api/rbac/reference.html)
    - [Filtering data using queries](../user-manual/api/queries.html)
    - [Examples](../user-manual/api/examples.html)
    - [Reference](../user-manual/api/reference.html)
  + [Wazuh Kibana plugin](../user-manual/kibana-app/index.html)
    - [Setting up the Wazuh Kibana plugin](../user-manual/kibana-app/connect-kibana-app.html)
    - [Wazuh Kibana plugin features](../user-manual/kibana-app/features/index.html)
      * [App overview](../user-manual/kibana-app/features/app-overview.html)
      * [Ruleset](../user-manual/kibana-app/features/ruleset.html)
      * [Settings](../user-manual/kibana-app/features/settings.html)
      * [Dev tools](../user-manual/kibana-app/features/dev-tools.html)
      * [Reporting](../user-manual/kibana-app/features/reporting.html)
      * [Index pattern selector](../user-manual/kibana-app/features/index-pattern.html)
      * [Download as CSV](../user-manual/kibana-app/features/download-csv.html)
      * [Query configuration](../user-manual/kibana-app/features/query-configuration.html)
    - [Troubleshooting](../user-manual/kibana-app/troubleshooting.html)
    - [Reference](../user-manual/kibana-app/reference/index.html)
      * [Configuration file](../user-manual/kibana-app/reference/config-file.html)
      * [Elasticsearch indices](../user-manual/kibana-app/reference/elasticsearch.html)
      * [Configure the name of Elasticsearch indices](../user-manual/kibana-app/reference/configure-indices.html)
      * [Create a custom dashboard](../user-manual/kibana-app/reference/custom-dashboard.html)
  + [Reference](../user-manual/reference/index.html)
    - [Local configuration (ossec.conf)](../user-manual/reference/ossec-conf/index.html)
      * [active-response](../user-manual/reference/ossec-conf/active-response.html)
      * [agentless](../user-manual/reference/ossec-conf/agentless.html)
      * [alerts](../user-manual/reference/ossec-conf/alerts.html)
      * [auth](../user-manual/reference/ossec-conf/auth.html)
      * [client](../user-manual/reference/ossec-conf/client.html)
      * [client\_buffer](../user-manual/reference/ossec-conf/client_buffer.html)
      * [cluster](../user-manual/reference/ossec-conf/cluster.html)
      * [command](../user-manual/reference/ossec-conf/commands.html)
      * [database\_output](../user-manual/reference/ossec-conf/database-output.html)
      * [email\_alerts](../user-manual/reference/ossec-conf/email_alerts.html)
      * [global](../user-manual/reference/ossec-conf/global.html)
      * [integration](../user-manual/reference/ossec-conf/integration.html)
      * [labels](../user-manual/reference/ossec-conf/labels.html)
      * [localfile](../user-manual/reference/ossec-conf/localfile.html)
      * [logging](../user-manual/reference/ossec-conf/logging.html)
      * [remote](../user-manual/reference/ossec-conf/remote.html)
      * [reports](../user-manual/reference/ossec-conf/reports.html)
      * [rootcheck](../user-manual/reference/ossec-conf/rootcheck.html)
      * [sca](../user-manual/reference/ossec-conf/sca.html)
      * [ruleset](../user-manual/reference/ossec-conf/ruleset.html)
      * [socket](../user-manual/reference/ossec-conf/socket.html)
      * [syscheck](../user-manual/reference/ossec-conf/syscheck.html)
      * [syslog\_output](../user-manual/reference/ossec-conf/syslog-output.html)
      * [fluent-forward](../user-manual/reference/ossec-conf/fluent-forward.html)
      * [gcp-pubsub](../user-manual/reference/ossec-conf/gcp-pubsub.html)
      * [wodle name="open-scap"](../user-manual/reference/ossec-conf/wodle-openscap.html)
      * [wodle name="command"](../user-manual/reference/ossec-conf/wodle-command.html)
      * [wodle name="cis-cat"](../user-manual/reference/ossec-conf/wodle-ciscat.html)
      * [wodle name="aws-s3"](../user-manual/reference/ossec-conf/wodle-s3.html)
      * [wodle name="syscollector"](../user-manual/reference/ossec-conf/wodle-syscollector.html)
      * [vulnerability-detector](../user-manual/reference/ossec-conf/vuln-detector.html)
      * [wodle name="osquery"](../user-manual/reference/ossec-conf/wodle-osquery.html)
      * [wodle name="docker-listener"](../user-manual/reference/ossec-conf/wodle-docker.html)
      * [wodle name="azure-logs"](../user-manual/reference/ossec-conf/wodle-azure-logs.html)
      * [wodle name="agent-key-polling"](../user-manual/reference/ossec-conf/wodle-agent-key-polling.html)
      * [Verifying configuration](../user-manual/reference/ossec-conf/verifying-configuration.html)
    - [Centralized configuration (agent.conf)](../user-manual/reference/centralized-configuration.html)
    - [Internal configuration](../user-manual/reference/internal-options.html)
    - [Daemons](../user-manual/reference/daemons/index.html)
      * [ossec-agentd](../user-manual/reference/daemons/ossec-agentd.html)
      * [ossec-agentlessd](../user-manual/reference/daemons/ossec-agentlessd.html)
      * [ossec-analysisd](../user-manual/reference/daemons/ossec-analysisd.html)
      * [ossec-authd](../user-manual/reference/daemons/ossec-authd.html)
      * [ossec-csyslogd](../user-manual/reference/daemons/ossec-csyslogd.html)
      * [ossec-dbd](../user-manual/reference/daemons/ossec-dbd.html)
      * [ossec-execd](../user-manual/reference/daemons/ossec-execd.html)
      * [ossec-logcollector](../user-manual/reference/daemons/ossec-logcollector.html)
      * [ossec-maild](../user-manual/reference/daemons/ossec-maild.html)
      * [ossec-monitord](../user-manual/reference/daemons/ossec-monitord.html)
      * [ossec-remoted](../user-manual/reference/daemons/ossec-remoted.html)
      * [ossec-reportd](../user-manual/reference/daemons/ossec-reportd.html)
      * [ossec-syscheckd](../user-manual/reference/daemons/ossec-syscheckd.html)
      * [wazuh-clusterd](../user-manual/reference/daemons/clusterd.html)
      * [wazuh-modulesd](../user-manual/reference/daemons/wazuh-modulesd.html)
      * [wazuh-db](../user-manual/reference/daemons/wazuh-db.html)
      * [Tables available for wazuh-db](../user-manual/reference/daemons/wazuh-db.html#tables-available-for-wazuh-db)
      * [ossec-integratord](../user-manual/reference/daemons/ossec-integratord.html)
    - [Tools](../user-manual/reference/tools/index.html)
      * [agent-auth](../user-manual/reference/tools/agent-auth.html)
      * [agent\_control](../user-manual/reference/tools/agent_control.html)
      * [manage\_agents](../user-manual/reference/tools/manage_agents.html)
      * [ossec-control](../user-manual/reference/tools/ossec-control.html)
      * [ossec-logtest](../user-manual/reference/tools/ossec-logtest.html)
      * [ossec-makelists](../user-manual/reference/tools/ossec-makelists.html)
      * [rootcheck\_control](../user-manual/reference/tools/rootcheck_control.html)
      * [syscheck\_control](../user-manual/reference/tools/syscheck_control.html)
      * [syscheck\_update](../user-manual/reference/tools/syscheck_update.html)
      * [clear\_stats](../user-manual/reference/tools/clear_stats.html)
      * [ossec-regex](../user-manual/reference/tools/ossec-regex.html)
      * [update\_ruleset](../user-manual/reference/tools/update_ruleset.html)
      * [util.sh](../user-manual/reference/tools/util.sh.html)
      * [verify-agent-conf](../user-manual/reference/tools/verify-agent-conf.html)
      * [agent\_groups](../user-manual/reference/tools/agent_groups.html)
      * [agent\_upgrade](../user-manual/reference/tools/agent_upgrade.html)
      * [cluster\_control](../user-manual/reference/tools/cluster_control.html)
      * [fim\_migrate](../user-manual/reference/tools/fim_migrate.html)
    - [Unattended Installation](../user-manual/reference/unattended-installation.html)
    - [Statistics files](../user-manual/reference/statistics-files/index.html)
      * [ossec-agentd.state](../user-manual/reference/statistics-files/ossec-agentd-state.html)
      * [ossec-remoted.state](../user-manual/reference/statistics-files/ossec-remoted-state.html)
      * [ossec-analysisd.state](../user-manual/reference/statistics-files/ossec-analysisd-state.html)
  + [Elasticsearch tuning](../user-manual/elasticsearch/elastic_tuning.html)
  + [Uninstalling the Wazuh components](../user-manual/uninstall/index.html)
    - [Uninstalling Wazuh with Open Distro for Elasticsearch](../user-manual/uninstall/open-distro.html)
    - [Uninstalling Wazuh with Elastic Stack](../user-manual/uninstall/elastic-stack.html)
* [Development](../development/index.html)
  + [Client keys file](../development/client-keys.html)
  + [Standard OSSEC message format](../development/message-format.html)
  + [Makefile options](../development/makefile.html)
  + [Wazuh Cluster](../development/wazuh-cluster.html)
  + [Wazuh packages generation guide](../development/packaging/index.html)
    - [AIX](../development/packaging/generate-aix-package.html)
    - [Debian](../development/packaging/generate-deb-package.html)
    - [HPUX](../development/packaging/generate-hpux-package.html)
    - [Wazuh Kibana plugin](../development/packaging/generate-wazuh-kibana-app.html)
    - [macOS](../development/packaging/generate-osx-package.html)
    - [RPM](../development/packaging/generate-rpm-package.html)
    - [Solaris](../development/packaging/generate-sol-package.html)
    - [Splunk App](../development/packaging/generate-wazuh-splunk-app.html)
    - [Virtual machine](../development/packaging/generate-ova.html)
    - [Windows](../development/packaging/generate-windows-package.html)
    - [WPK](../development/packaging/generate-wpk-package.html)
* [Containers](../containers.html)
  + [Docker](../docker/index.html)
    - [Docker installation](../docker/docker-installation.html)
    - [Wazuh Docker deployment](../docker/wazuh-container.html)
    - [Wazuh Docker utilities](../docker/container-usage.html)
    - [Upgrade Guide (3.x to 4.0)](../docker/upgrade-guide.html)
    - [FAQ](../docker/faq-wazuh-container.html)
  + [Deploying with Kubernetes](../deploying-with-kubernetes/index.html)
    - [Kubernetes configuration](../deploying-with-kubernetes/kubernetes-conf.html)
    - [Upgrade Wazuh installed in Kubernetes](../deploying-with-kubernetes/kubernetes-upgrade.html)
    - [Clean Up](../deploying-with-kubernetes/kubernetes-clean-up.html)
* [Deployment](../deployment.html)
  + [Deploying with Puppet](../deploying-with-puppet/index.html)
    - [Set up Puppet](../deploying-with-puppet/setup-puppet/index.html)
      * [Installing Puppet master](../deploying-with-puppet/setup-puppet/install-puppet-master.html)
      * [Installing Puppet agent](../deploying-with-puppet/setup-puppet/install-puppet-agent.html)
      * [PuppetDB installation (Optional)](../deploying-with-puppet/setup-puppet/install-puppet-db.html)
      * [Setting up Puppet certificates](../deploying-with-puppet/setup-puppet/setup-puppet-certificates.html)
    - [Wazuh Puppet module](../deploying-with-puppet/wazuh-puppet-module/index.html)
      * [Wazuh agent class](../deploying-with-puppet/wazuh-puppet-module/reference-wazuh-puppet/wazuh-agent-class.html)
      * [Wazuh manager class](../deploying-with-puppet/wazuh-puppet-module/reference-wazuh-puppet/wazuh-manager-class.html)
  + [Deploying with Ansible](../deploying-with-ansible/index.html)
    - [Installation Guide](../deploying-with-ansible/installation-guide.html)
      * [Install Ansible](../deploying-with-ansible/guide/install-ansible.html)
      * [Install Wazuh Manager](../deploying-with-ansible/guide/install-wazuh-manager.html)
      * [Install Elastic Stack Server](../deploying-with-ansible/guide/install-elk-server.html)
      * [Install Wazuh Agent](../deploying-with-ansible/guide/install-wazuh-agent.html)
    - [Remote Hosts Connection](../deploying-with-ansible/setup-remote-systems.html)
    - [Roles](../deploying-with-ansible/roles/index.html)
      * [Wazuh Manager](../deploying-with-ansible/roles/wazuh-manager.html)
      * [Filebeat](../deploying-with-ansible/roles/wazuh-filebeat.html)
      * [Elasticsearch](../deploying-with-ansible/roles/wazuh-elasticsearch.html)
      * [Kibana](../deploying-with-ansible/roles/wazuh-kibana.html)
      * [Wazuh Agent](../deploying-with-ansible/roles/wazuh-agent.html)
    - [Variables references](../deploying-with-ansible/reference.html)
  + [Virtual Machine (OVA)](../virtual-machine/virtual-machine.html)
* [Compliance](../compliance.html)
  + [Using Wazuh for PCI DSS](../pci-dss/index.html)
    - [Log analysis](../pci-dss/log-analysis.html)
    - [Policy monitoring](../pci-dss/policy-monitoring.html)
    - [Rootkit detection](../pci-dss/rootkit-detection.html)
    - [File integrity monitoring](../pci-dss/file-integrity-monitoring.html)
    - [Active response](../pci-dss/active-response.html)
    - [Elastic Stack](../pci-dss/elastic.html)
  + [Using Wazuh for GDPR](../gdpr/index.html)
    - [GDPR II, Principles <gdpr\_II>](../gdpr/gdpr-II.html)
    - [GDPR III, Rights of the data subject <gdpr\_III>](../gdpr/gdpr-III.html)
    - [GDPR IV, Controller and processor <gdpr\_IV>](../gdpr/gdpr-IV.html)
* [Monitoring with Wazuh](../monitoring.html)
  + [Using Wazuh to monitor AWS](../amazon/index.html)
    - [Monitoring AWS instances](../amazon/instances.html)
    - [Monitoring AWS based services](../amazon/services/index.html)
      * [Prerequisites](../amazon/services/prerequisites/index.html)
        + [Configuring an S3 Bucket](../amazon/services/prerequisites/S3-bucket.html)
        + [Configuring AWS credentials](../amazon/services/prerequisites/credentials.html)
        + [Installing dependencies](../amazon/services/prerequisites/dependencies.html)
        + [Considerations for configuration](../amazon/services/prerequisites/considerations.html)
      * [Supported services](../amazon/services/supported-services/index.html)
        + [AWS CloudTrail](../amazon/services/supported-services/cloudtrail.html)
        + [Amazon VPC](../amazon/services/supported-services/vpc.html)
        + [AWS Config](../amazon/services/supported-services/config.html)
        + [AWS Key Management Service](../amazon/services/supported-services/kms.html)
        + [Amazon Macie](../amazon/services/supported-services/macie.html)
        + [AWS Trusted Advisor](../amazon/services/supported-services/trusted-advisor.html)
        + [Amazon GuardDuty](../amazon/services/supported-services/guardduty.html)
        + [Amazon WAF](../amazon/services/supported-services/waf.html)
        + [Amazon Inspector](../amazon/services/supported-services/inspector.html)
        + [AWS CloudWatch Logs](../amazon/services/supported-services/cloudwatchlogs.html)
        + [Cisco Umbrella](../amazon/services/supported-services/cisco-umbrella.html)
      * [Troubleshooting](../amazon/services/troubleshooting.html)
  + [Using Wazuh to monitor Microsoft Azure](../azure/index.html)
    - [Monitoring Instances](../azure/monitoring-instances.html)
    - [Monitoring Activity](../azure/monitoring-activity.html)
    - [Monitoring Services](../azure/monitoring-services.html)
  + [Using Wazuh to monitor Docker](../docker-monitor/index.html)
    - [Monitoring Docker server](../docker-monitor/monitoring_docker_server.html)
    - [Monitoring containers activity](../docker-monitor/monitoring_containers_activity.html)
  + [Using Wazuh to monitor GCP services](../gcp/index.html)
    - [Prerequisites](../gcp/prerequisites/index.html)
      * [Installing dependencies](../gcp/prerequisites/dependencies.html)
      * [Configuring GCP credentials](../gcp/prerequisites/credentials.html)
      * [Configuring Google Cloud Pub/Sub](../gcp/prerequisites/pubsub.html)
      * [Considerations for configuration](../gcp/prerequisites/considerations.html)
    - [Configuration](../user-manual/reference/ossec-conf/gcp-pubsub.html)
    - [Supported services](../gcp/supported-services/index.html)
* [Migrating from OSSEC](../migrating-from-ossec/index.html)
  + [Migrating OSSEC server](../migrating-from-ossec/ossec-server.html)
  + [Migrating OSSEC agent](../migrating-from-ossec/ossec-agent.html)
* [Learning Wazuh](../learning-wazuh/index.html)
  + [Prepare your Wazuh Lab Environment](../learning-wazuh/build-lab/index.html)
    - [Build the Wazuh Lab VPC](../learning-wazuh/build-lab/build-vpc.html)
    - [Launch the EC2 instances](../learning-wazuh/build-lab/launch-ec2-instances.html)
    - [Establish access to your EC2 instances](../learning-wazuh/build-lab/access-ec2-instances.html)
    - [Install Wazuh server Components](../learning-wazuh/build-lab/install-wazuh-manager.html)
    - [Install the Elastic Stack](../learning-wazuh/build-lab/install-elastic-stack.html)
    - [Configure X-Pack Security](../learning-wazuh/build-lab/xpack-security-setup.html)
    - [Install the Linux Wazuh agents](../learning-wazuh/build-lab/install-linux-agents.html)
    - [Install the Windows Wazuh agent](../learning-wazuh/build-lab/install-windows-agent.html)
  + [Detect an SSH brute-force attack](../learning-wazuh/ssh-brute-force.html)
  + [Detect an RDP brute force attack](../learning-wazuh/rdp-brute-force.html)
  + [Expose hiding processes](../learning-wazuh/hidden-processes.html)
  + [Detect filesystem changes](../learning-wazuh/detect-fs-changes.html)
  + [Change the rules](../learning-wazuh/replace-stock-rule.html)
  + [Survive a log flood](../learning-wazuh/survive-flood.html)
  + [Detect and react to a Shellshock attack](../learning-wazuh/shellshock.html)
  + [Keep watch for malicious command execution](../learning-wazuh/audit-commands.html)
  + [Catch suspicious network traffic](../learning-wazuh/suricata.html)
  + [Track down vulnerable applications](../learning-wazuh/vuln-detection.html)
* [Release notes](index.html)
  + 4.0.4 Release notes
  + [4.0.3 Release notes](release_4_0_3.html)
  + [4.0.2 Release notes](release_4_0_2.html)
  + [4.0.1 Release notes](release_4_0_1.html)
  + [4.0.0 Release notes](release_4_0_0.html)
  + [3.13.6 Release notes](release-3-13-6.html)
  + [3.13.5 Release notes](release-3-13-5.html)
  + [3.13.4 Release notes](release-3-13-4.html)
  + [3.13.3 Release notes](release_3_13_3.html)
  + [3.13.2 Release notes](release_3_13_2.html)
  + [3.13.1 Release notes](release_3_13_1.html)
  + [3.13.0 Release notes](release_3_13_0.html)
  + [3.12.3 Release notes](release_3_12_3.html)
  + [3.12.2 Release notes](release_3_12_2.html)
  + [3.12.1 Release notes](release_3_12_1.html)
  + [3.12.0 Release notes](release_3_12_0.html)
  + [3.11.4 Release notes](release_3_11_4.html)
  + [3.11.3 Release notes](release_3_11_3.html)
  + [3.11.2 Release notes](release_3_11_2.html)
  + [3.11.1 Release notes](release_3_11_1.html)
  + [3.11.0 Release notes](release_3_11_0.html)
  + [3.10.2 Release notes](release_3_10_2.html)
  + [3.10.1 Release notes](release_3_10_1.html)
  + [3.10.0 Release notes](release_3_10_0.html)
  + [3.9.5 Release notes](release_3_9_5.html)
  + [3.9.4 Release notes](release_3_9_4.html)
  + [3.9.3 Release notes](release_3_9_3.html)
  + [3.9.2 Release notes](release_3_9_2.html)
  + [3.9.1 Release notes](release_3_9_1.html)
  + [3.9.0 Release notes](release_3_9_0.html)
  + [3.8.2 Release notes](release_3_8_2.html)
  + [3.8.1 Release notes](release_3_8_1.html)
  + [3.8.0 Release notes](release_3_8_0.html)
  + [3.7.2 Release notes](release_3_7_2.html)
  + [3.7.1 Release notes](release_3_7_1.html)
  + [3.7.0 Release notes](release_3_7_0.html)
  + [3.6.1 Release notes](release_3_6_1.html)
  + [3.6.0 Release notes](release_3_6_0.html)
  + [3.5.0 Release notes](release_3_5_0.html)
  + [3.4.0 Release notes](release_3_4_0.html)
  + [3.3.1 Release notes](release_3_3_1.html)
  + [3.3.0 Release notes](release_3_3_0.html)
  + [3.2.4 Release notes](release_3_2_4.html)
  + [3.2.3 Release notes](release_3_2_3.html)
  + [3.2.2 Release notes](release_3_2_2.html)
  + [3.2.1 Release notes](release_3_2_1.html)
  + [3.2.0 Release notes](release_3_2_0.html)
  + [3.1.0 Release notes](release_3_1_0.html)
  + [3.0.0 Release notes](release_3_0_0.html)
  + [2.1 Release notes](release_2_1.html)

Attention
 This documentation does not apply to the most recent version of Wazuh. Check out the docs for the latest version.

* [Release notes](index.html)
* 4.0.4 Release notes

# 4.0.4 Release notes

This section lists the changes in version 4.0.4. More details about these changes are provided in the changelog of each component:

* [wazuh/wazuh](https://github.com/wazuh/wazuh/blob/v4.0.4/CHANGELOG.md)
* [wazuh/wazuh-kibana-app](https://github.com/wazuh/wazuh-kibana-app/blob/v4.0.4-7.9.3/CHANGELOG.md)

## Wazuh core

### Added

**API**

* Missing secure headers for API responses to fulfill the OWASP recommendations.
* New option to disable uploading configurations containing remote commands.
* New option to choose the SSL ciphers. Default value TLSv1.2.

### Changed

**API**

* Restore and update API configuration endpoints have been deprecated.
* JWT token expiration time set to 15 minutes.

### Fixed

**API**

* Fixed a path traversal flaw ([CVE-2021-26814](https://nvd.nist.gov/vuln/detail/CVE-2021-26814)) affecting 4.0.0 to 4.0.3 at `/manager/files` and `/cluster/{node_id}/files` endpoints. This vulnerability allowed authenticated users to execute arbitrary code with administrative privileges via `/manager/files` URI. An authenticated user to the service could exploit incomplete input validation on the `/manager/files` API to inject arbitrary code within the API service script. Thanks to Davide Meacci for reporting this vulnerability.

**Framework**

* Bug with client.keys file handling when adding agents without authd.

**Core**

* The purge of the Redhat vulnerabilities database before updating it.

## Wazuh Kibana plugin

### Added

* Support for Wazuh v4.0.4.

[Release notes](index.html "Previous. Release notes")
[4.0.3 Release notes](release_4_0_3.html "Next. 4.0.3 Release notes")

[Edit on GitHub](https://github.com/wazuh/wazuh-documentation/blob/4.0/source/release-notes/release_4_0_4.rst)

On this page

* 4.0.4 Release notes
  + [Wazuh core](#wazuh-core)
    - [Added](#added)
    - [Changed](#changed)
    - [Fixed](#fixed)
  + [Wazuh Kibana plugin](#wazuh-kibana-plugin)
    - [Added](#id1)

Explore

* [Overview](https://wazuh.com/platform/overview/)
* [XDR](https://wazuh.com/platform/xdr/)
* [SIEM](https://wazuh.com/platform/siem/)

Services

* [Wazuh Cloud](https://wazuh.com/cloud/)
* [Professional support](https://wazuh.com/services/professional-support/)
* [Consulting services](https://wazuh.com/services/consulting-services/)
* [Training courses](https://wazuh.com/services/training-courses/)

Company

* [About us](https://wazuh.com/about-us/)
* [Customers](https://wazuh.com/our-customers/)
* [Partners](https://wazuh.com/partners/)

Documentation

* [Quickstart](https://documentation.wazuh.com/current/quickstart.html)
* [Getting started](https://wazuh.com/current/getting-started/index.html)
* [Installation guide](https://wazuh.com/current/installation-guide/index.html)

Resources

* [Blog](https://wazuh.com/blog/)
* [Community](https://wazuh.com/community/)

© 2024 Wazuh Inc.

[Legal resources](https://wazuh.com/legal-resources/)

[Contact us](https://wazuh.com/contact-us/)

+1 (844) 349 2984

* [X](https://x.com/wazuh "Wazuh on X")
* [LinkedIn](https://www.linkedin.com/company/wazuh "Wazuh on LinkedIn")
* [Reddit](https://www.reddit.com/r/Wazuh/ "Wazuh on Reddit")
* [GitHub](https://github.com/wazuh "Wazuh on Github")
* [Slack](https://wazuh.com/community/join-us-on-slack/ "Join us on Slack")
* Mailing list

Close

=== Content from github.com_7410c9f3_20250114_234102.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Freleases%2Ftag%2Fv4.0.4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Freleases%2Ftag%2Fv4.0.4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=wazuh%2Fwazuh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wazuh](/wazuh)
/
**[wazuh](/wazuh/wazuh)**
Public

* [Notifications](/login?return_to=%2Fwazuh%2Fwazuh) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fwazuh%2Fwazuh)
* [Star
   11.4k](/login?return_to=%2Fwazuh%2Fwazuh)

* [Code](/wazuh/wazuh/tree/v4.0.4)
* [Issues
  2.4k](/wazuh/wazuh/issues)
* [Pull requests
  310](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects
  0](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

Additional navigation options

* [Code](/wazuh/wazuh/tree/v4.0.4)
* [Issues](/wazuh/wazuh/issues)
* [Pull requests](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

1. [Releases](/wazuh/wazuh/releases)
2. [v4.0.4](/wazuh/wazuh/releases/tag/v4.0.4)

# Wazuh v4.0.4

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wazuh/wazuh/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.0.4)

 Loading

[View all tags](/wazuh/wazuh/tags)

![@vikman90](https://avatars.githubusercontent.com/u/10536251?s=40&v=4)
[vikman90](/vikman90)
released this
14 Jan 17:50

·
[20839 commits](/wazuh/wazuh/compare/v4.0.4...master)
to master
since this release

[v4.0.4](/wazuh/wazuh/tree/v4.0.4)

[`e79fcc4`](/wazuh/wazuh/commit/e79fcc448e372e06c83c4d5f45f9e9c36c67b525)

This commit was signed with the committer’s **verified signature**.
The key has expired.

[![](https://avatars.githubusercontent.com/u/10536251?s=64&v=4)](/vikman90)
[vikman90](/vikman90)
Vikman Fernandez-Castro

GPG key ID: 79FB91CF9B36A0A6
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Added

* **API:**
  + Added missing secure headers for API responses. ([#7138](https://github.com/wazuh/wazuh/issues/7138))
  + Added new config option to disable uploading configurations containing remote commands. ([#7134](https://github.com/wazuh/wazuh/issues/7134))
  + Added new config option to choose the SSL ciphers. Default value `TLSv1.2`. ([#7164](https://github.com/wazuh/wazuh/issues/7164))

## Changed

* **API:**
  + Deprecated endpoints to restore and update API configuration file. ([#7132](https://github.com/wazuh/wazuh/issues/7132))
  + Default expiration time of the JWT token set to 15 minutes. ([#7167](https://github.com/wazuh/wazuh/pull/7167))

## Fixed

* **API:**
  + Fixed a path traversal flaw ([CVE-2021-26814](https://nvd.nist.gov/vuln/detail/CVE-2021-26814)) affecting 4.0.0 to 4.0.3 at `/manager/files` and `/cluster/{node_id}/files` endpoints. ([#7131](https://github.com/wazuh/wazuh/issues/7131))
* **Framework:**
  + Fixed a bug with add\_manual(agents) function when authd is disabled. ([#7135](https://github.com/wazuh/wazuh/issues/7135))
* **Core:**
  + Fixed the purge of the Redhat vulnerabilities database before updating it. ([#7133](https://github.com/wazuh/wazuh/pull/7133))

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7bee3ae6_20250115_210335.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7131)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7131)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=wazuh%2Fwazuh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wazuh](/wazuh)
/
**[wazuh](/wazuh/wazuh)**
Public

* [Notifications](/login?return_to=%2Fwazuh%2Fwazuh) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fwazuh%2Fwazuh)
* [Star
   11.4k](/login?return_to=%2Fwazuh%2Fwazuh)

* [Code](/wazuh/wazuh)
* [Issues
  2.4k](/wazuh/wazuh/issues)
* [Pull requests
  310](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects
  0](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

Additional navigation options

* [Code](/wazuh/wazuh)
* [Issues](/wazuh/wazuh/issues)
* [Pull requests](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fwazuh%2Fwazuh%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fwazuh%2Fwazuh%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix /manager/files endpoints #7131

 Merged

[davidjiglesias](/davidjiglesias)
merged 5 commits into
[4.0.4](/wazuh/wazuh/tree/4.0.4 "wazuh/wazuh:4.0.4")
from
[fix-manager-files-endpoints](/wazuh/wazuh/tree/fix-manager-files-endpoints "wazuh/wazuh:fix-manager-files-endpoints")

Jan 10, 2021

 Merged

# [Fix /manager/files endpoints](#top) #7131

[davidjiglesias](/davidjiglesias)
merged 5 commits into
[4.0.4](/wazuh/wazuh/tree/4.0.4 "wazuh/wazuh:4.0.4")
from
[fix-manager-files-endpoints](/wazuh/wazuh/tree/fix-manager-files-endpoints "wazuh/wazuh:fix-manager-files-endpoints")

Jan 10, 2021

[Conversation
0](/wazuh/wazuh/pull/7131)
[Commits
5](/wazuh/wazuh/pull/7131/commits)
[Checks
0](/wazuh/wazuh/pull/7131/checks)
[Files changed](/wazuh/wazuh/pull/7131/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=60&v=4)](/davidjiglesias)

Copy link

Member

### @davidjiglesias **[davidjiglesias](/davidjiglesias)** commented [Jan 10, 2021](#issue-782874260) • edited Loading

Hello team,

This PR fixes regexes for Wazuh API spec and updates unit and integration tests.

**UNIT TEST RESULTS:**

```
Launching pytest with arguments /wazuh/api/api/test/test_validator.py

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/api
plugins: asyncio-0.14.0
collecting ... collected 171 items

============================= 171 passed in 0.44s ==============================

Launching pytest with arguments /wazuh/framework/wazuh/tests/test_cdb_list.py

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 47 items

============================== 47 passed in 0.60s ==============================

Launching pytest with arguments /wazuh/framework/wazuh/rbac/tests/test_auth_context.py

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 2 items

========================= 2 passed, 1 warning in 2.43s =========================

Launching pytest with arguments /wazuh/framework/wazuh/rbac/tests/test_decorators.py in /wazuh/framework/wazuh/rbac/tests

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 105 items

======================== 105 passed in 78.31s (0:01:18) ========================

Launching pytest with arguments /wazuh/framework/wazuh/rbac/tests/test_default_configuration.py in /wazuh/framework/wazuh/rbac/tests

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 47 items

============================= 47 passed in 33.99s ==============================

Launching pytest with arguments /wazuh/framework/wazuh/rbac/tests/test_orm.py in /wazuh/framework/wazuh/rbac/tests

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 53 items

============================= 53 passed in 43.33s ==============================

Launching pytest with arguments /wazuh/framework/wazuh/rbac/tests/test_preprocessor.py in /wazuh/framework/wazuh/rbac/tests

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 11 items

============================== 11 passed in 8.51s ==============================

Launching pytest with arguments /wazuh/framework/wazuh/tests/test_security.py in /wazuh/framework/wazuh/tests

============================= test session starts ==============================
platform linux -- Python 3.8.5, pytest-5.4.3, py-1.9.0, pluggy-0.13.1 -- /home/davidjiglesias/venvs/bin/python
cachedir: .pytest_cache
rootdir: /wazuh/framework
plugins: asyncio-0.14.0
collecting ... collected 69 items

================== 69 passed, 3 warnings in 61.88s (0:01:01) ===================

```

**API INTEGRATION TEST RESULTS:**

```
python3 run_tests.py -l cluster,manager
Collected tests [6]:
test_cluster_endpoints.tavern.yaml, test_manager_endpoints.tavern.yaml, test_rbac_black_cluster_endpoints.tavern.yaml, test_rbac_black_manager_endpoints.tavern.yaml, test_rbac_white_cluster_endpoints.tavern.yaml, test_rbac_white_manager_endpoints.tavern.yaml

test_cluster_endpoints.tavern.yaml
	 54 passed, 1 xpassed, 72 warnings

test_manager_endpoints.tavern.yaml
	 35 passed, 38 warnings

test_rbac_black_cluster_endpoints.tavern.yaml
	 21 passed, 23 warnings

test_rbac_black_manager_endpoints.tavern.yaml
	 19 passed, 21 warnings

test_rbac_white_cluster_endpoints.tavern.yaml
	 21 passed, 23 warnings

test_rbac_white_manager_endpoints.tavern.yaml
	 19 passed, 21 warnings

```

Sorry, something went wrong.

All reactions

 [davidjiglesias](/davidjiglesias)
added 5 commits
[January 9, 2021 17:28](#commits-pushed-f238166)

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias)

`[Fix spec regexes](/wazuh/wazuh/pull/7131/commits/f238166e5df7dfb6a3e6b5787cdfeb447c2c0bdc "Fix spec regexes")`

`[f238166](/wazuh/wazuh/pull/7131/commits/f238166e5df7dfb6a3e6b5787cdfeb447c2c0bdc)`

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias)

`[Add lists .cdb extension to allowed delete_files_path and update tests](/wazuh/wazuh/pull/7131/commits/529218e71005f4534d0927e889cfe439d6a498be "Add lists .cdb extension to allowed delete_files_path and update tests")`

`[529218e](/wazuh/wazuh/pull/7131/commits/529218e71005f4534d0927e889cfe439d6a498be)`

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias)

`[Add cluster integration test cases](/wazuh/wazuh/pull/7131/commits/b69e6cb93cb8743dfb0eb9f3b4217bf8edb0379b "Add cluster integration test cases")`

`[b69e6cb](/wazuh/wazuh/pull/7131/commits/b69e6cb93cb8743dfb0eb9f3b4217bf8edb0379b)`

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias)

`[Add wazuh absolute path validation for custom upgrade file path](/wazuh/wazuh/pull/7131/commits/a814d5814a5584eb70b0827d2f0dd8f3bebadcd1 "Add wazuh absolute path validation for custom upgrade file path")`

`[a814d58](/wazuh/wazuh/pull/7131/commits/a814d5814a5584eb70b0827d2f0dd8f3bebadcd1)`

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias)

`[Disable whitespace in cdb_lists keys](/wazuh/wazuh/pull/7131/commits/c863665e969cacbc688a48f181874c91f662b9c8 "Disable whitespace in cdb_lists keys")`

`[c863665](/wazuh/wazuh/pull/7131/commits/c863665e969cacbc688a48f181874c91f662b9c8)`

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
added
[module/framework](/wazuh/wazuh/labels/module/framework)
[module/api](/wazuh/wazuh/labels/module/api)
labels
[Jan 10, 2021](#event-4188282187)

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
added this to the [Sprint 123 - Framework](/wazuh/wazuh/milestone/98) milestone
[Jan 10, 2021](#event-4188282189)

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
self-assigned this
[Jan 10, 2021](#event-4188282192)

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
merged commit [`1185ecb`](/wazuh/wazuh/commit/1185ecb7604e2b88f114cca2f125a2d3835274a1)
into
4.0.4

[Jan 10, 2021](https://github.com/wazuh/wazuh/pull/7131#event-4188329327)

 [![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
deleted the
fix-manager-files-endpoints

branch
[January 10, 2021 19:06](#event-4188329343)

This was referenced Mar 2, 2022

[Release 4.3.0 - Release Candidate 5 - Manual Testing
wazuh/wazuh-qa#2614](/wazuh/wazuh-qa/issues/2614)

Closed

[Release 4.3.0 - Release Candidate 5 - Manual Testing - Fix /manager/files endpoints
wazuh/wazuh-qa#2617](/wazuh/wazuh-qa/issues/2617)

Closed

[![@Rebits](https://avatars.githubusercontent.com/u/11089305?s=40&v=4)](/Rebits)
[Rebits](/Rebits)
mentioned this pull request
[Apr 18, 2022](#ref-issue-1207179421)

[Release 4.3.0 - Release Candidate 6 - Manual testing patch notes
wazuh/wazuh-qa#2798](/wazuh/wazuh-qa/issues/2798)

Closed

11 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7131)

Reviewers

No reviews

Assignees

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias) [davidjiglesias](/davidjiglesias)

Labels

[module/api](/wazuh/wazuh/labels/module/api)
[module/framework](/wazuh/wazuh/labels/module/framework)

Projects

None yet

Milestone

 [**Sprint 123 - Framework**](/wazuh/wazuh/milestone/98 "Sprint 123 - Framework")

Development

Successfully merging this pull request may close these issues.

1 participant

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=52&v=4)](/davidjiglesias)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d2c225df_20250115_210333.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7167)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7167)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=wazuh%2Fwazuh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wazuh](/wazuh)
/
**[wazuh](/wazuh/wazuh)**
Public

* [Notifications](/login?return_to=%2Fwazuh%2Fwazuh) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fwazuh%2Fwazuh)
* [Star
   11.4k](/login?return_to=%2Fwazuh%2Fwazuh)

* [Code](/wazuh/wazuh)
* [Issues
  2.4k](/wazuh/wazuh/issues)
* [Pull requests
  310](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects
  0](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

Additional navigation options

* [Code](/wazuh/wazuh)
* [Issues](/wazuh/wazuh/issues)
* [Pull requests](/wazuh/wazuh/pulls)
* [Discussions](/wazuh/wazuh/discussions)
* [Actions](/wazuh/wazuh/actions)
* [Projects](/wazuh/wazuh/projects)
* [Wiki](/wazuh/wazuh/wiki)
* [Security](/wazuh/wazuh/security)
* [Insights](/wazuh/wazuh/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fwazuh%2Fwazuh%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fwazuh%2Fwazuh%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Update default auth\_token\_exp\_timeout to 15 minutes. #7167

 Merged

[davidjiglesias](/davidjiglesias)
merged 2 commits into
[4.0.4](/wazuh/wazuh/tree/4.0.4 "wazuh/wazuh:4.0.4")
from
[fix-jwt-token-duration](/wazuh/wazuh/tree/fix-jwt-token-duration "wazuh/wazuh:fix-jwt-token-duration")

Jan 13, 2021

 Merged

# [Update default auth\_token\_exp\_timeout to 15 minutes.](#top) #7167

[davidjiglesias](/davidjiglesias)
merged 2 commits into
[4.0.4](/wazuh/wazuh/tree/4.0.4 "wazuh/wazuh:4.0.4")
from
[fix-jwt-token-duration](/wazuh/wazuh/tree/fix-jwt-token-duration "wazuh/wazuh:fix-jwt-token-duration")

Jan 13, 2021

[Conversation
0](/wazuh/wazuh/pull/7167)
[Commits
2](/wazuh/wazuh/pull/7167/commits)
[Checks
0](/wazuh/wazuh/pull/7167/checks)
[Files changed](/wazuh/wazuh/pull/7167/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Selutario](https://avatars.githubusercontent.com/u/23361101?s=60&v=4)](/Selutario)

Copy link

Contributor

### @Selutario **[Selutario](/Selutario)** commented [Jan 13, 2021](#issue-785015142)

| Related issue |
| --- |
| Closes [#7163](https://github.com/wazuh/wazuh/issues/7163) |

## Description

Hi team!

This PR updates the default expiration timeout of the API JWT tokens.

## Tests results

### QA exp\_timeout

```
python3 -m pytest integration/test_api/test_config/test_jwt_token_exp_timeout/
============================================================================================ test session starts =============================================================================================
platform linux -- Python 3.8.2, pytest-6.2.1, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: html-3.1.1, testinfra-5.0.0, metadata-1.11.0, tavern-1.12.2, cov-2.10.1
collected 4 items

integration/test_api/test_config/test_jwt_token_exp_timeout/test_jwt_token_exp_timeout.py .ss.                                                                                                         [100%]

================================================================================= 2 passed, 2 skipped, 3 warnings in 47.60s ==================================================================================

```
### Unittests

#### API

```
python3 -m pytest api/api/test/ --disable-warnings
============================================================================================ test session starts =============================================================================================
platform linux -- Python 3.8.5, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
rootdir: /home/selu/Git/wazuh/api
plugins: trio-0.6.0, asyncio-0.14.0
collected 231 items

api/api/test/test_alogging.py ........                                                                                                                                                                 [  3%]
api/api/test/test_authentication.py ..........                                                                                                                                                         [  7%]
api/api/test/test_configuration.py .......                                                                                                                                                             [ 10%]
api/api/test/test_util.py ...................................                                                                                                                                          [ 25%]
api/api/test/test_validator.py ....................................................................................................................................................................... [ 98%]
....                                                                                                                                                                                                   [100%]

====================================================================================== 231 passed, 14 warnings in 0.98s ======================================================================================

```

Regards,

Selu.

Sorry, something went wrong.

All reactions

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&v=4)](/Selutario)

`[Update default auth_token_exp_timeout to 15 minutes.](/wazuh/wazuh/pull/7167/commits/fd24ad52a6f191e9e3c110218253a36645446990 "Update default auth_token_exp_timeout to 15 minutes.")`

`[fd24ad5](/wazuh/wazuh/pull/7167/commits/fd24ad52a6f191e9e3c110218253a36645446990)`

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&u=97670ea12bd5f4a9e9fa6f1cdf4a1d0169af6724&v=4)](/Selutario)
[Selutario](/Selutario)
self-assigned this
[Jan 13, 2021](#event-4200694935)

 [![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&u=97670ea12bd5f4a9e9fa6f1cdf4a1d0169af6724&v=4)](/Selutario)
[Selutario](/Selutario)
requested a review
from [davidjiglesias](/davidjiglesias)
[January 13, 2021 11:16](#event-4200697709)

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&u=97670ea12bd5f4a9e9fa6f1cdf4a1d0169af6724&v=4)](/Selutario)
[Selutario](/Selutario)
linked an issue
[Jan 13, 2021](#event-4200698800)
that may be
closed
by this pull request

[Set JWT default duration to 15 minutes
#7163](/wazuh/wazuh/issues/7163)

Closed

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&v=4)](/Selutario)

`[Update changelog.md](/wazuh/wazuh/pull/7167/commits/59b4b45c548224be0c8b22cea31621211cc4e03d "Update changelog.md")`

`[59b4b45](/wazuh/wazuh/pull/7167/commits/59b4b45c548224be0c8b22cea31621211cc4e03d)`

[![davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=60&v=4)](/davidjiglesias)

**[davidjiglesias](/davidjiglesias)**
approved these changes
[Jan 13, 2021](#pullrequestreview-567164845)

 [View reviewed changes](/wazuh/wazuh/pull/7167/files/59b4b45c548224be0c8b22cea31621211cc4e03d)

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
merged commit [`b8c47b0`](/wazuh/wazuh/commit/b8c47b06426134c2ae1e2b693c7463c2339c6b65)
into
4.0.4

[Jan 13, 2021](https://github.com/wazuh/wazuh/pull/7167#event-4200928756)

 [![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&u=04b899fc140d95736acfc74a175c0540246b1756&v=4)](/davidjiglesias)
[davidjiglesias](/davidjiglesias)
deleted the
fix-jwt-token-duration

branch
[January 13, 2021 12:17](#event-4200928811)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fwazuh%2Fwazuh%2Fpull%2F7167)

Reviewers

[![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=40&v=4)](/davidjiglesias) [davidjiglesias](/davidjiglesias)

davidjiglesias approved these changes

Assignees

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=40&v=4)](/Selutario) [Selutario](/Selutario)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Set JWT default duration to 15 minutes](https://github.com/wazuh/wazuh/issues/7163)

2 participants

[![@Selutario](https://avatars.githubusercontent.com/u/23361101?s=52&v=4)](/Selutario) [![@davidjiglesias](https://avatars.githubusercontent.com/u/48716145?s=52&v=4)](/davidjiglesias)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


