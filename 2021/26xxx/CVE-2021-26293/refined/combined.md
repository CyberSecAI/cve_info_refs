=== Content from auroramail.wordpress.com_96d06c9e_20250114_214249.html ===

[Skip to content](#content)
[![Aurora, WebMail, MailSuite](https://auroramail.wordpress.com/wp-content/uploads/2017/05/cropped-afterlogic-aurora.png)](https://auroramail.wordpress.com/)

[Aurora, WebMail, MailSuite](https://auroramail.wordpress.com/)

Web-based solutions from AfterLogic

Menu

# Addressing DAV-related vulnerability in WebMail and Aurora

[February 3, 2021March 25, 2021](https://auroramail.wordpress.com/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/) ~ [auroramail](https://auroramail.wordpress.com/author/auroramail/)

One of our valued customers reported a vulnerability in our products, that potentially allows uploading and executing arbitrary files via built-in DAV server used in [WebMail Pro](https://afterlogic.com/webmail-client) and [Aurora Corporate](https://afterlogic.com/aurora). We’re now releasing updates for our products closing this vulnerability, and strongly recommend to upgrade your installations to the latest version.

Below, you’ll find recommendations on how to address the issue on your existing installation of WebMail Pro or Aurora. Please note that while these changes were only tested with version 8.5.3, they should work for previous versions as well.

Before we proceed, we’d like to point out that disabling DAV access on the installation effectively closes the vulnerability, too. That’s done by setting **Disabled** to **true** in data/settings/modules/Dav.config.json file. Note that this will not affect the use of web interface or Aurora Mail / Aurora Files mobile apps as they work via API, not DAV. If you’d rather keep DAV enabled, please follow the below guidelines.

1. In vendor/afterlogic/dav/lib/DAVServer.php file, locate function **exec**() and replace its code with:

```

public function exec()
{
    $sRequestUri = empty($_SERVER['REQUEST_URI']) ? '' : \trim($_SERVER['REQUEST_URI']);

    if ($this->isModuleEnabled('Dav') && !strpos(urldecode($sRequestUri), '../'))
    {
        parent::exec();
    }
    else
    {
        echo 'Access denied';
    }
}

```

2. In vendor/afterlogic/dav/lib/DAV/Auth/Backend/Basic.php file, locate **validateUserPass** function and replace the line:

```

if (class_exists('\\Aurora\\System\\Api') && \Aurora\System\Api::IsValid())

```
```
with:
```
```

if (class_exists('\\Aurora\\System\\Api') && \Aurora\System\Api::IsValid() && $sUserName !== \Afterlogic\DAV\Constants::DAV_PUBLIC_PRINCIPAL && $sUserName !== \Afterlogic\DAV\Constants::DAV_TENANT_PRINCIPAL)

```

3. Similarly, in vendor/afterlogic/dav/lib/DAV/Auth/Backend/Digest.php file, locate **getDigestHash** function and replace the line:

```

if (class_exists('\\Aurora\\System\\Api') && \Aurora\System\Api::IsValid())

```

with:

```

if (class_exists('\\Aurora\\System\\Api') && \Aurora\System\Api::IsValid() && $sUserName !== \Afterlogic\DAV\Constants::DAV_PUBLIC_PRINCIPAL && $sUserName !== \Afterlogic\DAV\Constants::DAV_TENANT_PRINCIPAL)

```

Since some of our clients still use previous v7 of WebMail and Aurora, we chose to issue a security update for those as well. Note that if you don’t use DAV, you can simply disable it by setting **EnableMobileSync** to **Off** in data/settings/settings.xml file.

1. In libraries/afterlogic/DAV/Server.php file, before the closing “}” add the following function:

```

public function exec()
{
    $sRequestUri = empty($_SERVER['REQUEST_URI']) ? '' : \trim($_SERVER['REQUEST_URI']);
    if (!strpos(urldecode($sRequestUri), '../'))
    {
        parent::exec();
    }
    else
    {
        echo 'Access denied';
    }
}

```

2. In libraries/afterlogic/DAV/Auth/Backend/Basic.php file, locate **validateUserPass** function and replace the line:

```

if (class_exists('CApi') && \CApi::IsValid())

```

with:

```

if (class_exists('CApi') && \CApi::IsValid() && $sUserName !== \afterlogic\DAV\Constants::DAV_PUBLIC_PRINCIPAL && $sUserName !== \afterlogic\DAV\Constants::DAV_TENANT_PRINCIPAL)

```

3. Similarly, in libraries/afterlogic/DAV/Auth/Backend/Digest.php file, locate **getDigestHash** function and replace the line:

```

if (class_exists('CApi') && \CApi::IsValid())

```

with:

```

if (class_exists('CApi') && \CApi::IsValid() && $sUserName !== \afterlogic\DAV\Constants::DAV_PUBLIC_PRINCIPAL && $sUserName !== \afterlogic\DAV\Constants::DAV_TENANT_PRINCIPAL)

```

Should you require any assistance, please don’t hesitate to [contact us](https://s.afterlogic.com/helpdesk/).

### Share this:

* [Twitter](https://auroramail.wordpress.com/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/?share=twitter "Click to share on Twitter")
* [Facebook](https://auroramail.wordpress.com/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

## Post navigation

[‹ PreviousUsing DAV sync on cPanel](https://auroramail.wordpress.com/2020/11/11/using-dav-sync-on-cpanel/)[Next ›ClamAV antivirus update for v7 of MailSuite/Aurora](https://auroramail.wordpress.com/2021/03/12/clamav-antivirus-update-for-v7-of-mailsuite-aurora/)

### Leave a comment [Cancel reply](/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/#respond)

Δ

# Recent Posts

* [Afterlogic WebMail on CyberPanel – with password change](https://auroramail.wordpress.com/2023/03/31/afterlogic-webmail-on-cyberpanel-with-password-change-feature/)
  March 31, 2023
* [Docker images update for Afterlogic products](https://auroramail.wordpress.com/2022/09/08/docker-images-update-for-afterlogic-products/)
  September 8, 2022
* [Installing CentOS 8 Linux for running MailSuite Pro or Aurora Corporate](https://auroramail.wordpress.com/2022/04/20/installing-centos-8-linux-for-running-mailsuite-pro-or-aurora-corporate/)
  April 20, 2022
* [Message sorting in Afterlogic WebMail and Aurora Corporate](https://auroramail.wordpress.com/2022/03/03/message-sorting-in-afterlogic-webmail-and-aurora-corporate/)
  March 3, 2022
* [Mailing lists issue in MailSuite Pro / Aurora MTA](https://auroramail.wordpress.com/2021/07/29/mailing-lists-issue-in-mailsuite-pro-aurora-mta/)
  July 29, 2021
* [Nextcloud integration revised](https://auroramail.wordpress.com/2021/04/15/nextcloud-integration-revised/)
  April 15, 2021
* [Office files viewer in Afterlogic WebMail and Aurora](https://auroramail.wordpress.com/2021/04/01/office-files-viewer-in-afterlogic-webmail-and-aurora/)
  April 1, 2021
* [ClamAV antivirus update for v7 of MailSuite/Aurora](https://auroramail.wordpress.com/2021/03/12/clamav-antivirus-update-for-v7-of-mailsuite-aurora/)
  March 12, 2021

# Search

Search for:

# Archives

* [March 2023](https://auroramail.wordpress.com/2023/03/)
* [September 2022](https://auroramail.wordpress.com/2022/09/)
* [April 2022](https://auroramail.wordpress.com/2022/04/)
* [March 2022](https://auroramail.wordpress.com/2022/03/)
* [July 2021](https://auroramail.wordpress.com/2021/07/)
* [April 2021](https://auroramail.wordpress.com/2021/04/)
* [March 2021](https://auroramail.wordpress.com/2021/03/)
* [February 2021](https://auroramail.wordpress.com/2021/02/)
* [November 2020](https://auroramail.wordpress.com/2020/11/)
* [August 2020](https://auroramail.wordpress.com/2020/08/)
* [November 2019](https://auroramail.wordpress.com/2019/11/)
* [October 2019](https://auroramail.wordpress.com/2019/10/)
* [September 2019](https://auroramail.wordpress.com/2019/09/)
* [June 2019](https://auroramail.wordpress.com/2019/06/)
* [February 2019](https://auroramail.wordpress.com/2019/02/)
* [January 2019](https://auroramail.wordpress.com/2019/01/)
* [December 2018](https://auroramail.wordpress.com/2018/12/)
* [October 2018](https://auroramail.wordpress.com/2018/10/)
* [September 2018](https://auroramail.wordpress.com/2018/09/)
* [July 2018](https://auroramail.wordpress.com/2018/07/)
* [April 2018](https://auroramail.wordpress.com/2018/04/)
* [January 2018](https://auroramail.wordpress.com/2018/01/)
* [December 2017](https://auroramail.wordpress.com/2017/12/)
* [October 2017](https://auroramail.wordpress.com/2017/10/)
* [September 2017](https://auroramail.wordpress.com/2017/09/)
* [August 2017](https://auroramail.wordpress.com/2017/08/)
* [May 2017](https://auroramail.wordpress.com/2017/05/)

* [Facebook](https://www.facebook.com/afterlogic)
* [Twitter](https://twitter.com/afterlogic)
* [Contact](https://afterlogic.com/contact)

[Website Powered by WordPress.com](https://wordpress.com/?ref=footer_custom_powered).

* [Comment](https://auroramail.wordpress.com/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://auroramail.wordpress.com/wp-content/uploads/2017/05/cropped-afterlogic-aurora.png?w=50) Aurora, WebMail, MailSuite](https://auroramail.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fauroramail.wordpress.com%2F2021%2F02%2F03%2Faddressing-dav-related-vulnerability-in-webmail-and-aurora%2F&signup_flow=account)
* Privacy
* + [![](https://auroramail.wordpress.com/wp-content/uploads/2017/05/cropped-afterlogic-aurora.png?w=50) Aurora, WebMail, MailSuite](https://auroramail.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fauroramail.wordpress.com%2F2021%2F02%2F03%2Faddressing-dav-related-vulnerability-in-webmail-and-aurora%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p8MlR1-5J)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://auroramail.wordpress.com/2021/02/03/addressing-dav-related-vulnerability-in-webmail-and-aurora/)
  + [View post in Reader](https://wordpress.com/read/blogs/129734443/posts/355)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


