```json
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from insufficient sanitization of user-controlled input within the `bbcode_imgs` and `bbcode_emails` functions, which are used to process BBCode tags such as `[img]` and `[email]`. The vulnerability lies in how URLs within these tags are handled before being rendered in HTML. Specifically, the function `bbcode_out()` which was meant to sanitize, was not doing so properly.",
    "weaknesses": [
      "Improper neutralization of input during web page generation ('Cross-site Scripting')",
      "Improper neutralization of special elements used in an SQL command ('SQL Injection')"
    ],
    "impact": "An attacker could inject arbitrary HTML, including JavaScript code, into the page by crafting malicious URLs within the `[img]` and `[email]` BBCode tags. This could lead to Cross-Site Scripting (XSS) attacks, where the attacker could execute malicious scripts in the context of a user's browser.  This could also lead to SQL injection if a malicious URL is constructed that way.",
    "attack_vectors": "An attacker can exploit the vulnerability by injecting a specially crafted BBCode tag within forum posts, private messages, or any other area that renders BBCode.  Since the vulnerability is in the parsing and output of the data, the injection point is not specifically a single form input field but anywhere where the BBCode parsing occurs, and renders user supplied data.",
    "required_capabilities": "An attacker needs to be able to post content on the forum, and no special privileges are required. The attacker does not need to be authenticated."
  },
  "cve": "CVE-2021-29399",
  "additional_details": {
      "patch_information": "The vulnerability is fixed in XMB version 1.9.12.03 and later. A patch is also available for 1.9.11.16"
    }
}
```