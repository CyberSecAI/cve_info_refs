=== Content from www.mozilla.org_a49fdb21_20250115_081449.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-18

## Security Vulnerabilities fixed in Firefox ESR 78.10.1

Announced
May 4, 2021
Impact
moderate
Products
Firefox ESR
Fixed in

* Firefox ESR 78.10.1

#### [#CVE-2021-29951: Mozilla Maintenance Service could have been started or stopped by domain users](#CVE-2021-29951)

Reporter
James Forshaw
Impact
moderate
##### Description

The Mozilla Maintenance Service granted SERVICE\_START access to `BUILTIN|Users` which, in a domain network, grants normal remote users access to start or stop the service. This could be used to prevent the browser update service from operating (if an attacker spammed the 'Stop' command); but also exposed attack surface in the maintenance service.
*Note: This issue only affected Windows operating systems older than Win 10 build 1709. Other operating systems are unaffected.*

##### References

* [Bug 1690062](https://bugzilla.mozilla.org/show_bug.cgi?id=1690062)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e63c0314_20250115_081447.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1690062)
* [XML](/show_bug.cgi?ctype=xml&id=1690062)

Closed
[Bug 1690062](/show_bug.cgi?id=1690062)
(CVE-2021-29951)

Opened 4 years ago
Closed 4 years ago

# Windows Maintenance Service has a Weak DACL for Domain Networks

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Windows Maintenance Service has a Weak DACL for Domain Networks

## Categories

### (Toolkit :: Application Update, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox87 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 88+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox87 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: forshaw, Assigned: bytesized)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/96e4252ea3aebe64d73acae0a509f240?d=mm&size=40)  [bytesized](/user_profile?user_id=563604)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5f639fae9daed646889e64c874cbf5b6?d=mm&size=40)  [forshaw](/user_profile?user_id=540730)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### ( [URL](https://bugs.chromium.org/p/project-zero/issues/detail?id=2148 "https://bugs.chromium.org/p/project-zero/issues/detail?id=2148") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bugs.chromium.org/p/project-zero/issu...](https://bugs.chromium.org/p/project-zero/issues/detail?id=2148 "https://bugs.chromium.org/p/project-zero/issues/detail?id=2148")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [Disclosure deadline 2021-05-03] Could lead to system RCE if combined with other bugs)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29951

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[Disclosure deadline 2021-05-03] Could lead to system RCE if combined with other bugs

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#c14 "4 years ago") | ? |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [poc.cpp](/attachment.cgi?id=9200493)  [4 years ago](#c0)  [James Forshaw](/user_profile?user_id=540730)   1.50 KB, text/plain |  | [Details](/attachment.cgi?id=9200493&action=edit) |
| --- | --- | --- |
| [Bug 1690062 - r=agashlin](/attachment.cgi?id=9203564)  [4 years ago](#c4)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c17 "4 years ago") | [Details](/attachment.cgi?id=9203564&action=edit) | [Review](/attachment.cgi?id=9203564) |
| [Bug 1690062 - Test to ensure the Maintenance Service can only be started by interactive users r=agashlin](/attachment.cgi?id=9203565)  [4 years ago](#c5)  [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9203565&action=edit) | [Review](/attachment.cgi?id=9203565) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1690062#c0)• 4 years ago |
|  | |

Attached file
[poc.cpp](attachment.cgi?id=9200493)
— [Details](attachment.cgi?id=9200493&action=edit)

## Summary:

The Mozilla Maintenance service on Windows is configured to allow *BUILTIN\Users* *SERVICE\_START* access which can be granted to normal remote users on domain networks allowing them to start the service remotely and pass arbitrary arguments to its service main.

## Description:

Note, it’s not clear how much you care about this behavior, and perhaps it’s intentional? Up to you whether you fix it I guess, however I would highly recommend it.

In domain environments (less so in home networks) most users can authenticate to any other workstation or server. One commonly remotely exposed service is the Service Control Manager which manages the local services. A non-administrator can be granted access to a service as long as they can pass a series of access checks.

Basically when installing the maintenance service’s security descriptor in [serviceinstall.cpp](https://searchfox.org/mozilla-central/source/toolkit/components/maintenanceservice/serviceinstall.cpp#691) you grant *BUILTIN\Users* group *SERVICE\_START* and *SERVICE\_STOP* access. As this group is granted to all authenticated users including remote ones this means any remote user can start and stop the maintenance service. This is a risk as the start operation takes a command line which is used to influence the update operation, and has been a source of numerous bugs in the past. While there might not be any known bugs in the handling of arguments atm, is this something you want to risk? If such a bug was found then you could have SYSTEM RCE on domain networks.

Now, this isn’t quite as bad as it might be. For a start I’m guessing some enterprises don’t install the service and rely on their own installation mechanisms and this assumes the service is exposed remotely through the firewall on a host. Also since Windows 10 1709 a mitigation has been in place to prevent remote users not in the local admin group from getting access to certain SCM and service access rights. This is described in a [support article](https://support.microsoft.com/en-us/topic/block-remote-callers-who-are-not-local-administrators-from-starting-stopping-services-c5f77f8e-09e6-57e6-72d1-2c4423627a24). This blocks a normal user getting *SERVICE\_START* access but this hasn’t been back ported to Windows 7 or 8.X which you still support so they would be vulnerable, and it's possible to disable the mitigation which some sysadmins might do.

My recommended fix is to use the *NT AUTHORITY\INTERACTIVE* group instead of the *BUILTIN\Users*. This group is only granted to interactive logins (which includes RDP logins), not network logins, which is presumably the behavior you want? Replacing the line in serviceinstall.cpp `CreateWellKnownSid(WinBuiltinUsersSid, nullptr, sid, &SIDSize)` with `CreateWellKnownSid(WinInteractiveSid, nullptr, sid, &SIDSize)` should be sufficient.

## Proof of Concept:

I’ve provided a proof of concept as a C++ file which will access the local SCM over a TCP RPC connection which simulates remote access. It also disables the *INTERACTIVE* group from the caller’s token to ensure it’s not inadvertently getting access using that, this is needed as it’ll actually use the same token and not do a full network authentication but the same result has been tested remotely. You’ll need to put the C++ file into a project and compile it.

For reasons already outlined you’ll need to run this on Windows 7 or 8.1 as recent versions of Windows 10 have a mitigation to block this attack vector. Although if you want to test on Windows 10 read the previous link for the registry key settings to disable the mitigation.

1. Compile the C++ project.
2. Run the POC on Windows 7 or 8.1 with the maintenance service installed.
3. Observe the output, if it prints *[SUCCESS]* it should have been granted *SERVICE\_START* access.

### Expected Result:

The *OpenService* call fails with *ERROR\_ACCESS\_DENIED*.

### Observed Result:

The *OpenService* call succeeds.

This bug is subject to a 90 day disclosure deadline. After 90 days elapse,

the bug report will become visible to the public. The scheduled disclosure

date is 2021-05-03. Disclosure at an earlier date is also possible if

agreed upon by all parties.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1690062#a989_159069)• 4 years ago |

Component: General → Application UpdateProduct: Firefox → Toolkit

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1690062#c1)• 4 years ago |
|  | |

Rachel: who on your team is working on the maintenance service these days? This could be super bad if combined with another bug.

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(rtublitz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Whiteboard: [Disclosure deadline 2021-05-03] Could lead to system RCE if combined with other bugs

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1690062#c2)• 4 years ago |
|  | |

I'll look into it.

Assignee: nobody → ksteuberFlags: needinfo?(rtublitz)

|  | [Rachel Tublitz [:rachel]](/user_profile?user_id=646733) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1690062#c3)• 4 years ago |
|  | |

thank you Kirk!

Priority: -- → P1

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1690062#c4)• 4 years ago |
|  | |

Attached file
[Bug 1690062 - r=agashlin](attachment.cgi?id=9203564)
— [Details](attachment.cgi?id=9203564&action=edit)

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1690062#c5)• 4 years ago |
|  | |

Attached file
[Bug 1690062 - Test to ensure the Maintenance Service can only be started by interactive users r=agashlin](attachment.cgi?id=9203565)
— [Details](attachment.cgi?id=9203565&action=edit)

Depends on D105382

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1690062#c6)• 4 years ago |
|  | |

Even though this is not a sec-high or sec-critical bug, I'm going to wait to merge the tests. So let's keep this bug open.

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1690062#c7)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/89cb4083e3104c80036119edb4febd136de7091b>

<https://hg.mozilla.org/mozilla-central/rev/89cb4083e310>

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1690062#c8)• 4 years ago |
|  | |

What is the plan for when this fix will be released? As mentioned in the original report the 90 day deadline ends on 2021-05-03 where the issue will disclosed if a patch is not available. There is the option of a 14 day grace extension as long as the patch will be released within that time window.

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1690062#c9)• 4 years ago |
|  | |

The fix was landed in Firefox 87, which became the release version of Firefox on 2021-03-23.

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1690062#c10)• 4 years ago |
|  | |

Great, I didn't notice anything in the release notes. Was this assigned a CVE? Also for interests sake at the same time I discovered that the mitigation Microsoft added to the SCM which I mentioned in the report was bypassable. They fixed the issue this month <https://bugs.chromium.org/p/project-zero/issues/detail?id=2147>.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1690062#c11)• 4 years ago |
|  | |

This shouldn't have been left open just for landing tests. We need to figure out what to do for ESR now since the next scheduled release doesn't go out until June 1.

Status: NEW → RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F)Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)Resolution: --- → FIXEDTarget Milestone: --- → 87 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1690062#c12)• 4 years ago |
|  | |

And we'll need to amend the Fx87 advisories once that gets sorted.

Kirk, please request ESR78 approval on this. It grafts cleanly as-landed.

Group: firefox-core-security → core-security-releaseFlags: needinfo?(ksteuber)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1690062#c13)• 4 years ago |
|  | |

(In reply to Kirk Steuber (he/him) [:bytesized] from [comment #6](/show_bug.cgi?id=1690062#c6 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks"))

> Even though this is not a sec-high or sec-critical bug, I'm going to wait to merge the tests. So let's keep this bug open.

Kirk: PLEASE don't do that. If the bug is fixed please mark it fixed, *especially* for a security bug. That will kick off our advisory and CVE assigning process, testing, and all the rest of the release stuff we need to do. Landing tests later for security bugs is important because [people do look to turn those into exploits](https://blog.exodusintel.com/2019/09/09/patch-gapping-chrome/), so thank you for that! But for managing that later check-in after marking the bug fixed your two choices should be:

1. set the `in-testsuite` flag to "?" to indicate tests aren't landed yet. (reminder to yourself, or eventually someone will nag you about it)
2. clone this into a "land tests for [bug 1690062](/show_bug.cgi?id=1690062 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks")" task bug.

I'll go with the `in-testsuite?` flag for now but if you want to clone a bug instead please do so and clear the flag here.

Note: we also need this fix on ESR 78

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1690062#c14)• 4 years ago |
|  | |

Tom: we'll need a CVE here and an update to the 87 advisories. We'll want to wait on pushing the advisory update until we know what we're doing with ESR 78 (push a mid-cycle release to meet the disclosure deadline? wait for current schedule?)

[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F) → [89+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=89%2B)Flags: needinfo?(tom)Flags: in-testsuite?

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1690062#c15)• 4 years ago |
|  | |

Comment on [attachment 9203564](/attachment.cgi?id=9203564 "Bug 1690062 - r=agashlin") [[details]](/attachment.cgi?id=9203564&action=edit "Bug 1690062 - r=agashlin")

[Bug 1690062](/show_bug.cgi?id=1690062 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks") - r=agashlin

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: If unpatched, could be combined with other exploits to form an exploit chain.
* **User impact if declined**: If unpatched, could be combined with other exploits to form an exploit chain.
* **Fix Landed on Version**: 87
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: This is a bit risky because it deals with changing Windows permissions, which are complicated to get right, and can have serious implications if they are wrong. As far as I know, the only alternative is to leave this unpatched.
* **String or UUID changes made by this patch**:
Flags: needinfo?(ksteuber)
[Attachment #9203564](/attachment.cgi?id=9203564&action=edit "Bug 1690062 - r=agashlin") -
Flags: approval-mozilla-esr78?

|  | [Robin Steuber (she/her) [:bytesized]](/user_profile?user_id=563604)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1690062#c16)• 4 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #13](/show_bug.cgi?id=1690062#c13 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks"))

> (In reply to Kirk Steuber (he/him) [:bytesized] from [comment #6](/show_bug.cgi?id=1690062#c6 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks"))
>
> > Even though this is not a sec-high or sec-critical bug, I'm going to wait to merge the tests. So let's keep this bug open.
>
> Kirk: PLEASE don't do that. If the bug is fixed please mark it fixed, *especially* for a security bug. That will kick off our advisory and CVE assigning process, testing, and all the rest of the release stuff we need to do.

I wish I had known that before today. I read the [Security Bug Approval Process](https://firefox-source-docs.mozilla.org/bug-mgmt/processes/security-approval.html#on-requesting-sec-approval) document, and did my best to follow it. My apologies for getting it wrong.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1690062#c17)• 4 years ago |
|  | |

Comment on [attachment 9203564](/attachment.cgi?id=9203564 "Bug 1690062 - r=agashlin") [[details]](/attachment.cgi?id=9203564&action=edit "Bug 1690062 - r=agashlin")

[Bug 1690062](/show_bug.cgi?id=1690062 "RESOLVED FIXED - Windows Maintenance Service has a Weak DACL for Domain Networks") - r=agashlin

Approved for 78.11esr. I'm also going to reset the ESR tracking flag in case we end up shipping this in a 78.10.1 dot release before then.

[Attachment #9203564](/attachment.cgi?id=9203564&action=edit "Bug 1690062 - r=agashlin") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1690062#c18)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/9efd42e1e29d>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[89+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=89%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1690062#c19)• 4 years ago |
| uplift | |

Fixed for 78.10.1esr also.

<https://hg.mozilla.org/releases/mozilla-esr78/rev/cdde52e57ff2>

[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F) → [88+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=88%2B)Flags: needinfo?(tom)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1690062#c20)• 4 years ago |
|  | |

The Project Zero issue tracker will be opened today as the 90 days have expired (<https://bugs.chromium.org/p/project-zero/issues/detail?id=2148>) I'll mention it was fixed in FF87 and that it'll be fixed in 78.10.1esr. When is the ESR set for release?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1690062#c21)• 4 years ago |
|  | |

We're shipping Wednesday or Thursday -- can we have a couple more days?

Flags: needinfo?(forshaw)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1690062#c22)• 4 years ago |
|  | |

If the final patch date will be definitely within the next 14 days, I can apply a grace extension. If that's the case here then I can apply it for your.

Flags: needinfo?(forshaw)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1690062#a7856845_578488)• 4 years ago |

Alias: CVE-2021-29951

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1690062#c23)• 4 years ago |
|  | |

We will definitely be shipping the ESR fix this week.

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1690062#c24)• 4 years ago |
|  | |

Thanks. I've applied the grace period to the deadline so the issue won't be opened today. It'll give until 2021/05/17.

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1690062#c25)• 4 years ago |
|  | |

For info, as the fixes seems to have gone out I've opened the bug in our issues tracker. <https://bugs.chromium.org/p/project-zero/issues/detail?id=2148>

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1690062#a8517405_580382)• 4 years ago |

URL: [https://bugs.chromium.org/p/project-z...](https://bugs.chromium.org/p/project-zero/issues/detail?id=2148)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1690062#a25448869_1689)• 3 years ago |

Group: core-security-release

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1690062#c26)• 3 years ago |
|  | |

Pushed by ksteuber@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/55a4243e57c9>
Test to ensure the Maintenance Service can only be started by interactive users r=agashlin

|  | [Iulian Moraru](/user_profile?user_id=682863) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1690062#c27)• 3 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/55a4243e57c9>

You need to [log in](/show_bug.cgi?id=1690062&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Forshaw](/user_profile?user_id=540730)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3b796b51_20250115_081448.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-10

## Security Vulnerabilities fixed in Firefox 87

Announced
March 23, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 87

**Note**: This advisory was updated May 3, 2021 to include CVE-2021-29951 and again on June 8, 2021 to include CVE-2021-29955 - both were also fixed in this release.

#### [#CVE-2021-29955: Transient Execution Vulnerability allowed leaking arbitrary memory address](#CVE-2021-29955)

Reporter
Hany Ragab, Enrico Barberis, Herbert Bos, and Cristiano Giuffrida from the VUSec group at VU Amsterdam
Impact
high
##### Description

A transient execution vulnerability, named Floating Point Value Injection (FPVI) allowed an attacker to leak arbitrary memory addresses and may have also enabled JIT type confusion attacks. (A related vulnerability, Speculative Code Store Bypass (SCSB), did not affect Firefox.)

##### References

* [Bug 1692972](https://bugzilla.mozilla.org/show_bug.cgi?id=1692972)

#### [#CVE-2021-23981: Texture upload into an unbound backing buffer resulted in an out-of-bound read](#CVE-2021-23981)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A texture upload of a Pixel Buffer Object could have confused the WebGL code to skip binding the buffer used to unpack it, resulting in memory corruption and a potentially exploitable information leak or crash.

##### References

* [Bug 1692832](https://bugzilla.mozilla.org/show_bug.cgi?id=1692832)

#### [#CVE-2021-29951: Mozilla Maintenance Service could have been started or stopped by domain users](#CVE-2021-29951)

Reporter
James Forshaw
Impact
moderate
##### Description

The Mozilla Maintenance Service granted SERVICE\_START access to `BUILTIN|Users` which, in a domain network, grants normal remote users access to start or stop the service. This could be used to prevent the browser update service from operating (if an attacker spammed the 'Stop' command); but also exposed attack surface in the maintenance service.
*Note: This issue only affected Windows operating systems older than Win 10 build 1709. Other operating systems are unaffected.*

##### References

* [Bug 1690062](https://bugzilla.mozilla.org/show_bug.cgi?id=1690062)

#### [#CVE-2021-23982: Internal network hosts could have been probed by a malicious webpage](#CVE-2021-23982)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Using techniques that built on the slipstream research, a malicious webpage could have scanned both an internal network's hosts as well as services running on the user's local machine utilizing WebRTC connections.

##### References

* [Bug 1677046](https://bugzilla.mozilla.org/show_bug.cgi?id=1677046)

#### [#CVE-2021-23983: Transitions for invalid ::marker properties resulted in memory corruption](#CVE-2021-23983)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

By causing a transition on a parent node by removing a CSS rule, an invalid property for a marker could have been applied, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1692684](https://bugzilla.mozilla.org/show_bug.cgi?id=1692684)

#### [#CVE-2021-23984: Malicious extensions could have spoofed popup information](#CVE-2021-23984)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious extension could have opened a popup window lacking an address bar. The title of the popup lacking an address bar should not be fully controllable, but in this situation was. This could have been used to spoof a website and attempt to trick the user into providing credentials.

##### References

* [Bug 1693664](https://bugzilla.mozilla.org/show_bug.cgi?id=1693664)

#### [#CVE-2021-23985: Devtools remote debugging feature could have been enabled without indication to the user](#CVE-2021-23985)

Reporter
Anonymous working with Trend Micro's Zero Day Initiative
Impact
low
##### Description

If an attacker is able to alter specific about:config values (for example malware running on the user's computer), the Devtools remote debugging feature could have been enabled in a way that was unnoticable to the user. This would have allowed a remote attacker (able to make a direct network connection to the victim) to monitor the user's browsing activity and (plaintext) network traffic. This was addressed by providing a visual cue when Devtools has an open network socket.

##### References

* [Bug 1659129](https://bugzilla.mozilla.org/show_bug.cgi?id=1659129)

#### [#CVE-2021-23986: A malicious extension could have performed credential-less same origin policy violations](#CVE-2021-23986)

Reporter
Armin Ebert
Impact
low
##### Description

A malicious extension with the 'search' permission could have installed a new search engine whose favicon referenced a cross-origin URL. The response to this cross-origin request could have been read by the extension, allowing a same-origin policy bypass by the extension, which should not have cross-origin permissions. This cross-origin request was made without cookies, so the sensitive information disclosed by the violation was limited to local-network resources or resources that perform IP-based authentication.

##### References

* [Bug 1692623](https://bugzilla.mozilla.org/show_bug.cgi?id=1692623)

#### [#CVE-2021-23987: Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](#CVE-2021-23987)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Matthew Gregan, Tyson Smith, Julien Wajsberg, and Alexis Beingessner reported memory safety bugs present in Firefox 86 and Firefox ESR 78.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 87 and Firefox ESR 78.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1513519%2C1683439%2C1690169%2C1690718)

#### [#CVE-2021-23988: Memory safety bugs fixed in Firefox 87](#CVE-2021-23988)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Tyson Smith and Christian Holler reported memory safety bugs present in Firefox 86. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 87](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1684994%2C1686653)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a5e7ec58_20250115_081450.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-19

## Security Vulnerabilities fixed in Thunderbird 78.10.1

Announced
May 4, 2021
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 78.10.1

#### [#CVE-2021-29951: Thunderbird Maintenance Service could have been started or stopped by domain users](#CVE-2021-29951)

Reporter
James Forshaw
Impact
moderate
##### Description

The Maintenance Service granted SERVICE\_START access to `BUILTIN|Users` which, in a domain network, grants normal remote users access to start or stop the service. This could be used to prevent the browser update service from operating (if an attacker spammed the 'Stop' command); but also exposed attack surface in the maintenance service.
*Note: This issue only affected Windows operating systems older than Win 10 build 1709. Other operating systems are unaffected.*

##### References

* [Bug 1690062](https://bugzilla.mozilla.org/show_bug.cgi?id=1690062)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


