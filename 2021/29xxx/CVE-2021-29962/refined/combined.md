=== Content from www.mozilla.org_30dfa836_20250114_214133.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-23

## Security Vulnerabilities fixed in Firefox 89

Announced
June 1, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 89

#### [#CVE-2021-29965: Password Manager on Firefox for Android susceptible to domain spoofing](#CVE-2021-29965)

Reporter
Harshit Mahendra
Impact
high
##### Description

A malicious website that causes an HTTP Authentication dialog to be spawned could trick the built-in password manager to suggest passwords for the currently active website instead of the website that triggered the dialog.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1709257](https://bugzilla.mozilla.org/show_bug.cgi?id=1709257)

#### [#CVE-2021-29960: Filenames printed from private browsing mode incorrectly retained in preferences](#CVE-2021-29960)

Reporter
Sebastian Hengst
Impact
moderate
##### Description

Firefox used to cache the last filename used for printing a file. When generating a filename for printing, Firefox usually suggests the web page title.
The caching and suggestion techniques combined may have lead to the title of a website visited during private browsing mode being stored on disk.

##### References

* [Bug 1675965](https://bugzilla.mozilla.org/show_bug.cgi?id=1675965)

#### [#CVE-2021-29961: Firefox UI spoof using "<select>" elements and CSS scaling](#CVE-2021-29961)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When styling and rendering an oversized `&lt;select>` element, Firefox did not apply correct clipping which allowed an attacker to paint over the user interface.

##### References

* [Bug 1700235](https://bugzilla.mozilla.org/show_bug.cgi?id=1700235)

#### [#CVE-2021-29963: Shared cookies for search suggestions in private browsing mode](#CVE-2021-29963)

Reporter
Wladimir Palant working with Include Security
Impact
moderate
##### Description

Address bar search suggestions in private browsing mode were re-using session data from normal mode.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1705068](https://bugzilla.mozilla.org/show_bug.cgi?id=1705068)

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Firefox would process incorrectly, leading to an out-of-bounds read.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29959: Devices could be re-enabled without additional permission prompt](#CVE-2021-29959)

Reporter
Jan-Ivar Bruaroey
Impact
low
##### Description

When a user has already allowed a website to access microphone and camera, disabling camera sharing would not fully prevent the website from re-enabling it without an additional prompt.
This was only possible if the website kept recording with the microphone until re-enabling the camera.

##### References

* [Bug 1395819](https://bugzilla.mozilla.org/show_bug.cgi?id=1395819)

#### [#CVE-2021-29962: No rate-limiting for popups on Firefox for Android](#CVE-2021-29962)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Firefox for Android would become unstable and hard-to-recover when a website opened too many popups.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1701673](https://bugzilla.mozilla.org/show_bug.cgi?id=1701673)

#### [#CVE-2021-29967: Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christian Holler, Anny Gakhokidze, Alexandru Michis, Gabriele Svelto reported memory safety bugs present in Firefox 88 and Firefox ESR 78.11. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

#### [#CVE-2021-29966: Memory safety bugs fixed in Firefox 89](#CVE-2021-29966)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Christian Holler, Tooru Fujisawa, Tyson Smith reported memory safety bugs present in Firefox 88. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1660307%2C1686154%2C1702948%2C1708124)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_6b403e1c_20250114_214132.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1701673)
* [XML](/show_bug.cgi?ctype=xml&id=1701673)

Closed
[Bug 1701673](/show_bug.cgi?id=1701673)
(CVE-2021-29962)

Opened 4 years ago
Closed 4 years ago

# Denial of Service via window.open() calls

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Denial of Service via window.open() calls

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox87 wontfix, firefox88 wontfix, firefox89 verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix) |
| firefox89 | --- | [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox87 |  | wontfix |
| firefox88 |  | wontfix |
| firefox89 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jwkbugzilla, Assigned: csadilek)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/cacee3afc0d1d5e9fb61a861b0ed024b?d=mm&size=40)  [csadilek](/user_profile?user_id=590895)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/bd1b9ed4ddafb4e94ca9ec218f77fdb4?d=mm&size=40)  [jwkbugzilla](/user_profile?user_id=109976)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

Dependency [tree](/showdependencytree.cgi?id=1701673&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1701673)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-dos, sec-low, Whiteboard: [post-critsmash-triage][adv-main89+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29962

[Keywords:](/describekeywords.cgi)

[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main89+]

Change Request:

---

Bug Flags:

|  | sec-bounty | ? |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Proof of concept page](/attachment.cgi?id=9212203)  [4 years ago](#c0)  [Wladimir Palant](/user_profile?user_id=109976)   422 bytes, text/html |  | [Details](/attachment.cgi?id=9212203&action=edit) |
| --- | --- | --- |
| [0001-Improve-prompt-handling.patch](/attachment.cgi?id=9215115)  [4 years ago](#c1)  [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)   20.46 KB, patch | sebastian : [review+](#c3 "4 years ago")  tjr : [sec-approval+](#c6 "4 years ago") | [Details](/attachment.cgi?id=9215115&action=edit) | [Diff](/attachment.cgi?id=9215115&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115) |
| [advisory.txt](/attachment.cgi?id=9223726)  [4 years ago](#c13)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   291 bytes, text/plain |  | [Details](/attachment.cgi?id=9223726&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1701673#c0)• 4 years ago |
|  | |

Attached file
[Proof of concept page](attachment.cgi?id=9212203)
— [Details](attachment.cgi?id=9212203&action=edit)

Fenix protects against websites opening too many `alert()` or `prompt()` dialogs, similarly to Firefox on desktop. It doesn’t have any such protection for abuse of `window.open()` calls however. Each call results in a pop-up prompt, with an unlimited number of such calls stacking.

Please take care when opening the attached proof of concept page, the resulting denial of service is difficult to resolve! This page will attempt to open a pop-up every 100 milliseconds, each time resulting in a new prompt. These prompts are too many to be canceled, and the entire Fenix UI becomes unreachable so that switching tabs or reloading isn’t an option. Even if the process is terminated, restarting will restore the tab and load the malicious page again. I could only resolve this via Developer Tools.

Firefox on desktop doesn’t have this issue: its prompts are tab-modal, they don’t block other UI parts. Also, the pop-up prompt is non-modal. And the prompts don’t stack, the existing prompt simply counts up. So all pop-up requests can be dismissed at once.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a198086_1689)• 4 years ago |

Blocks: [eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")Keywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1701673#c1)• 4 years ago |
|  | |

Attached patch

[0001-Improve-prompt-handling.patch](attachment.cgi?id=9215115&action=diff)
— [Details](attachment.cgi?id=9215115&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115)

Assignee: nobody → csadilek
[Attachment #9215115](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") -
Flags: review?(s.kaspari)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1701673#c2)• 4 years ago |
|  | |

The prompts functionality in A-C/Fenix needs a bigger refactoring to make popups tab-modal and also support a queue of prompt requests which would then allow for a better popup blocker to be implemented. We should then also inform the user of the number of popups blocked on the current page.

I attached a short-term patch here which makes sure we only show one popup at a time. It also reuses our existing prompt abuse detector so users can disallow any more popups from the current page.

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1701673#c3)• 4 years ago |
|  | |

Comment on [attachment 9215115](/attachment.cgi?id=9215115 "0001-Improve-prompt-handling.patch") [[details]](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") [[diff]](/attachment.cgi?id=9215115&action=diff "0001-Improve-prompt-handling.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115)
0001-Improve-prompt-handling.patch
Review of [attachment 9215115](/attachment.cgi?id=9215115 "0001-Improve-prompt-handling.patch") [[details]](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") [[diff]](/attachment.cgi?id=9215115&action=diff "0001-Improve-prompt-handling.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115):
-----------------------------------------------------------------
Patch looks good to me. 👍
I verified it on a Google Pixel 4a using sample browser from the AC repository.
[Attachment #9215115](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") -
Flags: review?(s.kaspari) → review+

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1701673#c4)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1701673&comment_id=15356935 "1 revision") |
|  | |

Comment on [attachment 9215115](/attachment.cgi?id=9215115 "0001-Improve-prompt-handling.patch") [[details]](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") [[diff]](/attachment.cgi?id=9215115&action=diff "0001-Improve-prompt-handling.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115)

0001-Improve-prompt-handling.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Easy to construct a page to trigger the DOS. I kept the tests in the same commit too for now as this is rated sec-low, but please advise if we should land separately.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes, the sec-low DOS attack can likely be inferred from the patch.
* **Which older supported branches are affected by this flaw?**: All of them
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Easy to create backports. Risk is low.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions, but basic testing of popup prompts is required.
[Attachment #9215115](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") -
Flags: sec-approval?

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1701673#c5)• 4 years ago |
|  | |

Requested sec-approval to double-check as this bug relates to [bug 1701684](/show_bug.cgi?id=1701684 "RESOLVED FIXED - Universal XSS with pop-up prompts"), which does have an independent patch though.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1701673#c6)• 4 years ago |
|  | |

Comment on [attachment 9215115](/attachment.cgi?id=9215115 "0001-Improve-prompt-handling.patch") [[details]](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") [[diff]](/attachment.cgi?id=9215115&action=diff "0001-Improve-prompt-handling.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1701673&attachment=9215115)

0001-Improve-prompt-handling.patch

sec approved

[Attachment #9215115](/attachment.cgi?id=9215115&action=edit "0001-Improve-prompt-handling.patch") -
Flags: sec-approval? → sec-approval+

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1701673#c7)• 4 years ago |
|  | |

Fix landed in Fenix 89 Nightly 210413 17:00.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1701673#c8)• 4 years ago |
|  | |

<https://github.com/mozilla-mobile/android-components/commit/346a44da6c537e73c5343f3aa76a35256f8273fc>

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1701673#c9)• 4 years ago |
|  | |

Hello Sebastian, can you please help me with the steps in order to verify this issue?

Flags: needinfo?(s.kaspari)Flags: needinfo?(csadilek)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a1988620_553429)• 4 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1701673#c10)• 4 years ago |
|  | |

Hey Andrei.

If you open the "Proof of concept page", added as an attachment to this bug, then:

* In an unpatched version of Fenix you should see multiple prompts stack on top of each other asking whether you want to allow the page to open popups. And there will be no real escape from this.
* In a patched version of Fenix the prompts will not stack (only one shown) and follow-up prompts will have a checkbox that allows you to block further prompts from this page.
Flags: needinfo?(s.kaspari)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a1994971_590895)• 4 years ago |

Flags: needinfo?(csadilek)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1701673#c11)• 4 years ago |
|  | |

Thank you for the explanation, Sebastian!

Please note that I'm still able to reproduce this issue on the latest Nightly 4/22 and Latest Beta 89.0.0.b1 with Google Pixel 4 XL (11).

This is the behavior I saw:

No matter how many times I pressed `Deny` or `Allow` the prompt was still there.

After I selected `Prevent this page from creating additional dialogs` and press any of the `Deny or`Allow` the prompt will go away but after a home button interrupt the prompt is back or using the recent apps button.

Note that the same behavior is on both builds Nightly and Beta.

[Gif](https://im3.ezgif.com/tmp/ezgif-3-05d2c235c307.gif)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1701673#c12)• 4 years ago |
|  | |

There was a misunderstanding about the verification and after I synced with Christian on zoom we agreed that what I said above is the intended behavior.

Based on this comment and my verification from above, I verify this issue as fixed on Nightly 4/22 and Latest Beta 89.0.0.b1 Google Pixel 4 XL (11).

In the GIF above, the intended behavior can be seen.

Thanks, @sebastian and @christian!

Status: RESOLVED → VERIFIED

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a2088419_616105)• 4 years ago |

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a5074142_428608)• 4 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main89+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1701673#c13)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9223726)
— [Details](attachment.cgi?id=9223726&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a5081509_428608)• 4 years ago |

Alias: CVE-2021-29962

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a20625212_1689)• 3 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1701673#a50514831_430528)• 2 years ago |

Component: Security: Android → GeneralOS: Unspecified → Android
You need to [log in](/show_bug.cgi?id=1701673&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Wladimir Palant](/user_profile?user_id=109976)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


