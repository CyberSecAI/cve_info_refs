=== Content from www.mozilla.org_449228e1_20250115_091553.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-17

## Security Vulnerabilities fixed in Thunderbird 78.8.1

Announced
March 8, 2021
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 78.8.1

**Note**: This advisory was issued April 20, 2021 to include CVE-2021-29950.

#### [#CVE-2021-29950: Logic issue potentially leaves key material unlocked](#CVE-2021-29950)

Reporter
Cure53
Impact
moderate
##### Description

Thunderbird unprotects a secret OpenPGP key prior to using it for a decryption, signing or key import task. If the task runs into a failure, the secret key may remain in memory in its unprotected state.

##### References

* [Bug 1673239](https://bugzilla.mozilla.org/show_bug.cgi?id=1673239)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_6573e7fa_20250115_091551.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1673239)
* [XML](/show_bug.cgi?ctype=xml&id=1673239)

Closed
[Bug 1673239](/show_bug.cgi?id=1673239)
(CVE-2021-29950)

Opened 4 years ago
Closed 4 years ago

# RNP-01-012 WP1 Thunderbird: Logic issue potentially leaves key material unlocked (Medium)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

RNP-01-012 WP1 Thunderbird: Logic issue potentially leaves key material unlocked (Medium)

## Categories

### (MailNews Core :: Security: OpenPGP, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP#Security%3A%20OpenPGP)

Security: OpenPGP
▾

MailNews Core :: Security: OpenPGP
OpenPGP is about all aspects related to encrypted or signed email messages using the OpenPGP protocol.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

78

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (thunderbird\_esr78+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

87 Branch

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr78 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr78 | + | fixed |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: wsmwk, Assigned: KaiE)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/976cc55d51282c1c46821f8451605062?d=mm&size=40)  [wsmwk](/user_profile?user_id=29811)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[RNP-01-audit](/show_bug.cgi?id=1671735 "RESOLVED FIXED - Audit-Report RNP & Thunderbird Integration 08.2020 (tracking)")

Dependency [tree](/showdependencytree.cgi?id=1673239&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1673239)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[CVE-2021-29956](/show_bug.cgi?id=1710290 "RESOLVED FIXED - For OpenPGP secret keys imported with Thunderbird versions 78.8.1 - 78.10.1, the master password isn't effective")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29950

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin](/attachment.cgi?id=9203762)  [4 years ago](#c2)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   48 bytes, text/x-phabricator-request | wsmwk : [approval-comm-esr78+](#c6 "4 years ago") | [Details](/attachment.cgi?id=9203762&action=edit) | [Review](/attachment.cgi?id=9203762) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1673239#c0)• 4 years ago |
|  | |

During the audit of the RNP source code, it was discovered that there is a potential logic flaw related to locking/unlocking and protecting/unprotecting keys. The function - named rnp\_key\_unlock() - unlocks a key and has secret key material for use without password protection. This puts all values into memory so the key becomes usable for corresponding operations (e.g. changing attributes or exporting keys).

As an example, the flow of operations is as follows:

1. Unlock the key by invoking rnp\_key\_unlock()
2. Perform some operations on the key, e.g. export it by using rnp\_key\_export()
3. Lock the key again by invoking rnp\_key\_lock()

It was identified that the rnp\_key\_lock() might not be invoked in case the desired operation, in the example above rnp\_key\_export(), is running into an error. This situation potentially allows an attacker to perform operations on already unlocked keys, without needing to unlock them beforehand.

A similar pattern has been observed for rnp\_key\_protect/rnp\_key\_unprotect(), which gets invoked when keys are imported through importKeyBlockImpl(). A protected key is encrypted and can be safely held in memory. Invoking rnp\_key\_unprotect() on a given key removes the encryption from the key.

***Affected File:***

comm/mail/extensions/openpgp/content/modules/RNP.jsm

***Affected Code:***

refer to [Attachment 9182160](/attachment.cgi?id=9182160 "cure53 RNP-01-report.pdf") [[details]](/attachment.cgi?id=9182160&action=edit "cure53 RNP-01-report.pdf")

Locking/protecting the keys in case an operation performed on an unlocked/unprotected key fails is important because it reduces the potential risk of having unlocked/unprotected keys in memory. Therefore, it is recommended to properly catch any occurring exceptions and re-lock/protect keys again.

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a140_29811)• 4 years ago |

Assignee: o.nickolay → nobodySummary: RNP-01-012 WP1 RNP: encrypt\_secret\_key() does not wipe keybuf from memory (Low) → RNP-01-012 WP1 Thunderbird: Logic issue potentially leaves key material unlocked (Medium)Whiteboard: [RNP]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a1528845_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a3807940_101158)• 4 years ago |

Assignee: nobody → mkmelin+mozilla

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1673239#c1)• 4 years ago |
|  | |

I will attach a first revision of a fix, which is currently untested. I'm attaching it anyway, phabricator might help me self-review more easily.

The fix will affect the following actions. We need to test these actions still work correctly with the new patch.

* key generation
* import secret key
* backup secret key
* change expiration date

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1673239#c2)• 4 years ago |
|  | |

Attached file
[Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin](attachment.cgi?id=9203762)
— [Details](attachment.cgi?id=9203762&action=edit)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1673239#c3)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1673239&comment_id=15271616 "1 revision") |
|  | |

I've implemented automated tests for secret keys in [bug 1693554](/show_bug.cgi?id=1693554 "RESOLVED FIXED - Add automated tests for OpenPGP secret key operations").

Tests pass without and with the fixes from this bug.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a10102786_101158)• 4 years ago |

Assignee: mkmelin+mozilla → kaieStatus: NEW → ASSIGNED
[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=affected)Target Milestone: --- → 87 Branch

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1673239#c4)• 4 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/b14afc010507d8d5857bc739dc75ed022e30792e>

Status: ASSIGNED → RESOLVEDClosed: 4 years agoResolution: --- → FIXED

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a10104353_101158)• 4 years ago |

[tracking-thunderbird\_esr78](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=equals&v1=%2B)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1673239#c5)• 4 years ago |
|  | |

Comment on [attachment 9203762](/attachment.cgi?id=9203762 "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin") [[details]](/attachment.cgi?id=9203762&action=edit "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin")

[Bug 1673239](/show_bug.cgi?id=1673239 "RESOLVED FIXED - RNP-01-012 WP1 Thunderbird: Logic issue potentially leaves key material unlocked (Medium)") - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin

[Approval Request Comment]

User impact if declined: sec issue

Testing completed (on c-c, etc.): on beta

Risk to taking this patch (and alternatives if risky): doesn't seem very high

[Attachment #9203762](/attachment.cgi?id=9203762&action=edit "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin") -
Flags: approval-comm-esr78?

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1673239#c6)• 4 years ago |
|  | |

Comment on [attachment 9203762](/attachment.cgi?id=9203762 "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin") [[details]](/attachment.cgi?id=9203762&action=edit "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin")

[Bug 1673239](/show_bug.cgi?id=1673239 "RESOLVED FIXED - RNP-01-012 WP1 Thunderbird: Logic issue potentially leaves key material unlocked (Medium)") - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin

[Triage Comment]

Approved for esr78

[Attachment #9203762](/attachment.cgi?id=9203762&action=edit "Bug 1673239 - OpenPGP key material should remain locked in memory in failure scenarios. r=mkmelin") -
Flags: approval-comm-esr78? → approval-comm-esr78+

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1673239#c7)• 4 years ago |
| uplift | |

Thunderbird 78.8.1:

<https://hg.mozilla.org/releases/comm-esr78/rev/0c8606e7f45d>

[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=fixed)

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1673239#c8)• 4 years ago |
|  | |

Kaie, will you be arranging a security advisory for this?

Flags: needinfo?(kaie)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1673239#c9)• 4 years ago |
|  | |

Sorry for having missed this at the time of release. I will work with Tom to check if we can release a CVE late.

Flags: needinfo?(kaie)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a15307405_578488)• 4 years ago |

Alias: CVE-2021-29950

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a16935058_36541)• 4 years ago |

Regressions: [CVE-2021-29956](/show_bug.cgi?id=1710290 "RESOLVED FIXED - For OpenPGP secret keys imported with Thunderbird versions 78.8.1 - 78.10.1, the master password isn't effective")

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673239#a19628868_29811)• 4 years ago |

Group: mail-core-security
You need to [log in](/show_bug.cgi?id=1673239&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


