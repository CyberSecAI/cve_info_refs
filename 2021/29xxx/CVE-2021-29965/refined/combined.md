=== Content from bugzilla.mozilla.org_1542b7d0_20250114_224825.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1709257)
* [XML](/show_bug.cgi?ctype=xml&id=1709257)

Closed
[Bug 1709257](/show_bug.cgi?id=1709257)
(CVE-2021-29965)

Opened 4 years ago
Closed 4 years ago

# Fenix password manager is fooled by origin of http auth prompt, suggests passwords for the completely wrong site

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Fenix password manager is fooled by origin of http auth prompt, suggests passwords for the completely wrong site

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox88 wontfix, firefox89+ fixed, firefox90+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox88 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix) |
| firefox89 | [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) |
| firefox90 | [+](/buglist.cgi?f1=cf_tracking_firefox90&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox88 |  | wontfix |
| firefox89 | + | fixed |
| firefox90 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: pm.mahendra1, Assigned: sebastian)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/823f986b798048330aca1a50acc92240?d=mm&size=40)  [sebastian](/user_profile?user_id=472516)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1052abf0cd6a02a6fc5b7d3995a04f5b?d=mm&size=40)  [pm.mahendra1](/user_profile?user_id=679750)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[873810](/show_bug.cgi?id=873810 "RESOLVED DUPLICATE - Background tabs can force an HTTP auth prompt over the active tab to steal the user's credentials for the currently-active website")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1709257&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1709257)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1708107](/show_bug.cgi?id=1708107 "RESOLVED DUPLICATE - URL Spoofing using http auth")

## Details

### (4 keywords, Whiteboard: [adv-main89+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29965

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main89+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2465112_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Screenshot\_20210428\_182959\_org.mozilla.firefox.jpg](/attachment.cgi?id=9220022)  [4 years ago](#c0)  [Harshit Mahendra](/user_profile?user_id=679750)   365.62 KB, image/jpeg |  | [Details](/attachment.cgi?id=9220022&action=edit) |
| --- | --- | --- |
| [0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch](/attachment.cgi?id=9222612)  [4 years ago](#c6)  [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)   9.44 KB, patch |  | [Details](/attachment.cgi?id=9222612&action=edit) | [Diff](/attachment.cgi?id=9222612&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222612) |
| [0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch](/attachment.cgi?id=9222615)  [4 years ago](#c7)  [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)   11.61 KB, patch | csadilek : [review+](#c8 "4 years ago")  tjr : [sec-approval+](#c10 "4 years ago") | [Details](/attachment.cgi?id=9222615&action=edit) | [Diff](/attachment.cgi?id=9222615&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615) |
| [advisory.txt](/attachment.cgi?id=9223708)  [4 years ago](#c14)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   391 bytes, text/plain |  | [Details](/attachment.cgi?id=9223708&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Harshit Mahendra](/user_profile?user_id=679750)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1709257#c0)• 4 years ago |
|  | |

Attached image
[Screenshot\_20210428\_182959\_org.mozilla.firefox.jpg](attachment.cgi?id=9220022)
— [Details](attachment.cgi?id=9220022&action=edit)

+++ This bug was initially created as a clone of [Bug #1708107](/show_bug.cgi?id=1708107 "RESOLVED DUPLICATE - URL Spoofing using http auth") +++

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36

Firefox for Android

Steps to reproduce:

1. Open this URL - <http://designs.ndev.xyz/test/new.html>
2. Click on the 'Click here to Open Apple.com'.
3. Wait for 1 second.

Actual results:

POC videos -

Android - <https://youtu.be/SbQMQt86KKw>

As you can see in the screenshot the http auth is suggesting the password of apple.com

Expected results:

The Fenix password manager should NOT be suggesting passwords that don't match the source of the http auth.

|  | [Harshit Mahendra](/user_profile?user_id=679750)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1709257#c1)• 4 years ago |
|  | |

Here I want to ask a question These password in the screenshot is saved on my google chrome Browser not in Firefox. but it is suggesting me on Firefox? if I click on the "manage password" it open the google chrome app and redirect me to the password manager.

Is this a bug of google or Firefox ?

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1709257#c2)• 4 years ago |
|  | |

This seems specific to Android. Stefan, can your team take a look at this? Thanks!

Group: firefox-core-security → mobile-core-securityComponent: Security → Security: AndroidFlags: needinfo?(sarentz)Product: Firefox → FenixVersion: Firefox 90 → unspecified

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a545710_159069)• 4 years ago |

See Also: → [1708107](/show_bug.cgi?id=1708107 "RESOLVED DUPLICATE - URL Spoofing using http auth")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1709257#c3)• 4 years ago |
|  | |

This looks to me like an extension/consequence of [bug 1708107](/show_bug.cgi?id=1708107 "RESOLVED DUPLICATE - URL Spoofing using http auth") -- we've spoofed our own password manager!

Note: we intentionally suggest passwords for sibling domains because that comes up a lot in large sites (e.g. sites where the password is saved for registration.veditz.example and then used on [www.veditz.example](http://www.veditz.example)). THIS IS NOT THAT. We're suggesting passwords based on the URL of the topmost tab while the auth comes from a different tab entirely.

Are we equally wrong if the auth prompt comes from a cross-origin frame?

Flags: needinfo?(s.kaspari)Summary: The Fenix password manager should NOT be suggesting passwords that don't match the source of the http auth. → Fenix password manager is fooled by origin of http auth prompt, suggests passwords for the completely wrong site

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1709257#c4)• 4 years ago |
|  | |

The popup from behind is probably a Gecko bug, and a spoofing problem in its own right: [bug 873810](/show_bug.cgi?id=873810 "RESOLVED DUPLICATE - Background tabs can force an HTTP auth prompt over the active tab to steal the user's credentials for the currently-active website")

THIS bug (with a higher severity) is that our password manager suggestions lend credence to the spoof and make it much more likely the user will fall for it.

Status: UNCONFIRMED → NEWDepends on: [873810](/show_bug.cgi?id=873810 "RESOLVED DUPLICATE - Background tabs can force an HTTP auth prompt over the active tab to steal the user's credentials for the currently-active website")Ever confirmed: trueKeywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1709257#c5)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1709257&comment_id=15409839 "1 revision") |
|  | |

I'll take a look.

From the video it seems like what happens:

* ~~The http auth dialog is shown for the previous page. (Not getting cancelled on navigation?)~~ [Edit: That assumption was wrong, the dialog is for the *next* page that should get loaded]
* Autofill suggestions are shown for the *current* page. What's interesting here is that this doesn't seem to be our own suggestions, but come from Android's Autofill API (which is also confirmed by the user seeing suggestions from their accounts stored in Chrome). I'm curious whether we pass the domain along or whether the Autofill service tries to interpolate it from the view structure.
Assignee: nobody → s.kaspariStatus: NEW → ASSIGNEDFlags: needinfo?(s.kaspari)

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1709257#c6)• 4 years ago |
|  | |

Attached patch

[0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch](attachment.cgi?id=9222612&action=diff) (obsolete)
— [Details](attachment.cgi?id=9222612&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222612)

The password suggestions are coming from the system's autofill provider (Android system API).

We try to give the system API a hint and tell it the domain to autofill for:

<https://github.com/mozilla-mobile/android-components/blob/master/components/feature/prompts/src/main/java/mozilla/components/feature/prompts/dialog/AutofillEditText.kt>

Unfortunately we pass along the URL of the current tab:

<https://github.com/mozilla-mobile/android-components/blob/master/components/feature/prompts/src/main/java/mozilla/components/feature/prompts/PromptFeature.kt#L610>

With this patch, we pass the URL the auth dialog is for instead (that we get from Gecko).

[Attachment #9222612](/attachment.cgi?id=9222612&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: review?(csadilek)

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1709257#c7)• 4 years ago |
|  | |

Attached patch

[0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch](attachment.cgi?id=9222615&action=diff)
— [Details](attachment.cgi?id=9222615&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615)

[Attachment #9222612](/attachment.cgi?id=9222612&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Attachment is obsolete: true
[Attachment #9222612](/attachment.cgi?id=9222612&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: review?(csadilek)
[Attachment #9222615](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: review?(csadilek)

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1321972_472516)• 4 years ago |

Flags: needinfo?(sarentz)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1709257#c8)• 4 years ago |
|  | |

Comment on [attachment 9222615](/attachment.cgi?id=9222615 "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[details]](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[diff]](/attachment.cgi?id=9222615&action=diff "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615)
0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch
Review of [attachment 9222615](/attachment.cgi?id=9222615 "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[details]](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[diff]](/attachment.cgi?id=9222615&action=diff "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615):
-----------------------------------------------------------------
Tested this patch against the provided sample page and verified that only logins matching the domain of the auth request are suggested.
[Attachment #9222615](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: review?(csadilek) → review+

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1709257#c9)• 4 years ago |
|  | |

Comment on [attachment 9222615](/attachment.cgi?id=9222615 "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[details]](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[diff]](/attachment.cgi?id=9222615&action=diff "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615)

0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch exposes that we have been using the current page's URL for the autofill hint instead of the URL the auth dialog is for. With that information you may end up figuring out the spoofing shown in this bug.

However to be effective it needs: An Android device supporting the autofill API (Android 8+), the user to have setup an autofill provider (or using the default), the user having matching accounts stored in the autofill provider.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: All release versions of Firefox for Android
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Very unlikely.
[Attachment #9222615](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: sec-approval?

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1423275_472516)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1425276_580382)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix)
[tracking-firefox89](/buglist.cgi?f1=cf_tracking_firefox89&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B)
[tracking-firefox90](/buglist.cgi?f1=cf_tracking_firefox90&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox90&o1=equals&v1=%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1709257#c10)• 4 years ago |
|  | |

Comment on [attachment 9222615](/attachment.cgi?id=9222615 "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[details]](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[diff]](/attachment.cgi?id=9222615&action=diff "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1709257&attachment=9222615)

0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch

We're in RC week, approved to land

[Attachment #9222615](/attachment.cgi?id=9222615&action=edit "0001-AuthenticationDialogFragment-Use-URL-from-prompt-req.patch") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1709257#c11)• 4 years ago |
|  | |

Adding bounty nomination at the request of the reporter (email to security@)

Flags: sec-bounty?

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1709257#c12)• 4 years ago |
|  | |

* Patch landed in the branches A-C and Fenix Nightly.
* And patch landed in the A-C and Fenix branches for Fenix 89 (waiting for the next Beta/RC to get out).

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1858086_75935)• 4 years ago |

Status: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1858094_75935)• 4 years ago |

Group: mobile-core-security → core-security-release

|  | [Harshit Mahendra](/user_profile?user_id=679750)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1709257#c13)• 4 years ago |
|  | |

:pocmo Thanks for fixing this bug. I checked on Firefox Nightly and It's working fine.

:dveditz Does this bug qualify for bounty ? let me know.

Thanks,

Harshit Mahendra

Flags: needinfo?(tom)Flags: needinfo?(dveditz)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a1995783_428608)• 4 years ago |

Whiteboard: [adv-main89+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1709257#c14)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9223708)
— [Details](attachment.cgi?id=9223708&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a2003194_428608)• 4 years ago |

Alias: CVE-2021-29965

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1709257#c15)• 4 years ago |
|  | |

The bug is flagged for the bounty committee and we will evaluate it in the coming weeks (probably next week.)

Flags: needinfo?(tom)Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a2465112_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Harshit Mahendra](/user_profile?user_id=679750)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1709257#c16)• 4 years ago |
|  | |

:dveditz Thanks for the bounty ! Just wanted to ask what will be the next step to process bounty ?

Flags: needinfo?(dveditz)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1709257#c17)• 4 years ago |
|  | |

Harshit - I will be doing the paperwork on our end and emailing you

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a17546888_1689)• 3 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a47436495_430528)• 2 years ago |

Component: Security: Android → General

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1709257#a96983588_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1709257&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Harshit Mahendra](/user_profile?user_id=679750)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_30dfa836_20250114_224826.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-23

## Security Vulnerabilities fixed in Firefox 89

Announced
June 1, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 89

#### [#CVE-2021-29965: Password Manager on Firefox for Android susceptible to domain spoofing](#CVE-2021-29965)

Reporter
Harshit Mahendra
Impact
high
##### Description

A malicious website that causes an HTTP Authentication dialog to be spawned could trick the built-in password manager to suggest passwords for the currently active website instead of the website that triggered the dialog.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1709257](https://bugzilla.mozilla.org/show_bug.cgi?id=1709257)

#### [#CVE-2021-29960: Filenames printed from private browsing mode incorrectly retained in preferences](#CVE-2021-29960)

Reporter
Sebastian Hengst
Impact
moderate
##### Description

Firefox used to cache the last filename used for printing a file. When generating a filename for printing, Firefox usually suggests the web page title.
The caching and suggestion techniques combined may have lead to the title of a website visited during private browsing mode being stored on disk.

##### References

* [Bug 1675965](https://bugzilla.mozilla.org/show_bug.cgi?id=1675965)

#### [#CVE-2021-29961: Firefox UI spoof using "<select>" elements and CSS scaling](#CVE-2021-29961)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When styling and rendering an oversized `&lt;select>` element, Firefox did not apply correct clipping which allowed an attacker to paint over the user interface.

##### References

* [Bug 1700235](https://bugzilla.mozilla.org/show_bug.cgi?id=1700235)

#### [#CVE-2021-29963: Shared cookies for search suggestions in private browsing mode](#CVE-2021-29963)

Reporter
Wladimir Palant working with Include Security
Impact
moderate
##### Description

Address bar search suggestions in private browsing mode were re-using session data from normal mode.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1705068](https://bugzilla.mozilla.org/show_bug.cgi?id=1705068)

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Firefox would process incorrectly, leading to an out-of-bounds read.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29959: Devices could be re-enabled without additional permission prompt](#CVE-2021-29959)

Reporter
Jan-Ivar Bruaroey
Impact
low
##### Description

When a user has already allowed a website to access microphone and camera, disabling camera sharing would not fully prevent the website from re-enabling it without an additional prompt.
This was only possible if the website kept recording with the microphone until re-enabling the camera.

##### References

* [Bug 1395819](https://bugzilla.mozilla.org/show_bug.cgi?id=1395819)

#### [#CVE-2021-29962: No rate-limiting for popups on Firefox for Android](#CVE-2021-29962)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Firefox for Android would become unstable and hard-to-recover when a website opened too many popups.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1701673](https://bugzilla.mozilla.org/show_bug.cgi?id=1701673)

#### [#CVE-2021-29967: Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christian Holler, Anny Gakhokidze, Alexandru Michis, Gabriele Svelto reported memory safety bugs present in Firefox 88 and Firefox ESR 78.11. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

#### [#CVE-2021-29966: Memory safety bugs fixed in Firefox 89](#CVE-2021-29966)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Christian Holler, Tooru Fujisawa, Tyson Smith reported memory safety bugs present in Firefox 88. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1660307%2C1686154%2C1702948%2C1708124)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


