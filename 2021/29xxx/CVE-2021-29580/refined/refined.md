The provided content relates to CVE-2021-29580.

**Root cause of vulnerability:** The `tf.raw_ops.FractionalMaxPoolGrad` implementation in TensorFlow does not validate that input and output tensors are not empty and are of the same rank.

**Weaknesses/vulnerabilities present:**
1.  **Undefined behavior:**  When an input tensor is empty, the operation leads to undefined behavior.
2.  **Denial of service (DoS):** A `CHECK` condition fails when specific tensor shapes are passed, causing the process to abort.

**Impact of exploitation:**
1.  Undefined behavior can lead to unpredictable results, including crashes or data corruption.
2.  The DoS vulnerability can be triggered by a specially crafted input, leading to process termination.

**Attack vectors:**
The vulnerability is triggered through the `tf.raw_ops.FractionalMaxPoolGrad` operation by providing specific input tensors.

**Required attacker capabilities/position:**
An attacker needs to be able to provide inputs to the `tf.raw_ops.FractionalMaxPoolGrad` operation. This could be a user controlling inputs to a TensorFlow model, or an attacker injecting malformed data.

**Additional details:**
The provided commit diff shows the fix implemented which adds checks to ensure that input tensors are not empty and have the correct rank.
The affected versions are prior to 2.5.0 and the patched versions include 2.1.4, 2.2.3, 2.3.3, 2.4.2.