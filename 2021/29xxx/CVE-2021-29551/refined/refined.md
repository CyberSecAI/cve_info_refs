The provided content is related to CVE-2021-29551.

**Root cause of vulnerability:**
The vulnerability stems from the implementation of `MatrixTriangularSolve` in TensorFlow. The `ValidateInputTensors` function uses `OP_REQUIRES` to check input tensor dimensions. If the dimensions are invalid, the function returns, but the kernel execution does not terminate immediately. This leads to an out-of-bounds read when the `MatMulBCast` object is initialized with invalid data after the dimension check fails.

**Weaknesses/vulnerabilities present:**
- Out-of-bounds read: The vulnerability allows an attacker to trigger a heap out-of-bounds read due to the incorrect handling of invalid input tensors.
- Inadequate error handling: The `OP_REQUIRES` macro does not prevent further execution of the function after a check fails.

**Impact of exploitation:**
- An attacker can cause a program using the vulnerable TensorFlow library to read beyond allocated memory bounds, leading to crashes or potential information disclosure.

**Attack vectors:**
- By providing crafted input tensors with invalid dimensions to the `tf.raw_ops.MatrixTriangularSolve` function.

**Required attacker capabilities/position:**
- An attacker needs the ability to control input data to the `tf.raw_ops.MatrixTriangularSolve` function in a TensorFlow program.

**Additional details:**
- The vulnerability exists because `OP_REQUIRES` only sets the context status to non-OK and returns, but does not terminate the kernel execution.
- The fix involves adding an explicit return after validation check failure to prevent the execution flow from reaching the vulnerable code.
- The vulnerability affects TensorFlow versions prior to 2.5.0.
- Patches were backported to versions 2.1.4, 2.2.3, 2.3.3, and 2.4.2
- The vulnerability is triggered by empty tensors that do not meet the minimum dimension requirements.
- The commit `480641e3599775a8895254ffbc0fc45621334f68` contains the fix.