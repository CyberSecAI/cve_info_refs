=== Content from rustsec.org_d4c6cb9c_20250114_205255.html ===


RUSTSEC-2021-0048: stackvector: StackVec::extend can write out of bounds when size\_hint is incorrect › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/stackvector/RUSTSEC-2021-0048.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/stackvector/RUSTSEC-2021-0048.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0048)

# RUSTSEC-2021-0048

StackVec::extend can write out of bounds when size\_hint is incorrect

Reported
February 19, 2021

Issued
March 30, 2021

(last modified: June 13, 2023)

Package
[stackvector](/packages/stackvector.html)
([crates.io](https://crates.io/crates/stackvector))

Type
Vulnerability

Categories

* [memory-corruption](/categories/memory-corruption.html)

Aliases

* [CVE-2021-29939](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29939)
* [GHSA-9frf-r7c7-j2vg](https://github.com/advisories/GHSA-9frf-r7c7-j2vg)

References

* <https://github.com/Alexhuszagh/rust-stackvector/issues/2>

CVSS Score
7.3
HIGH

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionNone
ScopeUnchanged
ConfidentialityLow
IntegrityLow
AvailabilityLow

CVSS Vector
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)
Patched

* `>=1.0.9`

### Description

`StackVec::extend` used the lower and upper bounds from an Iterator's
`size_hint` to determine how many items to push into the stack based vector.

If the `size_hint` implementation returned a lower bound that was larger than
the upper bound, `StackVec` would write out of bounds and overwrite memory
on the stack. As mentioned by the [size\_hint](https://doc.rust-lang.org/std/iter/trait.Iterator.html#provided-methods)
documentation, `size_hint` is mainly for optimization and incorrect
implementations should not lead to memory safety issues.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


