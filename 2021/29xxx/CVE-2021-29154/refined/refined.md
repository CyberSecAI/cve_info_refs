```json
{
  "cve": "CVE-2021-29154",
  "description": "An issue has been discovered in the Linux kernel that can be abused by unprivileged local users to escalate privileges.\n\nThe issue is with how BPF JIT compilers for some architectures compute branch displacements when generating machine code. This can be abused to craft anomalous machine code and execute it in the Kernel mode, where the control flow is hijacked to execute unsafe code.\n\n",
  "affected_products": [
    "NetApp Cloud Backup (formerly AltaVault)",
    "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S",
    "NetApp SolidFire & HCI Management Node",
     "NetApp SolidFire Baseboard Management Controller (BMC)"
  ],
  "vulnerability": {
    "root_cause": "The branch displacement logic in the BPF JIT compilers for x86 assumes that, for any generated branch instruction, the distance cannot increase between optimization passes.  This assumption can be violated due to how the distances are computed, specifically when a backward branch is processed. This leads to incorrect branch displacements.",
    "weaknesses": [
      "Incorrect BPF JIT branch displacement computation"
    ],
    "impact": "Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).  Specifically, it can be abused to craft anomalous machine code and execute it in the Kernel mode, where the control flow is hijacked to execute unsafe code.",
      "attack_vector": "Local",
    "required_capabilities": [
      "Local user with ability to insert eBPF instructions",
      "Privileged user (root or CAP_SYS_ADMIN)"
    ]
  },
  "additional_details": {
    "netapp_products_not_affected": [
      "AFF Baseboard Management Controller (BMC) - A700s",
      "ATTO FibreBridge - 7500N",
      "ATTO FibreBridge - 7600N",
      "Active IQ Unified Manager for Linux",
      "Active IQ Unified Manager for Microsoft Windows",
      "Active IQ Unified Manager for VMware vSphere",
       "Active IQ mobile app",
      "Astra Trident",
      "Brocade Fabric Operating System Firmware",
      "Brocade SAN Navigator (SANnav)",
       "Cloud Insights Acquisition Unit",
      "Cloud Insights Storage Workload Security Agent",
      "Cloud Insights Telegraf Agent",
        "Cloud Volumes ONTAP Mediator",
        "E-Series BIOS",
        "E-Series SANtricity OS Controller Software 11.x",
        "E-Series SANtricity Unified Manager and Web Services Proxy",
        "Element .NET SDK",
        "Element HealthTools",
        "Element JAVA SDK",
         "Element Plug-in for vCenter Server",
        "Element Python SDK",
        "FAS/AFF BIOS - 8300/8700/A400/C400",
        "FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400",
         "FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250",
        "FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750",
        "FAS/AFF Service Processor - 8080/8060/8040/8020",
      "Global File Cache",
      "Host Utilities - SAN for Linux",
      "Host Utilities - SAN for Windows",
     "IOM6 SAS Disk Shelf Firmware",
       "Management Services for Element Software and NetApp HCI",
        "MetroCluster Tiebreaker for clustered Data ONTAP",
        "NetApp BlueXP",
        "NetApp Converged Systems Advisor Agent",
        "NetApp HCI Baseboard Management Controller (BMC) - H410C",
        "NetApp HCI Baseboard Management Controller (BMC) - H610C",
        "NetApp HCI Baseboard Management Controller (BMC) - H610S",
       "NetApp HCI Baseboard Management Controller (BMC) - H615C",
       "NetApp HCI Compute Node (Bootstrap OS)",
       "NetApp HCI Compute Node BIOS",
       "NetApp HCI Storage Node BIOS",
       "NetApp Manageability SDK",
         "NetApp NFS Plug-in for VMware VAAI",
         "NetApp ONTAP PowerShell Toolkit (PSTK)",
        "NetApp SolidFire & HCI Storage Node (Element Software)",
        "NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)",
       "NetApp VASA Provider for Clustered Data ONTAP 9.7 and above",
       "NetApp XCP NFS",
       "NetApp XCP SMB",
       "ONTAP 9 (formerly Clustered Data ONTAP)",
       "ONTAP Antivirus Connector",
      "ONTAP Mediator",
      "ONTAP Select Deploy administration utility",
      "OnCommand Insight",
      "OnCommand Workflow Automation",
       "SANtricity Storage Plugin for vCenter",
        "SRA Plugin for Linux",
        "SRA Plugin for Windows",
        "Single Mailbox Recovery",
        "Snap Creator Framework",
        "SnapCenter",
         "SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine",
        "SnapManager for Hyper-V",
        "SolidFire Storage Replication Adapter",
        "Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above",
         "StorageGRID (formerly StorageGRID Webscale)",
        "StorageGRID BIOS SG1000/SG100",
        "StorageGRID BIOS SG5660/SG5612/SG5760/SG5712",
        "StorageGRID BIOS SG6060/SGF6024/SGF6112",
       "StorageGRID Baseboard Management Controller (BMC)",
       "StorageGRID9 (9.x and prior)",
       "System Manager 9.x",
        "Virtual Storage Console for VMware vSphere 9.7 and above"
    ],
    "mitigation": "To mitigate this issue, NetApp recommends updating to the fixed versions. There are no workarounds.",
    "patches": [
         {
            "product": "NetApp Cloud Backup (formerly AltaVault)",
            "first_fixed_in_release": "NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information."
        },
        {
            "product": "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S",
            "first_fixed_in_release": "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2876227.html) for more information."
        },
         {
            "product": "NetApp SolidFire & HCI Management Node",
            "first_fixed_in_release": "<https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.5> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.10>"
        },
       {
            "product": "NetApp SolidFire Baseboard Management Controller (BMC)",
            "first_fixed_in_release": "NetApp SolidFire Baseboard Management Controller (BMC) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2847476.html%20) for more information."
       }
    ],
   "public_discussion":"NetApp is aware of public discussion of this vulnerability."
  }
}
```