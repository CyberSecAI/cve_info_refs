=== Content from github.com_fe108722_20250114_195521.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fpull%2F767)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fpull%2F767)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=InvoicePlane%2FInvoicePlane)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[InvoicePlane](/InvoicePlane)
/
**[InvoicePlane](/InvoicePlane/InvoicePlane)**
Public

* [Notifications](/login?return_to=%2FInvoicePlane%2FInvoicePlane) You must be signed in to change notification settings
* [Fork
  812](/login?return_to=%2FInvoicePlane%2FInvoicePlane)
* [Star
   2.6k](/login?return_to=%2FInvoicePlane%2FInvoicePlane)

* [Code](/InvoicePlane/InvoicePlane)
* [Issues
  76](/InvoicePlane/InvoicePlane/issues)
* [Pull requests
  31](/InvoicePlane/InvoicePlane/pulls)
* [Discussions](/InvoicePlane/InvoicePlane/discussions)
* [Projects
  0](/InvoicePlane/InvoicePlane/projects)
* [Security](/InvoicePlane/InvoicePlane/security)
* [Insights](/InvoicePlane/InvoicePlane/pulse)

Additional navigation options

* [Code](/InvoicePlane/InvoicePlane)
* [Issues](/InvoicePlane/InvoicePlane/issues)
* [Pull requests](/InvoicePlane/InvoicePlane/pulls)
* [Discussions](/InvoicePlane/InvoicePlane/discussions)
* [Projects](/InvoicePlane/InvoicePlane/projects)
* [Security](/InvoicePlane/InvoicePlane/security)
* [Insights](/InvoicePlane/InvoicePlane/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FInvoicePlane%2FInvoicePlane%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FInvoicePlane%2FInvoicePlane%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix for CVE-2021-29023 #733 #767

 Merged

[nielsdrost7](/nielsdrost7)
merged 4 commits into
[InvoicePlane:develop](/InvoicePlane/InvoicePlane/tree/develop "InvoicePlane/InvoicePlane:develop")
from
[naui95:develop](/naui95/InvoicePlane/tree/develop "naui95/InvoicePlane:develop")

Jul 10, 2022

 Merged

# [fix for CVE-2021-29023 #733](#top) #767

[nielsdrost7](/nielsdrost7)
merged 4 commits into
[InvoicePlane:develop](/InvoicePlane/InvoicePlane/tree/develop "InvoicePlane/InvoicePlane:develop")
from
[naui95:develop](/naui95/InvoicePlane/tree/develop "naui95/InvoicePlane:develop")

Jul 10, 2022

[Conversation
2](/InvoicePlane/InvoicePlane/pull/767)
[Commits
4](/InvoicePlane/InvoicePlane/pull/767/commits)
[Checks
0](/InvoicePlane/InvoicePlane/pull/767/checks)
[Files changed](/InvoicePlane/InvoicePlane/pull/767/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![naui95](https://avatars.githubusercontent.com/u/6253240?s=60&v=4)](/naui95)

Copy link

Contributor

### @naui95 **[naui95](/naui95)** commented [Oct 10, 2021](#issue-1022038835) ‚Ä¢ edited Loading

Pull Request Checklist

* My code follows the code formatting guidelines.
* I have an issue ID for this pull request. ([[1.5.12?] CVE-2021-29023: password reset rate limiting¬†#733](https://github.com/InvoicePlane/InvoicePlane/issues/733))
* I selected the corresponding branch.
* I have rebased my changes on top of the corresponding branch.

Issue Type (Please check one or more)

* Bugfix
* Improvement of an existing Feature
* New Feature

Sorry, something went wrong.

 üëÄ
1
 onny reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

 [naui95](/naui95)
added 3 commits
[October 10, 2021 16:08](#commits-pushed-5f2337f)

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&v=4)](/naui95)

`[prevent predictability of recovery token](/InvoicePlane/InvoicePlane/pull/767/commits/5f2337fb598d326cfbedc52ba54fb4045594c311 "prevent predictability of recovery token #733") [InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)`

`[5f2337f](/InvoicePlane/InvoicePlane/pull/767/commits/5f2337fb598d326cfbedc52ba54fb4045594c311)`

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&v=4)](/naui95)

`[create the log table](/InvoicePlane/InvoicePlane/pull/767/commits/cfecd073d3d8d2b423bafc81288d198762e49994 "create the log table")`

`[cfecd07](/InvoicePlane/InvoicePlane/pull/767/commits/cfecd073d3d8d2b423bafc81288d198762e49994)`

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&v=4)](/naui95)

`[implement rate limiting](/InvoicePlane/InvoicePlane/pull/767/commits/b612068db81c61d016dc5380e76c498373316703 "implement rate limiting
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
#733")`
 ‚Ä¶

`[b612068](/InvoicePlane/InvoicePlane/pull/767/commits/b612068db81c61d016dc5380e76c498373316703)`

```
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
[InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)
```

[![nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=60&v=4)](/nielsdrost7)

**[nielsdrost7](/nielsdrost7)**
reviewed
[Oct 13, 2021](#pullrequestreview-778128530)

 [View reviewed changes](/InvoicePlane/InvoicePlane/pull/767/files/cfecd073d3d8d2b423bafc81288d198762e49994)

[application/modules/setup/sql/035\_1.5.12.sql](/InvoicePlane/InvoicePlane/pull/767/files/5f2337fb598d326cfbedc52ba54fb4045594c311..cfecd073d3d8d2b423bafc81288d198762e49994#diff-4f4107690393851b6d11ad027ff9217150fce96def51a79335ddb63cecccb78b)

|  |  | @@ -1 +1,6 @@ | |
| --- | --- | --- | --- |
|  |  | # Added for versioning |
|  |  | CREATE TABLE `ip\_login\_log` ( |

Copy link

Contributor

### @nielsdrost7 **[nielsdrost7](/nielsdrost7)** [Oct 13, 2021](#discussion_r727729945)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Shouldn't we rely on the table prefix here? It wouldn't always be 'ip\_', right?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @naui95 **[naui95](/naui95)** [Oct 13, 2021](#discussion_r728425762)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

As I could see, the whole IP code base does not rely on a dynamic prefix, but always uses `ip_` as prefix. All the queries I saw called the tables by passing directly `ip_`

Sorry, something went wrong.

 üëç
1
 nielsdrost7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@onny](https://avatars.githubusercontent.com/u/757752?s=40&v=4)](/onny)
[onny](/onny)
mentioned this pull request
[Apr 9, 2022](#ref-pullrequest-1198606255)

[invocieplane: Add patches for CVE-2021-29024, CVE-2021-29023
NixOS/nixpkgs#167996](/NixOS/nixpkgs/pull/167996)
 Merged

13 tasks

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&v=4)](/naui95)

`[Merge branch 'InvoicePlane:develop' into develop](/InvoicePlane/InvoicePlane/pull/767/commits/45e8f3bb7b60eaa671c944a5666a294d182844c1 "Merge branch 'InvoicePlane:develop' into develop")`

`[45e8f3b](/InvoicePlane/InvoicePlane/pull/767/commits/45e8f3bb7b60eaa671c944a5666a294d182844c1)`

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)
[nielsdrost7](/nielsdrost7)
merged commit [`f4fe13c`](/InvoicePlane/InvoicePlane/commit/f4fe13c6edc76667221d3b6e3dc93b5a24d57d95)
into
InvoicePlane:develop

[Jul 10, 2022](https://github.com/InvoicePlane/InvoicePlane/pull/767#event-6965201414)

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)
[nielsdrost7](/nielsdrost7)
mentioned this pull request
[Jul 31, 2022](#ref-issue-919673780)

[[1.5.12?] CVE-2021-29023: password reset rate limiting
#733](/InvoicePlane/InvoicePlane/issues/733)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fpull%2F767)

Reviewers

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&v=4)](/nielsdrost7) [nielsdrost7](/nielsdrost7)

nielsdrost7 left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=52&v=4)](/naui95) [![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=52&v=4)](/nielsdrost7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_6da62660_20250115_115358.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fissues%2F733)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fissues%2F733)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=InvoicePlane%2FInvoicePlane)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[InvoicePlane](/InvoicePlane)
/
**[InvoicePlane](/InvoicePlane/InvoicePlane)**
Public

* [Notifications](/login?return_to=%2FInvoicePlane%2FInvoicePlane) You must be signed in to change notification settings
* [Fork
  811](/login?return_to=%2FInvoicePlane%2FInvoicePlane)
* [Star
   2.6k](/login?return_to=%2FInvoicePlane%2FInvoicePlane)

* [Code](/InvoicePlane/InvoicePlane)
* [Issues
  76](/InvoicePlane/InvoicePlane/issues)
* [Pull requests
  31](/InvoicePlane/InvoicePlane/pulls)
* [Discussions](/InvoicePlane/InvoicePlane/discussions)
* [Projects
  0](/InvoicePlane/InvoicePlane/projects)
* [Security](/InvoicePlane/InvoicePlane/security)
* [Insights](/InvoicePlane/InvoicePlane/pulse)

Additional navigation options

* [Code](/InvoicePlane/InvoicePlane)
* [Issues](/InvoicePlane/InvoicePlane/issues)
* [Pull requests](/InvoicePlane/InvoicePlane/pulls)
* [Discussions](/InvoicePlane/InvoicePlane/discussions)
* [Projects](/InvoicePlane/InvoicePlane/projects)
* [Security](/InvoicePlane/InvoicePlane/security)
* [Insights](/InvoicePlane/InvoicePlane/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FInvoicePlane%2FInvoicePlane%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FInvoicePlane%2FInvoicePlane%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [1.5.12?] CVE-2021-29023: password reset rate limiting #733

Closed

[zeitschlag](/zeitschlag) opened this issue
Jun 12, 2021
¬∑ 4 comments

Closed

# [[1.5.12?] CVE-2021-29023: password reset rate limiting](#top) #733

[zeitschlag](/zeitschlag) opened this issue
Jun 12, 2021
¬∑ 4 comments

Milestone
[1.5.12](/InvoicePlane/InvoicePlane/milestone/8 "1.5.12")

## Comments

[![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=80&u=03831f778836cfa2a6d98ada6a2503d67462098d&v=4)](/zeitschlag)

Copy link

Contributor

### **[zeitschlag](/zeitschlag)** commented [Jun 12, 2021](#issue-919673780) ‚Ä¢ edited Loading

| InvoicePlane 1.5.11 doesn't have any rate-limiting for password reset and the reset token is generated using a weak mechanism that is predictable.   * [cve.mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29023) * [Exploit](https://notnnor.github.io/research/2021/03/16/weak-password-recovery-mechanism-in-invoiceplane.html) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëÄ
1
 onny reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

[![@UnderDogg](https://avatars.githubusercontent.com/u/592703?s=40&u=a0ca8ed12c6296b24f154cd553bae6306dfaa23e&v=4)](/UnderDogg)
[UnderDogg](/UnderDogg)
changed the title
~~CVE-2021-29023~~
CVE-2021-29023: password reset rate limiting
[Jun 13, 2021](#event-4881961641)

[![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=40&u=03831f778836cfa2a6d98ada6a2503d67462098d&v=4)](/zeitschlag)
[zeitschlag](/zeitschlag)
added this to the [v1.5.12](/InvoicePlane/InvoicePlane/milestone/8) milestone
[Jun 13, 2021](#event-4882129402)

[![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=40&u=03831f778836cfa2a6d98ada6a2503d67462098d&v=4)](/zeitschlag)
[zeitschlag](/zeitschlag)
self-assigned this
[Jun 13, 2021](#event-4882130394)

[![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=80&u=03831f778836cfa2a6d98ada6a2503d67462098d&v=4)](/zeitschlag)

Copy link

Contributor

Author

### **[zeitschlag](/zeitschlag)** commented [Jun 13, 2021](#issuecomment-860188621)

| The idea is to do two things as a quick fix:   * We not only check if there's a user with this mail, but also if there's already a password reset token stored in the database for them. If so, we don't generate a new one. ([L. 169](https://github.com/InvoicePlane/InvoicePlane/blob/develop/application/modules/sessions/controllers/Sessions.php#L169)) * To harden things, we add a salt when it comes to hashing.   Feel free to add your thoughts :) |
| --- |

 üëç
1
 nielsdrost7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@UnderDogg](https://avatars.githubusercontent.com/u/592703?s=80&u=a0ca8ed12c6296b24f154cd553bae6306dfaa23e&v=4)](/UnderDogg)

Copy link

Contributor

### **[UnderDogg](/UnderDogg)** commented [Jun 29, 2021](#issuecomment-870517472)

| See PR [#743](https://github.com/InvoicePlane/InvoicePlane/pull/743) |
| --- |

All reactions

Sorry, something went wrong.

[![@UnderDogg](https://avatars.githubusercontent.com/u/592703?s=40&u=a0ca8ed12c6296b24f154cd553bae6306dfaa23e&v=4)](/UnderDogg)
[UnderDogg](/UnderDogg)
mentioned this issue
[Jun 29, 2021](#ref-pullrequest-931783418)

[Patch for CVE-2021-29022 and CVE-2021-29023
#743](/InvoicePlane/InvoicePlane/pull/743)
 Closed

5 tasks

[![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=40&u=03831f778836cfa2a6d98ada6a2503d67462098d&v=4)](/zeitschlag)
[zeitschlag](/zeitschlag)
removed their assignment
[Aug 6, 2021](#event-5123422162)

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Oct 10, 2021](#ref-commit-5f2337f)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[prevent predictability of recovery token](/naui95/InvoicePlane/commit/5f2337fb598d326cfbedc52ba54fb4045594c311 "prevent predictability of recovery token #733") [InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)`

`[5f2337f](/naui95/InvoicePlane/commit/5f2337fb598d326cfbedc52ba54fb4045594c311)`

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Oct 10, 2021](#ref-commit-b612068)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[implement rate limiting](/naui95/InvoicePlane/commit/b612068db81c61d016dc5380e76c498373316703 "implement rate limiting
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
#733")`
‚Ä¶

`[b612068](/naui95/InvoicePlane/commit/b612068db81c61d016dc5380e76c498373316703)`

```
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
[InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)
```

[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)
[naui95](/naui95)
mentioned this issue
[Oct 10, 2021](#ref-pullrequest-1022038835)

[fix for CVE-2021-29023 #733
#767](/InvoicePlane/InvoicePlane/pull/767)
 Merged

7 tasks

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=80&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)

Copy link

Contributor

### **[nielsdrost7](/nielsdrost7)** commented [Dec 24, 2021](#issuecomment-1000738885)

| refs [#739](https://github.com/InvoicePlane/InvoicePlane/pull/739) |
| --- |

All reactions

Sorry, something went wrong.

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)
[nielsdrost7](/nielsdrost7)
changed the title
~~CVE-2021-29023: password reset rate limiting~~
[1.5.12?] CVE-2021-29023: password reset rate limiting
[Dec 24, 2021](#event-5813059919)

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Jun 11, 2022](#ref-commit-ff0a9ef)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[prevent predictability of recovery token](/naui95/InvoicePlane/commit/ff0a9ef772ee10608aaad3a228d8ada8163d8d96 "prevent predictability of recovery token #733") [InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)`

`[ff0a9ef](/naui95/InvoicePlane/commit/ff0a9ef772ee10608aaad3a228d8ada8163d8d96)`

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Jun 11, 2022](#ref-commit-fc9bffa)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[implement rate limiting](/naui95/InvoicePlane/commit/fc9bffaf65b6d1a712ff8d1d69cfc93922d0af9c "implement rate limiting
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
#733")`
‚Ä¶

`[fc9bffa](/naui95/InvoicePlane/commit/fc9bffaf65b6d1a712ff8d1d69cfc93922d0af9c)`

```
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
[InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)
```

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Jun 11, 2022](#ref-commit-95068f2)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[prevent predictability of recovery token](/naui95/InvoicePlane/commit/95068f2b5f3d9c4e51d5f240b47531f9e8170f69 "prevent predictability of recovery token #733") [InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)`

`[95068f2](/naui95/InvoicePlane/commit/95068f2b5f3d9c4e51d5f240b47531f9e8170f69)`

[naui95](/naui95)
added a commit
to naui95/InvoicePlane
that referenced
this issue
[Jun 11, 2022](#ref-commit-2e8aecc)
[![@naui95](https://avatars.githubusercontent.com/u/6253240?s=40&u=da303c755a134bc5f87aa18e78616a0d5da81457&v=4)](/naui95)

`[implement rate limiting](/naui95/InvoicePlane/commit/2e8aecc7d49cada0870f7f80988abaee2aac21b2 "implement rate limiting
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
#733")`
‚Ä¶

`[2e8aecc](/naui95/InvoicePlane/commit/2e8aecc7d49cada0870f7f80988abaee2aac21b2)`

```
implements rate limiting for:
- login attempts
- password recovery attempts
-password recovery token use
[InvoicePlane#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)
```

[nielsdrost7](/nielsdrost7)
added a commit
that referenced
this issue
[Jul 10, 2022](#ref-commit-f4fe13c)
[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)

`[Merge pull request](/InvoicePlane/InvoicePlane/commit/f4fe13c6edc76667221d3b6e3dc93b5a24d57d95 "Merge pull request #767 from naui95/develop

fix for CVE-2021-29023 #733") [#767](https://github.com/InvoicePlane/InvoicePlane/pull/767) [from naui95/develop](/InvoicePlane/InvoicePlane/commit/f4fe13c6edc76667221d3b6e3dc93b5a24d57d95 "Merge pull request #767 from naui95/develop

fix for CVE-2021-29023 #733")`
‚Ä¶

`[f4fe13c](/InvoicePlane/InvoicePlane/commit/f4fe13c6edc76667221d3b6e3dc93b5a24d57d95)`

```
fix for [CVE-2021-29023](https://github.com/advisories/GHSA-q62q-p9mg-92r4 "CVE-2021-29023") [#733](https://github.com/InvoicePlane/InvoicePlane/issues/733)
```

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=80&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)

Copy link

Contributor

### **[nielsdrost7](/nielsdrost7)** commented [Jul 31, 2022](#issuecomment-1200412511)

| Solved by PR [#767](https://github.com/InvoicePlane/InvoicePlane/pull/767) |
| --- |

All reactions

Sorry, something went wrong.

[![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=40&u=3ec537a5de8257603496654d672524ffdd669cf0&v=4)](/nielsdrost7)
[nielsdrost7](/nielsdrost7)
closed this as [completed](/InvoicePlane/InvoicePlane/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 31, 2022](#event-7096242188)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FInvoicePlane%2FInvoicePlane%2Fissues%2F733)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**1.5.12**](/InvoicePlane/InvoicePlane/milestone/8 "1.5.12")

Development

No branches or pull requests

3 participants

[![@UnderDogg](https://avatars.githubusercontent.com/u/592703?s=52&v=4)](/UnderDogg) [![@zeitschlag](https://avatars.githubusercontent.com/u/2580019?s=52&v=4)](/zeitschlag) [![@nielsdrost7](https://avatars.githubusercontent.com/u/47660417?s=52&v=4)](/nielsdrost7)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from notnnor.github.io_b47c2ef6_20250114_195522.html ===


Weak Password Recovery Mechanism in InvoicePlane CRM

[‚Üê Home](https://notnnor.github.io)
# Weak Password Recovery Mechanism in InvoicePlane CRM

Mar 16, 2021

## Summary

InvoicePlane is one of the popular open-source CRM. During the search for a PHP based open-source CRM in Github, this comes mostly within first ten.

The latest version of InvoicePlane (v1.5.11) has a weak password recovery mechanism which could lead to¬†authenticated remote code execution. Without further wasting your time let‚Äôs dive into the details.

* CWE-640: Weak Password Recovery Mechanism for Forgotten Password
* CWE-770: Allocation of Resources Without Limits or Throttling

The application allows users to reset their passwords by sending a reset link via email. As usual, the application allows the user to reset a new password by visiting the link. Here the things seem to be normal on the surface, but when we dive into source code things are different.

#### Proof of Concept

The password reset feature doesn‚Äôt have any rate-limiting mechanism implemented to prevent brute force. When a user requests¬†a password reset, the¬†application generates a reset token stores it in the database. The problem is, during this token generation application concatenates the current time and email to generate an MD5 hash then uses this generated hash as a token. Since there is no rate limiting, if the attacker has the users‚Äô email address predicting this token becomes so easy. During the password generation, through the response date header attacker can figure out the time value as well.

![invoiceplane password reset](/images/invoiceplane/password-reset-token-code.png "Password Reset Code")

As seen on the above image, at line 172 application concatenates the current server time and user email to generate a token.

![invoiceplane password reset success](/images/invoiceplane/password-reset-token-success.png "Password Reset Success Message")

The above image shows the successful password change using the exploit.

* [notnnor](https://notnnor.github.io/about.html)
* notnnor@gmail.com


