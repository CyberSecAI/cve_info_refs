- **Root cause of vulnerability:** Stored Cross-Site Scripting (XSS) vulnerability exists due to insufficient sanitization of DNS query data that is later displayed in the Pi-hole Admin web interface. Specifically, the vulnerability is triggered when a crafted DNS query containing a malicious script is resolved by the Pi-hole server, and the query is later viewed by an administrator in the Query Log.
- **Weaknesses/vulnerabilities present:**
    - Stored XSS vulnerability
    - Lack of input sanitization for DNS queries displayed in the web interface.
- **Impact of exploitation:**
    - An attacker can execute arbitrary JavaScript code in the context of the administrator's browser.
    - This can lead to potential compromise of the Pi-hole system including:
      - Accessing sensitive information available to the administrator.
      - Performing actions on behalf of the administrator.
      - Potentially taking over the administrative interface
      - As stated in the rationale, "the threat actor can do the same actions as admin and access the same data as admin"
    - The impact on availability is high since the admin panel allows for the switching off the Pi-hole.
- **Attack vectors:**
    - The attacker must have network access to the Pi-hole DNS server.
    - The attacker needs to send crafted DNS queries containing malicious JavaScript code.
    - The victim must be a legitimate administrator of the Pi-hole instance.
    - The victim has to authenticate to the web interface and view the query log data.
- **Required attacker capabilities/position:**
    - Network access to the Pi-hole DNS server.
    - Ability to send crafted DNS queries to the Pi-hole DNS server.
    - No need for prior authentication.