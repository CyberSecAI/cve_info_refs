```
{
  "CVE-2021-29136": {
    "related_content": [
      {
        "source": "github.com_37686e88_20250115_190548.html",
        "vulnerability": {
          "root_cause": "The vulnerability stems from a lack of proper input validation when unpacking container image layers. Specifically, umoci fails to prevent a malicious layer from replacing the rootfs directory with a symlink, which allows an attacker to control where subsequent image layers are applied.",
          "weaknesses": [
            "Improper input validation",
             "Path traversal via symlink manipulation"
          ],
          "impact": "An attacker can overwrite arbitrary host files by creating a malicious layer with a symlink for '.' or '/', then subsequent image layers will be applied to that target. This could result in code execution, data loss, or other system compromise.",
          "attack_vectors": [
            "A crafted OCI image layer",
            "Specifically a layer containing a symlink entry for '.' or '/'"
           ],
          "required_attacker_capabilities": "An attacker needs the ability to create a malicious OCI image layer and convince a user to unpack the image using vulnerable versions of umoci. The attacker requires the same level of access as the user running umoci.",
           "additional_details": "The vulnerability affects both `umoci unpack` and `umoci raw unpack`. Defenses against symlink-based attacks are insufficient as they resolve relative to the rootfs directory, which can itself be a symlink."
        }
      },
      {
         "source": "github.com_8aae8c0f_20250115_190545.html",
         "vulnerability": "NOINFO"
      },
      {
        "source":"github.com_364ee1aa_20250115_190550.html",
        "vulnerability": {
          "root_cause": "The root cause of this vulnerability is the ability of an attacker to create a malicious layer that changes the type of the root directory `/` to a symlink during image extraction. This is possible because umoci's checks for symlink-based attacks are performed relative to the rootfs directory, and these checks become ineffective when the rootfs itself is a symlink. By changing the type of `/`, an attacker can control the location where subsequent image layers are applied, leading to the overwrite of host files.",
           "weaknesses":[
             "Improper handling of symlinks during layer extraction",
              "Insufficient validation of root directory type"
            ],
          "impact": "An attacker can overwrite host files with a specially crafted image layer containing a symlink entry for `/`.",
          "attack_vectors": [
            "A malicious OCI image layer",
            "Specifically, a layer containing a symlink entry for `/`"
             ],
          "required_attacker_capabilities": "The attacker must be able to craft a malicious OCI image layer and convince a user to unpack the image using vulnerable versions of umoci.",
          "additional_details": "This commit addresses the issue by adding a check to prevent changing the type of the root directory `/` during layer extraction."
        }
      },
      {
        "source": "www.openwall.com_d9306e47_20250114_212437.html",
        "vulnerability": {
          "root_cause": "The vulnerability arises from umoci's failure to prevent a malicious layer from replacing the root filesystem with a symlink pointing to an arbitrary location. When processing image layers, umoci deletes inodes if their types change. This allows a malicious layer with a symlink named '.' or '/' to replace the rootfs directory with an attacker-controlled symlink. Subsequent layers would then be applied to the symlink's target, enabling host file overwrites.",
          "weaknesses": [
           "Inadequate symlink handling during layer extraction",
            "Lack of validation when deleting inodes"
           ],
          "impact": "An attacker can overwrite arbitrary host files by creating a malicious layer with a symlink for '.' or '/', then subsequent image layers will be applied to that target. This could lead to arbitrary code execution, data loss or other system compromise.",
          "attack_vectors": [
           "A crafted OCI image layer",
           "Specifically a layer containing a symlink entry for '.' or '/'"
           ],
          "required_attacker_capabilities": "The attacker needs the ability to create a malicious OCI image layer and entice a user to unpack the image with a vulnerable version of umoci. The attacker requires the same level of access as the user running umoci.",
           "additional_details":"The vulnerability impacts both `umoci unpack` and `umoci raw unpack`. While defenses against symlink attacks exist, they resolve relative to rootfs, which is vulnerable if changed to a symlink."
        }
      },
     {
        "source":"github.com_15d4d744_20250115_190542.html",
        "vulnerability": {
          "root_cause": "The vulnerability is caused by umoci's improper handling of symlinks in image layers. Specifically, if a malicious layer contains a symlink named '.' or '/', umoci will replace the rootfs directory with a symlink to a location controlled by the attacker. Subsequent layers will then be applied to the symlink's target, allowing for the overwrite of host files.",
           "weaknesses": [
              "Improper symlink handling during image layer extraction",
              "Insufficient validation of rootfs modifications"
            ],
           "impact": "An attacker can overwrite arbitrary host files by creating a malicious layer with a symlink for '.' or '/'. This can lead to arbitrary code execution, data loss, and other forms of system compromise.",
            "attack_vectors": [
             "A malicious OCI image layer",
             "Specifically, a layer containing a symlink entry for '.' or '/'"
              ],
            "required_attacker_capabilities": "The attacker needs the ability to create a malicious OCI image layer and entice a user to unpack the image using a vulnerable version of umoci. The attacker requires the same level of access as the user running umoci.",
            "additional_details": "The issue affects both `umoci unpack` and `umoci raw unpack`. Although umoci has defenses against symlink attacks, these are bypassed when the rootfs itself is a symlink."
        }
      }
    ],
    "unrelated_content":[
      "github.com_dba769c8_20250115_190550.html",
      "docs.github.com_d782ce82_20250115_190543.html",
      "github.com_a1b59367_20250115_190549.html"
     ]
  }
}
```