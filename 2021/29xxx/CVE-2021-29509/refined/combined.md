=== Content from gist.github.com_91f685de_20250115_082747.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837&source=header-gist)

[Sign¬†in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837) [Sign¬†up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@nateberkopec](https://avatars.githubusercontent.com/u/845662?s=64&v=4)](/nateberkopec)

# [nateberkopec](/nateberkopec)/**[keepalive.patch](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837)** Secret

Created
May 11, 2021 14:17

Show Gist options

* [Download ZIP](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/archive/6567b2eafb1f351e6f54b4dd200039e836d5092d.zip)

* [Star
  (3)
  3](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837)You must be signed in to star a gist
* [Fork
  (2)
  2](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837.js&quot;&gt;&lt;/script&gt;
* Save nateberkopec/4b3ea5676c0d70cbb37c82d54be25837 to your computer and use it in GitHub Desktop.

[Code](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837)
[Revisions
1](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/revisions)
[Stars
2](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/stargazers)
[Forks
2](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837.js&quot;&gt;&lt;/script&gt;

Save nateberkopec/4b3ea5676c0d70cbb37c82d54be25837 to your computer and use it in GitHub Desktop.

[Download ZIP](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/archive/6567b2eafb1f351e6f54b4dd200039e836d5092d.zip)

Puma keepalive patch

 [Raw](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837/raw/6567b2eafb1f351e6f54b4dd200039e836d5092d/keepalive.patch)

[**keepalive.patch**](#file-keepalive-patch)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From df72887170c7ef3614c941c9bdefb4a1f3546ebf Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: Nate Berkopec <nate.berkopec@gmail.com> |
|  | Date: Tue, 11 May 2021 07:43:32 -0600 |
|  | Subject: [PATCH] Close keepalive connections after MAX\_FAST\_INLINE requests |
|  |  |
|  | --- |
|  | lib/puma/server.rb | 21 +++++++++++++-------- |
|  | 1 file changed, 13 insertions(+), 8 deletions(-) |
|  |  |
|  | diff --git a/lib/puma/server.rb b/lib/puma/server.rb |
|  | index 3912699c..32bdbd2e 100644 |
|  | --- a/lib/puma/server.rb |
|  | +++ b/lib/puma/server.rb |
|  | @@ -447,15 +447,20 @@ module Puma |
|  |  |
|  | requests += 1 |
|  |  |
|  | - check\_for\_more\_data = @status == :run |
|  | + # Closing keepalive sockets after they've made a reasonable |
|  | + # number of requests allows Puma to service many connections |
|  | + # fairly, even when the number of concurrent connections exceeds |
|  | + # the size of the threadpool. It also allows cluster mode Pumas |
|  | + # to keep load evenly distributed across workers, because clients |
|  | + # are randomly assigned a new worker when opening a new connection. |
|  | + # |
|  | + # Previously, Puma would kick connections in this conditional back |
|  | + # to the reactor. However, because this causes the todo set to increase |
|  | + # in size, the wait\_until\_full mutex would never unlock, leaving |
|  | + # any additional connections unserviced. |
|  | + break if requests >= @max\_fast\_inline |
|  |  |
|  | - if requests >= @max\_fast\_inline |
|  | - # This will mean that reset will only try to use the data it already |
|  | - # has buffered and won't try to read more data. What this means is that |
|  | - # every client, independent of their request speed, gets treated like a slow |
|  | - # one once every max\_fast\_inline requests. |
|  | - check\_for\_more\_data = false |
|  | - end |
|  | + check\_for\_more\_data = @status == :run |
|  |  |
|  | next\_request\_ready = with\_force\_shutdown(client) do |
|  | client.reset(check\_for\_more\_data) |
|  | -- |
|  | 2.30.1 (Apple Git-130) |

[![@MarcelRaschke](https://avatars.githubusercontent.com/u/42359664?s=80&v=4)](/MarcelRaschke)

Copy link

### **[MarcelRaschke](/MarcelRaschke)** commented [May 20, 2021](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837?permalink_comment_id=3750174#gistcomment-3750174)

patch

Sorry, something went wrong.

[![@curtcurt87](https://avatars.githubusercontent.com/u/53494858?s=80&v=4)](/curtcurt87)

Copy link

### **[curtcurt87](/curtcurt87)** commented [May 27, 2021](/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837?permalink_comment_id=3759602#gistcomment-3759602)

patch

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnateberkopec%2F4b3ea5676c0d70cbb37c82d54be25837)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from rubygems.org_d80a5f07_20250115_082755.html ===


[‚¨¢
RubyGems](/ "RubyGems") Navigation menu

Search Gems‚Ä¶

[Releases](https://rubygems.org/releases)
[Blog](https://blog.rubygems.org)
[Gems](/gems)
[Guides](https://guides.rubygems.org)
[Sign in](/sign_in)
[Sign up](/sign_up)

# [puma](/gems/puma) *6.5.0*

Puma is a simple, fast, multi-threaded, and highly parallel HTTP 1.1 server
for Ruby/Rack applications. Puma is intended for use in both development and
production environments. It's great for highly parallel Ruby implementations such as
JRuby and TruffleRuby as well as as providing process worker support to support CRuby well.

## Gemfile: =

## install: =

### Versions:

1. [6.5.0](/gems/puma/versions/6.5.0-java)
   November 22, 2024
   java
   (254 KB)
2. [6.5.0](/gems/puma/versions/6.5.0)
   November 22, 2024
   (232 KB)
3. [6.4.3](/gems/puma/versions/6.4.3-java)
   September 19, 2024
   java
   (249 KB)
4. [6.4.3](/gems/puma/versions/6.4.3)
   September 19, 2024
   (226 KB)
5. [6.4.2](/gems/puma/versions/6.4.2-java)
   January 08, 2024
   java
   (248 KB)

[Show all versions (337 total)](https://rubygems.org/gems/puma/versions)

### Runtime Dependencies (1):

[**nio4r**](/gems/nio4r)
~> 2.0

[Show all transitive dependencies](/gems/puma/versions/6.5.0/dependencies)

### Owners:

[![](/users/42258/avatar.jpeg?size=48&theme=light)](/profiles/evan "evan")[![](/users/49862/avatar.jpeg?size=48&theme=light)](/profiles/schneems "schneems")[![](/users/62792/avatar.jpeg?size=48&theme=light)](/profiles/nateberkopec "nateberkopec")
### Pushed by:

[![](/users/62792/avatar.jpeg?size=48&theme=light)](/profiles/nateberkopec "nateberkopec")
### Authors:

* Evan Phoenix

### SHA 256 checksum:

=

[‚Üê Previous version](/gems/puma/versions/6.4.3)

## Total downloads 419,390,813

## For this version 3,292,509

## Version Released: November 22, 2024 11:50pm

## License: BSD-3-Clause

## Required Ruby Version: *>= 2.4*

## New versions require MFA: true

## Version published with MFA: true

### Links:

[Homepage](https://puma.io)
[Changelog](https://github.com/puma/puma/blob/master/History.md)
[Source Code](https://github.com/puma/puma)
[Bug Tracker](https://github.com/puma/puma/issues)
[Download](/downloads/puma-6.5.0.gem)
[Review changes](https://my.diffend.io/gems/puma/prev/6.5.0)
[Badge](https://badge.fury.io/rb/puma/install)
[Subscribe](/sign_in)
[RSS](/gems/puma/versions.atom)
Report abuse
[Reverse dependencies](/gems/puma/reverse_dependencies)

[Status](https://status.rubygems.org)
[Uptime](https://uptime.rubygems.org)
[Code](https://github.com/rubygems/rubygems.org)
[Data](/pages/data)
[Discuss](https://groups.google.com/group/rubygems-org)
[Stats](/stats)
[Contribute](https://guides.rubygems.org/contributing/)
[About](/pages/about)
Help
[API](https://guides.rubygems.org/rubygems-org-api)
[Security](/pages/security)

RubyGems.org is the Ruby community‚Äôs gem hosting service. Instantly [publish your gems](https://guides.rubygems.org/publishing/) and then [install them](https://guides.rubygems.org/command-reference/#gem-install). Use [the API](https://guides.rubygems.org/rubygems-org-api/) to find out more about [available gems](/gems). [Become a contributor](https://guides.rubygems.org/contributing/) and improve the site yourself.

RubyGems.org is made possible through a partnership with the greater Ruby community. [Fastly](https://www.fastly.com/) provides bandwidth and CDN support, [Ruby Central](https://www.rubycentral.org/) covers infrastructure costs, and funds ongoing development and ops work. [Learn more about our sponsors and how they work together](/pages/sponsors).

We need your help to fund the developer time that keeps RubyGems.org running smoothly for everyone. [Join Ruby Central today](https://rubycentral.org/#/portal/signup).

[Supported by
Ruby Central](https://rubycentral.org/)
[Designed by
DockYard](https://dockyard.com/ruby-on-rails-consulting)
[Resolved with
DNSimple](https://dnsimple.link/resolving-rubygems)
[Monitored by
Datadog](https://www.datadoghq.com/)
[Gems served by
Fastly](https://www.fastly.com/)
[Monitored by
Honeybadger](https://www.honeybadger.io/)
[Verified by
Domainr](https://domainr.com/)
[Secured by
Whitesource](https://mend.io/)

[English](/gems/puma?locale=en)

[Nederlands](/gems/puma?locale=nl)

[ÁÆÄ‰Ωì‰∏≠Êñá](/gems/puma?locale=zh-CN)

[Ê≠£È´î‰∏≠Êñá](/gems/puma?locale=zh-TW)

[Portugu√™s do Brasil](/gems/puma?locale=pt-BR)

[Fran√ßais](/gems/puma?locale=fr)

[Espa√±ol](/gems/puma?locale=es)

[Deutsch](/gems/puma?locale=de)

[Êó•Êú¨Ë™û](/gems/puma?locale=ja)



=== Content from github.com_cc2888ca_20250115_082749.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpuma%2Fpuma%2Fsecurity%2Fpolicy)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpuma%2Fpuma%2Fsecurity%2Fpolicy)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fsecurity%2Fpolicy&source=header-repo&source_repo=puma%2Fpuma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[puma](/puma)
/
**[puma](/puma/puma)**
Public

* [Notifications](/login?return_to=%2Fpuma%2Fpuma) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpuma%2Fpuma)
* [Star
   7.7k](/login?return_to=%2Fpuma%2Fpuma)

* [Code](/puma/puma)
* [Issues
  66](/puma/puma/issues)
* [Pull requests
  27](/puma/puma/pulls)
* [Discussions](/puma/puma/discussions)
* [Actions](/puma/puma/actions)
* [Security](/puma/puma/security)
* [Insights](/puma/puma/pulse)

Additional navigation options

* [Code](/puma/puma)
* [Issues](/puma/puma/issues)
* [Pull requests](/puma/puma/pulls)
* [Discussions](/puma/puma/discussions)
* [Actions](/puma/puma/actions)
* [Security](/puma/puma/security)
* [Insights](/puma/puma/pulse)

# Security: puma/puma

## Security Navigation

* [Overview](/puma/puma/security)
* ### Reporting

  + [Policy](/puma/puma/security/policy)
  + [Advisories](/puma/puma/security/advisories)

### SECURITY.md

# Security Policy

## Supported Versions

| Version | Supported |
| --- | --- |
| Latest release in 6.x | ‚úÖ |
| Latest release in 5.x | ‚úÖ |
| All other releases | ‚ùå |

## Reporting a Vulnerability

Contact [Evan Phoenix.](https://github.com/evanphx)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_be92b889_20250115_082754.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3083-1] puma security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3083-1] puma security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Sun, 28 Aug 2022 00:37:44 +0530
* *Message-id*: <[[üîé]](/msgid-search/YwprgOCcqliTeu2c%40debian.org)¬†[YwprgOCcqliTeu2c@debian.org](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3083-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
August 28, 2022                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : puma
Version        : 3.12.0-2+deb10u3
CVE ID         : CVE-2021-29509 CVE-2021-41136 CVE-2022-23634
                 CVE-2022-24790

Multiple security issues have been found in puma, a web server for
ruby/rack applications.

CVE-2021-29509

    Keepalive Connections Causing Denial Of Service in puma.

CVE-2021-41136

    puma with a proxy which forwards HTTP header values which contain
    the LF character could allow HTTP request smugggling. A client
    could smuggle a request through a proxy, causing the proxy to send
    a response back to another unknown client.

CVE-2022-23634

    puma may not always call `close` on the response body. Rails,
    prior to version `7.0.2.2`, depended on the response body being
    closed in order for its `CurrentAttributes` implementation to work
    correctly. The combination of these two behaviors (Puma not
    closing the body + Rails' Executor implementation) causes
    information leakage.

CVE-2022-24790

    using Puma behind a proxy that does not properly validate that the
    incoming HTTP request matches the RFC7230 standard, Puma and the
    frontend proxy may disagree on where a request starts and ends.
    This would allow requests to be smuggled via the front-end proxy
    to Puma

For Debian 10 buster, these problems have been fixed in version
3.12.0-2+deb10u3.

We recommend that you upgrade your puma packages.

For the detailed security status of puma please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/puma>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmMKa4AACgkQhj1N8u2c
KO/g0RAAlWwo15hwfcDDYvECOydh4HYBcK9Z/lpSSHwDWFJ69eS2djnicDVVYGbu
7Ic/c7zLZy8nJ10UcyZ/9OarJbZ2N22sTPI7R5Rii3PqxSj6FRxB3IGVtrylIFdr
9i0qH4ONa2DHUqyJV8UzN+NWy55KdDnPz2+GGXKtzOTDEutSBQNwsXkM07SJ9YDp
6TUCegbAjlOZxKzh3HAANAQ/Ua0//3m8ofaoDJb9pfsAuxNrOhxNbCzVRH7qBYqd
87cnfnwX8AWNKree9OZWxLMh2gXgbgzJmwzcJjkQeN8JWMp+74yzAlN2/37yU/2d
JSfyAqQCwOfe73x09T4v74IBKitVf0eDxgEzi1R8gfe2V7s3mNF7mAkvtt3mkRGi
URsVhJUr0G4vQ2/UOFpeTAn/yIVv7eLOIDSsiMSJBfefmZPM2zrrrxjb1uAQ7cps
U6LnMOr4M+w6Huq2K19T1scLomaEml3lZHbR4lJStRIVxmiJOo6NBBVYlv1P9VyO
kChxXd2odH75EsILYVKIZa8GIXo1Gzm3Z2hVQim+pu2pSGYMWS16QVGr3jbNflEg
TXjcMl2ED5iw7MxYZl6t2DUKgD3XcYPEd5da7OvPj+PxG+1tdZFc0g8K96ssGlyy
tjHlJBEiGqoxjBzrEYVrWuSrSNoYXfZ+cy+iBiEXci247CPk4/I=
=Y4/2
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_b17876cb_20250115_082755.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Puma: Multiple Vulnerabilities ‚Äî GLSA **202208-28**

Multiple vulnerabilities have been discovered in Puma, the worst of which could result in denial of service.

### Affected packages

| Package | **www-servers/puma** on all architectures |
| --- | --- |
| Affected versions | < **5.6.4** |
| Unaffected versions | >= **5.6.4** |

### Background

Puma is a simple, fast, threaded, and highly concurrent HTTP 1.1 server for Ruby/Rack.

### Description

Multiple vulnerabilities have been discovered in Puma. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Puma users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-servers/puma-5.6.4"

```
### References

* [CVE-2021-29509](https://nvd.nist.gov/vuln/detail/CVE-2021-29509)
* [CVE-2021-41136](https://nvd.nist.gov/vuln/detail/CVE-2021-41136)
* [CVE-2022-23634](https://nvd.nist.gov/vuln/detail/CVE-2022-23634)
* [CVE-2022-24790](https://nvd.nist.gov/vuln/detail/CVE-2022-24790)

**Release date**

August 14, 2022

**Latest revision**

August 14, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [794034](https://bugs.gentoo.org/show_bug.cgi?id=794034)
* [817893](https://bugs.gentoo.org/show_bug.cgi?id=817893)
* [833155](https://bugs.gentoo.org/show_bug.cgi?id=833155)
* [836431](https://bugs.gentoo.org/show_bug.cgi?id=836431)

### Questions or comments?

Please feel free to contact us.

**¬© 2001‚Äì2020 Gentoo Foundation, Inc.**



=== Content from github.com_b65ff7e8_20250115_082748.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpuma%2Fpuma%2Fsecurity%2Fadvisories%2FGHSA-q28m-8xjw-8vr5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpuma%2Fpuma%2Fsecurity%2Fadvisories%2FGHSA-q28m-8xjw-8vr5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=puma%2Fpuma)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[puma](/puma)
/
**[puma](/puma/puma)**
Public

* [Notifications](/login?return_to=%2Fpuma%2Fpuma) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fpuma%2Fpuma)
* [Star
   7.7k](/login?return_to=%2Fpuma%2Fpuma)

* [Code](/puma/puma)
* [Issues
  66](/puma/puma/issues)
* [Pull requests
  27](/puma/puma/pulls)
* [Discussions](/puma/puma/discussions)
* [Actions](/puma/puma/actions)
* [Security](/puma/puma/security)
* [Insights](/puma/puma/pulse)

Additional navigation options

* [Code](/puma/puma)
* [Issues](/puma/puma/issues)
* [Pull requests](/puma/puma/pulls)
* [Discussions](/puma/puma/discussions)
* [Actions](/puma/puma/actions)
* [Security](/puma/puma/security)
* [Insights](/puma/puma/pulse)

# Keepalive Connections Causing Denial Of Service in puma

High

[nateberkopec](/nateberkopec)
published
GHSA-q28m-8xjw-8vr5
May 11, 2021

## Package

bundler

puma
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

<= 4.3.7, 5.x <= 5.3.0

## Patched versions

4.3.8, 5.3.1

## Description

This vulnerability is related to [CVE-2019-16770](https://github.com/puma/puma/security/advisories/GHSA-7xx3-m584-x994).

### Impact

The fix for [CVE-2019-16770](https://github.com/advisories/GHSA-7xx3-m584-x994 "CVE-2019-16770") was incomplete. The original fix only protected existing connections that had already been accepted from having their requests starved by greedy persistent-connections saturating all threads in the same process. However, new connections may still be starved by greedy persistent-connections saturating all threads in all processes in the cluster.

A `puma` server which received more concurrent `keep-alive` connections than the server had threads in its threadpool would service only a subset of connections, denying service to the unserved connections.

### Patches

This problem has been fixed in `puma` 4.3.8 and 5.3.1.

### Workarounds

Setting `queue_requests false` also fixes the issue. This is not advised when using `puma` without a reverse proxy, such as `nginx` or `apache`, because you will open yourself to slow client attacks (e.g. [slowloris](https://en.wikipedia.org/wiki/Slowloris_%28computer_security%29)).

The fix is very small. [A git patch is available here](https://gist.github.com/nateberkopec/4b3ea5676c0d70cbb37c82d54be25837) for those using [unsupported versions](https://github.com/puma/puma/security/policy#supported-versions) of Puma.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Puma](https://github.com/puma/puma).
* To report problems with this fix or to report another vulnerability, see [our security policy.](https://github.com/puma/puma/security/policy)

### Acknowledgements

Thank you to [@MSP-Greg](https://github.com/MSP-Greg), [@wjordan](https://github.com/wjordan) and [@evanphx](https://github.com/evanphx) for their review on this issue.

Thank you to [@ioquatix](https://github.com/ioquatix) for providing a modified fork of `wrk` which made debugging this issue much easier.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2021-29509

### Weaknesses

[CWE-410](/advisories?query=cwe%3A410)

### Credits

* [![@MSP-Greg](https://avatars.githubusercontent.com/u/15081176?s=40&v=4)](/MSP-Greg)
  [MSP-Greg](/MSP-Greg)
  Analyst
* [![@wjordan](https://avatars.githubusercontent.com/u/56541?s=40&v=4)](/wjordan)
  [wjordan](/wjordan)
  Analyst
* [![@ioquatix](https://avatars.githubusercontent.com/u/30030?s=40&v=4)](/ioquatix)
  [ioquatix](/ioquatix)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


