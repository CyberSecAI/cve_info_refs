=== Content from www.mozilla.org_84329039_20250114_181127.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-22

## Security Vulnerabilities fixed in Thunderbird 78.10.2

Announced
May 17, 2021
Impact
low
Products
Thunderbird
Fixed in

* Thunderbird 78.10.2

#### [#CVE-2021-29957: Partial protection of inline OpenPGP message not indicated](#CVE-2021-29957)

Reporter
Cure53
Impact
low
##### Description

If a MIME encoded email contains an OpenPGP inline signed or encrypted message part, but also contains an additional unprotected part, Thunderbird did not indicate that only parts of the message are protected.

##### References

* [Bug 1673241](https://bugzilla.mozilla.org/show_bug.cgi?id=1673241)

#### [#CVE-2021-29956: Thunderbird stored OpenPGP secret keys without master password protection](#CVE-2021-29956)

Reporter
Participants on the Thunderbird E2EE Mailing List
Impact
low
##### Description

OpenPGP secret keys that were imported using Thunderbird version 78.8.1 up to version 78.10.1 were stored unencrypted on the user's local disk. The master password protection was inactive for those keys. Version 78.10.2 will restore the protection mechanism for newly imported keys, and will automatically protect keys that had been imported using affected Thunderbird versions.

##### References

* [Bug 1710290](https://bugzilla.mozilla.org/show_bug.cgi?id=1710290)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_e2394445_20250114_181127.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1673241)
* [XML](/show_bug.cgi?ctype=xml&id=1673241)

Closed
[Bug 1673241](/show_bug.cgi?id=1673241)
(CVE-2021-29957)

Opened 4 years ago
Closed 4 years ago

# RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)

## Categories

### (MailNews Core :: Security: OpenPGP, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP#Security%3A%20OpenPGP)

Security: OpenPGP
▾

MailNews Core :: Security: OpenPGP
OpenPGP is about all aspects related to encrypted or signed email messages using the OpenPGP protocol.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Security%3A%20OpenPGP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

78

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (thunderbird\_esr78+ fixed, thunderbird89+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

90 Branch

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr78 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=fixed) |
| thunderbird89 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_89&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_89&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr78 | + | fixed |
| thunderbird89 | + | fixed |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: wsmwk, Assigned: KaiE)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/976cc55d51282c1c46821f8451605062?d=mm&size=40)  [wsmwk](/user_profile?user_id=29811)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### (Regressed 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1701908](/show_bug.cgi?id=1701908 "RESOLVED FIXED - Partial OpenPGP encryption reminder might be shown for an unrelated message"), [1701924](/show_bug.cgi?id=1701924 "RESOLVED FIXED - Partial inline reminder no longer shown"), [1702582](/show_bug.cgi?id=1702582 "RESOLVED FIXED - Partial OpenPGP encryption reminder not shown for inline messages that are decoded during retries")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[RNP-01-audit](/show_bug.cgi?id=1671735 "RESOLVED FIXED - Audit-Report RNP & Thunderbird Integration 08.2020 (tracking)")

Dependency [tree](/showdependencytree.cgi?id=1673241&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1673241)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1770004](/show_bug.cgi?id=1770004 "NEW - Email with inline PGP key at the end of body shows only the inline openpgp block -----BEGIN PGP PUBLIC KEY BLOCK-----")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29957

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin](/attachment.cgi?id=9213156)  [4 years ago](#c4)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   48 bytes, text/x-phabricator-request | wsmwk : [approval-comm-beta+](#c14 "4 years ago")  wsmwk : [approval-comm-esr78+](#c16 "4 years ago") | [Details](/attachment.cgi?id=9213156&action=edit) | [Review](/attachment.cgi?id=9213156) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1673241#c0)• 4 years ago |
|  | |

It was found that a partially unencrypted email has been insufficiently detected as such by Thunderbird. This introduces the risk of users erroneously assuming the entire email was encrypted and therefore ascribing it with an incorrect security status.

\***Proof-of-Concept *.eml file:***

refer to [Attachment 9182160](/attachment.cgi?id=9182160 "cure53 RNP-01-report.pdf") [[details]](/attachment.cgi?id=9182160&action=edit "cure53 RNP-01-report.pdf")

It is recommended that the logic for detecting encrypted content receives improvements by design. If parts of the message were decrypted, the whole message should be checked for unencrypted parts. If any parts of the parts were not decrypted, the application should alert the user about partially unprotected information.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a362916_1689)• 4 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1673241#c1)• 4 years ago |
|  | |

Alessandro: This is the bug I mentioned in [bug 1702582](/show_bug.cgi?id=1702582 "RESOLVED FIXED - Partial OpenPGP encryption reminder not shown for inline messages that are decoded during retries"), FYI.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1673241#c2)• 4 years ago |
|  | |

Adding Patrick to CC.

I'm working on several changes to the handling of inline messages.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1673241#c3)• 4 years ago |
|  | |

Regarding the past EFAIL security issue, one of the remedies was to limit processing of encrypted messages to the top level of a MIME message.

Apparently this wasn't applied to messages that are a mix of MIME and inline PGP. In the provided sample, there are three MIME parts. One of them contains an inline PGP message, and our current code is willing to process it.

I think it is OK if we continue to allow processing of exactly one inline PGP message, even if it is contained in the second level of a MIME message. However, if we do, we should give it the "partial PGP" treatment. We should show the notification that it's partial. We shouldn't process it automatically, but require the user to click the button to process the partial content. And after the user clicks, we should hide all other MIME parts. (This is what we currently do for a single-part plain text message, which contains an PGP block.)

There is some existing code (which refers to a [bug 983](/show_bug.cgi?id=983 "VERIFIED INVALID - CSS color: RGB colors are all showing as black")), which has this comment:

```
          // for safety reasons, we replace the complete visible message with
          // the decrypted or signed part (bug 983)

```

But that code doesn't work. For the given example, additional rendered content is kept.

Also, currently the code will always replace the first rendered MIME part with the decrypted/decoded contents - even if that isn't the PGP block.

We should change the code to walk the DOM and remove all unrelated DIV nodes.

Also, there is code that recursively processes the full MIME tree, and will decode any parts at any nesting level. We should remove that code for at least two reasons. (1) Our new code (post Enigmail) will use the result of decoding to update the top level message status and show status indicators, and we don't support displaying status for sub content. (2) Because of the risks described around the EFAIL security issues, we shoudn't automatically process sub content.

While testing, I discovered that for messages that we cannot process (cannot decrypt, e.g. because of a broken digest part), we will not show any OpenPGP failure status (because RNP doesn't give us an helpful error code). I suggest two changes here. (3) If we don't get helpful failure information, let's check if the message we're trying to process is an encrypted message or a signed message (according to its BEGIN PGP header), and show the respective general OpenPGP error status. (4) If we're processing partial contents, let's always reduce the shown contents. In other words, remove the code around it, and keep the PGP message that we cannot process. I've suggested this also in [bug 1702582](/show_bug.cgi?id=1702582 "RESOLVED FIXED - Partial OpenPGP encryption reminder not shown for inline messages that are decoded during retries").

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1673241#c4)• 4 years ago |
|  | |

Attached file
[Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin](attachment.cgi?id=9213156)
— [Details](attachment.cgi?id=9213156&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a13670196_600971)• 4 years ago |

Assignee: nobody → kaieStatus: NEW → ASSIGNED

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1673241#c5)• 4 years ago |
|  | |

I have test messages for interactive testing, I'll work on automating in a separate patch.

|  | [Ronald Tse](/user_profile?user_id=670742) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1673241#c6)• 4 years ago |
|  | |

Kai, RNP is happy to provide helpful response for a clean implementation on this case. If you remember, we do have a pending ticket that we need to discuss with your side on (1) the needs of TB from a compliance profile and (3) the interface between TB/RNP to describe the fit of a compliance profile. This in scope in the original project i.e. comes with a deadline from MOSS.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1673241#c7)• 4 years ago |
|  | |

Ronald, most of this bug is about PGP/MIME. We don't use RNP to process the MIME structure of an email, we're using code in Thunderbird (formerly Enigmail code) to do that. I'm not sure how [comment 6](/show_bug.cgi?id=1673241#c6 "RESOLVED FIXED - RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)") is related to this bug.

|  | [Ronald Tse](/user_profile?user_id=670742) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1673241#c8)• 4 years ago |
|  | |

Got it, thanks for the clarification Kai!

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1673241#c9)• 4 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/34b4c229c416a707188eb2ddf0698c7d1cd8fe11>

Status: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=affected)Resolution: --- → FIXEDTarget Milestone: --- → 90 Branch

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1673241#c10)• 4 years ago |
|  | |

lint fix:

<https://hg.mozilla.org/comm-central/rev/1536dedb52da7b63fd7509d909a108504dd58bf8>

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a15462469_101158)• 4 years ago |

[tracking-thunderbird89](/buglist.cgi?f1=cf_tracking_thunderbird_89&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_thunderbird_89&o1=equals&v1=%2B)
[tracking-thunderbird\_esr78](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr78&o1=equals&v1=%2B)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1673241#c11)• 4 years ago |
|  | |

Comment on [attachment 9213156](/attachment.cgi?id=9213156 "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") [[details]](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin")

[Bug 1673241](/show_bug.cgi?id=1673241 "RESOLVED FIXED - RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)") - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin

Needs testing on beta, because we should consider to uplift to 78.11

[Approval Request Comment]

Regression caused by (bug #): no

User impact if declined: imprecise OpenPGP status reports for some message

Testing completed (on c-c, etc.): yes

Risk to taking this patch (and alternatives if risky): mild risk for regressions, but passes existing tests, and we add new tests

[Attachment #9213156](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") -
Flags: approval-comm-beta?

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a16232097_36541)• 4 years ago |

[status-thunderbird89](/buglist.cgi?f1=cf_status_thunderbird_89&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_89&o1=equals&v1=affected)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1673241#c12)• 4 years ago |
|  | |

The fix assumes that the fixes from [bug 1701908](/show_bug.cgi?id=1701908 "RESOLVED FIXED - Partial OpenPGP encryption reminder might be shown for an unrelated message"), [bug 1702582](/show_bug.cgi?id=1702582 "RESOLVED FIXED - Partial OpenPGP encryption reminder not shown for inline messages that are decoded during retries"), [bug 1701924](/show_bug.cgi?id=1701924 "RESOLVED FIXED - Partial inline reminder no longer shown") are present, so adding dependencies.

Depends on: [1701908](/show_bug.cgi?id=1701908 "RESOLVED FIXED - Partial OpenPGP encryption reminder might be shown for an unrelated message"), [1702582](/show_bug.cgi?id=1702582 "RESOLVED FIXED - Partial OpenPGP encryption reminder not shown for inline messages that are decoded during retries"), [1701924](/show_bug.cgi?id=1701924 "RESOLVED FIXED - Partial inline reminder no longer shown")

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1673241#c13)• 4 years ago |
|  | |

Comment on [attachment 9213156](/attachment.cgi?id=9213156 "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") [[details]](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin")

[Bug 1673241](/show_bug.cgi?id=1673241 "RESOLVED FIXED - RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)") - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin

See above beta approval request for details.

Requesting esr78 approval, however, should wait for at least 2 weeks beta testing.

[Attachment #9213156](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") -
Flags: approval-comm-esr78?

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1673241#c14)• 4 years ago |
|  | |

Comment on [attachment 9213156](/attachment.cgi?id=9213156 "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") [[details]](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin")

[Bug 1673241](/show_bug.cgi?id=1673241 "RESOLVED FIXED - RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)") - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin

[Triage Comment]

Approved for beta

[Attachment #9213156](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") -
Flags: approval-comm-beta? → approval-comm-beta+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1673241#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/releases/comm-beta/rev/beceab875bd723113c4bd0f3315fac584fd5062f>

89.0b3

[status-thunderbird89](/buglist.cgi?f1=cf_status_thunderbird_89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_89&o1=equals&v1=fixed)

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1673241#c16)• 4 years ago |
|  | |

Comment on [attachment 9213156](/attachment.cgi?id=9213156 "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") [[details]](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin")

[Bug 1673241](/show_bug.cgi?id=1673241 "RESOLVED FIXED - RNP-01-008 WP3 Thunderbird: Partially unencrypted email insufficiently detected (Low)") - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin

[Triage Comment]

Approved for esr78

[Attachment #9213156](/attachment.cgi?id=9213156&action=edit "Bug 1673241 - Improve handling of mixed MIME and inline OpenPGP. r=PatrickBrunschwig,mkmelin") -
Flags: approval-comm-esr78? → approval-comm-esr78+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1673241#c17)• 4 years ago |
|  | |

<https://hg.mozilla.org/releases/comm-esr78/rev/d2f01d2934ed8aa63dafa946a90008f68c6daf0a>

78.10.2

[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=fixed)

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1673241#c18)• 4 years ago |
|  | |

Kai, if you plan to do a CVE for this issue, please coordinate with security@mozilla.com - we intend to release 78.10.2 on Monday or Tuesday.

Flags: needinfo?(kaie)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1673241#c19)• 4 years ago |
|  | |

cve requested

Flags: needinfo?(kaie)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a17631694_578488)• 4 years ago |

Alias: CVE-2021-29957

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a19627763_29811)• 4 years ago |

Group: mail-core-security

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1673241#a49417976_101158)• 3 years ago |

Regressions: [1770004](/show_bug.cgi?id=1770004 "NEW - Email with inline PGP key at the end of body shows only the inline openpgp block -----BEGIN PGP PUBLIC KEY BLOCK-----")
You need to [log in](/show_bug.cgi?id=1673241&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


