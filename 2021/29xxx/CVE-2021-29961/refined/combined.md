=== Content from security.gentoo.org_5c4cc1a0_20250115_095730.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202107-09**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **89.0** |
| Unaffected versions | >= **78.11.0**>= **89.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **89.0** |
| Unaffected versions | >= **78.11.0**>= **89.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-78.11.0"

```

All Mozilla Firefox ESR binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-78.11.0"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-89.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-89.0"

```
### References

* [CVE-2021-29959](https://nvd.nist.gov/vuln/detail/CVE-2021-29959)
* [CVE-2021-29960](https://nvd.nist.gov/vuln/detail/CVE-2021-29960)
* [CVE-2021-29961](https://nvd.nist.gov/vuln/detail/CVE-2021-29961)
* [CVE-2021-29966](https://nvd.nist.gov/vuln/detail/CVE-2021-29966)

**Release date**

July 07, 2021

**Latest revision**

July 07, 2021: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [794082](https://bugs.gentoo.org/show_bug.cgi?id=794082)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_30dfa836_20250115_095731.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-23

## Security Vulnerabilities fixed in Firefox 89

Announced
June 1, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 89

#### [#CVE-2021-29965: Password Manager on Firefox for Android susceptible to domain spoofing](#CVE-2021-29965)

Reporter
Harshit Mahendra
Impact
high
##### Description

A malicious website that causes an HTTP Authentication dialog to be spawned could trick the built-in password manager to suggest passwords for the currently active website instead of the website that triggered the dialog.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1709257](https://bugzilla.mozilla.org/show_bug.cgi?id=1709257)

#### [#CVE-2021-29960: Filenames printed from private browsing mode incorrectly retained in preferences](#CVE-2021-29960)

Reporter
Sebastian Hengst
Impact
moderate
##### Description

Firefox used to cache the last filename used for printing a file. When generating a filename for printing, Firefox usually suggests the web page title.
The caching and suggestion techniques combined may have lead to the title of a website visited during private browsing mode being stored on disk.

##### References

* [Bug 1675965](https://bugzilla.mozilla.org/show_bug.cgi?id=1675965)

#### [#CVE-2021-29961: Firefox UI spoof using "<select>" elements and CSS scaling](#CVE-2021-29961)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When styling and rendering an oversized `&lt;select>` element, Firefox did not apply correct clipping which allowed an attacker to paint over the user interface.

##### References

* [Bug 1700235](https://bugzilla.mozilla.org/show_bug.cgi?id=1700235)

#### [#CVE-2021-29963: Shared cookies for search suggestions in private browsing mode](#CVE-2021-29963)

Reporter
Wladimir Palant working with Include Security
Impact
moderate
##### Description

Address bar search suggestions in private browsing mode were re-using session data from normal mode.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1705068](https://bugzilla.mozilla.org/show_bug.cgi?id=1705068)

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Firefox would process incorrectly, leading to an out-of-bounds read.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29959: Devices could be re-enabled without additional permission prompt](#CVE-2021-29959)

Reporter
Jan-Ivar Bruaroey
Impact
low
##### Description

When a user has already allowed a website to access microphone and camera, disabling camera sharing would not fully prevent the website from re-enabling it without an additional prompt.
This was only possible if the website kept recording with the microphone until re-enabling the camera.

##### References

* [Bug 1395819](https://bugzilla.mozilla.org/show_bug.cgi?id=1395819)

#### [#CVE-2021-29962: No rate-limiting for popups on Firefox for Android](#CVE-2021-29962)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Firefox for Android would become unstable and hard-to-recover when a website opened too many popups.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1701673](https://bugzilla.mozilla.org/show_bug.cgi?id=1701673)

#### [#CVE-2021-29967: Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christian Holler, Anny Gakhokidze, Alexandru Michis, Gabriele Svelto reported memory safety bugs present in Firefox 88 and Firefox ESR 78.11. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

#### [#CVE-2021-29966: Memory safety bugs fixed in Firefox 89](#CVE-2021-29966)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Christian Holler, Tooru Fujisawa, Tyson Smith reported memory safety bugs present in Firefox 88. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1660307%2C1686154%2C1702948%2C1708124)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_98786ac1_20250115_095730.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1700235)
* [XML](/show_bug.cgi?ctype=xml&id=1700235)

Closed
[Bug 1700235](/show_bug.cgi?id=1700235)
(CVE-2021-29961)

Opened 4 years ago
Closed 4 years ago

# <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

<select> element with large size then transformed with scale() allow WebRender to render over Firefox UI

## Categories

### (Core :: Graphics: WebRender, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20WebRender#Graphics%3A%20WebRender)

Graphics: WebRender
▾

Core :: Graphics: WebRender
Bugs related to the integration of WebRender into Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20WebRender&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20WebRender&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20WebRender)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

90 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=unaffected) |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox86 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix) |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix) |
| firefox89 | --- | [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified) |
| firefox90 | --- | [verified](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr78 |  | unaffected |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox86 |  | wontfix |
| firefox87 |  | wontfix |
| firefox88 |  | wontfix |
| firefox89 |  | verified |
| firefox90 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: gw)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2f22cafad5e74490468a55973c7c14fe?d=mm&size=40)  [gw](/user_profile?user_id=504871)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2f22cafad5e74490468a55973c7c14fe?d=mm&size=40)  [gw](/user_profile?user_id=504871)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1706068](/show_bug.cgi?id=1706068 "RESOLVED FIXED - Disappearing / Ghost tabs"), [1706109](/show_bug.cgi?id=1706109 "RESOLVED DUPLICATE - Graphs don't show up in Firefox profiler with WR"), [1706159](/show_bug.cgi?id=1706159 "RESOLVED DUPLICATE - Text disappears when an iframe is loaded"), [1708337](/show_bug.cgi?id=1708337 "VERIFIED FIXED - The extensions' doorhangers don't have rounded corners when webrender is enabled"), [1709270](/show_bug.cgi?id=1709270 "RESOLVED WONTFIX - 10.68 - 3.69% web-de dcf / google-search-restaurants LastVisualChange + 16 more (Android) regression on Mon April 19 2021")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1664719](/show_bug.cgi?id=1664719 "RESOLVED FIXED - Optimize handling of shared / compositor clips for picture caching")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [adv-main89+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29961

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [adv-main89+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1885066_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files, 1 obsolete file)

| [drawbar.bundle.html](/attachment.cgi?id=9210903)  [4 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.89 MB, text/html |  | [Details](/attachment.cgi?id=9210903&action=edit) |
| --- | --- | --- |
| [hidebar.bundle.html](/attachment.cgi?id=9210904)  [4 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   727.33 KB, text/html |  | [Details](/attachment.cgi?id=9210904&action=edit) |
| [Firefox WebRender Render over UI - Drawbar - Intel i5-1035G1.mp4](/attachment.cgi?id=9210905)  [4 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   345.14 KB, video/mp4 |  | [Details](/attachment.cgi?id=9210905&action=edit) |
| [Firefox Webrender Render over UI - Drawbar (Reduced Scale) - Intel i5-1035G1.mp4](/attachment.cgi?id=9210906)  [4 years ago](#c3)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   277.41 KB, video/mp4 |  | [Details](/attachment.cgi?id=9210906&action=edit) |
| [Firefox WebRender Render over UI - Hidebar - Intel i5-1035G1.mp4](/attachment.cgi?id=9210907)  [4 years ago](#c4)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   407.05 KB, video/mp4 |  | [Details](/attachment.cgi?id=9210907&action=edit) |
| [Bug 1700235 - Apply iframe clips on tile caches instead of prims.](/attachment.cgi?id=9215988)  [4 years ago](#c11)  [Glenn Watson [:gw]](/user_profile?user_id=504871)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9215988&action=edit) | [Review](/attachment.cgi?id=9215988) |
| [Bug 1700235 - Apply iframe clips on tile caches instead of prims.](/attachment.cgi?id=9217049)  [4 years ago](#c16)  [Glenn Watson [:gw]](/user_profile?user_id=504871)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c26 "4 years ago") | [Details](/attachment.cgi?id=9217049&action=edit) | [Review](/attachment.cgi?id=9217049) |
| [image](/attachment.cgi?id=9219176)  [4 years ago](#c22)  [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815)   153.27 KB, image/png |  | [Details](/attachment.cgi?id=9219176&action=edit) |
| [advisory.txt](/attachment.cgi?id=9223731)  [4 years ago](#c29)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   237 bytes, text/plain |  | [Details](/attachment.cgi?id=9223731&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1700235#c0)• 4 years ago |
|  | |

Attached file
[drawbar.bundle.html](attachment.cgi?id=9210903)
— [Details](attachment.cgi?id=9210903&action=edit)

When create `<select>` element with large size attribute and large font-size, then transform the element with CSS `scale()`, the element is rendered and stretched over Firefox toolbar and other UI.

mozregression show the regression range is started from commit [Bug 1664719 - Pt 2a - Re-enable is\_ancestor check](https://hg.mozilla.org/integration/autoland/rev/c8102686489e51edec8a976f013398412577be44):

```
19:51.48 INFO: Narrowed integration regression window from [b88d1d84, c8102686] (3 builds) to [25a50264, c8102686] (2 builds) (~1 steps left)
19:51.48 INFO: No more integration revisions, bisection finished.
19:51.48 INFO: Last good revision: 25a50264ae3204f2df9add308fc712df45947637
19:51.48 INFO: First bad revision: c8102686489e51edec8a976f013398412577be44
19:51.48 INFO: Pushlog:
https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=25a50264ae3204f2df9add308fc712df45947637&tochange=c8102686489e51edec8a976f013398412577be44

```

As it able to render over Firefox address bar and toolbar UI, I can assume it's possible to spoof the address bar with background-image or hide the address bar with background-color.

## Reproduced on:

* Firefox Nightly 88.0a1 (2021-03-22) (64-bit) on Arch Linux (AMD RENOIR (DRM 3.40.0, 5.11.6-arch1-1, LLVM 11.1.0)
* Firefox Nightly 88.0a1 (2021-03-22) (64-bit) on Windows 10 (AMD A8-7410 R5 Graphics)
* Firefox Nightly 88.0a1 (2021-03-22) (64-bit) on Windows 10 (Intel i5-1035G1)

## Steps to Reproduce:

1. Open Firefox with WebRender enabled
2. Visit attached drawbar.bundle.html or hidebar.bundle.html
3. The toolbar is now covered by background-image or background-color

(If toolbar is only partially covered on your screen, try to zoom-in or zoom-out the page, or increase the CSS scale() or <select> size)

Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1700235#c1)• 4 years ago |
|  | |

Attached file
[hidebar.bundle.html](attachment.cgi?id=9210904)
— [Details](attachment.cgi?id=9210904&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1700235#c2)• 4 years ago |
|  | |

Attached video
[Firefox WebRender Render over UI - Drawbar - Intel i5-1035G1.mp4](attachment.cgi?id=9210905)
— [Details](attachment.cgi?id=9210905&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1700235#c3)• 4 years ago |
|  | |

Attached video
[Firefox Webrender Render over UI - Drawbar (Reduced Scale) - Intel i5-1035G1.mp4](attachment.cgi?id=9210906)
— [Details](attachment.cgi?id=9210906&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1700235#c4)• 4 years ago |
|  | |

Attached video
[Firefox WebRender Render over UI - Hidebar - Intel i5-1035G1.mp4](attachment.cgi?id=9210907)
— [Details](attachment.cgi?id=9210907&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a6175_159069)• 4 years ago |

Blocks: [1664719](/show_bug.cgi?id=1664719 "RESOLVED FIXED - Optimize handling of shared / compositor clips for picture caching")Group: firefox-core-security → gfx-core-securityType: task → defectComponent: Security → Graphics: WebRenderProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a141744_406194)• 4 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a142214_406194)• 4 years ago |

No longer blocks: [1664719](/show_bug.cgi?id=1664719 "RESOLVED FIXED - Optimize handling of shared / compositor clips for picture caching")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1664719](/show_bug.cgi?id=1664719 "RESOLVED FIXED - Optimize handling of shared / compositor clips for picture caching")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a142214_546015)• 4 years ago |

Has Regression Range: --- → yes

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a142252_406194)• 4 years ago |

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected)
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected)

|  | [Andrew Osmond [:aosmond] (he/him)](/user_profile?user_id=505306) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a154092_505306)• 4 years ago |

Flags: needinfo?(gwatson)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a162891_406194)• 4 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)
[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=unaffected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a166625_1689)• 4 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1700235#c5)• 4 years ago |
|  | |

I can't reproduce drawing over the titlebar after trying a number of zoom / scale / resolution configurations. But it does draw what looks like garbage at the bottom of the screen for me. I'll investigate that and find what's happening - hopefully whatever causes that is the same issue.

Assignee: nobody → gwatsonFlags: needinfo?(gwatson)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1700235#c6)• 4 years ago |
|  | |

I was able to reduce the case further and reproduce in a wrench capture.

The problem is caused by (a lack of) `f32` accuracy.

From Gecko, the display list contains a spatial node with transform `([1.0, 0.0, 0.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -652528960.0, 0.0, 1.0])`.

Since the coordinate system for that is axis-aligned with respect to the global iframe clip rect, WR maps the iframe clip-rect into this primitive's coordinate space, and intersects with the primitive's local clip rect, providing a single local clip rect that is applied during vertex shading.

However, the extremely large offset combined with the very large y-scale in the transform means that floating point accuracy loss occurs, and the mapped clip rect is incorrectly now referencing an area outside the iframe clip in world space by ~47 pixels in my local test case.

How would such a case be handled in non-WR Gecko? Does Gecko layout / DL building do any rejection or clamping of extremely large transforms like this?

Flags: needinfo?(matt.woodrow)Flags: needinfo?(jmuizelaar)Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1700235#c7)• 4 years ago |
|  | |

I don't know this off the top of my head, but if Matt / Jeff can't answer let me know and I can dig.

Flags: needinfo?(emilio)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a326379_75935)• 4 years ago |

[status-firefox86](/buglist.cgi?f1=cf_status_firefox86&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox86&o1=equals&v1=wontfix)
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1700235#c8)• 4 years ago |
|  | |

Clipping is mostly done in device space (often with fixed point) so there's no opportunity for floating point error to cause a problem.

Flags: needinfo?(jmuizelaar)

|  | [Matt Woodrow (:mattwoodrow)](/user_profile?user_id=380838) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a1207152_380838)• 4 years ago |

Flags: needinfo?(matt.woodrow)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1700235#c9)• 4 years ago |
|  | |

Thinking about this more overnight - it's still unclear to me why the overall content frame clip doesn't end up being applied to the content tiles. I need to investigate that, as that seems like the simplest way to ensure this can't happen.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a1788243_75935)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a1885066_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1700235#c10)• 4 years ago |
|  | |

The partial answer to the question in [comment 8](/show_bug.cgi?id=1700235#c8 "VERIFIED FIXED - <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI") is that for the picture cache tiles that overlap with the URL bar, there is no clip rect on the picture cache instance constraining them to the content region. Next step is to work out why this is.

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1700235#c11)• 4 years ago |
|  | |

Attached file
[Bug 1700235 - Apply iframe clips on tile caches instead of prims.](attachment.cgi?id=9215988) (obsolete)
— [Details](attachment.cgi?id=9215988&action=edit)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1700235#c12)• 4 years ago |
|  | |

The attached patch provides a solution that prevents the floating point inaccuracy affecting outside a content iframe, by ensuring that iframe clip rects are applied to the picture cache tiles (which aren't affected by the floating point accuracy issues in the content).

In some ways this is a band-aid fix, in that the float inaccuracy can still cause rendering artifacts *within* content, but it should prevent content leaking outside the iframe clip in these cases. We can work on the content inaccuracy with extreme transforms and primitive sizes as a lower priority.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1700235#c13)• 4 years ago |
|  | |

Apply iframe clips on tile caches instead of prims. r=nical,kvark

<https://hg.mozilla.org/integration/autoland/rev/8a4eff9d5f949a52dd7097395f4a124ceb9e39d4>

<https://hg.mozilla.org/mozilla-central/rev/8a4eff9d5f94>

Group: gfx-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 89 Branch

|  | [Lee Salzman [:lsalzman]](/user_profile?user_id=536714) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a2395608_536714)• 4 years ago |

Regressions: [1706109](/show_bug.cgi?id=1706109 "RESOLVED DUPLICATE - Graphs don't show up in Firefox profiler with WR")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a2404434_258347)• 4 years ago |

Regressions: [1706068](/show_bug.cgi?id=1706068 "RESOLVED FIXED - Disappearing / Ghost tabs")

|  | [Kagami Rosylight [:saschanaz] (they/them)](/user_profile?user_id=473060) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a2406639_473060)• 4 years ago |

Regressions: [1706159](/show_bug.cgi?id=1706159 "RESOLVED DUPLICATE - Text disappears when an iframe is loaded")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1700235#c14)• 4 years ago |
|  | |

Backed out from Beta to avoid shipping 89.0b1 with the various regressions being filed off it. We can consider re-landing it once those are resolved on Nightly.

<https://hg.mozilla.org/releases/mozilla-beta/rev/2cd99c728148493e0ee78c765d53a4ca40638c61>

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected)
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1700235#c15)• 4 years ago |
|  | |

Backed out for painting regressions:

<https://hg.mozilla.org/mozilla-central/rev/09bea3dd34bd0da18d56758701528ca7be22c0ea>

Status: RESOLVED → REOPENED
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected)Flags: needinfo?(gwatson)Resolution: FIXED → ---Target Milestone: 89 Branch → ---

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a2412511_504871)• 4 years ago |

Flags: needinfo?(gwatson)

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1700235#c16)• 4 years ago |
|  | |

Attached file
[Bug 1700235 - Apply iframe clips on tile caches instead of prims.](attachment.cgi?id=9217049)
— [Details](attachment.cgi?id=9217049&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a2508827_600971)• 4 years ago |

[Attachment #9215988](/attachment.cgi?id=9215988&action=edit "Bug 1700235 - Apply iframe clips on tile caches instead of prims.") -
Attachment is obsolete: true

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1700235#c17)• 4 years ago |
|  | |

Apply iframe clips on tile caches instead of prims. r=gfx-reviewers,kvark

<https://hg.mozilla.org/integration/autoland/rev/6527552f2b2809528c69db127d813bf0a065d44c>

<https://hg.mozilla.org/mozilla-central/rev/6527552f2b28>

Status: REOPENED → RESOLVEDClosed: 4 years ago → 4 years ago
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 90 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1700235#c18)• 4 years ago |
|  | |

The patch landed in nightly and beta is affected.

:gw, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

If yes, don't forget to request an uplift for the patches in the regressions caused by this fix.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(gwatson)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1700235#c19)• 4 years ago |
|  | |

redirecting to :kvark given Glenn's PTO

Flags: needinfo?(dmalyshau)

|  | [Dzmitry Malyshau [:kvark]](/user_profile?user_id=582393) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1700235#c20)• 4 years ago |
|  | |

Comment on [attachment 9217049](/attachment.cgi?id=9217049 "Bug 1700235 - Apply iframe clips on tile caches instead of prims.") [[details]](/attachment.cgi?id=9217049&action=edit "Bug 1700235 - Apply iframe clips on tile caches instead of prims.")

[Bug 1700235](/show_bug.cgi?id=1700235 "VERIFIED FIXED - <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI") - Apply iframe clips on tile caches instead of prims.

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potential security risk of malicious pages rendering over UI and luring the user to click on stuff they don't want to.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Copied from the first comment:

* Open Firefox with WebRender enabled
* Visit attached drawbar.bundle.html or hidebar.bundle.html
* The toolbar is now covered by background-image or background-color

(If toolbar is only partially covered on your screen, try to zoom-in or zoom-out the page, or increase the CSS scale() or <select> size)

* **List of other uplifts needed**: None
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: It's not entirely trivial, and it didn't get much of the testing in Nightly yet.
* **String changes made/needed**:
Flags: needinfo?(dmalyshau)
[Attachment #9217049](/attachment.cgi?id=9217049&action=edit "Bug 1700235 - Apply iframe clips on tile caches instead of prims.") -
Flags: approval-mozilla-beta?

|  | [Dzmitry Malyshau [:kvark]](/user_profile?user_id=582393) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a3172118_582393)• 4 years ago |

Flags: qe-verify+

|  | [Dzmitry Malyshau [:kvark]](/user_profile?user_id=582393) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1700235#c21)• 4 years ago |
|  | |

Requesting uplift

Flags: needinfo?(gwatson)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a3223262_551058)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Timothy Nikkel (:tnikkel)](/user_profile?user_id=255010) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a3228955_255010)• 4 years ago |

Regressions: [1708337](/show_bug.cgi?id=1708337 "VERIFIED FIXED - The extensions' doorhangers don't have rounded corners when webrender is enabled")

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1700235#c22)• 4 years ago |
|  | |

Attached image
[image](attachment.cgi?id=9219176)
— [Details](attachment.cgi?id=9219176&action=edit)

Hello! Using the attached TC's saved locally and STR from [comment 20](/show_bug.cgi?id=1700235#c20 "VERIFIED FIXED - <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI") I managed to reproduce the issue with Firefox 88.0a1 (20210302134918) on Windows 10x64 as follows:

1. opening drawbar.bundle.html displayed the toolbar and address bar covered by a background-image
2. opening Set title with the name from hidebar.bundle.html and set title with URL opened a new window without the address bar displayed.

Using Firefox 90.0a1 (20210429092605) on Windows 10x64, macOS 10.12, and Ubuntu 20.04:

1. clicking both options from hidebar.bundle.html opens a new window with address bar displayed
2. opening drawbar.bundle.html no longer displays background-image on the address bar and tab bar but it displayed underneath when zooming in/out.

Attached a screenshot with all results. Are these expected? Thank you in advance!

Flags: needinfo?(gwatson)

|  | [Dzmitry Malyshau [:kvark]](/user_profile?user_id=582393) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1700235#c23)• 4 years ago |
|  | |

Thank you, Alexandru!

Given your observations, as well as the newly found regression, it's a tough call to make.

I think, given that the change still fixes the case of overlapping UI contents, it would be good to land in Beta. The security fix is more important than the drawbacks here.

|  | [Glenn Watson [:gw]](/user_profile?user_id=504871)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1700235#c24)• 4 years ago |
|  | |

Hi Alexandru,

Thanks for verifying - yes, those results appear to be as expected.

It's OK that we get some weird looking content inside the content frame for this test case (it involves extreme scale / stretching of a large image), so long as it doesn't draw on the main UI itself.

I'll investigate the attached regression today - if we can solve that easily, it's probably fine to uplift this.

Flags: needinfo?(gwatson)

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1700235#c25)• 4 years ago |
|  | |

Thank you both for all the information! marking 90 as verified per the above comments.

[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=verified)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a3760270_546716)• 4 years ago |

Regressions: [1709270](/show_bug.cgi?id=1709270 "RESOLVED WONTFIX - 10.68 - 3.69% web-de dcf / google-search-restaurants LastVisualChange + 16 more (Android) regression on Mon April 19 2021")

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1700235#c26)• 4 years ago |
|  | |

Comment on [attachment 9217049](/attachment.cgi?id=9217049 "Bug 1700235 - Apply iframe clips on tile caches instead of prims.") [[details]](/attachment.cgi?id=9217049&action=edit "Bug 1700235 - Apply iframe clips on tile caches instead of prims.")

[Bug 1700235](/show_bug.cgi?id=1700235 "VERIFIED FIXED - <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI") - Apply iframe clips on tile caches instead of prims.

Approved for 89 beta 10, thanks.

[Attachment #9217049](/attachment.cgi?id=9217049&action=edit "Bug 1700235 - Apply iframe clips on tile caches instead of prims.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1700235#c27)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/361beb8a5622>

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a3933874_537720)• 4 years ago |

Status: RESOLVED → VERIFIED

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1700235#c28)• 4 years ago |
|  | |

Verified fixed with 89.0b10 (20210509185840) on Windows10x64, macOS 11 and Ubuntu 18.04. The same results are displayed as in [comment 22](/show_bug.cgi?id=1700235#c22 "VERIFIED FIXED - <select> element with large size then transformed with scale() allow WebRender to render over Firefox UI").

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=verified)Flags: qe-verify+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a5647315_428608)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [adv-main89+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1700235#c29)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9223731)
— [Details](attachment.cgi?id=9223731&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a5655423_428608)• 4 years ago |

Alias: CVE-2021-29961

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a21199128_1689)• 3 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1700235#a100635755_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1700235&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


