=== Content from www.mozilla.org_30dfa836_20250114_200319.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-23

## Security Vulnerabilities fixed in Firefox 89

Announced
June 1, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 89

#### [#CVE-2021-29965: Password Manager on Firefox for Android susceptible to domain spoofing](#CVE-2021-29965)

Reporter
Harshit Mahendra
Impact
high
##### Description

A malicious website that causes an HTTP Authentication dialog to be spawned could trick the built-in password manager to suggest passwords for the currently active website instead of the website that triggered the dialog.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1709257](https://bugzilla.mozilla.org/show_bug.cgi?id=1709257)

#### [#CVE-2021-29960: Filenames printed from private browsing mode incorrectly retained in preferences](#CVE-2021-29960)

Reporter
Sebastian Hengst
Impact
moderate
##### Description

Firefox used to cache the last filename used for printing a file. When generating a filename for printing, Firefox usually suggests the web page title.
The caching and suggestion techniques combined may have lead to the title of a website visited during private browsing mode being stored on disk.

##### References

* [Bug 1675965](https://bugzilla.mozilla.org/show_bug.cgi?id=1675965)

#### [#CVE-2021-29961: Firefox UI spoof using "<select>" elements and CSS scaling](#CVE-2021-29961)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When styling and rendering an oversized `&lt;select>` element, Firefox did not apply correct clipping which allowed an attacker to paint over the user interface.

##### References

* [Bug 1700235](https://bugzilla.mozilla.org/show_bug.cgi?id=1700235)

#### [#CVE-2021-29963: Shared cookies for search suggestions in private browsing mode](#CVE-2021-29963)

Reporter
Wladimir Palant working with Include Security
Impact
moderate
##### Description

Address bar search suggestions in private browsing mode were re-using session data from normal mode.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1705068](https://bugzilla.mozilla.org/show_bug.cgi?id=1705068)

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Firefox would process incorrectly, leading to an out-of-bounds read.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29959: Devices could be re-enabled without additional permission prompt](#CVE-2021-29959)

Reporter
Jan-Ivar Bruaroey
Impact
low
##### Description

When a user has already allowed a website to access microphone and camera, disabling camera sharing would not fully prevent the website from re-enabling it without an additional prompt.
This was only possible if the website kept recording with the microphone until re-enabling the camera.

##### References

* [Bug 1395819](https://bugzilla.mozilla.org/show_bug.cgi?id=1395819)

#### [#CVE-2021-29962: No rate-limiting for popups on Firefox for Android](#CVE-2021-29962)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Firefox for Android would become unstable and hard-to-recover when a website opened too many popups.

*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1701673](https://bugzilla.mozilla.org/show_bug.cgi?id=1701673)

#### [#CVE-2021-29967: Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christian Holler, Anny Gakhokidze, Alexandru Michis, Gabriele Svelto reported memory safety bugs present in Firefox 88 and Firefox ESR 78.11. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

#### [#CVE-2021-29966: Memory safety bugs fixed in Firefox 89](#CVE-2021-29966)

Reporter
Mozilla developers and community
Impact
moderate
##### Description

Mozilla developers Christian Holler, Tooru Fujisawa, Tyson Smith reported memory safety bugs present in Firefox 88. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1660307%2C1686154%2C1702948%2C1708124)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ce84ca00_20250114_200320.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-24

## Security Vulnerabilities fixed in Firefox ESR 78.11

Announced
June 1, 2021
Impact
moderate
Products
Firefox ESR
Fixed in

* Firefox ESR 78.11

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Firefox would processing incorrectly, leading to an out-of-bounds read.

*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29967: Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Anny Gakhokidze, Alexandru Michis, Christian Holler reported memory safety bugs present in Firefox 88 and Firefox ESR 78.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 89 and Firefox ESR 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b1dfc776_20250114_200317.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1706501)
* [XML](/show_bug.cgi?ctype=xml&id=1706501)

Closed
[Bug 1706501](/show_bug.cgi?id=1706501)
(CVE-2021-29964)

Opened 4 years ago
Closed 4 years ago

# Read beyond bounds in remoting server

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Read beyond bounds in remoting server

## Categories

### (Toolkit :: Startup and Profile System, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Startup%20and%20Profile%20System#Startup%20and%20Profile%20System)

Startup and Profile System
▾

Toolkit :: Startup and Profile System
New applications startup system - including shared AppRunner, AppStartup, and profile system.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Startup%20and%20Profile%20System&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Startup%20and%20Profile%20System&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Startup%20and%20Profile%20System)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 88

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

90 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [89+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=89%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix) |
| firefox89 | [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed) |
| firefox90 | [+](/buglist.cgi?f1=cf_tracking_firefox90&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 89+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox87 |  | wontfix |
| firefox88 |  | wontfix |
| firefox89 | + | fixed |
| firefox90 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozillabugs, Assigned: toshi)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/4801821fe25ca374f61630ba813036f9?d=mm&size=40)  [toshi](/user_profile?user_id=644141)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d5c63f9bd72a6704ada7f9ca71771d8b?d=mm&size=40)  [mozillabugs](/user_profile?user_id=608633)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8f56e46f0120d9477f8f320991a2196a?d=mm&size=40)  [mossop](/user_profile?user_id=91159)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-moderate, Whiteboard: [adv-main89+][adv-esr78.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29964

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main89+][adv-esr78.11+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c10 "4 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a12676142_578488 "3 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | [qe-verify](#a2640640_458186 "4 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [POC](/attachment.cgi?id=9217243)  [4 years ago](#c0)  [mozillabugs](/user_profile?user_id=608633)   615 bytes, text/plain |  | [Details](/attachment.cgi?id=9217243&action=edit) |
| --- | --- | --- |
| [Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring. r=mossop](/attachment.cgi?id=9217600)  [4 years ago](#c6)  [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c14 "4 years ago") | [Details](/attachment.cgi?id=9217600&action=edit) | [Review](/attachment.cgi?id=9217600) |
| [Bug 1706501 - Make HandleCommandLine take nsACString](/attachment.cgi?id=9221012)  [4 years ago](#c12)  [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c16 "4 years ago") | [Details](/attachment.cgi?id=9221012&action=edit) | [Review](/attachment.cgi?id=9221012) |
| [advisory.txt](/attachment.cgi?id=9223719)  [4 years ago](#c18)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   309 bytes, text/plain |  | [Details](/attachment.cgi?id=9223719&action=edit) |
| [advisory.txt](/attachment.cgi?id=9223735)  [4 years ago](#c19)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   311 bytes, text/plain |  | [Details](/attachment.cgi?id=9223735&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1706501#c0)• 4 years ago |
|  | |

Attached file
[POC](attachment.cgi?id=9217243)
— [Details](attachment.cgi?id=9217243&action=edit)

`CommandLineParserWin::HandleCommandLine()` (toolkit\xre\CmdLineAndEnvUtils.h) reads beyond bounds when fed an unterminated string via a malformed `WM_COPYDATA` message. This message can be sent by a hostile program running in a different -- even a less-privileged -- account context than the victim instance of FF. [1]

The read beyond bounds could cause FF to navigate to a page that could injure the user, such as if the memory beyond the end of the string contains a site's access token. This is unlikely, but not inconceivable. [2]

Attached is a POC that demonstrates the bug. Use it thusly:

1. Create a VS console project and replace the VS-generated sample program with the POC. Build it.
2. Find a throwaway VM.
3. Ensure that no instances of FF are currently running on the system.
4. Run FF 88.0 using the default profile, from an elevated admin account cmd prompt.
5. Notice that FF runs in the admin account's context, but (fortunately!) disables the admin token.
6. Attach a debugger to FF's chrome process.
7. Set a BP on `CommandLineParserWin::HandleCommandLine()`.
8. Run the POC in a different, nonprivileged account than the one in which you ran FF.
9. When the BP fires, examine the `aCmdLineString` argument and notice that it begins with 8 bytes of 'a' (which is what the POC sent). There might or might not be an accidental "terminating" 0 following the last 'a'. Step the code and notice that it reads at least one byte beyond the 8 that the POC sent. Depending on your OS and memory layout, FF might crash attempting to read a no-access page.
10. Rebuild the POC with `BYTE_COUNT` == `128*1024`. Rerun the above sequence and notice that Windows puts the `WM_COPYDATA` message on the heap instead of the stack, potentially allowing longer reads beyond bounds.

The bug is in WinRemoteMessageReceiver::Parse() (toolkit/components/remote/winremotemessage.cpp), which assumes that `aMessageData->lpData` is null-terminated. It should instead use the count from `aMessageData->cbData`, which contains the exact number of bytes that Windows copied from the sender's context into FF's context.

[1] I will soon post a bug documenting other ways in which WM\_COPYDATA can be accessed and abused or accidentally invoked, such as by a different instance of FF running in a different account's context. Probably other Windows messages can be abused similarly. I don't know how much FF can do to protect itself from these others.

[2] Windows copies small `WM_COPYDATA` messages onto the stack, the relevant portions of which contain local variables and stack-frame data related to handling the `WM_COPYDATA` message. Windows copies large `WM_COPYDATA` messages onto the heap, sometimes followed by a no-access page.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1706501#c1)• 4 years ago |
|  | |

Toshi, is this something you could investigate? Thanks.

Flags: needinfo?(tkikuchi)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a773_406194)• 4 years ago |

Component: General → Startup and Profile SystemProduct: Core → Toolkit

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1706501#c2)• 4 years ago |
|  | |

The reporter is right. `WinRemoteMessageReceiver::Parse` should handle the case where `COPYDATASTRUCT::lpData` is not null-terminated. I could reproduce a simple crash caused by an inaccessible page just after the received buffer.

Assignee: nobody → tkikuchiFlags: needinfo?(tkikuchi)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a28529_428608)• 4 years ago |

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1706501#c3)• 4 years ago |
|  | |

It looks like this code was added in [bug 1650637](/show_bug.cgi?id=1650637 "RESOLVED FIXED - Cyrillic URL parameter is split when passed from the command line"), which landed in Firefox 81.

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected)
[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected)
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)Regressed by: [1650637](/show_bug.cgi?id=1650637 "RESOLVED FIXED - Cyrillic URL parameter is split when passed from the command line")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a56398_406194)• 4 years ago |

Group: core-security → firefox-core-security

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1706501#c4)• 4 years ago |
|  | |

It's not regressed by [bug 1650637](/show_bug.cgi?id=1650637 "RESOLVED FIXED - Cyrillic URL parameter is split when passed from the command line"). My patch just moved the logic. The logic itself is very old. I can see [it existed](https://hg.mozilla.org/releases/mozilla-esr68/rev/fe3cd9f0d12bae82190bd17ea474d1a2f4bb80a2#l7.304) even before v67.

No longer regressed by: [1650637](/show_bug.cgi?id=1650637 "RESOLVED FIXED - Cyrillic URL parameter is split when passed from the command line")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a57677_406194)• 4 years ago |

[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1706501#c5)• 4 years ago |
|  | |

> [1] I will soon post a bug documenting other ways in which WM\_COPYDATA can be accessed and abused or accidentally invoked, such as by a different instance of FF running in a different account's context. Probably other Windows messages can be abused similarly. I don't know how much FF can do to protect itself from these others.

See <https://bugzilla.mozilla.org/show_bug.cgi?id=1706759> .

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a79566_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1706501#c6)• 4 years ago |
|  | |

Attached file
[Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring. r=mossop](attachment.cgi?id=9217600)
— [Details](attachment.cgi?id=9217600&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1706501#c7)• 4 years ago |
|  | |

Make CommandLineParserWin::HandleCommandLine take nsTSubstring. r=mossop

<https://hg.mozilla.org/integration/autoland/rev/ec09f17201b4ca9b609386d94cafe7f4733fea84>

<https://hg.mozilla.org/mozilla-central/rev/ec09f17201b4>

Group: firefox-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 90 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a614968_75935)• 4 years ago |

[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=wontfix)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1706501#c8)• 4 years ago |
|  | |

The patch landed in nightly and beta is affected.

:toshi, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(tkikuchi)

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1706501#c9)• 4 years ago |
|  | |

Comment on [attachment 9217600](/attachment.cgi?id=9217600 "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop") [[details]](/attachment.cgi?id=9217600&action=edit "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop")

[Bug 1706501](/show_bug.cgi?id=1706501 "RESOLVED FIXED - Read beyond bounds in remoting server") - Make CommandLineParserWin::HandleCommandLine take nsTSubstring. r=mossop

### Beta/Release Uplift Approval Request

* **User impact if declined**: The worst case is if an attacker could craft stack or heap nicely, they might open a malicious URL by sending a window message from an external program. Or, a random window message can easily cause crash, that should not happen.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The fix is basically to add a boundary check in string buffer operation. It's simple and easily understood. Since this is a security bug, I didn't include a testcase for this patch, but I already wrote a test case and verified the fix with it. It will be landed separately later (bug [bug 1708741](/show_bug.cgi?id=1708741 "RESOLVED FIXED")).
* **String changes made/needed**:
Flags: needinfo?(tkikuchi)
[Attachment #9217600](/attachment.cgi?id=9217600&action=edit "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop") -
Flags: approval-mozilla-beta?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1706501#c10)• 4 years ago |
|  | |

While the overread is clearly wrong, it's not clear to us (from a bounty-awarding perspective) that the data being read is part of what the attacker sends. MS will copy the remote message correctly, it's the receiving Firefox that gets it wrong and reads into it's own heap.

Also, local-attacker is generally not part of our threat model, with an exception for the admin-privileged maintenance service because that's a concern for Enterprise folks.

Flags: sec-bounty? → sec-bounty-

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1706501#c11)• 4 years ago |
|  | |

Toshi, could you also request an uplift to ESR? Thanks

Flags: needinfo?(tkikuchi)

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1706501#c12)• 4 years ago |
|  | |

Attached file
[Bug 1706501 - Make HandleCommandLine take nsACString](attachment.cgi?id=9221012)
— [Details](attachment.cgi?id=9221012&action=edit)

|  | [Toshihito Kikuchi [:toshi]](/user_profile?user_id=644141)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1706501#c13)• 4 years ago |
|  | |

Comment on [attachment 9221012](/attachment.cgi?id=9221012 "Bug 1706501 - Make HandleCommandLine take nsACString") [[details]](/attachment.cgi?id=9221012&action=edit "Bug 1706501 - Make HandleCommandLine take nsACString")

[Bug 1706501](/show_bug.cgi?id=1706501 "RESOLVED FIXED - Read beyond bounds in remoting server") - Make HandleCommandLine take nsACString

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: The possible exploit scenario is a local-attacker situation, but as described below, an external program can easily cause Firefox to crash by sending a window message, that should not be possible in ESR version, too.
* **User impact if declined**: The worst case is if an attacker could craft stack or heap nicely, they might open a malicious URL by sending a window message from an external program. Or, a random window message can easily cause crash, that should not happen.
* **Fix Landed on Version**: 90
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The fix is basically to add a boundary check in string buffer operation. It's simple and easily understood.
* **String or UUID changes made by this patch**: None
Flags: needinfo?(tkikuchi)
[Attachment #9221012](/attachment.cgi?id=9221012&action=edit "Bug 1706501 - Make HandleCommandLine take nsACString") -
Flags: approval-mozilla-esr78?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1706501#c14)• 4 years ago |
|  | |

Comment on [attachment 9217600](/attachment.cgi?id=9217600 "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop") [[details]](/attachment.cgi?id=9217600&action=edit "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop")

[Bug 1706501](/show_bug.cgi?id=1706501 "RESOLVED FIXED - Read beyond bounds in remoting server") - Make CommandLineParserWin::HandleCommandLine take nsTSubstring. r=mossop

Approved for 89 beta 11, thanks.

[Attachment #9217600](/attachment.cgi?id=9217600&action=edit "Bug 1706501 - Make CommandLineParserWin::HandleCommandLine take nsTSubstring.  r=mossop") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1706501#c15)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/46213ee42ebb>

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1706501#c16)• 4 years ago |
|  | |

Comment on [attachment 9221012](/attachment.cgi?id=9221012 "Bug 1706501 - Make HandleCommandLine take nsACString") [[details]](/attachment.cgi?id=9221012&action=edit "Bug 1706501 - Make HandleCommandLine take nsACString")

[Bug 1706501](/show_bug.cgi?id=1706501 "RESOLVED FIXED - Read beyond bounds in remoting server") - Make HandleCommandLine take nsACString

Approved for 78.11esr, thanks.

[Attachment #9221012](/attachment.cgi?id=9221012&action=edit "Bug 1706501 - Make HandleCommandLine take nsACString") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1706501#c17)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/80e97d09f422>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)
[tracking-firefox89](/buglist.cgi?f1=cf_tracking_firefox89&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox89&o1=equals&v1=%2B)
[tracking-firefox90](/buglist.cgi?f1=cf_tracking_firefox90&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox90&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [89+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=89%2B)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a2640640_458186)• 4 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a3140821_428608)• 4 years ago |

Whiteboard: [adv-main89+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a3141394_428608)• 4 years ago |

Whiteboard: [adv-main89+] → [adv-main89+][adv-esr78.11+r]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a3144214_428608)• 4 years ago |

Whiteboard: [adv-main89+][adv-esr78.11+r] → [adv-main89+][adv-esr78.11+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1706501#c18)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9223719) (obsolete)
— [Details](attachment.cgi?id=9223719&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1706501#c19)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9223735)
— [Details](attachment.cgi?id=9223735&action=edit)

[Attachment #9223719](/attachment.cgi?id=9223719&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a3148688_428608)• 4 years ago |

Alias: CVE-2021-29964

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a12676142_578488)• 3 years ago |

Flags: sec-bounty-hof+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a18692369_1689)• 3 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1706501#a98129052_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1706501&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [mozillabugs](/user_profile?user_id=608633)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_b54cdbeb_20250114_200320.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-26

## Security Vulnerabilities fixed in Thunderbird 78.11

Announced
June 3, 2021
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 78.11

#### [#CVE-2021-29964: Out of bounds-read when parsing a "WM\_COPYDATA" message](#CVE-2021-29964)

Reporter
Ronald Crane
Impact
moderate
##### Description

A locally-installed hostile program could send `WM_COPYDATA` messages that Thunderbird would processing incorrectly, leading to an out-of-bounds read.

*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1706501](https://bugzilla.mozilla.org/show_bug.cgi?id=1706501)

#### [#CVE-2021-29967: Memory safety bugs fixed in Thunderbird 78.11](#CVE-2021-29967)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Anny Gakhokidze, Alexandru Michis, Christian Holler reported memory safety bugs present in Thunderbird 78.11. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1602862%2C1703191%2C1703760%2C1704722%2C1706041)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


