=== Content from bugzilla.mozilla.org_38226be3_20250114_183032.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1724896)
* [XML](/show_bug.cgi?ctype=xml&id=1724896)

Closed
[Bug 1724896](/show_bug.cgi?id=1724896)
(CVE-2021-29991)

Opened 3 years ago
Closed 3 years ago

# Firefox incorrectly interprets newlines in HTTP headers in HTTP/3, allowing for header splitting

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox incorrectly interprets newlines in HTTP headers in HTTP/3, allowing for header splitting

## Categories

### (Core :: Networking: HTTP, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
▾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 90

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

93 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox-esr91 | [91+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=91%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox91 | [+](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=verified) |
| firefox92 | [+](/buglist.cgi?f1=cf_tracking_firefox92&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=verified) |
| firefox93 | [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr91 |  | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox91 | + | verified |
| firefox92 | + | verified |
| firefox93 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: neal, Assigned: dragana)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/91b350e2ab5eb2590adffaa3d0c9293a?d=mm&size=40)  [dragana](/user_profile?user_id=508195)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0f03148fe95ad54ccfe406c85f411dee?d=mm&size=40)  [neal](/user_profile?user_id=690320)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [necko-triaged][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29991

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][sec-survey]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Sanitize headers](/attachment.cgi?id=9235700)  [3 years ago](#c5)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c12 "3 years ago")  jcristau : [approval-mozilla-release+](#c15 "3 years ago")  jcristau : [approval-mozilla-esr91+](#c15 "3 years ago")  dveditz : [sec-approval+](#c7 "3 years ago") | [Details](/attachment.cgi?id=9235700&action=edit) | [Review](/attachment.cgi?id=9235700) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Neal Poole](/user_profile?user_id=690320)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1724896#c0)• 3 years ago |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36

Steps to reproduce:

1. Set up a system at <https://fb.mvfst.net/15> which speaks HTTP/3, and returns an HTTP/3 header with a newline in it.
2. Browse to it in Firefox with the Network tab open

Actual results:

The page loads properly and the Network tab indicates that Firefox parsed the header with a newline as two separate headers, similar to how it would have been parsed in HTTP/1.1

Expected results:

The page should fail to load, because the QPACK encoding for headers should allow Firefox to recognize that a single header containing a newline is present, and newlines are not allowed in headers.

|  | [Neal Poole](/user_profile?user_id=690320)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1724896#c1)• 3 years ago |
|  | |

We originally came across this issue while investigating a report of HTTP header splitting submitted via our bug bounty program. The server in question supports HTTP/1.1, HTTP/2, and HTTP/3. We found the issue only reproduced with HTTP/1.1, and with HTTP/3 in Firefox.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a16822_159069)• 3 years ago |

Group: firefox-core-security → network-core-securityComponent: Untriaged → Networking: HTTPProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1724896#c2)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1724896&comment_id=15522147 "1 revision") |
|  | |

[Tracking Requested - why for this release]:

Response splitting attacks can lead to critical security problems on websites. The sites that are the early adopters for http/3 tend to be the big sites popular with our users.

With a Fx90 build I get http/2 from that server (and no bug); in the just-released Firefox 91 I'm served http/3 and can confirm the problem (also see it in Beta). Tagging as a "regression" in that sense. Oddly, in Nightly I'm seeing http/2 even though all the relevant prefs appear to be the same as in my other test profiles -- will keep poking at that.

Update: When I refresh in Nightly and other builds I do get http/3 and can confirm the bug everywhere. Our first connection to a server doesn't use http/3 because we need to get the Alt-svc header -- I was testing too efficiently trying to hit each relevant version quickly :-)

Status: UNCONFIRMED → NEW
[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected)
[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected)
[tracking-firefox91](/buglist.cgi?f1=cf_tracking_firefox91&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%3F)
[tracking-firefox92](/buglist.cgi?f1=cf_tracking_firefox92&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox92&o1=equals&v1=%2B)Ever confirmed: trueKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a19578_75935)• 3 years ago |

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox91](/buglist.cgi?f1=cf_tracking_firefox91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%2B)
[tracking-firefox93](/buglist.cgi?f1=cf_tracking_firefox93&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [91+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=91%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1724896#c3)• 3 years ago |
|  | |

Removing the regression keyword. Apparently issue on my end: http/3 has been enabled in Release since Fx89.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a20786_1689)• 3 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Neal Poole](/user_profile?user_id=690320)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1724896#c4)• 3 years ago |
|  | |

If you go to <https://fb.mvfst.net/> first and then <https://fb.mvfst.net/15> it may work better to repro. My understanding is that browsers typically connect to an HTTP/2 or HTTP/1.1 server and "discover" the server supports HTTP/3 through the Alt-Svc header: if you go to /15 directly you may not get anything if the HTTP/2 request fails due to the splitting.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1724896#c5)• 3 years ago |
|  | |

Attached file
[Sanitize headers](attachment.cgi?id=9235700)
— [Details](attachment.cgi?id=9235700&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a40592_600971)• 3 years ago |

Assignee: nobody → dd.mozillaStatus: NEW → ASSIGNED

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a41000_600971)• 3 years ago |

[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Attachment description: Senitize headers → Sanitize headers

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1724896#c6)• 3 years ago |
|  | |

Comment on [attachment 9235700](/attachment.cgi?id=9235700 "Sanitize headers") [[details]](/attachment.cgi?id=9235700&action=edit "Sanitize headers")

Sanitize headers

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The fix really show the issue.

  [Comment 2](/show_bug.cgi?id=1724896#c2 "VERIFIED FIXED - Firefox incorrectly interprets newlines in HTTP headers in HTTP/3, allowing for header splitting") was information about the attacks.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: from 90
* **If not all supported branches, which bug introduced the flaw?**: Enabling HTTP/3 in 90 release
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: The patch will apply cleanly to 93, 92 and 91
* **How likely is this patch to cause regressions; how much testing does it need?**: Very unlikely. Our HTTP/2 stack already behaves in the same way as he change in this patch.

  Also he code change is in Rust code which makes it a bit safer.
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1724896#c7)• 3 years ago |
|  | |

Comment on [attachment 9235700](/attachment.cgi?id=9235700 "Sanitize headers") [[details]](/attachment.cgi?id=9235700&action=edit "Sanitize headers")

Sanitize headers

sec-approval=dveditz

Please don't land until the Release Managers are ready to build the point release. The patch makes the problem obvious and we don't want to leave too long a gap between landing and shipping.

[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1724896#c8)• 3 years ago |
|  | |

Comment on [attachment 9235700](/attachment.cgi?id=9235700 "Sanitize headers") [[details]](/attachment.cgi?id=9235700&action=edit "Sanitize headers")

Sanitize headers

### Beta/Release Uplift Approval Request

* **User impact if declined**: Users of sites that use http/3 are vulnerable to HTTP response splitting vulnerabilities
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Follow steps in [comment 4](/show_bug.cgi?id=1724896#c4 "VERIFIED FIXED - Firefox incorrectly interprets newlines in HTTP headers in HTTP/3, allowing for header splitting"), then open dettools and looks at the response headers for the /15 document. You should see a single header that looks like

> ```
> injectheader: Value x: new
>
> ```

rather that two separate headers

> ```
> injectheader: Value
> x: new
>
> ```

* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This is straightforward rust code to replacing problematic control characters with a space. This will make the http/3 implementation behave like http/2 where this behavior is well-tested.
* **String changes made/needed**:
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-release?
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-beta?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a157660_1689)• 3 years ago |

Flags: qe-verify+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a163252_580382)• 3 years ago |

[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-esr91?

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a182582_415378)• 3 years ago |

Severity: -- → S2Priority: -- → P1Whiteboard: [necko-triaged]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1724896#c9)• 3 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/b03420dc286b17bd8823d7e86ba5790050bc80e8>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1724896#c10)• 3 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b03420dc286b>

Group: network-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 93 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a317450_578488)• 3 years ago |

Alias: CVE-2021-29991

|  | [Neal Poole](/user_profile?user_id=690320)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1724896#c11)• 3 years ago |
|  | |

If there is going to be any public attribution of the reporter for the issue, can we use the name Youssef Sammouda? That's the researcher who submitted the report to our bug bounty program that led us to identify the behavior.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1724896#c12)• 3 years ago |
|  | |

Comment on [attachment 9235700](/attachment.cgi?id=9235700 "Sanitize headers") [[details]](/attachment.cgi?id=9235700&action=edit "Sanitize headers")

Sanitize headers

Approved for 92.0b4.

[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1724896#c13)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/2187c8b0e6f4>

[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a504495_551058)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Daniel Cicas [:dcicas], Release QA](/user_profile?user_id=629433) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1724896#c14)• 3 years ago |
|  | |

Hello,

I managed to reproduce this issue with Fx 91.0 release.

I can confirm that this issue is fixed on Fx 92.0b4 and Fx 93.0a1 on Win 10, mac OS 11.5 and Ubuntu 18.

Status: RESOLVED → VERIFIED
[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=verified)
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=verified)Flags: qe-verify+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1724896#c15)• 3 years ago |
|  | |

Comment on [attachment 9235700](/attachment.cgi?id=9235700 "Sanitize headers") [[details]](/attachment.cgi?id=9235700&action=edit "Sanitize headers")

Sanitize headers

approved for 91.0.1 (release + esr)

[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-release?
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-release+
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-esr91?
[Attachment #9235700](/attachment.cgi?id=9235700&action=edit "Sanitize headers") -
Flags: approval-mozilla-esr91+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1724896#c16)• 3 years ago |
| uplift | |

for 91.0.1:

<https://hg.mozilla.org/releases/mozilla-release/rev/a2096e046618>

for 91.0.1esr (FIREFOX\_ESR\_91\_0\_X\_RELBRANCH):

<https://hg.mozilla.org/releases/mozilla-esr91/rev/4f3e0758a0ced30fa1cf4a4577f74aa71770aae7>

for 91.1esr (default):

<https://hg.mozilla.org/releases/mozilla-esr91/rev/a5e047f1b996f8caa67a1d5ff2c03e889e9b9538>

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Daniel Cicas [:dcicas], Release QA](/user_profile?user_id=629433) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1724896#c17)• 3 years ago |
|  | |

Hello,

I verified this fix on Fx 91.0.1 Fx 91.0.1esr and Fx 91.1esr (<https://treeherder.mozilla.org/jobs?repo=mozilla-esr91&revision=a5e047f1b996f8caa67a1d5ff2c03e889e9b9538&selectedTaskRun=VK7wIrFeQ_au5V_Sx-T59Q.0>) on win 10, mac OS 11 and Ubuntu 18.04.

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1724896#c18)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1724896) to reply.

Flags: needinfo?(dd.mozilla)Whiteboard: [necko-triaged] → [necko-triaged][sec-survey]

|  | [Neal Poole](/user_profile?user_id=690320)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1724896#c19)• 3 years ago |
|  | |

<https://www.mozilla.org/en-US/security/advisories/mfsa2021-37/> mentions my name instead of Youssef. Any chance we can update that?

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1724896#c20)• 3 years ago |
|  | |

Julien, do you know the answer to question in [comment 19](/show_bug.cgi?id=1724896#c19 "VERIFIED FIXED - Firefox incorrectly interprets newlines in HTTP headers in HTTP/3, allowing for header splitting")?

Flags: needinfo?(dd.mozilla) → needinfo?(jcristau)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1724896#c21)• 3 years ago |
|  | |

Updated: <https://github.com/mozilla/foundation-security-advisories/commit/e6fae793fba581f31f5bb8ca7bb3246580c076f5>

Flags: needinfo?(jcristau)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1724896#a32995128_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1724896&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_57a02818_20250114_183032.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-37

## Security Vulnerabilities fixed in Firefox 91.0.1 and Thunderbird 91.0.1

Announced
August 16, 2021
Impact
high
Products
Firefox, Thunderbird
Fixed in

* Firefox 91.0.1
* Thunderbird 91.0.1

#### [#CVE-2021-29991: Header Splitting possible with HTTP/3 Responses](#CVE-2021-29991)

Reporter
Youssef Sammouda
Impact
high
##### Description

Firefox incorrectly accepted a newline in a HTTP/3 header, interpretting it as two separate headers. This allowed for a header splitting attack against servers using HTTP/3.

##### References

* [Bug 1724896](https://bugzilla.mozilla.org/show_bug.cgi?id=1724896)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


