=== Content from github.com_e96b389e_20250114_204402.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgetgrav%2Fgrav%2Fsecurity%2Fadvisories%2FGHSA-g8r4-p96j-xfxc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgetgrav%2Fgrav%2Fsecurity%2Fadvisories%2FGHSA-g8r4-p96j-xfxc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=getgrav%2Fgrav)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[getgrav](/getgrav)
/
**[grav](/getgrav/grav)**
Public

* [Notifications](/login?return_to=%2Fgetgrav%2Fgrav) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2Fgetgrav%2Fgrav)
* [Star
   14.7k](/login?return_to=%2Fgetgrav%2Fgrav)

* [Code](/getgrav/grav)
* [Issues
  403](/getgrav/grav/issues)
* [Pull requests
  25](/getgrav/grav/pulls)
* [Discussions](/getgrav/grav/discussions)
* [Actions](/getgrav/grav/actions)
* [Projects
  0](/getgrav/grav/projects)
* [Security](/getgrav/grav/security)
* [Insights](/getgrav/grav/pulse)

Additional navigation options

* [Code](/getgrav/grav)
* [Issues](/getgrav/grav/issues)
* [Pull requests](/getgrav/grav/pulls)
* [Discussions](/getgrav/grav/discussions)
* [Actions](/getgrav/grav/actions)
* [Projects](/getgrav/grav/projects)
* [Security](/getgrav/grav/security)
* [Insights](/getgrav/grav/pulse)

# Twig allowing dangerous PHP functions by default

High

[rhukster](/rhukster)
published
GHSA-g8r4-p96j-xfxc
Apr 13, 2021

## Package

composer

getgrav/grav
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<= 1.7.10

## Patched versions

1.7.11

## Description

### Impact

Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages.

As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance.

### Patches

The issue was addressed by preventing dangerous functions from being called in Twig templates. A configuration option has been added to manually allow arbitrary PHP functions (`system.twig.safe_functions`) and filters (`system.twig.safe_filters`).

Futures major versions of Grav may disable this functionality by default.

### Workarounds

Blocking access to the `/admin` path from untrusted sources will reduce the probability of exploitation.

### References

* <https://portswigger.net/research/server-side-template-injection>
* <https://blog.sonarsource.com/grav-cms-code-execution-vulnerabilities>

### For more information

If you have any questions or comments about this advisory, you can contact:

* The original reporters, by sending an email to vulnerability.research [at] sonarsource.com;
* The maintainers, by opening an issue on this repository.

### Severity

High

### CVE ID

CVE-2021-29440

### Weaknesses

[CWE-74](/advisories?query=cwe%3A74)

### Credits

* [![@thomas-chauchefoin-sonarsource](https://avatars.githubusercontent.com/u/79814170?s=40&v=4)](/thomas-chauchefoin-sonarsource)
  [thomas-chauchefoin-sonarsource](/thomas-chauchefoin-sonarsource)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packagist.org_5796d018_20250114_204403.html ===

Composer v1 support is [coming to an end](https://blog.packagist.com/shutting-down-packagist-org-support-for-composer-1-x/)

Toggle navigation

# [Packagist](/) *The PHP Package Repository*

* [Browse](/explore/)
* [Submit](/packages/submit)
* [Create account](/register/)
* [Sign in](/login/)

   Remember me

  [Use Github](/login/github)
  Log in

  [No account yet? Create one now!](/register/)

Search by [![](/img/algolia-logo-light.svg?v=1736524296)](https://www.algolia.com/)

## [getgrav /](/packages/getgrav/) grav

Modern, Crazy Fast, Ridiculously Easy and Amazingly Powerful Flat-File CMS

##### Maintainers

[![](https://www.gravatar.com/avatar/6baebbee28fc0d8514ecd608aa876667?s=48&d=identicon "w00fz")](/users/w00fz/)
[![](https://www.gravatar.com/avatar/0985810b185a2387703a64270e2011f1?s=48&d=identicon "rhukster")](/users/rhukster/)

##### Details

[github.com/getgrav/grav](https://github.com/getgrav/grav "Canonical Repository URL")

[Homepage](https://getgrav.org)

[Source](https://github.com/getgrav/grav/tree/develop)

[Issues](https://github.com/getgrav/grav/issues)

Fund package maintenance!

[Open Collective](https://opencollective.com/grav)

[Installs](/packages/getgrav/grav/stats):

75 982

[Dependents](/packages/getgrav/grav/dependents?order_by=downloads):

1

[Suggesters](/packages/getgrav/grav/suggesters):

0

[Security](/packages/getgrav/grav/advisories):

30

[Stars](https://github.com/getgrav/grav/stargazers):

14 651

[Watchers](https://github.com/getgrav/grav/watchers):
 338

[Forks](https://github.com/getgrav/grav/forks):

1 419

[Open Issues](https://github.com/getgrav/grav/issues):

428

Type:project

1.8.0-beta.3
2024-11-21 19:46 UTC

Requires

* php: ^8.2
* ext-curl: \*
* ext-dom: \*
* ext-gd: \*
* [ext-json](/providers/ext-json): \*
* ext-libxml: \*
* [ext-openssl](/providers/ext-openssl): \*
* [ext-zip](/providers/ext-zip): \*
* [antoligy/dom-string-iterators](/packages/antoligy/dom-string-iterators): ^1.0
* [composer/ca-bundle](/packages/composer/ca-bundle): ^1.5
* [composer/semver](/packages/composer/semver): ^3.4
* [doctrine/cache](/packages/doctrine/cache): ^2.2
* [doctrine/collections](/packages/doctrine/collections): ^2.2
* [donatj/phpuseragentparser](/packages/donatj/phpuseragentparser): ~1.9
* [dragonmantank/cron-expression](/packages/dragonmantank/cron-expression): ^3.0
* [erusev/parsedown](/packages/erusev/parsedown): ^1.7
* [erusev/parsedown-extra](/packages/erusev/parsedown-extra): ~0.8
* [filp/whoops](/packages/filp/whoops): ~2.16
* [getgrav/cache](/packages/getgrav/cache): ^2.0
* [getgrav/image](/packages/getgrav/image): ^4.0
* [guzzlehttp/psr7](/packages/guzzlehttp/psr7): ^2.7
* [itsgoingd/clockwork](/packages/itsgoingd/clockwork): ^5.3
* [league/climate](/packages/league/climate): ^3.8
* [matthiasmullie/minify](/packages/matthiasmullie/minify): ^1.3
* [maximebf/debugbar](/packages/maximebf/debugbar): ~1.23
* [miljar/php-exif](/packages/miljar/php-exif): ^0.6
* [monolog/monolog](/packages/monolog/monolog): ^2.0
* [multiavatar/multiavatar-php](/packages/multiavatar/multiavatar-php): ^1.0
* [nyholm/psr7](/packages/nyholm/psr7): ^1.8
* [nyholm/psr7-server](/packages/nyholm/psr7-server): ^1.1
* [pimple/pimple](/packages/pimple/pimple): ~3.5.0
* [psr/container](/packages/psr/container): ^1.1
* [psr/http-message](/packages/psr/http-message): ^1.1
* [psr/http-server-middleware](/packages/psr/http-server-middleware): ^1.0
* [psr/log](/packages/psr/log): ^1.1
* [psr/simple-cache](/packages/psr/simple-cache): ^1.0
* [rhukster/dom-sanitizer](/packages/rhukster/dom-sanitizer): ^1.0
* [rockettheme/toolbox](/packages/rockettheme/toolbox): v2.x-dev
* [symfony/cache](/packages/symfony/cache): ^6.4
* [symfony/console](/packages/symfony/console): ^6.4
* [symfony/event-dispatcher](/packages/symfony/event-dispatcher): ^6.4
* [symfony/http-client](/packages/symfony/http-client): ^6.4
* [symfony/polyfill-iconv](/packages/symfony/polyfill-iconv): ^1.24
* [symfony/polyfill-mbstring](/packages/symfony/polyfill-mbstring): ^1.24
* [symfony/polyfill-php80](/packages/symfony/polyfill-php80): ^1.24
* [symfony/polyfill-php81](/packages/symfony/polyfill-php81): ^1.24
* [symfony/process](/packages/symfony/process): ^6.4
* [symfony/var-dumper](/packages/symfony/var-dumper): ^6.4
* [symfony/var-exporter](/packages/symfony/var-exporter): ^6.4
* [symfony/yaml](/packages/symfony/yaml): ^6.4
* [twig/twig](/packages/twig/twig): ^2.1
* [willdurand/negotiation](/packages/willdurand/negotiation): ^3.1

Requires (Dev)

* [codeception/codeception](/packages/codeception/codeception): ^5.1
* [codeception/module-asserts](/packages/codeception/module-asserts): \*
* [codeception/module-phpbrowser](/packages/codeception/module-phpbrowser): \*
* [getgrav/markdowndocs](/packages/getgrav/markdowndocs): ^2.0
* [phpstan/phpstan](/packages/phpstan/phpstan): ^1.12
* [phpstan/phpstan-deprecation-rules](/packages/phpstan/phpstan-deprecation-rules): ^1.2
* [phpunit/php-code-coverage](/packages/phpunit/php-code-coverage): ~9.2
* [rector/rector](/packages/rector/rector): ^1.2

Suggests

* ext-exif: Needed to use exif data from images.
* [ext-iconv](/providers/ext-iconv): Recommended for better performance
* ext-intl: Recommended for multi-language sites
* [ext-mbstring](/providers/ext-mbstring): Recommended for better performance
* ext-memcache: Needed to support Memcache servers
* [ext-memcached](/providers/ext-memcached): Needed to support Memcached servers
* [ext-redis](/providers/ext-redis): Needed to support Redis servers
* ext-zend-opcache: Recommended for better performance

Provides

None

Conflicts

None

Replaces

* [symfony/polyfill-php72](/packages/symfony/polyfill-php72): \*
* [symfony/polyfill-php73](/packages/symfony/polyfill-php73): \*
* [symfony/polyfill-php74](/packages/symfony/polyfill-php74): \*

 MIT  a15fe29f43b921604a773dfeb1efef7ae7505c0c

[php](https://packagist.org/search/?tags=php)[cms](https://packagist.org/search/?tags=cms)[flat cms](https://packagist.org/search/?tags=flat%20cms)[flat-file cms](https://packagist.org/search/?tags=flat-file%20cms)[flatfile cms](https://packagist.org/search/?tags=flatfile%20cms)

* [dev-develop / 1.x-dev](#dev-develop)
* [1.8.x-dev](#1.8.x-dev)
* [1.8.0-beta.3](#1.8.0-beta.3)
* [1.8.0-beta.2](#1.8.0-beta.2)
* [1.8.0-beta.1](#1.8.0-beta.1)
* [1.7.48](#1.7.48)
* [1.7.47](#1.7.47)
* [1.7.46](#1.7.46)
* [1.7.45](#1.7.45)
* [1.7.44](#1.7.44)
* [1.7.43](#1.7.43)
* [1.7.42.3](#1.7.42.3)
* [1.7.42.2](#1.7.42.2)
* [1.7.42.1](#1.7.42.1)
* [1.7.42](#1.7.42)
* [1.7.41.2](#1.7.41.2)
* [1.7.41.1](#1.7.41.1)
* [1.7.41](#1.7.41)
* [1.7.40](#1.7.40)
* [1.7.39.4](#1.7.39.4)
* [1.7.39.3](#1.7.39.3)
* [1.7.39.2](#1.7.39.2)
* [1.7.39.1](#1.7.39.1)
* [1.7.39](#1.7.39)
* [1.7.38](#1.7.38)
* [1.7.37.1](#1.7.37.1)
* [1.7.37](#1.7.37)
* [1.7.36](#1.7.36)
* [1.7.35](#1.7.35)
* [1.7.34](#1.7.34)
* [1.7.33](#1.7.33)
* [1.7.32](#1.7.32)
* [1.7.31](#1.7.31)
* [1.7.30](#1.7.30)
* [1.7.29.1](#1.7.29.1)
* [1.7.29](#1.7.29)
* [1.7.28](#1.7.28)
* [1.7.27.1](#1.7.27.1)
* [1.7.27](#1.7.27)
* [1.7.26.1](#1.7.26.1)
* [1.7.26](#1.7.26)
* [1.7.25](#1.7.25)
* [1.7.24](#1.7.24)
* [1.7.23](#1.7.23)
* [1.7.22](#1.7.22)
* [1.7.21](#1.7.21)
* [1.7.20](#1.7.20)
* [1.7.19](#1.7.19)
* [1.7.18](#1.7.18)
* [1.7.17](#1.7.17)
* [1.7.16](#1.7.16)
* [1.7.15](#1.7.15)
* [1.7.14](#1.7.14)
* [1.7.13](#1.7.13)
* [1.7.12](#1.7.12)
* [1.7.10](#1.7.10)
* [1.7.9](#1.7.9)
* [1.7.8](#1.7.8)
* [1.7.7](#1.7.7)
* [1.7.6](#1.7.6)
* [1.7.5](#1.7.5)
* [1.7.4](#1.7.4)
* [1.7.3](#1.7.3)
* [1.7.1](#1.7.1)
* [1.7.0](#1.7.0)
* [1.7.0-rc.20](#1.7.0-rc.20)
* [1.7.0-rc.19](#1.7.0-rc.19)
* [1.7.0-rc.18](#1.7.0-rc.18)
* [1.7.0-rc.17](#1.7.0-rc.17)
* [1.7.0-rc.16](#1.7.0-rc.16)
* [1.7.0-rc.15](#1.7.0-rc.15)
* [1.7.0-rc.14](#1.7.0-rc.14)
* [1.7.0-rc.13](#1.7.0-rc.13)
* [1.7.0-rc.12](#1.7.0-rc.12)
* [1.7.0-rc.11](#1.7.0-rc.11)
* [1.7.0-rc.10](#1.7.0-rc.10)
* [1.7.0-rc.9](#1.7.0-rc.9)
* [1.7.0-rc.8](#1.7.0-rc.8)
* [1.7.0-rc.7](#1.7.0-rc.7)
* [1.7.0-rc.6](#1.7.0-rc.6)
* [1.7.0-rc.5](#1.7.0-rc.5)
* [1.7.0-rc.4](#1.7.0-rc.4)
* [1.7.0-rc.3](#1.7.0-rc.3)
* [1.7.0-rc.2](#1.7.0-rc.2)
* [1.7.0-rc.1](#1.7.0-rc.1)
* [1.7.0-beta.10](#1.7.0-beta.10)
* [1.7.0-beta.9](#1.7.0-beta.9)
* [1.7.0-beta.8](#1.7.0-beta.8)
* [1.7.0-beta.7](#1.7.0-beta.7)
* [1.7.0-beta.6](#1.7.0-beta.6)
* [1.7.0-beta.5](#1.7.0-beta.5)
* [1.7.0-beta.4](#1.7.0-beta.4)
* [1.7.0-beta.3](#1.7.0-beta.3)
* [1.7.0-beta.2](#1.7.0-beta.2)
* [1.7.0-beta.1](#1.7.0-beta.1)
* [1.6.31](#1.6.31)
* [1.6.30](#1.6.30)
* [1.6.29](#1.6.29)
* [1.6.28](#1.6.28)
* [1.6.27](#1.6.27)
* [1.6.26](#1.6.26)
* [1.6.25](#1.6.25)
* [1.6.24](#1.6.24)
* [1.6.23](#1.6.23)
* [1.6.22](#1.6.22)
* [1.6.21](#1.6.21)
* [1.6.20](#1.6.20)
* [1.6.19](#1.6.19)
* [1.6.18](#1.6.18)
* [1.6.17](#1.6.17)
* [1.6.16](#1.6.16)
* [1.6.15](#1.6.15)
* [1.6.14](#1.6.14)
* [1.6.13](#1.6.13)
* [1.6.12](#1.6.12)
* [1.6.11](#1.6.11)
* [1.6.10](#1.6.10)
* [1.6.9](#1.6.9)
* [1.6.8](#1.6.8)
* [1.6.7](#1.6.7)
* [1.6.6](#1.6.6)
* [1.6.5](#1.6.5)
* [1.6.4](#1.6.4)
* [1.6.3](#1.6.3)
* [1.6.2](#1.6.2)
* [1.6.1](#1.6.1)
* [1.6.0](#1.6.0)
* [1.6.0-rc.4](#1.6.0-rc.4)
* [1.6.0-rc.3](#1.6.0-rc.3)
* [1.6.0-rc.2](#1.6.0-rc.2)
* [1.6.0-rc.1](#1.6.0-rc.1)
* [1.6.0-beta.8](#1.6.0-beta.8)
* [1.6.0-beta.7](#1.6.0-beta.7)
* [1.6.0-beta.6](#1.6.0-beta.6)
* [1.6.0-beta.5](#1.6.0-beta.5)
* [1.6.0-beta.4](#1.6.0-beta.4)
* [1.6.0-beta.3](#1.6.0-beta.3)
* [1.6.0-beta.2](#1.6.0-beta.2)
* [1.6.0-beta.1](#1.6.0-beta.1)
* [1.5.10](#1.5.10)
* [1.5.9](#1.5.9)
* [1.5.8](#1.5.8)
* [1.5.7](#1.5.7)
* [1.5.6](#1.5.6)
* [1.5.5](#1.5.5)
* [1.5.4](#1.5.4)
* [1.5.3](#1.5.3)
* [1.5.2](#1.5.2)
* [1.5.1](#1.5.1)
* [1.5.0](#1.5.0)
* [1.5.0-rc.1](#1.5.0-rc.1)
* [1.5.0-beta.2](#1.5.0-beta.2)
* [1.5.0-beta.1](#1.5.0-beta.1)
* [1.4.8](#1.4.8)
* [1.4.7](#1.4.7)
* [1.4.6](#1.4.6)
* [1.4.5](#1.4.5)
* [1.4.4](#1.4.4)
* [1.4.3](#1.4.3)
* [1.4.2](#1.4.2)
* [1.4.1](#1.4.1)
* [1.4.0](#1.4.0)
* [1.4.0-rc.2](#1.4.0-rc.2)
* [1.4.0-rc.1](#1.4.0-rc.1)
* [1.4.0-beta.3](#1.4.0-beta.3)
* [1.4.0-beta.2](#1.4.0-beta.2)
* [1.4.0-beta.1](#1.4.0-beta.1)
* [1.3.10](#1.3.10)
* [1.3.9](#1.3.9)
* [1.3.8](#1.3.8)
* [1.3.7](#1.3.7)
* [1.3.6](#1.3.6)
* [1.3.5](#1.3.5)
* [1.3.4](#1.3.4)
* [1.3.3](#1.3.3)
* [1.3.2](#1.3.2)
* [1.3.1](#1.3.1)
* [1.3.0](#1.3.0)
* [1.3.0-rc.5](#1.3.0-rc.5)
* [1.3.0-rc.4](#1.3.0-rc.4)
* [1.3.0-rc.3](#1.3.0-rc.3)
* [1.3.0-rc.2](#1.3.0-rc.2)
* [1.3.0-rc.1](#1.3.0-rc.1)
* [1.2.4](#1.2.4)
* [1.2.3](#1.2.3)
* [1.2.2](#1.2.2)
* [1.2.1](#1.2.1)
* [1.2.0](#1.2.0)
* [1.2.0-rc.3](#1.2.0-rc.3)
* [1.2.0-rc.2](#1.2.0-rc.2)
* [1.2.0-rc.1](#1.2.0-rc.1)
* [1.1.17](#1.1.17)
* [1.1.16](#1.1.16)
* [1.1.15](#1.1.15)
* [1.1.14](#1.1.14)
* [1.1.13](#1.1.13)
* [1.1.12](#1.1.12)
* [1.1.11](#1.1.11)
* [1.1.10](#1.1.10)
* [1.1.9](#1.1.9)
* [1.1.9-rc.3](#1.1.9-rc.3)
* [1.1.9-rc.2](#1.1.9-rc.2)
* [1.1.9-rc.1](#1.1.9-rc.1)
* [1.1.8](#1.1.8)
* [1.1.7](#1.1.7)
* [1.1.6](#1.1.6)
* [1.1.5](#1.1.5)
* [1.1.4](#1.1.4)
* [1.1.3](#1.1.3)
* [1.1.2](#1.1.2)
* [1.1.1](#1.1.1)
* [1.1.0](#1.1.0)
* [1.1.0-rc.3](#1.1.0-rc.3)
* [1.1.0-rc.2](#1.1.0-rc.2)
* [1.1.0-rc.1](#1.1.0-rc.1)
* [1.1.0-beta.5](#1.1.0-beta.5)
* [1.1.0-beta.4](#1.1.0-beta.4)
* [1.1.0-beta.3](#1.1.0-beta.3)
* [1.1.0-beta.2](#1.1.0-beta.2)
* [1.1.0-beta.1](#1.1.0-beta.1)
* [1.0.10](#1.0.10)
* [1.0.9](#1.0.9)
* [1.0.8](#1.0.8)
* [1.0.7](#1.0.7)
* [1.0.6](#1.0.6)
* [1.0.5](#1.0.5)
* [1.0.4](#1.0.4)
* [1.0.3](#1.0.3)
* [1.0.2](#1.0.2)
* [1.0.1](#1.0.1)
* [1.0.0](#1.0.0)
* [1.0.0-rc.6](#1.0.0-rc.6)
* [1.0.0-rc.5](#1.0.0-rc.5)
* [1.0.0-rc.4](#1.0.0-rc.4)
* [1.0.0-rc.3](#1.0.0-rc.3)
* [1.0.0-rc.2](#1.0.0-rc.2)
* [1.0.0-rc.1](#1.0.0-rc.1)
* [0.9.45](#0.9.45)
* [0.9.44](#0.9.44)
* [0.9.43](#0.9.43)
* [0.9.42](#0.9.42)
* [0.9.41](#0.9.41)
* [0.9.40](#0.9.40)
* [0.9.39](#0.9.39)
* [0.9.38](#0.9.38)
* [0.9.37](#0.9.37)
* [0.9.36](#0.9.36)
* [0.9.35](#0.9.35)
* [0.9.34](#0.9.34)
* [0.9.33](#0.9.33)
* [0.9.32](#0.9.32)
* [0.9.31](#0.9.31)
* [0.9.30](#0.9.30)
* [0.9.29](#0.9.29)
* [0.9.28](#0.9.28)
* [0.9.27](#0.9.27)
* [0.9.26](#0.9.26)
* [0.9.25](#0.9.25)
* [0.9.24](#0.9.24)
* [0.9.23](#0.9.23)
* [0.9.22](#0.9.22)
* [0.9.21](#0.9.21)
* [0.9.20](#0.9.20)
* [0.9.19](#0.9.19)
* [0.9.18](#0.9.18)
* [0.9.17](#0.9.17)
* [0.9.16](#0.9.16)
* [0.9.15](#0.9.15)
* [0.9.14](#0.9.14)
* [0.9.13](#0.9.13)
* [0.9.12](#0.9.12)
* [0.9.11](#0.9.11)
* [0.9.10](#0.9.10)
* [0.9.9](#0.9.9)
* [0.9.8](#0.9.8)
* [0.9.7](#0.9.7)
* [0.9.6](#0.9.6)
* [0.9.5](#0.9.5)
* [0.9.4](#0.9.4)
* [0.9.3](#0.9.3)
* [0.9.2](#0.9.2)
* [0.9.1](#0.9.1)
* [0.9.0](#0.9.0)
* [0.8.0](#0.8.0)
* [dev-master](#dev-master)
* [dev-feature/media](#dev-feature/media)
* [dev-feature/watermark](#dev-feature/watermark)
* [dev-feature/parsedown-1.8-compatibility](#dev-feature/parsedown-1.8-compatibility)

This package is auto-updated.

Last update: 2025-01-13 12:30:27 UTC

---

# README

[![PHPStan](https://camo.githubusercontent.com/610887b1c25490a9f5ce3e090f93307973fc3648ad9d00a1a8dd9af7226060a9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f5048505374616e2d656e61626c65642d627269676874677265656e2e7376673f7374796c653d666c6174)](https://github.com/phpstan/phpstan)
[![Discord](https://camo.githubusercontent.com/74b2bf1bbef026033187f129b53fd9ecdad8e2e89b991988ce4b9797746c2d9b/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f3530313833363933363538343130313839392e7376673f6c6f676f3d646973636f726426636f6c6f72423d373238414441266c6162656c3d446973636f726425323043686174)](https://chat.getgrav.org)
[![PHP Tests](https://github.com/getgrav/grav/workflows/PHP%20Tests/badge.svg?branch=develop)](https://github.com/getgrav/grav/actions?query=workflow%3A%22PHP+Tests%22) [![OpenCollective](https://camo.githubusercontent.com/be9a82a8702513fb4bd608290b9cdeb3532212ab56c9847c78afc282e1bc7a5e/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f6261636b6572732f62616467652e7376673f6c6162656c3d4261636b65727326636f6c6f723d627269676874677265656e)](#user-content-backers) [![OpenCollective](https://camo.githubusercontent.com/d001c920154ba7f2b920577fccce47850da558d5fb8f7e373c05c0fc9ee8a1b2/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f737570706f72746572732f62616467652e7376673f6c6162656c3d537570706f727465727326636f6c6f723d627269676874677265656e)](#user-content-supporters) [![OpenCollective](https://camo.githubusercontent.com/0911a251d71ac03e1d3d2e316838b53874001d6814e26e978379d40a90b60ede/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f73706f6e736f72732f62616467652e7376673f6c6162656c3d53706f6e736f727326636f6c6f723d627269676874677265656e)](#user-content-sponsors)

Grav is a **Fast**, **Simple**, and **Flexible**, file-based Web-platform. There is **Zero** installation required. Just extract the ZIP archive, and you are already up and running. It follows similar principles to other flat-file CMS platforms, but has a different design philosophy than most. Grav comes with a powerful **Package Management System** to allow for simple installation and upgrading of plugins and themes, as well as simple updating of Grav itself.

The underlying architecture of Grav is designed to use well-established and *best-in-class* technologies to ensure that Grav is simple to use and easy to extend. Some of these key technologies include:

* [Twig Templating](https://twig.symfony.com/): for powerful control of the user interface
* [Markdown](https://en.wikipedia.org/wiki/Markdown): for easy content creation
* [YAML](https://yaml.org): for simple configuration
* [Parsedown](https://parsedown.org/): for fast Markdown and Markdown Extra support
* [Doctrine Cache](https://www.doctrine-project.org/projects/doctrine-orm/en/latest/reference/caching.html): layer for performance
* [Pimple Dependency Injection Container](https://github.com/silexphp/Pimple): for extensibility and maintainability
* [Symfony Event Dispatcher](https://symfony.com/doc/current/components/event_dispatcher/introduction.html): for plugin event handling
* [Symfony Console](https://symfony.com/doc/current/components/console/introduction.html): for CLI interface
* [Gregwar Image Library](https://github.com/Gregwar/Image): for dynamic image manipulation

# Requirements

* PHP 7.3.6 or higher. Check the [required modules list](https://learn.getgrav.org/basics/requirements#php-requirements)
* Check the [Apache](https://learn.getgrav.org/basics/requirements#apache-requirements) or [IIS](https://learn.getgrav.org/basics/requirements#iis-requirements) requirements

# Documentation

The full documentation can be found from [learn.getgrav.org](https://learn.getgrav.org).

# QuickStart

These are the options to get Grav:

### Downloading a Grav Package

You can download a **ready-built** package from the [Downloads page on https://getgrav.org](https://getgrav.org/downloads)

### With Composer

You can create a new project with the latest **stable** Grav release with the following command:

```
$ composer create-project getgrav/grav ~/webroot/grav

```
### From GitHub

1. Clone the Grav repository from [https://github.com/getgrav/grav](https://github.com/getgrav/grav/blob/HEAD/) to a folder in the webroot of your server, e.g. `~/webroot/grav`. Launch a **terminal** or **console** and navigate to the webroot folder:

   ```
   $ cd ~/webroot
   $ git clone https://github.com/getgrav/grav.git

   ```
2. Install the **plugin** and **theme dependencies** by using the [Grav CLI application](https://learn.getgrav.org/advanced/grav-cli) `bin/grav`:

   ```
   $ cd ~/webroot/grav
   $ bin/grav install

   ```

Check out the [install procedures](https://learn.getgrav.org/basics/installation) for more information.

# Adding Functionality

You can download [plugins](https://getgrav.org/downloads/plugins) or [themes](https://getgrav.org/downloads/themes) manually from the appropriate tab on the [Downloads page on https://getgrav.org](https://getgrav.org/downloads), but the preferred solution is to use the [Grav Package Manager](https://learn.getgrav.org/advanced/grav-gpm) or `GPM`:

```
$ bin/gpm index

```

This will display all the available plugins and then you can install one or more with:

```
$ bin/gpm install <plugin/theme>

```
# Updating

To update Grav you should use the [Grav Package Manager](https://learn.getgrav.org/advanced/grav-gpm) or `GPM`:

```
$ bin/gpm selfupgrade

```

To update plugins and themes:

```
$ bin/gpm update

```
## Upgrading from older version

* [Upgrading to Grav 1.7](https://learn.getgrav.org/16/advanced/grav-development/grav-17-upgrade-guide)
* [Upgrading to Grav 1.6](https://learn.getgrav.org/16/advanced/grav-development/grav-16-upgrade-guide)
* [Upgrading from Grav <1.6](https://learn.getgrav.org/16/advanced/grav-development/grav-15-upgrade-guide)

# Contributing

We appreciate any contribution to Grav, whether it is related to bugs, grammar, or simply a suggestion or improvement! Please refer to the [Contributing guide](https://github.com/getgrav/grav/blob/HEAD/CONTRIBUTING.md) for more guidance on this topic.

## Security issues

If you discover a possible security issue related to Grav or one of its plugins, please email the core team at contact@getgrav.org and we'll address it as soon as possible.

# Getting Started

* [What is Grav?](https://learn.getgrav.org/basics/what-is-grav)
* [Install](https://learn.getgrav.org/basics/installation) Grav in few seconds
* Understand the [Configuration](https://learn.getgrav.org/basics/grav-configuration)
* Take a peek at our available free [Skeletons](https://getgrav.org/downloads/skeletons)
* If you have questions, jump on our [Discord Chat Server](https://chat.getgrav.org)!
* Have fun!

# Exploring More

* Have a look at our [Basic Tutorial](https://learn.getgrav.org/basics/basic-tutorial)
* Dive into more [advanced](https://learn.getgrav.org/advanced) functions
* Learn about the [Grav CLI](https://learn.getgrav.org/cli-console/grav-cli)
* Review examples in the [Grav Cookbook](https://learn.getgrav.org/cookbook)
* More [Awesome Grav Stuff](https://github.com/getgrav/awesome-grav)

# Backers

Support Grav with a monthly donation to help us continue development. [[Become a backer](https://opencollective.com/grav/contribute)]

[![](https://camo.githubusercontent.com/e4a76f96d7e508644c44907768251996c4c7dc35ad0c6c00940c174d2e83a504/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f6261636b6572732e7376673f6176617461724865696768743d33362677696474683d363030)](https://camo.githubusercontent.com/e4a76f96d7e508644c44907768251996c4c7dc35ad0c6c00940c174d2e83a504/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f6261636b6572732e7376673f6176617461724865696768743d33362677696474683d363030)

# Supporters

Support Grav with a monthly donation to help us continue development. [[Become a supporter](https://opencollective.com/grav/contribute)]

[![](https://camo.githubusercontent.com/e780a5427c4c8e43fe9c55613c00e59c2a26abf18e6d6701a27b357bff2a2c2e/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f737570706f72746572732e7376673f6176617461724865696768743d33362677696474683d363030)](https://camo.githubusercontent.com/e780a5427c4c8e43fe9c55613c00e59c2a26abf18e6d6701a27b357bff2a2c2e/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f737570706f72746572732e7376673f6176617461724865696768743d33362677696474683d363030)

# Sponsors

Support Grav with a yearly donation to help us continue development. [[Become a sponsor](https://opencollective.com/grav/contribute)]

[![](https://camo.githubusercontent.com/14050ea00829b871e3ff499aecaca096198fbb9b55fa312163a31a6da97aefc4/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f73706f6e736f72732e7376673f6176617461724865696768743d33362677696474683d363030)](https://camo.githubusercontent.com/14050ea00829b871e3ff499aecaca096198fbb9b55fa312163a31a6da97aefc4/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f677261762f74696572732f73706f6e736f72732e7376673f6176617461724865696768743d33362677696474683d363030)

# License

See [LICENSE](https://github.com/getgrav/grav/blob/HEAD/LICENSE.txt)

# Running Tests

First install the dev dependencies by running `composer install` from the Grav root.

Then `composer test` will run the Unit Tests, which should be always executed successfully on any site.
Windows users should use the `composer test-windows` command.
You can also run a single unit test file, e.g. `composer test tests/unit/Grav/Common/AssetsTest.php`

To run phpstan tests, you should run:

* `composer phpstan` for global tests
* `composer phpstan-framework` for more strict tests
* `composer phpstan-plugins` to test all installed plugins

* [About Packagist](/about)
* [Atom/RSS Feeds](/feeds/)

* [Statistics](/statistics)
* [Browse Packages](/explore/)

* [API](/apidoc)
* [Mirrors](/mirrors)

* [Status](https://status.packagist.org/)
* [Dashboard](https://p.datadoghq.com/sb/x98w56x71erzshui-4a54c45f82bacc991e83302548934b6a)

Packagist maintenance and hosting provided by [![Private Packagist](/img/private-packagist.svg?v=1736524296)](https://packagist.com/)

Monitoring provided by [![Datadog](/img/datadog-light.png?v=1736524296)](https://datadog.com/)



=== Content from packetstormsecurity.com_324156f0_20250114_204359.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from assets-eu-01.kc-usercontent.com:443_37f57320_20250115_121043.html ===
RIFFr;  WEBPVP8 f;  p� �\*�l>Q(�F����!�p
in�|�� ��}���<�yw��U;v��/N[�����{������}�~���U�~��g�����ݽ�����{����w������7e����\_���'��ϴ'�Mi��0�T�#�o�����?�zc��̿d���7������\_�-�W����E��;����������O���\_��)��+�����' �����O������������R�=�����7��������O|�����/���� �[�s�O�/�߼�M�����%����ۏ��?�������i��������?{}�Db���!ŝ����!ŝ����!ŝ����!ŝ��0��'T�ZQ�4�'����{VE����VE����VE����-ócҋ� omG#�^��jgG�����-�+��x������тnF�e� ����z=��3���� �{VE����VE����VE,���a�8(��1(
�9��W�����z�~�Z�؄"�����'j�����#D]yAY��C}���8�2fGr�%� �Y.�8qg~}�"�qg~}�"�qg~}����ۻ�=�\�>](
��βX���?��y�P'����l25��)&�
�B�
x�3�'4�Ø�ڱ{��U{y��F���{VE����VE����V>^V��/�u4/YV/� c�q(��G��>
m��F�4a� �����!9�҅�Q�����"�qg~}�"�qg~}�"�aX�|�,i��V{m�ZUŞ񗸳�>ՑD8��>ՑD8��>՘��ڲ(�w�ڲ(�w�ڲ(�w�ڲ'����p��>�E~\"��\_�����W���+����}C,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϱvH�{lZ��jU<�9S��;�\y�[��~�7��8�M�Dnµ,N�3�@,��������ʤv4��a>�t�̇J��,��w��k0O��L-V����4�Ӂ�g߶�e���9G�m�#��R1�$U@�,"���M�\*�`���@y''^��B��ytJt�f���
�o�x�t4�3�h�L ���2��9{Z�Z��D��2�����K����Z�&�ђ0#"@��H�y.��EBR�u��D��<�f!>����̦�2����̞���#�Hŝ�e���?��sSHz���|� � &�O�S��^\�N��E�������~��'���+�a&�Ӏ��;�J\_��
�I���˸d
�����ӗ<�03JW)�2S�(esW�����\*�Ɏ �iA����%��N�?�a5�SS����hK]�Z�����"�qg��[����YЗ��H���0��g�#�E���(��S�q"�화��}U�h������j���]���ٛhD\*��q0���#o��chM�9���`l���,���
嚎�3ԋ�e�m�E�^ՑD8��>ՑD8��>Ց&$]�α/1�6���i�I��{�k6A�n�����?�>0�7t��ng��80���C�;��YC�;��YC�;��YG��nQx�dQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵdQ,�ϵ^  ���� ��@�P���de�I!L՜��o�2��͐}s��R}�|�
]V ��B�9w�pY��0�� v�z2j�⑂�4�.a/&�q\�nIJJ{�ݢT]'��������&ĵ��$H��I>;�1}��f/���+�G��-nr��ؖ�.��T���$����t�/��^-:J���xZ�J:���v`M�t/A��4���ZO)0��0.F�Ik
�W�#T�iL�щ���$�<���o�Q�����N��",���IN���Æ��T=�6\*��ƴ�B��I4��s��N��u��G'���g�Mv\*m�g\ {���֥��6O��ԷWIf�d
���+�t��坚�e)�lE�,T�ܚ��N���@A8�O��]���H���xV���0K��o�ռ�A,�|[��"o�?���t:ѿ�-�;�����M�3�V������L%�[Xh$G���
Q�f�$������W]C��魑�B�i-�.�g.������ aO�#�;(��B��x ��j9��EL��r����`�x�x�@�/J!z������z]���;����h�W� &�b�����\_߇O�
�(c�<�T�w��|7�5�PX����e��\*
�W�p�?�W��V�\_|p�H�%�� �XɄ�w�:�&D�S�u
���?�W+keb�m�<���hnK��^F�Cv��R%�����^K� ��~��C?���T��� E�?ғ; Rw��hXv����U%Z6������.ˆ�.���6u�����/�p L�Tr1l�,]�A"u��by�gA���}l�Ulv#���`�u� �'�Rf�E��5�ة�d�%,[q���%[m���Zy�
ȋ�8<���:^�Y����� H��Y�
���1��+M������r兑xt�D�f e����/'�����P�ū�Ŧ��(8?�7���i�]S�Nx���\*Nu߯�y5[��c\�<�L O��$D+�Z���`6&+�Yp�9�AāW6/�V8����2�O� ��u��<0\_�a
�.}�G�!:�i��W\�[
i�d��;��:�˝�b٘�L���`)�F\�VO[
�a�^bC1\*[zD�&�%0v��ò�wnk�SBQ�����#� G����Fl��9 ��M?�wgC�ޞQ ����L�Ѐ<�Z�{^)�K�l?-ѩu�6����
2��>�Ty�\��a}us�V&f�X�U����\_i��Z%\/�������l�G�� �G���ݹ����8(OoKn���VT���O�w������PNG�J`(�W5��/�6>�;��se.�}���I��@r/�6'�{�H���
C��׃��H/�H]��G�q����b��7Op��g���u�ߙ��O�1�\*����7�^k�{G ��p�c�\*�R�+w�G�/8�?% "�|o/Ȗ���t�FD��/��q��o����ܠ�:^�i\_��ZJ�x��v/�a\*{aJ�i�`�����Zީ����Zn{Jj3�o�o7"�m��%3����O\�P��,}�j=2�� o����+��i���?��7���t�Jؖ ��A��r��KW��A�J��5�lV�n��뺽KυQ��d��\*���)���72�<3XsdP��sU�E8��������F�?����ˋX�{j`������(t��n�@x�������KG'���\O��3\_��X Bb]rr��ٲ =d�2�~���]�i�N�A�c�+1%�����O0z��Т8�����<�vW����Be�o����3���\*.��^T��8�pB�m�[��o�&�����'»\_�J/�
�
�K���ֺu×�5�x���͗`��]V�Y��[I�P����d+S>�W���S�ʭ��KYOS�����θ���o��6D��}�8"az^ 0�G\S��TV���h��f��nGl��EB��Q�#$]�+-��x����[l�
�Q�
X|�zq>q��O���I� ���jB
l;���A"�Bz�V�E���b��U�.�Iv t��L����'FV
D;#�߆65�&�u��������(���'��+�\_�#xv�Og��3� և�
V�d6>���o8+ܲ�{!�� ��73�eR�)D�e[4��Y߸S hI�6-6m�y�L���W��!�/Y�.�Wԍ��/�%�=��ۚ�ݝ�^�!����#�>7H%d �fu��&�h������#�$y�o�i�]rY��"�����N� �+�L��F�$�#m�R�����xN�q��\_S���+���W08�4�0�\*��|��
��?�[��-�;��N�6�
}��
.4��BSP˟  nJc��g���Ѻ�(ƃ�����F�+vΛoj:�!q�=I���\
�u����åC!�!�2&`�ꐟ>�@'�T֢�S@W�c�������-!�LV�M<�O���7��\F�p���Jj�C����&�ݍ�7۷��s��\���)6Źg�ޛ� /^ʹ��1$�E��OܙCn��#'��9��
uLv�u��q+'g���m�����p1P=�c��M�'�Si>��kc}��<�Nᩁr/��Ų�I6�X$�\
�d
�q~� �+�N��f�Ϣ^��@䨀�?�g\��LV�|n�2?�D�o��wf����\*gc�~(��Z����v��6��p���/e��^k���L�˥vVy8:.s�� �d�БU�6�6���Ρg�Ѳo���8��=Jj u�׿���n#\_k�,�e�r�6"L�0v�f���N>�]��Y2q��,$hH�L��xV�X0L���(U
�'|�ň���4�c�     3^�V-��             ��?�-�gƿ�,q6�S`UȦtڗ��Y �,j,O���˅a����-5���vh�m�V��,Ҍ���3�U�0�b�>�
���?��e{�Jp�#fք�MZq�}U@�P�'A�2�XC
?����$k ����\*჻�F,
\_�3zF@0�z@&���4R�����eVe�+ �#Jh�8��S�Hi��&O���ϗ����s엌A0��h�����5���U���\_�\+�ϼpU\rG� �k�ۡ�/��F�ī��
C4�0�c��lZ��hA���tR��ɬǪn}7 ����}�[�5��/���s�$b�p�赚��?�)
'��o�ZF
&���UƼ�G��L���\o�l�O('�)f��/9�hӼ��[C/����<� �w.yA���d�s�4��{h�����B1�7��Lm�BGԈ# ,(�����
-\_xȿڽ��>� Z�m�X&Tt
bh�S�e�a�I�obfJ��y��@I�e�\4B"U^��$v�h��JB�𶶬j��4�%��ۀj'9�#|���෰�d�ܘ��1�em�u}Q][vj�B��z��
f����L���1���SDJH��\*ћGe�I�n';C!���jk,r��;��'�y�m)�ֱ8��/��h�f7>��LM :'� �8�HQ�L��h�ھ�a
�������,;�͎���m����?
9'r���6�������`�I��:�� X@��B��=R� ��Xۅ>���'/�j��xb�����a��ٔ�.PW�K� ��Ǒ���}�bX�^H!�Vh��N���=�ヷ
���Hp]�m6:����TV$4����|���AA)��5
��
��6&Dս�W)L���I��Y�" �ҲV�gV\_g�~��5��Hژ�A�@ �8� D��qL��:.ԫ�:�Ox[�`�ʯ�PiR�@�M�wf�Nox{z�n[��Á�$l���6���O��A#�p���� /�m�L}'���6Ԍn��Q��#�C�� �7���b�\*�3�l6::��b�9=�i�oy\_��L��Ρj�4lQn%����'��B1}�9�L�,��e��A��o���T|��A�p�!���~��|�cz��E�#U���[G\�E�����fTN����^����L��#�|`���[���7nb��uZ���/'��׻�ڬ����� ��^���9;��d\��aL$i>����IY6�W3#N�U ���
��� ���F&�ʀ�Wf$�i���u��@9�=P $s�W `��:��Rw?s��)�[O"ÜQyE�<׸�ʚӒ�Y��U� � ���#��|p��������F�6�D�1�i�c���C�VڽJS�\�\��2YK�����Y�&�.+g�bvכ�~m5�Y������u�h�������?8uw�������#�U�np��q�l�������g(ҷǘm�R�~�D`��E}�6|�?�\*���\_,�P�u���0��~c]�8I�ɚ� ���=�J��N�
p�=��6�yP� �~�:R��U����� �G}g�ͱ��9y�����-|}��|x���ӑ�
��׉��T��%n����8��Q;^LI�`������&���N��k��n�&�>�X`�bC� .��qt��`�k���V���r�ކr̤�Ȝ�yp�4M��h��E���#ӛ�1������m�c���'�7ǀ���b�� �C�^��劣(~��X@�yI������0A֘�\_"vQ��ot��&���Z�4�a�L��5|�m���bu3�Q2!E��Q�E�/�I��"!��s������T��0�� �p�΅��ˤ��mqC��p4/���5\_�A�Y�T�����k�`��+�:�k����g��A����%��"��g�&a?i�l@<2�C��BK'�����%�#0��G��g�L�.���`fer��بCq�݌DG��T�#|���
����,;����m��6+L���|�L��n����x�T\�$�uc�f�f�EȴN�2w�LL�����������dD�C��4�5+��)z k>ga�,%���x��>Q}�rkNXΘ^R�a,��V92��X�)���
�7�C��g���;g���aa���:��X86v�q��=�G0��Ԕ�F͡�ڛ�>��)���RG�k��juC�����\*Cr%��!�.�>�T��C���j}�~���U1�h6�,Z
�<���)�}t�����H��>@|�G�.�N֡B�|�� p�����d~�b�n���(�&��vO�l�^�� �;h�u�G}��C�
�н���ru`^b����VaŃ����ȯ5mG����D�+j�N!�����B�"r�S�/#d��\*g�vNy2 <�ݮ(ΚrRX�z��>��=�,ς��y��zǓz���k��F�j�T��buA3�H�˞�҉U�.k��;N����[˓�oϤ�h�0
�����H��o�`�d��t⫎[��]`ԧM�R"�
 �0��gT!�I\_�؉^��\ψ\_��Io���L�P��I�\_ţ��"�:��"~a�%q�kc���\_4�Z;9%E5�-�@����2�`զ�����t`��X-(trJpU2N'�a��t[�z���T,��񔉌\*Ƶ���u�m��C=n��&Mҹ
U��T��-�{��~��P&lc��}?����ߜ@�:�Ѷ��yH�o��(��� $�b�.hh�h�r�dH�� ]�8F��7xw�(���\_�#4<��`���<��ќ\_�"��Ϭ<�I��ʙʘߒ-92�6���~����
K4j�d
��i��4(֛�(��+ء\_l�G@\L��
uc��!��l�<�A�g�֗��%�WѰ65��=���>��1莶$j����+�#�=�cZH`��3#]^������`���I\*�
!m$���(
��-�����3~U���G�w�rJ����F� t�7\\7&č$����6V`���kY�S��ɮ=��t��l�j��و�74u��,�c�B%��C1�pa���u7xz�H��q�w`H�P�}Ɇ)��a�5����+<����T ����D��L�|���PH�m��� ҏ�7��Pħ}3�R���`���#��3o�#mB���8���0c��E=#���)go�i)�Ë��u��::K�BqP�o�B�\_�R0��a���������g�vBeA��&���l�s1;�j23���1��B���]^�wrgK��Tu}\_\埱�\*<
�$�O}@��q�);��E���� ���P����o���>��:�i��q�R�����S\_H���S� �ᷖ��LV���Oj/���dZ�:2Z����BLUޔ $o"{R�U��[�Z�ޢ�3�f�W�ۂ�톋����GD�/��:��'iP�i����|��@A���Wi�.c��"�/��R+$�T^�� �2׼�m=8���B��@��&�ƈ����=A�4���?dr+L�0����n�j�D�P�#@˺�P�0��em��%��ej؀!�O޻n�U��)~���� �~�z�.\����{I�t���{�0����zh��1O����@��T�gvN �����t�R>�~[[�w����$\_/�z\*�eJOrH ���'9��{�4�a�5
���� f��C/�Ky�6�v����L�e�'\_t\_�hTl��6w^��H�:�9f��lե�ygbx!b�1z��5���V �]�0$W��!��E�����z����(�.�ҿ��X~��R��g�c7�c}�����q.0��l������\:����Sw��k�P�%ㄹ��u$VE18w軲m$ѧ8&���y���� .b��sʽӋ(����NU�����l�r��\�Ґq�!'��ӻw(7܍
�
Ge$6��Q�f$����~�a��/)�k������Iw�f>Q���l���A��0l^1��l`I�%���=�SMiahJ�ƃ����/Ȋ�T�F�6��.D�J-0��T�8�\*�wz���)��Q��8"��u/GX9���q>4���-����0^
Z��g��c�pҎ��mf֬�N2���Ł-C��m�o�� �O ��f���\*Q����i8A��T�
�̱F�~��聱5����rߊ�@�����Bt5A�\8P�rv� S�.��~��2�(mۿ�rC��2Tֈ�\*�� ���ssԆEX��O�]ȋ򩟐b������Ƣ!=��{N�
w��M�T禷���[�~�R�� ��fOj�O��jE[�tn�
[��W�RS@�Y67�Snûo�@�D�ЃS��ϵlc�ft����s��4���z�JMyU�}O
�i,1%� �v�ĐB�2n���H�kva��&!�ps!�$Z��-��N�9q9M�塣pL
�~��b%�W��h� �WU���6�KU��s��`������aC��(\[n��P�B�d6O�Ӗ��t��l����
�Ϋ~��ߑ���9��#TGe��\*��H�m%����F���3�IzT�F;ak�����;C�aK�:C�NU R\2�|�ۃg��Y�S�����H�6���Ϣ;劳�=��������S��u���������4rF��B��!�f���ۙrW$u���]�З��C��0���
3+ƕ�ʵ,�0.cZ�l�� ���BAw���y�o�w $�P��1Nls���3�Zu�g�0[c-m�B�U�QǠC�F���Z^Ng\�����R�ޢ��K��C'ǜ��ۧ���7��aBm��.u1?Zߋ�.��Z��u���0��8x~}Q��}R�5����2�ٖ���@sK��j~;��O���bu&��a�~���XN�
3c#���%��wന�;0ݍ]����q[Ǔ��5^v�#��u���|l˚�ەq]���:1��^��L�G��+����v2P����k�`�P׫I9����+vv�y>ط=s8&��z���?6x�/r�(Ĥ���5Y�P��%B����]��o�Sa�#c���j�[ˀ{l��T3o���6dz�����
}�Ӏ �!D�G��P��EOf�ۑ�����7^<��QO��X�ir{�K���R�E�T��A��qݠ1�!bܭI�T�-!��k>e�S�7Q#�ٵ% �i��[���`Ơ\_^�{��;S��K�|�#"?���o�\*�k���N tM\*s��e-��S8�����;���~���iy�֡w��ٵ����p�4��r���x��9�O�f�P6�c� ���-�v#��X��R�S�հ�#CI5��~��r�N�-!-�KD[Q&`N��+��Z��e�W�Np��}(�F�c�W��Oo��]���[���m�m?r�S��.R�{� "�Qh���-T����j:g�r�d�w5ױ����
{�<;��Ц��j����a�f
>NL
���맒I�Q+ﰁ�ѕ�t��6��2a?�`$F<�Ёm��uS��������Y�B �"0� ������Kl/F(��k����$}���2%��Ȭ'����
�1F���5ߞ]����%U!ߵ�s�,�t������,�
�Zn
{hi�j���\_����g�~���P&
����������@<�Z6�'y=ql�+$�����\_����'�ŽԢS�U��l�@�QlU� �OOP�, t0�7?�K<�cAMr��dm
<4h�?D�ϡ��0U�͕R�|���R���b
[�i v�Kz4�M ;����RJ��Y�shQ#>�{[
�E]��v�U¿0�i�?��8���j�?V����?3j�jH<�1��e���q�"o\_�<##�ԫ�`j���e�$�� �͌x
L����Df?��FȐ&�-
��"Cso�P�P�^N��%.<���v]&oٚ ��aI�L>jt|r�3P#w��iU�ɴ��3�Y0"K��1��bt\_)���c80��z���"� �F \J2W;�d��pˉ���]���x��Q�F�C(��p� }���E�B\_s�Pw�����xI\ʔb�rs���r�Ȅ|zK���5�6��k�j����1m��hCm��W!�"�s
m�G�S�ࢣn2�Zrk;��C�`��X0�p�\��A�ۺ�I�o\������N�MH��xa��}�^3�L�����F��ߙ��`�Ru|�p�����<�Jk��
E���ܪ�l��o8K�vR�����H��~������-N�[�.H�\K%G�ߓ���B:�M��;ގ�v=B2��z������ ��̇-l��qC/�102��4���^���fz!n��p/�,��:��53�(~u�
 K\_�qA6 8���@~���<�u�1R)�~��H�y6sk�׺�b%䴪b��^r}}�+)7�����=!�UQ������{K:�Q��k�Ue�Hn������v�T�q���K� �S��U�Y\*����B�4QL���������Q����K�K�J9�{��B�<�/�j�cᅭwEg�o�
�/���[������k�z:
�����M3)��?��;G8=~7X���x�?@��+Aͺ�a���B8kH T� ��ko�z�6��c ���D\*L��t��3��|�c��p�I[vs��5�mX�5��\*�z�nM�SE��ߘs�!;��R��J$y�,�,�l2��ϩ�M ��I��؝g�� W�E��v>T����@`'�}�[�X~��N��0���j���ԣ�Nq𳮲^��eҢ���=�#`p�j
3����W�1MK�D�A �z� Pi�m=����H�l�"�Ts�8|m�`aX����t39ϑ��K�y\_;߇�Q�Cƀ�+X���mI��uͶ󠣣c`�&�[rύ�-É\M[�H�� ��tJ�&�y�B����~�����.!9zm�����&F� >$E�nw��W�Gj%1�Y�!�������^?�7u�R��i��ӽ��`�U��g�:4z�5�v�C#/b�6�:�U@�ݩ=I��x/G�YHm݁�J$z�ϐA��{�y���'�1�G6i��=ګLt�]�/U�ژoNf�7}c5eo���<?�-�~�a�o��������]ZJ�&ONy��쾸�dO�ԝ��B���T]�Z�{��%Iy���I7���F\*S�{�Gh1��}��s�.�ÈKR�"�B��Y5�bA��z(:3��?a��B6�A�������4���َ�¥��u(�6>��I��P�NIt,���r��r��#����a+؊��9G��h.�X��]�n��|Q�Os��!�SV��ҔMht�#��l��!�� Ǝ!��3R�'�7��9[��������\��в{̀�@��u۳�<\*�I��U��U�s�껢/&� <)�Lό��\�8�z����<��!'qq���[G��S0��'�׳�rY~�#Z��)W#�녯�g�L~\*����P0NR-9
c��;�};���x���O�no,��m��������j�����.���qtn�p�6ݓ���l�u\*L=Xd��=����7�p�xjAt�֤����T5�4��it1�7���C���D $kD9P\*~��;��� C��A�}o��0i��W۸��5�����A�7� ��)?���'���b?�ah�e2�K|�c�w���y�`FW~��OQb������!\
�+
�o���I(���\*�!&�� 7w�J\*�����c>���K|�0G���3�
hNO�r�a���jr�Ł[,�%�+�qL�.���o��k-B��j-��6�MU��g�������&�I)S�~[C��I�{g�E-�l�p���B��:U��ש�\$�vP���Gn8�5"�τ��j�$ܳic[�a���b�Q�8/A�eӕE�碢��m��1��z����,ǚψ!�B�5��f�T��\_��Xi����7�[�H�7�f(8.����CmR`X���u��{\*p� �oûA���՞��P5�yφ���X0o����6"�5\_�Q;�-)L��.E��^l�}"�-��{�;{BZa�B���3K<���h.��(��YR��Uʱ9�8Z�c(��LR���ۨ�A"t�;4��c�j�x ].�@Tk���I"fL�đ���'��s�A+���ji�� %��!aq��9=P7�rE���������pm�nJ�Ҍ9rr��?c������]����P� �X`�w<E
{}�� V#�ܸ[{���b�B��A��3iL+񖄝^�a-t���y-EBnG�����t�o6v$A��HX|
��1�mǹ2��\_��G�n#�⡵���ښ��J�mC[\_��s%ː�d�4!λ���y���u��˂ۋ�`�u�Ϻ)�F���pxvo�tt%Z�з�8�'#���S���^�E�=V���,\*�Tp^�� G�F�"��
.��i]L��! �La�g�wzg��`��u�d��d؈0'cg[1
����;ڇ�M�                

=== Content from blog.sonarsource.com_b31dfa0b_20250114_204401.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Grav CMS 1.7.10 - Code Execution Vulnerabilities

![](data:image/svg+xml;charset=utf-8...)![Thomas Chauchefoin photo]()![Thomas Chauchefoin photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/ddfcf9fd-16c2-4f57-8922-4198a01b5c2a/b0f43e1e-d67e-4bcf-a90c-0a1908c2b772_Thomas_Chauchefoin.jpg?w=800&h=800&auto=format&fit=crop)

Thomas Chauchefoin

Vulnerability Researcher

June 1, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We responsibly disclosed two code execution vulnerabilities in Grav CMS, one of the most popular flat-file PHP CMS in the market. Let’s see what we can learn from them and discuss their p...](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/97bcf5db-601e-43e7-bb8f-1e1bf76f44fe/cover-7010bb42-01bb-4965-8429-8679170943a1_Grav%2BCMS%2B1.7.10%2Bblogpost%25402x.png?w=2401&h=1201&auto=format&fit=crop)![We responsibly disclosed two code execution vulnerabilities in Grav CMS, one of the most popular flat-file PHP CMS in the market. Let’s see what we can learn from them and discuss their p...](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/97bcf5db-601e-43e7-bb8f-1e1bf76f44fe/cover-7010bb42-01bb-4965-8429-8679170943a1_Grav%2BCMS%2B1.7.10%2Bblogpost%25402x.png?w=2401&h=1201&auto=format&fit=crop)

In the lineage of most recent flat-file PHP CMS, Grav CMS is a modern web platform to build fast, safe and extensible websites. It uses a modern technology stack with Twig, Symfony and Doctrine, and offers an administration dashboard that allows managing the whole website (structure, pages, static resources, etc.).  It was voted as “Best Flat File CMS” in 2017 and 2019 and is rapidly gaining traction with over 12k GitHub stars.

As simplicity and security are often key arguments when choosing a flat-file CMS, we recently pursued some security research on Grav CMS 1.7.10. As a result, we discovered two interesting vulnerabilities in the core and the dashboard (respectively CVE-2021-29440 and CVE-2021-29439). These issues can be exploited by authenticated attackers with low privileges, and allow them to compromise the website and its server. In this blog post, we will look at the technical details of these code vulnerabilities and how to patch them.

## Impact

The vulnerabilities were confirmed on the last released version of Grav CMS (1.7.10) available at the time of our research and the associated *admin* module (1.10.10), a module often deployed with Grav and offered as part of a bundle on the official website. The two years old Grav 1.2.0 was also confirmed to be vulnerable.

Remote attackers can leverage the vulnerabilities in multiple attack scenarios:

* Credentials stuffing, granting access on the administration interface even with low privileges;
* Compromised or malicious content author;
* Presence of a Cross-Site Scripting vulnerability on the same perimeter.

The Server-Side Template Injection and Code Execution vulnerability presented in this article are respectivelyCVE-2021-29440 (affecting the Grav core) and CVE-2021-29439 (affecting the Grav Admin plugin). Both allow to execute arbitrary PHP code and system commands on the underlying server. After our report, the maintainers promptly fixed both issues and released Grav CMS 1.7.11.

Here is a short demonstration of our exploit for CVE-2021-29439:

Grav CMS 1.7.10 Remote Code Execution

## Technical details

### CVE-2021-29440: Unsafe Twig processing of static pages

The Grav administration dashboard allows super-users to create new user accounts, and to grant them privileges in a very granular fashion. Depending on the user’s permissions, additional security mechanisms can be applied. A Cross-Site Scripting filter prevents non-super-users from pushing pages containing `script` tags or `on*` attributes. With this in mind, we thought it would be interesting to find a way to gain code execution from this level of privilege.

As for most flat-file content management systems focusing on Markdown, a header (usually named *Front Matter*) can add contextual information regarding this specific page. It is often used to organize pages in categories, publishing content at a given route, etc.

After digging in Grav's code, we noticed that the front matter block supports a directive named `process.twig`, which will apply a Twig rendering pass on the content before serving the page. While this behavior is disabled by default, users with basic page creation privileges enable this feature in the front matter:

```
title: foo
process:
   twig: true
```

Recent Server-Side Template Injection research convinced us of one thing: code execution depends on the context but is never too far away!

Looking through the code surrounding Twig, we quickly noticed that the rendering step is not sandboxed: in the Twig ecosystem, it means that any tag, filter, method and properties can be invoked. As mentioned in James Kettle’s [*Server-Side Template Injection*](https://portswigger.net/research/server-side-template-injection "Server-Side Template Injection")  article, PHP functions however are not mapped into Twig templates and must be explicitly declared. Grav worked around this limitation by registering a callback triggered on each unknown function call:

**system/src/Grav/Common/Twig/Twig.php**

```
if ($config->get('system.twig.undefined_functions')) {
    $this->twig->registerUndefinedFunctionCallback(function ($name) {
        if (function_exists($name)) {
            return new TwigFunction($name, $name);
        }
        return new TwigFunction($name, static function () {
        });
    });
}
```

From here, arbitrary code execution is basically obtained with the right *front matter*and a template like `{{ system("id") }}`:

![](data:image/svg+xml;charset=utf-8...)![Proof-of-Concept of CVE-2021-29440]()![Proof-of-Concept of CVE-2021-29440](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/0fab2d3f-fbfa-459b-a4ea-2556ee92185a/body-21867695-343d-45f5-a353-3677a21cef9c_gracms-ssti-exploit.png?w=988&h=364&auto=format&fit=crop)
### CVE-2021-29439: Arbitrary module installation

In the case of the admin plugin, most task handlers are implemented in `classes/plugin/AdminController.php`. To dispatch the incoming request to the right one, a new hook is associated with the event `onPagesInitialized` (in `admin/admin.php`), and will ultimately call `AdminBaseController::execute()`, which will perform an anti-CSRF check ([1]) and call the requested task ([2]):

**classes/plugin/AdminController.php**

```
public function execute()
{
    // [...]
    if (!$this->validateNonce()) {             // [1]
        return false;
    }
    $method = 'task' . ucfirst($this->task);
    if (method_exists($this, $method)) {
        try {
            $response = $this->{$method}();      // [2]
        } catch (RequestException $e) {
      // [...]
    return $response;
}
```

As we can see, no permission check is performed here, and it is not the role of the CSRF protection to do it.

Therefore, the usual implementation of a handler consists of a permission check with `AdminController::authorizeTask()` ([1]) and then of the actual action, i.e. as seen in `AdminController::taskGetUpdates()` ([2]):

**classes/plugin/AdminController.php**

```
protected function taskGetUpdates()
{
   // [1], permission check
   if (!$this->authorizeTask('dashboard', ['admin.login', 'admin.super'])) {
       return false;
   }
   // [...]
   // [2], implementation
   try {
       $gpm = new GravGPM($flush);
       $resources_updates = $gpm->getUpdatable();
```

We noticed that the permission check for `AdminController::taskInstallPackage()` is slightly different, in a way it intends to be generic by checking that the current user has either the permission `admin.plugin` or `admin.theme`. However, as `$data['type']` is fully controlled by the user, thus having any `admin.*` permission (`admin.posts`, `admin.login`, etc.) is enough to pass the check and install an arbitrary package:

**classes/plugin/AdminController.php**

```
protected function taskInstallPackage($reinstall = false)
{
   $data    = $this->post;
   $package = $data['package'] ?? '';
   $type    = $data['type'] ?? '';
   if (!$this->authorizeTask('install ' . $type, ['admin.' . $type, 'admin.super'])) {
       $this->admin->json_response = [
           'status'  => 'error',
           'message' => $this->admin::translate('PLUGIN_ADMIN.INSUFFICIENT_PERMISSIONS_FOR_TASK')
       ];
       return false;
   }

   try {
       $result = Gpm::install($package, ['theme' => $type === 'theme']);
```

This primitive only allows fetching [official plugins listed on the website](https://getgrav.org/downloads/plugins "official plugins listed on the website"). While we do not plan to release the plugin’s name and the associated exploitation code (exercise left to the reader!), we were able to find an official plugin that let us obtain arbitrary code execution without requiring more privileges (see the video in the introduction).

## Patches

### CVE-2021-29440

The Twig rendering vulnerability is not easy to address while maintaining full backward compatibility for existing websites. The maintainers decided to improve the undefined functions resolver to prevent “unsafe” ones to be called. The nature of PHP makes it very hard to establish such a list, so an additional filter had to be implemented to prevent the use of functions that could be used to obtain an `unserialize()` primitive with the `phar` scheme wrapper. While an allow list would have been ideal, the risk of breakage of existing instances was too important.

The maintainers are aware of the limitations of this solution and intend to fully address it in the next major release of Grav. You can find [the patch](https://github.com/getgrav/grav/commit/3d102825673ac58fbeb57bdf778e43b08fb7354c "the patch") and [the public advisory](https://github.com/getgrav/grav/security/advisories/GHSA-g8r4-p96j-xfxc "the public advisory") on GitHub. After the upgrade to 1.7.11, you should still take time to review the current accounts on your instance, remove the unused ones and assess the risk of credential stuffing.

### CVE-2021-29439

This vulnerability was addressed by hardening the authorization checks before the dispatch to task handlers:

**classes/plugin/AdminBaseController.php**

```
public function execute()
{
    // Ignore blacklisted views.
    if (in_array($this->view, $this->blacklist_views, true)) {
            return false;
    }
    // Make sure that user is logged into admin.
    if (!$this->admin->authorize()) {
            return false;
    }

```

Stricter checks were also added in the implementation of existing handlers:

**classes/plugin/AdminController.php**

```
protected function taskInstallDependenciesOfPackages()
{
    $type = $this->view;
    if ($type !== 'plugins' && $type !== 'themes') {
            return false;
    }

    if (!$this->authorizeTask('install dependencies', ['admin.' . $type, 'admin.super'])) {
            $this->admin->json_response = [
                'status'  => 'error',
                'message' => [...]
        ];
            return false;
    }
```

You can find [the patch](https://github.com/getgrav/grav-plugin-admin/commit/a220359877fd1281f76ba732e5308e0e3002e4b1 "the patch") and [the public advisory](https://github.com/getgrav/grav-plugin-admin/security/advisories/GHSA-wg37-cf5x-55hq "the public advisory") on GitHub. Meanwhile, if you can’t upgrade to the version that includes the aforementioned patches, you can still temporarily disable the plugin and perform manual edits of the content.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-04-09 | We report all issues to the official email address |
| 2021-04-09 | The maintainers discuss and acknowledge our findings |
| 2021-04-14 | Grav 1.7.11 is released, fixing CVE-2021-29440 |
| 2021-04-14 | Grav Admin 1.10.11 is released, fixing CVE-2021-29439 |

## Summary

We were able to demonstrate the exploitation of two very distinct issues on the administration panel of Grav CMS 1.7.10, with only a reduced set of permissions. Both security issues can enable an attacker to execute arbitrary code on the targeted host server. Further, we analyzed how these severe vulnerabilities were patched.

We’ll be happy to discuss these bugs [in our community forum thread.](https://community.sonarsource.com/t/new-security-research-code-execution-vulnerabilities-in-grav-cms-nosql-injections-in-rocket-chat/44117 "in our community forum thread.")

It is also interesting to note that another very cool unauthenticated code execution vulnerability [was discovered](https://pentest.blog/unexpected-journey-7-gravcms-unauthenticated-arbitrary-yaml-write-update-leads-to-code-execution/ "was discovered") by Mehmet Ince in the same code area just before we started our research.

Finally, we would like to thank the maintainers of Grav for acknowledging our advisory and fixing these vulnerabilities super fast in only 5 days.

#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from avatars.githubusercontent.com_a510c95e_20250115_183112.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ����.�N�ii<5�>q 6O `CXe��O�zO��E���+�{˟,1�P1��~B�9��W�% ��[��ṏ?��R���3qk
��J���(��1���w7z���gO2�z�����\�&k�8�簺����9�U: ���������e S2��$j��͛�Vf ���G]���Ҽ�1<
д��f�c�i�j�b�� 7����@��Z��z}�� �����3Gwo��I�Xˬ{Y���?\���\_��-��� W��Fr���V��S�.<�,���rWw�3�ހ ��$�h�}��qI���\*�:�ݿ���~���@�j���ު�uq��wo���P�4�Q@��
