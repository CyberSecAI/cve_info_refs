=== Content from www.mozilla.org_6b3ff753_20250114_221453.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-36

## Security Vulnerabilities fixed in Thunderbird 91

Announced
August 11, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-29986: Race condition when resolving DNS names could have led to memory corruption](#CVE-2021-29986)

Reporter
pahhur
Impact
high
##### Description

A suspected race condition when calling `getaddrinfo` led to memory corruption and a potentially exploitable crash.
*Note: This issue only affected Linux operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1696138](https://bugzilla.mozilla.org/show_bug.cgi?id=1696138)

#### [#CVE-2021-29981: Live range splitting could have led to conflicting assignments in the JIT](#CVE-2021-29981)

Reporter
Gary Kwong
Impact
high
##### Description

An issue present in lowering/register allocation could have led to obscure but deterministic register confusion failures in JITted code that would lead to a potentially exploitable crash.

##### References

* [Bug 1707774](https://bugzilla.mozilla.org/show_bug.cgi?id=1707774)

#### [#CVE-2021-29988: Memory corruption as a result of incorrect style treatment](#CVE-2021-29988)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Thunderbird incorrectly treated an inline list-item element as a block element, resulting in an out of bounds read or memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1717922](https://bugzilla.mozilla.org/show_bug.cgi?id=1717922)

#### [#CVE-2021-29984: Incorrect instruction reordering during JIT optimization](#CVE-2021-29984)

Reporter
Lukas Bernhard
Impact
high
##### Description

Instruction reordering resulted in a sequence of instructions that would cause an object to be incorrectly considered during garbage collection. This led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1720031](https://bugzilla.mozilla.org/show_bug.cgi?id=1720031)

#### [#CVE-2021-29980: Uninitialized memory in a canvas object could have led to memory corruption](#CVE-2021-29980)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Uninitialized memory in a canvas object could have caused an incorrect free() leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722204](https://bugzilla.mozilla.org/show_bug.cgi?id=1722204)

#### [#CVE-2021-29987: Users could have been tricked into accepting unwanted permissions on Linux](#CVE-2021-29987)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

After requesting multiple permissions, and closing the first permission panel, subsequent permission panels will be displayed in a different position but still record a click in the default location, making it possible to trick a user into accepting a permission they did not want to.
*This bug only affects Thunderbird on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1716129](https://bugzilla.mozilla.org/show_bug.cgi?id=1716129)

#### [#CVE-2021-29985: Use-after-free media channels](#CVE-2021-29985)

Reporter
Marcin 'Icewall' Noga of Cisco Talos
Impact
moderate
##### Description

A use-after-free vulnerability in media channels could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722083](https://bugzilla.mozilla.org/show_bug.cgi?id=1722083)

#### [#CVE-2021-29982: Single bit data leak due to incorrect JIT optimization and type confusion](#CVE-2021-29982)

Reporter
Lukas Bernhard
Impact
low
##### Description

Due to incorrect JIT optimization, we incorrectly interpreted data from the wrong type of object, resulting in the potential leak of a single bit of memory.

##### References

* [Bug 1715318](https://bugzilla.mozilla.org/show_bug.cgi?id=1715318)

#### [#CVE-2021-29989: Memory safety bugs fixed in Thunderbird 91](#CVE-2021-29989)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Kershaw Chang, Philipp, Chris Peterson, Sebastian Hengst, Christoph Kerschbaumer, Olli Pettay, Sandor Molnar, and Simon Giesecke reported memory safety bugs present in versions of Thunderbird prior to 91. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662676%2C1666184%2C1719178%2C1719998%2C1720568%2C1544190%2C1716481%2C1717778%2C1719319%2C1722073)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_c3cab586_20250114_221451.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-33

## Security Vulnerabilities fixed in Firefox 91

Announced
August 10, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 91

#### [#CVE-2021-29986: Race condition when resolving DNS names could have led to memory corruption](#CVE-2021-29986)

Reporter
pahhur
Impact
high
##### Description

A suspected race condition when calling `getaddrinfo` led to memory corruption and a potentially exploitable crash.
*Note: This issue only affected Linux operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1696138](https://bugzilla.mozilla.org/show_bug.cgi?id=1696138)

#### [#CVE-2021-29981: Live range splitting could have led to conflicting assignments in the JIT](#CVE-2021-29981)

Reporter
Gary Kwong
Impact
high
##### Description

An issue present in lowering/register allocation could have led to obscure but deterministic register confusion failures in JITted code that would lead to a potentially exploitable crash.

##### References

* [Bug 1707774](https://bugzilla.mozilla.org/show_bug.cgi?id=1707774)

#### [#CVE-2021-29988: Memory corruption as a result of incorrect style treatment](#CVE-2021-29988)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Firefox incorrectly treated an inline list-item element as a block element, resulting in an out of bounds read or memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1717922](https://bugzilla.mozilla.org/show_bug.cgi?id=1717922)

#### [#CVE-2021-29983: Firefox for Android could get stuck in fullscreen mode](#CVE-2021-29983)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Firefox for Android could get stuck in fullscreen mode and not exit it even after normal interactions that should cause it to exit.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1719088](https://bugzilla.mozilla.org/show_bug.cgi?id=1719088)

#### [#CVE-2021-29984: Incorrect instruction reordering during JIT optimization](#CVE-2021-29984)

Reporter
Lukas Bernhard
Impact
high
##### Description

Instruction reordering resulted in a sequence of instructions that would cause an object to be incorrectly considered during garbage collection. This led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1720031](https://bugzilla.mozilla.org/show_bug.cgi?id=1720031)

#### [#CVE-2021-29980: Uninitialized memory in a canvas object could have led to memory corruption](#CVE-2021-29980)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Uninitialized memory in a canvas object could have caused an incorrect free() leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722204](https://bugzilla.mozilla.org/show_bug.cgi?id=1722204)

#### [#CVE-2021-29987: Users could have been tricked into accepting unwanted permissions on Linux](#CVE-2021-29987)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

After requesting multiple permissions, and closing the first permission panel, subsequent permission panels will be displayed in a different position but still record a click in the default location, making it possible to trick a user into accepting a permission they did not want to.
*This bug only affects Firefox on Linux. Other operating systems are unaffected.*

##### References

* [Bug 1716129](https://bugzilla.mozilla.org/show_bug.cgi?id=1716129)

#### [#CVE-2021-29985: Use-after-free media channels](#CVE-2021-29985)

Reporter
Marcin 'Icewall' Noga of Cisco Talos
Impact
moderate
##### Description

A use-after-free vulnerability in media channels could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722083](https://bugzilla.mozilla.org/show_bug.cgi?id=1722083)

#### [#CVE-2021-29982: Single bit data leak due to incorrect JIT optimization and type confusion](#CVE-2021-29982)

Reporter
Lukas Bernhard
Impact
low
##### Description

Due to incorrect JIT optimization, we incorrectly interpreted data from the wrong type of object, resulting in the potential leak of a single bit of memory.

##### References

* [Bug 1715318](https://bugzilla.mozilla.org/show_bug.cgi?id=1715318)

#### [#CVE-2021-29989: Memory safety bugs fixed in Firefox 91 and Firefox ESR 78.13](#CVE-2021-29989)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christoph Kerschbaumer, Olli Pettay, Sandor Molnar, and Simon Giesecke reported memory safety bugs present in Firefox 90 and Firefox ESR 78.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 91 and Firefox ESR 78.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662676%2C1666184%2C1719178%2C1719998%2C1720568)

#### [#CVE-2021-29990: Memory safety bugs fixed in Firefox 91](#CVE-2021-29990)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Kershaw Chang, Philipp, Chris Peterson, and Sebastian Hengst reported memory safety bugs present in Firefox 90. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 91](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544190%2C1716481%2C1717778%2C1719319%2C1722073)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_067c0658_20250114_221446.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202208-14**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-91.12.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-91.12.0"

```
### References

* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-29967](https://nvd.nist.gov/vuln/detail/CVE-2021-29967)
* [CVE-2021-29969](https://nvd.nist.gov/vuln/detail/CVE-2021-29969)
* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38492](https://nvd.nist.gov/vuln/detail/CVE-2021-38492)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-40529](https://nvd.nist.gov/vuln/detail/CVE-2021-40529)
* [CVE-2021-43528](https://nvd.nist.gov/vuln/detail/CVE-2021-43528)
* [CVE-2021-43529](https://nvd.nist.gov/vuln/detail/CVE-2021-43529)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0566](https://nvd.nist.gov/vuln/detail/CVE-2022-0566)
* [CVE-2022-1196](https://nvd.nist.gov/vuln/detail/CVE-2022-1196)
* [CVE-2022-1197](https://nvd.nist.gov/vuln/detail/CVE-2022-1197)
* [CVE-2022-1520](https://nvd.nist.gov/vuln/detail/CVE-2022-1520)
* [CVE-2022-1529](https://nvd.nist.gov/vuln/detail/CVE-2022-1529)
* [CVE-2022-1802](https://nvd.nist.gov/vuln/detail/CVE-2022-1802)
* [CVE-2022-1834](https://nvd.nist.gov/vuln/detail/CVE-2022-1834)
* [CVE-2022-2200](https://nvd.nist.gov/vuln/detail/CVE-2022-2200)
* [CVE-2022-2226](https://nvd.nist.gov/vuln/detail/CVE-2022-2226)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* [CVE-2022-24713](https://nvd.nist.gov/vuln/detail/CVE-2022-24713)
* [CVE-2022-26381](https://nvd.nist.gov/vuln/detail/CVE-2022-26381)
* [CVE-2022-26383](https://nvd.nist.gov/vuln/detail/CVE-2022-26383)
* [CVE-2022-26384](https://nvd.nist.gov/vuln/detail/CVE-2022-26384)
* [CVE-2022-26386](https://nvd.nist.gov/vuln/detail/CVE-2022-26386)
* [CVE-2022-26387](https://nvd.nist.gov/vuln/detail/CVE-2022-26387)
* [CVE-2022-26485](https://nvd.nist.gov/vuln/detail/CVE-2022-26485)
* [CVE-2022-26486](https://nvd.nist.gov/vuln/detail/CVE-2022-26486)
* [CVE-2022-28281](https://nvd.nist.gov/vuln/detail/CVE-2022-28281)
* [CVE-2022-28282](https://nvd.nist.gov/vuln/detail/CVE-2022-28282)
* [CVE-2022-28285](https://nvd.nist.gov/vuln/detail/CVE-2022-28285)
* [CVE-2022-28286](https://nvd.nist.gov/vuln/detail/CVE-2022-28286)
* [CVE-2022-28289](https://nvd.nist.gov/vuln/detail/CVE-2022-28289)
* [CVE-2022-29909](https://nvd.nist.gov/vuln/detail/CVE-2022-29909)
* [CVE-2022-29911](https://nvd.nist.gov/vuln/detail/CVE-2022-29911)
* [CVE-2022-29912](https://nvd.nist.gov/vuln/detail/CVE-2022-29912)
* [CVE-2022-29913](https://nvd.nist.gov/vuln/detail/CVE-2022-29913)
* [CVE-2022-29914](https://nvd.nist.gov/vuln/detail/CVE-2022-29914)
* [CVE-2022-29916](https://nvd.nist.gov/vuln/detail/CVE-2022-29916)
* [CVE-2022-29917](https://nvd.nist.gov/vuln/detail/CVE-2022-29917)
* [CVE-2022-31736](https://nvd.nist.gov/vuln/detail/CVE-2022-31736)
* [CVE-2022-31737](https://nvd.nist.gov/vuln/detail/CVE-2022-31737)
* [CVE-2022-31738](https://nvd.nist.gov/vuln/detail/CVE-2022-31738)
* [CVE-2022-31740](https://nvd.nist.gov/vuln/detail/CVE-2022-31740)
* [CVE-2022-31741](https://nvd.nist.gov/vuln/detail/CVE-2022-31741)
* [CVE-2022-31742](https://nvd.nist.gov/vuln/detail/CVE-2022-31742)
* [CVE-2022-31747](https://nvd.nist.gov/vuln/detail/CVE-2022-31747)
* [CVE-2022-34468](https://nvd.nist.gov/vuln/detail/CVE-2022-34468)
* [CVE-2022-34470](https://nvd.nist.gov/vuln/detail/CVE-2022-34470)
* [CVE-2022-34472](https://nvd.nist.gov/vuln/detail/CVE-2022-34472)
* [CVE-2022-34478](https://nvd.nist.gov/vuln/detail/CVE-2022-34478)
* [CVE-2022-34479](https://nvd.nist.gov/vuln/detail/CVE-2022-34479)
* [CVE-2022-34481](https://nvd.nist.gov/vuln/detail/CVE-2022-34481)
* [CVE-2022-34484](https://nvd.nist.gov/vuln/detail/CVE-2022-34484)
* [CVE-2022-36318](https://nvd.nist.gov/vuln/detail/CVE-2022-36318)
* [CVE-2022-36319](https://nvd.nist.gov/vuln/detail/CVE-2022-36319)
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

August 10, 2022

**Latest revision**

August 10, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [794085](https://bugs.gentoo.org/show_bug.cgi?id=794085)
* [802759](https://bugs.gentoo.org/show_bug.cgi?id=802759)
* [807943](https://bugs.gentoo.org/show_bug.cgi?id=807943)
* [811912](https://bugs.gentoo.org/show_bug.cgi?id=811912)
* [813501](https://bugs.gentoo.org/show_bug.cgi?id=813501)
* [822294](https://bugs.gentoo.org/show_bug.cgi?id=822294)
* [828539](https://bugs.gentoo.org/show_bug.cgi?id=828539)
* [831040](https://bugs.gentoo.org/show_bug.cgi?id=831040)
* [833520](https://bugs.gentoo.org/show_bug.cgi?id=833520)
* [834805](https://bugs.gentoo.org/show_bug.cgi?id=834805)
* [845057](https://bugs.gentoo.org/show_bug.cgi?id=845057)
* [846596](https://bugs.gentoo.org/show_bug.cgi?id=846596)
* [849047](https://bugs.gentoo.org/show_bug.cgi?id=849047)
* [857048](https://bugs.gentoo.org/show_bug.cgi?id=857048)
* [864577](https://bugs.gentoo.org/show_bug.cgi?id=864577)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_de60c0b3_20250114_221443.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1720031)
* [XML](/show_bug.cgi?ctype=xml&id=1720031)

Closed
[Bug 1720031](/show_bug.cgi?id=1720031)
(CVE-2021-29984)

Opened 4 years ago
Closed 3 years ago

# Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206

## Categories

### (Core :: JavaScript Engine: JIT, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

92 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [91+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=91%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox90 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=wontfix) |
| firefox91 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed) |
| firefox92 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 91+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox90 |  | wontfix |
| firefox91 |  | fixed |
| firefox92 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: lukas.bernhard, Assigned: jandem)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/709c5feed942bf99f098bb24aa1cc86f?d=mm&size=40)  [jandem](/user_profile?user_id=375297)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/59307c6d3ba87d521f5443530ecf72a9?d=mm&size=40)  [lukas.bernhard](/user_profile?user_id=656084)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1720031&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1720031)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [sec-survey][adv-main91+][adv-esr78.13+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29984

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][adv-main91+][adv-esr78.13+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1395939_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a1620493_551058 "3 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!](/attachment.cgi?id=9232633)  [3 years ago](#c10)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c18 "3 years ago")  pascalc : [approval-mozilla-esr78+](#c18 "3 years ago")  tjr : [sec-approval+](#c13 "3 years ago") | [Details](/attachment.cgi?id=9232633&action=edit) | [Review](/attachment.cgi?id=9232633) |
| --- | --- | --- |
| [Bug 1720031 - Add comment, tests, and a new JitOption. r?iain!](/attachment.cgi?id=9232634)  [3 years ago](#c11)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9232634&action=edit) | [Review](/attachment.cgi?id=9232634) |
| [advisory.txt](/attachment.cgi?id=9235123)  [3 years ago](#c22)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   287 bytes, text/plain |  | [Details](/attachment.cgi?id=9235123&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1720031#c0)• 4 years ago |
|  | |

User Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:91.0) Gecko/20100101 Firefox/91.0

Steps to reproduce:

The following sample triggers `MOZ_ASSERT(!IsInsideNursery(thing));` at this location (in debug builds):

<https://searchfox.org/mozilla-central/rev/6550c23862b4ed287843057fd30dbae789bd9b0b/js/src/gc/AtomMarking.cpp#206>

Release builds crash with a NULL-deref here:

<https://searchfox.org/mozilla-central/rev/6550c23862b4ed287843057fd30dbae789bd9b0b/js/src/util/Text.h#99>

Older versions (e.g. git c4573875e2765595093d23b2e73cfa3a976a4ed0 from Mar 2019) crash with:

Hit MOZ\_CRASH(\*\*\* Zone mismatch 0x7f7c049f4000 vs. 0xfffe2f2f2f2f2f2f at argument 0) at js/src/vm/JSContext-inl.h:48

shell arguments:

```
obj-x86_64-pc-linux-gnu/dist/bin/js --no-threads --cpu-count=1 --ion-offthread-compile=off --baseline-warmup-threshold=10 --ion-warmup-threshold=100 crash.js

```
```
function main() {
    const v13 = [];
    let v15 = "1";
    for (let v16 = "0"; v16 !== 65535; v16 = v16 + v15) {
        if (v16) {
            v15 = "0";
        }
        const v21 = ["9",v16];
        Reflect.apply(String.fromCharCode,String,v21);
    }
}
main();

```

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1720031#c1)• 4 years ago |
|  | |

This reproduces just with `--no-threads --fuzzing-safe`.

Group: firefox-core-security → javascript-core-securityStatus: UNCONFIRMED → NEW
[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected)Component: Untriaged → JavaScript: GCEver confirmed: trueFlags: sec-bounty?Product: Firefox → CoreHardware: Unspecified → x86\_64

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1720031#c2)• 4 years ago |
|  | |

Jonco: would you be the right person to look at this?

Flags: needinfo?(jcoppeard)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1720031#c3)• 4 years ago |
|  | |

Based on the poison value in the assertion, I assume it is some kind of UAF: "Zone mismatch 0x7f7c049f4000 vs. 0xfffe2f2f2f2f2f2f at argument 0"

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1720031#c4)• 4 years ago |
|  | |

Ah, right, that's from older versions. I guess it could still be in newer versions, but we assert in a different way.

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1720031#c5)• 4 years ago |
|  | |

It's an assertion failure checking a string that was allocated in the nursery by JIT code and then moved by nursery collection. It could be a missing barrier in JIT code somewhere.

Bisection blames [bug 1689413](/show_bug.cgi?id=1689413 "RESOLVED FIXED - Remove ObjectGroup") which is not terribly helpful.

Crash backtrace:

```
#0  0x00005587ff8cf4f6 in js::gc::AtomMarkingRuntime::atomIsMarked<JSAtom> (this=0x7fe5da23c808, zone=0x7fe5d9fea000,
    thing=0x76afbe3ff88) at /home/jon/clone/dev/js/src/gc/AtomMarking.cpp:206
#1  0x00005587fecf3b1f in js::ContextChecks::checkAtom<JSAtom> (this=0x7ffd7c7e43d0, thing=0x76afbe3ff88, argIndex=0)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:108
#2  0x00005587fecf38a2 in js::ContextChecks::check (this=0x7ffd7c7e43d0, str=0x76afbe3ff88, argIndex=0)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:119
#3  0x00005587fecf376c in js::ContextChecks::check (this=0x7ffd7c7e43d0, v=..., argIndex=0)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:133
#4  0x00005587fecf35b7 in js::ContextChecks::check (this=0x7ffd7c7e43d0, args=..., argIndex=0)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:160
#5  0x00005587fecf3474 in JSContext::checkImpl<JS::CallArgs> (this=0x7fe5da219000, args=...)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:213
#6  0x00005587fecf3317 in JSContext::check<JS::CallArgs> (this=0x7fe5da219000, args=...)
    at /home/jon/clone/dev/js/src/vm/JSContext-inl.h:220
#7  0x00005587fecedd2e in CallJSNative (cx=0x7fe5da219000,
    native=0x5587fefec3a0 <js::str_fromCharCode(JSContext*, unsigned int, JS::Value*)>, reason=js::CallReason::Call,
    args=...) at /home/jon/clone/dev/js/src/vm/Interpreter.cpp:422
#8  0x00005587fecdbf06 in js::InternalCallOrConstruct (cx=0x7fe5da219000, args=..., construct=js::NO_CONSTRUCT,
    reason=js::CallReason::Call) at /home/jon/clone/dev/js/src/vm/Interpreter.cpp:511
#9  0x00005587fecdc6b6 in InternalCall (cx=0x7fe5da219000, args=..., reason=js::CallReason::Call)
    at /home/jon/clone/dev/js/src/vm/Interpreter.cpp:571
#10 0x00005587fecdc767 in js::Call (cx=0x7fe5da219000, fval=..., thisv=..., args=..., rval=...,
    reason=js::CallReason::Call) at /home/jon/clone/dev/js/src/vm/Interpreter.cpp:588
#11 0x00005587ffba8ab9 in js::jit::InvokeFunction (cx=0x7fe5da219000, obj=..., constructing=false,
    ignoresReturnValue=false, argc=2, argv=0x7ffd7c7e4a60, rval=...)
    at /home/jon/clone/dev/js/src/jit/VMFunctions.cpp

```

|  | [Jon Coppeard (:jonco)](/user_profile?user_id=443194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1720031#c6)• 4 years ago |
|  | |

(In reply to Jon Coppeard (:jonco) from [comment #5](/show_bug.cgi?id=1720031#c5 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206"))

Bisection blames this changeset, but it turns out this is due to the change in object size affecting when we trigger a nursery collection:

```
changeset:   569882:a11a96dce11b
user:        Jan de Mooij <jdemooij@mozilla.com>
date:        Fri Mar 05 19:10:12 2021 +0000
summary:     Bug 1689413 part 16 - Remove JSObject group field. r=tcampbell,jonco

```

Simplified testcase:

```
function main() {
  let a = "0";
  let b = "0";
  for (let i = 0; i < 10000; i++) {
    if (b) {
      a = "0";
    }
    Reflect.apply(String.fromCharCode, String, ["0", b]);
    b = b + a;
  }
}
main();

```

The testcase performs a single minor GC and crashes shortly afterwards. The collection happens in js::ConcatStrings and the engine crashes shortly afterwards:

```
#0  js::Nursery::collect (this=0x7f8b3ef411c8, kind=GC_NORMAL, reason=JS::GCReason::OUT_OF_NURSERY)
    at /home/jon/clone/dev/js/src/gc/Nursery.cpp:1015
#1  0x00005640de1682da in js::gc::GCRuntime::collectNursery (this=0x7f8b3ef3e788, kind=GC_NORMAL,
    reason=JS::GCReason::OUT_OF_NURSERY, phase=js::gcstats::PhaseKind::MINOR_GC)
    at /home/jon/clone/dev/js/src/gc/GC.cpp:7793
#2  0x00005640de16b5cf in js::gc::GCRuntime::minorGC (this=0x7f8b3ef3e788, reason=JS::GCReason::OUT_OF_NURSERY,
    phase=js::gcstats::PhaseKind::MINOR_GC) at /home/jon/clone/dev/js/src/gc/GC.cpp:7759
#3  0x00005640de17fc94 in js::gc::GCRuntime::tryNewNurseryString<(js::AllowGC)1> (this=0x7f8b3ef3e788,
    cx=0x7f8b3ef4c000, thingSize=24, kind=js::gc::AllocKind::STRING) at /home/jon/clone/dev/js/src/gc/Allocator.cpp:177
#4  0x00005640de1803f3 in js::AllocateStringImpl<JSString, (js::AllowGC)1> (cx=0x7f8b3ef4c000, heap=js::gc::DefaultHeap)
    at /home/jon/clone/dev/js/src/gc/Allocator.cpp:217
#5  0x00005640dd92fbaf in js::AllocateString<JSRope, (js::AllowGC)1> (cx=0x7f8b3ef4c000, heap=js::gc::DefaultHeap)
    at /home/jon/clone/dev/js/src/gc/Allocator.h:61
#6  0x00005640dd91f028 in JSRope::new_<(js::AllowGC)1> (cx=0x7f8b3ef4c000, left=..., right=..., length=2016,
    heap=js::gc::DefaultHeap) at /home/jon/clone/dev/js/src/vm/StringType-inl.h:171
#7  0x00005640ddbc0094 in js::ConcatStrings<(js::AllowGC)1> (cx=0x7f8b3ef4c000, left=..., right=...,
    heap=js::gc::DefaultHeap) at /home/jon/clone/dev/js/src/vm/StringType.cpp:948
#8  0x00001db928c53fdd in ?? ()

```

This doesn't reproduce with --no-ion (and does reproduce with --ion-eager). My guess is that we're not tracing something we should be in the JITs.

Jan does anything stand out to you?

Flags: needinfo?(jcoppeard) → needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1720031#c7)• 4 years ago |
|  | |

This is a really good find.

What happens is that for initializing the array literal we have `StoreElement` and `SetInitializedLength` instructions. The instruction reordering pass then moves the `Concat` *between* these two instructions. If the concatenation then triggers a GC we don't mark the element because we didn't bump the initialized length yet.

Not sure yet what's the best way to fix this. "Can GC" isn't known at the MIR level. The simplest fix is probably to teach `ReorderInstructions` to never move anything before a `SetInitializedLength` instruction.

Component: JavaScript: GC → JavaScript Engine: JITKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a435499_406194)• 3 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a690810_607698)• 3 years ago |

Severity: -- → S3Priority: -- → P1

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a695137_607698)• 3 years ago |

Assignee: nobody → jdemooij

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1720031#c8)• 3 years ago |
|  | |

The spot fix for this one is easy but I'm doing some perf measurements to see if we can disable instruction reordering for JS.

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1720031#c9)• 3 years ago |
|  | |

(In reply to Jan de Mooij [:jandem] from [comment #8](/show_bug.cgi?id=1720031#c8 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206"))

> The spot fix for this one is easy but I'm doing some perf measurements to see if we can disable instruction reordering for JS.

I looked into this and some Octane-subtests do seem a bit affected so I'll go with the simpler fix + a new JitOption to help the fuzzers.

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1720031#c10)• 3 years ago |
|  | |

Attached file
[Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!](attachment.cgi?id=9232633)
— [Details](attachment.cgi?id=9232633&action=edit)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1720031#c11)• 3 years ago |
|  | |

Attached file
[Bug 1720031 - Add comment, tests, and a new JitOption. r?iain!](attachment.cgi?id=9232634)
— [Details](attachment.cgi?id=9232634&action=edit)

Depends on D120626

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a948802_375297)• 3 years ago |

Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1720031#c12)• 3 years ago |
|  | |

Comment on [attachment 9232633](/attachment.cgi?id=9232633 "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") [[details]](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!")

[Bug 1720031](/show_bug.cgi?id=1720031 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206") - Check for SetInitializedLength when reordering. r?iain!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easy, but it's likely doable with some skill and effort.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: Trivial to backport.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions, it just disables an optimization in a particular case.
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1720031#c13)• 3 years ago |
|  | |

Comment on [attachment 9232633](/attachment.cgi?id=9232633 "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") [[details]](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!")

[Bug 1720031](/show_bug.cgi?id=1720031 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206") - Check for SetInitializedLength when reordering. r?iain!

Approved to land and uplift

[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: sec-approval? → sec-approval+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1720031#c14)• 3 years ago |
|  | |

Comment on [attachment 9232633](/attachment.cgi?id=9232633 "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") [[details]](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!")

[Bug 1720031](/show_bug.cgi?id=1720031 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206") - Check for SetInitializedLength when reordering. r?iain!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Security issues, crashes.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It just disables an optimization in a specific case.
* **String changes made/needed**: N/A
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-esr91?
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-beta?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1720031#c15)• 3 years ago |
|  | |

Check for SetInitializedLength when reordering. r=iain

<https://hg.mozilla.org/integration/autoland/rev/7528462f1eef91beaf5a97c78c44b3c35b7f5cd1>

<https://hg.mozilla.org/mozilla-central/rev/7528462f1eef>

Group: javascript-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 92 Branch

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1720031#c16)• 3 years ago |
|  | |

Jan, does it need to land on esr78? Thanks

Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1354531_375297)• 3 years ago |

Flags: needinfo?(jdemooij)
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-esr78?

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1720031#c17)• 3 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #16](/show_bug.cgi?id=1720031#c16 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206"))

> Jan, does it need to land on esr78? Thanks

Yes, thanks for noticing! I'm too used to a single supported ESR release...

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1720031#c18)• 3 years ago |
|  | |

Comment on [attachment 9232633](/attachment.cgi?id=9232633 "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") [[details]](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!")

[Bug 1720031](/show_bug.cgi?id=1720031 "RESOLVED FIXED - Assertion failure: !IsInsideNursery(thing) at AtomMarking.cpp:206") - Check for SetInitializedLength when reordering. r?iain!

Thanks, approved for beta and esr78. This will be inherited in esr91 with the 91 to esr91 merge.

[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-esr91?
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-esr78?
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-esr78+
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-beta?
[Attachment #9232633](/attachment.cgi?id=9232633&action=edit "Bug 1720031 - Check for SetInitializedLength when reordering. r?iain!") -
Flags: approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1355383_24572)• 3 years ago |

[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1720031#c19)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/f997de389884>

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1720031#c20)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/d05f240578e8>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [91+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=91%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1395939_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1720031#c21)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1720031) to reply.

Flags: needinfo?(jdemooij)Whiteboard: [sec-survey]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1482377_75935)• 3 years ago |

[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=wontfix)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1620493_551058)• 3 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a1965171_375297)• 3 years ago |

Flags: needinfo?(jdemooij)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a2246785_578488)• 3 years ago |

Whiteboard: [sec-survey] → [sec-survey][adv-main90+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a2246963_578488)• 3 years ago |

Whiteboard: [sec-survey][adv-main90+] → [sec-survey][adv-main91+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1720031#c22)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9235123)
— [Details](attachment.cgi?id=9235123&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a2257761_578488)• 3 years ago |

Alias: CVE-2021-29984

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a2258093_578488)• 3 years ago |

Whiteboard: [sec-survey][adv-main91+] → [sec-survey][adv-main91+][adv-esr78.13+]

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a20748014_422187)• 3 years ago |

Blocks: [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a35547842_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1720031#a91076767_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1720031&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_795b7589_20250114_221452.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-34

## Security Vulnerabilities fixed in Firefox ESR 78.13

Announced
August 10, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.13

#### [#CVE-2021-29986: Race condition when resolving DNS names could have led to memory corruption](#CVE-2021-29986)

Reporter
pahhur
Impact
high
##### Description

A suspected race condition when calling `getaddrinfo` led to memory corruption and a potentially exploitable crash.
*Note: This issue only affected Linux operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1696138](https://bugzilla.mozilla.org/show_bug.cgi?id=1696138)

#### [#CVE-2021-29988: Memory corruption as a result of incorrect style treatment](#CVE-2021-29988)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Firefox incorrectly treated an inline list-item element as a block element, resulting in an out of bounds read or memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1717922](https://bugzilla.mozilla.org/show_bug.cgi?id=1717922)

#### [#CVE-2021-29984: Incorrect instruction reordering during JIT optimization](#CVE-2021-29984)

Reporter
Lukas Bernhard
Impact
high
##### Description

Instruction reordering resulted in a sequence of instructions that would cause an object to be incorrectly considered during garbage collection. This led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1720031](https://bugzilla.mozilla.org/show_bug.cgi?id=1720031)

#### [#CVE-2021-29980: Uninitialized memory in a canvas object could have led to memory corruption](#CVE-2021-29980)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Uninitialized memory in a canvas object could have caused an incorrect free() leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722204](https://bugzilla.mozilla.org/show_bug.cgi?id=1722204)

#### [#CVE-2021-29985: Use-after-free media channels](#CVE-2021-29985)

Reporter
Marcin 'Icewall' Noga of Cisco Talos
Impact
moderate
##### Description

A use-after-free vulnerability in media channels could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722083](https://bugzilla.mozilla.org/show_bug.cgi?id=1722083)

#### [#CVE-2021-29989: Memory safety bugs fixed in Firefox 91 and Firefox ESR 78.13](#CVE-2021-29989)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christoph Kerschbaumer, Simon Giesecke, Sandor Molnar, and Olli Pettay reported memory safety bugs present in Firefox 90 and Firefox ESR 78.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 91 and Firefox ESR 78.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662676%2C1666184%2C1719178%2C1719998%2C1720568)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_8a98e4d8_20250114_221453.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-35

## Security Vulnerabilities fixed in Thunderbird 78.13

Announced
August 10, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.13

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-29986: Race condition when resolving DNS names could have led to memory corruption](#CVE-2021-29986)

Reporter
pahhur
Impact
high
##### Description

A suspected race condition when calling `getaddrinfo` led to memory corruption and a potentially exploitable crash.
*Note: This issue only affected Linux operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1696138](https://bugzilla.mozilla.org/show_bug.cgi?id=1696138)

#### [#CVE-2021-29988: Memory corruption as a result of incorrect style treatment](#CVE-2021-29988)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Thunderbird incorrectly treated an inline list-item element as a block element, resulting in an out of bounds read or memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1717922](https://bugzilla.mozilla.org/show_bug.cgi?id=1717922)

#### [#CVE-2021-29984: Incorrect instruction reordering during JIT optimization](#CVE-2021-29984)

Reporter
Lukas Bernhard
Impact
high
##### Description

Instruction reordering resulted in a sequence of instructions that would cause an object to be incorrectly considered during garbage collection. This led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1720031](https://bugzilla.mozilla.org/show_bug.cgi?id=1720031)

#### [#CVE-2021-29980: Uninitialized memory in a canvas object could have led to memory corruption](#CVE-2021-29980)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Uninitialized memory in a canvas object could have caused an incorrect free() leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722204](https://bugzilla.mozilla.org/show_bug.cgi?id=1722204)

#### [#CVE-2021-29985: Use-after-free media channels](#CVE-2021-29985)

Reporter
Marcin 'Icewall' Noga of Cisco Talos
Impact
moderate
##### Description

A use-after-free vulnerability in media channels could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1722083](https://bugzilla.mozilla.org/show_bug.cgi?id=1722083)

#### [#CVE-2021-29989: Memory safety bugs fixed in Thunderbird 78.13](#CVE-2021-29989)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Christoph Kerschbaumer, Simon Giesecke, Sandor Molnar, and Olli Pettay reported memory safety bugs present in Thunderbird 78.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1662676%2C1666184%2C1719178%2C1719998%2C1720568)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_ffa2d904_20250114_221446.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202202-03**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-91.6.0:esr"

```

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-91.6.0:esr"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-97.0:rapid"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-97.0:rapid"

```
### References

* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29972](https://nvd.nist.gov/vuln/detail/CVE-2021-29972)
* [CVE-2021-29974](https://nvd.nist.gov/vuln/detail/CVE-2021-29974)
* [CVE-2021-29975](https://nvd.nist.gov/vuln/detail/CVE-2021-29975)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29977](https://nvd.nist.gov/vuln/detail/CVE-2021-29977)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29981](https://nvd.nist.gov/vuln/detail/CVE-2021-29981)
* [CVE-2021-29982](https://nvd.nist.gov/vuln/detail/CVE-2021-29982)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29987](https://nvd.nist.gov/vuln/detail/CVE-2021-29987)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-29990](https://nvd.nist.gov/vuln/detail/CVE-2021-29990)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38491](https://nvd.nist.gov/vuln/detail/CVE-2021-38491)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43540](https://nvd.nist.gov/vuln/detail/CVE-2021-43540)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0511](https://nvd.nist.gov/vuln/detail/CVE-2022-0511)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22753](https://nvd.nist.gov/vuln/detail/CVE-2022-22753)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22755](https://nvd.nist.gov/vuln/detail/CVE-2022-22755)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22757](https://nvd.nist.gov/vuln/detail/CVE-2022-22757)
* [CVE-2022-22758](https://nvd.nist.gov/vuln/detail/CVE-2022-22758)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22762](https://nvd.nist.gov/vuln/detail/CVE-2022-22762)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* MOZ-2021-0004
* MOZ-2021-0005
* MOZ-2021-0006
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

February 21, 2022

**Latest revision**

February 21, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [802768](https://bugs.gentoo.org/show_bug.cgi?id=802768)
* [807947](https://bugs.gentoo.org/show_bug.cgi?id=807947)
* [813498](https://bugs.gentoo.org/show_bug.cgi?id=813498)
* [821385](https://bugs.gentoo.org/show_bug.cgi?id=821385)
* [828538](https://bugs.gentoo.org/show_bug.cgi?id=828538)
* [831039](https://bugs.gentoo.org/show_bug.cgi?id=831039)
* [832992](https://bugs.gentoo.org/show_bug.cgi?id=832992)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


