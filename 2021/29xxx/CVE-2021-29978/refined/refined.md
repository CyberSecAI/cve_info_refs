```
{
  "cveId": "CVE-2021-29978",
  "description": "Multiple low security issues were discovered and fixed in a security audit of Mozilla VPN 2.x branch as part of a 3rd party security audit.",
  "vulnerabilities": [
    {
      "rootCause": "Balrog does not verify the whole certificate chain on macOS.",
      "weaknesses": [
        "Incomplete certificate chain verification"
      ],
      "impact": "Attackers can supply a self-signed leaf certificate, bypassing Balrog's intended security. State-funded attackers controlling a trusted CA could perform a Man-in-the-Middle attack, replacing the legitimate binary code from Mozilla VPN updates with malicious software.",
      "attackVectors": [
        "Man-in-the-Middle (MitM) attack during software updates"
      ],
      "attackerCapabilities": [
        "Ability to perform MitM attacks",
        "Control of a trusted certificate authority (for more advanced attacks)"
      ]
    },
    {
      "rootCause": "Balrog does not properly verify the certificate chain, permitting rogue root certificates to pass.",
      "weaknesses": [
        "Improper certificate chain validation"
      ],
      "impact": "Attackers can use a rogue root certificate to sign a malicious leaf certificate. This allows for MitM attacks where attackers can replace legitimate binary code with malicious software during updates.",
      "attackVectors": [
        "Man-in-the-Middle (MitM) attacks"
      ],
       "attackerCapabilities": [
        "Ability to perform MitM attacks",
		"Control of a trusted certificate authority"
      ]
    },
	{
      "rootCause": "The iOS Mozilla VPN app has NSAllowsArbitraryLoads set, disabling default App Transport Security restrictions and allowing plain-text HTTP requests.",
       "weaknesses": [
        "Weak App Transport Security (ATS) policy",
		"Plain-text HTTP usage enabled"
      ],
      "impact": "The app is allowed to use plain-text HTTP requests which weakens security and exposes user data to potential eavesdropping.",
       "attackVectors": [
        "Man-in-the-Middle (MitM) attacks",
		"Network eavesdropping"
      ],
	   "attackerCapabilities": [
        "Ability to perform MitM attacks",
		"Network access to the user"
      ]
    },
	{
      "rootCause": "Mozilla VPN desktop app sets up an HTTP server for OAuth callback without proper protection, making it vulnerable to spam requests.",
       "weaknesses": [
        "Unprotected local HTTP server for OAuth callback",
		"Lack of proper authentication for local server requests"
      ],
      "impact": "Attackers can disturb the login process of the app by spamming requests to the local server, denying authentication.",
      "attackVectors": [
        "Local request spamming via JavaScript"
      ],
	    "attackerCapabilities": [
        "Ability to send requests to the local server via JavaScript"
      ]
    },
    {
      "rootCause": "Race condition in Ping Sender could expose gateway IP.",
        "weaknesses": [
        "Race condition in ping sender"
      ],
      "impact": "ICMP packets sent after turning off the VPN may reveal the internal IP address of the WireGuard gateway.",
      "attackVectors": [
        "Timing-based information leakage"
      ],
        "attackerCapabilities": [
        "Ability to observe network traffic"
      ]
    },
    {
      "rootCause": "Android app allows backups of application data.",
      "weaknesses": [
        "Backup feature enabled by default",
		"Android Manifest allowBackup flag not set to false"
      ],
      "impact": "Attackers with adb command access can extract all stored app data, including VPN configuration data.",
      "attackVectors": [
        "ADB command access"
      ],
        "attackerCapabilities": [
          "Ability to send adb commands to user phones"
        ]
    },
	{
      "rootCause": "Secure flag missing on views for Android app.",
        "weaknesses": [
         "Missing FLAG_SECURE security flag on views"
      ],
      "impact": "Sensitive data displayed on the screen can be captured through screenshots or screen recordings by malicious apps.",
       "attackVectors": [
        "Malicious applications exploiting missing FLAG_SECURE flag to take screenshots"
      ],
        "attackerCapabilities": [
        "Ability to install malicious apps on the device"
      ]
    },
 {
      "rootCause": "Android app supports insecure v1 signature.",
        "weaknesses": [
        "Use of insecure v1 APK signature"
      ],
      "impact": "The app is vulnerable to the Janus vulnerability on devices running Android < 7, allowing attackers to inject malicious code without breaking the signature and potentially taking over the existing application.",
       "attackVectors": [
        "Janus vulnerability exploitation on Android < 7 devices"
      ],
        "attackerCapabilities": [
          "Ability to craft and deploy malicious APK"
        ]
    },
	{
      "rootCause": "The API used by the Mozilla VPN applications includes sensitive information in error responses.",
        "weaknesses": [
        "Information disclosure through error messages"
      ],
      "impact": "Error messages expose sensitive data, such as Mullvad account IDs, which could be used for further attacks against connected APIs.",
        "attackVectors": [
        "API information disclosure"
      ],
        "attackerCapabilities": [
        "Ability to trigger errors through API requests"
      ]
    },
{
      "rootCause": "Android app does not consistently use encrypted shared preferences.",
        "weaknesses": [
        "Inconsistent use of encrypted shared preferences",
		"Plain-text storage of sensitive data in shared_prefs folder"
      ],
     "impact": "Sensitive information, like VPN IPs and private keys, is stored in plain-text in shared preferences, potentially exposed to local attackers or via backups.",
       "attackVectors": [
        "Local access to the device or data backups"
      ],
       "attackerCapabilities": [
          "Root access to the phone or access to backups"
        ]
    },
{
      "rootCause": "Android app exposes sensitive data to system logs.",
        "weaknesses": [
       "Excessive logging of sensitive information"
      ],
      "impact": "User tokens and codes can be accessed via system logs, potentially exposing user data to third parties.",
        "attackVectors": [
        "Access to system logs via adb logcat or direct access on rooted devices"
      ],
      "attackerCapabilities": [
        "Debugging access via USB with adb, or system privileges on rooted devices"
      ]
    },
    {
      "rootCause": "The Mozilla VPN WebSocket Controller exposes a WebSocket endpoint on localhost without authentication.",
      "weaknesses": [
        "Unauthenticated WebSocket endpoint on localhost"
      ],
      "impact": "Any website can connect and interact with the VPN client, potentially leading to information disclosure such as screenshots.",
      "attackVectors": [
        "Cross-site WebSocket hijacking"
      ],
        "attackerCapabilities": [
          "Ability to host an arbitrary website"
        ]
    },
	{
     "rootCause":"Auth code could be leaked by injecting port",
      "weaknesses": [
         "Port parameter injection in the auth URL"
      ],
      "impact": "An attacker can inject the @ sign into the port parameter to redirect the auth code to an arbitrary host.",
       "attackVectors": [
        "Man-in-the-Middle (MitM) attacks via crafted URLs"
      ],
        "attackerCapabilities": [
        "Ability to craft malicious URLs"
      ]
    }
  ]
}
```