=== Content from bugzilla.mozilla.org_b52fc916_20250114_192850.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1697604)
* [XML](/show_bug.cgi?ctype=xml&id=1697604)

Closed
[Bug 1697604](/show_bug.cgi?id=1697604)
(CVE-2021-29944)

Opened 4 years ago
Closed 4 years ago

# HTML injection vulnerability in Reader View

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

HTML injection vulnerability in Reader View

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox87 wontfix, firefox88 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox87 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix) |
| firefox88 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox87 |  | wontfix |
| firefox88 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jwkbugzilla, Assigned: csadilek)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/cacee3afc0d1d5e9fb61a861b0ed024b?d=mm&size=40)  [csadilek](/user_profile?user_id=590895)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/bd1b9ed4ddafb4e94ca9ec218f77fdb4?d=mm&size=40)  [jwkbugzilla](/user_profile?user_id=109976)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low, Whiteboard: [post-critsmash-triage][adv-main88+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-29944

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main88+]

Change Request:

---

Bug Flags:

|  | sec-bounty | ? |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Proof of concept (sending data)](/attachment.cgi?id=9208223)  [4 years ago](#c0)  [Wladimir Palant](/user_profile?user_id=109976)   2.59 KB, text/html |  | [Details](/attachment.cgi?id=9208223&action=edit) |
| --- | --- | --- |
| [Proof of concept (redirecting)](/attachment.cgi?id=9208226)  [4 years ago](#c1)  [Wladimir Palant](/user_profile?user_id=109976)   2.66 KB, text/html |  | [Details](/attachment.cgi?id=9208226&action=edit) |
| [advisory.txt](/attachment.cgi?id=9215548)  [4 years ago](#c12)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   392 bytes, text/plain |  | [Details](/attachment.cgi?id=9215548&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1697604#c0)• 4 years ago |
|  | |

Attached file
[Proof of concept (sending data)](attachment.cgi?id=9208223)
— [Details](attachment.cgi?id=9208223&action=edit)

A similar issue has been reported in [bug 1658175](/show_bug.cgi?id=1658175 "RESOLVED FIXED - HTML tag injection through ${article.title} in Fenix's Readerview") before. The fix is incomplete however. While `article.title` and `article.byLine` are being escaped, `article.dir` and other fields are not. In fact, some attributes aren’t even quoted. While CSP prevents direct code execution here, this could still be harmful.

I’ve attached two proof of concept pages, both with a malicious `dir` attribute on the `<html>` tag. The first one contains an `<img>` tag with an unclosed `src` attribute. The closing quote is located in the article “text” then. This makes sure that the entire HTML code before the closing quote is sent in a request to `http://localhost/` (some data here but nothing that should be unknown to the attacking website). You can try it out by navigating to <https://palant.info/temp/tP0wR6yK0uN5fN6s/reader_view.html> in Fenix and switching on Reader View.

The second proof of concept page injects a `<meta refresh>` tag, causing the page to navigate to Reader View of a data: URI. Normally, top-level navigation to data: URIs is prohibited. This approach allows navigation to other websites as well, the location bar keeps displaying the original website. You can try it out by navigating to <https://palant.info/temp/tP0wR6yK0uN5fN6s/reader_view2.html> in Fenix and switching on Reader View.

If you inspect the page source code for the second proof of concept and look at the `<a class="domain">` tag, you will notice that the URL parameter is another potential HTML injection vector. Its current handling is: URL-decoding twice, then passing it through `new URL(...).href`, then putting it into an unquoted attribute in the HTML code. This setup happens to be not exploitable for HTTP URLs (`new URL()` removes any whitespace, and with the HTML5 parser escaping an unquoted attribute is impossible without spaces) but it is with data: URIs.

### Recommendations

I generally recommend escaping everything, ideally automatically. Assumptions about some values being “safe” often break.

This means for <https://github.com/mozilla-mobile/android-components/blob/4155fff604166170c4b2b3139cdc1f369ace1b8c/components/feature/readerview/src/main/assets/extensions/readerview/readerview-background.js#L16>: Don’t call `encodeURIComponent()` on one value and leave the rest alone. Use `URLSearchParams` to compile this query, it will take care of escaping automatically.

On the receiving end (<https://github.com/mozilla-mobile/android-components/blob/4155fff604166170c4b2b3139cdc1f369ace1b8c/components/feature/readerview/src/main/assets/extensions/readerview/readerview.js#L344>), there is no need to call `decodeURIComponent()` manually, it only causing double decoding. `URLSearchParams` is already being used here, that’s sufficient.

When composing HTML code (<https://github.com/mozilla-mobile/android-components/blob/4155fff604166170c4b2b3139cdc1f369ace1b8c/components/feature/readerview/src/main/assets/extensions/readerview/readerview.js#L129>), quote all attributes. Unquoted attributes are a security hazard. And call `escapeHTML()` on all values, right there when inserting into HTML code. It’s too easy to forget this if it is done in another function.

Ideally however, `outerHTML`/`innerHTML` should not be used at all. In this particular case I’d recommend adding this content to the static HTML code, with a `hidden` attribute. Use regular DOM methods (`setAttribute()`, `textContent`) to fill in the dynamic data. These might not be quite as convenient but they are inherently safe. Once everything is filled in, the `hidden` attribute can be removed.

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1697604#c1)• 4 years ago |
|  | |

Attached file
[Proof of concept (redirecting)](attachment.cgi?id=9208226)
— [Details](attachment.cgi?id=9208226&action=edit)

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a91_109976)• 4 years ago |

Summary: HTML injection in vulnerability in Reader View → HTML injection vulnerability in Reader View

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1697604#c2)• 4 years ago |
|  | |

Sebastian or Christian are probably good people to look at this.

Flags: needinfo?(s.kaspari)Flags: needinfo?(csadilek)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a5825_1689)• 4 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1697604#c3)• 4 years ago |
|  | |

Thanks, Wladimir.

I will assign to me to schedule a fix.

Flags: needinfo?(csadilek)

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a8696_590895)• 4 years ago |

Assignee: nobody → csadilekFlags: needinfo?(s.kaspari)

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1697604#c4)• 4 years ago |
|  | |

One more recommendation for <https://github.com/mozilla-mobile/android-components/blob/a9bbac53fba6ebc4b1f629636ebde0c85c14da45/components/feature/readerview/src/main/java/mozilla/components/feature/readerview/ReaderViewMiddleware.kt#L79>: It should be better to determine the location bar display based on what’s actually loaded (extract `url` query parameter from action.url) rather than some hidden state that might be outdated.

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1697604#c5)• 4 years ago |
|  | |

Thanks, for this part we already have a ticket to find a better solution and remove the workaround. Let's keep this ticket confined to preventing the HTML injection cases you described, and address other refactorings separately.

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1697604#c6)• 4 years ago |
|  | |

Latest Fenix Nightly (210312 17:02) contains a fix for the two cases above caused by `article.dir`. We also followed the recommendations to quote all attributes, switch to using `URLSearchParams` instead of `encodeURIComponent`/`decodeURIComponent` and move all escaping logic to a single function where those strings are used to make this harder to miss in the future. Removing the dynamic HTML template for the static one we will look into in a follow-up to keep this separate from the immediate security fixes here.

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1697604#c7)• 4 years ago |
|  | |

`article.url.href` and `article.url.hostname` aren’t being escaped here: <https://github.com/mozilla-mobile/android-components/blob/09f8e790a498e4ec97173ef88d4de779fe212668/components/feature/readerview/src/main/assets/extensions/readerview/readerview.js#L137>. This should be fine given Gecko’s automatic URL escaping for HTTP URLs but it’s an unnecessary assumption.

There is a remaining superfluous `decodeURIComponent` call here: <https://github.com/mozilla-mobile/android-components/blob/09f8e790a498e4ec97173ef88d4de779fe212668/components/feature/readerview/src/main/assets/extensions/readerview/readerview.js#L358>

Otherwise the changes look fine.

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1697604#c8)• 4 years ago |
|  | |

> This should be fine given Gecko’s automatic URL escaping for HTTP URLs but it’s an unnecessary assumption.

Ah that's not an assumption we made. This is the result of `new URL(url)` which validates the URL, and `href` as well as `hostname` already come back as encoded. That's why we didn't encode/escape again. If there's anything unsafe here please let us know.

> There is a remaining superfluous decodeURIComponent call...

Thanks, removed now.

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1697604#c9)• 4 years ago |
|  | |

(In reply to Christian Sadilek [:csadilek] from [comment #8](/show_bug.cgi?id=1697604#c8 "RESOLVED FIXED - HTML injection vulnerability in Reader View"))

> Ah that's not an assumption we made. This is the result of `new URL(url)` which validates the URL, and `href` as well as `hostname` already come back as encoded. That's why we didn't encode/escape again. If there's anything unsafe here please let us know.

As I said, that’s Gecko’s URL escaping for HTTP URLs that you get via the URL object. It’s an implementation detail (used to work differently in the past, changed as an XSS prevention measure) and not happening for data: URIs for example.

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1697604#c10)• 4 years ago |
|  | |

Just for clarification: I’m not saying that it is unsafe (it isn’t as long as you are sure that you only get HTTP URLs), I’m saying that it’s better not to make any assumptions and to always escape every value inserted into HTML code. And here we have two assumptions: that there will only be HTTP URLs and that Gecko will URL-encode all dangerous characters in HTTP URLs (something that wasn’t always a given e.g. for the anchor part of the URL).

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1697604#c11)• 4 years ago |
|  | |

This was fixed with <https://github.com/mozilla-mobile/android-components/pull/9882> and landed about a month ago.

Status: NEW → RESOLVEDClosed: 4 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a2397172_75935)• 4 years ago |

Group: mobile-core-security → core-security-release
[status-firefox87](/buglist.cgi?f1=cf_status_firefox87&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox87&o1=equals&v1=wontfix)
[status-firefox88](/buglist.cgi?f1=cf_status_firefox88&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox88&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a2909741_551058)• 4 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a2922793_578488)• 4 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main88+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1697604#c12)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9215548)
— [Details](attachment.cgi?id=9215548&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a3156609_428608)• 4 years ago |

Alias: CVE-2021-29944

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a22245225_1689)• 3 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1697604#a52134862_430528)• 2 years ago |

Component: Security: Android → GeneralOS: Unspecified → Android
You need to [log in](/show_bug.cgi?id=1697604&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Wladimir Palant](/user_profile?user_id=109976)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ab358732_20250114_192851.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-16

## Security Vulnerabilities fixed in Firefox 88

Announced
April 19, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 88

#### [#CVE-2021-23994: Out of bound write due to lazy initialization](#CVE-2021-23994)

Reporter
Abraruddin Khan and Omair
Impact
high
##### Description

A WebGL framebuffer was not initialized early enough, resulting in memory corruption and an out of bound write.

##### References

* [Bug 1699077](https://bugzilla.mozilla.org/show_bug.cgi?id=1699077)

#### [#CVE-2021-23995: Use-after-free in Responsive Design Mode](#CVE-2021-23995)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When Responsive Design Mode was enabled, it used references to objects that were previously freed. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1699835](https://bugzilla.mozilla.org/show_bug.cgi?id=1699835)

#### [#CVE-2021-23996: Content rendered outside of webpage viewport](#CVE-2021-23996)

Reporter
Colin D. Munro
Impact
high
##### Description

By utilizing 3D CSS in conjunction with Javascript, content could have been rendered outside the webpage's viewport, resulting in a spoofing attack that could have been used for phishing or other attacks on a user.

##### References

* [Bug 1701834](https://bugzilla.mozilla.org/show_bug.cgi?id=1701834)

#### [#CVE-2021-23997: Use-after-free when freeing fonts from cache](#CVE-2021-23997)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Due to unexpected data type conversions, a use-after-free could have occurred when interacting with the font cache. We presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Bug 1701942](https://bugzilla.mozilla.org/show_bug.cgi?id=1701942)

#### [#CVE-2021-23998: Secure Lock icon could have been spoofed](#CVE-2021-23998)

Reporter
Jordi Chancel
Impact
moderate
##### Description

Through complicated navigations with new windows, an HTTP page could have inherited a secure lock icon from an HTTPS page.

##### References

* [Bug 1667456](https://bugzilla.mozilla.org/show_bug.cgi?id=1667456)

#### [#CVE-2021-23999: Blob URLs may have been granted additional privileges](#CVE-2021-23999)

Reporter
Nika Layzell
Impact
moderate
##### Description

If a Blob URL was loaded through some unusual user interaction, it could have been loaded by the System Principal and granted additional privileges that should not be granted to web content.

##### References

* [Bug 1691153](https://bugzilla.mozilla.org/show_bug.cgi?id=1691153)

#### [#CVE-2021-24000: requestPointerLock() could be applied to a tab different from the visible tab](#CVE-2021-24000)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A race condition with `requestPointerLock()` and `setTimeout()` could have resulted in a user interacting with one tab when they believed they were on a separate tab. In conjunction with certain elements (such as `<input type="file">`) this could have led to an attack where a user was confused about the origin of the webpage and potentially disclosed information they did not intend to.

##### References

* [Bug 1694698](https://bugzilla.mozilla.org/show_bug.cgi?id=1694698)

#### [#CVE-2021-24001: Testing code could have enabled session history manipulations by a compromised content process](#CVE-2021-24001)

Reporter
Andrew McCreight
Impact
moderate
##### Description

A compromised content process could have performed session history manipulations it should not have been able to due to testing infrastructure that was not restricted to testing-only configurations.

##### References

* [Bug 1694727](https://bugzilla.mozilla.org/show_bug.cgi?id=1694727)

#### [#CVE-2021-24002: Arbitrary FTP command execution on FTP servers using an encoded URL](#CVE-2021-24002)

Reporter
Daniel Santos
Impact
moderate
##### Description

When a user clicked on an FTP URL containing encoded newline characters (%0A and %0D), the newlines would have been interpreted as such and allowed arbitrary commands to be sent to the FTP server.

##### References

* [Bug 1702374](https://bugzilla.mozilla.org/show_bug.cgi?id=1702374)

#### [#CVE-2021-29945: Incorrect size computation in WebAssembly JIT could lead to null-reads](#CVE-2021-29945)

Reporter
Christian Holler
Impact
moderate
##### Description

The WebAssembly JIT could miscalculate the size of a return type, which could lead to a null read and result in a crash.

*Note: This issue only affected x86-32 platforms. Other platforms are unaffected.*

##### References

* [Bug 1700690](https://bugzilla.mozilla.org/show_bug.cgi?id=1700690)

#### [#CVE-2021-29944: HTML injection vulnerability in Firefox for Android's Reader View](#CVE-2021-29944)

Reporter
Wladimir Palant working with Include Security
Impact
low
##### Description

Lack of escaping allowed HTML injection when a webpage was viewed in Reader View. While a Content Security Policy prevents direct code execution, HTML injection is still possible.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1697604](https://bugzilla.mozilla.org/show_bug.cgi?id=1697604)

#### [#CVE-2021-29946: Port blocking could be bypassed](#CVE-2021-29946)

Reporter
Frederik Braun
Impact
low
##### Description

Ports that were written as an integer overflow above the bounds of a 16-bit integer could have bypassed port blocking restrictions when used in the Alt-Svc header.

##### References

* [Bug 1698503](https://bugzilla.mozilla.org/show_bug.cgi?id=1698503)

#### [#CVE-2021-29947: Memory safety bugs fixed in Firefox 88](#CVE-2021-29947)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Ryan VanderMeulen, Sean Feng, Tyson Smith, Julian Seward, Christian Holler reported memory safety bugs present in Firefox 87. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 88](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651449%2C1674142%2C1693476%2C1696886%2C1700091)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


