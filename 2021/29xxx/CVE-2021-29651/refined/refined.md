- **Root cause of vulnerability:** The vulnerability stems from the improper handling of the `pomerium_redirect_uri` parameter during programmatic access to protected sites. An attacker can manipulate this parameter to redirect a victim to an arbitrary URL after they've logged into Pomerium, resulting in an open redirect. This redirection carries a JWT in the URL, leading to its leakage.
- **Weaknesses/vulnerabilities present:**
    - **Open Redirect:** The application allows an attacker-controlled redirect URL, causing users to be redirected to arbitrary external sites.
    - **JWT Leakage:** The JWT is included in the redirect URL, which exposes it to the attacker's control via the redirect, allowing the attacker to potentially impersonate the victim.
- **Impact of exploitation:**
    - **Information Disclosure:** A leaked JWT allows the attacker to extract the victim's identity (e.g., email address).
    - **Account Impersonation:** If an application integrating with Pomerium does not properly validate the audience (`aud`) claim in the JWT, an attacker can use the stolen JWT to access that application as the victim.
- **Attack vectors:**
    - Programmatic access to protected sites is used to obtain a signed login URL, where the attacker can manipulate the `pomerium_redirect_uri` parameter.
    - The victim needs to have an active session with Pomerium.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to induce a victim to visit a crafted URL. The attacker needs to be able to influence the `pomerium_redirect_uri`.
    - The victim must have an existing session with Pomerium.