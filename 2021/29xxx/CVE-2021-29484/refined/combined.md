=== Content from github.com_f45a0c44_20250114_194154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTryGhost%2FGhost%2Fsecurity%2Fadvisories%2FGHSA-9fgx-q25h-jxrg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTryGhost%2FGhost%2Fsecurity%2Fadvisories%2FGHSA-9fgx-q25h-jxrg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=TryGhost%2FGhost)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[TryGhost](/TryGhost)
/
**[Ghost](/TryGhost/Ghost)**
Public

* [Notifications](/login?return_to=%2FTryGhost%2FGhost) You must be signed in to change notification settings
* [Fork
  10.5k](/login?return_to=%2FTryGhost%2FGhost)
* [Star
   48k](/login?return_to=%2FTryGhost%2FGhost)

* [Code](/TryGhost/Ghost)
* [Issues
  31](/TryGhost/Ghost/issues)
* [Pull requests
  144](/TryGhost/Ghost/pulls)
* [Actions](/TryGhost/Ghost/actions)
* [Security](/TryGhost/Ghost/security)
* [Insights](/TryGhost/Ghost/pulse)

Additional navigation options

* [Code](/TryGhost/Ghost)
* [Issues](/TryGhost/Ghost/issues)
* [Pull requests](/TryGhost/Ghost/pulls)
* [Actions](/TryGhost/Ghost/actions)
* [Security](/TryGhost/Ghost/security)
* [Insights](/TryGhost/Ghost/pulse)

# DOM XSS in Theme Preview

High

[ErisDS](/ErisDS)
published
GHSA-9fgx-q25h-jxrg
Apr 29, 2021

## Package

npm

ghost
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>=4.0.0 <4.3.3

## Patched versions

4.3.3

## Description

### Impact

An unused endpoint added during the development of 4.0.0 has left sites vulnerable to untrusted users gaining access to Ghost Admin. Attackers can gain access by getting logged in users to click a link containing malicious code. Users do not need to enter credentials and may not know they've visited a malicious site.

Ghost(Pro) has already been patched. We can find no evidence that the issue was exploited on Ghost(Pro) prior to the patch being added.

Self-hosters are impacted if running Ghost a version between 4.0.0 and 4.3.2. Immediate action should be taken to secure your site - see patches & workarounds below.

### Patches

Fixed in 4.3.3, all 4.x sites should upgrade as soon as possible.

As the endpoint is unused, the patch simply removes it.

### Workarounds

* Log out of Ghost Admin
* Suspend any users who cannot log out
* Block access to `/ghost/preview`

Example of how to block access in nginx:

```
location ~ /ghost/preview {
    rewrite ^(\/(.*\/)?ghost\/)(.*)$ $1 redirect;
}

```

This redirects the endpoint to `/ghost/`, which mimics the behaviour after the patch is applied.

### References

* [Forum Post](https://forum.ghost.org/t/critical-security-update-available-for-ghost-4-x/22290)

### For more information

If you have any questions or comments about this advisory:

* email us at security@ghost.org

---

Credits: Paul Gerste, SonarSource (<https://www.sonarsource.com/>)

### Severity

High

7.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:H/A:N

### CVE ID

CVE-2021-29484

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_adf0345c_20250114_194157.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## ghost

5.106.1Â â¢Â PublicÂ â¢Â Published a day ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [97 Dependencies](?activeTab=dependencies)
* [8 Dependents](?activeTab=dependents)
* [820 Versions](?activeTab=versions)

Â

[![Ghost](https://user-images.githubusercontent.com/65487235/157884383-1b75feb1-45d8-4430-b636-3f7e06577347.png)](https://ghost.org/#gh-light-mode-only)
[![Ghost](https://user-images.githubusercontent.com/65487235/157849205-aa24152c-4610-4d7d-b752-3a8c4f9319e6.png)](https://ghost.org/#gh-dark-mode-only)

Â

[Ghost.org](https://ghost.org/) â¢
[Forum](https://forum.ghost.org) â¢
[Docs](https://ghost.org/docs/) â¢
[Contributing](https://github.com/TryGhost/Ghost/blob/main/.github/CONTRIBUTING.md) â¢
[Twitter](https://twitter.com/ghost)

[![Downloads](https://camo.githubusercontent.com/99d5f1d5171170e485a5915c77ab7698b8e5195bf8cd8376e657517e7fb9eeb1/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f776e6c6f6164732d3130304d2b2d627269676874677265656e2e737667)](https://ghost.org/)
[![Latest release](https://camo.githubusercontent.com/9e853f46d27a75c158570435d3a82651fffc8ef0931401539ba8710f26d2aca3/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f54727947686f73742f47686f73742e737667)](https://github.com/TryGhost/Ghost/releases/)
[![Build status](https://github.com/TryGhost/Ghost/workflows/CI/badge.svg?branch=main)](https://github.com/TryGhost/Ghost/actions)
[![Contributors](https://camo.githubusercontent.com/db2635e4e553c740247fb1f1769f75820d26828562068cf57d221c3bb63a03a9/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f54727947686f73742f47686f73742e737667)](https://github.com/TryGhost/Ghost/contributors/)

Â

[![Fiercely independent, professional publishing. Ghost is the most popular open source, headless Node.js CMS which already works with all the tools you know and love.](https://user-images.githubusercontent.com/353959/169805900-66be5b89-0859-4816-8da9-528ed7534704.png)](https://ghost.org/)

Â

[![Ghost(Pro)](https://user-images.githubusercontent.com/65487235/157849437-9b8fcc48-1920-4b26-a1e8-5806db0e6bb9.png)](https://ghost.org/pricing/#gh-light-mode-only)
[![Ghost(Pro)](https://user-images.githubusercontent.com/65487235/157849438-79889b04-b7b6-4ba7-8de6-4c1e4b4e16a5.png)](https://ghost.org/pricing/#gh-dark-mode-only)

The easiest way to get a production instance deployed is with our official **[Ghost(Pro)](https://ghost.org/pricing/)** managed service. It takes about 2 minutes to launch a new site with worldwide CDN, backups, security and maintenance all done for you.

For most people this ends up being the best value option because of [how much time it saves](https://ghost.org/docs/hosting/) â and 100% of revenue goes to the Ghost Foundation; funding the maintenance and further development of the project itself. So youâll be supporting open source software *and* getting a great service!

Â

# Quickstart install

If you want to run your own instance of Ghost, in most cases the best way is to use our **CLI tool**

```
npm install ghost-cli -g

```

Â

Then, if installing locally add the `local` flag to get up and running in under a minute - [Local install docs](https://ghost.org/docs/install/local/)

```
ghost install local

```

Â

or on a server run the full install, including automatic SSL setup using LetsEncrypt - [Production install docs](https://ghost.org/docs/install/ubuntu/)

```
ghost install

```

Â

Check out our [official documentation](https://ghost.org/docs/) for more information about our [recommended hosting stack](https://ghost.org/docs/hosting/) & properly [upgrading Ghost](https://ghost.org/docs/update/), plus everything you need to develop your own Ghost [themes](https://ghost.org/docs/themes/) or work with [our API](https://ghost.org/docs/content-api/).

### Contributors & advanced developers

For anyone wishing to contribute to Ghost or to hack/customize core files we recommend following our full development setup guides: [Contributor guide](https://ghost.org/docs/contributing/) â¢ [Developer setup](https://ghost.org/docs/install/source/)

Â

# Ghost sponsors

A big thanks to our sponsors and partners who make Ghost possible. If you're interested in sponsoring Ghost and supporting the project, please check out our profile on [GitHub sponsors](https://github.com/sponsors/TryGhost) â¤ï¸

**[DigitalOcean](https://m.do.co/c/9ff29836d717)** â¢ **[Fastly](https://www.fastly.com/)**

Â

# Getting help

Everyone can get help and support from a large community of developers over on the [Ghost forum](https://forum.ghost.org/). **Ghost(Pro)** customers have access to 24/7 email support.

To stay up to date with all the latest news and product updates, make sure you [subscribe to our changelog newsletter](https://ghost.org/changelog/) â or follow us [on Twitter](https://twitter.com/Ghost), if you prefer your updates bite-sized and facetious. ð·ð¢

Â

# Copyright & license

Copyright (c) 2013-2025 Ghost Foundation - Released under the [MIT license](https://github.com/TryGhost/Ghost/blob/HEAD/LICENSE).
Ghost and the Ghost Logo are trademarks of Ghost Foundation Ltd. Please see our [trademark policy](https://ghost.org/trademark/) for info on acceptable usage.

## Readme

### Keywords

* [ghost](/search?q=keywords:ghost)
* [blog](/search?q=keywords:blog)
* [cms](/search?q=keywords:cms)
* [headless](/search?q=keywords:headless)
* [content](/search?q=keywords:content)
* [markdown](/search?q=keywords:markdown)
## Package Sidebar

### Install

`npm i ghost`

### Repository

[Gitgithub.com/TryGhost/Ghost](https://github.com/TryGhost/Ghost)

### Homepage

[ghost.org](https://ghost.org)

### DownloadsWeekly Downloads

6,323

### Version

5.106.1

### License

MIT

### Unpacked Size

36.3 MB

### Total Files

1517

### Last publish

a day ago

### Collaborators

* [![zimoatghost](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82NmRmYzQ5YWRiNGQwNDJiYzMyYTE3MzRiNDA5MGM3ZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.TRbzd_6UeODbyhki6S5KWzMeKBoFazfGlamxHCS4g3Q "zimoatghost")](/~zimoatghost)
* [![allouis](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kZmE1ZTE2MGMxODE2MjUyNWRlMTVkZDIyMzg5MjI3Nz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.RN7CsIlBEVnDVPFavXEQ1sxY18xlkl82hTEI2SAjRkc "allouis")](/~allouis)
* [![kernalghost](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kMDM5ZTEyZDJiNGZhYmY1YzFiZjU2ZWNjMjZlYjc5Yz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.TckfXHNBeniidRoO7hbY3qDsZYH77IwIQAcLbMUn6os "kernalghost")](/~kernalghost)
* [![sanne-san](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9lYmRiNjU2NTRkN2IxYTgxNDg2YTAyYTdhMDc3ZjYyMD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.GXbWWMo1mZt4JOJ0xVY7ro_U-r-OfrET57w_QGq0TMk "sanne-san")](/~sanne-san)
* [![chrisraible](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8wMzIwNjA3OWZlOTdhZmUyYWNkMjBmMmYyMDc4YzFjMD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.KDHzt_UxRwmfjG8fj4l0lv98wJTRduS2zAaSJGInOhI "chrisraible")](/~chrisraible)
* [![erisds](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8xM2JjM2FlZDIyNmUzZDdiMGQyNjJlNTY2NDQ2OGY1MD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.9UlWFIKIJyUDUsD9SDctyg7a8XNZzI7BPW_S-CXEDVw "erisds")](/~erisds)
* [![johnonolan](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83NWU5NThhNjY3NGE3ZDY4ZmUwZDU3NWZiMjM1MTE2Yz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.YiGfAbr3P0Xr7gLMJqZDGUppAe71YxaX_ZaAz39fy2U "johnonolan")](/~johnonolan)
* [![kevinansfield](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zYWUwNDViYzE5OGExNTc0MDE4MjdjODQ1NWNkN2M5OT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.JDwAw1rktqp_1Lj89vXn5_6mOH45JiRKC0ww5z4UKOs "kevinansfield")](/~kevinansfield)
* [![cobbspur](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hYTU1ZDIzNmIyZmJjZDQyOWMwNGFmZjdmMWJmMDJmMD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.XJpnTZ1m-UtbrH8_julxobtuDejHvfF2ruNroyJUlyk "cobbspur")](/~cobbspur)
* [![aileencgn](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84NWE0N2E2MGQ1Nzk1NzI2MDFmZjc0YjcyZmU4YjMyZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Za2aO9EgmDRiD-iNne6xq9y5MfXIc1__0Hsma_EPHbE "aileencgn")](/~aileencgn)
* [![jloh](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9hMGVlNWIwNDVmYmMxMzI3NTU0MjQ1M2IyYTk3MmQ5ZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.yhWQGID7BkCXcsz33Qt57wfbnkizI1F_uBfVRp4gZME "jloh")](/~jloh)
* [![daniellockyer](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9jMzZiZGQzOGI4ZjVmZTZhYjE0Y2Q2MWVhZTQyZDllZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.Ad3BPZ6dbaxCUj_tz14aijJ-GC_ruArrr6zzSX52rPc "daniellockyer")](/~daniellockyer)
* [![minimaluminium](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zZGM3ZGUxYjNjMGU0ZDNkNmM1M2I3NTRmZDkyNzM2Yj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.xt-CLboNpKSVKrecmOb8mTRqXn5VhLSKXMuDxEKxPgU "minimaluminium")](/~minimaluminium)
* [![sam-lord](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9jZWUwOGMzYmJlOTY1ZDE3MzBhMjhkMWM3ODdkMGVlMz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.qRvlLSzlREZPWnwMFh4U8Ryat_EghEUonmr3EUX3Yw8 "sam-lord")](/~sam-lord)
* [![pauladamdavis](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83M2JjMzZlZTJjMzA4YTI5YWZiY2ZmZGUyNTM1YTM2Mj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.F_hJLprwH1MSf1DWKkWeq2oQSq7FqpxbBVeHJRvOcDk "pauladamdavis")](/~pauladamdavis)
* [![bobvaneck](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kOTQyOTk4MDBkM2JkY2RjNjU5MGM2NmY2YzNlNjM4MT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ykUtvVJuDL1wOjykJ-8MyNvJVzIKW-SjDhzYI8QSxhY "bobvaneck")](/~bobvaneck)
* [![joeegrigg](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci84YzlhM2FjZDJhNjdlYTA1ZGUzMjU4YjcwNTEyYmJkNz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.tc4jxtbSmFygnvChFkALgv5nygPlZnIEANySNkAbyHA "joeegrigg")](/~joeegrigg)
* [![djordjevlais](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci81NjdjMTY5YTRhMmIyZGQ0NDAzZGJmOGE3M2FiYmM3NT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.HnSvWKFLVhx_ADGL_dEb4Nv_LlJHsfqWpbFxEat-E-c "djordjevlais")](/~djordjevlais)
* [![ronaldlangeveld](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82Y2FhOTdjNjlkMjA4MWExYzM2NmY4Y2U1ZTRiMjkxZj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.km1EPHvR7IH4KICF2e5p8vIXMKG2mZQDxREYfkl3Rik "ronaldlangeveld")](/~ronaldlangeveld)
* [![hadret](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yYzY5NjlkNDgyNmQxMmJkZTA5ZDI0MWRmMjI2MDVmMj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.0NXkz3oOeM7RNPQ9wL7QPFghJXC7c_pKbLKjvQk0Sik "hadret")](/~hadret)
* [![jonhickman](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci82YWQyMjVmZDg2M2JmMTZkOTkxOTJkNzlkN2I1YjRkMj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.ROCAVEP7MilEiwU-KCERPpZ_FgSrsnBnR1oZnxHZzdI "jonhickman")](/~jonhickman)
* [![erik-ghost](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83YTE1NzEwZmRkZTc1MmRhM2ExYWYzYmQ1ZDYxMWI1Nz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.uXmYKqeJcNxxtGk3CczI3euPik2Ij3T_pJe8IaE1FLU "erik-ghost")](/~erik-ghost)
* [![sagzy](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yNzQ0OWNjN2ZhM2YwNzJmYTAxYTk5NWE0ZWRjZjg3Mz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.VY19ExRgSzcxBvDHwrL3O4ZDab74Oxy94tQQ5_rsr-E "sagzy")](/~sagzy)
* [![dvdwinden](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8zODBlZGQ5MGM3MGY0ZjY4ZDRkZWVmODZlMzg2NTY1Zj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.fnsHiymxgHDochUrMcGlQMmOd5bhMCeV66nBPtlsdhw "dvdwinden")](/~dvdwinden)
* [![vershwal](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yZTkxMzRlM2Y1NTk2ZDE3YjY3NzNlZTM0MmE5ZDU1ZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.FYUiTTkwieUqP8gmHowBP0vitozY1dF9RS7vU7sJ_mI "vershwal")](/~vershwal)
* [![mike182uk](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci83MzBjMDNjN2VjZGJkNjU0MDI4YjNiZWI1ZjU5MjI5MD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.r1loDDKq2GIQVNATlTwC01oqpkvuXUVRmaLTWLX5-Ds "mike182uk")](/~mike182uk)
* [![9larsons](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9iMDRlYTFjMDY0MWE3NGRiNWUyMmVmZjFkM2JkZjY3Yz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.XbrcaQOT79hLq0HlOEq-smiUlYhmZFU8xN-TTn7R8Ec "9larsons")](/~9larsons)
* [![lsinger](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci9kMmUwZTVmNmJmN2JmZTZlNDFkMDRiMzZkZDViZDdmMz9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.gHvjOMcYTLfYNc0gQIL4o-oNRcyREmcl1OxpPp4FjHc "lsinger")](/~lsinger)
* [![charliegilbert](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci80MmY2NzI3YjYxYWQwOGEyYWUzOGVhOTFmYjRlZDllZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.OJO_cjFGt67u21yOV0KmQDwqbTyvBIDbDWzPBu8STOY "charliegilbert")](/~charliegilbert)
* [![kirrg001](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8yMjhjZjA2MmZhYzQyNzc1OTY4NjY3MDE2YzdkNDg5OT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.YHak-4C6NDHwMq7eOqXkLCFCyuwMxk6x5nK5r2HjcRk "kirrg001")](/~kirrg001)
[**Try** on RunKit](https://runkit.com/npm/ghost)[**Report** malware](/support?inquire=security&security-inquire=malware&package=ghost&version=5.106.1)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from forum.ghost.org_31786051_20250114_194153.html ===


[Ghost Forum](/)

# [Critical security update available for Ghost 4.x](/t/critical-security-update-available-for-ghost-4-x/22290)

[News](/c/news/9)

[Hannah](https://forum.ghost.org/u/Hannah)

April 29, 2021, 11:32am

1

We have been made aware of a security vulnerability in Ghost 4.x. This is patched in 4.3.3 - which has already been released and rolled out on on Ghost(Pro). Self-hosters should update to 4.3.3 as soon as possible, or if for any reason you cannot update, implement one of the recommendations outlined below.

**Details:**

An unused endpoint added during the development of 4.0.0 is vulnerable to allowing untrusted users access to Ghost Admin. An attacker may gain access by convincing an authenticated Ghost Staff User to click a link containing malicious code. Users do not need to enter credentials and may not know they’ve visited a malicious site for this exploit to be effective.

![:warning:](https://emoji.discourse-cdn.com/apple/warning.png?v=12 ":warning:") **Updating to 4.3.3 is critical to the security of your site.**

**Ghost(Pro):**

Ghost(Pro) has already been patched. We have investigated and found no evidence that the issue was exploited prior to the patch being added - meaning no customer sites have been compromised. As Ghost(Pro) is maintained by the Ghost core team, it is always patched immediately when any security incident is reported.

**Patch & Workarounds:**

The patch in 4.3.3 removes the unused endpoint, and is the quickest complete solution.

As a workaround, if for any reason you cannot update your Ghost instance, you can do either of the following:

* Suspend Staff Users, and then log out of Admin until you are able update.
* Block access to the endpoint manually at your edge. For details see [advisory](https://github.com/TryGhost/Ghost/security/advisories/GHSA-9fgx-q25h-jxrg).

**Disclosure:**

Full details of the vulnerability have been published through [GitHub Advisories](https://github.com/TryGhost/Ghost/security/advisories/GHSA-9fgx-q25h-jxrg). We’ve also published a notification to all affected sites that will appear in Ghost Admin and shared the details here on the forum.

To aid with disclosures in future, we’re also updating Ghost to be able to self-notify site administrators by email when there are any critical updates available that require immediate attention.

We’re really grateful to Paul Gerste of SonarSource (<https://www.sonarsource.com/>) for finding this vulnerability, reporting it responsibly following our [security policy](https://ghost.org/docs/security/#reporting-vulnerabilities), and for his prompt replies to our followup questions.

21 Likes

[Minimum Node.js Versions changing to 12.22.1 & 14.16.1 (Node v10 is EOL)](https://forum.ghost.org/t/minimum-node-js-versions-changing-to-12-22-1-14-16-1-node-v10-is-eol/22527)

[system](https://forum.ghost.org/u/system)
Closed

May 15, 2021, 9:34am

8

This topic was automatically closed 14 days after the last reply. New replies are no longer allowed.

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Security update available for Ghost 4.x and 5.x](https://forum.ghost.org/t/security-update-available-for-ghost-4-x-and-5-x/30823)  [News](/c/news/9) | 1 | 839 | June 29, 2022 |
| [Security update available for Ghost 4.48.7 and 5.22.6](https://forum.ghost.org/t/security-update-available-for-ghost-4-48-7-and-5-22-6/34475)  [News](/c/news/9) | 4 | 1680 | November 1, 2023 |
| [Security update available for Ghost 3.x and 4.x](https://forum.ghost.org/t/security-update-available-for-ghost-3-x-and-4-x/25839)  [News](/c/news/9) | 10 | 1703 | October 26, 2021 |
| [Critical Security Update warning - only when applicable](https://forum.ghost.org/t/critical-security-update-warning-only-when-applicable/26756)  [Ideas](/c/ideas/5) | 0 | 274 | November 10, 2021 |
| [Critical security notification keeps displaying even after updating to the latest version](https://forum.ghost.org/t/critical-security-notification-keeps-displaying-even-after-updating-to-the-latest-version/23673)  [Developer help](/c/help/6) | 3 | 540 | June 28, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from blog.sonarsource.com_033f1000_20250114_194152.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Ghost CMS 4.3.2 - Cross-Origin Admin Takeover

![](data:image/svg+xml;charset=utf-8...)![Paul Gerste photo]()![Paul Gerste photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e712603b-cf90-4c56-a666-cd2691b3def2/404b3fe2-4818-41dc-bbe0-9cae851eb542_Paul_Gerste.jpg?w=800&h=800&auto=format&fit=crop)

Paul Gerste

Vulnerability Researcher

August 31, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We recently discovered an XSS vulnerability in the admin frontend of Ghost CMS 4.3.2. Find out the details and learn how to avoid such issues in your code!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/6e09643a-1811-40f9-ab7b-968fa954c14a/cover-278a88f4-f948-4c9a-8ede-2a8c22f9a270_RD-34%2BGhost%2BCMS%2BDOM%2BXSS%25402x.png?w=2401&h=1200&auto=format&fit=crop)![We recently discovered an XSS vulnerability in the admin frontend of Ghost CMS 4.3.2. Find out the details and learn how to avoid such issues in your code!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/6e09643a-1811-40f9-ab7b-968fa954c14a/cover-278a88f4-f948-4c9a-8ede-2a8c22f9a270_RD-34%2BGhost%2BCMS%2BDOM%2BXSS%25402x.png?w=2401&h=1200&auto=format&fit=crop)

Ghost is one of the most popular Node.js-based Content Management Systems (CMS). According to the vendor, there are currently more than 2.5 million installs of it and the project has more than 38k stars on GitHub. During our research on open-source applications, we analyzed the code and found a vulnerability in Ghost 4.3.2 that allows attackers to gain control of admin accounts.

In this blog post, we will first look at some web technologies that are required to understand the vulnerability. Then we will show the vulnerability and how it could have been exploited by attackers. Finally, we will explain how to avoid or fix such issues during development.

## Impact

The code vulnerability, CVE-2021-29484, was introduced in Ghost 4.0.0 and fixed in version 4.3.3. It is a DOM-based Cross-Site Scripting (XSS) issue that allows attackers to take over accounts, including admins. This would allow them to read or modify any data on the site.

Exploiting this vulnerability requires the victim to visit a malicious link while being logged in to the Ghost admin area. The affected versions of Ghost are vulnerable in the default configuration, and there is no setting to disable the affected component.

The following video demonstrates the exploitation of the vulnerability by having an admin click on a malicious link that creates a new privileged account for the attacker without the victim noticing it:

## Technical Details

We will first explain the web technologies that are important to understand this vulnerability: Same-Origin Policy and Cross-Origin messaging. Then we explain how the vulnerability works and how to avoid such issues during development.

### Background

When a website embeds another website using an `<iframe>` element, some rules control how both sites can interact with each other. This set of rules is called the [Same-Origin Policy (SOP)](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy "Same-Origin Policy (SOP)"). It prevents different websites from directly reading or modifying each other unless they come from the same *origin*. A website’s origin consists of the protocol, the host, and the port of the website’s URL. For example, `https://example.com` is the origin of `https://example.com/test/?id=42` (the port is omitted here because it can be derived from the protocol).

![](data:image/svg+xml;charset=utf-8...)![Example of the Same-Origin Policy (SOP)]()![Example of the Same-Origin Policy (SOP)](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/b9479345-64c9-4fe8-b82a-623c3bd70c08/body-70d960f4-ff8c-44a2-83af-494ef1de1f8d_sop%2B%25281%2529.png?w=551&h=361&auto=format&fit=crop)

As a result, a website on `https://`**attacker**`.com` cannot read or manipulate any data of `https://`**facebook**`.com`, but `https://attacker.com/`**xxx** can access the content of `https://attacker.com/`**yyy**. This is an important security mechanism because otherwise, every website you visit could steal your private Facebook messages or read your bank data, just by embedding the victim site.

There is, however, still a way for websites to communicate with other websites that are *cross-origin*, meaning that they have different origins. To do this, websites can send and receive message events by using the [postMessage API](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage "postMessage API"). This method is pretty secure by default because it does not allow the sites to directly access each other’s DOM, but there is still room for things to go wrong when handling these messages, as we will see in the next section.

### DOM-based XSS in Theme Preview (CVE-2021-29484)

Ghost is a CMS that consists of two components. The first component is the page containing the content, the other one is the admin area. The admin frontend is usually served on the `/ghost/` sub-path of a Ghost site, but it can also be served on another domain if users want to go with an extra-secure setup. The admin area allows users with various roles to log in and perform tasks, e.g. writing new blog posts, editing settings, or changing the site’s theme.

In Ghost 4.0.0, a theme preview feature was added to the admin frontend. It consists of a static HTML page that is served in the context of the admin area at `/ghost/preview`. The page, simplified for brevity, looks like this:

[**core/server/web/admin/views/preview.html**](https://github.com/TryGhost/Ghost/blob/95651b33a66f3240535a61999b292a725f1b3317/core/server/web/admin/views/preview.html "core/server/web/admin/views/preview.html")**:**

```
 1   <script type="text/javascript" charset="utf-8">
 2       (function(){
 3           function onReceive(message) {
 …               // ...
 6               document.write(message.data);
 …               // ...
 9           }
 …           // ...
34           if (window.addEventListener){
35               addEventListener("message", onReceive, true);
 …               // ...
38           }
 …           // ...
42       })();
 …       // ...
53   </script>
```

It contains a script that listens for `message` events (line 35). If such an event occurs, its content is added to the page in line 6, but without verifying the event’s origin. This constitutes a vulnerability because a site from any origin could send such a message. The whole theme preview component is embeddable from anywhere, as there is no `X-Frame-Options` header and no `frame-ancestors` directive in the `Content-Security-Policy` header that would prevent it.

This allows for DOM-based XSS within the context of the admin panel. An attacker could craft a website that embeds the theme preview page and sends a malicious HTML payload to it. The payload will then be inserted into the page, executing any JavaScript in it. Since the victim is logged in, the attacker can now do anything the victim is authorized to do.

Attackers could use this to take over privileged accounts, such as admins or owners, by luring them into visiting an attacker-controlled website while being logged in. The malicious payload could create a new admin account for the attacker, which would provide unrestricted access to the Ghost admin area. This is demonstrated in the demo video above.

**exploit.html:**

```
<iframe name="iframe" src="http://ghost:2368/ghost/preview"></iframe>
<script>
window.addEventListener('message', (event) => {
  if (event.data === 'loaded') {
    const payload = 'alert(origin)';
    iframe.postMessage(`<script>${payload}<\x2fscript>`, '*');
  }
});
</script>
```

This example exploit works by embedding a Ghost instance’s theme preview page in an iframe and then using the postMessage API to send a message that contains a malicious script once the iframe has loaded. When a victim, e.g. an admin user, visits the attacker’s page, the script payload is executed and can perform any action as the admin. This would result in the take-over of the Ghost site, as the attacker could read and modify everything on it.

This vulnerability shows that even in high-quality codebases, things can slip through. An automated approach helps to catch issues [before they go into production](https://sonarcloud.io/code-security/ "before they go into production") or even [before they leave the IDE](https://www.sonarlint.org/ "before they leave the IDE").

### Patch

In this case, the vendor chose to [remove](https://github.com/TryGhost/Ghost/commit/14b3431de12e674a0bd562e9230e2891b6903ae2 "remove") the affected component because it was unused anyway. In other scenarios, there might not be such an easy option.

The main issue was that *any* website could have sent a message event and the theme preview component would not validate where it came from. Fortunately, message events have the [origin](https://developer.mozilla.org/en-US/docs/Web/API/MessageEvent/origin "origin") property that can be used to validate the sender. A straightforward fix would be to compare the event’s origin with a set of allowed origins and reject any message that comes from somewhere else. Example:

```
const allowedOrigins = [
    'https://example.com',
    'https://blog.example.com',
];
window.addEventListener('message', (event) => {
    if (!allowedOrigins.includes(event.origin)) {
        return;
    }
    handleEvent(event);
});
```

So if your code is handling cross-origin message events, you can check if it uses the messages in potentially dangerous ways, such as inserting unfiltered data into the page. In this case, we recommend checking the origin to verify that events come from non-malicious origins, as shown in the example above.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-04-27 | We send a detailed advisory via email |
| 2021-04-27 | Vendor confirms the issue, asks for additional proof-of-concept (PoC) |
| 2021-04-27 | We send an additional PoC that demonstrates the impact |
| 2021-04-28 | Vendor asks for further clarification |
| 2021-04-28 | We provide more details |
| 2021-04-29 | Vendor releases version 4.3.3 |

## Summary

In this blog post, we analyzed a code vulnerability found in Ghost 4.3.2, a widely-used open-source CMS written in JavaScript. We outlined how the Same-Origin Policy works, and how unsafe handling of Cross-Origin messages can lead to the takeover of a Ghost instance. We also explained how to prevent vulnerabilities of this kind.

We reported these vulnerabilities to the vendor in late April 2021. They confirmed and fixed the vulnerabilities immediately and took their product’s security very seriously, so huge kudos to the Ghost security team! If you are running Ghost, we recommend updating to at least version 4.3.3.

## Related Blog Posts

* [*Zimbra 8.8.15 - Webmail Compromise via Email*](https://blog.sonarsource.com/zimbra-webmail-compromise-via-email "Zimbra 8.8.15 - Webmail Compromise via Email")
* [*WordPress 5.7 XXE Vulnerability*](https://blog.sonarsource.com/wordpress-xxe-security-vulnerability "WordPress 5.7 XXE Vulnerability")
* [*Grav CMS 1.7.10 - Code Execution Vulnerabilities*](https://blog.sonarsource.com/grav-cms-code-execution-vulnerabilities "Grav CMS 1.7.10 - Code Execution Vulnerabilities")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


