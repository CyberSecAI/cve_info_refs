The provided content is related to CVE-2021-29439.

**Root cause of vulnerability:**
The vulnerability stems from insufficient privilege verification in the plugin-related task handlers within the Grav CMS admin plugin.

**Weaknesses/vulnerabilities present:**
- **Insufficient Authorization Checks:** Task handlers for plugin-related operations did not properly verify the caller's privileges. Specifically, users with the `admin.login` permission were not correctly restricted from performing actions that require higher privileges.
- **Inadequate Access Control:** The system allowed users with minimal admin privileges (specifically the ability to log into the admin panel) to install arbitrary third-party plugins and their dependencies.

**Impact of exploitation:**
- **Arbitrary Code Execution:** By installing a specially crafted plugin, an attacker can achieve arbitrary code execution on the server.
- **Privilege Escalation:** Successful exploitation allows an attacker to elevate their privileges on the affected Grav CMS instance.

**Attack vectors:**
- **Malicious Plugin Installation:** An attacker would need to create or use a malicious plugin that contains code designed to exploit the vulnerability.
- **Admin Panel Access:** The attacker needs to have access to the admin panel with `admin.login` privileges.

**Required attacker capabilities/position:**
- An attacker must have an account with `admin.login` privileges to access the admin panel.
- An attacker needs the ability to upload and install a malicious plugin.

**Additional notes:**
- The vulnerability was addressed by enhancing authorization checks on task handlers, restricting access to plugin installation actions to users with appropriate privileges.
- A workaround was to block access to the `/admin` path from untrusted sources.
- The fix is included in version 1.10.11.
- The commit diffs highlight changes to `AdminBaseController.php`, specifically modifying permission checks within task handlers such as `taskFilesUpload`, `taskFilesSessionRemove` and `taskGetFilesInFolder`, which were originally using `save` permissions, but changed to more specific permissions like  `upload file`, `delete file` and `get files` respectively.