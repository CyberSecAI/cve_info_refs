```
{
  "CVE-2021-43038": {
    "root_cause": "The Unitrends backup appliance uses a custom PostgreSQL user defined function (UDF) written in Perl. This function is vulnerable to command injection because it executes a shell script and blindly passes new or modified data from a table row to the Perl system() function.",
    "weaknesses": [
      "Command injection via a custom PostgreSQL user defined function (UDF).",
      "The UDF uses the Perl system() function to execute shell commands with user-controlled input.",
       "The function is a trigger function. So, it is executed based on a database event, not on user input"
    ],
    "impact": "Remote command execution as the postgres Linux user by injecting shell metacharacters into the alert_text column.",
    "attack_vectors": "An attacker can exploit this vulnerability by first creating a table in the public schema and adding a trigger that calls the vulnerable UDF when a row is inserted or updated. Subsequently, they can insert a malicious row with shell metacharacters in the `alert_text` column. An attacker must have network access to the vulnerable PostgreSQL port.",
    "required_attacker_capabilities": "An attacker needs a low-privileged PostgreSQL user account with the USAGE privilege on the bp schema, which allows them to execute UDFs. They also need the ability to create tables in the public schema."
  }
}
```