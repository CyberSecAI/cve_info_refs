```
{
  "CVE-2021-43396": {
    "Description": "The vulnerability occurs within the `iconv` library, specifically during conversions from the ISO-2022-JP-3 character encoding. It can be triggered by an escape sequence that switches the active character set. This causes a spurious NUL character to be emitted during the conversion process when the internal state of iconv is reset (inbuf = NULL). This was a regression introduced by a previous security fix.",
    "Root cause": "The code responsible for resetting the internal state in `iconvdata/iso-2022-jp-3.c` does not properly ensure that a character has been saved before resetting the state. The condition `data->__statep->__count != ASCII_set` incorrectly picks cases where the current set differs from ASCII_set, without verifying that a character is ready to output.",
    "Weaknesses": [
      "Incorrect state handling during character set conversion.",
      "Missing check for queued characters before state reset."
    ],
    "Impact": "The spurious NUL character emitted can lead to data corruption or unexpected behavior in applications that use `iconv`. Programs expecting a NUL character as a data terminator might misinterpret the additional NUL, leading to incorrect processing.",
     "Attack vectors": [
        "The vulnerability is triggered through a crafted input string during ISO-2022-JP-3 conversion.",
        "The application using the iconv library has to call it with a specific sequence including a reset operation by providing NULL as the input buffer"
      ],
    "Required attacker capabilities": "The attacker needs to be able to provide specific input to an application using `iconv` that triggers the vulnerable code path. This includes an escape sequence to switch the character set and subsequent state reset (inbuf = NULL). The application also needs to be impacted by a spurious NUL byte.",
	"Additional Information": "The vulnerability is not exploitable through regular user input, but rather through specific programming logic, which requires a separate application bug."
  }
}
```