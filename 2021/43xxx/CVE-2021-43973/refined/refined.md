The provided content is related to CVE-2021-43973.

**Root cause of vulnerability:**
Multiple vulnerabilities in SysAid ITIL, including an unauthenticated user registration bypass, a SQL injection vulnerability, and an arbitrary file upload vulnerability, can be chained to achieve remote code execution.

**Weaknesses/vulnerabilities present:**
1. **Unauthenticated User Registration Bypass:** The `/enduserreg` endpoint allows user registration regardless of the server-side setting, allowing an attacker to create a new user account anonymously.
2. **SQL Injection:** The `getMobileList` method in `SysAidUser.java` is vulnerable to SQL injection via the `filterText` parameter in `SelectUsers.jsp`, which allows an attacker to modify user permissions, escalating privileges to `administrator`.
3. **Arbitrary File Upload:** The `UploadPsIcon.jsp` allows arbitrary file uploads, with the server returning the absolute path of the uploaded file.
4. **Arbitrary File Read/Copy:** Using the returned path from the previous step, the `UserSelfServiceSettings.jsp` page can be used to move the uploaded JSP file to the webroot.

**Impact of exploitation:**
An unauthenticated attacker can gain remote code execution on the affected server by exploiting these vulnerabilities in sequence. First, an attacker creates a user account, then uses SQL injection to gain administrator rights. As an administrator they can upload a JSP file and move it to the webroot, enabling them to execute arbitrary code by accessing the crafted JSP file.

**Attack vectors:**
The attack vector involves a series of HTTP requests to the vulnerable SysAid ITIL server. The initial requests involve registering an anonymous user, followed by SQL injection via `SelectUsers.jsp` to escalate privileges. The attacker then uses `UploadPsIcon.jsp` to upload a malicious JSP file and `UserSelfServiceSettings.jsp` to move the file to the webroot.

**Required attacker capabilities/position:**
The attacker requires network access to the vulnerable SysAid ITIL server. No prior authentication or specific privileges are required initially. The attacker must also be capable of sending crafted HTTP requests.