=== Content from appcheck-ng.com_1d2d6728_20250114_232929.html ===

[Skip to content](#content)
[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Uncategorised](https://appcheck-ng.com/category/uncategorised/)

* October 15, 2021

# WordPress + Microsoft Office 365 / Azure AD | LOGIN Persistent Cross-Site Scripting (CVE-2021-43409)

The “WPO365 | LOGIN” WordPress plugin (up to and including version 15.3) by wpo365.com is vulnerable to a persistent Cross-Site Scripting (XSS) vulnerability (also known as Stored or Second-Order XSS).

The AppCheck Research team identified a security flaw within the “WPO365 | LOGIN” WordPress plugin. The plugin has been downloaded 88,664 times at the time of writing. This blog post details the finding along with remediation advice.

## Summary

The “WPO365 | LOGIN” WordPress plugin (up to and including version 15.3) by wpo365.com is vulnerable to a persistent Cross-Site Scripting (XSS) vulnerability (also known as Stored or Second-Order XSS).

Persistent XSS vulnerabilities occur when the application stores and retrieves client supplied data without proper handling of dangerous content. This type of XSS vulnerability is exploited by submitting malicious script content to the application which is then retrieved and executed by other application users.

The attacker could exploit this to conduct a range of attacks against users of the affected application such as session hijacking, account take over and accessing sensitive data.

In this case, the XSS payload can be submitted by any anonymous user, the payload then renders and executes when a WordPress administrator authenticates and accesses the WordPress Dashboard. The injected payload can carry out actions on behalf of the administrator including adding other administrative users and changing application settings. This flaw could be exploited to ultimately provide full control of the affected system to the attacker.

You can read more about XSS here:

<https://appcheck-ng.com/cross-site-scripting/>

## Technical Analysis

The vulnerability occurs when rendering error OpenID authentication error messages within the WPO365 dashboard. The affected code path can be found in “ServicesRouter\_Service.php”

The routing component first checks that the “error” POST parameter is set before calling the “route\_openidconnect\_error” function (line 52):

```
// process openid connect error

if ( isset( $_POST[ 'error' ] ) ) {

add_action( 'init', 'WpoServicesRouter_Service::route_openidconnect_error' );

return true;

}
```

The “route\_openidconnect\_error” method is then called which reads the “error\_description” POST parameter before writing it to the internal log service without sanitisation (line 195).

```
public static function route_openidconnect_error() {

$error_string = $_POST[ 'error' ] . isset( $_POST[ 'error_description' ] ) ? $_POST[ 'error_description' ] : '';

Log_Service::write_log( 'ERROR', __METHOD__ . ' -> ' . $error_string );

Authentication_Service::goodbye( Error_Service::CHECK_LOG );

exit();
```

The following HTTP request can be sent to the target application to trigger the vulnerability:

```
POST / HTTP/1.1 Host: 192.168.88.176 Cookie: wordpress_test_cookie=WP%20Cookie%20check Content-Length: 242 Content-Type: application/x-www-form-urlencoded error=2&error_description=<img+src=a+onerror=alert(%26quot;XSS_Proof_of_Concept!%26quot;)

>&error_uri=https%3A%2F%2Flogin.microsoftonline.com%2Ferror%3Fcode%3D700054&state=https%3A%2F%2F192.168.88.176%2Fwp-login.php%3Flogin_errors%3DCHECK_LOG2
```

Accessing the WPO365 login page will then render the injected payload, in this case: alert(“XSS\_Proof\_of\_Concept!”)

### ScreenShot

![](https://appcheck-ng.com/wp-content/uploads/wp_xss-300x147.png)

## Remediation

The vendor released a security update on the same day the issue was reported to them by AppCheck. This is an incredible turnaround and AppCheck would like to thank wpo365.com and Marco van Wieren for their rapid response in resolving this issue.

Further information can be found here:

> [Change Log](https://www.wpo365.com/change-log/)

> [WordPress + Microsoft Office 365 / Azure AD | LOGIN](https://wordpress.org/plugins/wpo365-login/)

## Disclosure Timeline:

**29th September 2021:**

Reported to vendor

**29th September 2021:**

Vendor remediated the flaw and published a fix.

**13th October 2021:**

AppCheck advisory published.

#### Get started with Appcheck

No software to download or install.

Contact us or call us 0113 887 8380

[Start your free trial](#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjEzOTUiLCJ0b2dnbGUiOmZhbHNlfQ%3D%3D)

### Further Reading

* Research

* [June 28, 2023](https://appcheck-ng.com/2023/06/28/)

# [Deep Dive: Logging](https://appcheck-ng.com/deep-dive-logging/)

* Security Alerts

* [December 20, 2024](https://appcheck-ng.com/2024/12/20/)

# [Known Actively Exploited Vulnerabilities Round-up (13.12.24-19.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-13-12-24-19-12-24/)

* Security Alerts

* [December 13, 2024](https://appcheck-ng.com/2024/12/13/)

# [Known Actively Exploited Vulnerabilities Round-up (06.12.24-12.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-06-12-24-12-12-24/)

* Technical Updates

* [December 12, 2024](https://appcheck-ng.com/2024/12/12/)

# [Palo Alto Networks Monthly Security Round-up Nov-Dec 2024](https://appcheck-ng.com/palo-alto-networks-monthly-security-round-up-nov-dec-2024/)

* Security Alerts

* [December 11, 2024](https://appcheck-ng.com/2024/12/11/)

# [Microsoft Patch Tuesday – December 10th 2024](https://appcheck-ng.com/microsoft-patch-tuesday-december-10th-2024/)

* Security Alerts

* [December 6, 2024](https://appcheck-ng.com/2024/12/06/)

# [Known Actively Exploited Vulnerabilities Round-up (29.11.24-05.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-29-11-24-05-12-24/)

* Security Alerts

* [November 29, 2024](https://appcheck-ng.com/2024/11/29/)

# [Known Actively Exploited Vulnerabilities Round-up (22.11.24-28.11.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-22-11-24-28-11-24/)

![](https://appcheck-ng.com/wp-content/uploads/2024/02/Appcheck_logo_icon.svg)

## About Appcheck

AppCheck is a software security vendor based in the UK, offering a leading security scanning platform that automates the discovery of security flaws within organisations websites, applications, network and cloud infrastructure. AppCheck are authorized by te Common Vulnerabilities and Exposures (CVE) Program aas a CVE Numbering Authority (CNA)

## Put us to the test.Try AppCheck for free

No software to download or install.

Contact us or call us 0113 887 8380

Start your free trial

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/iso_badge.jpg)](https://appcheck-ng.com/wp-content/uploads/2024/11/ISO-27001-_-2013-Certificate-1.pdf)

##### Services

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/automated-penetration-testing/)

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/automated-penetration-testing/)

##### Company

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

##### Resources

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

##### Keep in touch

email

 I agree to receive information and commercial offers about AppCheck Ltd.
 Submit

AppCheck Ltd. is a company registered in England and Wales with company number 06888174

## Start your free trial

Simply complete the form and we’ll send you all you need to activate AppCheck and undertake your FREE scan.

**Your details**
Full Name

Company Name

Work Email

Telephone

Where did you hear about AppCheck?

**IP Addresses**
Please enter your IP address ranges

**URLs**
Please enter full URLs for your web applications, and both http and https where appropriate

 I have read and agreed to our [Privacy Policy](/privacy-policy/)
 I agree to receive information and commercial offers about AppCheck Ltd.

Submit

# Get in touch



=== Content from www.wpo365.com_dbb66656_20250114_232931.html ===


![](https://www.wpo365.com/wp-content/uploads/2021/07/wpo365-website-header.jpg)

[![](https://www.wpo365.com/wp-content/uploads/2024/06/www-logo-lowres.png)](https://www.wpo365.com)

* [Features](https://www.wpo365.com/features/)
* [Pricing](https://www.wpo365.com/pricing/)
  + [Bundles](https://www.wpo365.com/pricing/)
  + [Addons](https://www.wpo365.com/wordpress-addons/)
* [Resources](https://docs.wpo365.com/)
  + [Tutorials (new)](https://tutorials.wpo365.com/)
  + [Documentation](https://docs.wpo365.com/)
  + [Getting started](https://docs.wpo365.com/category/21-getting-started)
  + [Videos](https://www.youtube.com/channel/UCmcUJkBWDrwSZR1pQZdkINQ)
  + [Change Log](https://www.wpo365.com/change-log/)
  + [User Voice](https://www.wpo365.com/user-voice/)
  + [Blog](https://www.wpo365.com/all-articles/)
  + [Latest News](https://www.wpo365.com/latest-news/)
  + [Contact](https://www.wpo365.com/contact/)
* [Login](https://www.wpo365.com/your-account/)
  + [Customers](https://www.wpo365.com/your-account/)
  + [Affiliates](https://www.wpo365.com/affiliate-login/)

 Menu

* [Features](https://www.wpo365.com/features/)
* [Pricing](https://www.wpo365.com/pricing/)
  + [Bundles](https://www.wpo365.com/pricing/)
  + [Addons](https://www.wpo365.com/wordpress-addons/)
* [Resources](https://docs.wpo365.com/)
  + [Tutorials (new)](https://tutorials.wpo365.com/)
  + [Documentation](https://docs.wpo365.com/)
  + [Getting started](https://docs.wpo365.com/category/21-getting-started)
  + [Videos](https://www.youtube.com/channel/UCmcUJkBWDrwSZR1pQZdkINQ)
  + [Change Log](https://www.wpo365.com/change-log/)
  + [User Voice](https://www.wpo365.com/user-voice/)
  + [Blog](https://www.wpo365.com/all-articles/)
  + [Latest News](https://www.wpo365.com/latest-news/)
  + [Contact](https://www.wpo365.com/contact/)
* [Login](https://www.wpo365.com/your-account/)
  + [Customers](https://www.wpo365.com/your-account/)
  + [Affiliates](https://www.wpo365.com/affiliate-login/)

Search
 Search

Search
 Search

* [Features](https://www.wpo365.com/features/)
* [Pricing](https://www.wpo365.com/pricing/)
  + [Bundles](https://www.wpo365.com/pricing/)
  + [Addons](https://www.wpo365.com/wordpress-addons/)
* [Resources](https://docs.wpo365.com/)
  + [Tutorials (new)](https://tutorials.wpo365.com/)
  + [Documentation](https://docs.wpo365.com/)
  + [Getting started](https://docs.wpo365.com/category/21-getting-started)
  + [Videos](https://www.youtube.com/channel/UCmcUJkBWDrwSZR1pQZdkINQ)
  + [Change Log](https://www.wpo365.com/change-log/)
  + [User Voice](https://www.wpo365.com/user-voice/)
  + [Blog](https://www.wpo365.com/all-articles/)
  + [Latest News](https://www.wpo365.com/latest-news/)
  + [Contact](https://www.wpo365.com/contact/)
* [Login](https://www.wpo365.com/your-account/)
  + [Customers](https://www.wpo365.com/your-account/)
  + [Affiliates](https://www.wpo365.com/affiliate-login/)

 Menu

* [Features](https://www.wpo365.com/features/)
* [Pricing](https://www.wpo365.com/pricing/)
  + [Bundles](https://www.wpo365.com/pricing/)
  + [Addons](https://www.wpo365.com/wordpress-addons/)
* [Resources](https://docs.wpo365.com/)
  + [Tutorials (new)](https://tutorials.wpo365.com/)
  + [Documentation](https://docs.wpo365.com/)
  + [Getting started](https://docs.wpo365.com/category/21-getting-started)
  + [Videos](https://www.youtube.com/channel/UCmcUJkBWDrwSZR1pQZdkINQ)
  + [Change Log](https://www.wpo365.com/change-log/)
  + [User Voice](https://www.wpo365.com/user-voice/)
  + [Blog](https://www.wpo365.com/all-articles/)
  + [Latest News](https://www.wpo365.com/latest-news/)
  + [Contact](https://www.wpo365.com/contact/)
* [Login](https://www.wpo365.com/your-account/)
  + [Customers](https://www.wpo365.com/your-account/)
  + [Affiliates](https://www.wpo365.com/affiliate-login/)

# Change Log

### Latest changes

### 14th January 2024 / v34.2

* **FIX** (Composer) Dependencies have been updated to remove the requirement for PHP >= 8.0.0.

### 13th January 2024 / v34.1

* **IMPROVEMENT** You can now choose between a Microsoft 365 account or a personal Microsoft account, like Hotmail.com or Outlook.com, to send WordPress emails. See the [updated tutorial](https://tutorials.wpo365.com/courses/email-configure-microsoft-graph-mailer/lessons/send-email-from-a-personal-microsoft-account-e-g-hotmail-com/) for details. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** Plugin no longer (falsely) reports an error when enabling the auto-retry mail-send functionality fails. Instead, it generates a warning with a more verbose description. [MAIL, PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** Allowlisting domains does now correctly denies access to domains not in the list. [ROLES + ACCESS, PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** Detection of the redirect\_to parameter – for example added to the (default) login URL by other solutions – has been improved. [LOGIN]
* **FIX** The plugin now properly URL encodes a user’s UPN when checking for existing users in AAD B2C / Entra Ext. ID. [CUSTOMERS]
* **FIX** The plugin now properly URL encodes a user’s UPN when trying to submit email messages to Microsoft Graph. [LOGIN, MICROSOFT GRAPH MAILER]

### 18th December 2024 / v34.0

* **BREAKING CHANGE** Excluding a WP role from “WPO365 Audiences” (e.g. to ensure that the role in question sees all content without “WPO365 Audiences”-based restrictions) now takes the post type as an extra configuration parameter (so that – for example – a user with custom WP role “Wiki-Editor” can see all posts of custom post type “Wiki” but for all other post types configured restrictions will apply). The setting can only be changed if the version of the premium plugin providing the “WPO365 Audiences” logic is equal or higher than 34.0. Without updating the configuration, WPO365 will assume that the role-exclusion applies to all post types. Consult the [new tutorial](https://tutorials.wpo365.com/courses/ra-use-wpo365-audiences-to-restrict-gate-access-to-content/) for further details. [ROLES + ACCESS, PRO, INTEGRATE (SYNC, INTRANET)]
* **CHANGE** The PHPSECLIB v3 library has been updated to the latest version 3.0.43 and any customizations have been abandonned. [LOGIN, MICROSOFT GRAPH MAILER]
* **CHANGE** The “WPO365 Audiences” Block Editor has been withdrawn and the only option to configure “WPO365 Audiences” at page-level is the Metabox, which is now always enabled. See [updated documentation](https://tutorials.wpo365.com/courses/ra-use-wpo365-audiences-to-restrict-gate-access-to-content/lessons/removed-wpo365-audiences-gutenberg-block/) for guidance. [ROLES + ACCESS, PRO, INTEGRATE (SYNC, INTRANET)]
* **IMPROVEMENT** You can now define a splash screen image URL as part of your Power BI Embed configuration and if defined, the app will show the image when Power BI is loading, effectively providing a white label experience. See the [updated documentation](https://docs.wpo365.com/article/84-microsoft-power-bi-for-wordpress) for details. [M365 APPS, INTEGRATE (INTRANET)]
* **IMPROVEMENT** A user’s primary blog is set (to the contextual subsite) when WPO365 creates a new user when WordPress Multisite is enabled. [LOGIN]
* **IMPROVEMENT** Developers can now use the hook ‘wpo365/oidc/params’ to filter the parameters used to build the authorization URL. See the [updated documentation](https://docs.wpo365.com/article/82-developer-hooks) for details. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** The auto-retry functionality has been reworked to prevent emails from being sent twice. [MAIL, PRO, INTEGRATE (SYNC, INTEGRATE)]
* **FIX** WPO365 will no longer send an out-of-the-box “new user email notification” if a new user is created by WPO365 during WPO365 User Synchronization. [INTEGRATE (SYNC, INTRANET)]
* **FIX** Sending a test email from the “Mail” configuration page will no longer delete all cached (user) access tokens. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** The “Default role” setting is now also unlocked when the WPO365 | MAIL premium plugin is detected. [MAIL]
* **FIX** Various issues when using SharePoint Online Search to search for employees have been fixed. [M365 APPS, INTEGRATE (INTRANET)]
* **FIX** WPO365 now requires Microsoft Graph > Delegated Permissions > Calendar.Read permissions to test the configuration to embed an Exchange / Outlook calendar in WordPress (instead of Users.Read.All). [LOGIN, M365 APPS, INTEGRATE (INTRANET)]
* **FIX** When using a complex query to retrieve – for example – a user’s manager’s Display Name from Microsoft Graph as follows “::graph:manager.displayName”, WPO365 no longer incorrectly populates it with the current user’s display name if the current user does not have a manager defined. [INTEGRATE (SYNC, INTRANET)]

### 21st November 2024 / v33.3

* **FIX** After updating to WordPress 6.7 an error “Notice: Function \_load\_textdomain\_just\_in\_time was called incorrectly” would be thrown. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** A CSS “button” selector affected the global styling of button elements. [LOGIN, APPS, INTEGRATE (INTRANET)]
* **IMPROVEMENT** Developers can now filter the parameters used to build the authorization URL / token URL. [LOGIN, MICROSOFT GRAPH MAILER]

### 3rd November 2024 / v33.2

* **IMPROVEMENT** A new filter “wpo365/user/user\_login” to customize a user’s WP username has been added to allow developers to apply their custom logic. Consult the updated [online documentation](https://docs.wpo365.com/article/82-developer-hooks). [LOGIN]
* **FIX** Token expiration in Power BI has been improved and – among other things – in the instance of a “TokenExpired” client error, WPO365 will reload the window. [LOGIN]
* **FIX** WPO365 is now better able to handle a situation where multiple apps to embed various Microsoft 365 services – e.g. a SharePoint Library, a Viva Engage Feed and an Exchnage Calendar – have been placed on the same page. [APPS, INTEGRATE (INTRANET)]
* **FIX** When the calendar does not detect the start date column it will render an error message. [APPS, INTEGRATE (INTRANET)]
* **FIX** For new installations, WPO365 will audiences will automatically enable the use of metaboxes (as opposed to using a Gutenberg Block). [ROLES + ACCESS, PROFESSIONAL, INTEGRATE, CUSTOMERS (SYNC, INTRANET)]
* **FIX** The version number of the SCIM addon (plugin) has been fixed. [SCIM]
* **FIX** When a new user is created by any other solution than WPO365, the default WordPress email(s) to the user and the administrator will not be blocked. [LOGIN]
* **FIX** When a WPO365 User Synchronization Job has fisnished, it will show a green “stopped” badge to indicate success. [INTEGRATE (SYNC)]
* **FIX** Copying a shortcode to embed “Power BI” content in the free version WPO365 | LOGIN has been fixed. [LOGIN]
* **FIX** The WPO365 | DOCUMENTS Gutenberg block is now backward compatible with older configurations that do not specify the “Name” column as sortable. [DOCUMENTS, APPS, INTEGRATE (INTRANET)]

### 15th October 2024 / v33.1

* **FIX** WPO365 will now consistently redirect users (again) to their final destination URL, preventing them from being sent back to the login page. [LOGIN]
* **FIX** WPO365 now checks (again) whether the user’s final destination URL matches the scheme of the registered application’s Redirect URI in Entra and if needed corrects this. [LOGIN]

### 11th October 2024 / v33.0

* **BREAKING CHANGE** Previously users (of a WordPress Multisite / WPO365 “Shared” WPMU Mode) attempting to access a (sub) site that they are not a member of, would be denied access. Starting with this version, those users will either be **sent to their “primary” site** instead, or – if a primary site cannot be determined – to their global user dashboard URL. [LOGIN]
* **BREAKING CHANGE** Starting with version 33.0, WPO365 | LOGIN can **redirect users to Microsoft faster** (using a server-side redirect). This is generally recommended to avoid issues with server-side / external caching services. The JavaScript file “pintra-redirect.js” will therefore no longer be automatically enqueued on every page request. To mitigate the impact of this change on existing configurations, administators must manually update the WPO365 configuration and uncheck the option “Use client-side redirect” on the plugin’s “Login / Logout” configuration page, unless the WordPress site is integrated in Microsoft Teams, uses a custom “Sign in with Microsoft” login button or the administrator wishes to briefly display a “loading” icon when the user is redirected. See the [online documentation](https://docs.wpo365.com/article/223-use-client-side-redirect) for details. [LOGIN]
* **NEW FEATURE** The “Sign in with Microsoft” button that is displayed on the (default) WordPress login page can now be customized on the plugin’s “Login / Logout” configuration page. That same button can also be placed on any WordPress post or page using the **new shortcode “wpo365-sso-button”**. See the [online documentation](https://docs.wpo365.com/article/224-add-single-sign-on-button-anywhere-shortcode) for instructions. [LOGIN, ESSENTIALS, PROFESSIONAL, INTEGRATE, CUSTOMERS (LOGIN+, SYNC, INTRANET)]
* **IMPROVEMENT** WPO365 now uses built-in WordPress logic to help ensure that the URL where users are being redirected to – after they successfully signed in with Microsoft – is safe. [LOGIN]
* **FIX** Fixed an issue whereby WPO365 would require a user to sign in with Microsoft when that user attempted to access a password-protected page when the administrator enforced SSO for the default / custom login page. [ESSENTIALS, PROFESSIONAL, INTEGRATE, CUSTOMERS (LOGIN+, SYNC, INTRANET)]

### 26th September 2024 / v32.0

* **BREAKING CHANGE** This version of WPO365 adds support for WordPress’ built-in **“login\_redirect” filter**. This means that the URL where users are redirected after they successfully sign in to your WordPress website, can be set by a third-party plugin e.g. “LoginWP”. Please note that rules defined in WPO365 to redirect a user (e.g. “Welcome page for first-time users”, “Always send user to default / custom landing page” and “Azure AD group-based redirect after successful login”) will be applied after the “login\_redirect” has been applied and therefore overrule the filtered result. [LOGIN]
* **IMPROVEMENT** If an administrator activated the option to **Force SSO for the default / custom login page**, WPO365 will now redirect all requests to Microsoft for authentication, unless a unique cookie is presented. This cookie will be set by WPO365 when a user requests the default / custom landing page with the correct “Secret key to bypass SSO” added to the URL. Brute-force password-guessing bots should now be blocked from submitting login attempts to your website’s login endpoint. [ESSENTIALS, PROFESSIONAL, INTEGRATE (LOGIN+, SYNC, INTRANET)]
* **IMPROVEMENT** The built-in **license and update manager** has been greatly simplified and algined with WordPress’ plugin managent. [ALL PREMIUM]
* **FIX** WPO365’s shutdown routine will now run at the very last possible moment to ensure that the built-in Microsoft Graph Mailer can still access its configuration and send emails, e.g. third-party plugins such as “WP Job Manager” sending out alerts. [MAIL, PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** Administrators can now still change a user’s local WordPress password, even if the option “User cannot change password” (on the plugin’s “User Registration” configuration page) has been activated. [ESSENTIALS, PROFESSIONAL, INTEGRATE (LOGIN+, SYNC INTRANET)]
* **FIX** The “Plugin self-test” no longer fails when an administrator has configured multiple SAML 2.0 Identity Providers. [ALL PREMIUM]
* **FIX** WPO365 has restored the ability to save user attributes from a user’s manager e.g. the manager’s email address as WordPress metadata for the user in question. [PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** The ability to define a default sorting of a column (ascending or descending) of an embedded SharePoint Library or List has been restored. [DOCUMENTS, APPS, INTEGRATE (INTRANET)]
* **FIX** Direct reports of users listed in the Employee Directory app are filtered to ensure that disabled users are not selected. [APPS, INTEGRATE (INTRANET)]

### 6th September 2024 / v31.1

* **IMPROVEMENT** The SCIM messages sent by Entra’s User Provisioning Service are now logged and can be viewed via WP Admin > WPO365 > Dashboard > Insights > Users. See the [new tutorial step](https://tutorials.wpo365.com/courses/sync-entra-user-provisioning-scim/lessons/view-scim-messages-received-from-entra/) for details. [SCIM, INTEGRATE]
* **FIX** Undefined variable $custom\_field\_not\_found [ALL PREMIUM]

### 4th September 2024 / v31.0

* **BREAKING CHANGE** WPO365 is now able to **save user attributes from any source as WP user meta** (claims in an ID token and SAML 2.0 response, properties received from Microsoft Graph and Entra Provisioning (SCIM)) but the administrator needs to update the corresponding mappings with a prefix, or else WPO365 will not update the WP user meta record when the attribute is updated with an empty value. Refer to the [updated online documentation](https://docs.wpo365.com/article/98-synchronize-microsoft-365-azure-ad-profile-fields) for details. [CUSTOM USER FIELDS, PROFESSIONAL, INTEGRATE (LOGIN+, SYNC, INTRANET)]
* **IMPROVEMENT** WPO365 is now able to process the **SAML 2.0 groups claim** and apply all ROLES + ACCESS functionality e.g. WPO365 Audiences, restrict access, dynamically assign WordPress roles based on Entra Group Memberships. [ROLES + ACCESS, PROFESSIONAL, INTEGRATE, CUSTOMERS (SYNC, INTRANET)]
* **IMPROVEMENT** WPO365 will now also check if it needs to update a user’s WP role(s) based on user attributes it receives from Entra’s SCIM based User Provisioning Service. [ROLES + ACCESS, PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **IMPROVEMENT** An administrator can now configure WPO365 to redirect the user the website’s backend when initiating the “Sign in with Microsoft” flow. See [online documentation](https://docs.wpo365.com/article/219-use-admin-url-to-initiate-authentication) for details. [LOGIN]
* **IMPROVEMENT** Once Entra (User) Provisioning via SCIM is enabled, administrators can specify a SCIM attribute for WPO365 to use as the WordPress username for new users. [SCIM, INTEGRATE (INTRANET)]
* **IMPROVEMENT** An administrator can specify one or more IP addresses that WPO365 should bypass for authentication. [ROLES + ACCESS, SCIM, ESSENTIALS, PROFESSIONAL, CUSTOMERS, INTEGRATE (LOGIN+, SYNC, INTRANET)]
* **FIX** WPO365 will not try to retrieve a user’s Entra Group Memberships if this information has already been included in the ID token or SAML response. [ROLES + ACCESS, PROFESSIONAL, CUSTOMERS, INTEGRATE (SYNC, INTRANET)]
* **FIX** Added a “Close” button to the config-test apps when embedding a SharePoint list / library or Outlook / Exchange calendar in WordPress. [LOGIN]
* **FIX** The “Recent documents” view stopped working after column-sorting had been implemented for the apps that embed a SharePoint Library and List. [LOGIN, APPS, INTEGRATE (INTRANET)]
* **FIX** “Logout from Microsoft” is able to deal with multiple Identity Providers of different tenant types. [ALL PREMIUM]
* **FIX** Column definition for apps that embed a SharePoint Library and List now require “isSortable” (instead of “sortable”) set as true (following the documentation). [APPS, INTEGRATE (INTRANET)]
* **FIX** Features unlocked by the CUSTOMERS bundle now include ROLES + ACCESS and AVATAR. [CUSTOMERS]
* **FIX** Features unlocked by the PROFESSIONAL bundle now include AVATAR. [PROFESSIONAL]
* **FIX** Special characters – for example ö and é – in SAML claim values are no longer encoded as HTML entities (e.g. ö). [LOGIN]
* **FIX** The option to skip authentication for REST API requests when a BASIC auth header is present has been removed. Instead an administrator should add REST API’s endpoint to the “List of pages freed from authentication” on the plugin’s “Single Sign-on” page. [ESSENTIALS, LOGIN+, PROFESSIONAL, CUSTOMERS, INTEGRATE, (SYNC, INTRANET)]
* **FIX** A warning is shown when the secret key to bypass SSO contains non-alphanumeric characters. [ESSENTIALS, PROFESSIONAL, CUSTOMERS, INTEGRATE (LOGIN+, SYNC, INTRANET)]
* **FIX** WPO365 is now be able to handle a site relative URL for the redirect\_to parameter upon login. [LOGIN]

### 14th August 2024 / v30.2

* **FIX** When the SAML 2.0 certificate is invalid or expired, the plugin will now attempt to read the X.509 certificate from the “IDPSSODescriptor” XML node (provided that the administrator has entered a valid “App Metadata Federation” URL). [LOGIN]

### 28th July 2024 / v30.1

* **FIX** The login\_hint parameter for the URL created by WPO365 to send a user to Microsoft to authenticate in case of (Entra) External ID and Azure AD B2C will now be correctly set. [LOGIN]
* **FIX** A regression that caused WPO365 to send a user always to the custom error page (instead of the default one) – even if that option was not configuration – has now been fixed. [ESSENTIALS, ALL BUNDLES]

### 22nd July 2024 / v30.0

* **BREAKING CHANGE** It is now possible to configure support for **multiple Identity Providers for different tenant types** (regular Entra ID, Azure AD B2C and Entra External ID). ([read more](https://www.wpo365.com/news/breaking-change-affecting-wp-config-php-based-identity-provider-idp-configurations/)) and ([more](https://docs.wpo365.com/article/137-use-wp-config-for-aad-secrets)) [ALL PREMIUM]
* **IMPROVEMENT** A **SharePoint Library or List** that is embedded in WordPress can now be sorted beforehand or when the user clicks on the column header. [DOCUMENTS, M365 APPS, INTEGRATE (INTRANET)]
* **IMPROVEMENT** The **HelpScout beacon** on the plugin’s configuration pages would be blocked from loading – for example when using Microsoft Edge – and has therefore been replaced with a new help button that opens the WPO365 Contact Form instead. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** The new bundles **PROFESSIONAL** and **INTEGRATE** no longer cause a critical error if WPO365 | LOGIN has not been installed / activated prior to activation. [PROFESSIONAL, INTEGRATE]
* **FIX** The default value for the **Redirect URL** now again corresponds to the site’s home URL. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** Some **WP Cron** Jobs that rely on a custom cron schedule “wpo-every-minute” e.g. Auto-Retry for sending emails and User Sync Monitor to ensure user synchronization keeps running, should no longer be removed when the custom schedule is not found. [MAIL, PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** The **Mail Log Viewer** will show no results if a filter e.g. Errors returns no results. [MAIL, PROFESSIONAL, CUSTOMERS, INTEGRATE (SYNC, INTRANET)]
* **FIX** Changed the log level of a number of avatar related issues e.g. when a profile picture for a user was not found from warning to debug. [PROFESSIONAL, INTEGRATE (SYNC, INTRANET)]
* **FIX** The login-message shortcode and the login-button shortcode are now correctly initialized for the new PROFESSIONAL and INTEGRATE bundles. [PROFESSIONAL, INTEGRATE]
* **FIX** If the administrator has configured a custom error / logged-out page then WPO365 will also ensure user is redirected to that page when they sign out of WordPress using the default sign-out option(s). [PROFESSIONAL, INTEGRATE (LOGIN+, SYNC, INTRANET)]

### 28th June 2024 / v29.0

* Support for 3 new [WPO365 feature bundles](https://www.wpo365.com/news/its-not-just-a-change-its-a-leap-forward) [LOGIN+, INTRANET, SYNC].

### 21th June 2024 / v28.2

* **FIX** WPO365 will now correctly “ignore” a SAML response when the Relay State is not a properly formatted URL. [LOGIN]

### 20th June 2024 / v28.1

* **IMPROVEMENT** The Mail Audit Log Viewer has been updated to show nr. of attempts and time of last attempt for a better general understanding of the send-status of the email in question. [MAIL, CUSTOMERS, SYNC, INTRANET]
* **IMPROVEMENT** The Debug Log entries now display timestamps in the WordPress timezone (see WP Admin > Settings > General > Timezone). [LOGIN, MICROSOFT GRAPH MAILER]
* **IMPROVEMENT** The Mail Audit Log entries now display timestamps in the WordPress timezone (see WP Admin > Settings > General > Timezone). [LOGIN, MICROSOFT GRAPH MAILER]
* **IMPROVEMENT** The WPO365 Insights entries now display timestamps in the WordPress timezone (see WP Admin > Settings > General > Timezone). [LOGIN, MICROSOFT GRAPH MAILER]
* **IMPROVEMENT** A small icon on the plugin’s Mail configuration page will show the status of the “Resending failed emails automatically” feature. [MAIL, CUSTOMERS, SYNC, INTRANET]
* **IMPROVEMENT** The default WP role update scenario has been updated from “Add” to “Skip” and the plugin’s “User Registration” configuration has been update accordingly. [LOGIN]
* **IMPROVEMENT** The Microsoft Graph Mailer for WordPress will not be instantiated if no authorization information can be found. [LOGIN, MICROSOFT GRAPH MAILER]
* **IMPROVEMENT** The Mail Authorization Status Popup will now appear only after 4 seconds and will no longer show if authorization is under way. [LOGIN, MICROSOFT GRAPH MAILER]
* **IMPROVEMENT** Administrators can now also auto-enroll users into LearnDash courses and auto-assign users to LearnDash Groups based on (login) domains. [ROLES + ACCESS, SYNC, INTRANET]
* **IMPROVEMENT** Administrators can now disable SSO for WP Admin. A warning will show if this new option conflicts with other options such as “Dual Login” and “Force SSO for the login page”. [LOGIN+, CUSTOMERS, SYNC, INTRANET]
* **FIX** WordPress no longer shows that an update for a premium addon or bundle is available when the latest version is already installed. [ALL PREMIUM]
* **FIX** WPO365 now correctly replaces the WP Avatar with the user’s Entra / Microsoft 365 Profile Picture when BuddyBoss has been installed / enabled. [AVATAR, SYNC, INTRANET]
* **FIX** The self-test would fail if the administrator had enabled the Proof Key for Code Exchange. [LOGIN+, CUSTOMERS, SYNC, INTRANET]
* **FIX** The recently added Mail Audit Log Retention Policy (to clean up entries older than 90 days) no longer fails if an older version of WPO365 | MICROSOFT GRAPH MAILER or WPO365 | LOGIN would be installed in combination with the latest version of the WPO365 | MAIL addon. [MAIL, CUSTOMERS, SYNC, INTRANET]
* **FIX** WPO365 no longer tries to process an OpenID Connect response if SAML 2.0 based SSO is configured. [LOGIN]
* **FIX** The shortcode configurator to embed a SharePoint List or Library now warns if the wrong Microsoft Graph version is selected on the plugin’s “Integration” configuration page. [LOGIN, M365 APPS]
* **FIX** WPO365 User Sync will now include the low-level DB error message if an error occurs when logging the results to the database. [CUSTOMERS, SYNC, INTRANET]
* **FIX** The WPO365 configuration pages will now show the correct values for Entra ID / AAD related options retrieved from wp-config.php (instead of from the database). [ALL PREMIUM]
* **FIX** The Mail Audit Log will now create a new table at the correct “level” in case WordPress Multisite would be activated and WPO365’s default support mode for WPMU (= Shared) is configured. [MAIL, CUSTOMERS, SYNC, INTRANET]
* **FIX** WPO365 will now only attempt to retrieve a User Resource from Microsoft Graph when the administrator explicitly configured “Microsoft Graph” as the desired “Source for custom user fields” on the plugin’s “User Sync” configuration page. [LOGIN+, CUSTOMERS, SYNC, INTRANET]
* **FIX** The Redirect URI for the WPO365 Microsoft Graph Mailer no longer indicates an error for the Redirect URI migrated from “Mail Integration for Office 365 / Outlook” plugin. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** The WP Avatar no longer shows a broken picture link when the Avatar feature is enabled but WPO365 fails to retrieve the user’s profile photo from Microsoft Graph. [AVATAR, SYNC, INTRANET]

### 21st May 2024 / v28.0

* **PATCHED (CVE-2024-4706)** Validation of the script URL – used to embed Microsoft 365 services in WordPress – is now validated to ensure it points to a resource on the local WordPress server. [ALL]
* **BREAKING CHANGE** (Microsoft Graph Mailer): WPO365 [retains **mail log** entries](https://docs.wpo365.com/article/217-mail-log-retention) that are less than approximately 90 days old and deletes entries that exceed the configured number of days. [MAIL]
* **BREAKING CHANGE** (WordPress Multisite): Profile pictures for *WordPress Avatars* and downloaded from Microsoft Graph will always be saved in /wp-content/uploads/wpo365/profile-images instead of /wp-content/uploads/sites/[blog\_id]/wpo365/profile-images. [AVATAR, SYNC, INTRANET]
* **IMPROVEMENT** In an attempt to better understand errors that involve *cURL*, administrators can now enable [verbose logging for cURL](https://docs.wpo365.com/article/214-enable-curl-verbose). [ALL]
* **IMPROVEMENT** The *Allowed (login) domains* list can now be changed into a [list of domains that are not allowed to sign in](https://docs.wpo365.com/article/43-domain-whitelist). This is especially useful for administrators that allow users from any Microsoft Entra ID / AAD tenant to sign into their WordPress website. [LOGIN+, SYNC, INTRANET]
* **IMPROVEMENT** Administrators can now configure WPO365 to [add new or existing users to all subsites in a WordPress Multisite Network](https://docs.wpo365.com/article/215-always-add-all-users-to-all-wpmu-subsites) when they sign in with Microsoft or when their data is synchronized. Additionally, all existing users can be added a new subsite, when it is first initialized. [LOGIN+, SYNC, INTRANET]
* **IMPROVEMENT** A monitor (in the form of a WP Cron Job) for [WPO365 User Synchronization](https://www.wpo365.com/feature/user-synchronization/) will be started automatically (each time a new user synchronization starts) and will check every 5 minutes for unfinished synchronization jobs for which no WP Cron Job (to process the next batch of users) exists and re-create this job if needed. [SYNC, INTRANET]
* **IMPROVEMENT** If WPO365 is used to [integrate WordPress with Azure AD B2C](https://www.wpo365.com/feature/azure-ad-b2c/) and the administrator has configured WPO365 to create users in Azure AD B2C from WordPress, the status of this upstream-synchronization will now also show on a user’s profile page. [CUSTOMERS, SYNC, INTRANET]
* **IMPROVEMENT** If enabled, [WPO365 Audiences](https://www.wpo365.com/feature/audiences/) will now be shown for each post and / or page on WordPress pages, listing all posts and pages. [ROLES + ACCESS, SYNC, INTRANET]
* **IMPROVEMENT** The response – when a non-logged-in user requests a post or a page that is restricted by a WPO365 Audience – is now streamlined with the option [Response for visitors requesting a page that requires a logged-in user](https://docs.wpo365.com/article/197-post-types-that-require-a-logged-in-user). [ROLES + ACCESS, SYNC, INTRANET]
* **IMPROVEMENT** The *Admin Credential > Secret Token* that is used for [Entra ID (AAD) User provisioning (SCIM) for WordPress](https://docs.wpo365.com/article/59-wordpress-user-provisioning-with-azure-ad-scim) can now be administered on the plugin’s *User Sync* configuration page. [SCIM, INTRANET]
* **IMPROVEMENT** WPO365 now supports [Custom URL Domains for Microsoft Entra (Ext.) ID](https://learn.microsoft.com/en-us/entra/external-id/customers/how-to-custom-url-domain). [LOGIN+, SYNC, INTRANET]
* **IMPROVEMENT** If activated, WPO365 will terminate the loading of WordPress, whenever it identifies a login attempt (with local WordPress credentials) by a user whose username is not included in the [WPO\_ADMINS list](https://docs.wpo365.com/article/174-restrict-access-to-the-wpo365-configuration-pages). See the [online documentation](https://docs.wpo365.com/article/216-only-wpoadmins-can-sign-in-locally) for details. [ALL]
* **IMPROVEMENT** The title for the *Office 365 Profile Information* section on a user’s profile (only visible if the administrator enabled the option to [Show Azure AD user attributes in a WordPress user profile](https://docs.wpo365.com/article/98-synchronize-microsoft-365-azure-ad-profile-fields)) can now be translated (go to WP Admin > WPO365 > … > Translations). [CUSTOM USER FIELDS, LOGIN+, SYNC, PREMIUM]
* **IMPROVEMENT** Administrators of a WordPress Multisite installation with dedicated mode enabled (so that subsites can be configured independently of each other) can now go to the plugins *Import / Export* configuration for a subsite to replace the (empty) configuration of the subsite with a copy of the central WPO365 configuration template. See the [updated documentation](https://docs.wpo365.com/article/29-support-for-wordpress-multisite-wpmu) for details. [ALL]
* **PREVIEW** Administrators of GCCH tenants can now select this type of tenant from the list of Identity Providers, in order to change the TLD for all relevant Microsoft endpoints to “.us” (instead of “.com”). [ALL]
* **FIX** Translations for the Employee Directory app now correctly handle special characters (however, it may be necessary to recreate the shortcode). [ALL]
* **FIX** The premium WPO365 | MAIL option to resend failed emails automatically can now be started when the premium addon is used in combination with WPO365 | MICROSOFT GRAPH MAILER. [MICROSOFT GRAPH MAILER]

### 19th April 2024 / v27.2

* **IMPROVEMENT** The lis of **Optional SCIM attribute mappings** on the plugin’s **User Sync** configuration page has been *deprecated*. Administrators that have support for **SCIM based Azure AD User provisioning** enabled, are urged to migrate these mappings to the list **SCIM attribute to WordPress user meta mappings** in the section **Custom User Fields** using the corresponding **Migrate optional SCIM attribute mappings** button. [SCIM, INTRANET]
* **FIX** Some **SCIM attribute to WordPress user meta mappings** e.g. “emails[type eq “work”].value” were only processed by WPO365 internally e.g. to update a user’s WordPress profile. With this change, these attributes can now also be mapped to WordPress user meta. [SCIM, INTRANET]
* ****FIX**** An administrator now can (and should) – besides the ID token claim – also specify the corresponding AAD user property (and SCIM claim, if support for SCIM based Azure AD User provisioning has been enabled) that WPO365 should use for a **new WordPress user’s username**. This only concerns those administrators, who configured a **custom claim as the username** of a new WordPress user (on the plugin’s **User registration** configuration page). [(LOGIN+), CUSTOMERS, SCIM, SYNC, SCIM]
* **FIX** By fixing a caching issue, WPO365 should – after this update – no longer show a notification that **There is a new version of […] available […]** for WPO365 premium addons and bundles, after those were updated to the lastest version. [ALL PREMIUM ADDONS / BUNDLES]

### 10th April 2024 / v27.1

* **FIX** “**Strict Mode**” for the Redirect URI can now also be enabled for the WPO365 | MICROSOFT GRAPH MAILER plugin (so it will only try process an Oauth response / payload detected at the exact URL which must be a path below the site’s home address e.g. /oidc-auth/). [MICROSOFT GRAPH MAILER]
* **FIX** WPO365 will not try and process an Oauth response / payload if both features SSO and MICROSOFT GRAPH MAILER are disabled or if SSO is disabled but MICROSOFT GRAPH MAILER is enabled and but the administrator did not start an attempt to authorize an account to send emails from. [LOGIN, MICROSOFT GRAPH MAILER]
* **FIX** **WPO365 Health Messages** are now correctly displayed on the corresponding panel for the MICROSOFT GRAPH MAILER plugin. [MICROSOFT GRAPH MAILER]
* **FIX** A cached **Authorization Code** will now be correctly removed from that cache once it has been redeemed. [LOGIN]
* **FIX** A user’s UPN is now correctly escaped before inserting it into the WPO365 User Synchronization database table (to support UPNs with single quotes). [SYNC, INTRANET]

### 26th March 2024 / v27.0

* **BREAKING CHANGE** HTML and CSS for the default **login-button** has changed slightly and the wrapper is now a flex-box, to allow for an additional drop-down list in case the administrator configured [multiple Identity Providers](https://tutorials.wpo365.com/courses/wp-config-php-multiple-identity-providers-idps/). An administrator, however, can revert this change and configure WPO365 to use the old login-button template (see the corresponding option on the plugin’s *Miscellaneous* configuration page). [LOGIN]
* ****BREAKING CHANGE**** To support devOps workflows and site replication scenarios, WPO365 now automatically detects named constants in your website’s wp-config.php file that either configure an [single Identity Provider (IdP)](https://tutorials.wpo365.com/courses/wp-config-php-single-identity-provider-idp/) or any of the [WPO365 settings](https://tutorials.wpo365.com/courses/wp-config-php-configuration-w-o-idps/) that are not directly related to an IdP. As a result, the option **Use WP-Config.php for AAD secrets** has been renamed to [Obfuscate AAD options](https://docs.wpo365.com/article/137-use-wp-config-for-aad-secrets) and the option **Use WP-Config.php to override (some) config options** has been removed. [ANY PREMIUM ADDON / BUNDLE]
* ****BREAKING CHANGE**** LearnDash enrollment rules are now also applied to existing users (when they sign in or when users are synchronized). [ROLES + ACCESS, SYNC, INTRANET]

* **FEATURE (PREVIEW)** Administrators can now configure WPO365 to support multiple Identity Providers (IdP). If multiple IdPs have been configured, WPO365 will – by default – render a dropdown list enumerating IdPs by their “friendly name”. A user simply picks an IdP from the list before clicking “Sign in with Microsoft”. Refer to the new [tutorial](https://tutorials.wpo365.com/courses/wp-config-php-multiple-identity-providers-idps/) for further details. [ANY PREMIUM ADDON / BUNDLE]
* ******FEATURE (PREVIEW)****** Now administrators can enable **WPO365 Insights** and aggregate various events into straightforward management dashboards. These dashboards are designed to offer valuable insights, such as tracking the count of users who have authenticated successfully or unsuccessfully, monitoring emails that have been sent successfully or unsuccessfully, and overseeing the synchronization status of users, whether through SCIM, WPO365 User synchronization, or during their initial sign-in. See the new [online guide](https://www.wpo365.com/feature/wpo365-insights/) for further details. [ALL]
* ****FEATURE (PREVIEW)**** Administrators can now add **app roles** to an *App registration* in *Microsoft Entra Admin Center* and use them to dynamically assign WordPress roles to users. See the [online documentation](https://www.wpo365.com/feature/roles-access/) for further details. [ROLES + ACCESS, SYNC, INTRANET]
* ****FEATURE (PREVIEW)**** WPO365 now also supports the SAML 2.0 protocol for use with Azure AD’s **multi-tenancy feature**. See the [online documentation](https://docs.wpo365.com/article/211-support-for-multitenant-apps-saml-2-0) for further details. [LOGIN+, SYNC, INTRANET]

* **IMPROVEMENT** WPO365 can now be configured to skip saving the default WP **avatar** for a user without a profile picture. See the [online documentation](https://docs.wpo365.com/article/212-do-not-save-default-wp-avatar) for further details. [AVATAR, SYNC, INTRANET]
* **IMPROVEMENT** An administrator can now choose between the WordPress site URL or the WP Admin URL as the **default landing page** after a user successfully signed in with Microsoft. Alternatively, a custom URL can be defined when the LOGIN+ addon, or the SYNC or INTRANET is detected. [LOGIN, LOGIN+, SYNC, INTRANET]
* **IMPROVEMENT** When a SAML 2.0 **X509 certificate** is missing from the configuration, is expired or has been withdrawn, WPO365 will try and read the tenant’s federation metadata to obtain (and cache) a new signing key. [LOGIN]
* **IMPROVEMENT** **WPO365 Health Messages** will no longer be displayed on a default WordPress notification banner, but instead a dismissable panel will slide over the configuration app. [LOGIN]
* **IMPROVEMENT** After running the **Plugin self-test** for SAML 2.0 based SSO, the raw SAML response can now be viewed by clicking the corresponding link for the “SAML response has been processed and no errors occurred” test case. [LOGIN]
* **IMPROVEMENT** Generated **passwords** are checked to ensure that the generated password has characters from all four possible categories (lower and upper case, numbers and symbols). [LOGIN]
* **IMPROVEMENT** When deleting a WPO365 configuration, several caches e.g. for access tokens and certificates, are cleaned as well. [LOGIN]
* **IMPROVEMENT** WPO365 will now update BuddyPress profile fields (provided that this option is enabled) whenever Azure AD Provisioning (SCIM) sends new / updated user attributes. [SCIM, INTRANET]

* **FIX** **Audiences** now work correctly if a user is a member of one Audience but not of all when more than one Audience has been added to a page. [ROLES + ACCESS, SYNC, INTRANET]
* **FIX** **User synchronization** of users with an apostrophe in their username now no longer generates an error when being logged into the database table. [SYNC, INTRANET]
* **FIX** **Auth.-Only** scenarios are now compatible with the **Audiences** feature to make a page private (restricting access exclusively to users who are authenticated). [ROLES + ACCESS, SYNC, INTRANET]
* **FIX** WPO365 will not send the user into an infinite loop anymore, if the administrator has enabled “strict mode” for the Redirect URI plus checked the option to use wp-config.php for AAD secrets. [ALL PREMIUM]
* **FIX** WPO365 now checks for before “Trying to create a duplicate log entry” during user synchronization and will update the existing log record instead. [SYNC, INTRANET]

### 17th January 2024 / v26.0

* **Feature** Embed an Outlook / Exchange Calendar in WordPress. See [online documentation](https://www.wpo365.com/feature/outlook-exchange-calendar/) for details. [LOGIN, APPS, INTRANET]
* **Feature** Embed a SharePoint Online List in WordPress. See [online documentation](https://www.wpo365.com/feature/sharepoint-list/) for details. [LOGIN, APPS, INTRANET]
* **Fix** The plugin attempted to process any POST request with parameter “error”, mistakenly assuming that it would be an authentication-error sent by Microsoft. [LOGIN, MICROSOFT GRAPH MAILER]
* Version bumped. [ALL]

### 18th December 2023 / v25.4

* **Improvement** WPO365 can now also **auto-assign WordPress roles** to users based on claims found in the SAML 2.0 response. [ROLES + ACCESS, SYNC, INTRANET]
* **Fix** The plugin will always choose the form\_post OIDC Response mode if the administrator has configured the **Hybrid User Flow** for OpenID Connect. [LOGIN]

### 15th December 2023 / v25.3

* **Fix** Updated parts of the PHP Security Library v3 to improve compatibility with older PHP versions. [LOGIN, MICROSOFT GRAPH MAILER]
* **Fix** Reverted default OIDC response mode back to form\_post, to support the Hybrid Flow. Administrators can instead manually select “query”. [LOGIN]

### 13th December 2023 / v25.2

* **Fix** Fixed “Fatal error: Cannot use ::class with dynamic class name” for 2 files in PHP Security Library v3. [LOGIN, MICROSOFT GRAPH MAILER]

### 13th December 2023 / v25.1

* **Improvement** The default response mode – for new installations – when requesting an (OIDC) authorization code has been updated to **query**. This will help preserve the code, especially if the administrator has configured a 3rd party multi-factor authentication provider such as Duo. Existing installations are not affected, however, and the response mode remains “form\_post”. See the [updated documentation](https://docs.wpo365.com/article/208-select-oidc-response-mode) for details. [LOGIN]
* **Improvement** Admins configuring the Microsoft Graph Mailer portion of WPO365 can now select an option to skip all checks. Checking this option instructs the Microsoft Graph Mailer to skip the check whether the default “from” email address is registered for the corresponding account and whether the “from” email address specified by a plugin has a different email-domain compared to the default “from” email address used to submit email message to Microsoft Graph. [LOGIN, MAIL, SYNC, INTRANET]
* **Fix** When enrolling users onto LearnDash courses, WPO365 now first checks if the user is already enrolled. [ROLES + ACCESS, SYNC, INTRANET]
* **Fix** When clicking the clear-button in the search box – for the embedded SharePoint Online Search experience for WordPress – the search results will be cleared. [LOGIN, M365 APPS, INTRANET]
* **Fix** The option to replace the default WordPress “register” link with a link that redirects to the Azure AD B2C sign-up experience is now always available (but remains a premium option). [LOGIN+, CUSTOMERS, SYNC, INTRANET]
* **Fix** WPO365 User synchronization no longer produces warnings if a user is not an Azure AD user (based on a domain-check that has become optional since v21.0). [SYNC, INTRANET]
* **Fix** The plugin self-test now detects the recently introduced new INTRANET | 5Y and SYNC | 5Y plugins and will test all possible premium scenarios. [INTRANET | 5Y, SYNC | 5Y]
* **Fix** The PHP Secure Communications library has been updated and the plugin now uses version 3.0 (to verify an ID token’s signature). [LOGIN, MICROSOFT GRAPH MAILER]
* Version bumped. [ALL]

### 10th November 2023 / v25.0

* **Breaking Change** Sending WordPress email using Microsoft Graph now always will use the Azure AD configuration from the plugin’s Mail configuration page. [LOGIN]
* **Feature** SAML 2.0 based single sign-on can now be configured by generating / exporting Service Provider metadata that can be imported in Azure Active Directory whilst importing the Identity Provider metadata from Azure Active Directory in WPO365. See the [updated documentation](https://docs.wpo365.com/article/100-single-sign-on-with-saml-2-0-for-wordpress) for details. [LOGIN]
* **Improvement** Administrators that have enabled support for multi-tenancy, can now allow-list tenants, effectively restricting access to users of tenants that are not allow-listed. See the [updated documentation](https://docs.wpo365.com/article/205-allowed-other-tenants) for details. [LOGIN+, CUSTOMERS, SYNC, INTRANET]
* **Improvement** SAML 2.0 will now always – by default – set the requestedAuthnContext to false and it’s no longer necessary to define a global variable in the WordPress site’s wp-config.php. Administrators who did add this variable can now safely remove it. On the other hand, administrators can still explicitely request that the authentication context is checked by enabling the corresponding option on the plugin’s Single Sign-on configuration page. [LOGIN]
* **Improvement** Administrators can now configure “strict” mode for OpenID Connect. Doing so, will force WPO365 to only “listen” for users returning from Microsoft at the configured Redirect URI. See the [online docuemntation](https://docs.wpo365.com/article/204-enable-strict-mode-for-redirect-uri) for details. [LOGIN]
* Tested up to 6.4. [ALL]

Click here for [older entries](https://www.wpo365.com/change-log-archive/).

### 120+

5 Star Reviews

### 20K

Installations

### 400K+

Downloads

# Latest Articles

### [Latest News](https://www.wpo365.com/latest-news/)

### [Send WP emails from a personal Microsoft account](https://www.wpo365.com/news/send-wp-emails-from-a-personal-microsoft-account/)

WPO365’s Mailer for Microsoft Graph has been updated and now lets you send WordPress emails from a personal Microsoft account [...]

### [WPBeginner verified](https://www.wpo365.com/news/wpbeginner-verified/)

I’m excited to share that WPBeginner has included WPO365 in their Premium WordPress Solutions center. WPBeginner is a highly trusted [...]

[View all Latest News](https://www.wpo365.com/latest-news/)

### [Blog](https://www.wpo365.com/all-articles/)

### [Customize your login button](https://www.wpo365.com/article/customize-your-login-button/)

The “Sign in with Microsoft” login button that is displayed on the (default) WordPress login page can now be customized [...]

### [Client secret expiration notification](https://www.wpo365.com/article/client-secret-expiration-notification/)

With its latest version, WPO365 can help monitor the expiration date(s) of AAD application / client secrets. This is important, [...]

[View all Articles](https://www.wpo365.com/all-articles/)

![](https://www.wpo365.com/wp-content/uploads/2023/05/website-icon-512.png)

# Get your integration project started today!

[Get started with LOGIN](https://www.wpo365.com/downloads/wordpress-office-365-login/)

[Get started with EMAIL](https://www.wpo365.com/downloads/wpo365-ms-graph-mailer/)

Resources

* [Tutorials (new)](https://tutorials.wpo365.com/)
* [Documentation](https://docs.wpo365.com/)
* [Getting Started](https://docs.wpo365.com/category/21-getting-started)
* [Blog](https://www.wpo365.com/all-articles/)
* [User Voice](https://www.wpo365.com/user-voice/)
* [Latest News](https://www.wpo365.com/latest-news/)
* [Change Log](https://www.wpo365.com/change-log/)
* [Contact](https://www.wpo365.com/contact/)

* [Tutorials (new)](https://tutorials.wpo365.com/)
* [Documentation](https://docs.wpo365.com/)
* [Getting Started](https://docs.wpo365.com/category/21-getting-started)
* [Blog](https://www.wpo365.com/all-articles/)
* [User Voice](https://www.wpo365.com/user-voice/)
* [Latest News](https://www.wpo365.com/latest-news/)
* [Change Log](https://www.wpo365.com/change-log/)
* [Contact](https://www.wpo365.com/contact/)

About

WPO365.com is a **Downloads by van Wieren** project and initiated by [Marco van Wieren](https://www.linkedin.com/in/marco-van-wieren/). The company is based in Zurich, Switzerland and registered under CHE-195.435.638.

Affiliate Program

Refer customers and earn money with the [WPO365 Affiliate Program](https://www.wpo365.com/affiliates/).


