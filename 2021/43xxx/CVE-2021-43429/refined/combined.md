=== Content from github.com_f8aacc33_20250115_090343.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fissues%2F1037)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fissues%2F1037)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Seagate%2Fcortx-s3server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jun 26, 2023. It is now read-only.

[Seagate](/Seagate)
/
**[cortx-s3server](/Seagate/cortx-s3server)**
Public archive

* [Notifications](/login?return_to=%2FSeagate%2Fcortx-s3server) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2FSeagate%2Fcortx-s3server)
* [Star
   37](/login?return_to=%2FSeagate%2Fcortx-s3server)

* [Code](/Seagate/cortx-s3server)
* [Issues
  4](/Seagate/cortx-s3server/issues)
* [Pull requests
  23](/Seagate/cortx-s3server/pulls)
* [Discussions](/Seagate/cortx-s3server/discussions)
* [Actions](/Seagate/cortx-s3server/actions)
* [Projects
  0](/Seagate/cortx-s3server/projects)
* [Wiki](/Seagate/cortx-s3server/wiki)
* [Security](/Seagate/cortx-s3server/security)
* [Insights](/Seagate/cortx-s3server/pulse)

Additional navigation options

* [Code](/Seagate/cortx-s3server)
* [Issues](/Seagate/cortx-s3server/issues)
* [Pull requests](/Seagate/cortx-s3server/pulls)
* [Discussions](/Seagate/cortx-s3server/discussions)
* [Actions](/Seagate/cortx-s3server/actions)
* [Projects](/Seagate/cortx-s3server/projects)
* [Wiki](/Seagate/cortx-s3server/wiki)
* [Security](/Seagate/cortx-s3server/security)
* [Insights](/Seagate/cortx-s3server/pulse)

# Potential error due to the unreleased lock #1037

Closed

[anson-lo](/anson-lo) opened this issue
Jul 18, 2021
Â· 28 comments

Closed

# [Potential error due to the unreleased lock](#top) #1037

[anson-lo](/anson-lo) opened this issue
Jul 18, 2021
Â· 28 comments

Assignees
[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&v=4)](/nileshgovande) [![@bkirunge7](https://avatars.githubusercontent.com/u/64120272?s=40&v=4)](/bkirunge7)

Labels
[bug](/Seagate/cortx-s3server/labels/bug)
Something isn't working
[needs-triage](/Seagate/cortx-s3server/labels/needs-triage)

## Comments

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

### **[anson-lo](/anson-lo)** commented [Jul 18, 2021](#issue-946980786)

| Dear developers: Thank you for your checking. In the method `mempool_destroy`, the lock `&pool->lock` may be not released if the branch condition satisfies and the method returns.     [cortx-s3server/mempool/s3\_memory\_pool.c](https://github.com/Seagate/cortx-s3server/blob/d684426013aecda8b21d59e2fcc09073730f3fd2/mempool/s3_memory_pool.c#L539)  Line 539 in [d684426](/Seagate/cortx-s3server/commit/d684426013aecda8b21d59e2fcc09073730f3fd2)   |  | pthread\_mutex\_lock(&pool->lock); | | --- | --- |      [cortx-s3server/mempool/s3\_memory\_pool.c](https://github.com/Seagate/cortx-s3server/blob/d684426013aecda8b21d59e2fcc09073730f3fd2/mempool/s3_memory_pool.c#L543)  Line 543 in [d684426](/Seagate/cortx-s3server/commit/d684426013aecda8b21d59e2fcc09073730f3fd2)   |  | return S3\_MEMPOOL\_INVALID\_ARG; | | --- | --- |      ``` int mempool_destroy(MemoryPoolHandle *handle) {   struct mempool *pool = NULL;   struct memory_pool_element *pool_item;   char *log_msg_fmt = "mempool(%p): free(%p) called for buffer size(%zu)";   char log_msg[200];    if (handle == NULL) {     return S3_MEMPOOL_INVALID_ARG;   }    pool = (struct mempool *)*handle;   if (pool == NULL) {     return S3_MEMPOOL_INVALID_ARG;   }    if ((pool->flags & ENABLE_LOCKING) != 0) {     pthread_mutex_lock(&pool->lock); // the lock   }    if (*handle == NULL) {     return S3_MEMPOOL_INVALID_ARG;  //return without releasing   }    ...; }  ```  Best, |
| --- | --- | --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@welcome](https://avatars.githubusercontent.com/in/4141?s=80&v=4)](/apps/welcome)

Copy link

### **[welcome](/apps/welcome) bot** commented [Jul 18, 2021](#issuecomment-882019038)

| Thanks for opening this issue. A contributor should be by to give feedback soon. In the meantime, please check out the [contributing guidelines](https://github.com/Seagate/cortx/blob/main/CONTRIBUTING.md) and explore other [ways you can get involved](https://github.com/Seagate/cortx/). |
| --- |

All reactions

Sorry, something went wrong.

[![@cortx-admin](https://avatars.githubusercontent.com/u/68642722?s=40&u=ec736f7022ff00c8982749d456975351126d67c3&v=4)](/cortx-admin)
[cortx-admin](/cortx-admin)
added
the
[needs-triage](/Seagate/cortx-s3server/labels/needs-triage)
label
[Jul 18, 2021](#event-5034795393)

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=40&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)
[johnbent](/johnbent)
assigned [nileshgovande](/nileshgovande) and [bkirunge7](/bkirunge7)
[Jul 19, 2021](#event-5039102045)

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=80&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)

Copy link

Contributor

### **[johnbent](/johnbent)** commented [Jul 19, 2021](#issuecomment-882630132)

| Thanks [@anson-lo](https://github.com/anson-lo) ! Â Just curious: how did you find this by the way? Â Just reading the code or you did some automated analysis? |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=80&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)

Copy link

Contributor

### **[nileshgovande](/nileshgovande)** commented [Jul 20, 2021](#issuecomment-883037677)

| Thanks [@anson-lo](https://github.com/anson-lo) . You're right, this looks like a bug. Would you like to submit the patch yourself? Let us know and that'd be awesome. Otherwise, we can fix it. Thanks for catching this and reporting |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Jul 20, 2021](#issuecomment-883044678)

| [@johnbent](https://github.com/johnbent) It is reported by a static code scanner. [@nileshgovande](https://github.com/nileshgovande) I am happy to pull a request. Would be done soon. |
| --- |

 ðŸ‘
1
 mukul-seagate11 reacted with thumbs up emoji

All reactions

* ðŸ‘
  1 reaction

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=80&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)

Copy link

Contributor

### **[nileshgovande](/nileshgovande)** commented [Jul 20, 2021](#issuecomment-883133059)

| Thanks, [@anson-lo](https://github.com/anson-lo) Which static code scanner? |
| --- |

All reactions

Sorry, something went wrong.

[![@mukul-seagate11](https://avatars.githubusercontent.com/u/65269273?s=40&v=4)](/mukul-seagate11)
[mukul-seagate11](/mukul-seagate11)
added
the
[bug](/Seagate/cortx-s3server/labels/bug)
Something isn't working
label
[Jul 20, 2021](#event-5042583663)

[![@mukul-seagate11](https://avatars.githubusercontent.com/u/65269273?s=80&v=4)](/mukul-seagate11)

Copy link

Contributor

### **[mukul-seagate11](/mukul-seagate11)** commented [Jul 20, 2021](#issuecomment-883186298)

| Thanks, [@anson-lo](https://github.com/anson-lo) Which static code scanner?  Nilesh, Its reported in Codacy |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Jul 20, 2021](#issuecomment-883289512)

| [@nileshgovande](https://github.com/nileshgovande) We use [Pinpoint,](https://qingkaishi.github.io/public_pdfs/PLDI2018.pdf) a static analysis tool similar to Codacy. |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=80&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)

Copy link

Contributor

### **[nileshgovande](/nileshgovande)** commented [Jul 21, 2021](#issuecomment-883854326) â€¢ edited Loading

| No [@mukul-seagate11](https://github.com/mukul-seagate11) - its not CC [@johnbent](https://github.com/johnbent) [@bkirunge7](https://github.com/bkirunge7)  We will check on Pinpoint [@anson-lo](https://github.com/anson-lo) |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=80&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)

Copy link

Contributor

### **[nileshgovande](/nileshgovande)** commented [Jul 21, 2021](#issuecomment-883883493)

| PR - [#1041](https://github.com/Seagate/cortx-s3server/pull/1041) |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=80&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)

Copy link

Contributor

### **[nileshgovande](/nileshgovande)** commented [Jul 21, 2021](#issuecomment-883884592)

| Changes merged to main |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)
[nileshgovande](/nileshgovande)
closed this as [completed](/Seagate/cortx-s3server/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 21, 2021](#event-5047992240)

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Oct 15, 2021](#issuecomment-944387062)

| [@nileshgovande](https://github.com/nileshgovande) Hi, would this bug cause any security issues like deadlock due to acquiring the same lock? |
| --- |

All reactions

Sorry, something went wrong.

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=80&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)

Copy link

Contributor

### **[johnbent](/johnbent)** commented [Oct 15, 2021](#issuecomment-944402878)

| FYI [@swanand-gadre](https://github.com/swanand-gadre) . This is an interesting issue where a community member used a different static analysis tool and found an issue in our S3 code. Just something you might be interested in. |
| --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Oct 16, 2021](#issuecomment-944851036)

| Thanks [@johnbent](https://github.com/johnbent) for looping me in.  Similar condition is described as a weakness here -> <https://cwe.mitre.org/data/definitions/401.html>  Since memory lock is not released in specific condition, It leads to not sufficiently tracking and releasing allocated memory after it has been used, which slowly consumes remaining memory.  It impacts availability (reduced performance, article also mention, potential DoS attack).  Hi [@nileshgovande](https://github.com/nileshgovande)  I see that the specific condition is now fixed with pool->lock released with pthread\_mutex\_unlock(&pool->lock); Also code to reset \*handle and free items in the free list does clean-up.  However do we need to also add a similar code, in  if (handle == NULL) { return S3\_MEMPOOL\_INVALID\_ARG; }  Or will it not have pool-lock if handle is NULL ?  Regards Swanand |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Oct 16, 2021](#issuecomment-944852369)

| Could we apply CVE ID for this issue? (Similar to [CVE-2014-3657](https://github.com/advisories/GHSA-543q-9rm2-x5f3 "CVE-2014-3657"), [CVE-2015-8340](https://github.com/advisories/GHSA-m46m-c4vg-mwcw "CVE-2015-8340"),[CVE-2020-12771](https://github.com/advisories/GHSA-x72c-34x9-qrm4 "CVE-2020-12771")). Thanks so much. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=80&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)

Copy link

Contributor

### **[johnbent](/johnbent)** commented [Oct 19, 2021](#issuecomment-947130004)

| Hey [@swanand-gadre](https://github.com/swanand-gadre) , do you have an answer for [@anson-lo](https://github.com/anson-lo) ? |
| --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Oct 20, 2021](#issuecomment-947582670)

| Hi [@anson-lo](https://github.com/anson-lo)  Thank you for your interest,  Is there any POC or end user scenario available, where this condition is hit and shows evidence of impact? |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Oct 22, 2021](#issuecomment-949316050)

| Unfortunately, I don't have PoC or find it via concretely triggering this bug. I just manually examined the security impacts of this bug. I see many CVE IDs assigned without POC. This's fine if you think it's not worth it. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=80&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)

Copy link

Contributor

### **[johnbent](/johnbent)** commented [Oct 22, 2021](#issuecomment-949723572)

| [@anson-lo](https://github.com/anson-lo) , those other CVE IDs that you see are automatically created by the Whitesource bot. It would be really cool if your tool is finding vulnerabilities that Whitesource is missing! |
| --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Oct 28, 2021](#issuecomment-953640894)

| Hi [@anson-lo](https://github.com/anson-lo)  To further investigate, I went thru following linkes to check the details required to create CVE  <https://www.kb.cert.org/vuls/report/>  Along with some other details, it asks for  How does an attacker exploit this vulnerability? (Explain access or other conditions necessary to attack.) What does an attacker gain by exploiting this vulnerability? (i.e. what is the impact?)  Also I wanted to check about the tool you mentioned you are using  Perhaps we can quickly connect so that I can understand the work you are doing?  Let me know.  Regards Swanand |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Oct 28, 2021](#issuecomment-953674127)

| [@swanand-gadre](https://github.com/swanand-gadre) Thanks so much!  **How does an attacker exploit this vulnerability?** This is my understanding after eyeballing the code for a while. In the `mempool_destroy`, the lock `pool->lock` is not released correctly when `*handle == NULL` and the function `mempool_destroy` returns `S3_MEMPOOL_INVALID_ARG`. When `mempool_create_with_shared_mem` that invokes `mempool_destroy` is called multiple times, it could lead to reacquiring the same lock `pool->lock`. Apologies for being unfamiliar with the code, this is my initial analysis, which could be refined further.  **What does an attacker gain by exploiting this vulnerability?** This could lead to deadlock, wreaking a denial-of-the-service due to the reacquiring the same lock.  **The tool I am working** This is a (academic purpose) static analysis tool that consists of pointer analysis, lock analysis, reachability analysis, etc. The tool is similar to [SVF](https://github.com/SVF-tools/SVF). |
| --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Nov 1, 2021](#issuecomment-956030456)

| Hi [@anson-lo](https://github.com/anson-lo)  Does the same fix applies to  if (handle == NULL) { return S3\_MEMPOOL\_INVALID\_ARG; }  Do you want to try raising it with <https://cve.mitre.org/cve/request_id.html>  Regards Swanand |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Nov 1, 2021](#issuecomment-956037469)

| [@swanand-gadre](https://github.com/swanand-gadre) Hi, it seems the individuals are more difficult to request this without assistance from developers. I tried before but got no reply. Could you please raise it? |
| --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Nov 2, 2021](#issuecomment-957100051)

| Hi [@anson-lo](https://github.com/anson-lo)  In my opinion, since your tool uncovered it, it is appropriate you raise request for CVE ID. Typically, committee would reach out to the products, in case of doubts/queries.  However requesting you to take initial step.  Also I wanted to know your feedback, if , the same fix applies to?  if (handle == NULL) { return S3\_MEMPOOL\_INVALID\_ARG; }  Regards Swanand |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Nov 2, 2021](#issuecomment-957124166)

| [@swanand-gadre](https://github.com/swanand-gadre) Thanks, I would take an initial step.     [cortx-s3server/mempool/s3\_memory\_pool.c](https://github.com/Seagate/cortx-s3server/blob/d684426013aecda8b21d59e2fcc09073730f3fd2/mempool/s3_memory_pool.c#L529-L540)  Lines 529 to 540 in [d684426](/Seagate/cortx-s3server/commit/d684426013aecda8b21d59e2fcc09073730f3fd2)   |  | if (handle == NULL) { | | --- | --- | |  | return S3\_MEMPOOL\_INVALID\_ARG; | |  | } | |  |  | |  | pool = (struct mempool \*)\*handle; | |  | if (pool == NULL) { | |  | return S3\_MEMPOOL\_INVALID\_ARG; | |  | } | |  |  | |  | if ((pool->flags & ENABLE\_LOCKING) != 0) { | |  | pthread\_mutex\_lock(&pool->lock); | |  | } |      From my view, applying to `handle==NULL` is not necessary, since the lock `pool->lock` is acquired later. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=80&v=4)](/swanand-gadre)

Copy link

Contributor

### **[swanand-gadre](/swanand-gadre)** commented [Nov 9, 2021](#issuecomment-963898650)

| Hi [@anson-lo](https://github.com/anson-lo)  Any further updates ?  Regards Swanand |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Nov 10, 2021](#issuecomment-964735104)

| [@swanand-gadre](https://github.com/swanand-gadre) Hi, I have submitted my CVE application form but haven't received any notifications so far. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=80&u=52a058e919f62f3af90ebe0bb46c5dce260bcc5c&v=4)](/johnbent)

Copy link

Contributor

### **[johnbent](/johnbent)** commented [Nov 11, 2021](#issuecomment-966015453)

| [@anson-lo](https://github.com/anson-lo) , by the way, this has been fixed now in the code. So should we still file for the CVE? |
| --- |

All reactions

Sorry, something went wrong.

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=80&v=4)](/anson-lo)

Copy link

Contributor

Author

### **[anson-lo](/anson-lo)** commented [Nov 17, 2021](#issuecomment-971209741)

| OK, thanks for your time and help |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fissues%2F1037).

Assignees

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&v=4)](/nileshgovande) [nileshgovande](/nileshgovande)

[![@bkirunge7](https://avatars.githubusercontent.com/u/64120272?s=40&v=4)](/bkirunge7) [bkirunge7](/bkirunge7)

Labels

[bug](/Seagate/cortx-s3server/labels/bug)
Something isn't working
[needs-triage](/Seagate/cortx-s3server/labels/needs-triage)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

7 participants

[![@johnbent](https://avatars.githubusercontent.com/u/2047294?s=52&v=4)](/johnbent) [![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=52&v=4)](/nileshgovande) [![@bkirunge7](https://avatars.githubusercontent.com/u/64120272?s=52&v=4)](/bkirunge7) [![@mukul-seagate11](https://avatars.githubusercontent.com/u/65269273?s=52&v=4)](/mukul-seagate11) [![@cortx-admin](https://avatars.githubusercontent.com/u/68642722?s=52&v=4)](/cortx-admin) [![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=52&v=4)](/anson-lo) [![@swanand-gadre](https://avatars.githubusercontent.com/u/91461608?s=52&v=4)](/swanand-gadre)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_366ec0b8_20250115_090345.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fpull%2F1041)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fpull%2F1041)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Seagate%2Fcortx-s3server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jun 26, 2023. It is now read-only.

[Seagate](/Seagate)
/
**[cortx-s3server](/Seagate/cortx-s3server)**
Public archive

* [Notifications](/login?return_to=%2FSeagate%2Fcortx-s3server) You must be signed in to change notification settings
* [Fork
  87](/login?return_to=%2FSeagate%2Fcortx-s3server)
* [Star
   37](/login?return_to=%2FSeagate%2Fcortx-s3server)

* [Code](/Seagate/cortx-s3server)
* [Issues
  4](/Seagate/cortx-s3server/issues)
* [Pull requests
  23](/Seagate/cortx-s3server/pulls)
* [Discussions](/Seagate/cortx-s3server/discussions)
* [Actions](/Seagate/cortx-s3server/actions)
* [Projects
  0](/Seagate/cortx-s3server/projects)
* [Wiki](/Seagate/cortx-s3server/wiki)
* [Security](/Seagate/cortx-s3server/security)
* [Insights](/Seagate/cortx-s3server/pulse)

Additional navigation options

* [Code](/Seagate/cortx-s3server)
* [Issues](/Seagate/cortx-s3server/issues)
* [Pull requests](/Seagate/cortx-s3server/pulls)
* [Discussions](/Seagate/cortx-s3server/discussions)
* [Actions](/Seagate/cortx-s3server/actions)
* [Projects](/Seagate/cortx-s3server/projects)
* [Wiki](/Seagate/cortx-s3server/wiki)
* [Security](/Seagate/cortx-s3server/security)
* [Insights](/Seagate/cortx-s3server/pulse)

# avoid the unrelesed lock after the method returns for issue#1037 #1041

 Merged

[nileshgovande](/nileshgovande)
merged 2 commits into
[Seagate:main](/Seagate/cortx-s3server/tree/main "Seagate/cortx-s3server:main")
from
anson-lo:main

Jul 21, 2021

 Merged

# [avoid the unrelesed lock after the method returns for issue#1037](#top) #1041

[nileshgovande](/nileshgovande)
merged 2 commits into
[Seagate:main](/Seagate/cortx-s3server/tree/main "Seagate/cortx-s3server:main")
from
anson-lo:main

Jul 21, 2021

[Conversation
4](/Seagate/cortx-s3server/pull/1041)
[Commits
2](/Seagate/cortx-s3server/pull/1041/commits)
[Checks
0](/Seagate/cortx-s3server/pull/1041/checks)
[Files changed](/Seagate/cortx-s3server/pull/1041/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![anson-lo](https://avatars.githubusercontent.com/u/83398016?s=60&v=4)](/anson-lo)

Copy link

Contributor

### @anson-lo **[anson-lo](/anson-lo)** commented [Jul 20, 2021](#issue-948243402)

Update s3\_memory\_pool.c. Avoid the unreleased lock pool->lock after the method returns. This patch for issue#1037.

Sorry, something went wrong.

All reactions

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=40&v=4)](/anson-lo)

`[avoid the unrelesed lock after the method returns](/Seagate/cortx-s3server/pull/1041/commits/23882c427837ee988a60201c5d09a5e91e19b2d7 "avoid the unrelesed lock after the method returns

Update s3_memory_pool.c. Avoid the unreleased lock pool->lock after the method returns.")`
 â€¦

`[23882c4](/Seagate/cortx-s3server/pull/1041/commits/23882c427837ee988a60201c5d09a5e91e19b2d7)`

```
Update s3_memory_pool.c. Avoid the unreleased lock pool->lock after the method returns.
```

 [![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=40&v=4)](/anson-lo)
[anson-lo](/anson-lo)
requested review from
[bkirunge7](/bkirunge7),
[knrajnambiar76](/knrajnambiar76),
[nileshgovande](/nileshgovande) and
[t7ko-seagate](/t7ko-seagate)
as [code owners](/Seagate/cortx-s3server/blob/68fca198c579b7d2901a2416d796653b069bd38d/CODEOWNERS#L5)
[July 20, 2021 04:41](#event-5041940399)

[![@cla-bot](https://avatars.githubusercontent.com/in/2404?s=80&v=4)](/apps/cla-bot)

Copy link

### **[cla-bot](/apps/cla-bot) bot** commented [Jul 20, 2021](#issuecomment-883047351)

| Thanks for your contribution! The CLA bot has flagged your contribution as not having a Contributor License Agreement in place. Note that this is not needed in the overwhelming majority of instances and this warning will usually be ignored. The code reviewers will make a determination and may ask you to sign a CLA or may choose to ignore this warning. More information about this can be found [here](https://github.com/Seagate/cortx/blob/master/doc/dco_cla.md). |
| --- |

All reactions

Sorry, something went wrong.

[![@cortx-admin](https://avatars.githubusercontent.com/u/68642722?s=80&u=ec736f7022ff00c8982749d456975351126d67c3&v=4)](/cortx-admin)

Copy link

### **[cortx-admin](/cortx-admin)** commented [Jul 20, 2021](#issuecomment-883048741)

| Can one of the admins verify this patch? |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&v=4)](/nileshgovande)

`[Merge branch 'main' into main](/Seagate/cortx-s3server/pull/1041/commits/ed8b483a2164b81e53ee64a10e8de75770bdc17b "Merge branch 'main' into main")`

`[ed8b483](/Seagate/cortx-s3server/pull/1041/commits/ed8b483a2164b81e53ee64a10e8de75770bdc17b)`

[![@cla-bot](https://avatars.githubusercontent.com/in/2404?s=80&v=4)](/apps/cla-bot)

Copy link

### **[cla-bot](/apps/cla-bot) bot** commented [Jul 20, 2021](#issuecomment-883189041)

| Thanks for your contribution! The CLA bot has flagged your contribution as not having a Contributor License Agreement in place. Note that this is not needed in the overwhelming majority of instances and this warning will usually be ignored. The code reviewers will make a determination and may ask you to sign a CLA or may choose to ignore this warning. More information about this can be found [here](https://github.com/Seagate/cortx/blob/master/doc/dco_cla.md). |
| --- |

All reactions

Sorry, something went wrong.

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)
[nileshgovande](/nileshgovande)
mentioned this pull request
[Jul 21, 2021](#ref-issue-946980786)

[Potential error due to the unreleased lock
#1037](/Seagate/cortx-s3server/issues/1037)

Closed

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&u=c176c66ca89f4f07cf2ea00b526a2ae36907369a&v=4)](/nileshgovande)
[nileshgovande](/nileshgovande)
merged commit [`dd6bfbc`](/Seagate/cortx-s3server/commit/dd6bfbc4b84f14f898598922ca9efd5aaa645c5d)
into
Seagate:main

[Jul 21, 2021](https://github.com/Seagate/cortx-s3server/pull/1041#event-5047991282)

[![@welcome](https://avatars.githubusercontent.com/in/4141?s=80&v=4)](/apps/welcome)

Copy link

### **[welcome](/apps/welcome) bot** commented [Jul 21, 2021](#issuecomment-883884486)

| Thanks for your contribution to CORTX! ðŸŽ‰ |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSeagate%2Fcortx-s3server%2Fpull%2F1041).

Reviewers

[![@bkirunge7](https://avatars.githubusercontent.com/u/64120272?s=40&v=4)](/bkirunge7) [bkirunge7](/bkirunge7)

 Awaiting requested review from bkirunge7

[![@knrajnambiar76](https://avatars.githubusercontent.com/u/5705513?s=40&v=4)](/knrajnambiar76) [knrajnambiar76](/knrajnambiar76)

 Awaiting requested review from knrajnambiar76

[![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=40&v=4)](/nileshgovande) [nileshgovande](/nileshgovande)

 Awaiting requested review from nileshgovande

[![@t7ko-seagate](https://avatars.githubusercontent.com/u/65701458?s=40&v=4)](/t7ko-seagate) [t7ko-seagate](/t7ko-seagate)

 Awaiting requested review from t7ko-seagate

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@anson-lo](https://avatars.githubusercontent.com/u/83398016?s=52&v=4)](/anson-lo) [![@cortx-admin](https://avatars.githubusercontent.com/u/68642722?s=52&v=4)](/cortx-admin) [![@nileshgovande](https://avatars.githubusercontent.com/u/63101371?s=52&v=4)](/nileshgovande)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


