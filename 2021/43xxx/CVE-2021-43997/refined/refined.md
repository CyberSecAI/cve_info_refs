The provided content contains information about multiple vulnerabilities patched in FreeRTOS, specifically in relation to the ARMv7-M and ARMv8-M MPU ports. It appears that CVE-2021-43997 is associated with these fixes, and the information extracted below encompasses the details found within the provided text.

**Root cause of vulnerability:**
Multiple vulnerabilities related to privilege escalation and arbitrary memory access were found in the FreeRTOS MPU ports for ARMv7-M and ARMv8-M architectures. These issues stemmed from:
1.  Lack of checks on arguments passed to functions like `pvTaskGetThreadLocalStoragePointer()` or `vTaskSetThreadLocalStoragePointer`.
2.  Unrestricted privilege elevation through parameters to functions like `MPU_xTaskCreate`, `MPU_xTaskCreateStatic`, `MPU_xTimerCreate`, `MPU_xTimerCreateStatic`, or `MPU_xTimerPendFunctionCall`.
3.  Exploitable behavior via direct branching into FreeRTOS MPU API wrapper functions with a crafted stack frame.
4.  Configuration of overlapping memory protection unit (MPU) regions that allowed unprivileged tasks to access privileged data.

**Weaknesses/vulnerabilities present:**

*   **Arbitrary Memory Access:** Negative index values passed to thread local storage functions allowed arbitrary read/write.
*   **Privilege Escalation:** Unprivileged tasks could invoke privileged functions by providing them as parameters to specific FreeRTOS APIs, or by crafting a stack frame and branching into MPU API wrappers.
*   **MPU Bypass:** Overlapping MPU regions could be configured to allow unprivileged access to privileged data.

**Impact of exploitation:**

*   **Arbitrary Memory Read/Write:** Attackers could read from or write to any memory location, potentially leading to data corruption or information disclosure.
*   **Privilege Escalation:** Attackers could elevate their privileges from unprivileged tasks to kernel-level access, gaining full control over the system.

**Attack vectors:**

*   **Injected Code:** Exploitation requires the attacker to have the ability to execute injected code within the system.
*   **Malicious Parameters:** Attackers can pass malicious parameters to specific FreeRTOS API functions to gain privileges.
*   **Crafted Stack Frames:** Attackers can use manually crafted stack frames to branch directly into FreeRTOS MPU API wrapper functions to escalate privileges.
*   **MPU Misconfiguration:** An attacker with control over the MPU configuration can setup overlapping regions to bypass memory protection.

**Required attacker capabilities/position:**
*   The attacker needs to have the ability to execute code within the context of the FreeRTOS system, meaning some form of code injection or prior access to the system is required.
*   For the MPU bypass, attackers need to have control over the MPU configuration.

**Additional Information:**
* The vulnerability concerning function calls via `MPU_xTaskCreate`, `MPU_xTaskCreateStatic`, `MPU_xTimerCreate`, `MPU_xTimerCreateStatic`, and `MPU_xTimerPendFunctionCall` has been addressed by restricting task creation to unprivileged tasks and by removing the timer-related APIs.
* The stack variable `xRunningPrivileged` was removed to prevent privilege escalation through crafted stack frames.
* The kernel now utilizes the highest numbered MPU regions for kernel protections to prevent overlapping MPU configurations that could result in privilege escalation.
* The fixes for these vulnerabilities were released in FreeRTOS V10.4.3 LTS Patch 3 and V10.5.0.
* The changes also include a new configuration option `configALLOW_UNPRIVILEGED_CRITICAL_SECTIONS` which allows developers to prevent unprivileged tasks from entering critical sections.