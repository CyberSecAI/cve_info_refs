Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability stems from the incorrect use of the `state` parameter in the Google OAuth login process. Instead of using it for its intended purpose of a CSRF token, the application used it to pass the "next URL" (the URL to redirect to after successful login). This allowed attackers to manipulate the redirect URL, potentially leading to phishing or other malicious activities.

**Weaknesses/Vulnerabilities:**

*   **CSRF Token Misuse:** The `state` parameter, meant for CSRF protection, was repurposed to store the redirect URL.
*   **Predictable State Value:** The "next URL" was a static and predictable value in the `state` parameter.
*   **Open Redirect:** By manipulating the `state` parameter, an attacker could redirect users to arbitrary URLs after login.

**Impact of Exploitation:**

*   **Phishing:** Attackers could redirect users to a fake login page, potentially stealing their credentials.
*   **Malicious Redirects:** Attackers could redirect users to websites hosting malware or other malicious content.
*   **Session Hijacking (Indirect):**  While not directly hijacking the session, by redirecting to a malicious site, an attacker could try to trick the user into giving their credentials or install malicious software.

**Attack Vectors:**

*   **Man-in-the-Middle (MitM) Attack:** An attacker could intercept the OAuth authorization request and modify the `state` parameter to redirect the user to a malicious site.
*   **Direct Manipulation:** In some cases, the attacker might be able to construct a crafted URL that initiates the OAuth flow with a manipulated `state` parameter.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to intercept or manipulate the OAuth authorization request or construct a URL to initiate the OAuth flow.
*   The attacker doesn't need access to the Redash application itself, just the ability to manipulate URLs or network requests related to the OAuth process.

**Additional Information:**

*   The vulnerability only affects Redash instances that use Google Login.
*   The fix involves replacing `Flask-Oauthlib` with `Authlib`, which automatically provides and validates a CSRF token for the `state` variable. The "next URL" is stored in the user session.
*   The provided commit diff shows the code changes to address the issue.

This information is more detailed than what is typically provided in a basic CVE description, which usually includes just a brief overview and affected versions.