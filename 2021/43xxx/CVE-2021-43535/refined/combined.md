=== Content from www.debian.org_c71d4ad5_20250115_081442.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DSA 5034-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5034-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 2 Jan 2022 17:01:50 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220102170150.GA31860%40seger.debian.org)Â [20220102170150.GA31860@seger.debian.org](msg00000.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5034-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
January 02, 2022                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For the oldstable distribution (buster), these problems have been fixed
in version 1:91.4.1-1~deb10u1.

For the stable distribution (bullseye), these problems have been fixed in
version 1:91.4.1-1~deb11u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmHR2XsACgkQEMKTtsN8
TjYd7w//ak0oRg6eCbfKob7RuhyUJ+6VsRhi4OUhuJBn78TsdwY6RWn63FZLqR0k
zUPM77KHdbL1dBE4Cphijqk8SQWAiWjKY0qceTA0QLJD3in9ZeyZQ3pGElynfRfQ
b42lYuAeo04CxKxgdrvHcLtDTfVFTWTUS7bwB7uzufu5AwflESPJuDW+e98nG0Nh
8lP/jBk6MpPJ4+smPQY2TeRyicd+a5C7JIe1dZAh7MhDJ+KJ2n1/1K3DUUR2eCo/
MYlw00nXs/Vr1BJxwWxSfl9ahxUcOWQWZ8SjtvIJTJXSjw1RoP+1Vefln7rpKgDH
2rUbsWJwS5B/83e2mDvsatgCZPNVsecMDrvWWVoctJm652pdqIAXvBxtyncoSm+S
Wmn5gdGec9IHXSUty1wO2pXrbfUKtr3H5qtyoesDBvhlXrYeyI5jNYTrO6V493le
j0WmZC0sypibI1jMOfOR68BYeDVl7kz737e6I4OoaNg4UUbXXBPgDOdFBaODt9ql
egTHI2wMCuszUBUo3PfVp1pyvb2Lnr27NisQNU2rvDV/MSXba3tsEUXj+ka4UVQZ
XcAUEcWKUVBn4utbJQJ81k3/KbVsAo0emN9cSM3z4opHpkmLGeyyvvPMwE8+Y/FM
RqFfsn4wRGDgwOZyGCWZ9NERvQ/r+DeBWp/Ca5Cw1fyho/4mFQY=
=jRWO
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_0e2a32c7_20250115_081445.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-50

## Security Vulnerabilities fixed in Thunderbird 91.3

Announced
November 3, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*
This advisory was updated January 17, 2023 to add CVE-2021-43529. This fix was included in the original release of Thunderbird 91.3, but did not appear in the advisory published at that time.

#### [#CVE-2021-43529: Memory corruption when processing S/MIME messages](#CVE-2021-43529)

Reporter
Tavis Ormandy
Impact
critical
##### Description

Thunderbird versions prior to 91.3.0 are vulnerable to the heap overflow described in CVE-2021-43527 when processing S/MIME messages. Thunderbird versions 91.3.0 and later will not call the vulnerable code when processing S/MIME messages that contain certificates with DER-encoded DSA or RSA-PSS signatures.
Note: This advisory was added on January 17, 2023 after discovering it was inadvertently left out of the original advisory. The fix was included in the original release of Thunderbird 91.3.

##### References

* [Bug 1738501](https://bugzilla.mozilla.org/show_bug.cgi?id=1738501)

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Thunderbird before version 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Thunderbird for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Thunderbird could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of web navigations, Thunderbird could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Thunderbird ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Thunderbird 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.debian.org_d669cd63_20250115_081442.html ===


---

[[Date Prev](msg00211.html)][[Date Next](msg00213.html)]
[[Thread Prev](msg00211.html)][[Thread Next](msg00213.html)]
[[Date Index](maillist.html#00212)]
[[Thread Index](threads.html#00212)]

# [SECURITY] [DSA 5026-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5026-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 19 Dec 2021 15:23:09 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211219152309.GA28709%40seger.debian.org)Â [20211219152309.GA28709@seger.debian.org](msg00212.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5026-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 19, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2021-43546 CVE-2021-43545 CVE-2021-43543 CVE-2021-43542
                 CVE-2021-43541 CVE-2021-43539 CVE-2021-43538 CVE-2021-43537
                 CVE-2021-43536 CVE-2021-43535 CVE-2021-43534 CVE-2021-38509
                 CVE-2021-38508 CVE-2021-38507 CVE-2021-38506 CVE-2021-38504
                 CVE-2021-38503

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

Between 78.x and 91.x, Firefox has seen a number of feature updates. For
more information please refer to
<https://www.mozilla.org/en-US/firefox/91.0esr/releasenotes/>

For the oldstable distribution (buster) one more final toolchain update
is needed, updated packages will shortly be available as 91.4.1esr-1~deb10u1

For the stable distribution (bullseye), these problem have been fixed in
version 91.4.1esr-1~deb11u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmG/ThkACgkQEMKTtsN8
TjYUEhAAqvtyXOssLe1+WtXdIeDNPCq4SCVnqKiVx2k+CJ8UVD1+NRGP0c4lRWG+
jORSEG+/iTcglfPKWb36Wly+xTafkZ5H1//SJCECwMCg6aq6EqlFZM50g6o6zOr/
szad8i/Dirh0G08AMzoab3VIm1RdlXmcZ6HWlaD59zMTm5ZakzikIX1rWhM0KPq4
dU9Pp3nwkcBlKmY90VTr3QGxOaolu1tes+y2r7ZwP8ZhVSFYV5wkPVAgvS9ybSih
yAvxVlB9f/aYjnfo4kzKBhZENoFz/h9qdp8hg00DI7Olw0WJkmU6soDh75FqJ4j4
XMzYAWEqnDyxFpU9t+RBUPFMNFERc/iVFDQaIuF6WDq2ud7Pzpj+byvSsL5kuaob
k4PMHv/SSLVrMWlsj9nO0ee9ih60W+FTIIjhz9Kt2zwY1OX+CBsxWOK86VEJk+7R
m30yhAvJMjqjZtBICF6bvv9ny+FYixQb8rCpRh172NpBlMC8pB0ypvWL4Y4iJK5n
Tj5zmL8iGDYrsZnqgIs5MThM5HLAw4vzBAPfQOB7PDyeWnj+uT+oYcPqOuxIB17Y
FHbIKxjGSMqdWtq/FZ9iP9Sga45hanlMEmu0UZqXFfMKXCY6/cVPk7k5l9vRmwXt
ds+PzAROBdEY2A9KXrct9bXRXdboOj2s2fpgaLU+SPy4xqEN2/I=
=AqRn
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_827a400d_20250115_081444.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-49

## Security Vulnerabilities fixed in Firefox ESR 91.3

Announced
November 2, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.3

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Firefox could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2b382435_20250115_081441.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1667102)
* [XML](/show_bug.cgi?ctype=xml&id=1667102)

Closed
[Bug 1667102](/show_bug.cgi?id=1667102)
(CVE-2021-43535)

Opened 4 years ago
Closed 3 years ago

# Crash in [@ mozilla::net::Http2Stream::TransmitFrame]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in [@ mozilla::net::Http2Stream::TransmitFrame]

## Categories

### (Core :: Networking: HTTP, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
â–¾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

94 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox-esr91 | [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox89 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=wontfix) |
| firefox90 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=wontfix) |
| firefox91 | [+](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=wontfix) |
| firefox92 | [+](/buglist.cgi?f1=cf_tracking_firefox92&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix) |
| firefox93 | [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed) |
| firefox94 | [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | wontfix |
| firefox-esr91 | 94+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox89 |  | wontfix |
| firefox90 |  | wontfix |
| firefox91 | + | wontfix |
| firefox92 | + | wontfix |
| firefox93 | + | fixed |
| firefox94 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jcristau, Assigned: kershaw)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/15b9b3783e4671cd882bff1316df14c9?d=mm&size=40)  [jcristau](/user_profile?user_id=580382)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue"), [1740274](/show_bug.cgi?id=1740274 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]")

[1574971](/show_bug.cgi?id=1574971 "RESOLVED FIXED - Consider using weak ptrs for mSegmentReader/mSegmentWriter in h2 code")

Dependency [tree](/showdependencytree.cgi?id=1667102&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1667102)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1711738](/show_bug.cgi?id=1711738 "RESOLVED FIXED - Crash in [@ mozilla::net::DnsAndConnectSocket::TransportSetup::SetupStreams]")

## Details

### (Keywords: crash, sec-high, testcase-wanted, Whiteboard: [necko-triaged][sec-survey][adv-main93+][adv-esr91.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-43535

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][sec-survey][adv-main93+][adv-esr91.3+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [noni](/user_profile?user_id=458186) | [qe-verify](#a25486758_458186 "4 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

[[@ mozilla::net::Http2Stream::TransmitFrame ]](https://crash-stats.mozilla.org/signature/?signature=mozilla%3A%3Anet%3A%3AHttp2Stream%3A%3ATransmitFrame)

[[@ mozilla::net::Http2Stream::ParseHttpRequestHeaders ]](https://crash-stats.mozilla.org/signature/?signature=mozilla%3A%3Anet%3A%3AHttp2Stream%3A%3AParseHttpRequestHeaders)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [Hold reference to Http2Session during ReadSegment call](/attachment.cgi?id=9228354)  [4 years ago](#c8)  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)   48 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#c11 "4 years ago") | [Details](/attachment.cgi?id=9228354&action=edit) | [Review](/attachment.cgi?id=9228354) |
| --- | --- | --- |
| [Bug 1667102 - Add some diagnostic assertions, r=#necko](/attachment.cgi?id=9239782)  [3 years ago](#c21)  [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#a31284936_24572 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c37 "3 years ago")  tjr : [sec-approval+](#a30944284_578488 "3 years ago") | [Details](/attachment.cgi?id=9239782&action=edit) | [Review](/attachment.cgi?id=9239782) |
| [Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko](/attachment.cgi?id=9241062)  [3 years ago](#c22)  [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c32 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#a33805811_75935 "3 years ago")  tjr : [sec-approval+](#c24 "3 years ago") | [Details](/attachment.cgi?id=9241062&action=edit) | [Review](/attachment.cgi?id=9241062) |
| [advisory.txt](/attachment.cgi?id=9248705)  [3 years ago](#c39)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   224 bytes, text/plain |  | [Details](/attachment.cgi?id=9248705&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1667102#c0)â€¢ 4 years ago |
|  | |

Crash report: <https://crash-stats.mozilla.org/report/index/c27d1c1c-2530-4f43-9ce4-c4d000200924>

Top 10 frames of crashing thread:

```
0  @0x858481e6
1  @0xebeacfc6
2 xul.dll mozilla::net::Http2Stream::TransmitFrame netwerk/protocol/http/Http2Stream.cpp:971
3 xul.dll mozilla::net::Http2Stream::OnReadSegment netwerk/protocol/http/Http2Stream.cpp:1516
4 xul.dll static mozilla::net::nsHttpTransaction::ReadRequestSegment netwerk/protocol/http/nsHttpTransaction.cpp:725
5 xul.dll nsBufferedInputStream::ReadSegments netwerk/base/nsBufferedStreams.cpp:446
6 xul.dll mozilla::net::nsHttpTransaction::ReadSegments netwerk/protocol/http/nsHttpTransaction.cpp:752
7 xul.dll mozilla::net::Http2Stream::ReadSegments netwerk/protocol/http/Http2Stream.cpp:164
8 xul.dll mozilla::net::Http2Session::ReadSegmentsAgain netwerk/protocol/http/Http2Session.cpp:2815
9 xul.dll mozilla::net::nsHttpConnection::OnSocketWritable netwerk/protocol/http/nsHttpConnection.cpp:1993

```

Most of these crashes seem to be `EXCEPTION_ACCESS_VIOLATION_EXEC` which might be scary?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1667102#c1)â€¢ 4 years ago |
|  | |

\_VIOLATION\_EXEC is definitely bad, and there's no good reason for http to be calling into unsymbolized memory (unlike the JIT say). Maybe the stream is gone (UAF), and we shouldn't be using a raw pointer here? Maybe uninitialized, with a predictable pattern that leaves the same value behind from whatever frame was there before?

Very interesting and suspicious that most of the crashes are crashing at the same address `0x858481e6`

<https://crash-stats.mozilla.org/signature/?product=Firefox&signature=mozilla%3A%3Anet%3A%3AHttp2Stream%3A%3ATransmitFrame&date=%3E%3D2020-09-17T17%3A12%3A00.000Z&date=%3C2020-09-24T17%3A12%3A00.000Z&_columns=date&_columns=product&_columns=version&_columns=build_id&_columns=platform&_columns=reason&_columns=address&_columns=install_time&_columns=startup_crash&_sort=-date&page=1#reports>

Flags: needinfo?(valentin.gosu)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1667102#c2)â€¢ 4 years ago |
|  | |

It seems to me something is going very wrong when jumping through a vtable. The address is indeed very suspicious but it could be an artefact caused by whatever issue leads to this crash. There's a few things worthy of note:

* All the crashes are on 32-bit Windows
* The vast majority of the crashes with an URL are on YouTube, with Facebook a distant second so this might have something to do with streaming video
* The user comments don't contain anything useful at all, it seems to happen out-of-the-blue
* The vast majority of the crashes are coming from machines with 4GiB of memory or less
* Many crashes have very low available commit space, so these users were running out of memory. Many more reports don't have memory annotations at all which is something that doesn't happen often. It is possible that this bug is caused - or at least made more likely - by low memory scenarios

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1667102#c3)â€¢ 4 years ago |
|  | |

Another couple of things worthy of note: this seems to be happening mostly on Windows 7 and there appear to be similar crashes with different signatures:

`[@ mozilla::net::nsSocketOutputStream::Write]`

<https://crash-stats.mozilla.org/report/index/3ff460cb-0666-4ce9-bdc3-6e0e00200924>

`[@ mozilla::net::nsHttpConnection::OnReadSegment]`

<https://crash-stats.mozilla.org/report/index/31ab8728-d339-441a-932d-8aa580200924>

The stacks for both signatures are eerily similar to this one

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a63645_415378)â€¢ 4 years ago |

See Also: â†’ [1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue")

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a406494_646284)â€¢ 4 years ago |

Severity: -- â†’ S3Priority: -- â†’ P1

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a435400_415378)â€¢ 4 years ago |

Assignee: nobody â†’ valentin.gosuFlags: needinfo?(valentin.gosu)Whiteboard: [necko-triaged]

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1667102#c4)â€¢ 4 years ago |
|  | |

I think it's a dupe of [bug 1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue") - let's wait for that to land and see if the crashes here go away.

Depends on: [1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue")See Also: [1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue") â†’

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1667102#c5)â€¢ 4 years ago |
|  | |

I have landed:

[Bug 1707078](/show_bug.cgi?id=1707078 "RESOLVED FIXED - Change some raw pointers into WeakPtr in Htttp2Session")

[Bug 1705065](/show_bug.cgi?id=1705065 "RESOLVED FIXED - ConnectionEntry should not hold raw pointer of DnsAndConnectSocket")

Both bugs remove use of raw pointer in the code that is related to this crash. The fixes may help with this crash, but we need to wait and see.

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1667102#c6)â€¢ 4 years ago |
|  | |

So [Bug 1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue") has been re-opened, the patch did not fix the problem, it seems.

[Bug 1707078](/show_bug.cgi?id=1707078 "RESOLVED FIXED - Change some raw pointers into WeakPtr in Htttp2Session") is fixed in 90, which is our current beta.

[Bug 1705065](/show_bug.cgi?id=1705065 "RESOLVED FIXED - ConnectionEntry should not hold raw pointer of DnsAndConnectSocket") is not yet fixed.

We should probably un-stall [bug 1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue") somehow to move this forward?

Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1667102#c7)â€¢ 4 years ago |
|  | |

[Bug 1705065](/show_bug.cgi?id=1705065 "RESOLVED FIXED - ConnectionEntry should not hold raw pointer of DnsAndConnectSocket") is now fixed in 91.

We probably need it to get to beta to know if it worked or not.

Otherwise, we can work either here or in [bug 1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue"), but the solution is likely a larger refactoring of the code.

Flags: needinfo?(valentin.gosu)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1667102#c8)â€¢ 4 years ago |
|  | |

Attached file
[Hold reference to Http2Session during ReadSegment call](attachment.cgi?id=9228354)
â€” [Details](attachment.cgi?id=9228354&action=edit)

From crashes it looks like Http2Session is destroyed, therefore let's hold refernce to the session.

The pattch alos aadd some diagnostic assertions to make sure that Htttp2Stream holds pointer to the correct (expeced) session.

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1667102#c9)â€¢ 4 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=684a0e2dd1e07861a98ec6660d557a06c16dcf18>

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a23422289_580382)â€¢ 4 years ago |

See Also: â†’ [1711738](/show_bug.cgi?id=1711738 "RESOLVED FIXED - Crash in [@ mozilla::net::DnsAndConnectSocket::TransportSetup::SetupStreams]")

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1667102#c10)â€¢ 4 years ago |
|  | |

Comment on [attachment 9228354](/attachment.cgi?id=9228354 "Hold reference to Http2Session during ReadSegment call") [[details]](/attachment.cgi?id=9228354&action=edit "Hold reference to Http2Session during ReadSegment call")

Hold reference to Http2Session during ReadSegment call

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch add some diagnostic asserts and changes a raw pointer to a refPtr. The change tries to guess what is the cause of the bug. The patch does not reveals more that the crash reports already show.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all, this is an old bug
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: The patch should apply cleanly to older branches
* **How likely is this patch to cause regressions; how much testing does it need?**: Very unlikely. It only add diagnostic asserts a RefPtr.
[Attachment #9228354](/attachment.cgi?id=9228354&action=edit "Hold reference to Http2Session during ReadSegment call") -
Flags: sec-approval?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a23661299_580382)â€¢ 4 years ago |

[status-firefox89](/buglist.cgi?f1=cf_status_firefox89&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox89&o1=equals&v1=wontfix)
[status-firefox90](/buglist.cgi?f1=cf_status_firefox90&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox90&o1=equals&v1=wontfix)
[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a24774828_1689)â€¢ 4 years ago |

[tracking-firefox91](/buglist.cgi?f1=cf_tracking_firefox91&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox91&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- â†’ [91+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=91%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1667102#c11)â€¢ 4 years ago |
|  | |

Comment on [attachment 9228354](/attachment.cgi?id=9228354 "Hold reference to Http2Session during ReadSegment call") [[details]](/attachment.cgi?id=9228354&action=edit "Hold reference to Http2Session during ReadSegment call")

Hold reference to Http2Session during ReadSegment call

sec-approval = dveditz

[Attachment #9228354](/attachment.cgi?id=9228354&action=edit "Hold reference to Http2Session during ReadSegment call") -
Flags: sec-approval? â†’ sec-approval+

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a24914532_508195)â€¢ 4 years ago |

Assignee: valentin.gosu â†’ dd.mozilla

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1667102#c12)â€¢ 4 years ago |
|  | |

I cannot land this his patch in lando, i says that I do not have permissions. Can you land it for me?

Flags: needinfo?(jcristau)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1667102#c13)â€¢ 4 years ago |
|  | |

Hold reference to Http2Session during ReadSegment call r=necko-reviewers,valentin

<https://hg.mozilla.org/integration/autoland/rev/568cde9bc686ce4ae172331ca1defa25263b5e59>

Flags: needinfo?(jcristau)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1667102#c14)â€¢ 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/568cde9bc686>

Group: network-core-security â†’ core-security-releaseStatus: NEW â†’ RESOLVEDClosed: 4 years ago
[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 91 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1667102#c15)â€¢ 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1667102) to reply.

Flags: needinfo?(dd.mozilla)Whiteboard: [necko-triaged] â†’ [necko-triaged][sec-survey]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1667102#c16)â€¢ 4 years ago |
|  | |

We're still seeing crashes with this signature in 91.0b1 (i.e. with the fix), e.g. [bp-55492aa4-762d-429a-a2de-f6af50210714](https://crash-stats.mozilla.org/report/index/55492aa4-762d-429a-a2de-f6af50210714)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a25486758_458186)â€¢ 4 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1667102#c17)â€¢ 3 years ago |
|  | |

I forgot to set "leave-open" flag.

Status: RESOLVED â†’ REOPENEDResolution: FIXED â†’ ---

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a25900618_580382)â€¢ 3 years ago |

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=fixed) â†’ [affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected)
[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1667102#c18)â€¢ 3 years ago |
|  | |

Dragana, given that 91 is still marked as affected after the patch, do we need to uplift what already landed in the 91 cycle to esr78 or can we delay that to the next 78.x release? Thanks

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a26958477_580382)â€¢ 3 years ago |

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=wontfix)
[tracking-firefox92](/buglist.cgi?f1=cf_tracking_firefox92&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox92&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[91+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=91%2B) â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F)

|  | [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1667102#c19)â€¢ 3 years ago |
|  | |

The patch has no fix he issue. We do not need o uplift it.

Flags: needinfo?(dd.mozilla)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a27217509_580382)â€¢ 3 years ago |

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a27931516_75935)â€¢ 3 years ago |

Status: REOPENED â†’ NEW
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)Target Milestone: 91 Branch â†’ ---

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1667102#c20)â€¢ 3 years ago |
|  | |

Too late to address this for the current cycle.

[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix)
[tracking-firefox93](/buglist.cgi?f1=cf_tracking_firefox93&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1667102#c21)â€¢ 3 years ago |
|  | |

Attached file
[Bug 1667102 - Add some diagnostic assertions, r=#necko](attachment.cgi?id=9239782)
â€” [Details](attachment.cgi?id=9239782&action=edit)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1667102#c22)â€¢ 3 years ago |
|  | |

Attached file
[Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko](attachment.cgi?id=9241062)
â€” [Details](attachment.cgi?id=9241062&action=edit)

Depends on D124753

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1667102#c23)â€¢ 3 years ago |
|  | |

Comment on [attachment 9241062](/attachment.cgi?id=9241062 "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") [[details]](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easy, since this patch assumes this crash is caused by a race condition that `Http2Session` is released on main thread.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: The patch should apply cleanly to older branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Should be low, since this patch only changes the behavior a bit. With this patch, we access `Http2Session` via a `nsWeakPtr`, not a raw pointer.

  If an `Http2Session` is released before accessing, Firefox will be crashed.
[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: sec-approval?

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a30760737_505624)â€¢ 3 years ago |

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a30859885_75935)â€¢ 3 years ago |

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected)
[tracking-firefox94](/buglist.cgi?f1=cf_tracking_firefox94&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1667102#c24)â€¢ 3 years ago |
|  | |

Comment on [attachment 9241062](/attachment.cgi?id=9241062 "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") [[details]](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko

Approved to land and request uplift

[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a30944284_578488)â€¢ 3 years ago |

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: sec-approval? â†’ sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1667102#c25)â€¢ 3 years ago |
|  | |

Add some diagnostic assertions, r=necko-reviewers,dragana

<https://hg.mozilla.org/integration/autoland/rev/b933ec9d0dc387d348229cf8d2d07e82103972ea>

Make sure nsHttpTransaction::mConnection is released on socket thread, r=necko-reviewers,dragana

<https://hg.mozilla.org/integration/autoland/rev/624ecfecb03527c8f36daf59e48bfa9118647919>

<https://hg.mozilla.org/mozilla-central/rev/b933ec9d0dc3>

<https://hg.mozilla.org/mozilla-central/rev/624ecfecb035>

Status: NEW â†’ RESOLVEDClosed: 4 years ago â†’ 3 years ago
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 94 Branch

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1667102#c26)â€¢ 3 years ago |
|  | |

Dragana, do you want to request uplift? Thanks

Flags: needinfo?(dd.mozilla)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1667102#c27)â€¢ 3 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #26](/show_bug.cgi?id=1667102#c26 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]"))

> Dragana, do you want to request uplift? Thanks

Sorry, I should do this.

Assignee: dd.mozilla â†’ kershawFlags: needinfo?(dd.mozilla)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1667102#c28)â€¢ 3 years ago |
|  | |

Comment on [attachment 9241062](/attachment.cgi?id=9241062 "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") [[details]](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko

### Beta/Release Uplift Approval Request

* **User impact if declined**: Could be crashed.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: N/A
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Should be low.

  The patch only changed the raw pointer access to a weak pointer and not changes others.
* **String changes made/needed**: N/A
[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: approval-mozilla-beta?

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a31279322_505624)â€¢ 3 years ago |

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1667102#c29)â€¢ 3 years ago |
|  | |

Does it a also need uplifting to 78 and 91 ESR?

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1667102#c30)â€¢ 3 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #29](/show_bug.cgi?id=1667102#c29 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]"))

> Does it a also need uplifting to 78 and 91 ESR?

Probably not, since I am not entirely sure my patches fix the crash.

I'd like to wait a few more cycles.

Flags: needinfo?(kershaw)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1667102#c31)â€¢ 3 years ago |
|  | |

Since we don't uplift in 78 ESR this cycle, I am marking 78 as wontfix as this ESR branch will be EOL with 94.

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=%3F) â†’ ---

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1667102#c32)â€¢ 3 years ago |
|  | |

Comment on [attachment 9241062](/attachment.cgi?id=9241062 "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") [[details]](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko

Approved for 93 beta 8, thanks.

[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a31284936_24572)â€¢ 3 years ago |

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1667102#c33)â€¢ 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/9f8eed9137f0>

<https://hg.mozilla.org/releases/mozilla-beta/rev/a4237f33cc63>

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a31903202_578488)â€¢ 3 years ago |

Whiteboard: [necko-triaged][sec-survey] â†’ [necko-triaged][sec-survey][adv-main93+r]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1667102#c34)â€¢ 3 years ago |
|  | |

(In reply to Kershaw Chang [:kershaw] from [comment #30](/show_bug.cgi?id=1667102#c30 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]"))

> > Does it a also need uplifting to 78 and 91 ESR?
>
> Probably not, since I am not entirely sure my patches fix the crash.
>
> I'd like to wait a few more cycles.

I'll set this to be tracked for ESR 91.3 ("94+") for now. As we get to the end of it we can see if you still need more evidence, and push it out further if necessary.

[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=%3F) â†’ [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a32620024_75935)â€¢ 3 years ago |

Blocks: [1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue")No longer depends on: [1402014](/show_bug.cgi?id=1402014 "RESOLVED FIXED - Crash in mozilla::net::Http2Session::FlushOutputQueue")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1667102#c35)â€¢ 3 years ago |
|  | |

This is looking great on beta/release. I think we're good for an ESR uplift request.

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1667102#c36)â€¢ 3 years ago |
|  | |

Comment on [attachment 9241062](/attachment.cgi?id=9241062 "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") [[details]](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: Firefox could crash.
* **Fix Landed on Version**: 94
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This patch is already verified for a few cycles.
* **String or UUID changes made by this patch**: N/A
Flags: needinfo?(kershaw)
[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: approval-mozilla-esr91?

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a33803349_505624)â€¢ 3 years ago |

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1667102#c37)â€¢ 3 years ago |
|  | |

Comment on [attachment 9239782](/attachment.cgi?id=9239782 "Bug 1667102 - Add some diagnostic assertions, r=#necko") [[details]](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko")

[Bug 1667102](/show_bug.cgi?id=1667102 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]") - Add some diagnostic assertions, r=#necko

Approved for 91.3esr, thanks.

[Attachment #9239782](/attachment.cgi?id=9239782&action=edit "Bug 1667102 - Add some diagnostic assertions, r=#necko") -
Flags: approval-mozilla-esr91? â†’ approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a33805811_75935)â€¢ 3 years ago |

[Attachment #9241062](/attachment.cgi?id=9241062&action=edit "Bug 1667102 - Make sure nsHttpTransaction::mConnection is released on socket thread, r=#necko") -
Flags: approval-mozilla-esr91? â†’ approval-mozilla-esr91+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1667102#c38)â€¢ 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/fff749a15d5b>

<https://hg.mozilla.org/releases/mozilla-esr91/rev/c1741d6eb4f0>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a34401766_578488)â€¢ 3 years ago |

Whiteboard: [necko-triaged][sec-survey][adv-main93+r] â†’ [necko-triaged][sec-survey][adv-main93+r][adv-esr91.3+r]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1667102#c39)â€¢ 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9248705)
â€” [Details](attachment.cgi?id=9248705&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1667102#c40)â€¢ 3 years ago |
|  | |

Due to this landed in different versions, it's being retroactively assigned an individual CVE. (Which we don't know yet, so it's being given a temporary identifier.) The appropriate advisories will be updated.

Whiteboard: [necko-triaged][sec-survey][adv-main93+r][adv-esr91.3+r] â†’ [necko-triaged][sec-survey][adv-main93+][adv-esr91.3+]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a35018070_75935)â€¢ 3 years ago |

Blocks: [1574971](/show_bug.cgi?id=1574971 "RESOLVED FIXED - Consider using weak ptrs for mSegmentReader/mSegmentWriter in h2 code")

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1667102#c41)â€¢ 3 years ago |
|  | |

There are still some crashes on 93, so reopen this bug.

I'll keep working on this.

Status: RESOLVED â†’ REOPENEDResolution: FIXED â†’ ---

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1667102#c42)â€¢ 3 years ago |
|  | |

This signature seems related.

Crash Signature: [@ mozilla::net::Http2Stream::TransmitFrame] â†’ [@ mozilla::net::Http2Stream::TransmitFrame]
[@ mozilla::net::Http2Stream::ParseHttpRequestHeaders ]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1667102#c43)â€¢ 3 years ago |
|  | |

Can we spin any future work to a new bug? This has already had advisories issued for it so tracking is going to get ugly if we keep doing more here.

Flags: needinfo?(kershaw)

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1667102#c44)â€¢ 3 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #43](/show_bug.cgi?id=1667102#c43 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]"))

> Can we spin any future work to a new bug? This has already had advisories issued for it so tracking is going to get ugly if we keep doing more here.

Sure. I'll close this and file a new one.

Status: REOPENED â†’ RESOLVEDClosed: 3 years ago â†’ 3 years agoFlags: needinfo?(kershaw)Resolution: --- â†’ FIXED

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a35513522_505624)â€¢ 3 years ago |

Blocks: [1740274](/show_bug.cgi?id=1740274 "RESOLVED FIXED - Crash in [@ mozilla::net::Http2Stream::TransmitFrame]")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a37576189_428608)â€¢ 3 years ago |

Alias: CVE-2021-43535

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667102#a60605607_1689)â€¢ 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1667102&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Dragana Damjanovic [:dragana]](/user_profile?user_id=508195)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.debian.org_710f37d2_20250115_081441.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 2863-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2863-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Wed, 29 Dec 2021 15:08:44 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211229140844.4D47C2A01EC%40andromeda)Â [20211229140844.4D47C2A01EC@andromeda](msg00030.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2863-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2021                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 91.4.1esr-1~deb9u1
CVE ID         : CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43534 CVE-2021-43535
                 CVE-2021-43536 CVE-2021-43537 CVE-2021-43538 CVE-2021-43539
                 CVE-2021-43541 CVE-2021-43542 CVE-2021-43543 CVE-2021-43545
                 CVE-2021-43546

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

For Debian 9 stretch, these problems have been fixed in version
91.4.1esr-1~deb9u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHMa+gACgkQnUbEiOQ2
gwJ1fxAAlShXtzdoIbA8nzTMODGnFqcZlcbnLRBJHRz2wqooV8AQfyzMqoZH9Ac+
iZPZ0hsK94j4CfGv+HjIJDag3xrqifKRmNu+C7EDp6A85a0jtu34OlKu4GcDeGO+
4D+cLd4ODc9qxSGT9DoMrqEhX8AHZbIBMq9ULcFtJziqlkRJQgjJ7VHnboI8phR3
kPjVead/5ktIjM9/ke3XL2dmKsT/8eUV3V1BkIpReZhMkqvHfMjXU0OYj9KX3nRe
6NHmoiNVTGhEmXGZ+YyVPSg3vQ60rs9VVKgDryBA8nqvZDmb4V+cNXXeE3mc2ytK
bLdE/diLNL2hVtmXrx3j7DAuieXV5GKGOhvx+OtOU4wgxnnzT5JO4gu0taOUSOlp
RY8CJjJC8MwkGbmvzfIImzWY0a7OrjyX1CalYs/Liv8pGP8xYzjM5hzGXE9P1HhP
Ap+ES6j5TeYEzIlUM8YmtdYOnDu1ae5a+FUUIHtMZY9B9+AypY1qq7XJx69KNyLK
dyERuMDhVohNRMdim7enVZeePyfLsE5Ywexaw0YgiHMJSSLWdPRuy1U/X9JN+1op
mT66RRdNl64maq3ZkSOjmyzNM7zpsYZ3hsXX6U2DkqGsc+Q3xlb4/ncRriJx4rZO
8bN0h9L3Zobb4ItOVSI4BvqMNYh0oKCBRNhp8O2Uj0bIxNCHvhg=
=pQH3
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_4cca222d_20250115_081443.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-43

## Security Vulnerabilities fixed in Firefox 93

Announced
October 5, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 93

#### [#CVE-2021-38496: Use-after-free in MessageTask](#CVE-2021-38496)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

During operations on MessageTasks, a task may have been removed while it was still scheduled, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1725335](https://bugzilla.mozilla.org/show_bug.cgi?id=1725335)

#### [#CVE-2021-38497: Validation message could have been overlaid on another origin](#CVE-2021-38497)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Through use of `reportValidity()` and `window.open()`, a plain-text validation message could have been overlaid on another origin, leading to possible user confusion and spoofing attacks.

##### References

* [Bug 1726621](https://bugzilla.mozilla.org/show_bug.cgi?id=1726621)

#### [#CVE-2021-38498: Use-after-free of nsLanguageAtomService object](#CVE-2021-38498)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

During process shutdown, a document could have caused a use-after-free of a languages service object, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1729642](https://bugzilla.mozilla.org/show_bug.cgi?id=1729642)

#### [#CVE-2021-32810: Data race in crossbeam-deque](#CVE-2021-32810)

Reporter
Maor Kleinberger
Impact
moderate
##### Description

In the crossbeam crate, one or more tasks in the worker queue could have been be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this could have caused a double free and a memory leak.

##### References

* [Bug 1729813](https://bugzilla.mozilla.org/show_bug.cgi?id=1729813)
* [Bug https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw](https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw)

#### [#CVE-2021-38500: Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](#CVE-2021-38500)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Andreas Pehrson and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1725854%2C1728321)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38501: Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](#CVE-2021-38501)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Kevin Brosnan, Mihai Alexandru Michis, and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685354%2C1715755%2C1723176)

#### [#CVE-2021-38499: Memory safety bugs fixed in Firefox 93](#CVE-2021-38499)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julien Cristau, Christian Holler reported memory safety bugs present in Firefox 92. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1723170%2C1725356%2C1727364)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_b809ed9d_20250115_081442.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 2874-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2874-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Tue, 4 Jan 2022 11:10:10 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220104101010.737312AA2C8%40andromeda)Â [20220104101010.737312AA2C8@andromeda](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2874-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 04, 2022                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:91.4.1-1~deb9u1
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For Debian 9 stretch, these problems have been fixed in version
1:91.4.1-1~deb9u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHUHP4ACgkQnUbEiOQ2
gwIdhhAAsYJeGaKX7EakOQSqKqWksvfDg41A+TA01hpygOvfipqGlJl4sBCFHtfm
vPY4w6A+RsJWPohOch+DMc9EfXOJ1ivMp0nMMky/8xYYksAQqeThtwBfm2wHWpGT
IZAtn5doZe/53P++ejD5xLnCC19oCdBbEHsPj3p6OWzEUByqfPZBAv02lA+0pqqo
Mga52gFMI6xy4wmeuQZGtKsyI/hujLbYHnp7Rb8+3uwisb7QkzeVod77z211pGon
ifobrw52Bfa0Cb1e9Xesg70TDsZlPPlUnqHaUC5pE+OxS0Vx1G4Eur1+wQ9ao4V8
djlJWhmj1+1wNlSJ91Fsk0UQ+y6cVli4MU5wzIufQ0TdN+hMjQD0nuCejnjhQjPc
YNK7jYUwM4+DFGswYdpvoNa2uNtKzsu7sZQW9kfeF7H2uLoJgAUdNRdKrNmUrofQ
C4E2CsI3wTQxE9gmWX+LRGKr9r6QF15es7KCEGuFlAToVCh/d6vXF0f9IaH0ZE05
6W4sfcYoj6HKHEcKONuh6codpRceKx6gPgh+2n0pdoUNNlz/AbO0is+SiIInILlI
dYSdTxPLK0fZxD+ufi2E9IaQ2VvRg0Y933pQvjn3xbCCk7xehM7TD55LlwfUWPGb
/ffeEgwsObhA0cmV3jN6+bvxM9Tbk7DSd4Q30fuqSy8od5Ih0i4=
=kFGv
-----END PGP SIGNATURE-----

```

---


