=== Content from www.nlnetlabs.nl_f3dde89a_20250114_185139.html ===
Three vulnerabilities have been discovered in Routinator: CVE-2021-43172,
CVE-2021-43173 and CVE-2021-43174.
== Summary
=== CVE-2021-43172
Routinator prior to 0.10.2 happily processes a chain of RRDP repositories of
infinite length causing it to never finish a validation run.
=== CVE-2021-43173
In Routinator prior to 0.10.2, a validation run can be delayed significantly
by an RRDP repository by not answering but slowly drip-feeding bytes to keep
the connection alive. This can be used to effectively stall validation.
=== CVE-2021-43174
Routinator versions 0.9.0 up to and including 0.10.1, support the gzip
transfer encoding when querying RRDP repositories. This encoding can be used by
an RRDP repository to cause an out-of-memory crash in these versions of
Routinator.
== Affected products
Routinator up to and including 0.10.1.
== Description
=== CVE-2021-43172
In RPKI, a CA can choose the RRDP repository it wishes to publish its data
in. By continuously generating a new child CA that only consists of another
CA using a different RRDP repository, a malicious CA can create a chain of
CAs of de-facto infinite length. Routinator prior to version 0.10.2 did
not contain a limit on the length of such a chain and will therefore continue
to process this chain forever. As a result, the validation run will never
finish, leading to Routinator continuing to serve the old data set or, if
in the initial validation run directly after starting, never serve any data
at all.
=== CVE-2021-43173
While Routinator has a configurable time-out value for RRDP connections,
this time-out was only applied to individual read or write operations rather
than the complete request. Thus, if an RRDP repository sends a little bit of
data before that time-out expired, it can continuously extend the time it
takes for the request to finish. Since validation will only continue once the
update of an RRDP repository has concluded, this delay will cause validation
to stall, leading to Routinator continuing to serve the old data set or, if
in the initial validation run directly after starting, never serve any data
at all.
=== CVE-2021-43174
RRDP uses XML which allows arbitrary amounts of white space in the encoded
data. The gzip scheme compresses such white space extremely well, leading to
very small compressed files that become huge when being decompressed for
further processing, big enough that Routinator runs out of memory when
parsing input data waiting for the next XML element.
While it would have been possible to fix this out-of-memory condition, the
large amount of data still needs to be handled, leading to a severe delay in
validation runs. We have therefore decided to disable the gzip encoding
completely.
== Solution
Install Routinator version 0.10.2 or later.
== Acknowledgments
We would like to thank Koen van der Hove for discovering and reporting the
issue.

