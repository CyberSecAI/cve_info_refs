Based on the provided content, here's the breakdown of CVE-2021-43161:

**Root cause of vulnerability:**
- Command Injection vulnerability

**Weaknesses/vulnerabilities present:**
-  Remote Code Execution (RCE) via command injection in the `doSwitchApi` function.

**Impact of exploitation:**
- Allows an attacker to execute arbitrary commands on the affected system.

**Attack vectors:**
- Network-based attack via the `/cgi-bin/luci/api/switch` endpoint.

**Required attacker capabilities/position:**
-  The attacker needs to be authenticated to exploit the vulnerability.

**Additional Details:**
- The vulnerability affects Ruijie RG-EW Series Routers up to ReyeeOS 1.55.1915 / EW_3.0(1)B11P55.
- The vulnerable function is located in the `/usr/lib/lua/luci/modules/switch.lua` file.
- The vulnerability was discovered by Minh Khoa of VSEC.
- This is a post-authenticated RCE vulnerability.
- Tested on Ruijie RG-EW1200, Ruijie RG-EW1200G PRO