```
{
  "cveId": "CVE-2021-43542",
  "related": true,
  "information": [
    {
      "source": "www.debian.org_d669cd63_20250114_202659.html",
      "content": "Package        : firefox-esr\nCVE ID         : CVE-2021-43546 CVE-2021-43545 CVE-2021-43543 CVE-2021-43542\n                 CVE-2021-43541 CVE-2021-43539 CVE-2021-43538 CVE-2021-43537\n                 CVE-2021-43536 CVE-2021-43535 CVE-2021-43534 CVE-2021-38509\n                 CVE-2021-38508 CVE-2021-38507 CVE-2021-38506 CVE-2021-38504\n                 CVE-2021-38503\n\nMultiple security issues have been found in the Mozilla Firefox\nweb browser, which could potentially result in the execution\nof arbitrary code, information disclosure or spoofing.\n\nDebian follows the extended support releases (ESR) of Firefox. Support\nfor the 78.x series has ended, so starting with this update we're now\nfollowing the 91.x releases.\n\nBetween 78.x and 91.x, Firefox has seen a number of feature updates. For\nmore information please refer to\n<https://www.mozilla.org/en-US/firefox/91.0esr/releasenotes/>\n\nFor the oldstable distribution (buster) one more final toolchain update\nis needed, updated packages will shortly be available as 91.4.1esr-1~deb10u1\n\nFor the stable distribution (bullseye), these problem have been fixed in\nversion 91.4.1esr-1~deb11u1."
    },
    {
      "source": "bugzilla.mozilla.org_9a1ce039_20250114_202656.html",
      "content": "Fast query of registered URL schemes through XMLHttpRequest for system fingerprinting\n\nThe problem is that XMLHttpRequest will return different status codes dependent on the registration-state of the protocol or not.\n\nJavascript code snippet:\n\nvar scheme = \"spotify://dummy\";\n\ntry {\n\nvar ajaxObj = new XMLHttpRequest()\n\najaxObj.open(\"GET\", scheme, false);\n\najaxObj.send();\n\n} catch (error) {\n\nif (ajaxObj.status === 0) {\n\nconsole.log(\"Protocol found: \" + scheme);\n\n} else { // regulary ajaxObj.status == 200\n\nconsole.log(\"Protocol NOT found: \" + scheme);\n\n}\n\n}\n\nA fix would be to disallow XMLHttpRequest requests with protocols others than http, https, ...\n\nAs per <https://fetch.spec.whatwg.org/#scheme-fetch> anything other than `about:`/`blob:`/`data:`/`file:`/`http:`/`https:` ought to return a network error (which would result in status 0).\n\nWhen fixing this we should make sure that HTML's `<img>`, CSS's `background-image`, `fetch()`, etc. do not have the same problem."
    },
    {
      "source": "www.mozilla.org_9a0822d3_20250114_202702.html",
      "content": "#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler\n\nReporter\nRaphael Smolik\nImpact\nmoderate\nDescription\nUsing XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.\n\nReferences\n\n* Bug 1723281"
    },
        {
      "source": "www.mozilla.org_9ac8834a_20250114_202700.html",
      "content": "#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler\n\nReporter\nRaphael Smolik\nImpact\nmoderate\nDescription\nUsing XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.\n\nReferences\n\n* Bug 1723281"
    },
    {
       "source": "www.debian.org_c71d4ad5_20250114_202659.html",
       "content": "Package        : thunderbird\nCVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502\n                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507\n                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529\n                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537\n                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542\n                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538\n\nMultiple security issues were discovered in Thunderbird, which could\nresult in the execution of arbitrary code, spoofing, information disclosure,\ndowngrade attacks on SMTP STARTTLS connections or misleading display of\nOpenPGP/MIME signatures."
     },
      {
      "source": "security.gentoo.org_067c0658_20250114_202658.html",
      "content": "Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could result in the arbitrary execution of code.\n\n\nMultiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.\n\n\n\n* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)"
    },
    {
      "source": "lists.debian.org_b809ed9d_20250114_202656.html",
      "content": "Package        : thunderbird\nVersion        : 1:91.4.1-1~deb9u1\nCVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502\n                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507\n                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529\n                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537\n                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542\n                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538\n\nMultiple security issues were discovered in Thunderbird, which could\nresult in the execution of arbitrary code, spoofing, information disclosure,\ndowngrade attacks on SMTP STARTTLS connections or misleading display of\nOpenPGP/MIME signatures."
    },
    {
      "source": "security.gentoo.org_ffa2d904_20250114_202657.html",
      "content": "* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)"
    },
    {
       "source": "www.mozilla.org_c6198758_20250114_202701.html",
       "content": "#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler\n\nReporter\nRaphael Smolik\nImpact\nmoderate\nDescription\nUsing XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.\n\nReferences\n\n* Bug 1723281"
    },
    {
      "source":"lists.debian.org_710f37d2_20250114_202656.html",
      "content": "Package        : firefox-esr\nVersion        : 91.4.1esr-1~deb9u1\nCVE ID         : CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507\n                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43534 CVE-2021-43535\n                 CVE-2021-43536 CVE-2021-43537 CVE-2021-43538 CVE-2021-43539\n                 CVE-2021-43541 CVE-2021-43542 CVE-2021-43543 CVE-2021-43545\n                 CVE-2021-43546\n\nMultiple security issues have been found in the Mozilla Firefox\nweb browser, which could potentially result in the execution\nof arbitrary code, information disclosure or spoofing."
    }
  ],
  "vulnerability": {
    "rootCause": "XMLHttpRequest returns different status codes depending on whether a protocol is registered or not.",
    "weaknesses": [
      "The XMLHttpRequest API can be used to probe for the existence of registered URL schemes."
    ],
    "impact": "An attacker can identify installed applications on a user's system by probing error messages returned from XMLHttpRequest when attempting to load external protocols.",
    "attackVectors": [
      "A malicious website can use JavaScript to make XMLHttpRequest requests to probe for external protocol handlers."
    ],
    "requiredCapabilities": "The attacker needs to be able to execute JavaScript in the user's browser."
  }
}
```