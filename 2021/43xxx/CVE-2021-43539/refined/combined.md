=== Content from security.gentoo.org_ffa2d904_20250114_180503.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities â€” GLSA **202202-03**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-91.6.0:esr"

```

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-91.6.0:esr"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-97.0:rapid"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-97.0:rapid"

```
### References

* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29972](https://nvd.nist.gov/vuln/detail/CVE-2021-29972)
* [CVE-2021-29974](https://nvd.nist.gov/vuln/detail/CVE-2021-29974)
* [CVE-2021-29975](https://nvd.nist.gov/vuln/detail/CVE-2021-29975)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29977](https://nvd.nist.gov/vuln/detail/CVE-2021-29977)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29981](https://nvd.nist.gov/vuln/detail/CVE-2021-29981)
* [CVE-2021-29982](https://nvd.nist.gov/vuln/detail/CVE-2021-29982)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29987](https://nvd.nist.gov/vuln/detail/CVE-2021-29987)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-29990](https://nvd.nist.gov/vuln/detail/CVE-2021-29990)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38491](https://nvd.nist.gov/vuln/detail/CVE-2021-38491)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43540](https://nvd.nist.gov/vuln/detail/CVE-2021-43540)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0511](https://nvd.nist.gov/vuln/detail/CVE-2022-0511)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22753](https://nvd.nist.gov/vuln/detail/CVE-2022-22753)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22755](https://nvd.nist.gov/vuln/detail/CVE-2022-22755)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22757](https://nvd.nist.gov/vuln/detail/CVE-2022-22757)
* [CVE-2022-22758](https://nvd.nist.gov/vuln/detail/CVE-2022-22758)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22762](https://nvd.nist.gov/vuln/detail/CVE-2022-22762)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* MOZ-2021-0004
* MOZ-2021-0005
* MOZ-2021-0006
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

February 21, 2022

**Latest revision**

February 21, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [802768](https://bugs.gentoo.org/show_bug.cgi?id=802768)
* [807947](https://bugs.gentoo.org/show_bug.cgi?id=807947)
* [813498](https://bugs.gentoo.org/show_bug.cgi?id=813498)
* [821385](https://bugs.gentoo.org/show_bug.cgi?id=821385)
* [828538](https://bugs.gentoo.org/show_bug.cgi?id=828538)
* [831039](https://bugs.gentoo.org/show_bug.cgi?id=831039)
* [832992](https://bugs.gentoo.org/show_bug.cgi?id=832992)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from lists.debian.org_b809ed9d_20250114_180502.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 2874-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2874-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Tue, 4 Jan 2022 11:10:10 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220104101010.737312AA2C8%40andromeda)Â [20220104101010.737312AA2C8@andromeda](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2874-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 04, 2022                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:91.4.1-1~deb9u1
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For Debian 9 stretch, these problems have been fixed in version
1:91.4.1-1~deb9u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHUHP4ACgkQnUbEiOQ2
gwIdhhAAsYJeGaKX7EakOQSqKqWksvfDg41A+TA01hpygOvfipqGlJl4sBCFHtfm
vPY4w6A+RsJWPohOch+DMc9EfXOJ1ivMp0nMMky/8xYYksAQqeThtwBfm2wHWpGT
IZAtn5doZe/53P++ejD5xLnCC19oCdBbEHsPj3p6OWzEUByqfPZBAv02lA+0pqqo
Mga52gFMI6xy4wmeuQZGtKsyI/hujLbYHnp7Rb8+3uwisb7QkzeVod77z211pGon
ifobrw52Bfa0Cb1e9Xesg70TDsZlPPlUnqHaUC5pE+OxS0Vx1G4Eur1+wQ9ao4V8
djlJWhmj1+1wNlSJ91Fsk0UQ+y6cVli4MU5wzIufQ0TdN+hMjQD0nuCejnjhQjPc
YNK7jYUwM4+DFGswYdpvoNa2uNtKzsu7sZQW9kfeF7H2uLoJgAUdNRdKrNmUrofQ
C4E2CsI3wTQxE9gmWX+LRGKr9r6QF15es7KCEGuFlAToVCh/d6vXF0f9IaH0ZE05
6W4sfcYoj6HKHEcKONuh6codpRceKx6gPgh+2n0pdoUNNlz/AbO0is+SiIInILlI
dYSdTxPLK0fZxD+ufi2E9IaQ2VvRg0Y933pQvjn3xbCCk7xehM7TD55LlwfUWPGb
/ffeEgwsObhA0cmV3jN6+bvxM9Tbk7DSd4Q30fuqSy8od5Ih0i4=
=kFGv
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_9ac8834a_20250114_180504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-52

## Security Vulnerabilities fixed in Firefox 95

Announced
December 7, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 95

#### [#CVE-2021-43536: URL leakage when navigating while executing asynchronous function](#CVE-2021-43536)

Reporter
Sunwoo Kim and Youngmin Kim of SNU CompSec Lab
Impact
high
##### Description

Under certain circumstances, asynchronous functions could have caused a navigation to fail but expose the target URL.

##### References

* [Bug 1730120](https://bugzilla.mozilla.org/show_bug.cgi?id=1730120)

#### [#CVE-2021-43537: Heap buffer overflow when using structured clone](#CVE-2021-43537)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
high
##### Description

An incorrect type conversion of sizes from 64bit to 32bit integers allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1738237](https://bugzilla.mozilla.org/show_bug.cgi?id=1738237)

#### [#CVE-2021-43538: Missing fullscreen and pointer lock notification when requesting both](#CVE-2021-43538)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

By misusing a race in our notification code, an attacker could have forcefully hidden the notification for pages that had received full screen and pointer lock access, which could have been used for spoofing attacks.

##### References

* [Bug 1739091](https://bugzilla.mozilla.org/show_bug.cgi?id=1739091)

#### [#CVE-2021-43539: GC rooting failure when calling wasm instance methods](#CVE-2021-43539)

Reporter
Asumu Takikawa and Ioanna Dimitriou
Impact
high
##### Description

Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occurring within the call not tracing those live pointers. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1739683](https://bugzilla.mozilla.org/show_bug.cgi?id=1739683)

#### [#CVE-2021-4128: Use-after-free in fullscreen objects on MacOS](#CVE-2021-4128)

Reporter
Atila Butkovits
Impact
high
##### Description

When transitioning in and out of fullscreen mode, a graphics object was not correctly protected; resulting in memory corruption and a potentially exploitable crash.
*This bug only affects Firefox on MacOS. Other operating systems are unaffected.*

##### References

* [Bug 1735852](https://bugzilla.mozilla.org/show_bug.cgi?id=1735852)

#### [#CVE-2021-43540: WebExtensions could have installed persistent ServiceWorkers](#CVE-2021-43540)

Reporter
Jake Heath
Impact
moderate
##### Description

WebExtensions with the correct permissions were able to create and install ServiceWorkers for third-party websites that would not have been uninstalled with the extension.

##### References

* [Bug 1636629](https://bugzilla.mozilla.org/show_bug.cgi?id=1636629)

#### [#CVE-2021-43541: External protocol handler parameters were unescaped](#CVE-2021-43541)

Reporter
chriscla
Impact
moderate
##### Description

When invoking protocol handlers for external protocols, a supplied parameter URL containing spaces was not properly escaped.

##### References

* [Bug 1696685](https://bugzilla.mozilla.org/show_bug.cgi?id=1696685)

#### [#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler](#CVE-2021-43542)

Reporter
Raphael Smolik
Impact
moderate
##### Description

Using XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.

##### References

* [Bug 1723281](https://bugzilla.mozilla.org/show_bug.cgi?id=1723281)

#### [#CVE-2021-43543: Bypass of CSP sandbox directive when embedding](#CVE-2021-43543)

Reporter
Armin Ebert
Impact
moderate
##### Description

Documents loaded with the CSP sandbox directive could have escaped the sandbox's script restriction by embedding additional content.

##### References

* [Bug 1738418](https://bugzilla.mozilla.org/show_bug.cgi?id=1738418)

#### [#CVE-2021-43544: Receiving a malicious URL as text through a SEND intent could have led to XSS](#CVE-2021-43544)

Reporter
Irwan
Impact
moderate
##### Description

When receiving a URL through a SEND intent, Firefox would have searched for the text, but subsequent usages of the address bar might have caused the URL to load unintentionally, which could lead to XSS and spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1739934](https://bugzilla.mozilla.org/show_bug.cgi?id=1739934)

#### [#CVE-2021-43545: Denial of Service when using the Location API in a loop](#CVE-2021-43545)

Reporter
Paul ZÃ¼hlcke
Impact
low
##### Description

Using the Location API in a loop could have caused severe application hangs and crashes.

##### References

* [Bug 1720926](https://bugzilla.mozilla.org/show_bug.cgi?id=1720926)

#### [#CVE-2021-43546: Cursor spoofing could overlay user interface when native cursor is zoomed](#CVE-2021-43546)

Reporter
Daniel Veditz
Impact
low
##### Description

It was possible to recreate previous cursor spoofing attacks against users with a zoomed native cursor.

##### References

* [Bug 1737751](https://bugzilla.mozilla.org/show_bug.cgi?id=1737751)

#### [#CVE-2021-4129: Memory safety bugs fixed in Firefox 95 and Firefox ESR 91.4](#CVE-2021-4129)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julian Hector, Randell Jesup, Gabriele Svelto, Tyson Smith, Christian Holler, and Masayuki Nakano reported memory safety bugs present in Firefox 94. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 95](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1393362%2C1736046%2C1736751%2C1737009%2C1739372%2C1739421)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_9a0822d3_20250114_180505.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-54

## Security Vulnerabilities fixed in Thunderbird 91.4.0

Announced
December 7, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.4

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-43536: URL leakage when navigating while executing asynchronous function](#CVE-2021-43536)

Reporter
Sunwoo Kim and Youngmin Kim of SNU CompSec Lab
Impact
high
##### Description

Under certain circumstances, asynchronous functions could have caused a navigation to fail but expose the target URL.

##### References

* [Bug 1730120](https://bugzilla.mozilla.org/show_bug.cgi?id=1730120)

#### [#CVE-2021-43537: Heap buffer overflow when using structured clone](#CVE-2021-43537)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
high
##### Description

An incorrect type conversion of sizes from 64bit to 32bit integers allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1738237](https://bugzilla.mozilla.org/show_bug.cgi?id=1738237)

#### [#CVE-2021-43538: Missing fullscreen and pointer lock notification when requesting both](#CVE-2021-43538)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

By misusing a race in our notification code, an attacker could have forcefully hidden the notification for pages that had received full screen and pointer lock access, which could have been used for spoofing attacks.

##### References

* [Bug 1739091](https://bugzilla.mozilla.org/show_bug.cgi?id=1739091)

#### [#CVE-2021-43539: GC rooting failure when calling wasm instance methods](#CVE-2021-43539)

Reporter
Asumu Takikawa and Ioanna Dimitriou
Impact
high
##### Description

Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occurring within the call not tracing those live pointers. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1739683](https://bugzilla.mozilla.org/show_bug.cgi?id=1739683)

#### [#CVE-2021-43541: External protocol handler parameters were unescaped](#CVE-2021-43541)

Reporter
chriscla
Impact
moderate
##### Description

When invoking protocol handlers for external protocols, a supplied parameter URL containing spaces was not properly escaped.

##### References

* [Bug 1696685](https://bugzilla.mozilla.org/show_bug.cgi?id=1696685)

#### [#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler](#CVE-2021-43542)

Reporter
Raphael Smolik
Impact
moderate
##### Description

Using XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.

##### References

* [Bug 1723281](https://bugzilla.mozilla.org/show_bug.cgi?id=1723281)

#### [#CVE-2021-43543: Bypass of CSP sandbox directive when embedding](#CVE-2021-43543)

Reporter
Armin Ebert
Impact
moderate
##### Description

Documents loaded with the CSP sandbox directive could have escaped the sandbox's script restriction by embedding additional content.

##### References

* [Bug 1738418](https://bugzilla.mozilla.org/show_bug.cgi?id=1738418)

#### [#CVE-2021-43545: Denial of Service when using the Location API in a loop](#CVE-2021-43545)

Reporter
Paul ZÃ¼hlcke
Impact
low
##### Description

Using the Location API in a loop could have caused severe application hangs and crashes.

##### References

* [Bug 1720926](https://bugzilla.mozilla.org/show_bug.cgi?id=1720926)

#### [#CVE-2021-43546: Cursor spoofing could overlay user interface when native cursor is zoomed](#CVE-2021-43546)

Reporter
Daniel Veditz
Impact
low
##### Description

It was possible to recreate previous cursor spoofing attacks against users with a zoomed native cursor.

##### References

* [Bug 1737751](https://bugzilla.mozilla.org/show_bug.cgi?id=1737751)

#### [#CVE-2021-43528: JavaScript unexpectedly enabled for the composition area](#CVE-2021-43528)

Reporter
Pedro Batista
Impact
low
##### Description

Thunderbird unexpectedly enabled JavaScript in the composition area.
The JavaScript execution context was limited to this area and did not
receive chrome-level privileges, but could be used as a stepping stone
to further an attack with other vulnerabilities.

##### References

* [Bug 1742579](https://bugzilla.mozilla.org/show_bug.cgi?id=1742579)

#### [#CVE-2021-4129: Memory safety bugs fixed in Thunderbird 91.4.0](#CVE-2021-4129)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julian Hector, Randell Jesup, Gabriele Svelto, Tyson Smith, Christian Holler, and Masayuki Nakano reported memory safety bugs present in Thunderbird 91.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.4.0](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1393362%2C1736046%2C1736751%2C1737009%2C1739372%2C1739421)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_710f37d2_20250114_180502.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 2863-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2863-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Wed, 29 Dec 2021 15:08:44 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211229140844.4D47C2A01EC%40andromeda)Â [20211229140844.4D47C2A01EC@andromeda](msg00030.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2863-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2021                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 91.4.1esr-1~deb9u1
CVE ID         : CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43534 CVE-2021-43535
                 CVE-2021-43536 CVE-2021-43537 CVE-2021-43538 CVE-2021-43539
                 CVE-2021-43541 CVE-2021-43542 CVE-2021-43543 CVE-2021-43545
                 CVE-2021-43546

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

For Debian 9 stretch, these problems have been fixed in version
91.4.1esr-1~deb9u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHMa+gACgkQnUbEiOQ2
gwJ1fxAAlShXtzdoIbA8nzTMODGnFqcZlcbnLRBJHRz2wqooV8AQfyzMqoZH9Ac+
iZPZ0hsK94j4CfGv+HjIJDag3xrqifKRmNu+C7EDp6A85a0jtu34OlKu4GcDeGO+
4D+cLd4ODc9qxSGT9DoMrqEhX8AHZbIBMq9ULcFtJziqlkRJQgjJ7VHnboI8phR3
kPjVead/5ktIjM9/ke3XL2dmKsT/8eUV3V1BkIpReZhMkqvHfMjXU0OYj9KX3nRe
6NHmoiNVTGhEmXGZ+YyVPSg3vQ60rs9VVKgDryBA8nqvZDmb4V+cNXXeE3mc2ytK
bLdE/diLNL2hVtmXrx3j7DAuieXV5GKGOhvx+OtOU4wgxnnzT5JO4gu0taOUSOlp
RY8CJjJC8MwkGbmvzfIImzWY0a7OrjyX1CalYs/Liv8pGP8xYzjM5hzGXE9P1HhP
Ap+ES6j5TeYEzIlUM8YmtdYOnDu1ae5a+FUUIHtMZY9B9+AypY1qq7XJx69KNyLK
dyERuMDhVohNRMdim7enVZeePyfLsE5Ywexaw0YgiHMJSSLWdPRuy1U/X9JN+1op
mT66RRdNl64maq3ZkSOjmyzNM7zpsYZ3hsXX6U2DkqGsc+Q3xlb4/ncRriJx4rZO
8bN0h9L3Zobb4ItOVSI4BvqMNYh0oKCBRNhp8O2Uj0bIxNCHvhg=
=pQH3
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_d669cd63_20250114_180503.html ===


---

[[Date Prev](msg00211.html)][[Date Next](msg00213.html)]
[[Thread Prev](msg00211.html)][[Thread Next](msg00213.html)]
[[Date Index](maillist.html#00212)]
[[Thread Index](threads.html#00212)]

# [SECURITY] [DSA 5026-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5026-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 19 Dec 2021 15:23:09 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20211219152309.GA28709%40seger.debian.org)Â [20211219152309.GA28709@seger.debian.org](msg00212.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5026-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 19, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2021-43546 CVE-2021-43545 CVE-2021-43543 CVE-2021-43542
                 CVE-2021-43541 CVE-2021-43539 CVE-2021-43538 CVE-2021-43537
                 CVE-2021-43536 CVE-2021-43535 CVE-2021-43534 CVE-2021-38509
                 CVE-2021-38508 CVE-2021-38507 CVE-2021-38506 CVE-2021-38504
                 CVE-2021-38503

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

Between 78.x and 91.x, Firefox has seen a number of feature updates. For
more information please refer to
<https://www.mozilla.org/en-US/firefox/91.0esr/releasenotes/>

For the oldstable distribution (buster) one more final toolchain update
is needed, updated packages will shortly be available as 91.4.1esr-1~deb10u1

For the stable distribution (bullseye), these problem have been fixed in
version 91.4.1esr-1~deb11u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmG/ThkACgkQEMKTtsN8
TjYUEhAAqvtyXOssLe1+WtXdIeDNPCq4SCVnqKiVx2k+CJ8UVD1+NRGP0c4lRWG+
jORSEG+/iTcglfPKWb36Wly+xTafkZ5H1//SJCECwMCg6aq6EqlFZM50g6o6zOr/
szad8i/Dirh0G08AMzoab3VIm1RdlXmcZ6HWlaD59zMTm5ZakzikIX1rWhM0KPq4
dU9Pp3nwkcBlKmY90VTr3QGxOaolu1tes+y2r7ZwP8ZhVSFYV5wkPVAgvS9ybSih
yAvxVlB9f/aYjnfo4kzKBhZENoFz/h9qdp8hg00DI7Olw0WJkmU6soDh75FqJ4j4
XMzYAWEqnDyxFpU9t+RBUPFMNFERc/iVFDQaIuF6WDq2ud7Pzpj+byvSsL5kuaob
k4PMHv/SSLVrMWlsj9nO0ee9ih60W+FTIIjhz9Kt2zwY1OX+CBsxWOK86VEJk+7R
m30yhAvJMjqjZtBICF6bvv9ny+FYixQb8rCpRh172NpBlMC8pB0ypvWL4Y4iJK5n
Tj5zmL8iGDYrsZnqgIs5MThM5HLAw4vzBAPfQOB7PDyeWnj+uT+oYcPqOuxIB17Y
FHbIKxjGSMqdWtq/FZ9iP9Sga45hanlMEmu0UZqXFfMKXCY6/cVPk7k5l9vRmwXt
ds+PzAROBdEY2A9KXrct9bXRXdboOj2s2fpgaLU+SPy4xqEN2/I=
=AqRn
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_41826682_20250114_180502.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1739683)
* [XML](/show_bug.cgi?ctype=xml&id=1739683)

Closed
[Bug 1739683](/show_bug.cgi?id=1739683)
(CVE-2021-43539)

Opened 3 years ago
Closed 3 years ago

# Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls

## Categories

### (Core :: JavaScript: WebAssembly, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20WebAssembly#JavaScript%3A%20WebAssembly)

JavaScript: WebAssembly
â–¾

Core :: JavaScript: WebAssembly
Implementation of the WebAssembly (wasm) standard, including compilation and runtime support.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20WebAssembly)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

96 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [95+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=95%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox94 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix) |
| firefox95 | [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed) |
| firefox96 | [+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 95+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox94 |  | wontfix |
| firefox95 | + | fixed |
| firefox96 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: asumu, Assigned: asumu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6ffcd6697f8ede5e344bade7a9778eff?d=mm&size=40)  [asumu](/user_profile?user_id=640839)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6ffcd6697f8ede5e344bade7a9778eff?d=mm&size=40)  [asumu](/user_profile?user_id=640839)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8db6b22eadf9c098ae78e6d0d0615e29?d=mm&size=40)  [rhunt](/user_profile?user_id=573202)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[wasm-jit-bugs](/show_bug.cgi?id=1728518 "NEW - [meta] Wasm JIT-bugs")

Dependency [tree](/showdependencytree.cgi?id=1739683&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1739683)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [sec-survey][adv-main95+][adv-ESR91.4.0+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-43539

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][adv-main95+][adv-ESR91.4.0+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1556072_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | [qe-verify](#a1776392_458186 "3 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls](/attachment.cgi?id=9249520)  [3 years ago](#c3)  [Asumu Takikawa](/user_profile?user_id=640839)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c16 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c19 "3 years ago")  tjr : [sec-approval+](#c12 "3 years ago") | [Details](/attachment.cgi?id=9249520&action=edit) | [Review](/attachment.cgi?id=9249520) |
| --- | --- | --- |
| [Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. r=rhunt](/attachment.cgi?id=9249521)  [3 years ago](#c4)  [Asumu Takikawa](/user_profile?user_id=640839)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9249521&action=edit) | [Review](/attachment.cgi?id=9249521) |
| [advisory.txt](/attachment.cgi?id=9253450)  [3 years ago](#c21)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   185 bytes, text/plain |  | [Details](/attachment.cgi?id=9253450&action=edit) |
| [advisory.txt](/attachment.cgi?id=9253572)  [3 years ago](#c23)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   335 bytes, text/plain |  | [Details](/attachment.cgi?id=9253572&action=edit) |
| [advisory.txt](/attachment.cgi?id=9253577)  [3 years ago](#c25)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   334 bytes, text/plain |  | [Details](/attachment.cgi?id=9253577&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1739683#c0)â€¢ 3 years ago |
|  | |

The following Wasm jit-test test case triggers a crash in Ion:

```
// crash.js
gczeal(2, 1); // Collect on every allocation.

let exports = wasmEvalText(
  `(module
     (table $tab (export "tab") 5 externref)
     (elem declare funcref (ref.func $g))
     (func $g)
     (func $f (export "f") (param externref) (result)
       (ref.func $g) ;; force a collection via allocation in instance call
                     ;; stack map is not at the right offset as failure mode is FailOnInvalidRef
       (ref.is_null)
       (if
         (then)
         ;; crashes here due to GC happening above
         ;; at this point the externref on stack is a poisoned value
         (else (i32.const 0) (local.get 0) (table.set $tab)))
       )
     )`,
  {}
).exports;
exports.f("foo");

```

Running this produces a crash like the following

```
$ mach jit-test --ion crash.js
Assertion failure: ThreadId::ThisThreadId() == owningThread_, at /home/asumu/mozilla-unified/js/src/threading/Mutex.cpp:63
UndefinedBehaviorSanitizer:DEADLYSIGNAL
==28940==ERROR: UndefinedBehaviorSanitizer: SEGV on unknown address 0x000000000000 (pc 0x557b685d175c bp 0x7ffec0503ba0 sp 0x7ffec0503b70 T28940)
==28940==The signal is caused by a WRITE memory access.
==28940==Hint: address points to the zero page.

```

This is reduced from another test case (in exception handling Ion code) where it was more obvious that the `externref` parameter to the function `$f` is getting collected and overwritten with a poisoned value, but you can see in gdb that the externref is overwritten with `0x2F` (`JS_FRESH_NURSERY_PATTERN`) if you break in the `tableSet` method.

What appears to be happening is that stack maps for Ion calls to Wasm instance method calls are not being installed correctly (at the right offset), so they are not actually looked up during GC. The GC then misses roots in the stack frame. This happens on methods where the failure mode is not `Infallible`, as there are some error handling instructions inserted between the call return point and the location of the `LSafepoint`.

I'll attach a patch that should fix the offsets later.

I think it is difficult to trigger this bug without gczeal turned on, but I've marked this as a security bug just in case.

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1739683#c1)â€¢ 3 years ago |
|  | |

Note: this particular test case seems to only crash on debug builds, and observing the memory poisoning also requires having debug on so it's difficult to tell if something bad is happening on non-debug builds.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1739683#c2)â€¢ 3 years ago |
|  | |

Stack map problem with reftypes.

Severity: -- â†’ S3Priority: -- â†’ P1

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1739683#c3)â€¢ 3 years ago |
|  | |

Attached file
[Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls](attachment.cgi?id=9249520)
â€” [Details](attachment.cgi?id=9249520&action=edit)

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1739683#c4)â€¢ 3 years ago |
|  | |

Attached file
[Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. r=rhunt](attachment.cgi?id=9249521)
â€” [Details](attachment.cgi?id=9249521&action=edit)

Depends on D130527

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a18708_640839)â€¢ 3 years ago |

Assignee: nobody â†’ asumuStatus: NEW â†’ ASSIGNED

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1739683#c5)â€¢ 3 years ago |
|  | |

It sounds like a GC rooting issue, so I'm going to mark it sec-high.

Group: core-security â†’ javascript-core-securityKeywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1739683#c6)â€¢ 3 years ago |
|  | |

I can't tell yet if this is some corner case in not-yet-shipped code or a real emergency, will discuss with Ryan later today.

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1739683#c7)â€¢ 3 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1739683&comment_id=15649782 "1 revision") |
|  | |

Analysis:

* this is about wasm builtin calls only (other calls are ok)
* this is about ion only (baseline is ok)
* this is specific to builtin calls that can return an error *and* can trigger gc, probably only ref.func
* a pointer on the stack is not traced because the stackmap is not found by the gc because its location marker is off, if the correct phase of gc is triggered by the allocation in question
* an attacker could perhaps place many pointers on the stack in an attempt to get one that points to something interesting, but this will be hard to count on and will easily crash
* fission helps us (attack does not escape to other domains) but also hurts us (gc behavior may be less turbulent than it would be in the single-process browser)
* the issue is serious, we do uplifts all the way

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a336673_499633)â€¢ 3 years ago |

Flags: sec-bounty?

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1739683#c8)â€¢ 3 years ago |
|  | |

Obviously not asking for a bounty for myself, but for Asumu, if eligible. This is an important bug.

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1739683#c9)â€¢ 3 years ago |
|  | |

Comment on [attachment 9249520](/attachment.cgi?id=9249520 "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") [[details]](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls")

[Bug 1739683](/show_bug.cgi?id=1739683 "RESOLVED FIXED - Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls") - Fix code offset for safepoints on Wasm instance method calls

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Unsure, but my guess is not easily. The patch changes how we record offsets for stack maps for wasm calls so it could lead someone to suspect that certain calls could lead to the wrong stack map. From there they would have to figure out that it's only certain kinds, specifically just ref.func to our knowledge (see Lars' post). From there they would have to manage the heap non-determinism, as Lars again points out, to trigger a GC in the ref.func call that will collect an object they control on the stack and then allocate an object into the same pointer and then use it somehow.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely, we have good coverage of many stack map possible issues.
[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: sec-approval?

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1739683#c10)â€¢ 3 years ago |
|  | |

As marked in the security approval request, I think we should change the commit message to not mention safepoints nor builtin instance methods.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a434890_600971)â€¢ 3 years ago |

[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Attachment description: Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls â†’ Bug 1739683 - Fix code offset use in Wasm calls

|  | [Asumu Takikawa](/user_profile?user_id=640839)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1739683#c11)â€¢ 3 years ago |
|  | |

I retitled the patch given the above comments to not mention the details. Happy to adjust it again if needed.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1739683#c12)â€¢ 3 years ago |
|  | |

Comment on [attachment 9249520](/attachment.cgi?id=9249520 "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") [[details]](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls")

[Bug 1739683](/show_bug.cgi?id=1739683 "RESOLVED FIXED - Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls") - Fix code offset for safepoints on Wasm instance method calls

Approved to land and request uplift

[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Attachment description: Bug 1739683 - Fix code offset use in Wasm calls â†’ Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls
[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: sec-approval? â†’ sec-approval+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a859784_600971)â€¢ 3 years ago |

[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Attachment description: Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls â†’ Bug 1739683 - Fix code offset use in Wasm calls

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1739683#c13)â€¢ 3 years ago |
|  | |

Fix code offset use in Wasm calls r=rhunt,lth

<https://hg.mozilla.org/integration/autoland/rev/a972b4f1f667f9b5945d74ad351b429b6c5be9b7>

<https://hg.mozilla.org/mozilla-central/rev/a972b4f1f667>

Group: javascript-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 3 years ago
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 96 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1739683#c14)â€¢ 3 years ago |
|  | |

Please nominate this patch for Beta and ESR91 approval when you get a chance.

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix)
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox95](/buglist.cgi?f1=cf_tracking_firefox95&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B)
[tracking-firefox96](/buglist.cgi?f1=cf_tracking_firefox96&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- â†’ [95+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=95%2B)Flags: needinfo?(asumu)

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1739683#c15)â€¢ 3 years ago |
|  | |

Comment on [attachment 9249520](/attachment.cgi?id=9249520 "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") [[details]](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls")

[Bug 1739683](/show_bug.cgi?id=1739683 "RESOLVED FIXED - Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls") - Fix code offset for safepoints on Wasm instance method calls

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potentially exploitable GC rooting hazard due to stack maps issue.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Not risky, we have good coverage of many stack map possible issues.
* **String changes made/needed**:

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Potentially exploitable GC rooting hazard due to stack maps issue.
* **Fix Landed on Version**: 96
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Not risky, we have good coverage of many stack map possible issues.
* **String or UUID changes made by this patch**:
[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Attachment description: Bug 1739683 - Fix code offset use in Wasm calls â†’ Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls
[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: approval-mozilla-esr91?
[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1739683#c16)â€¢ 3 years ago |
|  | |

Comment on [attachment 9249520](/attachment.cgi?id=9249520 "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") [[details]](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls")

[Bug 1739683](/show_bug.cgi?id=1739683 "RESOLVED FIXED - Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls") - Fix code offset for safepoints on Wasm instance method calls

Approved for 95.0b9.

[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1739683#c17)â€¢ 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/22c44c7ac825>

[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1739683#c18)â€¢ 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1739683) to reply.

Flags: needinfo?(asumu)Whiteboard: [sec-survey]

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a1031869_573202)â€¢ 3 years ago |

Flags: needinfo?(asumu)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1739683#c19)â€¢ 3 years ago |
|  | |

Comment on [attachment 9249520](/attachment.cgi?id=9249520 "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") [[details]](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls")

[Bug 1739683](/show_bug.cgi?id=1739683 "RESOLVED FIXED - Crash in Wasm Ion code when gczeal is used with reference types and builtin instance method calls") - Fix code offset for safepoints on Wasm instance method calls

Approved for 91.4esr.

[Attachment #9249520](/attachment.cgi?id=9249520&action=edit "Bug 1739683 - Fix code offset for safepoints on Wasm instance method calls") -
Flags: approval-mozilla-esr91? â†’ approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1739683#c20)â€¢ 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/9ee936305e68>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a1556072_1689)â€¢ 3 years ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a1776392_458186)â€¢ 3 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a2308596_428608)â€¢ 3 years ago |

Whiteboard: [sec-survey] â†’ [sec-survey][adv-main95+][adv-ESR91.4.0+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1739683#c21)â€¢ 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9253450) (obsolete)
â€” [Details](attachment.cgi?id=9253450&action=edit)

My understanding of wasm and wasm instance methods is... limited. The advisory draft is addressing this by being very vague. It's generally OK if it's "vague but not wrong", but, can you review the advisory to make sure I'm not saying something incorrect or stupid? :)

Flags: needinfo?(lhansen)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1739683#c22)â€¢ 3 years ago |
|  | |

Hi Frederik, I think the advisory is probably misleading as it stands. A title like "GC rooting failure" with explanation "Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occuring within the call not tracing those live pointers. This could cause some live objects to be collected and the caller could later reference unused or reused memory. " would be comprehensive.

Flags: needinfo?(lhansen) â†’ needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1739683#c23)â€¢ 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9253572) (obsolete)
â€” [Details](attachment.cgi?id=9253572&action=edit)

Thanks, Lars!

I've added the relevant feature to the title and replaced your last sentence with our template sentence of "This can lead to a user-after-free causing a potentially exploitable crash."

[Attachment #9253450](/attachment.cgi?id=9253450&action=edit "advisory.txt") -
Attachment is obsolete: trueFlags: needinfo?(fbraun)

|  | [Lars T Hansen [:lth]](/user_profile?user_id=499633) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1739683#c24)â€¢ 3 years ago |
|  | |

That sounds good, though (nitpicking) I think the preferred spelling is "use-after-free"?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1739683#c25)â€¢ 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9253577)
â€” [Details](attachment.cgi?id=9253577&action=edit)

Oops. Thanks!

[Attachment #9253572](/attachment.cgi?id=9253572&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a2395247_428608)â€¢ 3 years ago |

Alias: CVE-2021-43539

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a25443000_1689)â€¢ 2 years ago |

Group: core-security-release

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a44657834_600971)â€¢ 2 years ago |

[Attachment #9249521](/attachment.cgi?id=9249521&action=edit "Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. r=rhunt") -
Attachment description: Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. â†’ WIP: Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a68611071_600971)â€¢ 1 year ago |

[Attachment #9249521](/attachment.cgi?id=9249521&action=edit "Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. r=rhunt") -
Attachment description: WIP: Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. â†’ Bug 1739683 - Add gczeal test for Wasm instance call safepoint issue. r=rhunt

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1739683#c26)â€¢ 1 year ago |
|  | |

Pushed by rhunt@eqrion.net:
<https://hg.mozilla.org/integration/autoland/rev/3637a0367fb6>
Add gczeal test for Wasm instance call safepoint issue. r=lth

|  | [Sandor Molnar[:smolnar]](/user_profile?user_id=670045) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1739683#c27)â€¢ 1 year ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/3637a0367fb6>

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739683#a80953075_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1739683&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Asumu Takikawa](/user_profile?user_id=640839)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_067c0658_20250114_180503.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities â€” GLSA **202208-14**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-91.12.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-91.12.0"

```
### References

* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-29967](https://nvd.nist.gov/vuln/detail/CVE-2021-29967)
* [CVE-2021-29969](https://nvd.nist.gov/vuln/detail/CVE-2021-29969)
* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38492](https://nvd.nist.gov/vuln/detail/CVE-2021-38492)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-40529](https://nvd.nist.gov/vuln/detail/CVE-2021-40529)
* [CVE-2021-43528](https://nvd.nist.gov/vuln/detail/CVE-2021-43528)
* [CVE-2021-43529](https://nvd.nist.gov/vuln/detail/CVE-2021-43529)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0566](https://nvd.nist.gov/vuln/detail/CVE-2022-0566)
* [CVE-2022-1196](https://nvd.nist.gov/vuln/detail/CVE-2022-1196)
* [CVE-2022-1197](https://nvd.nist.gov/vuln/detail/CVE-2022-1197)
* [CVE-2022-1520](https://nvd.nist.gov/vuln/detail/CVE-2022-1520)
* [CVE-2022-1529](https://nvd.nist.gov/vuln/detail/CVE-2022-1529)
* [CVE-2022-1802](https://nvd.nist.gov/vuln/detail/CVE-2022-1802)
* [CVE-2022-1834](https://nvd.nist.gov/vuln/detail/CVE-2022-1834)
* [CVE-2022-2200](https://nvd.nist.gov/vuln/detail/CVE-2022-2200)
* [CVE-2022-2226](https://nvd.nist.gov/vuln/detail/CVE-2022-2226)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* [CVE-2022-24713](https://nvd.nist.gov/vuln/detail/CVE-2022-24713)
* [CVE-2022-26381](https://nvd.nist.gov/vuln/detail/CVE-2022-26381)
* [CVE-2022-26383](https://nvd.nist.gov/vuln/detail/CVE-2022-26383)
* [CVE-2022-26384](https://nvd.nist.gov/vuln/detail/CVE-2022-26384)
* [CVE-2022-26386](https://nvd.nist.gov/vuln/detail/CVE-2022-26386)
* [CVE-2022-26387](https://nvd.nist.gov/vuln/detail/CVE-2022-26387)
* [CVE-2022-26485](https://nvd.nist.gov/vuln/detail/CVE-2022-26485)
* [CVE-2022-26486](https://nvd.nist.gov/vuln/detail/CVE-2022-26486)
* [CVE-2022-28281](https://nvd.nist.gov/vuln/detail/CVE-2022-28281)
* [CVE-2022-28282](https://nvd.nist.gov/vuln/detail/CVE-2022-28282)
* [CVE-2022-28285](https://nvd.nist.gov/vuln/detail/CVE-2022-28285)
* [CVE-2022-28286](https://nvd.nist.gov/vuln/detail/CVE-2022-28286)
* [CVE-2022-28289](https://nvd.nist.gov/vuln/detail/CVE-2022-28289)
* [CVE-2022-29909](https://nvd.nist.gov/vuln/detail/CVE-2022-29909)
* [CVE-2022-29911](https://nvd.nist.gov/vuln/detail/CVE-2022-29911)
* [CVE-2022-29912](https://nvd.nist.gov/vuln/detail/CVE-2022-29912)
* [CVE-2022-29913](https://nvd.nist.gov/vuln/detail/CVE-2022-29913)
* [CVE-2022-29914](https://nvd.nist.gov/vuln/detail/CVE-2022-29914)
* [CVE-2022-29916](https://nvd.nist.gov/vuln/detail/CVE-2022-29916)
* [CVE-2022-29917](https://nvd.nist.gov/vuln/detail/CVE-2022-29917)
* [CVE-2022-31736](https://nvd.nist.gov/vuln/detail/CVE-2022-31736)
* [CVE-2022-31737](https://nvd.nist.gov/vuln/detail/CVE-2022-31737)
* [CVE-2022-31738](https://nvd.nist.gov/vuln/detail/CVE-2022-31738)
* [CVE-2022-31740](https://nvd.nist.gov/vuln/detail/CVE-2022-31740)
* [CVE-2022-31741](https://nvd.nist.gov/vuln/detail/CVE-2022-31741)
* [CVE-2022-31742](https://nvd.nist.gov/vuln/detail/CVE-2022-31742)
* [CVE-2022-31747](https://nvd.nist.gov/vuln/detail/CVE-2022-31747)
* [CVE-2022-34468](https://nvd.nist.gov/vuln/detail/CVE-2022-34468)
* [CVE-2022-34470](https://nvd.nist.gov/vuln/detail/CVE-2022-34470)
* [CVE-2022-34472](https://nvd.nist.gov/vuln/detail/CVE-2022-34472)
* [CVE-2022-34478](https://nvd.nist.gov/vuln/detail/CVE-2022-34478)
* [CVE-2022-34479](https://nvd.nist.gov/vuln/detail/CVE-2022-34479)
* [CVE-2022-34481](https://nvd.nist.gov/vuln/detail/CVE-2022-34481)
* [CVE-2022-34484](https://nvd.nist.gov/vuln/detail/CVE-2022-34484)
* [CVE-2022-36318](https://nvd.nist.gov/vuln/detail/CVE-2022-36318)
* [CVE-2022-36319](https://nvd.nist.gov/vuln/detail/CVE-2022-36319)
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

August 10, 2022

**Latest revision**

August 10, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [794085](https://bugs.gentoo.org/show_bug.cgi?id=794085)
* [802759](https://bugs.gentoo.org/show_bug.cgi?id=802759)
* [807943](https://bugs.gentoo.org/show_bug.cgi?id=807943)
* [811912](https://bugs.gentoo.org/show_bug.cgi?id=811912)
* [813501](https://bugs.gentoo.org/show_bug.cgi?id=813501)
* [822294](https://bugs.gentoo.org/show_bug.cgi?id=822294)
* [828539](https://bugs.gentoo.org/show_bug.cgi?id=828539)
* [831040](https://bugs.gentoo.org/show_bug.cgi?id=831040)
* [833520](https://bugs.gentoo.org/show_bug.cgi?id=833520)
* [834805](https://bugs.gentoo.org/show_bug.cgi?id=834805)
* [845057](https://bugs.gentoo.org/show_bug.cgi?id=845057)
* [846596](https://bugs.gentoo.org/show_bug.cgi?id=846596)
* [849047](https://bugs.gentoo.org/show_bug.cgi?id=849047)
* [857048](https://bugs.gentoo.org/show_bug.cgi?id=857048)
* [864577](https://bugs.gentoo.org/show_bug.cgi?id=864577)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_c71d4ad5_20250114_180503.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DSA 5034-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5034-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 2 Jan 2022 17:01:50 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20220102170150.GA31860%40seger.debian.org)Â [20220102170150.GA31860@seger.debian.org](msg00000.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5034-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
January 02, 2022                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For the oldstable distribution (buster), these problems have been fixed
in version 1:91.4.1-1~deb10u1.

For the stable distribution (bullseye), these problems have been fixed in
version 1:91.4.1-1~deb11u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmHR2XsACgkQEMKTtsN8
TjYd7w//ak0oRg6eCbfKob7RuhyUJ+6VsRhi4OUhuJBn78TsdwY6RWn63FZLqR0k
zUPM77KHdbL1dBE4Cphijqk8SQWAiWjKY0qceTA0QLJD3in9ZeyZQ3pGElynfRfQ
b42lYuAeo04CxKxgdrvHcLtDTfVFTWTUS7bwB7uzufu5AwflESPJuDW+e98nG0Nh
8lP/jBk6MpPJ4+smPQY2TeRyicd+a5C7JIe1dZAh7MhDJ+KJ2n1/1K3DUUR2eCo/
MYlw00nXs/Vr1BJxwWxSfl9ahxUcOWQWZ8SjtvIJTJXSjw1RoP+1Vefln7rpKgDH
2rUbsWJwS5B/83e2mDvsatgCZPNVsecMDrvWWVoctJm652pdqIAXvBxtyncoSm+S
Wmn5gdGec9IHXSUty1wO2pXrbfUKtr3H5qtyoesDBvhlXrYeyI5jNYTrO6V493le
j0WmZC0sypibI1jMOfOR68BYeDVl7kz737e6I4OoaNg4UUbXXBPgDOdFBaODt9ql
egTHI2wMCuszUBUo3PfVp1pyvb2Lnr27NisQNU2rvDV/MSXba3tsEUXj+ka4UVQZ
XcAUEcWKUVBn4utbJQJ81k3/KbVsAo0emN9cSM3z4opHpkmLGeyyvvPMwE8+Y/FM
RqFfsn4wRGDgwOZyGCWZ9NERvQ/r+DeBWp/Ca5Cw1fyho/4mFQY=
=jRWO
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_c6198758_20250114_180504.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-53

## Security Vulnerabilities fixed in Firefox ESR 91.4.0

Announced
December 7, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.4

#### [#CVE-2021-43536: URL leakage when navigating while executing asynchronous function](#CVE-2021-43536)

Reporter
Sunwoo Kim and Youngmin Kim of SNU CompSec Lab
Impact
high
##### Description

Under certain circumstances, asynchronous functions could have caused a navigation to fail but expose the target URL.

##### References

* [Bug 1730120](https://bugzilla.mozilla.org/show_bug.cgi?id=1730120)

#### [#CVE-2021-43537: Heap buffer overflow when using structured clone](#CVE-2021-43537)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
high
##### Description

An incorrect type conversion of sizes from 64bit to 32bit integers allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1738237](https://bugzilla.mozilla.org/show_bug.cgi?id=1738237)

#### [#CVE-2021-43538: Missing fullscreen and pointer lock notification when requesting both](#CVE-2021-43538)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

By misusing a race in our notification code, an attacker could have forcefully hidden the notification for pages that had received full screen and pointer lock access, which could have been used for spoofing attacks.

##### References

* [Bug 1739091](https://bugzilla.mozilla.org/show_bug.cgi?id=1739091)

#### [#CVE-2021-43539: GC rooting failure when calling wasm instance methods](#CVE-2021-43539)

Reporter
Asumu Takikawa and Ioanna Dimitriou
Impact
high
##### Description

Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occurring within the call not tracing those live pointers. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1739683](https://bugzilla.mozilla.org/show_bug.cgi?id=1739683)

#### [#CVE-2021-43541: External protocol handler parameters were unescaped](#CVE-2021-43541)

Reporter
chriscla
Impact
moderate
##### Description

When invoking protocol handlers for external protocols, a supplied parameter URL containing spaces was not properly escaped.

##### References

* [Bug 1696685](https://bugzilla.mozilla.org/show_bug.cgi?id=1696685)

#### [#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler](#CVE-2021-43542)

Reporter
Raphael Smolik
Impact
moderate
##### Description

Using XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.

##### References

* [Bug 1723281](https://bugzilla.mozilla.org/show_bug.cgi?id=1723281)

#### [#CVE-2021-43543: Bypass of CSP sandbox directive when embedding](#CVE-2021-43543)

Reporter
Armin Ebert
Impact
moderate
##### Description

Documents loaded with the CSP sandbox directive could have escaped the sandbox's script restriction by embedding additional content.

##### References

* [Bug 1738418](https://bugzilla.mozilla.org/show_bug.cgi?id=1738418)

#### [#CVE-2021-43545: Denial of Service when using the Location API in a loop](#CVE-2021-43545)

Reporter
Paul ZÃ¼hlcke
Impact
low
##### Description

Using the Location API in a loop could have caused severe application hangs and crashes.

##### References

* [Bug 1720926](https://bugzilla.mozilla.org/show_bug.cgi?id=1720926)

#### [#CVE-2021-43546: Cursor spoofing could overlay user interface when native cursor is zoomed](#CVE-2021-43546)

Reporter
Daniel Veditz
Impact
low
##### Description

It was possible to recreate previous cursor spoofing attacks against users with a zoomed native cursor.

##### References

* [Bug 1737751](https://bugzilla.mozilla.org/show_bug.cgi?id=1737751)

#### [#CVE-2021-4129: Memory safety bugs fixed in Firefox 95 and Firefox ESR 91.4](#CVE-2021-4129)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julian Hector, Randell Jesup, Gabriele Svelto, Tyson Smith, Christian Holler, and Masayuki Nakano reported memory safety bugs present in Firefox 94 and Firefox ESR 91.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 95 and Firefox ESR 91.4](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1393362%2C1736046%2C1736751%2C1737009%2C1739372%2C1739421)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


