=== Content from github.com_5881c38c_20250114_220349.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Freleases%2Ftag%2Fv1.18.5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Freleases%2Ftag%2Fv1.18.5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB/tree/v1.18.5)
* [Issues
  153](/NodeBB/NodeBB/issues)
* [Pull requests
  30](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB/tree/v1.18.5)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

1. [Releases](/NodeBB/NodeBB/releases)
2. [v1.18.5](/NodeBB/NodeBB/releases/tag/v1.18.5)

# v1.18.5

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/NodeBB/NodeBB/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.18.5)

 Loading

[View all tags](/NodeBB/NodeBB/tags)

![@nodebb-misty](https://avatars.githubusercontent.com/u/7928251?s=40&v=4)
[nodebb-misty](/nodebb-misty)
released this
27 Oct 16:48

Â·
[5334 commits](/NodeBB/NodeBB/compare/v1.18.5...master)
to master
since this release

[v1.18.5](/NodeBB/NodeBB/tree/v1.18.5)

[`c28ac8e`](/NodeBB/NodeBB/commit/c28ac8ec52910c4f9fffec5fb11de2705126c790)

ðŸš¨ This release contains security patches. You are advised to upgrade to this version as soon as possible.

Release build (patch) of NodeBB @ 2021-10-27T16:47:58.522Z

#### v1.18.5 (2021-10-27)

##### Breaking Changes

* disable javascript in custom less tab ([719cfc0](https://github.com/NodeBB/NodeBB/commit/719cfc0d578aedb5acdf2b920cfaae323c2ef6fc))

##### Chores

* up themes ([463b207](https://github.com/NodeBB/NodeBB/commit/463b2076a605ee6eaa868219c4c9f0833c485b39))
* up persona ([1438f40](https://github.com/NodeBB/NodeBB/commit/1438f40984da530bb403f34bed3bcfc4d4d9c888))
* incrementing version number - v1.18.4 ([945c2b0](https://github.com/NodeBB/NodeBB/commit/945c2b0b8a242db398b7c39200a3c361d284d102))
* update changelog for v1.18.4 ([7cbcb52](https://github.com/NodeBB/NodeBB/commit/7cbcb5215180be9eac09ddb20bf848e064be8793))
* **deps:**
  + update dependency lint-staged to v11.2.6 ([8d4bb8b](https://github.com/NodeBB/NodeBB/commit/8d4bb8bbbede04d2a5c0081c028a9653f4407d4f))
  + update dependency lint-staged to v11.2.5 ([0728a99](https://github.com/NodeBB/NodeBB/commit/0728a99453283a37b85e08be9ab287acbd310878))
  + update dependency lint-staged to v11.2.4 ([f76a788](https://github.com/NodeBB/NodeBB/commit/f76a78829084842b69795e84ff722a30e7b1b6b8))
  + update dependency husky to v7.0.4 ([2a3e13f](https://github.com/NodeBB/NodeBB/commit/2a3e13f360e0ef9ad9256f787c97b0ef2231908a))
  + update dependency mocha to v9.1.3 ([4784f01](https://github.com/NodeBB/NodeBB/commit/4784f016a7b5748dad6e51820a8baa6c81aceb56))
  + update dependency eslint-plugin-import to v2.25.2 ([3c3f45d](https://github.com/NodeBB/NodeBB/commit/3c3f45d91bb1b1c4710b3a260b16510afe2c89ca))
  + update dependency jsdom to v18 ([4b8dcd4](https://github.com/NodeBB/NodeBB/commit/4b8dcd4c2bfe4a41edfd251091f0ba9770547439))
  + update dependency eslint-plugin-import to v2.25.1 ([7c4aebb](https://github.com/NodeBB/NodeBB/commit/7c4aebbdf0a7bc42bbe4ff8ae2994155a54f6a8d))
  + update dependency lint-staged to v11.2.3 ([288b545](https://github.com/NodeBB/NodeBB/commit/288b5456f73c1a3be4f8c44f72ebae48bb972340))
  + update dependency lint-staged to v11.2.2 ([f96c8c4](https://github.com/NodeBB/NodeBB/commit/f96c8c4db03f21af900ba4ff0e60628c32333f87))
  + update dependency @commitlint/cli to v13.2.1 ([52c38a1](https://github.com/NodeBB/NodeBB/commit/52c38a1dc8501c9401c26aed38d31230626e26c4))
  + update dependency lint-staged to v11.2.1 ([022e8df](https://github.com/NodeBB/NodeBB/commit/022e8df03564139bb6883e6ef93f08fe7cd1b102))
  + update dependency eslint-config-nodebb to v0.0.3 ([4b92df8](https://github.com/NodeBB/NodeBB/commit/4b92df821b852724b4ac7c317f9e6d6ec20c2978))
* **i18n:**
  + fallback strings for new resources: nodebb.admin-settings-email, nodebb.error ([9b68dc3](https://github.com/NodeBB/NodeBB/commit/9b68dc37cccaf7cdfcb3af2f164962cb7d1e6547))
  + fallback strings for new resources: nodebb.admin-dashboard ([ff962b5](https://github.com/NodeBB/NodeBB/commit/ff962b5ddf2c14cde6e6c8bc9ce13636d7e459cf))
  + fallback strings for new resources: nodebb.admin-dashboard, nodebb.admin-menu ([abe5913](https://github.com/NodeBB/NodeBB/commit/abe59131dd8c7bd443d7d74089d13b63dcab501a))
  + fallback strings for new resources: nodebb.admin-manage-digest, nodebb.admin-settings-user, nodebb.user ([2bed40b](https://github.com/NodeBB/NodeBB/commit/2bed40bed057046ed482ac65efecc9f652684c00))

##### Documentation Changes

* update verbiage re: login API route (94c4f87b)

##### New Features

* new ACP option `emailPrompt` ... which allows administrators to disable the client-side prompt to encourage users to enter or confirm their email addresses ([80ea12c](https://github.com/NodeBB/NodeBB/commit/80ea12c1c1963f5b39fb64841e4f3c8da3c87af2))
* show popular searches ([f4cf482](https://github.com/NodeBB/NodeBB/commit/f4cf482a874701ce80c0f306c49d8788cec66f87))
* new plugin hook to allow plugins to reject email address on new registration or email change ([6b4f35c](https://github.com/NodeBB/NodeBB/commit/6b4f35c2fab7e64357db5220e73127bfe98a15f8))
* utilities login API route now starts an actual login session, if requested ([806a1e5](https://github.com/NodeBB/NodeBB/commit/806a1e50d25163799d6b4339da739f3e37f73f1e))
* add method name to deprecation message ([b91ae08](https://github.com/NodeBB/NodeBB/commit/b91ae0880d29fd5ba47d6ac6163eb600ec09bfee))
* quote tooltip ([66fca4e](https://github.com/NodeBB/NodeBB/commit/66fca4e066034a9606bd718d4025c27e749be4f8))
* additional quality options for jpeg uploads, added quality and compression settings for png uploads ([d22b076](https://github.com/NodeBB/NodeBB/commit/d22b076b2eeffd401cc6decb060f8eda8854562a))
* [#8053](https://github.com/NodeBB/NodeBB/issues/8053), biweekly digest option ([f7967bd](https://github.com/NodeBB/NodeBB/commit/f7967bdf68235c963cd2123ed563ccd4465054f3))
* core submit button dropdown ([605a538](https://github.com/NodeBB/NodeBB/commit/605a53812e9a54688e1cf2db0e66c3cb934e1228))
* added failing i18n tests ([35af763](https://github.com/NodeBB/NodeBB/commit/35af7634183fe1c97483b75feed210e737ff0f1d))
* confirm before deleting all events ([#9875](https://github.com/NodeBB/NodeBB/pull/9875)) ([56d05b4](https://github.com/NodeBB/NodeBB/commit/56d05b4e86d28a8434467eb787c6536e68112805))

##### Bug Fixes

* **deps:**
  + update dependency nodebb-theme-vanilla to v12.1.7 ([#9944](https://github.com/NodeBB/NodeBB/pull/9944)) ([bf20965](https://github.com/NodeBB/NodeBB/commit/bf20965f0bd68a46de4de4e3f274a6fbffa28073))
  + update dependency nodebb-theme-persona to v11.2.19 ([#9943](https://github.com/NodeBB/NodeBB/pull/9943)) ([bcf85fc](https://github.com/NodeBB/NodeBB/commit/bcf85fcfba64ef0a91df9979331b3c6caa0d0f39))
  + update dependency nodebb-rewards-essentials to v0.2.0 ([7c2ecb1](https://github.com/NodeBB/NodeBB/commit/7c2ecb1234c7111087e554f9bca3a0aa974b6137))
  + update dependency nodebb-theme-vanilla to v12.1.6 ([49b8b98](https://github.com/NodeBB/NodeBB/commit/49b8b983b642652a0f9638a7bd142a48f6d06c5d))
  + update dependency nodebb-theme-persona to v11.2.18 ([ed0adf2](https://github.com/NodeBB/NodeBB/commit/ed0adf2ccf49988b8878d51c7d6da3512ca565d2))
  + update dependency nodebb-theme-persona to v11.2.17 ([7866107](https://github.com/NodeBB/NodeBB/commit/78661079887adf851e495eedf6dcb5c0a6cbcfc8))
  + update dependency postcss to v8.3.11 ([a5f4e20](https://github.com/NodeBB/NodeBB/commit/a5f4e206816d1467812aedf53a96a0fead727e63))
  + update dependency nodebb-theme-vanilla to v12.1.5 ([d74a6bd](https://github.com/NodeBB/NodeBB/commit/d74a6bd35ed62f784c564b8fca9305c8c0f457c9))
  + update dependency sharp to v0.29.2 ([8b8fe39](https://github.com/NodeBB/NodeBB/commit/8b8fe393039e180ed64f39a084fc131f34157621))
  + update dependency postcss to v8.3.10 ([b18a24e](https://github.com/NodeBB/NodeBB/commit/b18a24e97bea687f2a62441a70c4ec5036aa791e))
  + update dependency nodebb-theme-persona to v11.2.15 ([f3c8d7d](https://github.com/NodeBB/NodeBB/commit/f3c8d7da8e3f6291c585ef5e8c68807dc5c8da76))
  + update dependency nodebb-theme-persona to v11.2.14 ([#9919](https://github.com/NodeBB/NodeBB/pull/9919)) ([5e08e67](https://github.com/NodeBB/NodeBB/commit/5e08e67b0eec8254d8b40d4919b1bd3a97245614))
  + update dependency socket.io-client to v4.3.2 ([deba3e2](https://github.com/NodeBB/NodeBB/commit/deba3e27521ccbbae5ed9d5e1568d1d822a8714a))
  + update dependency socket.io to v4.3.1 ([e1554f6](https://github.com/NodeBB/NodeBB/commit/e1554f619abb8b09afa63a17ddedbf563db28aef))
  + update socket.io packages ([ce5a0a2](https://github.com/NodeBB/NodeBB/commit/ce5a0a21134cc3f93889e822eb27b0063f3d1ff9))
  + update dependency nodebb-plugin-spam-be-gone to v0.7.10 ([600a872](https://github.com/NodeBB/NodeBB/commit/600a872031eee9d62f95142dfce091e5170143ad))
  + update dependency nodebb-plugin-composer-default to v7.0.10 ([b0128f8](https://github.com/NodeBB/NodeBB/commit/b0128f85722d8d7fb972647a6173a5bda8140d9a))
  + update dependency nodebb-plugin-markdown to v8.14.4 ([f8f35d7](https://github.com/NodeBB/NodeBB/commit/f8f35d7e7e0ff1a26149e3fe5bc6c7e3f7667525))
  + update dependency nodebb-plugin-composer-default to v7.0.9 ([ed87466](https://github.com/NodeBB/NodeBB/commit/ed87466208e2aba56278a3727ac80f73501631f7))
  + update dependency nodebb-theme-persona to v11.2.13 ([1dba75e](https://github.com/NodeBB/NodeBB/commit/1dba75e9c96d12b40d15977fe9abfab069bbee05))
  + update dependency ioredis to v4.28.0 ([4ff5452](https://github.com/NodeBB/NodeBB/commit/4ff5452d6f2e936e3070e1af4db9f726b4885622))
  + update dependency nodebb-theme-persona to v11.2.12 ([fe9f82f](https://github.com/NodeBB/NodeBB/commit/fe9f82f6b44fe4d60ad82e1fc252d9c49bdda56c))
  + update dependency ioredis to v4.27.11 ([6d2e0aa](https://github.com/NodeBB/NodeBB/commit/6d2e0aa97074a46cd752041f6cc0e0b98eb4f24c))
  + update dependency nodebb-plugin-mentions to v2.14.1 ([820f8cd](https://github.com/NodeBB/NodeBB/commit/820f8cdf87b66dad8ca1bb297b855191fa6abbe8))
  + update dependency jquery-ui to v1.13.0 ([b0eb2ae](https://github.com/NodeBB/NodeBB/commit/b0eb2aed0e934e835cedccda37a7a71d43fefa26))
* remove loading="lazy", fixes inf. scroll loaded images ([0157278](https://github.com/NodeBB/NodeBB/commit/015727855f1b57083685b2dce0114673fadd159c))
* windows tests ([25ebbd6](https://github.com/NodeBB/NodeBB/commit/25ebbd6563931a9ed548254eb10ae143ac060356))
* undefined query showing in searches ([6cfaea0](https://github.com/NodeBB/NodeBB/commit/6cfaea06f03c04676c86e847bcc27fcb7c032af9))
* don't repeat search if on same page ([89f5e06](https://github.com/NodeBB/NodeBB/commit/89f5e06bbf84a9b19dca7f2dcefd38ebb2ecc412))
* api session revoke test ([0926ae6](https://github.com/NodeBB/NodeBB/commit/0926ae6ecf28390cc3dd31f51af59c716ec618f7))
* crash ([da64810](https://github.com/NodeBB/NodeBB/commit/da64810a4a87260a2d5dfd032b934eb0d1b69748))
* add missing translation ([eb075c7](https://github.com/NodeBB/NodeBB/commit/eb075c7328f07f839ee4d887eced6839477390fa))
* move record to controller ([ee8e048](https://github.com/NodeBB/NodeBB/commit/ee8e048015576a81b96df6fe57cd4308df24c5b4))
* profile edit fields showing translated values ([63572c2](https://github.com/NodeBB/NodeBB/commit/63572c23ce366feac56a380126af631bebba048c))
* [#9934](https://github.com/NodeBB/NodeBB/issues/9934), fix translator test ([8d316d1](https://github.com/NodeBB/NodeBB/commit/8d316d1859af6fdca95dc158c3009d99873484d0))
* token verify ([04dab1d](https://github.com/NodeBB/NodeBB/commit/04dab1d550cdebf4c1567bca9a51f8b9ca48a500))
* guard against prototype pollution ([1783f91](https://github.com/NodeBB/NodeBB/commit/1783f918bc19568f421473824461ff2ed7755e4c))
* translator path traversal ([c8b2fc4](https://github.com/NodeBB/NodeBB/commit/c8b2fc46dc698db687379106b3f01c71b80f495f))
* there is no alltime digest, fixes translation in test email ([e62948f](https://github.com/NodeBB/NodeBB/commit/e62948f73d5e6ede68e86c65f9efcf3e21536eeb))
* clicking outside postContainer should close tooltip ([47df62e](https://github.com/NodeBB/NodeBB/commit/47df62e7003c5e73e8ff6957bd9f1f73e7dacb34))
* minification regression ([998b9e7](https://github.com/NodeBB/NodeBB/commit/998b9e7918d6fb2f78e3232e946b5273f12032aa))
* tooltip ([fec7ebe](https://github.com/NodeBB/NodeBB/commit/fec7ebed043edd692f231a25634b287429cd758d))
* biweekly digest [#8053](https://github.com/NodeBB/NodeBB/issues/8053) ([9cb4de5](https://github.com/NodeBB/NodeBB/commit/9cb4de50a257719ca398edb6089b10d461b3617a))
* restore plugin upgrade checking logic ([4468739](https://github.com/NodeBB/NodeBB/commit/44687394dc7c77bbe5ed1f48545aeb0adbbd1e6c))
* fallbacks for new langauge key ([ed4ebd2](https://github.com/NodeBB/NodeBB/commit/ed4ebd22774629886e99cee554c52143a4448a07))
* [#9917](https://github.com/NodeBB/NodeBB/issues/9917), show topics as unread for guests ([4333d21](https://github.com/NodeBB/NodeBB/commit/4333d217a1f4d9dc401305330e69833b28d98bbe))
* clarify site settings urls vs config.json url ([#9912](https://github.com/NodeBB/NodeBB/pull/9912)) ([6436aa6](https://github.com/NodeBB/NodeBB/commit/6436aa65ad2ddd109913cd0e570fff6747175ef5))
* clarify SMTP enable toggle ([#9911](https://github.com/NodeBB/NodeBB/pull/9911)) ([09f198f](https://github.com/NodeBB/NodeBB/commit/09f198fc374cdaf926407035af72d9587b8a49ce))
* don't overwrite reloadRequired with false ([9e0ce02](https://github.com/NodeBB/NodeBB/commit/9e0ce0272ca50c4c6275e25240500d0e13bdafed))
* delete translations in admin/general folder (since general was removed and relocated elsewhere) ([b460e59](https://github.com/NodeBB/NodeBB/commit/b460e5909c43d91690b43a9e94a8f6f61228ce83))
* pushed missing key to tx and pulled fallbacks ([21b6108](https://github.com/NodeBB/NodeBB/commit/21b610826c1427ec31df1eb56876d970c6cefde6))
* adding missing language namespace "top" ([0f9b0b7](https://github.com/NodeBB/NodeBB/commit/0f9b0b7846d5811ff16849000cccce873e33552b))
* extra debug log ([bd893cd](https://github.com/NodeBB/NodeBB/commit/bd893cdaa3cd7d1105467563d3c01981757629c7))
* have renovate add `dependencies` label to its PRs ([eddb986](https://github.com/NodeBB/NodeBB/commit/eddb98681c8100ca978e8bb6062001b4e30b68d4))
* no global bootbox ([#9879](https://github.com/NodeBB/NodeBB/pull/9879)) ([227456f](https://github.com/NodeBB/NodeBB/commit/227456fb1786cb23be635dada3c901a1be4cc3fe))
* [#9872](https://github.com/NodeBB/NodeBB/issues/9872) update app badge with notification count if applicable ([3e69bcd](https://github.com/NodeBB/NodeBB/commit/3e69bcdf1f995b0123118285383c62ccf09b0e13))
* better nomenclature ([c1149d0](https://github.com/NodeBB/NodeBB/commit/c1149d045c37e38bda08958a782b3f36f0f6a918))
* html attributes ([#9877](https://github.com/NodeBB/NodeBB/pull/9877)) ([3acaac4](https://github.com/NodeBB/NodeBB/commit/3acaac4c7c8d6420a75b5f73fa3964ed352f573f))
* escape thumbs, allow robots meta tag ([4f9717f](https://github.com/NodeBB/NodeBB/commit/4f9717fb08cc0dd3d49e6a89e5ed16ebe4a6f2b0))
* missing translations ([#9876](https://github.com/NodeBB/NodeBB/pull/9876)) ([7935bd9](https://github.com/NodeBB/NodeBB/commit/7935bd9efbe572afd27285007515efba50ac7384))

##### Performance Improvements

* dont fs.open if plugin doesnt have language namespace ([#9893](https://github.com/NodeBB/NodeBB/pull/9893)) ([1feb111](https://github.com/NodeBB/NodeBB/commit/1feb111ade0b8aa4ecbf3b0f5775d42a33b52927))

##### Refactors

* wider value field ([c428ba8](https://github.com/NodeBB/NodeBB/commit/c428ba80aa85bcf9bacfa370ff934f1f5a8ee0d2))
* dont save partial searches ([c7e078d](https://github.com/NodeBB/NodeBB/commit/c7e078d4950ef874f73f4d8668a88d6d31c11e9a))
* use search api for topic search ([6419273](https://github.com/NodeBB/NodeBB/commit/64192731a0144c727340bbc6d111d55d7012bf9c))
* slowdown quick search ([19ee717](https://github.com/NodeBB/NodeBB/commit/19ee717444da35374cb9c7d6677c78a0a6c6fc62))
* typo ([a528790](https://github.com/NodeBB/NodeBB/commit/a5287906151cf9a54bcc04b347592aeb2954e9e9))
* add callback to loadNotifications ([f02fba2](https://github.com/NodeBB/NodeBB/commit/f02fba29dcc2e233c527bd4783c316fbd123bed8))
* simplified utilities API > login rout ([506c34a](https://github.com/NodeBB/NodeBB/commit/506c34a84dc5753dc663fa46ffbb563a7a9dce34))
* log error as well ([1d62bd6](https://github.com/NodeBB/NodeBB/commit/1d62bd6d7b6de45a1a13ee9e4548b670729bccd4))
* catch errors from buildHeader in error handler ðŸ”¥ ([73a9ca0](https://github.com/NodeBB/NodeBB/commit/73a9ca09c972de14523e095f02644c12d2b244b0))
* add missing helpers.tryRoute ([d4da984](https://github.com/NodeBB/NodeBB/commit/d4da98404c83d08a6a7bfabb815641d15dea5160))
* shorter middleware ([ee0282f](https://github.com/NodeBB/NodeBB/commit/ee0282f5aaed75cb20dcdc3f29e19636c9ca3322))
* meta/minifier use async/await ([b2429ef](https://github.com/NodeBB/NodeBB/commit/b2429ef00e45c558625d340461542d0c488519ba))
* remove unused var ([90b8126](https://github.com/NodeBB/NodeBB/commit/90b81262fa217d8271f2df747f9a10595ddc3552))
* catch errors from digest ([8e319a9](https://github.com/NodeBB/NodeBB/commit/8e319a9b250b585d740e6b361c0099949ec7e6b6))
* less.render returns promise ([14bc83a](https://github.com/NodeBB/NodeBB/commit/14bc83a88ec574da6d4bf056444bdbb2c663dbfa))
* less.render already returns promise ([6da3239](https://github.com/NodeBB/NodeBB/commit/6da3239230f64d2869b0c5700db1bc77d76e6ce0))
* prompt.get already returns promise ([c70eaa0](https://github.com/NodeBB/NodeBB/commit/c70eaa0a34be0969081fed6d9333f4fa437c89a5))
* no need for async/callbacks ([057d1d5](https://github.com/NodeBB/NodeBB/commit/057d1d58e3c790b6968abe7534f984fc1aacbfac))
* no more ðŸ® ([38756a0](https://github.com/NodeBB/NodeBB/commit/38756a0c34a62a0541706c69074643fc556ae213))
* allow array of uids for blocks.is/list ([a9bc6a0](https://github.com/NodeBB/NodeBB/commit/a9bc6a0962dd4fcb79b9f54184f1c9de557b8c6e))
* show full url on error log ([8e6bd7e](https://github.com/NodeBB/NodeBB/commit/8e6bd7e913b0afd624a99ef910a168df0551f627))
* var to const and let ([#9885](https://github.com/NodeBB/NodeBB/pull/9885)) ([b0a24d6](https://github.com/NodeBB/NodeBB/commit/b0a24d6dd5c3631389ce03683ca725c1084aa934))
* remove unused code ([997fb2b](https://github.com/NodeBB/NodeBB/commit/997fb2b348372e90daa8c76d52bba5a147ed3974))
* remove unused colorpicker ([543d852](https://github.com/NodeBB/NodeBB/commit/543d85212b634764ed9352bd97e4ce66070028c6))

##### Reverts

* lazy load ([3d1cf16](https://github.com/NodeBB/NodeBB/commit/3d1cf168f269d674c83904e12ea2c33693ae25b8))

##### Tests

* fix broken openapi3 schema ([7ef5214](https://github.com/NodeBB/NodeBB/commit/7ef5214ef912bb9bd0eaead458d115ff497e3a84))
* restore commented-out i18n test ([fa1afbc](https://github.com/NodeBB/NodeBB/commit/fa1afbcf4a0c007473377b6d11409cbc47427555))
* moved topic event and topic thumb tests to subfolder for better organisation ([154ffea](https://github.com/NodeBB/NodeBB/commit/154ffea01b323ada1feb23d4bdb2e914ab59eb61))
* remove escape ([6c25b9d](https://github.com/NodeBB/NodeBB/commit/6c25b9dbaa974a23fa3613cd16743e0d792f1404))
* possible fix to timeout ([63109c0](https://github.com/NodeBB/NodeBB/commit/63109c070527946db0c5c06b67fddee21101abc7))
* increase timeout ([8654a99](https://github.com/NodeBB/NodeBB/commit/8654a996d374f5284febb4b6b58c9679b75f2902))

 Assets
2

 Loading

All reactions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_79c91f8b_20250114_220350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fsecurity%2Fadvisories%2FGHSA-hf2m-j98r-4fqw)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fsecurity%2Fadvisories%2FGHSA-hf2m-j98r-4fqw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB)
* [Issues
  153](/NodeBB/NodeBB/issues)
* [Pull requests
  30](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

# API token verification can be bypassed

Critical

[julianlam](/julianlam)
published
GHSA-hf2m-j98r-4fqw
Nov 27, 2021

## Package

nodebb

## Affected versions

1.15.0 - 1.18.4

## Patched versions

1.18.5

## Description

### Impact

Incorrect logic present in the token verification step unintentionally allowed master token access to the API.

### Patches

The vulnerability has been patch as of v1.18.5.

### Workarounds

Cherry-pick commit hash [04dab1d](https://github.com/NodeBB/NodeBB/commit/04dab1d550cdebf4c1567bca9a51f8b9ca48a500) to receive this patch in lieu of a full upgrade.

### For more information

If you have any questions or comments about this advisory:

* Email us at security@nodebb.org

### Severity

Critical

### CVE ID

CVE-2021-43786

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287)

### Credits

* [![@paul-gerste-sonarsource](https://avatars.githubusercontent.com/u/79814126?s=40&v=4)](/paul-gerste-sonarsource)
  [paul-gerste-sonarsource](/paul-gerste-sonarsource)
  Analyst

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_33261f2c_20250114_220347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F04dab1d550cdebf4c1567bca9a51f8b9ca48a500)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F04dab1d550cdebf4c1567bca9a51f8b9ca48a500)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NodeBB%2FNodeBB)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NodeBB](/NodeBB)
/
**[NodeBB](/NodeBB/NodeBB)**
Public

* [Notifications](/login?return_to=%2FNodeBB%2FNodeBB) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FNodeBB%2FNodeBB)
* [Star
   14.3k](/login?return_to=%2FNodeBB%2FNodeBB)

* [Code](/NodeBB/NodeBB)
* [Issues
  153](/NodeBB/NodeBB/issues)
* [Pull requests
  30](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects
  1](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

Additional navigation options

* [Code](/NodeBB/NodeBB)
* [Issues](/NodeBB/NodeBB/issues)
* [Pull requests](/NodeBB/NodeBB/pulls)
* [Actions](/NodeBB/NodeBB/actions)
* [Projects](/NodeBB/NodeBB/projects)
* [Wiki](/NodeBB/NodeBB/wiki)
* [Security](/NodeBB/NodeBB/security)
* [Insights](/NodeBB/NodeBB/pulse)

## Commit

[Permalink](/NodeBB/NodeBB/commit/04dab1d550cdebf4c1567bca9a51f8b9ca48a500)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: token verify

[Browse files](/NodeBB/NodeBB/tree/04dab1d550cdebf4c1567bca9a51f8b9ca48a500)
Browse the repository at this point in the history

* Loading branch information

[![@barisusakli](https://avatars.githubusercontent.com/u/2583394?s=40&v=4)](/barisusakli)

[barisusakli](/NodeBB/NodeBB/commits?author=barisusakli "View all commits by barisusakli")
committed
Oct 25, 2021

1 parent
[1783f91](/NodeBB/NodeBB/commit/1783f918bc19568f421473824461ff2ed7755e4c)

commit 04dab1d

Showing
**1 changed file**
with
**3 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

10 changes: 3 additions & 7 deletions

10
[src/routes/authentication.js](#diff-dcdf8faf45de1e74f36ce6b0a3ea30533e82b548413fbeb4ff3539493ed98142 "src/routes/authentication.js")

Show comments

[View file](/NodeBB/NodeBB/blob/04dab1d550cdebf4c1567bca9a51f8b9ca48a500/src/routes/authentication.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,13 +44,9 @@ Auth.getLoginStrategies = function () { |
|  |  | }; |
|  |  |  |
|  |  | Auth.verifyToken = async function (token, done) { |
|  |  | let { tokens = [] } = await meta.settings.get('core.api'); |
|  |  | tokens = tokens.reduce((memo, cur) => { |
|  |  | memo[cur.token] = cur.uid; |
|  |  | return memo; |
|  |  | }, {}); |
|  |  |  |
|  |  | const uid = tokens[token]; |
|  |  | const { tokens = [] } = await meta.settings.get('core.api'); |
|  |  | const tokenObj = tokens.find(t => t.token === token); |
|  |  | const uid = tokenObj ? tokenObj.uid : undefined; |
|  |  |  |
|  |  | if (uid !== undefined) { |
|  |  | if (parseInt(uid, 10) > 0) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `04dab1d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNodeBB%2FNodeBB%2Fcommit%2F04dab1d550cdebf4c1567bca9a51f8b9ca48a500) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from blog.sonarsource.com_1b6a9069_20250114_220345.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonarâ€™s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# NodeBB 1.18.4 - Remote Code Execution With One Shot

![](data:image/svg+xml;charset=utf-8...)![Paul Gerste photo]()![Paul Gerste photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/e712603b-cf90-4c56-a666-cd2691b3def2/404b3fe2-4818-41dc-bbe0-9cae851eb542_Paul_Gerste.jpg?w=800&h=800&auto=format&fit=crop)

Paul Gerste

Vulnerability Researcher

November 30, 2021

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We recently discovered three interesting code vulnerabilities in NodeBB 1.18.4, allowing attackers to compromise servers. Find out about the details in this article!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/db647ba1-7a21-4e50-b817-65bf50b314eb/cover-3bd121d8-10dd-4296-8027-ca31586c0eaa_RD-62%2BNodeBB%2B1.18.4%2BOne-Shot%2BRCE%25402x.png?w=2400&h=1256&auto=format&fit=crop)![We recently discovered three interesting code vulnerabilities in NodeBB 1.18.4, allowing attackers to compromise servers. Find out about the details in this article!](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/db647ba1-7a21-4e50-b817-65bf50b314eb/cover-3bd121d8-10dd-4296-8027-ca31586c0eaa_RD-62%2BNodeBB%2B1.18.4%2BOne-Shot%2BRCE%25402x.png?w=2400&h=1256&auto=format&fit=crop)

Message forums are used by many companies and open source projects to exchange with their users. NodeBB is the leading JavaScript-based forum solution, having over 12k stars on GitHub. Several popular companies are using NodeBB to establish a community around their flagship products.

During recent research, we discovered three vulnerabilities in NodeBB 1.18.4 that could allow attackers to take over NodeBB instances in various ways. In this article, we take a technical deep dive into these issues, describe how they can be abused by attackers, and show how such vulnerabilities can be prevented.

## Impact

Our findings impact NodeBB versions before 1.18.5 and can be summarized as follows:

* Read arbitrary JSON files (CVE-2021-43788)
* Take over user accounts via Cross-Site Scripting (CVE-2021-43787)
* Entirely bypass authentication for any user (CVE-2021-43786)

The final impact of these vulnerabilities is Remote Code Execution on a NodeBB server, regardless of its configuration. Attackers don't need an account or any information, they can directly attack any instance that is available on the internet.

## Technical Details

We will first describe a File Read vulnerability that can be used by attackers to leak sensitive data. We will then show how it can be combined with another vulnerability to perform a Cross-Site Scripting (XSS) attack that can spread from user to user. Finally, we will analyze a third vulnerability that would allow an unauthenticated attacker to execute commands on a NodeBB server using just a single request.

### Arbitrary JSON File Read (CVE-2021-43788)

In order to translate the user interface into a user's language, NodeBB uses translation tags in their templates which basically are identifiers that refer to a certain message that can then be loaded from the correct JSON file. They look likeÂ `[[namespace:key]]`, where theÂ `namespace`Â specifies the file and theÂ `key`Â describes a selector inside that file. These tags can be placed anywhere on a page and will be converted into a message when the page is rendered, either on the server- or the client-side. Such functionality is usually calledÂ *i18n*, short forÂ *internationalization*, and can be seen in many projects.

As an example, the tagÂ `[[global:403.title]]`Â would correspond to the messageÂ *Access Denied*Â in the following file located atÂ `language/en-US/global.json`Â when using theÂ `en-US`Â locale:

```
{
  "403.title": "Access Denied"
}

```

When resolving the file that corresponds to a tag's namespace, the following function is called ([src/languages.js](https://github.com/NodeBB/NodeBB/blob/v1.18.4/src/languages.js#L15-L24 "src/languages.js")):

```
Languages.get = async function (language, namespace) {
    const data = await fs.promises.readFile(
        path.join(languagesPath, language, `${namespace}.json`),
        'utf8'
    );
    const parsed = JSON.parse(data) || {};
    // [...]
    return parsed;
};
```

It uses theÂ `namespace`Â parameter to build a file system path, but the resulting path is not checked to be located in the translation directory. This leads to a Path Traversal vulnerability. It allows an attacker to read any JSON file from the file system, as long as it has theÂ `.json`Â file extension and contains valid JSON data. To extract a certain value from such a file, the attacker can use theÂ `key`Â portion of a translation tag to specify which property should be read.

This could, for example, be used to read the application's configuration which is stored in a JSON file. The config can contain database credentials or a session secret that is used to sign and verify cookies. Depending on the system that NodeBB runs on, there could be even more interesting files to read.

While there is no intended way for users to use arbitrary translation tags when they interact with a NodeBB site, there are some occasions where it is still possible. One example is the generation of HTML meta tags during the rendering of a page. When NodeBB creates the value for theÂ `og:url`Â meta tag, the current URL's path and query are used without proper sanitization, effectively reflecting their value into the server's response ([src/meta/tags.js](https://github.com/NodeBB/NodeBB/blob/v1.18.4/src/meta/tags.js#L170-L171 "src/meta/tags.js")):

```
// [...]
const ogUrl = url + (req.originalUrl !== '/' ? stripRelativePath(req.originalUrl) : '');
addIfNotExists(meta, 'property', 'og:url', ogUrl);
// [...]
```

While special HTML characters are escaped, the square brackets that start and end a translation tag are passed through as-is. This allows specifying a URL that includes a translation tag, which is then converted to its corresponding value later during rendering of the response. Attackers can use this to exploit the Path Traversal and read sensitive data. The following screenshot demonstrates how an attacker would read an instance's session secret:

### Wormable Cross-Site Scripting (CVE-2021-43787)

In the previous section, we showed that attackers can use translation tags to include sensitive data into a page by using a Path Traversal issue. The same issue can also be exploited in a different way, resulting in a Cross-Site Scripting (XSS) attack that can spread from user to user.

If an attacker manages to includeÂ *controlled*Â data into a page by abusing translation, then they could include arbitrary HTML and JavaScript because the sanitization is performed before the tags are translated. The only thing required for this is a method to write attacker-controlled data into a JSON file that will have a known path.

NodeBB allows users to export their user profile, posts, and uploaded content. When exporting a profile, the data gets written into a JSON file with a predictable path. The file will be located atÂ `build/export/UID_profile.json`Â whereÂ `UID`Â corresponds to the user that exported their profile. Since a user can enter almost anything on their profile, this is enough to create a payload that can then be inserted into a page.

To exploit this, an attacker would first create an account and insert a JavaScript payload into one of their profile fields. They would then export their profile, causing the payload to be included in a JSON file. Then, they would change their profile once again, this time including a translation tag that points to the exported profile file using the Path Traversal described previously. After that, the payload would execute every time someone visits the attacker's user profile or any of their posts if they used the signature field for the exploit.

The attacker can even create a payload that infects each user account that visits the attacker's profile. This would include the payload in the victim's profile too, making it spread from user to user until every account is taken over. Since this would inevitably reach an admin account, it is a powerful attack that can eventually lead to the takeover of the whole NodeBB instance.

### API Authentication Bypass (CVE-2021-43786)

Next to its web UI, NodeBB also features a REST API. This API can either be used with cookie authentication, i.e. with the usual login session, or with API tokens. These tokens can be created by administrators and they have a corresponding user ID. If the specified user ID of a token isÂ `0`Â then this token will be considered to be aÂ *master token*. Such tokens can be used to perform actions on behalf of any user, including administrators, by specifying a user ID in theÂ `_uid`Â query parameter of each request.

These tokens can then be used as a regularÂ [Bearer token](https://datatracker.ietf.org/doc/html/rfc6750#section-2.1 "Bearer token")Â by including them in theÂ `Authorization`Â header of a request. NodeBB then checks each request's token using the following function:

```
 1   Auth.verifyToken = async function (token, done) {
 2   let { tokens = [] } = await meta.settings.get('core.api');
 3       tokens = tokens.reduce((memo, cur) => {
 4           memo[cur.token] = cur.uid;
 5           return memo;
 6       }, {});
 7
 8       const uid = tokens[token];
 9
10       if (uid !== undefined) {
11           if (parseInt(uid, 10) > 0) {
12               done(null, {
13                   uid: uid,
14               });
15           } else {
16               done(null, {
17                   master: true,
18               });
19           }
20       } else {
21           done(false);
22       }
23   };
```

When the tokens are loaded in line 2, they are stored in an array where each item is an object that has aÂ `token`Â and aÂ `uid`Â property. These tokens are then merged into an object (lines 3-6), where the key is a token and the value is the corresponding user ID. Example of such a merge:

```
[
  { token: '793a561', uid: 42 },
  { token: '1a444cf', uid: 1337 },
]
// becomes:
{
  '793a561': 42,
  '1a444cf': 1337,
}
```

The lookup then happens in line 8 by using the provided token to access a property and checking if its value is undefined. The vulnerability lies in the way theÂ `tokens`Â object is created and how the lookup works: since theÂ `tokens`Â object is created using an object literal (`{}`) in line 6, it inherits all properties fromÂ `Object.prototype`, such asÂ `toString`Â orÂ `constructor`. Since the lookup checks if a property is present by using the provided token as the key (line 8), this also works for these inherited properties. As a result,Â `toString`,Â `constructor`*,*Â and all other keys of inherited properties are considered valid Bearer tokens.

The propertyâ€™s value is then passed intoÂ `parseInt()`Â to determine if this is a master token or a regular one. Since the values of the inherited properties are either functions or objects, they will all be parsed toÂ `NaN`, which is not greater thanÂ `0`. As a result, the authentication succeeds with theÂ `master`Â flag set toÂ `true`.

As discussed earlier, master tokens allow specifying the user ID that should be used for a request via theÂ `_uid`Â query parameter. Attackers can use IDÂ `1`Â because it usually belongs to an admin user, or they can list the members of theÂ *Administrator*Â user group. Since the authentication bypass works for every API call, attackers can use the whole admin API, which allows them to achieve Remote Code Execution (RCE).

Because this vulnerability is quite dangerous for unpatched instances, we won't go into detail about how to actually build the final RCE exploit. However, we can say that it requires only a single request, making it interesting for cybercriminals, so make sure to patch your instance.

## Patch

For the Path Traversal, the maintainers of NodeBB implemented the following fix, which is the recommended way of preventing such issues:

```
Languages.get = async function (language, namespace) {
    const pathToLanguageFile = path.join(languagesPath, language, `${namespace}.json`);
    if (!pathToLanguageFile.startsWith(languagesPath)) {
        throw new Error('[[error:invalid-path]]');
    }
    // ...
}
```

TheÂ `path.join()`Â call also normalizes the path, which then allows a simpleÂ `startsWith()`Â check to validate that the resulting path is pointing to a file inside the correct folder.

The XSS issue was also partly fixed by this because attackers could not use the Path Traversal to control the result of a translation. The maintainers also removed the ability to use translation tags in user profile fields, reducing the attack surface further.

Finally, the authentication bypass was fixed by skipping the conversion from array to object entirely and just searching the array for a matching entry:

```
Auth.verifyToken = async function (token, done) {
    const { tokens = [] } = await meta.settings.get('core.api');
    const tokenObj = tokens.find(t => t.token === token);
    const uid = tokenObj ? tokenObj.uid : undefined;
    // ...
};
```

To limit the impact of similar vulnerabilities that might occur in the future, the maintainers also secured the API endpoint that allowed attackers to execute code on the server.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2021-10-25 | We report all issues to NodeBB |
| 2021-10-25 | NodeBB confirms the issues |
| 2021-10-25 | NodeBB awards us with a $1536 bounty for the findings |
| 2021-10-27 | NodeBB 1.18.5 is released with patches for all issues |
| 2021-11-16 | CVE-2021-43786, CVE-2021-43787, and CVE-2021-43788 are assigned |

## Summary

In this article, we described three vulnerabilities we found in NodeBB 1.18.4 and what the underlying root cause was. We also explained how they could be used by attackers to gain Remote Code Execution capabilities on NodeBB instances. Finally, we described the mitigations implemented by the maintainers.

We would like to give big kudos to the NodeBB team! They took the issues very seriously and implemented and released patches very fast. Since the API authentication bypass can have a severe impact, we recommend updating to at least version 1.18.5 as soon as possible.

## Related Blog Posts

* [MyBB Remote Code Execution Chain](https://blog.sonarsource.com/mybb-remote-code-execution-chain "MyBB Remote Code Execution Chain")
* [Etherpad 1.8.13 - Code Execution Vulnerabilities](https://blog.sonarsource.com/etherpad-code-execution-vulnerabilities "Etherpad 1.8.13 - Code Execution Vulnerabilities")
* [SmartStoreNET - Malicious Message leading to E-Commerce Takeover](https://blog.sonarsource.com/smartstorenet-malicious-message-leading-to-e-commerce-takeoverhttps%3A// "SmartStoreNET - Malicious Message leading to E-Commerce Takeover")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

Â© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.


