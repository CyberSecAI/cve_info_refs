=== Content from discuss.hashicorp.com_92f0674b_20250114_190344.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-30 - Vault's Templated ACL Policies Matched First-Created Alias Per Entity and Auth Backend](/t/hcsec-2021-30-vaults-templated-acl-policies-matched-first-created-alias-per-entity-and-auth-backend/32132)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

November 18, 2021, 5:54pm

1

**Bulletin ID:** HCSEC-2021-30

**Affected Products / Versions:** Vault and Vault Enterprise 0.11.0 through 1.7.5 and 1.8.4; fixed in 1.7.6, 1.8.5 and 1.9.0.

**Publication Date:** November 18, 2021

**Summary**

Vault and Vault Enterprise (“Vault”) templated ACL policies would always match the first-created entity alias if multiple entity aliases existed for a specified entity and mount combination, potentially resulting in incorrect policy enforcement. This vulnerability, CVE-2021-43998, was fixed in Vault and Vault Enterprise 1.7.6, 1.8.5, and 1.9.0.

**Background**

Vault’s identity secrets engine is the identity management solution for Vault. It has the concept of entities which may have aliases for each mount accessor they use. Vault generally expects a single alias per entity and authentication backend.

There is additional information regarding these entity and alias concepts in Vault’s [Identity Secrets Engine documentation](https://www.vaultproject.io/docs/secrets/identity), and the [Identity: Entities and Groups tutorial](https://learn.hashicorp.com/tutorials/vault/identity). Additional information regarding templated ACL policies can be found in the [Templated Policies documentation](https://www.vaultproject.io/docs/concepts/policies#templated-policies), and the [ACL Policy Path Templating tutorial](https://learn.hashicorp.com/tutorials/vault/policy-templating).

**Details**

An external party reported that it was possible for a single entity to have multiple entity aliases for a same entity and mount combination when using templated ACL policies. It was observed that such cases may result in incorrect policies being applied; permissions of the first-created entity alias continue to be enforced, but will also be enforced for the newly-created alias.

As of 1.7.6, 1.8.5, and 1.9.0, Vault will now prevent the creation of new entity aliases if one already exists for a given entity and mount combination. Vault will also provide a warning to operators on startup, should multiple entity aliases exist for the same entity and mount combination: `One or more entities have multiple aliases on the same mount(s), remove duplicates to avoid ACL templating issues`.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault or Vault Enterprise 1.7.6, 1.8.5, or 1.9.0. Please refer to [Upgrading Vault](https://www.vaultproject.io/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by Christian Baumann and Nick Triller who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

January 6, 2022, 6:30pm

2

**Update Regarding Risk Scoring**

The CVSS score originally published to the NIST [NVD](https://nvd.nist.gov/) for this issue was 9.1 (Critical), with a vector string [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N&version=3.1).

In contrast, HashiCorp’s internal CVSS scoring was 5.9 (Medium), with a vector string [CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N&version=3.1).

To exploit this vulnerability, an attacker requires write permissions to the `identity/entity-alias` endpoint, generally reserved to privileged Vault operators. In most cases, it is likely that such a user would be able to legitimately and directly assign themselves those policies without needing to exploit this vulnerability. As a result, we’ve assessed both attack complexity and privileges required as high.

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2021-27 - Vault Merging Multiple Entity Aliases for the Same Mount May Allow Privilege Escalation](https://discuss.hashicorp.com/t/hcsec-2021-27-vault-merging-multiple-entity-aliases-for-the-same-mount-may-allow-privilege-escalation/30420)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 8196 | October 7, 2021 |
| [HCSEC-2022-18 - Vault Entity Alias Metadata May Leak Between Aliases With The Same Name Assigned To The Same Entity](https://discuss.hashicorp.com/t/hcsec-2022-18-vault-entity-alias-metadata-may-leak-between-aliases-with-the-same-name-assigned-to-the-same-entity/44550)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7720 | September 20, 2022 |
| [HCSEC-2024-21 - Vault Operators in Root Namespace May Elevate Their Privileges](https://discuss.hashicorp.com/t/hcsec-2024-21-vault-operators-in-root-namespace-may-elevate-their-privileges/70565)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 2385 | October 10, 2024 |
| [Question about certificate entity templating in policies](https://discuss.hashicorp.com/t/question-about-certificate-entity-templating-in-policies/37314)  [Vault](/c/vault/30) | 2 | 431 | March 23, 2022 |
| [HCSEC-2020-07 - Vault Enterprise Prefixed Mount Policies May Result In Unauthorized Namespace Access](https://discuss.hashicorp.com/t/hcsec-2020-07-vault-enterprise-prefixed-mount-policies-may-result-in-unauthorized-namespace-access/18090)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4117 | November 25, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from security.gentoo.org_58090d82_20250114_190345.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# HashiCorp Vault: Multiple Vulnerabilities — GLSA **202207-01**

Multiple vulnerabilities have been discovered in HashiCorp Vault, the worst of which could result in denial of service.

### Affected packages

| Package | **app-admin/vault** on all architectures |
| --- | --- |
| Affected versions | < **1.10.3** |
| Unaffected versions | >= **1.10.3** |

### Background

HashiCorp Vault is a tool for managing secrets.

### Description

Multiple vulnerabilities have been discovered in HashiCorp Vault. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All HashiCorp Vault users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/vault-1.10.3"

```
### References

* [CVE-2020-25594](https://nvd.nist.gov/vuln/detail/CVE-2020-25594)
* [CVE-2021-27668](https://nvd.nist.gov/vuln/detail/CVE-2021-27668)
* [CVE-2021-3024](https://nvd.nist.gov/vuln/detail/CVE-2021-3024)
* [CVE-2021-3282](https://nvd.nist.gov/vuln/detail/CVE-2021-3282)
* [CVE-2021-32923](https://nvd.nist.gov/vuln/detail/CVE-2021-32923)
* [CVE-2021-37219](https://nvd.nist.gov/vuln/detail/CVE-2021-37219)
* [CVE-2021-38553](https://nvd.nist.gov/vuln/detail/CVE-2021-38553)
* [CVE-2021-38554](https://nvd.nist.gov/vuln/detail/CVE-2021-38554)
* [CVE-2021-41802](https://nvd.nist.gov/vuln/detail/CVE-2021-41802)
* [CVE-2021-43998](https://nvd.nist.gov/vuln/detail/CVE-2021-43998)
* [CVE-2021-45042](https://nvd.nist.gov/vuln/detail/CVE-2021-45042)
* [CVE-2022-25243](https://nvd.nist.gov/vuln/detail/CVE-2022-25243)
* [CVE-2022-30689](https://nvd.nist.gov/vuln/detail/CVE-2022-30689)

**Release date**

July 29, 2022

**Latest revision**

July 29, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [768312](https://bugs.gentoo.org/show_bug.cgi?id=768312)
* [797244](https://bugs.gentoo.org/show_bug.cgi?id=797244)
* [808093](https://bugs.gentoo.org/show_bug.cgi?id=808093)
* [817269](https://bugs.gentoo.org/show_bug.cgi?id=817269)
* [827945](https://bugs.gentoo.org/show_bug.cgi?id=827945)
* [829493](https://bugs.gentoo.org/show_bug.cgi?id=829493)
* [835070](https://bugs.gentoo.org/show_bug.cgi?id=835070)
* [845405](https://bugs.gentoo.org/show_bug.cgi?id=845405)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


