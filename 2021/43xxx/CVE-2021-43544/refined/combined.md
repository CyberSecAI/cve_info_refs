=== Content from www.mozilla.org_9ac8834a_20250114_193618.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-52

## Security Vulnerabilities fixed in Firefox 95

Announced
December 7, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 95

#### [#CVE-2021-43536: URL leakage when navigating while executing asynchronous function](#CVE-2021-43536)

Reporter
Sunwoo Kim and Youngmin Kim of SNU CompSec Lab
Impact
high
##### Description

Under certain circumstances, asynchronous functions could have caused a navigation to fail but expose the target URL.

##### References

* [Bug 1730120](https://bugzilla.mozilla.org/show_bug.cgi?id=1730120)

#### [#CVE-2021-43537: Heap buffer overflow when using structured clone](#CVE-2021-43537)

Reporter
bo13oy of Cyber Kunlun Lab
Impact
high
##### Description

An incorrect type conversion of sizes from 64bit to 32bit integers allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1738237](https://bugzilla.mozilla.org/show_bug.cgi?id=1738237)

#### [#CVE-2021-43538: Missing fullscreen and pointer lock notification when requesting both](#CVE-2021-43538)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

By misusing a race in our notification code, an attacker could have forcefully hidden the notification for pages that had received full screen and pointer lock access, which could have been used for spoofing attacks.

##### References

* [Bug 1739091](https://bugzilla.mozilla.org/show_bug.cgi?id=1739091)

#### [#CVE-2021-43539: GC rooting failure when calling wasm instance methods](#CVE-2021-43539)

Reporter
Asumu Takikawa and Ioanna Dimitriou
Impact
high
##### Description

Failure to correctly record the location of live pointers across wasm instance calls resulted in a GC occurring within the call not tracing those live pointers. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1739683](https://bugzilla.mozilla.org/show_bug.cgi?id=1739683)

#### [#CVE-2021-4128: Use-after-free in fullscreen objects on MacOS](#CVE-2021-4128)

Reporter
Atila Butkovits
Impact
high
##### Description

When transitioning in and out of fullscreen mode, a graphics object was not correctly protected; resulting in memory corruption and a potentially exploitable crash.
*This bug only affects Firefox on MacOS. Other operating systems are unaffected.*

##### References

* [Bug 1735852](https://bugzilla.mozilla.org/show_bug.cgi?id=1735852)

#### [#CVE-2021-43540: WebExtensions could have installed persistent ServiceWorkers](#CVE-2021-43540)

Reporter
Jake Heath
Impact
moderate
##### Description

WebExtensions with the correct permissions were able to create and install ServiceWorkers for third-party websites that would not have been uninstalled with the extension.

##### References

* [Bug 1636629](https://bugzilla.mozilla.org/show_bug.cgi?id=1636629)

#### [#CVE-2021-43541: External protocol handler parameters were unescaped](#CVE-2021-43541)

Reporter
chriscla
Impact
moderate
##### Description

When invoking protocol handlers for external protocols, a supplied parameter URL containing spaces was not properly escaped.

##### References

* [Bug 1696685](https://bugzilla.mozilla.org/show_bug.cgi?id=1696685)

#### [#CVE-2021-43542: XMLHttpRequest error codes could have leaked the existence of an external protocol handler](#CVE-2021-43542)

Reporter
Raphael Smolik
Impact
moderate
##### Description

Using XMLHttpRequest, an attacker could have identified installed applications by probing error messages for loading external protocols.

##### References

* [Bug 1723281](https://bugzilla.mozilla.org/show_bug.cgi?id=1723281)

#### [#CVE-2021-43543: Bypass of CSP sandbox directive when embedding](#CVE-2021-43543)

Reporter
Armin Ebert
Impact
moderate
##### Description

Documents loaded with the CSP sandbox directive could have escaped the sandbox's script restriction by embedding additional content.

##### References

* [Bug 1738418](https://bugzilla.mozilla.org/show_bug.cgi?id=1738418)

#### [#CVE-2021-43544: Receiving a malicious URL as text through a SEND intent could have led to XSS](#CVE-2021-43544)

Reporter
Irwan
Impact
moderate
##### Description

When receiving a URL through a SEND intent, Firefox would have searched for the text, but subsequent usages of the address bar might have caused the URL to load unintentionally, which could lead to XSS and spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1739934](https://bugzilla.mozilla.org/show_bug.cgi?id=1739934)

#### [#CVE-2021-43545: Denial of Service when using the Location API in a loop](#CVE-2021-43545)

Reporter
Paul Zühlcke
Impact
low
##### Description

Using the Location API in a loop could have caused severe application hangs and crashes.

##### References

* [Bug 1720926](https://bugzilla.mozilla.org/show_bug.cgi?id=1720926)

#### [#CVE-2021-43546: Cursor spoofing could overlay user interface when native cursor is zoomed](#CVE-2021-43546)

Reporter
Daniel Veditz
Impact
low
##### Description

It was possible to recreate previous cursor spoofing attacks against users with a zoomed native cursor.

##### References

* [Bug 1737751](https://bugzilla.mozilla.org/show_bug.cgi?id=1737751)

#### [#CVE-2021-4129: Memory safety bugs fixed in Firefox 95 and Firefox ESR 91.4](#CVE-2021-4129)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julian Hector, Randell Jesup, Gabriele Svelto, Tyson Smith, Christian Holler, and Masayuki Nakano reported memory safety bugs present in Firefox 94. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 95](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1393362%2C1736046%2C1736751%2C1737009%2C1739372%2C1739421)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_ff18882e_20250114_193615.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1739934)
* [XML](/show_bug.cgi?ctype=xml&id=1739934)

Closed
[Bug 1739934](/show_bug.cgi?id=1739934)
(CVE-2021-43544)

Opened 3 years ago
Closed 3 years ago

# social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app

## Categories

### (Fenix :: General, defect)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox94 wontfix, firefox95+ fixed, firefox96+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox94 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix) |
| firefox95 | [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed) |
| firefox96 | [+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox94 |  | wontfix |
| firefox95 | + | fixed |
| firefox96 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hackerone3117, Assigned: amejia)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5b94ed5fbd4cd2feb68a13aa1ff2cde7?d=mm&size=40)  [amejia](/user_profile?user_id=623634)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/55ce097ef86e17468e0f3b4092cb58fa?d=mm&size=40)  [hackerone3117](/user_profile?user_id=695571)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1436485](/show_bug.cgi?id=1436485 "RESOLVED DUPLICATE - Cross Site XSS ( Cross Site Scripting ) at Firefox Focus for Android"), [1740016](/show_bug.cgi?id=1740016 "RESOLVED DUPLICATE - bypass Uxss on Firefox android via javascript:alert(1)// which is shared via the Google translate app[Bug]:")

[1745842](/show_bug.cgi?id=1745842 "RESOLVED DUPLICATE - Receiving a malicious javascript URL as text via a SEND intent may cause XSS")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-sop, reporter-external, sec-moderate, Whiteboard: [reporter-external] [web-bounty-form][adv-main95+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-43544

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [web-bounty-form][adv-main95+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1954019_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 5 obsolete files)

| [Uxss](/attachment.cgi?id=9249705)  [3 years ago](#c0)  [Irwan](/user_profile?user_id=695571)   445.44 KB, image/jpeg |  | [Details](/attachment.cgi?id=9249705&action=edit) |
| --- | --- | --- |
| [AC.patch](/attachment.cgi?id=9250811)  [3 years ago](#c11)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   5.21 KB, text/plain | csadilek : [review+](#a726838_590895 "3 years ago")  sebastian : [review+](#c14 "3 years ago") | [Details](/attachment.cgi?id=9250811&action=edit) |
| [Fenix.patch](/attachment.cgi?id=9250815)  [3 years ago](#c12)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   3.65 KB, text/plain | csadilek : [feedback+](#c19 "3 years ago")  sebastian : [feedback+](#c15 "3 years ago") | [Details](/attachment.cgi?id=9250815&action=edit) |
| [AC.patch](/attachment.cgi?id=9251046)  [3 years ago](#c21)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   13.90 KB, text/plain |  | [Details](/attachment.cgi?id=9251046&action=edit) |
| [Fenix.patch](/attachment.cgi?id=9251047)  [3 years ago](#c22)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   13.61 KB, patch | sebastian : [review+](#a907535_472516 "3 years ago")  csadilek : [review+](#c26 "3 years ago") | [Details](/attachment.cgi?id=9251047&action=edit) | [Diff](/attachment.cgi?id=9251047&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047) |
| [AC\_final.patch](/attachment.cgi?id=9251049)  [3 years ago](#c23)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   13.90 KB, patch | sebastian : [review+](#a907821_472516 "3 years ago")  csadilek : [review+](#c25 "3 years ago") | [Details](/attachment.cgi?id=9251049&action=edit) | [Diff](/attachment.cgi?id=9251049&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049) |
| [AC.patch](/attachment.cgi?id=9252170)  [3 years ago](#c36)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   7.00 KB, patch | tjr : [sec-approval+](#c39 "3 years ago") | [Details](/attachment.cgi?id=9252170&action=edit) | [Diff](/attachment.cgi?id=9252170&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252170) |
| [Fenix.patch](/attachment.cgi?id=9252172)  [3 years ago](#c37)  [Arturo Mejia [:amejia]](/user_profile?user_id=623634)   8.28 KB, patch | tjr : [sec-approval+](#c38 "3 years ago") | [Details](/attachment.cgi?id=9252172&action=edit) | [Diff](/attachment.cgi?id=9252172&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252172) |
| [advisory.txt](/attachment.cgi?id=9253453)  [3 years ago](#c51)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   344 bytes, text/plain |  | [Details](/attachment.cgi?id=9253453&action=edit) |
| [UXss Barcode.jpeg](/attachment.cgi?id=9257033)  [3 years ago](#c62)  [Muhammad Zaid Ghifari](/user_profile?user_id=683632)   34.85 KB, image/jpeg |  | [Details](/attachment.cgi?id=9257033&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1739934#c0)• 3 years ago |
|  | |

Attached image
[Uxss](attachment.cgi?id=9249705)
— [Details](attachment.cgi?id=9249705&action=edit)

hello Firefox security team,

i think it's a uxss vulnerability triggering android Firefox users, when i try to execute javascript:alert(1) in Firefox it doesn't work. to trigger it I use the Google translate app and translate javascript:alert(document.domain)// then I share it with Firefox users then uxss will be triggered there.

Production steps:

1. enter the android app and translate javascript:alert(1) // then share it to Firefox android
2. successfully shared Firefox will point to google, with a javascript:alert(1) search
3. just press once search on Firefox web then enter then uxss will be triggered.

scenario :

I think not everyone understands this problem, maybe when the javascript that is shared from the translate apps to Firefox users, ordinary victims will use the search feature of Firefox and accidentally press enter because there is no back button. with this xss will be triggered

PoC videos :

<https://drive.google.com/file/d/1dEXjgypdjKb_eZNIW3Pf7WIY5Cjkmqq7/view?usp=sharing>

Impact :

Uxss via javascript shared by translate apps to Firefox android users

Flags: sec-bounty?

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1739934#c1)• 3 years ago |
|  | |

because I didn't understand initially reporting a bug on your system please understand, I have reported it also via ticket <https://github.com/mozilla-mobile/fenix/issues/22356>

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1739934#c2)• 3 years ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

Hello ?

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1739934#c3)• 3 years ago |
|  | |

Hi Daniel,

could we can get a sec level on this bug?

Thanks in advance!

Flags: needinfo?(dveditz)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a39446_623634)• 3 years ago |

Group: websites-security → mobile-core-securityType: task → defectComponent: Other → Security: AndroidOS: All → AndroidProduct: Websites → Fenix

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1739934#c5)• 3 years ago |
|  | |

> 2. successfully shared Firefox will point to google, with a javascript:alert(1) search
> 3. just press once search on Firefox web then enter then uxss will be triggered.

What happens is:

* Firefox receives the text "javascript:alert(1)" (via SEND intent, not VIEW intent like URI loads).
* We search for an URI in that text.
* We do not find any URI (I'm curious why though, it's not like we filter here explicitly)
* As fallback we construct a search URL for the text and load that
* When clicking into the URL bar we add the search text instead of the URI to it (if applicable) - to allow the user to quickly modify their search terms
* In this case the search terms are "javascript:alert(1)", which we identify as not being search terms and instead load the URI in Gecko

Not sure how an actual attack would look like? However there's definitely a mismatch between the URI/Search detection in the Intent handler and in the toolbar. However to some degree that may be intentional: I don't think we ever want to accept javascript: URIs via Intent, but we may want to allow the user to enter them manually.

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1739934#c6)• 3 years ago |
|  | |

can you produce it if not please let me know I will give more detail POC..

I guess you can emulate the fix on Opera browser, they filter the javascript into their search field. Anchovy

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a238273_1689)• 3 years ago |

Flags: needinfo?(dveditz)Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1739934#c7)• 3 years ago |
|  | |

Of course Google Translate isn't malicious, but it demonstrates that some other app could do this intentionally. In the example the external app doesn't get to target the UXSS at a particular domain, but it could probably load enough code to do interesting things depending on what popular site it finds itself on. There might be a way for another app to get us to open a specific target URL first, then send the javascript: url from the background?

> I don't think we ever want to accept javascript: URIs via Intent

We don't ever want to accept javascript: URLs from anywhere for any reason. Maybe bookmarklets as a special exception, but those are so niche that the risks of allowing it from too many places isn't worth the risk.

> but we may want to allow the user to enter them manually.

maybe. We sort of don't sometimes though. I guess we block pastes, but typing works

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1739934#c8)• 3 years ago |
|  | |

hi is there any update there?

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1739934#c9)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1739934&comment_id=15657113 "1 revision") |
|  | |

Hi Irwan, sorry for the delay. We are working on a possible solution.

We are going to update the bug as soon a we have it concrete.

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1739934#c10)• 3 years ago |
|  | |

Thanks for your reply, no problem, can you change the status to assign (trigaed) for this problem now?

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a643085_623634)• 3 years ago |

Assignee: nobody → amejiamarmolStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1739934#c11)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1739934&comment_id=15657987 "1 revision") |
|  | |

Attached file
[AC.patch](attachment.cgi?id=9250811) (obsolete)
— [Details](attachment.cgi?id=9250811&action=edit)

This is a draft just to show the solution, I will put a final patch (including tests) after confirming this is the right approach.

[Attachment #9250811](/attachment.cgi?id=9250811&action=edit "AC.patch") -
Flags: review?(s.kaspari)
[Attachment #9250811](/attachment.cgi?id=9250811&action=edit "AC.patch") -
Flags: review?(csadilek)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1739934#c12)• 3 years ago |
|  | |

Attached file
[Fenix.patch](attachment.cgi?id=9250815) (obsolete)
— [Details](attachment.cgi?id=9250815&action=edit)

[Attachment #9250815](/attachment.cgi?id=9250815&action=edit "Fenix.patch") -
Flags: feedback?(s.kaspari)
[Attachment #9250815](/attachment.cgi?id=9250815&action=edit "Fenix.patch") -
Flags: feedback?(csadilek)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1739934#c13)• 3 years ago |
|  | |

To summarize the patches.

We are blocking any JavaScript URLs by default, and only allowing them for bookmarks.

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1739934#c14)• 3 years ago |
|  | |

Comment on [attachment 9250811](/attachment.cgi?id=9250811 "AC.patch") [[details]](/attachment.cgi?id=9250811&action=edit "AC.patch")

AC.patch

Unfortunately Bugzilla doesn't show the "review"/Splinter option here?

The patch looks good.

nit: I think we should move the `getFlags()` method from `EngineSession` (concept) to `GeckoEngineSession`, maybe as an extension method. Stripping this specific flag before passing it along is a Gecko-specific thing we do, so let's do it only internally in `GeckoEngineSession` (We could also try naming it in a way that it is more clear that we are filtering the flags down to Gecko supported flags.

[Attachment #9250811](/attachment.cgi?id=9250811&action=edit "AC.patch") -
Flags: review?(s.kaspari) → review+

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1739934#c15)• 3 years ago |
|  | |

Comment on [attachment 9250815](/attachment.cgi?id=9250815 "Fenix.patch") [[details]](/attachment.cgi?id=9250815&action=edit "Fenix.patch")

Fenix.patch

LGTM. Only question I have is: We added this "recently saved" section to home recently. Is this covered too?

[Attachment #9250815](/attachment.cgi?id=9250815&action=edit "Fenix.patch") -
Flags: feedback?(s.kaspari) → feedback+

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1739934#c16)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1739934&comment_id=15658828 "1 revision") |
|  | |

(In reply to Sebastian Kaspari (:sebastian; :pocmo) from [comment #14](/show_bug.cgi?id=1739934#c14 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Comment on [attachment 9250811](/attachment.cgi?id=9250811 "AC.patch") [[details]](/attachment.cgi?id=9250811&action=edit "AC.patch")
>
> AC.patch
>
> Unfortunately Bugzilla doesn't show the "review"/Splinter option here?
>
> The patch looks good.
>
> nit: I think we should move the `getFlags()` method from `EngineSession` (concept) to `GeckoEngineSession`, maybe as an extension method. Stripping this specific flag before passing it along is a Gecko-specific thing we do, so let's do it only internally in `GeckoEngineSession` (We could also try naming it in a way that it is more clear that we are filtering the flags down to Gecko supported flags.

Thanks for the review.

Got it, no problem.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1739934#c17)• 3 years ago |
|  | |

(In reply to Sebastian Kaspari (:sebastian; :pocmo) from [comment #15](/show_bug.cgi?id=1739934#c15 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Comment on [attachment 9250815](/attachment.cgi?id=9250815 "Fenix.patch") [[details]](/attachment.cgi?id=9250815&action=edit "Fenix.patch")
>
> Fenix.patch
>
> LGTM. Only question I have is: We added this "recently saved" section to home recently. Is this covered too?

Yes, we are adding the flag on `DefaultRecentBookmarksController` to cover that :).

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1739934#c18)• 3 years ago |
|  | |

Comment on [attachment 9250811](/attachment.cgi?id=9250811 "AC.patch") [[details]](/attachment.cgi?id=9250811&action=edit "AC.patch")

AC.patch

On the A-C patch, I think we'll need to update our `BookmarksStorageSuggestionProvider` to pass thew new flag along (in `onSuggestionClicked`). Users open bookmarklets through the awesomebar as a workaround to bookmarks always being opened in new tabs otherwise. So since we're doing this to keep bookmarklets working, we need to make sure this keeps working as well.

We should add a comment to `getFlags` explaining why we're removing the flag before passing it to GV e.g. just to point out that this flag is A-C specific.

Approach looks good to me!

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a726838_590895)• 3 years ago |

[Attachment #9250811](/attachment.cgi?id=9250811&action=edit "AC.patch") -
Flags: review?(csadilek) → review+

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1739934#c19)• 3 years ago |
|  | |

Comment on [attachment 9250815](/attachment.cgi?id=9250815 "Fenix.patch") [[details]](/attachment.cgi?id=9250815&action=edit "Fenix.patch")

Fenix.patch

Fenix side looks good to me for the immediate fix. I think we will want to introduce a `BookmarksUseCase` class here in a follow-up and also address the problem that bookmarks are always opened in a new tab, but let's keep this separate.

[Attachment #9250815](/attachment.cgi?id=9250815&action=edit "Fenix.patch") -
Flags: feedback?(csadilek) → feedback+

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1739934#c20)• 3 years ago |
|  | |

(In reply to Christian Sadilek [:csadilek] from [comment #18](/show_bug.cgi?id=1739934#c18 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Comment on [attachment 9250811](/attachment.cgi?id=9250811 "AC.patch") [[details]](/attachment.cgi?id=9250811&action=edit "AC.patch")
>
> AC.patch
>
> On the A-C patch, I think we'll need to update our `BookmarksStorageSuggestionProvider` to pass thew new flag along (in `onSuggestionClicked`). Users open bookmarklets through the awesomebar as a workaround to bookmarks always being opened in new tabs otherwise. So since we're doing this to keep bookmarklets working, we need to make sure this keeps working as well.
>
> We should add a comment to `getFlags` explaining why we're removing the flag before passing it to GV e.g. just to point out that this flag is A-C specific.
>
> Approach looks good to me!

Perfect!

I will update the patches the suggestions.

Thanks for the review.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1739934#c21)• 3 years ago |
|  | |

Attached file
[AC.patch](attachment.cgi?id=9251046) (obsolete)
— [Details](attachment.cgi?id=9251046&action=edit)

[Security approval request comment]

How easily could an exploit be constructed based on the patch?

Not very easy

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?

We are not going to include tests, until the fix lands on the release version.

Which older supported branches are affected by this flaw?

Firefox 95 and below

If not all supported branches, which bug introduced the flaw?

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?

Yes, we will backport.

How likely is this patch to cause regressions; how much testing does it need?

No likely.

[Attachment #9250811](/attachment.cgi?id=9250811&action=edit "AC.patch") -
Attachment is obsolete: true
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: sec-approval?
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: review?(s.kaspari)
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: review?(csadilek)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1739934#c22)• 3 years ago |
|  | |

Attached patch

[Fenix.patch](attachment.cgi?id=9251047&action=diff) (obsolete)
— [Details](attachment.cgi?id=9251047&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047)

[Security approval request comment]

How easily could an exploit be constructed based on the patch?

Not very easy

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?

We are not going to include tests, until the fix lands on the release version.

Which older supported branches are affected by this flaw?

Firefox 95 and below

If not all supported branches, which bug introduced the flaw?

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?

Yes, we will backport.

How likely is this patch to cause regressions; how much testing does it need?

No likely.

[Attachment #9250815](/attachment.cgi?id=9250815&action=edit "Fenix.patch") -
Attachment is obsolete: true
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: sec-approval?
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: review?(s.kaspari)
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: review?(csadilek)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1739934#c23)• 3 years ago |
|  | |

Attached patch

[AC\_final.patch](attachment.cgi?id=9251049&action=diff) (obsolete)
— [Details](attachment.cgi?id=9251049&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049)

This replaced <https://bugzilla.mozilla.org/show_bug.cgi?id=1739934#c21> as shows the Splinter Review.

[Security approval request comment]

How easily could an exploit be constructed based on the patch?

Not very easy

Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?

We are not going to include tests, until the fix lands on the release version.

Which older supported branches are affected by this flaw?

Firefox 95 and below

If not all supported branches, which bug introduced the flaw?

Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?

Yes, we will backport.

How likely is this patch to cause regressions; how much testing does it need?

No likely.

[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Attachment is obsolete: true
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: sec-approval?
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: review?(s.kaspari)
[Attachment #9251046](/attachment.cgi?id=9251046&action=edit "AC.patch") -
Flags: review?(csadilek)
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: sec-approval?
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: review?(s.kaspari)
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: review?(csadilek)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1739934#c24)• 3 years ago |
|  | |

Comment on [attachment 9251049](/attachment.cgi?id=9251049 "AC_final.patch") [[details]](/attachment.cgi?id=9251049&action=edit "AC_final.patch") [[diff]](/attachment.cgi?id=9251049&action=diff "AC_final.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049)

AC\_final.patch

I think this going to be fine to land, but I'm clearing sec-approval until we have r+'s just in case it takes some cycles.

[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: sec-approval?

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1739934#c25)• 3 years ago |
|  | |

Comment on [attachment 9251049](/attachment.cgi?id=9251049 "AC_final.patch") [[details]](/attachment.cgi?id=9251049&action=edit "AC_final.patch") [[diff]](/attachment.cgi?id=9251049&action=diff "AC_final.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049)
AC\_final.patch
Review of [attachment 9251049](/attachment.cgi?id=9251049 "AC_final.patch") [[details]](/attachment.cgi?id=9251049&action=edit "AC_final.patch") [[diff]](/attachment.cgi?id=9251049&action=diff "AC_final.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049):
-----------------------------------------------------------------
Looks good to me. Just a nit.
::: components/browser/engine-gecko/src/main/java/mozilla/components/browser/engine/gecko/GeckoEngineSession.kt
@@ +183,5 @@
>
> + private fun shouldLoadJSSchemes(
> + scheme: String?,
> + flags: LoadUrlFlags
> + ) = scheme?.startsWith(JS\_SCHEME) == true && flags.contains(ALLOW\_JAVASCRIPT\_URL)
nit: The scheme is already normalized here, so we could really check for equality instead of `startsWith`. That's also what happens when checking BLOCKED\_SCHEMES.contains.
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: review?(csadilek) → review+

|  | [Christian Sadilek [:csadilek]](/user_profile?user_id=590895) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1739934#c26)• 3 years ago |
|  | |

Comment on [attachment 9251047](/attachment.cgi?id=9251047 "Fenix.patch") [[details]](/attachment.cgi?id=9251047&action=edit "Fenix.patch") [[diff]](/attachment.cgi?id=9251047&action=diff "Fenix.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047)
Fenix.patch
Review of [attachment 9251047](/attachment.cgi?id=9251047 "Fenix.patch") [[details]](/attachment.cgi?id=9251047&action=edit "Fenix.patch") [[diff]](/attachment.cgi?id=9251047&action=diff "Fenix.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047):
-----------------------------------------------------------------
::: app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt
@@ +152,5 @@
> activity.openToBrowserAndLoad(
> searchTermOrURL = url,
> newTab = fragmentStore.state.tabId == null,
> + from = BrowserDirection.FromSearchDialog,
> + flags = flags
nit: Why this change? That's the default here anyway, no?
::: app/src/main/java/org/mozilla/fenix/search/SearchDialogInteractor.kt
@@ +30,5 @@
> searchController.handleTextChanged(text)
> }
>
> + override fun onUrlTapped(url: String, flags: LoadUrlFlags) {
> + searchController.handleUrlTapped(url, flags)
nit: same q: above. why change this?
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: review?(csadilek) → review+

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1739934#c27)• 3 years ago |
|  | |

(In reply to Christian Sadilek [:csadilek] from [comment #26](/show_bug.cgi?id=1739934#c26 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Comment on [attachment 9251047](/attachment.cgi?id=9251047 "Fenix.patch") [[details]](/attachment.cgi?id=9251047&action=edit "Fenix.patch") [[diff]](/attachment.cgi?id=9251047&action=diff "Fenix.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047)
>
> Fenix.patch
>
> ## Review of [attachment 9251047](/attachment.cgi?id=9251047 "Fenix.patch") [[details]](/attachment.cgi?id=9251047&action=edit "Fenix.patch") [[diff]](/attachment.cgi?id=9251047&action=diff "Fenix.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251047):
>
> ::: app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt
>
> @@ +152,5 @@
>
> > ```
> >      activity.openToBrowserAndLoad(
> >          searchTermOrURL = url,
> >          newTab = fragmentStore.state.tabId == null,
> >
> > ```
> >
> > * ```
> >          from = BrowserDirection.FromSearchDialog,
> >
> >   ```
> > * ```
> >          flags = flags
> >
> >   ```
>
> nit: Why this change? That's the default here anyway, no?
>
> ::: app/src/main/java/org/mozilla/fenix/search/SearchDialogInteractor.kt
>
> @@ +30,5 @@
>
> > ```
> >      searchController.handleTextChanged(text)
> >  }
> >
> > ```
> >
> > * override fun onUrlTapped(url: String, flags: LoadUrlFlags) {
> > * ```
> >      searchController.handleUrlTapped(url, flags)
> >
> >   ```
>
> nit: same q: above. why change this?

We need both as we added the flags AC on `BookmarksStorageSuggestionProvider`, then we are receiving the flags on `AwesomeBarView.kt` line 58, but never passing then to the interactor (that at the end delategates to the load use-case), without `interactor.onUrlTapped(url, flags)` this line the load use-case never get the `flags` from `BookmarksStorageSuggestionProvider`, for more information see `AwesomeBarInteractor` line 20.

The issue same can be say about `additionalHeaders` this is separate issue `AwesomeBarView.kt` line 58.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1739934#c28)• 3 years ago |
|  | |

Additionally to clarify the usages above, I filed this follow-up ticket <https://github.com/mozilla-mobile/fenix/issues/22494> help to understand the reason why we need the extra code.

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a907535_472516)• 3 years ago |

[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: review?(s.kaspari) → review+

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a907821_472516)• 3 years ago |

[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: review?(s.kaspari) → review+

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1739934#c29)• 3 years ago |
|  | |

Comment on [attachment 9251049](/attachment.cgi?id=9251049 "AC_final.patch") [[details]](/attachment.cgi?id=9251049&action=edit "AC_final.patch") [[diff]](/attachment.cgi?id=9251049&action=diff "AC_final.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9251049)

AC\_final.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easy
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: Firefox 95 and below
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: No likely
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: sec-approval?

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1739934#c30)• 3 years ago |
|  | |

Hi a little Addition, I see Uxss can be exploited further, as I explained above many ways to send the javascript via google translate or Name the application, even create bookmarks, with the javascript payload and then share it with other Firefox users with the same production steps.Thank you

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1739934#c31)• 3 years ago |
|  | |

We should break the tests out into a separate patch that we land later (we typically land one release later.)

Flags: needinfo?(amejiamarmol)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1739934#c32)• 3 years ago |
|  | |

(In reply to Irwan from [comment #30](/show_bug.cgi?id=1739934#c30 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Hi a little Addition, I see Uxss can be exploited further, as I explained above many ways to send the javascript via google translate or Name the application, even create bookmarks, with the javascript payload and then share it with other Firefox users with the same production steps.Thank you

Thanks Irwan!

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1739934#c33)• 3 years ago |
|  | |

(In reply to Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc) from [comment #31](/show_bug.cgi?id=1739934#c31 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> We should break the tests out into a separate patch that we land later (we typically land one release later.)

Thanks Tom, yes this is the approach that we are going to take :)

Flags: needinfo?(amejiamarmol)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1739934#c34)• 3 years ago |
|  | |

Okay; I can give sec-approval once that's done.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1739934#c35)• 3 years ago |
|  | |

No problem, I'll update the patches removing the tests.

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1739934#c36)• 3 years ago |
|  | |

Attached patch

[AC.patch](attachment.cgi?id=9252170&action=diff)
— [Details](attachment.cgi?id=9252170&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252170)

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easy
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: Firefox 95 and below
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: No likely
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Attachment is obsolete: true
[Attachment #9251049](/attachment.cgi?id=9251049&action=edit "AC_final.patch") -
Flags: sec-approval?
[Attachment #9252170](/attachment.cgi?id=9252170&action=edit "AC.patch") -
Flags: sec-approval?

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1739934#c37)• 3 years ago |
|  | |

Attached patch

[Fenix.patch](attachment.cgi?id=9252172&action=diff)
— [Details](attachment.cgi?id=9252172&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252172)

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easy
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: Firefox 95 and below
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: No likely
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Attachment is obsolete: true
[Attachment #9251047](/attachment.cgi?id=9251047&action=edit "Fenix.patch") -
Flags: sec-approval?Flags: needinfo?(tom)
[Attachment #9252172](/attachment.cgi?id=9252172&action=edit "Fenix.patch") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1739934#c38)• 3 years ago |
|  | |

Comment on [attachment 9252172](/attachment.cgi?id=9252172 "Fenix.patch") [[details]](/attachment.cgi?id=9252172&action=edit "Fenix.patch") [[diff]](/attachment.cgi?id=9252172&action=diff "Fenix.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252172)

Fenix.patch

Thanks! Approved to land.

Flags: needinfo?(tom)
[Attachment #9252172](/attachment.cgi?id=9252172&action=edit "Fenix.patch") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1739934#c39)• 3 years ago |
|  | |

Comment on [attachment 9252170](/attachment.cgi?id=9252170 "AC.patch") [[details]](/attachment.cgi?id=9252170&action=edit "AC.patch") [[diff]](/attachment.cgi?id=9252170&action=diff "AC.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1739934&attachment=9252170)

AC.patch

Approved to land

[Attachment #9252170](/attachment.cgi?id=9252170&action=edit "AC.patch") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a1357702_75935)• 3 years ago |

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=unaffected)
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected)
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected)
[tracking-firefox95](/buglist.cgi?f1=cf_tracking_firefox95&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B)
[tracking-firefox96](/buglist.cgi?f1=cf_tracking_firefox96&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a1357745_75935)• 3 years ago |

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=unaffected) → [wontfix](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=wontfix)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1739934#c40)• 3 years ago |
|  | |

We landed the patch on [Fenix (main)](https://github.com/mozilla-mobile/fenix/commit/3f86a5d6f9523776d9e1197cb5daa50da5871e64), it will be available in the next nightly update. We are going to wait until early next week to uplift the patch to Beta 95 to give the patch some time on nightly to early discover any possible issues .

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1739934#c41)• 3 years ago |
|  | |

I hope this problem can be solved before the weekend arrives :D

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1739934#c42)• 3 years ago |
|  | |

Yesterday, we uplifted the patch to the [beta branch 95](https://github.com/mozilla-mobile/fenix/pull/22628) as we didn't found any issues on nightly, the patch should be available in the next beta update.

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1739934#c43)• 3 years ago |
|  | |

thanks for your reply, then when can i hear about the bounty of this bug?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1739934#c44)• 3 years ago |
|  | |

I'm marking it fixed which will flag it for consideration for a bounty at our next committee meeting.

Status: ASSIGNED → RESOLVEDClosed: 3 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1739934#c45)• 3 years ago |
|  | |

We triaged this too quickly initially and over-rated it. This is not a "Universal" XSS, it can only target your search provider. Our default in most of the world, Google, is a pretty interesting target if the user happens to have a Google login (lots of tied services). Less so if the user has customized their search. It also requires user interaction on an obvious javascript: url, after seeing the search results. `sec-moderate` is more appropriate.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Summary: bypass Uxss on Firefox android via javascript:alert(1)// which is shared via the Google translate app → social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a1954019_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1739934#c46)• 3 years ago |
|  | |

Well you are right the attacker can only target search sites like google, Bing, Yahoo etc. can also target other sites like Facebook but it is impossible for the victim to change the search engine They became Facebook.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1739934#c47)• 3 years ago |
|  | |

(In reply to Arturo Mejia from [comment #42](/show_bug.cgi?id=1739934#c42 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Yesterday, we uplifted the patch to the [beta branch 95](https://github.com/mozilla-mobile/fenix/pull/22628) as we didn't found any issues on nightly, the patch should be available in the next beta update.

This ended up being the 95.1.0 RC build rather than a beta release.

Group: mobile-core-security → core-security-release
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed)
[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=fixed)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1739934#c48)• 3 years ago |
|  | |

hi it's my first time to get a reward from Firefox, how do i withdraw the funds $1k

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1739934#c49)• 3 years ago |
|  | |

I sent an email to you about 17 hours before you posted this comment; if you cannot find it, please contact me at tom@mozilla.com

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1739934#c50)• 3 years ago |
|  | |

thanks, I just saw because of the stack of messages, I will follow up on your email tom!

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a2099713_428608)• 3 years ago |

Whiteboard: [reporter-external] [web-bounty-form] [verif?] → [reporter-external] [web-bounty-form][adv-main95+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1739934#c51)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9253453)
— [Details](attachment.cgi?id=9253453&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a2186360_428608)• 3 years ago |

Alias: CVE-2021-43544

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1739934#c53)• 3 years ago |
|  | |

Hi team,

it seems our browser and version are very different, why is this a duplicate?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1739934#c54)• 3 years ago |
|  | |

Both your bug and this involves `javascript:` URLs sent via SEND. Can you reproduce your bug in a version that contains this fix?

Flags: needinfo?(dveditz)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1739934#c55)• 3 years ago |
|  | |

hi Daniel,

I see this is not a duplicate of what you said, because you confirmed the status of the fix in version 95.96. I think you missed the Firefox Beta fix. It is not like that?

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1739934#c56)• 3 years ago |
|  | |

(In reply to Irwan from [comment #55](/show_bug.cgi?id=1739934#c55 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> hi Daniel,
>
> I see this is not a duplicate of what you said, because you confirmed the status of the fix in version 95.96. I think you missed the Firefox Beta fix. It is not like that?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1739934#c57)• 3 years ago |
|  | |

I do not understand the question. Is the bug fixed in Firefox 95 (release) and Firefox 96 Beta ? Are you saying it is not fixed in Fireox 96 Beta?

Flags: needinfo?(dveditz) → needinfo?(hackerone3117)

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1739934#c58)• 3 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] Out until January from [comment #57](/show_bug.cgi?id=1739934#c57 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> I do not understand the question. Is the bug fixed in Firefox 95 (release) and Firefox 96 Beta ? Are you saying it is not fixed in Fireox 96 Beta?

no, the point is that when patching firefox 95, there was no patching on firefox beta 96, it happened when I first reported this vulnerability in my report on [bug 1745842](/show_bug.cgi?id=1745842 "RESOLVED DUPLICATE - Receiving a malicious javascript URL as text via a SEND intent may cause XSS")

Flags: needinfo?(dveditz)

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1739934#c59)• 3 years ago |
|  | |

in short, he said i reported ahead of your patching and checking.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1739934#c60)• 3 years ago |
|  | |

I don't know where he said that, but that contradicts the evidence in this bug and the way normal software development works. He is wrong.

* Nov 16: By [comment 21](/show_bug.cgi?id=1739934#c21 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") Arturo has a patch for the current development branch (96). In that comment he notes that 95 is also affected. He repeats that in [comment 29](/show_bug.cgi?id=1739934#c29 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") because "check if other versions are affected" is a **standard** part of software development.
* Nov 23: one of our Release Managers explicitly marks this as being tracked to be fixed in 95 and 96.
* Nov 25: fixed in "nightly" (the future Firefox 96)
* Nov 30: fixed in "beta" after testing in nightly (the future Firefox 95)
* Dec 1: Ryan notes that it missed the last beta release for 95 but was put into the 1st Release Candidate
* Dec 7: we release Firefox 95 and our advisories, and somewhere around here release 96 on the beta channel
* Dec 13: you file [bug 1745842](/show_bug.cgi?id=1745842 "RESOLVED DUPLICATE - Receiving a malicious javascript URL as text via a SEND intent may cause XSS")

All of that information is here, in this bug that you are reading. If your bug is fixed, it is fixed solely because of actions in this bug before you filed yours. Those actions are our standard actions and would have happened even if you had filed your bug a month earlier.

If your bug is not a duplicate then it should still be happening. We'll need a better PoC so we can distinguish the cases.

Flags: needinfo?(dveditz)

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1739934#c61)• 3 years ago |
|  | |

Hi team,

I don't agree if it is said to be moderate, because this Xss can be executed on "Scan QR Barcode" which means this is a more serious problem "High",

where can i do a retest to prove that my analysis is correct??

Flags: needinfo?(sarentz)

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1739934#c62)• 3 years ago |
|  | |

Attached image
[UXss Barcode.jpeg](attachment.cgi?id=9257033)
— [Details](attachment.cgi?id=9257033&action=edit)

this is the PoC, please scan this barcode on the firefox beta URL bar and see the results.

you have to retest the vulnerable firefox browser before

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1739934#c63)• 3 years ago |
|  | |

Your PoC in [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") is rather different than the bug filed here in [comment 0](/show_bug.cgi?id=1739934#c0 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"). Your PoC [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") does not work on Firefox Beta 96 or Nightly 97 which means that it was fixed as part of [bug 1705094](/show_bug.cgi?id=1705094 "RESOLVED FIXED - QR code scanner allows opening non-HTTP URLs"). Which was fixed in nightly around November 8th. Which is over a month before you filed your bug. We strongly recommend researchers test their findings on [Nightly versions of Firefox](https://github.com/mozilla-mobile/fenix/wiki#download).

Flags: needinfo?(sarentz)

|  | [Muhammad Zaid Ghifari](/user_profile?user_id=683632) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1739934#c64)• 3 years ago |
|  | |

(In reply to Kevin Brosnan [:kbrosnan] from [comment #63](/show_bug.cgi?id=1739934#c63 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> Your PoC in [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") is rather different than the bug filed here in [comment 0](/show_bug.cgi?id=1739934#c0 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"). Your PoC [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") does not work on Firefox Beta 96 or Nightly 97 which means that it was fixed as part of [bug 1705094](/show_bug.cgi?id=1705094 "RESOLVED FIXED - QR code scanner allows opening non-HTTP URLs"). Which was fixed in nightly around November 8th. Which is over a month before you filed your bug. We strongly recommend researchers test their findings on [Nightly versions of Firefox](https://github.com/mozilla-mobile/fenix/wiki#download).

I want you to retest the version that was pepatched last November 8, because I did not find access to download version 95, I think version 95 is vulnerable not at a moderate level but high, because it can be executed Firefox beta via barcode scan.

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1739934#c65)• 3 years ago |
|  | |

The qr code scanner is a secondary method to get URLs and displays the URL that will be loaded. The user needs to confirm that the URL is what they want to load. It is currently the Christmas and New Years break and almost all the team is out of the office. The findings in [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app") is not a critical security flaw such that I/Mozilla need to call 20+ people in from paid time off. Firefox 96 will contain the fix to your report from [comment 62](/show_bug.cgi?id=1739934#c62 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"), it will be released on 2022-01-11.

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1739934#c66)• 3 years ago |
|  | |

(In reply to Tom Ritter [:tjr] (ni? for response to CVE/sec-approval/advisories/etc) from [comment #49](/show_bug.cgi?id=1739934#c49 "VERIFIED FIXED - social-engineered XSS on default search provider via javascript:alert(1) URL which is SENT from another app"))

> I sent an email to you about 17 hours before you posted this comment; if you cannot find it, please contact me at tom@mozilla.com

Hi tom, can you open your email, I want to discuss there?

Flags: needinfo?(hackerone3117)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a5141125_695571)• 3 years ago |

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a7911239_578488)• 3 years ago |

Flags: needinfo?(tom)

|  | [Irwan](/user_profile?user_id=695571)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a23632233_695571)• 2 years ago |

Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a25234103_1689)• 2 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a31195895_430528)• 2 years ago |

Component: Security: Android → General

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1739934#a80744176_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1739934&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irwan](/user_profile?user_id=695571)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


