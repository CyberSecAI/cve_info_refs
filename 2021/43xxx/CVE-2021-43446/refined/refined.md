Based on the provided content, here's a breakdown of the vulnerability information related to CVE-2021-43446:

**CVE-2021-43446: XSS in macros**

*   **Root Cause:** The ONLYOFFICE document editor's macro functionality uses `eval()` to execute JavaScript code within a document macro. This allows for arbitrary JavaScript execution within the context of the document editor.
*   **Weaknesses/Vulnerabilities:**
    *   **Unsafe JavaScript Execution:** The use of `eval()` directly on user-provided macro code allows for injection of arbitrary JavaScript.
    *   **Lack of Sandboxing:** There is no sandboxing or restriction of the JavaScript code executed within the macro, allowing access to the full DOM and potentially other resources accessible to the application.
    *   **Unauthenticated WebSocket Access:** Combined with the unauthenticated WebSocket vulnerability (CVE-2021-43447), an attacker can inject a malicious macro into a document without any authentication.
*   **Impact of Exploitation:**
    *   **Cross-Site Scripting (XSS):** An attacker can inject malicious JavaScript into a document which will execute when a user opens the document. This XSS can be leveraged for a variety of malicious actions, including session hijacking, data theft, or further exploitation of the document management system the editor is integrated with (e.g., Nextcloud).
    *   **Privilege Escalation:** As demonstrated in the provided text, the XSS vulnerability can be used to create a new administrative account on the integrated document management system (Nextcloud) without needing to confirm the existing admin's password if an admin action has been performed in the last 30 minutes.
*   **Attack Vectors:**
    *   **Malicious Document Injection:** By exploiting the unauthenticated WebSocket vulnerability and crafting a malicious macro, an attacker can inject this macro into a document on the target system.
    *   **User Interaction:** The attack requires a user to open the document with the injected macro, at which point the malicious JavaScript is executed.
*   **Required Attacker Capabilities/Position:**
    *   **Knowledge of Document ID:**  The attacker needs to know the document ID to target a specific document for macro injection.
    *   **Network Access:** The attacker needs to be able to connect to the vulnerable ONLYOFFICE server and communicate through its WebSocket endpoint.

**Additional Notes:**

*   The provided content offers a detailed explanation of the vulnerability, including code snippets and proof-of-concept exploitation steps, which are not part of the standard CVE description.
*   The text highlights that the default configuration of ONLYOFFICE is insecure, with unauthenticated WebSocket access and a default JWT signing key of "secret," which contributes to the exploitability of this vulnerability.
*   The report also details additional vulnerabilities discovered in ONLYOFFICE, including unauthenticated websocket access, default signing keys, SSRF, and path traversal leading to arbitrary file write. These vulnerabilities are addressed by other CVEs in the range CVE-2021-43444 to CVE-2021-43449.
*   The document indicates that this vulnerability has been fixed in version 7.2 of OnlyOffice.