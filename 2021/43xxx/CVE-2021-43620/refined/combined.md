=== Content from rustsec.org_f2b95cd4_20250115_095345.html ===


RUSTSEC-2021-0123: fruity: Converting `NSString` to a String Truncates at Null Bytes ‚Ä∫ RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/fruity/RUSTSEC-2021-0123.md) ‚ãÖ
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/fruity/RUSTSEC-2021-0123.md) ‚ãÖ
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0123)

# RUSTSEC-2021-0123

Converting `NSString` to a String Truncates at Null Bytes

Reported
November 14, 2021

Issued
November 15, 2021

(last modified: June 13, 2023)

Package
[fruity](/packages/fruity.html)
([crates.io](https://crates.io/crates/fruity))

Type
Vulnerability

Aliases

* [CVE-2021-43620](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43620)
* [GHSA-h352-g5vw-3926](https://github.com/advisories/GHSA-h352-g5vw-3926)

References

* <https://github.com/nvzqz/fruity/issues/14>

Patched

* `>=0.3.0`

Unaffected

* `<0.1.0`

Affected Functions
Version
`fruity::foundation::NSString::to_str`

* `<0.3.0, >=0.1.0`

`fruity::foundation::NSString::to_str_with_nul`

* `<0.3.0, >=0.1.0`

`fruity::foundation::NSString::to_string`

* `<0.3.0, >=0.1.0`

`fruity::foundation::NSString::to_string_with_nul`

* `<0.3.0, >=0.1.0`

### Description

Methods of [`NSString`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html) for conversion to a string may return a partial result.
Since they call [`CStr::from_ptr`](https://doc.rust-lang.org/std/ffi/struct.CStr.html#method.from_ptr) on a pointer to the string buffer, the
string is terminated at the first null byte, which might not be the end of the
string.

In addition to the vulnerable functions listed for this issue, the
implementations of [`Display`](https://doc.rust-lang.org/std/fmt/trait.Display.html), [`PartialEq`](https://doc.rust-lang.org/std/cmp/trait.PartialEq.html), [`PartialOrd`](https://doc.rust-lang.org/std/cmp/trait.PartialOrd.html), and [`ToString`](https://doc.rust-lang.org/std/string/trait.ToString.html)
for [`NSString`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html) are also affected, since they call those functions.

## Impact

Since [`NSString`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html) is commonly used as the type for paths by the [Foundation](https://developer.apple.com/documentation/foundation)
framework, null byte truncation might allow for easily bypassing file extension
checks. For example, if a file name is provided by a user and validated to have
one of a specific set of extensions, with validation taking place before
truncation, an attacker can add an accepted extension after a null byte (e.g.,
`file.exe\0.txt`). After truncation, the file name used by the application
would be `file.exe`.

It would be better to generate unique names for files, instead of using
user-provided names, but not all applications take this approach.

## Example:

```
let string = NSString::from_str("null\0byte");
println!("{}", string);

```

That example only prints the string "null".

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from github.com_99ab0e73_20250115_095341.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnvzqz%2Ffruity%2Fissues%2F14)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnvzqz%2Ffruity%2Fissues%2F14)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=nvzqz%2Ffruity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nvzqz](/nvzqz)
/
**[fruity](/nvzqz/fruity)**
Public

* [Notifications](/login?return_to=%2Fnvzqz%2Ffruity) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2Fnvzqz%2Ffruity)
* [Star
   173](/login?return_to=%2Fnvzqz%2Ffruity)

* [Code](/nvzqz/fruity)
* [Issues
  8](/nvzqz/fruity/issues)
* [Pull requests
  3](/nvzqz/fruity/pulls)
* [Discussions](/nvzqz/fruity/discussions)
* [Actions](/nvzqz/fruity/actions)
* [Projects
  0](/nvzqz/fruity/projects)
* [Security](/nvzqz/fruity/security)
* [Insights](/nvzqz/fruity/pulse)

Additional navigation options

* [Code](/nvzqz/fruity)
* [Issues](/nvzqz/fruity/issues)
* [Pull requests](/nvzqz/fruity/pulls)
* [Discussions](/nvzqz/fruity/discussions)
* [Actions](/nvzqz/fruity/actions)
* [Projects](/nvzqz/fruity/projects)
* [Security](/nvzqz/fruity/security)
* [Insights](/nvzqz/fruity/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnvzqz%2Ffruity%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnvzqz%2Ffruity%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# `Display` for `NSString` truncates at null bytes #14

Closed

[dylni](/dylni) opened this issue
Oct 31, 2021
¬∑ 6 comments
 ¬∑ Fixed by [rustsec/advisory-db#1223](https://github.com/rustsec/advisory-db/pull/1223)

Closed

# [`Display` for `NSString` truncates at null bytes](#top) #14

[dylni](/dylni) opened this issue
Oct 31, 2021
¬∑ 6 comments
 ¬∑ Fixed by [rustsec/advisory-db#1223](https://github.com/rustsec/advisory-db/pull/1223)

## Comments

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=80&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

Copy link

### **[dylni](/dylni)** commented [Oct 31, 2021](#issue-1040611981)

| This issue was originally reported privately, but I thought I should create an issue to inform others about it, as it has not yet been fixed.  The implementation of [`Display`](https://doc.rust-lang.org/std/fmt/trait.Display.html) for [`NSString`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html) truncates at null bytes, since it uses [`CStr::from_ptr`](https://doc.rust-lang.org/std/ffi/struct.CStr.html#method.from_ptr). It should be possible to use [`[NSString lengthOfBytesUsingEncoding:]`](https://developer.apple.com/documentation/foundation/nsstring/1410710-lengthofbytesusingencoding) and [`[NSString UTF8String]`](https://developer.apple.com/documentation/foundation/nsstring/1411189-utf8string) instead to create the complete string.  Example:  ``` let string = NSString::from_str("null\0bytes"); println!("{}", string); ```  That example only prints the string "null". Since [`ToString::to_string`](https://doc.rust-lang.org/std/string/trait.ToString.html#tymethod.to_string) uses [`Display`](https://doc.rust-lang.org/std/fmt/trait.Display.html) to create strings, it has the same issue. [`NSString::to_str`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html#method.to_str) and [`NSString::to_str_with_null`](https://docs.rs/fruity/0.2.0/fruity/foundation/struct.NSString.html#method.to_str_with_nul) also have the same issue.  If you believe this is a valid issue, I encourage you to file a security advisory at <https://github.com/rustsec/advisory-db>, including a patch version if it is possible to release within two weeks.  Thank you for your work on this crate. Creating a security advisory is not meant to be anything other than a way to provide information to other users. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)
[dylni](/dylni)
mentioned this issue
[Nov 14, 2021](#ref-pullrequest-1053061586)

[Add fruity advisory for nvzqz/fruity#14
rustsec/advisory-db#1102](/rustsec/advisory-db/pull/1102)
 Merged

[Shnatsel](/Shnatsel)
pushed a commit
to rustsec/advisory-db
that referenced
this issue
[Nov 15, 2021](#ref-commit-d5184e3)
[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

`[Add fruity advisory for](/rustsec/advisory-db/commit/d5184e35e368262496dccfba2e5ddfcd56f3c1d8 "Add fruity advisory for nvzqz/fruity#14 (#1102)

* Add fruity advisory for nvzqz/fruity#14

* Fix lint error

* Fix lint error

* Add an impact section") [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14) [(](/rustsec/advisory-db/commit/d5184e35e368262496dccfba2e5ddfcd56f3c1d8 "Add fruity advisory for nvzqz/fruity#14 (#1102)

* Add fruity advisory for nvzqz/fruity#14

* Fix lint error

* Fix lint error

* Add an impact section")[#1102](https://github.com/rustsec/advisory-db/pull/1102)[)](/rustsec/advisory-db/commit/d5184e35e368262496dccfba2e5ddfcd56f3c1d8 "Add fruity advisory for nvzqz/fruity#14 (#1102)

* Add fruity advisory for nvzqz/fruity#14

* Fix lint error

* Fix lint error

* Add an impact section")`
‚Ä¶

`[d5184e3](/rustsec/advisory-db/commit/d5184e35e368262496dccfba2e5ddfcd56f3c1d8)`

```
* Add fruity advisory for [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)

* Fix lint error

* Fix lint error

* Add an impact section
```

[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=80&u=6d52ad6b671a922da249dd410c15ba2634eee3a4&v=4)](/Shnatsel)

Copy link

### **[Shnatsel](/Shnatsel)** commented [Nov 15, 2021](#issuecomment-968402328)

| Heads up: this issue has been included in the [RustSec advisory database](https://github.com/RustSec/advisory-db). It will be surfaced by tools such as [cargo-audit](https://github.com/RustSec/cargo-audit) or [cargo-deny](https://github.com/EmbarkStudios/cargo-deny) from now on.  Once a fix is released to crates.io, please open a pull request to update the advisory with the patched version, or file an issue on [the advisory database repository](https://github.com/RustSec/advisory-db). |
| --- |

All reactions

Sorry, something went wrong.

[![@nvzqz](https://avatars.githubusercontent.com/u/10367662?s=80&u=4e0d8069ed1d125eb30d7b9758b39b4b58d38bf1&v=4)](/nvzqz)

Copy link

Owner

### **[nvzqz](/nvzqz)** commented [Apr 8, 2022](#issuecomment-1092732913)

| This is now fixed in release `0.3.0`. Sorry for the delay. I cherry-picked it from a series of changes that I wanted to clean up and didn't get around to. I will be adding more APIs and releases soon, with a focus on macOS. |
| --- |

All reactions

Sorry, something went wrong.

[![@nvzqz](https://avatars.githubusercontent.com/u/10367662?s=40&u=4e0d8069ed1d125eb30d7b9758b39b4b58d38bf1&v=4)](/nvzqz)
[nvzqz](/nvzqz)
closed this as [completed](/nvzqz/fruity/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Apr 8, 2022](#event-6395527521)

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=80&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

Copy link

Author

### **[dylni](/dylni)** commented [Apr 18, 2022](#issuecomment-1101856616) ‚Ä¢ edited Loading

| Thanks [@nvzqz](https://github.com/nvzqz)! The new implementation looks good and appears to resolve the issue. Also, [`NSString::from_str_no_copy`](https://docs.rs/fruity/0.3.0/fruity/foundation/struct.NSString.html#method.from_str_no_copy) should no longer need a "Safety" section, since it's safe now. |
| --- |

All reactions

Sorry, something went wrong.

[![@nvzqz](https://avatars.githubusercontent.com/u/10367662?s=80&u=4e0d8069ed1d125eb30d7b9758b39b4b58d38bf1&v=4)](/nvzqz)

Copy link

Owner

### **[nvzqz](/nvzqz)** commented [Apr 18, 2022](#issuecomment-1101858133) ‚Ä¢ edited Loading

| [@dylni](https://github.com/dylni) that method is safe because the `NSString` cannot outlive the input due to the `'data` lifetime. I forgot to remove the safety notice. |
| --- |

All reactions

Sorry, something went wrong.

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=80&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

Copy link

Author

### **[dylni](/dylni)** commented [Apr 18, 2022](#issuecomment-1101862156)

| [@nvzqz](https://github.com/nvzqz) Sorry, I realized my original comment was wrong and edited it. You are correct that the lifetime is now sufficiently enforced. |
| --- |

All reactions

Sorry, something went wrong.

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)
[dylni](/dylni)
mentioned this issue
[Apr 18, 2022](#ref-pullrequest-1207564692)

[Add patch version for fruity
rustsec/advisory-db#1223](/rustsec/advisory-db/pull/1223)
 Merged

[![@nvzqz](https://avatars.githubusercontent.com/u/10367662?s=80&u=4e0d8069ed1d125eb30d7b9758b39b4b58d38bf1&v=4)](/nvzqz)

Copy link

Owner

### **[nvzqz](/nvzqz)** commented [Apr 18, 2022](#issuecomment-1101864362)

| No worries. I appreciate your diligence. Things like that do get missed. |
| --- |

 üëç
1
 dylni reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 21, 2022](#ref-commit-885e220)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/885e220ad4b5c914d426b9d35a9b73877cc305d5 "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[885e220](/madsmtm/objc2/commit/885e220ad4b5c914d426b9d35a9b73877cc305d5)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 22, 2022](#ref-commit-fb3452a)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/fb3452a38ed866946f74941851af2ec29faacfa1 "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[fb3452a](/madsmtm/objc2/commit/fb3452a38ed866946f74941851af2ec29faacfa1)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 22, 2022](#ref-commit-8be7802)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/8be78024e29017389f3f68cd354c79dc1077fd88 "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[8be7802](/madsmtm/objc2/commit/8be78024e29017389f3f68cd354c79dc1077fd88)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 22, 2022](#ref-commit-9d0dfe4)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/9d0dfe4b31ba0f2d2a037bc8832ac815d30583ad "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[9d0dfe4](/madsmtm/objc2/commit/9d0dfe4b31ba0f2d2a037bc8832ac815d30583ad)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 22, 2022](#ref-commit-1931965)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/193196519d95d8d607d7d59176798077e58d8f3c "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[1931965](/madsmtm/objc2/commit/193196519d95d8d607d7d59176798077e58d8f3c)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 26, 2022](#ref-commit-c99defa)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/c99defad6b23055c1b1f53e80be19b9dabc3b358 "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[c99defa](/madsmtm/objc2/commit/c99defad6b23055c1b1f53e80be19b9dabc3b358)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[madsmtm](/madsmtm)
added a commit
to madsmtm/objc2
that referenced
this issue
[Jul 26, 2022](#ref-commit-a3104bd)
[![@madsmtm](https://avatars.githubusercontent.com/u/10577181?s=40&u=bb5932e9d514de100eb85b8d8ae8dce0e5593b2c&v=4)](/madsmtm)

`[Allow ns_string! to end with NUL](/madsmtm/objc2/commit/a3104bd436aa29009892bd04630ef0de3fa6a6b7 "Allow ns_string! to end with NUL

If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see https://github.com/nvzqz/fruity/issues/14")`
‚Ä¶

`[a3104bd](/madsmtm/objc2/commit/a3104bd436aa29009892bd04630ef0de3fa6a6b7)`

```
If the user needs the string to end with e.g. two NUL, we really shouldn't stop them.

`fruity` probably did this originally because their NSString truncated at null bytes, see [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnvzqz%2Ffruity%2Fissues%2F14)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Add patch version for fruity](/rustsec/advisory-db/pull/1223)

3 participants

[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=52&v=4)](/Shnatsel) [![@nvzqz](https://avatars.githubusercontent.com/u/10367662?s=52&v=4)](/nvzqz) [![@dylni](https://avatars.githubusercontent.com/u/46035563?s=52&v=4)](/dylni)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_d27c2714_20250115_095344.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frustsec%2Fadvisory-db%2Fpull%2F1102)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frustsec%2Fadvisory-db%2Fpull%2F1102)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rustsec%2Fadvisory-db)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rustsec](/rustsec)
/
**[advisory-db](/rustsec/advisory-db)**
Public

* [Notifications](/login?return_to=%2Frustsec%2Fadvisory-db) You must be signed in to change notification settings
* [Fork
  372](/login?return_to=%2Frustsec%2Fadvisory-db)
* [Star
   941](/login?return_to=%2Frustsec%2Fadvisory-db)

* [Code](/rustsec/advisory-db)
* [Issues
  60](/rustsec/advisory-db/issues)
* [Pull requests
  19](/rustsec/advisory-db/pulls)
* [Discussions](/rustsec/advisory-db/discussions)
* [Actions](/rustsec/advisory-db/actions)
* [Projects
  0](/rustsec/advisory-db/projects)
* [Security](/rustsec/advisory-db/security)
* [Insights](/rustsec/advisory-db/pulse)

Additional navigation options

* [Code](/rustsec/advisory-db)
* [Issues](/rustsec/advisory-db/issues)
* [Pull requests](/rustsec/advisory-db/pulls)
* [Discussions](/rustsec/advisory-db/discussions)
* [Actions](/rustsec/advisory-db/actions)
* [Projects](/rustsec/advisory-db/projects)
* [Security](/rustsec/advisory-db/security)
* [Insights](/rustsec/advisory-db/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frustsec%2Fadvisory-db%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frustsec%2Fadvisory-db%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add fruity advisory for nvzqz/fruity#14 #1102

 Merged

[Shnatsel](/Shnatsel)
merged 4 commits into
[rustsec:main](/rustsec/advisory-db/tree/main "rustsec/advisory-db:main")
from
dylni:add-fruity-advisory-for-nvzqz-fruity-14

Nov 15, 2021

 Merged

# [Add fruity advisory for nvzqz/fruity#14](#top) #1102

[Shnatsel](/Shnatsel)
merged 4 commits into
[rustsec:main](/rustsec/advisory-db/tree/main "rustsec/advisory-db:main")
from
dylni:add-fruity-advisory-for-nvzqz-fruity-14

Nov 15, 2021

[Conversation
4](/rustsec/advisory-db/pull/1102)
[Commits
4](/rustsec/advisory-db/pull/1102/commits)
[Checks
0](/rustsec/advisory-db/pull/1102/checks)
[Files changed](/rustsec/advisory-db/pull/1102/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dylni](https://avatars.githubusercontent.com/u/46035563?s=60&v=4)](/dylni)

Copy link

Contributor

### @dylni **[dylni](/dylni)** commented [Nov 14, 2021](#issue-1053061586) ‚Ä¢ edited Loading

Issue: [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)

A CVE request has been submitted as well.

Questions:

* Can I add trait implementations to the `functions` list?
* Should I create an unmaintained crate advisory too?
  + [`Display` for `NSString` truncates at null bytes¬†nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)
  + [I'd like to contribute¬†nvzqz/fruity#13](https://github.com/nvzqz/fruity/issues/13)

Sorry, something went wrong.

 üëç
1
 madsmtm reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 [dylni](/dylni)
added 2 commits
[November 14, 2021 17:21](#commits-pushed-ed272a5)

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&v=4)](/dylni)

`[Add fruity advisory for](/rustsec/advisory-db/pull/1102/commits/ed272a5f42f5b43a2672581d729995e8e858deee "Add fruity advisory for nvzqz/fruity#14") [nvzqz/fruity#14](https://github.com/nvzqz/fruity/issues/14)`

`[ed272a5](/rustsec/advisory-db/pull/1102/commits/ed272a5f42f5b43a2672581d729995e8e858deee)`

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&v=4)](/dylni)

`[Fix lint error](/rustsec/advisory-db/pull/1102/commits/263cf9eff8dd1230d9d3dd8cf7530d683b8e3e78 "Fix lint error")`

`[263cf9e](/rustsec/advisory-db/pull/1102/commits/263cf9eff8dd1230d9d3dd8cf7530d683b8e3e78)`

[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=80&u=6d52ad6b671a922da249dd410c15ba2634eee3a4&v=4)](/Shnatsel)

Copy link

Member

### **[Shnatsel](/Shnatsel)** commented [Nov 14, 2021](#issuecomment-968384788)

| Thank you for the report!  Could you clarify why this presents a security issue, ideally in the advisory text? It does appear to be a logic bug, but I don't see any evidence of memory corruption or the like. |
| --- |

All reactions

Sorry, something went wrong.

 [dylni](/dylni)
added 2 commits
[November 14, 2021 18:24](#commits-pushed-e775b8d)

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&v=4)](/dylni)

`[Fix lint error](/rustsec/advisory-db/pull/1102/commits/e775b8dfb572f50152f60f2e20fc7cb8297d5bf4 "Fix lint error")`

`[e775b8d](/rustsec/advisory-db/pull/1102/commits/e775b8dfb572f50152f60f2e20fc7cb8297d5bf4)`

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&v=4)](/dylni)

`[Add an impact section](/rustsec/advisory-db/pull/1102/commits/39f937b6ebbf62535c343c7bbdb0744bb079e41b "Add an impact section")`

`[39f937b](/rustsec/advisory-db/pull/1102/commits/39f937b6ebbf62535c343c7bbdb0744bb079e41b)`

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=80&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

Copy link

Contributor

Author

### **[dylni](/dylni)** commented [Nov 14, 2021](#issuecomment-968392284)

| [@Shnatsel](https://github.com/Shnatsel) An impact section has now been added. Does it seem sufficient?  This is easily one of the less severe security issues in many cases, since there are usually other mitigations that would prevent it. However, it was one of the main criticisms of PHP, for instance, so it has caused issues for filename validation in the past: <https://www.php.net/manual/en/security.filesystem.nullbytes.php> |
| --- |

All reactions

Sorry, something went wrong.

[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=80&u=6d52ad6b671a922da249dd410c15ba2634eee3a4&v=4)](/Shnatsel)

Copy link

Member

### **[Shnatsel](/Shnatsel)** commented [Nov 15, 2021](#issuecomment-968401405)

| Yes, the Impact section looks very well-written to me. Merging.  And thank you very much for discovering and reporting the issue! |
| --- |

All reactions

Sorry, something went wrong.

[![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=40&u=6d52ad6b671a922da249dd410c15ba2634eee3a4&v=4)](/Shnatsel)
[Shnatsel](/Shnatsel)
merged commit [`d5184e3`](/rustsec/advisory-db/commit/d5184e35e368262496dccfba2e5ddfcd56f3c1d8)
into
rustsec:main

[Nov 15, 2021](https://github.com/rustsec/advisory-db/pull/1102#event-5614961582)

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=80&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)

Copy link

Contributor

Author

### **[dylni](/dylni)** commented [Nov 15, 2021](#issuecomment-968404071)

| Thanks [@Shnatsel](https://github.com/Shnatsel)!  Should I create an issue to ask if the crate is no longer maintained, or is [nvzqz/fruity#13](https://github.com/nvzqz/fruity/issues/13) sufficient?  Also, the `affected.functions` section does not include the affected traits (e.g., `Display`). Is there a way to include those as well? |
| --- |

All reactions

Sorry, something went wrong.

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=40&u=d2e216558f79cb4125540b57742b172bffd3d35c&v=4)](/dylni)
[dylni](/dylni)
mentioned this pull request
[Nov 15, 2021](#ref-pullrequest-1053684851)

[Add CVE for RUSTSEC-2021-0123
#1105](/rustsec/advisory-db/pull/1105)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frustsec%2Fadvisory-db%2Fpull%2F1102)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@dylni](https://avatars.githubusercontent.com/u/46035563?s=52&v=4)](/dylni) [![@Shnatsel](https://avatars.githubusercontent.com/u/291257?s=52&v=4)](/Shnatsel)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


