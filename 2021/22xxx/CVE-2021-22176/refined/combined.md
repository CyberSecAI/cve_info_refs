=== Content from gitlab.com_b38cdce7_20250115_082751.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Revoked User can still view the Merge Request created by him via API

**[HackerOne report #962604](https://hackerone.com/reports/962604)** by `muthu_prakash` on 2020-08-19, assigned to [@kaunghtet](/kaunghtet "Kaung Htet Aung"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

In Gitlab when a user is demoted to Guest role, the Guest user will not be able to view and edit the Merge requests in a project even if the merge request is created by him. But this check is not implemented in API so the Guest user will be able to the following actions for the Merge request which he don't have a permission.

Allowed Actions in API

* Able to view the title and Description of the Merge Request via /projects/:id/merge\_requests/:merge\_request\_iid endpoint
* Get a list of merge request participants via /projects/:id/merge\_requests/:merge\_request\_iid/participants
* Get a list of merge request commits via /projects/:id/merge\_requests/:merge\_request\_iid/commits
* Get information about the merge request including its files and changes via /projects/:id/merge\_requests/:merge\_request\_iid/changes
* Get a list of merge request pipelines via /projects/:id/merge\_requests/:merge\_request\_iid/pipelines
* Create a TODO for that Merge Request via POST /projects/:id/merge\_requests/:merge\_request\_iid/todo
* Get a list of merge request diff versions via /projects/:id/merge\_requests/:merge\_request\_iid/versions
* Get Merge Request approvals status via /projects/:id/merge\_requests/:merge\_request\_iid/approvals

##### Steps to reproduce

1. Add a user a to a project with developer role.
2. From the Added user account create a Merge Request
3. From Admin account demote to the user to Guest Role
4. From the Guest user account try to access the Merge request created by that user. (Merge Request tab will not be available for that user)
5. Now Create an access token from the Guest user account and try to access the Merge Request created by the user by the above mentioned any one of the endpoints (Notice you will be able to view the Merge Request)

##### Impact

Guest Role users have access to Merge Request data that he's not authorised to view and Edit

##### What is the current *bug* behavior?

Guest Roles users have access to Merge Request data that he's not authorised to view and Edit via API

##### What is the expected *correct* behavior?

Guest Roles users should be restricted access to Merge Request to view and Edit via API

##### Output of checks

This bug happens on GitLab.com

#### Impact

Guest Role users have access to Merge Request data that he's not authorised to view and Edit

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

1. Steps outlined in [#243491 (comment 404509988)](https://gitlab.com/gitlab-org/gitlab/-/issues/243491#note_404509988 "Revoked User can still view  the Merge Request  created by him via API")

Edited Aug 31, 2020 by [Kaung Htet Aung](/kaunghtet)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_550cb7c3_20250115_082750.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22176.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22176.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22176.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22176.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 24, 2021

  [6a2d297e](/gitlab-org/cves/-/commit/6a2d297e852dc9ea5478ea8e2858e94d64d3e7aa)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6a2d297e852dc9ea5478ea8e2858e94d64d3e7aa)
  ·
  6a2d297e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

  6a2d297e

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6a2d297e852dc9ea5478ea8e2858e94d64d3e7aa)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

Loading


