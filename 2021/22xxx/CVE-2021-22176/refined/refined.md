```json
{
  "vulnerability": {
    "root_cause": "The application does not consistently enforce access controls for merge requests via the API after a user's role is demoted to Guest. Specifically, while the UI restricts access as expected, the API does not.",
    "weaknesses": [
      "Inconsistent access control enforcement between UI and API.",
      "Insufficient validation of user roles when accessing merge request data via the API.",
       "API endpoints for accessing merge requests did not check for the guest role."
    ],
    "impact": "Guest users can access merge request data (title, description, participants, commits, changes, pipelines, diff versions, approvals) via the API even when they should not be able to.",
    "attack_vectors": [
      "A guest user exploits API endpoints to access merge requests created when they were a developer."
     ],
    "required_capabilities": [
      "The attacker must have been a developer in a project, created a merge request, and then have their role demoted to Guest.",
       "The attacker needs to have API access via a generated access token for the guest user."
    ],
     "details": "The vulnerability allows a guest user, who previously had a developer role, to access merge request data through the API endpoints. These endpoints include:\n\t* /projects/:id/merge_requests/:merge_request_iid\n\t* /projects/:id/merge_requests/:merge_request_iid/participants\n\t* /projects/:id/merge_requests/:merge_request_iid/commits\n\t* /projects/:id/merge_requests/:merge_request_iid/changes\n\t* /projects/:id/merge_requests/:merge_request_iid/pipelines\n\t* /projects/:id/merge_requests/:merge_request_iid/todo\n\t* /projects/:id/merge_requests/:merge_request_iid/versions\n\t* /projects/:id/merge_requests/:merge_request_iid/approvals\n"
  }
}
```