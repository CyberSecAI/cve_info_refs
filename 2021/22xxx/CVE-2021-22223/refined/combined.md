=== Content from gitlab.com_32c3b850_20250115_085550.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Generic command Injections

**[HackerOne report #1059557](https://hackerone.com/reports/1059557)** by `yvvdwf` on 2020-12-15, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

The descriptions of Feature flags are not sanitized enough. It currently use `Dompurify` to allow only `&lt;strong&gt;` tag and [*all DOM attributes*](https://gitlab.com/gitlab-org/gitlab/-/blob/a73629186ff0b6469a3c794f11c13bee7ae3b8e0/ee/app/assets/javascripts/audit_events/components/table_cells/html_table_cell.vue#L16) of this tag. This allows attackers to introduce any DOM attributes and when combining with other existing javascript functions on gitlab, attackers might trick victims to do any PUT requests.

The following attack scenario allows setting a normal account as administrator.

##### Steps to reproduce

**as Attackers**

1. In any existing project, or create a new project, go to `Operations/Feature Flags`, click `New feature flag` button.
2. Fill the form in `New feature flag` as the following:

* Name: `XSS` (or anything, it is not important)
* Description: `&lt;strong style=&#34;position:absolute;top:0;left:0;right:0;bottom:0;z-index:99999&#34; data-url=&#34;/api/v4/users/USER_ID?admin=true&#34; class=js-usage-consent-action&gt;`. In the url above, please replace `USER_ID` by your user ID that is existing in your gitlab instance.
* Click `Create feature flag` to save the flag

**as Admin**

1. Go to `Admin area/Monitoring/Audit log`. After opening the `Audit log`, you might notice that there exists a transparent layer on the topmost. That layer intercept any click events.
2. Click anywhere (to set the attacker as administrator)

##### Impact

Attackers might use this vulnerable to escalate permission.

##### What is the current *bug* behavior?

The descriptions of feature flags are not sanitized correctly.

##### What is the expected *correct* behavior?

Any DOM attributes of `&lt;strong&gt;` tags in the description of feature flags should be eliminated.

##### Output of checks

###### Results of GitLab environment info

(For installations with omnibus-gitlab package run and paste the output of:

`sudo gitlab-rake gitlab:env:info`)

```
System information
System:		Ubuntu 18.04
Proxy:		no
Current User:	git
Using RVM:	no
Ruby Version:	2.7.2p137
Gem Version:	3.1.4
Bundler Version:2.1.4
Rake Version:	13.0.1
Redis Version:	5.0.9
Git Version:	2.29.0
Sidekiq Version:5.2.9
Go Version:	unknown

GitLab information
Version:	13.6.0-ee
Revision:	c050e8fb184
Directory:	/opt/gitlab/embedded/service/gitlab-rails
DB Adapter:	PostgreSQL
DB Version:	11.9
URL:		http://gl.local
HTTP Clone URL:	http://gl.local/some-group/some-project.git
SSH Clone URL:	git@gl.local:some-group/some-project.git
Elasticsearch:	no
Geo:		no
Using LDAP:	no
Using Omniauth:	yes
Omniauth Providers:

GitLab Shell
Version:	13.13.0
Repository storage paths:
- default: 	/var/opt/gitlab/git-data/repositories
GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell
Git:		/opt/gitlab/embedded/bin/git
```

#### Impact

Attackers might use this vulnerable to escalate permission.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_1b4605a8_20250115_085549.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22223.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22223.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22223.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22223.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jul 05, 2021

  [40cc43a6](/gitlab-org/cves/-/commit/40cc43a61340936ef6c5cb5c3294e299a46f445c)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/40cc43a61340936ef6c5cb5c3294e299a46f445c)
  ·
  40cc43a6

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 05, 2021

  40cc43a6

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/40cc43a61340936ef6c5cb5c3294e299a46f445c)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 05, 2021

Loading


