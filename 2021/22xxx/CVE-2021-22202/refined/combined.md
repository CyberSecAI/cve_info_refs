=== Content from gitlab.com_74dac4df_20250115_083303.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# CSRF in System hooks execution through API

**[HackerOne report #471274](https://hackerone.com/reports/471274)** by `mishre` on 2018-12-22:

**Summary:**
Gitlab allows admins (of the whole deployment) to configure system hooks, which will be executed upon certain actions (across all projects). However, it seems that there exists an endpoint which sends a test web hook when being browsed by an admin.

**Description:**
When the admin is logged and an attacker lures him to browse `https://gitlab-instance/api/v4/hooks/{hook-id}` the hook is executed with test parameters possibly causing undesired actions to be performed (sending requests which the admin didn't want to send). An attacker can cause a silent execution of the web hook, by luring the admin to browse his own site (while including an image on that site poiting to the mentioned endpoint) or by luring the admin on clicking a link.

## Steps To Reproduce:

1. Login to Gitlab as the instance admin.
2. Browse to <https://gitlab-instance/admin/hooks>
3. Create a hook pointing to a server under your control.
4. Now browse to <https://gitlab-instance/api/v4/hooks/1> (substitute 1 with the created hook's id)
5. To verify this actually executed the hook - check your hook server logs, you should see a request with the following header: X-Gitlab-Event

## Impact

An attacker can cause system hooks to be executed undesirably.

## Security Team Recommendation

Change the HTTP method to POST to be consistent with the solution in <https://gitlab.com/gitlab-org/gitlab-ce/issues/42604>.

Edited Jan 07, 2019 by [Ethan Strike](/estrike)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_42dd1d3b_20250115_083302.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22202.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22202.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22202.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22202.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jul 13, 2021

  [48839b9e](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  [Publishing 4 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  ·
  48839b9e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 13, 2021

  48839b9e

  [Publishing 4 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/48839b9e657026bdcf69011468ec40892f398a25)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jul 13, 2021

Loading


