=== Content from gitlab.com_135392b2_20250115_100334.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22196.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22196.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22196.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22196.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Apr 28, 2021

  [2086a3b3](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  [Publishing 13 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  ·
  2086a3b3

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Apr 28, 2021

  2086a3b3

  [Publishing 13 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Apr 28, 2021

Loading



=== Content from gitlab.com_d8e913b8_20250115_100335.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored-XSS in merge requests

**[HackerOne report #977697](https://hackerone.com/reports/977697)** by `yvvdwf` on 2020-09-09, assigned to [@vdesousa](/vdesousa "Vitor Meireles De Sousa"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hi team,

A stored XSS is existing in the merge requests pages.

##### Steps to reproduce

1. In any existing project or create a new project with checking option "Initialize repository with a README"
2. Create a new branch with name `&#39;&gt;&lt;iframe/srcdoc=&#39;&lt;script/src=/yvvdwf/data/-/jobs/552156057/artifacts/raw/alert.js&gt;&lt;/script&gt;&#39;&gt;&lt;/iframe&gt;`, e.g., `git push origin master:&#34;&#39;&gt;&lt;iframe/srcdoc=&#39;&lt;script/src=/yvvdwf/data/-/jobs/552156057/artifacts/raw/alert.js&gt;&lt;/script&gt;&#39;&gt;&lt;/iframe&gt;&#34;`
3. Create a new merge request from the new branch to master
4. When open the merge request being created, you should see an alert

##### Impact

This stored-XSS allows attacker to execute arbitrary actions on behalf of victim notably via gitlab API. It occurs automatically without any need of victim's interaction despite gitlab CSP.

##### Examples

(the alert occurs although existing of CSP of gitlab)

<https://gitlab.com/yvvdwf/store-xss-merge-request/-/merge_requests/1>

##### What is the current *bug* behavior?

In [\_sidebar.html.haml](https://gitlab.com/gitlab-org/gitlab/-/blob/3d10455ebe4d90f3a6c4fd73a0d52aa4506e40f8/app/views/shared/issuable/_sidebar.html.haml#L170), the `source_branch` is not sanitized when using as `title` attribute

```
%span
    = _(&#39;Source branch: %{source_branch_open}%{source_branch}%{source_branch_close}&#39;).html_safe % { source_branch_open: &#34;&lt;cite title=&#39;#{source_branch}&#39;&gt;&#34;.html_safe, source_branch_close: &#34;&lt;/cite&gt;&#34;.html_safe, source_branch: source_branch }
```

##### What is the expected *correct* behavior?

`sourche_banch` should be sanitized

##### Output of checks

This bug happens on GitLab.com

#### Impact

This stored-XSS allows attacker to execute arbitrary actions on behalf of victim notably via gitlab API. It occurs automatically without any need of victim's interaction despite gitlab CSP.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


