=== Content from discuss.rubyonrails.org_0a1da068_20250114_195402.html ===


![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [[CVE-2021-22902] Possible Denial of Service vulnerability in Action Dispatch](/t/cve-2021-22902-possible-denial-of-service-vulnerability-in-action-dispatch/77866)

[Security Announcements](/c/security-announcements/9)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

May 5, 2021, 4:57pm

1

There is a possible Denial of Service vulnerability in the Mime type parser of
Action Dispatch. This vulnerability has been assigned the CVE identifier
CVE-2021-22902.

Versions Affected: >= 6.0.0
Not affected: < 6.0.0
Fixed Versions: 6.0.3.7, 6.1.0.2

## Impact

There is a possible Denial of Service vulnerability in Action Dispatch.
Carefully crafted Accept headers can cause the mime type parser in Action
Dispatch to do catastrophic backtracking in the regular expression engine.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

The following monkey patch placed in an initializer can be used to work around
the issue:

```
module Mime
  class Type
    MIME_REGEXP = /\A(?:\*\/\*|#{MIME_NAME}\/(?:\*|#{MIME_NAME})(?>\s*#{MIME_PARAMETER}\s*)*)\z/
  end
end

```
## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 6-0-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch for 6.0 series
* 6-1-Prevent-catastrophic-backtracking-during-mime-parsin.patch - Patch for 6.1 series

Please note that only the 6.1.Z, 6.0.Z, and 5.2.Z series are supported at
present. Users of earlier unsupported releases are advised to upgrade as soon
as possible as we cannot guarantee the continued availability of security
fixes for unsupported releases.

## Credits

Thanks to Security Curious security-curious@pm.me for reporting this!

[6-1-Prevent-catastrophic-backtracking-during-mime-parsin.patch](/uploads/short-url/3hp8aVmp45qOHC7Fni8jOXRSQT6.patch) (2.2 KB) [6-0-Prevent-catastrophic-backtracking-during-mime-parsin.patch](/uploads/short-url/rFjaiDVa2Dgz3KOJVlRnoFaC4Qd.patch) (2.2 KB)

5 Likes

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2023-22792] Possible ReDoS based DoS vulnerability in Action Dispatch](https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) ,  [actiondispatch](https://discuss.rubyonrails.org/tag/actiondispatch) | 0 | 7513 | January 17, 2023 |
| [[CVE-2023-22795] Possible ReDoS based DoS vulnerability in Action Dispatch](https://discuss.rubyonrails.org/t/cve-2023-22795-possible-redos-based-dos-vulnerability-in-action-dispatch/82118)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) ,  [actiondispatch](https://discuss.rubyonrails.org/tag/actiondispatch) | 0 | 7603 | January 17, 2023 |
| [[CVE-2023-27530] Possible DoS Vulnerability in Multipart MIME parsing](https://discuss.rubyonrails.org/t/cve-2023-27530-possible-dos-vulnerability-in-multipart-mime-parsing/82388)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 10450 | March 2, 2023 |
| [Possible ReDoS vulnerability in Accept header parsing in Action Dispatch](https://discuss.rubyonrails.org/t/possible-redos-vulnerability-in-accept-header-parsing-in-action-dispatch/84946)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) | 0 | 3772 | February 21, 2024 |
| [[CVE-2022-44572] Possible Denial of Service Vulnerability in Rack's RFC2183 boundary parsing](https://discuss.rubyonrails.org/t/cve-2022-44572-possible-denial-of-service-vulnerability-in-racks-rfc2183-boundary-parsing/82124)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 4528 | January 17, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


