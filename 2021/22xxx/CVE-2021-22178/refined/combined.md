=== Content from gitlab.com_c35f01a4_20250114_200751.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SSRF: send arbitrary POST requests into local networks

**[HackerOne report #1037411](https://hackerone.com/reports/1037411)** by `yvvdwf` on 2020-11-18, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

Prometheus integration service allows to issue any POST requests into local network.

##### Steps to reproduce

1. In any existing project (or create a new one), goto Settings/Intergrations/Prometheus
2. Setting the following parameters:

* Active: check
* API URL: `https://gitlab.com` (or any url)
* Google IAP Audience Client ID: `test` (or any string)
* Google IAP Service Account JSON: `{"token_credential_uri": "http://localhost:1234/arbitrary-query?x=y", "private_key": 512}`

3. Click "Test" button, gitlab will hit`localhost:1234` (e.g., open a web server at port 1234 to receive the requests)

##### Impact

The SSRF allows attackers to issue arbitrary POST requests into local network. The impact will be different, depending on which services are running on the local network. For example, if there exists a docker daemon that is listening on localhost:2375, then attackers may read any files by issuing a POST request to build an image from remote dockerfile. With your permission, I will try to discover gitlab.com .

##### Output of checks

This bug happens on GitLab.com

#### Impact

The SSRF allows attackers to issue arbitrary POST requests into local network. The impact will be different, depending on which services are running on the local network. For example, if there exists a docker daemon that is listening on localhost:2375, then attackers may read any files by issuing a POST request to build an image from remote dockerfile. With your permission, I will try to discover gitlab.com .

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Mar 15, 2021 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_6f686959_20250114_200749.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22178.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22178.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22178.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22178.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 24, 2021

  [c46f3e25](/gitlab-org/cves/-/commit/c46f3e2576653d4d04e2200a3f9aba133d6cf445)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c46f3e2576653d4d04e2200a3f9aba133d6cf445)
  ·
  c46f3e25

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

  c46f3e25

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c46f3e2576653d4d04e2200a3f9aba133d6cf445)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

Loading


