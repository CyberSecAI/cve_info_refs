=== Content from gitlab.com_a8942dc3_20250114_192749.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22182.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22182.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22182.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22182.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 03, 2021

  [db2dfc84](/gitlab-org/cves/-/commit/db2dfc84b6ed6737fbb8cabc47ee8b607aadda67)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/db2dfc84b6ed6737fbb8cabc47ee8b607aadda67)
  ·
  db2dfc84

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 03, 2021

  db2dfc84

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/db2dfc84b6ed6737fbb8cabc47ee8b607aadda67)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 03, 2021

Loading



=== Content from gitlab.com_183b2fbb_20250114_192749.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in merge request because of target branch

**[HackerOne report #1030189](https://hackerone.com/reports/1030189)** by `ashish_r_padelkar` on 2020-11-09, assigned to [@kaunghtet](/kaunghtet "Kaung Htet Aung"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello,

I Found a stored XSS in merge request which triggers for everyone in public project as merge requests are available for everyone. Currently Gitlab.com is prevented because of CSP.

##### Steps to reproduce

1. Create a file at `-/new/master/` and in `Target Branch` section put branch name as XSS payload `"><img/src='x'onerror=prompt(1)>`.
2. Create a merge request now at `/-/merge_requests/new`. Select `Target Branch` as above branch with XSS payload and create a merge request.
3. As soon as you create merge request, you should see below button

[![Screenshot_2020-11-10_at_00.52.04.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/60fc7fc0ea7f6dc30921a8ce3b37f9be70faa2a8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32313664633438392d646563612d343239302d383835392d3636356335343833376664642f53637265656e73686f745f323032302d31312d31305f61745f30302e35322e30342e706e67)

4. Click on `Merge Immediately`
5. It will create a pipeline and appears as a note which triggers this XSS

[![Screenshot_2020-11-10_at_00.53.36.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/6e43fab97c80e472e967849fe1d0674565a82332/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61383664366533392d353266652d343661342d613033312d3632353462613066643633362f53637265656e73686f745f323032302d31312d31305f61745f30302e35332e33362e706e67)

##### Output of checks

This bug happens on GitLab.com

Regards,

Ashish

#### Impact

Stored XSS in merge request

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2020-11-10\_at\_00.52.04.png](https://h1.sec.gitlab.net/a/216dc489-deca-4290-8859-665c54837fdd/Screenshot_2020-11-10_at_00.52.04.png)
* [Screenshot\_2020-11-10\_at\_00.53.36.png](https://h1.sec.gitlab.net/a/a86d6e39-52fe-46a4-a031-6254ba0fd636/Screenshot_2020-11-10_at_00.53.36.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Nov 10, 2020 by [Kaung Htet Aung](/kaunghtet)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


