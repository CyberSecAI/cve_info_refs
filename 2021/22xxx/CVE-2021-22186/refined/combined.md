=== Content from gitlab.com_3d534c7e_20250115_095019.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Group Maintainers are able to use the Group CI/CD Variables API

### Summary

Group Maintainers are able to use the [Group CI/CD Variables API](https://docs.gitlab.com/ee/api/group_level_variables.html). According to our [permissions model](https://docs.gitlab.com/ee/user/permissions.html#group-members-permissions), this action should be limited to Group Owners. Thus is a critical elevation of user permissions.

### Steps to reproduce

`curl --request POST --header "PRIVATE-TOKEN: $GROUP_MAINTAINER_TOKEN" "https://gitlab.com/api/v4/groups/$GROUP_ID/variables" --form "key=maintainertest" --form "value=test"`

### What is the current *bug* behavior?

Group Maintainers are able to manage Group-level CI/CD variables using the [API](https://docs.gitlab.com/ee/api/group_level_variables.html).

### What is the expected *correct* behavior?

Only Group Owners should be able to manage Group-level CI/CD variables.

### Relevant logs and/or screenshots

```
curl --request POST --header "PRIVATE-TOKEN: $GROUP_MAINTAINER_TOKEN" "https://gitlab.com/api/v4/groups/$GROUP_ID/variables" --form "key=maintainertest" --form "value=test"
{"variable_type":"env_var","key":"maintainertest","value":"test","protected":false,"masked":false}%
```

expected

```
curl --request POST --header "PRIVATE-TOKEN: $GROUP_MAINTAINER_TOKEN" "https://gitlab.com/api/v4/groups/$GROUP_ID/variables" --form "key=maintainertest" --form "value=test"
{"message":"403 Forbidden"}
```

### Output of checks

This bug happens on GitLab.com

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_85048d10_20250115_095019.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22186.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22186.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22186.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22186.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Mar 24, 2021

  [447bbb05](/gitlab-org/cves/-/commit/447bbb05ec931c735502b03df22df498213e8aa5)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/447bbb05ec931c735502b03df22df498213e8aa5)
  繚
  447bbb05

  [ GitLab Bot ](/gitlab-bot) authored Mar 24, 2021

  447bbb05

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/447bbb05ec931c735502b03df22df498213e8aa5)
  [ GitLab Bot ](/gitlab-bot) authored Mar 24, 2021

Loading


