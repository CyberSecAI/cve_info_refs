=== Content from gitlab.com_c8bba391_20250114_183900.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Restrict vulnerability pages for Reporter and below

**[HackerOne report #1047140](https://hackerone.com/reports/1047140)** by `vaib25vicky` on 2020-11-30, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Why are we doing this work

The fix for the vulnerability described in <https://gitlab.com/gitlab-org/gitlab/-/issues/289996> involved hiding the button in the [frontend](/gitlab-org/gitlab/-/issues?label_name=frontend "Issues for the Frontend team. Covers everything related to the way GitLab behaves (and, to an extent, looks) inside your browser."). More importantly, the [backend](/gitlab-org/gitlab/-/issues?label_name=backend "Issues that require backend work") also needs to deny the requests.

**Restriction targets**

* Security Dashboard (Vulnerabilities over time, Project security status)
  + root group (fka "instance") e.g.: <https://gitlab.com/-/security/dashboard>)
  + group; e.g.: <https://gitlab.com/groups/gitlab-org/-/security/dashboard>
  + project; e.g.: <https://gitlab.com/gitlab-org/gitlab/-/security/dashboard>
* Vulnerability Report
  + group; e.g.: <https://gitlab.com/groups/gitlab-org/-/security/vulnerabilities>
  + project; e.g.: <https://gitlab.com/gitlab-org/gitlab/-/security/vulnerability_report>
* GraphQL API
  + Endpoints that provide vulnerability counts for a project.
* REST API
  + Endpoints that create/download exports of vulnerability data.

## Relevant links

* [Restrict export](https://gitlab.com/gitlab-org/gitlab/-/issues/289996#note_458453608)
* [Restrict vulnerability count](https://gitlab.com/gitlab-org/gitlab/-/issues/289996#note_460282962)
* [Restrict vulnerability pages](https://gitlab.com/gitlab-org/gitlab/-/issues/289996#note_480786012)
* [Restrict all the things](https://gitlab.com/gitlab-org/gitlab/-/issues/289996#note_488248372)

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [iss0.png](https://h1.sec.gitlab.net/a/463f847b-1217-43b4-b41b-2ae64676b986/iss0.png)
* [iss1.png](https://h1.sec.gitlab.net/a/e5eaa8fa-ac0f-40c3-aca9-c6e99956a5c5/iss1.png)
* [iss2.png](https://h1.sec.gitlab.net/a/74aaf31a-b884-4df3-8947-48adcd3a743d/iss2.png)
* [iss3.png](https://h1.sec.gitlab.net/a/f3667367-3ec5-4efa-9ed4-06b8c41bcc4c/iss3.png)

## Non-functional requirements

* Documentation:
* Feature flag:
* Performance:
* Testing:

## Implementation plan

* [backend](/gitlab-org/gitlab/-/issues?label_name=backend "Issues that require backend work") block Reporter and below from requesting:
  + `vulnerabilitiesCountByDay`, `vulnerabilitySeveritiesCount`, `vulnerabilityGrades` endpoints in the GraphQL API
  + `vulnerability_exports` endpoints in the REST API
* Return 403 for Reporter and below:
  + `security/vulnerabilities` pages
  + `security/dashboard` pages
  + `security/vulnerability_report` page

/cc [@matt\_wilson](/matt_wilson "Matt Wilson") [@lkerr](/lkerr "Lindsay Kerr")

Edited Jun 11, 2021 by [Lindsay Kerr](/lkerr)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_db25763d_20250114_183859.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22244.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22244.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22244.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22244.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Aug 23, 2021

  [e55180fb](/gitlab-org/cves/-/commit/e55180fbf18ea558f1c5c3fbe4c7de8e4bcadae8)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e55180fbf18ea558f1c5c3fbe4c7de8e4bcadae8)
  ·
  e55180fb

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 23, 2021

  e55180fb

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e55180fbf18ea558f1c5c3fbe4c7de8e4bcadae8)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 23, 2021

Loading


