```
{
  "CVE-2021-22945": {
    "Description": "When sending data to an MQTT server, libcurl <= 7.73.0 and 7.78.0 could in some circumstances erroneously keep a pointer to an already freed memory area and both use that again in a subsequent call to send data and also free it again.",
    "Root cause": "Use-after-free vulnerability in libcurl when sending data to an MQTT server. The code incorrectly maintains a pointer to freed memory and attempts to use and free it again later.",
    "Weaknesses": [
      "Use-after-free",
      "Double-free"
     ],
    "Impact": "Memory corruption, potentially leading to arbitrary code execution.",
    "Attack vectors": [
      "Sending crafted data to an MQTT server that triggers the vulnerability in libcurl."
    ],
   "Required attacker capabilities/position": "An attacker would need the ability to interact with an MQTT server and send crafted requests which would trigger the use-after-free and double free condition in libcurl."
  },
  "CVE-2021-22946": {
    "Description": "A user can tell curl >= 7.20.0 and <= 7.78.0 to require a successful upgrade to TLS when speaking to an IMAP, POP3 or FTP server (--ssl-reqd on the command line orCURLOPT_USE_SSL set to CURLUSESSL_CONTROL or CURLUSESSL_ALL withlibcurl). This requirement could be bypassed if the server would return a properly crafted but perfectly legitimate response.This ﬂaw would then make curl silently continue its operations withoutTLS contrary to the instructions and expectations, exposing possibly sensitive data in clear text over the network.",
    "Root cause": "The vulnerability arises because curl does not properly enforce a required TLS upgrade when interacting with IMAP, POP3, or FTP servers.",
    "Weaknesses": [
      "TLS downgrade bypass",
       "Cleartext transmission of sensitive information"
     ],
    "Impact": "The vulnerability could allow a man-in-the-middle attacker to downgrade a connection from TLS to cleartext, allowing for the interception of sensitive information.",
    "Attack vectors": [
       "Man-in-the-middle attacks intercepting network traffic.",
       "Crafted server responses."
     ],
    "Required attacker capabilities/position": "An attacker needs to be in a position to intercept network traffic between the client and the server."
  },
  "CVE-2021-22947": {
    "Description": "When curl >= 7.20.0 and <= 7.78.0 connects to an IMAP or POP3 server to retrieve data using STARTTLS to upgrade to TLS security, the server can respond and send back multiple responses at once that curl caches. curl would then upgrade to TLS but not ﬂush the in-queue of cached responses but instead continue using and trustingthe responses it got before the TLS handshake as if they were authenticated.Using this ﬂaw, it allows a Man-In-The-Middle attacker to first inject the fake responses, then pass-through the TLS trafﬁc from the legitimate server and trick curl into sending data back to the user thinking the attacker’s injected data comes from the TLS-protected server.",
    "Root cause": "The vulnerability stems from curl’s improper handling of cached server responses after a TLS upgrade using STARTTLS in IMAP or POP3 connections. The cached responses from before the TLS upgrade aren't cleared and are still used as if authenticated after the TLS upgrade",
    "Weaknesses": [
      "STARTTLS protocol injection",
      "Insufficient verification of data authenticity"
     ],
    "Impact": "Man-in-the-middle (MITM) attacks, allowing injection of fake responses and potentially leading to data compromise.",
    "Attack vectors": [
       "Man-in-the-middle attacks intercepting network traffic.",
       "Crafted server responses."
     ],
    "Required attacker capabilities/position": "The attacker must be positioned to intercept network traffic between the client and the IMAP/POP3 server."
    }
}
```