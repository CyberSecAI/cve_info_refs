=== Content from gitlab.com_d991d695_20250114_181558.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22260.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22260.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22260.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22260.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 11, 2022

  [06afb3e7](/gitlab-org/cves/-/commit/06afb3e7b1d21d1597c3757c3607fe94fab65075)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/06afb3e7b1d21d1597c3757c3607fe94fab65075)
  ·
  06afb3e7

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

  06afb3e7

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/06afb3e7b1d21d1597c3757c3607fe94fab65075)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

Loading



=== Content from gitlab.com_a7125809_20250114_181559.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in DataDog Integration affects maintainers/owners

**[HackerOne report #1257383](https://hackerone.com/reports/1257383)** by `shells3c` on 2021-07-11, assigned to GitLab Team:

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

The code: <https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/models/integrations/datadog.rb>

```
   def fields
    ...
    {
          type: 'password',
          name: 'api_key',
          title: _('API key'),
          non_empty_password_title: s_('ProjectService|Enter new API key'),
          non_empty_password_help: s_('ProjectService|Leave blank to use your current API key'),
          help: "<a href=\"#{api_keys_url}\" target=\"_blank\">API key</a> used for authentication with Datadog",
          required: true
    }

    ...

    def api_keys_url
      return URL_API_KEYS_DOCS unless datadog_site.presence

      sprintf(URL_TEMPLATE_API_KEYS, datadog_site: datadog_site)
    end

```

The `api_keys_url` is not sanitized before being rendered, leads to XSS, affects any maintainer/owner of the project when they visit the DataDog Integration

##### Steps to reproduce

1. Go to DataDog Integration setting: [https://gitlab.com/:user:/:project:/-/services/datadog/edit](https://gitlab.com/%3Auser%3A/%3Aproject%3A/-/services/datadog/edit) (requires permission)
2. In the **Datadog site** field, set the value to `"><script>alert()</script>`, then **Save**
3. Now XSS will be activated in [https://gitlab.com/:user:/:project:/-/services/datadog/edit](https://gitlab.com/%3Auser%3A/%3Aproject%3A/-/services/datadog/edit), send this link to victims

#### Impact

Stored XSS affects maintainers/owners

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


