=== Content from gitlab.com_d97bff29_20250115_102013.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Unauthenticated CI lint API may lead to information disclosure and SSRF

**[HackerOne report #1059596](https://hackerone.com/reports/1059596)** by `myster` on 2020-12-15:

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

HI!

CI Lint API (<https://docs.gitlab.com/ee/api/lint.html>) allows anonymous access for anyone to validate yaml syntax which in itself is not really an issue however use of `remote` includes may result in an abuse of this unauthenticated API endpoint.

**Scenario 1:**

An administrator enables internal requests to use Webhooks with internal services assuming its safe to do because all users are part of the organization and can be trusted.

This would also allow an attacker to abuse the CI Lint Api with remote includes to perform internal network requests.

PoC `.gitlab-ci.yml`:

```
include:
  remote: &#39;http://127.0.0.1:9100/b.yml&#39;
```

curl request:

```
curl -s -H &#39;Content-Type: application/json&#39; https://redacted/api/v4/ci/lint --data &#39;{ &#34;include_merged_yaml&#34;: true, &#34;content&#34;: &#34;include:\n  remote: &#39;http://127.0.0.1:9100/b.yml&#39;&#34; }&#39;
```

response (if port is open):

```
    &#34;Included file `http://127.0.0.1:9100/b.yml` does not have valid YAML syntax!&#34;
```

**Scenario 2:**

Let's assume that internal requests are blocked. Even in such a scenario, following risks are present:

1. Abuse of the Gitlab instance as a proxy to port scan remote targets (I know there are a lot of such proxies out there, but still there should at least be an option to disallow this)
2. Disclosure of origin IP address + User agent of Gitlab instance when its running behind a load balancer or services like Cloudflare for DDoS protection.

Therefore, I think this endpoint should not be public by default and enforcing authentication might be a good idea allowing a toggle to disable it if one is aware of potential risks here.

Thanks!

#### Impact

* Origin IP address disclosure
* Unauthenticated SSRF when an admin whitelists internal endpoints for Authenticated users

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

## Proposal

[#294178 (comment 484606184)](https://gitlab.com/gitlab-org/gitlab/-/issues/294178#note_484606184 "Unauthenticated CI lint API may lead to information disclosure and SSRF")

Edited Feb 15, 2021 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_5af74677_20250115_102012.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22175.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22175.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22175.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22175.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jun 09, 2021

  [ea546954](/gitlab-org/cves/-/commit/ea5469549c45f5d77baff053898e299e48350313)
  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/ea5469549c45f5d77baff053898e299e48350313)
  ·
  ea546954

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 09, 2021

  ea546954

  [Publishing 0 updated advisories and 2 new advisories](/gitlab-org/cves/-/commit/ea5469549c45f5d77baff053898e299e48350313)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 09, 2021

Loading


