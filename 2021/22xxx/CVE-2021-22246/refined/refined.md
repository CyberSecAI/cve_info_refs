```json
{
  "CVE-2021-22246": {
    "related": true,
    "summary": "GitLab Webhooks do not properly obey timeouts, so connections can be forced to last forever.",
    "root_cause": "The GitLab webhook implementation lacks a proper timeout mechanism for HTTP(S) connections, except for the 'Test Webhook' functionality.",
    "weaknesses": [
      "Improper timeout handling for webhook connections",
      "Acceptance of large response data without proper resource management."
    ],
    "impact": "Denial of service. The vulnerability allows an attacker to keep HTTP(S) connections open indefinitely, potentially leading to resource exhaustion, including depletion of connection pools, memory exhaustion, and process termination. It can also slow down the system.",
    "attack_vectors": [
      "A malicious webhook receiver can respond in a way that keeps the connection alive indefinitely by sending data very slowly.",
      "A malicious webhook receiver can send large amounts of data to consume resources on the GitLab server",
       "An attacker can trigger a large number of webhooks to exacerbate the impact."
    ],
    "attacker_capabilities": "The attacker needs to be able to either add webhooks to a project (or system webhook or integration) or control a server that a webhook is configured to connect to.",
    "additional_details": "The vulnerability affects any use of `Gitlab::HTTP.post` such as system webhooks and integrations (e.g. Mattermost). The issue is not limited to project webhooks. When viewing webhook logs, a large response body can cause the Puma worker to be killed due to out-of-memory. The lack of timeouts affects webhook requests triggered by actions (e.g. creating a new issue) more severely than the 'Test Webhook' functionality, which has a 60-second timeout. The `perform_request` function is identified in the stack trace, which uses HTTParty and where the lack of timeout is likely."
  }
}
```