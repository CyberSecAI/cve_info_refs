Based on the provided content, here's the breakdown of CVE-2021-22893:

**Root Cause of Vulnerability:**

*   A use-after-free vulnerability exists in Pulse Connect Secure (PCS) within the license server handling endpoint.

**Weaknesses/Vulnerabilities Present:**

*   **Use-After-Free:** The vulnerability stems from improper memory management, specifically a use-after-free condition. This means the software attempts to access memory that has already been freed, potentially leading to unexpected behavior.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** A remote, unauthenticated attacker can execute arbitrary code on the vulnerable PCS gateway.
*   **Root Privileges:** The attacker gains root privileges on the system. This level of access allows the attacker to take complete control of the compromised system.

**Attack Vectors:**

*   **Network-Based:** The vulnerability is exploitable through network requests, targeting specific endpoints related to license server handling.
*   **Unauthenticated Access:** Exploitation does not require prior authentication to the vulnerable system.
*   **Crafted Request:** The attacker needs to send a crafted request to a vulnerable endpoint on the PCS gateway.

**Required Attacker Capabilities/Position:**

*   **Remote Access:** The attacker can be located remotely and does not need to be on the local network.
*   **Network Connectivity:** The attacker needs network connectivity to the vulnerable PCS system.
*   **Ability to Forge Requests:** The attacker needs to be able to craft malicious requests that trigger the use-after-free condition.
* **No Authentication:** The attacker does not need any credentials to exploit the vulnerability.

**Additional Notes:**

*   The vulnerability affects all systems running PCS 9.0R3 or higher, or 9.1R1 through 9.2R11.3.
*   The license server configuration does not need to be enabled for a system to be vulnerable.
*   This vulnerability has been exploited in the wild.
*   Multiple threat actors have been observed exploiting this vulnerability.
*   The exploitation of this vulnerability is often combined with techniques to bypass authentication and persist on the compromised device.
*   The vulnerability can be leveraged to install backdoors, webshells, and credential stealers.
*   The attackers often modify legitimate Pulse Secure binaries and scripts to maintain persistence.