=== Content from gitlab.com_c34a4a37_20250114_230104.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22195.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22195.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22195.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22195.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Apr 01, 2021

  [3ef2fd28](/gitlab-org/cves/-/commit/3ef2fd28e0f9eb732bbf1c7f807cfb1ce805251f)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3ef2fd28e0f9eb732bbf1c7f807cfb1ce805251f)
  ·
  3ef2fd28

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Apr 01, 2021

  3ef2fd28

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3ef2fd28e0f9eb732bbf1c7f807cfb1ce805251f)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Apr 01, 2021

Loading



=== Content from gitlab.com_7a40ce02_20250114_230104.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Remote Code Execution after cloning a malicious repository [ VSCode Extension ]

**[HackerOne report #1094381](https://hackerone.com/reports/1094381)** by `rapt00r` on 2021-02-04, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

### Summary

Hi there! I've found a critical vulnerability on the VSCode Extension `gitlab` that allows an attacker to execute malicious binary on the victim's machine after they cloning a repository.

### Description

The vulnerability occurs because the gitlab extension for VSCode doesn't specify where the binary `git.exe` on the windows, must be called. This will make the Windows search for the `git.exe` inside of the current directory after cloning a repository, allowing a custom git.exe binary to be executed after the clone.

##### Why this happen?

When a user execute a command, Windows first will check on the current directory, then it's will verify each path in the `%PATH%` variable and finally checks the system locations, for example `%WINDIR%`.

By knowing this, when a user clone a new repository, Windows will check if the `git.exe` file exists on the current directory (cloned repository) and if found, it will be executed. As the malicious repository have the `git.exe` file and any 'allowed paths' are not defined, Windows will check the repository and will execute, allowing to execute our binaries.

### Steps to Reproduce

1. Create a new Repository.
2. Rename a Window's binary to `git.exe` and upload to the repository (in this example, I used the calculator.exe)
3. Open the VSCode and install the gitlab extension.
4. Clone the repository
5. The binary will be executed after the clone.

#### Demo

1. Creating a new repository:

   [![gitlab-00.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/1f9e204e91de1dc566f5b3e61185e1dbe62f446c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f38626438633738612d643934662d346630372d383863312d3333656666633735386132312f6769746c61622d30302e706e67)
2. Upload the calculator binary inside of the repository (remember to renamee it to git.exe before upload):

   [![gitlab-04.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/464a9f57d8d9653b9c6129c3fdccc6766d226b1d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34616435393231322d346531342d346330632d396666352d3161306231333730663239662f6769746c61622d30342e706e67)
3. Clone the repository (can be via VSCode directly too):

   [![gitlab-05.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b94d96e5a36ee44f66876f85c6b2d77d7332c1e8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36383633386539392d633165632d346263332d393936652d3561333264386163346438642f6769746c61622d30352e706e67)
4. Open the repository in the VSCode:

   [![gitlab-07.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/c22642ac4378ff1cbc3f96ecb37fbd0b3c25bc71/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37616639306639302d373331362d343931322d393862622d3462613962316432613435382f6769746c61622d30372e706e67)
5. The calculator binary will be executed:

   [![gitlab-08.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/9f4c6dc4f10f71e511e3b18184beb46f5301986f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65613262306437652d303961332d343562332d623736632d3930386261313138633739642f6769746c61622d30382e706e67)

Video PoC:

[gitlab-rce.mp4](https://user-content.gitlab-static.net/525ceeec853aca6354ec95cdba2c2d7b648ae31f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61343062353564362d396630342d343666392d383838322d6663613163316536626634372f6769746c61622d7263652e6d7034 "Download 'gitlab-rce.mp4'")

#### Impact

Attackers can run malicious binary on user's machine that cloned the malicious repository

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [gitlab-00.png](https://h1.sec.gitlab.net/a/8bd8c78a-d94f-4f07-88c1-33effc758a21/gitlab-00.png)
* [gitlab-05.png](https://h1.sec.gitlab.net/a/68638e99-c1ec-4bc3-996e-5a32d8ac4d8d/gitlab-05.png)
* [gitlab-04.png](https://h1.sec.gitlab.net/a/4ad59212-4e14-4c0c-9ff5-1a0b1370f29f/gitlab-04.png)
* [gitlab-08.png](https://h1.sec.gitlab.net/a/ea2b0d7e-09a3-45b3-b76c-908ba118c79d/gitlab-08.png)
* [gitlab-07.png](https://h1.sec.gitlab.net/a/7af90f90-7316-4912-98bb-4ba9b1d2a458/gitlab-07.png)
* [gitlab-rce.mp4](https://h1.sec.gitlab.net/a/a40b55d6-9f04-46f9-8882-fca1c1e6bf47/gitlab-rce.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


