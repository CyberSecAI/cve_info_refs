=== Content from gitlab.com_82281583_20250114_195641.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22261.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22261.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22261.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22261.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 11, 2022

  [2b592657](/gitlab-org/cves/-/commit/2b592657f232335894fbee0373d8c6e83e49da09)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2b592657f232335894fbee0373d8c6e83e49da09)
  ·
  2b592657

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

  2b592657

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2b592657f232335894fbee0373d8c6e83e49da09)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

Loading



=== Content from gitlab.com_e6ef344b_20250114_195641.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in the Jira issue detail pages

**[HackerOne report #1132083](https://hackerone.com/reports/1132083)** by `thornguyen` on 2021-03-22, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I've found a stored XSS vulnerability in the Jira issue detail pages by exploiting Jira integration. Also, I was able to bypass CSP and gain full javascript execution under gitlab.com context.

##### Steps to reproduce

1. Create a **Mock API** that response this payload [![payload.json](data:image/gif;base64...)](/gitlab-org/gitlab/-/blob/master/%5BREDACTED%5D) when there are requests to path `/rest/api/2/issue/POC?expand=renderedFields`. You can use <https://beeceptor.com/> like my POC video.
2. In a GitLab project that has premium / ultimate license , go to **Settings -> Integrations -> Jira**:

* Tick active at the **Enable integration** section
* Input any URL at **Web URL** field
* Input the mock API created in Step 1 to the **Jira API URL** field
* Click **Save changes**

3. Now go to [https://gitlab.com/[YOUR\_ORGANIZATION]/[YOUR\_PROJECT]/-/integrations/jira/issues/POC](https://gitlab.com/%5BYOUR_ORGANIZATION%5D/%5BYOUR_PROJECT%5D/-/integrations/jira/issues/POC) and you will see a popup.

##### Impact

Stored-XSS allow attackers to perform arbitrary actions on behalf of victims at client side. And since the JIRA issue detail pages can be made public, this impact a considerable number of GitLab users and visitors.

##### Examples

* [REDACTED] (tested in Chrome and Firefox)

##### What is the current *bug* behavior?

GitLab doesn't sanitize the *key* field in the JSON response from Jira API so it leads to stored XSS at the Jira issue detail pages.

[REDACTED]

##### POC Video

![REDACTED]

##### What is the expected *correct* behavior?

GitLab should sanitize *key* field in the JSON response from Jira API before output to browser.

##### Output of checks

This bug happens on GitLab.com

#### Impact

Stored-XSS allow attackers to perform arbitrary actions on behalf of victims at client side. And since the JIRA issue detail pages can be made public, this impact a considerable number of GitLab users and visitors.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!
[REDACTED]

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Jul 07, 2022 by [Costel Maxim](/cmaxim)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


