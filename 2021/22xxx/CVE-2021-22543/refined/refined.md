```
{
  "CVE-2021-22543": {
    "description": "Multiple NetApp products incorporate Linux Kernel. Linux Kernel versions prior to 5.13 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).",
    "affected_products": [
      "NetApp Cloud Backup (formerly AltaVault)",
      "NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S",
      "NetApp HCI Baseboard Management Controller (BMC) - H410C",
      "NetApp SolidFire Baseboard Management Controller (BMC)"
    ],
    "root_cause": "Improper handling of VM_IO|VM_PFNMAP vmas in KVM can bypass RO checks and can lead to pages being freed while still accessible by the VMM and guest. KVM uses get_user_pages to translate the host virtual address to the page it needs to map into the guest. However, get_user_pages will fail if the address lies in a vma with the VM_IO or VM_PFNMAP flag set. KVM handles that failure by using follow_pfn to fetch the page directly from the vma. If those pages do not have the PG_reserved bit set, KVM proceeds to treat them as normal pages and will call getpage/putpage on them. However, reference counting on the pages might not be set up to handle this.",
    "weaknesses": [
      "Incorrect handling of memory mapped with VM_IO or VM_PFNMAP flags in KVM leading to bypassing of read-only checks.",
      "Use-after-free vulnerability due to incorrect reference counting of pages."
    ],
    "impact": "Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS). On some systems, allows users with the ability to start and control a VM to read/write random pages of memory. Can cause a kernel panic, memory corruption, or system crash due to a use-after-free.",
    "attack_vectors": "Local access to the /dev/kvm interface is required to exploit this vulnerability.",
    "required_capabilities": "Ability to create and control a virtual machine using KVM."
  }
}
```