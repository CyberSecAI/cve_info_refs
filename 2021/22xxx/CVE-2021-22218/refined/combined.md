=== Content from gitlab.com_4da5e904_20250114_200809.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Spoofing commit author for signed commits

**[HackerOne report #1077019](https://hackerone.com/reports/1077019)** by `subbotin` on 2021-01-12, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Label "Verified" for signed commits not checks email for x509 signs.

##### Steps to reproduce

Instruction for linux, but it can be useful for reproducing on over OS.

1. Create valid x509 certificate for some email (I use <https://www.actalis.it/en/certificates-for-secure-electronic-mail.aspx> because it's only one service which makes free mime certs).
2. Import cert to storage `gpgsm --import PKCS12_Credential_new@fake.email.pfx`
3. Create .gitconfig like

```
[user]
	email = new@fake.email
	name = target_account_on_gitlab_name
	signingkey = 0xBFD04A72 # (you key id from previous step. can be find by `gpgsm -k`)
[commit]
	gpgsign = true
[gpg]
	program = gpgsm
```

1. make new commit and push it to gitlab.
2. go to page <https://gitlab.com/group_name/project_name/-/commits/master> and looks on bages
3. for better picture you can change avatar via gravatar.com

##### Impact

Someone with compromised ssh key but not compromised GPG key or x509 cert.

##### Examples

<https://gitlab.com/mr_tron/test/-/commits/master>

You can see on this page two commits:

Both made by me, both has label "Verified". They looks identically (only one difference - link under commit name. one follows on my gitlab account, and second is just "mailto:my@email"). Both commits signed by x509 MIME certificate. Initial commit I signed with my certificate issued to my email denis@subbot.in which I use for registration on gitlab.org, but second commit is signed by certificate issued to random temporary email (not really random - that's my old email, but i never mentioned it on gitlab.org).

Github.com for example in this situation adds label "Unverified". Look on two last commits on this page - <https://github.com/mr-tron/test-sign-x509/commits/master>

##### What is the current *bug* behavior?

Gitlab display commits signed by x509 certificate for any email like Verified

Also it displays login for gitlab users detected based on login in same manner as "user.name" from commit info.

##### What is the expected *correct* behavior?

It should should display label "Signed" or "Unverified" and not green color.

##### Relevant logs and/or screenshots

In attachments.

##### Output of checks

This bug happens me on gitlab.org

#### Impact

Attacker can impersonate someone else in gitlab web interface.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2021-01-12\_16-28-54.png](https://h1.sec.gitlab.net/a/bdaf53bf-9bc4-48e3-8413-a181b1ba751b/Screenshot_2021-01-12_16-28-54.png)
* [Screenshot\_2021-01-12\_16-29-43.png](https://h1.sec.gitlab.net/a/24390e51-b22e-4d6b-81d8-1de0d0fb220f/Screenshot_2021-01-12_16-29-43.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_d3764e32_20250114_200808.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22218.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22218.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22218.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22218.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 11, 2022

  [1fc10a9a](/gitlab-org/cves/-/commit/1fc10a9ab49104ce32df510d369174758acc4a4d)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1fc10a9ab49104ce32df510d369174758acc4a4d)
  ·
  1fc10a9a

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

  1fc10a9a

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1fc10a9ab49104ce32df510d369174758acc4a4d)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

Loading


