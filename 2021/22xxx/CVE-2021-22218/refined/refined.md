```json
{
  "CVE-2021-22218": {
    "description": "GitLab displays commits signed with X.509 certificates as 'Verified' even if the email address in the certificate does not match a user's email in GitLab. Additionally, it displays the login name for GitLab users based on the commit's 'user.name' field, which can be spoofed.",
    "root_cause": "GitLab incorrectly assumes that a valid X.509 signature implies verification of the commit author's identity, without validating the email address in the certificate against the GitLab user's email address. It also relies on the 'user.name' field in the commit to display the user's login name which can be arbitrary.",
    "weaknesses": [
      "Inadequate verification of commit author identity based on X.509 certificates",
      "Reliance on spoofable commit metadata (user.name) for user identification",
      "Lack of proper validation of email address in X.509 certificates"
     ],
    "impact": "An attacker can impersonate another user in the GitLab web interface by creating a commit with a valid X.509 signature (with any email) and a spoofed 'user.name' field. The commit will be displayed as 'Verified' and show the attacker's chosen username, leading to user confusion and potential deception.",
    "attack_vectors": [
      "Creation of a Git commit with a valid X.509 signature, where the certificate email doesn't match any user.",
       "Spoofing the 'user.name' field in the Git commit."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to generate a valid X.509 certificate and create Git commits. They also need to push the commit to the GitLab repository"
  }
}
```