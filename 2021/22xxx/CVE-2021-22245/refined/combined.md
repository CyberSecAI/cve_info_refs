=== Content from gitlab.com_a5a16261_20250114_191505.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# DoS via payload in git config --global user.name

**[HackerOne report #987689](https://hackerone.com/reports/987689)** by `stanlyoncm` on 2020-09-21, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

NOTE: The report was sent in Spanish. TL;DR is that a commit from a user with a really long name makes the `/-/branches` page unreachable. If the commit is pushed directly to master it breaks the entire repository. See the [How To Reproduce](#how-to-reproduce) section below.

## Report

==Report in Spanish:==

##### Summary

Un atacante miembro de un proyecto, podrÃ­a causar una denegaciÃ³n de servicio en la rama del proyecto en **gitlab.com** al realizar un cometer desde el emulador de terminal por medio del comando **git**, el atacante, es capaz de realizar este ataque al colocar una carga Ãºtil en el valor de nombre en `git config --global user.name`

El impacto del DoS depende de los permisos que tenga el atacante dentro del proyecto a mayor permiso, mayor serÃ¡ el impacto del ataque.

Un atacante con permisos de Mantenedor podrÃ¡ causar el DoS en la rama maestra del proyecto, afectando las ramas de nivel inferior al no poder acceder a `/branches` (*notara esto en el video de domostracion*).

Un atacante con permisos de Desarrollo podrÃ¡ causar el DoS en **gitlab.com** en cualquier rama que no sea maestra, esto ya que no puede hacer push sobre el `origin/master`

##### Steps to reproduce

**[Preparacion]**

Para este proyecto y la demostraciÃ³n en video, se realizo el ataque en la rama maestra del proyecto, por lo que deberÃ¡ invitar a un miembro con permisos de Mantenedor

\_\_1)\_\_Cree un nuevo proyecto y agregue un nuevo miembro con permisos de mantenedor.

**[Flujo del ataque]** (*miembro invitado con permisos de mantenedor*)

\_\_1)\_\_Desde el emulador de terminal establezca su nombre de usuario y correo electrÃ³nico.

\_\_2)\_\_Clone el proyecto.

\_\_3)\_\_Realice una confirmaciÃ³n de prueba (*opcional*).

\_\_4)\_\_Coloque el archivo `name.txt` (*adjunto:*[![name.txt](data:image/gif;base64...)](https://user-content.gitlab-static.net/ea3a14a78b2ecf4d89072f236280e7771e7049df/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36613762383034342d626161322d346230322d613832382d3834653238626464623862382f6e616d652e747874)) un nivel por debajo del proyecto que acaba de clonar.

\_\_5)\_\_Utilice el siguiente comando para agregar el valor `name.txt` al nombre de usuario: `name=$(cat ../name.txt) &amp;&amp; git config --global user.name &#34;$name&#34;`

\_\_6)\_\_Ahora realice algÃºn cambio en el proyecto y realice un comiter con el nuevo nombre de usuario.

\_\_7)\_\_Haga git push sobre la rama maestra.

Ahora cualquier persona que visite la pagina principal del proyecto en gitlab.com, se encontrara con la ruta **404** indicando que la pagina no se encuentra, si accede a `https://gitlab.com/user/project/-/branches` se encontrara con la ruta `503` indicando que gitlab no esta disponible.

##### What is the current *bug* behavior?

DenegaciÃ³n de servicio al acceder al proyecto a travÃ©s de gitlab.com, a travÃ©s de de una carga Ãºtil colocada en el nombre de usuario

##### What is the expected *correct* behavior?

El proyecto deberÃ­a ser accesible a travÃ©s de gitlab.com tras cualquier confirmaciÃ³n o cometer de usuario.

##### Relevant logs and/or screenshots

[![404.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/07041837383382eae0fd0b3efb32605a18824bcf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64393664313565392d356235662d343635342d396531632d3138353533653030653465392f3430342e706e67)

[![503.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b0183f0b93f7e82115b893391cac31c878674ba6/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f66353463343935652d303065302d343862642d623635662d3963353932633535393539322f3530332e706e67)

##### Output of checks

This bug happens on GitLab.com

##### Poc

[poc.mp4](https://user-content.gitlab-static.net/c0f951cf8255abfa25eff8a65b6b875187138702/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61633931663135322d623263372d343962362d393034322d6466313231613734303864622f706f632e6d7034 "Download 'poc.mp4'")

#### Impact

Todos los usuarios no podrÃ¡n acceder al proyecto o a las ramas a travÃ©s de gitlab.com

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [poc.mp4](https://h1.sec.gitlab.net/a/ac91f152-b2c7-49b6-9042-df121a7408db/poc.mp4)
* [404.png](https://h1.sec.gitlab.net/a/d96d15e9-5b5f-4654-9e1c-18553e00e4e9/404.png)
* [503.png](https://h1.sec.gitlab.net/a/f54c495e-00e0-48bd-b65f-9c592c559592/503.png)
* [name.txt](https://h1.sec.gitlab.net/a/6a7b8044-baa2-4b02-a828-84e28bddb8b8/name.txt)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Clone a repository (victim) that you're a developer (attacker) on and run the following commands:

```
git checkout -b dostest
git config user.name "$(ruby -e 'puts "name" * 20000')"
echo test >> README.md
git add README.md
git commit -m dos
git push --set-upstream origin dostest
```

At this point the `/-/branches` page is unreachable with 503.

If the repository enables developers to push to master (or if the maintainer does so) the entire repository becomes unavailable, even the settings pages.

Edited Sep 24, 2020 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_e4632df0_20250114_191504.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22245.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22245.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22245.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22245.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Aug 23, 2021

  [92ba6d64](/gitlab-org/cves/-/commit/92ba6d646e5b7d36c15179d52116bf390c9da103)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/92ba6d646e5b7d36c15179d52116bf390c9da103)
  Â·
  92ba6d64

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Aug 23, 2021

  92ba6d64

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/92ba6d646e5b7d36c15179d52116bf390c9da103)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Aug 23, 2021

Loading


