Based on the provided document, here's an analysis of CVE-2021-22722:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a CWE-79: Improper Neutralization of Input During Web Page Generation ('Stored Cross-site Scripting'). This occurs when the charging station's web server fails to properly sanitize input during the process of importing a CSV file or changing station parameters.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** Malicious scripts can be injected into the system by exploiting the lack of proper input sanitization. These scripts are then stored and executed when other users interact with the affected parts of the application.

**Impact of Exploitation:**

*   **Code Injection:** A successful exploit can lead to the injection of malicious code into the charging station's web interface.
*   **Compromise of User Accounts:** An attacker can leverage the injected script to potentially hijack user sessions, steal credentials or perform actions on behalf of a legitimate user, leading to compromised settings and accounts.

**Attack Vectors:**

*   **Importing Malicious CSV:** An attacker can inject malicious code through a specially crafted CSV file that exploits the vulnerable input sanitization.
*   **Changing Station Parameters:** Malicious code can also be injected when a user attempts to change station parameters through the web interface, if the input is not properly handled.

**Required Attacker Capabilities/Position:**

*   **Low Privileged Access:** The attacker needs to have low-level access to the charging station's web server, requiring valid credentials to use the web interface.
*   **User Interaction:** Exploitation requires user interaction, as the malicious script execution is triggered by a user accessing affected pages (e.g., after a malicious CSV import or parameter change).