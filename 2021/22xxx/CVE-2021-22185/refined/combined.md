=== Content from gitlab.com_f2fce95d_20250114_225559.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22185.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22185.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22185.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22185.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 24, 2021

  [93a2bc9b](/gitlab-org/cves/-/commit/93a2bc9bf9938c2dc06c76d4b0f0cd64678b61ad)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/93a2bc9bf9938c2dc06c76d4b0f0cd64678b61ad)
  ·
  93a2bc9b

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

  93a2bc9b

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/93a2bc9bf9938c2dc06c76d4b0f0cd64678b61ad)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 24, 2021

Loading



=== Content from gitlab.com_6f89cd34_20250114_225600.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Possible XSS in wiki author name

While reviewing [!51273 (merged)](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/51273 "Wiki: Add author avatar and link"), I noticed that we were doing:

```
"<strong>#{@page.last_version.author_name}</strong>".html_safe
```

(The code before that MR does something similar)

Adding HTML tags to the author name which I believe comes from the Git commit could lead to an XSS vulnerability.

That is why in the examples in <https://docs.gitlab.com/ee/development/i18n/externalization.html#html>, we separate the HTML tags from the content so that we only call `#html_safe` on the tags.

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


