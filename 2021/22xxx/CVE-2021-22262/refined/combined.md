=== Content from gitlab.com_40d7d1dc_20250115_100243.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# "Basic" Jira users can Add/Remove Jira Connect Namespaces

**NOTE** The main concern described in this issue is related to the fact that "Basic" (non-admin) users in Jira can Remove/Add namespaces by directly accessing `<jira_cloud_namespace>.atlassian.net/plugins/servlet/ac/gitlab-jira-connect-gitlab.com/gitlab-configuration`. At this time I do not believe there is any security concern with the JWT itself, even though it is mentioned in the report.

There does not appear to be any links in the UI for "BASIC" (non-admin) Jira users to access this page, but when manually entered it is shown. As the HackerOne reporter describes in [this comment](https://gitlab.com/gitlab-org/gitlab/-/issues/327062#note_546133684 "\"Basic\" Jira users can Add/Remove Jira Connect Namespaces"), it appears that GitLab needs to verify the permissions in the JWT to decide whether or not to grant access to this page. As per [this issue](https://gitlab.com/gitlab-org/gitlab/-/issues/9641#list-namespaces-that-are-linked "Manage namespaces to sync to Jira Cloud Dev Info API from GitLab.com"), I believe we intended only Jira admins to be able to add/remove these namespaces:

> When viewing this page, it is not necessary to be logged in to GitLab. We show the data here based on the JWT token generated by Jira which ensures that the user making the request here is an admin of the Jira account.

**[HackerOne report #1147812](https://hackerone.com/reports/1147812)** by `updatelap` on 2021-04-03, assigned to [@ankelly](/ankelly "Andrew Kelly"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

**Note:**

Hey Gitlab Sec Team,

I contacted your GitLab Support team about your Jira app [GitLab.com for Jira Cloud](https://marketplace.atlassian.com/apps/1221011/gitlab-com-for-jira-cloud?hosting=cloud&tab=overview) . And they told me that the app is eligible for reporting and reward

#### Summary:

GitLab provides an application tool [GitLab.com for Jira Cloud](https://marketplace.atlassian.com/apps/1221011/gitlab-com-for-jira-cloud?hosting=cloud&tab=overview), an application that allows customers to managed Jira issues at Jira instance from GitLab.com. After testing the integration feature in the application, it was found that the application leads to the leakage of the `JWT` to unauthorized users.

##### *About Jira:*

Jira Cloud allows the system administrator to add users with different Roles such as "**Basic, Trusted, and Site administrator**" with the highest authority being "**Site administrator**" and least "**Basic**". Based on these Roles allows:

1. The administrator can fully manage the account by accessing all projects, issues, dashboards and **configuring applications.**
2. Access to specific projects or issues. It is not possible to access to **configure applications** or to change any of the account settings.

### Description:

As we mentioned earlier, the **GitLab.com for Jira Cloud**, after installing It allows an administrator to link their GitLab.com account with Atlassian Jira Cloud. So, after Setup, Jira **admin** is allowed to go `https://YOUDOMIN.atlassian.net/plugins/servlet/ac/gitlab-jira-connect-gitlab.com/gitlab-configuration` When going to this page admin can `Linked Gitlab namespaces` with Jira cloud.

[REDACTED]

When you click on "**Add namespaces**", You can add namespaces and groups to the Jira cloud. So. Based on the **About Jira description**, an employee with "`BSSIC`" privileges is not allowed to access the application configuration. After testing if the `GitLab for Jira Cloud` app checks the permissions of Jira users before providing the user with the `JWT`, it is found that the `GitLab for Jira Cloud` application does not verify the user's permissions and generates the JWT code for a user with `Basic privileges`. This allows this malicious user to link their namespaces or group to Jira instance that they do not own and can remove namespaces or group added by System admin. In addition, Gitlab allows users to create private namespaces and groups on Gitlab and then link them to the Jira instance. So this will reveal these namespaces and private groups

The normal or expected behavior that the tool should work with is to verify the role of the user who requests the configuration page, and if he does not have the privilege to display the page, a message similar to this should appear.

[REDACTED]

#### Steps To Reproduce

1. Go to Jira cloud and create Jira instance.
2. Add user with `Basic` roles.
3. The administrator create project and restricted to this project for admin only.

[REDACTED]
3 Admin Install [GitLab.com for Jira Cloud](https://marketplace.atlassian.com/apps/1221011/gitlab-com-for-jira-cloud?hosting=cloud&tab=overview) app.

4.Admin go to `https://YOUDOMIN.atlassian.net/plugins/servlet/ac/gitlab-jira-connect-gitlab.com/gitlab-configuration` and login with your Gitlab account.

5.Admin click in Add namespace and Link namespace and group to Jira cloud.

6.User Go to `{BaseUrl}/plugins/servlet/ac/gitlab-jira-connect-gitlab.com/gitlab-configuration`

[REDACTED]

#### Impact

1. First. An unauthorized employee can access the application configuration page and reveal these namespaces and private groups
2. The server grants a JWT token to the Basic user, allowing it to remove namespaces and groups.

[REDACTED]
3.It allows the user to link his Gitlab account to the jira instance and add his namespaces and groups to an instance that he does not own

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

[REDACTED]

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Jul 07, 2022 by [Costel Maxim](/cmaxim)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_299be436_20250115_100242.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22262.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22262.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22262.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22262.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 11, 2022

  [97ed02c3](/gitlab-org/cves/-/commit/97ed02c32f79dcaf0b3bc405d0b6ff38aaafbd7d)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/97ed02c32f79dcaf0b3bc405d0b6ff38aaafbd7d)
  ·
  97ed02c3

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

  97ed02c3

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/97ed02c32f79dcaf0b3bc405d0b6ff38aaafbd7d)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 11, 2022

Loading


