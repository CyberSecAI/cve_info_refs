=== Content from github.com_5bb844ed_20250114_234857.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Fpull%2F15)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Fpull%2F15)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=google%2Fsa360-webquery-bigquery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 29, 2023. It is now read-only.

[google](/google)
/
**[sa360-webquery-bigquery](/google/sa360-webquery-bigquery)**
Public archive

* [Notifications](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery)
* [Star
   15](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery)

* [Code](/google/sa360-webquery-bigquery)
* [Issues
  1](/google/sa360-webquery-bigquery/issues)
* [Pull requests
  1](/google/sa360-webquery-bigquery/pulls)
* [Actions](/google/sa360-webquery-bigquery/actions)
* [Projects
  0](/google/sa360-webquery-bigquery/projects)
* [Security](/google/sa360-webquery-bigquery/security)
* [Insights](/google/sa360-webquery-bigquery/pulse)

Additional navigation options

* [Code](/google/sa360-webquery-bigquery)
* [Issues](/google/sa360-webquery-bigquery/issues)
* [Pull requests](/google/sa360-webquery-bigquery/pulls)
* [Actions](/google/sa360-webquery-bigquery/actions)
* [Projects](/google/sa360-webquery-bigquery/projects)
* [Security](/google/sa360-webquery-bigquery/security)
* [Insights](/google/sa360-webquery-bigquery/pulse)

# setting file permissions on datastore directory #15

 Closed

[KatTraxler](/KatTraxler)
wants to merge
1
commit into
[google:master](/google/sa360-webquery-bigquery/tree/master "google/sa360-webquery-bigquery:master")
from
[KatTraxler:directory-permission-fix](/KatTraxler/sa360-webquery-bigquery/tree/directory-permission-fix "KatTraxler/sa360-webquery-bigquery:directory-permission-fix")

 Closed

# [setting file permissions on datastore directory](#top) #15

[KatTraxler](/KatTraxler)
wants to merge
1
commit into
[google:master](/google/sa360-webquery-bigquery/tree/master "google/sa360-webquery-bigquery:master")
from
[KatTraxler:directory-permission-fix](/KatTraxler/sa360-webquery-bigquery/tree/directory-permission-fix "KatTraxler/sa360-webquery-bigquery:directory-permission-fix")

[Conversation
6](/google/sa360-webquery-bigquery/pull/15)
[Commits
1](/google/sa360-webquery-bigquery/pull/15/commits)
[Checks
0](/google/sa360-webquery-bigquery/pull/15/checks)
[Files changed](/google/sa360-webquery-bigquery/pull/15/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![KatTraxler](https://avatars.githubusercontent.com/u/52041609?s=60&v=4)](/KatTraxler)

Copy link

### @KatTraxler **[KatTraxler](/KatTraxler)** commented [Feb 17, 2021](#issue-809838414)

You are using the File API to create a directory ('datastore') which ultimately stores OAuth2 credentials. Utilizing methods on the File API, I was able to set the read and write permission on that directory to restrict the permission to the owner of the directory. This change doesn't really fix the issue.

It *appears* as though the creation of the file which stores the credentials ('StoredCredentials') is being handled by the `[com.google.auth.oauth2.UserCredentials](https://googleapis.dev/java/google-auth-library/0.23.0/index.html)` Class. I don't see any native capability to set file permissions in this library.

You might need to migrate to a different method of creating the 'StoredCredentials' file, one that allows more control of the StoredCredentials File or request an upgrade to the underlying library.

Sorry, something went wrong.

All reactions

[![@KatTraxler](https://avatars.githubusercontent.com/u/52041609?s=40&v=4)](/KatTraxler)

`[setting file permissions on datastore directory](/google/sa360-webquery-bigquery/pull/15/commits/a5d6b6265d4599282216cfad2ba670e95cbbae20 "setting file permissions on datastore directory")`

`[a5d6b62](/google/sa360-webquery-bigquery/pull/15/commits/a5d6b6265d4599282216cfad2ba670e95cbbae20)`

[![@google-cla](https://avatars.githubusercontent.com/in/42202?s=80&v=4)](/apps/google-cla)

Copy link

### **[google-cla](/apps/google-cla) bot** commented [Feb 17, 2021](#issuecomment-780286116)

| Thanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA).  üìù **Please visit <https://cla.developers.google.com/> to sign.**  Once you've signed (or fixed any issues), please reply here with `@googlebot I signed it!` and we'll verify it.   ---  What to do if you already signed the CLAIndividual signers  * It's possible we don't have your GitHub username or you're using a different email address on your commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/).  Corporate signers  * Your company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to [go/cla#troubleshoot](http://go/cla#troubleshoot) ([Public version](https://opensource.google/docs/cla/#troubleshoot)). * The email used to register you as an authorized contributor must be the email used for the Git commit. Check [your existing CLA data](https://cla.developers.google.com/clas) and verify that your [email is set on your git commits](https://help.github.com/articles/setting-your-email-in-git/). * The email used to register you as an authorized contributor must also be [attached to your GitHub account](https://github.com/settings/emails).   ‚ÑπÔ∏è **Googlers: [Go here](https://goto.google.com/prinfo/https%3A//github.com/google/sa360-webquery-bigquery/pull/15) for more info**. |
| --- |

All reactions

Sorry, something went wrong.

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=40&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)
[anantdamle](/anantdamle)
linked an issue
[Feb 17, 2021](#event-4340101535)
that may be
closed
by this pull request

[Insecure Permissions for /datastore/StoredCredential File
#14](/google/sa360-webquery-bigquery/issues/14)

Closed

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=80&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)

Copy link

Contributor

### **[anantdamle](/anantdamle)** commented [Feb 17, 2021](#issuecomment-780396090)

| [@KatTraxler](https://github.com/KatTraxler) Thanks for this PR. Can you sign the CLA and update this conversation. I am curious to learn if this approach will allow running the JAR file through `cron` |
| --- |

All reactions

Sorry, something went wrong.

[![@KatTraxler](https://avatars.githubusercontent.com/u/52041609?s=80&u=2bf5859cc6cf6adb79f8e91669150e682b02cac5&v=4)](/KatTraxler)

Copy link

Author

### **[KatTraxler](/KatTraxler)** commented [Feb 17, 2021](#issuecomment-780652667) via email

| [@googlebot](https://github.com/googlebot) I signed it! ‚Ä¶ On Tue, Feb 16, 2021 at 10:18 PM google-cla[bot] \*\*\*@\*\*\*.\*\*\*> wrote: Thanks for your pull request. It looks like this may be your first contribution to a Google open source project (if not, look below for help). Before we can look at your pull request, you'll need to sign a Contributor License Agreement (CLA). üìù \*Please visit <https://cla.developers.google.com/> <<https://cla.developers.google.com/>> to sign.\* Once you've signed (or fixed any issues), please reply here with [@googlebot](https://github.com/googlebot) I signed it! and we'll verify it. ------------------------------ What to do if you already signed the CLA Individual signers - It's possible we don't have your GitHub username or you're using a different email address on your commit. Check your existing CLA data <<https://cla.developers.google.com/clas>> and verify that your email is set on your git commits <<https://help.github.com/articles/setting-your-email-in-git/>>. Corporate signers - Your company has a Point of Contact who decides which employees are authorized to participate. Ask your POC to be added to the group of authorized contributors. If you don't know who your Point of Contact is, direct the Google project maintainer to go/cla#troubleshoot (Public version <<https://opensource.google/docs/cla/#troubleshoot>>). - The email used to register you as an authorized contributor must be the email used for the Git commit. Check your existing CLA data <<https://cla.developers.google.com/clas>> and verify that your email is set on your git commits <<https://help.github.com/articles/setting-your-email-in-git/>>. - The email used to register you as an authorized contributor must also be attached to your GitHub account <<https://github.com/settings/emails>>. ‚ÑπÔ∏è \*Googlers: Go here <[https://goto.google.com/prinfo/https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Fpull%2F15](https://goto.google.com/prinfo/https%3A//github.com/google/sa360-webquery-bigquery/pull/15)> for more info\*. ‚Äî You are receiving this because you authored the thread. Reply to this email directly, view it on GitHub <[#15 (comment)](https://github.com/google/sa360-webquery-bigquery/pull/15#issuecomment-780286116)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AMNBPCIBPDYOECTJHJBDWALS7M7PTANCNFSM4XXUERZQ>> . |
| --- |

All reactions

Sorry, something went wrong.

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=80&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)

Copy link

Contributor

### **[anantdamle](/anantdamle)** commented [Feb 19, 2021](#issuecomment-781838483)

| Thanks [@KatTraxler](https://github.com/KatTraxler) for the PR. This solution does not solve the issue completely.  Do you think one of the following may be a better solution:   1. accepting datastore folder as an input parameter. Allows the user to setup protections outside of the code. 2. Removing the stored credentials. Use service account credentials to access all services including SA360. |
| --- |

All reactions

Sorry, something went wrong.

[![@KatTraxler](https://avatars.githubusercontent.com/u/52041609?s=80&u=2bf5859cc6cf6adb79f8e91669150e682b02cac5&v=4)](/KatTraxler)

Copy link

Author

### **[KatTraxler](/KatTraxler)** commented [Feb 20, 2021](#issuecomment-782555469)

| Hi [@anantdamle](https://github.com/anantdamle) I don't imagine either of the options would address the underlying issue:  **Option 1:** accepting datastore folder as an input parameter. Allows the user to setup protections outside of the code. The users OAuth credentials are contained in the 'StoredCredentials' file, in the 'datastore' directory. If instead of creating the 'datastore' directory in code, the user was asked to provide a directory, the resultant file where the OAuth credentials are stored is still created by [com.google.auth.oauth2.UserCredentials](https://googleapis.dev/java/google-auth-library/0.23.0/index.html) Class and is still the same 'StoredCredentials' file with insecure permissions. **Option 2:** Removing the stored credentials. Use service account credentials to access all services including SA360. I'm assuming proposal entails generating a private key for a service account? If that's the case, this solution would likely be worse than the current state. Today, the credentials that are stored insecurely are considered 'short-term'. They will always have an expiration. Changing this application to have the ability to run as a service account would result in durable credentials being stored on a local file system where if not explicitly set, the default and insecure set of file permissions are `-rw-r--r--`  Recommendation: Open an issue with the maintainers of the Java google-auth-library asking if there is a Method on the Class [com.google.auth.oauth2.UserCredentials](https://googleapis.dev/java/google-auth-library/0.23.0/index.html) allowing you configure the permissions on the file which is created when OAuth2 credentials are generated. |
| --- |

All reactions

Sorry, something went wrong.

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=80&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)

Copy link

Contributor

### **[anantdamle](/anantdamle)** commented [Feb 23, 2021](#issuecomment-783907634) ‚Ä¢ edited Loading

| [@KatTraxler](https://github.com/KatTraxler) Thanks for notifying of the bug and proposing a PR. This is a temporary solution. Long term solution is fixing [Issue#8](https://github.com/google/sa360-webquery-bigquery/issues/8). Will work on building that solution. Directory level permissions would not fix the file permissions. |
| --- |

All reactions

Sorry, something went wrong.

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=40&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)
[anantdamle](/anantdamle)
closed this
[Feb 23, 2021](#event-4363253268)

[![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=40&u=ef142b7a3131d1af8a94d41f8cb05144e76ab32a&v=4)](/anantdamle)
[anantdamle](/anantdamle)
linked an issue
[Feb 23, 2021](#event-4363253784)
that may be
closed
by this pull request

[Support Service Account credentials
#8](/google/sa360-webquery-bigquery/issues/8)

Closed

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Fpull%2F15).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Insecure Permissions for /datastore/StoredCredential File](https://github.com/google/sa360-webquery-bigquery/issues/14)

 [Support Service Account credentials](https://github.com/google/sa360-webquery-bigquery/issues/8)

2 participants

[![@KatTraxler](https://avatars.githubusercontent.com/u/52041609?s=52&v=4)](/KatTraxler) [![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=52&v=4)](/anantdamle)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_fa582fdc_20250114_234853.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJLLeitschuh%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-7fjx-657r-9r5h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJLLeitschuh%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-7fjx-657r-9r5h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=JLLeitschuh%2Fsecurity-research)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[JLLeitschuh](/JLLeitschuh)
/
**[security-research](/JLLeitschuh/security-research)**
Public

* [Notifications](/login?return_to=%2FJLLeitschuh%2Fsecurity-research) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2FJLLeitschuh%2Fsecurity-research)
* [Star
   16](/login?return_to=%2FJLLeitschuh%2Fsecurity-research)

* [Code](/JLLeitschuh/security-research)
* [Issues
  8](/JLLeitschuh/security-research/issues)
* [Pull requests
  3](/JLLeitschuh/security-research/pulls)
* [Discussions](/JLLeitschuh/security-research/discussions)
* [Actions](/JLLeitschuh/security-research/actions)
* [Projects
  0](/JLLeitschuh/security-research/projects)
* [Security](/JLLeitschuh/security-research/security)
* [Insights](/JLLeitschuh/security-research/pulse)

Additional navigation options

* [Code](/JLLeitschuh/security-research)
* [Issues](/JLLeitschuh/security-research/issues)
* [Pull requests](/JLLeitschuh/security-research/pulls)
* [Discussions](/JLLeitschuh/security-research/discussions)
* [Actions](/JLLeitschuh/security-research/actions)
* [Projects](/JLLeitschuh/security-research/projects)
* [Security](/JLLeitschuh/security-research/security)
* [Insights](/JLLeitschuh/security-research/pulse)

# Insecure Temporary File in google / sa360-webquery-bigquery

Moderate

[JLLeitschuh](/JLLeitschuh)
published
GHSA-7fjx-657r-9r5h
Mar 9, 2022

## Package

google / sa360-webquery-bigquery
(Application)

## Affected versions

<= v1.0.2

## Patched versions

v1.0.3

## Description

### CVE Status

CVE is pending via the CVE Appeals process with MITRE

### Impact

`TransferRunner` may disclose information to other users from WebQuery CSV report.

### Patches

Version `v1.0.3` and higher is patched.

### Prerequisites

This vulnerability impacts Unix-like systems, and very old versions of Mac OSX and Windows as they all share the system temporary directory between all users.

### Workarounds

If you are unable to update: setting the `java.io.tmpdir` system environment variable to a directory that is exclusively owned by the executing user will fix this vulnerability for all operating systems.

### References

* [google/sa360-webquery-bigquery#14](https://github.com/google/sa360-webquery-bigquery/issues/14)

Fix:

* [google/sa360-webquery-bigquery@4926b5b#diff-4169b705389b36efbde7d57ec27a1ad2aa21c4385d2e535ee8354f79f03ae756L56](https://github.com/google/sa360-webquery-bigquery/commit/4926b5bf0e4be88f7a09badd145c50fa8a95e1cc#diff-4169b705389b36efbde7d57ec27a1ad2aa21c4385d2e535ee8354f79f03ae756L56)

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2021-22571

### Weaknesses

[CWE-377](/advisories?query=cwe%3A377)

### Credits

* [![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&v=4)](/JLLeitschuh)
  [JLLeitschuh](/JLLeitschuh)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_2e82528c_20250114_234858.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Freleases%2Ftag%2Fv1.0.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fsa360-webquery-bigquery%2Freleases%2Ftag%2Fv1.0.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=google%2Fsa360-webquery-bigquery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 29, 2023. It is now read-only.

[google](/google)
/
**[sa360-webquery-bigquery](/google/sa360-webquery-bigquery)**
Public archive

* [Notifications](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery)
* [Star
   15](/login?return_to=%2Fgoogle%2Fsa360-webquery-bigquery)

* [Code](/google/sa360-webquery-bigquery/tree/v1.0.3)
* [Issues
  1](/google/sa360-webquery-bigquery/issues)
* [Pull requests
  1](/google/sa360-webquery-bigquery/pulls)
* [Actions](/google/sa360-webquery-bigquery/actions)
* [Projects
  0](/google/sa360-webquery-bigquery/projects)
* [Security](/google/sa360-webquery-bigquery/security)
* [Insights](/google/sa360-webquery-bigquery/pulse)

Additional navigation options

* [Code](/google/sa360-webquery-bigquery/tree/v1.0.3)
* [Issues](/google/sa360-webquery-bigquery/issues)
* [Pull requests](/google/sa360-webquery-bigquery/pulls)
* [Actions](/google/sa360-webquery-bigquery/actions)
* [Projects](/google/sa360-webquery-bigquery/projects)
* [Security](/google/sa360-webquery-bigquery/security)
* [Insights](/google/sa360-webquery-bigquery/pulse)

1. [Releases](/google/sa360-webquery-bigquery/releases)
2. [v1.0.3](/google/sa360-webquery-bigquery/releases/tag/v1.0.3)

# User credentials for authentication

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/google/sa360-webquery-bigquery/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.0.3)

 Loading

[View all tags](/google/sa360-webquery-bigquery/tags)

![@anantdamle](https://avatars.githubusercontent.com/u/13331827?s=40&v=4)
[anantdamle](/anantdamle)
released this
28 Feb 15:40

¬∑
[5 commits](/google/sa360-webquery-bigquery/compare/v1.0.3...master)
to master
since this release

[v1.0.3](/google/sa360-webquery-bigquery/tree/v1.0.3)

[`4926b5b`](/google/sa360-webquery-bigquery/commit/4926b5bf0e4be88f7a09badd145c50fa8a95e1cc)

```
v1.0.3

use user provided folder for temp storage.
```

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


