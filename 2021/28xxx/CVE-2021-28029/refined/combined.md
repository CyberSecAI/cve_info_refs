=== Content from rustsec.org_154e45c7_20250114_230225.html ===


RUSTSEC-2021-0028: toodee: Multiple memory safety issues in insert\_row › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/toodee/RUSTSEC-2021-0028.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/toodee/RUSTSEC-2021-0028.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0028)

# RUSTSEC-2021-0028

Multiple memory safety issues in insert\_row

Reported
February 19, 2021

Issued
March 1, 2021

(last modified: June 13, 2023)

Package
[toodee](/packages/toodee.html)
([crates.io](https://crates.io/crates/toodee))

Type
Vulnerability

Categories

* [memory-corruption](/categories/memory-corruption.html)

Keywords
[#memory-safety](/keywords/memory-safety.html)
[#double-free](/keywords/double-free.html)

Aliases

* [CVE-2021-28028](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28028)
* [CVE-2021-28029](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28029)
* [GHSA-wcvp-r8j8-47pc](https://github.com/advisories/GHSA-wcvp-r8j8-47pc)
* [GHSA-xm9m-2vj8-fmfr](https://github.com/advisories/GHSA-xm9m-2vj8-fmfr)

References

* <https://github.com/antonmarsden/toodee/issues/13>

Patched

* `>=0.3.0`

Affected Functions
Version
`toodee::TooDee::insert_row`

* `<0.3.0`

### Description

When inserting rows from an iterator at a particular index, `toodee` would shift
items over, duplicating their ownership. The space reserved for the new elements
was based on the `len()` returned by the `ExactSizeIterator`.

This could result in elements in the array being freed twice if the iterator
panics. Uninitialized or previously freed elements could also be exposed if the
`len()` didn't match the number of elements.

These issues were fixed in commit `ced70c17` by temporarily setting the length
of the array smaller while processing it and adding assertions on the number
of elements returned by the iterator.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


