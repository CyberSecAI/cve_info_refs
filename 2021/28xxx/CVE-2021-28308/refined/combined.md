=== Content from rustsec.org_e166d4ec_20250114_190138.html ===


RUSTSEC-2021-0038: fltk: Multiple memory safety issues › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/fltk/RUSTSEC-2021-0038.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/fltk/RUSTSEC-2021-0038.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0038)

# RUSTSEC-2021-0038

Multiple memory safety issues

Reported
March 6, 2021

Issued
March 6, 2021

(last modified: June 13, 2023)

Package
[fltk](/packages/fltk.html)
([crates.io](https://crates.io/crates/fltk))

Type
Vulnerability

Keywords
[#undefined\_behavior](/keywords/undefined_behavior.html)

Aliases

* [CVE-2021-28306](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28306)
* [CVE-2021-28307](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28307)
* [CVE-2021-28308](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28308)
* [GHSA-5pg8-h4gv-m3p8](https://github.com/advisories/GHSA-5pg8-h4gv-m3p8)
* [GHSA-7qcc-g2m9-8533](https://github.com/advisories/GHSA-7qcc-g2m9-8533)
* [GHSA-vjmg-pc8h-p6p8](https://github.com/advisories/GHSA-vjmg-pc8h-p6p8)

References

* <https://github.com/MoAlyousef/fltk-rs/issues/519>

Patched

* `>=0.15.3`

Affected Functions
Version
`fltk::image::Pixmap::new`

* `<0.15.2, >=0.14.12`

`fltk::prelude::WidgetExt::set_label_type`

* `<0.15.2`

`fltk::prelude::WindowExt::set_icon`

* `<0.14.12`

### Description

Affected versions contain multiple memory safety issues, such as:

* Setting a multi label type where an image doesn't exist would lead to a NULL pointer dereference.
* Setting a window icon using a non-raster image (which FLTK rasterizes lazily) would lead to a NULL dereference.
* Pixmap constructor would not check for correct pixmaps which could lead to out-of bound reads.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


