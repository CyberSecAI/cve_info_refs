- **Root cause of vulnerability**: Missing sanitization of user-controlled input in the web application's email search functionality. Specifically, the "sort_by" parameter is vulnerable to SQL injection.
- **Weaknesses/vulnerabilities present**: SQL Injection (CWE-89)
- **Impact of exploitation**:  An attacker with low-privileged access to the web application can extract data from the underlying database. The queries are executed as the database admin user "postgres", allowing full access to the database. However, based on the tests, stacked queries were not possible, so the exploitation is limited to read access.
- **Attack vectors**: By sending crafted GET requests to the `/ex/message_tracking/messages` endpoint with malicious SQL code in the `sort_by` parameter.
- **Required attacker capabilities/position**: An attacker needs an active session and authenticated access to the WebGUI with a role that has access to the email search function (e.g. monitor role). Low privileges are sufficient.