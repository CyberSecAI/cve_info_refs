Based on the provided information, this content is related to CVE-2021-28398.

**Root cause of vulnerability:**
The vulnerability lies in the Local Filesystem Harvester, specifically in how it handles "before scripts". The application fails to properly sanitize these scripts before executing them, leading to the possibility of arbitrary command execution.

**Weaknesses/vulnerabilities present:**
- Improper input sanitization of "before scripts"
- Use of a functionality that executes arbitrary commands
- CWE-94: Improper Control of Generation of Code ('Code Injection')
- CWE-676: Use of Potentially Dangerous Function

**Impact of exploitation:**
Successful exploitation allows a logged-in user with administrator privileges to execute arbitrary operating system commands on the host server. This can lead to a complete compromise of the internal network if an attacker chooses to do so.

**Attack vectors:**
- By using the Local Filesystem Harvester
- Exploiting the "before script" functionality

**Required attacker capabilities/position:**
- An attacker needs to have a user account with administrator privileges in the GeoNetwork system.
- The attacker must be able to access the administrative interface where the Local Filesystem Harvester is configured.

**Additional details:**
- The vulnerability affects GeoNetwork versions 3.4.0 up to 3.10.6 (inclusive) and 4.0.0-alpha.1 to 4.0.3 (inclusive).
- Patched versions are 3.12.0 and 4.0.4.
- Mitigation includes disabling the local file system harvester protocol or disabling the before script functionality.
- The vulnerability was reported by Tyler Sullivan.