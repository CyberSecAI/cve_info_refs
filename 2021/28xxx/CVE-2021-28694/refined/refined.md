### CVE-2021-28694

**Root cause of vulnerability:**
- The Xen hypervisor failed to prevent guest virtual machines from undoing or replacing memory mappings specified as "untranslated" in the ACPI tables. These regions are supposed to pass the translation phase unaltered.

**Weaknesses/vulnerabilities present:**
- Improper access control. The hypervisor did not enforce restrictions on modifying untranslated memory regions.

**Impact of exploitation:**
- Privilege escalation, denial of service, or information leaks, depending on how and where the untranslated regions are used.

**Attack vectors:**
- Exploitable by a guest with access to physical devices via PCI passthrough.

**Required attacker capabilities/position:**
- An attacker must be able to control a guest virtual machine with PCI passthrough access.

**Additional details:**
- The vulnerability exists on x86 systems with IOMMUs and firmware specifying memory regions to be identity-mapped.
- It is system-specific, and if these regions were used only during system boot, the vulnerability would not be exploitable.
- The vulnerability is present in all versions of Xen.
- The issue is due to the hypervisor not protecting the untranslated memory mapping.