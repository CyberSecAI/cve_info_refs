=== Content from www.debian.org_37d01132_20250114_185719.html ===


---

[[Date Prev](msg00052.html)][[Date Next](msg00054.html)]
[[Thread Prev](msg00052.html)][[Thread Next](msg00054.html)]
[[Date Index](maillist.html#00053)]
[[Thread Index](threads.html#00053)]

# [SECURITY] [DSA 4872-1] shibboleth-sp security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4872-1] shibboleth-sp security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 18 Mar 2021 19:04:20 +0000
* *Message-id*: <[[游댍]](/msgid-search/20210318190420.GA1242%40seger.debian.org)[20210318190420.GA1242@seger.debian.org](msg00053.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4872-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
March 18, 2021                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : shibboleth-sp
CVE ID         : not yet available
Debian Bug     : 985405

Toni Huttunen discovered that the Shibboleth service provider's template
engine used to render error pages could be abused for phishing attacks.

For additional information please refer to the upstream advisory at
<https://shibboleth.net/community/advisories/secadv_20210317.txt>

For the stable distribution (buster), this problem has been fixed in
version 3.0.4+dfsg1-1+deb10u1.

We recommend that you upgrade your shibboleth-sp packages.

For the detailed security status of shibboleth-sp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/shibboleth-sp>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmBTo9cACgkQEMKTtsN8
TjaGjw/+OREYbcLeTaXdCvtKnJ20e80/anQvxsMFiiLGrNeuVU4HvNjbXHwdjVZJ
8gtGILGWXFfg90ikCnZgIJ6ZGxsDK0zpolIem/Ob/G+iwxQStGculI7IXiDgQThK
kf2TWQJV9SzVvAHelV/9fO5g/BzJn7gjuYNmNVN+ugKTWO2Ei6jTaV/0Fj3Nuc66
FSF1gAf7MU8U+AOfhJ7Q8AelRC+4d13HGwr7vAUDgbbhlDV+wsGg+PRGp540L2FR
AGBE742c/Jt7ulD6LPWLxtWumgbb3etlRM/kFm4vfp613jASOldpvfXvacS72+yh
K2no9NHy66fnMibfX/lnJ0uuvJsxt5pxove9NtDCWhVej6/0HA3lY0um+QKt/DFI
ChPC0ZkL/vWpy1U3VTZgg8GtrXB6uWLvaGNnXOy2i59Ph3Uz/HD9f/H/oEM2m/YA
ihKc6ghvHSBA5Y34zh5eCNK96fgyOoNz8IJRnY6J5hveICm5uvWnYUKeNXI1dSas
eCCQ9bB/Oy16ahqHA1sqeqyFqzBv032QK0Gle5fNWzUBbcYLLiZ0BBHj8N88rw3L
AMg7pFKRDD9dwY+wR5xADETPeEKqqRCc4fI4I2szn5yYOiycngxrF0P92d11eJbV
44VMA2JlAGsCQUBDmmQe5Vh0Nf2YPZUnkdJDp9DaTnMwlJuNzcA=
=5tlR
-----END PGP SIGNATURE-----

```

---



=== Content from shibboleth.net_589358cc_20250114_185719.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Shibboleth Service Provider Security Advisory [17 March 2021]
An updated version of the Service Provider software is available
which fixes a phishing vulnerability.
Template generation allows external parameters to override placeholders
======================================================================
The SP includes a primitive template engine used to render error pages
and various other status or transition pages, and it supports a syntax
for embedding placeholders that are replaced by internally supplied
values or configuration settings.
For reasons that are unclear in the code history, it was extended to
allow replacement via query parameters also, though this is not a
typical need. Because of this feature, it's possible to cause the SP
to display some templates containing values supplied externally by
URL manipulation.
Though the values are encoded to prevent script injection, the content
nevertheless appears to come from the server and so would be interpreted
as trustworthy, allowing email addresses, logos and style sheets, or
support URLs to be manipulated by an attacker.
All platforms are impacted by this issue.
Recommendations
===============
Update to V3.2.1 or later of the Service Provider software, which
is now available.
The update adds a new  setting to the configuration called
externalParameters, which defaults to false. When false, support for
this "feature" is disabled. In the unlikely event that a valid need
for this exists, the setting can be enabled temporarily to maintain
function until the use case requiring it is addressed in some other
way.
In the event that an update is not possible, reducing or eliminating
some of the more sensitive template replacement values with static
values in the templates may decrease the impact.
Other Notes
===========
The cpp-sp git commit containing the fix for this issue is
d1dbebfadc1bdb824fea63843c4c38fa69e54379
Credits
=======
Toni Huttunen, Fraktal Oy
History
=======
Edited to add credit, and a bit more discussion of style sheet risk
and workarounds.
URL for this Security Advisory:
https://shibboleth.net/community/advisories/secadv\_20210317.txt
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE3KoVAHvtneaQzZUjN4uEVAIneWIFAmBSD+MACgkQN4uEVAIn
eWJQtBAAp3xxDvDxiQ3bNw+vwJmEOVjJMlwLjBQPmYvV09Pu593xuQj4RWLbZRgK
lZlxHzvXb6dg+bHNl799uCFhcWe8NExB5GnTQPR8/JG1OwgJ0WogezpMYAAvKjkA
LXaDsz7u4DDQ4OBYemkMx3W+0CHhYPw+TLz9rHN+rAKOEGzPLWDT/cKJ75ps19/v
hnQKZ7i7mQobh61zAe5rpi+ziWmDqhzFv4uBOwbuY02UYZQm6+D3BRqAf62Cjnyh
Z/nuZ6Z/5BxitDZBPPSreSl7sMHYzI83RDZGHWgEDjHKZdpYSXpUM3vntuC1pdaO
r4izd97H7nptnuznslu1S0NfkeZlWF3XaaMa8ZrCvMvC62MVK+WvOgFZxE5wmeDZ
3f9Eei//LTE4+B1rQPU99wNbgXdelfXWKkN6hHIXcSlfqG4miAONA86U39JuNovy
S66o9uQG3y55Qp9YcGAca4/9azmr8xQlcKTPFfp2tJrvCwmK3yu0TPbeirPpE9SN
eJhl3/cCenOyN9pMZOZ9MqeIPdlkJ1Qwcd1xs/Jyzqo/LTsvnzVTzaCx0lc6qy/Z
ld3Amkcpo/K2NajWjFVvwx72Yj4Y3DCUvlDrQcNM8Oc2Sv195EDJpXIW8ynqB9aZ
RJUrsmhKRcQKMbfGlHAToMREruW1i3jH1twqS/IOxe7Z4jg5u3A=
=tv1A
-----END PGP SIGNATURE-----


=== Content from bugs.debian.org_4b08cb97_20250114_185715.html ===

# Debian Bug report logs - #985405 src:shibboleth-sp: Error templates allow query-based override of variables

[![version graph](version.cgi?found=shibboleth-sp%2F3.0.2%2Bdfsg1-1;fixed=shibboleth-sp%2F3.2.1%2Bdfsg1-1;fixed=shibboleth-sp%2F3.0.4%2Bdfsg1-1%2Bdeb10u1;width=2;height=2;absolute=0;package=src%3Ashibboleth-sp;collapse=1)](version.cgi?fixed=shibboleth-sp%2F3.2.1%2Bdfsg1-1;fixed=shibboleth-sp%2F3.0.4%2Bdfsg1-1%2Bdeb10u1;found=shibboleth-sp%2F3.0.2%2Bdfsg1-1;info=1;absolute=0;collapse=1;package=src%3Ashibboleth-sp)

Package:
[src:shibboleth-sp](pkgreport.cgi?src=shibboleth-sp);
Maintainer for [src:shibboleth-sp](pkgreport.cgi?src=shibboleth-sp) is [Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>](pkgreport.cgi?maint=pkg-shibboleth-devel%40alioth-lists.debian.net);

Reported by: [Ferenc W치gner <wferi@debian.org>](pkgreport.cgi?submitter=wferi%40debian.org)

Date: Wed, 17 Mar 2021 15:06:01 UTC

Severity: *grave*

Tags: patch, security, upstream

Found in version shibboleth-sp/3.0.2+dfsg1-1

Fixed in versions shibboleth-sp/3.2.1+dfsg1-1, shibboleth-sp/3.0.4+dfsg1-1+deb10u1

**Done:** Ferenc W치gner <wferi@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <https://issues.shibboleth.net/jira/browse/SSPCPP-922>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=985405;mbox=yes), [status mbox](bugreport.cgi?bug=985405;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=985405;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`:

`Bug#985405`; Package `src:shibboleth-sp`.
(Wed, 17 Mar 2021 15:06:03 GMT) ([full text](bugreport.cgi?bug=985405;msg=2), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Ferenc W치gner <wferi@debian.org>`:

New Bug report received and forwarded. Copy sent to `Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`.
(Wed, 17 Mar 2021 15:06:04 GMT) ([full text](bugreport.cgi?bug=985405;msg=4), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=985405;msg=5), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=wferi%40debian.org)
From: Ferenc W치gner <wferi@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: src:shibboleth-sp: Error templates allow query-based override of variables
Date: Wed, 17 Mar 2021 16:03:25 +0100
```
Package: src:shibboleth-sp
Version: 3.0.2+dfsg1-1
Severity: important
Tags: upstream patch security
Forwarded: <https://issues.shibboleth.net/jira/browse/SSPCPP-922>

Shibboleth Service Provider Security Advisory [17 March 2021]

An updated version of the Service Provider software is available
which fixes a phishing vulnerability.

Template generation allows external parameters to override placeholders
======================================================================
The SP includes a primitive template engine used to render error pages
and various other status or transition pages, and it supports a syntax
for embedding placeholders that are replaced by internally supplied
values or configuration settings.

For reasons that are unclear in the code history, it was extended to
allow replacement via query parameters also, though this is not a
typical need. Because of this feature, it's possible to cause the SP
to display some templates containing values supplied externally by
URL manipulation. Though the values are encoded to prevent script
injection, the content nevertheless appears to come from the server
and so would be interpreted as trustworthy, allowing email addresses,
logos, or support URLs to be manipulated by an attacker.

All platforms are impacted by this issue.

Recommendations
===============
Update to V3.2.1 or later of the Service Provider software, which
is now available.

The update adds a new <Errors> setting to the configuration called
externalParameters, which defaults to false. When false, support for
this "feature" is disabled. In the unlikely event that a valid need
for this exists, the setting can be enabled temporarily to maintain
function until the use case requiring it is addressed in some other
way.

Other Notes
===========
The cpp-sp git commit containing the fix for this issue is
d1dbebfadc1bdb824fea63843c4c38fa69e54379

URL for this Security Advisory:
<https://shibboleth.net/community/advisories/secadv_20210317.txt>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`:

`Bug#985405`; Package `src:shibboleth-sp`.
(Wed, 17 Mar 2021 17:21:02 GMT) ([full text](bugreport.cgi?bug=985405;msg=7), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `wferi@niif.hu`:

Extra info received and forwarded to list. Copy sent to `Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`.
(Wed, 17 Mar 2021 17:21:03 GMT) ([full text](bugreport.cgi?bug=985405;msg=9), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 985405@bugs.debian.org ([full text](bugreport.cgi?bug=985405;msg=10), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=wferi%40niif.hu)
From: wferi@niif.hu
To: team@security.debian.org
Cc: 985405@bugs.debian.org
Subject: Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based override of variables
Date: Wed, 17 Mar 2021 18:19:07 +0100
```
Dear Security Team,

Please review the debdiff below for a buster-security upload.
The advisory text changed a little meanwhile, adding credits to Toni
Huttunen, Fraktal Oy for discovering the problem, mentioning the style
sheet spoofing and adding some mitigation tips.

I haven't got a concrete exploit on hand, but I'll start testing the
updated package shortly.

diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/changelog shibboleth-sp-3.0.4+dfsg1/debian/changelog
--- shibboleth-sp-3.0.4+dfsg1/debian/changelog	2019-03-16 20:51:16.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/changelog	2021-03-17 16:55:49.000000000 +0100
@@ -1,3 +1,26 @@
+shibboleth-sp (3.0.4+dfsg1-1+deb10u1) buster-security; urgency=high
+
+  * [594074b] New patch: SSPCPP-922 - Add externalParameters option to Errors
+    element.
+    Fix a phishing vulnerability: Template generation allows external
+    parameters to override placeholders
+    The primitive template engine used to render error pages allows
+    replacement via query parameters also, though this is not a typical
+    need. Because of this feature, it's possible to cause the SP to
+    display some templates containing values supplied externally by URL
+    manipulation. Though the values are encoded to prevent script
+    injection, the content nevertheless appears to come from the server
+    and so would be interpreted as trustworthy, allowing email addresses,
+    logos, or support URLs to be manipulated by an attacker.
+    This update adds a new <Errors> setting to the configuration called
+    externalParameters, which defaults to false. When false, support for
+    this "feature" is disabled.
+    <https://shibboleth.net/community/advisories/secadv_20210317.txt>
+    <https://issues.shibboleth.net/jira/browse/SSPCPP-922>
+    Thanks to Scott Cantor (Closes: #[985405](bugreport.cgi?bug=985405))
+
+ -- Ferenc W치gner <wferi@debian.org>  Wed, 17 Mar 2021 16:55:49 +0100
+
 shibboleth-sp (3.0.4+dfsg1-1) unstable; urgency=medium

   * [f284741] New upstream release: 3.0.4
diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf
--- shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf	2019-03-13 20:06:54.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/gbp.conf	2021-03-17 16:21:54.000000000 +0100
@@ -1,5 +1,5 @@
 [DEFAULT]
-debian-branch = debian/master
+debian-branch = debian/buster
 upstream-branch = upstream/latest
 pristine-tar = True

diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/patches/series shibboleth-sp-3.0.4+dfsg1/debian/patches/series
--- shibboleth-sp-3.0.4+dfsg1/debian/patches/series	2019-03-16 20:48:54.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/patches/series	2021-03-17 16:54:46.000000000 +0100
@@ -3,3 +3,4 @@
 Debianize-the-systemd-service-file-of-shibd.patch
 seckeygen-defaults-for-Debian.patch
 Use-runstatedir-from-future-Autoconf-2.70.patch
+SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch
diff -Nru shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch
--- shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch	1970-01-01 01:00:00.000000000 +0100
+++ shibboleth-sp-3.0.4+dfsg1/debian/patches/SSPCPP-922-Add-externalParameters-option-to-Errors-elemen.patch	2021-03-17 16:54:46.000000000 +0100
@@ -0,0 +1,125 @@
+From: Scott Cantor <cantor.2@osu.edu>
+Date: Tue, 16 Mar 2021 10:56:22 -0400
+Subject: SSPCPP-922 - Add externalParameters option to Errors element
+
+<https://issues.shibboleth.net/jira/browse/SSPCPP-922>
+
+Closes: #[985405](bugreport.cgi?bug=985405)
+---
+ schemas/shibboleth-3.0-native-sp-config.xsd     |  1 +
+ shibsp/ServiceProvider.cpp                      | 11 +++++++++--
+ shibsp/handler/impl/AttributeCheckerHandler.cpp | 12 ++++++++++--
+ shibsp/handler/impl/FormSessionInitiator.cpp    | 12 +++++++++++-
+ shibsp/handler/impl/LogoutHandler.cpp           | 10 +++++++++-
+ 5 files changed, 40 insertions(+), 6 deletions(-)
+
+diff --git a/schemas/shibboleth-3.0-native-sp-config.xsd b/schemas/shibboleth-3.0-native-sp-config.xsd
+index 5bfa3a2..3b1a664 100644
+--- a/schemas/shibboleth-3.0-native-sp-config.xsd
++++ b/schemas/shibboleth-3.0-native-sp-config.xsd
+@@ -732,6 +732,7 @@
+     <attribute name="localLogout" type="anyURI"/>
+     <attribute name="globalLogout" type="anyURI"/>
+     <attribute name="partialLogout" type="anyURI"/>
++    <attribute name="externalParameters" type="boolean" />
+     <anyAttribute namespace="##any" processContents="lax"/>
+   </complexType>
+
+diff --git a/shibsp/ServiceProvider.cpp b/shibsp/ServiceProvider.cpp
+index aacbba1..b9f6e4c 100644
+--- a/shibsp/ServiceProvider.cpp
++++ b/shibsp/ServiceProvider.cpp
+@@ -71,9 +71,16 @@ namespace shibsp {
+         if (!app)
+             app = request.getServiceProvider().getApplication(nullptr);
+
+-        const PropertySet* props=app->getPropertySet("Errors");
++        const PropertySet* props = app->getPropertySet("Errors");
+
+-        // First look for settings in the request map of the form pageError.
++        // If the externalParameters option isn't set, clear out the request field.
++        pair<bool,bool> externalParameters =
++                props ? props->getBool("externalParameters") : pair<bool,bool>(false,false);
++        if (!externalParameters.first || !externalParameters.second) {
++            tp.m_request = nullptr;
++        }
++
++        // Now look for settings in the request map of the form pageError.
+         try {
+             RequestMapper::Settings settings = request.getRequestSettings();
+             if (mderror)
+diff --git a/shibsp/handler/impl/AttributeCheckerHandler.cpp b/shibsp/handler/impl/AttributeCheckerHandler.cpp
+index 47dff9d..52f56fa 100644
+--- a/shibsp/handler/impl/AttributeCheckerHandler.cpp
++++ b/shibsp/handler/impl/AttributeCheckerHandler.cpp
+@@ -187,8 +187,16 @@ pair<bool,long> AttributeCheckerHandler::run(SPRequest& request, bool isHandler)
+
+     ifstream infile(m_template.c_str());
+     if (infile) {
+-        TemplateParameters tp(nullptr, request.getApplication().getPropertySet("Errors"), session);
+-        tp.m_request = &request;
++        const PropertySet* props = request.getApplication().getPropertySet("Errors");
++        TemplateParameters tp(nullptr, props, session);
++
++        // If the externalParameters option isn't set, don't populate the request field.
++        pair<bool,bool> externalParameters =
++                props ? props->getBool("externalParameters") : pair<bool,bool>(false,false);
++        if (externalParameters.first && externalParameters.second) {
++            tp.m_request = &request;
++        }
++
+         stringstream str;
+         XMLToolingConfig::getConfig().getTemplateEngine()->run(infile, str, tp);
+         if (m_flushSession && session) {
+diff --git a/shibsp/handler/impl/FormSessionInitiator.cpp b/shibsp/handler/impl/FormSessionInitiator.cpp
+index 522b31b..24dd77d 100644
+--- a/shibsp/handler/impl/FormSessionInitiator.cpp
++++ b/shibsp/handler/impl/FormSessionInitiator.cpp
+@@ -123,8 +123,18 @@ pair<bool,long> FormSessionInitiator::run(SPRequest& request, string& entityID,
+     ifstream infile(XMLToolingConfig::getConfig().getPathResolver()->resolve(fname, PathResolver::XMLTOOLING_CFG_FILE).c_str());
+     if (!infile)
+         throw ConfigurationException("Unable to access HTML template ($1).", params(1, m_template));
++
++    const PropertySet* props = app.getPropertySet("Errors");
++
+     TemplateParameters tp;
+-    tp.m_request = &request;
++
++    // If the externalParameters option isn't set, don't populate the request field.
++    pair<bool,bool> externalParameters =
++            props ? props->getBool("externalParameters") : pair<bool,bool>(false,false);
++    if (externalParameters.first && externalParameters.second) {
++        tp.m_request = &request;
++    }
++
+     tp.setPropertySet(app.getPropertySet("Errors"));
+     tp.m_map["action"] = returnURL;
+     if (!target.empty())
+diff --git a/shibsp/handler/impl/LogoutHandler.cpp b/shibsp/handler/impl/LogoutHandler.cpp
+index 026be56..5673a12 100644
+--- a/shibsp/handler/impl/LogoutHandler.cpp
++++ b/shibsp/handler/impl/LogoutHandler.cpp
+@@ -63,6 +63,7 @@ pair<bool,long> LogoutHandler::sendLogoutPage(
+ {
+     string tname = string(type) + "Logout";
+     const PropertySet* props = application.getPropertySet("Errors");
++
+     pair<bool,const char*> prop = props ? props->getString(tname.c_str()) : pair<bool,const char*>(false,nullptr);
+     if (!prop.first) {
+         tname += ".html";
+@@ -76,7 +77,14 @@ pair<bool,long> LogoutHandler::sendLogoutPage(
+     if (!infile)
+         throw ConfigurationException("Unable to access $1 HTML template.", params(1,prop.second));
+     TemplateParameters tp;
+-    tp.m_request = &request;
++
++    // If the externalParameters option isn't set, don't populate the request field.
++    pair<bool,bool> externalParameters =
++            props ? props->getBool("externalParameters") : pair<bool,bool>(false,false);
++    if (externalParameters.first && externalParameters.second) {
++        tp.m_request = &request;
++    }
++
+     tp.setPropertySet(props);
+     tp.m_map["logoutStatus"] = "Logout completed successfully.";  // Backward compatibility.
+     stringstream str;
--
Thanks,
Feri

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`:

`Bug#985405`; Package `src:shibboleth-sp`.
(Wed, 17 Mar 2021 19:09:04 GMT) ([full text](bugreport.cgi?bug=985405;msg=12), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`.
(Wed, 17 Mar 2021 19:09:04 GMT) ([full text](bugreport.cgi?bug=985405;msg=14), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 985405@bugs.debian.org ([full text](bugreport.cgi?bug=985405;msg=15), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: wferi@niif.hu
Cc: team@security.debian.org, 985405@bugs.debian.org
Subject: Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based
override of variables
Date: Wed, 17 Mar 2021 20:06:22 +0100
```
On Wed, Mar 17, 2021 at 06:19:07PM +0100, wferi@niif.hu wrote:
> Dear Security Team,
>
> Please review the debdiff below for a buster-security upload.
> The advisory text changed a little meanwhile, adding credits to Toni
> Huttunen, Fraktal Oy for discovering the problem, mentioning the style
> sheet spoofing and adding some mitigation tips.
>
> I haven't got a concrete exploit on hand, but I'll start testing the
> updated package shortly.

debdiff looks fine, please upload when you had a chance to test it
(and remember to build with -sa, since shib-sp is new in buster-security,
ftp-master and security-master don't share tarballs)

Cheers,
        Moritz

```

---

**Marked as fixed in versions shibboleth-sp/3.2.1+dfsg1-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 17 Mar 2021 19:45:05 GMT) ([full text](bugreport.cgi?bug=985405;msg=17), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=17), [link](#16)).

---

**Severity set to 'grave' from 'important'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 17 Mar 2021 19:45:07 GMT) ([full text](bugreport.cgi?bug=985405;msg=19), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`:

`Bug#985405`; Package `src:shibboleth-sp`.
(Wed, 17 Mar 2021 20:51:07 GMT) ([full text](bugreport.cgi?bug=985405;msg=21), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `wferi@niif.hu`:

Extra info received and forwarded to list. Copy sent to `Debian Shib Team <pkg-shibboleth-devel@alioth-lists.debian.net>`.
(Wed, 17 Mar 2021 20:51:07 GMT) ([full text](bugreport.cgi?bug=985405;msg=23), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 985405@bugs.debian.org ([full text](bugreport.cgi?bug=985405;msg=24), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=wferi%40niif.hu)
From: wferi@niif.hu
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: wferi@niif.hu, team@security.debian.org, 985405@bugs.debian.org
Subject: Re: Bug#985405: src:shibboleth-sp: Error templates allow query-based override of variables
Date: Wed, 17 Mar 2021 21:48:23 +0100
```
Moritz Muehlenhoff <jmm@inutil.org> writes:

> debdiff looks fine, please upload when you had a chance to test it

The updated packages work fine in our infrastructure.
I uploaded the full source package.
--
Thanks,
Feri

```

---

**Reply sent**
to `Ferenc W치gner <wferi@debian.org>`:

You have taken responsibility.
(Fri, 19 Mar 2021 19:36:15 GMT) ([full text](bugreport.cgi?bug=985405;msg=26), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=26), [link](#25)).

---

**Notification sent**
to `Ferenc W치gner <wferi@debian.org>`:

Bug acknowledged by developer.
(Fri, 19 Mar 2021 19:36:15 GMT) ([full text](bugreport.cgi?bug=985405;msg=28), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 985405-close@bugs.debian.org ([full text](bugreport.cgi?bug=985405;msg=29), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 985405-close@bugs.debian.org
Subject: Bug#985405: fixed in shibboleth-sp 3.0.4+dfsg1-1+deb10u1
Date: Fri, 19 Mar 2021 19:32:09 +0000
```
Source: shibboleth-sp
Source-Version: 3.0.4+dfsg1-1+deb10u1
Done: Ferenc W치gner <wferi@debian.org>

We believe that the bug you reported is fixed in the latest version of
shibboleth-sp, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 985405@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Ferenc W치gner <wferi@debian.org> (supplier of updated shibboleth-sp package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 17 Mar 2021 21:40:34 CET
Source: shibboleth-sp
Architecture: source
Version: 3.0.4+dfsg1-1+deb10u1
Distribution: buster-security
Urgency: high
Maintainer: Debian Shib Team <pkg-shibboleth-devel@lists.alioth.debian.org>
Changed-By: Ferenc W치gner <wferi@debian.org>
Closes: [985405](bugreport.cgi?bug=985405)
Changes:
 shibboleth-sp (3.0.4+dfsg1-1+deb10u1) buster-security; urgency=high
 .
   * [594074b] New patch: SSPCPP-922 - Add externalParameters option to Errors
     element.
     Fix a phishing vulnerability: Template generation allows external
     parameters to override placeholders
     The primitive template engine used to render error pages allows
     replacement via query parameters also, though this is not a typical
     need. Because of this feature, it's possible to cause the SP to
     display some templates containing values supplied externally by URL
     manipulation. Though the values are encoded to prevent script
     injection, the content nevertheless appears to come from the server
     and so would be interpreted as trustworthy, allowing email addresses,
     logos, or support URLs to be manipulated by an attacker.
     This update adds a new <Errors> setting to the configuration called
     externalParameters, which defaults to false. When false, support for
     this "feature" is disabled.
     <https://shibboleth.net/community/advisories/secadv_20210317.txt>
     <https://issues.shibboleth.net/jira/browse/SSPCPP-922>
     Thanks to Scott Cantor (Closes: #[985405](bugreport.cgi?bug=985405))
Checksums-Sha256:
 c33ef8a0c0735abe7348e9825588bba01ac62325a6dc4375be21b153b8c0fd88 3034 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 6790ac56e79c215dd38a065c94905b979185b72294d3fce2cd78ba43995831f4 79324 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 6f33456c355d811803afba004f90810f54fdd1f2398f3486fe73f8be0ca53b22 13808 shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 b327701d111da4b5da370eddc945c382abc378ff9445e1eda9554c0d7e6f1dca 629664 shibboleth-sp_3.0.4+dfsg1.orig.tar.xz
Checksums-Sha1:
 b772eca334b15268404717420e899765f6d19d38 3034 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 41ce923aef344361e7df8f2625f31ef3d84cf85f 79324 shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 f73d4690f2fad69caaac1beb0a871266b732c309 13808 shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 cf6064d46a963cd5704439d0124bd7333ea8447e 629664 shibboleth-sp_3.0.4+dfsg1.orig.tar.xz
Files:
 b2030bd2eafac8728d6aa75d9bf7eca0 3034 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1.dsc
 74d4b3c702dd8219f9f81720c7fc5bc1 79324 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1.debian.tar.xz
 ee57dbfb6777b3d0c9f64eced6efab02 13808 web optional shibboleth-sp_3.0.4+dfsg1-1+deb10u1_amd64.buildinfo
 050e90a66472f17e81acd2ab21b677c2 629664 web optional shibboleth-sp_3.0.4+dfsg1.orig.tar.xz

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEwddEx0RNIUL7eugtOsj3Fkd+2yMFAmBSaYsACgkQOsj3Fkd+
2yOZyQ/+JOqrW/hSIdV64BRu0wYR7+gwrRM2/a29Dy9zZYKr1AAF6i2IgAmCYic2
7kNOmqKwqjEDpEf50NizKqcMxqqjlwE7M0sBz7pMIw2IR2VWL1HzOQgs1uP0HfLB
uU3sP9JUY6HmRMoZyjDsEx1iyLmHRsQ3Lb1+eMb5w/Rx7Fn1tOOlKmBE/0zOqy6A
m1drxjGtRoY65bOnjoqTJ1mUWJVLySg7OXMCsop2pCpftGDCSzSMDl7DWErM2OMF
CsisB5jx9RB3OsxYr2H7mQNY3LW7CI5MT2CKw92n7Ebv3WqSMltUjiDPj0Qqy4Pp
w9qv8mZ8iyEA7SQH13hKVSP0R7Ss7FeZIsRzjOHXocwZpxU+T+wVSNzeuD75oA8M
rP8TTDk7fSGTjhxg/rIffH04+RiJ1rDvSC1gncLphjUNzok5tnzs9OBaYH9Hy6sP
xQLCC+SCO8xfGBGM5dJgLJqzZ1jmdPFVd96wmzRdFNzdnMsCqSMlz/nexIYCjk1z
WafbGbjN+QnpuCRqDD15ySXZSE29KWvbBwnz8ULYf79RQp0AynkOLwub/3MQgXmQ
f+/adJACwlApqo+XP/hvuHsWo/VmgfxN7pNNvZTFvvPqwKlPD897phYFFUM48hKw
eVP3aDn4mkBfWQM6HlCIi9bwAF7CVnCTkFQEnAL6OtcSKpQJ4ZM=
=miVA
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 23 Apr 2021 07:24:40 GMT) ([full text](bugreport.cgi?bug=985405;msg=31), [mbox](bugreport.cgi?bug=985405;mbox=yes;msg=31), [link](#30)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=985405).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 14 18:57:15 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright 춸 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from issues.shibboleth.net_5fd66f31_20250114_185718.html ===


[![Custom Jira logo](/s/g2slup/b/0/f4712b4be2cf04fa8b6bf3ee00d3d60a/_/jira-logo-scaled.png)![Custom Jira icon](/s/g2slup/b/0/f4712b4be2cf04fa8b6bf3ee00d3d60a/_/jira-logo-scaled.png)](/jira)ProjectsFiltersDashboardsAppsCreateSearch[Sign in](/login.jsp)![](https://shibboleth.atlassian.net/rest/api/2/universal_avatar/view/type/project/avatar/10575?size=xxlarge)
## Shibboleth SP - C++

Software projectMenu[Reports](/projects/SSPCPP?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page)[Issues](/jira/software/c/projects/SSPCPP/issues)[Archived issuesNew](/jira/software/c/projects/SSPCPP/issues/archive)You're in a company-managed project![Loading...](data:image/svg+xml;base64...)


