Based on the provided content, here's a breakdown of the vulnerability described in CVE-2021-28511:

**Root Cause of Vulnerability:**

The vulnerability stems from a flaw in how Arista EOS handles the interaction between Security Access Control Lists (ACLs) and Network Address Translation (NAT) rules. Specifically, if a packet matches both a permit rule in a NAT ACL and a deny rule in a Security ACL, the NAT ACL takes precedence. This results in the security ACL being bypassed.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Access Control (CWE-284):** The system fails to enforce the intended access control policy, allowing packets that should be dropped by a security ACL to be forwarded due to a matching NAT rule.
*   **ACL Bypass:** The core issue is the ability to bypass a deny rule in a security ACL under certain conditions.

**Impact of Exploitation:**

*   An attacker could potentially bypass security ACLs, enabling traffic that would normally be blocked, potentially granting unauthorized access to network resources or services.
*   This could lead to unauthorized access to internal hosts if an attacker spoofs an address within the allowed range of the NAT, despite being in a range explicitly denied by the Security ACL.

**Attack Vectors:**

*   The attack vector is network-based, leveraging specifically crafted packets that match both a NAT permit rule and a Security ACL deny rule.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send network traffic that will reach the Arista EOS device.
*  The attacker needs to be able to send traffic that matches a NAT permit rule on the device and also an overlapping range that is denied by the Security ACL.
*   The attacker does not require any special privileges, so a non-authenticated user can exploit this vulnerability.

**Additional Details:**

*   The vulnerability applies to both dynamic and static NAT configurations, with the caveat that static NAT is less likely to be exploited due to typical configuration practices.
*   The advisory provides specific examples for configuration scenarios using dynamic and static NAT.
*   The affected software versions and platforms are clearly listed, along with unaffected products.
*   The document contains a workaround by adding deny rules from the Security ACL into the NAT ACL, which will prevent the packets from being translated at the expense of maintaining the configuration in two places.
*   The final solution requires an upgrade to the specified software versions.