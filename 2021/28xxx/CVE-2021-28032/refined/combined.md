=== Content from rustsec.org_91a0e195_20250114_190832.html ===


RUSTSEC-2021-0031: nano\_arena: split\_at allows obtaining multiple mutable references to the same data › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/nano_arena/RUSTSEC-2021-0031.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/nano_arena/RUSTSEC-2021-0031.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0031)

# RUSTSEC-2021-0031

split\_at allows obtaining multiple mutable references to the same data

Reported
January 31, 2021

Issued
March 2, 2021

(last modified: June 13, 2023)

Package
[nano\_arena](/packages/nano_arena.html)
([crates.io](https://crates.io/crates/nano_arena))

Type
Vulnerability

Categories

* [memory-corruption](/categories/memory-corruption.html)

Keywords
[#memory-safety](/keywords/memory-safety.html)
[#aliasing](/keywords/aliasing.html)
[#unsound](/keywords/unsound.html)

Aliases

* [CVE-2021-28032](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28032)
* [GHSA-wp34-mqw5-jj85](https://github.com/advisories/GHSA-wp34-mqw5-jj85)

References

* <https://github.com/bennetthardwick/nano-arena/issues/1>

CVSS Score
9.8
CRITICAL

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionNone
ScopeUnchanged
ConfidentialityHigh
IntegrityHigh
AvailabilityHigh

CVSS Vector
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
Patched

* `>=0.5.2`

Affected Functions
Version
`nano_arena::Arena::split_at`

* `<0.5.2`

`nano_arena::ArenaSplit::split_at`

* `<0.5.2`

### Description

Affected versions of this crate assumed that `Borrow<Idx>` was guaranteed to
return the same value on `.borrow()`. The borrowed index value was used to
retrieve a mutable reference to a value.

If the `Borrow<Idx>` implementation returned a different index, the split arena
would allow retrieving the index as a mutable reference creating two mutable
references to the same element. This violates Rust's aliasing rules and allows
for memory safety issues such as writing out of bounds and use-after-frees.

The flaw was corrected in commit `6b83f9d` by storing the `.borrow()` value in
a temporary variable.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


