=== Content from security.gentoo.org_95ed445a_20250115_102538.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **202107-30**

Multiple vulnerabilities have been found in Xen, the worst of which
could result in privilege escalation.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.15.0-r1** |
| Unaffected versions | >= **4.14.2-r1**>= **4.15.0-r1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen 4.14.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.14.2-r1"

```

All Xen 4.15.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.15.0-r1"

```
### References

* [CVE-2020-29479](https://nvd.nist.gov/vuln/detail/CVE-2020-29479)
* [CVE-2020-29486](https://nvd.nist.gov/vuln/detail/CVE-2020-29486)
* [CVE-2020-29487](https://nvd.nist.gov/vuln/detail/CVE-2020-29487)
* [CVE-2020-29566](https://nvd.nist.gov/vuln/detail/CVE-2020-29566)
* [CVE-2020-29567](https://nvd.nist.gov/vuln/detail/CVE-2020-29567)
* [CVE-2020-29568](https://nvd.nist.gov/vuln/detail/CVE-2020-29568)
* [CVE-2020-29569](https://nvd.nist.gov/vuln/detail/CVE-2020-29569)
* [CVE-2020-29570](https://nvd.nist.gov/vuln/detail/CVE-2020-29570)
* [CVE-2020-29571](https://nvd.nist.gov/vuln/detail/CVE-2020-29571)
* [CVE-2021-0089](https://nvd.nist.gov/vuln/detail/CVE-2021-0089)
* [CVE-2021-26313](https://nvd.nist.gov/vuln/detail/CVE-2021-26313)
* [CVE-2021-28687](https://nvd.nist.gov/vuln/detail/CVE-2021-28687)
* [CVE-2021-28690](https://nvd.nist.gov/vuln/detail/CVE-2021-28690)
* [CVE-2021-28691](https://nvd.nist.gov/vuln/detail/CVE-2021-28691)
* [CVE-2021-28692](https://nvd.nist.gov/vuln/detail/CVE-2021-28692)
* [CVE-2021-28693](https://nvd.nist.gov/vuln/detail/CVE-2021-28693)
* [CVE-2021-3308](https://nvd.nist.gov/vuln/detail/CVE-2021-3308)

**Release date**

July 12, 2021

**Latest revision**

July 12, 2021: 1

**Severity**

high

**Exploitable**

local, remote

**Bugzilla entries**

* [760144](https://bugs.gentoo.org/show_bug.cgi?id=760144)
* [766474](https://bugs.gentoo.org/show_bug.cgi?id=766474)
* [783456](https://bugs.gentoo.org/show_bug.cgi?id=783456)
* [795054](https://bugs.gentoo.org/show_bug.cgi?id=795054)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xenproject.org_b4fba20b_20250115_102539.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Xen Security Advisory CVE-2021-28687 / XSA-368
version 3
HVM soft-reset crashes toolstack
UPDATES IN VERSION 3
====================
CVE assigned.
ISSUE DESCRIPTION
=================
libxl requires all data structures passed across its public interface
to be initialized before use and disposed of afterwards by calling a
specific set of functions. Many internal data structures also require
this initialize / dispose discipline, but not all of them.
When the "soft reset" feature was implemented, the
libxl\_\_domain\_suspend\_state structure didn't require any
initialization or disposal. At some point later, an initialization
function was introduced for the structure; but the "soft reset" path
wasn't refactored to call the initialization function. When a guest
nwo initiates a "soft reboot", uninitialized data structure leads to
an assert() when later code finds the structure in an unexpected
state.
The effect of this is to crash the process monitoring the guest. How
this affects the system depends on the structure of the toolstack.
For xl, this will have no security-relevant effect: every VM has its
own independent monitoring process, which contains no state. The
domain in question will hang in a crashed state, but can be destroyed
by `xl destroy` just like any other non-cooperating domain.
For daemon-based toolstacks linked against libxl, such as libvirt,
this will crash the toolstack, losing the state of any in-progress
operations (localized DoS), and preventing further administrator
operations unless the daemon is configured to restart automatically
(system-wide DoS). If crashes "leak" resources, then repeated crashes
could use up resources, also causing a system-wide DoS.
IMPACT
======
A malicious guest can crash the management daemon, leading to at least
a localized, possibly system-wide denial-of-service.
VULNERABLE SYSTEMS
==================
Only Xen versions 4.12 through 4.14 are affected. Earlier versions
are not affected.
The issue affects only systems with a guest monitoring process, which
is linked against libxl, and which is important other than simply for
the functioning of one particular guest. libvirt is one common
toolstack affected. Systems using the `xl` command-line tool should
generally suffer no security-relevant effects.
The xapi toolstack does not currently link against libxl, and so is
not affected.
MITIGATION
==========
Ensuring that any management daemons are restarted automatically after
a crash will partially mitigate the issue.
CREDITS
=======
This issue was discovered by Olaf Hering.
RESOLUTION
==========
Applying the appropriate attached patch resolves this issue.
Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball. Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.
xsa368.patch xen-unstable
xsa368-4.14.patch Xen 4.14.x
xsa368-4.13.patch Xen 4.13.x - Xen 4.12.x
$ sha256sum xsa368\*
e80f33c3ce45372fef7bd91ec71b2b66e557176b79f9771872ce111bfff34150 xsa368.meta
b82f2b110514cdf47a2688913ad5af68b01050751d56705a15ddf9a970b6fa0d xsa368.patch
636df70ae5eaf00b50ef0b5ac219a2aeda771c66833fae88e7ee43b18ae889f4 xsa368-4.13.patch
55bbe59c75b69f493e364dfcf6cdbc7db4acd32dbf0b4d2466815b7c1f1823ce xsa368-4.14.patch
$
DEPLOYMENT DURING EMBARGO
=========================
Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.
But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).
Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.
(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable. This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)
For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----
iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmBTXAAMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZdgcH/RTW41tLPh8KHJ+82qefaI2EUBK3nmNnR5hnye3c
9GPP/QB7QdHp+JSIRTAZxOayBQeFEcYSX/5VxDypIiqT02wHS9hDr3jcpOfGLcdt
MiN9kB3vYqe353Lask0mN7AX3J5v3wvrYzBRx9ccaYcX/Jcubrx6Jy5laQSYpTUu
4GCeLZQ2tHI8N3ZHiKI7YUyxmn9vKgvFil1gyuk8L5x6npnW4ixdWF0MRyHe7wbS
dbZbug0g6bbJbs4CFZbm1CbQjGGOwznfT8z9ppmgPdi+33X+Cimz3wlbpXeJKpZk
/nJObobdPGk7ClChvUjntv0oaZ+2zFoUoe3Yc08aa+B29e8=
=Dehk
-----END PGP SIGNATURE-----

