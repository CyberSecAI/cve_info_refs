=== Content from openwrt.org_c3777120_20250114_211735.html ===


[![OpenWrt Wiki](/_media/logo.png)OpenWrt Wiki](/start "OpenWrt Wiki")

* Tools
  + User Tools
  + [Log In](/advisory/2021-08-01-3?do=login&sectok= "Log In")
  + Site Tools
  + [Recent Changes](/advisory/2021-08-01-3?do=recent "Recent Changes [r]")
  + [Media Manager](/advisory/2021-08-01-3?do=media&ns=advisory "Media Manager")
  + [Sitemap](/advisory/2021-08-01-3?do=index "Sitemap [x]")
  + Page Tools
  + [Show pagesource](/advisory/2021-08-01-3?do=edit "Show pagesource [v]")
  + [Old revisions](/advisory/2021-08-01-3?do=revisions "Old revisions [o]")
  + [Backlinks](/advisory/2021-08-01-3?do=backlink "Backlinks")
  + [Back to top](#dokuwiki__top "Back to top [t]")

* Translations of this page
  + Translations of this page [?](/meta/translation "meta:translation")
  + [English (en)](/advisory/2021-08-01-3 "English")
  + [|العربية (ar)](/ar/advisory/2021-08-01-3 "|العربية")
  + [Česky (cs)](/cs/advisory/2021-08-01-3 "Česky")
  + [Deutsch (de)](/de/advisory/2021-08-01-3 "Deutsch")
  + [Español (es)](/es/advisory/2021-08-01-3 "Español")
  + [Français (fr)](/fr/advisory/2021-08-01-3 "Français")
  + [Magyar (hu)](/hu/advisory/2021-08-01-3 "Magyar")
  + [Italiano (it)](/it/advisory/2021-08-01-3 "Italiano")
  + [日本語 (ja)](/ja/advisory/2021-08-01-3 "日本語")
  + [한국어 (ko)](/ko/advisory/2021-08-01-3 "한국어")
  + [Polski (pl)](/pl/advisory/2021-08-01-3 "Polski")
  + [Português (pt)](/pt/advisory/2021-08-01-3 "Português")
  + [Português (pt-br)](/pt-br/advisory/2021-08-01-3 "Português")
  + [Русский (ru)](/ru/advisory/2021-08-01-3 "Русский")
  + [Türkçe (tr)](/tr/advisory/2021-08-01-3 "Türkçe")
  + [Українська (uk)](/uk/advisory/2021-08-01-3 "Українська")
  + [Tiếng Việt (vi)](/vi/advisory/2021-08-01-3 "Tiếng Việt")
  + [中文 (zh)](/zh/advisory/2021-08-01-3 "中文")
  + [繁體中文 (zh-tw)](/zh-tw/advisory/2021-08-01-3 "繁體中文")

* [Log In](/advisory/2021-08-01-3?do=login&sectok= "Log In")

---

1. You are here
2. [Home](/start "start")
3. [OpenWrt Security Advisories](/advisory/start "advisory:start")
4. [Security Advisory 2021-08-01-3 - luci-app-ddns: Multiple authenticated RCEs (CVE-2021-28961)](/advisory/2021-08-01-3 "advisory:2021-08-01-3")

---

 Learn about OpenWrt
#### Learn about OpenWrt

* [Supported devices](/supported_devices "supported_devices")
* [Packages](/packages/start "packages:start")
* [Downloads](/downloads "downloads")
* [Documentation](/docs/start "docs:start")
  + [Quick start guide](/docs/guide-quick-start/start "docs:guide-quick-start:start")
  + [User guide](/docs/guide-user/start "docs:guide-user:start")
  + [Developer guide](/docs/guide-developer/start "docs:guide-developer:start")
* [Security](/docs/guide-developer/security "docs:guide-developer:security")
* [FAQ](/faq "faq")
* [Forum](https://forum.openwrt.org/ "https://forum.openwrt.org/")
#### Contributing

* [Submitting patches](/submitting-patches "submitting-patches")
* [Reporting bugs](/bugs "bugs")
* [Contributing to wiki](/wiki/wikirules "wiki:wikirules")
#### Project

* [About OpenWrt](/about "about")
* [Rules](/rules "rules")
* [Infrastructure](/infrastructure "infrastructure")
* [Donate](/donate "donate")
* [Merchandise](/merchandise "merchandise")
* [Website](/wiki/start "wiki:start")
* [Trademark policy](/trademark "trademark")
* [License](/license "license")
* [Contacts](/contact "contact")

* [Show pagesource](/advisory/2021-08-01-3?do=edit "Show pagesource [v]")
* [Old revisions](/advisory/2021-08-01-3?do=revisions "Old revisions [o]")
* [Backlinks](/advisory/2021-08-01-3?do=backlink "Backlinks")
* [Back to top](#dokuwiki__top "Back to top [t]")

×
####

###### Table of Contents

* [Security Advisory 2021-08-01-3 - luci-app-ddns: Multiple authenticated RCEs (CVE-2021-28961)](#security_advisory_2021-08-01-3_-_luci-app-ddnsmultiple_authenticated_rces_cve-2021-28961)
  + [DESCRIPTION](#description)
  + [REQUIREMENTS](#requirements)
  + [AFFECTED VERSIONS](#affected_versions)
  + [CREDITS](#credits)
  + [REFERENCES](#references)

# Security Advisory 2021-08-01-3 - luci-app-ddns: Multiple authenticated RCEs (CVE-2021-28961)

## DESCRIPTION

An authenticated user in LuCI is able to inject shell code in luci-app-ddns.
Multiple variables in the luci-app-ddns applications where not validated before they were executed on the system's shell, which could be exploited by adding system shell commands.

## REQUIREMENTS

To exploit this vulnerability the attackers needs access to LuCI and the extra application luci-app-ddns has to be installed.
The attacker is then able to inject code which is executed on the shell of the system.

In a normal OpenWrt installation all users that have access to LuCI also have access to the shell of the system over SSH for example by design.

## AFFECTED VERSIONS

To our knowledge, OpenWrt version 19.07.0 to 19.07.7 are affected. The fixed packages will be integrated in the upcoming OpenWrt 19.07.8 release. Older versions of OpenWrt (e.g. OpenWrt 18.06, OpenWrt 15.05 and LEDE 17.01) are end of life and not supported any more.

In OpenWrt 21.02 the luci-app-ddns package was already convert to a client side implementation which is not affected by this problem.

## CREDITS

This issue was identified by Jussi Rämo (Ericsson Product Security Assurance Team).

## REFERENCES

* openwrt-19.07: [https://github.com/openwrt/luci/commit/9df7ea4d66644df69fcea18b36bc465912ffccbd](https://github.com/openwrt/luci/commit/9df7ea4d66644df69fcea18b36bc465912ffccbd "https://github.com/openwrt/luci/commit/9df7ea4d66644df69fcea18b36bc465912ffccbd")

This website uses cookies. By using the website, you agree with storing cookies on your computer. Also you acknowledge that you have read and understand our Privacy Policy. If you do not agree leave the website.OK[More information about cookies](https://en.wikipedia.org/wiki/HTTP_cookie)

* Last modified: 2021/08/16 21:46
* by hauke

**Self-registration in the wiki has been disabled.

If you want to contribute to the OpenWrt wiki, please post [HERE](https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671 "https://forum.openwrt.org/t/applying-for-openwrt-wiki-account/101671") in the forum or ask on IRC for access.**

---

[![cc](/lib/tpl/bootstrap3/images/license/cc.png) ![by](/lib/tpl/bootstrap3/images/license/by.png) ![sa](/lib/tpl/bootstrap3/images/license/sa.png)](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

Except where otherwise noted, content on this wiki is licensed under the following license:
[CC Attribution-Share Alike 4.0 International](https://creativecommons.org/licenses/by-sa/4.0/deed.en "CC Attribution-Share Alike 4.0 International")

![](/lib/exe/taskrunner.php?id=advisory%3A2021-08-01-3&1736889455)



=== Content from github.com_338cf877_20250114_211735.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenwrt%2Fluci%2Fcommit%2F9df7ea4d66644df69fcea18b36bc465912ffc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenwrt%2Fluci%2Fcommit%2F9df7ea4d66644df69fcea18b36bc465912ffc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openwrt%2Fluci)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openwrt](/openwrt)
/
**[luci](/openwrt/luci)**
Public

* [Notifications](/login?return_to=%2Fopenwrt%2Fluci) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2Fopenwrt%2Fluci)
* [Star
   6.6k](/login?return_to=%2Fopenwrt%2Fluci)

* [Code](/openwrt/luci)
* [Issues
  235](/openwrt/luci/issues)
* [Pull requests
  48](/openwrt/luci/pulls)
* [Actions](/openwrt/luci/actions)
* [Projects
  0](/openwrt/luci/projects)
* [Wiki](/openwrt/luci/wiki)
* [Security](/openwrt/luci/security)
* [Insights](/openwrt/luci/pulse)

Additional navigation options

* [Code](/openwrt/luci)
* [Issues](/openwrt/luci/issues)
* [Pull requests](/openwrt/luci/pulls)
* [Actions](/openwrt/luci/actions)
* [Projects](/openwrt/luci/projects)
* [Wiki](/openwrt/luci/wiki)
* [Security](/openwrt/luci/security)
* [Insights](/openwrt/luci/pulse)

## Commit

[Permalink](/openwrt/luci/commit/9df7ea4d66644df69fcea18b36bc465912ffccbd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

luci-app-ddns: fix multiple authenticated RCEs

[Browse files](/openwrt/luci/tree/9df7ea4d66644df69fcea18b36bc465912ffccbd)
Browse the repository at this point in the history

```
The ddns detail model passes unsanitized values directly to sys.call() in
various places, which allows injecting arbitrary commands through a number
of fields.

Prevent that issue by quoting the values used in command invocations.

Signed-off-by: Jo-Philipp Wich <jo@mein.io>
```

* Loading branch information

[![@jow-](https://avatars.githubusercontent.com/u/2528802?s=40&v=4)](/jow-)

[jow-](/openwrt/luci/commits?author=jow- "View all commits by jow-")
committed
Feb 17, 2021

1 parent
[34e0d65](/openwrt/luci/commit/34e0d656a41befd9720be35c4831c9f136a67c59)

commit 9df7ea4

Showing
**1 changed file**
with
**10 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

20 changes: 10 additions & 10 deletions

20
[applications/luci-app-ddns/luasrc/model/cbi/ddns/detail.lua](#diff-4aec381ed21f2a65199b9a791480bdd362912af021b27b89918ff636f225509c "applications/luci-app-ddns/luasrc/model/cbi/ddns/detail.lua")

Show comments

[View file](/openwrt/luci/blob/9df7ea4d66644df69fcea18b36bc465912ffccbd/applications/luci-app-ddns/luasrc/model/cbi/ddns/detail.lua)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -105,22 +105,22 @@ local function \_verify\_ip\_source() |
|  |  | \_arg = (\_ipv6 == "1") |
|  |  | and ipn6:formvalue(section) |
|  |  | or ipn4:formvalue(section) |
|  |  | command = command .. [[n ]] .. \_arg |
|  |  | command = command .. [[n ]] .. UTIL.shellquote(\_arg) |
|  |  | elseif \_source == "web" then |
|  |  | \_arg = (\_ipv6 == "1") |
|  |  | and iurl6:formvalue(section) |
|  |  | or iurl4:formvalue(section) |
|  |  | command = command .. [[u ]] .. \_arg |
|  |  | command = command .. [[u ]] .. UTIL.shellquote(\_arg) |
|  |  |  |
|  |  | -- proxy only needed for checking url |
|  |  | \_arg = (pxy) and pxy:formvalue(section) or "" |
|  |  | if (\_arg and #\_arg > 0) then |
|  |  | command = command .. [[ -p ]] .. \_arg |
|  |  | command = command .. [[ -p ]] .. UTIL.shellquote(\_arg) |
|  |  | end |
|  |  | elseif \_source == "interface" then |
|  |  | command = command .. [[i ]] .. ipi:formvalue(section) |
|  |  | command = command .. [[i ]] .. UTIL.shellquote(ipi:formvalue(section)) |
|  |  | elseif \_source == "script" then |
|  |  | command = command .. [[s ]] .. ips:formvalue(section) |
|  |  | command = command .. [[s ]] .. UTIL.shellquote(ips:formvalue(section)) |
|  |  | end |
|  |  | command = command .. [[ -- get\_local\_ip]] |
|  |  | return (SYS.call(command) == 0) |
| Expand Down  Expand Up | | @@ -436,7 +436,7 @@ function uurl.validate(self, value) |
|  |  | return nil, err\_tab\_basic(self) .. "<QUERY> " .. translate("missing / required") |
|  |  | elseif not url.host then |
|  |  | return nil, err\_tab\_basic(self) .. "<HOST> " .. translate("missing / required") |
|  |  | elseif SYS.call([[nslookup ]] .. url.host .. [[ >/dev/null 2>&1]]) ~= 0 then |
|  |  | elseif SYS.call([[nslookup ]] .. UTIL.shellquote(url.host) .. [[ >/dev/null 2>&1]]) ~= 0 then |
|  |  | return nil, err\_tab\_basic(self) .. translate("can not resolve host: ") .. url.host |
|  |  | end |
|  |  |  |
| Expand Down  Expand Up | | @@ -864,7 +864,7 @@ function iurl4.validate(self, value) |
|  |  | return nil, err\_tab\_adv(self) .. translate("must start with 'http://'") |
|  |  | elseif not url.host then |
|  |  | return nil, err\_tab\_adv(self) .. "<HOST> " .. translate("missing / required") |
|  |  | elseif SYS.call([[nslookup ]] .. url.host .. [[>/dev/null 2>&1]]) ~= 0 then |
|  |  | elseif SYS.call([[nslookup ]] .. UTIL.shellquote(url.host) .. [[>/dev/null 2>&1]]) ~= 0 then |
|  |  | return nil, err\_tab\_adv(self) .. translate("can not resolve host: ") .. url.host |
|  |  | else |
|  |  | return value |
| Expand Down  Expand Up | | @@ -915,7 +915,7 @@ function iurl6.validate(self, value) |
|  |  | return nil, err\_tab\_adv(self) .. translate("must start with 'http://'") |
|  |  | elseif not url.host then |
|  |  | return nil, err\_tab\_adv(self) .. "<HOST> " .. translate("missing / required") |
|  |  | elseif SYS.call([[nslookup ]] .. url.host .. [[>/dev/null 2>&1]]) ~= 0 then |
|  |  | elseif SYS.call([[nslookup ]] .. UTIL.shellquote(url.host) .. [[>/dev/null 2>&1]]) ~= 0 then |
|  |  | return nil, err\_tab\_adv(self) .. translate("can not resolve host: ") .. url.host |
|  |  | else |
|  |  | return value |
| Expand Down  Expand Up | | @@ -1180,7 +1180,7 @@ if has\_dnsserver or ( ( m:get(section, "dns\_server") or "" ) ~= "" ) then |
|  |  | local command = CTRL.luci\_helper .. [[ -]] |
|  |  | if (ipv6 == 1) then command = command .. [[6]] end |
|  |  | if (force == 1) then command = command .. [[f]] end |
|  |  | command = command .. [[d ]] .. value .. [[ -- verify\_dns]] |
|  |  | command = command .. [[d ]] .. UTIL.shellquote(value) .. [[ -- verify\_dns]] |
|  |  |  |
|  |  | local ret = SYS.call(command) |
|  |  | if ret == 0 then return value -- everything OK |
| Expand Down  Expand Up | | @@ -1256,7 +1256,7 @@ if has\_proxy or ( ( m:get(section, "proxy") or "" ) ~= "" ) then |
|  |  | local command = CTRL.luci\_helper .. [[ -]] |
|  |  | if (ipv6 == 1) then command = command .. [[6]] end |
|  |  | if (force == 1) then command = command .. [[f]] end |
|  |  | command = command .. [[p ]] .. value .. [[ -- verify\_proxy]] |
|  |  | command = command .. [[p ]] .. UTIL.shellquote(value) .. [[ -- verify\_proxy]] |
|  |  | local ret = SYS.call(command) |
|  |  | if ret == 0 then return value |
|  |  | elseif ret == 2 then return nil, err\_tab\_adv(self) .. translate("nslookup can not resolve host") |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9df7ea4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenwrt%2Fluci%2Fcommit%2F9df7ea4d66644df69fcea18b36bc465912ffc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


