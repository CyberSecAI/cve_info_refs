```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by an array out-of-bounds write in the sdm845.c driver.",
    "weaknesses": [
      "Buffer Overflow"
    ],
    "impact": "Successful exploitation could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).",
    "attack_vectors": "The vulnerability is in the sound/soc/qcom/sdm845.c driver and is triggered when an unexpected port ID number is encountered.",
    "required_capabilities": "Local access is required to exploit this vulnerability."
  },
  "fixes": [
    {
        "commit": "1c668e1c0a0f74472469cd514f40c9012b324c31",
        "description": "The fix involves using the AFE_PORT_MAX macro instead of hardcoding the MAX AFE port ID to 16 to prevent out-of-bounds access.",
        "file_changes": [
            {
                "file": "sound/soc/qcom/sdm845.c",
                "changes": "The `stream_prepared` and `sruntime` arrays' sizes were changed from `SLIM_MAX_RX_PORTS` to `AFE_PORT_MAX`."
            }
        ]
    }
  ],
  "products_affected": [
      "FAS/AFF Baseboard Management Controller (BMC) - A250/500f",
      "NetApp Cloud Backup (formerly AltaVault)",
      "NetApp SolidFire Baseboard Management Controller (BMC)"
  ],
  "cve": "CVE-2021-28952",
  "references": [
    "https://bugzilla.redhat.com/show_bug.cgi?id=1941774",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3ebba796fa251d042be42b929a2d916ee5c34a49",
    "https://lore.kernel.org/alsa-devel/20210309142129.14182-2-srinivas.kandagatla@linaro.org/",
     "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=dbcc7d57bffc0c8cac9dac11bec548597d59a6a5",
    "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d88d05a9e0b6d9356e97129d4ff9942d765f46ea",
    "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cc7a0bb058b85ea03db87169c60c7cfdd5d34678",
    "https://security.netapp.com/advisory/ntap-20210430-0003"
  ]
}
```