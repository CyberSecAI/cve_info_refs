=== Content from packetstormsecurity.com_7c882b4c_20250114_184341.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from supportannouncement.us.dlink.com_3505e414_20250114_184346.html ===


Search by product, keyword, model.

* [Home](http://us.dlink.com/)
  [Support](http://support.dlink.com/index.aspx)
  [Forums](http://forums.dlink.com)
  [Security Advisories](http://support.dlink.com/securityadvisories.aspx)
  [Shop](https://shop.us.dlink.com/)
  US
  ![](https://supportannouncement.us.dlink.com/images/US.gif)
  English
  []

      English | French

Support Announcement

Announcement
>
SAP10208

DIR-3060 :: H/W Ax :: F/W v1.11b04 :: Authenticated LAN-Side Command Injection

**Overview**

On November 1, 2021, a 3rd party security researcher from IOT-Inspector, submitted a report accusing the DIR-3060 using firmware v1.11b04 of a LAN-side authenticated command injection exploit.   The Vulnerability was confirmed and a patch was issued too close the reported issue.  Please find the beta/hotfix release below

**3rd Party Report information**

- **Report provided:** T Shiomitsu, IoT Inspector Research Lab :: research@iot-inspector.com

          **- Reference** : <https://www.iot-inspector.com/blog/advisory-d-link-dir-3060/>

The D-Link DIR-3060 is affected by a post-authentication command injection vulnerability. Any person who is able to gain authenticated access to a DIR-3060 would be able to run arbitrary system commands on the device as the "admin" user, with root privileges.

**Affected Models**

| **Model** | **Hardware Revision** | **Affected FW** | **Fixed FW** | **Recommendation** | **Last Updated** |
| --- | --- | --- | --- | --- | --- |
| DIR-3060 | All Ax Hardware Revisions | v1.11b04 & Below | [v1.11b04 Hotfix 2](https://support.dlink.com/resource/SECURITY_ADVISEMENTS/DIR-3060/REVA/DIR-3060_REVA_FIRMWARE_v1.11B04_HOTFIX.zip) | Please Download and Update Device | 03/08/2021 |

**Regarding Security patch for your D-Link Devices**

Firmware updates address the security vulnerabilities in affected D-Link devices. D-Link will update this continually and we strongly recommend all users to install the relevant updates.

Please note that this is a device beta software, beta firmware, or hot-fix release which is still undergoing final testing before its official release. The beta software, beta firmware, or hot-fix is provided on an “as is” and “as available” basis and the user assumes all risk and liability for use thereof. D-Link does not provide any warranties, whether express or implied, as to the suitability or usability of the beta firmware. D-Link will not be liable for any loss, whether such loss is direct, indirect, special or consequential, suffered by any party as a result of their use of the beta firmware.

As there are different hardware revisions on our products, please check this on your device before downloading the correct corresponding firmware update. The hardware revision information can usually be found on the product label on the underside of the product next to the serial number. Alternatively, they can also be found on the device web configuration.

* [Contact Us](http://support.dlink.com/Search.aspx)
* Do Not Sell My Info – CA Residents Only
* Privacy
* Terms of Use
* End of Product Life-Cycle
* [GPL Source Code](http://tsd.dlink.com.tw/gpl2008.asp)



=== Content from seclists.org_b05ab26d_20250114_184342.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](22)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](22)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

![](/shared/images/nst-icons.svg#search)

# [CVE-2021-28144] Authenticated Command Injection in D-Link DIR-3060 Web Interface

---

*From*: research <research () iot-inspector com>

*Date*: Thu, 11 Mar 2021 12:09:10 +0000

---

```
IoT Inspector Research Lab Security Advisory IOT-20210311-0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
              title: Authenticated Command Injection in D-Link DIR-3060 Web
                     Interface
     vendor/product: D-Link DIR-3060 (<https://www.dlink.com/>)
 vulnerable version: v1.11b04 & Below
      fixed version: v1.11b04 Hotfix 2
         CVE number: CVE-2021-28144
             impact: 8.8 (high) CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
           reported: 2020-11-27
        publication: 2021-03-11
                 by: T Shiomitsu, IoT Inspector Research Lab
                     <https://www.iot-inspector.com/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vendor description:
-------------------
D-Link Corporation is a Taiwanese multinational networking equipment
manufacturing corporation. The DIR-3060 (also known as the EXO AC3000 Smart
Mesh Wi-Fi Router) is one of their higher-end home/small business routers.

Vulnerability overview/description:
-----------------------------------
The D-Link DIR-3060 is affected by a post-authentication command injection
vulnerability. Any person who is able to gain authenticated access to a
DIR-3060 would be able to run arbitrary system commands on the device as the
system "admin" user, with root privileges.

Proof of concept:
-----------------
When a SOAP request is made to the SetVirtualServerSettings SOAP endpoint, the
function at 00461918 in prog.cgi is invoked. This function traverses the SOAP
XML request body, stores expected SOAP field values, and takes different paths
depending on the values.

If a request with a non-null LocalIPAddress, Enabled set to “true”, an
InternalPort of “9” and a ProtocolType of “UDP” is sent, the function
CheckArpTables (named by me, based at 0046163c) is invoked.

// ...snip
      iVar5 = strcmp(Enabled,"true");
      if ((((iVar5 == 0) && (LocalIPAddress != (char *)0x0)) &&
          (iVar5 = strcmp(InternalPort,"9"), iVar5 == 0)) &&
         (iVar5 = strcmp(ProtocolType,"UDP"), iVar5 == 0)) {
        local_4154 = local_4154 + 1;
        iVar5 = CheckArpTables(LocalIPAddress, InternalPort, ProtocolType, 0xdc, local_4154);
        if (iVar5 == -1) {
            local_4160 = 0xb;
            goto LAB_00462504;
        }
      }
// ...snip

Interestingly, UDP/9 correlates to the canonical Discard Protocol, which is the
TCP/UDP/IP equivalent of /dev/null.

The CheckArpTables() function attempts to check the device ARP records, by
calling the arp system command and grep’ing the output. However, the user-
controlled value passed as the LocalIPAddress is written directly into the
command line format string with snprint(). This string is then passed directly
to a function called FCGI_popen(), which is a library function imported from
libfcgi.so.

undefined CheckArpTables(char *LocalIPAddress, char *InternalPort, char *ProtocolType, undefined param_4, int param_5) {
    // ...snip...
    memset(buffer, 0, 0x40);
    // ...snip...
    snprintf(buffer, 0x40, "arp | grep %s | awk \'{printf $4}\'", LocalIPAddress);
    iVar1 = FCGI_popen(buffer, "r");
    // ...snip...
}

We can see in libfcgi.so that FCGI_popen() is essentially only a thin wrapper
around the stdio popen() library function. Arguments passed to FCGI_popen()
get passed directly to popen().

int FCGI_popen(char *param_1, char *param_2)
{
  FILE *__stream;
  int iVar1;
  __stream = popen(param_1,param_2);
  iVar1 = FCGI_OpenFromFILE(__stream);
  if ((__stream != (FILE *)0x0) && (iVar1 == 0)) {
    pclose(__stream);
  }
  return iVar1;
}

Since the LocalIPAddress value is not sanitized or checked in any way, a
crafted command injection string can be passed as the LocalIPAddress, which
will then be written to the arp command format string, and passed (almost)
directly to popen().

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vulnerable / tested versions:
-----------------------------
DIR-3060 v1.11b04

Solution:
---------
Apply D-Link-supplied patch, v1.11b04 Hotfix 2.

Advisory URL:
-------------
<https://www.iot-inspector.com/blog/advisory-d-link-dir-3060/>

Vendor contact timeline:
------------------------
2020-11-16: Initial contact made to ipsecure () dlinkcorp com to request keys for
            encryption.
2020-11-20: No reply received, so follow-up e-mail sent.
2020-11-27: No reply received, so advisory sent by e-mail without encryption.
2021-02-03: No reply received, so follow-up e-mail sent.
2021-02-12: No reply received, so inquiry sent using the forms at
            support.dlink.com and eu.dlink.com/uk/en/contact-d-link.
2021-02-17: Response from the US D-Link support team, pointing us towards the
            US-specific D-Link security page.
2021-02-17: Sent e-mail to this new US-specific D-Link security e-mail address.
2021-02-19: Response from a member of the D-Link USA SIRT.
2021-02-19: We request a public key from D-Link USA for transmission of the
            advisory.
2021-02-19: PGP public key is provided by D-Link USA.
2021-02-19: Advisory is sent to D-Link USA with encryption.
2021-02-19: Receipt of advisory is confirmed by D-Link USA SIRT.
2021-02-19: We reply and ask for D-Link USA to keep us updated.
2021-02-20: D-Link “ipsecure” finally answers our e-mail, saying that
            security () dlink com should be the official e-mail, and the
            ipsecure () dlinkcorp com e-mail (the only one listed on the main
            D-Link security disclosure page) is only a backup address.
2021-02-22: D-Link USA responds, confirming that the e-mail address listed
            on the main D-Link security page has been changed.
2021-03-02: We e-mail D-Link USA to ask for a status update.
2021-03-02: D-Link USA responds with status update.
2021-03-08: D-Link USA provides patched firmware for testing.
2021-03-08: We respond asking for assigned CVE number.
2021-03-08: D-Link USA notes that they do not apply for, or manage CVE numbers
            related to their own products.
2021-03-08: We apply for a CVE number for this issue.
2021-03-08: D-Link USA publishes public advisory.
2021-03-11: CVE is assigned & IoT Inspector Research Lab publishes advisory.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The IoT Inspector Research Lab is an integrated part of IoT Inspector.

IoT Inspector is a platform for automated security analysis and compliance
checks of IoT firmware. Our mission is to secure the Internet of Things. In
order to discover vulnerabilities and vulnerability patterns within IoT devices
and to further enhance automated identification that allows for scalable
detection within IoT Inspector, we conduct excessive security research in the
area of IoT.

Whenever the IoT Inspector Research Lab discovers vulnerabilities in IoT
firmware, we aim to responsibly disclose relevant information to the vendor
of the affected IoT device as well as the general public in a way that
minimizes potential harm and encourages further security analyses of IoT
systems.

You can find our responsible disclosure policy here:
<https://www.iot-inspector.com/responsible-disclosure-policy/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Interested in using IoT Inspector for your research or product?

Mail: research at iot-inspector dot com
Web: <https://www.iot-inspector.com>
Blog: <https://www.iot-inspector.com/blog/>
Twitter: <https://twitter.com/iotinspector>

EOF T Shiomitsu / @2021

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](22)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](22)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

### Current thread:

* **[CVE-2021-28144] Authenticated Command Injection in D-Link DIR-3060 Web Interface** *research (Mar 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.iot-inspector.com_ee0c2cc1_20250114_184348.html ===
Ready for the New EU Cyber Resilience Act?[Learn More](/cra-readiness-assessment)

Solutions

Roles[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)Use Cases[SBOM Management](/use-case/sbom-management)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[TELCO](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Product

ONEKEY PlatformYour All-in-One Cybersecurity and Compliance Solution[Platform Overview](/platform-overview)Features[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis)[Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)[![ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67121fed08268feb9f6b269b_whitepaperhero.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)WhitepapersSep 1, 2024ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](/resource/onekey-360deg-comprehensive-product-cybersecurity-compliance)[Expert Consulting](/expert-consulting)Resources

ONEKEY ResourcesAll our resources combined in one place[Resources](/resources)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)[![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)ResearchNov 26, 2024Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)Company

[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Release](/press-releases)[![Cyber Resilience Act bans products with known vulnerabilities](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b822e403bdc2f3221d575_6712ae1b7f657cc8b66be3ee_02.jpeg)Press ReleaseJun 6, 2024Cyber Resilience Act bans products with known vulnerabilities](/press-release/cyber-resilience-act-bans-products-with-known-vulnerabilities)[Book a Demo](/book-a-demo)[Book a Demo](/book-a-demo)

[Resources](/resources)>[Research](/resources/research)>Advisory: D-Link DIR-3060 Authenticated RCE (CVE-2021-28144)
# Advisory: D-Link DIR-3060 Authenticated RCE (CVE-2021-28144)

![Advisory: D-Link DIR-3060 Authenticated RCE (CVE-2021-28144)](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b822e403bdc2f3221d575_6712ae1b7f657cc8b66be3ee_02.jpeg)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)March 10, 20216Â min readTablE of contentsExample H2
## READY TO UPGRADE YOUR RISK MANAGEMENT?

Make cybersecurity and compliance efficient and effective with ONEKEY.

[Book a Demo](/book-a-demo)
# **Overview**

The [D-Link DIR-3060](https://www.dlink.com/en/products/dir-3060-exo-ac3000-smart-mesh-wi-fi-router) (running firmware versions below v1.11b04) is affected by a post-authentication command injection vulnerability. Anybody with authenticated access to a DIR-3060 would be able to run arbitrary system commands on the device as the system "admin" user, with root privileges. D-Link has released a patched firmware version [v1.11b04 Hotfix 2](https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10208) to address this issue. Affected users are advised to apply the patch.
[caption id="attachment\_3886" align="aligncenter" width="600"]![D-Link Dir 3060 Â© D-Link](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8b88c71fe45365175b18_D-Link-DIR-3060-768x481-1.png) D-Link Dir 3060 Â© D-Link[/caption]

| Affected vendor & product | D-Link DIR-3060 ([www.dlink.com](https://www.dlink.com/)) |
| --- | --- |
| Vulnerable version | v1.11b04 & below |
| Fixed version | [v1.11b04 Hotfix 2](https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10208) |
| CVE Number | CVE-2021-28144 |
| Impact | 8.8 (high) [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H&version=3.1) |
| Credit | T. Shiomitsu, IoT Inspector Research Lab |

# **Vulnerable Component**

Web management functionality on the DIR-3060 is mainly handled by the `prog.cgi` binary. The `lighttpd` `fastcgi` server configuration is such that requests made to `/HNAP1/` or files with the `.fcgi` extension are handled by `/etc_ro/lighttpd/www/web/HNAP1/prog.fcgi`, which is a symlink to `/bin/prog.cgi`.
```
// ...
fastcgi.server = (
    "/HNAP1/" =>
    ((
        "socket" => "/var/prog.fcgi.socket-0",
        "check-local" => "enable",
        "bin-path" => "/etc_ro/lighttpd/www/web/HNAP1/prog.fcgi",
        "idle-timeout" => 10,
        "min-procs" => 1,
        "max-procs" => 2
    )),
    ".fcgi" =>
    ((
        "socket" => "/var/prog.fcgi.socket-0",
        "check-local" => "enable",
        "bin-path" => "/etc_ro/lighttpd/www/web/HNAP1/prog.fcgi",
        "idle-timeout" => 10,
        "min-procs" => 1,
        "max-procs" => 2
    )),
    "/common/" =>
    ((
        "socket" => "/var/myinfo.fcgi.socket-0",
        "check-local" => "disable",
        "bin-path" => "/sbin/myinfo.cgi",
        "idle-timeout" => 10,
        "min-procs" => 1,
        "max-procs" => 1
    ))
)
// ...
```
By default, configuration changes are made by issuing SOAP requests to the web management interface at `http://[ROUTER]/HNAP1/` - these are then all then handled by `prog.cgi`.
# **The****Vulnerability**

When a SOAP request is made to the `SetVirtualServerSettings` SOAP endpoint, the function at `00461918`  in `prog.cgi` is invoked. This function traverses the SOAP XML request body, stores expected SOAP field values, and takes different paths depending on the values.
If a request with a non-null `LocalIPAddress`, `Enabled` set to âtrueâ, an `InternalPort` of â9â and a `ProtocolType` of âUDPâ is sent, the function `CheckArpTables` (named by me, based at `0046163c`) is invoked.
```
// ...snip
      iVar5 = strcmp(Enabled,"true");
      if ((((iVar5 == 0) && (LocalIPAddress != (char *)0x0)) &&
          (iVar5 = strcmp(InternalPort,"9"), iVar5 == 0)) &&
         (iVar5 = strcmp(ProtocolType,"UDP"), iVar5 == 0)) {
        local_4154 = local_4154 + 1;
        iVar5 = CheckArpTables(LocalIPAddress, InternalPort, ProtocolType, 0xdc, local_4154);
        if (iVar5 == -1) {
            local_4160 = 0xb;
            goto LAB_00462504;
        }
      }
// ...snip
```
Interestingly, UDP/9 correlates to the canonical [Discard Protocol](https://en.wikipedia.org/wiki/Discard_Protocol), which is the TCP/UDP/IP equivalent of `/dev/null`.
The `CheckArpTables()` function attempts to check the device ARP records, by calling the `arp` system command and `grep`âing the output. However, the user-controlled value passed as the `LocalIPAddress` is written directly into the command line format string with `snprint()`. This string is then passed directly to a function called `FCGI_popen()`, which is a library function imported from `libfcgi.so`.
```
undefined CheckArpTables(char *LocalIPAddress, char *InternalPort, char *ProtocolType, undefined param_4, int param_5) {
    // ...snip...
    memset(buffer, 0, 0x40);
    // ...snip...
    snprintf(buffer, 0x40, "arp | grep %s | awk \'{printf $4}\'", LocalIPAddress);
    iVar1 = FCGI_popen(buffer, "r");
    // ...snip...
}
```
We can see in `libfcgi.so` that `FCGI_popen()` is essentially only a thin wrapper around the stdio `popen()` library function. Arguments passed to `FCGI_popen()` get passed directly to `popen()`.
```
int FCGI_popen(char *param_1, char *param_2)
{
  FILE *__stream;
  int iVar1;
  __stream = popen(param_1,param_2);
  iVar1 = FCGI_OpenFromFILE(__stream);
  if ((__stream != (FILE *)0x0) && (iVar1 == 0)) {
    pclose(__stream);
  }
  return iVar1;
}
```
Since the `LocalIPAddress` value is not sanitized or checked in any way, a crafted command injection string can be passed as the `LocalIPAddress`, which will then be written to the `arp` command format string, and passed (almost) directly to `popen()`.
[![Copy Of Ads 480 120](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8236692550f5d60746d6_Copy-of-Ads-480_120.png)](https://www.iot-inspector.com/demo/)
# **Key Takeaways**

Abstraction of common library functions with potential security implications is common in embedded device development. Many embedded developers attempt to do this in order to easily "drop-in" common library functions with more secure analogues.
However, D-Link, in this case, did not do this. They had abstracted (and used) the `FCGI_popen()` function as a drop-in replacement for `popen()` - presumably in order to ensure that the implementation could be standardized for code cleanliness (and perhaps security) purposes. However, there was no extra checking or sanitization in place in the actual `FCGI_popen()` function. Therefore, there was no particular security benefit to this abstraction.
From our perspective (weâre in the business of automating security analysis of embedded device firmware, in case you didnât know) this is an interesting case. Vendors often use such drop-in replacement functions, imported from external libraries. When running our automated security analyses of ELF executables, we have to take into account which imported functions are used within an ELF, as well as how exposed potentially dangerous library functions are within these functions. This can help us drill down more intentionally into these executables to flag potential security issues. This kind of automation can considerably speed up recognition of potential security issues.
# **Disclosure Timeline**

*2020-11-16*: Initial contact made to ipsecure@dlinkcorp.com to request keys for encryption.
*2020-11-20*: No reply received, so follow-up e-mail sent.
*2020-11-27*: No reply received, so advisory sent by e-mail without encryption.
*2021-02-03*: No reply received, so follow-up e-mail sent.
*2021-02-12*: No reply received, so inquiry sent using the forms at support.dlink.com and eu.dlink.com/uk/en/contact-d-link.
*2021-02-17*: Response from the US D-Link support team, pointing us towards the US-specific D-Link security page.
*2021-02-17*: Sent e-mail to this new US-specific D-Link security e-mail address.
*2021-02-19*: Response from a member of the D-Link USA SIRT.
*2021-02-19*: We request a public key from D-Link USA for transmission of the advisory.
*2021-02-19*: PGP public key is provided by D-Link USA.
*2021-02-19*: Advisory is sent to D-Link USA with encryption.
*2021-02-19*: Receipt of advisory is confirmed by D-Link USA SIRT.
*2021-02-19*: We reply and ask for D-Link USA to keep us updated.
*2021-02-20*: D-Link "ipsecure" finally answers our e-mail, saying that security@dlink.com should be the official e-mail, and the ipsecure@dlinkcorp.com e-mail (the only one listed on the main D-Link security disclosure page) is only a backup address.
*2021-02-22*: D-Link USA responds, confirming that the e-mail address listed on the main D-Link security page has been changed.
*2021-03-02*: We e-mail D-Link USA to ask for a status update.
*2021-03-02*: D-Link USA responds with status update.
*2021-03-08*: D-Link USA provides patched firmware for testing.
*2021-03-08*: We respond asking for assigned CVE number.
*2021-03-08*: D-Link USA notes that they do not apply for, or manage CVE numbers related to their own products.
*2021-03-08*: We apply for a [CVE number](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28144) for this issue.
*2021-03-08*: [D-Link USA publishes public advisory](https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10208).
*2021-03-11*: CVE is assigned & IoT Inspector Research Lab publishes advisory.
Share
## About Onekey

[ONEKEY](/) is the leading European specialist in Product Cybersecurity & Compliance Management and part of the investment portfolio of [PricewaterhouseCoopers Germany (PwC)](https://www.pwc.de/de.html). The unique combination of an automated Product Cybersecurity & Compliance Platform (PCCP) with expert knowledge and consulting services provides fast and comprehensive analysis, support, and management to improve product cybersecurity and compliance from product purchasing, design, development, production to end-of-life.

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/67583204f930179edfad5cb3_2024-09%20ONEKEY-TEAM_Mallorca.avif)

CONTACT:
Sara Fortmann
Marketing Manager
sara.fortmann@onekey.com

euromarcom public relations GmbH
+49 611 973 150
team@euromarcom.de

## RELATED RESEARCH ARTICLES

![Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/675192012562197008d3c477_Image%20Frame%20124.avif)ResearchDec 5, 202410Â min read
### Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones

Explore the latest developments in Unblob, including enhanced sandboxing with Landlock, improved carving reporting, and ÏÂ² randomness analysis. Celebrate community contributions, academic research collaborations, and new format handlers, while looking forward to exciting updates in 2025.

[Read More](/resource/unblob-2024-highlights-sandboxing-reporting-and-community-milestones)![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)ResearchNov 26, 202420Â min read
### Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers

Discover how severe security flaws, including unauthenticated remote command execution (CVE-2024-11665 & CVE-2024-11666), affect eCharge EV charging controllers. Learn about insecure firmware practices, cloud infrastructure issues, and actionable steps to mitigate risks in EV charging systems.

[Read More](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)![Security Advisory: Unauthenticated Command Injection in Mitel IP Phones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67209c8a2e0431878267653a_AdobeStock_493462234.jpeg)ResearchNov 17, 202415Â min read
### Security Advisory: Unauthenticated Command Injection in Mitel IP Phones

Discover critical vulnerabilities in Mitel SIP phones that allow unauthenticated command injection. Learn how outdated input parsing can expose your devices and why it's essential to scan firmware for security risks. Protect your network with our in-depth analysis and expert takeaways.

[Read More](/resource/security-advisory-unauthenticated-command-injection-in-mitel-ip-phones)
## Ready to automate your Product Cybersecurity & Compliance?

Make cybersecurity and compliance efficient and effective withÂ ONEKEY.

[Book a Demo](/book-a-demo)

![onekey logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66ec7d83c10fbfa879b33dd9_ONEKEY_Logo_Neon.svg)Solutions[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)[SBOM Management](/use-case/sbom-management)Product[Platform Overview](/platform-overview)[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis) [Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[Telco](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)Company[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Releases](/press-releases)Social[LinkedIn](https://www.linkedin.com/company/onekey-sec/)[Twitter (X)](https://x.com/onekey_sec)

[Privacy policy](/privacy-policy)[Impressum](/imprint)[Responsible Disclosure Policy](/responsible-disclosure-policy)![Security logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9c52cda15bb54ea28e_Frame%201000003145.png)![Allianz logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d773dfd7f6acbffc5_Frame%201000003146.avif)![Cybersecurity Made In Europe logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d6e4f46bc39d692ea_Frame%201000003144.avif)![ECSO logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d1b01b2cbe0045cea_Frame%201000003152.avif)ONEKeY 2024


