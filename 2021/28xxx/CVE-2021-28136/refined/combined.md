=== Content from github.com_655e2546_20250115_080306.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp-idf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp-idf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=espressif%2Fesp-idf)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[espressif](/espressif)
/
**[esp-idf](/espressif/esp-idf)**
Public

* [Notifications](/login?return_to=%2Fespressif%2Fesp-idf) You must be signed in to change notification settings
* [Fork
  7.4k](/login?return_to=%2Fespressif%2Fesp-idf)
* [Star
   14.3k](/login?return_to=%2Fespressif%2Fesp-idf)

Espressif IoT Development Framework. Official development framework for Espressif SoCs.

### License

[Apache-2.0 license](/espressif/esp-idf/blob/master/LICENSE)

[14.3k
stars](/espressif/esp-idf/stargazers) [7.4k
forks](/espressif/esp-idf/forks) [Branches](/espressif/esp-idf/branches) [Tags](/espressif/esp-idf/tags) [Activity](/espressif/esp-idf/activity)
 [Star](/login?return_to=%2Fespressif%2Fesp-idf)

 [Notifications](/login?return_to=%2Fespressif%2Fesp-idf) You must be signed in to change notification settings

* [Code](/espressif/esp-idf)
* [Issues
  1.5k](/espressif/esp-idf/issues)
* [Pull requests
  126](/espressif/esp-idf/pulls)
* [Actions](/espressif/esp-idf/actions)
* [Projects
  0](/espressif/esp-idf/projects)
* [Security](/espressif/esp-idf/security)
* [Insights](/espressif/esp-idf/pulse)

Additional navigation options

* [Code](/espressif/esp-idf)
* [Issues](/espressif/esp-idf/issues)
* [Pull requests](/espressif/esp-idf/pulls)
* [Actions](/espressif/esp-idf/actions)
* [Projects](/espressif/esp-idf/projects)
* [Security](/espressif/esp-idf/security)
* [Insights](/espressif/esp-idf/pulse)

# espressif/esp-idf

    master[Branches](/espressif/esp-idf/branches)[Tags](/espressif/esp-idf/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[42,141 Commits](/espressif/esp-idf/commits/master/) | | |
| [.github](/espressif/esp-idf/tree/master/.github ".github") | | [.github](/espressif/esp-idf/tree/master/.github ".github") |  |  |
| [.gitlab](/espressif/esp-idf/tree/master/.gitlab ".gitlab") | | [.gitlab](/espressif/esp-idf/tree/master/.gitlab ".gitlab") |  |  |
| [components](/espressif/esp-idf/tree/master/components "components") | | [components](/espressif/esp-idf/tree/master/components "components") |  |  |
| [docs](/espressif/esp-idf/tree/master/docs "docs") | | [docs](/espressif/esp-idf/tree/master/docs "docs") |  |  |
| [examples](/espressif/esp-idf/tree/master/examples "examples") | | [examples](/espressif/esp-idf/tree/master/examples "examples") |  |  |
| [tools](/espressif/esp-idf/tree/master/tools "tools") | | [tools](/espressif/esp-idf/tree/master/tools "tools") |  |  |
| [.codespellrc](/espressif/esp-idf/blob/master/.codespellrc ".codespellrc") | | [.codespellrc](/espressif/esp-idf/blob/master/.codespellrc ".codespellrc") |  |  |
| [.editorconfig](/espressif/esp-idf/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/espressif/esp-idf/blob/master/.editorconfig ".editorconfig") |  |  |
| [.flake8](/espressif/esp-idf/blob/master/.flake8 ".flake8") | | [.flake8](/espressif/esp-idf/blob/master/.flake8 ".flake8") |  |  |
| [.gitignore](/espressif/esp-idf/blob/master/.gitignore ".gitignore") | | [.gitignore](/espressif/esp-idf/blob/master/.gitignore ".gitignore") |  |  |
| [.gitlab-ci.yml](/espressif/esp-idf/blob/master/.gitlab-ci.yml ".gitlab-ci.yml") | | [.gitlab-ci.yml](/espressif/esp-idf/blob/master/.gitlab-ci.yml ".gitlab-ci.yml") |  |  |
| [.gitmodules](/espressif/esp-idf/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/espressif/esp-idf/blob/master/.gitmodules ".gitmodules") |  |  |
| [.mypy.ini](/espressif/esp-idf/blob/master/.mypy.ini ".mypy.ini") | | [.mypy.ini](/espressif/esp-idf/blob/master/.mypy.ini ".mypy.ini") |  |  |
| [.pre-commit-config.yaml](/espressif/esp-idf/blob/master/.pre-commit-config.yaml ".pre-commit-config.yaml") | | [.pre-commit-config.yaml](/espressif/esp-idf/blob/master/.pre-commit-config.yaml ".pre-commit-config.yaml") |  |  |
| [.pylintrc](/espressif/esp-idf/blob/master/.pylintrc ".pylintrc") | | [.pylintrc](/espressif/esp-idf/blob/master/.pylintrc ".pylintrc") |  |  |
| [.readthedocs.yml](/espressif/esp-idf/blob/master/.readthedocs.yml ".readthedocs.yml") | | [.readthedocs.yml](/espressif/esp-idf/blob/master/.readthedocs.yml ".readthedocs.yml") |  |  |
| [.shellcheckrc](/espressif/esp-idf/blob/master/.shellcheckrc ".shellcheckrc") | | [.shellcheckrc](/espressif/esp-idf/blob/master/.shellcheckrc ".shellcheckrc") |  |  |
| [.vale.ini](/espressif/esp-idf/blob/master/.vale.ini ".vale.ini") | | [.vale.ini](/espressif/esp-idf/blob/master/.vale.ini ".vale.ini") |  |  |
| [CMakeLists.txt](/espressif/esp-idf/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/espressif/esp-idf/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [COMPATIBILITY.md](/espressif/esp-idf/blob/master/COMPATIBILITY.md "COMPATIBILITY.md") | | [COMPATIBILITY.md](/espressif/esp-idf/blob/master/COMPATIBILITY.md "COMPATIBILITY.md") |  |  |
| [COMPATIBILITY\_CN.md](/espressif/esp-idf/blob/master/COMPATIBILITY_CN.md "COMPATIBILITY_CN.md") | | [COMPATIBILITY\_CN.md](/espressif/esp-idf/blob/master/COMPATIBILITY_CN.md "COMPATIBILITY_CN.md") |  |  |
| [CONTRIBUTING.md](/espressif/esp-idf/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/espressif/esp-idf/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [Kconfig](/espressif/esp-idf/blob/master/Kconfig "Kconfig") | | [Kconfig](/espressif/esp-idf/blob/master/Kconfig "Kconfig") |  |  |
| [LICENSE](/espressif/esp-idf/blob/master/LICENSE "LICENSE") | | [LICENSE](/espressif/esp-idf/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/espressif/esp-idf/blob/master/README.md "README.md") | | [README.md](/espressif/esp-idf/blob/master/README.md "README.md") |  |  |
| [README\_CN.md](/espressif/esp-idf/blob/master/README_CN.md "README_CN.md") | | [README\_CN.md](/espressif/esp-idf/blob/master/README_CN.md "README_CN.md") |  |  |
| [ROADMAP.md](/espressif/esp-idf/blob/master/ROADMAP.md "ROADMAP.md") | | [ROADMAP.md](/espressif/esp-idf/blob/master/ROADMAP.md "ROADMAP.md") |  |  |
| [ROADMAP\_CN.md](/espressif/esp-idf/blob/master/ROADMAP_CN.md "ROADMAP_CN.md") | | [ROADMAP\_CN.md](/espressif/esp-idf/blob/master/ROADMAP_CN.md "ROADMAP_CN.md") |  |  |
| [SECURITY.md](/espressif/esp-idf/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/espressif/esp-idf/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [SUPPORT\_POLICY.md](/espressif/esp-idf/blob/master/SUPPORT_POLICY.md "SUPPORT_POLICY.md") | | [SUPPORT\_POLICY.md](/espressif/esp-idf/blob/master/SUPPORT_POLICY.md "SUPPORT_POLICY.md") |  |  |
| [SUPPORT\_POLICY\_CN.md](/espressif/esp-idf/blob/master/SUPPORT_POLICY_CN.md "SUPPORT_POLICY_CN.md") | | [SUPPORT\_POLICY\_CN.md](/espressif/esp-idf/blob/master/SUPPORT_POLICY_CN.md "SUPPORT_POLICY_CN.md") |  |  |
| [add\_path.sh](/espressif/esp-idf/blob/master/add_path.sh "add_path.sh") | | [add\_path.sh](/espressif/esp-idf/blob/master/add_path.sh "add_path.sh") |  |  |
| [conftest.py](/espressif/esp-idf/blob/master/conftest.py "conftest.py") | | [conftest.py](/espressif/esp-idf/blob/master/conftest.py "conftest.py") |  |  |
| [export.bat](/espressif/esp-idf/blob/master/export.bat "export.bat") | | [export.bat](/espressif/esp-idf/blob/master/export.bat "export.bat") |  |  |
| [export.fish](/espressif/esp-idf/blob/master/export.fish "export.fish") | | [export.fish](/espressif/esp-idf/blob/master/export.fish "export.fish") |  |  |
| [export.ps1](/espressif/esp-idf/blob/master/export.ps1 "export.ps1") | | [export.ps1](/espressif/esp-idf/blob/master/export.ps1 "export.ps1") |  |  |
| [export.sh](/espressif/esp-idf/blob/master/export.sh "export.sh") | | [export.sh](/espressif/esp-idf/blob/master/export.sh "export.sh") |  |  |
| [install.bat](/espressif/esp-idf/blob/master/install.bat "install.bat") | | [install.bat](/espressif/esp-idf/blob/master/install.bat "install.bat") |  |  |
| [install.fish](/espressif/esp-idf/blob/master/install.fish "install.fish") | | [install.fish](/espressif/esp-idf/blob/master/install.fish "install.fish") |  |  |
| [install.ps1](/espressif/esp-idf/blob/master/install.ps1 "install.ps1") | | [install.ps1](/espressif/esp-idf/blob/master/install.ps1 "install.ps1") |  |  |
| [install.sh](/espressif/esp-idf/blob/master/install.sh "install.sh") | | [install.sh](/espressif/esp-idf/blob/master/install.sh "install.sh") |  |  |
| [pytest.ini](/espressif/esp-idf/blob/master/pytest.ini "pytest.ini") | | [pytest.ini](/espressif/esp-idf/blob/master/pytest.ini "pytest.ini") |  |  |
| [sdkconfig.rename](/espressif/esp-idf/blob/master/sdkconfig.rename "sdkconfig.rename") | | [sdkconfig.rename](/espressif/esp-idf/blob/master/sdkconfig.rename "sdkconfig.rename") |  |  |
| [sgconfig.yml](/espressif/esp-idf/blob/master/sgconfig.yml "sgconfig.yml") | | [sgconfig.yml](/espressif/esp-idf/blob/master/sgconfig.yml "sgconfig.yml") |  |  |
| [sonar-project.properties](/espressif/esp-idf/blob/master/sonar-project.properties "sonar-project.properties") | | [sonar-project.properties](/espressif/esp-idf/blob/master/sonar-project.properties "sonar-project.properties") |  |  |
| View all files | | |

## Repository files navigation

* README
* Apache-2.0 license
* Security
# Espressif IoT Development Framework

* [中文版](/espressif/esp-idf/blob/master/README_CN.md)

ESP-IDF is the development framework for Espressif SoCs supported on Windows, Linux and macOS.

# ESP-IDF Release Support Schedule

[![Support Schedule](https://camo.githubusercontent.com/fb512099a286a6fbef99d87daebe40d553bf65990a6007e9e11dac7d4e19bf79/68747470733a2f2f646c2e6573707265737369662e636f6d2f646c2f6573702d6964662f737570706f72742d706572696f64732e7376673f763d31)](https://camo.githubusercontent.com/fb512099a286a6fbef99d87daebe40d553bf65990a6007e9e11dac7d4e19bf79/68747470733a2f2f646c2e6573707265737369662e636f6d2f646c2f6573702d6964662f737570706f72742d706572696f64732e7376673f763d31)

* Please read [the support policy](/espressif/esp-idf/blob/master/SUPPORT_POLICY.md) and [the documentation](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/versions.html) for more information about ESP-IDF versions.
* Please see the [End-of-Life Advisories](https://www.espressif.com/en/support/documents/advisories?keys=&field_type_of_advisory_tid%5B%5D=817) for information about ESP-IDF releases with discontinued support.

# ESP-IDF Release and SoC Compatibility

The following table shows ESP-IDF support of Espressif SoCs where [![alt text](https://camo.githubusercontent.com/d45d12181b76b9be44976bdd3b58bb82a413dfaf2ef23733387675217c64e591/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d707265766965772d6f72616e6765 "preview")](https://camo.githubusercontent.com/d45d12181b76b9be44976bdd3b58bb82a413dfaf2ef23733387675217c64e591/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d707265766965772d6f72616e6765) and [![alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e "supported")](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) denote preview status and support, respectively. The preview support is usually limited in time and intended for beta versions of chips. Please use an ESP-IDF release where the desired SoC is already supported.

| Chip | v5.0 | v5.1 | v5.2 | v5.3 | v5.4 |  |
| --- | --- | --- | --- | --- | --- | --- |
| ESP32 | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) |  |
| ESP32-S2 | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) |  |
| ESP32-C3 | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) |  |
| ESP32-S3 | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [Announcement](https://www.espressif.com/en/news/ESP32_S3) |
| ESP32-C2 | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [Announcement](https://www.espressif.com/en/news/ESP32-C2) |
| ESP32-C6 |  | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [Announcement](https://www.espressif.com/en/news/ESP32_C6) |
| ESP32-H2 |  | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [Announcement](https://www.espressif.com/en/news/ESP32_H2) |
| ESP32-P4 |  |  |  | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [alt text](https://camo.githubusercontent.com/be317185b6e9027a0bceb6ba8ebd6a8d7b079b4dc9103462a2e5c6f2f5ec8b7c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d737570706f727465642d677265656e) | [Announcement](https://www.espressif.com/en/news/ESP32-P4) |
| ESP32-C5 |  |  |  |  | [alt text](https://camo.githubusercontent.com/d45d12181b76b9be44976bdd3b58bb82a413dfaf2ef23733387675217c64e591/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d707265766965772d6f72616e6765) | [Announcement](https://www.espressif.com/en/news/ESP32-C5) |
| ESP32-C61 |  |  |  |  | [alt text](https://camo.githubusercontent.com/d45d12181b76b9be44976bdd3b58bb82a413dfaf2ef23733387675217c64e591/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d707265766965772d6f72616e6765) | [Announcement](https://www.espressif.com/en/products/socs/esp32-c61) |

There are variants of revisions for a series of chips. See [Compatibility Between ESP-IDF Releases and Revisions of Espressif SoCs](https://github.com/espressif/esp-idf/blob/master/COMPATIBILITY.md) for the details of the compatibility between ESP-IDF and chip revisions.

Espressif SoCs released before 2016 (ESP8266 and ESP8285) are supported by [RTOS SDK](https://github.com/espressif/ESP8266_RTOS_SDK) instead.

# Developing With ESP-IDF

## Setting Up ESP-IDF

See <https://idf.espressif.com/> for links to detailed instructions on how to set up the ESP-IDF depending on chip you use.

**Note:** Each SoC series and each ESP-IDF release has its own documentation. Please see Section [Versions](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/versions.html) on how to find documentation and how to checkout specific release of ESP-IDF.

### Non-GitHub forks

ESP-IDF uses relative locations as its submodules URLs ([.gitmodules](/espressif/esp-idf/blob/master/.gitmodules)). So they link to GitHub. If ESP-IDF is forked to a Git repository which is not on GitHub, you will need to run the script [tools/set-submodules-to-github.sh](/espressif/esp-idf/blob/master/tools/set-submodules-to-github.sh) after git clone.

The script sets absolute URLs for all submodules, allowing `git submodule update --init --recursive` to complete. If cloning ESP-IDF from GitHub, this step is not needed.

## Finding a Project

As well as the [esp-idf-template](https://github.com/espressif/esp-idf-template) project mentioned in Getting Started, ESP-IDF comes with some example projects in the [examples](/espressif/esp-idf/blob/master/examples) directory.

Once you've found the project you want to work with, change to its directory and you can configure and build it.

To start your own project based on an example, copy the example project directory outside of the ESP-IDF directory.

# Quick Reference

See the Getting Started guide links above for a detailed setup guide. This is a quick reference for common commands when working with ESP-IDF projects:

## Setup Build Environment

(See the Getting Started guide listed above for a full list of required steps with more details.)

* Install host build dependencies mentioned in the Getting Started guide.
* Run the install script to set up the build environment. The options include `install.bat` or `install.ps1` for Windows, and `install.sh` or `install.fish` for Unix shells.
* Run the export script on Windows (`export.bat`) or source it on Unix (`source export.sh`) in every shell environment before using ESP-IDF.

## Configuring the Project

* `idf.py set-target <chip_name>` sets the target of the project to `<chip_name>`. Run `idf.py set-target` without any arguments to see a list of supported targets.
* `idf.py menuconfig` opens a text-based configuration menu where you can configure the project.

## Compiling the Project

`idf.py build`

... will compile app, bootloader and generate a partition table based on the config.

## Flashing the Project

When the build finishes, it will print a command line to use esptool.py to flash the chip. However you can also do this automatically by running:

`idf.py -p PORT flash`

Replace PORT with the name of your serial port (like `COM3` on Windows, `/dev/ttyUSB0` on Linux, or `/dev/cu.usbserial-X` on MacOS. If the `-p` option is left out, `idf.py flash` will try to flash the first available serial port.

This will flash the entire project (app, bootloader and partition table) to a new chip. The settings for serial port flashing can be configured with `idf.py menuconfig`.

You don't need to run `idf.py build` before running `idf.py flash`, `idf.py flash` will automatically rebuild anything which needs it.

## Viewing Serial Output

The `idf.py monitor` target uses the [esp-idf-monitor tool](https://github.com/espressif/esp-idf-monitor) to display serial output from Espressif SoCs. esp-idf-monitor also has a range of features to decode crash output and interact with the device. [Check the documentation page for details](https://docs.espressif.com/projects/esp-idf/en/latest/get-started/idf-monitor.html).

Exit the monitor by typing Ctrl-].

To build, flash and monitor output in one pass, you can run:

`idf.py flash monitor`

## Compiling & Flashing Only the App

After the initial flash, you may just want to build and flash just your app, not the bootloader and partition table:

* `idf.py app` - build just the app.
* `idf.py app-flash` - flash just the app.

`idf.py app-flash` will automatically rebuild the app if any source files have changed.

(In normal development there's no downside to reflashing the bootloader and partition table each time, if they haven't changed.)

## Erasing Flash

The `idf.py flash` target does not erase the entire flash contents. However it is sometimes useful to set the device back to a totally erased state, particularly when making partition table changes or OTA app updates. To erase the entire flash, run `idf.py erase-flash`.

This can be combined with other targets, ie `idf.py -p PORT erase-flash flash` will erase everything and then re-flash the new app, bootloader and partition table.

# Resources

* Documentation for the latest version: <https://docs.espressif.com/projects/esp-idf/>. This documentation is built from the [docs directory](/espressif/esp-idf/blob/master/docs) of this repository.
* [Beginner's Guide to Key Concepts and Resources of ESP-IDF](https://youtu.be/J8zc8mMNKtc?feature=shared)
* The [esp32.com forum](https://esp32.com/) is a place to ask questions and find community resources.
* [Check the Issues section on github](https://github.com/espressif/esp-idf/issues) if you find a bug or have a feature request. Please check existing Issues before opening a new one.
* If you're interested in contributing to ESP-IDF, please check the [Contributions Guide](https://docs.espressif.com/projects/esp-idf/en/latest/contribute/index.html).

## About

Espressif IoT Development Framework. Official development framework for Espressif SoCs.

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/espressif/esp-idf/activity)
[Custom properties](/espressif/esp-idf/custom-properties)
### Stars

[**14.3k**
stars](/espressif/esp-idf/stargazers)
### Watchers

[**501**
watching](/espressif/esp-idf/watchers)
### Forks

[**7.4k**
forks](/espressif/esp-idf/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp-idf&report=espressif+%28user%29)

## [Releases 129](/espressif/esp-idf/releases)

[ESP-IDF Release v5.4
Latest

Jan 4, 2025](/espressif/esp-idf/releases/tag/v5.4)
[+ 128 releases](/espressif/esp-idf/releases)

## [Contributors 885](/espressif/esp-idf/graphs/contributors)

* [![@igrr](https://avatars.githubusercontent.com/u/4349050?s=64&v=4)](https://github.com/igrr)
* [![@projectgus](https://avatars.githubusercontent.com/u/205573?s=64&v=4)](https://github.com/projectgus)
* [![@jack0c](https://avatars.githubusercontent.com/u/21117421?s=64&v=4)](https://github.com/jack0c)
* [![@suda-morris](https://avatars.githubusercontent.com/u/8869469?s=64&v=4)](https://github.com/suda-morris)
* [![@mahavirj](https://avatars.githubusercontent.com/u/902446?s=64&v=4)](https://github.com/mahavirj)
* [![@ESP-Marius](https://avatars.githubusercontent.com/u/56995168?s=64&v=4)](https://github.com/ESP-Marius)
* [![@david-cermak](https://avatars.githubusercontent.com/u/38914379?s=64&v=4)](https://github.com/david-cermak)
* [![@ginkgm](https://avatars.githubusercontent.com/u/18559742?s=64&v=4)](https://github.com/ginkgm)
* [![@Icarus113](https://avatars.githubusercontent.com/u/32228133?s=64&v=4)](https://github.com/Icarus113)
* [![@dobairoland](https://avatars.githubusercontent.com/u/3954250?s=64&v=4)](https://github.com/dobairoland)
* [![@hfudev](https://avatars.githubusercontent.com/u/23117153?s=64&v=4)](https://github.com/hfudev)
* [![@Dazza0](https://avatars.githubusercontent.com/u/32921628?s=64&v=4)](https://github.com/Dazza0)
* [![@KonstantinKondrashov](https://avatars.githubusercontent.com/u/39947252?s=64&v=4)](https://github.com/KonstantinKondrashov)
* [![@mythbuster5](https://avatars.githubusercontent.com/u/28588580?s=64&v=4)](https://github.com/mythbuster5)

[+ 871 contributors](/espressif/esp-idf/graphs/contributors)

## Languages

* [C
  95.7%](/espressif/esp-idf/search?l=c)
* [Python
  2.1%](/espressif/esp-idf/search?l=python)
* [C++
  1.2%](/espressif/esp-idf/search?l=c%2B%2B)
* [CMake
  0.7%](/espressif/esp-idf/search?l=cmake)
* [Assembly
  0.3%](/espressif/esp-idf/search?l=assembly)
* [Shell
  0.0%](/espressif/esp-idf/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_58459e74_20250115_080307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp32-bt-lib)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp32-bt-lib)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=espressif%2Fesp32-bt-lib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[espressif](/espressif)
/
**[esp32-bt-lib](/espressif/esp32-bt-lib)**
Public

* [Notifications](/login?return_to=%2Fespressif%2Fesp32-bt-lib) You must be signed in to change notification settings
* [Fork
  43](/login?return_to=%2Fespressif%2Fesp32-bt-lib)
* [Star
   75](/login?return_to=%2Fespressif%2Fesp32-bt-lib)

ESP32 Bluetooth stack (below HCI layer) precompiled libraries

### License

[Apache-2.0 license](/espressif/esp32-bt-lib/blob/master/LICENSE)

[75
stars](/espressif/esp32-bt-lib/stargazers) [43
forks](/espressif/esp32-bt-lib/forks) [Branches](/espressif/esp32-bt-lib/branches) [Tags](/espressif/esp32-bt-lib/tags) [Activity](/espressif/esp32-bt-lib/activity)
 [Star](/login?return_to=%2Fespressif%2Fesp32-bt-lib)

 [Notifications](/login?return_to=%2Fespressif%2Fesp32-bt-lib) You must be signed in to change notification settings

* [Code](/espressif/esp32-bt-lib)
* [Pull requests
  0](/espressif/esp32-bt-lib/pulls)
* [Actions](/espressif/esp32-bt-lib/actions)
* [Projects
  0](/espressif/esp32-bt-lib/projects)
* [Security](/espressif/esp32-bt-lib/security)
* [Insights](/espressif/esp32-bt-lib/pulse)

Additional navigation options

* [Code](/espressif/esp32-bt-lib)
* [Pull requests](/espressif/esp32-bt-lib/pulls)
* [Actions](/espressif/esp32-bt-lib/actions)
* [Projects](/espressif/esp32-bt-lib/projects)
* [Security](/espressif/esp32-bt-lib/security)
* [Insights](/espressif/esp32-bt-lib/pulse)

# espressif/esp32-bt-lib

    master[Branches](/espressif/esp32-bt-lib/branches)[Tags](/espressif/esp32-bt-lib/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[335 Commits](/espressif/esp32-bt-lib/commits/master/) | | |
| [esp32](/espressif/esp32-bt-lib/tree/master/esp32 "esp32") | | [esp32](/espressif/esp32-bt-lib/tree/master/esp32 "esp32") |  |  |
| [.gitlab-ci.yml](/espressif/esp32-bt-lib/blob/master/.gitlab-ci.yml ".gitlab-ci.yml") | | [.gitlab-ci.yml](/espressif/esp32-bt-lib/blob/master/.gitlab-ci.yml ".gitlab-ci.yml") |  |  |
| [LICENSE](/espressif/esp32-bt-lib/blob/master/LICENSE "LICENSE") | | [LICENSE](/espressif/esp32-bt-lib/blob/master/LICENSE "LICENSE") |  |  |
| [README.rst](/espressif/esp32-bt-lib/blob/master/README.rst "README.rst") | | [README.rst](/espressif/esp32-bt-lib/blob/master/README.rst "README.rst") |  |  |
| View all files | | |

## Repository files navigation

* README
* Apache-2.0 license
# ESP32 BT/BLE Stack Libraries

This repository contains binary libraries supporting the ESP32 RF subsystems. It is used as a submodule within [Espressif IoT Development Framework](https://github.com/espressif/esp-idf) (ESP-IDF).

Files in this repository are Copyright (C) 2015-2016 Espressif Systems.

These binary libraries are provided under the same license as the parent esp-idf project - the Apache License 2.0 as provided in the file LICENSE. (The license text refers to this as "Object" form.)

## About

ESP32 Bluetooth stack (below HCI layer) precompiled libraries

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)

[Activity](/espressif/esp32-bt-lib/activity)
[Custom properties](/espressif/esp32-bt-lib/custom-properties)
### Stars

[**75**
stars](/espressif/esp32-bt-lib/stargazers)
### Watchers

[**17**
watching](/espressif/esp32-bt-lib/watchers)
### Forks

[**43**
forks](/espressif/esp32-bt-lib/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fespressif%2Fesp32-bt-lib&report=espressif+%28user%29)

## [Releases](/espressif/esp32-bt-lib/releases)

No releases published

## [Packages 0](/orgs/espressif/packages?repo_name=esp32-bt-lib)

No packages published

## [Contributors 27](/espressif/esp32-bt-lib/graphs/contributors)

[+ 13 contributors](/espressif/esp32-bt-lib/graphs/contributors)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.espressif.com_55623975_20250115_080307.html ===

[Skip to main content](#main-content)

[![Home](https://www.espressif.com/sites/all/themes/espressif/logo-black.svg)](/en "Home")
## Main menu

* [Home](/en)
* Hardware
  + Product Overview
    - [SoCs](/en/products/socs)
    - [Modules](/en/products/modules)
    - [DevKits](/en/products/devkits)
    - [Equipment](/en/products/equipment/production-testing-equipment/overview)
    - [Product Selector](https://products.espressif.com/#/product-selector?language=en)
  + ESP32-Wrap
    - ESP32-P
      * [ESP32-P4](/en/products/socs/esp32-p4 "A high-performing SoC offering extensive IO connectivity, HMI, and security features")
    - ESP32-S
      * [ESP32-S3](/en/products/socs/esp32-s3 "A powerful AI SoC with rich peripherals, ideal for HMI applications")
      * [ESP32-S2](/en/products/socs/esp32-s2 "A secure and Wi-Fi SoC with numerous I/O capabilities
        ")
    - ESP32-C
      * [ESP32-C6](/en/products/socs/esp32-c6 "A low-power Wi-Fi 6 SoC with enhanced connectivity")
      * [ESP32-C61](/en/products/socs/esp32-c61 "Delivering affordable Wi-Fi 6 connectivity")
      * [ESP32-C5](/en/products/socs/esp32-c5 "A 2.4 and 5 GHz dual-band Wi-Fi 6 RISC-V MCU")
      * [ESP32-C3](/en/products/socs/esp32-c3 "A cost-effective RISC-V SoC for secure IoT applications")
      * [ESP32-C2](/en/products/socs/esp32-c2 "A small-sized & cost-effective SoC for simple applications")
    - ESP32-H
      * [ESP32-H2](/en/products/socs/esp32-h2 "An 802.15.4 SoC for low power & secure connectivity")
    - ESP32
      * [ESP32](/en/products/socs/esp32 "A revolutionary Wi-Fi + Bluetooth SoC for IoT applications")
    - ESP8266
      * [ESP8266](/en/products/socs/esp8266 "Recommend upgrading to ESP32-C2 (ESP8684)")
* SDKs
  + [ESP-IDF](/en/products/sdks/esp-idf "Official IoT development framework")
    - [IDF Component Manager](https://components.espressif.com/)
  + [ESP-Matter SDK](https://www.espressif.com/en/solutions/device-connectivity/esp-matter-solution#sdk-for-matter "Simplified API and the required tools for building Matter-compatible devices")
  + [Zephyr® for Espressif](/en/sdks/esp-zephyr "Seamless IoT integration and optimized support")
  + [ESP-Arduino](/en/sdks/esp-arduino "Arduino IDE and development support for ESP32")
  + [ESP-AT](https://github.com/espressif/esp-at "AT commands to interface with ESP products")
    - [Overview](/en/products/sdks/esp-at/overview)
    - [Resources](/en/products/sdks/esp-at/resource)
  + [ESP-HOSTED](https://github.com/espressif/esp-hosted "Use ESP SoCs as communication co-processors")
  + [ESP-ADF](https://github.com/espressif/esp-adf "Official audio development framework")
  + [ESP-Mesh-Lite](/en/sdks/esp-mesh-lite "Mesh networking solution based on the Wi-Fi protocol")
  + [ESP HomeKit SDK](https://github.com/espressif/esp-homekit-sdk "Apple HomeKit-certified accessory development")
  + [ESP-BLE-MESH](/en/products/sdks/esp-idf/esp-ble-mesh "Fully SIG-Qualified Bluetooth Mesh Stack")
* Cloud
  + Special Menu
    - [ESP RainMaker®](https://rainmaker.espressif.com/ "Private AIoT Cloud platform with minimal coding and high security")
    - [ESP Insights](https://insights.espressif.com/ "A remote diagnostics solution to monitor the health of on-field devices")
  + Cloud Menu
    - ESP RainMaker®
      * [Homepage](https://rainmaker.espressif.com/)
      * [Product Brief](https://www.espressif.com/sites/default/files/RainMaker/ESP%20RainMaker%20Product%20Brief_EN.pdf)
      * [Tech Blogs](https://blog.espressif.com/rainmaker/home)
      * [Customer Stories](https://www.espressif.com/sites/default/files/RainMaker/ESP%20RainMaker%20Customer%20Story_EN.pdf)
    - ESP Insights
      * [Homepage](https://insights.espressif.com/)
      * [Tech Blogs](https://blog.espressif.com/esp-insights/home)
      * [Get Started](https://github.com/espressif/esp-insights#getting-started)
      * [Dashboard](https://dashboard.insights.espressif.com/)
    - Cloud Services
      * [Maintain & Iterate](/en/support/services)
      * [Tools Support](/en/support/services)
      * [Consult & Customize](/en/support/services)
    - Develop Resources
      * [Get Started](https://rainmaker.espressif.com/docs/intro/)
      * [GitHub Repository](https://github.com/espressif/esp-rainmaker)
      * Client APPs
        + [Nova Home (Source Code Available)](https://rainmaker.espressif.com/docs/nova-intro/)
        + [ESP RainMaker (Fully Open Source)](https://github.com/espressif/esp-rainmaker#phone-apps)
      * [Dashboard (Public)](https://dashboard.rainmaker.espressif.com/login)
    - Solution Integration
      * [Matter Fabric](https://www.espressif.com/en/news/RainMaker_Matter_Fabric "Quickly create your own Matter ecosystem")
      * [ESP-Mesh-Lite](/en/sdks/esp-mesh-lite "Cloud-based mesh device group control")
      * [AWS IoT ExpressLink](/en/solutions/device-connectivity/esp-aws-iot-expresslink "Build Cloud-connected devices with AWS IoT")
* Solutions
  + Special Menu
    - [ESP Matter Offerings](/en/solutions/device-connectivity/esp-matter-solution "SoCs, SDKs, and services for easy Matter device building")
  + Solutions Menu
    - Device Connectivity
      * [Remote Debugging Platform (ESP Insights)](https://insights.espressif.com/)
      * [ACK Solution (Alexa Connect Kit)](/en/solutions/device-connectivity/ack-solution)
      * [ACS Solution (Amazon Common Software)](/en/solutions/device-connectivity/acs-solution)
      * [ESP AWS IoT ExpressLink Solution](/en/solutions/device-connectivity/esp-aws-iot-expresslink)
    - Low-Power Solutions
      * [Wireless Communication Protocol (ESP-NOW)](/en/solutions/low-power-solutions/esp-now)
      * [ESP Smart Switch Solution](/en/solutions/low-power-solutions/esp-smart-switch)
    - HMI
      * [Smart Displays](/en/solutions/hmi/smart-displays)
    - Audio Solutions
      * [AVS Solution (Alexa Voice Services)](/en/solutions/audio-solutions/esp-avs)
      * [ESP Audio Front-End Algorithms](/en/solutions/audio-solutions/esp-afe)
    - AI Solutions
      * [Face Detection (ESP-WHO)](/en/products/devkits/esp-eye/overview?id=esp-who-wrap)
      * [Voice Assistant (ESP-SR)](/en/solutions/audio-solutions/esp-skainet/overview)
        + [Overview](/en/solutions/audio-solutions/esp-skainet/overview)
        + [Resources](/en/solutions/audio-solutions/esp-skainet/resources)
    - Peripherals
      * [Device Drivers](https://docs.espressif.com/projects/espressif-esp-iot-solution/en/latest/index.html)
      * [USB Solutions](/en/solutions/peripherals/usb-solutions)
* Support
  + [Technical Documents](/en/support/documents/technical-documents "Open-source datasheets, technical reference manuals, user guides, API references, test reports, and more!")
    - [All Types](/en/support/documents/technical-documents)
    - [SoCs](/en/support/download/documents/chips)
    - [Modules](/en/support/download/documents/modules)
    - [DevKits](/en/support/download/documents/development-board)
    - [Equipment](/en/support/download/documents/production-testing-equipment)
  + Services
    - [Self-Service Resources](/en/support/services)
    - [Open Software](/en/support/services)
    - [Hardware & RF](/en/support/services)
    - [Cloud](/en/support/services)
    - [Certification](/en/support/services)
    - [Manufacturing](/en/support/services)
    - [On-Site Assistance](/en/support/services)
  + Download
    - [SDKs & Demos](/en/support/download/sdks-demos)
    - [APPs](/en/support/download/apps)
    - [Tools](/en/support/download/other-tools)
    - [ESP-AT](/en/support/download/at)
  + Quality & Reliability
    - [Certificates](/en/support/documents/certificates)
    - [PCNs](/en/support/documents/pcns)
    - [Advisories](/en/support/documents/advisories)
    - [Longevity Commitment](/en/products/longevity-commitment)
  + FAQ
    - [ESP-FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/)
    - [Commercial FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/commercial-faq/index.html)
* Ecosystem
  + Partnership and Resource
    - [AWS Technology Partner](/en/ecosystem/partnership-and-resource/aws-advanced-technology-partner)
    - [Third-Party Platforms](/en/ecosystem/partnership-and-resource/third-party-platforms)
    - [Third-Party SDKs](/en/ecosystem/partnership-and-resource/third-party-sdks)
  + Developer Zone
    - [ESP Developer Portal](https://developer.espressif.com/)
    - [Espressif DevCon](https://devcon.espressif.com)
    - [Tech Blogs](https://medium.com/the-esp-journal)
    - [ESP32 Forum](https://www.esp32.com/)
  + Community
    - [Courses](/en/ecosystem/community-engagement/courses)
    - [Rust](https://github.com/esp-rs/esp-hal)
    - [Books](/en/ecosystem/community-engagement/books)
    - [Videos](/en/ecosystem/community-engagement/videos)
    - [Projects](/en/ecosystem/community-engagement/projects)
* Company
  + About Us
    - [About Espressif](/en/company/about-espressif)
    - [Milestones](/en/company/about-us/milestones)
    - [CEO Messages](/en/company/about-us/ceo-letter)
    - [Logo Guidelines](/en/about-espressif/logo-guidelines)
  + Newsroom
    - [News](/en/company/newsroom/news)
    - [Newsletter](/en/company/newsroom/newsletter)
    - [Tech Blogs](https://medium.com/the-esp-journal)
    - [Events](/en/company/newsroom/events)
  + Investor Relations
    - [Reports](/en/company/investor-relations/reports)
    - [Investor Inquiries](/en/company/investor-relations/investor-inquiries)
  + Corporate Responsibility
    - [Reports](/en/company/corporate-responsibility/reports)
    - [Wildlife Protection](/en/company/corporate-responsibility/wildlife-protection-program)
  + Join Us
    - [People at Espressif](/en/join-us/people-at-espressif)
    - [Campus Recruitment](/en/join-us/campus-recruitment)
    - [Open Positions](/en/join-us/job-search)
* Contact
  + [Contact Sales](/en/contact-us/sales-questions)
  + [Technical Inquiries](/en/contact-us/technical-inquiries)
  + [Circuit Schematic & PCB Design Review](/en/contact-us/circuit-schematic-pcb-design-review)
  + [Get Samples](/en/contact-us/get-samples)
  + [Become Our Supplier](/en/contact-us/become-our-supplier)
  + [Comments & Suggestions](/en/contact-us/comments-and-suggestions)

## Search form

Search

Search[EN](https://www.espressif.com/en/products/socs/esp32)[中文](https://www.espressif.com/zh-hans/products/socs/esp32)[Subscribe](https://www.espressif.com/en/subscribe)

* ![](/sites/default/files/banner/esp32-2-new.jpg)
  ![](/sites/default/files/banner/esp32-2-new-mobile-bg.jpg)
  # ESP32

  A feature-rich MCU with integrated Wi-Fi and
  Bluetooth connectivity for a wide-range
  of applications

## You are here

[Home](/en) » 硬件 » ESP32-Wrap » ESP32 » ESP32

* [Overview](#esp32-overview-wrap)
* [Products & Resources](#esp32-products-wrap)
* [Buy Now](#esp32-buy-now)

![](https://www.espressif.com/sites/default/files/hardware-feature/temperature_0.png)
Robust Design

ESP32 is capable of functioning reliably in industrial environments, with an operating temperature ranging from –40°C to +125°C. Powered by advanced calibration circuitries, ESP32 can dynamically remove external circuit imperfections and adapt to changes in external conditions.

![](https://www.espressif.com/sites/default/files/hardware-feature/battery_0.png)
Ultra-Low Power Consumption

Engineered for mobile devices, wearable electronics and IoT applications, ESP32 achieves ultra-low power consumption with a combination of several types of proprietary software. ESP32 also includes state-of-the-art features, such as fine-grained clock gating, various power modes and dynamic power scaling.

![](https://www.espressif.com/sites/default/files/hardware-feature/chip_0.png)
High Level of Integration

ESP32 is highly-integrated with in-built antenna switches, RF balun, power amplifier, low-noise receive amplifier, filters, and power management modules. ESP32 adds priceless functionality and versatility to your applications with minimal Printed Circuit Board (PCB) requirements.

![](https://www.espressif.com/sites/default/files/hardware-feature/wifi_0_1.png) ![](https://www.espressif.com/sites/default/files/hardware-feature/ble_0_0.png)
Hybrid Wi-Fi & Bluetooth Chip

ESP32 can perform as a complete standalone system or as a slave device to a host MCU, reducing communication stack overhead on the main application processor. ESP32 can interface with other systems to provide Wi-Fi and Bluetooth functionality through its SPI / SDIO or I2C / UART interfaces.

## Resources

[![](https://www.espressif.com/sites/default/files/hardware-resource/modules.png)
ESP32 Modules](https://www.espressif.com/en/products/modules/esp32)
[![](https://www.espressif.com/sites/default/files/hardware-resource/dev-kit.png)
ESP32 DevKits](https://www.espressif.com/en/products/devkits?id=ESP32)
[![](https://www.espressif.com/sites/default/files/hardware-resource/document_0.png)
Documents](https://www.espressif.com/en/support/documents/technical-documents)
[![](https://www.espressif.com/sites/default/files/hardware-resource/certificates_0.png)
Certificates](https://www.espressif.com/en/support/documents/certificates)
[![](https://www.espressif.com/sites/default/files/hardware-resource/get-sdk_0.png)
Get SDK](https://github.com/espressif/esp-idf/blob/master/README.md)
[![](https://www.espressif.com/sites/default/files/hardware-resource/technical-support.png)
Technical Support](http://espressif.com/en/company/contact/technical-inquiries-category)
[![](https://www.espressif.com/sites/default/files/hardware-resource/power-button.png)
Getting Started](https://esp-idf.readthedocs.io/en/latest/get-started/index.html)
[![](https://www.espressif.com/sites/default/files/hardware-resource/hardware-design-guide_0.png)
Hardware Design Guidelines](https://www.espressif.com/sites/default/files/documentation/esp32_hardware_design_guidelines_en.pdf)
[![](https://www.espressif.com/sites/default/files/hardware-resource/courses.png)
Courses](http://espressif.com/en/support/iot-college/courses?field_type_tid=13&field_course_language_tid=All)
[![](https://www.espressif.com/sites/default/files/hardware-resource/books.png)
Books](http://espressif.com/en/support/iot-college/books-new?field_type_tid=13&field_book_language_tid=All)
[![](https://www.espressif.com/sites/default/files/hardware-resource/videos.png)
Videos](https://www.espressif.com/en/ecosystem/iot-college/videos)
[![](https://www.espressif.com/sites/default/files/hardware-resource/forum.png)
ESP32 Forum](http://bbs.esp32.com/)

* [Technical Reference Manual›](https://www.espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf)
* [Flash Download Tools›](https://www.espressif.com/en/support/download/other-tools)
* [Certification and Test Demonstration›](https://www.espressif.com/en/support/download/other-tools)
* [Production Testing Guide›](https://www.espressif.com/sites/default/files/documentation/production_Testing_Guide__EN.pdf)
* [Production Testing Equipments›](https://www.espressif.com/en/products/equipment/production-testing-equipment/overview)
* [Espressif Services›](https://www.espressif.com/en/products/services)

[More Resources ›](https://www.espressif.com/en/products/socs/esp32/resources)

## Products

* ESP32 SoCs
* ESP32 Modules
* ESP32 DevKits

* [ESP32-D0WD-V3](/sites/default/files/documentation/esp32_datasheet_en.pdf)
* [ESP32-D0WDR2-V3](/sites/default/files/documentation/esp32_datasheet_en.pdf)
* [ESP32-U4WDH](/sites/default/files/documentation/esp32_datasheet_en.pdf)
* [ESP32-PICO-V3](/sites/default/files/documentation/esp32-pico-v3_datasheet_en.pdf)
* [ESP32-PICO-V3-02](/sites/default/files/documentation/esp32-pico-v3-02_datasheet_en.pdf)
* [ESP32-PICO-D4](/sites/default/files/documentation/esp32-pico-d4_datasheet_en.pdf)

![](/sites/all/themes/espressif/images/esp32-c6/esp32-c6-socs.png)

[See More SoCs](/en/products/socs?id=ESP32)

* [ESP32-WROOM-32E/32UE](/sites/default/files/documentation/esp32-wroom-32e_esp32-wroom-32ue_datasheet_en.pdf)
* [ESP32­-WROOM­-DA](/sites/default/files/documentation/esp32-wroom-da_datasheet_en.pdf)
* [ESP32-WROVER-E/IE](/sites/default/files/documentation/esp32-wrover-e_esp32-wrover-ie_datasheet_en.pdf)
* [ESP32-MINI-1/1U](/sites/default/files/documentation/esp32-mini-1_datasheet_en.pdf)
* [ESP32-PICO-MINI-02/02U](/sites/default/files/documentation/esp32-pico-mini-02_datasheet_en.pdf)
* [ESP32-PICO-V3-ZERO (ACK Module)](/sites/default/files/documentation/esp32-pico-v3-zero_datasheet_en.pdf)

![](/sites/all/themes/espressif/images/esp32-c6/esp32-c6-modules.png)

[See More Modules](/en/products/modules?id=ESP32)

* [ESP32-DevKitC](/en/products/devkits/esp32-devkitc)
* [ESP32-DevKitM-1](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/esp32/user-guide-devkitm-1.html)
* [ESP32-PICO-KIT](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/esp32/get-started-pico-kit.html)
* [ESP32-PICO-V3-ZERO-DevKit (ACK DevKit)](/en/solutions/device-connectivity/ack-solution)
* [ESP-EYE](/en/products/hardware/esp-eye/overview)
* [ESP32-Vaquita-DSPG](/en/products/devkits/esp-audio-devkits)
* [ESP32-LCDKit](https://docs.espressif.com/projects/espressif-esp-dev-kits/en/latest/esp32/esp32-lcdkit/user_guide.html)

![](/sites/all/themes/espressif/images/esp32-c6/esp32-c6-devkits.png)

[See More DevKits](/en/products/devkits?id=ESP32)

![](/sites/all/themes/espressif/images/esp32-buy-now.jpg)
## Buy Now

* [Ordering Information](https://www.espressif.com/sites/default/files/documentation/espressif_products_ordering_information_en.pdf)
* [Get Samples](/en/products/socs?id=ESP32)
* [Contact Us](/en/company/contact/pre-sale-questions-crm)

### Stay Informed with Us

Get the latest on innovations, product launches, upcoming events, documentation updates, PCN notifications, advisories, and more.

Subscribe

* PRODUCTS
* [SoCs](/en/products/socs)
* [Modules](/en/products/modules)
* [DevKits](/en/products/devKits)
* [Product Selector](https://products.espressif.com/#/product-selector)

* DEVELOPERS
* [Developer Portal](https://developer.espressif.com/)
* [ESP DevCon](http://devcon.espressif.com/)
* [Tech Blogs](https://medium.com/the-esp-journal)
* [News](/en/company/newsroom/news)

* COMPANY
* [About Espressif](/en/company/about-espressif)
* [Logo Guidelines](/en/about-espressif/logo-guidelines)
* [Sales Questions](/en/contact-us/sales-questions)
* [Work With Us](/en/join-us/job-search)

* RESOURCES
* [Tech Documents](/en/support/documents/technical-documents)
* [GitHub](https://github.com/espressif)
* [ESP-FAQ](https://docs.espressif.com/projects/espressif-esp-faq/en/latest/)
* [Get Samples](/en/contact-us/get-sample)

* [linkdin](https://www.linkedin.com/company/espressif-systems/)
* [youtube](https://www.youtube.com/channel/UCDBWNF7CJ2U5eLGT7o3rKog)
* [twitter](https://twitter.com/EspressifSystem)
* [facebook](https://www.facebook.com/espressif/)
* [ins](https://www.instagram.com/espressif_systems_official/)
* [github](https://github.com/espressif)

Copyright © 2024 Espressif Systems. All rights reserved.

[![](/sites/all/themes/espressif/images/gongan.png)](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011502019094)[沪ICP备2021026420号](https://beian.miit.gov.cn/)

* [Terms of Service](/en/content/terms-use)
* [Privacy Policy](/en/content/privacy)

690 Bibo Road Block 2 Suite 204, Zhangjiang Shanghai, China

## Languages

* [English](/en/products/socs/esp32)
* [简体中文](/zh-hans/products/socs/esp32)

 [![](/sites/all/themes/espressif/images/new-home/down.png?v=2)](https://www.espressif.com/en/contact-us/sales-questions)

![](https://px.ads.linkedin.com/collect/?pid=4339316&fmt=gif)
/



=== Content from dl.packetstormsecurity.net_4b35e9ff_20250115_080305.html ===
BRAKTOOTH: Causing Havoc on Bluetooth Link Manager

VULNERABILITY DISCLOSURE REPORT

By

Matheus E. Garbelini (SUTD)
Sudipta Chattopadhyay (SUTD)
Vaibhav Bedi (SUTD)
Sumei Sun (I2R, A*STAR)
Ernest Kurniawan (I2R, A*STAR)

Supported by

NRF NATIONAL SATELLITE OF EXCELLENCE IN TRUSTWORTHY SOFTWARE SYSTEMS
KEYSIGHT TECHNOLOGIES

August 31, 2021

BRAKTOOTH: Causing Havoc on Bluetooth Link Manager

Matheus E. Garbelini1; Sudipta Chattopadhyay1; Vaibhav Bedi1; Sumei Sun2; Ernest Kurniawan2

1Singapore University of Technology and Design

2I2R, A*STAR

1 Introduction

Bluetooth Classic (BT) protocol is a widely used wireless
protocol in laptops, handheld devices, and audio devices. BT
main procedures are shown in Figure 1 for reference. In the
past few years, Bluetooth has come under scrutiny due to
the discovery of several critical vulnerabilities. In this report,
we disclose BRAKTOOTH, a family of new security vulner-
abilities in commercial BT stacks that range from denial of
service (DoS) via ﬁrmware crashes and deadlocks in com-
modity hardware to arbitrary code execution (ACE) in cer-
tain IoTs. As of today, we have evaluated 13 BT devices from
11 vendors. We have discovered a total of 16 new security vul-
nerabilities, with 20 common vulnerability exposures (CVEs)
already assigned and four (4) vulnerabilities are pending
CVE assignment from Intel and Qualcomm.

All the vulnerabilities are already reported to the respective
vendors, with several vulnerabilities already patched and the
rest being in the process of replication and patching. More-
over, four of the BRAKTOOTH vulnerabilities have received
bug bounty from Espressif System and Xiaomi. An explo-
ration on Bluetooth listing [29] reveals that BRAKTOOTH
affects over 1400 product listings. BRAKTOOTH exposes fun-
damental attack vectors in the closed BT stack.

As the BT stack is often shared across many products,
it is highly probable that many other products (beyond the
≈1400 entries observed in Bluetooth listing) are affected by
BRAKTOOTH. Therefore, we suggest vendors producing BT
system-on-chips (SoCs), BT modules or BT end products to
use the BRAKTOOTH proof-of-concept (PoC) code to vali-
date their BT stack implementation. The availability of the
BRAKTOOTH PoC is discussed at the end of this report.

Why BrakTooth

The code name BrakTooth is the combination of two words:
1) Brak and 2) Tooth. While the word Tooth is clearly point-
ing towards Bluetooth targets, the word Brak is Norwegian
and translates to crash in English. The BrakTooth family of

Figure 1: An Illustration of the BT connection procedure.
FHS stands for Frequency Hopping Synchronization, ID
stands for Identity, LMP stands for Link Manager Protocol
and ACL stands for Asynchronous Connection Less.

vulnerabilities affect Bluetooth enabled devices by contin-
uously crashing or deadlocking them, while some result in
more serious consequences such as arbitrary code execution.

2 Attack Scenario Overview

Figure 2 showcases the generic scenario in which BRAK-
TOOTH attacks are performed. The attacker only requires (1)
a cheap ESP32 development kit (ESP-WROVER-KIT [33])
with a custom (non-compliant) LMP ﬁrmware and (2) a PC
to run the PoC tool. The PoC tool communicates with the
ESP32 board via serial port (/dev/ttyUSB1) and launches the
attacks according to the speciﬁed target BDAddress (<target
bdaddr>) and exploit name parameter (<exploit_name>).

Furthermore, the PoC tool logs over-the-air (OTA) packets
and checks the health of the target by getting a paging timeout
(no response) or alternatively getting status directly from the
target via a serial port, ssh connection, etc.

Due to some vendors having a ﬁxed release schedule, we
will release the Proof of Concept (PoC) tool publicly only at

1

MasterSlavePaging (FHS, ID Packets)(I) LMP informational requestsACL ConnectionInquiry (FHS, ID Packets)Accept host connection(II) LMP_host_connection_reqLMP_detach(III) Role SwitchLMP_accepted(IV) LMP Setup(V) pairing, authentication, encryptionOptionalFigure 2: An Illustration of BRAKTOOTH attack scenario

Table 1: Devices used for evaluation. The sample code is
provided by vendor to test the development board. This is not
applicable (N.A) on products running a ﬁxed application.

BT SoC Vendor

BT SoC

Dev. Kit / Product

Sample Code

AX200
WCN3990

Laptop Forge15-R
Xioami Pocophone F1

CC256XCQFN-EM
AC6366C_DEMO_V1.0

Bluetooth 5.2
Intel
Qualcomm
Bluetooth 5.1
Texas Instruments
CC2564C
Zhuhai Jieli Technology AC6366C
Bluetooth 5.0
CYW20735B1 CYW920735Q60EVB-01
Cypress
Bluetrum Technology
AB5301A
Zhuhai Jieli Technology AC6925C
Actions Technology
ATS281X
Bluetooth 4.2
Zhuhai Jieli Technology AC6905X
Espressif Systems
Bluetooth 4.1
Harman International
Bluetooth 4.0
Qualcomm
Bluetooth 3.0 + HS
Silabs

AB32VG1
XY-WRBT Module
Xiaomi MDZ-36-DB

BT Audio Receiver
ESP-WROVER-KIT

Laird DVK-BT900-SA

JBL TUNE500BT

DKWT32I-A

CSR 8811

JX25X

WT32i

ESP32

N.A
N.A

SPPDMMultiDemo
app_keyboard

rfcomm_serial_port
Default
N.A
N.A

N.A
bt_spp_acceptor

N.A

vspspp.server.at

ai-6.3.0-1149

the end of October 2021. This is the time when we expect
most vendors to have released their patches. In the meantime,
any BT semiconductor or module vendor can acquire the PoC
by ﬁlling up a simple form at the BRAKTOOTH PoC website.

3 Affected BT BR/EDR chipsets

31/08/2021: As of today, vulnerabilities V6, V15 and
V16 are pending CVE trackers. These vulnerabilities af-
fect Qualcomm and Intel which are vendors that can is-
sue CVEs by themselves (CVE Numbering Authorities -
CNA). However, their default policy is to issue CVEs only
after a patch has been distributed. Therefore, Table 2
will be updated accordingly once ﬁxes for V6, V15 and
V16 are available. Regarding the availability of patches,
when our team had contacted Intel, we were informed
that their next patch is scheduled to be released by the
end of October 2021. Similarly, we are also informed by
Qualcomm that their patch for V15 will take another few
months to be propagated.

A summary of BRAKTOOTH appears in Table 2. In each
row, we use the preﬁx V to identify a security vulnerability

2

and A to indicate an anomalous behaviour (i.e., faulty target
responses) that deviates from the Core Speciﬁcations [28].
Moreover, Table 2 outlines the respective CVEs, affected
devices, protocol layers, and the violated compliance. In sum-
mary, we discovered 16 new security vulnerabilities. For all
the discovered vulnerabilities, we have followed a respon-
sible disclosure process. Speciﬁcally, we have reached out
to the affected vendors and we have provided them at least
90 days until the public disclosure of this report. In most
cases, we have also actively helped the vendors to reproduce
the reported attacks at their end. Several vendors (e.g. Cy-
press, Bluetrum, Espressif) have already produced patches
with many in the process of producing them (e.g. Qualcomm,
Intel). The status of patches is discussed in Section 5.

The impact of our discovered vulnerabilities is categorized
into (I) crashes and (II) deadlocks. Crashes generally trig-
ger a fatal assertion, segmentation faults due to a buffer or
heap overﬂow within the SoC ﬁrmware. Deadlocks, in con-
trast, lead the target device to a condition in which no further
BT communication is possible. This may happen due to the
paging scan being forcibly disabled (V16), state machine
corruption on V6 or entirely disabling BT functionality via
arbitrary code execution (ACE) on V1. Our results affect
popular BT vendors (i.e, Intel, Qualcomm, Cypress, Texas
Instruments) and relatively less known (i.e., Bluetrum, Jieli
Technology, Harman), which are still employed in many con-
sumers products such as BT speakers, keyboards, toys, etc.

V1 affects ESP32, which is used in many products ranging
from consumer electronics to industrial equipment such as
programmable logic controllers (PLCs). Hence, the impact
is signiﬁcant, as the attacker only requires knowledge of the
target BDAddress to launch the attack. Indeed, all the vul-
nerabilities V1-V16 can be triggered without any previous
pairing or authentication. Moreover, the impact of V1-V16
reaches beyond the devices listed in Table 2, since any other
BT product employing an affected SoC is also vulnerable.

Multiple Link Manager Protocol (LMP) ﬂooding attacks
(e.g., V4, V12) and V15 were detected across SoCs from
different BT vendors. Since the affected vendors are majors
in their ﬁelds (i.e., Intel & Qualcomm), it indicates that there
is a lack of ﬂexible tools for over-the-air testing even in 2021.

ESP-WROVER-KIT (esp32driver firmware) BT Exploiter (PoC)/dev/ttyUSB1BR/EDR Target ./bt_exploiter --target=<target bdaddr> --exploit=<exploit_name>./firmware.py flash /dev/ttyUSB112Firmware (Non-Compliant LMP)Attacker PC (PoC)<target bdaddr>Table 2: Summary of new vulnerabilities and other anomalies found (Vx: Vulnerability, Ax: Non-compliance)

Anomalies

8.1 V1 Feature Pages Execution
8.2 V2 Truncated SCO Link Request
8.3 V3 Duplicated IOCAP

8.4 V4 Feature Resp. Flooding

8.5 V5 LMP Auto Rate Overﬂow

8.6 V6 LMP 2-DH1 Overﬂow
8.7 V7 LMP DM1 Overﬂow

Device(s)

CVE ID(s)
CVE-2021-28139
CVE-2021-34144 AC6366C_DEMO_V1.0
CVE-2021-28136

ESP-WROVER-KIT

CVE-2021-28135
CVE-2021-28155
CVE-2021-31717

CVE-2021-31609
CVE-2021-31612

ESP-WROVER-KIT
ESP-WROVER-KIT
JBL TUNE500BT
Xiaomi MDZ-36-DB
DKWT32I-A
BT Audio Receiver
DVK-BT900-SA

Pending
CVE-2021-34150 AB32VG1

8.8 V8 Truncated LMP Accepted

CVE-2021-31613

8.9 V9 Invalid Setup Complete

CVE-2021-31611

BT Audio Receiver
XY-WRBT Module
BT Audio Receiver
XY-WRBT Module

8.10 V10 Host Conn. Flooding
8.11 V11 Same Host Connection

CVE-2021-31785 Xiaomi MDZ-36-DB
CVE-2021-31786 Xiaomi MDZ-36-DB

8.12 V12 AU Rand Flooding

CVE-2021-31610
CVE-2021-34149
CVE-2021-34146
CVE-2021-34143

AB32VG1
CC256XCQFN-EM
CYW920735Q60EVB
AC6366C_DEMO_V1.0

8.15 V15 Invalid Timing Accuracy

CVE-2021-34147
Pending
Pending

8.13 V13 Invalid Max Slot Type
CVE-2021-34145 CYW920735Q60EVB
8.14 V14 Max Slot Length Overﬂow CVE-2021-34148 CYW920735Q60EVB
CYW920735Q60EVB
Pocophone F1 (WCN3990)
Intel AX200
Intel AX200
All tested devices
All, except ESP32
Xiaomi MDZ-36-DB
Pocophone F1 (WCN3990)
Intel AX200
DVK-BT900-SA
CYW920735Q60EVB

8.16 V16 Paging Scan Deadlock
A1 Accepts Lower LMP Length
A2 Accepts Higher LMP Length
A3 Multiple Encryption Start
A4 Ignore Role Switch Reject

Pending
N.A
N.A
N.A
N.A

A6 Ignore Encryption Stop

A5 Invalid Response

N.A

N.A

Besides, the Core Speciﬁcations only allows a limited "LMP
test mode" [28] that restricts the SoC to operate with few
LMP procedures.

4 Impact of BRAKTOOTH

We created different concrete attacks leveraging the BRAK-
TOOTH vulnerabilities. In the following, we show three such
sample attacks that launch arbitrary code execution (ACE) or
Denial of Service (DoS) on target devices.

4.1 Arbitrary Code Execution in IoTs

The most critical vulnerability (V1 in Table 2 - 8.1) affects
ESP32 SoC [32], which is used in many Wi-Fi and Bluetooth
IoT appliances such as Industry Automation, Smart Home,
Fitness, etc. The attack is illustrated in Figure 3. A lack of
out-of-bounds check in ESP32 BT Library [10] allows the re-
ception of a mutated LMP_feature_response_ext. This results
in the injection of eight bytes of arbitrary data outside the
bounds of Extended Feature Page Table ("E. Features Table"
in Figure 3). An attacker, which knows the ﬁrmware layout
of a target device, can write a known function address (JMP
Addr.) to the offset pointed by Features Page ("Feat. Page" in
the LMP_feature_response_ext packet) ﬁeld. It turns out that
the BT Library stores some callback pointers within the out-
of-bounds Features Page offset and such a callback is even-

State(s)

Feature Exchange
After Paging
Bounding

Target Layer(s)
LMP
LMP
LMP

Impact Type
ACE / Deadlock
Deadlock
Crash

Compliance Violated

[V.1] Part E, Sec. 2.7
[V.2] Part E, Sec. 2.7
[V.2] Part C, Sec. 4.2.7.1

After Paging

LMP

Crash

[V.1] Part E, Sec. 2.7

Data Rate Change

After EDR Change
Many

Many

Feature Exchange

Host Connection
Host Connection

After Paging

Baseband

Baseband
Baseband

LMP

LMP

LMP
LMP

LMP

After Setup Complete
After Setup Complete

Baseband
Baseband

Timing Accuracy

LMP, Baseband

Crash

[V.2] Part B, Sec. 6.6.2

Deadlock
Deadlock

[V.2] Part C, Sec. 2.3
[V.2] Part B, Sec. 6.5.4.1

Crash

[V.2] Part C, Sec. 5.1

Deadlock

[V.1] Part E, Sec. 2.7

Deadlock
Deadlock

Crash
Deadlock

Crash
Crash

Crash

[V.1] Part E, Sec. 2.7
[V.1] Part E, Sec. 2.7

[V.1] Part E, Sec. 2.7

[V.1] Part E, Sec. 2.7
[V.1] Part E, Sec. 2.7

[V.1] Part E, Sec. 2.7

After Host Connection
Many
Many
After Encryption Start
Role Switch

Feature Exchange

After Encryption Start

LMP, Baseband
Baseband
Baseband
LMP
LMP

Deadlock
Non-Compliance
Non-Compliance
Non-Compliance
Non-Compliance

[V.1] Part E, Sec. 2.7
[V.2] Part C, Sec. 5.1
[V.2] Part C, Sec. 5.1
[V.2] Part C, Sec. 4.12
[V.2] Part C, Sec. 4.4.2

LMP

LMP

Non-Compliance

[V.2] Part C, Sec. 4.3.4

Non-Compliance

[V.2] Part C, Sec. 4.2.5.4

tually invoked during the BT connection. While exploiting
this vulnerability, we forced ESP32 into erasing its NVRAM
data (normally written during product manufacturing) by set-
ting JMP Addr. to the address of nvs_ﬂash_erase. Such erase
function is always included in ESP32 SDK [8] and there-
fore, it is present in any ESP32 ﬁrmware. Similarly, disabling
BT or BLE can be done via esp_bt_controller_disable and
Wi-Fi via disable_wiﬁ_agc. Additionally, general-purpose
input/output (GPIO) can be controlled if the attacker knows
addresses to functions controlling actuators attached to ESP32.
As expected, this has serious implications if such an attack is
applied to Bluetooth-enabled Smart Home products.

Figure 3: An Illustration of CVE-2021-28138.

3

BBACL  Hdr.Feat. PageMax PageE. FeaturesIoT (ESP32) Firmware62 (bad)02JMP Addr.User Data (NVRAM)BLE / Wi-FiActuator (GPIO)LMP Packet - LMP_feature_response_extBD/EDR BT LibraryE. Features Table0x01 0x020x62Page 1. Page 2.BT CallbacksOut-of-bounds Features WriteJMP Addr.EraseDisableON/OFFAir Interface4.2 DoS in Laptops & Smartphones

We discuss two sample DoS attacks discovered on laptops
and smartphones employing Intel AX200 SoCs [17] and Qual-
comm WCN3990 SoC [30]. Due to the number of smartphones
and laptops vulnerable to such attacks, and the common use
of BT connectivity during video conference calls and music
streaming, updating the affected devices is essential.

The ﬁrst DoS (Invalid Timing Accuracy - 8.15) is due to
a failure in the SoC to free resources upon receiving an in-
valid LMP_timing_accuracy_response from a BT slave. The
attacker can exhaust the SoC by (a) paging, (b) sending the
malformed packet, and (c) disconnecting without sending
LMP_detach. These steps are repeated with a different BT
address (i.e., BDAddress) until the SoC is exhausted from
accepting new connections. On exhaustion, the SoC fails to
recover itself and disrupts current active connections, trigger-
ing ﬁrmware crashes sporadically. This vulnerability allows
an attacker to forcibly disconnect slave BT devices currently
connected to AX200 under Windows or Linux Laptops. Simi-
larly, Android phones such as Pocophone F1 and Oppo Reno
5G [22] experience BT disruptions. For example, users con-
nected to BT Headsets experience audio to be continuously
"cut" during the attack. This also results in ﬁrmware crashes
and restart of Android BT Service. In all cases, the OS tries
to recover connectivity which can be continuously disrupted.
The second DoS (Paging Scan Disable - 8.16) affects
only devices using Intel AX200 and it is triggered when an
oversized LMP_timing_accuracy_request (>17 bytes) is sent
to AX200 slave. This temporarily corrupts AX200 ﬁrmware,
which responds incorrectly during a subsequent BT connec-
tion and eventually disables the paging scan procedure (cf.,
Figure 1). Thus, scanning AX200 works, but no connection is
established from an external BT device. Therefore, this attack
can be used to trick an user to connect to the attacker’s BT
hardware instead of the legitimate target since AX200 paging
scan is disabled. Indeed, the user needs to manually re-enable
BT to restore functionality. The attack is also used to dis-
connect certain master BT devices connected to a vulnerable
Laptop. This leads to sporadic BT ﬁrmware crashes.

4.3 Freezing Audio Products

Many vulnerabilities were discovered while testing with a BT
Speaker (Mi Portable Bluetooth Speaker - MDZ-36-DB [37]),
BT Headphone (JBL TUNE 500BT [18]) and BT Audio Mod-
ules (XY-WRBT [25] and an unbranded BT Audio Receiver).
The discovered vulnerabilities arise from failures when send-
ing oversized LMP packets (LMP Auto Rate Overﬂow -
8.5), truncated packets (Truncated LMP Accepted - 8.8),
starting procedures out-of-order (Invalid Setup Complete -
8.9) and ﬁnally by ﬂooding LMP packets (Feature Response
Flooding - 8.4).

The vulnerabilities can "freeze" Xiaomi MDZ-36-DB and

completely shut down JBL TUNE 500BT. This requires the
user to manually turn on the unresponsive devices. Since
both devices accept multiple BT connections, an attack can
be triggered while the user is playing some music. As an
exception, XY-WRBT and BT Audio Receiver accept only one
connection, which avoids an attack to be launched during an
active BT connection with the user. Nevertheless, different
products employing the same SoC may enable multiple BT
connections depending on the product requirements.

Although issues were found in SoCs targeted to Audio
products, the BT Implementation can be reused in a number
of SoCs destined to different BT products. Hence, our discov-
eries are not limited to the type of products discussed in this
section, but rather to the LMP stack implementation.

4.4 Estimating the Scope of BRAKTOOTH

In this section, we measure the potential impact of BRAK-
TOOTH vulnerabilities. To this end, we estimate the number
of product listings employing the affected BT chipsets. Each
listing may contain one or multiple (up to hundreds) products
from the same company. We get such an estimated number by
querying the Bluetooth Listings Website [29]. In particular,
we use the qualiﬁcation IDs (QIDs) of each affected SoCs to
get their corresponding products listings. The total number of
potentially affected product listings is illustrated in Table 3. In
summary, as of August 23, 2021, the total number of listings
affected is over 1400. We note that even if the number of
listings for a major vendor such as Intel seems low, its listings
have up to hundreds of product models referenced by popular
PC brands such as HP, Asustek, Dell, etc.

Table 3: Number of product listings with respect to BT SoC.

Vendor

SoC

QID(s)

AX200
Intel
CC2564C
Texas Instruments
CYW20735B1
Cypress
Bluetrum Technology
AB32VG1
Zhuhai Jieli Technology AC6905X
Zhuhai Jieli Technology AC6925C
Zhuhai Jieli Technology AC6366C
ATS281X
Actions Technology
WCN3990/8
Qualcomm
CSR8811/CSR8510
Qualcomm
ESP32
Espressif Systems
JX25X
Harman International
Silabs
WT32i
Total Listings

127398
87924, 126789, 117855
169362, 112768
115952, 131655
91274
110839
136145
124400, 124265
96248, 116819
30846, 58778, 70941
116661 (ESP32 Dual-Mode Stack)
84803, 62232
49552

Listing(s) Count
17*
14
1
201
341
376
173
47
22
92
28
63
48
1423

It is worthwhile to mention that while we can get the total
number of registered products within Bluetooth Listings web-
site for a certain chipset QID, it only reveals a lower-bound
of the exact total number of listings employing a particular
chipset. This is because product vendors may choose to cus-
tomize the design. In this case, the QID of the employed
chipset or BT stack is written to a ﬁeld called Combined
Designs. Unfortunately, the Bluetooth Listings site do not
cross-reference Combined Designs when searching for a QID,
which makes it almost impossible to get the total number of

4

products employing a particular chipset. Furthermore, prod-
ucts employing modules derived from chipsets such as ESP32,
CSR8811, etc are also not shown during the search of a chipset
QID.

In conclusion, the total number of individual product mod-
els that are potentially affected by BRAKTOOTH could be
an order of magnitude higher than the listings estimated in
Table 3.

Table 4: Sample products using SoCs affected by BRAK-
TOOTH. The declaration ID references each product on the
Bluetooth Listing search website [29].

Product Vendor

Product Type

Microsoft

Laptop

Dell

Sony
Oppo
Ericsson

Desktop PC /
Laptop

Smartphone
Smartphone
Home Entertainment Hub

Volvo Technology Automotive Infotainment

Hella GmbH

Electronic Control Unit

Walmart Stores

Audio

Walmart Stores

Panasonic

Audio

Audio

Becker Avionics

Aircraft Entertainment System

u-box
Koyo Electronics

Industrial IoT Module
PLC (Industrial Automation)

Intel AX200

Intel AX200

SoC Model

WCN3990
WCN3998
CSR8510

Product Model
Surface Laptop 3
Surface Go 2
Surface Pro 7
Surface Book 3
Optiplex 5070
Alienware M17 R3
(Many more)
Xperia XZ2
Reno 5G CH1921
KDE20102
Volvo FH
(Many More)
PMP3
Disco Lamp Speaker
(Many More)
Small rugged speaker
(Many More)
Sound Bar SC-HTB100 ATS281X
AMU6500
(More)
NINA-W106
C2-02CPU

ESP32
ESP32

CC2564C

ATS281X

WT32i

Declaration ID

D048122

D044215

D048452
D044072
D054397

D044076

D048582

D053923

D044945

D050596
D050601

CSR8811/510 D053903

Jieli AC63XX D049113

From the listings shown in Table 3, we capture some in-
teresting products employing the vulnerable chipsets and list
them in Table 4. The observed types of products range from
audio appliances (BT Speakers, headsets, ambience, etc) to
personal PC/laptop computers, smartphones, and surprisingly
even automotive multimedia electronic control units (PMP3),
automotive infotainment systems (Volvo FH) and in-ﬂight
audio systems such as AMU6500. Notably Volvo FH and
AMU6500 are employing Qualcomm CSR8811/510 and Sil-
abs WT32i chipsets, respectively. As discussed in Section 5,
the Qualcomm CSR8811/510 is unlikely to receive a patch
(affected by V6) and we are not able to receive a response
from Silicon Labs regarding their status of the investigation
on Silabs WT32i (affected by V5).

4.5 Product Design Considerations

It is important to clarify that any product employing a vul-
nerable Bluetooth chipset, is not necessarily insecure (nev-
ertheless, affected due to BT connectivity being impaired).
The overall security of an end-product, which has an inter-
nal chipset with ﬁrmware ﬂaws, depends on how much the
product relies on such a vulnerable chipset for its main func-
tionality.

Figure 4 showcases common BT product design strategies

and their dependency on the BT chipset or stack.
1. In the Isolated Design, products may have their main pro-
cessor application (Product SW) communicating with a stan-
dalone BT chipset via a simplistic interface (e.g., serial AT

5

Figure 4: Examples of Bluetooth Product Design

commands, SPI/I2C transfers, etc). Such products may not
need targeted handling of vulnerabilities in the BT stack and
therefore are less impacted by a vulnerable BT chipset. This
means that BT vulnerabilities are not likely to affect the Prod-
uct SW or at least, the design allows to fully isolate attacks
coming from a vulnerable chipset. WT32i is an example of
such a BT Standalone chipset.

2. In between, a Mixed Design, which shares the BT stack
between the main processor and the BT controller, are some-
what susceptible to attacks on the speciﬁc part of the BT stack.
Since BRAKTOOTH affects the BT Baseband or LMP imple-
mentation, the host stack is not affected directly. However,
since both the BT Controller Stack and the BT Host Stack are
continuously communicating depending on what happens in-
side the BT Controller, issues on the Product SW could arise
if the HCI interface hangs. HCI interface may also misbe-
have in terms of whether the BT Controller provides expected
responses or not. Therefore, it is up to the product software
designer to investigate and handle all potential issues that can
arise in the BT host stack. In general, this involves signiﬁcant
expertise and cannot be easily derived. The Mixed Design
choice was unfortunately observed to affect products that rely
on MSP432 as the main processor and Texas Instruments
CC2564C as the BT controller when we had tested a sam-
ple code from TI’s BT stack (CC2564CMSP432BTBLESW1
(v4.2.1.1) + Service pack v1.4). In this context, attack V5 (8.5)
causes a temporary hang on MSP432, which could cause an
impact on the underlying product. In contrast, operating sys-
tems in smartphones and laptops have a mature mechanism to
handle BT controller hardware errors originated from attacks
in the BT controller. See Section 4.2 where we illustrate the
impact of BRAKTOOTH attacks on smartphones and laptops.

3. Lastly, we have the Fully Integrated Design, which is an
obvious choice for cost reduction and is widely deployed for
IoTs, speakers, headphones, and computer accessories. This
design is susceptible to BRAKTOOTH hangs, crashes, and
RCE directly on the main product functionalities. Such is due
to both the Product SW and BT Stack being coexistent on the

Main Processor (CPU)Bluetooth Chipset (BT Standalone)Simple CommunicationProduct SW Full BT Stack (e.g., SPP)Main Processor (CPU)Bluetooth Chipset (BT Controller)HCI CommunicationProduct SWBT ControllerStackBT Host StackSerial/SPI/I2CSerial/USBMain Processor (CPU)Bluetooth Chipset (Full Standalone)Internal APIFull BT Stack (e.g., A2DP)Product SW Isolated DesignMixed (Default) DesignFull Integrated DesignDependency on the BT Chipset or StackTable 5: Patching status, Vulnerabilities and SDK/Firmware version of affected devices.

* Contact vendor to acquire the patch.

BT SoC

Firmware or SDK Ver.

SoC or Module Vendor
Espressif Systems

Intel

ESP32

AX200

WCN3990/8
Qualcomm
CSR8811/CSR8510
Qualcomm
CC2564C
Texas Instruments
CYW20735B1
Inﬁneon (Cypress)
Bluetrum Technology
AB5301A
Zhuhai Jieli Technology AC6925C
Zhuhai Jieli Technology AC6905X
Zhuhai Jieli Technology AC6366C
ATS281X
Actions Technology
JX25X
Harman International
WT32i
Silabs

Vuln. / Anomalies
V1,V3-4 / A1

V15-16 / A1-2, A5

esp-idf-4.4
Linux - ibt-12-16.ddc
Windows - 22.40.0
crbtfw21.tlv, patch 0x0002
v9.1.12.14
cc256xc_bt_sp_v1.4
WICED SDK 2.9.0
V06X_S6645 (LMP Subver. 3)
unspeciﬁed (LMP Subver. 12576) V8-9 / A1-2
unspeciﬁed (LMP Subver. 12576) V5,V8-9 / A1-2
V2,V12 / A1-2
fw-AC63_BT_SDK 0.9.0
unspeciﬁed (LMP Subver. 5200)
V4,V10-11 / A1-2
unspeciﬁed (LMP Subver. 5063)
V4 / A1-2
V5 / A1-2
iWRAP 6.3.0 build 1149

V15 / A1-2,A4
V6 / A1-2
V12 / A1-2
V12-15 / A2,A6
V7,V12 / A1-2

Patch Status
[11] Available

Patch in progress

Patch in progress
No ﬁx
No ﬁx
Available *
Available *
Investigation in progress
Investigation in progress
Patch in progress
Investigation in progress
Pending
Pending

same hardware. This is exempliﬁed by V1 attack (8.1), which
affects ESP32 running Bluedroid BR/EDR stack.

To conclude, the assessment of a product based on its de-
pendency on the BT chipset is a fundamental approach to
understand and calculate the ﬁnal risk factors. Nevertheless,
since BRAKTOOTH affects the lower layers of several BT
implementations, at least BT connectivity is impaired regard-
less of the design choice. Therefore, this should be taken into
consideration when evaluating the product risks. Speciﬁcally,
it needs to be evaluated whether a stable BT connectivity is
always required for the assessed product to properly function.

5 BT Firmware Patches

Table 5 captures the affected vendors and the status of their
investigation. We categorize the status of the investigation in
the following forms:

• Available: The vendor has replicated the vulnerability

and a patch is available.

• Patch in progress: The vendor has successfully repli-
cated the vulnerability and a patch for the same will be
available soon.

• Investigation in progress: The vendor is currently in-
vestigating the security issue and our team is assisting
them.

• No ﬁx: The vendor has successfully replicated the issue,

but there is no plan to release a patch.

• Pending: The vendor hardly communicated with the
team and the status of their investigation is unclear at
best.

other vendors are currently at the stage of investigation or
patch development of the reported issues. We are working
with the vendors to help them reproduce the issues in their
systems such that patches are available to the public.

The vendor Texas Instruments has successfully replicated
the security issue, however, at this stage has no plan for pro-
ducing a patch. In particular, according to the Texas Instru-
ments PSIRT team, they will consider producing a patch only
if demanded by customers.

Our team approached Qualcomm to inquire whether a patch
would be available for the affected devices. We were informed
that they are working on a ﬁx for WCN3990/8 and that the
security issue reported in Qualcomm CSR8811A08 [24] has
been ﬁxed since 2011 only for ROM Versions A12 and beyond.
However, new products in 2021 are still being listed to use
CSR8811A08, which has no plan to be ﬁxed. Moreover, a
patch for the issue on CSR8510A10 [23] that causes V6 (see
Section 8.6) is not possible for CSR8510A10 due to the lack
of ROM patch space.

Zhuhai Jieli Technology conﬁrmed that a ﬁx for
AC6366C [35] would be released soon, but they did not con-
ﬁrm whether a patch would also be available to their other
audio devices AC6925C and AC6905X. Finally, we notice
for certain vendors (e.g. Harman International, Silabs), the
investigation status is unclear, as indicated by the Pending
status in Table 5.

6 Snifﬁng BT BR/EDR in less than $15

As part of our work of reverse engineering ESP32 BT stack,
we are releasing to the community a low-cost BT Classic
(BR/EDR) Active Sniffer which is available at the following
URL:

We observe that Espressif Systems, Inﬁneon (former Cy-
press) and Bluetrum have so far produced the patches. All

https://github.com/Matheus-Garbelini/esp32_bluetooth_
classic_sniffer

6

At the time of writing, this is the cheapest BR/EDR active
sniffer, we are aware of due to the low price of ESP32 boards.
ESP32-PICO-KIT can be purchased for $14.80 [21], but it is
possible to ﬁnd alternative ESP32 boards on Aliexpress for
as low as $4 [9].

Note that differently than passive sniffers, which does not
interact with the network, the ESP32 active sniffer must act
as either a BT Master or Slave device within the BT piconet.
As exempliﬁed in Figure 5, the sniffer logs BT BR/EDR
OTA protocols such as Baseband header, FHS, LMP, and
ACL packets. The sniffer cannot be used to inject packets at
the moment due to the PoC embargo. The embargo will be
lifted at the end of October 2021 and our full PoC tool will be
made available to the public for research and reproduction.

Figure 5: Active BR/EDR Snifﬁng of piconet. The sniffer
captures Baseband + FHS and LMP frames.

7 Reﬂection

In recent years, Bluetooth has come under scrutiny due to sev-
eral design and implementation level vulnerabilities, such
as KNOB [3], BIAS [2], SweynTooth [14], BLESA [36],
BlueMirror [6], etc. Our previous disclosure of Sweyn-
Tooth [14] vulnerabilities (2020) has clearly indicated the
lack of basic tests in Bluetooth certiﬁcation to validate the
security of Bluetooth Low Energy (BLE) devices. The BRAK-
TOOTH family of vulnerabilities revisits and reasserts this
issue in the case of the older, but yet heavily used Bluetooth
classic (BR/EDR) protocol implementations. Additionally,
during the responsible disclosure period, we had the follow-
ing observations that might shed light on the future research
in Bluetooth security.

7

Replication difﬁculty: Bluetooth Core Speciﬁcations allows
a limited "LMP test mode" [28]. This limits the vendors to
operate with only a few LMP procedures and therefore, the
vendors are unlikely to have full control over the messages
exchanged over all LMP procedures without expensive certi-
ﬁcation hardware. All BRAKTOOTH vulnerabilities V1-V16
involve speciﬁc mutation or duplication to create potentially
unexpected scenarios in the Bluetooth link manager (see Sec-
tion 8 for details). We postulate that due to the lack of tools (or
ﬂexibility thereof) to control all LMP procedures, BT devices
were not tested thoroughly on such uncommon scenarios. This
is also evident during our communication even with popular
BT vendors (e.g. Intel, Cypress, and Qualcomm). Speciﬁ-
cally, in contrast to our disclosure of SweynTooth [14] vul-
nerabilities, we experienced the following crucial differences:
1) The replication of BRAKTOOTH vulnerabilities involves
signiﬁcantly more interaction with the vendors. In the past,
our experience with BLE vendors suggests that they were
able to use in-house tools (without using our custom fuzzer)
to replicate the SweynTooth vulnerabilities. However, while
replicating BRAKTOOTH, vendors had to use the exact setup
used to discover BRAKTOOTH vulnerabilities. This involves
the usage of the ESP32 device, the custom LMP ﬁrmware and
the BRAKTOOTH PoC tool (see Figure 2). We believe such
is the case due to the lack of BT tooling for comprehensively
testing the security of Bluetooth link manager implementa-
tions under unexpected packet exchanges. Thankfully, our
PoC brings the control over LMP to the host, dismissing the
need to change the BT ﬁrmware just to create speciﬁc test
cases. This approach was inspired from our previous work
with the "SweynTooth Non-Compliant BLE Controller" [14].

Downstream dependency: During the responsible disclo-
sure period, we experienced that it is impossible for certain
BT module vendors to produce a patch due to their depen-
dency on downstream vendors. Speciﬁcally, this was observed
while reporting the vulnerability V6 (LMP 2-DH1 Overﬂow)
for Laird BT900 and BT820 SoC devices. A discussion with
Laird Technologies, Inc. revealed that the underlying LMP
Stack used by both BT900 (CSR8811) and BT820 (CSR8510)
devices is Stonestreet One’s Bluetopia stack (currently ac-
quired by Qualcomm) and the rectiﬁcation of V6 requires
the support of Qualcomm. After a discussion between our
team and Laird Connectivity, it was revealed (from Laird Con-
nectivity contacting Qualcomm internal support forum) that
the CSR8811 has no patch space available and therefore, the
vulnerability V6 is not possible to ﬁx. In other words, any de-
vices using CSR8811, including but not limited to BT900 and
BT820 SoC devices, are likely to remain vulnerable forever.
This clearly shows the complexity of resolving IoT vulner-
abilities due to the downstream dependencies on multiple
vendors. The implication of such a problem is not trivial to
gauge. Considering that certain devices may remain vulnera-
ble for a prolonged time, it is advised that the IoT module and
product vendors conduct a thorough risk assessment. This is

particularly important if the target module or product uses
a vulnerable component where patching is difﬁcult due to
software lock-down (similar to CSR8811).

Reverse engineering effort: During our research on Blue-
tooth Link Manager testing, we clearly observe the gap of
security testing tools to validate arbitrary BT devices. While
there exists emulation-based approaches [26], these works
need to spend signiﬁcant effort in reverse engineering the
target devices (if at all possible). The absence of any open
source and feature-complete Bluetooth LMP stack further
complicates the security testing problem. During our research,
we have designed a fuzzing interface by reverse-engineering
the ESP32 BT stack which is located in the static library
libbtdm_app.a [10] and ESP32 ROM memory. The reverse en-
gineering effort was utilized to design a (non-compliant) LMP
ﬁrmware that can be used off-the-shelf to validate any devices
with BR/EDR functionality. While the reverse-engineering
effort of a commodity BT stack was signiﬁcant, we believe
that the effort was fruitful and necessary in comprehensively
analysing the security of any BT implementations in the wild.
As discussed in the preceding paragraphs, we also experienced
that even major industries lack ﬂexible tools for comprehen-
sively testing BT Link Managers.

8 Vulnerabilities Description

In this section, we provide a detailed description of each vul-
nerability, the affected system-on-chip (SoC) models and the
SDKs where applicable. Some vulnerabilities were discov-
ered when testing developments kits and others were detected
by testing ﬁnal products (e.g. speakers or headphones).

8.1 V1: Feature Pages Execution

(CVE-2021-28139)

The Bluetooth Classic implementation in Espressif ESP-IDF
4.4 and earlier [8] does not properly restrict the Feature Page
upon reception of an LMP Feature Response Extended packet,
allowing attackers in radio range to trigger arbitrary code ex-
ecution (ACE) in ESP32 via a crafted Extended Features
bitﬁeld payload. As shown in Figure 6, the ACE vulnerabil-
ity is triggered by simply sending LMP_feature_res_ext with
an invalid feature page of 0x62 after LMP Setup procedure
(c.f., Figure 1). Moreover, the contents of extended features
in the LMP_feature_res_ext can be used to execute code at
an arbitrary address within the ESP32 ﬁrmware. For exam-
ple, as described in Section 4.1, such an address may point
to the erase function (nvs_ﬂash_erase) and disabling Wi-Fi
(disable_wiﬁ_agc), among others.

Impact: The attacker is able to execute arbitrary functions
implemented in the target ESP32’s ﬁrmware. Once the at-
tacker acquires a dump of ESP32 ﬁrmware and the memory
layout is known, functions at arbitrary addresses can be called.

This allows the attacker to erase user data (NVRAM), call I/O
functions that may control actuators, etc. Triggering ﬁrmware
crashes or a BT deadlock is also possible during repeated
attack attempts by executing invalid function addresses. In
case of a deadlock, the user needs to manually reset ESP32 to
restore BT communications.

Figure 6: Feature Page Execution

8.2 V2: Truncated SCO Link Request

(CVE-2021-34144)

The Bluetooth Classic implementation in the Zhuhai Jieli
AC6366C BT SDK 0.9.1 and earlier [35] does not properly
handle the reception of truncated LMP_SCO_Link_Request
packets while no other BT connections are active. This allows
attackers in radio range to prevent new BT connections (dis-
abling the AC6366C inquiry and page scan procedures) via
a crafted LMP packet. The user needs to manually perform
a power cycle (restart) of the device to restore BT commu-
nication. Following Figure 7, the attack can be launched by
sending an LMP_SCO_Link_Request with ACL length=2 in-
stead of its normal size of 7.

Impact: The attacker is able to prevent external parties to
connect to the device, requiring the user to manually perform
a power cycle on the device to resume normal connectiv-
ity. Attack risk is reduced if the user is already connected to
AC6366C or similar chipsets that only allow one active BT
connection at a time.

Figure 7: Truncated SCO Link Request

8

Master (Attacker)SlaveLMP_features_req_extLMP_features_res_extACE / Deadlock / CrashMutatedLMP....Feat. Pages=0x62OpcodesTIDACL HeaderBBLMP SetupMaster (Attacker)SlaveLMP_accepted_extLMP_SCO_link_reqPaging Scan DisabledMutatedLMP_max_slot_reqTruncatedOpcodeTIDLength = 2FlowLLIDBBACL HeaderLMP8.3 V3: Duplicated IOCAP
(CVE-2021-28136)

The Bluetooth Classic implementation in Espressif ESP-IDF
4.4 and earlier [8] does not properly handle the reception of
multiple LMP_IO_Capability_req packets during the pairing
process (see Figure 8). This allows attackers in radio range
to trigger memory corruption (and consequently a crash) in
ESP32 via a replayed (duplicated) LMP packet. The issue
was raised due to the sudden disconnection of ESP32 while
its bluedroid host stack was still in the pairing process. The
patch provided by Espressif rectiﬁes this issue by handling
a sudden disconnection during the pairing procedure (c.f.,
Table 5).

Impact: The attacker can exploit this vulnerability to
promptly cause ﬁrmware crashes and therefore maintain a
DoS while the attack is taking place. Since ESP32 restarts its
ﬁrmware by default upon receiving a fault, no user interaction
is needed to restore BT communication after the attack is
stopped.

Figure 8: Duplicated IOCAP

8.4 V4: Feature Response Flooding
(CVE-2021-28135/28155/31717)

The Bluetooth Classic implementation in Espressif ESP-IDF
4.4 and earlier [8] does not properly handle the reception of
continuous unsolicited LMP responses. This allows attackers
in radio range to trigger a denial of service (crash) in ESP32
by ﬂooding the target device with LMP Feature Response
data. As shown in Figure 9, LMP_features_res packets are
sent within a BT transmission slot of 1.25ms, which effec-
tively ﬂoods the Slave with unsolicited responses. This attack
vector is also effective against a range of other BT chipsets
such as JBL TUNE500BT [18] and Xiaomi MDZ-36-DB
(Actions Semi. ATS2815) [34, 37]. See Table 2 for all the
targets affected by V4.

Impact: The attack triggers a ﬁrmware crash on ESP32 and a
shutdown on JBL TUNE500BT and Xiaomi MDZ-36-DB.

9

In the case of a shutdown, the user needs to manually power
on the device again to restore communication. Furthermore,
since all targets accept multiple BT connections, the attack
can also be triggered while the target is already connected to
another device. For example, it is possible to immediately stop
audio from playing on JBL TUNE500BT and Xiaomi MDZ-
36-DB. The attacker, however, needs to know the BDAddress
of the target to launch the attack.

Figure 9: Feature Response Flooding

8.5 V5: LMP Auto Rate Overﬂow
(CVE-2021-31609/31612)

The Bluetooth Classic implementation in Silicon Labs
iWRAP 6.3.0 and earlier [19] does not properly handle
the reception of an oversized LMP packet greater than 17
bytes, allowing attackers in radio range to trigger a crash in
WT32i [20] via a crafted LMP packet. As shown in Figure 10,
the attack is triggered by sending an LMP with an ACL size
higher than 17 bytes. Normally this is not allowed by the BT
Core Speciﬁcation [27], but ESP32 radio can indeed send
such oversized LMP packets over the DM1 transport channel.
Our proof of concept (PoC) ﬁrmware bypasses some length
checks on the transmission path to make this possible. This
attack vector also works on some Jieli AC6905X (BT Audio
Receiver). Note that this attack requires sending this mal-
formed packet many times over many reconnections to trigger
a ﬁrmware crash. Particularly, a ﬁrmware crash on WT32i
may take around 3-5 minutes to be triggered.
Impact: The attack causes a ﬁrmware crash on both WT32i
and AC6905X. This can be used to cause a sporadic denial
of service (DoS) attacks on such devices.

8.6 V6: LMP 2-DH1 Overﬂow

(Pending CVE)

The Bluetooth Classic implementation on Laird CSR8811
A08 [24] and CSR8510 A10 [23] SoCs allows an LMP length
overﬂow over 2-DH1, resulting in a Deadlock (state machine
or packet handler corruption) outcome. Figure 11 captures the
sequence of messages exchanged to expose this vulnerability.

Master (Attacker)SlaveLMP_features_res_extLMP_features_req_extLMP_IO_Capability_reqCrashDuplicatedLMP_IO_Capability_reqLMP_IO_Capability_resSimple Pairing ProcedureMaster (Attacker)SlaveLMP_features_resCrashDuplicatedPaging ProcedureDuplicatedLMP_features_resDuplicatedLMP_features_res1.25ms1.25msdure and hence blocks new connections. If the user is already
connected to AB5301A and the attack is started (multiple
BT connections are allowed), the active connection is not dis-
rupted, but new connections or reconnection is not possible.
As compared to V5 (Section 8.5), this attack works with any
overﬂown LMP packet rather than a speciﬁc LMP packet.
Impact: The impact of this attack is similar to V2 (Sec-
tion 8.2), in which connections to the target are not accepted
due to the page scan procedure being disabled after the attack
(see Figure 1). Therefore, the user needs to manually perform
a power cycle (restart) of the device to restore normal BT
connectivity.

Figure 12: LMP DM1 Overﬂow

8.8 V8: Truncated LMP Accepted

(CVE-2021-31613)

The Bluetooth Classic implementation on Zhuhai Jieli
AC690X and AC692X devices with unknown ﬁrmware does
not properly handle the reception of a truncated LMP packet
during LMP auto rate procedure, allowing attackers in radio
range to immediately crash (and restart) a device via a crafted
LMP packet. As depicted in Figure 13, an attacker sends a
malformed LMP_accepted just after the LMP Setup proce-
dure. This malformed packet has an ACL size of one byte,
rather than the expected 2 bytes for the opcode LMP_accepted.
The implementation of the target BT device does not prop-
erly reject such packets with a truncated size. This eventually
results in a ﬁrmware crash, which, in turn, triggers a prompt
restart.

As the BT implementation of the target is closed source,
the exact root cause of this vulnerability is not known. How-
ever, it is common that LMP procedures involving slot and
rate adjustments are usually implemented in an interrupt han-
dler different than other non-real-time LMP packets, such as
feature requests and version requests. Such a handler may
miss some checks which are present on the other handlers, ex-
plaining why some overﬂow/underﬂow attacks only work for
certain LMP packet opcodes. This split in the LMP handler is
present, for instance, in ESP32 BT implementation.
Impact: The impact is a denial of service due to a ﬁrmware
crash & restart. The overall risk of such an attack is reduced if

Figure 10: LMP Auto Rate Overﬂow

In particular, the attack is performed by changing the transport
type of the normal LMP packet to 2-DH1 and then adding
more bytes to the LMP payload. This, for example, results in
a total ACL length of 27.

Impact: The attack causes a BT deadlock on Laird CSR8811
and a ﬁrmware crash on CSR8510 operating as a standard BT
dongle. While the dongle ﬁrmware crash is automatically re-
covered by the OS, the deadlock requires the user to perform a
power cycle to restore normal BT communication. The attack
does not affect Bluetooth Low Energy (BLE) communication
in CSR8811.

Figure 11: LMP 2-DH1 Overﬂow

8.7 V7: LMP DM1 Overﬂow
(CVE-2021-34150)

The Bluetooth Classic implementation on Bluetrum
AB5301A [5] (tested with AB32VG1 dev. kit [4]) with un-
speciﬁed ﬁrmware versions does not properly handle the re-
ception of oversized DM1 LMP packets. This allows attackers
in radio range to prevent new BT connections (disabling the
AB5301A inquiry and page scan procedures) via a crafted
LMP packet. Following Figure 12, an arbitrary LMP packet
(LMP_packet_type_table_req) is sent with an ACL length of
31, which is much higher than the expected 17 byte limit for
DM1 transport. Due to a lack of check of DM1 length, an
undeﬁned behaviour on the target baseband implementation
was observed. This eventually disables the paging scan proce-

10

Master (Attacker)SlaveLMP_setup_completeLMP_auto_rateCrashMutatedLMP_setup_completeExtra BytesLMPLength > 17FlowLLIDBBACL HeaderLMP_max_slotMaster (Attacker)SlaveL2CAP Info. RequestDeadlockMutatedLMP_AcceptedLength=27FLLID=3ACL HeaderLMP Informational RequestsType=2-DH1....Baseband HeaderOversizedLMPMaster (Attacker)SlaveLMP_packet_type_table_reqPaging Scan DisableMutatedLMPLength=31....ACL HeaderLMP Setup CompleteType=DM1....Baseband HeaderOversizedLMPAC690X and AC692X do not allow multiple BT connections.
In such a scenario, the attacker could only trigger a ﬁrmware
crash when no user is connected to AC690X or AC692X.

handle the reception of multiple LMP_host_connection_req
as shown in Figure 15. This allows attackers in radio range to
trigger a denial of service (deadlock) if no user is connected
to the target. Manual user intervention is required to restart
the device and restore Bluetooth communication.

Impact: An attacker in radio range can exploit the vulnera-
bility to perform DoS and shutdown or restart products using
chipsets and products based on Actions ATS2815/ATS2819.
However, the impact of the attack is reduced as the vulnerabil-
ity is only exploited when no other user device is connected
to the target.

Figure 13: Truncated LMP Accepted

8.9 V9: Invalid Setup Complete

(CVE-2021-31611)

The Bluetooth Classic implementation on Zhuhai Jieli
AC690X and AC692X devices does not properly handle the
reception of an out-of-order LMP Setup procedure (c.f., Fig-
ure 1) followed by a malformed LMP packet.

This scenario is illustrated in Figure 14. The attacker sends
an unexpected (duplicated) LMP_setup_complete, followed
by a malformed LMP_features_req_ext with an invalid LMP
opcode such as 0x64. The behaviour seen in Figure 14 allows
attackers in radio range to deadlock a device via injecting
crafted LMP packets. Moreover, the user needs to manually
reboot the device to restore communication.

Impact: An attacker can exploit this vulnerability to perform
a DoS. The overall risk of such an attack is reduced if AC690X
and AC692X do not allow multiple BT connections.

Figure 14: Invalid Setup Complete

8.10 V10: Host Connection Flooding

(CVE-2021-31785)

The Bluetooth Classic
ATS2815/ATS2819 [34]

implementation
on Actions
chipsets does not properly

11

Figure 15: Host Connection Flooding

8.11 V11: Same Host Connection

(CVE-2021-31786)

The Bluetooth Classic Audio implementation on products
based on Actions ATS2815/ATS2819 [34] chipset may not
properly handle a connection attempt from a host with the
same BDAddress as the currently connected BT host. As
illustrated in Figure 16, by simply connecting to the target
device (BT Speaker) with a forged BDAddress that matches
the BDAddress of the originally connected host (Device A -
E0:D4:E8:19:C7:69), the target device triggers a disconnec-
tion and eventually deadlocks. This requires the user to reboot
the target device to restore BT functionality.

When reaching Actions Semi during the disclosure period,
the company has informed us that they recommend the prod-
uct vendors to only allow one audio BT connection. However,
when we tested an ATS chipset based product Xiaomi MDZ-
36-DB, we observed that multiple BT connections are allowed,
albeit only one device can play audio at a time. Normally, con-
nections with repeated host BDAddress are rejected on LMP
Setup procedure (c.f., Figure 1). However, this procedure is
successful when testing Xiaomi MDZ-36-DB with repeated
host BDAddress, leading the audio device to an undeﬁned
state.

Impact: An attacker in radio range can exploit this vulnerable
behaviour to perform DoS and intentionally deadlock the
target device.

Master (Attacker)SlaveLMP_setup_completeLMP_acceptedCrashMutatedLMP_max_slotRe.ACL HeaderLMP (Truncated)OpcodeTIDLength=1FlowLLIDBBMaster (Attacker)SlaveLMP_features_requestLMP_features_responseLMP_setup_completeLMP_features_req_ext.......OpcodeTIDACL Hdr.BB(84) Unkown PDUDeadlockDuplicatedMutatedMaster (Attacker)SlaveLMP Informational RequestsPaging Scan DisableDuplicatedLMP_host_connection_reqLMP_host_connection_reqLMP_not_accepetedLMP_detachFigure 16: Same Host Connection

8.12 V12: LMP AU Rand Flooding

(CVE-2021-31610/34149/34146/34143)

The Bluetooth Classic implementation on several chipsets
does not properly handle the reception of continuous unso-
licited LMP responses that trigger a heap overﬂow within
the BT ﬁrmware. This allows attackers in radio range to trig-
ger a denial of service (either restart or deadlock the device)
by ﬂooding a device with LMP_AU_rand packet as shown
in Figure 17. Only CC2564C [15] from Texas Instruments
enters a deadlock state, which requires user intervention to re-
cover. Additionally, use of TI Dual-mode Bluetooth Stack for
MSP432 [16] may temporarily hang the host MCU (MSP432)
during the attack.

Many major chipset vendors are affected by this attack as
shown in Table 2. This attack is similar to Feature Response
Flooding (Section 8.4), indicating that ﬂooding testing with
packets from certain LMP procedures may not have been well
tested. This may arise because the Core Speciﬁcations only al-
lows a limited LMP testing mode [28] that restricts the SoC to
work with only a few LMP packets. This, in turn, may restrict
the test ﬂexibility for BT vendors. Speciﬁcally, vendors may
have a limited capacity of tests that they can perform with
their production BT ﬁrmware, such as ﬂooding or sending
out-of-order packets during normal LMP procedures.

Impact: An attacker in radio range can exploit this vulnerable
behaviour to perform DoS and intentionally crash or deadlock
the target device.

8.13 V13: LMP Invalid Max Slot Type

(CVE-2021-34145)

Figure 17: LMP AU Rand Flooding

allowing attackers in radio range to trigger a denial of service
(ﬁrmware crash) via a crafted LMP packet.

Impact: An attacker in radio range can exploit this vulnerable
behaviour to perform DoS and intentionally crash the target
device.

Figure 18: Invalid Max Slot Type

8.14 V14: Max Slot Length Overﬂow

(CVE-2021-34148)

The Bluetooth Classic implementation in the Cypress WICED
BT stack 2.9.0 [13] and earlier for CYW20735B1 [12] devices
does not properly handle the reception of LMP_max_slot with
a higher ACL Length (Length=31 as shown in Figure 19) after
completion of the LMP setup procedure. This allows attackers
in radio range to trigger a denial of service (ﬁrmware crash)
via a crafted LMP packet.

Impact: An attacker in radio range can exploit this vulnerabil-
ity to perform DoS and intentionally crash the target device.

The Bluetooth Classic implementation in the Cypress WICED
BT stack 2.9.0 [13] and earlier for CYW20735B1 [12] devices
does not properly handle the reception of LMP_max_slot
with an invalid Baseband packet type and LT_ADDRESS (see
Type and LT_ADDR ﬁelds in Figure 18). The vulnerability
is triggered after completion of the LMP setup procedure,

8.15 V15: Invalid Timing Accuracy

(CVE-2021-34147/Pending/Pending)

The Bluetooth Classic implementations in the Cypress
WICED BT stack 2.9.0 [13] and earlier for CYW20735B1
[12] devices, Intel AX200 [17] and Qualcomm WCN3990

12

ESP-WROVER-KIT (esp32driver firmware) BT Exploiter Proof of Concept (PoC)/dev/ttyUSB1BT Speaker Chipset 08:eb:ed:8f:37:80E0:D4:E8:19:C7:69E0:D4:E8:19:C7:69Device A (Smartphone)Master (Attacker)SlaveLMP_au_randCrashDuplicatedPaging ProcedureLMP_au_randLMP_not_acceptedLMP_au_randLMP_not_acceptedLMP_au_randDuplicatedSlave (Attacker)MasterLMP_setup_completeLMP_max_slotCrashMutatedLMP_setup_completeLMPACL HeaderType=0xaLT_ADDR=0Baseband HeaderRole SwitchFigure 19: Max Slot Length Overﬂow

[30] chipsets do not properly handle the reception of a mal-
formed LMP timing accuracy response followed by multiple
re-connections to the target link slave. This allows attackers
to exhaust device BT resources. Eventually, the attacker can
trigger a crash or BT disturbance via multiple attempts of
sending a crafted LMP_timing_acc_response (i.e. LMP tim-
ing accuracy response) followed by a sudden reconnection to
the target with a random BDAddress.

As shown in Figure 20, the attacker needs to perform
a loop of reconnection and injection of the malformed
LMP_timing_acc_response until the target chipset gets un-
stable. This either triggers a ﬁrmware crash (in the case of
WCN3990 and CYW20735B1) or disconnects other active
BT devices (in the case of Intel AX200). The faster the recon-
nection is performed, the easier is for the attack to succeed in
disturbing other BT devices connected to the target chipset.

Impact: This attack causes a denial of service (DoS) attack.
Speciﬁcally, while the attack is in progress, the target devices
are unable to use the Bluetooth service normally.

The impact of this attack does not persist after the attack
stops. This is because the target normally tries to recover
the BT connection by performing a re-connection to previ-
ously disconnected devices (e.g., Intel AX200 under Linux
or Windows). In the case of a WCN3990 ﬁrmware crash, the
Android OS restarts the Bluetooth daemon and re-uploads
a ﬁrmware image to WCN3990. Finally, for CYW20735B1,
it restarts automatically upon any fault due to its watchdog
timer being enabled by default. Nevertheless, in all cases, it is
not possible to normally use the device while the attack is in
progress, as the BT connection can be disrupted continuously.
The attacker only needs to know the BDAddress of the target
device and no authentication is required to launch the attack.

8.16 V16: Paging Scan Disable

(Pending CVE)

This vulnerability is depicted in Figure 21. As shown in Fig-
ure 21, sending an invalid packet during the LMP timing
accuracy procedure (i.e. packet LMP_timing_acc_request),
followed by a forced re-connection with the same BDAddress

Figure 20: Invalid Timing Accuracy

(any arbitrary BDAdress of choice of the attacker), leads Intel
AX200 to reject any externally initiated BT connections for
an undetermined amount of time. This persists even after the
attack stops and requires user intervention to recover AX200
normal functionalities.

Figure 21 illustrates the attack, which, similarly to at-
tack V15 (Section 8.15), involves a loop of sending the
malformed packet throughout re-connections to trigger the
vulnerability. In contrast to V15, the attack is triggered be-
fore role switch procedure (see Figure 1), requires the same
BDAddress when initiating re-connections and injects a mal-
formed LMP_timing_acc_request with an oversized LMP
length greater than 17 bytes. As a reminder, the maximum
length limit of an LMP packet under DM1 channel is 17 bytes,
which suggests that oversized LMP packets are not correctly
handled by AX200 under a sudden disconnection scenario.

Furthermore, during the next re-connection, AX200 sends
an out-of-order response which does not correspond to the
original request. For instance, during the second re-connection
involved in the scenario captured in Figure 21, AX200 sends
LMP_version_res when receiving a feature request from the
attacker. This depicts anomaly A5 as listed in Table 2.

Finally, as a second side effect of the vulnerability, the user
may not be able to initiate as much BR/EDR connections as
AX200 originally supports even after the attack stops. For
example, the user is able to connect a maximum of only one
or two BR/EDR devices depending on when the vulnerability
is triggered. More speciﬁcally, if the vulnerability is triggered
when AX200 is not connected to any device, then the user can
only connect to one device. Otherwise, if AX200 is already
connected to a device when the vulnerability is triggered, then
AX200 can only connect to two devices.

Impact: Once the attack is triggered and successful, the at-
tacker can cause DoS via the following AX200 behaviours:
(I) paging scan is disabled, which prevents any external de-

13

Master (Attacker)SlaveLMP_setup_completeLMP_max_slotCrashMutatedLMP_setup_completeExtra BytesLMPLength=31FlowLLIDBBACL HeaderLMP_auto_rateCrash or DoSPaging (Random BDAddr)Silent DisconnectionRetry AttackLoopSlave (Attacker)MasterLMP_timing_acc_requestLMP_timing_acc_responseMutatedLMP_setup_completeBaseband HeaderRole Switch.....Opcode=91TIDACL HeaderType=0xc.....LMPvice to connect to the target even if the BDAddress is known.
This behaviour can be used to trick an user to connect to
the attacker’s BT hardware instead of the legitimate target
since AX200 paging scan is disabled; (II) Multiple active BT
connections cannot be performed from the target. The user
requires to manually restart the Bluetooth service to restore
normal BT behaviour. On Linux and Windows, BT is recov-
ered by disabling and enabling Bluetooth via their respective
conﬁguration menu.

Firmware crashes may be sporadically triggered on AX200
during the attacks, but no speciﬁc scenario was found to reli-
ably trigger such crashes all the time.

Figure 21: Paging Scan Disable

PoC Tool Availability

BRAKTOOTH proof-of-concept (PoC) tool is available to
download for vendors producing BT SoCs, modules and prod-
ucts. To download the BRAKTOOTH proof-of-concept (PoC)
tool, kindly ﬁll up the following simple form: BRAKTOOTH
PoC. The form requires certain basic information (job role,
organization, and valid email) to be provided. The detailed
instructions to download and launch the exploits on a target
device will be sent (to the provided email) once the required
information is given. We encourage vendors producing BT
SoCs, BT modules, and BT end products to use the PoC and
validate against BRAKTOOTH attacks. We will be glad to help
with replication and validation. Send all questions related to
BRAKTOOTH to ask@braktooth.com.

14

Acknowledgments

This research was partially supported by NRF National Satel-
lite of Excellence in Trustworthy Software Systems. This
research is also successfully translated to a Keysight pene-
tration testing tool with the generous funding and support
provided by Keysight Technologies. We also want to thank
all the involved vendors for their support during the coor-
dination process and Cyber Security Agency of Singapore
(CSA) [1] for working with us and publishing the SingCERT
advisory [31]. We thank Ezekiel O. Soremekun for coining
the term BrakTooth. We thank Rushati Chakraborty for creat-
ing the BrakTooth title design. Additionally, special thanks
to Olof Astrand for his support on the open-source Tensilica
Xtensa module for Ghidra [7] and Kwok Chuo Willis Yip for
the ESP32 attack video.

References

[1] Cyber Security Agency of Singapore (CSA). https://

www.csa.gov.sg/, 2021.

[2] Daniele Antonioli, Nils Ole Tippenhauer, and Kasper
Rasmussen. BIAS: bluetooth impersonation attacks.
In 2020 IEEE Symposium on Security and Privacy, SP
2020, San Francisco, CA, USA, May 18-21, 2020, pages
549–562. IEEE, 2020.

[3] Daniele Antonioli, Nils Ole Tippenhauer, and Kasper B.
Rasmussen. The KNOB is broken: Exploiting low
entropy in the encryption key negotiation of Blue-
tooth BR/EDR. In 28th USENIX Security Symposium
(USENIX Security 19), pages 1047–1061, Santa Clara,
CA, August 2019. USENIX Association.

[4] Bluetrum. AB32VG1 Development Kit Quick Start
https://ab32vg1-example.readthedocs.io/zh/

(CN).
latest/introduction.html, 2021.

[5] Bluetrum. AB5301A SoC Product Description Website
(CN). http://www.bluetrum.com/product/ab5301a.html,
2021.

[6] Tristan Claverie and Jose Lopes Esteves. Bluemirror:
Reﬂections on bluetooth pairing and provisioning pro-
tocols. In 2021 IEEE Security and Privacy Workshops
(SPW), pages 339–351, 2021.

[7] Ebiroll. Fork of Tensilica Xtensa module for Ghidra.

https://github.com/Ebiroll/ghidra-xtensa, 2021.

[8] Espressif. Espressif IoT Development Framework. https:

//github.com/espressif/esp-idf, 2020.

[9] Espressif. Cheap ESP32 Development Kit. https://www.
aliexpress.com/item/1005001757645011.html, 2021.

Master (Attacker)SlaveLMP_version_resLMP_timing_acc_requestPaging Scan DisableMutatedExtra BytesLMPLength > 17FlowLLIDBBACL HeaderLMP_version_reqPaging (Initial BDAddr)Silent DisconnectionLMP_feature_reqLMP_version_resWarningInvalid Response (A5)Paging (Initial BDAddr)Silent DisconnectionRetry AttackLoopPaging Fails[25] DF Robot. XY-WRBT Bluetooth 5.0 Audio Re-
https://www.dfrobot.com/

ceiver Product Details.
product-2084.html, 2021.

[26] Jan Ruge, Jiska Classen, Francesco Gringoli, and
Matthias Hollick. Frankenstein: Advanced wireless
fuzzing to exploit new bluetooth escalation targets. In
29th USENIX Security Symposium (USENIX Security
20), pages 19–36. USENIX Association, August 2020.

[27] Bluetooth SIG.

Qualify your product.
develop-with-bluetooth/qualiﬁcation-listing/, 2019.

Bluetooth certiﬁcation guideline:
https://www.bluetooth.com/

[28] Bluetooth SIG.

v5.2, December 2019.
speciﬁcations/bluetooth-core-speciﬁcation.

Bluetooth Core Speciﬁcation
https://www.bluetooth.com/

[29] Bluetooth SIG. View previously qualiﬁed designs and
declared products, January 2020. https://launchstudio.
bluetooth.com/Listings/Search.

[30] Bluetooth SIG. WCN3990 Bluetooth Product List-
ings. https://launchstudio.bluetooth.com/ListingDetails/
66490, 2021.

[31] Singapore Computer Emergency Response Team
(SingCERT). Multiple Vulnerabilities Affecting Blue-
tooth Devices. https://www.csa.gov.sg/singcert/Alerts/
al-2021-051, 2021.

[32] Espressif Systems. ESP32 SoC Product Details. https:
//www.espressif.com/en/products/socs/esp32, 2021.

[33] Espressif Systems. Ofﬁcial ESP32 Development Kit
ESP32-WROVER-KIT. https://www.espressif.com/en/
products/hardware/esp-wrover-kit/overview, 2021.

[34] Actions Technology. ATS2815 Datasheet. http://www.

lanzhi-tech.com/ﬁledownload/99240, 2021.

[35] Jieli Technology. AC63 Series SDK repository. https:
//github.com/Jieli-Tech/fw-AC63_BT_SDK, 2021.

[36] Jianliang Wu, Yuhong Nan, Vireshwar Kumar, Dave Jing
Tian, Antonio Bianchi, Mathias Payer, and Dongyan
Xu. BLESA: Spooﬁng Attacks against Reconnections
in Bluetooth Low Energy. In 14th USENIX Workshop
on Offensive Technologies (WOOT 20), 2020.

[37] Xiaomi. Mi Portable Bluetooth Speaker MDZ-36-
https://www.mi.com/global/

DB Product Details.
mi-portable-bluetooth-speaker-16w/specs/, 2021.

[10] Espressif. ESP32 BT/BLE Stack Libraries. https://

github.com/espressif/esp32-bt-lib, 2021.

[11] Espressif. ESP32 ESP-IDF BrakTooth Patches (com-
mit #bf71f49). https://github.com/espressif/esp-idf/tree/
bf71f494a165aba5e5365e17e1e258598d9fc172, 2021.

[12] Inﬁneon (former Cypress). CYW20735B1 Datasheet.
https://www.cypress.com/ﬁle/298426/download, 2021.

[13] Inﬁneon (former Cypress). WICED Software. https:
//www.cypress.com/products/wiced-software, 2021.

[14] Matheus E. Garbelini, Chundong Wang, Sudipta Chat-
topadhyay, Sun Sumei, and Ernest Kurniawan. Sweyn-
tooth: Unleashing mayhem over bluetooth low en-
ergy. In 2020 USENIX Annual Technical Conference
(USENIX ATC 20), pages 911–925. USENIX Associa-
tion, July 2020.

[15] Texas Instruments. CC2564C Product Details. https:

//www.ti.com/product/CC2564C, 2021.

[16] Texas Instruments. CC2564C TI Dual-mode Bluetooth
Stack on MSP432 MCUs. https://www.ti.com/tool/
CC2564CMSP432BTBLESW, 2021. Service pack must
be downloaded separatelly.

[17] Intel.
tails.
products/189347/intel-wi-ﬁ-6-ax200-gig.html, 2021.

Intel Wi-Fi 6 AX200 SoC Product De-
https://ark.intel.com/content/www/us/en/ark/

[18] JBL.

JBL TUNE 500BT Wireless on-ear Head-
https://www.jbl.com.sg/

phone Product Details.
over-ear-headphones/JBL+TUNE500BT.html, 2021.

[19] Silicon Labs. Bluegiga iWRAP Bluetooth Classic
Software Stack. https://www.silabs.com/developers/
bluegiga-iwrap-bluetooth-classic-software-stack, 2021.

[20] Silicon Labs.

WT32I-A Product Descrip-
tion.
https://www.silabs.com/wireless/bluetooth/
bluegiga-classic-legacy-modules/device.wt32i-a, 2021.

[21] Mouser.

Ofﬁcial ESP32 Development Kit
ESP32-PICO-KIT.
https://www.mouser.sg/
ProductDetail/Espressif-Systems/ESP32-PICO-KIT?
qs=MLItCLRbWsyoLrlknFRqcQ%3D%3D, 2021.

[22] Oppo. Oppo Reno 5G (CPH1921) Product Details. https:
//www.oppo.com/en/smartphone-reno-5g/specs/, 2019.

[23] Qualcomm. CSR8510 Bluetooth SoC Product Details.

https://www.qualcomm.com/products/csr8510, 2021.

[24] Qualcomm. CSR8811 Bluetooth SoC Product Details.

https://www.qualcomm.com/products/csr8811, 2021.

15


