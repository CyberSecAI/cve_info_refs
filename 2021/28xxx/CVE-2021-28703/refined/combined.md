=== Content from security.gentoo.org_67d9988d_20250114_232212.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple Vulnerabilities — GLSA **202402-07**

Multiple vulnerabilities have been found in Xen, the worst of which can lead to arbitrary code execution.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.16.6\_pre1** |
| Unaffected versions | >= **4.16.6\_pre1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.16.6_pre1"

```
### References

* [CVE-2021-28703](https://nvd.nist.gov/vuln/detail/CVE-2021-28703)
* [CVE-2021-28704](https://nvd.nist.gov/vuln/detail/CVE-2021-28704)
* [CVE-2021-28705](https://nvd.nist.gov/vuln/detail/CVE-2021-28705)
* [CVE-2021-28706](https://nvd.nist.gov/vuln/detail/CVE-2021-28706)
* [CVE-2021-28707](https://nvd.nist.gov/vuln/detail/CVE-2021-28707)
* [CVE-2021-28708](https://nvd.nist.gov/vuln/detail/CVE-2021-28708)
* [CVE-2021-28709](https://nvd.nist.gov/vuln/detail/CVE-2021-28709)
* [CVE-2022-23816](https://nvd.nist.gov/vuln/detail/CVE-2022-23816)
* [CVE-2022-23824](https://nvd.nist.gov/vuln/detail/CVE-2022-23824)
* [CVE-2022-23825](https://nvd.nist.gov/vuln/detail/CVE-2022-23825)
* [CVE-2022-26356](https://nvd.nist.gov/vuln/detail/CVE-2022-26356)
* [CVE-2022-26357](https://nvd.nist.gov/vuln/detail/CVE-2022-26357)
* [CVE-2022-26358](https://nvd.nist.gov/vuln/detail/CVE-2022-26358)
* [CVE-2022-26359](https://nvd.nist.gov/vuln/detail/CVE-2022-26359)
* [CVE-2022-26360](https://nvd.nist.gov/vuln/detail/CVE-2022-26360)
* [CVE-2022-26361](https://nvd.nist.gov/vuln/detail/CVE-2022-26361)
* [CVE-2022-27672](https://nvd.nist.gov/vuln/detail/CVE-2022-27672)
* [CVE-2022-29900](https://nvd.nist.gov/vuln/detail/CVE-2022-29900)
* [CVE-2022-29901](https://nvd.nist.gov/vuln/detail/CVE-2022-29901)
* [CVE-2022-33746](https://nvd.nist.gov/vuln/detail/CVE-2022-33746)
* [CVE-2022-33747](https://nvd.nist.gov/vuln/detail/CVE-2022-33747)
* [CVE-2022-33748](https://nvd.nist.gov/vuln/detail/CVE-2022-33748)
* [CVE-2022-33749](https://nvd.nist.gov/vuln/detail/CVE-2022-33749)
* [CVE-2022-42309](https://nvd.nist.gov/vuln/detail/CVE-2022-42309)
* [CVE-2022-42310](https://nvd.nist.gov/vuln/detail/CVE-2022-42310)
* [CVE-2022-42319](https://nvd.nist.gov/vuln/detail/CVE-2022-42319)
* [CVE-2022-42320](https://nvd.nist.gov/vuln/detail/CVE-2022-42320)
* [CVE-2022-42321](https://nvd.nist.gov/vuln/detail/CVE-2022-42321)
* [CVE-2022-42322](https://nvd.nist.gov/vuln/detail/CVE-2022-42322)
* [CVE-2022-42323](https://nvd.nist.gov/vuln/detail/CVE-2022-42323)
* [CVE-2022-42324](https://nvd.nist.gov/vuln/detail/CVE-2022-42324)
* [CVE-2022-42325](https://nvd.nist.gov/vuln/detail/CVE-2022-42325)
* [CVE-2022-42326](https://nvd.nist.gov/vuln/detail/CVE-2022-42326)
* [CVE-2022-42327](https://nvd.nist.gov/vuln/detail/CVE-2022-42327)
* [CVE-2022-42330](https://nvd.nist.gov/vuln/detail/CVE-2022-42330)
* [CVE-2022-42331](https://nvd.nist.gov/vuln/detail/CVE-2022-42331)
* [CVE-2022-42332](https://nvd.nist.gov/vuln/detail/CVE-2022-42332)
* [CVE-2022-42333](https://nvd.nist.gov/vuln/detail/CVE-2022-42333)
* [CVE-2022-42334](https://nvd.nist.gov/vuln/detail/CVE-2022-42334)
* [CVE-2022-42335](https://nvd.nist.gov/vuln/detail/CVE-2022-42335)
* XSA-351
* XSA-355
* XSA-385
* XSA-387
* XSA-388
* XSA-389
* XSA-397
* XSA-399
* XSA-400
* XSA-407
* XSA-412
* XSA-414
* XSA-415
* XSA-416
* XSA-417
* XSA-418
* XSA-419
* XSA-420
* XSA-421
* XSA-422
* XSA-425
* XSA-430

**Release date**

February 04, 2024

**Latest revision**

February 04, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [754105](https://bugs.gentoo.org/show_bug.cgi?id=754105)
* [757126](https://bugs.gentoo.org/show_bug.cgi?id=757126)
* [826998](https://bugs.gentoo.org/show_bug.cgi?id=826998)
* [837575](https://bugs.gentoo.org/show_bug.cgi?id=837575)
* [858122](https://bugs.gentoo.org/show_bug.cgi?id=858122)
* [876790](https://bugs.gentoo.org/show_bug.cgi?id=876790)
* [879031](https://bugs.gentoo.org/show_bug.cgi?id=879031)
* [903624](https://bugs.gentoo.org/show_bug.cgi?id=903624)
* [905389](https://bugs.gentoo.org/show_bug.cgi?id=905389)
* [915970](https://bugs.gentoo.org/show_bug.cgi?id=915970)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xenproject.org_8baef40f_20250114_232213.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Xen Security Advisory CVE-2021-28703 / XSA-387
version 2
grant table v2 status pages may remain accessible after de-allocation (take two)
UPDATES IN VERSION 2
====================
Public release.
ISSUE DESCRIPTION
=================
Guest get permitted access to certain Xen-owned pages of memory. The
majority of such pages remain allocated / associated with a guest for
its entire lifetime. Grant table v2 status pages, however, get
de-allocated when a guest switched (back) from v2 to v1. The freeing
of such pages requires that the hypervisor know where in the guest
these pages were mapped. The hypervisor tracks only one use within
guest space, but racing requests from the guest to insert mappings of
these pages may result in any of them to become mapped in multiple
locations. Upon switching back from v2 to v1, the guest would then
retain access to a page that was freed and perhaps re-used for other
purposes.
This bug was fortuitously fixed by code cleanup in Xen 4.14, and
backported to security-supported Xen branches as a prerequisite of the
fix for XSA-378.
IMPACT
======
A malicious guest may be able to elevate its privileges to that of the
host, cause host or guest Denial of Service (DoS), or cause information
leaks.
VULNERABLE SYSTEMS
==================
All Xen branches up to and including 4.13 are vulnerable,
but only if the patches for XSA-378 have not been applied.
Xen versions 4.13.4, 4.14.x and 4.15.x are not affected.
Only x86 HMV and PVH guests permitted to use grant table version 2
interfaces can leverage this vulnerability. x86 PV guests cannot
leverage this vulnerability. On Arm, grant table v2 use is explicitly
unsupported.
MITIGATION
==========
Running only PV guests will avoid this vulnerability.
Suppressing use of grant table v2 interfaces for HVM or PVH guests will
also avoid this vulnerability.
CREDITS
=======
This issue was discovered by Patryk Balicki and Julien Grall of Amazon.
RESOLUTION
==========
Applying the following patch resolves the issue:
x86/p2m: don't assert that the passed in MFN matches for a remove
This patch was supplied with XSA-378, as one of 378's prerequisites.
The fix has already been applied to Xen stable branches as follows:
c65ea16dbcafbe4fe21693b18f8c2a3c5d14600e in Xen 4.14.x, 4.15.x
f50fbddbae81fcccae56d27317bd71cc0e678ba2 in Xen 4.13.4
d44643199c96ac22491ae002d3bcd1c989b95ea4 in xen.git#stable-4.12
66f400c71d12fe8adfb895984b14f2941e8cb6ce in xen.git#stable-4.11
DEPLOYMENT DURING EMBARGO
=========================
Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.
But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).
Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.
(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable. This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)
For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----
iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmGc2jgMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZlWUIAJ4bU9n2q9A4sqhiW0xJOCI4MIdwV2ym6xziP9iN
e5sg0u3gdp94M1vLf//8h7julxLXgdJd10HWWpJkfRQcsfz3E1ul1O+mAsoHxJwI
/qGl1Xis7AkDFjrPXthJUKh/DNgi8F1Rok7XDbfFznk34v4g6anh4JDfqJIUwIFQ
l2s6qIOc2PjvmrJMXEboT1wEUADZNtChIqOL7Ibre9Zz6/mdr0FjPfPvLAqfvf9m
aLaMElJMRx5iTEUG7qCYXUn8oKLbWNTv88yceudE7QZl3/zv/UnEL8nvBZWs/Gkx
UbrC6wkNFUSpF/ngexvzsSE/SrfMYYaUPfIciyuxvuosGJY=
=DmKh
-----END PGP SIGNATURE-----

