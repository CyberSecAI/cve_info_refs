=== Content from herolab.usd.de_bc0b0d57_20250114_225958.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2021-0007/ "Deutsch")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2021-0007/ "Deutsch")

# usd-2021-0007 | ChronoEngine ChronoForums

**Advisory ID**: usd20210007
**CVE Number**: CVE-2021-28377
**Affected Product**: ChronoEngine ChronoForums
**Affected Version**: v2.0.11
**Vulnerability Type**: CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
**Security Risk**: High
**Vendor URL**: <https://www.chronoengine.com/chronoforums>
**Vendor Status**: Unknown

### Description

The ChronoForums avatar function is vulnerable through unauthenticated path traversal attacks. This enables unauthenticated attackers to read arbitrary files, like for instance Joomla's configuration file containing secret credentials.

The ChronoForums avatar function is vulnerable through path traversal attacks. An attacker can pass arbitrary local file paths as 'av' parameter. The content of the file is returned. Unauthenticated attackers could use this vulnerabilities to read arbitrary files, like for instance Joomla's configuration file containing secret credentials.

##### Vulnerable Code:**File**: com\_chronoforums2/chronoforums/controllers/profiles.php

function avatar(){
if(!empty($this->data['u']) AND !empty($this->data['av'])){
$avatars\_path = \GApp::extension('chronoforums')->settings()->get('avatars\_path', \G2\Globals::ext\_path('chronoforums','front').'avatars'.DS);
$target = $avatars\_path.$this->data['av'];
\G2\L\Download::send($target, 'I', $this->data['av'], true);
}else{
\G2\L\Env::e404();
}

$this->view = false;
}

The corresponding function **send($path, $view = 'D', $filename = '', $cache = false)** in *cegcore2/libs/download.php*.

### Proof of Concept (PoC)

The following steps need to be performed to exploit this issue.

#### Preparation:

* Install Joomla 3.X.
* install latest ChronoEngine ChronoForums extensions (at time of writing: 2.0.11).
* Create and publish a forum in Joomla administration interface.

#### Exploiting:

Open the vulnerable File in Webbrowser: <https://<JoomlaInstallation>/index.php/component/chronoforums2/profiles/avatar/u1?tvout=file&av=<local_file>>

Exemplary values for <local\_file> are given in the following:

1. "**PAYLOAD**": References the **/etc/passwd** file.

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/11/usd20210007-1.png "usd20210007-1")

2. "**PAYLOAD**": References the Joomla configuration file (Path might vary).

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/11/usd20210007-2.png "usd20210007-2")
### Fix

Restrict path specification to configured avatar folder.

###

### References

* <https://cwe.mitre.org/data/definitions/22.html>
* [https://owasp.org/www-community/attacks/Path\_Traversal](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery)

###

### Timeline

* 2021-02-05: This vulnerability is identified by Tim Kranz and Nicolas Schickert.
* 2021-02-15: Initial contact with vendor.
* 2021-02-15: Vulnerability details are transmitted to the vendor.
* 2021-03-07: Status update requested.
* 2021-04-15: Status update requested.
* 2021-07-22: Status update requested.
* 2021-11-02: Status update requested, disclosure scheduled by the end of November.
* 2021-11-30: Advisory released.

###

### Credits

This security vulnerability was found by Nicolas Schickert and Tim Kranz of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

#### [Contact](https://www.usd.de/en/contact/)

[Imprint](https://www.usd.de/en/imprint/)

[Privacy Protection](https://www.usd.de/en/privacy-protection/)

[General Terms and Conditions](https://www.usd.de/en/terms-conditions/)

© 2025 usd AG

#### Follow Us

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)     [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/showcase/usd-ag-international/)

[Report a vulnerability or bug](https://www.usd.de/en/report-a-vulnerability-or-bug/)

[Code of Ethics](/en/code-of-ethics/)

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/en/the-security-risks-of-overlong-utf-8-encodings/)

Sep 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories on hugocms and Gitea](https://herolab.usd.de/en/security-advisories-on-hugocms-and-gitea/)

Jul 25, 2024

The pentest professionals at usd HeroLab examined hugocms and Gitea during their pentests. Thereby, several vulnerabilities were identified. The vulnerabilities were reported to the vendors as part of the Responsible Disclosure Policy. The usd HeroLab Advisories can...

## [Security Advisory on AXIS Webcam](https://herolab.usd.de/en/security-advisory-on-axis-webcam/)

Jul 1, 2024

The pentest professionals at usd HeroLab examined the AXIS Webcam (P1364) during their pentests. Our professionals discovered a vulnerability (cross-site request forgery) in the admin panel of AXIS P1364 Webcam. Exploiting this vulnerability enables an attacker to...


