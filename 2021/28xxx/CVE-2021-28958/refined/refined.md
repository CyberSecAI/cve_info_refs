Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2021-28958:

**1. Verification of CVE Relevance:**

The provided content explicitly mentions "CVE-2021-28958" and describes a vulnerability in ManageEngine ADSelfService Plus related to an unauthenticated RCE via password change functionality. This aligns with the CVE description (when available).

**2. Root Cause of the Vulnerability:**
The root cause is **improper sanitization of user-supplied input** when processing password change requests. Specifically, double quotes within the new password field were not properly escaped when constructing a PowerShell script used internally by the application to handle the password change.

**3. Weaknesses/Vulnerabilities Present:**

*   **PowerShell Script Injection:** The vulnerability allows for arbitrary code injection into a PowerShell script.
*   **Lack of Input Validation/Sanitization:** The application fails to properly sanitize user-provided input (specifically, the new password field), which enables the injection.

**4. Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation enables an attacker to execute arbitrary commands on the server where ManageEngine ADSelfService Plus is installed. This allows for a complete compromise of the server, leading to data breaches, malware deployment, or denial of service.

**5. Attack Vectors:**

*   **HTTP GET Request:** The exploit is triggered through an unauthenticated HTTP GET request to the `/RestAPI/ChangePasswordAPI` endpoint.
*   **Malicious Payload in `newPassword` parameter:** A crafted `newPassword` parameter containing injected PowerShell commands is sent within the request.

**6. Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the ManageEngine ADSelfService Plus server.
*   **No Authentication Required:** The vulnerability is unauthenticated, meaning the attacker doesn't need any valid credentials to exploit it.
*   **Knowledge of AD Domain:** The attacker must know the Active Directory domain name configured within ADSelfService Plus.
*   **Target System:** The target system must be running a vulnerable version of ManageEngine ADSelfService Plus.

**Technical Details:**

The provided exploit script demonstrates the attack by:

1.  Constructing a URL with the `ChangePasswordAPI` endpoint.
2.  Adding parameters:
    *   `operation`: `UMCP`
    *   `loginName`: A valid username (e.g. 'krbtgt').
    *   `domainName`: The Active Directory domain.
    *   `umcp`: `true`
    *   `IS_ENCRYPTED`: `false`
    *  `oldPassword`: arbitrary value
    *   `newPassword`: A long string with injected code
3.  Sending the request. The `newPassword` parameter includes a string that will cause the injected PowerShell to be executed by the server in context of the application.

**Affected Versions:**

*   The content indicates that versions of ManageEngine ADSelfService Plus **prior to 6102** are vulnerable.

**Mitigation:**

*   Upgrade ManageEngine ADSelfService Plus to version 6102 or higher, which contains the fix for this vulnerability.

**Summary:**

CVE-2021-28958 is a critical vulnerability in ManageEngine ADSelfService Plus that allows for unauthenticated remote code execution via PowerShell script injection. It's caused by a lack of input sanitization in the `newPassword` parameter during password change requests. This allows attackers to completely compromise vulnerable servers.