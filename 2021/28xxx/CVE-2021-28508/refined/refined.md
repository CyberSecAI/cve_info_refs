**Root cause of vulnerability:**

- Improper credentials management in Arista EOS state streaming telemetry agent TerminAttr and OpenConfig transport protocols. Specifically, the issue stems from how TerminAttr and Octa handle sensitive data related to IPsec and MACsec configurations.

**Weaknesses/vulnerabilities present:**

- **Cleartext Exposure of Sensitive Data:** TerminAttr and Octa, under certain conditions, expose IPsec and MACsec sensitive data (like shared keys) in clear text. This data is transmitted to authorized CloudVision users or gNMI clients.
- **CWE-255 Credentials Management Errors:** The core issue is that the system fails to properly protect and manage sensitive credentials.

**Impact of exploitation:**

- **Decryption of IPsec and MACsec Traffic:** Leaked IPsec and MACsec keys can enable an attacker to decrypt or potentially modify protected network traffic. This could lead to data breaches, man-in-the-middle attacks, and unauthorized network access.
- **Compromise of Confidentiality and Integrity:** Exploitation can lead to loss of confidentiality by exposing encrypted data and loss of data integrity via tampering.

**Attack vectors:**

- **Network Access:** An attacker needs access to the CloudVision or gNMI clients to intercept the leaked information. This implies the attack would be internal to the network.

**Required attacker capabilities/position:**

- **Authorized User/Client:** The attacker needs to be a user with access to CloudVision or an authorized gNMI client. This access could be legitimate or gained through other means of account compromise.
- **Network Visibility:** The attacker must be able to intercept or observe the data stream sent by TerminAttr or Octa.

**Additional Details:**

- This advisory addresses two CVEs, CVE-2021-28508 (IPsec) and CVE-2021-28509 (MACsec), stemming from the same root cause of credential management issues in TerminAttr and Octa.
- The conditions for exploitation are when either TerminAttr or Octa is enabled on the device, and IPsec or MACsec is configured on the same device.
- The advisory provides a clear list of affected EOS and TerminAttr versions, as well as affected platforms (Arista EOS-based products supporting IPsec or MACsec).
- The advisory also provides mitigation measures, namely disabling TerminAttr or Octa on affected devices, and resolution instructions, urging users to upgrade to specific remediated versions.