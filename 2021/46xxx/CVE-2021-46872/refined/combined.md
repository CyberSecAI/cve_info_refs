=== Content from github.com_4d65d637_20250115_084100.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fpull%2F19134)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fpull%2F19134)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=nim-lang%2FNim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[Nim](/nim-lang/Nim)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2FNim) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fnim-lang%2FNim)
* [Star
   16.7k](/login?return_to=%2Fnim-lang%2FNim)

* [Code](/nim-lang/Nim)
* [Issues
  2k](/nim-lang/Nim/issues)
* [Pull requests
  86](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects
  2](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

Additional navigation options

* [Code](/nim-lang/Nim)
* [Issues](/nim-lang/Nim/issues)
* [Pull requests](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnim-lang%2FNim%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnim-lang%2FNim%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fixes a possible 'javascript:' protocol exploit [backport:1.0] #19134

 Merged

[Araq](/Araq)
merged 5 commits into
[devel](/nim-lang/Nim/tree/devel "nim-lang/Nim:devel")
from
[araq-js-exploit](/nim-lang/Nim/tree/araq-js-exploit "nim-lang/Nim:araq-js-exploit")

Dec 10, 2021

 Merged

# [fixes a possible 'javascript:' protocol exploit [backport:1.0]](#top) #19134

[Araq](/Araq)
merged 5 commits into
[devel](/nim-lang/Nim/tree/devel "nim-lang/Nim:devel")
from
[araq-js-exploit](/nim-lang/Nim/tree/araq-js-exploit "nim-lang/Nim:araq-js-exploit")

Dec 10, 2021

[Conversation
8](/nim-lang/Nim/pull/19134)
[Commits
5](/nim-lang/Nim/pull/19134/commits)
[Checks
0](/nim-lang/Nim/pull/19134/checks)
[Files changed](/nim-lang/Nim/pull/19134/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Araq](https://avatars.githubusercontent.com/u/287816?s=60&v=4)](/Araq)

Copy link

Member

### @Araq **[Araq](/Araq)** commented [Nov 12, 2021](#issue-1051814152)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)

`[fixes a possible 'javascript:' protocol exploit [backport:1.0]](/nim-lang/Nim/pull/19134/commits/c785c54136db42c9105a25e470b73421bbde29bf "fixes a possible 'javascript:' protocol exploit [backport:1.0]")`

`[c785c54](/nim-lang/Nim/pull/19134/commits/c785c54136db42c9105a25e470b73421bbde29bf)`

[![dom96](https://avatars.githubusercontent.com/u/246651?s=60&v=4)](/dom96)

**[dom96](/dom96)**
reviewed
[Nov 12, 2021](#pullrequestreview-804680394)

 [View reviewed changes](/nim-lang/Nim/pull/19134/files/c785c54136db42c9105a25e470b73421bbde29bf)

Copy link

Contributor

### @dom96 **[dom96](/dom96)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks good, but this is in `renderImage`, do we need the same for links?

Sorry, something went wrong.

All reactions

[![juancarlospaco](https://avatars.githubusercontent.com/u/1189414?s=60&v=4)](/juancarlospaco)

**[juancarlospaco](/juancarlospaco)**
reviewed
[Nov 13, 2021](#pullrequestreview-805401759)

 [View reviewed changes](/nim-lang/Nim/pull/19134/files/c785c54136db42c9105a25e470b73421bbde29bf)

[lib/packages/docutils/rstgen.nim](/nim-lang/Nim/pull/19134/files/c785c54136db42c9105a25e470b73421bbde29bf#diff-9ee2bfe9943cc40e8ddfa9b2cfbd1e44a398c9b95d89c190a270137e022d8b27)
Outdated

|  |  | if scanf(target, "$w:", protocol): |
| --- | --- | --- |
|  |  | # if it has a protocol at all, ensure that it's not 'javascript:' or worse: |
|  |  | if cmpIgnoreCase(protocol, "http") == 0 or cmpIgnoreCase(protocol, "https") == 0 or |
|  |  | cmpIgnoreCase(protocol, "ftp") == 0: |

Copy link

Collaborator

### @juancarlospaco **[juancarlospaco](/juancarlospaco)** [Nov 13, 2021](#discussion_r748762860)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

What about other protocols like IRC, etc ?. ü§î

Sorry, something went wrong.

All reactions

[![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

`[add tests](/nim-lang/Nim/pull/19134/commits/90017f153a3aa8a4d9a7657d0a39d637c48171ec "add tests")`

`[90017f1](/nim-lang/Nim/pull/19134/commits/90017f153a3aa8a4d9a7657d0a39d637c48171ec)`

[![Araq](https://avatars.githubusercontent.com/u/287816?s=60&v=4)](/Araq)

**[Araq](/Araq)**
commented
[Nov 24, 2021](#pullrequestreview-815155658)

 [View reviewed changes](/nim-lang/Nim/pull/19134/files/90017f153a3aa8a4d9a7657d0a39d637c48171ec)

[tests/stdlib/trstgen.nim](/nim-lang/Nim/pull/19134/files/90017f153a3aa8a4d9a7657d0a39d637c48171ec#diff-07b00cecffd917e2c8a33adca6cf035cc9cb560ea8edde866d7af9fa043016ec)
Outdated

Show resolved

Hide resolved

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)

`[Update tests/stdlib/trstgen.nim](/nim-lang/Nim/pull/19134/commits/bcd92fc551c8c79f94928badca94dfeabc7c462c "Update tests/stdlib/trstgen.nim")`

`[bcd92fc](/nim-lang/Nim/pull/19134/commits/bcd92fc551c8c79f94928badca94dfeabc7c462c)`

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
added
the
[merge\_when\_passes\_CI](/nim-lang/Nim/labels/merge_when_passes_CI)
mergeable once green
label
[Nov 24, 2021](#event-5668185504)

[![@dom96](https://avatars.githubusercontent.com/u/246651?s=80&u=71db70f1b1e4b0fe826f80e641e85a833075f13d&v=4)](/dom96)

Copy link

Contributor

### **[dom96](/dom96)** commented [Nov 24, 2021](#issuecomment-978138657)

| Hello? Did you miss my question?  Looks good, but this is in renderImage, do we need the same for links? |
| --- |

All reactions

Sorry, something went wrong.

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=80&v=4)](/Araq)

Copy link

Member

Author

### **[Araq](/Araq)** commented [Nov 24, 2021](#issuecomment-978153659) ‚Ä¢ edited Loading

| No, I've read it (but I forgot to reply, sorry), but it seems to me that is the only place we missed because we already have this logic:  ``` proc isUrl(p: RstParser, i: int): bool =   result = p.tok[i+1].symbol == ":" and p.tok[i+2].symbol == "//" and     p.tok[i+3].kind == tkWord and     p.tok[i].symbol in ["http", "https", "ftp", "telnet", "file"]  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@dom96](https://avatars.githubusercontent.com/u/246651?s=80&u=71db70f1b1e4b0fe826f80e641e85a833075f13d&v=4)](/dom96)

Copy link

Contributor

### **[dom96](/dom96)** commented [Nov 24, 2021](#issuecomment-978154503) ‚Ä¢ edited Loading

| Where is the logic for rendering explicit links, specifically markdown ones? i.e. `[title][url-here.com]`. That should be fixed, if it somehow uses `renderImage` then fine but otherwise this doesn't fix that case. |
| --- |

All reactions

Sorry, something went wrong.

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=80&v=4)](/Araq)

Copy link

Member

Author

### **[Araq](/Araq)** commented [Nov 24, 2021](#issuecomment-978160521)

| Good point, `renderHyperlink` needs to be fixed too. |
| --- |

All reactions

Sorry, something went wrong.

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
removed
the
[merge\_when\_passes\_CI](/nim-lang/Nim/labels/merge_when_passes_CI)
mergeable once green
label
[Nov 24, 2021](#event-5668991438)

[![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

`[add the same logic for hyperlinks](/nim-lang/Nim/pull/19134/commits/3bad7a01e6e86844fde642f22d831a7d67af02cd "add the same logic for hyperlinks")`

`[3bad7a0](/nim-lang/Nim/pull/19134/commits/3bad7a01e6e86844fde642f22d831a7d67af02cd)`

[![Araq](https://avatars.githubusercontent.com/u/287816?s=60&v=4)](/Araq)

**[Araq](/Araq)**
commented
[Nov 26, 2021](#pullrequestreview-816458777)

 [View reviewed changes](/nim-lang/Nim/pull/19134/files/3bad7a01e6e86844fde642f22d831a7d67af02cd)

[lib/packages/docutils/rstgen.nim](/nim-lang/Nim/pull/19134/files/3bad7a01e6e86844fde642f22d831a7d67af02cd#diff-9ee2bfe9943cc40e8ddfa9b2cfbd1e44a398c9b95d89c190a270137e022d8b27)
Outdated

Show resolved

Hide resolved

[![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

`[move the logic into a proc](/nim-lang/Nim/pull/19134/commits/c91cb3c5787aae523b55ee7b9b6176ebd0c93bd8 "move the logic into a proc")`

`[c91cb3c](/nim-lang/Nim/pull/19134/commits/c91cb3c5787aae523b55ee7b9b6176ebd0c93bd8)`

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
closed this
[Dec 10, 2021](#event-5745739396)

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
reopened this
[Dec 10, 2021](#event-5745739526)

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
added
[Showstopper](/nim-lang/Nim/labels/Showstopper)
[merge\_when\_passes\_CI](/nim-lang/Nim/labels/merge_when_passes_CI)
mergeable once green
labels
[Dec 10, 2021](#event-5745740615)

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
merged commit [`9338aa2`](/nim-lang/Nim/commit/9338aa24977e84a33b9a7802eaff0777fcf4d9c3)
into
devel

[Dec 10, 2021](https://github.com/nim-lang/Nim/pull/19134#event-5746143289)

 [![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq)
[Araq](/Araq)
deleted the
araq-js-exploit

branch
[December 10, 2021 08:24](#event-5746143339)

[narimiran](/narimiran)
pushed a commit
that referenced
this pull request
[Dec 10, 2021](#ref-commit-4627512)
[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq) [![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

`[fixes a possible 'javascript:' protocol exploit [backport:1.0] (](/nim-lang/Nim/commit/46275126b89218e64844eee169e8ced05dd0e2d7 "fixes a possible 'javascript:' protocol exploit [backport:1.0] (#19134)

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit 9338aa24977e84a33b9a7802eaff0777fcf4d9c3)")[#19134](https://github.com/nim-lang/Nim/pull/19134)[)](/nim-lang/Nim/commit/46275126b89218e64844eee169e8ced05dd0e2d7 "fixes a possible 'javascript:' protocol exploit [backport:1.0] (#19134)

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit 9338aa24977e84a33b9a7802eaff0777fcf4d9c3)")`
‚Ä¶

`[4627512](/nim-lang/Nim/commit/46275126b89218e64844eee169e8ced05dd0e2d7)`

```
* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit [9338aa2](https://github.com/nim-lang/Nim/commit/9338aa24977e84a33b9a7802eaff0777fcf4d9c3))
```

[narimiran](/narimiran)
pushed a commit
that referenced
this pull request
[Dec 10, 2021](#ref-commit-17522d6)
[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq) [![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

`[fixes a possible 'javascript:' protocol exploit [backport:1.0] (](/nim-lang/Nim/commit/17522d6ae1444614be78b1002005513105f2893f "fixes a possible 'javascript:' protocol exploit [backport:1.0] (#19134)

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit 9338aa24977e84a33b9a7802eaff0777fcf4d9c3)")[#19134](https://github.com/nim-lang/Nim/pull/19134)[)](/nim-lang/Nim/commit/17522d6ae1444614be78b1002005513105f2893f "fixes a possible 'javascript:' protocol exploit [backport:1.0] (#19134)

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit 9338aa24977e84a33b9a7802eaff0777fcf4d9c3)")`
‚Ä¶

`[17522d6](/nim-lang/Nim/commit/17522d6ae1444614be78b1002005513105f2893f)`

```
* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit [9338aa2](https://github.com/nim-lang/Nim/commit/9338aa24977e84a33b9a7802eaff0777fcf4d9c3))
```

[![@a-mr](https://avatars.githubusercontent.com/u/1299583?s=40&v=4)](/a-mr)
[a-mr](/a-mr)
mentioned this pull request
[Feb 5, 2022](#ref-pullrequest-1111705696)

[Fix bug 27 of #17340
#19433](/nim-lang/Nim/pull/19433)
 Merged

[Clyybber](/Clyybber)
pushed a commit
to Clyybber/nimskull
that referenced
this pull request
[Feb 25, 2022](#ref-commit-eaca5d9)
[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq) [![@Clyybber](https://avatars.githubusercontent.com/u/14862103?s=40&v=4)](/Clyybber)

`[Merge upstream changes](/Clyybber/nimskull/commit/eaca5d90e9063b74750760e43be920f496dd32c2 "Merge upstream changes

Concerns these changes:
https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3

Excluded changes are:
https://github.com/nim-lang/Nim/pull/18963
https://github.com/nim-lang/Nim/pull/19003
https://github.com/nim-lang/Nim/pull/19043
https://github.com/nim-lang/Nim/pull/19055
https://github.com/nim-lang/Nim/pull/19053
https://github.com/nim-lang/Nim/pull/19064
https://github.com/nim-lang/Nim/pull/18642
https://github.com/nim-lang/Nim/pull/19062
https://github.com/nim-lang/Nim/pull/19082
https://github.com/nim-lang/Nim/pull/19090
https://github.com/nim-lang/Nim/pull/19077
https://github.com/nim-lang/Nim/pull/19021
https://github.com/nim-lang/Nim/pull/19100
https://github.com/nim-lang/Nim/pull/19102
https://github.com/nim-lang/Nim/pull/19111
https://github.com/nim-lang/Nim/pull/19115
https://github.com/nim-lang/Nim/pull/19133
https://github.com/nim-lang/Nim/pull/19142
https://github.com/nim-lang/Nim/pull/19158
https://github.com/nim-lang/Nim/pull/19129
https://github.com/nim-lang/Nim/pull/19137
https://github.com/nim-lang/Nim/pull/19168
https://github.com/nim-lang/Nim/pull/19156
https://github.com/nim-lang/Nim/pull/19147
https://github.com/nim-lang/Nim/pull/19180
https://github.com/nim-lang/Nim/pull/19183
https://github.com/nim-lang/Nim/pull/19182
https://github.com/nim-lang/Nim/pull/19187
https://github.com/nim-lang/Nim/pull/19179
https://github.com/nim-lang/Nim/pull/19209
https://github.com/nim-lang/Nim/pull/19210
https://github.com/nim-lang/Nim/pull/19207
https://github.com/nim-lang/Nim/pull/19219
https://github.com/nim-lang/Nim/pull/19195
https://github.com/nim-lang/Nim/pull/19212
https://github.com/nim-lang/Nim/pull/19134
https://github.com/nim-lang/Nim/pull/19235
https://github.com/nim-lang/Nim/pull/19252
https://github.com/nim-lang/Nim/pull/19196
https://github.com/nim-lang/Nim/pull/19295
https://github.com/nim-lang/Nim/pull/19301
https://github.com/nim-lang/Nim/pull/19181
https://github.com/nim-lang/Nim/pull/17223
https://github.com/nim-lang/Nim/pull/19370
https://github.com/nim-lang/Nim/pull/19385
https://github.com/nim-lang/Nim/pull/19307
https://github.com/nim-lang/Nim/pull/19394
https://github.com/nim-lang/Nim/pull/19399
https://github.com/nim-lang/Nim/pull/19390
https://github.com/nim-lang/Nim/pull/19407
https://github.com/nim-lang/Nim/pull/19419
https://github.com/nim-lang/Nim/pull/19421
https://github.com/nim-lang/Nim/pull/19363
https://github.com/nim-lang/Nim/pull/19406
https://github.com/nim-lang/Nim/pull/19431
https://github.com/nim-lang/Nim/pull/19455
https://github.com/nim-lang/Nim/pull/19461
https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e
https://github.com/nim-lang/Nim/pull/19462
https://github.com/nim-lang/Nim/pull/19442
https://github.com/nim-lang/Nim/pull/19437
https://github.com/nim-lang/Nim/pull/19433
https://github.com/nim-lang/Nim/pull/19512
https://github.com/nim-lang/Nim/pull/19487
https://github.com/nim-lang/Nim/pull/19543

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return \"\" when passed \"\"; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes https://github.com/nim-lang/Nim/issues/18775

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes https://github.com/nim-lang/Nim/issues/15435.

* Specify bug # in comment

Addresses https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes https://github.com/nim-lang/Nim/issues/16987 .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: https://github.com/nim-lang/Nim/pull/19084/files#r741203578

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes https://github.com/nim-lang/Nim/issues/15949.

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See https://nim-lang.org/docs/manual.html#pragmas
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676 for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: https://github.com/status-im/nimbus-eth2/issues/3121

Also add \"nimBuiltinSetjmp\" - mostly for benchmarking.

* fix for Apple's Clang++

Revert \"swap port to correct port order (#19177)\" (#19234)

This reverts commit 0d0c249074d6a1041de16108dc247396efef5513.

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase \"type\" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase \"basic\" type. Changing to \"Basic\" seems to solve these issues.

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows \"--styleCheck:usages --styleCheck:error\"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow https://github.com/nim-lang/Nim/pull/18681

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow @Vindaar's advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert \"unsafeAddr => addr (stdlib)\"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use \"stat\" rather than \"open\", \"seek\", and \"close\" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref https://github.com/nim-lang/Nim/issues/19463

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.")`
‚Ä¶

`[eaca5d9](/Clyybber/nimskull/commit/eaca5d90e9063b74750760e43be920f496dd32c2)`

```
Concerns these changes:
[nim-lang/Nim@727c637...340b5a1](https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3)

Excluded changes are:
[nim-lang/Nim#18963](https://github.com/nim-lang/Nim/pull/18963)
[nim-lang/Nim#19003](https://github.com/nim-lang/Nim/pull/19003)
[nim-lang/Nim#19043](https://github.com/nim-lang/Nim/pull/19043)
[nim-lang/Nim#19055](https://github.com/nim-lang/Nim/pull/19055)
[nim-lang/Nim#19053](https://github.com/nim-lang/Nim/pull/19053)
[nim-lang/Nim#19064](https://github.com/nim-lang/Nim/pull/19064)
[nim-lang/Nim#18642](https://github.com/nim-lang/Nim/pull/18642)
[nim-lang/Nim#19062](https://github.com/nim-lang/Nim/pull/19062)
[nim-lang/Nim#19082](https://github.com/nim-lang/Nim/pull/19082)
[nim-lang/Nim#19090](https://github.com/nim-lang/Nim/pull/19090)
[nim-lang/Nim#19077](https://github.com/nim-lang/Nim/pull/19077)
[nim-lang/Nim#19021](https://github.com/nim-lang/Nim/pull/19021)
[nim-lang/Nim#19100](https://github.com/nim-lang/Nim/pull/19100)
[nim-lang/Nim#19102](https://github.com/nim-lang/Nim/pull/19102)
[nim-lang/Nim#19111](https://github.com/nim-lang/Nim/pull/19111)
[nim-lang/Nim#19115](https://github.com/nim-lang/Nim/pull/19115)
[nim-lang/Nim#19133](https://github.com/nim-lang/Nim/pull/19133)
[nim-lang/Nim#19142](https://github.com/nim-lang/Nim/pull/19142)
[nim-lang/Nim#19158](https://github.com/nim-lang/Nim/pull/19158)
[nim-lang/Nim#19129](https://github.com/nim-lang/Nim/pull/19129)
[nim-lang/Nim#19137](https://github.com/nim-lang/Nim/pull/19137)
[nim-lang/Nim#19168](https://github.com/nim-lang/Nim/pull/19168)
[nim-lang/Nim#19156](https://github.com/nim-lang/Nim/pull/19156)
[nim-lang/Nim#19147](https://github.com/nim-lang/Nim/pull/19147)
[nim-lang/Nim#19180](https://github.com/nim-lang/Nim/pull/19180)
[nim-lang/Nim#19183](https://github.com/nim-lang/Nim/pull/19183)
[nim-lang/Nim#19182](https://github.com/nim-lang/Nim/pull/19182)
[nim-lang/Nim#19187](https://github.com/nim-lang/Nim/pull/19187)
[nim-lang/Nim#19179](https://github.com/nim-lang/Nim/pull/19179)
[nim-lang/Nim#19209](https://github.com/nim-lang/Nim/pull/19209)
[nim-lang/Nim#19210](https://github.com/nim-lang/Nim/pull/19210)
[nim-lang/Nim#19207](https://github.com/nim-lang/Nim/pull/19207)
[nim-lang/Nim#19219](https://github.com/nim-lang/Nim/pull/19219)
[nim-lang/Nim#19195](https://github.com/nim-lang/Nim/pull/19195)
[nim-lang/Nim#19212](https://github.com/nim-lang/Nim/pull/19212)
[nim-lang/Nim#19134](https://github.com/nim-lang/Nim/pull/19134)
[nim-lang/Nim#19235](https://github.com/nim-lang/Nim/pull/19235)
[nim-lang/Nim#19252](https://github.com/nim-lang/Nim/pull/19252)
[nim-lang/Nim#19196](https://github.com/nim-lang/Nim/pull/19196)
[nim-lang/Nim#19295](https://github.com/nim-lang/Nim/pull/19295)
[nim-lang/Nim#19301](https://github.com/nim-lang/Nim/pull/19301)
[nim-lang/Nim#19181](https://github.com/nim-lang/Nim/pull/19181)
[nim-lang/Nim#17223](https://github.com/nim-lang/Nim/pull/17223)
[nim-lang/Nim#19370](https://github.com/nim-lang/Nim/pull/19370)
[nim-lang/Nim#19385](https://github.com/nim-lang/Nim/pull/19385)
[nim-lang/Nim#19307](https://github.com/nim-lang/Nim/pull/19307)
[nim-lang/Nim#19394](https://github.com/nim-lang/Nim/pull/19394)
[nim-lang/Nim#19399](https://github.com/nim-lang/Nim/pull/19399)
[nim-lang/Nim#19390](https://github.com/nim-lang/Nim/pull/19390)
[nim-lang/Nim#19407](https://github.com/nim-lang/Nim/pull/19407)
[nim-lang/Nim#19419](https://github.com/nim-lang/Nim/pull/19419)
[nim-lang/Nim#19421](https://github.com/nim-lang/Nim/pull/19421)
[nim-lang/Nim#19363](https://github.com/nim-lang/Nim/pull/19363)
[nim-lang/Nim#19406](https://github.com/nim-lang/Nim/pull/19406)
[nim-lang/Nim#19431](https://github.com/nim-lang/Nim/pull/19431)
[nim-lang/Nim#19455](https://github.com/nim-lang/Nim/pull/19455)
[nim-lang/Nim#19461](https://github.com/nim-lang/Nim/pull/19461)
[nim-lang/Nim@cb894c7](https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e)
[nim-lang/Nim#19462](https://github.com/nim-lang/Nim/pull/19462)
[nim-lang/Nim#19442](https://github.com/nim-lang/Nim/pull/19442)
[nim-lang/Nim#19437](https://github.com/nim-lang/Nim/pull/19437)
[nim-lang/Nim#19433](https://github.com/nim-lang/Nim/pull/19433)
[nim-lang/Nim#19512](https://github.com/nim-lang/Nim/pull/19512)
[nim-lang/Nim#19487](https://github.com/nim-lang/Nim/pull/19487)
[nim-lang/Nim#19543](https://github.com/nim-lang/Nim/pull/19543)

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return "" when passed ""; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes [nim-lang/Nim#18775](https://github.com/nim-lang/Nim/issues/18775)

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes [nim-lang/Nim#15435](https://github.com/nim-lang/Nim/issues/15435).

* Specify bug # in comment

Addresses [nim-lang/Nim#19079 (comment)](https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547)

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes [nim-lang/Nim#16987](https://github.com/nim-lang/Nim/issues/16987) .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: <https://github.com/nim-lang/Nim/pull/19084/files#r741203578>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes [nim-lang/Nim#15949](https://github.com/nim-lang/Nim/issues/15949).

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See <https://nim-lang.org/docs/manual.html#pragmas>
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See [nim-lang/Nim#18146 (comment)](https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676) for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: [status-im/nimbus-eth2#3121](https://github.com/status-im/nimbus-eth2/issues/3121)

Also add "nimBuiltinSetjmp" - mostly for benchmarking.

* fix for Apple's Clang++

Revert "swap port to correct port order (#19177)" (#19234)

This reverts commit [0d0c249](https://github.com/Clyybber/nimskull/commit/0d0c249074d6a1041de16108dc247396efef5513).

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase "type" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase "basic" type. Changing to "Basic" seems to solve these issues.

<https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization>

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows "--styleCheck:usages --styleCheck:error"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow [nim-lang/Nim#18681](https://github.com/nim-lang/Nim/pull/18681)

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow [@Vindaar](https://github.com/Vindaar)'s advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert "unsafeAddr => addr (stdlib)"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit [nim-lang/Nim@5da931f](https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b) that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use "stat" rather than "open", "seek", and "close" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref [nim-lang/Nim#19463](https://github.com/nim-lang/Nim/issues/19463)

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.
```

[![@Clyybber](https://avatars.githubusercontent.com/u/14862103?s=40&u=56f5a335e1a6d292a8d10854a044b54a22399aa3&v=4)](/Clyybber)
[Clyybber](/Clyybber)
mentioned this pull request
[Feb 25, 2022](#ref-pullrequest-1149940266)

[Merge upstream changes
nim-works/nimskull#240](/nim-works/nimskull/pull/240)
 Merged

[Clyybber](/Clyybber)
pushed a commit
to Clyybber/nimskull
that referenced
this pull request
[Feb 25, 2022](#ref-commit-6534be0)
[![@Clyybber](https://avatars.githubusercontent.com/u/14862103?s=40&v=4)](/Clyybber)

`[Merge upstream changes](/Clyybber/nimskull/commit/6534be076c9f126ab9da24fbfc1bba3881d6503f "Merge upstream changes

Concerns these changes:
https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3

Excluded changes are:
https://github.com/nim-lang/Nim/pull/18963
https://github.com/nim-lang/Nim/pull/19003
https://github.com/nim-lang/Nim/pull/19043
https://github.com/nim-lang/Nim/pull/19055
https://github.com/nim-lang/Nim/pull/19053
https://github.com/nim-lang/Nim/pull/19064
https://github.com/nim-lang/Nim/pull/18642
https://github.com/nim-lang/Nim/pull/19062
https://github.com/nim-lang/Nim/pull/19082
https://github.com/nim-lang/Nim/pull/19090
https://github.com/nim-lang/Nim/pull/19077
https://github.com/nim-lang/Nim/pull/19021
https://github.com/nim-lang/Nim/pull/19100
https://github.com/nim-lang/Nim/pull/19102
https://github.com/nim-lang/Nim/pull/19111
https://github.com/nim-lang/Nim/pull/19115
https://github.com/nim-lang/Nim/pull/19133
https://github.com/nim-lang/Nim/pull/19142
https://github.com/nim-lang/Nim/pull/19158
https://github.com/nim-lang/Nim/pull/19129
https://github.com/nim-lang/Nim/pull/19137
https://github.com/nim-lang/Nim/pull/19168
https://github.com/nim-lang/Nim/pull/19156
https://github.com/nim-lang/Nim/pull/19147
https://github.com/nim-lang/Nim/pull/19180
https://github.com/nim-lang/Nim/pull/19183
https://github.com/nim-lang/Nim/pull/19182
https://github.com/nim-lang/Nim/pull/19187
https://github.com/nim-lang/Nim/pull/19179
https://github.com/nim-lang/Nim/pull/19209
https://github.com/nim-lang/Nim/pull/19210
https://github.com/nim-lang/Nim/pull/19207
https://github.com/nim-lang/Nim/pull/19219
https://github.com/nim-lang/Nim/pull/19195
https://github.com/nim-lang/Nim/pull/19212
https://github.com/nim-lang/Nim/pull/19134
https://github.com/nim-lang/Nim/pull/19235
https://github.com/nim-lang/Nim/pull/19252
https://github.com/nim-lang/Nim/pull/19196
https://github.com/nim-lang/Nim/pull/19295
https://github.com/nim-lang/Nim/pull/19301
https://github.com/nim-lang/Nim/pull/19181
https://github.com/nim-lang/Nim/pull/17223
https://github.com/nim-lang/Nim/pull/19370
https://github.com/nim-lang/Nim/pull/19385
https://github.com/nim-lang/Nim/pull/19307
https://github.com/nim-lang/Nim/pull/19394
https://github.com/nim-lang/Nim/pull/19399
https://github.com/nim-lang/Nim/pull/19390
https://github.com/nim-lang/Nim/pull/19407
https://github.com/nim-lang/Nim/pull/19419
https://github.com/nim-lang/Nim/pull/19421
https://github.com/nim-lang/Nim/pull/19363
https://github.com/nim-lang/Nim/pull/19406
https://github.com/nim-lang/Nim/pull/19431
https://github.com/nim-lang/Nim/pull/19455
https://github.com/nim-lang/Nim/pull/19461
https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e
https://github.com/nim-lang/Nim/pull/19462
https://github.com/nim-lang/Nim/pull/19442
https://github.com/nim-lang/Nim/pull/19437
https://github.com/nim-lang/Nim/pull/19433
https://github.com/nim-lang/Nim/pull/19512
https://github.com/nim-lang/Nim/pull/19487
https://github.com/nim-lang/Nim/pull/19543

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return \"\" when passed \"\"; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes https://github.com/nim-lang/Nim/issues/18775

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes https://github.com/nim-lang/Nim/issues/15435.

* Specify bug # in comment

Addresses https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes https://github.com/nim-lang/Nim/issues/16987 .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: https://github.com/nim-lang/Nim/pull/19084/files#r741203578

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes https://github.com/nim-lang/Nim/issues/15949.

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See https://nim-lang.org/docs/manual.html#pragmas
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676 for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: https://github.com/status-im/nimbus-eth2/issues/3121

Also add \"nimBuiltinSetjmp\" - mostly for benchmarking.

* fix for Apple's Clang++

Revert \"swap port to correct port order (#19177)\" (#19234)

This reverts commit 0d0c249074d6a1041de16108dc247396efef5513.

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase \"type\" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase \"basic\" type. Changing to \"Basic\" seems to solve these issues.

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows \"--styleCheck:usages --styleCheck:error\"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow https://github.com/nim-lang/Nim/pull/18681

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow @Vindaar's advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert \"unsafeAddr => addr (stdlib)\"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use \"stat\" rather than \"open\", \"seek\", and \"close\" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref https://github.com/nim-lang/Nim/issues/19463

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.")`
‚Ä¶

`[6534be0](/Clyybber/nimskull/commit/6534be076c9f126ab9da24fbfc1bba3881d6503f)`

```
Concerns these changes:
[nim-lang/Nim@727c637...340b5a1](https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3)

Excluded changes are:
[nim-lang/Nim#18963](https://github.com/nim-lang/Nim/pull/18963)
[nim-lang/Nim#19003](https://github.com/nim-lang/Nim/pull/19003)
[nim-lang/Nim#19043](https://github.com/nim-lang/Nim/pull/19043)
[nim-lang/Nim#19055](https://github.com/nim-lang/Nim/pull/19055)
[nim-lang/Nim#19053](https://github.com/nim-lang/Nim/pull/19053)
[nim-lang/Nim#19064](https://github.com/nim-lang/Nim/pull/19064)
[nim-lang/Nim#18642](https://github.com/nim-lang/Nim/pull/18642)
[nim-lang/Nim#19062](https://github.com/nim-lang/Nim/pull/19062)
[nim-lang/Nim#19082](https://github.com/nim-lang/Nim/pull/19082)
[nim-lang/Nim#19090](https://github.com/nim-lang/Nim/pull/19090)
[nim-lang/Nim#19077](https://github.com/nim-lang/Nim/pull/19077)
[nim-lang/Nim#19021](https://github.com/nim-lang/Nim/pull/19021)
[nim-lang/Nim#19100](https://github.com/nim-lang/Nim/pull/19100)
[nim-lang/Nim#19102](https://github.com/nim-lang/Nim/pull/19102)
[nim-lang/Nim#19111](https://github.com/nim-lang/Nim/pull/19111)
[nim-lang/Nim#19115](https://github.com/nim-lang/Nim/pull/19115)
[nim-lang/Nim#19133](https://github.com/nim-lang/Nim/pull/19133)
[nim-lang/Nim#19142](https://github.com/nim-lang/Nim/pull/19142)
[nim-lang/Nim#19158](https://github.com/nim-lang/Nim/pull/19158)
[nim-lang/Nim#19129](https://github.com/nim-lang/Nim/pull/19129)
[nim-lang/Nim#19137](https://github.com/nim-lang/Nim/pull/19137)
[nim-lang/Nim#19168](https://github.com/nim-lang/Nim/pull/19168)
[nim-lang/Nim#19156](https://github.com/nim-lang/Nim/pull/19156)
[nim-lang/Nim#19147](https://github.com/nim-lang/Nim/pull/19147)
[nim-lang/Nim#19180](https://github.com/nim-lang/Nim/pull/19180)
[nim-lang/Nim#19183](https://github.com/nim-lang/Nim/pull/19183)
[nim-lang/Nim#19182](https://github.com/nim-lang/Nim/pull/19182)
[nim-lang/Nim#19187](https://github.com/nim-lang/Nim/pull/19187)
[nim-lang/Nim#19179](https://github.com/nim-lang/Nim/pull/19179)
[nim-lang/Nim#19209](https://github.com/nim-lang/Nim/pull/19209)
[nim-lang/Nim#19210](https://github.com/nim-lang/Nim/pull/19210)
[nim-lang/Nim#19207](https://github.com/nim-lang/Nim/pull/19207)
[nim-lang/Nim#19219](https://github.com/nim-lang/Nim/pull/19219)
[nim-lang/Nim#19195](https://github.com/nim-lang/Nim/pull/19195)
[nim-lang/Nim#19212](https://github.com/nim-lang/Nim/pull/19212)
[nim-lang/Nim#19134](https://github.com/nim-lang/Nim/pull/19134)
[nim-lang/Nim#19235](https://github.com/nim-lang/Nim/pull/19235)
[nim-lang/Nim#19252](https://github.com/nim-lang/Nim/pull/19252)
[nim-lang/Nim#19196](https://github.com/nim-lang/Nim/pull/19196)
[nim-lang/Nim#19295](https://github.com/nim-lang/Nim/pull/19295)
[nim-lang/Nim#19301](https://github.com/nim-lang/Nim/pull/19301)
[nim-lang/Nim#19181](https://github.com/nim-lang/Nim/pull/19181)
[nim-lang/Nim#17223](https://github.com/nim-lang/Nim/pull/17223)
[nim-lang/Nim#19370](https://github.com/nim-lang/Nim/pull/19370)
[nim-lang/Nim#19385](https://github.com/nim-lang/Nim/pull/19385)
[nim-lang/Nim#19307](https://github.com/nim-lang/Nim/pull/19307)
[nim-lang/Nim#19394](https://github.com/nim-lang/Nim/pull/19394)
[nim-lang/Nim#19399](https://github.com/nim-lang/Nim/pull/19399)
[nim-lang/Nim#19390](https://github.com/nim-lang/Nim/pull/19390)
[nim-lang/Nim#19407](https://github.com/nim-lang/Nim/pull/19407)
[nim-lang/Nim#19419](https://github.com/nim-lang/Nim/pull/19419)
[nim-lang/Nim#19421](https://github.com/nim-lang/Nim/pull/19421)
[nim-lang/Nim#19363](https://github.com/nim-lang/Nim/pull/19363)
[nim-lang/Nim#19406](https://github.com/nim-lang/Nim/pull/19406)
[nim-lang/Nim#19431](https://github.com/nim-lang/Nim/pull/19431)
[nim-lang/Nim#19455](https://github.com/nim-lang/Nim/pull/19455)
[nim-lang/Nim#19461](https://github.com/nim-lang/Nim/pull/19461)
[nim-lang/Nim@cb894c7](https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e)
[nim-lang/Nim#19462](https://github.com/nim-lang/Nim/pull/19462)
[nim-lang/Nim#19442](https://github.com/nim-lang/Nim/pull/19442)
[nim-lang/Nim#19437](https://github.com/nim-lang/Nim/pull/19437)
[nim-lang/Nim#19433](https://github.com/nim-lang/Nim/pull/19433)
[nim-lang/Nim#19512](https://github.com/nim-lang/Nim/pull/19512)
[nim-lang/Nim#19487](https://github.com/nim-lang/Nim/pull/19487)
[nim-lang/Nim#19543](https://github.com/nim-lang/Nim/pull/19543)

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return "" when passed ""; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes [nim-lang/Nim#18775](https://github.com/nim-lang/Nim/issues/18775)

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes [nim-lang/Nim#15435](https://github.com/nim-lang/Nim/issues/15435).

* Specify bug # in comment

Addresses [nim-lang/Nim#19079 (comment)](https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547)

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes [nim-lang/Nim#16987](https://github.com/nim-lang/Nim/issues/16987) .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: <https://github.com/nim-lang/Nim/pull/19084/files#r741203578>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes [nim-lang/Nim#15949](https://github.com/nim-lang/Nim/issues/15949).

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See <https://nim-lang.org/docs/manual.html#pragmas>
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See [nim-lang/Nim#18146 (comment)](https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676) for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: [status-im/nimbus-eth2#3121](https://github.com/status-im/nimbus-eth2/issues/3121)

Also add "nimBuiltinSetjmp" - mostly for benchmarking.

* fix for Apple's Clang++

Revert "swap port to correct port order (#19177)" (#19234)

This reverts commit [0d0c249](https://github.com/Clyybber/nimskull/commit/0d0c249074d6a1041de16108dc247396efef5513).

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase "type" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase "basic" type. Changing to "Basic" seems to solve these issues.

<https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization>

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows "--styleCheck:usages --styleCheck:error"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow [nim-lang/Nim#18681](https://github.com/nim-lang/Nim/pull/18681)

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow [@Vindaar](https://github.com/Vindaar)'s advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert "unsafeAddr => addr (stdlib)"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit [nim-lang/Nim@5da931f](https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b) that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use "stat" rather than "open", "seek", and "close" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref [nim-lang/Nim#19463](https://github.com/nim-lang/Nim/issues/19463)

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.
```

[Clyybber](/Clyybber)
pushed a commit
to Clyybber/nimskull
that referenced
this pull request
[Feb 25, 2022](#ref-commit-c2961da)
[![@Clyybber](https://avatars.githubusercontent.com/u/14862103?s=40&v=4)](/Clyybber)

`[Merge upstream changes](/Clyybber/nimskull/commit/c2961dafa3648712ba6cb0e70cf15b1e26eade11 "Merge upstream changes

Concerns these changes:
https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3

Excluded changes are:
https://github.com/nim-lang/Nim/pull/18963
https://github.com/nim-lang/Nim/pull/19003
https://github.com/nim-lang/Nim/pull/19043
https://github.com/nim-lang/Nim/pull/19055
https://github.com/nim-lang/Nim/pull/19053
https://github.com/nim-lang/Nim/pull/19064
https://github.com/nim-lang/Nim/pull/18642
https://github.com/nim-lang/Nim/pull/19062
https://github.com/nim-lang/Nim/pull/19082
https://github.com/nim-lang/Nim/pull/19090
https://github.com/nim-lang/Nim/pull/19077
https://github.com/nim-lang/Nim/pull/19021
https://github.com/nim-lang/Nim/pull/19100
https://github.com/nim-lang/Nim/pull/19102
https://github.com/nim-lang/Nim/pull/19111
https://github.com/nim-lang/Nim/pull/19115
https://github.com/nim-lang/Nim/pull/19133
https://github.com/nim-lang/Nim/pull/19142
https://github.com/nim-lang/Nim/pull/19158
https://github.com/nim-lang/Nim/pull/19129
https://github.com/nim-lang/Nim/pull/19137
https://github.com/nim-lang/Nim/pull/19168
https://github.com/nim-lang/Nim/pull/19156
https://github.com/nim-lang/Nim/pull/19147
https://github.com/nim-lang/Nim/pull/19180
https://github.com/nim-lang/Nim/pull/19183
https://github.com/nim-lang/Nim/pull/19182
https://github.com/nim-lang/Nim/pull/19187
https://github.com/nim-lang/Nim/pull/19179
https://github.com/nim-lang/Nim/pull/19209
https://github.com/nim-lang/Nim/pull/19210
https://github.com/nim-lang/Nim/pull/19207
https://github.com/nim-lang/Nim/pull/19219
https://github.com/nim-lang/Nim/pull/19195
https://github.com/nim-lang/Nim/pull/19212
https://github.com/nim-lang/Nim/pull/19134
https://github.com/nim-lang/Nim/pull/19235
https://github.com/nim-lang/Nim/pull/19252
https://github.com/nim-lang/Nim/pull/19196
https://github.com/nim-lang/Nim/pull/19295
https://github.com/nim-lang/Nim/pull/19301
https://github.com/nim-lang/Nim/pull/19181
https://github.com/nim-lang/Nim/pull/17223
https://github.com/nim-lang/Nim/pull/19370
https://github.com/nim-lang/Nim/pull/19385
https://github.com/nim-lang/Nim/pull/19307
https://github.com/nim-lang/Nim/pull/19394
https://github.com/nim-lang/Nim/pull/19399
https://github.com/nim-lang/Nim/pull/19390
https://github.com/nim-lang/Nim/pull/19407
https://github.com/nim-lang/Nim/pull/19419
https://github.com/nim-lang/Nim/pull/19421
https://github.com/nim-lang/Nim/pull/19363
https://github.com/nim-lang/Nim/pull/19406
https://github.com/nim-lang/Nim/pull/19431
https://github.com/nim-lang/Nim/pull/19455
https://github.com/nim-lang/Nim/pull/19461
https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e
https://github.com/nim-lang/Nim/pull/19462
https://github.com/nim-lang/Nim/pull/19442
https://github.com/nim-lang/Nim/pull/19437
https://github.com/nim-lang/Nim/pull/19433
https://github.com/nim-lang/Nim/pull/19512
https://github.com/nim-lang/Nim/pull/19487
https://github.com/nim-lang/Nim/pull/19543

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return \"\" when passed \"\"; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes https://github.com/nim-lang/Nim/issues/18775

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes https://github.com/nim-lang/Nim/issues/15435.

* Specify bug # in comment

Addresses https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes https://github.com/nim-lang/Nim/issues/16987 .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: https://github.com/nim-lang/Nim/pull/19084/files#r741203578

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes https://github.com/nim-lang/Nim/issues/15949.

* Use the \"bug #NNNN\" comment syntax for consistency

Ref:
https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See https://nim-lang.org/docs/manual.html#pragmas
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676 for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: https://github.com/status-im/nimbus-eth2/issues/3121

Also add \"nimBuiltinSetjmp\" - mostly for benchmarking.

* fix for Apple's Clang++

Revert \"swap port to correct port order (#19177)\" (#19234)

This reverts commit 0d0c249074d6a1041de16108dc247396efef5513.

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase \"type\" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase \"basic\" type. Changing to \"Basic\" seems to solve these issues.

https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows \"--styleCheck:usages --styleCheck:error\"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow https://github.com/nim-lang/Nim/pull/18681

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow @Vindaar's advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert \"unsafeAddr => addr (stdlib)\"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to @konsumlamm

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use \"stat\" rather than \"open\", \"seek\", and \"close\" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref https://github.com/nim-lang/Nim/issues/19463

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.")`
‚Ä¶

`[c2961da](/Clyybber/nimskull/commit/c2961dafa3648712ba6cb0e70cf15b1e26eade11)`

```
Concerns these changes:
[nim-lang/Nim@727c637...340b5a1](https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3)

Excluded changes are:
[nim-lang/Nim#18963](https://github.com/nim-lang/Nim/pull/18963)
[nim-lang/Nim#19003](https://github.com/nim-lang/Nim/pull/19003)
[nim-lang/Nim#19043](https://github.com/nim-lang/Nim/pull/19043)
[nim-lang/Nim#19055](https://github.com/nim-lang/Nim/pull/19055)
[nim-lang/Nim#19053](https://github.com/nim-lang/Nim/pull/19053)
[nim-lang/Nim#19064](https://github.com/nim-lang/Nim/pull/19064)
[nim-lang/Nim#18642](https://github.com/nim-lang/Nim/pull/18642)
[nim-lang/Nim#19062](https://github.com/nim-lang/Nim/pull/19062)
[nim-lang/Nim#19082](https://github.com/nim-lang/Nim/pull/19082)
[nim-lang/Nim#19090](https://github.com/nim-lang/Nim/pull/19090)
[nim-lang/Nim#19077](https://github.com/nim-lang/Nim/pull/19077)
[nim-lang/Nim#19021](https://github.com/nim-lang/Nim/pull/19021)
[nim-lang/Nim#19100](https://github.com/nim-lang/Nim/pull/19100)
[nim-lang/Nim#19102](https://github.com/nim-lang/Nim/pull/19102)
[nim-lang/Nim#19111](https://github.com/nim-lang/Nim/pull/19111)
[nim-lang/Nim#19115](https://github.com/nim-lang/Nim/pull/19115)
[nim-lang/Nim#19133](https://github.com/nim-lang/Nim/pull/19133)
[nim-lang/Nim#19142](https://github.com/nim-lang/Nim/pull/19142)
[nim-lang/Nim#19158](https://github.com/nim-lang/Nim/pull/19158)
[nim-lang/Nim#19129](https://github.com/nim-lang/Nim/pull/19129)
[nim-lang/Nim#19137](https://github.com/nim-lang/Nim/pull/19137)
[nim-lang/Nim#19168](https://github.com/nim-lang/Nim/pull/19168)
[nim-lang/Nim#19156](https://github.com/nim-lang/Nim/pull/19156)
[nim-lang/Nim#19147](https://github.com/nim-lang/Nim/pull/19147)
[nim-lang/Nim#19180](https://github.com/nim-lang/Nim/pull/19180)
[nim-lang/Nim#19183](https://github.com/nim-lang/Nim/pull/19183)
[nim-lang/Nim#19182](https://github.com/nim-lang/Nim/pull/19182)
[nim-lang/Nim#19187](https://github.com/nim-lang/Nim/pull/19187)
[nim-lang/Nim#19179](https://github.com/nim-lang/Nim/pull/19179)
[nim-lang/Nim#19209](https://github.com/nim-lang/Nim/pull/19209)
[nim-lang/Nim#19210](https://github.com/nim-lang/Nim/pull/19210)
[nim-lang/Nim#19207](https://github.com/nim-lang/Nim/pull/19207)
[nim-lang/Nim#19219](https://github.com/nim-lang/Nim/pull/19219)
[nim-lang/Nim#19195](https://github.com/nim-lang/Nim/pull/19195)
[nim-lang/Nim#19212](https://github.com/nim-lang/Nim/pull/19212)
[nim-lang/Nim#19134](https://github.com/nim-lang/Nim/pull/19134)
[nim-lang/Nim#19235](https://github.com/nim-lang/Nim/pull/19235)
[nim-lang/Nim#19252](https://github.com/nim-lang/Nim/pull/19252)
[nim-lang/Nim#19196](https://github.com/nim-lang/Nim/pull/19196)
[nim-lang/Nim#19295](https://github.com/nim-lang/Nim/pull/19295)
[nim-lang/Nim#19301](https://github.com/nim-lang/Nim/pull/19301)
[nim-lang/Nim#19181](https://github.com/nim-lang/Nim/pull/19181)
[nim-lang/Nim#17223](https://github.com/nim-lang/Nim/pull/17223)
[nim-lang/Nim#19370](https://github.com/nim-lang/Nim/pull/19370)
[nim-lang/Nim#19385](https://github.com/nim-lang/Nim/pull/19385)
[nim-lang/Nim#19307](https://github.com/nim-lang/Nim/pull/19307)
[nim-lang/Nim#19394](https://github.com/nim-lang/Nim/pull/19394)
[nim-lang/Nim#19399](https://github.com/nim-lang/Nim/pull/19399)
[nim-lang/Nim#19390](https://github.com/nim-lang/Nim/pull/19390)
[nim-lang/Nim#19407](https://github.com/nim-lang/Nim/pull/19407)
[nim-lang/Nim#19419](https://github.com/nim-lang/Nim/pull/19419)
[nim-lang/Nim#19421](https://github.com/nim-lang/Nim/pull/19421)
[nim-lang/Nim#19363](https://github.com/nim-lang/Nim/pull/19363)
[nim-lang/Nim#19406](https://github.com/nim-lang/Nim/pull/19406)
[nim-lang/Nim#19431](https://github.com/nim-lang/Nim/pull/19431)
[nim-lang/Nim#19455](https://github.com/nim-lang/Nim/pull/19455)
[nim-lang/Nim#19461](https://github.com/nim-lang/Nim/pull/19461)
[nim-lang/Nim@cb894c7](https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e)
[nim-lang/Nim#19462](https://github.com/nim-lang/Nim/pull/19462)
[nim-lang/Nim#19442](https://github.com/nim-lang/Nim/pull/19442)
[nim-lang/Nim#19437](https://github.com/nim-lang/Nim/pull/19437)
[nim-lang/Nim#19433](https://github.com/nim-lang/Nim/pull/19433)
[nim-lang/Nim#19512](https://github.com/nim-lang/Nim/pull/19512)
[nim-lang/Nim#19487](https://github.com/nim-lang/Nim/pull/19487)
[nim-lang/Nim#19543](https://github.com/nim-lang/Nim/pull/19543)

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Begin commit listing:

use two underscores for easy demangling [backport:1.6] (#19028)

Add Elbrus 2000 architecture (#19024)

* Add Elbrus 2000 architecture

* Add e2k to niminst

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove exception (#18906)

allow converting static vars to `openArray` (#19035)

When assigning constant output to a seq, and then passing that static
seq to other functions that take `openArray`, the compiler may end up
producing errors, as it does not know how to convert `static[seq[T]]`
to `openArray[T]`. By ignoring the `static` wrapper on the type for
the purpose of determining data memory location and length, this gets
resolved cleanly. Unfortunately, it is relatively tricky to come up
with a minimal example, as there are followup problems from the failing
conversion, e.g., this may lead to `internal error: inconsistent
environment type`, instead of the relevant `openArrayLoc` error message.

use the correct header for TIOCGWINSZ on Solaris (#19037)

Minor update to terminal docs (#19056)

* Update terminal.nim

- Added some extra docs to cursorUp/Down/Forward/Backward
- I was able to use hideCursor and showCursor without adding stdout, removed the parameter
- Added docs to terminalHeight()* and terminalWidth()*

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Update lib/pure/terminal.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Added back f: file to cursor movement

* Removed unnecessary comments

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fix a tiny formating issue in doc/destructors.rst (#19058)

fix a tiny code snippet formatting issue in `doc/constructors.rst`, again (#19065)

Fix nimIdentNormalize, fixes #19067 (#19068)

* Make nimIdentNormalize return "" when passed ""; fixes #19067

Fixes #19067

* Add tests for nimIdentNormalize

fix #18971 (#19070) [backport:1.6]

since the example code return value from global variable, instead
of first argument, the `n.len` is 1 which causes compiler crashes.

fixes #19000 (#19032)

* fixes #19000

* progress

fix #18410 (Errors initializing an object of RootObj with the C++ backend) [backport] (#18836)

* fix #18410

* one line comment

* typo

* typo

* cover cpp

update numbers of lifetime-tracking hooks in doc/destructors.rst (#19088)

bootstrapping Nim compiler with `cpp --gc:orc` (#19087)

libs/impore/re: Add note about the requirement of `matches` to be pre-allocated (#19081)

Add few runnableExamples for `findBounds` for clarity.

Fixes [nim-lang/Nim#18775](https://github.com/nim-lang/Nim/issues/18775)

Add test for issue 15435 (#19079)

* Add test for issue 15435

Closes [nim-lang/Nim#15435](https://github.com/nim-lang/Nim/issues/15435).

* Specify bug # in comment

Addresses [nim-lang/Nim#19079 (comment)](https://github.com/nim-lang/Nim/pull/19079#discussion_r740279547)

manual: Document the use of `static` as a proc call (#19084)

* manual: Document the use of `static` as a proc call

Also adds tests.

Fixes [nim-lang/Nim#16987](https://github.com/nim-lang/Nim/issues/16987) .

* Update doc/manual.rst

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

* manual: Undocument usage of foo.static

foo.static and foo.static() are not expected to work.

Ref: <https://github.com/nim-lang/Nim/pull/19084/files#r741203578>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

manual: Document that comma propagates the default values of parameters (#19080)

* manual: Document that comma propagates the default values of parameters

Fixes [nim-lang/Nim#15949](https://github.com/nim-lang/Nim/issues/15949).

* Use the "bug #NNNN" comment syntax for consistency

Ref:
<https://nim-lang.github.io/Nim/contributing.html#writing-tests-stdlib>

> Always refer to a GitHub issue using the following exact syntax: bug
for tooling.

fixes #19011 [backport:1.6] (#19114)

Add deprecation pragmas in lib/deprecated/pure (#19113)

Deprecate `std/sharedlist` and `std/sharedtables` (#19112)

fix nimindexterm in rst2tex/doc2tex [backport] (#19106)

* fix nimindexterm (rst2tex/doc2tex) [backport]

* Add support for indexing in rst

Call {.cursor.} a pragma. (#19116)

* Call {.cursor.} a pragma.

Its hard to find .curser annotation while googling because all other things like it are called pragmas. See <https://nim-lang.org/docs/manual.html#pragmas>
Also the . in front of the name makes it hard to find and search for.

Can we just call it cursor pragma?

* Small fix for comment.

Remove tlsEmulation enabled from Windows + GCC config (#19119) [backport:1.6]

This flag has a very significant performance impact on programs compiled with --threads:on. It is also apparently not needed anymore for standard circumstances. Can we remove the config? See [nim-lang/Nim#18146 (comment)](https://github.com/nim-lang/Nim/issues/18146#issuecomment-876802676) for discussion and perf impact. [backport:1.6]

Add security tip for setCookie (#19117)

* Add security tip for setCookie

* Update lib/pure/cookies.nim

Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

* Update lib/pure/cookies.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>
Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>
Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

correct cookie docs (#19122)

refactoring: orc can use getThreadId() (#19123)

* refactoring: orc can use getThreadId()

* progress

fixed colorNames sorting mistake (#19125) [backport]

update manual (#19130) [backport]

Merge file size fields correctly on Windows (#19141)

* Merge file size fields correctly on Windows

Merge file size fields correctly on Windows

- Merge the two 32-bit file size fields from `BY_HANDLE_FILE_INFORMATION` correctly in `rawToFormalFileInfo`.
- Fixes #19135

* Update os.nim

Fix punycode.decode function (#19136)

* Refactor: rename proc to func

* Fix punycode.decode function

This function could only properly decode punycodes containing a single
encoded unicode character. As soon as there was more than one punycode
character group to decode it produced invalid output - the number of
characters was correct, but their position was not.

* Update tpunycode.nim

Co-authored-by: Clay Sweetser <Varriount@users.noreply.github.com>

Fix undeclared 'SYS_getrandom' on emscripten (#19144)

wrong spaces (3 => 2) (#19145)

`caseStmtMacros` no longer experimental, experimental manual refactor (#19173)

* `caseStmtMacros` no longer experimental, experimental manual refactor

* Update doc/manual.rst

* apply review suggestions

* apply review

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix inline syntax highlighting in system.nim (#19184)

swap port to correct port order (#19177)

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

feat: TLS-ALPN wrappers for OpenSSL (#19202)

Co-authored-by: Iced Quinn <icedquinn@iceworks.cc>

misc bugfixes [backport:1.2] (#19203)

treat do with pragmas but no parens as proc (#19191)

fixes #19188

[format minor] remove unnecessary spaces (#19216)

Making TCC work again on Windows --cpu:amd64 - fix #16326 (#19221)

* fix #16326

* removing comments

fixes a converter handling regression that caused private converters to leak into client modules; fixes #19213; [backport:1.6] (#19229)

Add support for LoongArch (#19223)

* Add support for LoongArch

* Update compiler/installer.ini

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

remove `std/sharedstrings` (#19228)

* remove std/sharedstrings

it has been broken since 0.18.0

* rephrase the changelog entry

add comments to spawn and pinnedSpawn (#19230)

`spawn` uses `nimSpawn3` internally and `pinnedSpawn` uses `nimSpawn4` internally. I comment it in order to help contributors get the gist of its functionality.

fixes an old ARC bug: the produced copy/sink operations don't copy the hidden type field for objects with enabled inheritance; fixes #19205 [backport:1.6] (#19232)

nimRawSetjmp: support Windows (#19197)

* nimRawSetjmp: support Windows

Using `_setjmp()` directly is required to avoid some rare (but very
annoying) exception-related stack corruption leading to segfaults on
Windows, with Mingw-w64 and SEH.
More details: [status-im/nimbus-eth2#3121](https://github.com/status-im/nimbus-eth2/issues/3121)

Also add "nimBuiltinSetjmp" - mostly for benchmarking.

* fix for Apple's Clang++

Revert "swap port to correct port order (#19177)" (#19234)

This reverts commit [0d0c249](https://github.com/Clyybber/nimskull/commit/0d0c249074d6a1041de16108dc247396efef5513).

move toDeque to after addLast (#19233) [backport:1.0]

Changes the order of procs definitions in order to avoid calling an undefined proc.

let Nim support Nimble 0.14 with lock-file support [backport:1.6] (#19236)

nimc.rst: fix table markup (#19239)

Various std net improvements (#19132)

* Variant of  that works with raw IpAddresses.

- Add doc tests for new net proc's.
- Aadd recvFrom impl
- Add recvFrom impl -- tweak handling data var

- Update lib/pure/net.nim
	Co-authored-by: Dominik Picheta <dominikpicheta@googlemail.com>

- cleaning up sendTo args
- remove extra connect test
- cleaning up sendTo args
- fix inet_ntop test
- fix test failing - byte len

* fix test failing - byte len

* debugging odd windows build failure

* debugging odd windows build failure

* more experiments to figure out the windows failure

* try manual assigment on InAddr

Co-authored-by: Jaremy Creechley <jaremy.creechley@panthalassa.com>

fix bug #14468 zero-width split (#19248)

basicopt.txt: Unify the format (#19251)

fix: fixes bug in CVerifyPeerUseEnvVars (#19247)

Previously CVerifyPeerUseEnvVars was not being passed into
scanSslCertificates, which meant that we weren't scanning
additional certificate locations given via the SSL_CERT_FILE and
SSL_CERT_DIR environment variables

suggestion to respect typedarray type (#19257)

* suggestion to respect typedarray

* Update jssys.nim

Co-authored-by: Sven Keller <s.keller@cortona.de>

fix #19244 - solves the problem of the InAddr object constructor in Windows. (#19259)

* Update winlean.nim

* Update tnet_ll.nim

Fixed typo in manual.rst unsafeAssign->uncheckedAssign. Fixes part 1 of #19266 (#19267)

use uppercase "type" for Proxy-Authorization header (#19273)

Some servers will reject authorization requests with a lowercase "basic" type. Changing to "Basic" seems to solve these issues.

<https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Proxy-Authorization>

Update colors.nim (#19274)

* Update colors.nim

Added `lightgray` alias to `lightgrey` and `...grey`aliases for the rest of the gray colors.
Added color `rebeccapurple`.
Fixed the incorrect values for the `PaleVioletRed` and `MediumPurple` colors.
This module should now be matching the CSS colors.
I used the seq[tuple] syntax for defining the names.

* Document colors changes.

Extract runnables that specify `doccmd` (#19275) [backport:1.6]

Fix build on FreeBSD/powerpc (#19282)

It's currently misdetected as powerpc64.

Fix #19107 (#19286) [backport]

fixes grammar typos [backport] (#19289)

fix 19292 (#19293)

Fix #19297 - fixing broken list after adding empty list (#19299)

* Update lists.nim

* Update tlists.nim

* removed check `if b.tail != nil`

The tail of the list being null it is still possible to retrieve its end by going through all nodes from the head. So checking for null from `b.tail` is unnecessary. However, setting `a.tail = b.tail` only if `a.head != nil`, so you don't break a good list with an already broken one.

fixes #16617 [backport] (#19300)

Update JS and nimscript import tests (#19306)

* add new modules, except experimental ones
* remove deprecated modules mersenne and sharedlist
* better describe why some modules fail and some modules don't

add compile time option for POSIX sigwait on Illumos/Solaris (#19296)

* add compile time option for POSIX sigwait on Illumos/Solaris

* fix link to documentation of `sigwait` on Illumos/Solaris

[docs] clarify the raised exception (#19308)

* [docs] clarify the raised exception

Lest developers wanna know what the exception is.

* Apply suggestions from [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

docs: Fix typo in tut1.rst (#19309)

Fix #19314 - fixing broken `DoublyLinkedList` after adding empty `DoublyLinkedList` (#19315) [backport]

* Update lists.nim

* Update tlists.nim

fixed typos (#19316)

devel: style fix (#19318)

this allows "--styleCheck:usages --styleCheck:error"

docs: Fix typo in tut1.rst (#19324)

correct the comments (#19322)

--expandArc

```
var
  a
  b
a = matrix(5, 5, 1.0)
b = matrix(5, 5, 2.0)
`=sink`(b, -
  let blitTmp = b
  wasMoved(b)
  blitTmp +
    a)
`=destroy`(b)
`=destroy`(a)
```

add std/private/win_getsysteminfo; refactor the usage of `GetSystemInfo` (#19310)

* add std/private/win_getsysteminfo

* import at the top level

* wrappers follow nep1 too

* follow review comment

Update net.nim (#19327) [backport]

Fix #19038 - making the Nim compiler work again on Windows XP (#19331)

* Update osenv.nim

* Update win_setenv.nim

* Update lib/pure/includes/osenv.nim

* Update lib/pure/includes/osenv.nim

* fixing cstring

Co-authored-by: Andreas Rumpf <rumpf_a@web.de>

fix nim-lang#19343 (#19344) [backport]

Ensure HttpClient onProgress is called once per second
Ensure that reported speed is accurate

stylecheck usages part two: stdlib cleanup (#19338)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

added filemode docs (#19346)

Fix `remove` on last node of singly-linked list [backport:1.6] (#19353)

fix stylecheck error with asyncdispatch (#19350)

* stylecheck usages part two: stdlib cleanup

typeinfo.nim: importCompilerProc => importcompilerproc

nre.nim: newLineFlags => newlineFlags

system.nim: JSRoot => JsRoot

ref #19319

* prefer importCompilerProc

* fix stylecheck error with asyncdispatch

it is a partial regression since #12842

* add tests

* don't use echo in tests

remove spaces between an identifier and a star (#19355)

It makes search easier by searching `+`* instead of `+` which filter lots of unexported versions.

Follow [nim-lang/Nim#18681](https://github.com/nim-lang/Nim/pull/18681)

bitsets.nim: cleanup (#19361)

make rst thread safe (#19369)

split for the convenience of review

docs: Mention `import foo {.all.}` syntax (#19377)

Mention the `import foo {.all.}` syntax in the manual,
with a caveat about private imports.
Also link to the experimental importutils module.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

update copyright year (#19381)

docs: Fix broken cross references to `rfind` in strutils (#19382) [backport]

Fixes three broken cross references to `rfind` in strutils.
Breakage due to signature changes of the `rfind` methods.

Co-authored-by: adigitoleo <adigitoleo@dissimulo.com>

move type operation section and remove deepcopy document (#19389)

ref #19173; because deepcopy is not fit for ORC/ARC which was used for spawn and spawn will be removed from compiler

deprecate unsafeAddr; extend addr (#19373)

* deprecate unsafeAddr; extend addr

addr is now available for all addressable locations, unsafeAddr is deprecated and become an alias for addr

* follow [@Vindaar](https://github.com/Vindaar)'s advice

* change the signature of addr

* unsafeAddr => addr (stdlib)

* Update changelog.md

* unsafeAddr => addr (tests)

* Revert "unsafeAddr => addr (stdlib)"

This reverts commit ab83c99c507048a8396e636bf22d55fdd84d7d1c.

* doc changes; thanks to [@konsumlamm](https://github.com/konsumlamm)

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

improve changelog a bit (#19400)

mangle names in nimbase.h using cppDefine (#19395) [backport]

mangle names in nimbase.h
fix comments

Optimize lent in JS [backport:1.6] (#19393)

* Optimize lent in JS [backport:1.6]

* addr on lent doesn't work anymore, don't use it

* use unsafeAddr  in test again for older versions

update deprecated example (#19415)

`toNimIdent` proc is deprecated, so I replaced it with `ident` proc

Improve Zshell completion (#19354)

fix stricteffects (nimsuggest/sexp) (#19405)

* fix stricteffects (nimsuggest/sexp)

* Update tstrict_effects3.nim

* Update tests/effects/tstrict_effects3.nim

suppress deprecated warnings (#19408)

* suppress deprecated warnings

once bump version to 1.7.3 enable deprecated messages

* deprecate later

add an example to setControlCHook (#19416)

* add an example to setControlCHook

* [skip CI] format example for setControlCHook

Co-authored-by: Nathan Blaxall <nathan.blaxall@actionstep.com>

fix term rewriting with sideeffect (#19410)

* fix term rewriting with sideeffect

fix #6217

* add tests

* Update tests/template/template_various.nim

Resolve cross file resolution errors in atomics (#19422) [backport:1.6]

* Resolve call undeclared routine testAndSet

* Fix undeclared field atomicType

Fix #11923 (#19427)

* Apply commit [nim-lang/Nim@5da931f](https://github.com/nim-lang/Nim/commit/5da931fe811717a45f2dd272ea6281979c3e8f0b) that was never merged (was part of a bigger PR). Should fix issue #11932

* add a generic object for custom pragma

os: faster getFileSize (#19438)

Use "stat" rather than "open", "seek", and "close" system calls.
The Windows implementation remains the same.

bugfix: varargs count as open arrays (#19447)

update outdated link (#19465)

Ref [nim-lang/Nim#19463](https://github.com/nim-lang/Nim/issues/19463)

Update jsfetch with latest API and fix missing bindings (#19473)

* Update with latest API and fix missing bindings

remove deprecated `Body`
remove implicit `cstring` convs
add `Headers` to `FetchOptions`
add `Request` init proc which takes `FetchOptions`

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* Update lib/std/jsfetch.nim

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

* remove experimental flag

Co-authored-by: Juan Carlos <juancarlospaco@gmail.com>

No longer segfault when using a typeclass with a self referencing type (#19467)

Clonkk fix2 11923 (#19451)

* fix nnkBracketExpr not compiling for getImpl on customPragmaNode

* fix test import

* fix alias not working with hasCustomPragmas

fix parseEnum cannot parse enum with const fields (#19466)

fix #19463

Add compilers and hints to default nim.cfg (#18424)

don't use a temp for addr [backport: 1.6] (#19503)

* don't use a temp for addr

fix #19497

* Update compiler/ccgcalls.nim

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

* add a test

Co-authored-by: konsumlamm <44230978+konsumlamm@users.noreply.github.com>

fixes #19404 by protecting the memory we borrow from. this replaces crashes with minor memory leaks which seems to be acceptable. In the longer run we need a better VM that didn't grow hacks over a decade. (#19515)

Co-authored-by: flywind <xzsflywind@gmail.com>

Remove backslash in glob pattern (#19524)

use OrderedTable instead of OrderedTableRef for mimedb (#19522)

* use OrderedTable instead of OrderedTableRef for mimedb

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

* added changelog entry for mimedb change

Signed-off-by: David Krause <enthus1ast@users.noreply.github.com>

Remove Deprecated oids.oidsToString (#19519)

* Remove deprecated oids.oidToString

* Remove deprecated oids.oidToString

Remove deprecated math.c_frexp (#19518)

* Remove Deprecated math proc

* Remove Deprecated math proc

* Remove Deprecated math proc

[testcase] genSym fails to make unique identifier for ref object types (#19506)

close #15118

Documentation: Fix word usage (#19529)

Update chcks.nim (#19540)

keep casing of noinit and noreturn pragmas consistently documented (#19535)

compile pragma: cache the result sooner (#19554)

extccomp.addExternalFileToCompile() relies on hashes to decide whether
an external C file needs recompilation or not.

Due to short-circuit evaluation of boolean expressions, the procedure
that generates a corresponding hash file is not called the first time an
external file is compiled, so an avoidable recompilation is triggered
the next build.

This patch fixes that by moving the proc call with a desired side
effect from its boolean expression, so it's executed unconditionally.
```

[bors](/apps/bors) bot
added a commit
to nim-works/nimskull
that referenced
this pull request
[Feb 26, 2022](#ref-commit-2a399aa)
[![@bors](https://avatars.githubusercontent.com/in/1847?s=40&v=4)](/apps/bors)

`[Merge](/nim-works/nimskull/commit/2a399aa3df5d3175c750f94d9be1cd535c0a3759 "Merge #240

240: Merge upstream changes r=Clyybber a=Clyybber

Concerns these changes:
https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3

Excluded changes are:
https://github.com/nim-lang/Nim/pull/18963
https://github.com/nim-lang/Nim/pull/19003
https://github.com/nim-lang/Nim/pull/19043
https://github.com/nim-lang/Nim/pull/19055
https://github.com/nim-lang/Nim/pull/19053
https://github.com/nim-lang/Nim/pull/19064
https://github.com/nim-lang/Nim/pull/18642
https://github.com/nim-lang/Nim/pull/19062
https://github.com/nim-lang/Nim/pull/19082
https://github.com/nim-lang/Nim/pull/19090
https://github.com/nim-lang/Nim/pull/19077
https://github.com/nim-lang/Nim/pull/19021
https://github.com/nim-lang/Nim/pull/19100
https://github.com/nim-lang/Nim/pull/19102
https://github.com/nim-lang/Nim/pull/19111
https://github.com/nim-lang/Nim/pull/19115
https://github.com/nim-lang/Nim/pull/19133
https://github.com/nim-lang/Nim/pull/19142
https://github.com/nim-lang/Nim/pull/19158
https://github.com/nim-lang/Nim/pull/19129
https://github.com/nim-lang/Nim/pull/19137
https://github.com/nim-lang/Nim/pull/19168
https://github.com/nim-lang/Nim/pull/19156
https://github.com/nim-lang/Nim/pull/19147
https://github.com/nim-lang/Nim/pull/19180
https://github.com/nim-lang/Nim/pull/19183
https://github.com/nim-lang/Nim/pull/19182
https://github.com/nim-lang/Nim/pull/19187
https://github.com/nim-lang/Nim/pull/19179
https://github.com/nim-lang/Nim/pull/19209
https://github.com/nim-lang/Nim/pull/19210
https://github.com/nim-lang/Nim/pull/19207
https://github.com/nim-lang/Nim/pull/19219
https://github.com/nim-lang/Nim/pull/19195
https://github.com/nim-lang/Nim/pull/19212
https://github.com/nim-lang/Nim/pull/19134
https://github.com/nim-lang/Nim/pull/19235
https://github.com/nim-lang/Nim/pull/19252
https://github.com/nim-lang/Nim/pull/19196
https://github.com/nim-lang/Nim/pull/19295
https://github.com/nim-lang/Nim/pull/19301
https://github.com/nim-lang/Nim/pull/19181
https://github.com/nim-lang/Nim/pull/17223
https://github.com/nim-lang/Nim/pull/19370
https://github.com/nim-lang/Nim/pull/19385
https://github.com/nim-lang/Nim/pull/19307
https://github.com/nim-lang/Nim/pull/19394
https://github.com/nim-lang/Nim/pull/19399
https://github.com/nim-lang/Nim/pull/19390
https://github.com/nim-lang/Nim/pull/19407
https://github.com/nim-lang/Nim/pull/19419
https://github.com/nim-lang/Nim/pull/19421
https://github.com/nim-lang/Nim/pull/19363
https://github.com/nim-lang/Nim/pull/19406
https://github.com/nim-lang/Nim/pull/19431
https://github.com/nim-lang/Nim/pull/19455
https://github.com/nim-lang/Nim/pull/19461
https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e
https://github.com/nim-lang/Nim/pull/19462
https://github.com/nim-lang/Nim/pull/19442
https://github.com/nim-lang/Nim/pull/19437
https://github.com/nim-lang/Nim/pull/19433
https://github.com/nim-lang/Nim/pull/19512
https://github.com/nim-lang/Nim/pull/19487
https://github.com/nim-lang/Nim/pull/19543

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Commit listing is in the commit message

Co-authored-by: The Nim Contributors <>") [#240](https://github.com/nim-works/nimskull/pull/240)`
‚Ä¶

`[2a399aa](/nim-works/nimskull/commit/2a399aa3df5d3175c750f94d9be1cd535c0a3759)`

```
240: Merge upstream changes r=Clyybber a=Clyybber

Concerns these changes:
[nim-lang/Nim@727c637...340b5a1](https://github.com/nim-lang/Nim/compare/727c6378d2464090564dbcd9bc8b9ac648467e38...340b5a1676062aa9bc7f17a2e078eaba96821bf3)

Excluded changes are:
[nim-lang/Nim#18963](https://github.com/nim-lang/Nim/pull/18963)
[nim-lang/Nim#19003](https://github.com/nim-lang/Nim/pull/19003)
[nim-lang/Nim#19043](https://github.com/nim-lang/Nim/pull/19043)
[nim-lang/Nim#19055](https://github.com/nim-lang/Nim/pull/19055)
[nim-lang/Nim#19053](https://github.com/nim-lang/Nim/pull/19053)
[nim-lang/Nim#19064](https://github.com/nim-lang/Nim/pull/19064)
[nim-lang/Nim#18642](https://github.com/nim-lang/Nim/pull/18642)
[nim-lang/Nim#19062](https://github.com/nim-lang/Nim/pull/19062)
[nim-lang/Nim#19082](https://github.com/nim-lang/Nim/pull/19082)
[nim-lang/Nim#19090](https://github.com/nim-lang/Nim/pull/19090)
[nim-lang/Nim#19077](https://github.com/nim-lang/Nim/pull/19077)
[nim-lang/Nim#19021](https://github.com/nim-lang/Nim/pull/19021)
[nim-lang/Nim#19100](https://github.com/nim-lang/Nim/pull/19100)
[nim-lang/Nim#19102](https://github.com/nim-lang/Nim/pull/19102)
[nim-lang/Nim#19111](https://github.com/nim-lang/Nim/pull/19111)
[nim-lang/Nim#19115](https://github.com/nim-lang/Nim/pull/19115)
[nim-lang/Nim#19133](https://github.com/nim-lang/Nim/pull/19133)
[nim-lang/Nim#19142](https://github.com/nim-lang/Nim/pull/19142)
[nim-lang/Nim#19158](https://github.com/nim-lang/Nim/pull/19158)
[nim-lang/Nim#19129](https://github.com/nim-lang/Nim/pull/19129)
[nim-lang/Nim#19137](https://github.com/nim-lang/Nim/pull/19137)
[nim-lang/Nim#19168](https://github.com/nim-lang/Nim/pull/19168)
[nim-lang/Nim#19156](https://github.com/nim-lang/Nim/pull/19156)
[nim-lang/Nim#19147](https://github.com/nim-lang/Nim/pull/19147)
[nim-lang/Nim#19180](https://github.com/nim-lang/Nim/pull/19180)
[nim-lang/Nim#19183](https://github.com/nim-lang/Nim/pull/19183)
[nim-lang/Nim#19182](https://github.com/nim-lang/Nim/pull/19182)
[nim-lang/Nim#19187](https://github.com/nim-lang/Nim/pull/19187)
[nim-lang/Nim#19179](https://github.com/nim-lang/Nim/pull/19179)
[nim-lang/Nim#19209](https://github.com/nim-lang/Nim/pull/19209)
[nim-lang/Nim#19210](https://github.com/nim-lang/Nim/pull/19210)
[nim-lang/Nim#19207](https://github.com/nim-lang/Nim/pull/19207)
[nim-lang/Nim#19219](https://github.com/nim-lang/Nim/pull/19219)
[nim-lang/Nim#19195](https://github.com/nim-lang/Nim/pull/19195)
[nim-lang/Nim#19212](https://github.com/nim-lang/Nim/pull/19212)
[nim-lang/Nim#19134](https://github.com/nim-lang/Nim/pull/19134)
[nim-lang/Nim#19235](https://github.com/nim-lang/Nim/pull/19235)
[nim-lang/Nim#19252](https://github.com/nim-lang/Nim/pull/19252)
[nim-lang/Nim#19196](https://github.com/nim-lang/Nim/pull/19196)
[nim-lang/Nim#19295](https://github.com/nim-lang/Nim/pull/19295)
[nim-lang/Nim#19301](https://github.com/nim-lang/Nim/pull/19301)
[nim-lang/Nim#19181](https://github.com/nim-lang/Nim/pull/19181)
[nim-lang/Nim#17223](https://github.com/nim-lang/Nim/pull/17223)
[nim-lang/Nim#19370](https://github.com/nim-lang/Nim/pull/19370)
[nim-lang/Nim#19385](https://github.com/nim-lang/Nim/pull/19385)
[nim-lang/Nim#19307](https://github.com/nim-lang/Nim/pull/19307)
[nim-lang/Nim#19394](https://github.com/nim-lang/Nim/pull/19394)
[nim-lang/Nim#19399](https://github.com/nim-lang/Nim/pull/19399)
[nim-lang/Nim#19390](https://github.com/nim-lang/Nim/pull/19390)
[nim-lang/Nim#19407](https://github.com/nim-lang/Nim/pull/19407)
[nim-lang/Nim#19419](https://github.com/nim-lang/Nim/pull/19419)
[nim-lang/Nim#19421](https://github.com/nim-lang/Nim/pull/19421)
[nim-lang/Nim#19363](https://github.com/nim-lang/Nim/pull/19363)
[nim-lang/Nim#19406](https://github.com/nim-lang/Nim/pull/19406)
[nim-lang/Nim#19431](https://github.com/nim-lang/Nim/pull/19431)
[nim-lang/Nim#19455](https://github.com/nim-lang/Nim/pull/19455)
[nim-lang/Nim#19461](https://github.com/nim-lang/Nim/pull/19461)
[nim-lang/Nim@cb894c7](https://github.com/nim-lang/Nim/commit/cb894c7094fb49014f85815a9dafc38b5dda743e)
[nim-lang/Nim#19462](https://github.com/nim-lang/Nim/pull/19462)
[nim-lang/Nim#19442](https://github.com/nim-lang/Nim/pull/19442)
[nim-lang/Nim#19437](https://github.com/nim-lang/Nim/pull/19437)
[nim-lang/Nim#19433](https://github.com/nim-lang/Nim/pull/19433)
[nim-lang/Nim#19512](https://github.com/nim-lang/Nim/pull/19512)
[nim-lang/Nim#19487](https://github.com/nim-lang/Nim/pull/19487)
[nim-lang/Nim#19543](https://github.com/nim-lang/Nim/pull/19543)

Excluded changes include major changes which require more consideration
and changes which don't apply to the current code anymore but could be
worth porting over still.

Excluded changes which only change the identifier casing in tests
or only concern code removed in nimskull aren't listed.

Commit listing is in the commit message

Co-authored-by: The Nim Contributors <>
```

[PMunch](/PMunch)
pushed a commit
to PMunch/Nim
that referenced
this pull request
[Mar 28, 2022](#ref-commit-8b10c58)
[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq) [![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&u=d238aaeb7aa3fe1fb4f5aa5a1c11c77bedcc27bf&v=4)](/narimiran) [![@PMunch](https://avatars.githubusercontent.com/u/2845482?s=40&v=4)](/PMunch)

`[fixes a possible 'javascript:' protocol exploit [backport:1.0] (](/PMunch/Nim/commit/8b10c5845f03aa25ac362c6e7d41624b433c3ebe "fixes a possible 'javascript:' protocol exploit [backport:1.0] (#19134)

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>")[nim-l‚Ä¶](https://github.com/nim-lang/Nim/pull/19134)`
‚Ä¶

`[8b10c58](/PMunch/Nim/commit/8b10c5845f03aa25ac362c6e7d41624b433c3ebe)`

```
[‚Ä¶ang#19134](https://github.com/nim-lang/Nim/pull/19134))

* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fpull%2F19134)

Reviewers

[![@juancarlospaco](https://avatars.githubusercontent.com/u/1189414?s=40&v=4)](/juancarlospaco) [juancarlospaco](/juancarlospaco)

juancarlospaco left review comments

[![@dom96](https://avatars.githubusercontent.com/u/246651?s=40&v=4)](/dom96) [dom96](/dom96)

dom96 left review comments

Assignees

No one assigned

Labels

[merge\_when\_passes\_CI](/nim-lang/Nim/labels/merge_when_passes_CI)
mergeable once green
[Showstopper](/nim-lang/Nim/labels/Showstopper)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=52&v=4)](/Araq) [![@dom96](https://avatars.githubusercontent.com/u/246651?s=52&v=4)](/dom96) [![@juancarlospaco](https://avatars.githubusercontent.com/u/1189414?s=52&v=4)](/juancarlospaco) [![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=52&v=4)](/narimiran)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from forum.nim-lang.org_38a3f6bb_20250115_084047.html ===




=== Content from github.com_78c0e3c4_20250115_084052.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fcompare%2Fv1.6.0...v1.6.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fcompare%2Fv1.6.0...v1.6.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=nim-lang%2FNim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[Nim](/nim-lang/Nim)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2FNim) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fnim-lang%2FNim)
* [Star
   16.7k](/login?return_to=%2Fnim-lang%2FNim)

* [Code](/nim-lang/Nim)
* [Issues
  2k](/nim-lang/Nim/issues)
* [Pull requests
  86](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects
  2](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

Additional navigation options

* [Code](/nim-lang/Nim)
* [Issues](/nim-lang/Nim/issues)
* [Pull requests](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

[Permalink](https://github.com/nim-lang/Nim/compare/nim-lang%3A727c637...nim-lang%3A9084d9b)
# Comparing changes

 Choose two branches to see what‚Äôs changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
nim-lang/Nim

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v1.6.0

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/nim-lang/Nim/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.6.2)

Could not load tags

Nothing to show

[{{ refName }}
default](/nim-lang/Nim/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.6.2)

 Loading

...

*head repository:*
nim-lang/Nim

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v1.6.2

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/nim-lang/Nim/compare/v1.6.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/nim-lang/Nim/compare/v1.6.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

17
contributors

[Commits
41](#commits_bucket)
[Files changed
73](#files_bucket)

 Loading

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can‚Äôt render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v1.6.0...v1.6.2`

  Retry

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_85f0114f_20250115_084103.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fnimforum)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fnimforum)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=nim-lang%2Fnimforum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[nimforum](/nim-lang/nimforum)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2Fnimforum) You must be signed in to change notification settings
* [Fork
  70](/login?return_to=%2Fnim-lang%2Fnimforum)
* [Star
   764](/login?return_to=%2Fnim-lang%2Fnimforum)

Lightweight alternative to Discourse written in Nim

[forum.nim-lang.org/](https://forum.nim-lang.org/ "https://forum.nim-lang.org/")

### License

[MIT license](/nim-lang/nimforum/blob/master/license.txt)

[764
stars](/nim-lang/nimforum/stargazers) [70
forks](/nim-lang/nimforum/forks) [Branches](/nim-lang/nimforum/branches) [Tags](/nim-lang/nimforum/tags) [Activity](/nim-lang/nimforum/activity)
 [Star](/login?return_to=%2Fnim-lang%2Fnimforum)

 [Notifications](/login?return_to=%2Fnim-lang%2Fnimforum) You must be signed in to change notification settings

* [Code](/nim-lang/nimforum)
* [Issues
  121](/nim-lang/nimforum/issues)
* [Pull requests
  8](/nim-lang/nimforum/pulls)
* [Actions](/nim-lang/nimforum/actions)
* [Projects
  0](/nim-lang/nimforum/projects)
* [Wiki](/nim-lang/nimforum/wiki)
* [Security](/nim-lang/nimforum/security)
* [Insights](/nim-lang/nimforum/pulse)

Additional navigation options

* [Code](/nim-lang/nimforum)
* [Issues](/nim-lang/nimforum/issues)
* [Pull requests](/nim-lang/nimforum/pulls)
* [Actions](/nim-lang/nimforum/actions)
* [Projects](/nim-lang/nimforum/projects)
* [Wiki](/nim-lang/nimforum/wiki)
* [Security](/nim-lang/nimforum/security)
* [Insights](/nim-lang/nimforum/pulse)

# nim-lang/nimforum

   ¬†master[Branches](/nim-lang/nimforum/branches)[Tags](/nim-lang/nimforum/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[662 Commits](/nim-lang/nimforum/commits/master/) | | |
| [.github](/nim-lang/nimforum/tree/master/.github ".github") | | [.github](/nim-lang/nimforum/tree/master/.github ".github") |  |  |
| [docker](/nim-lang/nimforum/tree/master/docker "docker") | | [docker](/nim-lang/nimforum/tree/master/docker "docker") |  |  |
| [localhost.local/public](/nim-lang/nimforum/tree/master/localhost.local/public "This path skips through empty directories") | | [localhost.local/public](/nim-lang/nimforum/tree/master/localhost.local/public "This path skips through empty directories") |  |  |
| [mockup](/nim-lang/nimforum/tree/master/mockup "mockup") | | [mockup](/nim-lang/nimforum/tree/master/mockup "mockup") |  |  |
| [public](/nim-lang/nimforum/tree/master/public "public") | | [public](/nim-lang/nimforum/tree/master/public "public") |  |  |
| [src](/nim-lang/nimforum/tree/master/src "src") | | [src](/nim-lang/nimforum/tree/master/src "src") |  |  |
| [tests](/nim-lang/nimforum/tree/master/tests "tests") | | [tests](/nim-lang/nimforum/tree/master/tests "tests") |  |  |
| [.gitignore](/nim-lang/nimforum/blob/master/.gitignore ".gitignore") | | [.gitignore](/nim-lang/nimforum/blob/master/.gitignore ".gitignore") |  |  |
| [.gitmodules](/nim-lang/nimforum/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/nim-lang/nimforum/blob/master/.gitmodules ".gitmodules") |  |  |
| [README.md](/nim-lang/nimforum/blob/master/README.md "README.md") | | [README.md](/nim-lang/nimforum/blob/master/README.md "README.md") |  |  |
| [license.txt](/nim-lang/nimforum/blob/master/license.txt "license.txt") | | [license.txt](/nim-lang/nimforum/blob/master/license.txt "license.txt") |  |  |
| [nimforum.nimble](/nim-lang/nimforum/blob/master/nimforum.nimble "nimforum.nimble") | | [nimforum.nimble](/nim-lang/nimforum/blob/master/nimforum.nimble "nimforum.nimble") |  |  |
| [setup.md](/nim-lang/nimforum/blob/master/setup.md "setup.md") | | [setup.md](/nim-lang/nimforum/blob/master/setup.md "setup.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# nimforum

NimForum is a light-weight forum implementation
with many similarities to Discourse. It is implemented in
the [Nim](https://nim-lang.org) programming
language and uses SQLite for its database.

## Examples in the wild

[![forum.nim-lang.org](https://camo.githubusercontent.com/9d26ac7dd8cf6d66275f0c4511c047a7966b49e2b9c8cce37967ff8be25033c7/68747470733a2f2f692e696d6775722e636f6d2f6864494635417a2e706e67)](https://forum.nim-lang.org)

[**forum.nim-lang.org**](https://forum.nim-lang.org)

## Features

* Efficient, type safe and clean **single-page application** developed using the
  [Karax](https://github.com/pragmagic/karax) and
  [Jester](https://github.com/dom96/jester) frameworks.
* **Utilizes SQLite** making set up much easier.
* Endlessly **customizable** using SASS.
* Spam blocking via new user sandboxing with great tools for moderators.
* reStructuredText enriched by Markdown to make formatting your posts a breeze.
* Search powered by SQLite's full-text search.
* Context-aware replies.
* Last visit tracking.
* Gravatar support.
* And much more!

## Setup

[See this document.](https://github.com/nim-lang/nimforum/blob/master/setup.md)

## Dependencies

The following lists the dependencies which you may need to install manually
in order to get NimForum running, compiled\*, or tested‚Ä†.

* libsass
* SQLite
* pcre
* Nim (and the Nimble package manager)\*
* [geckodriver](https://github.com/mozilla/geckodriver)‚Ä†
  + Firefox‚Ä†

[\*] Build time dependencies

[‚Ä†] Test time dependencies

## Development

Check out the tasks defined by this project's `nimforum.nimble` file by
running `nimble tasks`, as of writing they are:

```
backend              Compiles and runs the forum backend
runbackend           Runs the forum backend
frontend             Builds the necessary JS frontend (with CSS)
minify               Minifies the JS using Google's closure compiler
testdb               Creates a test DB (with admin account!)
devdb                Creates a test DB (with admin account!)
blankdb              Creates a blank DB
test                 Runs tester
fasttest             Runs tester without recompiling backend

```

To get up and running:

```
git clone https://github.com/nim-lang/nimforum
cd nimforum
git submodule update --init --recursive

# Setup the db with user: admin, pass: admin and some other users
nimble devdb

# Run this again if frontend code changes
nimble frontend

# Will start a server at localhost:5000
# MacOS users should note that port 5000 is reserved for AirPlay
# Set the entry "port" in forum.json to change the default
nimble backend
```

Development typically involves running `nimble devdb` which sets up the
database for development and testing, then `nimble backend`
which compiles and runs the forum's backend, and `nimble frontend`
separately to build the frontend. When making changes to the frontend it
should be enough to simply run `nimble frontend` again to rebuild. This command
will also build the SASS `nimforum.scss` file in the `public/css` directory.

### With docker

You can easily launch site on localhost if you have `docker` and `docker-compose`.
You don't have to setup dependencies (libsass, sglite, pcre, etc...) on you host PC.

To get up and running:

```
cd docker
docker-compose build
docker-compose up
```

And you can access local NimForum site.
Open <http://localhost:5000> .

# Troubleshooting

You might have to run `nimble install karax@#5f21dcd`, if setup fails
with:

```
andinus@circinus ~/projects/forks/nimforum> nimble --verbose devdb
[...]
 Installing karax@#5f21dcd
       Tip: 24 messages have been suppressed, use --verbose to show them.
     Error: No binaries built, did you specify a valid binary name?
[...]
     Error: Exception raised during nimble script execution

```

The hash needs to be replaced with the one specified in output.

# Copyright

Copyright (c) 2012-2018 Andreas Rumpf, Dominik Picheta.

All rights reserved.

# License

NimForum is licensed under the MIT license.

## About

Lightweight alternative to Discourse written in Nim

[forum.nim-lang.org/](https://forum.nim-lang.org/ "https://forum.nim-lang.org/")

### Topics

[nim](/topics/nim "Topic: nim")
[sqlite](/topics/sqlite "Topic: sqlite")
[forum](/topics/forum "Topic: forum")
[jester](/topics/jester "Topic: jester")
[karax-framework](/topics/karax-framework "Topic: karax-framework")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/nim-lang/nimforum/activity)
[Custom properties](/nim-lang/nimforum/custom-properties)
### Stars

[**764**
stars](/nim-lang/nimforum/stargazers)
### Watchers

[**21**
watching](/nim-lang/nimforum/watchers)
### Forks

[**70**
forks](/nim-lang/nimforum/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fnim-lang%2Fnimforum&report=nim-lang+%28user%29)

## [Releases 4](/nim-lang/nimforum/releases)

[v2.5.0
Latest

Sep 3, 2024](/nim-lang/nimforum/releases/tag/v2.5.0)
[+ 3 releases](/nim-lang/nimforum/releases)

## [Packages 0](/orgs/nim-lang/packages?repo_name=nimforum)

No packages published

## [Contributors 41](/nim-lang/nimforum/graphs/contributors)

[+ 27 contributors](/nim-lang/nimforum/graphs/contributors)

## Languages

* [Nim
  87.8%](/nim-lang/nimforum/search?l=nim)
* [HTML
  6.5%](/nim-lang/nimforum/search?l=html)
* [SCSS
  5.5%](/nim-lang/nimforum/search?l=scss)
* Other
  0.2%

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_4001c298_20250115_084049.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fcommit%2F46275126b89218e64844eee169e8ced05dd0e2d7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fcommit%2F46275126b89218e64844eee169e8ced05dd0e2d7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=nim-lang%2FNim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[Nim](/nim-lang/Nim)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2FNim) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fnim-lang%2FNim)
* [Star
   16.7k](/login?return_to=%2Fnim-lang%2FNim)

* [Code](/nim-lang/Nim)
* [Issues
  2k](/nim-lang/Nim/issues)
* [Pull requests
  86](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects
  2](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

Additional navigation options

* [Code](/nim-lang/Nim)
* [Issues](/nim-lang/Nim/issues)
* [Pull requests](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

## Commit

[Permalink](/nim-lang/Nim/commit/46275126b89218e64844eee169e8ced05dd0e2d7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fixes a possible 'javascript:' protocol exploit [backport:1.0] ([#19134](https://github.com/nim-lang/Nim/pull/19134))

[Browse files](/nim-lang/Nim/tree/46275126b89218e64844eee169e8ced05dd0e2d7)
Browse the repository at this point in the history

```
* fixes a possible 'javascript:' protocol exploit [backport:1.0]

* add tests

* Update tests/stdlib/trstgen.nim

* add the same logic for hyperlinks

* move the logic into a proc

Co-authored-by: narimiran <narimiran@disroot.org>
(cherry picked from commit [9338aa2](https://github.com/nim-lang/Nim/commit/9338aa24977e84a33b9a7802eaff0777fcf4d9c3))
```

* Loading branch information

[![@Araq](https://avatars.githubusercontent.com/u/287816?s=40&v=4)](/Araq) [![@narimiran](https://avatars.githubusercontent.com/u/16516130?s=40&v=4)](/narimiran)

[Araq](/nim-lang/Nim/commits?author=Araq "View all commits by Araq")
authored and
[narimiran](/nim-lang/Nim/commits?author=narimiran "View all commits by narimiran")
committed
Dec 10, 2021

1 parent
[83c472c](/nim-lang/Nim/commit/83c472c40dd17512023cb80abac1fba73bc0f29c)

commit 4627512

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**45 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/packages/docutils

  + lib/packages/docutils/rstgen.nim
    [rstgen.nim](#diff-9ee2bfe9943cc40e8ddfa9b2cfbd1e44a398c9b95d89c190a270137e022d8b27)
* tests/stdlib

  + tests/stdlib/trstgen.nim
    [trstgen.nim](#diff-07b00cecffd917e2c8a33adca6cf035cc9cb560ea8edde866d7af9fa043016ec)

## There are no files selected for viewing

15 changes: 14 additions & 1 deletion

15
[lib/packages/docutils/rstgen.nim](#diff-9ee2bfe9943cc40e8ddfa9b2cfbd1e44a398c9b95d89c190a270137e022d8b27 "lib/packages/docutils/rstgen.nim")

Show comments

[View file](/nim-lang/Nim/blob/46275126b89218e64844eee169e8ced05dd0e2d7/lib/packages/docutils/rstgen.nim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,7 +40,7 @@ |
|  |  | ## can be done by simply searching for [footnoteName]. |
|  |  |  |
|  |  | import strutils, os, hashes, strtabs, rstast, rst, highlite, tables, sequtils, |
|  |  | algorithm, parseutils, std/strbasics |
|  |  | algorithm, parseutils, std/strbasics, strscans |
|  |  |  |
|  |  | import ../../std/private/since |
|  |  |  |
| Expand Down  Expand Up | | @@ -823,6 +823,16 @@ proc renderOverline(d: PDoc, n: PRstNode, result: var string) = |
|  |  | rstnodeToRefname(n).idS, tmp, $chr(n.level - 1 + ord('A')), tocName]) |
|  |  |  |
|  |  |  |
|  |  | proc safeProtocol(linkStr: var string) = |
|  |  | var protocol = "" |
|  |  | if scanf(linkStr, "$w:", protocol): |
|  |  | # if it has a protocol at all, ensure that it's not 'javascript:' or worse: |
|  |  | if cmpIgnoreCase(protocol, "http") == 0 or cmpIgnoreCase(protocol, "https") == 0 or |
|  |  | cmpIgnoreCase(protocol, "ftp") == 0: |
|  |  | discard "it's fine" |
|  |  | else: |
|  |  | linkStr = "" |
|  |  |  |
|  |  | proc renderTocEntry(d: PDoc, e: TocEntry, result: var string) = |
|  |  | dispA(d.target, result, |
|  |  | "<li><a class=\"reference\" id=\"$1\_toc\" href=\"#$1\">$2</a></li>\n", |
| Expand Down  Expand Up | | @@ -887,6 +897,8 @@ proc renderImage(d: PDoc, n: PRstNode, result: var string) = |
|  |  |  |
|  |  | # support for `:target:` links for images: |
|  |  | var target = esc(d.target, getFieldValue(n, "target").strip(), escMode=emUrl) |
|  |  | safeProtocol(target) |
|  |  |  |
|  |  | if target.len > 0: |
|  |  | # `htmlOut` needs to be of the following format for link to work for images: |
|  |  | # <a class="reference external" href="target"><img src=\"$1\"$2/></a> |
| Expand Down  Expand Up | | @@ -1187,6 +1199,7 @@ proc renderHyperlink(d: PDoc, text, link: PRstNode, result: var string, external |
|  |  | d.escMode = emUrl |
|  |  | renderRstToOut(d, link, linkStr) |
|  |  | d.escMode = mode |
|  |  | safeProtocol(linkStr) |
|  |  | var textStr = "" |
|  |  | renderRstToOut(d, text, textStr) |
|  |  | if external: |
| Expand Down | |  |

35 changes: 31 additions & 4 deletions

35
[tests/stdlib/trstgen.nim](#diff-07b00cecffd917e2c8a33adca6cf035cc9cb560ea8edde866d7af9fa043016ec "tests/stdlib/trstgen.nim")

Show comments

[View file](/nim-lang/Nim/blob/46275126b89218e64844eee169e8ced05dd0e2d7/tests/stdlib/trstgen.nim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -398,7 +398,7 @@ Some chapter |
|  |  |  |
|  |  | Level2 |
|  |  | ------ |
|  |  |  |
|  |  |  |
|  |  | Level3 |
|  |  | ~~~~~~ |
|  |  |  |
| Expand All | | @@ -407,7 +407,7 @@ Some chapter |
|  |  |  |
|  |  | More |
|  |  | ~~~~ |
|  |  |  |
|  |  |  |
|  |  | Another |
|  |  | ------- |
|  |  |  |
| Expand Down  Expand Up | | @@ -683,7 +683,7 @@ Test1 |
|  |  | test "RST line blocks": |
|  |  | let input2 = dedent""" |
|  |  | Paragraph1 |
|  |  |  |
|  |  |  |
|  |  | | |
|  |  |  |
|  |  | Paragraph2""" |
| Expand All | | @@ -704,7 +704,7 @@ Test1 |
|  |  | # check that '| ' with a few spaces is still parsed as new line |
|  |  | let input4 = dedent""" |
|  |  | | xxx |
|  |  | | |
|  |  | | |
|  |  | | zzz""" |
|  |  |  |
|  |  | let output4 = input4.toHtml |
| Expand Down  Expand Up | | @@ -1548,3 +1548,30 @@ suite "RST/Code highlight": |
|  |  |  |
|  |  | check strip(rstToHtml(pythonCode, {}, newStringTable(modeCaseSensitive))) == |
|  |  | strip(expected) |
|  |  |  |
|  |  |  |
|  |  | suite "invalid targets": |
|  |  | test "invalid image target": |
|  |  | let input1 = dedent """.. image:: /images/myimage.jpg |
|  |  | :target: https://bar.com |
|  |  | :alt: Alt text for the image""" |
|  |  | let output1 = input1.toHtml |
|  |  | check output1 == """<a class="reference external" href="https://bar.com"><img src="/images/myimage.jpg" alt="Alt text for the image"/></a>""" |
|  |  |  |
|  |  | let input2 = dedent """.. image:: /images/myimage.jpg |
|  |  | :target: javascript://bar.com |
|  |  | :alt: Alt text for the image""" |
|  |  | let output2 = input2.toHtml |
|  |  | check output2 == """<img src="/images/myimage.jpg" alt="Alt text for the image"/>""" |
|  |  |  |
|  |  | let input3 = dedent """.. image:: /images/myimage.jpg |
|  |  | :target: bar.com |
|  |  | :alt: Alt text for the image""" |
|  |  | let output3 = input3.toHtml |
|  |  | check output3 == """<a class="reference external" href="bar.com"><img src="/images/myimage.jpg" alt="Alt text for the image"/></a>""" |
|  |  |  |
|  |  | test "invalid links": |
|  |  | check("(([Nim](https://nim-lang.org/)))".toHtml == |
|  |  | """((<a class="reference external" href="https://nim-lang.org/">Nim</a>))""") |
|  |  | check("(([Nim](javascript://nim-lang.org/)))".toHtml == |
|  |  | """((<a class="reference external" href="">Nim</a>))""") |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4627512`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fcommit%2F46275126b89218e64844eee169e8ced05dd0e2d7) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


