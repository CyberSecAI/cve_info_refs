The provided content relates to CVE-2021-46116.

**Root cause of vulnerability:**
The vulnerability stems from the lack of sufficient checks during the installation of templates in JPress. Specifically, the `io.jpress.web.admin._TemplateController#doInstall` function unpacks a zip file containing the template to the `classes/webapp/templates` directory without proper validation, allowing the upload of malicious files.

**Weaknesses/vulnerabilities present:**
- Unrestricted file upload: The system allows uploading of arbitrary zip files as templates.
- Insecure file extraction: The uploaded zip files are extracted directly to the template directory without proper sanitization of the file names and contents.
- Template injection: The application uses the Velocity template engine which can be exploited via template injection.
- Insufficient input validation allows for the inclusion of malicious code in the template.

**Impact of exploitation:**
- Remote code execution (RCE): By crafting a malicious template, an attacker can achieve remote code execution on the server. The attacker leverages template injection using fastjson to execute arbitrary JavaScript code, which then executes system commands.

**Attack vectors:**
- Uploading a malicious zip file via the template installation feature in the JPress admin panel.
- Triggering the execution of the malicious template by using the template preview functionality with a crafted `template` parameter in the GET request.

**Required attacker capabilities/position:**
- The attacker needs access to the JPress administration panel. The attacker also needs to know the upload functionality and how to trigger the template rendering.
- The attacker must be able to upload a malicious zip file disguised as a template.
- The attacker should be able to craft the malicious template to achieve RCE.