The provided content is related to the vulnerability described in CVE-2021-46871.

**Root cause of vulnerability:**
The `class` attribute in HEEx (HTML-aware Elixir) templates was not properly sanitized, allowing for the injection of malicious code.

**Weaknesses/vulnerabilities present:**
Cross-Site Scripting (XSS) vulnerability in the `class` attribute of HEEx templates in the `phoenix_html` library.

**Impact of exploitation:**
An attacker could inject arbitrary JavaScript code through the `class` attribute, which could then be executed in the context of a user's browser. This could lead to various malicious activities such as:
* Stealing user cookies or session tokens
* Redirecting users to malicious websites
* Defacing the web page
* Performing actions on behalf of the user

**Attack vectors:**
An attacker could inject malicious HTML containing the JavaScript payload in the `class` attribute, which is then rendered by the application using the vulnerable `phoenix_html` library.

**Required attacker capabilities/position:**
The attacker needs to be able to control the value of the `class` attribute in the HEEx template. This could be achieved through:
*  User input that is not properly sanitized before being used in the class attribute.
*  Compromised data sources that are used to populate the class attribute.