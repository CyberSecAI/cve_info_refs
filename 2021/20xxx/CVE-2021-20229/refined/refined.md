```
{
  "CVE-2021-20229": {
    "description": "PostgreSQL versions 9.5 prior to 9.5.25, 9.6 prior to 9.6.21, 10.0 prior to 10.16, 11.0 prior to 11.11, 12.0 prior to 12.6, and 13.0 prior to 13.2 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information.",
    "affected_products": [
      "PostgreSQL versions 9.5 prior to 9.5.25",
      "PostgreSQL versions 9.6 prior to 9.6.21",
      "PostgreSQL versions 10.0 prior to 10.16",
      "PostgreSQL versions 11.0 prior to 11.11",
      "PostgreSQL versions 12.0 prior to 12.6",
      "PostgreSQL versions 13.0 prior to 13.2"
     ],
    "root_cause": "The vulnerability stems from a flaw in how PostgreSQL handles column-level SELECT privileges for join aliases. Specifically, functions like scanNSItemForColumn, expandNSItemAttrs, and ExpandSingleTable were passing the wrong Range Table Entry (RTE) to markVarForSelectPriv when dealing with join operations. They were passing the join RTE instead of the base table's RTE. This resulted in the base table's selectedCols bitmap not being filled correctly, leading to an understatement of the columns read by the query.",
    "weaknesses": [
      "Improper handling of column-level SELECT privileges",
      "Incorrect RTE passed during join alias processing",
      "Incomplete column-usage bitmaps"
    ],
    "impact": "Successful exploitation could lead to disclosure of sensitive information, allowing an authenticated user with SELECT privilege on a single column to craft a query that returns all columns of the table.",
    "attack_vector": "An authenticated remote attacker can exploit this vulnerability by executing malicious crafted queries.",
    "attacker_capabilities": "The attacker needs to be an authenticated user with at least SELECT privilege on one column of a table in the PostgreSQL database.",
     "additional_details": [
        "The vulnerability was introduced by commit 9ce77d75c and affects PostgreSQL version 13 and prior.",
       "Stored views that use column-level privileges will have incomplete column-usage bitmaps and should be re-parsed by executing 'CREATE OR REPLACE' on user-defined views.",
        "NetApp products incorporate PostgreSQL and are also affected. However, specific NetApp products are not identified as being affected in the provided information."
     ]
  }
}
```