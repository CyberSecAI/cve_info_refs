=== Content from www.powercms.jp_6a4707d9_20250114_202253.html ===


[![PowerCMS™](/common/images/2018/logo_powercms.svg)](/)

* [お問い合わせ](/inquiry/)
* [PowerCMS ブログ](/blog/)

* [ログイン](https://www.powercms.jp/members/)
* [今すぐ購入](/inquiry/buy.html)

* [PowerCMS](/products/)
* [PowerCMSクラウド](/cloud/)
* [オプションサービス](/options/)
* [事例紹介](/case-studies/)
* [よくあるご質問](/faq/)
* [パートナー](/partner/)

| [ブログ] [PowerCMS 6 でのアップデートまとめ](https://www.powercms.jp/blog/2022/03/powercms_6_overview.html) を追加しました。 |
| --- |
| [ブログ] [PowerCMS サポートの実績 (2024年12月)](https://www.powercms.jp/blog/2025/01/support-achievements-202412.html) を追加しました。 |
| [ブログ] [展示会「第22回【東京】総務・人事・経理 Week 秋」を見学してきました](https://www.powercms.jp/blog/2024/12/20241004-report.html) を追加しました。 |
| [新着情報] [PowerCMSクラウド環境での設定変更予定のお知らせ](https://www.powercms.jp/news/modify_virtualhost_behavior.html) を追加しました。 |

# 新着情報

[ホーム](/) >
[新着情報](https://www.powercms.jp/news/) >
*PowerCMS 5.19 / 4.49 / 3.295 向け修正ファイルについて (XMLRPC …*

* [前の記事](https://www.powercms.jp/news/xmlrpc-api-202110.html)
* [全エントリー一覧](/news/index.html)
* [次の記事](https://www.powercms.jp/news/xmlrpc-api-provision-202111.html)
## PowerCMS 5.19 / 4.49 / 3.295 向け修正ファイルについて (XMLRPC API における OS コマンド・インジェクション(JVN#17645965)の脆弱性対策)

XMLRPC API 機能について新たな脆弱性 ([JVN#7602487](https://jvn.jp/jp/JVN76024879/)) が存在することがわかりました。下記、最新のアナウンスを参照してください。 (2022年8月31日)

* [XMLRPC API におけるコマンド・インジェクションの脆弱性対策 (JVN#7602487)](https://www.powercms.jp/news/xmlrpc-api-provision-202208.html)

10月21日にご案内致しました XMLRPC API おける OS コマンド・インジェクション(JVN#17645965)の脆弱性について対策の修正ファイルを提供いたします。

11月25日、JVN に掲載されました内容も本件の脆弱性の件になります。XMLRPC API 機能について新たに脆弱性が見つかったわけではございませんので誤解されませんようお願いいたします。

* [JVN#17645965: PowerCMS の XMLRPC API における OS コマンドインジェクションの脆弱性](https://jvn.jp/jp/JVN17645965/index.html)

サポートサイトの内容をご確認の上環境へ適用をお願いいたします。

お客様にはご迷惑をおかけいたしますこと、深くお詫び申し上げます。

### 影響を受けるバージョン

* PowerCMS 5.19 / 4.49 /3.295 を含む以前のバージョン

※ サポートを終了しておりますバージョンについては記載しておりません。

#### XMLRPC API を利用していない場合の対策

XMLRPC API を利用していない場合、XMLRPC API 機能を利用できなくすることで対策が行えますが、PowerCMS を CGI/FastCGI/PSGI で利用しているかによってその方法が異なります。

##### PowerCMS を CGI/FastCGI で利用している場合

下記のファイルについて、サーバーからファイルを削除したりパーミッションを付与しないようにするなど、動作しないようにしてください。

* mt-xmlrpc.cgi

※ PowerCMS の環境変数 [XMLRPCScript](https://www.powercms.jp/products/document/config-directives/xmlrpcscript.html) を設定されている場合、`mt-xmlrpc.cgi` をリネームして利用されている可能性があり、リネーム後のファイルを見つけて対策を行ってください。

##### PowerCMS を PSGI で利用している場合

環境変数 [RestrictedPSGIApp](https://www.powercms.jp/products/document/config-directives/restrictedpsgiapp.html) を設定し、XMLRPC API を禁止してください。

```

RestrictedPSGIApp  xmlrpc

```
#### XMLRPC API を利用している場合の対策

12月16日、修正ファイルの内容について対策が不足していることがわかりましたため修正ファイルを差し替えました。

修正ファイルをダウンロードして、ご利用の PowerCMS へ適用してください。

* [PowerCMS 5.19 / 4.49 / 3.295 向け修正ファイルについて (XMLRPC API における OS コマンド・インジェクションの脆弱性対策)](https://www.powercms.jp/members/20211022-004601.html) (ログインが必要です)

修正ファイルを適用できない場合、mt-xmlrpc.cgi へのアクセスを信頼のおけるアクセス元のみに限定したり HTTP 認証を設定するなどアクセスを制限してください。

### 脆弱性を利用した攻撃を受けてしまった場合

脆弱性に対策を行う前に不正アクセスが行われている可能性が見られる場合には下記ページの内容を参考に調査・対応してください。

* [PowerCMS の XMLRPC API における OS コマンド・インジェクションへの対応 | 新着情報](https://www.powercms.jp/news/xmlrpc-api-provision-202111.html.html)

### サポートサイト

サポートサイトへ初めてアクセスされる方は、お手数ですがまず[サインアップ](https://www.powercms.jp/members/)を行ってください(ライセンスコードが必要です)。

公開日
2021年10月22日
更新日
2022年9月2日

## 新着情報

* [重要なお知らせ](https://www.powercms.jp/news/notice/)
* [プレスリリース](https://www.powercms.jp/news/press/)
* [製品リリース情報](https://www.powercms.jp/news/release/)
* [イベント・セミナー情報](https://www.powercms.jp/news/seminar/)
* [トピックス](https://www.powercms.jp/news/topics/)

* [![PowerCMS クラウド](/images/banner/banner_cloud.jpg)](/cloud/)
* [![PowerCMS 8341](/images/banner/banner8341.jpg)](/news/powercms-8341.html)
* [![PowerSync](/images/banner/banner_powersync.jpg)](https://powersync.alfasado.net/)

ページの
先頭へ

* [HOME](/ "HOME")
  + [イベント・セミナー情報](/news/seminar/ "イベント・セミナー情報")
  + [PowerCMS ブログ](/blog/ "PowerCMS ブログ")
* [PowerCMS](/products/ "PowerCMS")
  + [PowerCMSの機能](/products/features/ "PowerCMSの機能")
  + [製品ラインアップ](/products/lineup/ "製品ラインアップ")
  + [価格表](/products/price.html "価格表")
  + [動作環境](/products/document/installation/system.html "動作環境")
  + [製品資料ダウンロード](/products/download.html "製品資料ダウンロード")
  + [ドキュメント](/products/document/ "ドキュメント")
* [PowerCMSクラウド](/cloud/ "PowerCMSクラウド")

* [オプションサービス](/options/ "オプションサービス")
* [事例紹介](/case-studies/ "事例紹介")
  + [導入事例](/case-studies/index.html#anchor1 "導入事例")
  + [パートナー構築事例](/case-studies/index.html#anchor2 "パートナー構築事例")
* [よくあるご質問](/faq/ "よくあるご質問")
* [パートナー紹介](/partner/ "パートナー紹介")
  + [PowerCMS Partner Pro](/partner/index.html#anchor1 "PowerCMS Partner Pro")
  + [PowerCMS Partner SOHO](/partner/index.html#anchor2 "PowerCMS Partner SOHO")
  + [パートナー制度とは](/partner/system.html "パートナー制度とは")
  + [パートナーお申し込み](/inquiry/partner.html "パートナーお申し込み")

* [お問い合わせ](/inquiry/ "お問い合わせ")
* [サポートについて](/support/ "サポートについて")
* [プライバシーポリシー](https://alfasado.net/policy/index.html "プライバシーポリシー")
* [会社概要](/company/ "会社概要")
* [PowerCMSご購入](/inquiry/buy.html "PowerCMSご購入")
  + [特定商取引法に基づく表示](/ordercontract/ "特定商取引法に基づく表示")
  + [クレジットカード決済について](/ordercontract/creditcard.html "クレジットカード決済について")

* **PowerCMS 関連製品**
  + [PowerCMS 8341](/news/powercms-8341.html "PowerCMS 8341")
  + [PowerSync](https://powersync.alfasado.net/ "PowerSync")
  + [VisitorAnalytics](https://visitoranalytics.alfasado.net/ "VisitorAnalytics")
  + [SAML Login](https://www.powercms.jp/news/saml-login.html "SAML Login")
* [PowerCMS X](https://powercmsx.jp/ "PowerCMS X")
* [伝えるウェブ](https://tsutaeru.cloud/ "伝えるウェブ")

Copyright © 2009-2024 Alfasado Inc. All rights reserved.
powered by [![アルファサード株式会社](/common/images/2017/logo_alfasado.svg)](https://alfasado.net/)

* [![W3C Member](/common/images/2017/logo_w3c.png)](https://www.w3.org/)



=== Content from jvn.jp_4b54d049_20250114_202252.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2021/11/24  Last Updated:2021/12/17
# JVN#17645965 PowerCMS XMLRPC API vulnerable to OS command injection

## Overview

PowerCMS XMLRPC API contains an OS command injection vulnerability.

## Products Affected

* PowerCMS 5.19 and earlier (PowerCMS 5 Series)
* PowerCMS 4.49 and earlier (PowerCMS 4 Series)
* PowerCMS 3.295 and earlier (PowerCMS 3 Series)

The developer states that PowerCMS 2 Series and earlier, which are unsupported (End-of-Life, EOL) versions, are affected too.

ãUpdated on 2021 December 17ã

According to the developer, the patch released on 2021 October 22 was not sufficient to fix the vulnerability.

Therefore, in the case of using XMLRPC API, apply the latest patch according to [the information provided by the developer](https://www.powercms.jp/news/release-fix-xmlrpc-api-202112.html).

## Description

PowerCMS XMLRPC API provided by Alfasado Inc. contains an OS command injection vulnerability ([CWE-78](https://cwe.mitre.org/data/definitions/78.html)).

## Impact

An arbitrary OS command may be executed by a remote attacker.

## Solution

**In the case that not using XMLRPC API:**

* If using as CGI/FCGI
  + Delete `mt-xmlrpc.cgi` or remove execute permission to `mt-xmlrpc.cgi`
* If using in PSGI
  + By setting environment variable RestrictedPSGIApp xmlrpc, prohibit XMLRPC application

**In the case that using XMLRPC API:**

**Upgrade the software and Apply the patch**

Update the software to the latest version, and then apply the patch according to the information provided by the developer.

**Apply the workaround**

If an update cannot be applied, applying the following workaround may mitigate the impact of this vulnerability.

* Restrict access to `mt-xmlrpc.cgi` (e.g. Restrict access only to trusted connection source, Set HTTP authentication)

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Alfasado Inc. | [Vulnerable](996316/index.html) | 2021/12/17 | [Alfasado Inc. website](https://www.powercms.jp/news/release-patch-xmlrpc-api-202110.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
Base Score:
9.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:N/C:P/I:P/A:P
Base Score:
7.5

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Alfasado Inc. reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and Alfasado Inc. coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2021-20850](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20850) |
| JVN iPedia | [JVNDB-2021-000105](https://jvndb.jvn.jp/jvndb/JVNDB-2021-000105) |

## Update History

2021/11/24
Information under the section [Other Information] was added.
2021/12/17
Information under the section [Products Affected] was updated.
2021/12/17
Alfasado Inc. update status

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2021 JPCERT/CC and IPA. All rights reserved.


