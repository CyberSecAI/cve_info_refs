Based on the provided content, here's the breakdown of CVE-2021-20140:

**Root cause of vulnerability:**
The vulnerability stems from unsanitized user input being passed to the `system()` function within the `controller_server` service on Gryphon Tower routers. Specifically, operation 10 is affected.

**Weaknesses/vulnerabilities present:**
- Unauthenticated command injection.
- Lack of sanitization of user-supplied parameters.

**Impact of exploitation:**
- An attacker can execute arbitrary commands with root privileges on the affected device.
- This allows for complete control of the router, potentially leading to data breaches, network disruptions, or further attacks on devices within the network.

**Attack vectors:**
- Sending a specially crafted malicious packet to the `controller_server` service on port 9999.

**Required attacker capabilities/position:**
- The attacker must be on the same network as the target router.
- No authentication is required.
- The attacker needs to craft a specific payload to send to the `controller_server` service.

**Technical Details:**
The specific operation (10) within the controller_server service uses the parameters provided in the request without sanitization. Specifically, the `macaddr` parameter is vulnerable. The attacker can insert shell commands that will be executed as root.

**Proof of Concept:**
The following payload will create the file **/tmp/op10** containing the results of the **id** command:
```
echo '{"10":{"macaddr":";id>/tmp/op10", "status":"tenable","version":"tenable"}}' | ncat --ssl <device-ip> 9999
```
This shows how an attacker can use command substitution to inject commands.