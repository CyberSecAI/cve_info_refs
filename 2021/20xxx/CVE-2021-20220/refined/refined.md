Based on the provided content, here's an analysis of CVE-2021-20220:

**Root Cause of Vulnerability:**

*   A regression in the fix for CVE-2020-10687 was found in Undertow.
*   The vulnerability is due to permitting invalid characters in an HTTP request, making HTTP request smuggling possible.

**Weaknesses/Vulnerabilities Present:**

*   **HTTP Request Smuggling:** The core weakness is the possibility of HTTP request smuggling against HTTP/1.x and HTTP/2 due to the acceptance of invalid characters in HTTP requests. This is related to a previous vulnerability, CVE-2017-2666.

**Impact of Exploitation:**

*   **Cache Poisoning:** An attacker can poison a web cache.
*   **Cross-Site Scripting (XSS):** An attacker can perform XSS attacks.
*   **Sensitive Information Disclosure:** An attacker may obtain sensitive information from requests other than their own.
*   **Data Confidentiality and Integrity:** The highest threat from this vulnerability is to data confidentiality and integrity.
*   **Data Modification:** An attacker could modify data.

**Attack Vectors:**

*   The attack vector is through malformed HTTP requests that contain invalid characters.

**Required Attacker Capabilities/Position:**

*   The attacker must be able to send HTTP requests to a vulnerable server.
*   No specific attacker capabilities or positions are mentioned beyond network access to the vulnerable service.

**Additional Details:**

*   The vulnerability affects Undertow versions prior to 2.2.0.Final, 2.1.6.Final, and 2.0.34.Final.
*   NetApp products, including Active IQ Unified Manager for Linux, Windows and VMware vSphere, and OnCommand Workflow Automation, are affected.
*   Red Hat also acknowledges this vulnerability and has released errata to address it in Red Hat JBoss Enterprise Application Platform and Red Hat Single Sign-On.
*  The vulnerability is a regression of a previous fix, indicating that a patch was incomplete or ineffective.