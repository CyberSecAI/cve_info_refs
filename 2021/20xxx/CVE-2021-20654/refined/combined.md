=== Content from jvn.jp_45bda230_20250114_185434.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2021/02/10  Last Updated:2021/02/10
# JVN#80785288 Wekan vulnerable to cross-site scripting

## Overview

Wekan contains a cross-site scripting vulnerbility.

This vulnerability is treated as one of multiple cross-site scripting vulnerabilities, named "Fieldbleed".

## Products Affected

* Wekan, versions between 3.12 and 4.11

## Description

Wekan, open source kanban board system, is vulnerable to cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html)).

This vulnerability is treated as one of multiple cross-site scripting vulnerabilities, named "Fieldbleed".

## Impact

When a logged-in user store malicious value containing Javascript code to the system, that JavaScript code may be executed on another logged-in user's web browser.

## Solution

**Update the Software**

Update the software to the latest version according to the information provided by the developer.

The developer states that Fieldbleed is fixed on version 4.12.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Wekan | [Hall of Fame / Fieldbleed](https://wekan.github.io/hall-of-fame/fieldbleed/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
Base Score:
5.4

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:S/C:N/I:P/A:N
Base Score:
3.5

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Ryoya Koyama at Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2021-20654](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20654) |
| JVN iPedia | [JVNDB-2021-000013](https://jvndb.jvn.jp/jvndb/JVNDB-2021-000013) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2021 JPCERT/CC and IPA. All rights reserved.



=== Content from github.com_6fa28c19_20250115_113332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwekan%2Fwekan%2Fblob%2Fmain%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwekan%2Fwekan%2Fblob%2Fmain%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=wekan%2Fwekan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wekan](/wekan)
/
**[wekan](/wekan/wekan)**
Public

* [Notifications](/login?return_to=%2Fwekan%2Fwekan) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2Fwekan%2Fwekan)
* [Star
   19.7k](/login?return_to=%2Fwekan%2Fwekan)

* [Code](/wekan/wekan)
* [Issues
  646](/wekan/wekan/issues)
* [Pull requests
  1](/wekan/wekan/pulls)
* [Discussions](/wekan/wekan/discussions)
* [Actions](/wekan/wekan/actions)
* [Wiki](/wekan/wekan/wiki)
* [Security](/wekan/wekan/security)
* [Insights](/wekan/wekan/pulse)

Additional navigation options

* [Code](/wekan/wekan)
* [Issues](/wekan/wekan/issues)
* [Pull requests](/wekan/wekan/pulls)
* [Discussions](/wekan/wekan/discussions)
* [Actions](/wekan/wekan/actions)
* [Wiki](/wekan/wekan/wiki)
* [Security](/wekan/wekan/security)
* [Insights](/wekan/wekan/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wekan.github.io_a408606d_20250114_185435.html ===

![Hall of Fame image from https://openclipart.org/detail/120343/trophy](../hof.svg)

[Back to Hall of Fame Contents](https://wekan.github.io/hall-of-fame)
[Back to Wekan Website](https://wekan.github.io)

# Contents / Fieldbleed

| CVE | Vulnerability name | Date | [Responsible Security Disclosure](https://github.com/wekan/wekan/blob/main/SECURITY.md) by | Vulnerabilities |
| --- | --- | --- | --- | --- |
| [CVE-2021-20654](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20654)  VRF#20-08-MDPNJ. VN: JVN#80785288 for attachments.  New report [JVN#74210258, investigating.](#JVN74210258) | **Fieldbleed** | 2020-03-23 17.03 EET | **Cyb3rjunky** and **swsjona** about [input fields](fieldbleed/#FIELD). **Ryoya Koyama** at Mitsui Bussan Secure Directions, Inc. (<https://www.mbsd.jp/>) about [Javascript inside .SVG attachment](fieldbleed/#SVG)     Did send detailed report! | * Javascript saved to field is run when page is reloaded * Affected Wekan v3.12-v4.11 * Fixed at [Wekan v4.12 2020-06-08](https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v412-2020-06-08-wekan-release) |

| Timeline | Details |
| --- | --- |
| **2020-03-23 17:03 EET** | Report received.  Cyb3rjunky wrote: Hi Wekan, I want to report a security vulnerability with the Wekan platform. This is a persistent XSS bug appears globally across the platform. The input and output for card names, checklist items, subtask items, comments,..... are not sanitized, the attacker can pass a javascript payload to those parameters to exploit the vulnerability in order to perform: cookie-capture, redirect phishing, deface lead to DOS. This bug is tested on the newest version of wekan, i suspect it affects all the earlier version. Here is my current setup:  | **Wekan Version** | 3.84.0 | | --- | --- | | **Meteor version** | 1.10.1 | | **Node version** | 12.16.1 | | **MongoDB version** | 3.2.22 | | **MongoDB storage engine** | wiredTiger | | **MongoDB Oplog enabled** | true | | **OS Type** | Linux | | **OS Platform** | linux | | **OS Arch** | x64 | | **OS Release** | 4.15.0-88-generic | | **OS Uptime** | 25 days, 3 hours, 22 minutes, 23 seconds | | **OS Load Average** | 0.00, 0.05, 0.06 | | **OS Total Memory** | 8 GB | | **OS Free Memory** | 3 GB | | **OS CPU Count** | 4 |   **Step to reproduce**  1. Add a new card 2. Put the name: <img src=x onerror=alert(1)> 3. The payload is saved and executed everytime the page is loaded   The remediation for this vulnerability is to sanitize the user input to make sure no malice code is saved to the server. Integrate with a whitelist if it is neccessary for user to input javascript value. This vulnerability is not critical however could be used to deny of service or to steal information from users. Please act upon notice. Thank you. Cyb3rjunky |
| **2020-03-23** | [Wekan v3.85](https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v385-2020-03-23-wekan-release) released by xet7 with fix: "Fix XSS bug reported today 4 hours ago by Cyb3rjunky. Logged in users could run javascript in input fields. This affects Wekan versions v3.12-v3.84. In Wekan v3.12 there was changes for XSS filter to allow inserting images, videos etc on comment WYSIWYG editor so features related to that are now removed. After this fix, Javascript in input fields is not executed. Thanks to Cyb3rjunky and xet7." |
 **2020-05-24** | Report received.  swsjona wrote:[Urgent] XSS in any boardsName: S.W. Sajeth Jonathan Twitter: @swsjona Bug type: Stored XSS Domain: Self Hosted Droplet Severity: MediumSummary A Stored XSS can be performed in any board by adding an IFRAME XSS Payload as a List name. || **2020-06-08** | [Wekan v4.12](https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v412-2020-06-08-wekan-release) released by xet7 with fix: "Fix XSS bug reported 2020-05-24 by [swsjona](https://twitter.com/swsjona). Logged in users could run javascript in input fields. This was partially fixed at v3.85, but at some fields XSS was still possible. This affects at least Wekan versions v3.12-v4.11. After this fix, Javascript in input fields is not executed. Thanks to swsjona, marc1006 and xet7." |
| **2021-01-02 17:03 EET** | Report received. ```  ----------------------------------------------------------------- Vulnerability report JVN#80785288 (begins here) ----------------------------------------------------------------- This vulnerability was found and reported by the following person, who would like to be credited when this issue is published on both the developer's website and JVN.    Name: Ryoya Koyama at Mitsui Bussan Secure Directions, Inc. (https://www.mbsd.jp/)   - Vulnerability ID: JVN#80785288  - Type of Vulnerability: CWE-79 (XSS, cross-site scripting)    actually the report explains Stored XSS.  - Affected Product and its version(s): Wekan v3.94 and v3.95    the reporter built a verification environment using docker-compose.yml   and verified the vulnerability on 2020/04/13.  - Reproduction Steps:      * prerequisites        - Attacker needs to login to Wekan.       - Victim needs to be able to access Wekan,         either logged in to Wekan or not.      * Attack Scenario        - Attacker log in to Wekan, and creates Board, List, Card.        - Attacker attach a malicious SVG file to the created Card.         (see test.svg)         this attached file is accessible with the URL like this:          http://localhost/cfs/files/attachments/hCxhmMyekCFjLJowB/test.svg?token=eyJhdXRoVG9rZW4iOiJsbmtZMi1mN1dSNjFPMTRjS3JzMmx3WlBzRlN3RzloQU9TOWxmZ0dXVWFfIn0%3D&download=true          note that the URL above contains "download" parameter, but         the URL without "download" parameter works too.        - Attacker leads Victim to the URL without "download" parameter.          http://localhost/cfs/files/attachments/hCxhmMyekCFjLJowB/test.svg?token=eyJhdXRoVG9rZW4iOiJsbmtZMi1mN1dSNjFPMTRjS3JzMmx3WlBzRlN3RzloQU9TOWxmZ0dXVWFfIn0%3D        - accessing the URL without "download" parameter, the attached file is         treated "inline" on Victim's web browser, which means         the javascript code inside the file is executed on the web browser.         (see alert.png for the screenshot when the javascript code is executed,          and log.txt for the http request and response.)      * Additional information        - when "download" parameter exists in the requested URL, then          the response comes with          Content-Disposition: attachment; filename="test.svg"         - when "download" parameter is missing, the response comes with          Content-Disposition: inline         - Content-Type of the response depends on the file type;          when the file type is either txt, xml, html, pdf, then              Content-Type: application/octet-stream          when the file type is svg, then              Content-Type: image/svg+xml           any modern web browsers do not open          "application/octet-stream" contents inline, hence          the reporter demonstrates the attack with svg file.  - Possible Impact:      - Confidentiality       Cookie information may be leaked, which can be utilized       to execute some actions by the attacker      - Integrity       page contents may be modified, enabling phishing      - Availability       None      - Initial CVSS evaluation     CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N/BS:5.4   - Comments from JPCERT/CC      Sorry to notify this report to you very lately.     We received this report on May 2020, but     missed to handle it in timely manner.     Quick looking at CHANGELOG.md and CVE Hall of Fame,     I don't find any mentions on xss-related fixes.     We don't verify the report on the latest Wekan version by our selves,     but suppose this report still has a value for you.  ----------------------------------------------------------------- Vulnerability report JVN#80785288 (ends here) -----------------------------------------------------------------  ``` PoC: content of test.svg file<?xml version="1.0" encoding="utf-8"?> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">     <script>          alert(document.cookie)     </script> </svg> |
 **2021-01-03 00:45 EET** | Reply to report VN: JVN#80785288 / TN: JPCERT #93802826. From maintainer of Wekan, [xet7](https://github.com/xet7):Thanks a lot for sending this new report and new PoC ! I did not previously test for Javascript inside of .SVG image. I tested this with newest Wekan and Firefox 84.0.2, and clicking attachment at Wekan card, this .SVG image did not open popup. When downloading .SVG attachment from Wekan card to hardrive, and opening only that .SVG file in another tab of same Firefox 84.0.2, popup did not show any text. So this same fieldbleed was already fixed at [Wekan v4.12 2020-06-08](https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v412-2020-06-08-wekan-release). I added mention to this CVE Hall of Fame page that this fieldbleed is XSS bug, and made some improvements to CVE Hall of Fame pages. Every vulnerability report is important, thanks for taking the time to send a report! If original reporter of this vulnerability would like to have nickname or name at Wekan Hall of Fame, please send more details. | **2022-05-23 13:30 EET** | Reply to newly received report JVN#74210258 2022-05-23 13.33 EET. From maintainer of Wekan, [xet7](https://github.com/xet7):Currently investigating included special case. If something in this applies to WeKan, and it would be possible technically to fix this, trying to get all WeKan platforms builds working and fix released within 90 days, starting today. Full details will be released after there has been some time to get everyone updated. |

[Back to Hall of Fame Contents](https://wekan.github.io/hall-of-fame)
[Back to Wekan Website](https://wekan.github.io)
#


