=== Content from www.mitsubishielectric.com_0e59dd6d_20250114_224418.html ===
Denial-of-Service Vulnerability in MELSOFT Transmission Port (TCP/IP)
Release date: May 27, 2021
Mitsubishi Electric Corporation

■Overview

Denial-of-Service (DoS) vulnerability exists in MELSOFT transmission port (TCP/IP) of MELSEC iQ-R series CPU modules due
to  improper  session  management.  An  attacker can cause  resource exhaustion and  DoS condition  on  a  target  by  not  closing a
connection properly. (CVE-2021-20591)

The product models and firmware versions affected by this vulnerability are listed below.

■CVSS

CVE-2021-20591 CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L Base Score:5.3

■Affected products

The following modules are affected:

Model name
R00/01/02CPU
R04/08/16/32/120(EN)CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU

Firmware Version
all versions
all versions
all versions
all versions
all versions

■Description

A denial-of-service (DoS) vulnerability exists in MELSOFT transmission port (TCP/IP) of MELSEC iQ-R series CPU modules due

to Uncontrolled Resource Consumption (CWE-400).

■Impact

If a malicious attacker does not close the connection to the MELSOFT transmission port (TCP/IP), legitimate clients will not be

able to connect to the MELSOFT transmission port (TCP/IP).

・If multiple MELSOFT transmission ports (TCP/IP) are open, the other ports are not affected.
・Sequence control is not affected.

■Countermeasures

Please carry out the mitigations/workarounds below.

If this vulnerability is expoited, legitimate user can recover by disabling the port with the forced connection invalidation function

and re-enabling the port.
For example，excerpt from the manual※1 and how to set the MELSEC iQ-R series CPU module are shown below.
※1：MELSEC iQ-R Ethernet User’s Manual (Application) Appendix 3 Buffer Memory
< Example >
・Excerpt from the manual

・Setting method

Set b2 to  “ON”  on the watch or Device/Buffer Memory Batch Monitor. After that, by setting b2 to “OFF”, legitimate clients can

connect.

< Example：Watch >

■Mitigations/Workarounds

< Mitigations >
Mitsubishi Electric recommends that customers take either or a combination of the following mitigation measures to minimize
the risk of exploiting this vulnerability:

- Use a firewall or virtual private network (VPN), etc. to prevent unauthorized access when Internet access is required.
- Use within a LAN and block access from untrusted networks and hosts through firewalls.
- Use the IP filter function※2 to restrict the connectable IP addresses.
- Use the MELSOFT transmission port (UDP/IP).
※2：MELSEC iQ-R Ethernet User’s Manual(Application) 1.13 Security “IP filter”

< Workarounds >
If port 5007 of the MELSOFT transmission port (TCP/IP) is not used, set b2 to "1" in advance with the forced connection
invalidation function described in the Conutermeasures.

■Acknowledgement

Mitsubishi Electric would like to thank Younes Dragoni of Nozomi Networks who reported this vulnerability.

■Contact information

Please contact your local Mitsubishi Electric representative.

< Inquiries | MITSUBISHI ELECTRIC FA >

https://www.mitsubishielectric.com/fa/support/index.html



=== Content from jvn.jp_a67cac60_20250114_224416.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

å¬éæ¥ï¼2021/05/27ãæçµæ´æ°æ¥ï¼2021/05/28
# JVNVU#98060539 ä¸è±é»æ©è£½ MELSEC iQ-R ã·ãªã¼ãºã® MELSOFT äº¤ä¿¡ãã¼ãã«ããããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§

## æ¦è¦

ä¸è±é»æ©è£½ MELSEC iQ-R ã·ãªã¼ãº CPU ã¦ãããã® MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã«ã¯ããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§ãå­å¨ãã¾ãã

## å½±é¿ãåããã·ã¹ãã

* R00/01/02CPU å¨ãã¼ã¸ã§ã³
* R04/08/16/32/120 (EN) CPU å¨ãã¼ã¸ã§ã³
* R08/16/32/120SFCPU å¨ãã¼ã¸ã§ã³
* R08/16/32/120PCPU å¨ãã¼ã¸ã§ã³
* R08/16/32/120PSFCPU å¨ãã¼ã¸ã§ã³

## è©³ç´°æå ±

ä¸è±é»æ©æ ªå¼ä¼ç¤¾ãæä¾ãã MELSEC iQ-R ã·ãªã¼ãº CPU ã¦ãããã® MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã«ã¯ãã»ãã·ã§ã³ç®¡çã®ä¸åã«èµ·å ãããªã½ã¼ã¹ã®æ¯æ¸ã®èå¼±æ§ ([CWE-400](https://cwe.mitre.org/data/definitions/400.html)ã[CVE-2021-20591](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20591)) ãå­å¨ãã¾ãã

## æ³å®ãããå½±é¿

é éã®ç¬¬ä¸èã MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã«æ¥ç¶ããã¾ã¾ã®ç¶æã¨ãããã¨ã§ãMELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã®ãªã½ã¼ã¹ãæ¯æ¸ãå½è©²ãã¼ãã¸ã®æ¥ç¶ãå¦çãããããµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã¨ãªãå¯è½æ§ãããã¾ããããã«ãããæ­£è¦ã®ã¦ã¼ã¶ã MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã«æ¥ç¶ã§ããªããªãã¾ãã

éçºèã«ããã¨ãè¤æ°ã® MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP ãã¼ã) ããªã¼ãã³ãã¦ããå ´åãä»ãã¼ãã¸ã®å½±é¿ã¯ãªããã¾ããã·ã¼ã±ã³ã¹å¶å¾¡ã¸ã®å½±é¿ã¯ãªãã¨ã®ãã¨ã§ãã

è©³ããã¯ã[éçºèãæä¾ããæå ±](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2021-003.pdf)ããç¢ºèªãã ããã

## å¯¾ç­æ¹æ³

**ã¯ã¼ã¯ã¢ã©ã¦ã³ããå®æ½ãã**

æ¬¡ã®åé¿ç­ãé©ç¨ãããã¨ã§ãæ¬èå¼±æ§ã®å½±é¿ãåé¿ã§ããã¨ã®ãã¨ã§ãã

* MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã® 5007 ãã¼ãã®æ©è½ãä¸è¦ãªå ´åã¯ãã³ãã¯ã·ã§ã³å¼·å¶ç¡å¹åæ©è½ãä½¿ç¨ãå½è©²ãã¼ããå¼·å¶çã«ç¡å¹åãã (MELSEC iQ-R Ethernetã¦ã¼ã¶ã¼ãºããã¥ã¢ã«(å¿ç¨ç·¨) ä»3 ãããã¡ã¡ã¢ãªãåç§)

ã¾ããéçºèã¯æ¬èå¼±æ§ã®å½±é¿ãè»½æ¸ããããã«ãæ¬¡ã®åé¿ç­ã®ããããã¾ãã¯çµã¿åãããé©ç¨ãããã¨ãæ¨å¥¨ãã¦ãã¾ãã

* å½è©²è£½åãã¤ã³ã¿ã¼ãããã«æ¥ç¶ããå ´åã«ã¯ããã¡ã¤ã¢ã¦ã©ã¼ã«ãä»®æ³ãã©ã¤ãã¼ããããã¯ã¼ã¯ (VPN) ç­ãä½¿ç¨ãã
* å½è©²è£½åã LAN åã§ä½¿ç¨ããä¿¡é ¼ã§ããªããããã¯ã¼ã¯ããã¹ãããã®ã¢ã¯ã»ã¹ããã¡ã¤ã¢ã¦ã©ã¼ã«ã§ãã­ãã¯ãã
* IP ãã£ã«ã¿æ©è½ãä½¿ç¨ããæ¥ç¶å¯è½ãª IP ã¢ãã¬ã¹ãé©åã«å¶éãã
* MELSOFT äº¤ä¿¡ãã¼ã (UDP/IP) ãä½¿ç¨ãã

æ¬¡ã®æ¹æ³ã§ããµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã¨ãªãæ¥ç¶ã§ããªããªã£ãæ­£è¦ã®ã¦ã¼ã¶ã MELSOFT äº¤ä¿¡ãã¼ã (TCP/IP) ã«æ¥ç¶ã§ããããã«ãªãã¨ã®ãã¨ã§ãã

* ãµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã«ãªã£ãå ´åã«ã¯ãã³ãã¯ã·ã§ã³å¼·å¶ç¡å¹åæ©è½ãä½¿ç¨ãå½è©²ãã¼ããå¼·å¶çã«ç¡å¹åããå¾ãååº¦æå¹åãã (MELSEC iQ-R Ethernetã¦ã¼ã¶ã¼ãºããã¥ã¢ã«(å¿ç¨ç·¨) ä»3 ãããã¡ã¡ã¢ãªãåç§)

è©³ããã¯ã[éçºèãæä¾ããæå ±](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2021-003.pdf)ããç¢ºèªãã ããã

## ãã³ãæå ±

| ãã³ã | ãªã³ã¯ |
| --- | --- |
| ä¸è±é»æ©æ ªå¼ä¼ç¤¾ | [MELSOFTäº¤ä¿¡ãã¼ã(TCP/IP)ã«ããããµã¼ãã¹æå¦(DoS)ã®èå¼±æ§](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2021-003.pdf) |

## åèæå ±

1. [ICS Advisory (ICSA-21-147-05)](https://us-cert.cisa.gov/ics/advisories/icsa-21-147-05)
   Mitsubishi Electric MELSEC iQ-R Series

## JPCERT/CCããã®è£è¶³æå ±

## JPCERT/CCã«ããèå¼±æ§åæçµæ

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
åºæ¬å¤:
5.3

| æ»æååºå(AV) | ç©ç (P) | ã­ã¼ã«ã« (L) | é£æ¥ (A) | ãããã¯ã¼ã¯ (N) |
| --- | --- | --- | --- | --- |
| æ»ææ¡ä»¶ã®è¤éã(AC) | é« (H) | ä½ (L) |
| å¿è¦ãªç¹æ¨©ã¬ãã«(PR) | é« (H) | ä½ (L) | ä¸è¦ (N) |
| ã¦ã¼ã¶é¢ä¸ã¬ãã«(UI) | è¦ (R) | ä¸è¦ (N) |
| ã¹ã³ã¼ã(S) | å¤æ´ãªã (U) | å¤æ´ãã (C) |
| æ©å¯æ§ã¸ã®å½±é¿(C) | ãªã (N) | ä½ (L) | é« (H) |
| å®å¨æ§ã¸ã®å½±é¿(I) | ãªã (N) | ä½ (L) | é« (H) |
| å¯ç¨æ§ã¸ã®å½±é¿(A) | ãªã (N) | ä½ (L) | é« (H) |

## è¬è¾

ãã®èå¼±æ§æå ±ã¯ãè£½åå©ç¨èã¸ã®å¨ç¥ãç®çã«ãéçºèã JPCERT/CC ã«å ±åããJPCERT/CC ãéçºèã¨ã®èª¿æ´ãè¡ãã¾ããã

## é¢é£ææ¸

| JPCERT ç·æ¥å ±å |  |
| --- | --- |
| JPCERT REPORT |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE |  |
| JVN iPedia |  |

## æ´æ°å±¥æ­´

2021/05/28
ãåèæå ±ãã« ICS Advisory ã®ãªã³ã¯ãè¿½å ãã¾ããã

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](/index.html)
* [![JVNã¨ã¯](/common/img/r_nav_2.gif)](/nav/jvn.html)
* [![èå¼±æ§ã¬ãã¼ãã®èª­ã¿æ¹](/common/img/r_nav_3.gif)](/nav/jvnhelp.html)
* [![èå¼±æ§ã¬ãã¼ãä¸è¦§](/common/img/r_nav_4.gif)](/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](/jp/index.html)
* [![VN_JPï¼é£çµ¡ä¸è½ï¼](/common/img/r_nav_4_4.gif)](/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](/vu/index.html)
* [![VN_TA](/common/img/r_nav_4_3.gif)](/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](/tr/index.html)
* [![JVN iPedia](/common/img/r_nav_10.gif)](http://jvndb.jvn.jp/)
* [![MyJVN](/common/img/r_nav_10_4.gif)](http://jvndb.jvn.jp/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](/rss/index.html)
* [![ãã³ãæå ±ä¸è¦§](/common/img/r_nav_7.gif)](/nav/index.html)
* [![é£çµ¡ä¸è½éçºèä¸è¦§](/common/img/r_nav_11.gif)](/reply/index.html)
* [![èå¼±æ§æå ±ã®å±åº](/common/img/r_nav_8.gif)](http://www.ipa.go.jp/security/vuln/report/)
* [![ãååãå](/common/img/r_nav_9.gif)](/contact/index.html)

Copyright (c) 2000-2021 JPCERT/CC and IPA. All rights reserved.


