=== Content from lists.gnu.org_189caece_20250115_121706.html ===


| | **qemu-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=qemu-devel)

---

[[Date Prev](msg07934.html)][[Date Next](msg07936.html)][[Thread Prev](msg07922.html)][[Thread Next](msg07936.html)][[Date Index](index.html#07935)][[Thread Index](threads.html#07935)]

## [PATCH] net: vmxnet3: validate configuration values during activate (CVE

---

| **From**: | P J P |
| --- | --- |

| **Subject**: | [PATCH] net: vmxnet3: validate configuration values during activate (CVE-2021-20203) |
| **Date**: | Sat, 30 Jan 2021 18:46:52 +0530 |

---

```
From: Prasad J Pandit <pjp@fedoraproject.org>

While activating device in vmxnet3_acticate_device(), it does not
validate guest supplied configuration values against predefined
minimum - maximum limits. This may lead to integer overflow or
OOB access issues. Add checks to avoid it.

Fixes: CVE-2021-20203
Buglink: [https://bugs.launchpad.net/qemu/+bug/1913873](https://bugs.launchpad.net/qemu/%2Bbug/1913873)
Reported-by: Gaoning Pan <pgn@zju.edu.cn>
Signed-off-by: Prasad J Pandit <pjp@fedoraproject.org>
---
 hw/net/vmxnet3.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/hw/net/vmxnet3.c b/hw/net/vmxnet3.c
index eff299f629..4a910ca971 100644
--- a/hw/net/vmxnet3.c
+++ b/hw/net/vmxnet3.c
@@ -1420,6 +1420,7 @@ static void vmxnet3_activate_device(VMXNET3State *s)
     vmxnet3_setup_rx_filtering(s);
     /* Cache fields from shared memory */
     s->mtu = VMXNET3_READ_DRV_SHARED32(d, s->drv_shmem, devRead.misc.mtu);
+    assert(VMXNET3_MIN_MTU <= s->mtu && s->mtu < VMXNET3_MAX_MTU);
     VMW_CFPRN("MTU is %u", s->mtu);

     s->max_rx_frags =
@@ -1473,6 +1474,9 @@ static void vmxnet3_activate_device(VMXNET3State *s)
         /* Read rings memory locations for TX queues */
         pa = VMXNET3_READ_TX_QUEUE_DESCR64(d, qdescr_pa, conf.txRingBasePA);
         size = VMXNET3_READ_TX_QUEUE_DESCR32(d, qdescr_pa, conf.txRingSize);
+        if (size > VMXNET3_TX_RING_MAX_SIZE) {
+            size = VMXNET3_TX_RING_MAX_SIZE;
+        }

         vmxnet3_ring_init(d, &s->txq_descr[i].tx_ring, pa, size,
                           sizeof(struct Vmxnet3_TxDesc), false);
@@ -1483,6 +1487,9 @@ static void vmxnet3_activate_device(VMXNET3State *s)
         /* TXC ring */
         pa = VMXNET3_READ_TX_QUEUE_DESCR64(d, qdescr_pa, conf.compRingBasePA);
         size = VMXNET3_READ_TX_QUEUE_DESCR32(d, qdescr_pa, conf.compRingSize);
+        if (size > VMXNET3_TC_RING_MAX_SIZE) {
+            size = VMXNET3_TC_RING_MAX_SIZE;
+        }
         vmxnet3_ring_init(d, &s->txq_descr[i].comp_ring, pa, size,
                           sizeof(struct Vmxnet3_TxCompDesc), true);
         VMXNET3_RING_DUMP(VMW_CFPRN, "TXC", i, &s->txq_descr[i].comp_ring);
@@ -1524,6 +1531,9 @@ static void vmxnet3_activate_device(VMXNET3State *s)
             /* RX rings */
             pa = VMXNET3_READ_RX_QUEUE_DESCR64(d, qd_pa, conf.rxRingBasePA[j]);
             size = VMXNET3_READ_RX_QUEUE_DESCR32(d, qd_pa, conf.rxRingSize[j]);
+            if (size > VMXNET3_RX_RING_MAX_SIZE) {
+                size = VMXNET3_RX_RING_MAX_SIZE;
+            }
             vmxnet3_ring_init(d, &s->rxq_descr[i].rx_ring[j], pa, size,
                               sizeof(struct Vmxnet3_RxDesc), false);
             VMW_CFPRN("RX queue %d:%d: Base: %" PRIx64 ", Size: %d",
@@ -1533,6 +1543,9 @@ static void vmxnet3_activate_device(VMXNET3State *s)
         /* RXC ring */
         pa = VMXNET3_READ_RX_QUEUE_DESCR64(d, qd_pa, conf.compRingBasePA);
         size = VMXNET3_READ_RX_QUEUE_DESCR32(d, qd_pa, conf.compRingSize);
+        if (size > VMXNET3_RC_RING_MAX_SIZE) {
+            size = VMXNET3_RC_RING_MAX_SIZE;
+        }
         vmxnet3_ring_init(d, &s->rxq_descr[i].comp_ring, pa, size,
                           sizeof(struct Vmxnet3_RxCompDesc), true);
         VMW_CFPRN("RXC queue %d: Base: %" PRIx64 ", Size: %d", i, pa, size);
--
2.29.2

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **[PATCH] net: vmxnet3: validate configuration values during activate (CVE-2021-20203)**,
  *P J P* **<=**

---

* Prev by Date:
  **[Re: [PULL 00/36] Misc patches (buildsys, i386, fuzzing) for 2021-01-29](msg07934.html)**
* Next by Date:
  **[[Bug 1913873] Re: QEMU: net: vmxnet: integer overflow may crash guest](msg07936.html)**
* Previous by thread:
  **[[PATCH v2] hw/arm/smmuv3: Fix addr\_mask for range-based invalidation](msg07922.html)**
* Next by thread:
  **[[Bug 1913873] Re: QEMU: net: vmxnet: integer overflow may crash guest](msg07936.html)**
* Index(es):
  + [**Date**](index.html#07935)
  + [**Thread**](threads.html#07935)



=== Content from bugs.launchpad.net_ece8f2b0_20250115_184805.html ===

[Log in / Register](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Blogin)

[![](https://launchpadlibrarian.net/27372372/qemu_64.png)](https://launchpad.net/qemu)

## [QEMU](https://launchpad.net/qemu)

* [Overview](https://launchpad.net/qemu)
* [Code](https://code.launchpad.net/qemu)
* [Bugs](https://bugs.launchpad.net/qemu)
* [Blueprints](https://blueprints.launchpad.net/qemu)
* [Translations](https://translations.launchpad.net/qemu)
* [Answers](https://answers.launchpad.net/qemu)

# QEMU: net: vmxnet: integer overflow may crash guest

Bug #1913873 reported by
[P J P](https://launchpad.net/~pjps)
on 2021-01-30

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [QEMU](https://bugs.launchpad.net/qemu) | Expired | Undecided | Unassigned |  |

### Bug Description

\* Gaoning Pan from Zhejiang University & Ant Security Light-Year Lab reported a malloc failure

  issue locates in vmxnet3\_activate\_device() of qemu/hw/net/vmxnet3.c NIC emulator

\* This issue is reproducible because while activating the NIC device, vmxnet3\_activate\_device

  does not validate guest supplied configuration values against predefined min/max limits.

@@ -1420,6 +1420,7 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

     vmxnet3\_setup\_rx\_filtering(s);

     /\* Cache fields from shared memory \*/

     s->mtu = VMXNET3\_READ\_DRV\_SHARED32(d, s->drv\_shmem, devRead.misc.mtu);

+ assert(VMXNET3\_MIN\_MTU <= s->mtu && s->mtu < VMXNET3\_MAX\_MTU); <= Did not check if MTU is within range

     VMW\_CFPRN("MTU is %u", s->mtu);

s->max\_rx\_frags =

@@ -1473,6 +1474,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* Read rings memory locations for TX queues \*/

         pa = VMXNET3\_READ\_TX\_QUEUE\_DESCR64(d, qdescr\_pa, conf.txRingBasePA);

         size = VMXNET3\_READ\_TX\_QUEUE\_DESCR32(d, qdescr\_pa, conf.txRingSize);

+ if (size > VMXNET3\_TX\_RING\_MAX\_SIZE) { <= Did not check TX ring size

+ size = VMXNET3\_TX\_RING\_MAX\_SIZE;

+ }

  vmxnet3\_ring\_init(d, &s->txq\_descr[i].tx\_ring, pa, size,

                           sizeof(struct Vmxnet3\_TxDesc), false);

@@ -1483,6 +1487,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* TXC ring \*/

         pa = VMXNET3\_READ\_TX\_QUEUE\_DESCR64(d, qdescr\_pa, conf.compRingBasePA);

         size = VMXNET3\_READ\_TX\_QUEUE\_DESCR32(d, qdescr\_pa, conf.compRingSize);

+ if (size > VMXNET3\_TC\_RING\_MAX\_SIZE) { <= Did not check TC ring size

+ size = VMXNET3\_TC\_RING\_MAX\_SIZE;

+ }

         vmxnet3\_ring\_init(d, &s->txq\_descr[i].comp\_ring, pa, size,

                           sizeof(struct Vmxnet3\_TxCompDesc), true);

         VMXNET3\_RING\_DUMP(VMW\_CFPRN, "TXC", i, &s->txq\_descr[i].comp\_ring);

@@ -1524,6 +1531,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

             /\* RX rings \*/

             pa = VMXNET3\_READ\_RX\_QUEUE\_DESCR64(d, qd\_pa, conf.rxRingBasePA[j]);

             size = VMXNET3\_READ\_RX\_QUEUE\_DESCR32(d, qd\_pa, conf.rxRingSize[j]);

+ if (size > VMXNET3\_RX\_RING\_MAX\_SIZE) { <= Did not check RX ring size

+ size = VMXNET3\_RX\_RING\_MAX\_SIZE;

+ }

             vmxnet3\_ring\_init(d, &s->rxq\_descr[i].rx\_ring[j], pa, size,

                               sizeof(struct Vmxnet3\_RxDesc), false);

             VMW\_CFPRN("RX queue %d:%d: Base: %" PRIx64 ", Size: %d",

@@ -1533,6 +1543,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* RXC ring \*/

         pa = VMXNET3\_READ\_RX\_QUEUE\_DESCR64(d, qd\_pa, conf.compRingBasePA);

         size = VMXNET3\_READ\_RX\_QUEUE\_DESCR32(d, qd\_pa, conf.compRingSize);

+ if (size > VMXNET3\_RC\_RING\_MAX\_SIZE) { <= Did not check RC ring size

+ size = VMXNET3\_RC\_RING\_MAX\_SIZE;

+ }

This may lead to potential integer overflow OR OOB buffer access issues.

Tags:

[cve](/qemu/%2Bbugs?field.tag=cve)
[security](/qemu/%2Bbugs?field.tag=security)

## CVE References

* [2021-20203](/bugs/cve/2021-20203 "An integer overflow issue was found i...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-01-30: |  |  | [#1](/qemu/%2Bbug/1913873/comments/1) |
| --- | --- | --- | --- |

CVE-2021-20203 assigned by Red Hat Inc.

CVE-2021-20203 assigned by Red Hat Inc.

[P J P (pjps)](https://launchpad.net/~pjps)
on 2021-01-30

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alexander Bulekov (a1xndr)](https://launchpad.net/~a1xndr) wrote on 2021-01-31: |  |  | [#2](/qemu/%2Bbug/1913873/comments/2) |
| --- | --- | --- | --- |

Is this the same as [https://bugs.launchpad.net/qemu/+bug/1890152](https://bugs.launchpad.net/qemu/%2Bbug/1890152) ?

Is this the same as https://bugs.launchpad.net/qemu/+bug/1890152 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-01-31: |  |  | [#3](/qemu/%2Bbug/1913873/comments/3) |
| --- | --- | --- | --- |

Yes, from the trace looks same.

Yes, from the trace looks same.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thomas Huth (th-huth)](https://launchpad.net/~th-huth) wrote on 2021-05-14:  [**Moved bug report**](/qemu/%2Bbug/1913873/comments/4) |  |  | [#4](/qemu/%2Bbug/1913873/comments/4) |
| --- | --- | --- | --- |

This is an automated cleanup. This bug report has been moved to QEMU's

new bug tracker on gitlab.com and thus gets marked as 'expired' now.

Please continue with the discussion here:

<https://gitlab.com/qemu-project/qemu/-/issues/308>

This is an automated cleanup. This bug report has been moved to QEMU's
new bug tracker on gitlab.com and thus gets marked as 'expired' now.
Please continue with the discussion here:
https://gitlab.com/qemu-project/qemu/-/issues/308

| Changed in qemu: | |
| --- | --- |
| **status**: | New → Expired |

[See full activity log](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/qemu/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1890152](https://bugs.launchpad.net/qemu/%2Bbug/1890152 "malloc 0xff0000030 bytes with vmxnet3")

You are
[not directly subscribed to this bug's notifications.](/qemu/%2Bbug/1913873/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [auto-gitlab.com-qemu-project-qemu-- #308](https://gitlab.com/qemu-project/qemu/-/issues/308)

  [closed Launchpad Security]
  [Edit](/bugs/1913873/%2Bwatch/142969 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from gitlab.com_52574ddc_20250115_121705.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
d05dcd94**

authored
Jan 30, 2021
by
**![Prasad J Pandit's avatar](https://secure.gravatar.com/avatar/0da54bb965204918509e325a6fb8ce5eeee77e1812ac0b0041c368234c433175?s=48&d=identicon "Prasad J Pandit")
Prasad J Pandit**
Committed by
[Jason Wang](/jasowang)
Nov 19, 2021

[Browse files](/qemu-project/qemu/-/tree/d05dcd94aee88728facafb993c7280547eb4d645)

### net: vmxnet3: validate configuration values during activate (CVE-2021-20203)

```

While activating device in vmxnet3_acticate_device(), it does not
validate guest supplied configuration values against predefined
minimum - maximum limits. This may lead to integer overflow or
OOB access issues. Add checks to avoid it.

Fixes: CVE-2021-20203
Buglink: [https://bugs.launchpad.net/qemu/+bug/1913873](https://bugs.launchpad.net/qemu/%2Bbug/1913873)

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/a9e56b80b7c49a0ffe81b7e1ecc3b55f49a37dd091b3d4b06aa7fd3b9dbf09fb?s=32&d=identicon)Gaoning Pan <pgn@zju.edu.cn>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/0da54bb965204918509e325a6fb8ce5eeee77e1812ac0b0041c368234c433175?s=32&d=identicon)Prasad J Pandit <pjp@fedoraproject.org>
Signed-off-by: [![Jason Wang's avatar](https://secure.gravatar.com/avatar/84fc00b985b91bfa000fb92ba5dc5e688f6b687fd8c32e18629693e61015eb8d?s=64&d=identicon "Jason Wang")](https://gitlab.com/jasowang "jasowang@redhat.com")[Jason Wang](https://gitlab.com/jasowang "jasowang@redhat.com") <jasowang@redhat.com>
```

parent
[44a3aa06](/qemu-project/qemu/-/commit/44a3aa0608f01274418487b655d42467c1d8334e)

Loading

Loading

Loading

* [Changes
  1](/qemu-project/qemu/-/commit/d05dcd94aee88728facafb993c7280547eb4d645)

[Hide whitespace changes](/qemu-project/qemu/-/commit/d05dcd94aee88728facafb993c7280547eb4d645?action=show&controller=projects%2Fcommit&id=d05dcd94aee88&namespace_id=qemu-project&project_id=qemu&w=1)
[Inline](/qemu-project/qemu/-/commit/d05dcd94aee88?view=inline)
[Side-by-side](/qemu-project/qemu/-/commit/d05dcd94aee88?view=parallel)

Loading

* [Michael Roth](/mdroth)
  @mdroth

  mentioned in commit [1ce084af](/qemu-project/qemu/-/commit/1ce084af083b6958c8287ea742a008a105bc960d "net: vmxnet3: validate configuration values during activate (CVE-2021-20203)")

  ·

  [Dec 23, 2021](#note_794208026)

  mentioned in commit [1ce084af](/qemu-project/qemu/-/commit/1ce084af083b6958c8287ea742a008a105bc960d "net: vmxnet3: validate configuration values during activate (CVE-2021-20203)")

  mentioned in commit 1ce084af083b6958c8287ea742a008a105bc960d

  Toggle commit list
* [Salvatore Bonaccorso](/carnil)
  @carnil

  mentioned in issue [#308 (closed)](/qemu-project/qemu/-/issues/308 "QEMU: net: vmxnet: integer overflow may crash guest")

  ·

  [Jan 09, 2022](#note_805119190)

  mentioned in issue [#308 (closed)](/qemu-project/qemu/-/issues/308 "QEMU: net: vmxnet: integer overflow may crash guest")

  mentioned in issue #308

  Toggle commit list
* [Fiona Ebner](/foxmox)
  @foxmox

  mentioned in commit [70d9e42f](/qemu-project/qemu/-/commit/70d9e42f0b27ae508f35caa7df5ee50683e0fd21 "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  ·

  [Feb 14, 2023](#note_1277783279)

  mentioned in commit [70d9e42f](/qemu-project/qemu/-/commit/70d9e42f0b27ae508f35caa7df5ee50683e0fd21 "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  mentioned in commit 70d9e42f0b27ae508f35caa7df5ee50683e0fd21

  Toggle commit list
* [Fiona Ebner](/foxmox)
  @foxmox

  mentioned in commit [099a6382](/qemu-project/qemu/-/commit/099a63828130843741d317cb28e936f468b2b53b "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  ·

  [Feb 21, 2023](#note_1286597177)

  mentioned in commit [099a6382](/qemu-project/qemu/-/commit/099a63828130843741d317cb28e936f468b2b53b "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  mentioned in commit 099a63828130843741d317cb28e936f468b2b53b

  Toggle commit list
* [Fiona Ebner](/foxmox)
  @foxmox

  mentioned in commit [b209cc45](/qemu-project/qemu/-/commit/b209cc4556d56938fa8a933670b8fb98c036af37 "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  ·

  [Apr 23, 2023](#note_1363433097)

  mentioned in commit [b209cc45](/qemu-project/qemu/-/commit/b209cc4556d56938fa8a933670b8fb98c036af37 "hw/net/vmxnet3: allow VMXNET3_MAX_MTU itself as a value")

  mentioned in commit b209cc4556d56938fa8a933670b8fb98c036af37

  Toggle commit list
* [Thomas Huth](/thuth)
  @thuth

  mentioned in commit [9a4f4153](/qemu-project/qemu/-/commit/9a4f41535b9b9116294e8e406ad97dd69330b28d "hw/net/vmxnet3: Fix guest-triggerable assert()")

  ·

  [Sep 10, 2023](#note_1552186909)

  mentioned in commit [9a4f4153](/qemu-project/qemu/-/commit/9a4f41535b9b9116294e8e406ad97dd69330b28d "hw/net/vmxnet3: Fix guest-triggerable assert()")

  mentioned in commit 9a4f41535b9b9116294e8e406ad97dd69330b28d

  Toggle commit list
* [Thomas Huth](/thuth)
  @thuth

  mentioned in commit [ebac7b1b](/qemu-project/qemu/-/commit/ebac7b1bef9cd2f3ad2fbf4a412c8123689dfde7 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  ·

  [Sep 11, 2023](#note_1552623785)

  mentioned in commit [ebac7b1b](/qemu-project/qemu/-/commit/ebac7b1bef9cd2f3ad2fbf4a412c8123689dfde7 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  mentioned in commit ebac7b1bef9cd2f3ad2fbf4a412c8123689dfde7

  Toggle commit list
* [Thomas Huth](/thuth)
  @thuth

  mentioned in commit [c68b844d](/qemu-project/qemu/-/commit/c68b844d3376764240afdb3c55d451e4dac11004 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  ·

  [Sep 20, 2023](#note_1566341000)

  mentioned in commit [c68b844d](/qemu-project/qemu/-/commit/c68b844d3376764240afdb3c55d451e4dac11004 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  mentioned in commit c68b844d3376764240afdb3c55d451e4dac11004

  Toggle commit list
* [Thomas Huth](/thuth)
  @thuth

  mentioned in commit [93d41079](/qemu-project/qemu/-/commit/93d4107937dfc846976d64f661ee7cb4f7975f73 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  ·

  [Sep 21, 2023](#note_1570203195)

  mentioned in commit [93d41079](/qemu-project/qemu/-/commit/93d4107937dfc846976d64f661ee7cb4f7975f73 "hw/net/vmxnet3: Fix guest-triggerable assert()")

  mentioned in commit 93d4107937dfc846976d64f661ee7cb4f7975f73

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from bugs.launchpad.net_2d05b7dc_20250115_184805.html ===

[Log in / Register](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Blogin)

[![](https://launchpadlibrarian.net/27372372/qemu_64.png)](https://launchpad.net/qemu)

## [QEMU](https://launchpad.net/qemu)

* [Overview](https://launchpad.net/qemu)
* [Code](https://code.launchpad.net/qemu)
* [Bugs](https://bugs.launchpad.net/qemu)
* [Blueprints](https://blueprints.launchpad.net/qemu)
* [Translations](https://translations.launchpad.net/qemu)
* [Answers](https://answers.launchpad.net/qemu)

# QEMU: net: vmxnet: integer overflow may crash guest

Bug #1913873 reported by
[P J P](https://launchpad.net/~pjps)
on 2021-01-30

[266](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [QEMU](https://bugs.launchpad.net/qemu) | Expired | Undecided | Unassigned |  |

### Bug Description

\* Gaoning Pan from Zhejiang University & Ant Security Light-Year Lab reported a malloc failure

  issue locates in vmxnet3\_activate\_device() of qemu/hw/net/vmxnet3.c NIC emulator

\* This issue is reproducible because while activating the NIC device, vmxnet3\_activate\_device

  does not validate guest supplied configuration values against predefined min/max limits.

@@ -1420,6 +1420,7 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

     vmxnet3\_setup\_rx\_filtering(s);

     /\* Cache fields from shared memory \*/

     s->mtu = VMXNET3\_READ\_DRV\_SHARED32(d, s->drv\_shmem, devRead.misc.mtu);

+ assert(VMXNET3\_MIN\_MTU <= s->mtu && s->mtu < VMXNET3\_MAX\_MTU); <= Did not check if MTU is within range

     VMW\_CFPRN("MTU is %u", s->mtu);

s->max\_rx\_frags =

@@ -1473,6 +1474,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* Read rings memory locations for TX queues \*/

         pa = VMXNET3\_READ\_TX\_QUEUE\_DESCR64(d, qdescr\_pa, conf.txRingBasePA);

         size = VMXNET3\_READ\_TX\_QUEUE\_DESCR32(d, qdescr\_pa, conf.txRingSize);

+ if (size > VMXNET3\_TX\_RING\_MAX\_SIZE) { <= Did not check TX ring size

+ size = VMXNET3\_TX\_RING\_MAX\_SIZE;

+ }

  vmxnet3\_ring\_init(d, &s->txq\_descr[i].tx\_ring, pa, size,

                           sizeof(struct Vmxnet3\_TxDesc), false);

@@ -1483,6 +1487,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* TXC ring \*/

         pa = VMXNET3\_READ\_TX\_QUEUE\_DESCR64(d, qdescr\_pa, conf.compRingBasePA);

         size = VMXNET3\_READ\_TX\_QUEUE\_DESCR32(d, qdescr\_pa, conf.compRingSize);

+ if (size > VMXNET3\_TC\_RING\_MAX\_SIZE) { <= Did not check TC ring size

+ size = VMXNET3\_TC\_RING\_MAX\_SIZE;

+ }

         vmxnet3\_ring\_init(d, &s->txq\_descr[i].comp\_ring, pa, size,

                           sizeof(struct Vmxnet3\_TxCompDesc), true);

         VMXNET3\_RING\_DUMP(VMW\_CFPRN, "TXC", i, &s->txq\_descr[i].comp\_ring);

@@ -1524,6 +1531,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

             /\* RX rings \*/

             pa = VMXNET3\_READ\_RX\_QUEUE\_DESCR64(d, qd\_pa, conf.rxRingBasePA[j]);

             size = VMXNET3\_READ\_RX\_QUEUE\_DESCR32(d, qd\_pa, conf.rxRingSize[j]);

+ if (size > VMXNET3\_RX\_RING\_MAX\_SIZE) { <= Did not check RX ring size

+ size = VMXNET3\_RX\_RING\_MAX\_SIZE;

+ }

             vmxnet3\_ring\_init(d, &s->rxq\_descr[i].rx\_ring[j], pa, size,

                               sizeof(struct Vmxnet3\_RxDesc), false);

             VMW\_CFPRN("RX queue %d:%d: Base: %" PRIx64 ", Size: %d",

@@ -1533,6 +1543,9 @@ static void vmxnet3\_activate\_device(VMXNET3State \*s)

         /\* RXC ring \*/

         pa = VMXNET3\_READ\_RX\_QUEUE\_DESCR64(d, qd\_pa, conf.compRingBasePA);

         size = VMXNET3\_READ\_RX\_QUEUE\_DESCR32(d, qd\_pa, conf.compRingSize);

+ if (size > VMXNET3\_RC\_RING\_MAX\_SIZE) { <= Did not check RC ring size

+ size = VMXNET3\_RC\_RING\_MAX\_SIZE;

+ }

This may lead to potential integer overflow OR OOB buffer access issues.

Tags:

[cve](/qemu/%2Bbugs?field.tag=cve)
[security](/qemu/%2Bbugs?field.tag=security)

## CVE References

* [2021-20203](/bugs/cve/2021-20203 "An integer overflow issue was found i...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-01-30: |  |  | [#1](/qemu/%2Bbug/1913873/comments/1) |
| --- | --- | --- | --- |

CVE-2021-20203 assigned by Red Hat Inc.

CVE-2021-20203 assigned by Red Hat Inc.

[P J P (pjps)](https://launchpad.net/~pjps)
on 2021-01-30

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alexander Bulekov (a1xndr)](https://launchpad.net/~a1xndr) wrote on 2021-01-31: |  |  | [#2](/qemu/%2Bbug/1913873/comments/2) |
| --- | --- | --- | --- |

Is this the same as [https://bugs.launchpad.net/qemu/+bug/1890152](https://bugs.launchpad.net/qemu/%2Bbug/1890152) ?

Is this the same as https://bugs.launchpad.net/qemu/+bug/1890152 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [P J P (pjps)](https://launchpad.net/~pjps) wrote on 2021-01-31: |  |  | [#3](/qemu/%2Bbug/1913873/comments/3) |
| --- | --- | --- | --- |

Yes, from the trace looks same.

Yes, from the trace looks same.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thomas Huth (th-huth)](https://launchpad.net/~th-huth) wrote on 2021-05-14:  [**Moved bug report**](/qemu/%2Bbug/1913873/comments/4) |  |  | [#4](/qemu/%2Bbug/1913873/comments/4) |
| --- | --- | --- | --- |

This is an automated cleanup. This bug report has been moved to QEMU's

new bug tracker on gitlab.com and thus gets marked as 'expired' now.

Please continue with the discussion here:

<https://gitlab.com/qemu-project/qemu/-/issues/308>

This is an automated cleanup. This bug report has been moved to QEMU's
new bug tracker on gitlab.com and thus gets marked as 'expired' now.
Please continue with the discussion here:
https://gitlab.com/qemu-project/qemu/-/issues/308

| Changed in qemu: | |
| --- | --- |
| **status**: | New → Expired |

[See full activity log](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/qemu/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1890152](https://bugs.launchpad.net/qemu/%2Bbug/1890152 "malloc 0xff0000030 bytes with vmxnet3")

You are
[not directly subscribed to this bug's notifications.](/qemu/%2Bbug/1913873/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/qemu/%2Bbug/1913873/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [auto-gitlab.com-qemu-project-qemu-- #308](https://gitlab.com/qemu-project/qemu/-/issues/308)

  [closed Launchpad Security]
  [Edit](/bugs/1913873/%2Bwatch/142969 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from secure.gravatar.com_551a2a0d_20250115_184805.html ===
���� JFIF  ` `  �� ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
�� C 



�� C  

��  P P" ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �\*(���� ��( �����d���:]ν�j�h��co�0�\� ���2H99�װ��N=!���3�����L���)��k�5WF��[�ݏ��p�c���ҧJ� {>������߅��{=�zޓY���d��������^4zW�CGz2R^G�����O�׃���(���(����D�U�O�61\_�&���:��0�ɴ�g�3���^Z2�=��uap��ׅ
{����ٷ�%ҵ�[������|�KM%hDqC�T��Ð���'�k?��@�]���s\k� �2���ћ-�0A'�+�#\_�I�y �����Y|h\_k2xSO!�,nD�� ���#\_e�Ͽ���,�3~b���z��������l�-�r� Asl��r����>�����c��� \_7�=��n�Xm+��rkĿa��7]��n� �{�#�n�M½P�+��sl���YH�0A
x��?X�'F��\_{>�\_�=:��-4���ǎ=BFk��ڿ�Y�^x��6Koy3\_�.u��F������s���A����u�/x���麴�2 ?�[��tV<� � ��<A`�vNq�Z5��1~����FX.$�=4�b� ���`�2:Rש~���u�J�H�Zf��n�ET�HtF�+^[\_���Q�hm%s�^xJ�Sx�}�� �ѣ��^3ն�4�pZ��������k��'��񞓸 ����or������Ex|G���;y~h���ԧ��V�����e�ς��F/�ec4�Bʄ���\_�!�Rd�̒9.��%��I5�����R���������Ofd!O�E~P��h�F�X�GF\*Â����9\*� 5���\��ӟ�Q�[?�O��w�7{�����\*�[���(�7�[�����ۚ��2ԣ� i.m�?x������W�>7x���\_�Z]��ܧ��8
��eH>�O�7ŏ|S��mv�6�Z+Kd��F=[$�rO�h�� ڟZ�\���{��2\G�YG��\_�����׿��A4��G4.�KGC��A����q�G��?
�c�Դ�.e p����M~>A�3�(��#DA��N ���?�>|2��6<�7L��R:X�c�棋y=�������\_?��o����ߩ���F!�� Eu5�}C�o��\_#W��n����<0/%Է����|�^�sgB���x|S���Rݕ���\_�/�h~�a���a��!ӯ�=��>�\.Oe-^+E{���Q��%c�p���+½=��~��6+nP���|/�Q����k�.�}�ޭ�2��p.d��X���Քs�Frq��ɿ�յޛe�ޭ��
�iڭ�a.p�Hǣ� c�������k{��+��y/�������\I�Z���� \_y��4Oo3�\*4R�\*�!��������3$0���#H�K3� :������ x�\_7\�Α�͌ �,�A�b3���oῃ|'���oG����vq�!� ��־��m���'����>?�K��ol�}5����'��� �>���V^8�œY}����"uĦO�U��UO9�8��kq�s���?Z�e��mpϊ�����Ơ.�5᫱5̙������
!\�$}߯O���y�-i���}��F8.�=t�d� ���o�����e�Ŵ�n�`>�n��>�K���8=����R���l<0�cFEX�G��2����N�EWQ�!�\_�i�S���YC~�Γ
�Z�d����=H��4W5|5T9+EIy�X|U|$�� ��#�/�
j�����m��?d�IT� �Aj���|A,,4�
^�!}��"��
\_Q^���s\_����Ϣ� Z3N^\_h�l���߈��\_�>#G-����Zl�
i��7�GrKq��y��A�0)h�w����%��#�q8����J�r~aEWI���

=== Content from launchpad.net_373135e2_20250115_184808.html ===

[Log in / Register](https://launchpad.net/~pjps/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~pjps)

## [P J P](https://launchpad.net/~pjps)

* Overview
* [Code](https://code.launchpad.net/~pjps)
* [Bugs](https://bugs.launchpad.net/~pjps)
* [Blueprints](https://blueprints.launchpad.net/~pjps)
* [Translations](https://translations.launchpad.net/~pjps)
* [Answers](https://answers.launchpad.net/~pjps)

* [Related packages](https://launchpad.net/~pjps/%2Brelated-packages)
* [Related projects](https://launchpad.net/~pjps/%2Brelated-projects)

## User information

Launchpad Id:
pjps

Email:
[Log in](%2Blogin) for email information.

Member since:
2020-05-22

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~pjps/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

P J P is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from lists.debian.org_4507892b_20250114_210429.html ===


---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)]
[[Thread Prev](msg00008.html)][[Thread Next](msg00010.html)]
[[Date Index](maillist.html#00009)]
[[Thread Index](threads.html#00009)]

# [SECURITY] [DLA 2623-1] qemu security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2623-1] qemu security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Sat, 10 Apr 2021 23:21:02 +0200
* *Message-id*: <[[🔎]](/msgid-search/fc0847aae3f8257a16aee882289230de21027f7e.camel%40debian.org) [fc0847aae3f8257a16aee882289230de21027f7e.camel@debian.org](msg00009.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2623-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
April 10, 2021                                <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : qemu
Version        : 1:2.8+dfsg-6+deb9u14
CVE ID         : CVE-2020-17380 CVE-2021-3392 CVE-2021-3409 CVE-2021-3416
                 CVE-2021-20203 CVE-2021-20255 CVE-2021-20257
Debian Bug     : 984450 984451 984452 984448 984449 970937

Several security vulnerabilities have been discovered in QEMU, a fast processor
emulator.

CVE-2021-20257

    net: e1000: infinite loop while processing transmit descriptors

CVE-2021-20255

    A stack overflow via an infinite recursion vulnerability was found in the
    eepro100 i8255x device emulator of QEMU. This issue occurs while processing
    controller commands due to a DMA reentry issue. This flaw allows a guest
    user or process to consume CPU cycles or crash the QEMU process on the
    host, resulting in a denial of service.

CVE-2021-20203

    An integer overflow issue was found in the vmxnet3 NIC emulator of the
    QEMU. It may occur if a guest was to supply invalid values for rx/tx queue
    size or other NIC parameters. A privileged guest user may use this flaw to
    crash the QEMU process on the host resulting in DoS scenario.

CVE-2021-3416

    A potential stack overflow via infinite loop issue was found in various NIC
    emulators of QEMU in versions up to and including 5.2.0. The issue occurs
    in loopback mode of a NIC wherein reentrant DMA checks get bypassed. A
    guest user/process may use this flaw to consume CPU cycles or crash the
    QEMU process on the host resulting in DoS scenario.

CVE-2021-3416

    The patch for CVE-2020-17380/CVE-2020-25085 was found to be ineffective,
    thus making QEMU vulnerable to the out-of-bounds read/write access issues
    previously found in the SDHCI controller emulation code. This flaw allows a
    malicious privileged guest to crash the QEMU process on the host, resulting
    in a denial of service or potential code execution.

For Debian 9 stretch, these problems have been fixed in version
1:2.8+dfsg-6+deb9u14.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpaKbXQc0upx.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from bugzilla.redhat.com_1d09bd95_20250114_210429.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1922441)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1922441)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1922441)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1922441

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1922441**](show_bug.cgi?id=1922441)
(CVE-2021-20203)
- [CVE-2021-20203](https://access.redhat.com/security/cve/CVE-2021-20203) qemu: Failed malloc in vmxnet3\_activate\_device() in hw/net/vmxnet3.c

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-20203 qemu: Failed malloc in vmxnet3\_activate\_device() in hw/net/vmx...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-20203 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1922719](show_bug.cgi?id=1922719 "CLOSED EOL - CVE-2021-20203 qemu: Failed malloc in vmxnet3_activate_device() in hw/net/vmxnet3.c [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1905617](show_bug.cgi?id=1905617) | | TreeView+ | [depends on](buglist.cgi?bug_id=1922441&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1922441&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-01-29 17:55 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-11-19 12:34 UTC ([History](show_activity.cgi?id=1922441)) | | [CC List:](page.cgi?id=fields.html#cclist) | 27 users (show)  ailan berrange cfergeau drjones imammedo itamar jen jferlan jforbes jmaloy knoel m.a.young mkenneth mrezanin mst ondrejj pbonzini philmd ppandit ribarry rjones robinlee.sysu security-response-team virt-maint virt-maint vkuznets xen-maint | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | An integer overflow flaw was found in the vmxnet3 NIC emulator of QEMU. This issue occurs when a guest supplies invalid values for the rx/tx queue size or other NIC parameters. This flaw allows a privileged guest user to crash the QEMU process on the host, resulting in a denial of service. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-01-31 08:41:42 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1922441#c0)  Pedro Sampaio    2021-01-29 17:55:15 UTC  ``` An integer overflow issue was found in the vmxnet3 NIC emulator of the QEMU. It may occur if a guest was to supply invalid values for rx/tx queue size or other NIC parameters. A privileged guest user may use this flaw to crash the QEMU process on the host resulting in DoS scenario.  Upstream patch: ---------------   -> <https://lists.gnu.org/archive/html/qemu-devel/2021-01/msg07935.html>   ```  [Comment 1](show_bug.cgi?id=1922441#c1)  Prasad Pandit    2021-01-31 04:21:46 UTC  ``` Acknowledgments:  Name: Gaoning Pan (Zhejiang University & Ant Security Light-Year Lab)   ```  [Comment 2](show_bug.cgi?id=1922441#c2)  Prasad Pandit    2021-01-31 04:21:50 UTC  ``` Statement:  This issue does not affect the versions of the qemu-kvm package as shipped with Red Hat Enterprise Linux 5, 6, 7 and 8.   ```  [Comment 3](show_bug.cgi?id=1922441#c3)  Prasad Pandit    2021-01-31 04:21:53 UTC  ``` External References:  [https://bugs.launchpad.net/qemu/+bug/1913873](https://bugs.launchpad.net/qemu/%2Bbug/1913873)   ```  [Comment 4](show_bug.cgi?id=1922441#c4)  Prasad Pandit    2021-01-31 04:28:42 UTC  ``` Created qemu tracking bugs for this issue:  Affects: fedora-all [[bug 1922719](show_bug.cgi?id=1922719 "CLOSED EOL - CVE-2021-20203 qemu: Failed malloc in vmxnet3_activate_device() in hw/net/vmxnet3.c [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=1922441#c5)  Product Security DevOps Team    2021-01-31 08:41:42 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2021-20203>   ```  [Comment 8](show_bug.cgi?id=1922441#c8)  Philippe Mathieu-Daudé    2021-11-19 12:34:19 UTC  ``` Fixed by <https://gitlab.com/qemu-project/qemu/-/commit/d05dcd94aee88>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1922441&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_074f076c_20250115_184807.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_5daa1f25_20250115_121706.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.debian.org_c98311a9_20250114_210429.html ===


---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)]
[[Thread Prev](msg00007.html)][[Thread Next](msg00009.html)]
[[Date Index](maillist.html#00008)]
[[Thread Index](threads.html#00008)]

# [SECURITY] [DLA 3099-1] qemu security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3099-1] qemu security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Mon, 5 Sep 2022 08:58:05 +0530
* *Message-id*: <YxVsxXlWx/Sdg4MV@debian.org>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3099-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
September 05, 2022                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : qemu
Version        : 1:3.1+dfsg-8+deb10u9
CVE ID         : CVE-2020-13253 CVE-2020-15469 CVE-2020-15859 CVE-2020-25084
                 CVE-2020-25085 CVE-2020-25624 CVE-2020-25625 CVE-2020-25723
                 CVE-2020-27617 CVE-2020-27821 CVE-2020-28916 CVE-2020-29129
                 CVE-2020-29443 CVE-2020-35504 CVE-2020-35505 CVE-2021-3392
                 CVE-2021-3416 CVE-2021-3507 CVE-2021-3527 CVE-2021-3582
                 CVE-2021-3607 CVE-2021-3608 CVE-2021-3682 CVE-2021-3713
                 CVE-2021-3748 CVE-2021-3930 CVE-2021-4206 CVE-2021-4207
                 CVE-2021-20181 CVE-2021-20196 CVE-2021-20203 CVE-2021-20221
                 CVE-2021-20257 CVE-2022-26354 CVE-2022-35414

Multiple security issues were discovered in QEMU, a fast processor
emulator, which could result in denial of service or the the execution
of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:3.1+dfsg-8+deb10u9.

We recommend that you upgrade your qemu packages.

For the detailed security status of qemu please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/qemu>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmMVbMUACgkQhj1N8u2c
KO+N6w//XuvPOvMxGsDw3swppKApkL1ECz7NC1L4xRouPyHhh0JZrqwovd5miY6M
mmIq2zeurtEVhf6kkhw1NP3ywrfgURyf7RhpcLN3z/o8aqjLoxL6fIJGzv9URulC
6xDpu1n5mKTI/EX8Zeqy9ks3+HgHNAg9jr5s5TWIYlJLhhlYvrvMbUAeM04V8Zaw
XGXJj0Jx1f83CMFVNXDJ6shBzfUZII3taZIjUFcME5DUFNxaG8492nYisRcwlDNy
Z1AOGbhehZlgbk5t4cX2kOMq/qp9EiAqrBUZgqXtT+zCRBr4hQjK5OOmaq69p4N5
RsS8MA3/Rtvt9b3xuNXnDy28O50yvlQJK9GJa/p8KM894pn2fMTu3pxFVAn4xIsp
umcx4LbxSYaBDygtK81xhxK3ODfakR8YGmXUffeRasPw/mFncdN9kTxCvuSgdoUO
rgqcmJ+D38JAzV+ALjEnMZkrGYzscM6GzKHA5DR37qmdG/JNNKpqy3TRWBpNY4ZL
QYmAIW5MvCx3SEgZBeAkUwPpfam6d3DwKm7RUvmvL5ul/UDcyowYRCpZGwgtyL57
8N3yu0V9IA0L04yuiUcd9RE3qXGsFQU7YvzpB7hEj2WQIV2i9LDb+5D2qnUJmdCR
+dCiSgxf0qi14Rbhv9gZ4/jCAC4fWHHGuyCO4ySyLVmDgtgBpQo=
=EhD5
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_a9cedf15_20250114_210429.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# QEMU: Multiple Vulnerabilities — GLSA **202208-27**

Multiple vulnerabilities have been discovered in QEMU, the worst of which could result in remote code execution (guest sandbox escape).

### Affected packages

| Package | **app-emulation/qemu** on all architectures |
| --- | --- |
| Affected versions | < **7.0.0** |
| Unaffected versions | >= **7.0.0** |

### Background

QEMU is a generic and open source machine emulator and virtualizer.

### Description

Multiple vulnerabilities have been discovered in QEMU.Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All QEMU users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/qemu-7.0.0"

```
### References

* [CVE-2020-15859](https://nvd.nist.gov/vuln/detail/CVE-2020-15859)
* [CVE-2020-15863](https://nvd.nist.gov/vuln/detail/CVE-2020-15863)
* [CVE-2020-16092](https://nvd.nist.gov/vuln/detail/CVE-2020-16092)
* [CVE-2020-35504](https://nvd.nist.gov/vuln/detail/CVE-2020-35504)
* [CVE-2020-35505](https://nvd.nist.gov/vuln/detail/CVE-2020-35505)
* [CVE-2020-35506](https://nvd.nist.gov/vuln/detail/CVE-2020-35506)
* [CVE-2020-35517](https://nvd.nist.gov/vuln/detail/CVE-2020-35517)
* [CVE-2021-3409](https://nvd.nist.gov/vuln/detail/CVE-2021-3409)
* [CVE-2021-3416](https://nvd.nist.gov/vuln/detail/CVE-2021-3416)
* [CVE-2021-3527](https://nvd.nist.gov/vuln/detail/CVE-2021-3527)
* [CVE-2021-3544](https://nvd.nist.gov/vuln/detail/CVE-2021-3544)
* [CVE-2021-3545](https://nvd.nist.gov/vuln/detail/CVE-2021-3545)
* [CVE-2021-3546](https://nvd.nist.gov/vuln/detail/CVE-2021-3546)
* [CVE-2021-3582](https://nvd.nist.gov/vuln/detail/CVE-2021-3582)
* [CVE-2021-3607](https://nvd.nist.gov/vuln/detail/CVE-2021-3607)
* [CVE-2021-3608](https://nvd.nist.gov/vuln/detail/CVE-2021-3608)
* [CVE-2021-3611](https://nvd.nist.gov/vuln/detail/CVE-2021-3611)
* [CVE-2021-3682](https://nvd.nist.gov/vuln/detail/CVE-2021-3682)
* [CVE-2021-3713](https://nvd.nist.gov/vuln/detail/CVE-2021-3713)
* [CVE-2021-3748](https://nvd.nist.gov/vuln/detail/CVE-2021-3748)
* [CVE-2021-3750](https://nvd.nist.gov/vuln/detail/CVE-2021-3750)
* [CVE-2021-3929](https://nvd.nist.gov/vuln/detail/CVE-2021-3929)
* [CVE-2021-3930](https://nvd.nist.gov/vuln/detail/CVE-2021-3930)
* [CVE-2021-3947](https://nvd.nist.gov/vuln/detail/CVE-2021-3947)
* [CVE-2021-4145](https://nvd.nist.gov/vuln/detail/CVE-2021-4145)
* [CVE-2021-4158](https://nvd.nist.gov/vuln/detail/CVE-2021-4158)
* [CVE-2021-4206](https://nvd.nist.gov/vuln/detail/CVE-2021-4206)
* [CVE-2021-4207](https://nvd.nist.gov/vuln/detail/CVE-2021-4207)
* [CVE-2021-20203](https://nvd.nist.gov/vuln/detail/CVE-2021-20203)
* [CVE-2021-20257](https://nvd.nist.gov/vuln/detail/CVE-2021-20257)
* [CVE-2021-20263](https://nvd.nist.gov/vuln/detail/CVE-2021-20263)
* [CVE-2022-0358](https://nvd.nist.gov/vuln/detail/CVE-2022-0358)
* [CVE-2022-26353](https://nvd.nist.gov/vuln/detail/CVE-2022-26353)
* [CVE-2022-26354](https://nvd.nist.gov/vuln/detail/CVE-2022-26354)

**Release date**

August 14, 2022

**Latest revision**

August 14, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [733448](https://bugs.gentoo.org/show_bug.cgi?id=733448)
* [736605](https://bugs.gentoo.org/show_bug.cgi?id=736605)
* [773220](https://bugs.gentoo.org/show_bug.cgi?id=773220)
* [775713](https://bugs.gentoo.org/show_bug.cgi?id=775713)
* [780816](https://bugs.gentoo.org/show_bug.cgi?id=780816)
* [792624](https://bugs.gentoo.org/show_bug.cgi?id=792624)
* [807055](https://bugs.gentoo.org/show_bug.cgi?id=807055)
* [810544](https://bugs.gentoo.org/show_bug.cgi?id=810544)
* [820743](https://bugs.gentoo.org/show_bug.cgi?id=820743)
* [835607](https://bugs.gentoo.org/show_bug.cgi?id=835607)
* [839762](https://bugs.gentoo.org/show_bug.cgi?id=839762)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


