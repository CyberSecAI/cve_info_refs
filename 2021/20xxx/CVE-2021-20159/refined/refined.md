### CVE-2021-20159
- **Root Cause:** The system log functionality of the Trendnet AC2600 TEW-827DRU firmware allows for command injection as root due to a malformed parameter. Specifically, the syslog daemon is spawned during boot, and if a malformed parameter is included in the configuration file, it won't start. When the syslog configuration page is visited, the backend checks if syslogd is running. If not, it attempts to run it through a system() call that accepts user-controlled input, allowing command injection.
- **Weaknesses/Vulnerabilities:**
    - Command Injection: A malformed parameter in the syslog configuration leads to command injection.
    - Improper Input Validation: The syslog configuration page does not properly validate user input before passing it to the system() function.
- **Impact of Exploitation:** Successful exploitation allows an attacker to execute arbitrary commands as root on the device.
- **Attack Vectors:**
    - Network-based: An attacker can send a crafted HTTP POST request to modify the device's configuration and inject a malicious command into the syslog server parameter, which is later executed when syslogd is restarted.
- **Required Attacker Capabilities/Position:**
    - The attacker needs to be able to send HTTP requests to the device's management interface.
    - Requires a valid session (Authenticated access) or the ability to bypass authentication.