```
{
  "CVE-2021-20179": {
    "Description": "The provided data reveals a vulnerability in the Dogtag PKI's RenewalProcessor. Due to a recent change in the PKI CLI, the CLI now passes user authentication with renewal requests. Unlike the EE pages, the REST API has always passed this authentication. When a request with authentication is made against a profile with no authentication method and no ACLs, the certificate is automatically approved due to a bug in the RenewalProcessor. This vulnerability is a result of not validating the passed principal to check if it was a trusted agent, especially after a code modification to allow Lightweight SubCAs to issue certificates. Profiles requiring Agent approval have an empty ACL list, and the authorization logic allows any user to approve the request accepting the AuthToken.",
    "Root cause": "The `RenewalProcessor` code incorrectly interpreted a non-null `authToken` as evidence of authorization, leading to immediate certificate issuance without proper authentication or authorization checks.",
    "Weaknesses": [
      "Improper authorization check",
      "Lack of validation of authentication tokens",
      "Incorrect use of a non-null authToken as an authorization check"
    ],
    "Impact": "Unprivileged users could renew any certificate, potentially leading to unauthorized certificate issuance and a compromise of confidentiality and integrity.  An attacker could repeatedly renew compromised certificates.",
    "Attack vectors": [
      "The vulnerability can be exploited via the REST API or the PKI CLI"
    ],
     "Required attacker capabilities": "An attacker with valid credentials and knowledge of the renewal endpoint, or someone with access to a compromised key can exploit this vulnerability. "
  }
}
```