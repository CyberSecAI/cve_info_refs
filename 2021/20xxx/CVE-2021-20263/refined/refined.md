```
{
  "cve": "CVE-2021-20263",
  "description": "A flaw was found in the virtio-fs shared file system daemon (virtiofsd) of QEMU. The new 'xattrmap' option may cause the 'security.capability' xattr in the guest to not drop on file write, potentially leading to a modified, privileged executable in the guest. In rare circumstances, this flaw could be used by a malicious user to elevate their privileges within the guest.",
  "affected_component": "virtio-fs shared file system daemon (virtiofsd) of QEMU",
  "root_cause": "The virtiofsd's 'xattrmap' option, when used to rename the 'security.capability' extended attribute (xattr), fails to drop this remapped xattr on file write operations. The host kernel normally handles this automatically, but the remapping prevents it from doing so.",
  "vulnerabilities": [
    "The 'security.capability' xattr is not dropped on file write when remapped using the 'xattrmap' option."
  ],
  "impact": "A malicious user inside the guest virtual machine can potentially elevate their privileges by modifying a privileged executable due to the 'security.capability' xattr not being dropped, potentially leading to a modified, privileged executable in the guest.",
  "attack_vectors": [
    "A malicious user with write access to files within the shared directory can modify a privileged executable and gain elevated privileges.",
    "The vulnerability is triggered by using the `-o xattr` and `-o xattrmap` options when running virtiofsd and if 'security.capability' is one of the renamed xattrs."
  ],
  "required_capabilities": [
    "The attacker needs to have write access to the shared filesystem in the guest operating system."
  ],
  "additional_details": [
      "The issue is more easily reproducible when the cache mode is set to 'none' (`-o cache=none`), but it may also occur with the default option '-o cache=auto'.",
      "The impact is limited since the 'xattrmap' feature is relatively new and not widely used.",
      "Unprivileged users should not have write permissions to privileged executables."
  ]
}
```