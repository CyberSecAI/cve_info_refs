```
{
  "CVE-2021-20314": {
    "Description": "Stack buffer overflow in libspf2 versions below 1.2.11 when processing certain SPF macros can lead to Denial of service and potentially code execution via malicious crafted SPF explanation messages.",
    "Root cause": "The vulnerability is due to an incorrect buffer length adjustment in the `SPF_INIT_STRING_LITERAL` macro. This macro places a 4-byte header of type `SPF_data_str` into the buffer inside `buf` without decreasing the available size `ds_avail` by 4. This leads to a 4-byte stack buffer overflow.",
    "Weaknesses": [
      "Stack buffer overflow"
    ],
    "Impact": "Denial of service and potentially code execution.",
      "Attack vectors": [
          "An attacker needs to control a domain's SPF record such that a mail server processing emails from this domain will trigger the vulnerability. This can be done by crafting a malicious SPF explanation message."
    ],
    "Required attacker capabilities/position": [
      "An attacker needs to control a domain's DNS records, specifically the SPF record, and be able to send an email using this domain."
    ],
      "Additional Information": [
        "The issue was fixed in github commit c37b7c1.",
          "The vulnerability exists in libspf2 versions prior to 1.2.11.",
          "The overflow occurs in `SPF_record_compile_macro` function, allowing the attacker to overwrite up to 4 bytes on the stack.",
          "The fix involves correctly accounting for the size of `SPF_data_t` when allocating memory for the string literal."
      ]
  }
}
```