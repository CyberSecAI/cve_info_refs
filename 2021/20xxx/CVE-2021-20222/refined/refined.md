Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from a reflected Cross-Site Scripting (XSS) flaw in the Keycloak new account console. The console was vulnerable to malicious code injection through the referrer URL.

**Weaknesses/Vulnerabilities:**
- Reflected XSS vulnerability in the new account console of Keycloak.
- The application was not properly sanitizing the referrer URL before using it in the context of the new account console.

**Impact of Exploitation:**
- Data confidentiality and integrity could be compromised.
- System availability could be affected due to malicious code execution within the application.

**Attack Vectors:**
- An attacker crafts a malicious URL that includes the malicious payload within the referrer.
- When a user accesses the vulnerable Keycloak new account console through the crafted malicious URL, the malicious payload is executed in the user's browser.

**Required Attacker Capabilities/Position:**
- The attacker must be able to craft a malicious URL containing the XSS payload.
- The attacker needs to trick a user into accessing the crafted URL, usually by embedding the crafted URL into a link and sending it through social engineering.

**Additional Information:**
- The vulnerability was present in Keycloak's new account console which was first introduced in Keycloak version 9.
- The new account console feature was a tech preview and not enabled by default in Keycloak version 11.0.1, requiring specific system properties to enable. This is why the impact was downgraded to low in this specific version.
- The vulnerability was fixed in Keycloak version 12.0.3.
- The fix was implemented in the internal keycloak-prod repository via the pull request: `https://github.com/keycloak/keycloak-prod/pull/421`.

The provided text also mentions a duplicate bug report: 1922216.