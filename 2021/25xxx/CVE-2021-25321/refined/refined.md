The content is related to CVE-2021-25321.

Root cause of vulnerability:
- The arpwatch daemon, when run with an unprivileged user, changes the ownership of the /var/lib/arpwatch directory and its files to the unprivileged user.
- The `dropprivileges` function in `arpwatch` uses `chown` to change the ownership of the arpwatch directory and files to the specified user.

Weaknesses/vulnerabilities present:
- Insecure file handling during privilege dropping.
- The program changes the ownership of the directory and files to the specified user, even if a symbolic link is created in place of the expected file (arp.dat in this case).
- This allows an attacker to change the ownership of any file on the filesystem if they can place a symbolic link to it within the directory before arpwatch is started using a non-root user.

Impact of exploitation:
- Local privilege escalation (LPE) from a runtime user to root.
- An attacker can gain ownership of arbitrary files on the filesystem, including sensitive files like `/etc/shadow`, by creating a symbolic link to it and running arpwatch with a specified unprivileged user.
- The attacker can then modify or read the contents of the file they gain ownership over.

Attack vectors:
- Local attacker.
- The attacker needs to have the ability to start the `arpwatch` service with a specified unprivileged user (via the `-u` command line argument).
- The attacker needs to be able to place a symbolic link in the /var/lib/arpwatch directory before the service is started.

Required attacker capabilities/position:
- Ability to execute commands as a local user.
- Knowledge of how to create symbolic links.
- Ability to run the arpwatch service using a user of choice.