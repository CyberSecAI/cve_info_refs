The content is related to CVE-2021-25682.

**Root cause of vulnerability:**
The vulnerability stems from improper parsing of the `/proc/pid/status` file within the `get_pid_info` function of the `apport` program. The function iterates through each line of the file, and if a line starts with "Uid:" or "Gid:", it extracts the first argument as the real user ID (`real_uid`) or real group ID (`real_gid`), respectively.

**Weaknesses/vulnerabilities present:**
- **Incorrect parsing of `/proc/pid/status`:** The `apport` program does not properly sanitize or validate the content of the `/proc/pid/status` file. This allows an attacker to inject arbitrary values for `Uid` and `Gid` by crafting a malicious process name containing strings such as "a\rUid: 0\rGid: 0". When a process with such a name crashes, the crafted values are present in the `/proc/pid/status` file (within the Name field), which are then read by apport and used as `real_uid` and `real_gid`.

- **Bypassed privilege dropping:** Because `real_uid` and `real_gid` can be manipulated, the `drop_privileges` function in apport can be bypassed. If a crafted process with a name such as "a\rUid: 0\rGid: 0" crashes, `real_uid` and `real_gid` are set to 0. This leads to bypassing the suid check in the `write_user_coredump` function, because the process effectively runs as root when writing the core dump.

**Impact of exploitation:**
- **Local privilege escalation to root:** An unprivileged user can exploit this vulnerability to gain root privileges. By manipulating the values of `real_uid` and `real_gid`, they can bypass privilege dropping in `apport`, and create a core dump owned by root, in an arbitrary location. By controlling the contents of this core dump, they can execute arbitrary code as root.

**Attack vectors:**
- **Local attack:** The attacker must be able to execute code locally on the target system.
- **Process name manipulation:** The attacker must craft a process name with specific embedded Uid/Gid strings that will be read from the /proc/pid/status file.
- **Controlled core dump:** The attacker must be able to control the contents of the core dump file written by apport, and they need to write this to a location of their choice, by leveraging the crafted process name.

**Required attacker capabilities/position:**
- **Unprivileged user access:** The attacker only needs to have a regular user account on the target system.
- **Ability to create and execute processes:** The attacker must be able to create processes with specific names, trigger process crashes, and create FIFO files.
- **Control over process names:** The attacker must be able to control the process name of a crashing process and recycle PIDs.