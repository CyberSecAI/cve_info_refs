### CVE-2021-25994

**Root cause of vulnerability:** The application is vulnerable to Host Header Injection because it doesn't validate the Host header when generating password reset links.

**Weaknesses/vulnerabilities present:**
*   Host Header Injection: The application uses the value of the `Host` header from an HTTP request to construct password reset URLs without proper sanitization or validation.

**Impact of exploitation:**
*   Account Takeover: An attacker can manipulate the password reset process to send the reset token to a server controlled by them, allowing them to then reset the victim's password and gain full access to their account.

**Attack vectors:**
*   The attacker initiates the password reset process by submitting a forgot password request with the victim's email.
*   The attacker intercepts the password reset request and modifies the `Host` header to point to their server.
*   The application sends the password reset email to the victim, but the reset link contains the attacker's server in the URL.
*   The victim clicks the malicious password reset link, sending the reset token to the attacker.
*   The attacker uses the token to reset the victim's password, thus gaining access to the victim's account.

**Required attacker capabilities/position:**
*   The attacker needs to be able to intercept and modify HTTP requests, for example, by using a proxy tool.
*   The attacker needs to have a server listening on the port specified in the malicious Host header to receive the reset token from the victim.
*   The attacker does not need any prior authentication or special privileges. They exploit the "forgot password" functionality.
*   The attacker needs to lure a victim into clicking the password reset link.