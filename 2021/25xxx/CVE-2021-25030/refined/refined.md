- **Root cause of vulnerability:** The `search_text` parameter in the `eme_searchmail` AJAX action is not sanitized or escaped before being used in a SQL query.
- **Weaknesses/vulnerabilities present:** SQL Injection (SQLI).
- **Impact of exploitation:** An attacker can execute arbitrary SQL queries, potentially leading to data exfiltration, modification, or deletion. In this specific example, the attacker is able to retrieve user passwords and emails.
- **Attack vectors:** By sending a crafted POST request to `wp-admin/admin-ajax.php` with the `action` parameter set to `eme_searchmail` and a malicious SQL query in the `search_text` parameter.
- **Required attacker capabilities/position:** The attacker needs to be an authenticated user with a role as low as subscriber.