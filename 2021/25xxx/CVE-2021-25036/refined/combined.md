=== Content from wpscan.com_44d2d824_20250114_230054.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# All In One SEO < 4.1.5.3 - Authenticated Privilege Escalation

### Description

The plugin is affected by a Privilege Escalation issue, which was discovered during an internal audit by the Jetpack Scan team, and may grant bad actors access to protected REST API endpoints they shouldn’t have access to. This could ultimately enable users with low-privileged accounts, like subscribers, to perform remote code execution on affected sites.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

all-in-one-seo-pack](https://a8cteam5105.wordpress.com/plugin/all-in-one-seo-pack/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.1.5.3

### References

CVE
[CVE-2021-25036](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25036)

URL
<https://jetpack.com/2021/12/14/severe-vulnerabilities-fixed-in-all-in-one-seo-plugin-version-4-1-5-3/>

URL
<https://plugins.trac.wordpress.org/changeset/2640944/all-in-one-seo-pack/trunk/app/Common/Api/Api.php>

### Classification

Type
AUTHBYPASS

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-287](https://cwe.mitre.org/data/definitions/287.html)

CVSS
[9.9 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Marc Montpas (Jetpack Scan)

Submitter
Marc Montpas (Jetpack Scan)

Submitter website
<https://jetpack.com/scan>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[6de4a7de-6b71-4349-8e52-04c89c5e6d6c](https://a8cteam5105.wordpress.com/vulnerability/6de4a7de-6b71-4349-8e52-04c89c5e6d6c/)

### Timeline

Publicly Published
2021-12-14 (about 3 years ago)

Added
2021-12-14 (about 3 years ago)

Last Updated
2022-04-12 (about 2 years ago)

### Other

Published
Title

Published
2019-12-12
Title
[Ultimate Addons for Elementor < 1.20.1 - Authentication Bypass](https://a8cteam5105.wordpress.com/vulnerability/e17430d9-f70f-40de-ad37-53810a96b2fc/)

Published
2013-03-24
Title
[Backupbuddy - importbuddy.php Restore Operation Persistence Weakness](https://a8cteam5105.wordpress.com/vulnerability/c3ee2e43-7572-46cf-9f18-a88fe28efa4d/)

Published
2015-05-04
Title
[Pie Register 2.0.14-2.0.15 - Privilege Escalation](https://a8cteam5105.wordpress.com/vulnerability/f30f77bd-2e6e-45cd-ac02-c9d3985844da/)

Published
2023-11-27
Title
[Swift Performance Lite <= 2.3.6.14 - Unauthenticated Configuration Export](https://a8cteam5105.wordpress.com/vulnerability/8c83dd57-9291-4dfc-846d-5ad47534e2ad/)

Published
2021-12-08
Title
[Registration Magic < 5.0.1.8 - Authentication Bypass](https://a8cteam5105.wordpress.com/vulnerability/88726c39-03b0-4831-81d5-a254aa78a2a3/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from jetpack.com_39a6ba3c_20250114_230051.html ===


[Skip to main content](#content)

[Menu](#mobile-menu)

* Products
   Back
  + [Security](https://jetpack.com/features/security/)
    - [VaultPress Backup](https://jetpack.com/upgrade/backup/)
    - [Scan](https://jetpack.com/upgrade/scan/)
    - [Akismet Anti-spam](https://jetpack.com/upgrade/anti-spam/)
  + [Performance](https://jetpack.com/features/performance/)
    - [Site Search](https://jetpack.com/upgrade/search/)
    - [Boost](https://jetpack.com/boost/)
    - [VideoPress](https://jetpack.com/videopress/)
  + [Growth](https://jetpack.com/features/growth/)
    - [Stats](https://jetpack.com/stats/)
    - [Social](https://jetpack.com/social/)
    - [Blaze](https://jetpack.com/blaze/)
  + [Management](https://jetpack.com/pro-dashboard/)
    - [For Agencies](https://jetpack.com/for-agencies/)
    - [CRM](https://jetpackcrm.com/?utm_medium=automattic_referred&utm_source=jpcom_header)
    - [Mobile app](https://jetpack.com/mobile/)
  + [Create](https://jetpack.com/ai/)
    - [AI Assistant](https://jetpack.com/ai/)

  Product Bundles

  + [Complete

    VaultPress Backup

    Akismet Anti-Spam

    Scan

    Search

    Social

    VideoPress

    Boost

    CRM](https://jetpack.com/complete/)
  + [Security

    VaultPress Backup

    Akismet Anti-Spam

    Scan](https://jetpack.com/features/security/)
  + [Growth

    Stats

    Social

    Newsletter](https://jetpack.com/features/growth/)
* [Pricing](https://jetpack.com/pricing/)
* [Partners](https://jetpack.com/jetpack-partners/)
* [Support](https://jetpack.com/support/)
* [Blog](https://jetpack.com/blog/)
* More

* [Search](/?s=)
* [Log in](https://jetpack.com/login/)
* [Get started](https://jetpack.com/pricing/)

![](https://jetpack.com/wp-content/uploads/2021/10/jetpack-blog-malware-header-6.jpeg?w=850)
# Severe Vulnerabilities Fixed in All In One SEO Plugin Version 4.1.5.3

Updated on December 14, 2021 - Marc Montpas

During an internal audit of the [All In One SEO](https://wordpress.org/plugins/all-in-one-seo-pack/) plugin, we uncovered an SQL Injection vulnerability and a Privilege Escalation bug.

If exploited, the SQL Injection vulnerability could grant attackers access to privileged information from the affected site’s database (e.g., usernames and hashed passwords).

The Privilege Escalation bug we discovered may grant bad actors access to protected REST API endpoints they shouldn’t have access to. This could ultimately enable users with low-privileged accounts, like subscribers, to perform remote code execution on affected sites.

We reported the vulnerabilities to the plugin’s author via email, and they recently released version 4.1.5.3 to address them. We strongly recommend that you update to the latest plugin version and have an established security solution on your site, such as [Jetpack Security](https://jetpack.com/features/security/).

## Details

Plugin Name: All In One SEO
Plugin URI: <https://wordpress.org/plugins/all-in-one-seo-pack/>
Author: <https://aioseo.com/>

## The Vulnerabilities

### Authenticated Privilege Escalation

**Affected versions:** Every version between 4.0.0 and 4.1.5.2 inclusively.
**CVE-ID:** CVE-2021-25036
**CVSSv3.1:** [9.9](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)
**CWSS:** [92.1](https://www.cwss-score.info/#TI:C,1/AP:P,0.9/AL:NA,1/IC:NA,1.0/FC:T,1/RP:RU,0.7/RL:NA,1/AV:I,1/AS:NA,1/IN:A,1/SC:A,1/BI:C,1/DI:NA,1/EX:H,1/EC:NA,1/P:NA,1/)

```

	/**
	 * Validates access from the routes array.
	 *
	 * @since 4.0.0
	 *
	 * @param  \WP_REST_Request $request The REST Request.
	 * @return bool                      True if validated, false if not.
	 */
	public function validateAccess( $request ) {
		$route     = str_replace( '/' . $this->namespace . '/', '', $request->get_route() );
		$routeData = isset( $this->getRoutes()[ $request->get_method() ][ $route ] ) ? $this->getRoutes()[ $request->get_method() ][ $route ] : [];

		// No direct route name, let's try the regexes.
		if ( empty( $routeData ) ) {
			foreach ( $this->getRoutes()[ $request->get_method() ] as $routeRegex => $routeInfo ) {
				$routeRegex = str_replace( '@', '\@', $routeRegex );
				if ( preg_match( "@{$routeRegex}@", $route ) ) {
					$routeData = $routeInfo;
					break;
				}
			}
		}

		if ( empty( $routeData['access'] ) ) {
			return true;
		}

		// We validate with any of the access options.
		if ( ! is_array( $routeData['access'] ) ) {
			$routeData['access'] = [ $routeData['access'] ];
		}
		foreach ( $routeData['access'] as $access ) {
			if ( current_user_can( $access ) ) {
				return true;
			}
		}

		if ( current_user_can( apply_filters( 'aioseo_manage_seo', 'aioseo_manage_seo' ) ) ) {
			return true;
		}

		return false;
	}

```

The privilege checks applied by All In One SEO to secure REST API endpoints contained a very subtle bug that could’ve granted users with low-privileged accounts (like subscribers) access to every single endpoint the plugin registers.

The Api::validateAccess() method relies on the REST API route being requested to know which privilege checks to enforce on a given request. Since it didn’t account for the fact that WordPress treats REST API routes as [case-insensitive strings](https://core.trac.wordpress.org/browser/trunk/src/wp-includes/rest-api/class-wp-rest-server.php#L1019), changing a single character to uppercase would completely bypass the privilege checks routine.

This is particularly worrying because some of the plugin’s endpoints are pretty sensitive. For example, the `aioseo/v1/htaccess` endpoint can rewrite a site’s .htaccess with arbitrary content. An attacker could abuse this feature to hide [.htaccess backdoors](https://github.com/wireghoul/htshells) and execute malicious code on the server.

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

Have a question?

Comments are closed for this article, but we're still here to help! Visit the support forum and we'll be happy to answer any questions.

[View support forum](https://wordpress.org/support/plugin/jetpack/)

- Search
- Enter your email address to receive news and updates from Jetpack
- Type your email…

  Subscribe

  Join 113.1K other subscribers
- ### Browse by Topic

  * [AI](https://jetpack.com/blog/category/ai/) (2)
  * [Analytics](https://jetpack.com/blog/category/analytics/) (21)
  * [Code snippets](https://jetpack.com/blog/category/developers/code-snippets/) (32)
  * [Contribute](https://jetpack.com/blog/category/contribute-2/) (6)
  * [Customer stories](https://jetpack.com/blog/category/customer-stories/) (6)
  * [Developers](https://jetpack.com/blog/category/developers/) (3)
  * [Ecommerce](https://jetpack.com/blog/category/ecommerce/) (18)
  * [Events](https://jetpack.com/blog/category/events/) (6)
  * [Features](https://jetpack.com/blog/category/features/) (69)
  * [Grow](https://jetpack.com/blog/category/grow/) (36)
  * [Hosting](https://jetpack.com/blog/category/hosting/) (7)
  * [Innovate](https://jetpack.com/blog/category/innovate/) (7)
  * [Jetpack News](https://jetpack.com/blog/category/jetpack-news/) (78)
  * [Learn](https://jetpack.com/blog/category/learn/) (117)
  * [Meet Jetpack](https://jetpack.com/blog/category/meet-jetpack/) (15)
  * [Mobile](https://jetpack.com/blog/category/mobile/) (1)
  * [Performance](https://jetpack.com/blog/category/performance/) (50)
  * [Photos & Videos](https://jetpack.com/blog/category/photos-videos/) (14)
  * [Promotions](https://jetpack.com/blog/category/promotions/) (2)
  * [Releases](https://jetpack.com/blog/category/releases/) (189)
  * [Scan](https://jetpack.com/blog/category/scan/) (2)
  * [Search Engine Optimization](https://jetpack.com/blog/category/search-engine-optimization/) (12)
  * [Security](https://jetpack.com/blog/category/security/) (146)
  * [Small Business](https://jetpack.com/blog/category/small-business/) (17)
  * [Social Media](https://jetpack.com/blog/category/social-media/) (48)
  * [Stats](https://jetpack.com/blog/category/stats/) (2)
  * [Support Stories](https://jetpack.com/blog/category/support-stories/) (3)
  * [Tips & Tricks](https://jetpack.com/blog/category/tips-tricks/) (90)
  * [Utilities & Maintenance](https://jetpack.com/blog/category/utilities-maintenance/) (13)
  * [Vulnerabilities](https://jetpack.com/blog/category/vulnerabilities/) (29)
  * [Webinars](https://jetpack.com/blog/category/webinars/) (2)
  * [Website Design](https://jetpack.com/blog/category/website-design/) (17)
  * [WordAds](https://jetpack.com/blog/category/wordads/) (1)
  * [WordCamp](https://jetpack.com/blog/category/events/wordcamp/) (5)

Jetpack

Explore the benefits of Jetpack

Learn how Jetpack can help you protect, speed up, and grow your WordPress site. [Get up to 53% off your first year.](https://jetpack.com/pricing/)

[Explore plans](https://jetpack.com/pricing/)

en

* WordPress Plugins
  + [Akismet Anti-spam](https://wordpress.org/plugins/akismet/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack](https://wordpress.org/plugins/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Boost](https://wordpress.org/plugins/jetpack-boost/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack CRM](https://wordpress.org/plugins/zero-bs-crm/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Protect](https://wordpress.org/plugins/jetpack-protect/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Search](https://wordpress.org/plugins/jetpack-search/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack Social](https://wordpress.org/plugins/jetpack-social/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Jetpack VideoPress](https://wordpress.org/plugins/jetpack-videopress/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [VaultPress Backup](https://wordpress.org/plugins/jetpack-backup/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [WP Super Cache](https://wordpress.org/plugins/wp-super-cache/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Download](https://jetpack.com/download/)
* Partners
  + [Recommended Hosts](https://jetpack.com/hosting/)
  + [For Hosts](https://jetpack.com/for/hosts/)
  + [For Agencies](https://jetpack.com/for-agencies/)
  + [For Affiliates](https://jetpack.com/affiliates/)
* Developers
  + [Documentation](https://developer.jetpack.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Beta Program](https://jetpack.com/beta/)
  + [Contribute to Jetpack](https://jetpack.com/contribute/)
  + [Jetpack on GitHub](https://github.com/Automattic/jetpack)
* Legal
  + [Terms of Service](https://wordpress.com/tos/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Privacy Policy](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [GDPR](https://jetpack.com/gdpr/)
  + Do Not Sell or Share My Personal Information
  + [Privacy Notice for California Users](https://automattic.com/privacy/?utm_medium=automattic_referred&utm_source=jpcom_footer#california-consumer-privacy-act-ccpa)
* Help
  + [Knowledge Base](https://jetpack.com/support/)
  + [Forums](https://wordpress.org/support/plugin/jetpack/?utm_medium=automattic_referred&utm_source=jpcom_footer)
  + [Webinars](https://jetpack.com/webinars/)
  + [Reviews and Testimonials](https://jetpack.com/testimonials/)
  + [Security Library](https://jetpack.com/features/security/library)
  + [Contact Us](https://jetpack.com/contact-support/)
  + [Press](https://jetpack.com/newsroom/)
* Social
  + [![X (formerly known as Twitter)](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-x.svg)](https://twitter.com/jetpack)
  + [![Facebook](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-facebook.svg)](https://www.facebook.com/jetpackme/)
  + [![LinkedIn](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-linkedin.svg)](https://www.linkedin.com/company/jetpack-for-wordpress/)
  + [![Youtube](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/icons/icon-youtube.svg)](https://www.youtube.com/JetpackOfficial)
* Mobile Apps
  + [![Get Jetpack on Google Play](https://s1.wp.com/wp-content/lib/app-badge-buttons/android/en.png?version=20220321)](https://play.google.com/store/apps/details?id=com.jetpack.android&referrer=utm_source%3Djetpack.com%26utm_campaign%3Djp_site_shortcode%26utm_medium%3Dwebsite)
  + [![Download Jetpack on the App Store](https://s1.wp.com/wp-content/lib/app-badge-buttons/ios/en.png?version=20220321)](https://apps.apple.com/app/apple-store/id1565481562?ct=jetpack.com--jp_site_shortcode&mt=8&pt=299112)

* [An ![Automattic](https://s2.wp.com/wp-content/themes/a8c/jetpackme-new/images/logos/logo-a8c-white.svg)](https://automattic.com/?utm_medium=automattic_referred&utm_source=jpcom_footer)
* [Work With Us](https://automattic.com/work-with-us/?utm_medium=automattic_referred&utm_source=jpcom_footer)

* Reblog
* Subscribe
  Subscribed

  + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)

  Join 60,957 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsevere-vulnerabilities-fixed-in-all-in-one-seo-plugin-version-4-1-5-3%252F)
* Privacy
* + [![](https://jetpack.com/wp-content/uploads/2022/06/cropped-jp-favicon-new-3.png?w=50)](http://jetpack.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fjetpack.com%252Fblog%252Fsevere-vulnerabilities-fixed-in-all-in-one-seo-plugin-version-4-1-5-3%252F)
  + [Copy shortlink](https://wp.me/p1moTy-Ard)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://jetpack.com/blog/severe-vulnerabilities-fixed-in-all-in-one-seo-plugin-version-4-1-5-3/)
  + [View post in Reader](https://wordpress.com/read/blogs/20115252/posts/140071)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from plugins.trac.wordpress.org_632386ec_20250114_230053.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2640944%2Fall-in-one-seo-pack%2Ftrunk%2Fapp%2FCommon%2FApi%2FApi.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2626843/all-in-one-seo-pack/trunk/app/Common/Api/Api.php "Changeset 2626843 for all-in-one-seo-pack/trunk/app/Common/Api/Api.php")
* [Next Change](/changeset/2655963/all-in-one-seo-pack/trunk/app/Common/Api/Api.php "Changeset 2655963 for all-in-one-seo-pack/trunk/app/Common/Api/Api.php") →

---

# Changeset [2640944](/changeset/2640944 "Show full changeset") for [all-in-one-seo-pack/trunk/app/Common/Api/Api.php](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2640944 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/07/2021 09:21:37 PM
([3 years](/timeline?from=2021-12-07T21%3A21%3A37Z&precision=second "See timeline at 12/07/2021 09:21:37 PM") ago)

Author:
benjaminprojas
Message:

4.1.5.3

File:

1 edited

* [all-in-one-seo-pack/trunk/app/Common/Api/Api.php](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2640944 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [all-in-one-seo-pack/trunk/app/Common/Api/Api.php](/changeset/2640944/all-in-one-seo-pack/trunk/app/Common/Api/Api.php "Show the changeset 2640944 restricted to all-in-one-seo-pack/trunk/app/Common/Api/Api.php")

  | [r2626843](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2626843#L226 "Show revision 2626843 of this file in browser") | [r2640944](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2640944#L226 "Show revision 2640944 of this file in browser") |  |
  | --- | --- | --- |
  | 226 | 226 | \*/ |
  | 227 | 227 | public function validateAccess( $request ) { |
  | 228 |  | $route     = str\_replace( '/' . $this->namespace . '/', '', $request->get\_route() ); |
  |  | 228 | // NOTE: Since WordPress uses case-insensitive patterns to match routes, |
  |  | 229 | // we are forcing everything to lowercase to ensure we have the proper route. |
  |  | 230 | // This prevents users with lower privileges from accessing routes they shouldn't. |
  |  | 231 | $route     = aioseo()->helpers->toLowercase( $request->get\_route() ); |
  |  | 232 | $route     = str\_replace( '/' . $this->namespace . '/', '', $route ); |
  | 229 | 233 | $routeData = isset( $this->getRoutes()[ $request->get\_method() ][ $route ] ) ? $this->getRoutes()[ $request->get\_method() ][ $route ] : []; |
  | 230 | 234 |  |
  | […](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2626843#L240) | […](/browser/all-in-one-seo-pack/trunk/app/Common/Api/Api.php?rev=2640944#L244) |  |
  | 240 | 244 | } |
  | 241 | 245 |  |
  |  | 246 | // If we still have no route data, return false. |
  |  | 247 | if ( empty( $routeData ) ) { |
  |  | 248 | return false; |
  |  | 249 | } |
  |  | 250 |  |
  |  | 251 | // If only the access parameter is missing from the array, we aren't checking any additional permissions. |
  | 242 | 252 | if ( empty( $routeData['access'] ) ) { |
  | 243 | 253 | return true; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2640944)
* [Zip Archive](?format=zip&new=2640944)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


