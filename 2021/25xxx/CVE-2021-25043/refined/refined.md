Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2021-25043

**Root Cause of Vulnerability:** The vulnerability stems from the lack of sanitization and escaping of the `custom_prices` parameter within the WooCommerce Currency Switcher plugin before it is output back into the response.

**Weaknesses/Vulnerabilities Present:**
*   **Reflected Cross-Site Scripting (XSS):** The primary vulnerability is a reflected XSS. This occurs because user-supplied input (`custom_prices` parameter) is echoed back without proper sanitization, allowing an attacker to inject malicious scripts that execute in the victim's browser.

**Impact of Exploitation:**
*   **Malicious Script Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a user's browser session. This could lead to various malicious activities:
    *   **Session Hijacking:** Stealing session cookies to gain unauthorized access to the user's account.
    *   **Data Theft:** Extracting sensitive information displayed on the page.
    *   **Redirections:** Redirecting users to malicious websites.
    *   **Defacement:** Modifying the content of the web page.
    *   **Phishing:** Displaying fake login forms to capture user credentials.

**Attack Vectors:**
*   **Malicious URL:** The primary attack vector is crafted malicious URLs. An attacker crafts a URL containing the malicious JavaScript in the `custom_prices` parameter.
*   **Social Engineering:** The attacker then tricks users into clicking the malicious link, often using social engineering techniques like phishing emails, malicious ads, or compromised websites.

**Required Attacker Capabilities/Position:**
*   **External Attacker:** The attacker does not need any special privileges or access to the web application. The attack can be carried out remotely by an external entity.
*   **Social Engineering Ability:** The attacker needs to be able to convince the target to click a malicious link.
*   **Network Access:** The attacker needs network access to deliver the malicious URL.

**Technical Details:**
*   The vulnerable code is in the `classes/woocs.php` file.
*   The vulnerability exists in how the plugin handles the `$_REQUEST['custom_prices']` parameter within the `classes/woocs.php` file, specifically around line 4052 where the variable is used without proper sanitization before being used in a response.
*   The fix involves using `wc_clean()` on the `$_REQUEST['custom_prices']` parameter before use.

**Proof of Concept:**

The following URL demonstrates the vulnerability:
`https://example.com/wp-admin/admin-ajax.php?action=woocs_get_custom_price_html&custom_prices[]=%3Cimg%20src%20onerror=alert(`XSS`)%3E`

This URL, when accessed, will trigger a JavaScript alert box with the text "XSS", demonstrating the injection of malicious code.

**Additional Details:**
*   The vulnerability was fixed in version 1.3.7.3 of the plugin.
*   The changes made in the mentioned commit also include some CSS updates and version number changes.
*   The CVE was publicly published on 2021-12-13
*   The original researcher is Krzysztof ZajÄ…c

In summary, this is a Reflected XSS vulnerability in the WooCommerce Currency Switcher plugin due to improper handling of the `custom_prices` parameter, allowing for arbitrary JavaScript execution in a user's browser.