- **Root cause:** Insufficient input filtering in the background image file upload functionality of the FTAPI file exchange web application. The application does not properly sanitize or validate uploaded SVG files.
- **Weaknesses/vulnerabilities:** Stored Cross-Site Scripting (XSS). The vulnerability lies in the lack of sanitization on uploaded SVG files, allowing for the injection of malicious JavaScript code within them.
- **Impact of exploitation:** An attacker can compromise the session of a victim by tricking them into visiting the uploaded malicious SVG file. This can potentially allow an attacker to perform actions on behalf of the victim user, steal sensitive information (e.g., cookies, session tokens), or perform other malicious activities.
- **Attack vectors:**
    1. An attacker with administrative privileges uploads a malicious SVG file containing embedded JavaScript via the background image upload feature of the submit box layout editor.
    2. The application saves the uploaded SVG in the public "/api/2/staticfile/" directory.
    3. A victim user visits the URL of the malicious file, which then executes the attacker's injected JavaScript code in the victim's browser.
- **Required attacker capabilities/position:** An attacker needs to have administrative privileges to access the submit box layout editor and upload the malicious SVG file. They also need the victim to visit the crafted URL to trigger the XSS.