=== Content from github.com_df4d34a2_20250114_201512.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcosmos%2Fethermint%2Fpull%2F692)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcosmos%2Fethermint%2Fpull%2F692)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=cosmos%2Fethermint)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 30, 2021. It is now read-only.

[cosmos](/cosmos)
/
**[ethermint](/cosmos/ethermint)**
Public archive

* [Notifications](/login?return_to=%2Fcosmos%2Fethermint) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcosmos%2Fethermint)
* [Star
   415](/login?return_to=%2Fcosmos%2Fethermint)

* [Code](/cosmos/ethermint)
* [Issues
  52](/cosmos/ethermint/issues)
* [Pull requests
  7](/cosmos/ethermint/pulls)
* [Discussions](/cosmos/ethermint/discussions)
* [Actions](/cosmos/ethermint/actions)
* [Projects
  0](/cosmos/ethermint/projects)
* [Security](/cosmos/ethermint/security)
* [Insights](/cosmos/ethermint/pulse)

Additional navigation options

* [Code](/cosmos/ethermint)
* [Issues](/cosmos/ethermint/issues)
* [Pull requests](/cosmos/ethermint/pulls)
* [Discussions](/cosmos/ethermint/discussions)
* [Actions](/cosmos/ethermint/actions)
* [Projects](/cosmos/ethermint/projects)
* [Security](/cosmos/ethermint/security)
* [Insights](/cosmos/ethermint/pulse)

# Fix nonce issue for replay attack #692

 Merged

[fedekunze](/fedekunze)
merged 4 commits into
[development](/cosmos/ethermint/tree/development "cosmos/ethermint:development")
from
[araska/nonce](/cosmos/ethermint/tree/araska/nonce "cosmos/ethermint:araska/nonce")

Jan 9, 2021

 Merged

# [Fix nonce issue for replay attack](#top) #692

[fedekunze](/fedekunze)
merged 4 commits into
[development](/cosmos/ethermint/tree/development "cosmos/ethermint:development")
from
[araska/nonce](/cosmos/ethermint/tree/araska/nonce "cosmos/ethermint:araska/nonce")

Jan 9, 2021

[Conversation
6](/cosmos/ethermint/pull/692)
[Commits
4](/cosmos/ethermint/pull/692/commits)
[Checks
0](/cosmos/ethermint/pull/692/checks)
[Files changed](/cosmos/ethermint/pull/692/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![araskachoi](https://avatars.githubusercontent.com/u/13338103?s=60&v=4)](/araskachoi)

Copy link

Contributor

### @araskachoi **[araskachoi](/araskachoi)** commented [Jan 8, 2021](#issue-781744512) • edited Loading

Closes: **[#687](https://github.com/cosmos/ethermint/issues/687)** [#686](https://github.com/cosmos/ethermint/issues/686)

## Description

Checks the nonce and requires the nonce to be the same as the account sequence.

before, the sequence needed to be greater than that of the nonce.

this fix will also throw an error when using an invalid nonce.

before, eth\_sendTransaction would return a tx receipt even if the tx was rejected on the chain.

---

For contributor use:

* Targeted PR against correct branch (see [CONTRIBUTING.md](https://github.com/cosmos/cosmos-sdk/blob/master/CONTRIBUTING.md#pr-targeting))
* Linked to Github issue with discussion and accepted design OR link to spec that describes this work.
* Code follows the [module structure standards](https://github.com/cosmos/cosmos-sdk/blob/master/docs/building-modules/structure.md).
* Wrote unit and integration [tests](https://github.com/cosmos/cosmos-sdk/blob/master/CONTRIBUTING.md#testing)
* Updated relevant documentation (`docs/`) or specification (`x/<module>/spec/`)
* Added relevant `godoc` [comments](https://blog.golang.org/godoc-documenting-go-code).
* Added a relevant changelog entry to the `Unreleased` section in `CHANGELOG.md`
* Re-reviewed `Files changed` in the Github PR explorer

---

For admin use:

* Added appropriate labels to PR (ex. `WIP`, `R4R`, `docs`, etc)
* Reviewers assigned
* Squashed all commits, uses message "Merge pull request #XYZ: [title]" ([coding standards](https://github.com/tendermint/coding/blob/master/README.md#merging-a-pr))

Sorry, something went wrong.

All reactions

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=40&v=4)](/araskachoi)

`[fix nonce issue for replay attack](/cosmos/ethermint/pull/692/commits/384270170eaa2dceec252163cfe1cb1ce057e1d0 "fix nonce issue for replay attack")`

`[3842701](/cosmos/ethermint/pull/692/commits/384270170eaa2dceec252163cfe1cb1ce057e1d0)`

 [![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=40&u=3db6138fc1a2cebc7e84f161ab523a121fd5015a&v=4)](/araskachoi)
[araskachoi](/araskachoi)
requested review from
[fedekunze](/fedekunze) and
[noot](/noot)
as [code owners](/cosmos/ethermint/blob/ed313c9482e22e2deebc381936259337cde612a8/.github/CODEOWNERS#L4)
[January 8, 2021 00:27](#event-4182311434)

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=40&v=4)](/araskachoi)

`[fix lint](/cosmos/ethermint/pull/692/commits/e39d1ff7d8656670fbde29932a9918703e221fd4 "fix lint")`

`[e39d1ff](/cosmos/ethermint/pull/692/commits/e39d1ff7d8656670fbde29932a9918703e221fd4)`

[![summerpro](https://avatars.githubusercontent.com/u/24319156?s=60&v=4)](/summerpro)

**[summerpro](/summerpro)**
approved these changes
[Jan 8, 2021](#pullrequestreview-563951963)

 [View reviewed changes](/cosmos/ethermint/pull/692/files/e39d1ff7d8656670fbde29932a9918703e221fd4)

[![fedekunze](https://avatars.githubusercontent.com/u/31522760?s=60&v=4)](/fedekunze)

**[fedekunze](/fedekunze)**
approved these changes
[Jan 8, 2021](#pullrequestreview-564224310)

 [View reviewed changes](/cosmos/ethermint/pull/692/files/e39d1ff7d8656670fbde29932a9918703e221fd4)

Copy link

Contributor

### @fedekunze **[fedekunze](/fedekunze)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ACK. Can you add a bug fix changelog entry under the Unreleased section?

Sorry, something went wrong.

All reactions

[rpc/namespaces/eth/api.go](/cosmos/ethermint/pull/692/files/e39d1ff7d8656670fbde29932a9918703e221fd4#diff-7859df159f76b705c02dfbf23bb6d3a9865059e68e5ecad5cfd95a4fa4f23b48)

Comment on lines
+1008
 to
+1012

|  |  | if args.Nonce != nil { |
| --- | --- | --- |
|  |  | if nonce != (uint64)(\*args.Nonce) { |
|  |  | return nil, fmt.Errorf(fmt.Sprintf("invalid nonce; got %d, expected %d", (uint64)(\*args.Nonce), nonce)) |
|  |  | } |
|  |  | } |

Copy link

Contributor

### @fedekunze **[fedekunze](/fedekunze)** [Jan 8, 2021](#discussion_r553916817)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

nice, thanks for adding this client side validation!

Sorry, something went wrong.

 😄
2
 araskachoi and summerpro reacted with laugh emoji

All reactions

* 😄
  2 reactions

 [araskachoi](/araskachoi)
and others
added 2 commits
[January 8, 2021 10:13](#commits-pushed-dfbd572)

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=40&v=4)](/araskachoi)

`[Merge branch 'development' into araska/nonce](/cosmos/ethermint/pull/692/commits/dfbd572883675957fdd9d083e4d17fbf5e0f2943 "Merge branch 'development' into araska/nonce")`

`[dfbd572](/cosmos/ethermint/pull/692/commits/dfbd572883675957fdd9d083e4d17fbf5e0f2943)`

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=40&v=4)](/araskachoi)

`[add to changelog](/cosmos/ethermint/pull/692/commits/183c9bd8af0743eb4f52f44fdf1b8ecbbcbb83b0 "add to changelog")`

`[183c9bd](/cosmos/ethermint/pull/692/commits/183c9bd8af0743eb4f52f44fdf1b8ecbbcbb83b0)`

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=80&u=3db6138fc1a2cebc7e84f161ab523a121fd5015a&v=4)](/araskachoi)

Copy link

Contributor

Author

### **[araskachoi](/araskachoi)** commented [Jan 9, 2021](#issuecomment-757055573)

| ACK. Can you add a bug fix changelog entry under the Unreleased section?  [@fedekunze](https://github.com/fedekunze) can you check the changelog once more before merging? Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&u=fe9bf16a28f1e94ddf34fc1eb87a41c02141e52f&v=4)](/fedekunze)
[fedekunze](/fedekunze)
merged commit [`d7bdbd7`](/cosmos/ethermint/commit/d7bdbd7488644f0aaeee5cdcdc119c863f199f72)
into
development

[Jan 9, 2021](https://github.com/cosmos/ethermint/pull/692#event-4186605582)

 [![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&u=fe9bf16a28f1e94ddf34fc1eb87a41c02141e52f&v=4)](/fedekunze)
[fedekunze](/fedekunze)
deleted the
araska/nonce

branch
[January 9, 2021 01:44](#event-4186605600)

[![@summerpro](https://avatars.githubusercontent.com/u/24319156?s=80&u=9df7fcfeae7f35f47ed6cfd97e84edc3feced9ba&v=4)](/summerpro)

Copy link

Contributor

### **[summerpro](/summerpro)** commented [Jan 11, 2021](#issuecomment-757606719)

| [@araskachoi](https://github.com/araskachoi) this pr cannot close [#687](https://github.com/cosmos/ethermint/issues/687) , but can close [#686](https://github.com/cosmos/ethermint/issues/686) |
| --- |

 👍
1
 araskachoi reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=80&u=fe9bf16a28f1e94ddf34fc1eb87a41c02141e52f&v=4)](/fedekunze)

Copy link

Contributor

### **[fedekunze](/fedekunze)** commented [Jan 11, 2021](#issuecomment-757893404)

| [@araskachoi](https://github.com/araskachoi) this pr cannot close [#687](https://github.com/cosmos/ethermint/issues/687) , but can close [#686](https://github.com/cosmos/ethermint/issues/686)  [@summerpro](https://github.com/summerpro) is right |
| --- |

All reactions

Sorry, something went wrong.

[![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&u=fe9bf16a28f1e94ddf34fc1eb87a41c02141e52f&v=4)](/fedekunze)
[fedekunze](/fedekunze)
mentioned this pull request
[Jan 11, 2021](#ref-issue-779904555)

[Weak noncecheck lead to replay of transactions
#686](/cosmos/ethermint/issues/686)

Closed

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=80&u=3db6138fc1a2cebc7e84f161ab523a121fd5015a&v=4)](/araskachoi)

Copy link

Contributor

Author

### **[araskachoi](/araskachoi)** commented [Jan 11, 2021](#issuecomment-758106041)

| [@araskachoi](https://github.com/araskachoi) this pr cannot close [#687](https://github.com/cosmos/ethermint/issues/687) , but can close [#686](https://github.com/cosmos/ethermint/issues/686)  agreed, |
| --- |

All reactions

Sorry, something went wrong.

[![@summerpro](https://avatars.githubusercontent.com/u/24319156?s=40&u=9df7fcfeae7f35f47ed6cfd97e84edc3feced9ba&v=4)](/summerpro)
[summerpro](/summerpro)
mentioned this pull request
[Jan 17, 2021](#ref-issue-780071551)

[evm tx nonce bug
okx/exchain#538](/okx/exchain/issues/538)

Closed

[![@zhongqiuwood](https://avatars.githubusercontent.com/u/36867992?s=40&v=4)](/zhongqiuwood)
[zhongqiuwood](/zhongqiuwood)
mentioned this pull request
[Jan 20, 2021](#ref-issue-784733511)

[Contributions from OKEX organization
#707](/cosmos/ethermint/issues/707)

Closed

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcosmos%2Fethermint%2Fpull%2F692).

Reviewers

[![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=40&v=4)](/fedekunze) [fedekunze](/fedekunze)

fedekunze approved these changes

[![@summerpro](https://avatars.githubusercontent.com/u/24319156?s=40&v=4)](/summerpro) [summerpro](/summerpro)

summerpro approved these changes

[![@noot](https://avatars.githubusercontent.com/u/36753753?s=40&v=4)](/noot) [noot](/noot)

 Awaiting requested review from noot

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@araskachoi](https://avatars.githubusercontent.com/u/13338103?s=52&v=4)](/araskachoi) [![@summerpro](https://avatars.githubusercontent.com/u/24319156?s=52&v=4)](/summerpro) [![@fedekunze](https://avatars.githubusercontent.com/u/31522760?s=52&v=4)](/fedekunze)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_08aca368_20250114_201508.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcosmos%2Fethermint%2Fissues%2F687)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcosmos%2Fethermint%2Fissues%2F687)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cosmos%2Fethermint)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 30, 2021. It is now read-only.

[cosmos](/cosmos)
/
**[ethermint](/cosmos/ethermint)**
Public archive

* [Notifications](/login?return_to=%2Fcosmos%2Fethermint) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcosmos%2Fethermint)
* [Star
   415](/login?return_to=%2Fcosmos%2Fethermint)

* [Code](/cosmos/ethermint)
* [Issues
  52](/cosmos/ethermint/issues)
* [Pull requests
  7](/cosmos/ethermint/pulls)
* [Discussions](/cosmos/ethermint/discussions)
* [Actions](/cosmos/ethermint/actions)
* [Projects
  0](/cosmos/ethermint/projects)
* [Security](/cosmos/ethermint/security)
* [Insights](/cosmos/ethermint/pulse)

Additional navigation options

* [Code](/cosmos/ethermint)
* [Issues](/cosmos/ethermint/issues)
* [Pull requests](/cosmos/ethermint/pulls)
* [Discussions](/cosmos/ethermint/discussions)
* [Actions](/cosmos/ethermint/actions)
* [Projects](/cosmos/ethermint/projects)
* [Security](/cosmos/ethermint/security)
* [Insights](/cosmos/ethermint/pulse)

This repository has been archived by the owner on Nov 30, 2021. It is now read-only.

# Replay Tx on another Chain #687

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosed[okx/exchain#544](https://github.com/okx/exchain/pull/544)okx/exchain#544Closed[Replay Tx on another Chain](#top)#687[okx/exchain#544](https://github.com/okx/exchain/pull/544)Copy linkLabels[stalestale PRs that will be closed if no further action occurs](https://github.com/cosmos/ethermint/issues?q=state%3Aopen%20label%3A%22stale%22)stale PRs that will be closed if no further action occurs![@summerpro](https://avatars.githubusercontent.com/u/24319156?u=9df7fcfeae7f35f47ed6cfd97e84edc3feced9ba&v=4&size=80)
## Description

![@summerpro](https://avatars.githubusercontent.com/u/24319156?u=9df7fcfeae7f35f47ed6cfd97e84edc3feced9ba&v=4&size=48)[summerpro](https://github.com/summerpro)opened [on Jan 6, 2021](https://github.com/cosmos/ethermint/issues/687#issue-779923860)
## Vulnerability Overview:

Since ethermint uses the same type of chainIDEpoch for ethereum compatibility, a verified signature in ethereum is still valid in ethermint with the same msg content and chainIDEpoch, which enables "cross-chain transaction replay" attack etc.

## Details and Root Cause:

First, we found some ground truths:

1. Both ethermint and ethereum have the same signature scheme.
2. User has the same public key and private key on ethermint and ethereum.
3. Different chainID can be parsed to a same chainIDEpoch such as "ethereum-1" and "erhermint-1"

Thus, if a msg successfully executed on ethereum of some chainIDEpoch, say 1 (mainnet), then it can be replaied on ethermint of the same chainIDEpoch (with the nonce check passed), and vice versa.

## Steps to Exploit:

1. Suppose that there are two chains. One's chainID is "Ethereum-1",the other is "Ethermint-1".The victim have accounts on both chains with the same public key (private key).
2. The victim transfer 10eth to the attacker,and the victim's MsgEthereumTx.data.nonce on "Ethereum-1" is 300. The victim's MsgEthereumTx.data.nonce on "Ethermint-1" is 300（or less than 300）.For the previously mentioned vulnerability can greatly reduce the difficulty of exploiting this vulnerability only need to meet the nonce of the replayed chain than the nonce of the replayed chain can be low.
3. The attacker replay the MsgEthereumTx on "Ethermint-1".
## Metadata

### Assignees

No one assigned

### Labels

[stalestale PRs that will be closed if no further action occurs](https://github.com/cosmos/ethermint/issues?q=state%3Aopen%20label%3A%22stale%22)stale PRs that will be closed if no further action occurs
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


