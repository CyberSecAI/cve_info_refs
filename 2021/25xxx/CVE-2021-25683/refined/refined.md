The content relates to CVE-2021-25683.

**Root cause of vulnerability:**
The vulnerability stems from the way Apport extracts the start time of a process by parsing the `/proc/pid/stat` file. Specifically, Apport extracts the start time from the 22nd column of this file.

**Weaknesses/vulnerabilities present:**
- **Incorrect parsing of /proc/pid/stat:** The vulnerability lies in the fact that the start time is extracted based on the column number rather than parsing the fields correctly. This allows an attacker to control the returned start time by manipulating the process filename. If the filename of the process contains a space, the parsing logic shifts, and the start time becomes a smaller value which allows a bypass of the check.

**Impact of exploitation:**
- **Bypass of get_process_starttime check:** An attacker can manipulate the start time returned by `get_process_starttime()` to be smaller than `apport_start`, bypassing the intended check that verifies if the process was replaced after the crash.
- **Privilege escalation:** By bypassing this check, an attacker can chain this vulnerability with others to perform a local privilege escalation to root. The attacker can write a core file with arbitrary content owned by root in a directory of their choosing, which can lead to arbitrary code execution.

**Attack vectors:**
- **Local access:** The attack requires local access to the system.
- **Process manipulation:** The attacker needs to create a process with a crafted name to manipulate `/proc/pid/stat` file content.

**Required attacker capabilities/position:**
- An unprivileged user must be able to execute programs and create files on the system.
- The attacker needs to create a process with specific name, to control the start time value read by apport from /proc/pid/stat
- Ability to crash a process to trigger the apport functionality and generate a core dump.
- Ability to manipulate the environment, specifically to control the directory where the core dump file is generated.