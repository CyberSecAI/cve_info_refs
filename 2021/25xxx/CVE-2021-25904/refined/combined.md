=== Content from rustsec.org_9c6e39f7_20250115_081602.html ===


RUSTSEC-2021-0007: av-data: `Frame::copy\_from\_raw\_parts` can lead to segfault without `unsafe` › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/av-data/RUSTSEC-2021-0007.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/av-data/RUSTSEC-2021-0007.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0007)

# RUSTSEC-2021-0007

`Frame::copy_from_raw_parts` can lead to segfault without `unsafe`

Reported
January 7, 2021

Issued
January 19, 2021

(last modified: June 13, 2023)

Package
[av-data](/packages/av-data.html)
([crates.io](https://crates.io/crates/av-data))

Type
Vulnerability

Categories

* [memory-exposure](/categories/memory-exposure.html)
* [privilege-escalation](/categories/privilege-escalation.html)

Aliases

* [CVE-2021-25904](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25904)
* [GHSA-352p-rhvq-7g78](https://github.com/advisories/GHSA-352p-rhvq-7g78)

References

* <https://github.com/rust-av/rust-av/issues/136>

CVSS Score
7.5
HIGH

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionNone
ScopeUnchanged
ConfidentialityNone
IntegrityNone
AvailabilityHigh

CVSS Vector
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)
Patched

* `>=0.3.0`

### Description

`fn Frame::copy_from_raw_parts()` is a safe API that can take a
raw pointer and dereference it. It is possible to read arbitrary memory address
with an arbitrarily fed pointer. This allows the safe API to access & read
arbitrary address in memory. Feeding an invalid memory address pointer to
the API may also cause the program to segfault.

The flaw was corrected in https://github.com/rust-av/rust-av/pull/137,
by removing the API `fn Frame::copy_from_raw_parts()`.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


