=== Content from build.opensuse.org_370bc5fd_20250115_140241.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 886970

This request supersedes:
[request 886905](/request/show/886905)
([Show diff](/request/show/886970?diff_to_superseded=886905))

##### Overview

### Request 886970 revoked

- remove a bit of clutter from spec file:

 \* defattr/BuildRoot are obsolete at least since SLE12 if not longer

* Created by
  [dirkmueller](/users/dirkmueller)
  over 3 years ago
* In state
  [revoked](/request/show/886970#request-history)
* Supersedes
  [886905](/request/show/886905)

* [Submit cups](#Submit_cups2177423)

Loading...

* [Comments for request 886970
  2](#comments)
* [Comments for request 886905
  3](#superseded-886905 "This request was superseded by request 886970")

---

![Staging Bot's avatar](https://www.gravatar.com/avatar/d41b2f36932f8e2d3648816d60497bb9?s=35&d=robohash "Staging Bot")

[Staging Bot (staging-bot)](/users/staging-bot)
-
[over 3 years ago](#comment-1457355 "2021-05-16 13:00 UTC")

<!-- devel-project -->

[@WernerFink](https://build.opensuse.org/users/WernerFink), [@dmolkentin](https://build.opensuse.org/users/dmolkentin), [@jsmeix](https://build.opensuse.org/users/jsmeix), [@mwilck](https://build.opensuse.org/users/mwilck): review reminder

---

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=35&d=robohash "Johannes Meixner")

[Johannes Meixner (jsmeix)](/users/jsmeix)
-
[over 3 years ago](#comment-1460796 "2021-05-21 13:48 UTC")

target maintainer

Would be acceptable according to <https://bugzilla.suse.com/show_bug.cgi?id=1184161#c43> but unknown what the actual benefit is i.e. what gets better for the users or SUSE without explicit "defattr"?

---

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=35&d=robohash "Johannes Meixner")

[Johannes Meixner (jsmeix)](/users/jsmeix)
-
[over 3 years ago](#comment-1443437 "2021-04-20 08:48 UTC")

target maintainer

Please only the patch in one submitrequest. Then talk to me about removing my comments and other cleanup things. But most important: Branch from Printing/package\_name and verify backward compatibility, cf. [https://en.opensuse.org/openSUSE:How\_to\_contribute\_to\_the\_Printing\_project](https://en.opensuse.org/openSUSE%3AHow_to_contribute_to_the_Printing_project)

---

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=35&d=robohash "Johannes Meixner")

[Johannes Meixner (jsmeix)](/users/jsmeix)
-
[over 3 years ago](#comment-1443440 "2021-04-20 09:03 UTC")

target maintainer

Dirk MÃ¼ller, thank you for the patch. I will add it myself. No need for you to do further work here.

---

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=35&d=robohash "Johannes Meixner")

[Johannes Meixner (jsmeix)](/users/jsmeix)
-
[over 3 years ago](#comment-1443449 "2021-04-20 09:18 UTC")

target maintainer

Done via <https://build.opensuse.org/request/show/886931> which is
not yet forwarded to Factory right now. Things get automatically forwarded to Factory after some time by a robot so we have some time to see if issues appear for users who use CUPS from OBS Printing project.

##### Request History

![Dirk Mueller's avatar](https://www.gravatar.com/avatar/c13f6726c52ab070fa80fa59a08f5c7c?s=38&d=robohash "Dirk Mueller")

[dirkmueller](/users/dirkmueller)
created request
[over 3 years ago](#request-creation "2021-04-20 10:51 UTC")

- remove a bit of clutter from spec file:

 \* defattr/BuildRoot are obsolete at least since SLE12 if not longer

---

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=38&d=robohash "Johannes Meixner")

[jsmeix](/users/jsmeix)
declined request
[over 3 years ago](#status-history-9580062 "2021-05-21 13:49 UTC")

Currently broken sources.

---

![Dirk Mueller's avatar](https://www.gravatar.com/avatar/c13f6726c52ab070fa80fa59a08f5c7c?s=38&d=robohash "Dirk Mueller")

[dirkmueller](/users/dirkmueller)
revoked request
[about 3 years ago](#status-history-10135242 "2021-11-27 11:40 UTC")

The source package 'cups' has been removed

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from lists.fedoraproject.org_5c897d02_20250115_102111.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3.mbox.gz?message=GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/#GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3)

# [SECURITY] Fedora 32 Update: cups-2.3.3op2-5.fc32

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

14 May
2021

14 May
'21

1:51 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-be95e017e7
2021-05-14 17:50:57.981337
--------------------------------------------------------------------------------

Name : cups
Product : Fedora 32
Version : 2.3.3op2
Release : 5.fc32
URL : <http://www.cups.org/>
Summary : CUPS printing system
Description :
CUPS printing system provides a portable printing layer for
UNIXï¿½ï¿½ operating systems. It has been developed by Apple Inc.
to promote a standard printing solution for all UNIX vendors and users.
CUPS provides the System V and Berkeley command-line interfaces.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-25317
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Apr 30 2021 Zdenek Dohnal zdohnal@redhat.com - 1:2.3.3op2-5
- 1955090 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attack
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1949119 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attacks
<https://bugzilla.redhat.com/show_bug.cgi?id=1949119>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-be95e017e7' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3/#GWPGZLT3U776Q5YPPSA6LGFWWBDWBVH3)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from build.opensuse.org_8d5b5e4e_20250115_140232.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 889939

##### Overview

### Request 889939 accepted

Fixed CVE-2021-25317 (bsc#1184161) (forwarded request 889938 from jsmeix)

* Created by
  [jsmeix](/users/jsmeix)
  over 3 years ago
* In state
  [accepted](/request/show/889939#request-history)

* [Submit cups](#Submit_cups2186958)

Loading...

* [Comments for request 889939
  0](#comments)

*No comments available*

##### Request History

![Johannes Meixner's avatar](https://www.gravatar.com/avatar/482e50beb4afcf4b9d12ba556de1ea0e?s=38&d=robohash "Johannes Meixner")

[jsmeix](/users/jsmeix)
created request
[over 3 years ago](#request-creation "2021-05-03 08:35 UTC")

Fixed CVE-2021-25317 (bsc#1184161) (forwarded request 889938 from jsmeix)

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
added opensuse-review-team as a reviewer
[over 3 years ago](#status-history-9507210 "2021-05-03 08:35 UTC")

Please review sources

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[over 3 years ago](#status-history-9507213 "2021-05-03 08:35 UTC")

Check script succeeded

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
set openSUSE:Factory:Staging:A as a staging project
[over 3 years ago](#status-history-9507228 "2021-05-03 08:36 UTC")

Being evaluated by staging project "openSUSE:Factory:Staging:A"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9507231 "2021-05-03 08:37 UTC")

Picked "openSUSE:Factory:Staging:A"

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9507234 "2021-05-03 08:40 UTC")

ok

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=38&d=robohash "Dominique Leuenberger")

[dimstar](/users/dimstar)
accepted review
[over 3 years ago](#status-history-9507339 "2021-05-03 10:01 UTC")

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
added factory-staging as a reviewer
[over 3 years ago](#status-history-9508485 "2021-05-03 12:13 UTC")

Being evaluated by group "factory-staging"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9508488 "2021-05-03 12:13 UTC")

Unstaged from project "openSUSE:Factory:Staging:A"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
set openSUSE:Factory:Staging:D as a staging project
[over 3 years ago](#status-history-9508491 "2021-05-03 12:13 UTC")

Being evaluated by staging project "openSUSE:Factory:Staging:D"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9508494 "2021-05-03 12:13 UTC")

Picked "openSUSE:Factory:Staging:D"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9518853 "2021-05-05 18:39 UTC")

Staging Project openSUSE:Factory:Staging:D got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
approved review
[over 3 years ago](#status-history-9518856 "2021-05-05 18:39 UTC")

Staging Project openSUSE:Factory:Staging:D got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted request
[over 3 years ago](#status-history-9518859 "2021-05-05 18:39 UTC")

Staging Project openSUSE:Factory:Staging:D got accepted.

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from en.opensuse.org_1cf65361_20250115_140238.html ===


[![ðŸ¦Ž](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/SDB%3ACUPS_in_a_Nutshell "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/SDB%3ACUPS_in_a_Nutshell "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=SDB:CUPS_in_a_Nutshell&oldid=182803 "Permanent link to this revision of the page")[Page information](/index.php?title=SDB:CUPS_in_a_Nutshell&action=info "More information about this page")

* In other languages
  [Deutsch](http://de.opensuse.org/SDB%3ACUPS_in_aller_K%C3%BCrze "SDB:CUPS in aller KÃ¼rze â€“ Deutsch")[FranÃ§ais](http://fr.opensuse.org/SDB%3ACUPS_en_quelques_mots "SDB:CUPS en quelques mots â€“ franÃ§ais")[Italiano](http://it.opensuse.org/SDB%3ACUPS_in_breve "SDB:CUPS in breve â€“ italiano")

* Log in

* [SDB](/SDB%3ACUPS_in_a_Nutshell)
* [Discussion](/index.php?title=SDB_Talk:CUPS_in_a_Nutshell&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/SDB%3ACUPS_in_a_Nutshell)
[View source](/index.php?title=SDB:CUPS_in_a_Nutshell&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=SDB:CUPS_in_a_Nutshell&action=history "Past revisions of this page [h]")

# SDB:CUPS in a Nutshell

Jump to: [navigation](#mw-head),
[search](#p-search)

This article addresses experienced Linux users.

It does not provide detailed explanations. All important issues in connection with CUPS are presented in a concise form.

Some details here and there could be a bit outdated (depending on the CUPS version) but in general things are still valid.

This article describes CUPS up to version 2.x under Linux with the traditional filtering system and backends there.

The nowadays driverless printing workflow is rather different.

## Contents

* [1 Overview of the CUPS Printing System](#Overview_of_the_CUPS_Printing_System)
  + [1.1 Processing stages of a print job:](#Processing_stages_of_a_print_job:)
    - [1.1.1 (I) Generating a print job](#(I)_Generating_a_print_job)
    - [1.1.2 (II) Saving the print job in the spool directory](#(II)_Saving_the_print_job_in_the_spool_directory)
    - [1.1.3 (III) Filtering the print data and sending printer-specific data to the printer](#(III)_Filtering_the_print_data_and_sending_printer-specific_data_to_the_printer)
    - [1.1.4 (IV) Completing the print job](#(IV)_Completing_the_print_job)
* [2 The Spooler](#The_Spooler)
  + [2.1 Function of the spooler](#Function_of_the_spooler)
  + [2.2 Details:](#Details:)
    - [2.2.1 /usr/sbin/cupsd](#/usr/sbin/cupsd)
    - [2.2.2 /usr/lib/cups/daemon/cups-lpd](#/usr/lib/cups/daemon/cups-lpd)
* [3 PPD Files](#PPD_Files)
  + [3.1 What is a PPD file and how does it work?](#What_is_a_PPD_file_and_how_does_it_work?)
  + [3.2 Details:](#Details:_2)
    - [3.2.1 /etc/cups/ppd/](#/etc/cups/ppd/)
    - [3.2.2 /usr/share/cups/model/](#/usr/share/cups/model/)
    - [3.2.3 The OpenPrinting/LinuxPrinting.org printer database](#The_OpenPrinting/LinuxPrinting.org_printer_database)
* [4 The Filter (includes the Driver)](#The_Filter_(includes_the_Driver))
  + [4.1 What does the filter system do and how does it work?](#What_does_the_filter_system_do_and_how_does_it_work?)
  + [4.2 Details:](#Details:_3)
    - [4.2.1 /usr/lib/cups/filter/](#/usr/lib/cups/filter/)
    - [4.2.2 /etc/cups/interfaces/](#/etc/cups/interfaces/)
    - [4.2.3 "raw"](#"raw")
* [5 The Backends](#The_Backends)
  + [5.1 What is a CUPS backend and how does it work?](#What_is_a_CUPS_backend_and_how_does_it_work?)
  + [5.2 Details:](#Details:_4)
    - [5.2.1 /usr/lib/cups/backend/](#/usr/lib/cups/backend/)
* [6 Command-line Tools](#Command-line_Tools)
  + [6.1 General information on the command-line tools](#General_information_on_the_command-line_tools)
  + [6.2 Details:](#Details:_5)
    - [6.2.1 Command-line tools for creating or editing queues](#Command-line_tools_for_creating_or_editing_queues)
    - [6.2.2 Command-line tools for daily use](#Command-line_tools_for_daily_use)
* [7 cupsd Web Frontend](#cupsd_Web_Frontend)
  + [7.1 Details:](#Details:_6)
* [8 Configuring CUPS <= 1.5 in the Network](#Configuring_CUPS_<=_1.5_in_the_Network)
  + [8.1 CUPS >= 1.6 has major incompatible changes](#CUPS_>=_1.6_has_major_incompatible_changes)
  + [8.2 Intrinsic design of CUPS <= 1.5 for printing in the network](#Intrinsic_design_of_CUPS_<=_1.5_for_printing_in_the_network)
  + [8.3 Configuration of a CUPS <= 1.5 server](#Configuration_of_a_CUPS_<=_1.5_server)
  + [8.4 Details:](#Details:_7)
    - [8.4.1 Configuration of the print queues on a CUPS <= 1.5 server](#Configuration_of_the_print_queues_on_a_CUPS_<=_1.5_server)
    - [8.4.2 Get CUPS debug messages if it does not work](#Get_CUPS_debug_messages_if_it_does_not_work)
    - [8.4.3 Configuration of CUPS <= 1.5 clients](#Configuration_of_CUPS_<=_1.5_clients)
    - [8.4.4 Special cases for configuration of CUPS <= 1.5 clients](#Special_cases_for_configuration_of_CUPS_<=_1.5_clients)
    - [8.4.5 Regarding firewall](#Regarding_firewall)
    - [8.4.6 Allow printer admin tasks for a normal user](#Allow_printer_admin_tasks_for_a_normal_user)
* [9 See also](#See_also)
## Overview of the CUPS Printing System

[Concepts printing](/Concepts_printing "Concepts printing") explains the basics about printing.

For a general overview see the "Overview of CUPS" page at [the CUPS web interface](http://localhost:631) running on your local machine or see the documentation for your actually used CUPS version at [CUPS.org](http://www.cups.org)

CUPS home page: <http://www.cups.org/>

### Processing stages of a print job:

The following first step takes place both on client and on server systems. This is the only step on client systems. No queues exist on client systems. A single host with a locally connected printer works as a CUPS server with a print queue for that printer.

#### (I) Generating a print job

An application program or a command-line tool generates a print job and passes it to the spooler.

A print job consists of information for the spooler, the print data (see [PostScript](/SDB%3AGlossary/PostScript "SDB:Glossary/PostScript") and [Concepts printing](/Concepts_printing "Concepts printing")), and optional information for the filter.

Example for a command-line tool:

```
lp -d queue -t title -o option1=value1 -o option2=value2 file1 file2

```

* "queue" and "title" is information for the spooler.
* "option1=value1" and "option2=value2" is information for the filter.
* "file1" and "file2" are the print data.

The following subsequent steps only take place on a CUPS server. A host on which the following steps take place is a server. A host on which a print queue actually exists is a server (in contrast to clients where only references to the actual print queues exist).

The spooler (cupsd) does:

#### (II) Saving the print job in the spool directory

* Saving the information for the spooler and the filter in the control file /var/spool/cups/c<job-number>
* Saving the data from the files to print in the data file /var/spool/cups/d<job-number>-<file-number>

#### (III) Filtering the print data and sending printer-specific data to the printer

* Starting the filter system:
  + Determining which filters are needed for generating the printer-specific data and establishment of the so called "filter chain" or "filter pipe".
  + Starting the programs of the filter chain/pipe with suitable parameters.
* Starting the backend for sending the printer-specific data from the filter pipe to the printer.

#### (IV) Completing the print job

* Waiting until the backend is finished.
* Deleting the respective files from the spool directory.

## The Spooler

### Function of the spooler

The main purpose of the spooler system is to move data from the sender to the recipient.

1. Accepting data (only from authorized senders).
2. Buffering data (until the recipient is ready to accept them).
3. Sending data to authorized recipients (after implementing suitable filters, if necessary).
4. Providing information about the status of the data (e.g., for "lpstat -W completed -o").

### Details:

#### /usr/sbin/cupsd

* cupsd is the server for the [IPP protocol](/SDB%3AGlossary/IPP_protocol "SDB:Glossary/IPP protocol")
* cupsd listens on TCP port 631 for IPP tasks for example via commands like "lp -d queue\_name file\_name" or "lpstat -t"
* cupsd listens on TCP port 631 for [HTTP](/SDB%3AGlossary/HTTP_protocol "SDB:Glossary/HTTP protocol") tasks like managing printers via http://localhost:631/printers/
* cupsd uses UDP port 631 for sending and receiving "CUPS Browsing" information (see "Intrinsic design of CUPS for printing in the network" below). Use commands like "netcat -u -l -p 631" to pick up such information (provided UDP port 631 is not yet occupied by cupsd)
* Configuration file for cupsd: /etc/cups/cupsd.conf (since CUPS 1.6 also /etc/cups/cups-files.conf)
* systemd unit files /usr/lib/systemd/system/cups.\*

#### /usr/lib/cups/daemon/cups-lpd

* cups-lpd is the server for the LPD protocol (RFC 1179)
* cups-lpd accepts print jobs that come in on TCP port 515 via the LPD protocol
* Either xinetd or inetd or systemd is used as wrapper for cups-lpd
* Configuration files:
  + Either /etc/xinetd.d/cups-lpd
  + or the cups-lpd line in /etc/inetd.conf
  + or systemd /usr/lib/systemd/system/cups-lpd\* unit files

## PPD Files

### What is a PPD file and how does it work?

See "PPD files: Printer-specific options" at [Concepts printing](/Concepts_printing "Concepts printing").

For PostScript printers, the PPD file contains the printer-specific options (and nothing else) together with the corresponding PostScript code snippets that must be sent to the PostScript interpreter in order to activate a certain option.

For non-PostScript printers, the PPD file contains additionally information which printer driver program must be used and the options that are available for the particular driver. If several drivers can be used for a given printer, several PPD files are available.

Depending on the printer-specific options set for a certain print job (e.g., "-o PageSize=A4"), the filter system reads the suitable PostScript code snippets (the so called "PostScript invocation values") from the PPD file and inserts them in the PostScript data stream.

The syntax for an option entry in the PPD file with two example entries is as follows:

| \* Main keyword | Option keyword/translation string | " PostScript invocation value " |
| --- | --- | --- |
| \*PageSize | Letter/letter paper: | "<</PageSize[612 792]/ImagingBBox null>>setpagedevice" |
| \*PageSize | A4/A4 paper: | "<</PageSize[595 842]/ImagingBBox null>>setpagedevice" |

More information is available in the "Adobe PostScript Printer Description File Format Specification, Version 4.3".

### Details:

#### /etc/cups/ppd/

* This directory contains the PPD files that cupsd actually makes use of.
* The entries (especially the "\*Default..." entries) in a PPD file in /etc/cups/ppd/ can vary from the entries in the original PPD file that was specified when the queue was configured.

#### /usr/share/cups/model/

* This directory contains the original PPD files which are used to set up new print queues. See "openSUSE printer driver software packages" at [Concepts printing](/Concepts_printing "Concepts printing") which packages provide what kind of PPD files.
* Additional PPD files (e.g., PPD files from printer manufacturers) can be copied to this directory in order to make them available for the printer configuration tools.

#### The OpenPrinting/LinuxPrinting.org printer database

* The OpenPrinting/LinuxPrinting.org printer database consists of XML files from which the Foomatic PPD files are generated.
* The OpenPrinting/LinuxPrinting.org printer database is available at <https://wiki.linuxfoundation.org/openprinting/database/databaseintro>

## The Filter (includes the Driver)

In general "filter" means a program that converts input data into output data
and "driver" means device-model-specific software and data.

### What does the filter system do and how does it work?

The main purpose of the filter system is to convert the original data of the print job (ASCII, PostScript, PDF) into printer-specific data (PostScript, PCL, ESC/P) via several steps.

Usually the last step is a program which is the printer driver which outputs the final printer-specific data, see "Printer drivers: Make the printer print" at [Concepts printing](/Concepts_printing "Concepts printing").

Each step is done by a separated filtering program where the filtering programs are run one after the other as a traditional Unix pipe: The original print job data is the input of the first filtering program where its output is sent via the pipe as input to the second filtering program and so on until the output of last filtering program is sent via the pipe as input to the CUPS backend that finally sends the printer-specific data to the printer (see the subsequent section about "The Backends").

The actual filtering of a particular print job for a particular printer model on a particular Linux system depends on various conditions, see "Background Information" at [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

In particular the filtering is different for the traditional printing data format PostScript and for the recent printing data format PDF, see "Common printing data formats" at [Concepts printing](/Concepts_printing "Concepts printing").

Furthermore the actual filtering depends on which kind of printer driver is used.

The following is one particular example how the filtering works for the traditional printing data format PostScript when a printer driver is used that is included in Ghostscript (see [Concepts printing](/Concepts_printing "Concepts printing")). In this case the filtering takes place by means of the following steps:

**1) Converting the original data to PostScript.**

**1a) Determination of the MIME type of the original data:**

This happens according to /usr/share/cups/mime/mime.types or /etc/cups/mime.types.

**1b) Conversion to PostScript (if it is not yet PostScript):**

If the MIME type of the original data is not "application/postscript", then conversion to PostScript according to /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs.

In particular original data of MIME type "text/plain" is converted to PostScript with /usr/lib/cups/filter/texttops.

Since CUPS 1.3.4 only UTF-8 text is supported (which includes 7-bit ASCII text). Text in the ISO-8859 encodings is no longer supported. The reason is that it is not possible to autodetect the encoding so that CUPS cannot process "plain text" files in arbitrary encodings in a reliable way, see [SDB:Plain Text versus Locale](/SDB%3APlain_Text_versus_Locale "SDB:Plain Text versus Locale"). To print non-UTF-8 text, you must convert it from its encoding to UTF-8 before sending it to the CUPS server. To print an ISO-8859-1 text file, you may use:

```
iconv -f ISO-8859-1 -t UTF-8 filename | lp -d queue

```

See "iconv --help" for some information about iconv.

Printing of PDF or graphics files (JPEG, PNG, etc.) works as before.

**2) Inserting the PostScript invocation values in the PostScript data stream.**

This happens according to the following line in /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs:

| Input MIME type | Output MIME type | Costs | Filter |
| --- | --- | --- | --- |
| application/postscript | application/vnd.cups-postscript | 66 | pstops |

**3) Convert PostScript data to printer-specific data.**

If a non-PostScript printer is used with a Foomatic PPD file, the PostScript data are converted to printer-specific data according to the following line in every Foomatic (version 3.x) PPD file:

| Main keyword | Input MIME type | Costs | Filter |
| --- | --- | --- | --- |
| \*cupsFilter: | "application/vnd.cups-postscript |  | foomatic-rip" |

If a non-PostScript printer is used with a Foomatic PPD file, then foomatic-rip together with Ghostscript serve as the PostScript interpreter.

foomatic-rip proceeds as follows to convert the PostScript data to printer-specific data:

**3a) Build a Ghostscript command:**

foomatic-rip builds a Ghostscript command with the needed Ghostscript printer driver and additional parameters according to the printer-specific options set for the respective print job.

In some cases, a postfilter is introduced after the Ghostscript command (via pipe). For example for some PCL printers certain options are realized by means of changes in the PCL data stream (e.g., paper tray selection via "perl -e").

**3b) Run the Ghostscript command (or pipe):**

foomatic-rip executes the Ghostscript command.

If a non-Foomatic PPD file (e.g., a Gutenprint/Gimp-Print PPD file from /usr/share/cups/model/gutenprint or /usr/share/cups/model/stp) is used for a non-PostScript printer, the "\*cupsFilter" entries in the PPD file may look as follows:

```
*cupsFilter: "application/vnd.cups-raster 100 rastertogutenprint"

```

or

```
*cupsFilter: "application/vnd.cups-raster 100 rastertoprinter"

```

With the matching entries in /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs the result is a different filtering procedure.
In this particular case /usr/lib/cups/filter/rastertogutenprint or /usr/lib/cups/filter/rastertoprinter is the printer driver program.

For more general information on filters see the man page "man 7 filter". More specific information on filtering is available in the Support Database article [SDB:Using Your Own Filters to Print with CUPS](/SDB%3AUsing_Your_Own_Filters_to_Print_with_CUPS "SDB:Using Your Own Filters to Print with CUPS").

### Details:

#### /usr/lib/cups/filter/

This directory contains the various filter programs used by the CUPS filter system if a PPD file was specified when the respective queue was configured.

* /usr/lib/cups/filter/\*tops (e.g., /usr/lib/cups/filter/texttops) for converting the original data (e.g., "text/plain") to PostScript.
* /usr/lib/cups/filter/pstops for inserting the PostScript invocation values and, if necessary, for reformatting the PostScript data (e.g., to downsize and print two pages on one sheet).
* /usr/lib/cups/filter/foomatic-rip for converting PostScript data to printer-specific data (e.g., PCL or ESC/P).

#### /etc/cups/interfaces/

Backward incompatible change since CUPS 2.2.0: There is no longer the directory /etc/cups/interfaces because since CUPS 2.2.0 so called "System V style Interface Scripts" are no longer supported for security reasons (cf. the "CHANGES" files in CUPS).

Up to CUPS < 2.2.0 the /etc/cups/interfaces directory contains the filter used by CUPS if a "System V style Interface Script" was specified instead of a PPD file when the respective queue was configured.
A "System V style Interface Script" is a single filter program or filter script that produces the printer-specific data for all data formats in which the original print data may be sent.
More information about the "System V style Interface Script" is available in the Support Database article "Using Your Own Filters to Print with CUPS": [SDB:Using Your Own Filters to Print with CUPS](/SDB%3AUsing_Your_Own_Filters_to_Print_with_CUPS "SDB:Using Your Own Filters to Print with CUPS").

#### "raw"

If neither a PPD file nor a "System V style Interface Script" was specified when the respective queue was configured, no filtering will take place. The original print data will be sent directly from the backend to the recipient (normally the printer) as they are (in "raw" form). It is not possible to convert the line break (e.g., LF -> CR+LF) or append a form feed. Up to CUPS < 2.2.0 a "System V style Interface Script" can be used for this purpose.

## The Backends

### What is a CUPS backend and how does it work?

Normally, the backend receives the printer-specific data from the filter and forwards them to the printer or another recipient.

The differences between the backend and the filter are as follows:

* One backend but usually several filters (called "filter chain" or "filter pipe") are activated to process a print job. Exceptions: "System V style Interface Script" (one filter) and "raw" printing (no filter).
* In the processing chain/pipe, the backend is always the last program executed for processing a print job.

The print system considers the print job as completed when the backend is finished. The backend is finished when the transmission to the recipient is completed. If the further processing at the recipient fails (e.g., if the printer is not able to print the printer-specific data), this will go unnoticed by the print system.

If the data transmission to the recipient fails (usually after several attempts by the backend), the backend will report an error to the print system (more precisely, to cupsd). The backend decides if and how many attempts make sense before it reports that the data transmission has failed. As further attempts would be futile, cupsd disables printing on the affected queue. After eliminating the cause of the problem, the system administrator must reenable printing with /usr/bin/enable (for CUPS 1.1 - i.e. up to Suse Linux 10.1) or with cupsenable (since CUPS 1.2 - i.e. since openSUSE 10.2).

For more information on backends see the man pages "man 7 backend" for what is specific for backends and "man 7 filter" for general information regarding filters (backends are a special type of filter). More specific information on backends is available in the Support Database article [SDB:Using Your Own Backends to Print with CUPS](/SDB%3AUsing_Your_Own_Backends_to_Print_with_CUPS "SDB:Using Your Own Backends to Print with CUPS").

### Details:

#### /usr/lib/cups/backend/

This directory contains the various backends.

A suitable backend must be employed under consideration of how the printer can be accessed from the host running the CUPS system and the type of recipient.

The destination to which a backend can send the data can be any URI (Uniform Resource Identifier) for which a suitable backend is available. The first part of the "DeviceURI" entry in /etc/cups/printers.conf determines the backend, the other entries serve as parameters for the backend.

| Backend | URI syntax | Example URI |
| --- | --- | --- |
| parallel | parallel:/dev/lp\* | parallel:/dev/lp0 |
| usb (traditional) | usb:/dev/usb/lp\* | usb:/dev/usb/lp0 |
| usb (new) | usb://<make>/<model>?serial=<number> | usb://ACME/FunPrinter%201000?serial=A1B2C3 |
| ipp | ipp://<ipp-server.domain>/printers/<queue> | ipp://cups-server.domain/printers/funprinter1000 |
| lpd | lpd://<lpd-server.domain>/<queue> | lpd://192.168.101.202/lpt1 |
| socket | socket://<host.domain>:<port> | socket://192.168.101.202:9100 |
| smb | see the man page smbspool(8) | smb://user:password@workgroup/smb-server/share |

If "user" and "password" are needed for the smb backend, the owner, group, and access permissions for the file /etc/cups/printers.conf must be sufficiently restrictive. The specifications "user" and "password" are not displayed with the command "lpstat -v".

Every backend can also be addressed directly. For example, the "parallel" and "usb" backends return the IEEE-1284 identification of connected printers.

```
root@host# /usr/lib/cups/backend/parallel
direct parallel:/dev/lp0 "ACME FunPrinter 1000" "Parallel Port #1"

```
```
root@host# /usr/lib/cups/backend/usb
direct usb://ACME/USB%20Printer?serial=1234 "ACME USB Printer" "USB Printer #1"
direct usb:/dev/usb/lp1 "Unknown" "USB Printer #2"
...

```

For older CUPS versions upon start-up, cupsd successively executes all backends in /usr/lib/cups/backend/ in order to determine which of the backends are available on the respective system. Only the available backends can be used for the configuration of queues. The available backends are displayed with "lpinfo -v". For nowadays CUPS versions not the cupsd itself but the separated cups-deviced is run that also executes all backends in /usr/lib/cups/backend/ when a "lpinfo -v" command is run (and cups-driverd is run when a "lpinfo -m" command is run, see "man cups-deviced" and "man cups-driverd").

## Command-line Tools

### General information on the command-line tools

Do not edit configuration files in /etc/cups/ manually if suitable command-line tools are available for this purpose.

Exception: /etc/cups/cupsd.conf (and since CUPS 1.6 also /etc/cups/cups-files.conf)

After modifications in /etc/cups/cupsd.conf (and since CUPS 1.6 also in /etc/cups/cups-files.conf), cupsd must be restarted in order to make it use the modified configuration.

Do not change CUPS spool files (in /var/spool/cups/) manually. Use CUPS command-line tools.

Never ever change CUPS files manually while the cupsd is running.

In contrast CUPS command-line tools only submit a task what to do to the cupsd and then the cupsd can do it properly.

Reason:

CUPS files are neither re-read nor instantly updated in any case. Rather, cupsd keeps much information in memory and writes it back to the files at more or less arbitrary time (see the "DirtyCleanInterval" cupsd configuration directive).

For example, to clean up all print queues run "cancel -a" (or since CUPS 1.7 "cancel -a -x") which completely removes all existing (old) print jobs (including job history) in all print queues.

Never copy configuration files from other systems into your system unless you know exactly what you are doing. Use command-line tools instead.

For example, to set up the same queues on several machines (e.g., for a backup server), do not copy /etc/cups/printers.conf and /etc/cups/ppd/\*, but write the respective commands in a script (usually a sequence of lpadmin commands) and run the script on the various machines. In this way, any error messages will be displayed on the respective machines (e.g., if a PPD file is not available on a machine or if a backend is not available or not ready to use). Furthermore with such a script you have something like a backup plus log-file of your settings, enabling you to restore those settings by running the script at any time.

If you are not sure which graphical tool is best suited for certain special configurations or print queue maintenance actions, use command-line tools instead.

In many cases, the sequence of the options is significant. Read the man pages. For example, the following commands are all different:

```
  lpadmin -E -p queue,
  lpadmin -p queue -E
  lpadmin -E -p queue -E

```
### Details:

#### Command-line tools for creating or editing queues

**How to set up a print queue in full compliance with CUPS:**

1. Retrieve autodetected printers and their correct matching DeviceURIs from the cupsd: Run (as root) "lpinfo -l -v"
2. Retrieve available printer driver descriptions from the cupsd: Run (as root) "lpinfo -l -m"
3. Select a printer/DeviceURI from the first list and a printer driver from the second list and devise an appropriate queue name.
4. Set up the queue: Run (as root) "lpadmin -p queue\_name -v DeviceURI -m printer\_driver -E" or "lpadmin -p queue\_name -v DeviceURI -P /usr/share/cups/model/printer\_driver -E"

There is no re-start of the cupsd needed to add, modify, or delete print queues (only a config change of the cupsd itself requires it to be re-started).

Example for creating a usual queue with a PPD file:

```
root@host# lpadmin -h localhost -p funprinter1000 -v parallel:/dev/lp0 -P /usr/share/cups/model/Postscript.ppd.gz -E

```

Example for creating a local "raw" queue that only forwards print job data to a queue on a remote cups server (see the sections "raw" and "/usr/lib/cups/backend/" above):

```
root@host# lpadmin -h localhost -p funprinter1000forwarding -v ipp://cups-server.domain/printers/funprinter1000 -E

```

Use the following command to check what was created:

```
user@host$ lpstat -h localhost -a funprinter1000 -p funprinter1000 -v funprinter1000
funprinter1000 accepting requests since Jan 01 00:00
printer funprinter1000 is idle.  enabled since Jan 01 00:00
device for funprinter1000: parallel:/dev/lp0

```

Alternatively, take a look at /etc/cups/printers.conf:

```
<Printer funprinter1000>
Info funprinter1000
DeviceURI parallel:/dev/lp0
State Idle
Accepting Yes
JobSheets none none
QuotaPeriod 0
PageLimit 0
KLimit 0
</Printer>

```

Or query the system via the web frontend: http://localhost:631/printers/funprinter1000

Editing the queue (e.g., changing the description and location):

```
root@host# lpadmin -h localhost -p funprinter1000 -D "ACME FunPrinter 1000" -L "2. floor: room 3"

```

Displaying the printer-specific options and their default settings in /etc/cups/ppd/funprinter1000.ppd (provided the queue was set up with a PPD file):

```
user@host$ lpoptions -h localhost -p funprinter1000 -l
Resolution/Output Resolution: 150dpi *300dpi 600dpi 1200dpi 2400dpi
PageSize/Media Size: Letter Legal Executive *A4 A5
...

```

The output has the following syntax:

```
main-keyword/translation-string: option-keyword option-keyword option-keyword ...

```

The default setting is marked with an \* preceding the "option-keyword".

Changing the printer-specific default settings in /etc/cups/ppd/funprinter1000.ppd (provided the queue was set up with a PPD file):

```
root@host# lpadmin -h localhost -p funprinter1000 -o Resolution=600dpi -o PageSize=Letter

```

The syntax is as follows:

```
lpadmin -h localhost -p queue -o main-keyword1=option-keyword1 -o main-keyword2=option-keyword2 ...

```

Do not use lpoptions for this purpose. Refer to the Support Database article [Print Settings with CUPS](/SDB%3APrint_Settings_with_CUPS "SDB:Print Settings with CUPS"). Normal users can use lpoptions to save their personal default settings in ~/.cups/lpoptions (since CUPS 1.2 / openSUSE 10.2, it was ~/.lpoptions in CUPS 1.1). More information on this is presented in the same Support Database article.

Use "accept" and "reject" to accept and reject print jobs for a queue.

Use /usr/bin/enable ("enable" is a bash built-in) or /usr/sbin/cupsenable and "disable" or /usr/sbin/cupsdisable to enable and disable printing in a queue (e.g., to avoid print jobs from being lost while doing maintenance work on the printer).

Deleting the queue:

```
root@host# lpadmin -h localhost -x funprinter1000

```
#### Command-line tools for daily use

Avoid BSD-type commands (lpr, lpq, lprm), as these only support a limited number of generic options. Use System V-type commands (lp, lpstat, cancel) instead.

Use lpoptions to save personal printer-specific option settings in ~/.cups/lpoptions (since CUPS 1.2 / openSUSE 10.2, it was ~/.lpoptions in CUPS 1.1). Example:

```
user@host$ lpoptions -o Resolution=1200dpi -p funprinter1000

```

The generally available printing options are described on the "Command-Line Printing and Options" page in the
"Getting Started" section under "Documentation/Help" at [the CUPS web interface](http://localhost:631) running on your local machine or see the "Documentation" for your actually used CUPS version at [CUPS.org](http://www.cups.org)

## cupsd Web Frontend

Every cupsd in the network has an HTTP web frontend. The URL for the local running cupsd is <http://localhost:631> and the URL for a remote cupsd on "host.domain" is http://host.domain:631 provided that the remote cupsd which runs on the remote host permits the access.

### Details:

In daily operations, the web frontend is usually the best source of information about queues and print jobs. For example, <http://localhost:631/printers/> provides an overview of all queues of a local cupsd.

The web frontend is the best way to get documentation on the respective cupsd (cupsd version). For example, the documentation for the locally installed CUPS version is available at <http://localhost:631> and the documentation for CUPS installed on a remote server is is available at http://host.domain:631 provided that the remote server permit the access.

Even the PPD files in /etc/cups/ppd/ can be accessed by way of the web frontend. For example, the PPD file of the queue "funprinter1000" on the local host (/etc/cups/ppd/funprinter1000.ppd) can be accessed with the URL http://localhost:631/printers/funprinter1000.ppd and
accordingly the PPD file of "queue" on "host.domain" can be accessed with a URL in the form http://host.domain:631/printers/queue.ppd provided that the remote host permit the access.

## Configuring CUPS <= 1.5 in the Network

### CUPS >= 1.6 has major incompatible changes

After a version upgrade to CUPS >= 1.6 printing in the network would no longer work as it did up to CUPS 1.5.

For an overview about what is new since CUPS 1.6 see <https://www.cups.org/blog.html>

For details regarding incompatible changes since CUPS 1.6 see <https://bugzilla.opensuse.org/show_bug.cgi?id=735404> and follow the links therein.

Since Mac OS X version 10.8 "Mountain Lion" it uses CUPS 1.6 (but not OS X 10.7 "Lion" that has CUPS 1.5). It seems OS X 10.8 clients need a CUPS 1.6 server that supports how OS X 10.8 clients print by default via network. Therefore networks with newest Mac OS X 10.8 clients may require a CUPS 1.6 server.

Users who need backward compatibility would run CUPS up to 1.5 on one server and those who need the new features in CUPS >= 1.6 could additionally run CUPS >= 1.6 on another server.

In particular note that CUPS >= 1.6 usually requires the filters of the cups-filters software that is provided by OpenPrinting.org.

### Intrinsic design of CUPS <= 1.5 for printing in the network

CUPS network servers (hosts on which spooling and filtering is done):

* The cupsd of a CUPS network server sends information about its queues to a list of IP addresses (host addresses and/or broadcast addresses). The default setting is an empty list.
* The transmission is repeated after preset intervals. The default setting is 30 seconds.

Clients (hosts that only send print jobs to servers):

* By default, cupsd listens to information from servers. Therefore, a local cupsd should run on every client. There is a list of servers from which information is accepted. By default, information is accepted from all servers.
* The information about a specific queue is deleted on a client if no new information about the queue comes in within a set interval. The default setting is 300 seconds.

In this way, the queues of the server are available directly on the client. Users on the clients can browse the queues on various servers. Therefore the whole stuff is called "Browsing".

Browsing is activated by default. All incoming browsing information is accepted, but no browsing information is sent (see above).

### Configuration of a CUPS <= 1.5 server

1. Configure print queues for the printers associated with the server.
2. Allow the clients to access the queues.
3. Activate sending of browsing information to the clients.

Subnetworks should be used to facilitate the configuration. If subnets are used, it is sufficient to send the browsing information to a fixed broadcast address instead of continuously maintaining a list of individual host addresses.

The access to the queues of a server is handled independently, regardless to which hosts the server sends browsing information. A server can grant all clients in the network access to its queues, while sending browsing information to only some of the clients. However, a server should not send any browsing information to clients that do not have access to its queues.

In a large company, it is not possible to have only one large server that sends browsing information for some of the queues to the clients in one department or one building and browsing information for other queues to other clients.

Several servers (one for every department or building) are needed for this.

### Details:

#### Configuration of the print queues on a CUPS <= 1.5 server

The printers belonging to a server are the ones for which the filtering takes place on the server.

**I) Configure the printers so that printing works on the server.**

Set up print queues for the printers associated with the server.

Verify that printing works correctly when a normal user prints directly from the server. In case of problems inspect the CUPS debug messages on the server, see below.

**II) Allow the clients to access the queues.**

Either change /etc/cups/cupsd.conf manually or use YaST. Since openSUSE 11.1 use in YaST the "Share Printers" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

**First let the cupsd listen on the network:**

By default the cupsd since CUPS 1.2 (since openSUSE 10.2) listens only on internal ("localhost") network interfaces (and a Unix domain socket) in /etc/cups/cupsd.conf for CUPS 1.2 and later:

```
Listen localhost:631
Listen /var/run/cups/cups.sock

```

For a CUPS 1.2 (and later) network server you must change it to listen on the outer network too. Add an entry of the form "Listen IP.of.your.server".

If the CUPS server is accessible from any untrusted network, make sure that you use a firewall to protect your server.

**Then allow the clients to access the server:**

The default setting in /etc/cups/cupsd.conf is as follows:

```
<Location />
Order allow,deny
Allow 127.0.0.2
</Location>

```

Access from "localhost" 127.0.0.1 is allowed in any case without an explicite entry and 127.0.0.2 could be assignd to the hostname of the server so that access via the hostname of the server is also allowed.

To allow access from all hosts in the whole local network insert the line

```
Allow @LOCAL

```

This setting allows all LOCAL hosts to access cupsd. LOCAL hosts are those whose IP addresses are associated with non-PPP interfaces (more precisely, interfaces whose IFF\_POINTOPOINT flag is not set) and whose IP address belongs to the same network as the CUPS server. This means that usually the "Internet" network interface which is connected to an usual modem is excluded. But if it is connected to a cable modem it is not a point-to-point interface so that @LOCAL cannot be used in this case.

To allow access from specific hosts or networks insert lines like

```
Allow 192.168.100.1
Allow 192.168.200.0/255.255.255.0

```

We recommend the use of IP addresses instead of names.

Differences regarding older SUSE LINUX versions:

From SUSE LINUX 9.0 up to SUSE LINUX 10.1, the default setting in /etc/cups/cupsd.conf was:

```
BrowseAllow @LOCAL
.
.
.
<Location />
...
Allow @LOCAL
</Location>

```

This setting allowed all LOCAL hosts to access cupsd and furthermore packets from all other hosts have been rejected immediately.

Up to SUSE LINUX 10.1 we provided CUPS 1.1 and since openSUSE 10.2 we provide CUPS 1.2 which is not fully backward compatible with CUPS 1.1.

Therefore in case of an update it is recommended not to use an outdated cupsd.conf from a CUPS 1.1 installation before but to start from scratch with the original cupsd.conf from our CUPS 1.2 (or later) RPM.

For example RunAsUser is no longer supported so that since openSUSE 10.2 / CUPS 1.2 the cupsd runs as root and therefore we are back to its default "basic authentication" via system users and system passwords (in /etc/shadow) so that it works again to authenticate as "root" and use the usual root system password.

**III) Activate the sending of browsing information to the clients.**

In /etc/cups/cupsd.conf, set the entry "BrowseAddress @LOCAL" in order to send browsing information to all LOCAL hosts, or insert entries in the form "BrowseAddress client.host.IP.address" or "BrowseAddress network.broadcast.IP.address".

The sending of browsing information to the clients is somewhat optional:

* If it is omitted, the clients will not automatically receive information about the queues on the server.
* Nevertheless, due to the previous step the clients are able to address the queues of the server.

Especially in large networks it may make sense to grant access to all clients, but to send browsing information only to some of the clients (e.g., only to the clients located in the same department or building as the server).

**IV) Restart the cupsd.**

#### Get CUPS debug messages if it does not work

The CUPS log file /var/log/cups/error\_log contains log messages that could be useful for troubleshooting - but it does not contain debug messages by default.

To get CUPS debug messages, see the section "Usually provide CUPS debug messages" in [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

Provided you have CUPS debug messages but those messages do not help you to find the root cause why it does not work, you may ask for help as described in [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

#### Configuration of CUPS <= 1.5 clients

**Recommended:**

1. Activate /etc/init.d/cups so that cupsd is started when the client is booted.
2. Start cupsd.

From SUSE LINUX 9.1, this takes place by default. If necessary, this can be done with the YaST Runlevel Editor or with insserv. Under normal circumstances, you should not configure anything else, especially

* no local queues on clients and
* no changes in the default settings for cupsd on clients.

#### Special cases for configuration of CUPS <= 1.5 clients

**Optional:**

Insert entries in the form "BrowseAllow IP.of.desired.server" and "BrowseDeny IP.of.unwanted.server" in /etc/cups/cupsd.conf in order to reject all kinds of packets (including browsing information) from undesired servers. We recommend the use of IP addresses instead of names. In certain cases, it may be useful to adapt the "BrowseOrder" entry.

If there are servers that do not send any browsing information but whose queues can be accessed (e.g., servers in other departments or buildings), you may want to poll the server's browsing information. To do this, insert an entry in the form "BrowsePoll IP.of.the.server:631" for every server in /etc/cups/cupsd.conf. We recommend the use of IP addresses instead of names. By default, the port on the server is 631. After cupsd is restarted, a cups-polld will be started for every "BrowsePoll" entry.

Either change /etc/cups/cupsd.conf manually or use YaST. Since openSUSE 11.3 use in YaST the "Print via Network" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

**If browsing is generally undesired:**

Set "Browsing Off" in /etc/cups/cupsd.conf. This does not mean that the queues on the server can no longer be accessed. Utilities like the command-line tools can still be used; however, the server must be specified explicitly (normally with the option "-h", see the man pages).

**Client-only configuration:**

If browsing is generally undesired, there is no reason for running a cupsd on the client. In this case, a client-only configuration should be used. Either set it up manually as described below or use YaST. Since openSUSE 11.1 use in YaST the "Print via Network" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

1. Stop and deactivate cupsd (using the YaST Runlevel Editor or insserv).
2. In /etc/cups/client.conf, insert an entry in the form "ServerName IP.of.the.server".

Such an entry in /etc/cups/client.conf should not exist together with a running local cupsd. As only one entry is possible, the preferred server should be entered. To access a different server, the server must be specified explicitly (option "-h") when using the command-line tools, or the environment variable CUPS\_SERVER must be set accordingly. Some applications ignore the "ServerName" entry. In this case, it may be useful to set CUPS\_SERVER, or the server can be specified explicitly in the application (e.g., with the option "-h" in the print command).

**Minimal client installations:**

The standard minimum requirement for addressing CUPS servers is to install the "cups-libs" and "cups-client" packages. In this case, servers can be addressed with the command-line tools.

The absolute minimum requirement for addressing a CUPS server is to install only the "cups-libs" package. In this case, only application programs that use the CUPS libraries directly can print.

#### Regarding firewall

If the CUPS server and the client systems are in an internal network and when you trust all what there is in your internal network, your network interface must be set to be in the
"internal zone".

It doesn't make sense to have a network setup in a trusted internal network with a network interface which belongs to the untrusted "external zone" (which is the default to be safe).

In particular do not disable firewall protection for CUPS (i.e. for IPP which uses TCP port 631 and UDP port 631) for the untrusted "external zone".

See the Support Database article [CUPS and SANE Firewall settings](/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings").

#### Allow printer admin tasks for a normal user

Since openSUSE 10.2 / CUPS 1.2 with an original CUPS 1.2 (or later) cupsd.conf file (which supports CUPS operation policies) you could allow printer admin tasks for a normal user as follows:

```
<Policy default>
...
<Limit ... CUPS-Add-Modify-Printer ...>
Require user @SYSTEM normal-user

```

Replace "normal-user" with the system user name (i.e. the user name in /etc/passwd) of the normal user who should be allowed to do printer admin tasks and restart the cupsd.

For details regarding "Operation Policies" see <https://www.cups.org/doc/policies.html>

Have in mind that a user who is allowed to do printer admin tasks can change the print queues as he likes. For example he could let (possibly confidential) print jobs print as usual (so that the betrayal is not easily noticed) but additionally send a copy of what is printed to any external destination.

**In this context a general security advice:**

When root allows normal users to do system administration tasks, in particular when root allows normal users to administer system processes (i.e. processes that run as root like the cupsd), then this or that kind of privilege escalation will be possible.

Only trustworthy users who do not misuse their privileges may get allowed to do specific system administration tasks.

## See also

[Portal:Printing](/Portal%3APrinting "Portal:Printing")

[SDB:Installing a Printer](/SDB%3AInstalling_a_Printer "SDB:Installing a Printer")

[SDB:Purchasing a Printer and Compatibility](/SDB%3APurchasing_a_Printer_and_Compatibility "SDB:Purchasing a Printer and Compatibility")

[SDB:Printing via TCP/IP network](/SDB%3APrinting_via_TCP/IP_network "SDB:Printing via TCP/IP network")

[SDB:CUPS and SANE Firewall settings](/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings")

[YaST Printer](/YaST_Printer "YaST Printer")

Retrieved from "<https://en.opensuse.org/index.php?title=SDB:CUPS_in_a_Nutshell&oldid=182803>"

[Category](/Special%3ACategories "Special:Categories"):

* [SDB:Printing](/Category%3ASDB%3APrinting "Category:SDB:Printing")

This page was last edited on 14 December 2023, at 09:48. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 159,752 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

Â© 2001â€“2025 SUSE LLC, Â© 2005â€“2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_amd.png)](/Sponsors)

##### Log in

Ã—

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in



=== Content from lists.fedoraproject.org_f147161c_20250115_102112.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47.mbox.gz?message=S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/#S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47)

# [SECURITY] Fedora 33 Update: cups-2.3.3op2-5.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

10 May
2021

10 May
'21

3:08 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-7b698513d5
2021-05-10 01:07:48.522221
--------------------------------------------------------------------------------

Name : cups
Product : Fedora 33
Version : 2.3.3op2
Release : 5.fc33
URL : <http://www.cups.org/>
Summary : CUPS printing system
Description :
CUPS printing system provides a portable printing layer for
UNIXï¿½ï¿½ operating systems. It has been developed by Apple Inc.
to promote a standard printing solution for all UNIX vendors and users.
CUPS provides the System V and Berkeley command-line interfaces.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-25317
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Apr 30 2021 Zdenek Dohnal zdohnal@redhat.com - 1:2.3.3op2-5
- 1955090 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attack
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1949119 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attacks
<https://bugzilla.redhat.com/show_bug.cgi?id=1949119>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-7b698513d5' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47/#S37IDQGHTORQ3Z6VRDQIGBYVOI27YG47)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lists.fedoraproject.org_547e13ed_20250115_102112.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/H74BP746O5NNVCBUTLLZYAFBPESFVECV/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/H74BP746O5NNVCBUTLLZYAFBPESFVECV/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/H74BP746O5NNVCBUTLLZYAFBPESFVECV/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/H74BP746O5NNVCBUTLLZYAFBPESFVECV/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-H74BP746O5NNVCBUTLLZYAFBPESFVECV.mbox.gz?message=H74BP746O5NNVCBUTLLZYAFBPESFVECV "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/H74BP746O5NNVCBUTLLZYAFBPESFVECV/#H74BP746O5NNVCBUTLLZYAFBPESFVECV)

# [SECURITY] Fedora 34 Update: cups-2.3.3op2-5.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

6 May
2021

6 May
'21

3:03 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-dc578ce534
2021-05-06 01:00:14.653702
--------------------------------------------------------------------------------

Name : cups
Product : Fedora 34
Version : 2.3.3op2
Release : 5.fc34
URL : <http://www.cups.org/>
Summary : CUPS printing system
Description :
CUPS printing system provides a portable printing layer for
UNIXï¿½ï¿½ operating systems. It has been developed by Apple Inc.
to promote a standard printing solution for all UNIX vendors and users.
CUPS provides the System V and Berkeley command-line interfaces.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-25317
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Apr 30 2021 Zdenek Dohnal zdohnal@redhat.com - 1:2.3.3op2-5
- 1955090 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attack
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1949119 - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attacks
<https://bugzilla.redhat.com/show_bug.cgi?id=1949119>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-dc578ce534' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/H74BP746O5NNVCBUTLLZYAFBPESFVECV/#H74BP746O5NNVCBUTLLZYAFBPESFVECV)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from www.gravatar.com_d42fff4d_20250115_225530.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½  & &" ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½Sï¿½2ï¿½ï¿½ï¿½ï¿½ï¿½rï¿½ï¿½!ï¿½Xï¿½gï¿½s]Ç‰ï¿½ï¿½ï¿½ï¿½yï¿½4ï¿½!ï¿½!`ï¿½ï¿½IYTu\ï¿½0Ocï¿½^ï¿½K5Ýµï¿½Bl,ï¿½2yÄ±ï¿½$ï¿½9eï¿½#ï¿½ï¿½ï¿½yï¿½]Fï¿½ï¿½iï¿½×½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\_bÓ½ï¿½{;vï¿½kï¿½=Oï¿½ï¿½Tk:=ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½u\_ï¿½rjï¿½ï¿½ï¿½ï¿½-ï¿½ï¿½uï¿½k{!?fï¿½QÕ‰{ï¿½tï¿½=+ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ã† ï¿½ï¿½ï¿½Õ¿6V[ï¿½ï¿½ï¿½,pï¿½ehï¿½ï¿½oï¿½~oï¿½ï¿½(ï¿½ï¿½ï¿½Pï¿½dï¿½ï¿½ï¿½<qï¿½Vï¿½ï¿½ï¿½=ï¿½tï¿½ï¿½G9bï¿½Mï¿½iv=ï¿½ï¿½;{QE pï¿½Å®ï¿½ï¿½xï¿½mF9`Iï¿½FNTï¿½aï¿½Ê½6 ï¿½Fï¿½ fPHJ(ï¿½ï¿½ï¿½(ï¿½ï¿½B?ï¿½ï¿½

=== Content from en.opensuse.org_950a1b6b_20250115_140236.html ===


[![ðŸ¦Ž](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/SDB%3ACUPS_and_SANE_Firewall_settings "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/SDB%3ACUPS_and_SANE_Firewall_settings "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&oldid=192166 "Permanent link to this revision of the page")[Page information](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=info "More information about this page")

* In other languages
  [ä¸­æ–‡](http://zh.opensuse.org/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings â€“ ä¸­æ–‡")

* Log in

* [SDB](/SDB%3ACUPS_and_SANE_Firewall_settings)
* [Discussion](/index.php?title=SDB_Talk:CUPS_and_SANE_Firewall_settings&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/SDB%3ACUPS_and_SANE_Firewall_settings)
[View source](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=history "Past revisions of this page [h]")

# SDB:CUPS and SANE Firewall settings

Jump to: [navigation](#mw-head),
[search](#p-search)

This article is rather old and was written with only traditional IPv4 networking in mind.

With nowadays IPv6 networking certain things are rather different so what was true for traditional IPv4 networking could be no longer true for nowadays IPv6 networking.

## Contents

* [1 Situation](#Situation)
* [2 Security: Make Things Not Just Work](#Security:_Make_Things_Not_Just_Work)
* [3 General Information About openSUSE Firewalls](#General_Information_About_openSUSE_Firewalls)
* [4 Basic Information How the Firewall Works](#Basic_Information_How_the_Firewall_Works)
* [5 When Network Security is Likely to be Doomed](#When_Network_Security_is_Likely_to_be_Doomed)
* [6 Basic Network Security versus Phishing](#Basic_Network_Security_versus_Phishing)
* [7 What is Specific Regarding Firewall Setup for Printing](#What_is_Specific_Regarding_Firewall_Setup_for_Printing)
  + [7.1 It is crucial to limit access to CUPS to trusted users](#It_is_crucial_to_limit_access_to_CUPS_to_trusted_users)
  + [7.2 It is crucial to limit access to network printer devices to trusted users](#It_is_crucial_to_limit_access_to_network_printer_devices_to_trusted_users)
  + [7.3 It is crucial to not accept remote printing information from untrusted hosts](#It_is_crucial_to_not_accept_remote_printing_information_from_untrusted_hosts)
    - [7.3.1 Automated print queue setup via cups-browsed](#Automated_print_queue_setup_via_cups-browsed)
* [8 What is Specific Regarding Firewall Setup for Using Scanners](#What_is_Specific_Regarding_Firewall_Setup_for_Using_Scanners)
  + [8.1 Setup for firewalld](#Setup_for_firewalld)
* [9 Summary](#Summary)
* [10 Bottom Line](#Bottom_Line)
* [11 Further Information](#Further_Information)
## Situation

You like to use printers and scanners in your network and you like to have firewall protection against unwanted access.

Using printers and scanners via network is likely to happen in particular in home networks and small office networks. Therefore this article provides at first basic information regarding firewall and network security.

CUPS and SANE are systems for using and managing printers and scanners respectively.

CUPS is the acronym for Common Unix Printing System. For basic information how to set up CUPS see [SDB:CUPS in a Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") and [YaST\_Printer](/YaST_Printer "YaST Printer") and regarding CUPS server security see <http://www.cups.org/documentation.php/security.html>

SANE is the acronym for Scanner Access Now Easy.
It provides standardized access to scanner hardware (e.g. a flatbed scanner) and a SANE network daemon that allows remote clients to access scanners which are connected to the local host. For basic information how to set up SANE see [SDB:Configuring Scanners](/SDB%3AConfiguring_Scanners "SDB:Configuring Scanners") and regarding the SANE network daemon see <http://www.sane-project.org/man/saned.8.html>

**Both CUPS and SANE provide network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks.**

For openSUSE Leap 42.3 (and prior versions) [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2") was the default firewall iptables-based front-end with rules generated according to the /etc/sysconfig/SuSEfirewall2 configuration file.

For openSUSE Leap 15.0 onwards, [firewalld](/Firewalld "Firewalld") is the default firewall front-end (which still uses the Linux kernel's netfilter framework), and can be configured using the 'firewall-cmd' CLI interface or the graphical 'firewalld-config' utility.

In this article "the firewall" usually means the [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2") or [firewalld](/Firewalld "Firewalld").
Third party firewalls (e.g. a firewall in an Internet "router-box" device) may work quite differently.

## Security: Make Things Not Just Work

The intended purpose of [security measures](/openSUSE%3ASecurity_Features "openSUSE:Security Features") is to make things not "just work" which means [security](/Portal%3ASecurity "Portal:Security") causes some kind of annoyance for the user when things do not "just work" out of the box. If everything would "just work" by default, it would be totally insecure.

Things should only work for authorized users. To distinguish authorized users from others, a person who works with a computer must somehow authenticate to be an authorized user which usually happens via a password dialog. Alternatively physical location can be used to distinguish authorized users from others. For example a person who works directly locally at the computer can be automatically logged in as authorized user while in contrast a person who works from remote via network needs to authenticate via password dialog. Additionally the location in the network (i.e. the network environment) can be used to distinguish legitimate access via network from unwanted access. Basically the firewall allows access via network or rejects it by partitioning the network environment into so called "zones" that are used to distinguish legitimate access in one zone from unwanted access in another zone.

In this context [security](/Concepts_security "Concepts security") means that in particular access from remote via network must not "just work" by default. Any kind of desired access from remote via network must be explicitly allowed by an [authorized user](/SDB%3ALogin_as_root "SDB:Login as root").

## General Information About openSUSE Firewalls

For openSUSE Leap 42.3 (and prior), refer to the documentation of the SuSEfirewall2 package in the /usr/share/doc/packages/SuSEfirewall2/ directory and the comments in its configuration file /etc/sysconfig/SuSEfirewall2 and the online documentation about [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2").

For openSUSE Leap 15.0 onwards, the current documentation can be found online in the Security Guide on <https://doc.opensuse.org/>

## Basic Information How the Firewall Works

The firewall is used to protect your host against unwanted access via network.

To access your host via network, at least one server process must run on your host. Each kind of server process is accessible via a particular network port. For example a web server process (e.g. the Apache web server) is accessible via the HTTP port 80 and the CUPS print server process is accessible via the IPP port 631 and the Avahi DNS-SD server process is accessible via the mDNS port 5353.

If no server process is running on your host, your host is not accessible via network so that you do not need the firewall. Nevertheless to be on the safe side you should not switch off the firewall because it will protect your host against unwanted access via network when an unintended server process was started by accident.

**If one or more server processes are running on your host and you open their matching ports in the firewall, you remove any firewall protection from your host because you only need the firewall to protect running server processes against unwanted access via network.**

On the other hand for server processes which should be accessible you must open the matching ports in the firewall. This means that there cannot be firewall protection for those server processes which should be accessible via network. Server processes which are accessible via network must provide sufficient security on their own. This is the reason why you must apply security updates for server processes which are accessible via network plus security updates for all what is related to such server processes (in particular system libraries that are used by your server processes and things like that).

If your host is connected only to a trusted internal network where a dedicated firewall machine protects the whole internal network, you may switch off the firewall on your host.

For example assume you have a server machine where a web server for your web site runs. Additionally the CUPS server process runs because there is a printer connected which you need once in a while to print something directly on the server machine.

Of course any user should be able to view your home page and whatever else you provide via your web site from any location in the Internet.

But on the other hand nothing else on your server machine should be accessible by arbitrary users from the Internet. In particular arbitrary users out there should not waste your paper and print on your printer.

Therefore you let the firewall pass any network traffic to HTTP port 80 (i.e. port 80 is open in the firewall) to allow arbitrary users to access the web server.

On the other hand you let the firewall prevent any network access for any other port (i.e. all other ports are closed in the firewall) so that in particular the CUPS server is not accessible via network and as a consequence your printer is protected against unwanted access via network.

Plain opening and closing ports in the firewall is sufficient for such kind of simple "all or nothing" configuration (allow any network access to the web server but none at all to the CUPS server).

Now assume you have again a server machine with a running web server and a running CUPS server but now the locally connected printer should be accessible by the users of a trusted internal network.

A trusted network means that you trust all users who can access this network. A user who can connect a computer to a network (e.g. a laptop where the user can work as "root") can send and receive any network traffic. Such a user can eavesdrop on the network and he can also fake any server machine in the network (except additional network switch hardware with an appropriate setup limits the user's network access).

Plain opening and closing ports in the firewall is no longer sufficient because if the IPP port for CUPS would be opened without further restrictions in the firewall, also arbitrary users out there from the Internet could waste your paper by printing on your printer.

The crucial point to apply further restrictions in the firewall is to distinguish whether or not network traffic happens in your trusted internal network.

Therefore your trusted internal network traffic must be separated from the other non-trusted network traffic. The best way to get different kind of network traffic separated is when different networks are used. The simplest and most secure solution to maintain separated networks is when separated network hardware is used.

Therefore the network hardware for your trusted internal network should be separated from the network hardware for the rest. In this case you have usually two network interface cards in your server machine, one where your trusted internal network is connected and the other one for the Internet connection. Consequently your network configuration has two network interfaces named for example "eth0" and "eth1".

Finally assume you have again a server machine with a network interface for the Internet connection and a second network interface for your trusted internal network. On the server machine a web-server and a CUPS server are running and the locally connected printer should be accessible only by the trusted users of your internal network.

In this case you would first and foremost assign the network interface for the Internet connection to the external zone of the firewall and the network interface for the internal network to the internal zone of the firewall.

By default the firewall prevents any network access via the network interface which belongs to the external zone but it lets any network traffic pass via the network interface which belongs to the internal zone.

Access direction is crucial: The firewall prevents access of your host from the Internet but not the other way round. Therefore you can still access servers in the Internet from your host. In particular you can access all those web servers which run out there in the Internet with your browser program. For example you can access the web server which runs on www.opensuse.org to get the openSUSE home page from it or access a mail server web frontend to get your e-mail even when the firewall prevents access of your host from the Internet. Have in mind that this way all what you request from the Internet gets delivered to your system. The firewall does not protect you when you visit a malicious web server with your browser program which will get its malicious web pages, see in particular the Wikipedia article <http://en.wikipedia.org/wiki/Drive-by_download> about "Drive-by download" and the firewall does not protect you when you get for example malicious e-mails. Furthermore you can submit any data to all those servers which are accessible out there in the Internet. The firewall does not protect you when you submit private or confidential data to a wrong server, see in particular the Wikipedia article <http://en.wikipedia.org/wiki/Phishing> about "Phishing". If you cannot trust the network you must not type in your authentication credentials into arbitrary web interfaces which are "just accessible" for you. If you cannot trust the network you must not submit private or confidential data to arbitrary servers which are "just accessible" for you. If you cannot trust a network you must not release private or confidential data into the network - except you had set up in advance sufficient encryption and authentication to ensure that only your intended recipient can decode your data regardless that others in the network could have also received your encrypted data.

As a result you can still browse the Internet without restrictions but no server process on your server machine is accessible from the Internet while all your server processes are accessible from your internal network.

As a second step you open HTTP port 80 for the external zone in the firewall to allow arbitrary users to access your web server from any location in the Internet.

In the end the web server is accessible for anybody from anywhere (i.e. from the Internet and from the internal network) but the CUPS server is only accessible for users in the trusted internal network.

As another example assume you have a laptop which you use while travelling but also in trusted networks in the office and at home.

When the laptop has a single network interface card, trusted and non-trusted network traffic will mix up. Therefore you assign the network interface to the external firewall zone to protect the laptop against unwanted access via any network. Usually it does not make sense to have any server process running on the laptop because when the laptop is moved from one network to another network, the server process becomes suddenly unavailable in the one network but available in the other network which results an unpredictable behaviour for the users which use your server. But when no server process is running on the laptop, it is not accessible via network so that no firewall is needed. Nevertheless to be on the safe side you should not switch off the firewall because it will protect the laptop against unwanted access when whatever kind of server process was started by accident.

Assume you must run whatever server process on the laptop. Now you need to get trusted and non-trusted network traffic separated. You could use a wireless network interface card for all kind of untrusted network connections while travelling and an additional network interface card with a traditional wired network cable connection which you use only in the office and at home. You would assign the network interface for the wireless card (e.g. "wlan0") to the external firewall zone and the network interface for the office and at home (e.g. "eth0") to the internal firewall zone. This way it would be actually fool-proof to keep the laptop protected against unwanted access via network: As long as the connection to a trusted network exists (there is no firewall protection for the wired network because it belongs to the internal firewall zone) you cannot move the laptop into a non-trusted network environment. Before you can do this you must unplug the traditional wired network cable which instantly makes the laptop no longer accessible because the firewall protects the wireless network (because it belongs to the external firewall zone).

In this article a trusted network means that you trust all users who can access this network so that you can open particular ports for particular server processes in the firewall for this network.

From the firewall point of view there is no such thing as "partially trusted" for a particular network because one cannot "partially open" a port in the firewall. Either the port is open for a particular network or not. Accordingly either you trust all users to access a server process in a particular network or not.

Do not confuse what "trusted network" means here with a more general meaning of trust. You may have different networks where you let the users of each network access more or less sensitive server processes. For example a trusted internal network with access to an internal print server where also confidential documents are printed on an internal printer device versus a separated network for guests with access to a separated print server plus a separated printer device where guests can print their documents. In each of the two networks you trust all the users to access the same kind of server process but both networks do not have the same level of trust from a general point of view. The simplest and most secure solution to maintain security is also used here: Separated hardware. Separated networks with separated print sever machines plus separated printer devices. Why separated printer devices? You may Google for "network printer security risk" (and see below).

## When Network Security is Likely to be Doomed

The basic idea to increase likelihood that your network security is doomed is to mix up trusted and non-trusted network traffic in one same network environment.

Save money and use the same network hardware for trusted and non-trusted network traffic and as a consequence pay with an increased likelihood that your network security is doomed and pay with an increased effort to maintain your network security.

Use one same "router-box" device for both your trusted internal network
and the connection to the Internet.
In such a case the router-box device is the crucial point
(in particular the crucial point of possible failure) regarding network security.
Usually such router-box devices provide their own built-in firewall
(which may work totally different than the firewall used in openSUSE).
Carefully read the documentation for your particular router-box
how to set up its built-in firewall and which kind of protection it provides.
Often it supports separation of your internal network from the Internet
via private IPv4 addresses like 192.168.xxx.xxx
together with network address translation (NAT), also known as network masquerading.
If your router-box has a built-in firewall and supports private IPv4 addresses together with NAT
(and if there is no security flaw in the router-box),
your hosts are in a trusted internal IPv4 network where the router-box is
a dedicated firewall machine which protects your internal network.
With nowadays IPv6 networking things are rather different.
Usually each host gets a public IPv6 address
so the hosts are no longer separated from the Internet.
In this case the router-box built-in firewall (hopefully)
protects the hosts against unwanted access from the Internet.
To be more on the safe side additionally a firewall should be running on each host.

Another way to increase likelihood that your network security is doomed is to use wireless communication for your trusted internal network traffic. In this case arbitrary strangers within a certain proximity out of your building have physical access to the electromagnetic waves which belong to the network traffic of your trusted network. Those folks out there do have a particular kind of physical access to your internal network. Therefore your network security totally depends on the trustworthiness of the security protocol which is used for network traffic encryption like the insufficient and deprecated WEP (Wired Equivalent Privacy) and its successors like WPA (Wi-Fi Protected Access) and finally WPA2 also known as RSN (Robust Secure Network). As of this writing (January 2010), only WPA2/RSN is considered secure, provided there is no WPS (Wi-Fi Protected Setup) functionality enabled which is insecure (Google for "wpa2 wps crack"). But WPA2 may not work with some older wireless network cards. Meanwhile (September 2012) WPA2 might be no longer secure because it seems possible to figure out its NT hash. Additionally there are other non-standard successors of WEP which could be insecure. Carefully read the documentation for your wireless network devices how to set up network traffic encryption for each of them and keep yourself continuously up to date regarding security issues or do not use wireless communication for your trusted internal network traffic.

Of course the best way to increase likelihood that your network security is doomed is to do all your network traffic via one same wireless router-box device. In this case carefully read the documentation for your particular wireless router-box how to set up its built-in firewall and its network traffic encryption protocol. Furthermore you need to keep yourself continuously up to date regarding security issues with your particular wireless router-box and what you could do against such issues.

On the other hand this kind of network environment is common nowadays in particular for home networks and small office networks where unfortunately often inexperienced users must maintain their network security on their own.

Assume you have a wireless router-box device which provides the Internet access for a workstation at home to which a printer is connected. Additionally you have a laptop and it should be possible to use the printer from the laptop. The workstation and the laptop have only a wireless network interface card to access the router-box.

**Plain opening of a port for the external zone in the firewall destroys your network security because it removes any firewall protection for the service which is accessed via this port. When the CUPS print server process is the only server process which runs on the workstation, opening its IPP port 631 removes effectively any firewall protection from the workstation.**

Instead inspect your network configuration to find out if different network interfaces are used for the Internet connection and for your internal network. For example there might be a network interface like "dsl0", "ppp0" or "ippp0" for the Internet connection and another network interface like "eth0" or "wlan0" for the internal network. In this case assign the network interface for the Internet connection to the external zone of the firewall and the network interface for the internal network to the internal zone of the firewall.

If one same network interface like "eth0" or "wlan0" is used for the Internet connection and for the internal network you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic.

## Basic Network Security versus Phishing

The above described measures for basic network security do usually not help against phishing attacks, cf. "Phishing" at Wikipedia <https://en.wikipedia.org/wiki/Phishing>

The reason is that phishing attacks happen via intentionally open channels to receive data from "the outer world" like incoming e-mails or other messaging systems but also SMS on mobile phones and traditional phone calls.

Usually such channels are intentionally open by default for any sender because it is intended that one can receive e.g. e-mails, other messages, SMS, and phone calls from anyone from "the outer world" (e.g. so that an old friend who lives now in a foreign country could still contact one) but this means that one can also get arbitrary unwanted things from possibly malicious senders.

There are also intentionally open channels to receive computer specific data from remote. Usually those open channels are intended to receive announcements (broadcasts/multicasts) from remote servers about available services that those remote servers provide in the network. For example remote print queues are announced this way by remote print servers in the network traditionally via the so called "CUPS Browsing" and/or nowadays via DNS-SD, see "print job phishing" below.

## What is Specific Regarding Firewall Setup for Printing

The CUPS server process (the cupsd) is accessible via TCP via the IPP port 631 to accept print jobs.

Optionally there could be also the cups-browsed (belongs to 'cups-filters' which is not CUPS but a separated project) which is accessible by default via UDP via IPP port 631 to accept any incoming CUPS Browsing information about remote print queues from any remote host. Normally the cups-browsed.service should not be used because it is a generic security risk when a service accepts any (possibly malicious) incoming information from any remote host so only a proper firewall setup would protect your host.

By default the cupsd should be only accessible via the internal interface of the local host (lo) to accept print jobs. Therefore printing is usually only possible directly from the local host but not from any remote host via network. If the cupsd runs in its default mode, you do not need the firewall to protect the cupsd (and your printer if it is locally connected) against unwanted access. Nevertheless to be on the safe side you should not switch off the firewall because it will protect your CUPS server against unwanted access via network when the cupsd is not running in its default mode. For example for very old CUPS versions or for uncommonly built cups RPM packages the cupsd might be even generally accessible unless the firewall provides protection.

To protect your CUPS server against unwanted access:

**Do not open any IPP port 631 for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone, client hosts in the internal network can access the CUPS server process and submit print jobs. Independent of the firewall setup the CUPS server must additionally be configured to accept print jobs from those client hosts (which is not the default, see above).

To make your CUPS server accessible:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

### It is crucial to limit access to CUPS to trusted users

Printing documents lets the user access and contol the printer hardware because in the end the printer processes data which is basically a program that controls the printer machine.

Furthermore printing documents via CUPS lets the user access and contol various programs that run on the computer where CUPS runs (i.e. the CUPS server machine which can also be the local host).

Those programs process the print job data (e.g. a PostScript or PDF file) in various ways to produce in the end printer specific data that is finally sent to the printer device. That final printer specific data is the above mentioned program which controls the printer machine.

Those programs are the cupsd (which runs as 'root' on the CUPS server), various filtering programs (e.g. Ghostscript), arbitrary printer drivers, and various backends. The various programs that convert the initial print job data into printer specific data (the filtering programs) and send the result to the printer device (the backend) are usually run as user 'lp' on the CUPS server.

Those programs work with the data in various ways so that in the end all together lead to a zillion of ways how the data is processed (cf. "Background Information" at [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue") and "Processing stages of a print job" at [SDB:CUPS in a Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell")).

Furthermore certain kind of print job data (in particular PostScript but also PDF to some extent) is actually a program.

PostScript is a general purpose Turing-complete programming language (cf. <https://en.wikipedia.org/wiki/PostScript>) that supports in particular file access on the system disk. When Ghostscript processes PostScript it runs a PostScript program as the user who runs Ghostscript (usually the user 'lp', see above). Furthermore when Ghostscript processes PDF it also runs a PostScript program because the PDF interpreter, as supplied with Ghostscript before version 9.56, is written in PostScript where PDF features which have no equivalent in PostScript need to be implemented via special PostScript extensions that have proven to be a security problem. See <https://artifex.com/blog/changes-to-the-pdf-interpreter> that provides a lot of background information about Ghostscript's PDF interpreter and why it is replaced in Ghostscript version 9.56 by a new PDF interpreter that is written entirely in C. When Ghostscript processes an arbitrary PostScript or PDF file, the user who runs Ghostscript runs an arbitrary program which can do basically anything on the system where Ghostscript runs that this user is allowed to do on that system. To make it safer when Ghostscript runs a PostScript program the Ghostscript command line option '-dSAFER' disables certain file access functionality (for details see /usr/share/doc/ghostscript/\*/Use.htm). When printing documents Ghostscript is normally run with the '-dSAFER' option set. Its name 'SAFER' says everything: It makes it 'safer' to let Ghostscript run a PostScript program, but it cannot make things completely safe.

Users who are allowed to submit print jobs are allowed to upload arbitrary data and even certain kind of programs onto the CUPS server.

In theory all those programs that run on the CUPS server are safe against misuse.

In practice there is an endless sequence of various kind of security issues that appear every now and then in this or that particular program which get fixed issue by issue ad infinitum (and ad nauseam).

In the end all that means:

**Users who are allowed to submit print jobs to a CUPS server are allowed to upload arbitrary data onto the CUPS server and run arbitrary programs in arbitrary ways (usually as user 'lp') on the CUPS server and finally access and contol the printer hardware as they like.**

CUPS cannot be used in an environment where one does not know who the persons are that submit print jobs or where one cannot trust the persons that submit print jobs because there are too many possibilities for users who are allowed to submit print jobs to let "bad things" happen on the CUPS server.

Even if all those programs that run on the CUPS server were safe against misuse, any user who is allowed to submit print jobs could still do some kind of denial of service attack: Either by submitting many small useless print jobs or a few huge nonsense print jobs which waste toner/ink and paper or by submitting specific tiny PostScript or specially crafted PDF print jobs which let PostScript or PDF processing software (like Ghostscript) or a printer's built-in PostScript interpreter do basically endless time consuming processing or even hang up in an endless loop. The latter may result in loss of print jobs when subsequent print jobs of other users were already sent into the printer's memory while the tiny PostScript job is blocking the printer's actual printing unit endlessly. If the blocking job can only be aborted by a printer reset, the other jobs in its memory are usually lost. If you think things like printer accounting would be an easy way out here, have a look at [SDB:Printer Accounting](/SDB%3APrinter_Accounting "SDB:Printer Accounting") and you may get "some new kind of headache regarding printing setup".

In parctice the most feasible way out is to limit access to CUPS to trusted users plus the next items:

### It is crucial to limit access to network printer devices to trusted users

Usual network printer devices (printers with a built-in network interface, see [SDB:Printing via TCP/IP network](/SDB%3APrinting_via_TCP/IP_network "SDB:Printing via TCP/IP network")) are no longer only "dumb" printing units. Nowadays network printers are also real computers with full network capabilities. When it looks like a printer, acts like a printer, sounds like a printer, it could be a computer! A user who controls a network printer controls a printing unit plus a computer with network access. Therefore it is crucial to limit access to network printer devices to trusted users (Google for "network printer security risk" - see above). Those access restrictions must be set up in the network printer device itself. Read the documentation of your network printer device how to do that.

### It is crucial to not accept remote printing information from untrusted hosts

Traditionally (i.e. in CUPS up to version 1.5.4) by default the CUPS server process was accessible via UDP via IPP port 631 to accept incoming information about remote print queues from remote hosts. A CUPS print server could publish information about its queues in the network by sending UDP broadcasts and/or regular UDP (unicast) packets. Accordingly the CUPS server processes which run on the client hosts accepted by default incoming information about remote print queues via UDP via IPP port 631.

In this way, the queues of the server were available on the clients without any CUPS-specific configuration on the client hosts. Users on the clients could browse the queues on various servers. Therefore the whole stuff is called "CUPS Browsing". See the section "Intrinsic design of CUPS <= 1.5 for printing in the network" at [SDB:CUPS\_in\_a\_Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") and note the section "CUPS 1.6 has major incompatible changes" therein.

Nowadays (i.e. since CUPS >= 1.6) remote print queue annoucements and remote printer announcements happen via DNS-SD that is implemented by Avahi instead of and/or in addition to traditional "CUPS Browsing",
cf. "Zero-configuration networking" at Wikipedia <https://en.wikipedia.org/wiki/Zero-configuration_networking> and "Avahi" at Wikipedia [https://en.wikipedia.org/wiki/Avahi\_(software)](https://en.wikipedia.org/wiki/Avahi_%28software%29)

Because CUPS Browsing is dropped in CUPS since version 1.6 the package cups-filters provides the cups-browsed that provides basic CUPS Browsing functionality to maintain backward compatibility with traditional old CUPS Browsing but cups-browsed is a generic security risk, see above.

Regardless what is used for remote printing services announcements:

It is crucial to not accept remote printing information from untrusted hosts.

Otherwise possibly confidential print jobs could be sent to untrusted printers or print servers.

See the "print job phishing" thread on the "cups" mailing list from August 2007

<https://lists.cups.org/pipermail/cups/2007-August/thread.html>

that reads in particular:

```
When printing in the network is done via usual CUPS Browsing,
on the other workstations in the network all announced queues
with the same name build automatically a so called "implicite class"
so that a print job which is sent to the destination with this name
is printed on an arbitrary printer in this class.
...
A malicious user ... can set up queues ... with the same name
as queues on the official CUPS server and announce his queues
in the network.
...
on the other workstations their users cannot notice
that duplicated queues exist so that the malicious user
could do "print job phishing".

```

If you wonder why this behaviour is the default: It is because CUPS is designed for use in a trusted internal network where usability and convenience (no CUPS-specific configuration on client hosts - i.e. make printing "just work" versus above "Security: Make Things Not Just Work") is considered to outweigh the security risk in an external network where furthermore by default a firewall should provide protection. See the above "print job phishing" thread which contains the following explanation from the CUPS main author:

```
To summarize:
1. Once a malicious user gains access to a network,
   there are numerous ways to compromise that network.
2. CUPS browsing attacks are easy to detect.
3. Disabling key features of CUPS browsing does not offer
   any added security while making printing much less usable.
4. Adding a signing key for browse packets would
   make CUPS browsing more secure but would require
   active configuration of every system on the network
   to be effective.
5. Using alternate protocols and/or manual configuration
   of shared printers can offer improved security
   at the expense of usability/convenience.

```

By default the firewall prevents any access via network interfaces which belong to the external zone and by default all network interfaces belong to the external zone. Therefore by default the firewall rejects or drops any remote printing information from any host so that client hosts are protected against "print job phishing".

In general if you cannot trust the network you must not submit your private or confidential print jobs to arbitrary printers (i.e. to arbitrary print queues) which are "just accessible" for you.

For example assume you are traveling with your laptop and in your hotel lobby there is a printer for guests. Here you accept remote printing information because you trust that well known reputable "Grand Hotel". You need to print out your admission ticket for a non-public congress that you got right now during a perfectly secure registration via Internet. You submit your print job to the "grand\_hotel\_lobby\_printer" and - voila! - a few seconds later your admission ticket comes out of the printer at the hotel lobby information desk. What you do not know is that those friendly businessman next to you had sent you the "grand\_hotel\_lobby\_printer" print queue information from his laptop so that he got your admission ticket and then (after copying it) forwarded it to the actual printer share of the hotel lobby printer so that you won't notice the deception. Instead of using a print queue that was "just accessible", you had better asked the clerk at the hotel lobby information desk how to correctly access the printer. Now it is too late and nobody may notice the one more listener at that congress. Because it had "just worked" you don't wonder why you didn't have to pay for using a printer at a public accessible location or what (if not money) you actually paid for that printout or even think about "cui bono?" when "the intended purpose of security measures is to make things not just work" (see above).

To protect your host against "print job phishing":

**Do not accept DNS-SD information from untrusted (external) hosts.**

**Do not open any IPP port 631 for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone on the client hosts, remote print queues which are published by internal CUPS print servers will be available on the client hosts.

To make published remote print queues available:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

As example for an exceptional case assume you have a laptop which you use while traveling but also in trusted networks in the office and at home where you like to use announced print queues of a CUPS server in your internal home network.

When the laptop has only a single network interface, trusted and non-trusted network traffic is mixed up so that the network interface must be assigned to the external firewall zone to protect the laptop against unwanted access via any network.

In this case you cannot open any IPP port 631 for the external zone in the firewall because this removes the firewall protection from the laptop in any network.

You simply cannot use arbitrary information about remote print queues from arbitrary hosts when trusted and non-trusted network traffic is mixed up.

In particular you must not open the IPP port 631 for UDP for the external zone so that remote print queue information from untrusted (i.e. external) servers is rejected.

Assume printing from the laptop happens only in the office where no locally connected printer is used but only one single CUPS server of the company. Then it is no longer needed to run a CUPS server process on the laptop. Instead a so called "client-only" configuration could be set up, see [SDB:CUPS\_in\_a\_Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") the section "Configuration of the clients", "Client-only configuration". A possible drawback is that application programs may be delayed for some time (until a timeout happens) when they try to access the CUPS server of the company in another network where it is actually not available (e.g. while traveling). Usually it is a host name resolution (DNS) timeout which causes the delay so that it may help to have a hardcoded entry for the CUPS server of the company in the /etc/hosts file.

You do not need to open any IPP port 631 in the firewall for a "client-only" configuration.

#### Automated print queue setup via cups-browsed

In general cups-browsed should not be used because it is a generic security risk, see above.

If the cups-browsed.service is started or enabled it does not only accept traditional old CUPS Browsing information from any remote host to make remote printers accessible on the local host.

Additionally it also does automated local print queue setup for remote printers that are announced via CUPS Browsing or via DNS-SD when needed e.g. for legacy PostScript/PCL printers that do not support CUPS driverless printing - i.e. for remote printers which require a local print queue with a printer model specific driver to be able to print on the remote printer from the local host.

If you wonder why there is an automated local setup for remote devices: It is because cups-browsed is designed for use in a trusted internal network where usability and convenience (no configuration on client hosts - i.e. make printing "just work" versus above "Security: Make Things Not Just Work") is considered to outweigh the security risk in an external network where furthermore by default a firewall should provide protection.

To do such an automated print queue setup printer model specific info is needed to be able to set up an appropriate printer model specific driver that makes correct looking printouts.

So cups-browsed queries the remote printer for printer model specific info but this results another generic security issue because a malicious fake remote printer can send malicious info to cups-browsed which results a malicious automated setup of the local print queue.

For an example how this can be misused to run commands (cf. above "printing documents via CUPS lets the user access and contol various programs that run on the computer where CUPS runs") see

<https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/>

Because cups-browsed queries the remote printer for printer model specific info a malicious fake remote printer can send arbitrary false info to cups-browsed which results that cups-browsed queries an arbitrary remote printer or an arbitrary remote host for printer model specific info.

For an example how this can be misused to do a DDoS attack see

<https://www.akamai.com/blog/security-research/october-cups-ddos-threat>

Both examples require that users or admins violate crucial conditions how printing services are meant to be used.

**Both cupsd and cups-browsed are network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks which means:**

**It is crucial to limit access to cupsd and cups-browsed to trusted users.**

**It is crucial to limit access to network printer devices to trusted users.**

**It is crucial to not accept remote printing information from untrusted hosts.**

In particular cups-browsed must not be used when cups-browsed could get possibly malicious info from a fake remote printer - i.e. when cups-browsed is not sufficiently restricted by a proper firewall setup to protect your host.

This also proves that it is crucial to not accept remote printing information from untrusted hosts.

## What is Specific Regarding Firewall Setup for Using Scanners

For using scanners via network the SANE network daemon (the saned) is the server process which must run so that remote clients can access scanners which are connected (usually via USB) to the local host.

When you have a network printer scanner copier all-in-one device with a built-in network interface so that the device is directy accessible via network, it is usually used in a different way by "stand-alone scanning to e-mail" where no SANE software (in particular no saned) is involved (see the section "Scanning via Network" in [SDB:Configuring Scanners](/SDB%3AConfiguring_Scanners "SDB:Configuring Scanners")).

The saned is used by the clients via two kind of network connections. In addition to a control connection (via port 6566) saned also uses a separated data connection (for the actual scanning data). The port of the data connection is selected by the operating system and could not be specified so that all ports above 1024 must have been accessible (i.e. open in the firewall) for connections from the clients. Recent saned versions provide support to specify a range of ports for the data connection in the saned configuration file /etc/sane.d/saned.conf via an entry like "data\_portrange = 30000 - 30100" so that only those ports would have to be open in the firewall. But the latter does not provide real better security because in the end the saned must be accessible for using scanners via network.

To protect your host against unwanted access:

**Do not open the sane-port 6566 or any other port regarding using scanners for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone, client hosts in the internal network can access the SANE server process to access scanners which are connected to the server machine. Independent of the firewall setup the SANE server must additionally be configured to permit access from those client hosts (by default it does not permit access).

To make your SANE server accessible:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

### Setup for firewalld

With SuSEfirewall2 some best effort setup is possible when one same network interface is used for the Internet connection and for the internal network by assigning the network interface to the external zone and specifying FW\_TRUSTED\_NETS, FW\_SERVICES\_ACCEPT\_RELATED\_EXT, and FW\_LOAD\_MODULES appropriately which proves that when trusted and non-trusted network traffic is mixed up there is increased effort (i.e. a more complicated configuration that results a more fragile way of operation) and less network security (i.e. only a best effort attempt to get some kind of network security).

A similar best effort setup for Firewalld is possible for example like:

Create a "private" zone

```
firewall-cmd --permanent --new-zone=private
firewall-cmd --permanent --zone=private --add-source=192.168.0.0/24

```

on the SANE server and on the client.

Additionally on the server set

```
firewall-cmd --permanent --zone=private --add-service=sane

```

The sane helper loads a sane specific conntrack module which takes care of opening any required ports for transferring scanner data - no additional explicit opening of ports is necessary.

In general if possible you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic.

## Summary

By default the firewall prevents any network access via network interfaces which belong to the external zone but it lets any network traffic pass via network interfaces which belong to the internal zone.

Both CUPS and SANE provide network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks.

To use printers and scanners in a trusted internal network and have firewall protection against unwanted access from the Internet, set up the firewall as follows:

Do not open the CUPS IPP port 631 or the sane-port 6566 or any other port for the external zone.

If different network interfaces are used for the Internet connection and for the internal network, assign the network interface for the Internet connection to the external zone and the network interface for the internal network to the internal zone.

When one same network interface is used for the Internet connection and for the internal network you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic or have a dedicated firewall machine which protects your whole internal network.

## Bottom Line

To use printers and scanners in a trusted internal network and be protected by the firewall against unwanted access from the Internet, do first and foremost this one single fundamental setup to gain security plus convenience in your network:

**Only assign the network interface which belongs to the internal network to the internal zone of the firewall.**

## Further Information

* [Portal:Printing](/Portal%3APrinting "Portal:Printing")
* [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2")
* [Portal:Security](/Portal%3ASecurity "Portal:Security")

Retrieved from "<https://en.opensuse.org/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&oldid=192166>"

[Category](/Special%3ACategories "Special:Categories"):

* [SDB:Printing](/Category%3ASDB%3APrinting "Category:SDB:Printing")

This page was last edited on 9 December 2024, at 16:05. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 100,190 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

Â© 2001â€“2025 SUSE LLC, Â© 2005â€“2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_amd.png)](/Sponsors)

##### Log in

Ã—

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in



=== Content from bugzilla.suse.com_4ecfb756_20250115_140239.html ===


| Bugzilla â€“ Bug Access Denied |
| --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1108444)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

## Related documentation

* [Creating an account](https://bugzilla.readthedocs.org/en/5.0/administering/users.html#creating-new-users)

You are not authorized to access bug #1108444.
To see this bug, you must
first [log
in to an account](show_bug.cgi?id=1108444&GoAheadAndLogIn=1) with the appropriate permissions.

Please press **Back** and try again.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1108444)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from idp-portal.suse.com_6b95d262_20250115_225533.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from en.opensuse.org_48fd8fb4_20250115_140236.html ===


[![ðŸ¦Ž](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/SDB%3ACUPS_and_SANE_Firewall_settings "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/SDB%3ACUPS_and_SANE_Firewall_settings "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&oldid=192166 "Permanent link to this revision of the page")[Page information](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=info "More information about this page")

* In other languages
  [ä¸­æ–‡](http://zh.opensuse.org/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings â€“ ä¸­æ–‡")

* Log in

* [SDB](/SDB%3ACUPS_and_SANE_Firewall_settings)
* [Discussion](/index.php?title=SDB_Talk:CUPS_and_SANE_Firewall_settings&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/SDB%3ACUPS_and_SANE_Firewall_settings)
[View source](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&action=history "Past revisions of this page [h]")

# SDB:CUPS and SANE Firewall settings

Jump to: [navigation](#mw-head),
[search](#p-search)

This article is rather old and was written with only traditional IPv4 networking in mind.

With nowadays IPv6 networking certain things are rather different so what was true for traditional IPv4 networking could be no longer true for nowadays IPv6 networking.

## Contents

* [1 Situation](#Situation)
* [2 Security: Make Things Not Just Work](#Security:_Make_Things_Not_Just_Work)
* [3 General Information About openSUSE Firewalls](#General_Information_About_openSUSE_Firewalls)
* [4 Basic Information How the Firewall Works](#Basic_Information_How_the_Firewall_Works)
* [5 When Network Security is Likely to be Doomed](#When_Network_Security_is_Likely_to_be_Doomed)
* [6 Basic Network Security versus Phishing](#Basic_Network_Security_versus_Phishing)
* [7 What is Specific Regarding Firewall Setup for Printing](#What_is_Specific_Regarding_Firewall_Setup_for_Printing)
  + [7.1 It is crucial to limit access to CUPS to trusted users](#It_is_crucial_to_limit_access_to_CUPS_to_trusted_users)
  + [7.2 It is crucial to limit access to network printer devices to trusted users](#It_is_crucial_to_limit_access_to_network_printer_devices_to_trusted_users)
  + [7.3 It is crucial to not accept remote printing information from untrusted hosts](#It_is_crucial_to_not_accept_remote_printing_information_from_untrusted_hosts)
    - [7.3.1 Automated print queue setup via cups-browsed](#Automated_print_queue_setup_via_cups-browsed)
* [8 What is Specific Regarding Firewall Setup for Using Scanners](#What_is_Specific_Regarding_Firewall_Setup_for_Using_Scanners)
  + [8.1 Setup for firewalld](#Setup_for_firewalld)
* [9 Summary](#Summary)
* [10 Bottom Line](#Bottom_Line)
* [11 Further Information](#Further_Information)
## Situation

You like to use printers and scanners in your network and you like to have firewall protection against unwanted access.

Using printers and scanners via network is likely to happen in particular in home networks and small office networks. Therefore this article provides at first basic information regarding firewall and network security.

CUPS and SANE are systems for using and managing printers and scanners respectively.

CUPS is the acronym for Common Unix Printing System. For basic information how to set up CUPS see [SDB:CUPS in a Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") and [YaST\_Printer](/YaST_Printer "YaST Printer") and regarding CUPS server security see <http://www.cups.org/documentation.php/security.html>

SANE is the acronym for Scanner Access Now Easy.
It provides standardized access to scanner hardware (e.g. a flatbed scanner) and a SANE network daemon that allows remote clients to access scanners which are connected to the local host. For basic information how to set up SANE see [SDB:Configuring Scanners](/SDB%3AConfiguring_Scanners "SDB:Configuring Scanners") and regarding the SANE network daemon see <http://www.sane-project.org/man/saned.8.html>

**Both CUPS and SANE provide network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks.**

For openSUSE Leap 42.3 (and prior versions) [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2") was the default firewall iptables-based front-end with rules generated according to the /etc/sysconfig/SuSEfirewall2 configuration file.

For openSUSE Leap 15.0 onwards, [firewalld](/Firewalld "Firewalld") is the default firewall front-end (which still uses the Linux kernel's netfilter framework), and can be configured using the 'firewall-cmd' CLI interface or the graphical 'firewalld-config' utility.

In this article "the firewall" usually means the [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2") or [firewalld](/Firewalld "Firewalld").
Third party firewalls (e.g. a firewall in an Internet "router-box" device) may work quite differently.

## Security: Make Things Not Just Work

The intended purpose of [security measures](/openSUSE%3ASecurity_Features "openSUSE:Security Features") is to make things not "just work" which means [security](/Portal%3ASecurity "Portal:Security") causes some kind of annoyance for the user when things do not "just work" out of the box. If everything would "just work" by default, it would be totally insecure.

Things should only work for authorized users. To distinguish authorized users from others, a person who works with a computer must somehow authenticate to be an authorized user which usually happens via a password dialog. Alternatively physical location can be used to distinguish authorized users from others. For example a person who works directly locally at the computer can be automatically logged in as authorized user while in contrast a person who works from remote via network needs to authenticate via password dialog. Additionally the location in the network (i.e. the network environment) can be used to distinguish legitimate access via network from unwanted access. Basically the firewall allows access via network or rejects it by partitioning the network environment into so called "zones" that are used to distinguish legitimate access in one zone from unwanted access in another zone.

In this context [security](/Concepts_security "Concepts security") means that in particular access from remote via network must not "just work" by default. Any kind of desired access from remote via network must be explicitly allowed by an [authorized user](/SDB%3ALogin_as_root "SDB:Login as root").

## General Information About openSUSE Firewalls

For openSUSE Leap 42.3 (and prior), refer to the documentation of the SuSEfirewall2 package in the /usr/share/doc/packages/SuSEfirewall2/ directory and the comments in its configuration file /etc/sysconfig/SuSEfirewall2 and the online documentation about [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2").

For openSUSE Leap 15.0 onwards, the current documentation can be found online in the Security Guide on <https://doc.opensuse.org/>

## Basic Information How the Firewall Works

The firewall is used to protect your host against unwanted access via network.

To access your host via network, at least one server process must run on your host. Each kind of server process is accessible via a particular network port. For example a web server process (e.g. the Apache web server) is accessible via the HTTP port 80 and the CUPS print server process is accessible via the IPP port 631 and the Avahi DNS-SD server process is accessible via the mDNS port 5353.

If no server process is running on your host, your host is not accessible via network so that you do not need the firewall. Nevertheless to be on the safe side you should not switch off the firewall because it will protect your host against unwanted access via network when an unintended server process was started by accident.

**If one or more server processes are running on your host and you open their matching ports in the firewall, you remove any firewall protection from your host because you only need the firewall to protect running server processes against unwanted access via network.**

On the other hand for server processes which should be accessible you must open the matching ports in the firewall. This means that there cannot be firewall protection for those server processes which should be accessible via network. Server processes which are accessible via network must provide sufficient security on their own. This is the reason why you must apply security updates for server processes which are accessible via network plus security updates for all what is related to such server processes (in particular system libraries that are used by your server processes and things like that).

If your host is connected only to a trusted internal network where a dedicated firewall machine protects the whole internal network, you may switch off the firewall on your host.

For example assume you have a server machine where a web server for your web site runs. Additionally the CUPS server process runs because there is a printer connected which you need once in a while to print something directly on the server machine.

Of course any user should be able to view your home page and whatever else you provide via your web site from any location in the Internet.

But on the other hand nothing else on your server machine should be accessible by arbitrary users from the Internet. In particular arbitrary users out there should not waste your paper and print on your printer.

Therefore you let the firewall pass any network traffic to HTTP port 80 (i.e. port 80 is open in the firewall) to allow arbitrary users to access the web server.

On the other hand you let the firewall prevent any network access for any other port (i.e. all other ports are closed in the firewall) so that in particular the CUPS server is not accessible via network and as a consequence your printer is protected against unwanted access via network.

Plain opening and closing ports in the firewall is sufficient for such kind of simple "all or nothing" configuration (allow any network access to the web server but none at all to the CUPS server).

Now assume you have again a server machine with a running web server and a running CUPS server but now the locally connected printer should be accessible by the users of a trusted internal network.

A trusted network means that you trust all users who can access this network. A user who can connect a computer to a network (e.g. a laptop where the user can work as "root") can send and receive any network traffic. Such a user can eavesdrop on the network and he can also fake any server machine in the network (except additional network switch hardware with an appropriate setup limits the user's network access).

Plain opening and closing ports in the firewall is no longer sufficient because if the IPP port for CUPS would be opened without further restrictions in the firewall, also arbitrary users out there from the Internet could waste your paper by printing on your printer.

The crucial point to apply further restrictions in the firewall is to distinguish whether or not network traffic happens in your trusted internal network.

Therefore your trusted internal network traffic must be separated from the other non-trusted network traffic. The best way to get different kind of network traffic separated is when different networks are used. The simplest and most secure solution to maintain separated networks is when separated network hardware is used.

Therefore the network hardware for your trusted internal network should be separated from the network hardware for the rest. In this case you have usually two network interface cards in your server machine, one where your trusted internal network is connected and the other one for the Internet connection. Consequently your network configuration has two network interfaces named for example "eth0" and "eth1".

Finally assume you have again a server machine with a network interface for the Internet connection and a second network interface for your trusted internal network. On the server machine a web-server and a CUPS server are running and the locally connected printer should be accessible only by the trusted users of your internal network.

In this case you would first and foremost assign the network interface for the Internet connection to the external zone of the firewall and the network interface for the internal network to the internal zone of the firewall.

By default the firewall prevents any network access via the network interface which belongs to the external zone but it lets any network traffic pass via the network interface which belongs to the internal zone.

Access direction is crucial: The firewall prevents access of your host from the Internet but not the other way round. Therefore you can still access servers in the Internet from your host. In particular you can access all those web servers which run out there in the Internet with your browser program. For example you can access the web server which runs on www.opensuse.org to get the openSUSE home page from it or access a mail server web frontend to get your e-mail even when the firewall prevents access of your host from the Internet. Have in mind that this way all what you request from the Internet gets delivered to your system. The firewall does not protect you when you visit a malicious web server with your browser program which will get its malicious web pages, see in particular the Wikipedia article <http://en.wikipedia.org/wiki/Drive-by_download> about "Drive-by download" and the firewall does not protect you when you get for example malicious e-mails. Furthermore you can submit any data to all those servers which are accessible out there in the Internet. The firewall does not protect you when you submit private or confidential data to a wrong server, see in particular the Wikipedia article <http://en.wikipedia.org/wiki/Phishing> about "Phishing". If you cannot trust the network you must not type in your authentication credentials into arbitrary web interfaces which are "just accessible" for you. If you cannot trust the network you must not submit private or confidential data to arbitrary servers which are "just accessible" for you. If you cannot trust a network you must not release private or confidential data into the network - except you had set up in advance sufficient encryption and authentication to ensure that only your intended recipient can decode your data regardless that others in the network could have also received your encrypted data.

As a result you can still browse the Internet without restrictions but no server process on your server machine is accessible from the Internet while all your server processes are accessible from your internal network.

As a second step you open HTTP port 80 for the external zone in the firewall to allow arbitrary users to access your web server from any location in the Internet.

In the end the web server is accessible for anybody from anywhere (i.e. from the Internet and from the internal network) but the CUPS server is only accessible for users in the trusted internal network.

As another example assume you have a laptop which you use while travelling but also in trusted networks in the office and at home.

When the laptop has a single network interface card, trusted and non-trusted network traffic will mix up. Therefore you assign the network interface to the external firewall zone to protect the laptop against unwanted access via any network. Usually it does not make sense to have any server process running on the laptop because when the laptop is moved from one network to another network, the server process becomes suddenly unavailable in the one network but available in the other network which results an unpredictable behaviour for the users which use your server. But when no server process is running on the laptop, it is not accessible via network so that no firewall is needed. Nevertheless to be on the safe side you should not switch off the firewall because it will protect the laptop against unwanted access when whatever kind of server process was started by accident.

Assume you must run whatever server process on the laptop. Now you need to get trusted and non-trusted network traffic separated. You could use a wireless network interface card for all kind of untrusted network connections while travelling and an additional network interface card with a traditional wired network cable connection which you use only in the office and at home. You would assign the network interface for the wireless card (e.g. "wlan0") to the external firewall zone and the network interface for the office and at home (e.g. "eth0") to the internal firewall zone. This way it would be actually fool-proof to keep the laptop protected against unwanted access via network: As long as the connection to a trusted network exists (there is no firewall protection for the wired network because it belongs to the internal firewall zone) you cannot move the laptop into a non-trusted network environment. Before you can do this you must unplug the traditional wired network cable which instantly makes the laptop no longer accessible because the firewall protects the wireless network (because it belongs to the external firewall zone).

In this article a trusted network means that you trust all users who can access this network so that you can open particular ports for particular server processes in the firewall for this network.

From the firewall point of view there is no such thing as "partially trusted" for a particular network because one cannot "partially open" a port in the firewall. Either the port is open for a particular network or not. Accordingly either you trust all users to access a server process in a particular network or not.

Do not confuse what "trusted network" means here with a more general meaning of trust. You may have different networks where you let the users of each network access more or less sensitive server processes. For example a trusted internal network with access to an internal print server where also confidential documents are printed on an internal printer device versus a separated network for guests with access to a separated print server plus a separated printer device where guests can print their documents. In each of the two networks you trust all the users to access the same kind of server process but both networks do not have the same level of trust from a general point of view. The simplest and most secure solution to maintain security is also used here: Separated hardware. Separated networks with separated print sever machines plus separated printer devices. Why separated printer devices? You may Google for "network printer security risk" (and see below).

## When Network Security is Likely to be Doomed

The basic idea to increase likelihood that your network security is doomed is to mix up trusted and non-trusted network traffic in one same network environment.

Save money and use the same network hardware for trusted and non-trusted network traffic and as a consequence pay with an increased likelihood that your network security is doomed and pay with an increased effort to maintain your network security.

Use one same "router-box" device for both your trusted internal network
and the connection to the Internet.
In such a case the router-box device is the crucial point
(in particular the crucial point of possible failure) regarding network security.
Usually such router-box devices provide their own built-in firewall
(which may work totally different than the firewall used in openSUSE).
Carefully read the documentation for your particular router-box
how to set up its built-in firewall and which kind of protection it provides.
Often it supports separation of your internal network from the Internet
via private IPv4 addresses like 192.168.xxx.xxx
together with network address translation (NAT), also known as network masquerading.
If your router-box has a built-in firewall and supports private IPv4 addresses together with NAT
(and if there is no security flaw in the router-box),
your hosts are in a trusted internal IPv4 network where the router-box is
a dedicated firewall machine which protects your internal network.
With nowadays IPv6 networking things are rather different.
Usually each host gets a public IPv6 address
so the hosts are no longer separated from the Internet.
In this case the router-box built-in firewall (hopefully)
protects the hosts against unwanted access from the Internet.
To be more on the safe side additionally a firewall should be running on each host.

Another way to increase likelihood that your network security is doomed is to use wireless communication for your trusted internal network traffic. In this case arbitrary strangers within a certain proximity out of your building have physical access to the electromagnetic waves which belong to the network traffic of your trusted network. Those folks out there do have a particular kind of physical access to your internal network. Therefore your network security totally depends on the trustworthiness of the security protocol which is used for network traffic encryption like the insufficient and deprecated WEP (Wired Equivalent Privacy) and its successors like WPA (Wi-Fi Protected Access) and finally WPA2 also known as RSN (Robust Secure Network). As of this writing (January 2010), only WPA2/RSN is considered secure, provided there is no WPS (Wi-Fi Protected Setup) functionality enabled which is insecure (Google for "wpa2 wps crack"). But WPA2 may not work with some older wireless network cards. Meanwhile (September 2012) WPA2 might be no longer secure because it seems possible to figure out its NT hash. Additionally there are other non-standard successors of WEP which could be insecure. Carefully read the documentation for your wireless network devices how to set up network traffic encryption for each of them and keep yourself continuously up to date regarding security issues or do not use wireless communication for your trusted internal network traffic.

Of course the best way to increase likelihood that your network security is doomed is to do all your network traffic via one same wireless router-box device. In this case carefully read the documentation for your particular wireless router-box how to set up its built-in firewall and its network traffic encryption protocol. Furthermore you need to keep yourself continuously up to date regarding security issues with your particular wireless router-box and what you could do against such issues.

On the other hand this kind of network environment is common nowadays in particular for home networks and small office networks where unfortunately often inexperienced users must maintain their network security on their own.

Assume you have a wireless router-box device which provides the Internet access for a workstation at home to which a printer is connected. Additionally you have a laptop and it should be possible to use the printer from the laptop. The workstation and the laptop have only a wireless network interface card to access the router-box.

**Plain opening of a port for the external zone in the firewall destroys your network security because it removes any firewall protection for the service which is accessed via this port. When the CUPS print server process is the only server process which runs on the workstation, opening its IPP port 631 removes effectively any firewall protection from the workstation.**

Instead inspect your network configuration to find out if different network interfaces are used for the Internet connection and for your internal network. For example there might be a network interface like "dsl0", "ppp0" or "ippp0" for the Internet connection and another network interface like "eth0" or "wlan0" for the internal network. In this case assign the network interface for the Internet connection to the external zone of the firewall and the network interface for the internal network to the internal zone of the firewall.

If one same network interface like "eth0" or "wlan0" is used for the Internet connection and for the internal network you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic.

## Basic Network Security versus Phishing

The above described measures for basic network security do usually not help against phishing attacks, cf. "Phishing" at Wikipedia <https://en.wikipedia.org/wiki/Phishing>

The reason is that phishing attacks happen via intentionally open channels to receive data from "the outer world" like incoming e-mails or other messaging systems but also SMS on mobile phones and traditional phone calls.

Usually such channels are intentionally open by default for any sender because it is intended that one can receive e.g. e-mails, other messages, SMS, and phone calls from anyone from "the outer world" (e.g. so that an old friend who lives now in a foreign country could still contact one) but this means that one can also get arbitrary unwanted things from possibly malicious senders.

There are also intentionally open channels to receive computer specific data from remote. Usually those open channels are intended to receive announcements (broadcasts/multicasts) from remote servers about available services that those remote servers provide in the network. For example remote print queues are announced this way by remote print servers in the network traditionally via the so called "CUPS Browsing" and/or nowadays via DNS-SD, see "print job phishing" below.

## What is Specific Regarding Firewall Setup for Printing

The CUPS server process (the cupsd) is accessible via TCP via the IPP port 631 to accept print jobs.

Optionally there could be also the cups-browsed (belongs to 'cups-filters' which is not CUPS but a separated project) which is accessible by default via UDP via IPP port 631 to accept any incoming CUPS Browsing information about remote print queues from any remote host. Normally the cups-browsed.service should not be used because it is a generic security risk when a service accepts any (possibly malicious) incoming information from any remote host so only a proper firewall setup would protect your host.

By default the cupsd should be only accessible via the internal interface of the local host (lo) to accept print jobs. Therefore printing is usually only possible directly from the local host but not from any remote host via network. If the cupsd runs in its default mode, you do not need the firewall to protect the cupsd (and your printer if it is locally connected) against unwanted access. Nevertheless to be on the safe side you should not switch off the firewall because it will protect your CUPS server against unwanted access via network when the cupsd is not running in its default mode. For example for very old CUPS versions or for uncommonly built cups RPM packages the cupsd might be even generally accessible unless the firewall provides protection.

To protect your CUPS server against unwanted access:

**Do not open any IPP port 631 for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone, client hosts in the internal network can access the CUPS server process and submit print jobs. Independent of the firewall setup the CUPS server must additionally be configured to accept print jobs from those client hosts (which is not the default, see above).

To make your CUPS server accessible:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

### It is crucial to limit access to CUPS to trusted users

Printing documents lets the user access and contol the printer hardware because in the end the printer processes data which is basically a program that controls the printer machine.

Furthermore printing documents via CUPS lets the user access and contol various programs that run on the computer where CUPS runs (i.e. the CUPS server machine which can also be the local host).

Those programs process the print job data (e.g. a PostScript or PDF file) in various ways to produce in the end printer specific data that is finally sent to the printer device. That final printer specific data is the above mentioned program which controls the printer machine.

Those programs are the cupsd (which runs as 'root' on the CUPS server), various filtering programs (e.g. Ghostscript), arbitrary printer drivers, and various backends. The various programs that convert the initial print job data into printer specific data (the filtering programs) and send the result to the printer device (the backend) are usually run as user 'lp' on the CUPS server.

Those programs work with the data in various ways so that in the end all together lead to a zillion of ways how the data is processed (cf. "Background Information" at [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue") and "Processing stages of a print job" at [SDB:CUPS in a Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell")).

Furthermore certain kind of print job data (in particular PostScript but also PDF to some extent) is actually a program.

PostScript is a general purpose Turing-complete programming language (cf. <https://en.wikipedia.org/wiki/PostScript>) that supports in particular file access on the system disk. When Ghostscript processes PostScript it runs a PostScript program as the user who runs Ghostscript (usually the user 'lp', see above). Furthermore when Ghostscript processes PDF it also runs a PostScript program because the PDF interpreter, as supplied with Ghostscript before version 9.56, is written in PostScript where PDF features which have no equivalent in PostScript need to be implemented via special PostScript extensions that have proven to be a security problem. See <https://artifex.com/blog/changes-to-the-pdf-interpreter> that provides a lot of background information about Ghostscript's PDF interpreter and why it is replaced in Ghostscript version 9.56 by a new PDF interpreter that is written entirely in C. When Ghostscript processes an arbitrary PostScript or PDF file, the user who runs Ghostscript runs an arbitrary program which can do basically anything on the system where Ghostscript runs that this user is allowed to do on that system. To make it safer when Ghostscript runs a PostScript program the Ghostscript command line option '-dSAFER' disables certain file access functionality (for details see /usr/share/doc/ghostscript/\*/Use.htm). When printing documents Ghostscript is normally run with the '-dSAFER' option set. Its name 'SAFER' says everything: It makes it 'safer' to let Ghostscript run a PostScript program, but it cannot make things completely safe.

Users who are allowed to submit print jobs are allowed to upload arbitrary data and even certain kind of programs onto the CUPS server.

In theory all those programs that run on the CUPS server are safe against misuse.

In practice there is an endless sequence of various kind of security issues that appear every now and then in this or that particular program which get fixed issue by issue ad infinitum (and ad nauseam).

In the end all that means:

**Users who are allowed to submit print jobs to a CUPS server are allowed to upload arbitrary data onto the CUPS server and run arbitrary programs in arbitrary ways (usually as user 'lp') on the CUPS server and finally access and contol the printer hardware as they like.**

CUPS cannot be used in an environment where one does not know who the persons are that submit print jobs or where one cannot trust the persons that submit print jobs because there are too many possibilities for users who are allowed to submit print jobs to let "bad things" happen on the CUPS server.

Even if all those programs that run on the CUPS server were safe against misuse, any user who is allowed to submit print jobs could still do some kind of denial of service attack: Either by submitting many small useless print jobs or a few huge nonsense print jobs which waste toner/ink and paper or by submitting specific tiny PostScript or specially crafted PDF print jobs which let PostScript or PDF processing software (like Ghostscript) or a printer's built-in PostScript interpreter do basically endless time consuming processing or even hang up in an endless loop. The latter may result in loss of print jobs when subsequent print jobs of other users were already sent into the printer's memory while the tiny PostScript job is blocking the printer's actual printing unit endlessly. If the blocking job can only be aborted by a printer reset, the other jobs in its memory are usually lost. If you think things like printer accounting would be an easy way out here, have a look at [SDB:Printer Accounting](/SDB%3APrinter_Accounting "SDB:Printer Accounting") and you may get "some new kind of headache regarding printing setup".

In parctice the most feasible way out is to limit access to CUPS to trusted users plus the next items:

### It is crucial to limit access to network printer devices to trusted users

Usual network printer devices (printers with a built-in network interface, see [SDB:Printing via TCP/IP network](/SDB%3APrinting_via_TCP/IP_network "SDB:Printing via TCP/IP network")) are no longer only "dumb" printing units. Nowadays network printers are also real computers with full network capabilities. When it looks like a printer, acts like a printer, sounds like a printer, it could be a computer! A user who controls a network printer controls a printing unit plus a computer with network access. Therefore it is crucial to limit access to network printer devices to trusted users (Google for "network printer security risk" - see above). Those access restrictions must be set up in the network printer device itself. Read the documentation of your network printer device how to do that.

### It is crucial to not accept remote printing information from untrusted hosts

Traditionally (i.e. in CUPS up to version 1.5.4) by default the CUPS server process was accessible via UDP via IPP port 631 to accept incoming information about remote print queues from remote hosts. A CUPS print server could publish information about its queues in the network by sending UDP broadcasts and/or regular UDP (unicast) packets. Accordingly the CUPS server processes which run on the client hosts accepted by default incoming information about remote print queues via UDP via IPP port 631.

In this way, the queues of the server were available on the clients without any CUPS-specific configuration on the client hosts. Users on the clients could browse the queues on various servers. Therefore the whole stuff is called "CUPS Browsing". See the section "Intrinsic design of CUPS <= 1.5 for printing in the network" at [SDB:CUPS\_in\_a\_Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") and note the section "CUPS 1.6 has major incompatible changes" therein.

Nowadays (i.e. since CUPS >= 1.6) remote print queue annoucements and remote printer announcements happen via DNS-SD that is implemented by Avahi instead of and/or in addition to traditional "CUPS Browsing",
cf. "Zero-configuration networking" at Wikipedia <https://en.wikipedia.org/wiki/Zero-configuration_networking> and "Avahi" at Wikipedia [https://en.wikipedia.org/wiki/Avahi\_(software)](https://en.wikipedia.org/wiki/Avahi_%28software%29)

Because CUPS Browsing is dropped in CUPS since version 1.6 the package cups-filters provides the cups-browsed that provides basic CUPS Browsing functionality to maintain backward compatibility with traditional old CUPS Browsing but cups-browsed is a generic security risk, see above.

Regardless what is used for remote printing services announcements:

It is crucial to not accept remote printing information from untrusted hosts.

Otherwise possibly confidential print jobs could be sent to untrusted printers or print servers.

See the "print job phishing" thread on the "cups" mailing list from August 2007

<https://lists.cups.org/pipermail/cups/2007-August/thread.html>

that reads in particular:

```
When printing in the network is done via usual CUPS Browsing,
on the other workstations in the network all announced queues
with the same name build automatically a so called "implicite class"
so that a print job which is sent to the destination with this name
is printed on an arbitrary printer in this class.
...
A malicious user ... can set up queues ... with the same name
as queues on the official CUPS server and announce his queues
in the network.
...
on the other workstations their users cannot notice
that duplicated queues exist so that the malicious user
could do "print job phishing".

```

If you wonder why this behaviour is the default: It is because CUPS is designed for use in a trusted internal network where usability and convenience (no CUPS-specific configuration on client hosts - i.e. make printing "just work" versus above "Security: Make Things Not Just Work") is considered to outweigh the security risk in an external network where furthermore by default a firewall should provide protection. See the above "print job phishing" thread which contains the following explanation from the CUPS main author:

```
To summarize:
1. Once a malicious user gains access to a network,
   there are numerous ways to compromise that network.
2. CUPS browsing attacks are easy to detect.
3. Disabling key features of CUPS browsing does not offer
   any added security while making printing much less usable.
4. Adding a signing key for browse packets would
   make CUPS browsing more secure but would require
   active configuration of every system on the network
   to be effective.
5. Using alternate protocols and/or manual configuration
   of shared printers can offer improved security
   at the expense of usability/convenience.

```

By default the firewall prevents any access via network interfaces which belong to the external zone and by default all network interfaces belong to the external zone. Therefore by default the firewall rejects or drops any remote printing information from any host so that client hosts are protected against "print job phishing".

In general if you cannot trust the network you must not submit your private or confidential print jobs to arbitrary printers (i.e. to arbitrary print queues) which are "just accessible" for you.

For example assume you are traveling with your laptop and in your hotel lobby there is a printer for guests. Here you accept remote printing information because you trust that well known reputable "Grand Hotel". You need to print out your admission ticket for a non-public congress that you got right now during a perfectly secure registration via Internet. You submit your print job to the "grand\_hotel\_lobby\_printer" and - voila! - a few seconds later your admission ticket comes out of the printer at the hotel lobby information desk. What you do not know is that those friendly businessman next to you had sent you the "grand\_hotel\_lobby\_printer" print queue information from his laptop so that he got your admission ticket and then (after copying it) forwarded it to the actual printer share of the hotel lobby printer so that you won't notice the deception. Instead of using a print queue that was "just accessible", you had better asked the clerk at the hotel lobby information desk how to correctly access the printer. Now it is too late and nobody may notice the one more listener at that congress. Because it had "just worked" you don't wonder why you didn't have to pay for using a printer at a public accessible location or what (if not money) you actually paid for that printout or even think about "cui bono?" when "the intended purpose of security measures is to make things not just work" (see above).

To protect your host against "print job phishing":

**Do not accept DNS-SD information from untrusted (external) hosts.**

**Do not open any IPP port 631 for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone on the client hosts, remote print queues which are published by internal CUPS print servers will be available on the client hosts.

To make published remote print queues available:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

As example for an exceptional case assume you have a laptop which you use while traveling but also in trusted networks in the office and at home where you like to use announced print queues of a CUPS server in your internal home network.

When the laptop has only a single network interface, trusted and non-trusted network traffic is mixed up so that the network interface must be assigned to the external firewall zone to protect the laptop against unwanted access via any network.

In this case you cannot open any IPP port 631 for the external zone in the firewall because this removes the firewall protection from the laptop in any network.

You simply cannot use arbitrary information about remote print queues from arbitrary hosts when trusted and non-trusted network traffic is mixed up.

In particular you must not open the IPP port 631 for UDP for the external zone so that remote print queue information from untrusted (i.e. external) servers is rejected.

Assume printing from the laptop happens only in the office where no locally connected printer is used but only one single CUPS server of the company. Then it is no longer needed to run a CUPS server process on the laptop. Instead a so called "client-only" configuration could be set up, see [SDB:CUPS\_in\_a\_Nutshell](/SDB%3ACUPS_in_a_Nutshell "SDB:CUPS in a Nutshell") the section "Configuration of the clients", "Client-only configuration". A possible drawback is that application programs may be delayed for some time (until a timeout happens) when they try to access the CUPS server of the company in another network where it is actually not available (e.g. while traveling). Usually it is a host name resolution (DNS) timeout which causes the delay so that it may help to have a hardcoded entry for the CUPS server of the company in the /etc/hosts file.

You do not need to open any IPP port 631 in the firewall for a "client-only" configuration.

#### Automated print queue setup via cups-browsed

In general cups-browsed should not be used because it is a generic security risk, see above.

If the cups-browsed.service is started or enabled it does not only accept traditional old CUPS Browsing information from any remote host to make remote printers accessible on the local host.

Additionally it also does automated local print queue setup for remote printers that are announced via CUPS Browsing or via DNS-SD when needed e.g. for legacy PostScript/PCL printers that do not support CUPS driverless printing - i.e. for remote printers which require a local print queue with a printer model specific driver to be able to print on the remote printer from the local host.

If you wonder why there is an automated local setup for remote devices: It is because cups-browsed is designed for use in a trusted internal network where usability and convenience (no configuration on client hosts - i.e. make printing "just work" versus above "Security: Make Things Not Just Work") is considered to outweigh the security risk in an external network where furthermore by default a firewall should provide protection.

To do such an automated print queue setup printer model specific info is needed to be able to set up an appropriate printer model specific driver that makes correct looking printouts.

So cups-browsed queries the remote printer for printer model specific info but this results another generic security issue because a malicious fake remote printer can send malicious info to cups-browsed which results a malicious automated setup of the local print queue.

For an example how this can be misused to run commands (cf. above "printing documents via CUPS lets the user access and contol various programs that run on the computer where CUPS runs") see

<https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/>

Because cups-browsed queries the remote printer for printer model specific info a malicious fake remote printer can send arbitrary false info to cups-browsed which results that cups-browsed queries an arbitrary remote printer or an arbitrary remote host for printer model specific info.

For an example how this can be misused to do a DDoS attack see

<https://www.akamai.com/blog/security-research/october-cups-ddos-threat>

Both examples require that users or admins violate crucial conditions how printing services are meant to be used.

**Both cupsd and cups-browsed are network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks which means:**

**It is crucial to limit access to cupsd and cups-browsed to trusted users.**

**It is crucial to limit access to network printer devices to trusted users.**

**It is crucial to not accept remote printing information from untrusted hosts.**

In particular cups-browsed must not be used when cups-browsed could get possibly malicious info from a fake remote printer - i.e. when cups-browsed is not sufficiently restricted by a proper firewall setup to protect your host.

This also proves that it is crucial to not accept remote printing information from untrusted hosts.

## What is Specific Regarding Firewall Setup for Using Scanners

For using scanners via network the SANE network daemon (the saned) is the server process which must run so that remote clients can access scanners which are connected (usually via USB) to the local host.

When you have a network printer scanner copier all-in-one device with a built-in network interface so that the device is directy accessible via network, it is usually used in a different way by "stand-alone scanning to e-mail" where no SANE software (in particular no saned) is involved (see the section "Scanning via Network" in [SDB:Configuring Scanners](/SDB%3AConfiguring_Scanners "SDB:Configuring Scanners")).

The saned is used by the clients via two kind of network connections. In addition to a control connection (via port 6566) saned also uses a separated data connection (for the actual scanning data). The port of the data connection is selected by the operating system and could not be specified so that all ports above 1024 must have been accessible (i.e. open in the firewall) for connections from the clients. Recent saned versions provide support to specify a range of ports for the data connection in the saned configuration file /etc/sane.d/saned.conf via an entry like "data\_portrange = 30000 - 30100" so that only those ports would have to be open in the firewall. But the latter does not provide real better security because in the end the saned must be accessible for using scanners via network.

To protect your host against unwanted access:

**Do not open the sane-port 6566 or any other port regarding using scanners for the external zone in the firewall.**

On the other hand the firewall lets by default any network traffic pass via network interfaces which belong to the internal zone. Therefore when the network interface for the internal network is assigned to the internal firewall zone, client hosts in the internal network can access the SANE server process to access scanners which are connected to the server machine. Independent of the firewall setup the SANE server must additionally be configured to permit access from those client hosts (by default it does not permit access).

To make your SANE server accessible:

**Assign the network interface which belongs to the internal network to the internal zone of the firewall.**

### Setup for firewalld

With SuSEfirewall2 some best effort setup is possible when one same network interface is used for the Internet connection and for the internal network by assigning the network interface to the external zone and specifying FW\_TRUSTED\_NETS, FW\_SERVICES\_ACCEPT\_RELATED\_EXT, and FW\_LOAD\_MODULES appropriately which proves that when trusted and non-trusted network traffic is mixed up there is increased effort (i.e. a more complicated configuration that results a more fragile way of operation) and less network security (i.e. only a best effort attempt to get some kind of network security).

A similar best effort setup for Firewalld is possible for example like:

Create a "private" zone

```
firewall-cmd --permanent --new-zone=private
firewall-cmd --permanent --zone=private --add-source=192.168.0.0/24

```

on the SANE server and on the client.

Additionally on the server set

```
firewall-cmd --permanent --zone=private --add-service=sane

```

The sane helper loads a sane specific conntrack module which takes care of opening any required ports for transferring scanner data - no additional explicit opening of ports is necessary.

In general if possible you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic.

## Summary

By default the firewall prevents any network access via network interfaces which belong to the external zone but it lets any network traffic pass via network interfaces which belong to the internal zone.

Both CUPS and SANE provide network services that are designed for use in a trusted internal network and not intended to be exposed to the public Internet or to other non-trusted networks.

To use printers and scanners in a trusted internal network and have firewall protection against unwanted access from the Internet, set up the firewall as follows:

Do not open the CUPS IPP port 631 or the sane-port 6566 or any other port for the external zone.

If different network interfaces are used for the Internet connection and for the internal network, assign the network interface for the Internet connection to the external zone and the network interface for the internal network to the internal zone.

When one same network interface is used for the Internet connection and for the internal network you may better change your network hardware so that your trusted internal network traffic becomes well separated from the non-trusted network traffic or have a dedicated firewall machine which protects your whole internal network.

## Bottom Line

To use printers and scanners in a trusted internal network and be protected by the firewall against unwanted access from the Internet, do first and foremost this one single fundamental setup to gain security plus convenience in your network:

**Only assign the network interface which belongs to the internal network to the internal zone of the firewall.**

## Further Information

* [Portal:Printing](/Portal%3APrinting "Portal:Printing")
* [SuSEfirewall2](/SuSEfirewall2 "SuSEfirewall2")
* [Portal:Security](/Portal%3ASecurity "Portal:Security")

Retrieved from "<https://en.opensuse.org/index.php?title=SDB:CUPS_and_SANE_Firewall_settings&oldid=192166>"

[Category](/Special%3ACategories "Special:Categories"):

* [SDB:Printing](/Category%3ASDB%3APrinting "Category:SDB:Printing")

This page was last edited on 9 December 2024, at 16:05. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 100,190 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

Â© 2001â€“2025 SUSE LLC, Â© 2005â€“2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_heinlein.png)](/Sponsors)

##### Log in

Ã—

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in



=== Content from bugzilla.redhat.com_1fd59eba_20250115_225533.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1949119)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1949119)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1949119)+ Login using a Red Hat Bugzilla account
  + ForgotÂ Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla â€“ BugÂ 1949119

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**BugÂ 1949119**](show_bug.cgi?id=1949119)
(CVE-2021-25317)
- [CVE-2021-25317](https://access.redhat.com/security/cve/CVE-2021-25317) cups: insecure permissions of /var/log/cups allows for symlink attacks

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-25317 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1950903](show_bug.cgi?id=1950903) [1950124](show_bug.cgi?id=1950124) [1950125](show_bug.cgi?id=1950125) [1955090](show_bug.cgi?id=1955090 "CLOSED ERRATA - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attacks [fedora-all]") [1955091](show_bug.cgi?id=1955091) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1947565](show_bug.cgi?id=1947565) | | TreeView+ | [depends on](buglist.cgi?bug_id=1949119&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1949119&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-04-13 13:18 UTC by Guilherme de Almeida Suckevicz | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-10-07 12:59 UTC ([History](show_activity.cgi?id=1949119)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  mdogra security-response-team twaugh zdohnal | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | It was found that some Linux vendors may assign the ownership of the /var/log/cups directory to the `lp` user. This could allow an attacker with such privileges to create empty files in arbitrary locations, or to force arbitrary files to be opened and closed, using a symlink attack. This has a low impact on the integrity of the system. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-11-15 13:09:58 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1949119#c0)  Guilherme de Almeida Suckevicz    2021-04-13 13:18:12 UTC  ``` A flaw was found in the way some Linux Operating Systems install cups.  If the default permissions of /var/log/cups allows the 'lp' user to write new files and that the cups daemon runs with root permissions, an attacker with access to the 'lp' user could use this flaw carry on a symlink attack. However, because cupsd verifies wether the path is a symlink after opening it, the flaw can be used only to create empty files in arbitrary locations, or to force open()/close() system calls on arbitrary locations.  Because the code will correct the /var/log/cups permissions after the fail, the attacker can carry this attack only once.  # ps -FC cupsd                                                                                                                           UID        PID  PPID  C    SZ   RSS PSR STIME TTY          TIME CMD                                                                                           root     18686     1  0 86575  9900   0 07:55 ?        00:00:00 /usr/sbin/cupsd -l                                                                                                                                        # ls -ld /var/log/cups/                                                                                                                  drwxr-xr-x. 2 lp sys 68 Apr 14 07:39 /var/log/cups/   ```  [Comment 3](show_bug.cgi?id=1949119#c3)  Cedric Buissart    2021-04-20 15:27:00 UTC  ``` Acknowledgments:  Name: Matthias Gerstner   ```  [Comment 4](show_bug.cgi?id=1949119#c4)  Cedric Buissart    2021-04-27 06:36:53 UTC  ``` Statement:  This issue does not affect the upstream CUPS, only the CUPS versions as packaged by some OS vendors.   ```  [Comment 5](show_bug.cgi?id=1949119#c5)  Cedric Buissart    2021-04-29 12:22:23 UTC  ``` Created cups tracking bugs for this issue:  Affects: fedora-all [[bug 1955090](show_bug.cgi?id=1955090 "CLOSED ERRATA - CVE-2021-25317 cups: insecure permissions of /var/log/cups allows for symlink attacks [fedora-all]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1949119&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.suse.com_2a183599_20250115_102110.html ===


| Bugzilla â€“ BugÂ 1184161 | VUL-0: CVE-2021-25317: cups: ownership of /var/log/cups could allow privilege escalation from lp user to root via symlink attacks | Last modified: 2024-05-23 15:31:16 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1184161)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**BugÂ 1184161**](show_bug.cgi?id=1184161)
(CVE-2021-25317)
- VUL-0: CVE-2021-25317: cups: ownership of /var/log/cups could allow privilege escalation from lp user to root via symlink attacks

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2021-25317: cups: ownership of /var/log/cups could allow privilege...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-25317 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/280706/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2021-25317:5.3:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2021-03-30 11:32 UTC by Matthias Gerstner | | --- | --- | | Modified: | 2024-05-23 15:31 UTC ([History](show_activity.cgi?id=1184161)) | | CC List: | 7 users (show)  atoptsoglou gianluca.gabrielli jsegitz jsmeix martin.wilck matthias.gerstner security-team | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1184161) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1184161&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1184161&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1184161#c0)  Matthias Gerstner   2021-03-30 11:32:56 UTC  ``` I noticed that on Tumbleweed (and probably all other maintained cups codestreams) the /var/log/cups directory is packaged as follows:  drwxr-xr-x 2 lp lp 4096 24. MÃ¤r 16:47 /var/log/cups/  This means the 'lp' user can perform arbitrary writes in this directory. The cups daemon is running as root, however, potentially creating log files in this directory.  A simple reproducer is as follows:  ``` root# sudo -u lp /bin/bash lp$ cd /var/log/cups lp$ rm -f * lp$ for log in error access page; do ln -s /root/${log}_log; done lp$ exit root# cupsctl --debug-logging ```  Interestingly, as a side effect of enabling cups logging, the ownership of /var/log/cups is changed. After the reproducer we get:  drwxr-xr-x 2 root lp 4.0K 30. MÃ¤r 13:27 /var/log/cups/  The reason for this is cups itself in scheduler/log.c with the following invocation:  ``` cupsdCheckPermissions(CUPS_LOGDIR, NULL, log_dir_perm, RunUser, Group, 1, -1); ```  This function makes sure that the log directory is owned by the RunUser and Group that cups is configured for. This can be too late already, however. Also after package updates of cups-config the original packaging permissions are reinstated.  Other distributions like Arch, Debian and Gentoo package /var/log/cups with root:root ownership. Only Fedora suffers from the same issue as we do. So we might need to report this to them as well, although they should be protected by their SELinux configuration. ``` [Comment 3](show_bug.cgi?id=1184161#c3)  Matthias Gerstner   2021-03-31 08:31:38 UTC  ``` (In reply to jsmeix@suse.com from [comment #1](show_bug.cgi?id=1184161#c1)) > I am a noob with symlink attacks. > Could you provide a complete reproducer that actually does something > what only root can do after privilege escalation from lp to root > e.g. how lp could do "head -n1 /etc/shadow" or something like that.  The reproducer in [comment 0](show_bug.cgi?id=1184161#c0) should lead to empty files being created like /root/error_log. If not very familiar with when e.g. the access_log is filled with something by cupsd, this would probably the most interesting vector, more kind of a denial-of-service by writing garbage to system files.  Since cups has a locally accessible web interface a local attacker could also influence the content of log files in some ways, so some sort of privilege escalation could also become possible.  It is not super serious but we should fix it anyway.  > permissions are set there as is. > I guess there is (or was?) some special reason for it > because otherwise no special permissions would be set.  Probably rather "was". The security issue is only with the write permission for the lp user. So if there is no process running as 'lp' that needs to write there then there should be no issue. Since all other distributions except Fedora don't package with lp write permissions and since cupsd *itself* is "fixing" these permissions for /var/log/cups during runtime I don't think there is a big risk for breaking anything.  > ----------------------------------------------------------- > # osc cat DISCONTINUED:openSUSE:10.3:Update cups cups.spec > ... > %files libs > %defattr(-,root,root) > %{_bindir}/cups-config > #%dir %attr(0755,lp,lp) %{_sysconfdir}/cups/ > %dir %attr(0710,lp,lp) %{_var}/spool/cups > %dir %attr(1770,lp,lp) %{_var}/spool/cups/tmp > %dir %attr(0755,lp,lp) %{_var}/log/cups/ > -----------------------------------------------------------  The write permission for lop for /spool/cups and /etc/cups is no longer there, which is good. Only for /var/log/cups and for the /var/spool/cups/tmp sticky bit directory. Hopefully cupsd does not create fixed paths in the latter, but at least symlink protection from the kernel would be kicking in here, because it is world-writable.  > I will contact the Red Hat CUPS maintainer via personal mail. > Perhaps he knows more about the reason for such kind of > special permission settings. >  > If needed we can also contact the CUPS author via personal mail > to find out what the nowadays right way is.  Yes thanks for investigating. ``` [Comment 4](show_bug.cgi?id=1184161#c4)  Johannes Meixner   2021-04-07 10:20:23 UTC  ``` Some tests with latest CUPS 2.3.3 from OBS Printing project:  I tested normal printing with  # rm -r /var/log/cups # mkdir /var/log/cups # ls -ld /var/log/cups drwxr-xr-x 2 root root 4096 Apr  7 11:40 /var/log/cups  and for me it still works well - in particular the usual log messages from filters and backends appear in /var/log/cups/error_log as expected because filters and backends should write log messages to the inherited stderr file descriptor and not try to append them directly to /var/log/cups/error_log (via fopen on their own).  How cupsd itself creates /var/log/cups  # rm -r /var/log/cups # systemctl start cups.service # ls -ld /var/log/cups drwxr-xr-x 2 root lp 4096 Apr  7 11:57 /var/log/cups  I think it is best to package /var/log/cups in the RPM with same owner:group and permissions as cupsd creates it.  I don't know the reason why cupsd sets group 'lp' (cf. above plain printing also works for me with group 'root') but I guess there is a reason why the configure --with-cups-group=lp setting is used there i.e. why group 'lp' needs read permissions.  We configure cups with (excerpts): --with-cups-user=lp --with-cups-group=lp --with-system-groups=root cf. our whole RPM cups.spec file at <https://build.opensuse.org/package/view_file/Printing/cups/cups.spec?expand=1> ``` [Comment 5](show_bug.cgi?id=1184161#c5)  Matthias Gerstner   2021-04-07 12:20:46 UTC  ``` Yes, using the permissions that cupsd sets makes the most sense, since it overrides them anyway sooner or later during runtime. Giving the lp group read access there seems reasonable to me.  Please backport this change also for maintained cups codestreams. I will see to it that a SUSE-CVE is assigned for this issue. ``` [Comment 6](show_bug.cgi?id=1184161#c6)  Johannes Segitz   2021-04-07 14:07:39 UTC  ``` Please use CVE-2021-25317 to track this ``` [Comment 7](show_bug.cgi?id=1184161#c7)  Johannes Meixner   2021-04-08 10:54:14 UTC  ``` How cupsd in latest CUPS 2.3.3 from OBS Printing project creates directories:  drwxr-xr-x 2 root lp ... /etc/cups/ppd drwx--x--- 3 root lp ... /var/spool/cups drwxrwx--T 2 root lp ... /var/spool/cups/tmp drwxr-xr-x 2 root lp ... /var/log/cups drwxrwx--- 3 root lp ... /var/cache/cups  How we create those directories in our RPM cups.spec file:  %dir %attr(755,root,lp) %{_sysconfdir}/cups/ppd %dir %attr(0710,root,lp) %{_var}/spool/cups %dir %attr(1770,root,lp) %{_var}/spool/cups/tmp %dir %attr(0755,lp,lp) %{_var}/log/cups/ %dir %attr(0775,lp,lp) %{_var}/cache/cups  which results  drwxr-xr-x 2 root lp ... /etc/cups/ppd drwx--x--- 3 root lp ... /var/spool/cups drwxrwx--T 2 root lp ... /var/spool/cups/tmp drwxr-xr-x 2 lp lp   ... /var/log/cups drwxrwxr-x 2 lp lp   ... /var/cache/cups  so /var/log/cups and /var/cache/cups need to be adjusted according to how cupsd creates them.    Regarding other directories that we create with special owner group and permission settings in our cups.spec file:  %dir %attr(700,root,lp) %{_sysconfdir}/cups/ssl %dir %attr(0775,root,ntadmin) %{_datadir}/cups/drivers %dir %attr(0755,root,lp) /etc/cups  Those directories are not created by cupsd.   Regarding /etc/cups  cupsd cannot start if there is no /etc/cups because cupsd needs a /etc/cups/cupsd.conf file and without it cupsd aborts with ------------------------------------------------------------------- # journalctl -xe  ... linux-h9wr cupsd[8150]:  Unable to open "/etc/cups/cupsd.conf" - No such file or directory ... linux-h9wr systemd[1]: cups.service:  Main process exited, code=exited, status=1/FAILURE ... linux-h9wr systemd[1]: Failed to start CUPS Scheduler. -------------------------------------------------------------------  I think  drwxr-xr-x 6 root lp ... /etc/cups  is OK.   Regarding /usr/share/cups/drivers  I don't know the reason for the 'ntadmin' group (at least there is such a group in /etc/group) so I hope  drwxrwxr-x 2 root ntadmin ... /usr/share/cups/drivers  is OK.   Regarding /etc/cups/ssl:  When it is missing ------------------------------------------------------------ # lpstat -E -p lpstat: Bad file descriptor ------------------------------------------------------------ so we need to create it.  For me it works as follows (cf. [https://bugzilla.suse.com/show_bug.cgi?id=1108444#c2](show_bug.cgi?id=1108444#c2 "RESOLVED NORESPONSE")) ------------------------------------------------------------ linux-h9wr:~ # mkdir -m 700 /etc/cups/ssl  linux-h9wr:~ # lpstat -E -p printer ps is idle.  enabled since Mon Mar 29 12:35:42 2021  linux-h9wr:~ # ls -ld /etc/cups/ssl drwx------ 2 root root ... /etc/cups/ssl  linux-h9wr:~ # ls -l /etc/cups/ssl/* -rw-r--r-- 1 root root ... /etc/cups/ssl/linux-h9wr.crt -rw-r--r-- 1 root root ... /etc/cups/ssl/linux-h9wr.key ------------------------------------------------------------  In contrast we create it in our RPM as  drwx------ 2 root lp ... /etc/cups/ssl  with files in it like  -rw-r--r-- 1 root root ... /etc/cups/ssl/linux-h9wr.crt -rw-r--r-- 1 root root ... /etc/cups/ssl/linux-h9wr.key  I think it does not make sense to create a directory with group 'lp' but without any group permissions so I think we should create /etc/cups/ssl as  %dir %attr(700,root,root) %{_sysconfdir}/cups/ssl ``` [Comment 8](show_bug.cgi?id=1184161#c8)  Matthias Gerstner   2021-04-08 10:55:32 UTC  ``` We now involved RedHat who also has the same issue in their packaging. We are currently negotiating a publication date for the finding. They seem to like a later date for this (latest date according to our policy is 2021-06-28).  Please don't leak any information about this into OBS (including Factory) until the to-be-established publication date is reached. For IBS this means that updates can be submitted and processed but cannot be released before the publication date is reached.  In updates please add the CVE number found in the bug summary to the changes file for reference. ``` [Comment 9](show_bug.cgi?id=1184161#c9)  Johannes Meixner   2021-04-12 08:26:04 UTC  ``` How things are on SLE15 with CUPS 2.2.7:  How we create directories via RPM:  drwxr-xr-x 2 root lp 4096 Apr  6  2020 /etc/cups/ppd drwxrwxr-x 2 lp   lp 4096 Apr  6  2020 /var/cache/cups drwxr-xr-x 2 lp   lp 4096 Apr  6  2020 /var/log/cups drwx--x--- 3 root lp 4096 Feb 24 11:51 /var/spool/cups drwxrwx--T 2 root lp 4096 Apr  6  2020 /var/spool/cups/tmp  drwx------ 2 root lp 4096 Apr  6  2020 /etc/cups/ssl/  How cupsd creates them:  drwxr-xr-x 2 root lp 4096 Apr 12 10:16 /etc/cups/ppd drwxrwx--- 3 root lp 4096 Apr 12 10:17 /var/cache/cups drwxr-xr-x 2 root lp 4096 Apr 12 10:17 /var/log/cups drwx--x--- 3 root lp 4096 Apr 12 10:16 /var/spool/cups drwxrwx--T 2 root lp 4096 Apr 12 10:16 /var/spool/cups/tmp  # lpstat -E -p also works on SLE15 with CUPS 2.2.7 with drwx------ 2 root root 4096 Apr 12 10:22 /etc/cups/ssl ``` [Comment 12](show_bug.cgi?id=1184161#c12)  Johannes Meixner   2021-04-12 11:29:46 UTC  ``` How things are on SLE12 with CUPS 1.7.5:  How we create directories via RPM:  drwxr-xr-x 2 root lp 4096 Feb 27  2019 /etc/cups/ppd drwx--x--- 3 root lp 4096 Feb 25 10:10 /var/spool/cups drwxrwx--T 2 root lp 4096 Feb 27  2019 /var/spool/cups/tmp drwxr-xr-x 2 lp lp 4096 Feb 27  2019 /var/log/cups drwxrwxr-x 2 lp lp 4096 Feb 27  2019 /var/cache/cups  drwx------ 2 root lp 4096 Feb 27  2019 /etc/cups/ssl  How cupsd creates them:  drwxr-xr-x 2 root lp 4096 Apr 12 13:22 /etc/cups/ppd drwx--x--- 3 root lp 4096 Apr 12 13:22 /var/spool/cups drwxrwx--T 2 root lp 4096 Apr 12 13:22 /var/spool/cups/tmp drwxr-xr-x 2 root lp 4096 Apr 12 13:21 /var/log/cups drwxrwxr-x 3 root lp 4096 Apr 12 13:22 /var/cache/cups  # lpstat -E -p also works on SLE12 with CUPS 1.7.5 with  # mkdir -m 700 /etc/cups/ssl drwx------ 2 root root 4096 Apr 12 13:22 /etc/cups/ssl  where cupsd creates files in /etc/cups/ssl like -rw------- 1 root lp 1241 Apr 12 13:22 server.crt -rw------- 1 root lp 1704 Apr 12 13:22 server.key ``` [Comment 16](show_bug.cgi?id=1184161#c16)  Johannes Meixner   2021-04-13 06:55:38 UTC  ``` How things are on SLE11 with CUPS 1.3.9:  How we create directories via RPM:  drwxr-xr-x 2 root lp 4096 May 27  2015 /etc/cups/ppd drwx--x--- 3 root lp 4096 Jun  9  2020 /var/spool/cups drwxrwx--T 2 root lp 4096 May 27  2015 /var/spool/cups/tmp drwxr-xr-x 2 lp lp 4096 May 27  2015 /var/log/cups drwxrwxr-x 2 lp lp 4096 May 27  2015 /var/cache/cups  drwx------ 2 root lp 4096 May 27  2015 /etc/cups/ssl  How cupsd creates them:  drwxr-xr-x 2 root lp 4096 Apr 13 08:46 /etc/cups/ppd drwx--x--- 3 root lp 4096 Apr 13 08:46 /var/spool/cups drwxrwx--T 2 root lp 4096 Apr 13 08:46 /var/spool/cups/tmp drwxr-xr-x 2 root lp 4096 Apr 13 08:46 /var/log/cups  cupsd does not create /var/cache/cups  # lpstat -E -p also works on SLE11 with CUPS 1.3.9 with  # mkdir -m 700 /etc/cups/ssl drwx------ 2 root root 4096 Apr 13 08:48 /etc/cups/ssl  where cupsd creates files in /etc/cups/ssl like -rw------- 1 root lp 1013 Apr 13 08:48 server.crt -rw------- 1 root lp  887 Apr 13 08:48 server.key ``` [Comment 17](show_bug.cgi?id=1184161#c17)  Johannes Meixner   2021-04-13 07:21:38 UTC  ``` On SLE11 with CUPS 1.3.9 cupsd does not create /var/cache/cups but it creates /etc/cups/yes instead  drwxrwxr-x 3 root lp 4096 Apr 13 09:05 /etc/cups/yes  because on SLE11 cups.spec contains  configure ... --with-cachedir  instead of what we have in SLE12 and later  configure ... --with-cachedir=/var/cache/cups  cf. in cups.changes ------------------------------------------------------------------- Wed Jan 27 14:43:37 CET 2010 - jsmeix@suse.de ... - Added the explicite path to '--with-cachedir=/var/cache/cups'   in cups.spec to avoid that the fallback value 'yes' results   the cache directory '/etc/cups/yes/'. -------------------------------------------------------------------  Because this issue here is not about /var/cache/cups and because the right owner group and permissions are set  by cupsd for /etc/cups/yes and it works this way in SLE11 I will not introduce a not needed change here for SLE11. ``` [Comment 20](show_bug.cgi?id=1184161#c20)  Johannes Meixner   2021-04-13 11:25:32 UTC  ``` How things are on SLE10 with CUPS 1.1.23:  How the directories are after SL10-SP4 installation (in SLE10 cupsd gets started by default so cupsd  is already running after SL10-SP4 installation):  drwxr-xr-x 2 lp lp 48 2010-11-09 11:14 /etc/cups/ppd drwx--x--- 3 lp lp 72 2021-04-13 12:39 /var/spool/cups drwxrwx--T 2 lp lp 48 2010-11-09 11:14 /var/spool/cups/tmp drwxr-xr-x 2 lp lp 80 2021-04-13 12:45 /var/log/cups drwx------ 2 lp lp 48 2010-11-09 11:14 /etc/cups/ssl  /var/cache/cups: No such file or directory /etc/cups/yes: No such file or directory  Neither the CUPS 1.1.23 sources contain any 'cache.*dir' nor does the SLE10 cups.spec file contain 'cache' so /var/cache/cups (or /etc/cups/yes) do not matter.  cupsd does not create any of the other directories and things fail if those directories are missing like  # lpadmin -p testy -v file:///dev/null \  -P /usr/share/cups/model/Postscript.ppd.gz -E lpadmin: Unable to create temporary file: No such file or directory  and after creating a 'testy' queue  # echo hello | lp -d testy lp: unable to create temporary file "/var/spool/cups/tmp/60757b13d6839"  - No such file or directory  Furthermore in SLE10 cupsd runs as user 'lp'  # ps auxw USER  PID %CPU %MEM   VSZ  RSS TTY STAT START TIME COMMAND lp   9507  0.0  0.4 24508 4652 ?   Ss   12:49 0:00 /usr/sbin/cupsd  according to /etc/cups/cupsd.conf  User lp Group lp RunAsUser Yes  So owner group lp:lp of those directories look right on SLE10.  Cf. [https://en.opensuse.org/SDB:CUPS_in_a_Nutshell](https://en.opensuse.org/SDB%3ACUPS_in_a_Nutshell) that reads (excerpts): ---------------------------------------------------------------- Configuration of the print queues on a CUPS <= 1.5 server  ...  Up to SUSE LINUX 10.1 we provided CUPS 1.1 and since openSUSE 10.2 we provide CUPS 1.2 which is not fully backward compatible with CUPS 1.1.  Therefore in case of an update it is recommended not to use an outdated cupsd.conf from a CUPS 1.1 installation before but to start from scratch with the original cupsd.conf from our CUPS 1.2 (or later) RPM.  For example RunAsUser is no longer supported so that since openSUSE 10.2 / CUPS 1.2 the cupsd runs as root and therefore we are back to its default "basic authentication" via system users and system passwords (in /etc/shadow) so that it works again to authenticate as "root" and use the usual root system password.  ----------------------------------------------------------------  I will not change how cupsd runs on SLE10 and accordingly I will not introduce changes of those directories for SLE10. ``` [Comment 21](show_bug.cgi?id=1184161#c21)  Alexandros Toptsoglou   2021-04-13 11:34:39 UTC  ``` SLE10 is EOL ``` [Comment 27](show_bug.cgi?id=1184161#c27)  Matthias Gerstner   2021-04-15 10:32:26 UTC  ``` So RedHat security pointed out the following constraint which changes the assessment of the issue (excerpt from mail exchange):  > > cupsdCheckLogFile() calls cupsFileOpen(), which calls cups_open(). > > [these functions are defined in file.c and log.c] > > Â  > > cups_open() verify that the file is not a symlink, via lstat (see the > > code below), and sets `errno` to EPERM :  indeed I did not catch that. This changes the assessment of the issue. The check is only made after the fact, however. So while no content will be written to the target file it will still be created for root:root with mode 0644.  So this could influence other components in the system that are looking for state files like /etc/setuid-debug. Or it could be used to pre-create configuration files that normally should be readable only by root. Another issue could be a denial-of-service attack against cupsd itself by pointing the symlink to some device file that blocks during open(). Furthermore kernel logic could be triggered that normally cannot be triggered by non-root users, by opening arbitrary device files, proc files or sysfs files etc. ``` [Comment 29](show_bug.cgi?id=1184161#c29)  Johannes Meixner   2021-04-15 11:58:27 UTC  ``` Therefore my RPM changelog text is intentionally somewhat vague about what the actual security issue is ("could lead to"): ------------------------------------------------------------------- - When cupsd creates directories with specific owner group   and permissions (usually owner is 'root' and group matches   "configure --with-cups-group=lp") specify same owner group and   permissions in the RPM spec file to ensure those directories   are installed by RPM with the right settings because if those   directories were installed by RPM with different settings then   cupsd would use them as is and not adjust its specific owner   group and permissions which could lead to privilege escalation   from 'lp' user to 'root' via symlink attacks e.g. if owner is   falsely 'lp' instead of 'root' CVE-2021-25317 ([bsc#1184161](http://bugzilla.suse.com/show_bug.cgi?id=1184161)) -------------------------------------------------------------------  My personal main intent behind the fix is to clean up or old mess in our cups.spec file how we let rpm create those directories versus how cupsd itself creates those directories.  A security issue like privilege escalation of the 'lp' user is of secondary importance for me here because noone must ever let arbitrary (untrusted) users access his cupsd, cf. "It is crucial to limit access to CUPS to trusted users" in [https://en.opensuse.org/SDB:CUPS_and_SANE_Firewall_settings](https://en.opensuse.org/SDB%3ACUPS_and_SANE_Firewall_settings) ``` [Comment 30](show_bug.cgi?id=1184161#c30)  Martin Wilck   2021-04-15 15:23:08 UTC  ``` (In reply to Johannes Meixner from [comment #29](show_bug.cgi?id=1184161#c29))  > A security issue like privilege escalation of the 'lp' user > is of secondary importance for me here because noone must > ever let arbitrary (untrusted) users access his cupsd, cf. > "It is crucial to limit access to CUPS to trusted users" in > [https://en.opensuse.org/SDB:CUPS_and_SANE_Firewall_settings](https://en.opensuse.org/SDB%3ACUPS_and_SANE_Firewall_settings)  Fair enough, but was the concern abuse of cups via it's own network sockets? I had imagined someone obtaining shell access because of an entirely unrelated vulnerability (e.g. in a web server). This person could then run print jobs locally and possibly exploit the privilege escalation. ``` [Comment 35](show_bug.cgi?id=1184161#c35)  Swamp Workflow Management   2021-04-30 10:22:23 UTC  ``` SUSE-SU-2021:1453-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1184161 CVE References: CVE-2021-25317 JIRA References:  Sources used: SUSE OpenStack Cloud Crowbar 9 (src):    cups-1.7.5-20.36.1 SUSE OpenStack Cloud Crowbar 8 (src):    cups-1.7.5-20.36.1 SUSE OpenStack Cloud 9 (src):    cups-1.7.5-20.36.1 SUSE OpenStack Cloud 8 (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Software Development Kit 12-SP5 (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server for SAP 12-SP4 (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server for SAP 12-SP3 (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP5 (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP4-LTSS (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP3-LTSS (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP3-BCL (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP2-LTSS-SAP (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP2-LTSS-ERICSSON (src):    cups-1.7.5-20.36.1 SUSE Linux Enterprise Server 12-SP2-BCL (src):    cups-1.7.5-20.36.1 HPE Helion Openstack 8 (src):    cups-1.7.5-20.36.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 36](show_bug.cgi?id=1184161#c36)  Swamp Workflow Management   2021-04-30 10:23:33 UTC  ``` SUSE-SU-2021:14712-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1184161 CVE References: CVE-2021-25317 JIRA References:  Sources used: SUSE Linux Enterprise Server 11-SP4-LTSS (src):    cups-1.3.9-8.46.56.18.1 SUSE Linux Enterprise Point of Sale 11-SP3 (src):    cups-1.3.9-8.46.56.18.1 SUSE Linux Enterprise Debuginfo 11-SP4 (src):    cups-1.3.9-8.46.56.18.1 SUSE Linux Enterprise Debuginfo 11-SP3 (src):    cups-1.3.9-8.46.56.18.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 37](show_bug.cgi?id=1184161#c37)  Swamp Workflow Management   2021-04-30 10:24:58 UTC  ``` SUSE-SU-2021:1454-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1184161 CVE References: CVE-2021-25317 JIRA References:  Sources used: SUSE Manager Server 4.0 (src):    cups-2.2.7-3.26.1 SUSE Manager Retail Branch Server 4.0 (src):    cups-2.2.7-3.26.1 SUSE Manager Proxy 4.0 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Server for SAP 15-SP1 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Server for SAP 15 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Server 15-SP1-LTSS (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Server 15-SP1-BCL (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Server 15-LTSS (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Module for Development Tools 15-SP3 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Module for Development Tools 15-SP2 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Module for Basesystem 15-SP3 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise Module for Basesystem 15-SP2 (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise High Performance Computing 15-SP1-LTSS (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise High Performance Computing 15-SP1-ESPOS (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise High Performance Computing 15-LTSS (src):    cups-2.2.7-3.26.1 SUSE Linux Enterprise High Performance Computing 15-ESPOS (src):    cups-2.2.7-3.26.1 SUSE Enterprise Storage 6 (src):    cups-2.2.7-3.26.1 SUSE CaaS Platform 4.0 (src):    cups-2.2.7-3.26.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 38](show_bug.cgi?id=1184161#c38)  Swamp Workflow Management   2021-05-01 01:15:42 UTC  ``` openSUSE-SU-2021:0638-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1184161 CVE References: CVE-2021-25317 JIRA References:  Sources used: openSUSE Leap 15.2 (src):    cups-2.2.7-lp152.9.9.1 ``` [Comment 39](show_bug.cgi?id=1184161#c39)  Johannes Meixner   2021-05-03 08:37:00 UTC  ``` Fixed for openSUSE Factory / Tumbleweed: ----------------------------------------------------------------- # osc submitrequest -m 'Fixed CVE-2021-25317 ([bsc#1184161](http://bugzilla.suse.com/show_bug.cgi?id=1184161))' \  home:jsmeix:branches:Printing cups Printing cups  created request id 889938   # osc request accept -m 'Fixed CVE-2021-25317 ([bsc#1184161](http://bugzilla.suse.com/show_bug.cgi?id=1184161))' \  889938  Result of change request state: ok openSUSE:Factory  Forward this submit to it? ([y]/n)y Fixed CVE-2021-25317 ([bsc#1184161](http://bugzilla.suse.com/show_bug.cgi?id=1184161)) (forwarded request 889938 from jsmeix) New request # 889939 ----------------------------------------------------------------- ``` [Comment 40](show_bug.cgi?id=1184161#c40)  OBSbugzilla Bot   2021-05-03 09:10:03 UTC  ``` This is an autogenerated message for OBS integration: This bug (1184161) was mentioned in <https://build.opensuse.org/request/show/889939> Factory / cups ``` [Comment 41](show_bug.cgi?id=1184161#c41)  Johannes Meixner   2021-05-10 12:06:02 UTC  ``` Matthias Gerstner  I have a question that could be related to this issue here:  I got a OBS submitrequest for the package cups in Printing where the '%defattr(-,root,root)' settings in cups.spec should be removed because they "are obsolete at least since SLE12" cf. <https://build.opensuse.org/request/show/886970>  I failed to find documentation about "defattr is obsolete" (I guess '%defattr(-,root,root)' is used by default) but my main point is if it isn't better for security to explicitly specify '%defattr(-,root,root)' compared to rely on whatever default? ``` [Comment 44](show_bug.cgi?id=1184161#c44)  Andrea Mattiazzo   2024-05-23 15:31:16 UTC  ``` All done, closing. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1184161)
* -Â [XML](show_bug.cgi?ctype=xml&id=1184161)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=1184161)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1184161)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from en.opensuse.org_339975be_20250115_140240.html ===


[![ðŸ¦Ž](https://static.opensuse.org/favicon.svg "openSUSE")
Wiki](/)

* Navigation
  [Home](/Main_Page)[Project](/Portal%3AProject)[Distribution](/Portal%3ADistribution)[Support](/Portal%3ASupport)[Contact](/openSUSE%3ACommunication_channels)[Site map](/openSUSE%3ACategory_browse)

* Help
  [Wiki](/Portal%3AWiki)[Create a Page](/Help%3AConcept)[Change a Page](/Help%3AEditing)[Find a Page](/Help%3ASearch)

* Tools
  [What links here](/Special%3AWhatLinksHere/SDB%3ACUPS_in_a_Nutshell "A list of all wiki pages that link here [j]")[Related changes](/Special%3ARecentChangesLinked/SDB%3ACUPS_in_a_Nutshell "Recent changes in pages linked from this page [k]")[Special pages](/Special%3ASpecialPages "A list of all special pages [q]")Printable version[Permanent link](/index.php?title=SDB:CUPS_in_a_Nutshell&oldid=182803 "Permanent link to this revision of the page")[Page information](/index.php?title=SDB:CUPS_in_a_Nutshell&action=info "More information about this page")

* In other languages
  [Deutsch](http://de.opensuse.org/SDB%3ACUPS_in_aller_K%C3%BCrze "SDB:CUPS in aller KÃ¼rze â€“ Deutsch")[FranÃ§ais](http://fr.opensuse.org/SDB%3ACUPS_en_quelques_mots "SDB:CUPS en quelques mots â€“ franÃ§ais")[Italiano](http://it.opensuse.org/SDB%3ACUPS_in_breve "SDB:CUPS in breve â€“ italiano")

* Log in

* [SDB](/SDB%3ACUPS_in_a_Nutshell)
* [Discussion](/index.php?title=SDB_Talk:CUPS_in_a_Nutshell&action=edit&redlink=1 "Discussion about the content page [t]")

[View](/SDB%3ACUPS_in_a_Nutshell)
[View source](/index.php?title=SDB:CUPS_in_a_Nutshell&action=edit "This page is protected.
You can view its source [e]")
[History](/index.php?title=SDB:CUPS_in_a_Nutshell&action=history "Past revisions of this page [h]")

# SDB:CUPS in a Nutshell

Jump to: [navigation](#mw-head),
[search](#p-search)

This article addresses experienced Linux users.

It does not provide detailed explanations. All important issues in connection with CUPS are presented in a concise form.

Some details here and there could be a bit outdated (depending on the CUPS version) but in general things are still valid.

This article describes CUPS up to version 2.x under Linux with the traditional filtering system and backends there.

The nowadays driverless printing workflow is rather different.

## Contents

* [1 Overview of the CUPS Printing System](#Overview_of_the_CUPS_Printing_System)
  + [1.1 Processing stages of a print job:](#Processing_stages_of_a_print_job:)
    - [1.1.1 (I) Generating a print job](#(I)_Generating_a_print_job)
    - [1.1.2 (II) Saving the print job in the spool directory](#(II)_Saving_the_print_job_in_the_spool_directory)
    - [1.1.3 (III) Filtering the print data and sending printer-specific data to the printer](#(III)_Filtering_the_print_data_and_sending_printer-specific_data_to_the_printer)
    - [1.1.4 (IV) Completing the print job](#(IV)_Completing_the_print_job)
* [2 The Spooler](#The_Spooler)
  + [2.1 Function of the spooler](#Function_of_the_spooler)
  + [2.2 Details:](#Details:)
    - [2.2.1 /usr/sbin/cupsd](#/usr/sbin/cupsd)
    - [2.2.2 /usr/lib/cups/daemon/cups-lpd](#/usr/lib/cups/daemon/cups-lpd)
* [3 PPD Files](#PPD_Files)
  + [3.1 What is a PPD file and how does it work?](#What_is_a_PPD_file_and_how_does_it_work?)
  + [3.2 Details:](#Details:_2)
    - [3.2.1 /etc/cups/ppd/](#/etc/cups/ppd/)
    - [3.2.2 /usr/share/cups/model/](#/usr/share/cups/model/)
    - [3.2.3 The OpenPrinting/LinuxPrinting.org printer database](#The_OpenPrinting/LinuxPrinting.org_printer_database)
* [4 The Filter (includes the Driver)](#The_Filter_(includes_the_Driver))
  + [4.1 What does the filter system do and how does it work?](#What_does_the_filter_system_do_and_how_does_it_work?)
  + [4.2 Details:](#Details:_3)
    - [4.2.1 /usr/lib/cups/filter/](#/usr/lib/cups/filter/)
    - [4.2.2 /etc/cups/interfaces/](#/etc/cups/interfaces/)
    - [4.2.3 "raw"](#"raw")
* [5 The Backends](#The_Backends)
  + [5.1 What is a CUPS backend and how does it work?](#What_is_a_CUPS_backend_and_how_does_it_work?)
  + [5.2 Details:](#Details:_4)
    - [5.2.1 /usr/lib/cups/backend/](#/usr/lib/cups/backend/)
* [6 Command-line Tools](#Command-line_Tools)
  + [6.1 General information on the command-line tools](#General_information_on_the_command-line_tools)
  + [6.2 Details:](#Details:_5)
    - [6.2.1 Command-line tools for creating or editing queues](#Command-line_tools_for_creating_or_editing_queues)
    - [6.2.2 Command-line tools for daily use](#Command-line_tools_for_daily_use)
* [7 cupsd Web Frontend](#cupsd_Web_Frontend)
  + [7.1 Details:](#Details:_6)
* [8 Configuring CUPS <= 1.5 in the Network](#Configuring_CUPS_<=_1.5_in_the_Network)
  + [8.1 CUPS >= 1.6 has major incompatible changes](#CUPS_>=_1.6_has_major_incompatible_changes)
  + [8.2 Intrinsic design of CUPS <= 1.5 for printing in the network](#Intrinsic_design_of_CUPS_<=_1.5_for_printing_in_the_network)
  + [8.3 Configuration of a CUPS <= 1.5 server](#Configuration_of_a_CUPS_<=_1.5_server)
  + [8.4 Details:](#Details:_7)
    - [8.4.1 Configuration of the print queues on a CUPS <= 1.5 server](#Configuration_of_the_print_queues_on_a_CUPS_<=_1.5_server)
    - [8.4.2 Get CUPS debug messages if it does not work](#Get_CUPS_debug_messages_if_it_does_not_work)
    - [8.4.3 Configuration of CUPS <= 1.5 clients](#Configuration_of_CUPS_<=_1.5_clients)
    - [8.4.4 Special cases for configuration of CUPS <= 1.5 clients](#Special_cases_for_configuration_of_CUPS_<=_1.5_clients)
    - [8.4.5 Regarding firewall](#Regarding_firewall)
    - [8.4.6 Allow printer admin tasks for a normal user](#Allow_printer_admin_tasks_for_a_normal_user)
* [9 See also](#See_also)
## Overview of the CUPS Printing System

[Concepts printing](/Concepts_printing "Concepts printing") explains the basics about printing.

For a general overview see the "Overview of CUPS" page at [the CUPS web interface](http://localhost:631) running on your local machine or see the documentation for your actually used CUPS version at [CUPS.org](http://www.cups.org)

CUPS home page: <http://www.cups.org/>

### Processing stages of a print job:

The following first step takes place both on client and on server systems. This is the only step on client systems. No queues exist on client systems. A single host with a locally connected printer works as a CUPS server with a print queue for that printer.

#### (I) Generating a print job

An application program or a command-line tool generates a print job and passes it to the spooler.

A print job consists of information for the spooler, the print data (see [PostScript](/SDB%3AGlossary/PostScript "SDB:Glossary/PostScript") and [Concepts printing](/Concepts_printing "Concepts printing")), and optional information for the filter.

Example for a command-line tool:

```
lp -d queue -t title -o option1=value1 -o option2=value2 file1 file2

```

* "queue" and "title" is information for the spooler.
* "option1=value1" and "option2=value2" is information for the filter.
* "file1" and "file2" are the print data.

The following subsequent steps only take place on a CUPS server. A host on which the following steps take place is a server. A host on which a print queue actually exists is a server (in contrast to clients where only references to the actual print queues exist).

The spooler (cupsd) does:

#### (II) Saving the print job in the spool directory

* Saving the information for the spooler and the filter in the control file /var/spool/cups/c<job-number>
* Saving the data from the files to print in the data file /var/spool/cups/d<job-number>-<file-number>

#### (III) Filtering the print data and sending printer-specific data to the printer

* Starting the filter system:
  + Determining which filters are needed for generating the printer-specific data and establishment of the so called "filter chain" or "filter pipe".
  + Starting the programs of the filter chain/pipe with suitable parameters.
* Starting the backend for sending the printer-specific data from the filter pipe to the printer.

#### (IV) Completing the print job

* Waiting until the backend is finished.
* Deleting the respective files from the spool directory.

## The Spooler

### Function of the spooler

The main purpose of the spooler system is to move data from the sender to the recipient.

1. Accepting data (only from authorized senders).
2. Buffering data (until the recipient is ready to accept them).
3. Sending data to authorized recipients (after implementing suitable filters, if necessary).
4. Providing information about the status of the data (e.g., for "lpstat -W completed -o").

### Details:

#### /usr/sbin/cupsd

* cupsd is the server for the [IPP protocol](/SDB%3AGlossary/IPP_protocol "SDB:Glossary/IPP protocol")
* cupsd listens on TCP port 631 for IPP tasks for example via commands like "lp -d queue\_name file\_name" or "lpstat -t"
* cupsd listens on TCP port 631 for [HTTP](/SDB%3AGlossary/HTTP_protocol "SDB:Glossary/HTTP protocol") tasks like managing printers via http://localhost:631/printers/
* cupsd uses UDP port 631 for sending and receiving "CUPS Browsing" information (see "Intrinsic design of CUPS for printing in the network" below). Use commands like "netcat -u -l -p 631" to pick up such information (provided UDP port 631 is not yet occupied by cupsd)
* Configuration file for cupsd: /etc/cups/cupsd.conf (since CUPS 1.6 also /etc/cups/cups-files.conf)
* systemd unit files /usr/lib/systemd/system/cups.\*

#### /usr/lib/cups/daemon/cups-lpd

* cups-lpd is the server for the LPD protocol (RFC 1179)
* cups-lpd accepts print jobs that come in on TCP port 515 via the LPD protocol
* Either xinetd or inetd or systemd is used as wrapper for cups-lpd
* Configuration files:
  + Either /etc/xinetd.d/cups-lpd
  + or the cups-lpd line in /etc/inetd.conf
  + or systemd /usr/lib/systemd/system/cups-lpd\* unit files

## PPD Files

### What is a PPD file and how does it work?

See "PPD files: Printer-specific options" at [Concepts printing](/Concepts_printing "Concepts printing").

For PostScript printers, the PPD file contains the printer-specific options (and nothing else) together with the corresponding PostScript code snippets that must be sent to the PostScript interpreter in order to activate a certain option.

For non-PostScript printers, the PPD file contains additionally information which printer driver program must be used and the options that are available for the particular driver. If several drivers can be used for a given printer, several PPD files are available.

Depending on the printer-specific options set for a certain print job (e.g., "-o PageSize=A4"), the filter system reads the suitable PostScript code snippets (the so called "PostScript invocation values") from the PPD file and inserts them in the PostScript data stream.

The syntax for an option entry in the PPD file with two example entries is as follows:

| \* Main keyword | Option keyword/translation string | " PostScript invocation value " |
| --- | --- | --- |
| \*PageSize | Letter/letter paper: | "<</PageSize[612 792]/ImagingBBox null>>setpagedevice" |
| \*PageSize | A4/A4 paper: | "<</PageSize[595 842]/ImagingBBox null>>setpagedevice" |

More information is available in the "Adobe PostScript Printer Description File Format Specification, Version 4.3".

### Details:

#### /etc/cups/ppd/

* This directory contains the PPD files that cupsd actually makes use of.
* The entries (especially the "\*Default..." entries) in a PPD file in /etc/cups/ppd/ can vary from the entries in the original PPD file that was specified when the queue was configured.

#### /usr/share/cups/model/

* This directory contains the original PPD files which are used to set up new print queues. See "openSUSE printer driver software packages" at [Concepts printing](/Concepts_printing "Concepts printing") which packages provide what kind of PPD files.
* Additional PPD files (e.g., PPD files from printer manufacturers) can be copied to this directory in order to make them available for the printer configuration tools.

#### The OpenPrinting/LinuxPrinting.org printer database

* The OpenPrinting/LinuxPrinting.org printer database consists of XML files from which the Foomatic PPD files are generated.
* The OpenPrinting/LinuxPrinting.org printer database is available at <https://wiki.linuxfoundation.org/openprinting/database/databaseintro>

## The Filter (includes the Driver)

In general "filter" means a program that converts input data into output data
and "driver" means device-model-specific software and data.

### What does the filter system do and how does it work?

The main purpose of the filter system is to convert the original data of the print job (ASCII, PostScript, PDF) into printer-specific data (PostScript, PCL, ESC/P) via several steps.

Usually the last step is a program which is the printer driver which outputs the final printer-specific data, see "Printer drivers: Make the printer print" at [Concepts printing](/Concepts_printing "Concepts printing").

Each step is done by a separated filtering program where the filtering programs are run one after the other as a traditional Unix pipe: The original print job data is the input of the first filtering program where its output is sent via the pipe as input to the second filtering program and so on until the output of last filtering program is sent via the pipe as input to the CUPS backend that finally sends the printer-specific data to the printer (see the subsequent section about "The Backends").

The actual filtering of a particular print job for a particular printer model on a particular Linux system depends on various conditions, see "Background Information" at [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

In particular the filtering is different for the traditional printing data format PostScript and for the recent printing data format PDF, see "Common printing data formats" at [Concepts printing](/Concepts_printing "Concepts printing").

Furthermore the actual filtering depends on which kind of printer driver is used.

The following is one particular example how the filtering works for the traditional printing data format PostScript when a printer driver is used that is included in Ghostscript (see [Concepts printing](/Concepts_printing "Concepts printing")). In this case the filtering takes place by means of the following steps:

**1) Converting the original data to PostScript.**

**1a) Determination of the MIME type of the original data:**

This happens according to /usr/share/cups/mime/mime.types or /etc/cups/mime.types.

**1b) Conversion to PostScript (if it is not yet PostScript):**

If the MIME type of the original data is not "application/postscript", then conversion to PostScript according to /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs.

In particular original data of MIME type "text/plain" is converted to PostScript with /usr/lib/cups/filter/texttops.

Since CUPS 1.3.4 only UTF-8 text is supported (which includes 7-bit ASCII text). Text in the ISO-8859 encodings is no longer supported. The reason is that it is not possible to autodetect the encoding so that CUPS cannot process "plain text" files in arbitrary encodings in a reliable way, see [SDB:Plain Text versus Locale](/SDB%3APlain_Text_versus_Locale "SDB:Plain Text versus Locale"). To print non-UTF-8 text, you must convert it from its encoding to UTF-8 before sending it to the CUPS server. To print an ISO-8859-1 text file, you may use:

```
iconv -f ISO-8859-1 -t UTF-8 filename | lp -d queue

```

See "iconv --help" for some information about iconv.

Printing of PDF or graphics files (JPEG, PNG, etc.) works as before.

**2) Inserting the PostScript invocation values in the PostScript data stream.**

This happens according to the following line in /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs:

| Input MIME type | Output MIME type | Costs | Filter |
| --- | --- | --- | --- |
| application/postscript | application/vnd.cups-postscript | 66 | pstops |

**3) Convert PostScript data to printer-specific data.**

If a non-PostScript printer is used with a Foomatic PPD file, the PostScript data are converted to printer-specific data according to the following line in every Foomatic (version 3.x) PPD file:

| Main keyword | Input MIME type | Costs | Filter |
| --- | --- | --- | --- |
| \*cupsFilter: | "application/vnd.cups-postscript |  | foomatic-rip" |

If a non-PostScript printer is used with a Foomatic PPD file, then foomatic-rip together with Ghostscript serve as the PostScript interpreter.

foomatic-rip proceeds as follows to convert the PostScript data to printer-specific data:

**3a) Build a Ghostscript command:**

foomatic-rip builds a Ghostscript command with the needed Ghostscript printer driver and additional parameters according to the printer-specific options set for the respective print job.

In some cases, a postfilter is introduced after the Ghostscript command (via pipe). For example for some PCL printers certain options are realized by means of changes in the PCL data stream (e.g., paper tray selection via "perl -e").

**3b) Run the Ghostscript command (or pipe):**

foomatic-rip executes the Ghostscript command.

If a non-Foomatic PPD file (e.g., a Gutenprint/Gimp-Print PPD file from /usr/share/cups/model/gutenprint or /usr/share/cups/model/stp) is used for a non-PostScript printer, the "\*cupsFilter" entries in the PPD file may look as follows:

```
*cupsFilter: "application/vnd.cups-raster 100 rastertogutenprint"

```

or

```
*cupsFilter: "application/vnd.cups-raster 100 rastertoprinter"

```

With the matching entries in /usr/share/cups/mime/mime.convs or /etc/cups/mime.convs the result is a different filtering procedure.
In this particular case /usr/lib/cups/filter/rastertogutenprint or /usr/lib/cups/filter/rastertoprinter is the printer driver program.

For more general information on filters see the man page "man 7 filter". More specific information on filtering is available in the Support Database article [SDB:Using Your Own Filters to Print with CUPS](/SDB%3AUsing_Your_Own_Filters_to_Print_with_CUPS "SDB:Using Your Own Filters to Print with CUPS").

### Details:

#### /usr/lib/cups/filter/

This directory contains the various filter programs used by the CUPS filter system if a PPD file was specified when the respective queue was configured.

* /usr/lib/cups/filter/\*tops (e.g., /usr/lib/cups/filter/texttops) for converting the original data (e.g., "text/plain") to PostScript.
* /usr/lib/cups/filter/pstops for inserting the PostScript invocation values and, if necessary, for reformatting the PostScript data (e.g., to downsize and print two pages on one sheet).
* /usr/lib/cups/filter/foomatic-rip for converting PostScript data to printer-specific data (e.g., PCL or ESC/P).

#### /etc/cups/interfaces/

Backward incompatible change since CUPS 2.2.0: There is no longer the directory /etc/cups/interfaces because since CUPS 2.2.0 so called "System V style Interface Scripts" are no longer supported for security reasons (cf. the "CHANGES" files in CUPS).

Up to CUPS < 2.2.0 the /etc/cups/interfaces directory contains the filter used by CUPS if a "System V style Interface Script" was specified instead of a PPD file when the respective queue was configured.
A "System V style Interface Script" is a single filter program or filter script that produces the printer-specific data for all data formats in which the original print data may be sent.
More information about the "System V style Interface Script" is available in the Support Database article "Using Your Own Filters to Print with CUPS": [SDB:Using Your Own Filters to Print with CUPS](/SDB%3AUsing_Your_Own_Filters_to_Print_with_CUPS "SDB:Using Your Own Filters to Print with CUPS").

#### "raw"

If neither a PPD file nor a "System V style Interface Script" was specified when the respective queue was configured, no filtering will take place. The original print data will be sent directly from the backend to the recipient (normally the printer) as they are (in "raw" form). It is not possible to convert the line break (e.g., LF -> CR+LF) or append a form feed. Up to CUPS < 2.2.0 a "System V style Interface Script" can be used for this purpose.

## The Backends

### What is a CUPS backend and how does it work?

Normally, the backend receives the printer-specific data from the filter and forwards them to the printer or another recipient.

The differences between the backend and the filter are as follows:

* One backend but usually several filters (called "filter chain" or "filter pipe") are activated to process a print job. Exceptions: "System V style Interface Script" (one filter) and "raw" printing (no filter).
* In the processing chain/pipe, the backend is always the last program executed for processing a print job.

The print system considers the print job as completed when the backend is finished. The backend is finished when the transmission to the recipient is completed. If the further processing at the recipient fails (e.g., if the printer is not able to print the printer-specific data), this will go unnoticed by the print system.

If the data transmission to the recipient fails (usually after several attempts by the backend), the backend will report an error to the print system (more precisely, to cupsd). The backend decides if and how many attempts make sense before it reports that the data transmission has failed. As further attempts would be futile, cupsd disables printing on the affected queue. After eliminating the cause of the problem, the system administrator must reenable printing with /usr/bin/enable (for CUPS 1.1 - i.e. up to Suse Linux 10.1) or with cupsenable (since CUPS 1.2 - i.e. since openSUSE 10.2).

For more information on backends see the man pages "man 7 backend" for what is specific for backends and "man 7 filter" for general information regarding filters (backends are a special type of filter). More specific information on backends is available in the Support Database article [SDB:Using Your Own Backends to Print with CUPS](/SDB%3AUsing_Your_Own_Backends_to_Print_with_CUPS "SDB:Using Your Own Backends to Print with CUPS").

### Details:

#### /usr/lib/cups/backend/

This directory contains the various backends.

A suitable backend must be employed under consideration of how the printer can be accessed from the host running the CUPS system and the type of recipient.

The destination to which a backend can send the data can be any URI (Uniform Resource Identifier) for which a suitable backend is available. The first part of the "DeviceURI" entry in /etc/cups/printers.conf determines the backend, the other entries serve as parameters for the backend.

| Backend | URI syntax | Example URI |
| --- | --- | --- |
| parallel | parallel:/dev/lp\* | parallel:/dev/lp0 |
| usb (traditional) | usb:/dev/usb/lp\* | usb:/dev/usb/lp0 |
| usb (new) | usb://<make>/<model>?serial=<number> | usb://ACME/FunPrinter%201000?serial=A1B2C3 |
| ipp | ipp://<ipp-server.domain>/printers/<queue> | ipp://cups-server.domain/printers/funprinter1000 |
| lpd | lpd://<lpd-server.domain>/<queue> | lpd://192.168.101.202/lpt1 |
| socket | socket://<host.domain>:<port> | socket://192.168.101.202:9100 |
| smb | see the man page smbspool(8) | smb://user:password@workgroup/smb-server/share |

If "user" and "password" are needed for the smb backend, the owner, group, and access permissions for the file /etc/cups/printers.conf must be sufficiently restrictive. The specifications "user" and "password" are not displayed with the command "lpstat -v".

Every backend can also be addressed directly. For example, the "parallel" and "usb" backends return the IEEE-1284 identification of connected printers.

```
root@host# /usr/lib/cups/backend/parallel
direct parallel:/dev/lp0 "ACME FunPrinter 1000" "Parallel Port #1"

```
```
root@host# /usr/lib/cups/backend/usb
direct usb://ACME/USB%20Printer?serial=1234 "ACME USB Printer" "USB Printer #1"
direct usb:/dev/usb/lp1 "Unknown" "USB Printer #2"
...

```

For older CUPS versions upon start-up, cupsd successively executes all backends in /usr/lib/cups/backend/ in order to determine which of the backends are available on the respective system. Only the available backends can be used for the configuration of queues. The available backends are displayed with "lpinfo -v". For nowadays CUPS versions not the cupsd itself but the separated cups-deviced is run that also executes all backends in /usr/lib/cups/backend/ when a "lpinfo -v" command is run (and cups-driverd is run when a "lpinfo -m" command is run, see "man cups-deviced" and "man cups-driverd").

## Command-line Tools

### General information on the command-line tools

Do not edit configuration files in /etc/cups/ manually if suitable command-line tools are available for this purpose.

Exception: /etc/cups/cupsd.conf (and since CUPS 1.6 also /etc/cups/cups-files.conf)

After modifications in /etc/cups/cupsd.conf (and since CUPS 1.6 also in /etc/cups/cups-files.conf), cupsd must be restarted in order to make it use the modified configuration.

Do not change CUPS spool files (in /var/spool/cups/) manually. Use CUPS command-line tools.

Never ever change CUPS files manually while the cupsd is running.

In contrast CUPS command-line tools only submit a task what to do to the cupsd and then the cupsd can do it properly.

Reason:

CUPS files are neither re-read nor instantly updated in any case. Rather, cupsd keeps much information in memory and writes it back to the files at more or less arbitrary time (see the "DirtyCleanInterval" cupsd configuration directive).

For example, to clean up all print queues run "cancel -a" (or since CUPS 1.7 "cancel -a -x") which completely removes all existing (old) print jobs (including job history) in all print queues.

Never copy configuration files from other systems into your system unless you know exactly what you are doing. Use command-line tools instead.

For example, to set up the same queues on several machines (e.g., for a backup server), do not copy /etc/cups/printers.conf and /etc/cups/ppd/\*, but write the respective commands in a script (usually a sequence of lpadmin commands) and run the script on the various machines. In this way, any error messages will be displayed on the respective machines (e.g., if a PPD file is not available on a machine or if a backend is not available or not ready to use). Furthermore with such a script you have something like a backup plus log-file of your settings, enabling you to restore those settings by running the script at any time.

If you are not sure which graphical tool is best suited for certain special configurations or print queue maintenance actions, use command-line tools instead.

In many cases, the sequence of the options is significant. Read the man pages. For example, the following commands are all different:

```
  lpadmin -E -p queue,
  lpadmin -p queue -E
  lpadmin -E -p queue -E

```
### Details:

#### Command-line tools for creating or editing queues

**How to set up a print queue in full compliance with CUPS:**

1. Retrieve autodetected printers and their correct matching DeviceURIs from the cupsd: Run (as root) "lpinfo -l -v"
2. Retrieve available printer driver descriptions from the cupsd: Run (as root) "lpinfo -l -m"
3. Select a printer/DeviceURI from the first list and a printer driver from the second list and devise an appropriate queue name.
4. Set up the queue: Run (as root) "lpadmin -p queue\_name -v DeviceURI -m printer\_driver -E" or "lpadmin -p queue\_name -v DeviceURI -P /usr/share/cups/model/printer\_driver -E"

There is no re-start of the cupsd needed to add, modify, or delete print queues (only a config change of the cupsd itself requires it to be re-started).

Example for creating a usual queue with a PPD file:

```
root@host# lpadmin -h localhost -p funprinter1000 -v parallel:/dev/lp0 -P /usr/share/cups/model/Postscript.ppd.gz -E

```

Example for creating a local "raw" queue that only forwards print job data to a queue on a remote cups server (see the sections "raw" and "/usr/lib/cups/backend/" above):

```
root@host# lpadmin -h localhost -p funprinter1000forwarding -v ipp://cups-server.domain/printers/funprinter1000 -E

```

Use the following command to check what was created:

```
user@host$ lpstat -h localhost -a funprinter1000 -p funprinter1000 -v funprinter1000
funprinter1000 accepting requests since Jan 01 00:00
printer funprinter1000 is idle.  enabled since Jan 01 00:00
device for funprinter1000: parallel:/dev/lp0

```

Alternatively, take a look at /etc/cups/printers.conf:

```
<Printer funprinter1000>
Info funprinter1000
DeviceURI parallel:/dev/lp0
State Idle
Accepting Yes
JobSheets none none
QuotaPeriod 0
PageLimit 0
KLimit 0
</Printer>

```

Or query the system via the web frontend: http://localhost:631/printers/funprinter1000

Editing the queue (e.g., changing the description and location):

```
root@host# lpadmin -h localhost -p funprinter1000 -D "ACME FunPrinter 1000" -L "2. floor: room 3"

```

Displaying the printer-specific options and their default settings in /etc/cups/ppd/funprinter1000.ppd (provided the queue was set up with a PPD file):

```
user@host$ lpoptions -h localhost -p funprinter1000 -l
Resolution/Output Resolution: 150dpi *300dpi 600dpi 1200dpi 2400dpi
PageSize/Media Size: Letter Legal Executive *A4 A5
...

```

The output has the following syntax:

```
main-keyword/translation-string: option-keyword option-keyword option-keyword ...

```

The default setting is marked with an \* preceding the "option-keyword".

Changing the printer-specific default settings in /etc/cups/ppd/funprinter1000.ppd (provided the queue was set up with a PPD file):

```
root@host# lpadmin -h localhost -p funprinter1000 -o Resolution=600dpi -o PageSize=Letter

```

The syntax is as follows:

```
lpadmin -h localhost -p queue -o main-keyword1=option-keyword1 -o main-keyword2=option-keyword2 ...

```

Do not use lpoptions for this purpose. Refer to the Support Database article [Print Settings with CUPS](/SDB%3APrint_Settings_with_CUPS "SDB:Print Settings with CUPS"). Normal users can use lpoptions to save their personal default settings in ~/.cups/lpoptions (since CUPS 1.2 / openSUSE 10.2, it was ~/.lpoptions in CUPS 1.1). More information on this is presented in the same Support Database article.

Use "accept" and "reject" to accept and reject print jobs for a queue.

Use /usr/bin/enable ("enable" is a bash built-in) or /usr/sbin/cupsenable and "disable" or /usr/sbin/cupsdisable to enable and disable printing in a queue (e.g., to avoid print jobs from being lost while doing maintenance work on the printer).

Deleting the queue:

```
root@host# lpadmin -h localhost -x funprinter1000

```
#### Command-line tools for daily use

Avoid BSD-type commands (lpr, lpq, lprm), as these only support a limited number of generic options. Use System V-type commands (lp, lpstat, cancel) instead.

Use lpoptions to save personal printer-specific option settings in ~/.cups/lpoptions (since CUPS 1.2 / openSUSE 10.2, it was ~/.lpoptions in CUPS 1.1). Example:

```
user@host$ lpoptions -o Resolution=1200dpi -p funprinter1000

```

The generally available printing options are described on the "Command-Line Printing and Options" page in the
"Getting Started" section under "Documentation/Help" at [the CUPS web interface](http://localhost:631) running on your local machine or see the "Documentation" for your actually used CUPS version at [CUPS.org](http://www.cups.org)

## cupsd Web Frontend

Every cupsd in the network has an HTTP web frontend. The URL for the local running cupsd is <http://localhost:631> and the URL for a remote cupsd on "host.domain" is http://host.domain:631 provided that the remote cupsd which runs on the remote host permits the access.

### Details:

In daily operations, the web frontend is usually the best source of information about queues and print jobs. For example, <http://localhost:631/printers/> provides an overview of all queues of a local cupsd.

The web frontend is the best way to get documentation on the respective cupsd (cupsd version). For example, the documentation for the locally installed CUPS version is available at <http://localhost:631> and the documentation for CUPS installed on a remote server is is available at http://host.domain:631 provided that the remote server permit the access.

Even the PPD files in /etc/cups/ppd/ can be accessed by way of the web frontend. For example, the PPD file of the queue "funprinter1000" on the local host (/etc/cups/ppd/funprinter1000.ppd) can be accessed with the URL http://localhost:631/printers/funprinter1000.ppd and
accordingly the PPD file of "queue" on "host.domain" can be accessed with a URL in the form http://host.domain:631/printers/queue.ppd provided that the remote host permit the access.

## Configuring CUPS <= 1.5 in the Network

### CUPS >= 1.6 has major incompatible changes

After a version upgrade to CUPS >= 1.6 printing in the network would no longer work as it did up to CUPS 1.5.

For an overview about what is new since CUPS 1.6 see <https://www.cups.org/blog.html>

For details regarding incompatible changes since CUPS 1.6 see <https://bugzilla.opensuse.org/show_bug.cgi?id=735404> and follow the links therein.

Since Mac OS X version 10.8 "Mountain Lion" it uses CUPS 1.6 (but not OS X 10.7 "Lion" that has CUPS 1.5). It seems OS X 10.8 clients need a CUPS 1.6 server that supports how OS X 10.8 clients print by default via network. Therefore networks with newest Mac OS X 10.8 clients may require a CUPS 1.6 server.

Users who need backward compatibility would run CUPS up to 1.5 on one server and those who need the new features in CUPS >= 1.6 could additionally run CUPS >= 1.6 on another server.

In particular note that CUPS >= 1.6 usually requires the filters of the cups-filters software that is provided by OpenPrinting.org.

### Intrinsic design of CUPS <= 1.5 for printing in the network

CUPS network servers (hosts on which spooling and filtering is done):

* The cupsd of a CUPS network server sends information about its queues to a list of IP addresses (host addresses and/or broadcast addresses). The default setting is an empty list.
* The transmission is repeated after preset intervals. The default setting is 30 seconds.

Clients (hosts that only send print jobs to servers):

* By default, cupsd listens to information from servers. Therefore, a local cupsd should run on every client. There is a list of servers from which information is accepted. By default, information is accepted from all servers.
* The information about a specific queue is deleted on a client if no new information about the queue comes in within a set interval. The default setting is 300 seconds.

In this way, the queues of the server are available directly on the client. Users on the clients can browse the queues on various servers. Therefore the whole stuff is called "Browsing".

Browsing is activated by default. All incoming browsing information is accepted, but no browsing information is sent (see above).

### Configuration of a CUPS <= 1.5 server

1. Configure print queues for the printers associated with the server.
2. Allow the clients to access the queues.
3. Activate sending of browsing information to the clients.

Subnetworks should be used to facilitate the configuration. If subnets are used, it is sufficient to send the browsing information to a fixed broadcast address instead of continuously maintaining a list of individual host addresses.

The access to the queues of a server is handled independently, regardless to which hosts the server sends browsing information. A server can grant all clients in the network access to its queues, while sending browsing information to only some of the clients. However, a server should not send any browsing information to clients that do not have access to its queues.

In a large company, it is not possible to have only one large server that sends browsing information for some of the queues to the clients in one department or one building and browsing information for other queues to other clients.

Several servers (one for every department or building) are needed for this.

### Details:

#### Configuration of the print queues on a CUPS <= 1.5 server

The printers belonging to a server are the ones for which the filtering takes place on the server.

**I) Configure the printers so that printing works on the server.**

Set up print queues for the printers associated with the server.

Verify that printing works correctly when a normal user prints directly from the server. In case of problems inspect the CUPS debug messages on the server, see below.

**II) Allow the clients to access the queues.**

Either change /etc/cups/cupsd.conf manually or use YaST. Since openSUSE 11.1 use in YaST the "Share Printers" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

**First let the cupsd listen on the network:**

By default the cupsd since CUPS 1.2 (since openSUSE 10.2) listens only on internal ("localhost") network interfaces (and a Unix domain socket) in /etc/cups/cupsd.conf for CUPS 1.2 and later:

```
Listen localhost:631
Listen /var/run/cups/cups.sock

```

For a CUPS 1.2 (and later) network server you must change it to listen on the outer network too. Add an entry of the form "Listen IP.of.your.server".

If the CUPS server is accessible from any untrusted network, make sure that you use a firewall to protect your server.

**Then allow the clients to access the server:**

The default setting in /etc/cups/cupsd.conf is as follows:

```
<Location />
Order allow,deny
Allow 127.0.0.2
</Location>

```

Access from "localhost" 127.0.0.1 is allowed in any case without an explicite entry and 127.0.0.2 could be assignd to the hostname of the server so that access via the hostname of the server is also allowed.

To allow access from all hosts in the whole local network insert the line

```
Allow @LOCAL

```

This setting allows all LOCAL hosts to access cupsd. LOCAL hosts are those whose IP addresses are associated with non-PPP interfaces (more precisely, interfaces whose IFF\_POINTOPOINT flag is not set) and whose IP address belongs to the same network as the CUPS server. This means that usually the "Internet" network interface which is connected to an usual modem is excluded. But if it is connected to a cable modem it is not a point-to-point interface so that @LOCAL cannot be used in this case.

To allow access from specific hosts or networks insert lines like

```
Allow 192.168.100.1
Allow 192.168.200.0/255.255.255.0

```

We recommend the use of IP addresses instead of names.

Differences regarding older SUSE LINUX versions:

From SUSE LINUX 9.0 up to SUSE LINUX 10.1, the default setting in /etc/cups/cupsd.conf was:

```
BrowseAllow @LOCAL
.
.
.
<Location />
...
Allow @LOCAL
</Location>

```

This setting allowed all LOCAL hosts to access cupsd and furthermore packets from all other hosts have been rejected immediately.

Up to SUSE LINUX 10.1 we provided CUPS 1.1 and since openSUSE 10.2 we provide CUPS 1.2 which is not fully backward compatible with CUPS 1.1.

Therefore in case of an update it is recommended not to use an outdated cupsd.conf from a CUPS 1.1 installation before but to start from scratch with the original cupsd.conf from our CUPS 1.2 (or later) RPM.

For example RunAsUser is no longer supported so that since openSUSE 10.2 / CUPS 1.2 the cupsd runs as root and therefore we are back to its default "basic authentication" via system users and system passwords (in /etc/shadow) so that it works again to authenticate as "root" and use the usual root system password.

**III) Activate the sending of browsing information to the clients.**

In /etc/cups/cupsd.conf, set the entry "BrowseAddress @LOCAL" in order to send browsing information to all LOCAL hosts, or insert entries in the form "BrowseAddress client.host.IP.address" or "BrowseAddress network.broadcast.IP.address".

The sending of browsing information to the clients is somewhat optional:

* If it is omitted, the clients will not automatically receive information about the queues on the server.
* Nevertheless, due to the previous step the clients are able to address the queues of the server.

Especially in large networks it may make sense to grant access to all clients, but to send browsing information only to some of the clients (e.g., only to the clients located in the same department or building as the server).

**IV) Restart the cupsd.**

#### Get CUPS debug messages if it does not work

The CUPS log file /var/log/cups/error\_log contains log messages that could be useful for troubleshooting - but it does not contain debug messages by default.

To get CUPS debug messages, see the section "Usually provide CUPS debug messages" in [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

Provided you have CUPS debug messages but those messages do not help you to find the root cause why it does not work, you may ask for help as described in [SDB:How to Report a Printing Issue](/SDB%3AHow_to_Report_a_Printing_Issue "SDB:How to Report a Printing Issue").

#### Configuration of CUPS <= 1.5 clients

**Recommended:**

1. Activate /etc/init.d/cups so that cupsd is started when the client is booted.
2. Start cupsd.

From SUSE LINUX 9.1, this takes place by default. If necessary, this can be done with the YaST Runlevel Editor or with insserv. Under normal circumstances, you should not configure anything else, especially

* no local queues on clients and
* no changes in the default settings for cupsd on clients.

#### Special cases for configuration of CUPS <= 1.5 clients

**Optional:**

Insert entries in the form "BrowseAllow IP.of.desired.server" and "BrowseDeny IP.of.unwanted.server" in /etc/cups/cupsd.conf in order to reject all kinds of packets (including browsing information) from undesired servers. We recommend the use of IP addresses instead of names. In certain cases, it may be useful to adapt the "BrowseOrder" entry.

If there are servers that do not send any browsing information but whose queues can be accessed (e.g., servers in other departments or buildings), you may want to poll the server's browsing information. To do this, insert an entry in the form "BrowsePoll IP.of.the.server:631" for every server in /etc/cups/cupsd.conf. We recommend the use of IP addresses instead of names. By default, the port on the server is 631. After cupsd is restarted, a cups-polld will be started for every "BrowsePoll" entry.

Either change /etc/cups/cupsd.conf manually or use YaST. Since openSUSE 11.3 use in YaST the "Print via Network" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

**If browsing is generally undesired:**

Set "Browsing Off" in /etc/cups/cupsd.conf. This does not mean that the queues on the server can no longer be accessed. Utilities like the command-line tools can still be used; however, the server must be specified explicitly (normally with the option "-h", see the man pages).

**Client-only configuration:**

If browsing is generally undesired, there is no reason for running a cupsd on the client. In this case, a client-only configuration should be used. Either set it up manually as described below or use YaST. Since openSUSE 11.1 use in YaST the "Print via Network" dialog, see [YaST Printer](/YaST_Printer "YaST Printer").

1. Stop and deactivate cupsd (using the YaST Runlevel Editor or insserv).
2. In /etc/cups/client.conf, insert an entry in the form "ServerName IP.of.the.server".

Such an entry in /etc/cups/client.conf should not exist together with a running local cupsd. As only one entry is possible, the preferred server should be entered. To access a different server, the server must be specified explicitly (option "-h") when using the command-line tools, or the environment variable CUPS\_SERVER must be set accordingly. Some applications ignore the "ServerName" entry. In this case, it may be useful to set CUPS\_SERVER, or the server can be specified explicitly in the application (e.g., with the option "-h" in the print command).

**Minimal client installations:**

The standard minimum requirement for addressing CUPS servers is to install the "cups-libs" and "cups-client" packages. In this case, servers can be addressed with the command-line tools.

The absolute minimum requirement for addressing a CUPS server is to install only the "cups-libs" package. In this case, only application programs that use the CUPS libraries directly can print.

#### Regarding firewall

If the CUPS server and the client systems are in an internal network and when you trust all what there is in your internal network, your network interface must be set to be in the
"internal zone".

It doesn't make sense to have a network setup in a trusted internal network with a network interface which belongs to the untrusted "external zone" (which is the default to be safe).

In particular do not disable firewall protection for CUPS (i.e. for IPP which uses TCP port 631 and UDP port 631) for the untrusted "external zone".

See the Support Database article [CUPS and SANE Firewall settings](/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings").

#### Allow printer admin tasks for a normal user

Since openSUSE 10.2 / CUPS 1.2 with an original CUPS 1.2 (or later) cupsd.conf file (which supports CUPS operation policies) you could allow printer admin tasks for a normal user as follows:

```
<Policy default>
...
<Limit ... CUPS-Add-Modify-Printer ...>
Require user @SYSTEM normal-user

```

Replace "normal-user" with the system user name (i.e. the user name in /etc/passwd) of the normal user who should be allowed to do printer admin tasks and restart the cupsd.

For details regarding "Operation Policies" see <https://www.cups.org/doc/policies.html>

Have in mind that a user who is allowed to do printer admin tasks can change the print queues as he likes. For example he could let (possibly confidential) print jobs print as usual (so that the betrayal is not easily noticed) but additionally send a copy of what is printed to any external destination.

**In this context a general security advice:**

When root allows normal users to do system administration tasks, in particular when root allows normal users to administer system processes (i.e. processes that run as root like the cupsd), then this or that kind of privilege escalation will be possible.

Only trustworthy users who do not misuse their privileges may get allowed to do specific system administration tasks.

## See also

[Portal:Printing](/Portal%3APrinting "Portal:Printing")

[SDB:Installing a Printer](/SDB%3AInstalling_a_Printer "SDB:Installing a Printer")

[SDB:Purchasing a Printer and Compatibility](/SDB%3APurchasing_a_Printer_and_Compatibility "SDB:Purchasing a Printer and Compatibility")

[SDB:Printing via TCP/IP network](/SDB%3APrinting_via_TCP/IP_network "SDB:Printing via TCP/IP network")

[SDB:CUPS and SANE Firewall settings](/SDB%3ACUPS_and_SANE_Firewall_settings "SDB:CUPS and SANE Firewall settings")

[YaST Printer](/YaST_Printer "YaST Printer")

Retrieved from "<https://en.opensuse.org/index.php?title=SDB:CUPS_in_a_Nutshell&oldid=182803>"

[Category](/Special%3ACategories "Special:Categories"):

* [SDB:Printing](/Category%3ASDB%3APrinting "Category:SDB:Printing")

This page was last edited on 14 December 2023, at 09:48. Content is available under [GNU Free Documentation License 1.2](https://www.gnu.org/licenses/fdl-1.2.html) unless otherwise noted. This page has been accessed 159,752 times.

* [Privacy policy](/openSUSE%3APrivacy_policy "openSUSE:Privacy policy")
* [About openSUSE Wiki](/openSUSE%3AAbout "openSUSE:About")
* [Disclaimers](/Terms_of_site "Terms of site")

Â© 2001â€“2025 SUSE LLC, Â© 2005â€“2025 openSUSE contributors & others.

Sponsors

[![Sponsor](https://static.opensuse.org/themes/bento/images/sponsors/sponsor_heinlein.png)](/Sponsors)

##### Log in

Ã—

Username

Password

[Create account](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
Cancel
Log in



=== Content from build.opensuse.org_1271e0aa_20250115_140242.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. [Printing](/project/show/Printing)
2. [cups](/package/show/Printing/cups)
3. cups.spec

[Overview](/package/show/Printing/cups)
[Repositories](/repositories/Printing/cups)
[Revisions](/package/revisions/Printing/cups)
[Requests](/package/requests/Printing/cups)
[Users](/package/users/Printing/cups)
[Attributes](/attribs/Printing/cups)
[Meta](/projects/Printing/packages/cups/meta)

### File cups.spec of Package cups

#
# spec file for package cups
#
# Copyright (c) 2024 SUSE LLC
#
# All modifications and additions to the file contributed by third parties
# remain the property of their copyright owners, unless otherwise agreed
# upon. The license for this file, and modifications and additions to the
# file, is the same license as for the pristine package itself (unless the
# license for the pristine package is not an Open Source License, in which
# case the license is the MIT License). An "Open Source License" is a
# license that conforms to the Open Source Definition (Version 1.9)
# published by the Open Source Initiative.
# Please submit bugfixes or comments via https://bugs.opensuse.org/
#
# By default enable testsuite (i.e. in the 'check' section run 'make test')
# cf. https://rpm.org/user\_doc/conditional\_builds.html
# To disable the testsuite you may set 'bcond\_with testsuite' instead
# until https://github.com/OpenPrinting/cups/issues/155 is actually fixed
# but we do not error out when 'make test' fails (see the 'check' section):
%bcond\_without testsuite
# \_tmpfilesdir is not defined in systemd macros up to openSUSE 13.2
%{!?\_tmpfilesdir: %global \_tmpfilesdir /usr/lib/tmpfiles.d }
# dbus too old in SLE 12
%if 0%{?suse\_version} < 1500
%define dbus\_dir %{\_sysconfdir}/dbus-1
%define dbus\_config %config
%else
%define dbus\_dir %{\_datadir}/dbus-1
%define dbus\_config %nil
%endif
Name: cups
# CUPS beta version numbers like "2.3b6" can be used as is because
# "zypper vcmp 2.3.b99 2.3.0" shows "2.3.b99 is older than 2.3.0" and
# "zypper vcmp 2.2.99 2.3b6" show "2.2.99 is older than 2.3b6" so that
# version upgrades from 2.2.x via 2.3.b\* to 2.3.0 work:
Version: 2.4.11
Release: 0
Summary: The Common UNIX Printing System
License: Apache-2.0
Group: Hardware/Printing
URL: https://openprinting.github.io/cups
# To get Source0 go to https://github.com/OpenPrinting/cups/releases or use e.g.
# wget --no-check-certificate -O cups-2.4.11-source.tar.gz https://github.com/OpenPrinting/cups/releases/download/v2.4.11/cups-2.4.11-source.tar.gz
Source0: https://github.com/OpenPrinting/cups/releases/download/v2.4.11/cups-2.4.11-source.tar.gz
# To get Source1 go to https://github.com/OpenPrinting/cups/releases or use e.g.
# wget --no-check-certificate -O cups-2.4.11-source.tar.gz.sig https://github.com/OpenPrinting/cups/releases/download/v2.4.11/cups-2.4.11-source.tar.gz.sig
Source1: https://github.com/OpenPrinting/cups/releases/download/v2.4.11/cups-2.4.11-source.tar.gz.sig
# To make Source2 use e.g.
# gpg --keyserver keys.openpgp.org --recv-keys 7082A0A50A2E92640F3880E0E4522DCC9B246FF7
# gpg --export --armor 7082A0A50A2E92640F3880E0E4522DCC9B246FF7 >cups.keyring
# See https://github.com/OpenPrinting/cups/discussions/327#discussioncomment-2060579
# PGP Fingerprint: 7082A0A50A2E92640F3880E0E4522DCC9B246FF7
Source2: cups.keyring
# To manually verify Source0 with Source1 and Source2 do e.g.
# gpg --import cups.keyring
# gpg --list-keys | grep -1 'Zdenek Dohnal'
# gpg --verify cups-2.4.11-source.tar.gz.sig cups-2.4.11-source.tar.gz
Source102: Postscript.ppd.gz
Source105: Postscript-level1.ppd.gz
Source106: Postscript-level2.ppd.gz
Source108: cups-client.conf
Source109: baselibs.conf
# Patch0...Patch9 is for patches from upstream:
# Source10...Source99 is for sources from SUSE which are intended for upstream:
# Patch10...Patch99 is for patches from SUSE which are intended for upstream:
# Patch10 cups-2.1.0-choose-uri-template.patch adds 'smb://...' URIs to templates/choose-uri.tmpl:
Patch10: cups-2.1.0-choose-uri-template.patch
# Patch11 cups-2.1.0-default-webcontent-path.patch changes the default path whereto the
# web content is installed from /usr/share/doc/cups to /usr/share/cups/webcontent
# because the files of the CUPS web content are no documentation, see CUPS STR #3578
# and https://bugzilla.suse.com/show\_bug.cgi?id=546023#c6 and subsequent comments:
Patch11: cups-2.1.0-default-webcontent-path.patch
# Patch100...Patch999 is for private patches from SUSE which are not intended for upstream:
# Patch100 cups-pam.diff adds conf/pam.suse regarding support for PAM for SUSE:
Patch100: cups-pam.diff
# Patch103 cups-1.4-do\_not\_strip\_recommended\_from\_PPDs.patch
# reverts the change which was added by Michael Sweet in Jan 2007
# which strips the word "recommended" from NickName in PPDs because
# at least yast2-printer in SUSE needs it, compare the
# 'Why not "recommend" PPDs in the NickName?' and the subsequent
# 'RFC: New Driver Rating/Information Attributes' mail thread on cups@easysw.com:
Patch103: cups-1.4-do\_not\_strip\_recommended\_from\_PPDs.patch
# Patch104 cups-config-libs.patch fixes option --libs in cups-config script:
Patch104: cups-config-libs.patch
# Patch107 harden\_cups.service.patch adds hardening to systemd service cups.service
# see https://bugzilla.suse.com/show\_bug.cgi?id=1181400
# and https://en.opensuse.org/openSUSE:Security\_Features#Systemd\_hardening\_effort
# where the default hardening settings are enhanced by adding
# ReadWritePaths=/etc/cups because cupsd needs write access in /etc/cups
# see https://bugzilla.suse.com/show\_bug.cgi?id=1195288
Patch107: harden\_cups.service.patch
# Patch108 downgrade-autoconf-requirement.patch
# downgrades the autoconf requirement in configure.ac from autoconf 2.71 to autoconf 2.69
# that is available in Tumbleweed as of this writing (March 2022)
Patch108: downgrade-autoconf-requirement.patch
# Patch112 cups-2.4.2-additional\_policies.patch adds the 'allowallforanybody' policy to cupsd.conf
# see SUSE FATE 303515 and https://bugzilla.suse.com/show\_bug.cgi?id=936309
Patch112: cups-2.4.2-additional\_policies.patch
# Build Requirements:
BuildRequires: dbus-1-devel
BuildRequires: fdupes
BuildRequires: gcc-c++
BuildRequires: gnutls-devel
BuildRequires: libavahi-devel
BuildRequires: libgcrypt-devel
BuildRequires: libjpeg-devel
BuildRequires: libpng-devel
BuildRequires: libtiff-devel
BuildRequires: libtool
BuildRequires: libusb-1\_0-devel
BuildRequires: pam-devel
BuildRequires: pkgconfig
BuildRequires: zlib-devel
%if 0%{?suse\_version} >= 1315
BuildRequires: pkgconfig(krb5)
%else
BuildRequires: krb5-devel
%endif
%if 0%{?suse\_version} > 1310
BuildRequires: pkgconfig(libsystemd)
%else
BuildRequires: pkgconfig(libsystemd-daemon)
%endif
BuildRequires: pkgconfig(systemd)
# Require the exact matching version-release of the cups-client sub-package
# (that requires all native CUPS libraries i.e. the libcups\* sub-packages)
# and the cups-config sub-package.
# The exact matching version-release of each sub-package is available
# on the same package repository where the cups package is because
# all are built simulaneously from the same cups source package
# and all required packages are provided on the same repository:
Requires: cups-client = %{version}-%{release}
Requires: cups-config = %{version}-%{release}
Requires(pre): %{\_sbindir}/groupadd
Requires(pre): coreutils
# Cf. https://en.opensuse.org/openSUSE:Systemd\_packaging\_guidelines
# versus https://lists.opensuse.org/opensuse-factory/2015-03/msg00218.html
%{?systemd\_requires}
# Since CUPS 1.6 all non-Mac filters are dropped from CUPS
# and provided in the separated cups-filters software from OpenPrinting.org:
Recommends: cups-filters
# Our Source105 PSLEVEL1.PPD.bz2 and Source106 PSLEVEL2.PPD.bz2 need foomatic-rip
# but this does not justify a RPM Requires so that a weak Recommends is sufficient:
Recommends: foomatic-filters
# The Ghostscript device "cups" is needed by several CUPS filters
# (in particular the "rasterto..." filters) which might justify a RPM Requires.
# But a RPM requirement for ghostscript would cause a build dependency cycle because
# cups Requires ghostscript which BuildRequires cups-devel which Requires libcups2
# and libcups2 is a sub-package of cups so that there is an implicit build dependency
# cycle between the main-packages cups and ghostscript.
# Furthermore, Ghostscript is not needed on a system where those CUPS filters are not used
# (e.g. on client systems in the network where the filtering hapens on a CUPS server
# or on a CUPS server with only "raw" queues), so that a weak Recommends fits better:
Recommends: ghostscript
# Install into this non-root directory (required when it is built as non-root user):
BuildRoot: %{\_tmppath}/%{name}-%{version}-build
# Conflicts with other print spoolers which provide same binaries like
# /usr/bin/lp and so on or which may listen on the same port (e.g. cups-lpd
# versus traditional lpd on port 515):
Conflicts: lprng
Conflicts: lprold
Conflicts: plp
%description
CUPS is a modular printing system which allows a computer to act as a
print server. A computer running CUPS is a host that can accept print
jobs from client computers, process them, and send them to the
appropriate printer.
CUPS consists of a print spooler and scheduler, a filter system that
converts the print data to a format that the printer will understand,
and a backend system that sends this data to the print device. CUPS
uses the Internet Printing Protocol (IPP) as the basis for managing
print jobs and queues. It also provides the traditional command line
interfaces for the System V and Berkeley print systems, and provides
support for the Berkeley print system's Line Printer Daemon protocol
and limited support for the server message block (SMB) protocol.
CUPS comes with a built-in web-based interface.
%package -n libcups2
Summary: HTTP/IPP communication and printer queue and job library
Group: System/Libraries
Requires: cups-config
Obsoletes: cups-libs < %{version}-%{release}
Provides: cups-libs = %{version}-%{release}
%description -n libcups2
The CUPS library contains all of the core HTTP and IPP communications
code as well as convenience functions for queuing print jobs, getting
printer information, accessing resources via HTTP and IPP, and
manipulating PPD files. The scheduler and all commands, filters, and
backends use this library.
%package -n libcupsimage2
Summary: CUPS library for working with large images
Group: System/Libraries
%description -n libcupsimage2
The CUPS imaging library provides functions for managing large
images, doing colorspace conversion and color management, scaling
images for printing, and managing raster page streams. It is used by
the CUPS image file filters, the PostScript RIP, and all raster
printers drivers.
%package config
Summary: CUPS library configuration files
Group: Hardware/Printing
%if 0%{?suse\_version} >= 1330
Requires(pre): user(lp)
Requires(pre): group(lp)
%endif
%description config
CUPS is a modular printing system which allows a computer to act as a
print server.
This subpackage contains some basic configuration files for its
operation.
%package client
Summary: CUPS Client Programs
# Require the exact matching version-release of the libcups\* sub-packages because
# non-matching CUPS libraries may let CUPS software crash (e.g. segfault)
# because all CUPS software is provided as one single CUPS source tarball
# and there are CUPS-internal dependencies via CUPS private API calls
# (which do not happen for third-party software which uses only the CUPS public API).
# The exact matching version-release of each libcups\* sub-package is available
# on the same package repository where the cups package is because
# all are built simultaneously from the same cups source package
# and all required packages are provided on the same repository:
Group: Hardware/Printing
Requires: libcups2 = %{version}-%{release}
Requires: libcupsimage2 = %{version}-%{release}
# Conflicts with other print spoolers which provide same binaries like /usr/bin/lp and so on:
Conflicts: lprng
Conflicts: lprold
Conflicts: plp
%description client
CUPS is a modular printing system which allows a computer to act as a
print server. A computer running CUPS is a host that can accept print
jobs from client computers, process them, and send them to the
appropriate printer.
This package contains the traditional command line interfaces for the
System V and Berkeley print systems.
%package devel
Summary: Development Environment for CUPS
# Do not require the exact matching version-release
# of the native CUPS libraries (i.e. the libcups\* sub-packages)
# but only CUPS libraries with matching version because
# for building third-party software which uses only the CUPS public API
# there are no CUPS-internal dependencies via CUPS private API calls
# (the latter would require the exact matching CUPS libraries version-release):
Group: Development/Libraries/C and C++
Requires: glibc-devel
Requires: libcups2 = %{version}
Requires: libcupsimage2 = %{version}
# make sure printer drivers benefit from automatic provides
%if 0%{?suse\_version} >= 1500
Requires: cups-rpm-helper
%endif
%description devel
CUPS is a modular printing system which allows a computer to act as a
print server.
This subpackage contains the header files for developing applications
that want to make use of libcups for adding print support.
%package ddk
Summary: CUPS Driver Development Kit
Group: Hardware/Printing
Requires: cups = %{version}
Requires: cups-devel = %{version}
# Since CUPS 1.4 the CUPS Driver Development Kit (DDK) is bundled with CUPS.
# For CUPS 1.2.x and 1.3.x, the DDK was separated software
# which we provided (up to openSUSE 11.1 / SLE11) in our cupsddk package:
Provides: cupsddk = %{version}
Obsoletes: cupsddk < %{version}
%description ddk
The CUPS Driver Development Kit (DDK) provides
a suite of standard drivers, a PPD file compiler,
and other utilities that can be used to develop
printer drivers for CUPS.
%prep
%setup -q
# Patch0...Patch9 is for patches from upstream:
# Patch10...Patch99 is for patches from SUSE which are intended for upstream:
# Patch10 cups-2.1.0-choose-uri-template.patch adds 'smb://...' URIs to templates/choose-uri.tmpl:
%patch -P 10 -b choose-uri-template.orig
# Patch11 cups-2.1.0-default-webcontent-path.patch changes the default path whereto the
# web content is installed from /usr/share/doc/cups to /usr/share/cups/webcontent
# because the files of the CUPS web content are no documentation, see CUPS STR #3578
# and https://bugzilla.suse.com/show\_bug.cgi?id=546023#c6 and subsequent comments:
%patch -P 11 -b default-webcontent-path.orig
# Patch100...Patch999 is for private patches from SUSE which are not intended for upstream:
# Patch100 cups-pam.diff adds conf/pam.suse regarding support for PAM for SUSE:
%patch -P 100 -b cups-pam.orig
# Patch103 cups-1.4-do\_not\_strip\_recommended\_from\_PPDs.patch
# reverts the change which was added by Michael Sweet in Jan 2007
# which strips the word "recommended" from NickName in PPDs because
# at least yast2-printer in SUSE needs it, compare the
# 'Why not "recommend" PPDs in the NickName?' and the subsequent
# 'RFC: New Driver Rating/Information Attributes' mail thread on cups@easysw.com:
%patch -P 103 -b do\_not\_strip\_recommended\_from\_PPDs.orig
# Patch104 cups-config-libs.patch fixes option --libs in cups-config script:
%patch -P 104 -b cups-config-libs.orig
# Patch107 harden\_cups.service.patch adds hardening to systemd service cups.service
# see https://bugzilla.suse.com/show\_bug.cgi?id=1181400
# and https://en.opensuse.org/openSUSE:Security\_Features#Systemd\_hardening\_effort
# where the default hardening settings are enhanced by adding
# ReadWritePaths=/etc/cups because cupsd needs write access in /etc/cups
# see https://bugzilla.suse.com/show\_bug.cgi?id=1195288
%patch -P 107 -p1 -b harden\_cups.service.orig
# Patch108 downgrade-autoconf-requirement.patch
# downgrades the autoconf requirement to the autoconf available in Tumbleweed as of this writing:
%patch -P 108 -b downgrade-autoconf-requirement.orig
# Patch112 cups-2.4.2-additional\_policies.patch adds the 'allowallforanybody' policy to cupsd.conf
# see SUSE FATE 303515 and https://bugzilla.suse.com/show\_bug.cgi?id=936309
%patch -P 112 -b cups-2.4.2-additional\_policies.orig
%build
# Remove ".SILENT" rule for verbose build output
sed 's#^.SILENT:##g' -i Makedefs.in
aclocal -I config-scripts
autoconf -I config-scripts
# Export the build options we desire
export CXXFLAGS="$CXXFLAGS %{optflags} -O2 -fstack-protector -fPIE -fPIC"
export CFLAGS="$CFLAGS %{optflags} -fstack-protector -fPIE -fPIC"
export LDFLAGS="-pie"
export CXX=c++
export CC=cc
# As long as cups-2.1.0-default-webcontent-path.patch is applied
# configure --with-docdir=... would be no longer needed
# because cups-2.1.0-default-webcontent-path.patch changes the
# default with-docdir path whereto the web content is installed
# from /usr/share/doc/cups to /usr/share/cups/webcontent because the
# files of the CUPS web content are no documentation, see CUPS STR #3578
# and https://bugzilla.suse.com/show\_bug.cgi?id=546023#c6 and subsequent comments
# so that the new default could be used as is but upstream may accept
# cups-2.1.0-default-webcontent-path.patch in general but change its default
# so that with-docdir is explicitly set here to be future proof.
# Regarding --with-rundir and --with-domainsocket
# see https://www.cups.org/str.php?L4306 and
# http://lists.opensuse.org/opensuse-factory/2013-01/msg00578.html
# --without-perl/php - neither actually work correctly so rather disable
# --without-xinetd - socket activation from systemd works better
# --enable-debug - avoids stripping of binaries
# --enable-relro - force relro sections in binaries/libs
%configure \
--enable-option-checking \
--with-docdir=%{\_datadir}/cups/webcontent \
--with-cups-user=lp \
--with-cups-group=lp \
--with-system-groups=root \
--enable-debug \
--enable-debug-printfs \
--enable-relro \
--enable-gssapi \
--enable-libusb \
--disable-static \
--without-rcdir \
--with-cachedir=%{\_localstatedir}/cache/cups \
--with-rundir=/run/cups \
--with-domainsocket=/run/cups/cups.sock \
--enable-dbus \
--enable-pam \
--enable-threads \
--enable-gnutls \
--enable-systemd \
--enable-avahi --disable-dnssd \
--enable-libpaper \
--without-perl \
--without-php \
--with-xinetd=no \
--enable-webif \
localedir=%{\_datadir}/locale
make %{?\_smp\_mflags}
%install
make BUILDROOT=%{buildroot} DBUSDIR=%{dbus\_dir} install
# Make directory for ssl files:
mkdir -p %{buildroot}%{\_sysconfdir}/cups/ssl
# Add a client.conf as template (Source108: cups-client.conf):
install -m644 %{SOURCE108} %{buildroot}%{\_sysconfdir}/cups/client.conf
# Make the libraries accessible also via generic named links:
ln -sf libcupsimage.so.2 %{buildroot}%{\_libdir}/libcupsimage.so
ln -sf libcups.so.2 %{buildroot}%{\_libdir}/libcups.so
# Move /usr/lib/pkgconfig/cups.pc to \_libdir if it is not there
# to avoid a conflict that cups-devel and cups-devel-32bit
# would both contain /usr/lib/pkgconfig/cups.pc because
# when cups.pc is arch dependent it has to be in \_libdir
# which it is because it contains 'libdir=/usr/lib64' on x86\_64
# (if it was arch independent it would have to be in \_datadir)
# cf. https://build.opensuse.org/request/show/965680
test -d %{buildroot}%{\_libdir}/pkgconfig || mv %{buildroot}/usr/lib/pkgconfig %{buildroot}%{\_libdir}/pkgconfig
# Add missing usual directories:
install -d -m755 %{buildroot}%{\_datadir}/cups/drivers
install -d -m755 %{buildroot}%{\_localstatedir}/cache/cups
# Add conf/pam.suse regarding support for PAM (see Patch100: cups-pam.diff):
%if 0%{?suse\_version} > 1500
install -d -m755 %{buildroot}%{\_pam\_vendordir}
install -m 644 -D conf/pam.suse %{buildroot}%{\_pam\_vendordir}/cups
# remove /etc/pam.d/cups from conf/pam.std
rm -rf %{buildroot}%{\_sysconfdir}/pam.d
%else
install -m 644 -D conf/pam.suse %{buildroot}%{\_sysconfdir}/pam.d/cups
%endif
# Add missing usual documentation.
install -d -m755 %{buildroot}/%{\_defaultdocdir}/cups
for f in CHANGES.md CREDITS.md INSTALL.md LICENSE README.md
do install -m 644 "$f" %{buildroot}%{\_defaultdocdir}/cups/
done
# Add generic PostScript printer PPDs:
# Source102: Postscript.ppd.gz
install -m 644 %{SOURCE102} %{buildroot}%{\_datadir}/cups/model/Postscript.ppd.gz
# Source105: Postscript-level1.ppd,gz
install -m 644 %{SOURCE105} %{buildroot}%{\_datadir}/cups/model/Postscript-level1.ppd.gz
# Source106: Postscript-level2.ppd.gz
install -m 644 %{SOURCE106} %{buildroot}%{\_datadir}/cups/model/Postscript-level2.ppd.gz
# Rm files for desktop menu:
rm -f %{buildroot}%{\_datadir}/applications/cups.desktop
rm -rf %{buildroot}%{\_datadir}/icons
# Save /etc/cups/cupsd.conf and /etc/cups/cupsd.conf.default from becoming hardlinked
# via the fdupes run below, see https://bugzilla.suse.com/show\_bug.cgi?id=773971
# by making their content different and at the same time fix the misleading comment.
# Intentionally let the build fail if 'grep' does not find what 'sed' should change
# because if upstream changed it 'sed' would silently no longer change the files:
grep -q '^# Configuration ' %{buildroot}/%{\_sysconfdir}/cups/cupsd.conf.default
sed -i -e 's/^# Configuration /# Default configuration /' %{buildroot}/%{\_sysconfdir}/cups/cupsd.conf.default
%if 0%{?suse\_version} < 1600
# rcbla aliases:
ln -s service %{buildroot}%{\_sbindir}/rccups
ln -s service %{buildroot}%{\_sbindir}/rccups-lpd
%endif
# Install /usr/lib/tmpfiles.d/cups.conf
# According to
# https://developers.redhat.com/blog/2016/09/20/managing-temporary-files-with-systemd-tmpfiles-on-rhel7/
# d /var/spool/cups/tmp - - - 30d
# results that each file older than 30 days on /var/spool/cups/tmp will be deleted where a file
# will be considered unused only if atime, mtime and ctime are all older than the specified time.
# We use group 'root' for /run/cups/certs (instead of 'sys')
# d /run/cups/certs 0511 lp root -
# because of https://bugzilla.opensuse.org/show\_bug.cgi?id=1042916
mkdir -p %{buildroot}%{\_tmpfilesdir}
cat > %{buildroot}%{\_tmpfilesdir}/cups.conf <<EOF
# See tmpfiles.d(5) for details
# Type(d=directory) Path Mode UID GID Age(until delete when cleaning)
d /run/cups 0755 root lp -
d /run/cups/certs 0511 lp root -
d %{\_localstatedir}/spool/cups/tmp - - - 30d
EOF
# Never run fdupes carelessly over the whole buildroot directory
# because in older openSUSE and SLE11 versions fdupes
# links files with different owner, group, or permissions
# see https://bugzilla.suse.com/show\_bug.cgi?id=784670
# and even in current openSUSE versions fdupes links across sub-package
# boundaries, compare https://bugzilla.suse.com/show\_bug.cgi?id=784869
%fdupes -s %{buildroot}/%{\_datadir}/cups/templates
%check
%if %{with testsuite}
# There appears to be some kind of race condition when running 'make test'
# cf. https://github.com/OpenPrinting/cups/issues/155
# so we do not call 'make %{?\_smp\_mflags} test' but plain 'make test'
# cf. https://github.com/OpenPrinting/cups/issues/155#issuecomment-802886811
# We print the log files for debugging purposes if the testsuite fails.
# The log files in the test directory are named like
# access\_log-2022-03-04-abuild
# debug\_log-2022-03-04-abuild
# error\_log-2022-03-04-abuild
# page\_log-2022-03-04-abuild
# We do not error out because https://github.com/OpenPrinting/cups/issues/155
# is not yet actually fixed so currently the testsuite still sometimes fails:
echo "TEST: running 'make test'"
if make test
then echo "TEST: succeeded"
else echo "TEST: 'make test' FAILED"
for logfile in test/\*\_log-\*-$(whoami)
do echo "TEST: printing log file $logfile:"
cat $logfile
echo "TEST: end of log file $logfile"
done
echo "TEST: end of printing log files"
fi
%else
echo "TEST: skipped 'make test', cf. https://github.com/OpenPrinting/cups/issues/155"
%endif
%pre -p /bin/bash
%if 0%{?suse\_version} > 1500
# Prepare for migration to /usr/etc; save any old .rpmsave
for i in pam.d/cups ; do
test -f %{\_sysconfdir}/${i}.rpmsave && mv -v %{\_sysconfdir}/${i}.rpmsave %{\_sysconfdir}/${i}.rpmsave.old ||:
done
%endif
%service\_add\_pre cups.service cups-lpd.socket cups.socket
%post -p /bin/bash
%if 0
# Use %%tmpfiles\_create when 13.2 is oldest in support scope
%endif
/usr/bin/systemd-tmpfiles --create %{\_tmpfilesdir}/cups.conf || :
%service\_add\_post cups.service cups-lpd.socket cups.socket
%preun -p /bin/bash
%service\_del\_preun cups.service cups-lpd.socket cups.socket
%postun -p /bin/bash
%service\_del\_postun cups.service cups-lpd.socket cups.socket
# Removed code comments from expanded scriptlets to reduce scriptlet size in binary RPMs
# but then users could no longer see the comments via "rpm -q --scripts cups"
# cf. https://build.opensuse.org/request/show/879976
%posttrans -p /bin/bash
%if 0
# Use a real bash script with an explicit "exit 0" at the end to be by default fail safe
# an explicit "exit 1" must be use to enforce package install/upgrade/erase failure where needed
# see the "Shared\_libraries" section in http://en.opensuse.org/openSUSE:Packaging\_scriptlet\_snippets
# Begin refresh systemd units and clean up possibly obsolete systemd units
# The following is a generic way how to refresh and/or clean up systemd units.
# A systemd unit may need a refresh after updating a package when the new package
# had installed a changed systemd unit file for an enabled systemd unit.
# A systemd unit may become obsolete by updating a package (see bnc#904215).
# A systemd unit is considered to have become obsolete when the systemd
# symlink /etc/systemd/system/.../unit\_name -> /path/to/unit\_file is broken.
# When during package update the new package does no longer provide a unit file
# then the systemd symlink becomes broken after the files of the old package
# had been actually removed by RPM.
# According to /usr/share/doc/packages/rpm/manual/triggers and according
# to https://en.opensuse.org/openSUSE:Packaging\_scriptlet\_snippets#Scriptlet\_Ordering
# and http://fedoraproject.org/wiki/Packaging:ScriptletSnippets#Scriptlet\_Ordering
# from the new package only "posttrans of new package" is run after "removal of old package"
# so that the new package must do the clean up as RPM posttrans scriptlet.
%endif
for u in cups.service cups.socket cups.path; do
if systemctl --quiet is-enabled $u 2>/dev/null
then
%if 0
# Refresh still valid enabled systemd units and clean up possibly obsoleted systemd units:
# Enforce systemd to use the current unit file which is usually the unit file of the new package
# but also in case of custom units (that use other unit files) a "reenable" won't hurt because
# "reenable" does not implicitly stop a running service which is "the right thing" because
# a RPM package installation must not automatically disrupt (restart) a running service.
# Using "--force reenable" is essential to clean up possibly conflicting/broken symlinks.
# (without "|| :" build fails with "Failed to get D-Bus connection: No connection to service manager. posttrans script ... failed"):
%endif
systemctl --quiet --force reenable $u 2>/dev/null || :
else
%if 0
# Refresh still valid disabled systemd units and clean up possibly obsoleted systemd units:
# First using "--force reenable" is essential to clean up possibly conflicting/broken symlinks
# because there is no "--force disable" that would clean up possibly conflicting/broken symlinks
# see https://bugzilla.opensuse.org/show\_bug.cgi?id=904215#c34
# so that first the unit has a clean state and then it is set back to disabled (as it was before).
# If a disabled systemd unit has become obsoleted, "systemctl --force reenable" will clean it up
# which means the unit gets removed and the subsequent "systemctl disable" will do nothing.
# (without "|| :" build fails with "Failed to get D-Bus connection: No connection to service manager. posttrans script ... failed"):
%endif
systemctl --quiet --force reenable $u 2>/dev/null || :
systemctl --quiet disable $u 2>/dev/null || :
fi
done
%if 0%{?suse\_version} > 1500
# Migration to /usr/etc, restore just created .rpmsave
for i in pam.d/cups ; do
test -f %{\_sysconfdir}/${i}.rpmsave && mv -v %{\_sysconfdir}/${i}.rpmsave %{\_sysconfdir}/${i} ||:
done
%endif
exit 0
%post -n libcups2 -p /sbin/ldconfig
%postun -n libcups2 -p /sbin/ldconfig
%post -n libcupsimage2 -p /sbin/ldconfig
%postun -n libcupsimage2 -p /sbin/ldconfig
%files
%defattr(-,root,root)
# In particular all executables are listed explicitly.
# This avoids that CUPS' configure magic might silently
# not build and install an executable when whatever condition
# for configure's automated tests is not fulfilled in the build system.
# See https://bugzilla.suse.com/show\_bug.cgi?id=526847#c9
# Regarding specific owner group and permission settings for directories
# see https://bugzilla.suse.com/show\_bug.cgi?id=1184161
# When cupsd creates directories with specific owner group and permissions
# (usually owner is 'root' and group matches "configure --with-cups-group=lp")
# we must specify same owner group and permission settings here
# to ensure those directories are installed by RPM with the right settings
# because if those directories were installed by RPM with different settings then
# cupsd would use them as is and not adjust its specific owner group and permissions.
# How cupsd creates those directories:
# drwxr-xr-x ... root lp ... /etc/cups/ppd
# see https://bugzilla.suse.com/show\_bug.cgi?id=1184161#c7
# The /etc/cups/ssl directory is not created by cupsd (but needed by it)
# and when needed (e.g. during the first run of "# lpstat -E -p")
# cupsd creates files in /etc/cups/ssl like localhost.crt and localhost.key
# so we specify secure owner group and permissions for /etc/cups/ssl
%config(noreplace) %attr(640,root,lp) %{\_sysconfdir}/cups/cups-files.conf
%config(noreplace) %attr(640,root,lp) %{\_sysconfdir}/cups/cupsd.conf
%config(noreplace) %attr(640,root,lp) %{\_sysconfdir}/cups/snmp.conf
%if 0%{?suse\_version} > 1500
%{\_pam\_vendordir}/cups
%else
%config %{\_sysconfdir}/pam.d/cups
%endif
%dbus\_config %{dbus\_dir}/system.d/cups.conf
%config %{\_sysconfdir}/cups/cupsd.conf.default
%config %{\_sysconfdir}/cups/cups-files.conf.default
%config %{\_sysconfdir}/cups/snmp.conf.default
%dir %attr(755,root,lp) %{\_sysconfdir}/cups/ppd
%dir %attr(700,root,root) %{\_sysconfdir}/cups/ssl
%{\_unitdir}/cups.service
%{\_unitdir}/cups.socket
%{\_unitdir}/cups.path
%{\_unitdir}/system-cups.slice
%{\_unitdir}/cups-lpd.socket
%{\_unitdir}/cups-lpd@.service
%{\_tmpfilesdir}/cups.conf
%{\_bindir}/cupstestppd
%{\_sbindir}/cupsctl
%{\_sbindir}/cupsd
%{\_sbindir}/cupsfilter
%if 0%{?suse\_version} < 1600
%{\_sbindir}/rccups
%{\_sbindir}/rccups-lpd
%endif
%dir /usr/lib/cups
%dir /usr/lib/cups/backend
/usr/lib/cups/backend/dnssd
/usr/lib/cups/backend/http
/usr/lib/cups/backend/https
/usr/lib/cups/backend/ipp
/usr/lib/cups/backend/ipps
/usr/lib/cups/backend/lpd
/usr/lib/cups/backend/snmp
/usr/lib/cups/backend/socket
/usr/lib/cups/backend/usb
%dir /usr/lib/cups/cgi-bin
/usr/lib/cups/cgi-bin/admin.cgi
/usr/lib/cups/cgi-bin/classes.cgi
/usr/lib/cups/cgi-bin/help.cgi
/usr/lib/cups/cgi-bin/jobs.cgi
/usr/lib/cups/cgi-bin/printers.cgi
%dir /usr/lib/cups/command
/usr/lib/cups/command/ippevepcl
/usr/lib/cups/command/ippeveps
%dir /usr/lib/cups/daemon
/usr/lib/cups/daemon/cups-deviced
/usr/lib/cups/daemon/cups-driverd
/usr/lib/cups/daemon/cups-exec
/usr/lib/cups/daemon/cups-lpd
%dir /usr/lib/cups/driver
%dir /usr/lib/cups/filter
/usr/lib/cups/filter/commandtops
/usr/lib/cups/filter/gziptoany
/usr/lib/cups/filter/pstops
/usr/lib/cups/filter/rastertoepson
/usr/lib/cups/filter/rastertohp
/usr/lib/cups/filter/rastertolabel
/usr/lib/cups/filter/rastertopwg
%dir /usr/lib/cups/monitor
/usr/lib/cups/monitor/bcp
/usr/lib/cups/monitor/tbcp
%dir /usr/lib/cups/notifier
/usr/lib/cups/notifier/dbus
/usr/lib/cups/notifier/mailto
/usr/lib/cups/notifier/rss
%doc %{\_defaultdocdir}/cups
%doc %{\_mandir}/man1/cups.1.gz
%doc %{\_mandir}/man1/cupstestppd.1.gz
%doc %{\_mandir}/man1/ippeveprinter.1.gz
%doc %{\_mandir}/man5/classes.conf.5.gz
%doc %{\_mandir}/man5/client.conf.5.gz
%doc %{\_mandir}/man5/cups-snmp.conf.5.gz
%doc %{\_mandir}/man5/cups-files.conf.5.gz
%doc %{\_mandir}/man5/cupsd-logs.5.gz
%doc %{\_mandir}/man5/cupsd.conf.5.gz
%doc %{\_mandir}/man5/mailto.conf.5.gz
%doc %{\_mandir}/man5/mime.convs.5.gz
%doc %{\_mandir}/man5/mime.types.5.gz
%doc %{\_mandir}/man5/printers.conf.5.gz
%doc %{\_mandir}/man5/subscriptions.conf.5.gz
%doc %{\_mandir}/man7/backend.7.gz
%doc %{\_mandir}/man7/filter.7.gz
%doc %{\_mandir}/man7/ippevepcl.7.gz
%doc %{\_mandir}/man7/ippeveps.7.gz
%doc %{\_mandir}/man7/notifier.7.gz
%doc %{\_mandir}/man8/cups-deviced.8.gz
%doc %{\_mandir}/man8/cups-driverd.8.gz
%doc %{\_mandir}/man8/cups-exec.8.gz
%doc %{\_mandir}/man8/cups-lpd.8.gz
%doc %{\_mandir}/man8/cups-snmp.8.gz
%doc %{\_mandir}/man8/cupsctl.8.gz
%doc %{\_mandir}/man8/cupsd.8.gz
%doc %{\_mandir}/man8/cupsd-helper.8.gz
%doc %{\_mandir}/man8/cupsfilter.8.gz
%{\_datadir}/cups/
%files client
%defattr(-,root,root)
%{\_bindir}/cancel
%{\_bindir}/ippeveprinter
%{\_bindir}/ippfind
%{\_bindir}/ipptool
%{\_bindir}/lp
%{\_bindir}/lpoptions
%{\_bindir}/lpq
%{\_bindir}/lpr
%{\_bindir}/lprm
%{\_bindir}/lpstat
%{\_sbindir}/cupsaccept
%{\_sbindir}/cupsdisable
%{\_sbindir}/cupsenable
%{\_sbindir}/cupsreject
%{\_sbindir}/lpadmin
%{\_sbindir}/lpc
%{\_sbindir}/lpinfo
%{\_sbindir}/lpmove
%doc %{\_mandir}/man1/cancel.1.gz
%doc %{\_mandir}/man1/ippfind.1.gz
%doc %{\_mandir}/man1/ipptool.1.gz
%doc %{\_mandir}/man1/lp.1.gz
%doc %{\_mandir}/man1/lpoptions.1.gz
%doc %{\_mandir}/man1/lpq.1.gz
%doc %{\_mandir}/man1/lpr.1.gz
%doc %{\_mandir}/man1/lprm.1.gz
%doc %{\_mandir}/man1/lpstat.1.gz
%doc %{\_mandir}/man5/ipptoolfile.5.gz
%doc %{\_mandir}/man8/cupsaccept.8.gz
%doc %{\_mandir}/man8/cupsdisable.8.gz
%doc %{\_mandir}/man8/cupsenable.8.gz
%doc %{\_mandir}/man8/cupsreject.8.gz
%doc %{\_mandir}/man8/lpadmin.8.gz
%doc %{\_mandir}/man8/lpc.8.gz
%doc %{\_mandir}/man8/lpinfo.8.gz
%doc %{\_mandir}/man8/lpmove.8.gz
%files devel
%defattr(-,root,root)
%{\_includedir}/cups/
%{\_libdir}/libcups.so
%{\_libdir}/libcupsimage.so
%{\_libdir}/pkgconfig/cups.pc
%files ddk
%defattr(-,root,root)
%{\_bindir}/ppdc
%{\_bindir}/ppdhtml
%{\_bindir}/ppdi
%{\_bindir}/ppdmerge
%{\_bindir}/ppdpo
%doc %{\_mandir}/man1/ppdc.1.gz
%doc %{\_mandir}/man1/ppdhtml.1.gz
%doc %{\_mandir}/man1/ppdi.1.gz
%doc %{\_mandir}/man1/ppdmerge.1.gz
%doc %{\_mandir}/man1/ppdpo.1.gz
%doc %{\_mandir}/man5/ppdcfile.5.gz
%files -n libcups2
%defattr(-,root,root)
%{\_libdir}/libcups.so.2
%files -n libcupsimage2
%defattr(-,root,root)
%{\_libdir}/libcupsimage.so.2
%files config
# Regarding specific owner group and permission settings for directories
# see the above comment in the files section of the main package.
# How cupsd creates those directories:
# drwx--x--- ... root lp ... /var/spool/cups
# drwxrwx--T ... root lp ... /var/spool/cups/tmp
# drwxr-xr-x ... root lp ... /var/log/cups
# drwxrwx--- ... root lp ... /var/cache/cups
# see https://bugzilla.suse.com/show\_bug.cgi?id=1184161#c7
# The 'lp' user does not need write permissions in /var/log/cups
# regardless that filters and backends are usually run as user 'lp' because
# filters and backends write log messages to the inherited stderr file descriptor
# and do not append them directly to /var/log/cups/error\_log (via fopen on their own).
# The /etc/cups directory is not created by cupsd but needed by it
# because cupsd cannot start if there is no /etc/cups/cupsd.conf file
# (otherwise cupsd aborts with: "Unable to open /etc/cups/cupsd.conf").
%defattr(-,root,root)
%if 0%{?suse\_version} >= 1330
%dir %attr(0755,root,lp) /etc/cups
%endif
%config(noreplace) %{\_sysconfdir}/cups/client.conf
%dir %attr(0710,root,lp) %{\_var}/spool/cups
%dir %attr(1770,root,lp) %{\_var}/spool/cups/tmp
%dir %attr(0755,root,lp) %{\_var}/log/cups
%dir %attr(0770,root,lp) %{\_var}/cache/cups
%{\_bindir}/cups-config
%{\_datadir}/locale/\*/cups\_\*
%doc %{\_mandir}/man1/cups-config.1.gz
%changelog

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")


