The provided content relates to CVE-2021-25094.

Here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from an insecure implementation of a custom font upload feature within the Tatsu WordPress plugin. Specifically, the `add_custom_font` AJAX action is vulnerable due to missing authentication and insufficient file validation.

**Weaknesses:**

1.  **Unauthenticated File Upload:** The `add_custom_font` action, which handles the uploading of custom fonts, can be accessed without authentication, allowing any user to initiate the upload process.
2.  **Insecure File Handling:**
    *   Uploaded zip files are extracted to a publicly accessible directory within the web root (`wp-content/uploads/typehub/custom/<zipfilename>/`).
    *   The plugin performs file extension checks *after* the zip archive has been extracted, creating a race condition where malicious code can be executed.
    *   The plugin skips files starting with a `.` (dot) character during the file extension check, allowing an attacker to upload a PHP shell that is not detected by the extension filter.
3. **Missing checks:** The plugin does not check file size or magic bytes.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** An attacker can upload a zip file containing a malicious PHP script, which can then be executed on the server, allowing for arbitrary command execution.
*   **Website Compromise:** Successful RCE can lead to complete control over the compromised website, including data theft, defacement, or use for further malicious activities.

**Attack Vectors:**

*   **HTTP Request:** The vulnerability is triggered by sending a crafted POST request to the `wp-admin/admin-ajax.php` endpoint with the `add_custom_font` action and a malicious zip file.
*   **Direct Access:** After the file has been uploaded, the attacker can access the malicious PHP file directly via its URL.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the targeted WordPress website.
*   **No authentication required:** The attacker doesn't need to have any account on the WordPress website since the vulnerability is unauthenticated.
*  **Basic technical knowledge:**  The attacker needs to understand how to craft a HTTP request with a malicious zip archive.

**Additional Details:**

*   The vulnerability was discovered by Vincent MICHEL (@darkpills).
*   The vulnerable code resides within the `includes/typehub/includes/class-typehub-store.php` file of the Tatsu plugin.
*   The vulnerability has been assigned CVE-2021-25094.
*   The identified race condition can be exploited with a high success rate by including a large number of dummy files within the zip archive in addition to the malicious file, which increases the duration of the extraction process.
*   The exploit can bypass Wordfence security plugin with simple obfuscation techniques.

**Mitigation:**

The vulnerability is fixed in Tatsu version 3.3.12. The fix addresses the unauthenticated access but is still not perfect:

*   The font upload feature now requires authentication.
*   The plugin performs a check on zip file before unzipping, but only if the php zip extension is loaded.
*   There is a logic error where the file will still be unzipped if the zip file can not be opened, skipping the security check.

The recommended mitigations are:

*   Remove the `nopriv` action to the `add_custom_font` callback
*   Analyze uploaded archives before extracting them.
*   Control the zip filename extensions using pathinfo().
*   Remove `.svg`, `.html`, `.css` extensions from whitelisted extensions.
*   Control the total uncompressed size of the archive.
*   Restrict allowed character in zip filename and filename sizes.
*   Control zip file magic bytes.

The provided content offers more in-depth information than the official CVE description.