Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the lack of proper sanitization of the `discount_code` parameter within the `pmpro_getLevelAtCheckout` function, specifically in a REST API endpoint. This function takes user-supplied input and directly incorporates it into an SQL query without escaping it.

**Weaknesses/Vulnerabilities:**
- **SQL Injection (SQLi):** The primary vulnerability is an unauthenticated blind SQL injection. Because the input is not sanitized, an attacker can inject malicious SQL code via the `discount_code` parameter.

**Impact of Exploitation:**
- **Denial of Service (DoS):**  The injected SQL could be used to cause database performance issues, potentially leading to a denial of service.
- **Sensitive Information Disclosure:** A skilled attacker could potentially extract sensitive information from the WordPress database by crafting specific SQL injection payloads.

**Attack Vectors:**
- **REST API Endpoint:** The vulnerability is exposed through a publicly accessible REST API endpoint `/pmpro/v1/checkout_level`.
- **HTTP GET Request:** The `discount_code` parameter is passed via the GET request.
- **Unauthenticated Access:** The endpoint is accessible to unauthenticated users, meaning anyone can trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs no special privileges or authentication to exploit the vulnerability.
- They only need to be able to send HTTP GET requests to the vulnerable WordPress site.
- Knowledge of SQL and WordPress REST API structure is beneficial to craft more effective attacks.

**Additional Information:**
- The vulnerability was reported by WPScan.com.
- The fix involves using the `esc_sql` function to sanitize the `$discount_code` and `$level_id` variables before using them in SQL queries.
- The vulnerable function `pmpro_getLevelAtCheckout` is located in the `includes/functions.php` file.
- The vulnerability is fixed in Paid Memberships Pro version 2.6.7.
- The CVSS score is 10.0 (Critical) reflecting the high severity of the vulnerability.