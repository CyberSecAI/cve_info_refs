The provided content is related to CVE-2021-44147.

**Root Cause:**
The vulnerability stems from an insufficiently configured XML parser within Claris FileMaker that allows XML External Entity (XXE) attacks. The parser does not prevent the use of external entities or external DTDs, leading to the possibility of exploiting external entity references.

**Weaknesses/Vulnerabilities:**
- The XML parser allows the use of external entities, including references to local files and remote resources via various protocols (e.g., `file://`, `http://`).
- The parser allows the use of external DTDs, which enables more complex exploitation scenarios, such as out-of-band data exfiltration using parameter entities.
- The use of UNC paths in external entities allows for SMB connections, which enables the capture of NetNTLMv2 hashes when the FileMaker Server runs under a custom Windows user.

**Impact of Exploitation:**
- **Local File Disclosure:** Attackers can read arbitrary files from the server's file system if the result of the import is visible or through an import mapping dialog.
- **Server-Side Request Forgery (SSRF):** Attackers can make the server send HTTP requests to arbitrary hosts, including internal ones, and potentially exfiltrate responses.
- **Out-of-Band Data Exfiltration:** Attackers can exfiltrate file contents by sending the data via HTTP requests to a server they control by using parameter entities.
- **NetNTLMv2 Hash Theft:** When the FileMaker Server is running under a custom Windows user, attackers can force the server to connect to an attacker-controlled SMB server, allowing for capture of the user's NetNTLMv2 hash. This hash could then potentially be cracked to obtain the user's password.

**Attack Vectors:**
- **Importing Malicious XML/XLSX Files:** The primary attack vector involves tricking a user into importing a malicious XML or XLSX file, which contains crafted external entity references. This can be done via the "Import Records" functionality.
- **Phishing Attacks:** Attackers can leverage snapshot link files (`*.fmpsl`), which are XML files, to execute phishing attacks. If a user opens a malicious snapshot link, the XML parser will process it, triggering the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to import files using the "Import Records" functionality in FileMaker. This requires a FileMaker account with the necessary privileges, like the default "Data Entry Only" privilege set.
- The attacker must be able to prepare and deliver crafted malicious XML/XLSX files to the target system, either directly or through a phishing attack.
- For out-of-band exfiltration, the attacker must have a server under their control where they can receive the exfiltrated data.
- For capturing NetNTLMv2 hashes, the attacker must have an SMB server set up to intercept the connection from the target.