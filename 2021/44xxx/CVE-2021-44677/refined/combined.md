=== Content from www.zerodayinitiative.com_d2daede3_20250114_224822.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

December 23rd, 2021
## Veritas Enterprise Vault EVExchangeWebServicesProxy Deserialization of Untrusted Data Remote Code Execution Vulnerability

### ZDI-21-1592ZDI-CAN-14078

| CVE ID | [CVE-2021-44677](https://www.cve.org/CVERecord?id=CVE-2021-44677) |
| --- | --- |
| CVSS SCORE | 9.8, [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| AFFECTED VENDORS | Veritas |
| AFFECTED PRODUCTS | Enterprise Vault |
| VULNERABILITY DETAILS | This vulnerability allows remote attackers to execute arbitrary code on affected installations of Veritas Enterprise Vault. Authentication is not required to exploit this vulnerability.  The specific flaw exists within EVExchangeWebServicesProxy.exe. The issue results from the lack of proper validation of user-supplied data, which can result in deserialization of untrusted data. An attacker can leverage this vulnerability to execute code in the context of the Enterprise Vault Admin Service. |
| ADDITIONAL DETAILS | Veritas has issued an update to correct this vulnerability. More details can be found at:  <https://www.veritas.com/content/support/en_US/security/VTS21-003> |
| DISCLOSURE TIMELINE | * 2021-08-13 - Vulnerability reported to vendor * 2021-12-23 - Coordinated public release of advisory |
| CREDIT | Markus Wulftange (@mwulftange) |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from www.veritas.com_e5fc9402_20250114_224820.html ===


* + Get Support
    - My Support Cases
    - Create Case
    - Start Chat
    - Call Us
    - Learn more about Veritas
  + [Veritas.com](https://www.veritas.com/)
  + [VOX](https://vox.veritas.com/)
* [Veritas.com](https://www.veritas.com/)
* [VOX](https://vox.veritas.com/)
* Get Support
  + My Support Cases
  + Create Case
  + Start Chat
  + Call Us
  + ---
  + [Learn more about Veritas](/support/en_US/terms/support-fundamentals)
* Language
  + 简体中文
  + English
  + Français
  + Deutsch
  + Italiano
  + 日本語
  + 한국어
  + Português
  + Español

* + [My Profile](https://www.veritas.com/support/en_US/settings?returnURL=https://www.veritas.com/support/en_US)
  + Sign Out

* Sign In

[![](/content/dam/support-new/logo/veritas_arctera_stack_95.png)

![]()](/support/en_US)
Support

* [Products](/support/en_US/products)
* [Knowledge Base](/support/en_US/search-results?fq=(document_type%3A%22Knowledge_Base%22))
* [Documentation](/support/en_US/search-results?q=*&fq=(document_type%3A%22document%22))
* [Downloads](/support/en_US/downloads)
* [Licensing](https://sso.veritas.com/app/veritassso_vems_1/exk1dn2qzmgXJCl9c417/sso/saml)
* NetInsights
  + [NetInsights Console](https://netinsights.veritas.com)
  + [Netinsights Status](https://www.veritas.com/support/en_US/netinsights-status)

* NetInsights
  + [NetInsights Console](https://netinsights.veritas.com)
  + [Netinsights Status](https://www.veritas.com/support/en_US/netinsights-status)

Sign In

Sign in failed. Please try again.

Username

Password
[Forgot Password](https://www.veritas.com/support/en/reset_password?returnURL=https://www.veritas.com/support/en)

Remember me

---

Don’t have an account? [Create One](https://www.veritas.com/support/en_US/register?returnURL=https://www.veritas.com/support/en_US).

Cancel
Sign In

##### resetPassword

oldPassword

passwordRules
newPassword

confirmNewPassword

regCancelButton
changePassword

Hello! We noticed that while you have a Veritas Account, you aren't yet registered to manage cases and use chat. Contact us for help registering your account

[regContactUsButton](/support/en_US/contact-us)
regCancelButton

![]()

    [Support](/support/en_US.html)
  /   [Security Alerts](/support/en_US/security.html)
  /   [Remote Code Execution Vulnerabilities in Veritas Enterprise Vault](/support/en_US/security/VTS21-003.html)

## Revision History

* 1.0: November 16, 2021: Initial version
* 2.0: December 09, 2021: CVE ID added
* 3.0: July 20, 2022: Acknowledgement section updated

---

## Summary

Veritas has discovered an issue where Veritas Enterprise Vault could allow Remote Code
Execution on a vulnerable Enterprise Vault Server.

| Issue | Description | Severity | Identifier | CVE ID |
| --- | --- | --- | --- | --- |
| 1 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14074 | [CVE-2021-44679](https://nvd.nist.gov/vuln/detail/CVE-2021-44679) |
| 2 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14075 | [CVE-2021-44680](https://nvd.nist.gov/vuln/detail/CVE-2021-44680) |
| 3 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14076 | [CVE-2021-44678](https://nvd.nist.gov/vuln/detail/CVE-2021-44678) |
| 4 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14078 | [CVE-2021-44677](https://nvd.nist.gov/vuln/detail/CVE-2021-44677) |
| 5 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14079 | [CVE-2021-44682](https://nvd.nist.gov/vuln/detail/CVE-2021-44682) |
| 6 | Deserialization of Untrusted Data Remote Code Execution Vulnerability | Critical | ZDI-CAN-14080 | [CVE-2021-44681](https://nvd.nist.gov/vuln/detail/CVE-2021-44681) |

## Issue

* CVE ID: See above
* Severity: Critical
* CVSS v3.1 Base Score 9.8 ([AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H))

On start-up, the Enterprise Vault application starts several services that listen on random .NET
Remoting TCP ports for possible commands from client applications. These TCP ports can be exploited
due to vulnerabilities that are inherent to the .NET Remoting service. A malicious attacker can
exploit both TCP remoting services and local IPC services on the Enterprise Vault Server.

This vulnerability affects Enterprise Vault server if and only if all the following pre-requisites
are fulfilled:

* The malicious attacker has RDP access to one of the VMs in the network. In order to have RDP
  access the attacker needs to be part of the Remote Desktop Users group.
* The malicious attacker knows the IP address of the EV server, the EV process IDs (random), EV
  TCP dynamic ports (random), EV remoteable object URIs.
* The firewall on the EV server is not properly configured

This vulnerability could allow remote code execution if an attacker sends specially
crafted data to a vulnerable EV server.

**Affected Versions**

All currently supported versions of Enterprise Vault versions: 14.2.1, 14.2, 14.1.3, 14.1.2, 14.1.1,
14.1, 14.0.1, 14.0, 12.5.3, 12.5.2, 12.5.1, 12.5. 12.4.2. 12.4.1. 12.4, 12.3.2, 12.3.1, 12.3,
12.2.3, 12.2.2, 12.2.1, 12.2, 12.1.3, 12.1.2, 12.1.1, 12.1, 12.0.4, 12.0.3, 12.0.2, 12.0.1, 12.0.
Earlier unsupported versions may be affected as well.

## Mitigation

The Enterprise Vault server can be protected from such .NET Remoting attacks by applying the
following guidelines:

* Ensure that only EV Administrators have access to the Enterprise Vault server as described in
  the [Enterprise
  Vault Administrator’s Guide](https://www.veritas.com/support/en_US/doc/11765145-146140116-0/v11737934-146140116).

+ See [Managing
  Administrator Security](https://www.veritas.com/support/en_US/doc/11765145-146140116-0/v11738019-146140116)

* Ensure only trusted users are part of the Remote Desktop Users group and have RDP access to the
  Enterprise Vault server.
* Ensure that the Enterprise Vault server firewall is enabled and properly configured as described
  in the [Enterprise
  Vault Administrator’s Guide](https://www.veritas.com/support/en_US/doc/11765145-146140116-0/v11737934-146140116)

+ See: [Firewall
  settings for Enterprise Vault programs](https://www.veritas.com/support/en_US/doc/11765145-146140116-0/v69906976-146140116)

* Ensure that the latest Windows updates have been installed on the Enterprise Vault server.

## Questions

For questions or problems regarding these vulnerabilities please contact Veritas
Technical Support (<https://www.veritas.com/support>)

## Acknowledgement

Veritas would like to thank Markus Wulftange and Reno Robert working with Trend Micro’s Zero Day Initiative (ZDI) for notifying us of these vulnerabilities.

### Disclaimer

THE SECURITY ADVISORY IS PROVIDED "AS IS" AND ALL EXPRESS OR IMPLIED CONDITIONS, REPRESENTATIONS AND
WARRANTIES, INCLUDING ANY IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR
NON-INFRINGEMENT, ARE DISCLAIMED, EXCEPT TO THE EXTENT THAT SUCH DISCLAIMERS ARE HELD TO BE LEGALLY
INVALID. VERITAS TECHNOLOGIES LLC SHALL NOT BE LIABLE FOR INCIDENTAL OR CONSEQUENTIAL DAMAGES IN
CONNECTION WITH THE FURNISHING, PERFORMANCE, OR USE OF THIS DOCUMENTATION. THE INFORMATION CONTAINED
IN THIS DOCUMENTATION IS SUBJECT TO CHANGE WITHOUT NOTICE.

Veritas Technologies LLC

2625 Augustine Drive

Santa Clara, CA 95054

![](/content/dam/support-new/logo/veritas_arctera_stack_95.png)

---

![]()

© 2024 Veritas
[Contact Us](/support/en_US/contact-us)
[Privacy Policy](https://www.veritas.com/about/privacy)
[Legal](https://www.veritas.com/about/legal)
[User Agreement](https://www.veritas.com/content/dam/support/terms/Veritas%20Support%20Web%20User%20Terms_05042018.pdf)


