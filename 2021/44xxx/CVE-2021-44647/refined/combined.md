=== Content from security.gentoo.org_198fece4_20250114_183642.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Lua: Multiple Vulnerabilities — GLSA **202305-23**

Multiple vulnerabilities have been discovered in Lua, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **dev-lang/lua** on all architectures |
| --- | --- |
| Affected versions | < **5.4.4-r103**< **5.2.3**< **5.1.5-r200**<= **5.1.5-r4** |
| Unaffected versions | >= **5.4.4-r103**>= **5.2.3**>= **5.1.5-r200** |

### Background

Lua is a powerful, efficient, lightweight, embeddable scripting language. It supports procedural programming, object-oriented programming, functional programming, data-driven programming, and data description.

### Description

Multiple vulnerabilities have been discovered in Lua. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Lua 5.1 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/lua-5.1.5-r200"

```

All Lua 5.3 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/lua-5.2.3"

```

All Lua 5.4 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/lua-5.4.4-r103"

```
### References

* [CVE-2014-5461](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-5461)
* [CVE-2021-44647](https://nvd.nist.gov/vuln/detail/CVE-2021-44647)
* [CVE-2022-28805](https://nvd.nist.gov/vuln/detail/CVE-2022-28805)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [837521](https://bugs.gentoo.org/show_bug.cgi?id=837521)
* [831053](https://bugs.gentoo.org/show_bug.cgi?id=831053)
* [520480](https://bugs.gentoo.org/show_bug.cgi?id=520480)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from lists.fedoraproject.org_b5fd7e59_20250114_183641.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F.mbox.gz?message=P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/#P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F)

# [SECURITY] Fedora 34 Update: lua-5.4.4-1.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

16 Feb
2022

16 Feb
'22

10:06 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-473560d1a6
2022-02-17 03:05:41.104629
--------------------------------------------------------------------------------

Name : lua
Product : Fedora 34
Version : 5.4.4
Release : 1.fc34
URL : <http://www.lua.org/>
Summary : Powerful light-weight programming language
Description :
Lua is a powerful light-weight programming language designed for
extending applications. Lua is also frequently used as a
general-purpose, stand-alone language. Lua is free software.
Lua combines simple procedural syntax with powerful data description
constructs based on associative arrays and extensible semantics. Lua
is dynamically typed, interpreted from bytecodes, and has automatic
memory management with garbage collection, making it ideal for
configuration, scripting, and rapid prototyping.

--------------------------------------------------------------------------------
Update Information:

Update to lua 5.4.4, 5.3.6. Note that while this fixes CVE-2021-43519, it was
also fixed in 5.4.3-4. ---- Fix CVE-2021-44647 (and other known upstream bugs)
--------------------------------------------------------------------------------
ChangeLog:

\* Tue Feb 1 2022 Tom Callaway spot@fedoraproject.org - 5.4.4-1
- update to 5.4.4, update bootstrap code to 5.3.6
- 5.4.4 contains the fix for 5.4.3 bug7, which is also CVE-2021-43519
This fix was also in 5.4.3-4, so you do not need to update solely for that.
\* Mon Jan 24 2022 Tom Callaway spot@fedoraproject.org - 5.4.3-4
- apply upstream fix for CVE-2021-44647
- apply upstream fixes for known lua bugs 4-10 (11 assumes other changes beyond 5.4.3)
\* Thu Jan 20 2022 Fedora Release Engineering releng@fedoraproject.org - 5.4.3-3
- Rebuilt for <https://fedoraproject.org/wiki/Fedora_36_Mass_Rebuild>
\* Thu Jul 22 2021 Fedora Release Engineering releng@fedoraproject.org - 5.4.3-2
- Rebuilt for <https://fedoraproject.org/wiki/Fedora_35_Mass_Rebuild>
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2044415 - CVE-2021-44647 lua: type confusion in funcnamefromcode in ldebug.c could result in local DoS
<https://bugzilla.redhat.com/show_bug.cgi?id=2044415>
[ 2 ] Bug #2047672 - CVE-2021-43519 lua: stack overflow in lua\_resume of ldo.c allows a DoS via a crafted script file
<https://bugzilla.redhat.com/show_bug.cgi?id=2047672>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-473560d1a6' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F/#P3EMGAQ5Y6GXJLY4K5DUOOEQT4MZ4J4F)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from lua-users.org_d062c133_20250114_183639.html ===


[[Date Prev](msg00203.html)][[Date Next](msg00205.html)][[Thread Prev](msg00196.html)][[Thread Next](msg00206.html)]
[[Date Index](index.html#00204)]
[[Thread Index](threads.html#00204)]

* **Subject**: **Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit**
* **From**: Roberto Ierusalimschy <roberto@[...](/cgi-bin/echo.cgi?inf.puc-rio.br)>
* **Date**: Tue, 30 Nov 2021 15:11:36 -0300

---

```
> Hi, I found an interesting SEGV crash on Lua interpreter.
>
> Lua .5.4.4, commit hash ad3942adba574c9d008c99ce2785a5af19d146bf
>
> [...]
> local function v(a, b, c, ...)
> return os.exit(0, true)
> end
>
> local function a()
> return h()
> end
>
> local e <close> = setmetatable({}, {__close = a})
>
> v()

Many thanks for the feedback.

The issue here is that, when closing the state, Lua assumes its stack
is going away, so it could close 'e' using all the stack after it.
However, the call to 'v' is still pending, and when the error tries
to create a traceback, the information about the call to 'v' has
been messed up by the closing of 'e'.

The fix seems simple:

--- a/lstate.c
+++ b/lstate.c
@@ -271,6 +271,7 @@ static void close_state (lua_State *L) {
   if (!completestate(g))  /* closing a partially built state? */
     luaC_freeallobjects(L);  /* just collect its objects */
   else {  /* closing a fully built state */
+    L->ci = &L->base_ci;  /* unwind CallInfo list */
     luaD_closeprotected(L, 1, LUA_OK);  /* close all upvalues */
     luaC_freeallobjects(L);  /* collect all objects */
     luai_userstateclose(L);

-- Roberto

```

---

* **Follow-Ups**:
  + **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00206.html),** *Kang woosun*

* **References**:
  + **[Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00195.html),** *Kang woosun*

* Prev by Date:
  **[Re: Crash Analysis: Finalizer Logic in singlestep function can lead to Sandbox Escape Exploit](msg00203.html)**
* Next by Date:
  **[Re: Crash Analysis: Finalizer Logic in singlestep function can lead to Sandbox Escape Exploit](msg00205.html)**
* Previous by thread:
  **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00196.html)**
* Next by thread:
  **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00206.html)**
* Index(es):
  + [**Date**](index.html#00204)
  + [**Thread**](threads.html#00204)



=== Content from access.redhat.com_adf45ad5_20250114_183640.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lua-users.org_896a625d_20250114_183639.html ===


[[Date Prev](msg00194.html)][[Date Next](msg00196.html)][[Thread Prev](msg00207.html)][[Thread Next](msg00196.html)]
[[Date Index](index.html#00195)]
[[Thread Index](threads.html#00195)]

* **Subject**: **Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit**
* **From**: Kang woosun <kws981924@[...](/cgi-bin/echo.cgi?gmail.com)>
* **Date**: Tue, 30 Nov 2021 18:17:13 +0900

---

Hi, I found an interesting
SEGV crash on Lua
interpreter.

Lua .5.4.4, commit hash
ad3942adba574c9d008c99ce2785a5af19d146bf

Ubuntu 20.04.3 LTS

glibc 2.31

crash.lua:

----------------------------------------------------------------------------------------------------------------

local
function v(a, b, c, ...)

  return
os.exit(0, true)

end

local function a()

  return h()

end

local e <close> =
setmetatable({}, {\_\_close =
a})

v()

----------------------------------------------------------------------------------------------------------------

How to reproduce:

----------------------------------------------------------------------------------------------------------------

./lua crash.lua

----------------------------------------------------------------------------------------------------------------

ASAN log:

----------------------------------------------------------------------------------------------------------------

==25870==ERROR:
AddressSanitizer: SEGV on unknown
address 0x000000000000 (pc 0x560c2ac6bbc1 bp 0x606000000e60 sp
0x7ffd4f445030
T0)

==25870==The signal is
caused by a READ memory access.

==25870==Hint: address
points to the zero page.

    #0
0x560c2ac6bbc0 in funcnamefromcode (/home/lua/lua+0x22bc0)

    #1
0x560c2ac6d672 in lua\_getinfo (/home/lua/lua+0x24672)

    #2
0x560c2acadbb1 in luaL\_traceback (/home/lua/lua+0x64bb1)

    #3
0x560c2ac61c4b in msghandler (/home/lua/lua+0x18c4b)

    #4
0x560c2ac725c7 in luaD\_precall (/home/lua/lua+0x295c7)

    #5
0x560c2ac731fc in luaD\_callnoyield (/home/lua/lua+0x2a1fc)

    #6
0x560c2ac6e3fd in luaG\_errormsg (/home/lua/lua+0x253fd)

    #7
0x560c2ac6e5f1 in luaG\_runerror (/home/lua/lua+0x255f1)

    #8
0x560c2ac6e7fe in luaG\_callerror (/home/lua/lua+0x257fe)

    #9
0x560c2ac70f4f in luaD\_tryfuncTM (/home/lua/lua+0x27f4f)

    #10
0x560c2ac719c1 in luaD\_pretailcall (/home/lua/lua+0x289c1)

    #11
0x560c2ac9e167 in luaV\_execute (/home/lua/lua+0x55167)

    #12
0x560c2ac73237 in luaD\_callnoyield (/home/lua/lua+0x2a237)

    #13
0x560c2ac76aec in luaF\_close (/home/lua/lua+0x2daec)

    #14
0x560c2ac6fa37 in luaD\_rawrunprotected (/home/lua/lua+0x26a37)

    #15
0x560c2ac73bb7 in luaD\_closeprotected (/home/lua/lua+0x2abb7)

    #16
0x560c2ac8f623 in close\_state (/home/lua/lua+0x46623)

    #17
0x560c2acc26f7 in os\_exit (/home/lua/lua+0x796f7)

    #18
0x560c2ac71b5b in luaD\_pretailcall (/home/lua/lua+0x28b5b)

    #19
0x560c2ac9e167 in luaV\_execute (/home/lua/lua+0x55167)

    #20
0x560c2ac73237 in luaD\_callnoyield (/home/lua/lua+0x2a237)

    #21
0x560c2ac6fa37 in luaD\_rawrunprotected (/home/lua/lua+0x26a37)

    #22
0x560c2ac73d93 in luaD\_pcall (/home/lua/lua+0x2ad93)

    #23
0x560c2ac68ba3 in lua\_pcallk (/home/lua/lua+0x1fba3)

    #24
0x560c2ac61e9e in docall (/home/lua/lua+0x18e9e)

    #25
0x560c2ac6316d in pmain (/home/lua/lua+0x1a16d)

    #26
0x560c2ac725c7 in luaD\_precall (/home/lua/lua+0x295c7)

    #27
0x560c2ac731fc in luaD\_callnoyield (/home/lua/lua+0x2a1fc)

    #28
0x560c2ac6fa37 in luaD\_rawrunprotected (/home/lua/lua+0x26a37)

    #29
0x560c2ac73d93 in luaD\_pcall (/home/lua/lua+0x2ad93)

    #30
0x560c2ac68ba3 in lua\_pcallk (/home/lua/lua+0x1fba3)

    #31 0x560c2ac613ae in main
(/home/lua/lua+0x183ae)

    #32
0x7f2a1883d0b2 in \_\_libc\_start\_main
(/lib/x86\_64-linux-gnu/libc.so.6+0x270b2)

    #33
0x560c2ac61a6d in \_start (/home/lua/lua+0x18a6d)

AddressSanitizer can not
provide additional info.

SUMMARY: AddressSanitizer:
SEGV
(/home/lua/lua+0x22bc0) in funcnamefromcode

----------------------------------------------------------------------------------------------------------------

Root cause:

----------------------------------------------------------------------------------------------------------------

The main reason is that
L->ci->previous->func
value is located above L->top in the luaD\_seterrorobj
function.

While the os.exit function
call the \_\_close metamethod
of tbc(to-be-closed), the upper callinfo frame calls the lower
callinfo frame.
At this time, if the function is executed normally. there is no
problem, but when
an error occurs (argument error or nil call, etc.), the
corresponding crash occurs.

To explain in more detail,
a crash occurs in
retrieving the name of the function that called the function in
which the error
occurred during the error handling process. In the
luaD\_seterrorobj function,
L->top is set to the tbc+2 value obtained in the luaF\_close
function. At
this time, if you look at the value, the address of the
L->ci->previous->func value used to find the function
name is the same
as or above L->top.

In this case, L->top is
used (increase or
decrement) during the error handling process, and the value of
L->ci->previous->func is overwritten with another
value. As a result, it
will refer to a non-function value in the function
funcnamefromcode.

Additionally, the
function’s argument must contain “…”
for the crash to occur. Perhaps it has something to do with
‘ci->func +=
actual + 1’ in the luaT\_adjustvarargs function.

----------------------------------------------------------------------------------------------------------------

How to patch(suggestion):

In fact, the patch
mentioned here is not recommended
because it does not eliminate the cause and it is not known how
it will affect
the error handling function.

However, I have checked
that the crash does not occur
by applying the patch, so I would like to use it as a reference
only. It is recommended
to patch the luaT\_adjustvarargs function to eliminate the cause.

----------------------------------------------------------------------------------------------------------------

diff --git a/ldebug.c
b/ldebug.c

index dc5f78c6..9b917b24
100644

--- a/ldebug.c

+++ b/ldebug.c

@@ -96,6 +96,8 @@ int
luaG\_getfuncline (const Proto
\*f, int pc) {

 static int
getcurrentline (CallInfo \*ci) {

+
if(ci->func\_corrupted)

+    return -1;

   return
luaG\_getfuncline(ci\_func(ci)->p, currentpc(ci));

 }

@@ -324,8 +326,11 @@
static const char \*getfuncname
(lua\_State \*L, CallInfo \*ci, const char \*\*name) {

     return
"metamethod";  /\* report
it as
such \*/

   }

   /\* calling
function is a known Lua function? \*/

-  else if
(!(ci->callstatus & CIST\_TAIL) &&
isLua(ci->previous))

+  else if
(!(ci->callstatus & CIST\_TAIL) &&
isLua(ci->previous)){

+
if(ci->previous->func\_corrupted)

+      return
"func\_corrupted";

     return
funcnamefromcode(L, ci->previous, name);

+  }

   else return
NULL;  /\* no way to find
a name \*/

 }

diff --git a/ldo.c b/ldo.c

index f282a773..a565b6ea
100644

--- a/ldo.c

+++ b/ldo.c

@@ -109,6 +109,8 @@ void
luaD\_seterrorobj (lua\_State
\*L, int errcode, StkId oldtop) {

     }

   }

   L->top =
oldtop + 1;

+
if(L->ci->previous->func >= L->top)

+
L->ci->previous->func\_corrupted = 1;

 }

@@ -483,6 +485,7 @@
l\_sinline CallInfo \*prepCallInfo
(lua\_State \*L, StkId func, int nret,

ci->nresults = nret;

ci->callstatus = mask;

   ci->top =
top;

+
ci->func\_corrupted = 0 ;

   return ci;

 }

diff --git a/lstate.h
b/lstate.h

index 44cf939c..0f2af604
100644

--- a/lstate.h

+++ b/lstate.h

@@ -196,6 +196,7 @@
typedef struct CallInfo {

   } u2;

   short
nresults;  /\* expected
number of results
from this function \*/

   unsigned
short callstatus;

+  unsigned char
func\_corrupted;

 } CallInfo;

----------------------------------------------------------------------------------------------------------------

Thank you for reading.

Found by: WooSun Kang (team Nil Armstrong)

---

* **Follow-Ups**:
  + **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00196.html),** *Sergey Zakharchenko*
  + **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00204.html),** *Roberto Ierusalimschy*

* Prev by Date:
  **[Re: [ANN] Lua 5.4.4 (rc1) now available](msg00194.html)**
* Next by Date:
  **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00196.html)**
* Previous by thread:
  **[Re: Crash Analysis: Finalizer Logic in singlestep function can lead to Sandbox Escape Exploit](msg00207.html)**
* Next by thread:
  **[Re: Crash : SEGV that occurs during error handling that occurs in the \_\_close metamethod of to-be-closed after calling os.exit](msg00196.html)**
* Index(es):
  + [**Date**](index.html#00195)
  + [**Thread**](threads.html#00195)


