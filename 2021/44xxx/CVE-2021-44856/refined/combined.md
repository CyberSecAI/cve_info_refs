=== Content from security.gentoo.org_ae3e6eb7_20250114_191707.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MediaWiki: Multiple Vulnerabilities — GLSA **202305-24**

Multiple vulnerabilities have been found in MediaWiki, the worst of which could result in denial of service.

### Affected packages

| Package | **www-apps/mediawiki** on all architectures |
| --- | --- |
| Affected versions | < **1.38.5** |
| Unaffected versions | >= **1.38.5** |

### Background

MediaWiki is a collaborative editing software, used by big projects like Wikipedia.

### Description

Multiple vulnerabilities have been discovered in MediaWiki. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All MediaWiki users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.38.5"

```
### References

* [CVE-2021-41798](https://nvd.nist.gov/vuln/detail/CVE-2021-41798)
* [CVE-2021-41799](https://nvd.nist.gov/vuln/detail/CVE-2021-41799)
* [CVE-2021-41800](https://nvd.nist.gov/vuln/detail/CVE-2021-41800)
* [CVE-2021-44854](https://nvd.nist.gov/vuln/detail/CVE-2021-44854)
* [CVE-2021-44855](https://nvd.nist.gov/vuln/detail/CVE-2021-44855)
* [CVE-2021-44856](https://nvd.nist.gov/vuln/detail/CVE-2021-44856)
* [CVE-2021-44857](https://nvd.nist.gov/vuln/detail/CVE-2021-44857)
* [CVE-2021-44858](https://nvd.nist.gov/vuln/detail/CVE-2021-44858)
* [CVE-2021-45038](https://nvd.nist.gov/vuln/detail/CVE-2021-45038)
* [CVE-2022-28202](https://nvd.nist.gov/vuln/detail/CVE-2022-28202)
* [CVE-2022-28205](https://nvd.nist.gov/vuln/detail/CVE-2022-28205)
* [CVE-2022-28206](https://nvd.nist.gov/vuln/detail/CVE-2022-28206)
* [CVE-2022-28209](https://nvd.nist.gov/vuln/detail/CVE-2022-28209)
* [CVE-2022-31090](https://nvd.nist.gov/vuln/detail/CVE-2022-31090)
* [CVE-2022-31091](https://nvd.nist.gov/vuln/detail/CVE-2022-31091)
* [CVE-2022-34911](https://nvd.nist.gov/vuln/detail/CVE-2022-34911)
* [CVE-2022-34912](https://nvd.nist.gov/vuln/detail/CVE-2022-34912)
* [CVE-2022-41765](https://nvd.nist.gov/vuln/detail/CVE-2022-41765)
* [CVE-2022-41766](https://nvd.nist.gov/vuln/detail/CVE-2022-41766)
* [CVE-2022-41767](https://nvd.nist.gov/vuln/detail/CVE-2022-41767)
* [CVE-2022-47927](https://nvd.nist.gov/vuln/detail/CVE-2022-47927)

**Release date**

May 21, 2023

**Latest revision**

May 21, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [815376](https://bugs.gentoo.org/show_bug.cgi?id=815376)
* [829302](https://bugs.gentoo.org/show_bug.cgi?id=829302)
* [836430](https://bugs.gentoo.org/show_bug.cgi?id=836430)
* [855965](https://bugs.gentoo.org/show_bug.cgi?id=855965)
* [873385](https://bugs.gentoo.org/show_bug.cgi?id=873385)
* [888041](https://bugs.gentoo.org/show_bug.cgi?id=888041)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from phabricator.wikimedia.org_54585c51_20250114_191706.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT271037)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T271037
# CVE-2021-44856: Title blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return valueClosed, Resolved[Public](/policy/explain/PHID-TASK-ynxe3kqjs7fnjpax6u4c/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/271037/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/271037/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Protect as security issue](/wmf/escalate-task/271037/)
* [Award Token](/token/give/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
* [Flag For Later](/flag/edit/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)

Assigned To

|  | [matmarex](/p/matmarex/) |
| --- | --- |

Authored By

|  | [Func](/p/Func/) |
| --- | --- |
| Jan 2 2021, 5:48 AM2021-01-02 05:48:38 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Security](/tag/security/)
* [MediaWiki-Page-editing](/tag/mediawiki-page-editing/) [(Backlog)](/project/board/139/)
* [User-DannyS712](/tag/user-dannys712/) [(Unsorted)](/project/board/3849/)
* [AbuseFilter](/tag/abusefilter/) [(Backlog)](/project/board/217/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [Vuln-MissingAuthz](/tag/vuln-missingauthz/) [(Tracked)](/project/board/1343/)
* [Patch-For-Review](/tag/patch-for-review/)
* [MW-1.35-notes](/tag/mw-1.35-notes/)
* [MW-1.38-notes (1.38.0-wmf.16; 2022-01-03)](/project/view/5648/)
* [MW-1.36-notes](/tag/mw-1.36-notes/) [(Backlog)](/project/board/4479/)
* [MW-1.37-notes](/tag/mw-1.37-notes/)
Referenced Files

|  | [F34527995: 0001-SECURITY-Fix-use-of-EditFilterMergedContent-hook-whe.patch](/F34527995) |
| --- | --- |
| Jun 26 2021, 2:46 PM2021-06-26 14:46:12 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Daimona](/p/Daimona/) |
| --- | --- |

|  | [DannyS712](/p/DannyS712/) |
| --- | --- |

|  | [Func](/p/Func/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [matmarex](/p/matmarex/) |
| --- | --- |

|  | [Mstyles](/p/Mstyles/) |
| --- | --- |

[View All 11 Subscribers](/subscriptions/list/PHID-TASK-ynxe3kqjs7fnjpax6u4c/)
# Description

The EditFilterMergedContent hook in ContentModelChange class required returning false to interrupt edit action, but handling function of AbuseFilter don't have a return value.

So when use Special:ChangeContentModel in a non-existent title, it will create the page, while the AbuseFilter's log assumed the creation was blocked.

# Details

Risk Rating Low Author Affiliation Wikimedia Communities

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Fix use of EditFilterMergedContent hook when changing content model](https://gerrit.wikimedia.org/r/c/747599) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +6 -0 |
|  | [SECURITY: Fix use of EditFilterMergedContent hook when changing content model](https://gerrit.wikimedia.org/r/c/747581) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_36](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_36) | +6 -0 |
|  | [SECURITY: Fix use of EditFilterMergedContent hook when changing content model](https://gerrit.wikimedia.org/r/c/747588) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_37](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_37) | +6 -0 |
|  | [SECURITY: Fix use of EditFilterMergedContent hook when changing content model](https://gerrit.wikimedia.org/r/c/747574) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_35](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_35) | +6 -0 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T271037)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T292226 [Release MediaWiki 1.35.5/1.36.3/1.37.1](/T292226) |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T292227 [Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227) |
|  |  | Resolved | Security | [matmarex](/p/matmarex/) | T271037 [CVE-2021-44856: Title blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value](/T271037) |

Mentioned In [T297896: Apply changes from 1.35.5 to unsupported legacy branch `REL1\_31`](/T297896)
[T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227)
[T297322: CVE-2021-44857, CVE-2021-44858: Unauthorized users can undo edits on any protected page and view contents of private wikis using mcrundo](/T297322)
[T287124: Grant access to OIT-LDAP Diffusion repo to contractor Danielattevelt](/T287124)
[T273354: Set $status->value in EditFilterMergedContentHookConstraint::checkConstraint() properly to display error message](/T273354) Mentioned Here [T292226: Release MediaWiki 1.35.5/1.36.3/1.37.1](/T292226)
[T280312: Handle EditFilterMergedContent hook properly to display error message](/T280312)
[T271038: Use edit constraints within ContentModelChange](/T271038)
### Event Timeline

[Func](/p/Func/) created this task.[Jan 2 2021, 5:48 AM2021-01-02 05:48:38 (UTC+0)](#6716856)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/4039364/)[Jan 2 2021, 5:48 AM2021-01-02 05:48:40 (UTC+0)](#6716866)[Func](/p/Func/) added a comment.[Jan 2 2021, 6:01 AM2021-01-02 06:01:35 (UTC+0)](#6716878)Comment Actions

Note that the handling of EditFilterMergedContent hook's return value in [ContentModelChange](https://doc.wikimedia.org/mediawiki-core/master/php/ContentModelChange_8php_source.html#l00264) class is different compare to which in [EditFilterMergedContentHookConstraint](https://doc.wikimedia.org/mediawiki-core/master/php/EditFilterMergedContentHookConstraint_8php_source.html#l00110) class, should it to be modified or put up a warning to avoid such a mistake?

[DannyS712](/p/DannyS712/) added projects: [MediaWiki-Page-editing](/tag/mediawiki-page-editing/), [User-DannyS712](/tag/user-dannys712/).[Jan 2 2021, 8:24 AM2021-01-02 08:24:24 (UTC+0)](#6716901)[DannyS712](/p/DannyS712/) subscribed.Comment Actions

See also [T271038: Use edit constraints within ContentModelChange](/T271038)

[DannyS712](/p/DannyS712/) added a subscriber: [taavi](/p/taavi/).[Jan 2 2021, 8:29 AM2021-01-02 08:29:04 (UTC+0)](#6716926)[Reedy](/p/Reedy/) added a project: [AbuseFilter](/tag/abusefilter/).[Jan 4 2021, 4:21 PM2021-01-04 16:21:28 (UTC+0)](#6719698)[Reedy](/p/Reedy/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-my56sdv7ccuzaxi/)[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jan 4 2021, 4:23 PM2021-01-04 16:23:26 (UTC+0)](#6719725)[sbassett](/p/sbassett/) added a subscriber: [Daimona](/p/Daimona/).

[Daimona](/p/Daimona/) added a comment.[Jan 4 2021, 9:08 PM2021-01-04 21:08:32 (UTC+0)](#6720953)Comment Actions

Returning false from the hook seems a good temporary solution, and I think it can be pushed publicly on gerrit, pretending it's some standardization / cleanup. But yes, core being inconsistent is the real problem.

[DannyS712](/p/DannyS712/) added a comment.[Jan 5 2021, 12:27 AM2021-01-05 00:27:44 (UTC+0)](#6721469)Comment Actions
> In [T271037#6720953](/T271037#6720953), [@Daimona](/p/Daimona/) wrote:
>
> Returning false from the hook seems a good temporary solution, and I think it can be pushed publicly on gerrit, pretending it's some standardization / cleanup. But yes, core being inconsistent is the real problem.

Yeah, core is really inconsistent. You can see the logic used for saving edits at EditFilterMergedContentHookConstraint. Note that switching to returning false **might** result in different behavior for saving edits, not sure since I'm not familiar enough with what AbuseFilter currently does in that hook

[Daimona](/p/Daimona/) added a comment.[Jan 5 2021, 11:16 AM2021-01-05 11:16:04 (UTC+0)](#6722173)Comment Actions
> In [T271037#6721469](/T271037#6721469), [@DannyS712](/p/DannyS712/) wrote:
> > In [T271037#6720953](/T271037#6720953), [@Daimona](/p/Daimona/) wrote:
> >
> > Returning false from the hook seems a good temporary solution, and I think it can be pushed publicly on gerrit, pretending it's some standardization / cleanup. But yes, core being inconsistent is the real problem.
>
> Yeah, core is really inconsistent. You can see the logic used for saving edits at EditFilterMergedContentHookConstraint. Note that switching to returning false **might** result in different behavior for saving edits, not sure since I'm not familiar enough with what AbuseFilter currently does in that hook

OK, fair. I didn't check the core code, but then perhaps we can copy part of EditFilterMergedContentHookConstraint into ContentModelChange? Specifically the part which checks the Status.

[Func](/p/Func/) added a comment.[Jan 10 2021, 2:37 AM2021-01-10 02:37:29 (UTC+0)](#6734033)Comment Actions
> In [T271037#6720953](/T271037#6720953), [@Daimona](/p/Daimona/) wrote:
>
> Returning false from the hook seems a good temporary solution, and I think it can be pushed publicly on gerrit, pretending it's some standardization / cleanup. But yes, core being inconsistent is the real problem.

If return false, you should set $status->value after $status->merge( $filterResultApi ); manually, such as $status->value = MediaWiki\EditPage\IEditObject::AS\_HOOK\_ERROR\_EXPECTED;.

I tested in my install of mw1.35, it's fine with edit and changecontentmodel both. But I wonder if that is a correct way to handle this hook?

I hope the code in ContentModelChange can be improved, because almost all hooks (originally) provide by EditPage.php support set Status object without return false.

[Func](/p/Func/) mentioned this in [T273354: Set $status->value in EditFilterMergedContentHookConstraint::checkConstraint() properly to display error message](/T273354).[Feb 5 2021, 3:22 PM2021-02-05 15:22:50 (UTC+0)](#6806754)[Tgr](/p/Tgr/) subscribed.[Mar 31 2021, 9:49 AM2021-03-31 09:49:16 (UTC+0)](#6959898)Comment Actions

I wonder if the intention with ignoring the status in ContentModelChange is to allow users to go (content1, model1) -> (content1, model2) -> (content2, model2) when there's no content that would be valid under both model1 and model2 so you couldn't otherwise get from one to the other.

On the net it still seems like a bad idea though. The API allows changing the content and the model at the same time, and it's a sufficiently infrequent problem that that should be a valid solution.

[Func](/p/Func/) added a comment.[Apr 4 2021, 5:38 AM2021-04-04 05:38:58 (UTC+0)](#6970798)Comment Actions
> In [T271037#6959898](/T271037#6959898), [@Tgr](/p/Tgr/) wrote:
>
> On the net it still seems like a bad idea though. The API allows changing the content and the model at the same time, and it's a sufficiently infrequent problem that that should be a valid solution.

Sorry for my poor english, what change should be done to solve this bug in your opinion?

[Func](/p/Func/) added a comment.[Apr 4 2021, 5:39 AM2021-04-04 05:39:10 (UTC+0)](#6970799)This comment was removed by [Func](/p/Func/).[sbassett](/p/sbassett/) added projects: [SecTeam-Processed](/tag/secteam-processed/), [Vuln-MissingAuthz](/tag/vuln-missingauthz/).[Apr 5 2021, 7:08 PM2021-04-05 19:08:30 (UTC+0)](#6973397)[Func](/p/Func/) added a subscriber: [matmarex](/p/matmarex/).[Jun 26 2021, 1:36 PM2021-06-26 13:36:35 (UTC+0)](#7178737)Comment Actions

[@matmarex](/p/matmarex/) , Changes related to [T280312](/T280312) can actually solve this security issue, so I considered doing backports.

I stopped creating backport changes now, If backports really shouldn't be done, please fell free to abandon them.

[matmarex](/p/matmarex/) added a comment.[Jun 26 2021, 2:39 PM2021-06-26 14:39:31 (UTC+0)](#7178761)Comment Actions

Extensions outside of our version control could also trigger this issue, right?

If so, it seems to me that it should be fixed in the ContentModelChange class, by changing the logic to match the EditFilterMergedContentHookConstraint class. And then that's the patch that should be backported.

[matmarex](/p/matmarex/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Jun 26 2021, 2:46 PM2021-06-26 14:46:11 (UTC+0)](#7178772)Comment Actions

And the required patch appears to be this:

0001-SECURITY-Fix-use-of-EditFilterMergedContent-hook-whe.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/dttxoybz7qe4cddeqmcz/PHID-FILE-hjm53t5uyfpybvei3g53/0001-SECURITY-Fix-use-of-EditFilterMergedContent-hook-whe.patch)

[sbassett](/p/sbassett/) moved this task from [Watching](/project/board/1179/) to [Incoming](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 28 2021, 4:22 PM2021-06-28 16:22:49 (UTC+0)](#7181584)[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jul 12 2021, 3:36 PM2021-07-12 15:36:44 (UTC+0)](#7206029)[Reedy](/p/Reedy/) renamed this task from Title which blocked in AbuseFilter can be create via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook to Title which blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value.[Jul 12 2021, 3:37 PM2021-07-12 15:37:42 (UTC+0)](#7206033)[sbassett](/p/sbassett/) mentioned this in [T287124: Grant access to OIT-LDAP Diffusion repo to contractor Danielattevelt](/T287124).[Jul 21 2021, 9:30 PM2021-07-21 21:30:23 (UTC+0)](#7228812)[Mstyles](/p/Mstyles/) subscribed.[Nov 1 2021, 9:12 PM2021-11-01 21:12:21 (UTC+0)](#7473255)Comment Actions

The security team would be happy to deploy this patch as soon as it can be reviewed by another person.

[matmarex](/p/matmarex/) added a comment.[Nov 3 2021, 7:10 PM2021-11-03 19:10:39 (UTC+0)](#7479356)Comment Actions

[@Daimona](/p/Daimona/) [@Func](/p/Func/) Are you able to have a look at the patch? It's very short and hopefully trivial.

[Func](/p/Func/) added a comment.[Nov 4 2021, 1:03 PM2021-11-04 13:03:06 (UTC+0)](#7481429)Comment Actions

LGTM.

[Mstyles](/p/Mstyles/) added a parent task: [T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227).[Dec 6 2021, 10:23 PM2021-12-06 22:23:03 (UTC+0)](#7551573)[sbassett](/p/sbassett/) subscribed.Edited · [Dec 6 2021, 10:23 PM2021-12-06 22:23:22 (UTC+0)](#7551577)Comment Actions

Patch from [T271037#7178772](/T271037#7178772) was deployed during today's security window:

22:19 mstyles@deploy1002: Synchronized php-1.38.0-wmf.9/includes/content/ContentModelChange.php: Deploy security patch for T271037 (duration: 00m 56s)

Tracking as part of the next security release: [T292226](/T292226). We're not seeing any errors in logstash, but if other folks subscribed on this task could perform some additional verification that the patch is behaving properly within production, that'd be great.

[sbassett](/p/sbassett/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Dec 6 2021, 10:27 PM2021-12-06 22:27:08 (UTC+0)](#7551592)[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[sbassett](/p/sbassett/) triaged this task as Low priority.[Dec 6 2021, 10:39 PM2021-12-06 22:39:25 (UTC+0)](#7551616)[sbassett](/p/sbassett/) changed Author Affiliation from N/A to Wikimedia Communities.[sbassett](/p/sbassett/) changed Risk Rating from N/A to Low.[Reedy](/p/Reedy/) renamed this task from Title which blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value to Title blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value.[Dec 10 2021, 5:48 PM2021-12-10 17:48:36 (UTC+0)](#7563540)[Reedy](/p/Reedy/) closed this task as Resolved.[Dec 10 2021, 5:52 PM2021-12-10 17:52:36 (UTC+0)](#7563573)[Reedy](/p/Reedy/) assigned this task to [matmarex](/p/matmarex/).[Legoktm](/p/Legoktm/) mentioned this in [T297322: CVE-2021-44857, CVE-2021-44858: Unauthorized users can undo edits on any protected page and view contents of private wikis using mcrundo](/T297322) .[Dec 10 2021, 7:44 PM2021-12-10 19:44:12 (UTC+0)](#7563775)[Reedy](/p/Reedy/) mentioned this in [T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227).[Dec 10 2021, 7:55 PM2021-12-10 19:55:42 (UTC+0)](#7563816)

[Reedy](/p/Reedy/) subscribed.[Dec 10 2021, 8:04 PM2021-12-10 20:04:59 (UTC+0)](#7563861)Comment Actions

Patch applies to all supported branches cleanly.

[Reedy](/p/Reedy/) renamed this task from Title blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value to CVE-2021-44856: Title blocked in AbuseFilter can be created via Special:ChangeContentModel due to the mishandling of EditFilterMergedContent hook return value.[Dec 13 2021, 3:04 AM2021-12-13 03:04:21 (UTC+0)](#7565343)[Reedy](/p/Reedy/) added a subscriber: [gerritbot](/p/gerritbot/).[Dec 13 2021, 9:40 PM2021-12-13 21:40:09 (UTC+0)](#7567791)[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:30 PM2021-12-15 19:30:26 (UTC+0)](#7573378)Comment Actions

Change 747574 had a related patch set uploaded (by Reedy; author: Bartosz Dziewoński):

[mediawiki/core@REL1\_35] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747574>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Dec 15 2021, 7:30 PM2021-12-15 19:30:29 (UTC+0)](#7573379)Comment Actions

Change 747581 had a related patch set uploaded (by Reedy; author: Bartosz Dziewoński):

[mediawiki/core@REL1\_36] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747581>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:32 PM2021-12-15 19:32:43 (UTC+0)](#7573391)Comment Actions

Change 747588 had a related patch set uploaded (by Reedy; author: Bartosz Dziewoński):

[mediawiki/core@REL1\_37] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747588>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:46 PM2021-12-15 19:46:37 (UTC+0)](#7573466)Comment Actions

Change 747599 had a related patch set uploaded (by Reedy; author: Bartosz Dziewoński):

[mediawiki/core@master] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747599>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:47 PM2021-12-15 19:47:53 (UTC+0)](#7573477)Comment Actions

Change 747574 **merged** by jenkins-bot:

[mediawiki/core@REL1\_35] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747574>

[Reedy](/p/Reedy/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-uwqs4rdm6nvaz3y/)" to "Public (No Login Required)".[Dec 15 2021, 7:53 PM2021-12-15 19:53:25 (UTC+0)](#7573490)[Reedy](/p/Reedy/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-jd4siiix22scmqg/)" to "All Users".[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added a project: [MW-1.35-notes](/tag/mw-1.35-notes/).[Dec 15 2021, 8:00 PM2021-12-15 20:00:28 (UTC+0)](#7573532)[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:02 PM2021-12-15 20:02:35 (UTC+0)](#7573543)Comment Actions

Change 747588 **merged** by jenkins-bot:

[mediawiki/core@REL1\_37] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747588>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:25 PM2021-12-15 20:25:50 (UTC+0)](#7573644)Comment Actions

Change 747581 **merged** by jenkins-bot:

[mediawiki/core@REL1\_36] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747581>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:48 PM2021-12-15 20:48:40 (UTC+0)](#7573712)Comment Actions

Change 747599 **merged** by jenkins-bot:

[mediawiki/core@master] SECURITY: Fix use of EditFilterMergedContent hook when changing content model

<https://gerrit.wikimedia.org/r/747599>

[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added projects: [MW-1.38-notes (1.38.0-wmf.16; 2022-01-03)](/project/view/5648/), [MW-1.36-notes](/tag/mw-1.36-notes/), [MW-1.37-notes](/tag/mw-1.37-notes/).[Dec 15 2021, 9:00 PM2021-12-15 21:00:28 (UTC+0)](#7573812)[Osnard](/p/Osnard/) mentioned this in [T297896: Apply changes from 1.35.5 to unsupported legacy branch `REL1\_31`](/T297896).[Dec 16 2021, 4:31 PM2021-12-16 16:31:26 (UTC+0)](#7575650)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
