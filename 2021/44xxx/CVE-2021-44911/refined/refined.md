Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**

*   The vulnerability stems from the lack of file extension restrictions when uploading "Mouse over button" and "When selected button" images in the `modules/menu/menu.admin.controller.php` file of XpressEngine (XE) before version 1.11.6.

**Weaknesses/vulnerabilities present:**

*   **Unrestricted File Upload:** The system allows uploading files without proper validation of their extensions.
*   **Stored XSS:**  By uploading HTML files, an attacker can inject malicious scripts that are executed when a user interacts with the affected element, leading to a stored Cross-Site Scripting (XSS) vulnerability.
*   **Potential Remote Code Execution (RCE):**  If the `.htaccess` configuration is not properly configured (as it was before XE 1.11.2), uploading PHP files can lead to remote code execution on the server.

**Impact of exploitation:**

*   **Stored XSS:** An attacker could inject malicious scripts that execute in the context of other users' browsers when they view the affected page or element, potentially leading to account compromise, data theft, or other malicious actions.
*   **Remote Code Execution (RCE):** If PHP files are allowed to be uploaded (depending on the `.htaccess` configuration), an attacker could gain complete control over the server.

**Attack vectors:**

*   An attacker uploads malicious files, such as HTML or PHP files, through the menu image upload functionality in the admin interface.

**Required attacker capabilities/position:**

*   The attacker needs to have access to the administrative interface of the XpressEngine installation to be able to upload files via the menu image upload functionality.
*   For RCE, the attacker also needs to target a system where the .htaccess configuration is vulnerable (like before XE 1.11.2).