=== Content from github.com_3aa32dd7_20250114_194309.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.28.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.28.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.28.0)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  264](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.28.0)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.28.0](/Mbed-TLS/mbedtls/releases/tag/v2.28.0)

# Mbed TLS 2.28.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.28.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)
released this
17 Dec 11:39

[v2.28.0](/Mbed-TLS/mbedtls/tree/v2.28.0)

[`8b3f26a`](/Mbed-TLS/mbedtls/commit/8b3f26a5ac38d4fdccbc5c5366229f3e01dafcc0)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

Mbed TLS 2.28 is a long-time support branch. It will be supported with bug-fixes and security fixes until end of 2024.

## Security Advisories

For full details, please see the following links:

<https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12>

## Release Notes

API changes

* Some fields of mbedtls\_ssl\_session and mbedtls\_ssl\_config are in a

  different order. This only affects applications that define such

  structures directly or serialize them.

Requirement changes

* Sign-magnitude and one's complement representations for signed integers are

  not supported. Two's complement is the only supported representation.

Removals

* Remove config option MBEDTLS\_TLS\_DEFAULT\_ALLOW\_SHA1\_IN\_CERTIFICATES,

  which allowed SHA-1 in the default TLS configuration for certificate

  signing. It was intended to facilitate the transition in environments

  with SHA-1 certificates. SHA-1 is considered a weak message digest and

  its use constitutes a security risk.
* Remove the partial support for running unit tests via Greentea on Mbed OS,

  which had been unmaintained since 2018.

Features

* The identifier of the CID TLS extension can be configured by defining

  MBEDTLS\_TLS\_EXT\_CID at compile time.
* Warn if errors from certain functions are ignored. This is currently

  supported on GCC-like compilers and on MSVC and can be configured through

  the macro MBEDTLS\_CHECK\_RETURN. The warnings are always enabled

  (where supported) for critical functions where ignoring the return

  value is almost always a bug. Enable the new configuration option

  MBEDTLS\_CHECK\_RETURN\_WARNING to get warnings for other functions. This

  is currently implemented in the AES, DES and md modules, and will be

  extended to other modules in the future.
* Add missing PSA macros declared by PSA Crypto API 1.0.0:

  PSA\_ALG\_IS\_SIGN\_HASH, PSA\_ALG\_NONE, PSA\_HASH\_BLOCK\_LENGTH, PSA\_KEY\_ID\_NULL.
* Add new API mbedtls\_ct\_memcmp for constant time buffer comparison.
* Add PSA API definition for ARIA.

Security

* Zeroize several intermediate variables used to calculate the expected

  value when verifying a MAC or AEAD tag. This hardens the library in

  case the value leaks through a memory disclosure vulnerability. For

  example, a memory disclosure vulnerability could have allowed a

  man-in-the-middle to inject fake ciphertext into a DTLS connection.
* In psa\_cipher\_generate\_iv() and psa\_cipher\_encrypt(), do not read back

  from the output buffer. This fixes a potential policy bypass or decryption

  oracle vulnerability if the output buffer is in memory that is shared with

  an untrusted application.
* Fix a double-free that happened after mbedtls\_ssl\_set\_session() or

  mbedtls\_ssl\_get\_session() failed with MBEDTLS\_ERR\_SSL\_ALLOC\_FAILED

  (out of memory). After that, calling mbedtls\_ssl\_session\_free()

  and mbedtls\_ssl\_free() would cause an internal session buffer to

  be free()'d twice.

Bugfix

* Stop using reserved identifiers as local variables. Fixes [#4630](https://github.com/Mbed-TLS/mbedtls/issues/4630).
* The GNU makefiles invoke python3 in preference to python except on Windows.

  The check was accidentally not performed when cross-compiling for Windows

  on Linux. Fix this. Fixes [#4774](https://github.com/Mbed-TLS/mbedtls/issues/4774).
* Prevent divide by zero if either of PSA\_CIPHER\_ENCRYPT\_OUTPUT\_SIZE() or

  PSA\_CIPHER\_UPDATE\_OUTPUT\_SIZE() were called using an asymmetric key type.
* Fix a parameter set but unused in psa\_crypto\_cipher.c. Fixes [#4935](https://github.com/Mbed-TLS/mbedtls/issues/4935).
* Don't use the obsolete header path sys/fcntl.h in unit tests.

  These header files cause compilation errors in musl.

  Fixes [#4969](https://github.com/Mbed-TLS/mbedtls/pull/4969).
* Fix missing constraints on x86\_64 and aarch64 assembly code

  for bignum multiplication that broke some bignum operations with

  (at least) Clang 12.

  Fixes [#4116](https://github.com/Mbed-TLS/mbedtls/issues/4116), [#4786](https://github.com/Mbed-TLS/mbedtls/issues/4786), [#4917](https://github.com/Mbed-TLS/mbedtls/issues/4917), [#4962](https://github.com/Mbed-TLS/mbedtls/issues/4962).
* Fix mbedtls\_cipher\_crypt: AES-ECB when MBEDTLS\_USE\_PSA\_CRYPTO is enabled.
* Failures of alternative implementations of AES or DES single-block

  functions enabled with MBEDTLS\_AES\_ENCRYPT\_ALT, MBEDTLS\_AES\_DECRYPT\_ALT,

  MBEDTLS\_DES\_CRYPT\_ECB\_ALT or MBEDTLS\_DES3\_CRYPT\_ECB\_ALT were ignored.

  This does not concern the implementation provided with Mbed TLS,

  where this function cannot fail, or full-module replacements with

  MBEDTLS\_AES\_ALT or MBEDTLS\_DES\_ALT. Reported by Armelle Duboc in [#1092](https://github.com/Mbed-TLS/mbedtls/issues/1092).
* Some failures of HMAC operations were ignored. These failures could only

  happen with an alternative implementation of the underlying hash module.
* Fix the error returned by psa\_generate\_key() for a public key. Fixes [#4551](https://github.com/Mbed-TLS/mbedtls/issues/4551).
* Fix the build of sample programs when neither MBEDTLS\_ERROR\_C nor

  MBEDTLS\_ERROR\_STRERROR\_DUMMY is enabled.
* Fix PSA\_ALG\_RSA\_PSS verification accepting an arbitrary salt length.

  This algorithm now accepts only the same salt length for verification

  that it produces when signing, as documented. Use the new algorithm

  PSA\_ALG\_RSA\_PSS\_ANY\_SALT to accept any salt length. Fixes [#4946](https://github.com/Mbed-TLS/mbedtls/issues/4946).
* The existing predicate macro name PSA\_ALG\_IS\_HASH\_AND\_SIGN is now reserved

  for algorithm values that fully encode the hashing step, as per the PSA

  Crypto API specification. This excludes PSA\_ALG\_RSA\_PKCS1V15\_SIGN\_RAW and

  PSA\_ALG\_ECDSA\_ANY. The new predicate macro PSA\_ALG\_IS\_SIGN\_HASH covers

  all algorithms that can be used with psa\_{sign,verify}\_hash(), including

  these two.
* Fix issue in Makefile on Linux with SHARED=1, that caused shared libraries

  not to list other shared libraries they need.
* Fix a bug in mbedtls\_gcm\_starts() when the bit length of the iv

  exceeds 2^32. Fixes [#4884](https://github.com/Mbed-TLS/mbedtls/issues/4884).
* Fix an uninitialized variable warning in test\_suite\_ssl.function with GCC

  version 11.
* Fix the build when no SHA2 module is included. Fixes [#4930](https://github.com/Mbed-TLS/mbedtls/issues/4930).
* Fix the build when only the bignum module is included. Fixes [#4929](https://github.com/Mbed-TLS/mbedtls/issues/4929).
* Fix a potential invalid pointer dereference and infinite loop bugs in

  pkcs12 functions when the password is empty. Fix the documentation to

  better describe the inputs to these functions and their possible values.

  Fixes [#5136](https://github.com/Mbed-TLS/mbedtls/issues/5136).
* The key usage flags PSA\_KEY\_USAGE\_SIGN\_MESSAGE now allows the MAC

  operations psa\_mac\_compute() and psa\_mac\_sign\_setup().
* The key usage flags PSA\_KEY\_USAGE\_VERIFY\_MESSAGE now allows the MAC

  operations psa\_mac\_verify() and psa\_mac\_verify\_setup().

Changes

* Set config option MBEDTLS\_TLS\_DEFAULT\_ALLOW\_SHA1\_IN\_KEY\_EXCHANGE to be

  disabled by default.
* Improve the performance of base64 constant-flow code. The result is still

  slower than the original non-constant-flow implementation, but much faster

  than the previous constant-flow implementation. Fixes [#4814](https://github.com/Mbed-TLS/mbedtls/issues/4814).
* Indicate in the error returned if the nonce length used with

  ChaCha20-Poly1305 is invalid, and not just unsupported.
* The mbedcrypto library includes a new source code module constant\_time.c,

  containing various functions meant to resist timing side channel attacks.

  This module does not have a separate configuration option, and functions

  from this module will be included in the build as required. Currently

  most of the interface of this module is private and may change at any

  time.

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

6519579b836ed78cc549375c7c18b111df5717e86ca0eeff4cb64b2674f424cc mbedtls-2.28.0.tar.gz

80cf41f5f3f625436e3a800e9708e60a25206cd5d81968ba8dd9f3e8becd37e6 mbedtls-2.28.0.zip

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_12446af1_20250114_194306.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  264](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

# Releases: Mbed-TLS/mbedtls

[Releases](/Mbed-TLS/mbedtls/releases)
[Tags](/Mbed-TLS/mbedtls/tags)

Releases ¬∑ Mbed-TLS/mbedtls
## Mbed TLS 3.6.2

15 Oct 12:35

![@davidhorstmann-arm](https://avatars.githubusercontent.com/u/70948878?s=40&v=4)
[davidhorstmann-arm](/davidhorstmann-arm)

[mbedtls-3.6.2](/Mbed-TLS/mbedtls/tree/mbedtls-3.6.2)

[`107ea89`](/Mbed-TLS/mbedtls/commit/107ea89daaefb9867ea9121002fbbdf926780e98)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...mbedtls-3.6.2)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.6.2](/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.6.2)
[Latest](/Mbed-TLS/mbedtls/releases/latest)

[Latest](/Mbed-TLS/mbedtls/releases/latest)

## Description

This release of Mbed TLS provides the fix for a security vulnerability.

Mbed TLS 3.6 is a long-term support (LTS) branch. It will be supported with bug-fixes and security fixes until at least March 2027.

## Security Advisories

For full details, please see the following links:

* [Buffer underrun in pkwrite when writing an opaque key pair](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-10-1/)

> ‚ùï **Release notes are truncated in GitHub's releases page**: Please refer to the [3.6.2](https://github.com/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.6.2) release page.

## Release Notes

Security

* Fix a buffer underrun in mbedtls\_pk\_write\_key\_der() when

  called on an opaque key, MBEDTLS\_USE\_PSA\_CRYPTO is enabled,

  and the output buffer is smaller than the actual output.

  Fix a related buffer underrun in mbedtls\_pk\_write\_key\_pem()

  when called on an opaque RSA key, MBEDTLS\_USE\_PSA\_CRYPTO is enabled

  and MBEDTLS\_MPI\_MAX\_SIZE is smaller than needed for a 4096-bit RSA key.

  [CVE-2024-49195](https://github.com/advisories/GHSA-24jq-7r79-4823 "CVE-2024-49195")

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Note

> ‚ùï `mbedtls-3.6.2.tar.bz2` is our official release file. `source.tar.gz` and `source.zip` are automatically generated snapshots that github generates. They do not include external dependencies, and [can't be configured](https://github.com/orgs/community/discussions/6003)

## Checksum

The SHA256 hash for the archive is:

8b54fb9bcf4d5a7078028e0520acddefb7900b3e66fec7f7175bb5b7d85ccdca mbedtls-3.6.2.tar.bz2

 Assets
4

 Loading

 üöÄ
3
 qcind, Swyter, and Chilledheart reacted with rocket emoji
 üëÄ
1
 qubit999 reacted with eyes emoji

All reactions

* üöÄ
  3 reactions
* üëÄ
  1 reaction

 4 people reacted

## Mbed TLS 3.6.1

30 Aug 13:16

![@davidhorstmann-arm](https://avatars.githubusercontent.com/u/70948878?s=40&v=4)
[davidhorstmann-arm](/davidhorstmann-arm)

[mbedtls-3.6.1](/Mbed-TLS/mbedtls/tree/mbedtls-3.6.1)

[`71c569d`](/Mbed-TLS/mbedtls/commit/71c569d44bf3a8bd53d874c81ee8ac644dd6e9e3)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...mbedtls-3.6.1)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.6.1](/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.6.1)

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

Mbed TLS 3.6 is a long-term support (LTS) branch. It will be supported with bug-fixes and security fixes until at least March 2027.

## Security Advisories

For full details, please see the following links:

* [`CTR_DRBG` prioritized over `HMAC_DRBG` as the PSA DRBG](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-1/)
* [Stack buffer overflow in ECDSA signature conversion functions](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-2/)
* [Limited authentication bypass in TLS 1.3 optional client authentication](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/)

> ‚ùï **Release notes are truncated in GitHub's releases page**: Please refer to the [3.6.1](https://github.com/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.6.1) release page.

## Release Notes

API changes

* The experimental functions psa\_generate\_key\_ext() and

  psa\_key\_derivation\_output\_key\_ext() are no longer declared when compiling

  in C++. This resolves a build failure under C++ compilers that do not

  support flexible array members (a C99 feature not adopted by C++).

  Fixes [#9020](https://github.com/Mbed-TLS/mbedtls/issues/9020).

Default behavior changes

* In a PSA-client-only build (i.e. MBEDTLS\_PSA\_CRYPTO\_CLIENT &&

  !MBEDTLS\_PSA\_CRYPTO\_C), do not automatically enable local crypto when the

  corresponding PSA mechanism is enabled, since the server provides the

  crypto. Fixes [#9126](https://github.com/Mbed-TLS/mbedtls/issues/9126).
* A TLS handshake may now call psa\_crypto\_init() if TLS 1.3 is enabled.

  This can happen even if TLS 1.3 is offered but eventually not selected

  in the protocol version negotiation.
* By default, the handling of TLS 1.3 tickets by the Mbed TLS client is now

  disabled at runtime. Applications that were using TLS 1.3 tickets

  signalled by MBEDTLS\_ERR\_SSL\_RECEIVED\_NEW\_SESSION\_TICKET return values now

  need to enable the handling of TLS 1.3 tickets through the new

  mbedtls\_ssl\_conf\_tls13\_enable\_signal\_new\_session\_tickets() API.

New deprecations

* The experimental functions psa\_generate\_key\_ext() and

  psa\_key\_derivation\_output\_key\_ext() are deprecated in favor of

  psa\_generate\_key\_custom() and psa\_key\_derivation\_output\_key\_custom().

  They have almost exactly the same interface, but the variable-length

  data is passed in a separate parameter instead of a flexible array

  member.
* The following cryptographic mechanisms are planned to be removed

  in Mbed TLS 4.0:
  + DES (including 3DES).
  + PKCS#1v1.5 encryption/decryption (RSAES-PKCS1-v1\_5).

    (OAEP, PSS, and PKCS#1v1.5 signature are staying.)
  + Finite-field Diffie-Hellman with custom groups.

    (RFC 7919 groups remain supported.)
  + Elliptic curves of size 225 bits or less.
* The following cipher suites are planned to be removed from (D)TLS 1.2

  in Mbed TLS 4.0:
  + TLS\_RSA\_\* (including TLS\_RSA\_PSK\_*), i.e. cipher suites using

    RSA decryption.

    (RSA signatures, i.e. TLS\_ECDHE\_RSA\_*, are staying.)
  + TLS\_ECDH\_*, i.e. cipher suites using static ECDH.

    (Ephemeral ECDH, i.e. TLS\_ECDHE\_*, is staying.)
  + TLS\_DHE\_*, i.e. cipher suites using finite-field Diffie-Hellman.

    (Ephemeral ECDH, i.e. TLS\_ECDHE\_*, is staying.)
  + TLS\_*CBC*, i.e. all cipher suites using CBC.
* The following low-level application interfaces are planned to be removed

  from the public API in Mbed TLS 4.0:
  + Hashes: hkdf.h, md5.h, ripemd160.h, sha1.h, sha3.h, sha256.h, sha512.h;
  + Random generation: ctr\_drbg.h, hmac\_drbg.h, entropy.h;
  + Ciphers and modes: aes.h, aria.h, camellia.h, chacha20.h, chachapoly.h,

    cipher.h, cmac.h, gcm.h, poly1305.h;
  + Private key encryption mechanisms: pkcs5.h, pkcs12.h.
  + Asymmetric cryptography: bignum.h, dhm.h, ecdh.h, ecdsa.h, ecjpake.h,

    ecp.h, rsa.h.

    The cryptographic mechanisms remain present, but they will only be

    accessible via the PSA API (psa\_xxx functions introduced gradually

    starting with Mbed TLS 2.17) and, where relevant, `pk.h`.

    For guidance on migrating application code to the PSA API, please consult

    the PSA transition guide (docs/psa-transition.md).
* The following integration interfaces are planned to be removed

  in Mbed TLS 4.0:
  + MBEDTLS\_xxx\_ALT replacement of cryptographic modules and functions.

    Use PSA transparent drivers instead.
  + MBEDTLS\_PK\_RSA\_ALT and MBEDTLS\_PSA\_CRYPTO\_SE\_C.

    Use PSA opaque drivers instead.

Features

* When the new compilation option MBEDTLS\_PSA\_KEY\_STORE\_DYNAMIC is enabled,

  the number of volatile PSA keys is virtually unlimited, at the expense

  of increased code size. This option is off by default, but enabled in

  the default mbedtls\_config.h. Fixes [#9216](https://github.com/Mbed-TLS/mbedtls/issues/9216).

Security

* Unlike previously documented, enabling MBEDTLS\_PSA\_HMAC\_DRBG\_MD\_TYPE does

  not cause the PSA subsystem to use HMAC\_DRBG: it uses HMAC\_DRBG only when

  MBEDTLS\_PSA\_CRYPTO\_EXTERNAL\_RNG and MBEDTLS\_CTR\_DRBG\_C are disabled.

  [CVE-2024-45157](https://github.com/advisories/GHSA-cvp8-hm87-hr8x "CVE-2024-45157")
* Fix a stack buffer overflow in mbedtls\_ecdsa\_der\_to\_raw() and

  mbedtls\_ecdsa\_raw\_to\_der() when the bits parameter is larger than the

  largest supported curve. In some configurations with PSA disabled,

  all values of bits are affected. This never happens in internal library

  calls, but can affect applications that call these functions directly.

  [CVE-2024-45158](https://github.com/advisories/GHSA-hw5v-7r63-g2h6 "CVE-2024-45158")
* With TLS 1.3, when a server enables optional authentication of the

  client, if the client-provided certificate does not have appropriate values

  in keyUsage or extKeyUsage extensions, then the return value of

  mbedtls\_ssl\_get\_verify\_result() would incorrectly have the

  MBEDTLS\_X509\_BADCERT\_KEY\_USAGE and MBEDTLS\_X509\_BADCERT\_EXT\_KEY\_USAGE bits

  clear. As a result, an attacker that had a certificate valid for uses other

  than TLS client authentication could be able to use it for TLS client

  authentication anyway. Only TLS 1.3 servers were affected, and only with

  optional authentication (required would abort the handshake with a fatal

  alert).

  [CVE-2024-45159](https://github.com/advisories/GHSA-cr54-4mf7-rg5v "CVE-2024-45159")

Bugfix

* Fix TLS 1.3 client build and runtime when support for session tickets is

  disabled (MBEDTLS\_SSL\_SESSION\_TICKETS configuration option). Fixes [#6395](https://github.com/Mbed-TLS/mbedtls/issues/6395).
* Fix compilation error when memcpy() is a function-like macros. Fixes [#8994](https://github.com/Mbed-TLS/mbedtls/issues/8994).
* MBEDTLS\_ASN1\_PARSE\_C and MBEDTLS\_ASN1\_WRITE\_C are now automatically enabled

  as soon as MBEDTLS\_RSA\_C is enabled. Fixes [#9041](https://github.com/Mbed-TLS/mbedtls/issues/9041).
* Fix undefined behaviour (incrementing a NULL pointer by zero length) when

  passing in zero length additional data to multipart AEAD.
* Fix rare concurrent access bug where attempting to operate on a

  non-existent key while concurrently creating a new key could potentially

  corrupt the key store.
* Fix error handling when creating a key in a dynamic secure element

  (feature enabled by MBEDTLS\_PSA\_CRYPTO\_SE\_C). In a low memory condition,

  the creation could return PSA\_SUCCESS but using or destroying the key

  would not work. Fixes [#8537](https://github.com/Mbed-TLS/mbedtls/issues/8537).
* Fix issue of redefinition warning messages for \_GNU\_SOURCE in

  entropy\_poll.c and sha\_256.c. There was a build warning during

  building for linux platform.

  Resolves [#9026](https://github.com/Mbed-TLS/mbedtls/pull/9026)
* Fix a compilation warning in pk.c when PSA is enabled and RSA is disabled.
* Fix the build when MBEDTLS\_PSA\_CRYPTO\_CONFIG is enabled and the built-in

  CMAC is enabled, but no built-in unauthenticated cipher is enabled.

  Fixes [#9209](https://github.com/Mbed-TLS/mbedtls/issues/9209).
* Fix redefinition warnings when SECP192R1 and/or SECP192K1 are disabled.

  Fixes [#9029](https://github.com/Mbed-TLS/mbedtls/issues/9029).
* Fix psa\_cipher\_decrypt() with CCM\* rejecting messages less than 3 bytes

  long. Credit to Cryptofuzz. Fixes [#9314](https://github.com/Mbed-TLS/mbedtls/issues/9314).
* Fix interference between PSA volatile keys and built-in keys

  when MBEDTLS\_PSA\_CRYPTO\_BUILTIN\_KEYS is enabled and

  MBEDTLS\_PSA\_KEY\_SLOT\_COUNT is more than 4096.
* Document and enforce the limitation of mbedtls\_psa\_register\_se\_key()

  to persistent keys. Resolves [#9253](https://github.com/Mbed-TLS/mbedtls/issues/9253).
* Fix Clang compilation error when MBEDTLS\_USE\_PSA\_CRYPTO is enabled

  but MBEDTLS\_DHM\_C is disabled. Reported by Michael Schuster in [#9188](https://github.com/Mbed-TLS/mbedtls/issues/9188).
* Fix server mode only build when MBEDTLS\_SSL\_SRV\_C is enabled but

  MBEDTLS\_SSL\_CLI\_C is disabled. Reported by M-Bab on GitHub in [#9186](https://github.com/Mbed-TLS/mbedtls/issues/9186).
* When MBEDTLS\_PSA\_CRYPTO\_C was disabled and MBEDTLS\_ECDSA\_C enabled,

  some code was defining 0-size arrays, resulting in compilation errors.

  Fixed by disabling the offending code in configurations without PSA

  Crypto, where it never worked. Fixes [#9311](https://github.com/Mbed-TLS/mbedtls/issues/9311).
* Fix unintended performance regression when using short RSA public keys.

  Fixes [#9232](https://github.com/Mbed-TLS/mbedtls/issues/9232).
* Fixes an issue where some TLS 1.2 clients could not connect to an

  Mbed TLS 3.6.0 server, due to incorrect handling of

  legacy\_compression\_methods in the ClientHello.

  Fixes [#8995](https://github.com/Mbed-TLS/mbedtls/issues/8995), [#9243](https://github.com/Mbed-TLS/mbedtls/issues/9243).
* Fix TLS connections failing when the handshake selects TLS 1.3

  in an application that does not call psa\_crypto\_init().

  Fixes [#9072](https://github.com/Mbed-TLS/mbedtls/issues/9072).
* Fix TLS connection failure in applications using an Mbed TLS client in

  the default configuration connecting to a TLS 1.3 server sending tickets.

  See the documentation of

  mbedtls\_ssl\_conf\_tls13\_enable\_signal\_new\_session\_tickets() for more

  information.

  Fixes [#8749](https://github.com/Mbed-TLS/mbedtls/issues/8749).
* Fix a memory leak that could occur when failing to process an RSA

  key through some PSA functions due to low memory conditions.
* Fixed a regression introduced in 3.6.0 where the CA callback set with

  mbedtls\_ssl\_conf\_ca\_cb() would stop working when connections were...

[Read more](/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.6.1)

 Assets
4

 Loading

 üëç
3
 jokosablenk, MirrorYuChen, and savin-itsph reacted with thumbs up emoji
 üöÄ
2
 SorkoPiko and Chilledheart reacted with rocket emoji
 üëÄ
1
 SkyDeBaun reacted with eyes emoji

All reactions

* üëç
  3 reactions
* üöÄ
  2 reactions
* üëÄ
  1 reaction

 6 people reacted

## Mbed TLS 2.28.9

30 Aug 13:15

![@davidhorstmann-arm](https://avatars.githubusercontent.com/u/70948878?s=40&v=4)
[davidhorstmann-arm](/davidhorstmann-arm)

[mbedtls-2.28.9](/Mbed-TLS/mbedtls/tree/mbedtls-2.28.9)

[`5e146ad`](/Mbed-TLS/mbedtls/commit/5e146adef63b326b04282252639bebc2730939c6)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...mbedtls-2.28.9)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 2.28.9](/Mbed-TLS/mbedtls/releases/tag/mbedtls-2.28.9)

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

Mbed TLS 2.28 is a long-time support branch. It will be supported with bug-fixes and security fixes until end of 2024.

## Security Advisories

For full details, please see the following links:

* [`CTR_DRBG` prioritized over `HMAC_DRBG` as the PSA DRBG](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-1/)

## Release Notes

Security

* Unlike previously documented, enabling MBEDTLS\_PSA\_HMAC\_DRBG\_MD\_TYPE does

  not cause the PSA subsystem to use HMAC\_DRBG: it uses HMAC\_DRBG only when

  MBEDTLS\_PSA\_CRYPTO\_EXTERNAL\_RNG and MBEDTLS\_CTR\_DRBG\_C are disabled.

  [CVE-2024-45157](https://github.com/advisories/GHSA-cvp8-hm87-hr8x "CVE-2024-45157")

Bugfix

* Fix the build in some configurations when check\_config.h is not included.

  Fix [#9152](https://github.com/Mbed-TLS/mbedtls/issues/9152).
* Fix issue of redefinition warning messages for \_GNU\_SOURCE in

  entropy\_poll.c and sha\_256.c. There was a build warning during

  building for linux platform.

  Resolves [#9026](https://github.com/Mbed-TLS/mbedtls/pull/9026)
* Fix error handling when creating a key in a dynamic secure element

  (feature enabled by MBEDTLS\_PSA\_CRYPTO\_SE\_C). In a low memory condition,

  the creation could return PSA\_SUCCESS but using or destroying the key

  would not work. Fixes [#8537](https://github.com/Mbed-TLS/mbedtls/issues/8537).
* Fix a memory leak that could occur when failing to process an RSA

  key through some PSA functions due to low memory conditions.
* Document and enforce the limitation of mbedtls\_psa\_register\_se\_key()

  to persistent keys. Resolves [#9253](https://github.com/Mbed-TLS/mbedtls/issues/9253).

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Note

> ‚ùï `mbedtls-2.28.9.tar.bz2` are our official release files. `source.tar.gz` and `source.zip` are automatically generated snapshot's that github is generating. They do not include external dependencies, and [can't be configured](https://github.com/orgs/community/discussions/6003)

## Checksum

The SHA256 hashes for the archives are:

e85ea97aaf78dd6c0a5ba2e54dd5932ffa15f39abfc189c26beef7684630c02b mbedtls-2.28.9.tar.bz2

 Assets
4

 Loading

 üëç
4
 xplshn, jokosablenk, rps102, and user8446 reacted with thumbs up emoji

All reactions

* üëç
  4 reactions

 4 people reacted

## Mbed TLS 3.6.0 LTS

28 Mar 15:05

![@minosgalanakis](https://avatars.githubusercontent.com/u/30719586?s=40&v=4)
[minosgalanakis](/minosgalanakis)

[v3.6.0](/Mbed-TLS/mbedtls/tree/v3.6.0)

[`2ca6c28`](/Mbed-TLS/mbedtls/commit/2ca6c285a0dd3f33982dd57299012dacab1ff206)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.6.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.6.0 LTS](/Mbed-TLS/mbedtls/releases/tag/v3.6.0)

## Description

This release of Mbed TLS provides new features, bug fixes and minor enhancements. This release includes fixes for security issues.

This release brings in improved multithreaded operations, record-size-limit, and early-data support and other TLS1.3 improvements. TLS1.3 support is now enabled by default.

## Long-term support

Mbed TLS 3.6 is a long-term support (LTS) branch. It will be supported with bug-fixes and security fixes until at least March 2027.

## Security Advisories

For full details, please see the following link:

* [PSA Crypto API with parameters in shared memory](https://github.com/Mbed-TLS/mbedtls-docs/blob/main/security-advisories/mbedtls-security-advisory-2024-03.md)

> ‚ùï **Release notes are trunctuated in GitHub's releases page**: Please refer to the [3.6.0](https://github.com/Mbed-TLS/mbedtls/releases/tag/v3.6.0) release page.

## Release Notes

API changes

* Remove `tls13_` in mbedtls\_ssl\_tls13\_conf\_early\_data() and

  mbedtls\_ssl\_tls13\_conf\_max\_early\_data\_size() API names. Early data

  feature may not be TLS 1.3 specific in the future. Fixes [#6909](https://github.com/Mbed-TLS/mbedtls/issues/6909).

Default behavior changes

* psa\_import\_key() now only accepts RSA keys in the PSA standard formats.

  The undocumented ability to import other formats (PKCS#8, SubjectPublicKey,

  PEM) accepted by the pkparse module has been removed. Applications that

  need these formats can call mbedtls\_pk\_parse\_{public,}key() followed by

  mbedtls\_pk\_import\_into\_psa().

Requirement changes

* Drop support for Visual Studio 2013 and 2015, and Arm Compiler 5.

New deprecations

* Rename the MBEDTLS\_SHA256\_USE\_A64\_CRYPTO\_xxx config options to

  MBEDTLS\_SHA256\_USE\_ARMV8\_A\_CRYPTO\_xxx. The old names may still

  be used, but are deprecated.
* In the PSA API, domain parameters are no longer used for anything.

  They are deprecated and will be removed in a future version of the

  library.
* mbedtls\_ecp\_write\_key() is deprecated in favor of

  mbedtls\_ecp\_write\_key\_ext().

Removals

* In the PSA API, the experimental way to encode the public exponent of

  an RSA key as a domain parameter is no longer supported. Use

  psa\_generate\_key\_ext() instead.
* Temporary function mbedtls\_pk\_wrap\_as\_opaque() is removed. To mimic the

  same behavior mbedtls\_pk\_get\_psa\_attributes() and

  mbedtls\_pk\_import\_into\_psa() can be used to import a PK key into PSA,

  while mbedtls\_pk\_setup\_opaque() can be used to wrap a PSA key into a opaque

  PK context.

Features

* Added an example program showing how to hash with the PSA API.
* Support Armv8-A Crypto Extension acceleration for SHA-256

  when compiling for Thumb (T32) or 32-bit Arm (A32).
* AES-NI is now supported in Windows builds with clang and clang-cl.

  Resolves [#8372](https://github.com/Mbed-TLS/mbedtls/issues/8372).
* Add new mbedtls\_x509\_csr\_parse\_der\_with\_ext\_cb() routine which allows

  parsing unsupported certificate extensions via user provided callback.
* Enable the new option MBEDTLS\_BLOCK\_CIPHER\_NO\_DECRYPT to omit

  the decryption direction of block ciphers (AES, ARIA, Camellia).

  This affects both the low-level modules and the high-level APIs

  (the cipher and PSA interfaces). This option is incompatible with modes

  that use the decryption direction (ECB in PSA, CBC, XTS, KW) and with DES.
* Support use of Armv8-A Cryptographic Extensions for hardware acclerated

  AES when compiling for Thumb (T32) or 32-bit Arm (A32).
* If a cipher or AEAD mechanism has a PSA driver, you can now build the

  library without the corresponding built-in implementation. Generally

  speaking that requires both the key type and algorithm to be accelerated

  or they'll both be built in. However, for CCM and GCM the built-in

  implementation is able to take advantage of a driver that only

  accelerates the key type (that is, the block cipher primitive). See

  docs/driver-only-builds.md for full details and current limitations.
* The CTR\_DRBG module will now use AES from a PSA driver if MBEDTLS\_AES\_C is

  disabled. This requires PSA\_WANT\_ALG\_ECB\_NO\_PADDING in addition to

  MBEDTLS\_PSA\_CRYPTO\_C and PSA\_WANT\_KEY\_TYPE\_AES.
* Fewer modules depend on MBEDTLS\_CIPHER\_C, making it possible to save code

  size by disabling it in more circumstances. In particular, the CCM and

  GCM modules no longer depend on MBEDTLS\_CIPHER\_C. Also,

  MBEDTLS\_PSA\_CRYPTO can now be enabled without MBEDTLS\_CIPHER\_C if all

  unauthenticated (non-AEAD) ciphers are disabled, or if they're all

  fully provided by drivers. See docs/driver-only-builds.md for full

  details and current limitations; in particular, NIST\_KW and PKCS5/PKCS12

  decryption still unconditionally depend on MBEDTLS\_CIPHER\_C.
* Add support for record size limit extension as defined by RFC 8449

  and configured with MBEDTLS\_SSL\_RECORD\_SIZE\_LIMIT.

  Application data sent and received will be fragmented according to

  Record size limits negotiated during handshake.
* Improve performance of AES-GCM, AES-CTR and CTR-DRBG when

  hardware accelerated AES is not present (around 13-23% on 64-bit Arm).
* Add functions mbedtls\_ecc\_group\_to\_psa() and mbedtls\_ecc\_group\_from\_psa()

  to convert between Mbed TLS and PSA curve identifiers.
* Add utility functions to manipulate mbedtls\_ecp\_keypair objects, filling

  gaps made by making its fields private: mbedtls\_ecp\_set\_public\_key(),

  mbedtls\_ecp\_write\_public\_key(), mbedtls\_ecp\_keypair\_calc\_public(),

  mbedtls\_ecp\_keypair\_get\_group\_id(). Fixes [#5017](https://github.com/Mbed-TLS/mbedtls/issues/5017), [#5441](https://github.com/Mbed-TLS/mbedtls/issues/5441), [#8367](https://github.com/Mbed-TLS/mbedtls/issues/8367), [#8652](https://github.com/Mbed-TLS/mbedtls/issues/8652).
* Add functions mbedtls\_md\_psa\_alg\_from\_type() and

  mbedtls\_md\_type\_from\_psa\_alg() to convert between mbedtls\_md\_type\_t and

  psa\_algorithm\_t.
* Add partial platform support for z/OS.
* Improve performance for gcc (versions older than 9.3.0) and IAR.
* Add functions mbedtls\_ecdsa\_raw\_to\_der() and mbedtls\_ecdsa\_der\_to\_raw() to

  convert ECDSA signatures between raw and DER (ASN.1) formats.
* Add support for using AES-CBC 128, 192, and 256 bit schemes

  with PKCS#5 PBES2. Keys encrypted this way can now be parsed by PK parse.
* The new function mbedtls\_rsa\_get\_bitlen() returns the length of the modulus

  in bits, i.e. the key size for an RSA key.
* Add pc files for pkg-config, e.g.:

  pkg-config --cflags --libs (mbedtls|mbedcrypto|mbedx509)
* Add getter (mbedtls\_ssl\_session\_get\_ticket\_creation\_time()) to access

  `mbedtls_ssl_session.ticket_creation_time`.
* The new functions mbedtls\_pk\_get\_psa\_attributes() and

  mbedtls\_pk\_import\_into\_psa() provide a uniform way to create a PSA

  key from a PK key.
* The benchmark program now reports times for both ephemeral and static

  ECDH in all ECDH configurations.
* Add support for 8-bit GCM tables for Shoup's algorithm to speedup GCM

  operations when hardware accelerated AES is not present. Improves

  performance by around 30% on 64-bit Intel; 125% on Armv7-M.
* The new function psa\_generate\_key\_ext() allows generating an RSA

  key pair with a custom public exponent.
* The new function mbedtls\_ecp\_write\_key\_ext() is similar to

  mbedtls\_ecp\_write\_key(), but can be used without separately calculating

  the output length.
* Add new accessor to expose the private group id member of

  `mbedtls_ecdh_context` structure.
* Add new accessor to expose the `MBEDTLS_PRIVATE(ca_istrue)` member of

  `mbedtls_x509_crt` structure. This requires setting

  the MBEDTLS\_X509\_EXT\_BASIC\_CONSTRAINTS bit in the certificate's

  ext\_types field.
* mbedtls\_psa\_get\_random() is always available as soon as

  MBEDTLS\_PSA\_CRYPTO\_CLIENT is enabled at build time and psa\_crypto\_init() is

  called at runtime. This together with MBEDTLS\_PSA\_RANDOM\_STATE can be

  used as random number generator function (f\_rng) and context (p\_rng) in

  legacy functions.
* The new functions mbedtls\_pk\_copy\_from\_psa() and

  mbedtls\_pk\_copy\_public\_from\_psa() provide ways to set up a PK context

  with the same content as a PSA key.
* Add new accessors to expose the private session-id,

  session-id length, and ciphersuite-id members of

  `mbedtls_ssl_session` structure.

  Add new accessor to expose the ciphersuite-id of

  `mbedtls_ssl_ciphersuite_t` structure.Design ref: [#8529](https://github.com/Mbed-TLS/mbedtls/issues/8529)
* Mbed TLS now supports the writing and reading of TLS 1.3 early data (see

  docs/tls13-early-data.md). The support enablement is controlled at build

  time by the MBEDTLS\_SSL\_EARLY\_DATA configuration option and at runtime by

  the mbedtls\_ssl\_conf\_early\_data() API (by default disabled in both cases).
* Add protection for multithreaded access to the PSA keystore and protection

  for multithreaded access to the the PSA global state, including

  concurrently calling psa\_crypto\_init() when MBEDTLS\_THREADING\_C and

  MBEDTLS\_THREADING\_PTHREAD are defined. See

  docs/architecture/psa-thread-safety/psa-thread-safety.md for more details.

  Resolves issues [#3263](https://github.com/Mbed-TLS/mbedtls/issues/3263) and [#7945](https://github.com/Mbed-TLS/mbedtls/issues/7945).

Security

* Fix a stack buffer overread (less than 256 bytes) when parsing a TLS 1.3

  ClientHello in a TLS 1.3 server supporting some PSK key exchange mode. A

  malicious client could cause information disclosure or a denial of service.
* Passing buffers that are stored in untrusted memory as arguments

  to PSA functions is now secure by default.

  The PSA core now protects against modification of inputs or exposure

  of intermediate outputs during operations. This is currently implemented

  by copying buffers.

  This feature increases code size and memory usage. If buffers passed to

  PSA functions are owned exclusively by the PSA core for the duration of

  the function call (i.e. no buffer parameters are in shared memory),

  copying...

[Read more](/Mbed-TLS/mbedtls/releases/tag/v3.6.0)

 Assets
3

 Loading

 üëç
1
 savin-itsph reacted with thumbs up emoji
 üéâ
1
 savin-itsph reacted with hooray emoji

All reactions

* üëç
  1 reaction
* üéâ
  1 reaction

 1 person reacted

## Mbed TLS 2.28.8

28 Mar 15:04

![@minosgalanakis](https://avatars.githubusercontent.com/u/30719586?s=40&v=4)
[minosgalanakis](/minosgalanakis)

[v2.28.8](/Mbed-TLS/mbedtls/tree/v2.28.8)

[`5a764e5`](/Mbed-TLS/mbedtls/commit/5a764e5555c64337ed17444410269ff21cb617b1)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.28.8)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 2.28.8](/Mbed-TLS/mbedtls/releases/tag/v2.28.8)

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

Mbed TLS 2.28 is a long-time support branch. It will be supported with bug-fixes and security fixes until end of 2024.

## Security Advisories

For full details, please see the following links:

* [PSA Crypto API with parameters in shared memory](https://github.com/Mbed-TLS/mbedtls-docs/blob/main/security-advisories/mbedtls-security-advisory-2024-03.md)

## Release Notes

Features

* AES-NI is now supported in Windows builds with clang and clang-cl.

  Resolves [#8372](https://github.com/Mbed-TLS/mbedtls/issues/8372).
* Add pc files for pkg-config, e.g.:

  pkg-config --cflags --libs (mbedtls|mbedcrypto|mbedx509)

Security

* Passing buffers that are stored in untrusted memory as arguments

  to PSA functions is now secure by default.

  The PSA core now protects against modification of inputs or exposure

  of intermediate outputs during operations. This is currently implemented

  by copying buffers.

  This feature increases code size and memory usage. If buffers passed to

  PSA functions are owned exclusively by the PSA core for the duration of

  the function call (i.e. no buffer parameters are in shared memory),

  copying may be disabled by setting MBEDTLS\_PSA\_ASSUME\_EXCLUSIVE\_BUFFERS.

  Note that setting this option will cause input-output buffer overlap to

  be only partially supported ([#3266](https://github.com/Mbed-TLS/mbedtls/issues/3266)).

  Fixes [CVE-2024-28960](https://github.com/advisories/GHSA-6h48-8w2f-5w94 "CVE-2024-28960").

Bugfix

* Fix the build with CMake when Everest is enabled through

  a user configuration file or the compiler command line. Fixes [#8165](https://github.com/Mbed-TLS/mbedtls/issues/8165).
* Fix an inconsistency between implementations and usages of `__cpuid`,

  which mainly causes failures when building Windows target using

  mingw or clang. Fixes [#8334](https://github.com/Mbed-TLS/mbedtls/issues/8334) & [#8332](https://github.com/Mbed-TLS/mbedtls/issues/8332).
* Correct initial capacities for key derivation algorithms: TLS12\_PRF,

  TLS12\_PSK\_TO\_MS.
* Fix mbedtls\_pk\_get\_bitlen() for RSA keys whose size is not a

  multiple of 8. Fixes [#868](https://github.com/Mbed-TLS/mbedtls/issues/868).
* Avoid segmentation fault caused by releasing not initialized

  entropy resource in gen\_key example. Fixes [#8809](https://github.com/Mbed-TLS/mbedtls/issues/8809).
* Fix missing bitflags in SSL session serialization headers. Their absence

  allowed SSL sessions saved in one configuration to be loaded in a

  different, incompatible configuration.
* Fix the restoration of the ALPN when loading serialized connection with

  the mbedtls\_ssl\_context\_load() API.
* Fully support arbitrary overlap between inputs and outputs of PSA

  functions. Note that overlap is still only partially supported when

  MBEDTLS\_PSA\_ASSUME\_EXCLUSIVE\_BUFFERS is set ([#3266](https://github.com/Mbed-TLS/mbedtls/issues/3266)).

Changes

* Use heap memory to allocate DER encoded public/private key.

  This reduces stack usage significantly for writing a public/private

  key to a PEM string.
* cmake: Use GnuInstallDirs to customize install directories

  Replace custom LIB\_INSTALL\_DIR variable with standard CMAKE\_INSTALL\_LIBDIR

  variable. For backward compatibility, set CMAKE\_INSTALL\_LIBDIR if

  LIB\_INSTALL\_DIR is set.

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Note

> ‚ùï `mbedtls-2.28.8.tar.bz2` are our official release files. `source.tar.gz` and `source.zip` are automatically generated snapshot's that github is generating. They do not include external depedencies, and [can't be configured](https://github.com/orgs/community/discussions/6003)

## Checksum

The SHA256 hashes for the archives are:

241c68402cef653e586be3ce28d57da24598eb0df13fcdea9d99bfce58717132 mbedtls-2.28.8.tar.bz2

 Assets
3

 Loading

All reactions

## Mbed TLS 3.5.2

26 Jan 10:18

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)

[v3.5.2](/Mbed-TLS/mbedtls/tree/v3.5.2)

[`daca7a3`](/Mbed-TLS/mbedtls/commit/daca7a3979c22da155ec9dce49ab1abf3b65d3a9)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.5.2)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.5.2](/Mbed-TLS/mbedtls/releases/tag/v3.5.2)

## Description

This release of Mbed TLS provides fixes for security issues.

## Security Advisories

For full details, please see the following link:

* [Timing side channel in private key RSA operations](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-01-1).
* [Buffer overflow in mbedtls\_x509\_set\_extension](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-01-2).

## Release Notes

Security

* Fix a timing side channel in private key RSA operations. This side channel

  could be sufficient for an attacker to recover the plaintext. A local

  attacker or a remote attacker who is close to the victim on the network

  might have precise enough timing measurements to exploit this. It requires

  the attacker to send a large number of messages for decryption. For

  details, see "Everlasting ROBOT: the Marvin Attack", Hubert Kario. Reported

  by Hubert Kario, Red Hat.
* Fix a failure to validate input when writing x509 extensions lengths which

  could result in an integer overflow, causing a zero-length buffer to be

  allocated to hold the extension. The extension would then be copied into

  the buffer, causing a heap buffer overflow.

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

35890edf1a2c7a7e29eac3118d43302c3e1173e0df0ebaf5db56126dabe5bb05 v3.5.2.tar.gz

eedecc468b3f8d052ef05a9d42bf63f04c8a1c50d1c5a94c251c681365a2c723 mbedtls-3.5.2.tar.gz

55c1525e7d5de18b84a1d1e5540950b4a3bac70e02889cf309919b2877cba63b v3.5.2.zip

fea0c12622044ef0d594361e83b2c2b5e4ca56bc1b44126ccca50872c7d6d4f6 mbedtls-3.5.2.zip

The URLs below point to the archives named `vX.Y.Z...`. When checking hashes, please be aware that due to GitHub's use of the Content-Disposition header, some clients will download the `vX.Y.Z...` archive and save it with the filename `mbedtls-X.Y.Z...`.

 Assets
2

 Loading

 üëç
3
 Swyter, mehregxn, and andreiaugustin reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

 3 people reacted

## Mbed TLS 2.28.7

26 Jan 10:18

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)

[v2.28.7](/Mbed-TLS/mbedtls/tree/v2.28.7)

[`555f847`](/Mbed-TLS/mbedtls/commit/555f84735aecdbd76a566cf087ec8425dfb0c8ab)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.28.7)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 2.28.7](/Mbed-TLS/mbedtls/releases/tag/v2.28.7)

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

Mbed TLS 2.28 is a long-time support branch. It will be supported with bug-fixes and security fixes until end of 2024.

## Security Advisories

For full details, please see the following links:

* [Timing side channel in private key RSA operations](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-01-1).
* [Buffer overflow in mbedtls\_x509\_set\_extension](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-01-2).

## Release Notes

Security

* Fix a timing side channel in private key RSA operations. This side channel

  could be sufficient for an attacker to recover the plaintext. A local

  attacker or a remote attacker who is close to the victim on the network

  might have precise enough timing measurements to exploit this. It requires

  the attacker to send a large number of messages for decryption. For

  details, see "Everlasting ROBOT: the Marvin Attack", Hubert Kario. Reported

  by Hubert Kario, Red Hat.
* Fix a failure to validate input when writing x509 extensions lengths which

  could result in an integer overflow, causing a zero-length buffer to be

  allocated to hold the extension. The extension would then be copied into

  the buffer, causing a heap buffer overflow.

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

4390bc4ab1ea9a1ddf3725f540d0f80838c656d1d7987a1cee8b4da43e4571de mbedtls-2.28.7.tar.gz

1df6073f0cf6a4e1953890bf5e0de2a8c7e6be50d6d6c69fa9fefcb1d14e981a v2.28.7.tar.gz

12f6e95435aa7510f74938fb1464d58c569c4b298b7044b7940758bbf6d5da04 mbedtls-2.28.7.zip

527ff2472f6c51436808242f4b626500555145a472ca0a2f30a3e68d52d9806e v2.28.7.zip

The URLs below point to the archives named `vX.Y.Z...`. When checking hashes, please be aware that due to GitHub's use of the Content-Disposition header, some clients will download the `vX.Y.Z...` archive and save it with the filename `mbedtls-X.Y.Z...`.

 Assets
2

 Loading

All reactions

## Mbed TLS 3.5.1

08 Nov 18:00

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)

[v3.5.1](/Mbed-TLS/mbedtls/tree/v3.5.1)

[`edb8fec`](/Mbed-TLS/mbedtls/commit/edb8fec9882084344a314368ac7fd957a187519c)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.5.1)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.5.1](/Mbed-TLS/mbedtls/releases/tag/v3.5.1)

## Description

This release of Mbed TLS provides a license update, and a bugfix.

## Release Notes

Changes

* Mbed TLS is now released under a dual Apache-2.0 OR GPL-2.0-or-later

  license. Users may choose which license they take the code under.

Bugfix

* Fix accidental omission of MBEDTLS\_TARGET\_PREFIX in 3rdparty modules

  in CMake.

## Who should update

We recommend all users should update at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

2597419f1a4a79dd28e6f5edc5180aff7e83bd85548437e07dcf9f808ceccb76 mbedtls-3.5.1.tar.gz

959a492721ba036afc21f04d1836d874f93ac124cf47cf62c9bcd3a753e49bdb mbedtls-3.5.1.zip

 Assets
2

 Loading

All reactions

## Mbed TLS 2.28.6

08 Nov 18:00

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)

[v2.28.6](/Mbed-TLS/mbedtls/tree/v2.28.6)

[`3a91dad`](/Mbed-TLS/mbedtls/commit/3a91dad9dceb484eea8b41f8941facafc4520021)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.28.6)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 2.28.6](/Mbed-TLS/mbedtls/releases/tag/v2.28.6)

## Description

This release of Mbed TLS updates the license, but contains no other changes from 2.28.5.

## Changes

* Mbed TLS is now released under a dual Apache-2.0 OR GPL-2.0-or-later

  license. Users may choose which license they take the code under.

## Who should update

We recommend users who need to take Mbed TLS under a GPL-2.0-or-later license should update.

## Checksum

The SHA256 hashes for the archives are:

737b088bb8877ff8f0fc404ebbc48f82486df3da4bfd5b28fa208a5967e42fb3 mbedtls-2.28.6.tar.gz

79e7679a1e88db56ee7c6e352ae6d24d67db2c2d102443343ea8938baa578d59 mbedtls-2.28.6.zip

 Assets
2

 Loading

All reactions

## Mbed TLS 3.5.0

05 Oct 17:14

![@minosgalanakis](https://avatars.githubusercontent.com/u/30719586?s=40&v=4)
[minosgalanakis](/minosgalanakis)

[mbedtls-3.5.0](/Mbed-TLS/mbedtls/tree/mbedtls-3.5.0)

[`1ec6906`](/Mbed-TLS/mbedtls/commit/1ec69067fa1351427f904362c1221b31538c8b57)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...mbedtls-3.5.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

[Mbed TLS 3.5.0](/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.5.0)

## Description

This release of Mbed TLS provides new features, bug fixes and minor enhancements. This release includes fixes for security issues.

This release brings in significant code-size reductions, partly depending on configuration. In particular, the new options `MBEDTLS_AES_ONLY_128_BIT_KEY_LENGTH` and `MBEDTLS_PSA_P256M_DRIVER_ENABLED` may help you save code size.

## Security Advisories

For full details, please see the following links:

* [Buffer overread in TLS stream cipher suites](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2023-10-1/)
* [Buffer overflow in TLS handshake parsing with ECDH](https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2023-10-2/)

## Release Notes

API changes

* Mbed TLS 3.4 introduced support for omitting the built-in implementation

  of ECDSA and/or EC J-PAKE when those are provided by a driver. However,

  there was a flaw in the logic checking if the built-in implementation, in

  that it failed to check if all the relevant curves were supported by the

  accelerator. As a result, it was possible to declare no curves as

  accelerated and still have the built-in implementation compiled out.

  Starting with this release, it is necessary to declare which curves are

  accelerated (using MBEDTLS\_PSA\_ACCEL\_ECC\_xxx macros), or they will be

  considered not accelerated, and the built-in implementation of the curves

  and any algorithm possible using them will be included in the build.
* Add new millisecond time type `mbedtls_ms_time_t` and `mbedtls_ms_time()`

  function, needed for TLS 1.3 ticket lifetimes. Alternative implementations

  can be created using an ALT interface.

Requirement changes

* Officially require Python 3.8 now that earlier versions are out of support.
* Minimum required Windows version is now Windows Vista, or

  Windows Server 2008.

New deprecations

* PSA\_WANT\_KEY\_TYPE\_xxx\_KEY\_PAIR and

  MBEDTLS\_PSA\_ACCEL\_KEY\_TYPE\_xxx\_KEY\_PAIR, where xxx is either ECC or RSA,

  are now being deprecated in favor of PSA\_WANT\_KEY\_TYPE\_xxx\_KEY\_PAIR\_yyy and

  MBEDTLS\_PSA\_ACCEL\_KEY\_TYPE\_xxx\_KEY\_PAIR\_yyy. Here yyy can be: BASIC,

  IMPORT, EXPORT, GENERATE, DERIVE. The goal is to have a finer detail about

  the capabilities of the PSA side for either key.
* MBEDTLS\_CIPHER\_BLKSIZE\_MAX is deprecated in favor of

  MBEDTLS\_MAX\_BLOCK\_LENGTH (if you intended what the name suggests:

  maximum size of any supported block cipher) or the new name

  MBEDTLS\_CMAC\_MAX\_BLOCK\_SIZE (if you intended the actual semantics:

  maximum size of a block cipher supported by the CMAC module).
* mbedtls\_pkcs5\_pbes2() and mbedtls\_pkcs12\_pbe() functions are now

  deprecated in favor of mbedtls\_pkcs5\_pbes2\_ext() and

  mbedtls\_pkcs12\_pbe\_ext() as they offer more security by checking

  for overflow of the output buffer and reporting the actual length

  of the output.

Features

* All modules that use hashes or HMAC can now take advantage of PSA Crypto

  drivers when MBEDTLS\_PSA\_CRYPTO\_C is enabled and psa\_crypto\_init() has

  been called. Previously (in 3.3), this was restricted to a few modules,

  and only in builds where MBEDTLS\_MD\_C was disabled; in particular the

  entropy module was not covered which meant an external RNG had to be

  provided - these limitations are lifted in this version. A new set of

  feature macros, MBEDTLS\_MD\_CAN\_xxx, has been introduced that can be used

  to check for availability of hash algorithms, regardless of whether

  they're provided by a built-in implementation, a driver or both. See

  docs/driver-only-builds.md.
* When a PSA driver for ECDH is present, it is now possible to disable

  MBEDTLS\_ECDH\_C in the build in order to save code size. For TLS 1.2

  key exchanges based on ECDH(E) to work, this requires

  MBEDTLS\_USE\_PSA\_CRYPTO. Restartable/interruptible ECDHE operations in

  TLS 1.2 (ECDHE-ECDSA key exchange) are not supported in those builds yet,

  as PSA does not have an API for restartable ECDH yet.
* When all of ECDH, ECDSA and EC J-PAKE are either disabled or provided by

  a driver, it is possible to disable MBEDTLS\_ECP\_C (and MBEDTLS\_BIGNUM\_C

  if not required by another module) and still get support for ECC keys and

  algorithms in PSA, with some limitations. See docs/driver-only-builds.txt

  for details.
* Add parsing of directoryName subtype for subjectAltName extension in

  x509 certificates.
* Add support for server-side TLS version negotiation. If both TLS 1.2 and

  TLS 1.3 protocols are enabled, the TLS server now selects TLS 1.2 or

  TLS 1.3 depending on the capabilities and preferences of TLS clients.

  Fixes [#6867](https://github.com/Mbed-TLS/mbedtls/issues/6867).
* X.509 hostname verification now supports IPAddress Subject Alternate Names.
* Add support for reading and writing X25519 and X448

  public and private keys in RFC 8410 format using the existing PK APIs.
* When parsing X.509 certificates, support the extensions

  SignatureKeyIdentifier and AuthorityKeyIdentifier.
* Don't include the PSA dispatch functions for PAKEs (psa\_pake\_setup() etc)

  if no PAKE algorithms are requested
* Add support for the FFDH algorithm and DH key types in PSA, with

  parameters from RFC 7919. This includes a built-in implementation based

  on MBEDTLS\_BIGNUM\_C, and a driver dispatch layer enabling alternative

  implementations of FFDH through the driver entry points.
* It is now possible to generate certificates with SubjectAltNames.

  Currently supported subtypes: DnsName, UniformResourceIdentifier,

  IP address, OtherName, and DirectoryName, as defined in RFC 5280.

  See mbedtls\_x509write\_crt\_set\_subject\_alternative\_name for

  more information.
* X.509 hostname verification now partially supports URI Subject Alternate

  Names. Only exact matching, without any normalization procedures

  described in 7.4 of RFC5280, will result in a positive URI verification.
* Add function mbedtls\_oid\_from\_numeric\_string() to parse an OID from a

  string to a DER-encoded mbedtls\_asn1\_buf.
* Add SHA-3 family hash functions.
* Add support to restrict AES to 128-bit keys in order to save code size.

  A new configuration option, MBEDTLS\_AES\_ONLY\_128\_BIT\_KEY\_LENGTH, can be

  used to enable this feature.
* AES performance improvements. Uplift varies by platform,

  toolchain, optimisation flags and mode.

  Aarch64, gcc -Os and CCM, GCM and XTS benefit the most.

  On Aarch64, uplift is typically around 20 - 110%.

  When compiling with gcc -Os on Aarch64, AES-XTS improves

  by 4.5x.
* Add support for PBKDF2-HMAC through the PSA API.
* New symbols PSA\_WANT\_KEY\_TYPE\_xxx\_KEY\_PAIR\_yyy and

  MBEDTLS\_PSA\_ACCEL\_KEY\_TYPE\_xxx\_KEY\_PAIR\_yyy (where xxx is either ECC, RSA

  or DH) were introduced in order to have finer accuracy in defining the

  PSA capabilities for each key. These capabilities, named yyy above, can be

  any of: BASIC, IMPORT, EXPORT, GENERATE, DERIVE.
  + DERIVE is only available for ECC keys, not for RSA or DH ones.
  + implementations are free to enable more than what it was strictly

    requested. For example BASIC internally enables IMPORT and EXPORT

    (useful for testing purposes), but this might change in the future.
* Add support for FFDH key exchange in TLS 1.3.

  This is automatically enabled as soon as PSA\_WANT\_ALG\_FFDH

  and the ephemeral or psk-ephemeral key exchange mode are enabled.

  By default, all groups are offered; the list of groups can be

  configured using the existing API function mbedtls\_ssl\_conf\_groups().
* Improve mbedtls\_x509\_time performance and reduce memory use.
* Reduce syscalls to time() during certificate verification.
* Allow MBEDTLS\_CONFIG\_FILE and MBEDTLS\_USER\_CONFIG\_FILE to be set by

  setting the CMake variable of the same name at configuration time.
* Add getter (mbedtls\_ssl\_cache\_get\_timeout()) to access

  `mbedtls_ssl_cache_context.timeout`.
* Add getter (mbedtls\_ssl\_get\_hostname()) to access

  `mbedtls_ssl_context.hostname`.
* Add getter (mbedtls\_ssl\_conf\_get\_endpoint()) to access

  `mbedtls_ssl_config.endpoint`.
* Support for "opaque" (PSA-held) ECC keys in the PK module has been

  extended: it is now possible to use mbedtls\_pk\_write\_key\_der(),

  mbedtls\_pk\_write\_key\_pem(), mbedtls\_pk\_check\_pair(), and

  mbedtls\_pk\_verify() with opaque ECC keys (provided the PSA attributes

  allow it).
* The documentation of mbedtls\_ecp\_group now describes the optimized

  representation of A for some curves. Fixes [#8045](https://github.com/Mbed-TLS/mbedtls/issues/8045).
* Add a possibility to generate CSR's with RCF822 and directoryName subtype

  of subjectAltName extension in x509 certificates.
* Add support for PBKDF2-CMAC through the PSA API.
* New configuration option MBEDTLS\_AES\_USE\_HARDWARE\_ONLY introduced. When

  using CPU-accelerated AES (e.g., Arm Crypto Extensions), this option

  disables the plain C implementation and the run-time detection for the

  CPU feature, which reduces code size and avoids the vulnerability of the

  plain C implementation.
* Accept arbitrary AttributeType and AttributeValue in certificate

  Distinguished Names using RFC 4514 syntax.
* Applications using ECC over secp256r1 through the PSA API can use a

  new implementation with a much smaller footprint, but some minor

  usage restrictions. See the documentation of the new configuration

  option MBEDTLS\_PSA\_P256M\_DRIVER\_ENABLED for details.

Security

* Fix a case where potentially sensitive information held in memory would not

  be completely zeroized during TLS 1.2 handshake, in both server and client

  configurations.
* In configu...

[Read more](/Mbed-TLS/mbedtls/releases/tag/mbedtls-3.5.0)

 Assets
2

 Loading

All reactions

Previous *1* [2](/Mbed-TLS/mbedtls/releases?page=2) [3](/Mbed-TLS/mbedtls/releases?page=3) [4](/Mbed-TLS/mbedtls/releases?page=4) [5](/Mbed-TLS/mbedtls/releases?page=5) [6](/Mbed-TLS/mbedtls/releases?page=6) [7](/Mbed-TLS/mbedtls/releases?page=7) [Next](/Mbed-TLS/mbedtls/releases?page=2)

Previous [Next](/Mbed-TLS/mbedtls/releases?page=2)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_462a290f_20250114_194307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.12)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.12)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.12)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  264](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.12)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.16.12](/Mbed-TLS/mbedtls/releases/tag/v2.16.12)

# Mbed TLS 2.16.12

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.16.12)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)
released this
17 Dec 11:39

[v2.16.12](/Mbed-TLS/mbedtls/tree/v2.16.12)

[`cf46671`](/Mbed-TLS/mbedtls/commit/cf4667126010c665341f9e50ef691b7ef8294188)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

This is the last release of the 2.16 long-time support branch. Users who want a long-time branch should move to mbedtls-2.28, which is backward-compatible and will be supported for at least 3 years.

## Security Advisories

For full details, please see the following links:

<https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12>

## Release Notes

Security

* Zeroize several intermediate variables used to calculate the expected

  value when verifying a MAC or AEAD tag. This hardens the library in

  case the value leaks through a memory disclosure vulnerability. For

  example, a memory disclosure vulnerability could have allowed a

  man-in-the-middle to inject fake ciphertext into a DTLS connection.
* Fix a double-free that happened after mbedtls\_ssl\_set\_session() or

  mbedtls\_ssl\_get\_session() failed with MBEDTLS\_ERR\_SSL\_ALLOC\_FAILED

  (out of memory). After that, calling mbedtls\_ssl\_session\_free()

  and mbedtls\_ssl\_free() would cause an internal session buffer to

  be free()'d twice.

Bugfix

* Stop using reserved identifiers as local variables. Fixes [#4630](https://github.com/Mbed-TLS/mbedtls/issues/4630).
* The GNU makefiles invoke python3 in preference to python except on Windows.

  The check was accidentally not performed when cross-compiling for Windows

  on Linux. Fix this. Fixes [#4774](https://github.com/Mbed-TLS/mbedtls/issues/4774).
* Mark basic constraints critical as appropriate. Note that the previous

  entry for this fix in the 2.16.10 changelog was in error, and it was not

  included in the 2.16.10 release as was stated.

  Make 'mbedtls\_x509write\_crt\_set\_basic\_constraints' consistent with RFC

  5280 4.2.1.9 which says: "Conforming CAs MUST include this extension in

  all CA certificates that contain public keys used to validate digital

  signatures on certificates and MUST mark the extension as critical in

  such certificates." Previous to this change, the extension was always

  marked as non-critical. This was fixed by [#4044](https://github.com/Mbed-TLS/mbedtls/pull/4044).
* Fix missing constraints on x86\_64 assembly code for bignum multiplication

  that broke some bignum operations with (at least) Clang 12.

  Fixes [#4116](https://github.com/Mbed-TLS/mbedtls/issues/4116), [#4786](https://github.com/Mbed-TLS/mbedtls/issues/4786), [#4917](https://github.com/Mbed-TLS/mbedtls/issues/4917).
* Failures of alternative implementations of AES or DES single-block

  functions enabled with MBEDTLS\_AES\_ENCRYPT\_ALT, MBEDTLS\_AES\_DECRYPT\_ALT,

  MBEDTLS\_DES\_CRYPT\_ECB\_ALT or MBEDTLS\_DES3\_CRYPT\_ECB\_ALT were ignored.

  This does not concern the implementation provided with Mbed TLS,

  where this function cannot fail, or full-module replacements with

  MBEDTLS\_AES\_ALT or MBEDTLS\_DES\_ALT. Reported by Armelle Duboc in [#1092](https://github.com/Mbed-TLS/mbedtls/issues/1092).
* Some failures of HMAC operations were ignored. These failures could only

  happen with an alternative implementation of the underlying hash module.
* Fix the build of sample programs when neither MBEDTLS\_ERROR\_C nor

  MBEDTLS\_ERROR\_STRERROR\_DUMMY is enabled.
* Fix a bug in mbedtls\_gcm\_starts() when the bit length of the iv

  exceeds 2^32. Fixes [#4884](https://github.com/Mbed-TLS/mbedtls/issues/4884).
* Fix the build when no SHA2 module is included. Fixes [#4930](https://github.com/Mbed-TLS/mbedtls/issues/4930).
* Fix the build when only the bignum module is included. Fixes [#4929](https://github.com/Mbed-TLS/mbedtls/issues/4929).
* Fix a potential invalid pointer dereference and infinite loop bugs in

  pkcs12 functions when the password is empty. Fix the documentation to

  better describe the inputs to these functions and their possible values.

  Fixes [#5136](https://github.com/Mbed-TLS/mbedtls/issues/5136).

Changes

* Improve the performance of base64 constant-flow code. The result is still

  slower than the original non-constant-flow implementation, but much faster

  than the previous constant-flow implementation. Fixes [#4814](https://github.com/Mbed-TLS/mbedtls/issues/4814).

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

294871ab1864a65d0b74325e9219d5bcd6e91c34a3c59270c357bb9ae4d5c393 mbedtls-2.16.12.tar.gz

1a3169e7016e7a737ea7904a7108aac7f97668f79baee6165dee9ba596cf7c10 mbedtls-2.16.12.zip

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_50dbbfd9_20250114_194310.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv3.1.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv3.1.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v3.1.0)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  264](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v3.1.0)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v3.1.0](/Mbed-TLS/mbedtls/releases/tag/v3.1.0)

# Mbed TLS 3.1.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.1.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@daverodgman](https://avatars.githubusercontent.com/u/407459?s=40&v=4)
[daverodgman](/daverodgman)
released this
17 Dec 11:39

¬∑
[14338 commits](/Mbed-TLS/mbedtls/compare/v3.1.0...development)
to development
since this release

[v3.1.0](/Mbed-TLS/mbedtls/tree/v3.1.0)

[`d65aeb3`](/Mbed-TLS/mbedtls/commit/d65aeb37349ad1a50e0f6c9b694d4b5290d60e49)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues.

## Security Advisories

For full details, please see the following links:

<https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12>

## Release Notes

API changes

* New error code for GCM: MBEDTLS\_ERR\_GCM\_BUFFER\_TOO\_SMALL.

  Alternative GCM implementations are expected to verify

  the length of the provided output buffers and to return the

  MBEDTLS\_ERR\_GCM\_BUFFER\_TOO\_SMALL in case the buffer length is too small.
* You can configure groups for a TLS key exchange with the new function

  mbedtls\_ssl\_conf\_groups(). It extends mbedtls\_ssl\_conf\_curves().
* Declare a number of structure fields as public: the fields of

  mbedtls\_ecp\_curve\_info, the fields describing the result of ASN.1 and

  X.509 parsing, and finally the field fd of mbedtls\_net\_context on

  POSIX/Unix-like platforms.

Requirement changes

* Sign-magnitude and one's complement representations for signed integers are

  not supported. Two's complement is the only supported representation.

New deprecations

* Deprecate mbedtls\_ssl\_conf\_curves() in favor of the more generic

  mbedtls\_ssl\_conf\_groups().

Removals

* Remove the partial support for running unit tests via Greentea on Mbed OS,

  which had been unmaintained since 2018.

Features

* Enable support for Curve448 via the PSA API. Contributed by

  Archana Madhavan in [#4626](https://github.com/Mbed-TLS/mbedtls/pull/4626). Fixes [#3399](https://github.com/Mbed-TLS/mbedtls/issues/3399) and [#4249](https://github.com/Mbed-TLS/mbedtls/issues/4249).
* The identifier of the CID TLS extension can be configured by defining

  MBEDTLS\_TLS\_EXT\_CID at compile time.
* Implement the PSA multipart AEAD interface, currently supporting

  ChaChaPoly and GCM.
* Warn if errors from certain functions are ignored. This is currently

  supported on GCC-like compilers and on MSVC and can be configured through

  the macro MBEDTLS\_CHECK\_RETURN. The warnings are always enabled

  (where supported) for critical functions where ignoring the return

  value is almost always a bug. Enable the new configuration option

  MBEDTLS\_CHECK\_RETURN\_WARNING to get warnings for other functions. This

  is currently implemented in the AES, DES and md modules, and will be

  extended to other modules in the future.
* Add missing PSA macros declared by PSA Crypto API 1.0.0:

  PSA\_ALG\_IS\_SIGN\_HASH, PSA\_ALG\_NONE, PSA\_HASH\_BLOCK\_LENGTH, PSA\_KEY\_ID\_NULL.
* Add support for CCM\*-no-tag cipher to the PSA.

  Currently only 13-byte long IV's are supported.

  For decryption a minimum of 16-byte long input is expected.

  These restrictions may be subject to change.
* Add new API mbedtls\_ct\_memcmp for constant time buffer comparison.
* Add functions to get the IV and block size from cipher\_info structs.
* Add functions to check if a cipher supports variable IV or key size.
* Add the internal implementation of and support for CCM to the PSA multipart

  AEAD interface.
* Mbed TLS provides a minimum viable implementation of the TLS 1.3

  protocol. See docs/architecture/tls13-support.md for the definition of

  the TLS 1.3 Minimum Viable Product (MVP). The MBEDTLS\_SSL\_PROTO\_TLS1\_3

  configuration option controls the enablement of the support. The APIs

  mbedtls\_ssl\_conf\_min\_version() and mbedtls\_ssl\_conf\_max\_version() allow

  to select the 1.3 version of the protocol to establish a TLS connection.
* Add PSA API definition for ARIA.

Security

* Zeroize several intermediate variables used to calculate the expected

  value when verifying a MAC or AEAD tag. This hardens the library in

  case the value leaks through a memory disclosure vulnerability. For

  example, a memory disclosure vulnerability could have allowed a

  man-in-the-middle to inject fake ciphertext into a DTLS connection.
* In psa\_aead\_generate\_nonce(), do not read back from the output buffer.

  This fixes a potential policy bypass or decryption oracle vulnerability

  if the output buffer is in memory that is shared with an untrusted

  application.
* In psa\_cipher\_generate\_iv() and psa\_cipher\_encrypt(), do not read back

  from the output buffer. This fixes a potential policy bypass or decryption

  oracle vulnerability if the output buffer is in memory that is shared with

  an untrusted application.
* Fix a double-free that happened after mbedtls\_ssl\_set\_session() or

  mbedtls\_ssl\_get\_session() failed with MBEDTLS\_ERR\_SSL\_ALLOC\_FAILED

  (out of memory). After that, calling mbedtls\_ssl\_session\_free()

  and mbedtls\_ssl\_free() would cause an internal session buffer to

  be free()'d twice.

Bugfix

* Stop using reserved identifiers as local variables. Fixes [#4630](https://github.com/Mbed-TLS/mbedtls/issues/4630).
* The GNU makefiles invoke python3 in preference to python except on Windows.

  The check was accidentally not performed when cross-compiling for Windows

  on Linux. Fix this. Fixes [#4774](https://github.com/Mbed-TLS/mbedtls/issues/4774).
* Prevent divide by zero if either of PSA\_CIPHER\_ENCRYPT\_OUTPUT\_SIZE() or

  PSA\_CIPHER\_UPDATE\_OUTPUT\_SIZE() were called using an asymmetric key type.
* Fix a parameter set but unused in psa\_crypto\_cipher.c. Fixes [#4935](https://github.com/Mbed-TLS/mbedtls/issues/4935).
* Don't use the obsolete header path sys/fcntl.h in unit tests.

  These header files cause compilation errors in musl.

  Fixes [#4969](https://github.com/Mbed-TLS/mbedtls/pull/4969).
* Fix missing constraints on x86\_64 and aarch64 assembly code

  for bignum multiplication that broke some bignum operations with

  (at least) Clang 12.

  Fixes [#4116](https://github.com/Mbed-TLS/mbedtls/issues/4116), [#4786](https://github.com/Mbed-TLS/mbedtls/issues/4786), [#4917](https://github.com/Mbed-TLS/mbedtls/issues/4917), [#4962](https://github.com/Mbed-TLS/mbedtls/issues/4962).
* Fix mbedtls\_cipher\_crypt: AES-ECB when MBEDTLS\_USE\_PSA\_CRYPTO is enabled.
* Failures of alternative implementations of AES or DES single-block

  functions enabled with MBEDTLS\_AES\_ENCRYPT\_ALT, MBEDTLS\_AES\_DECRYPT\_ALT,

  MBEDTLS\_DES\_CRYPT\_ECB\_ALT or MBEDTLS\_DES3\_CRYPT\_ECB\_ALT were ignored.

  This does not concern the implementation provided with Mbed TLS,

  where this function cannot fail, or full-module replacements with

  MBEDTLS\_AES\_ALT or MBEDTLS\_DES\_ALT. Reported by Armelle Duboc in [#1092](https://github.com/Mbed-TLS/mbedtls/issues/1092).
* Some failures of HMAC operations were ignored. These failures could only

  happen with an alternative implementation of the underlying hash module.
* Fix the error returned by psa\_generate\_key() for a public key. Fixes [#4551](https://github.com/Mbed-TLS/mbedtls/issues/4551).
* Fix compile-time or run-time errors in PSA

  AEAD functions when ChachaPoly is disabled. Fixes [#5065](https://github.com/Mbed-TLS/mbedtls/issues/5065).
* Remove PSA'a AEAD finish/verify output buffer limitation for GCM.

  The requirement of minimum 15 bytes for output buffer in

  psa\_aead\_finish() and psa\_aead\_verify() does not apply to the built-in

  implementation of GCM.
* Move GCM's update output buffer length verification from PSA AEAD to

  the built-in implementation of the GCM.

  The requirement for output buffer size to be equal or greater then

  input buffer size is valid only for the built-in implementation of GCM.

  Alternative GCM implementations can process whole blocks only.
* Fix the build of sample programs when neither MBEDTLS\_ERROR\_C nor

  MBEDTLS\_ERROR\_STRERROR\_DUMMY is enabled.
* Fix PSA\_ALG\_RSA\_PSS verification accepting an arbitrary salt length.

  This algorithm now accepts only the same salt length for verification

  that it produces when signing, as documented. Use the new algorithm

  PSA\_ALG\_RSA\_PSS\_ANY\_SALT to accept any salt length. Fixes [#4946](https://github.com/Mbed-TLS/mbedtls/issues/4946).
* The existing predicate macro name PSA\_ALG\_IS\_HASH\_AND\_SIGN is now reserved

  for algorithm values that fully encode the hashing step, as per the PSA

  Crypto API specification. This excludes PSA\_ALG\_RSA\_PKCS1V15\_SIGN\_RAW and

  PSA\_ALG\_ECDSA\_ANY. The new predicate macro PSA\_ALG\_IS\_SIGN\_HASH covers

  all algorithms that can be used with psa\_{sign,verify}\_hash(), including

  these two.
* Fix issue in Makefile on Linux with SHARED=1, that caused shared libraries

  not to list other shared libraries they need.
* Fix a bug in mbedtls\_gcm\_starts() when the bit length of the iv

  exceeds 2^32. Fixes [#4884](https://github.com/Mbed-TLS/mbedtls/issues/4884).
* Fix an uninitialized variable warning in test\_suite\_ssl.function with GCC

  version 11.
* Fix the build when no SHA2 module is included. Fixes [#4930](https://github.com/Mbed-TLS/mbedtls/issues/4930).
* Fix the build when only the bignum module is included. Fixes [#4929](https://github.com/Mbed-TLS/mbedtls/issues/4929).
* Fix a potential invalid pointer dereference and infinite loop bugs in

  pkcs12 functions when the password is empty. Fix the documentation to

  better describe the inputs to these functions and their possible values.

  Fixes [#5136](https://github.com/Mbed-TLS/mbedtls/issues/5136).
* The key usage flags PSA\_KEY\_USAGE\_SIGN\_MESSAGE now allows the MAC

  operations psa\_mac\_compute() and psa\_mac\_sign\_setup().
* The key usage flags PSA\_KEY\_USAGE\_VERIFY\_MESSAGE now allows the MAC

  operations psa\_mac\_verify() and psa\_mac\_verify\_setup().

Changes

* Explicitly mark the fields mbedtls\_ssl\_session.exported and

  mbedtls\_ssl\_config.respect\_cli\_pref as private. This was an

  oversight during the run-up to the release of Mbed TLS 3.0.

  The fields were never intended to be public.
* Implement multi-part CCM API.

  The multi-part functions: mbedtls\_ccm\_starts(), mbedtls\_ccm\_set\_lengths(),

  mbedtls\_ccm\_update\_ad(), mbedtls\_ccm\_update(), mbedtls\_ccm\_finish()

  were introduced in mbedTLS 3.0 release, however their implementation was

  postponed until now.

  Implemented functions support chunked data input for both CCM and CCM\*

  algorithms.
* Remove MBEDTLS\_SSL\_EXPORT\_KEYS, making it always on and increasing the

  code size by about 80B on an M0 build. This option only gated an ability

  to set a callback, but was deemed unnecessary as it was yet another define

  to remember when writing tests, or test configurations. Fixes [#4653](https://github.com/Mbed-TLS/mbedtls/issues/4653).
* Improve the performance of base64 constant-flow code. The result is still

  slower than the original non-constant-flow implementation, but much faster

  than the previous constant-flow implementation. Fixes [#4814](https://github.com/Mbed-TLS/mbedtls/issues/4814).
* Ignore plaintext/ciphertext lengths for CCM\*-no-tag operations.

  For CCM\* encryption/decryption without authentication, input

  length will be ignored.
* Indicate in the error returned if the nonce length used with

  ChaCha20-Poly1305 is invalid, and not just unsupported.
* The mbedcrypto library includes a new source code module constant\_time.c,

  containing various functions meant to resist timing side channel attacks.

  This module does not have a separate configuration option, and functions

  from this module will be included in the build as required. Currently

  most of the interface of this module is private and may change at any

  time.
* The generated configuration-independent files are now automatically

  generated by the CMake build system on Unix-like systems. This is not

  yet supported when cross-compiling.

## Who should update

We recommend all users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

b02df6f68dd1537e115a8497d5c173dc71edc55ad084756e57a30f951b725acd mbedtls-3.1.0.tar.gz

8ec791eaed8332c50cade2bcc17b75ae5931ac00824a761b5aa4e7586645b72b mbedtls-3.1.0.zip

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_d6643edf_20250114_194311.html ===


---

[[Date Prev](msg00035.html)][[Date Next](msg00037.html)]
[[Thread Prev](msg00035.html)][[Thread Next](msg00037.html)]
[[Date Index](maillist.html#00036)]
[[Thread Index](threads.html#00036)]

# [SECURITY] [DLA 3249-1] mbedtls security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3249-1] mbedtls security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 26 Dec 2022 00:33:58 +0100
* *Message-id*: <[[üîé]](/msgid-search/414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel%40debian.org)¬†[414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel@debian.org](msg00036.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3249-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
December 26, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : mbedtls
Version        : 2.16.9-0~deb10u1
CVE ID         : CVE-2019-16910 CVE-2019-18222 CVE-2020-10932 CVE-2020-10941
                 CVE-2020-16150 CVE-2020-36421 CVE-2020-36422 CVE-2020-36423
                 CVE-2020-36424 CVE-2020-36425 CVE-2020-36426 CVE-2020-36475
                 CVE-2020-36476 CVE-2020-36478 CVE-2021-24119 CVE-2021-43666
                 CVE-2021-44732 CVE-2022-35409
Debian Bug     : 941265 963159 972806 1002631

Multiple security vulnerabilities have been discovered in mbedtls, a
lightweight crypto and SSL/TLS library, which may allow attackers to obtain
sensitive information like the RSA private key or cause a denial of service
(application or server crash).

For Debian 10 buster, these problems have been fixed in version
2.16.9-0~deb10u1.

We recommend that you upgrade your mbedtls packages.

For the detailed security status of mbedtls please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mbedtls>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpsZBICojoMg.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from bugs.gentoo.org_514e9b98_20250114_194303.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla ‚Äì Bug¬†829660
<net-libs/mbedtls-{2.16.12,2.28.0}: multiple vulnerabilities
Last modified: 2023-01-11 05:25:11 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)‚Äì[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New¬†Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=829660&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=829660&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug¬†829660**](show_bug.cgi?id=829660)
(CVE-2021-43666, CVE-2021-44732, CVE-2021-45450)
- <net-libs/mbedtls-{2.16.12,2.28.0}: multiple vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-libs/mbedtls-{2.16.12,2.28.0}: multiple vulnerabilities

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-43666, CVE-2021-44732, CVE-2021-45450 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [829713](show_bug.cgi?id=829713 "RESOLVED FIXED - net-libs/mbedtls: please rapid stabilize 2.16.12 and 2.28.0-r1.") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=829660&hide_resolved=1) | |  | | Reported: | 2021-12-19 22:15 UTC by John Helmert III | | --- | --- | | Modified: | 2023-01-11 05:25 UTC ([History](show_activity.cgi?id=829660)) | | CC List: | 1 user (show)  blueness | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=829660&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=829660&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-12-19 22:15:11 UTC  ``` <https://github.com/ARMmbed/mbedtls/releases/tag/v2.16.12> <https://github.com/ARMmbed/mbedtls/releases/tag/v2.28.0> <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2021-12>  "Security    * Zeroize several intermediate variables used to calculate the expected      value when verifying a MAC or AEAD tag. This hardens the library in      case the value leaks through a memory disclosure vulnerability. For      example, a memory disclosure vulnerability could have allowed a      man-in-the-middle to inject fake ciphertext into a DTLS connection.    * In psa_cipher_generate_iv() and psa_cipher_encrypt(), do not read back      from the output buffer. This fixes a potential policy bypass or decryption      oracle vulnerability if the output buffer is in memory that is shared with      an untrusted application.    * Fix a double-free that happened after mbedtls_ssl_set_session() or      mbedtls_ssl_get_session() failed with MBEDTLS_ERR_SSL_ALLOC_FAILED      (out of memory). After that, calling mbedtls_ssl_session_free()      and mbedtls_ssl_free() would cause an internal session buffer to      be free()'d twice."  please bump to 2.16.12 and 2.28.0. ```  [Comment 1](#c1)  Anthony Basile   gentoo-dev  2021-12-20 13:58:52 UTC  ``` I just added 2.16.12, 2.28.0 and 3.1.0.  I did preliminary testing and they are ready for rapid stabilization. ```  [Comment 2](#c2)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-12-20 20:30:23 UTC  ``` Thank you! ```  [Comment 3](#c3)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-12-21 07:21:14 UTC  ``` (In reply to John Helmert III from [comment #0](show_bug.cgi?id=829660#c0)) > <https://github.com/ARMmbed/mbedtls/releases/tag/v2.16.12> > <https://github.com/ARMmbed/mbedtls/releases/tag/v2.28.0> > <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security>- > advisory-2021-12 >  > "Security >    * Zeroize several intermediate variables used to calculate the expected >      value when verifying a MAC or AEAD tag. This hardens the library in >      case the value leaks through a memory disclosure vulnerability. For >      example, a memory disclosure vulnerability could have allowed a >      man-in-the-middle to inject fake ciphertext into a DTLS connection. >    * In psa_cipher_generate_iv() and psa_cipher_encrypt(), do not read back >      from the output buffer. This fixes a potential policy bypass or > decryption >      oracle vulnerability if the output buffer is in memory that is shared > with >      an untrusted application.  CVE-2021-45450  >    * Fix a double-free that happened after mbedtls_ssl_set_session() or >      mbedtls_ssl_get_session() failed with MBEDTLS_ERR_SSL_ALLOC_FAILED >      (out of memory). After that, calling mbedtls_ssl_session_free() >      and mbedtls_ssl_free() would cause an internal session buffer to >      be free()'d twice." >  > please bump to 2.16.12 and 2.28.0. ```  [Comment 4](#c4)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-12-22 20:26:46 UTC  ``` Please cleanup, thanks! ```  [Comment 5](#c5)  Anthony Basile   gentoo-dev  2022-01-15 22:01:07 UTC  ``` (In reply to John Helmert III from [comment #4](show_bug.cgi?id=829660#c4)) > Please cleanup, thanks!  clean up done ```  [Comment 6](#c6)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-01-15 22:16:37 UTC  ``` Thanks! ```  [Comment 7](#c7)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-03-24 21:36:19 UTC  ``` CVE-2021-43666 (<https://github.com/ARMmbed/mbedtls/issues/5136>):  A Denial of Service vulnerability exists in mbed TLS 3.0.0 and earlier in the mbedtls_pkcs12_derivation function when an input password's length is 0. ```  [Comment 8](#c8)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-12-22 23:47:51 UTC  ``` GLSA request filed. ```  [Comment 9](#c9)  Larry the Git Cow   gentoo-dev  2023-01-11 05:22:44 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=f524f5fa47d9d739280d4530623a93084918da39>  commit f524f5fa47d9d739280d4530623a93084918da39 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2023-01-11 05:19:06 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2023-01-11 05:22:06 +0000      [ GLSA 202301-08 ] Mbed TLS: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/730752>     Bug: <https://bugs.gentoo.org/740108>     Bug: <https://bugs.gentoo.org/764317>     Bug: <https://bugs.gentoo.org/778254>     Bug: <https://bugs.gentoo.org/801376>     Bug: <https://bugs.gentoo.org/829660>     Bug: <https://bugs.gentoo.org/857813>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202301-08.xml | 62 ++++++++++++++++++++++++++++++++++++++++++++++++++++++  1 file changed, 62 insertions(+) ```  [Comment 10](#c10)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-01-11 05:25:11 UTC  ``` GLSA released, all done! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=829660)
* -¬†[XML](show_bug.cgi?ctype=xml&id=829660)
* -¬†[Clone This Bug](enter_bug.cgi?cloned_bug_id=829660)
* -¬†[Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=829660&product=Gentoo%20Security)
* -¬†Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)‚Äì[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New¬†Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=829660&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=829660&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


