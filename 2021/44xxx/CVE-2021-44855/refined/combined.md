=== Content from security.gentoo.org_ae3e6eb7_20250114_200655.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MediaWiki: Multiple Vulnerabilities — GLSA **202305-24**

Multiple vulnerabilities have been found in MediaWiki, the worst of which could result in denial of service.

### Affected packages

| Package | **www-apps/mediawiki** on all architectures |
| --- | --- |
| Affected versions | < **1.38.5** |
| Unaffected versions | >= **1.38.5** |

### Background

MediaWiki is a collaborative editing software, used by big projects like Wikipedia.

### Description

Multiple vulnerabilities have been discovered in MediaWiki. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All MediaWiki users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.38.5"

```
### References

* [CVE-2021-41798](https://nvd.nist.gov/vuln/detail/CVE-2021-41798)
* [CVE-2021-41799](https://nvd.nist.gov/vuln/detail/CVE-2021-41799)
* [CVE-2021-41800](https://nvd.nist.gov/vuln/detail/CVE-2021-41800)
* [CVE-2021-44854](https://nvd.nist.gov/vuln/detail/CVE-2021-44854)
* [CVE-2021-44855](https://nvd.nist.gov/vuln/detail/CVE-2021-44855)
* [CVE-2021-44856](https://nvd.nist.gov/vuln/detail/CVE-2021-44856)
* [CVE-2021-44857](https://nvd.nist.gov/vuln/detail/CVE-2021-44857)
* [CVE-2021-44858](https://nvd.nist.gov/vuln/detail/CVE-2021-44858)
* [CVE-2021-45038](https://nvd.nist.gov/vuln/detail/CVE-2021-45038)
* [CVE-2022-28202](https://nvd.nist.gov/vuln/detail/CVE-2022-28202)
* [CVE-2022-28205](https://nvd.nist.gov/vuln/detail/CVE-2022-28205)
* [CVE-2022-28206](https://nvd.nist.gov/vuln/detail/CVE-2022-28206)
* [CVE-2022-28209](https://nvd.nist.gov/vuln/detail/CVE-2022-28209)
* [CVE-2022-31090](https://nvd.nist.gov/vuln/detail/CVE-2022-31090)
* [CVE-2022-31091](https://nvd.nist.gov/vuln/detail/CVE-2022-31091)
* [CVE-2022-34911](https://nvd.nist.gov/vuln/detail/CVE-2022-34911)
* [CVE-2022-34912](https://nvd.nist.gov/vuln/detail/CVE-2022-34912)
* [CVE-2022-41765](https://nvd.nist.gov/vuln/detail/CVE-2022-41765)
* [CVE-2022-41766](https://nvd.nist.gov/vuln/detail/CVE-2022-41766)
* [CVE-2022-41767](https://nvd.nist.gov/vuln/detail/CVE-2022-41767)
* [CVE-2022-47927](https://nvd.nist.gov/vuln/detail/CVE-2022-47927)

**Release date**

May 21, 2023

**Latest revision**

May 21, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [815376](https://bugs.gentoo.org/show_bug.cgi?id=815376)
* [829302](https://bugs.gentoo.org/show_bug.cgi?id=829302)
* [836430](https://bugs.gentoo.org/show_bug.cgi?id=836430)
* [855965](https://bugs.gentoo.org/show_bug.cgi?id=855965)
* [873385](https://bugs.gentoo.org/show_bug.cgi?id=873385)
* [888041](https://bugs.gentoo.org/show_bug.cgi?id=888041)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from phabricator.wikimedia.org_7011aaed_20250114_200655.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT293589)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T293589
# CVE-2021-44855: Blind Stored XSS via Upload Image via URLClosed, Resolved[Public](/policy/explain/PHID-TASK-ss56yphul4pgu3lp3e46/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/293589/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/293589/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-ss56yphul4pgu3lp3e46/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-ss56yphul4pgu3lp3e46/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Protect as security issue](/wmf/escalate-task/293589/)
* [Award Token](/token/give/PHID-TASK-ss56yphul4pgu3lp3e46/)
* [Flag For Later](/flag/edit/PHID-TASK-ss56yphul4pgu3lp3e46/)

Assigned To

|  | [matmarex](/p/matmarex/) |
| --- | --- |

Authored By

|  | [aidilarf28](/p/aidilarf28/) |
| --- | --- |
| Oct 18 2021, 2:29 AM2021-10-18 02:29:09 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Security](/tag/security/)
* [Vuln-XSS](/tag/vuln-xss/)
* [VisualEditor](/tag/visualeditor/) [(Triaged)](/project/board/483/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [Patch-For-Review](/tag/patch-for-review/)
* [MW-1.38-notes (1.38.0-wmf.16; 2022-01-03)](/project/view/5648/)
Referenced Files

|  | [F34750523: 01-T293589-rev2.patch](/F34750523) |
| --- | --- |
| Nov 16 2021, 6:25 PM2021-11-16 18:25:00 (UTC+0) |

|  | [F34695003: 0002-ve.ui.MWMediaDialog-Clean-up-image-metadata-display.patch](/F34695003) |
| --- | --- |
| Oct 18 2021, 8:33 PM2021-10-18 20:33:40 (UTC+0) |

|  | [F34694086: 0001-SECURITY-ve.ui.MWMediaDialog-Escape-plaintext-image-.patch](/F34694086) |
| --- | --- |
| Oct 18 2021, 12:39 PM2021-10-18 12:39:26 (UTC+0) |

Subscribers

|  | [aidilarf28](/p/aidilarf28/) |
| --- | --- |

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [DLynch](/p/DLynch/) |
| --- | --- |

|  | [Dylsss](/p/Dylsss/) |
| --- | --- |

|  | [Esanders](/p/Esanders/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [jeena](/p/jeena/) |
| --- | --- |

[View All 14 Subscribers](/subscriptions/list/PHID-TASK-ss56yphul4pgu3lp3e46/)
# Description

Hi ,

I Found Blind Stored XSS <https://id.wikipedia.org/>

Follow me :)

**Steps :**

1. Login your account here <https://commons.wikimedia.org/>
2. Then upload the Image File here [https://commons.wikimedia.org/wiki/Special:UploadWizard](https://commons.wikimedia.org/wiki/Special%3AUploadWizard)
3. If you have, click **"Continue"**
4. Then you will find the features:

> This site requires you to provide copyright information for this work, to make sure everyone can legally reuse it.
>
> This file is my own work.
>
> This file is not my own work.

5. Select "This file is not my own work."
6. XSS is in the input form **"Source & Author(s)"**
7. Next, input the XSS payload in the 2 Input Forms :)

Payloads:

```
"><img src=c onerror=prompt(document.domain)>
```

8. Then if you have, click **"Publish File"**
9. Then you will get the URL:

> To use the file in a wiki, copy this text into a page:
>
> [[File:HACKED0001231313123123123131.jpg|thumb|"><img src=c onerror=prompt(document.domain)>]]
>
> To link to it in HTML, copy this URL:
>
> [https://commons.wikimedia.org/wiki/File:HACKED0001231313123123123131.jpg](https://commons.wikimedia.org/wiki/File%3AHACKED0001231313123123123131.jpg)

10. Next Edit User Article <https://id.wikipedia.org/>
11. Click Insert **"Image & Media Tool"**
12. Input the URL of your PHOTO location that has been inserted XSS :)

[https://commons.wikimedia.org/wiki/File:HACKED0001231313123123123131.jpg](https://commons.wikimedia.org/wiki/File%3AHACKED0001231313123123123131.jpg)

13. Look, your photo appears
14. Then click, and see a pop up appear and XSS is triggered :)

**Supporting Report :**

1. Screenshot

Download Now :

<https://www.dropbox.com/s/mlleeemug0znhzf/BLIND%20STORED%20XSS%20WIKIPEDIA.jpg?dl=0>

2. Video

Download Now :

<https://www.dropbox.com/s/b4uge4kgdw3ves6/BLIND%20STORED%20XSS%20WIKIPEDIA%202.mp4?dl=0>

# Details

Risk Rating High Author Affiliation Wikimedia Communities

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields](https://gerrit.wikimedia.org/r/c/747703) | [mediawiki/extensions/VisualEditor](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor) | [REL1\_31](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor/%2B/REL1_31) | +3 -3 |
|  | [SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields](https://gerrit.wikimedia.org/r/c/747592) | [mediawiki/extensions/VisualEditor](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor/%2B/master) | +2 -2 |
|  | [SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields](https://gerrit.wikimedia.org/r/c/747594) | [mediawiki/extensions/VisualEditor](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor) | [REL1\_36](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor/%2B/REL1_36) | +3 -3 |
|  | [SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields](https://gerrit.wikimedia.org/r/c/747595) | [mediawiki/extensions/VisualEditor](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor) | [REL1\_35](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor/%2B/REL1_35) | +3 -3 |
|  | [SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields](https://gerrit.wikimedia.org/r/c/747593) | [mediawiki/extensions/VisualEditor](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor) | [REL1\_37](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/VisualEditor/%2B/REL1_37) | +3 -3 |
|  | [Changes to content and Gemfile for security.wikimedia.org](https://gerrit.wikimedia.org/r/c/734739) | [wikimedia/security/landing-page](https://gerrit.wikimedia.org/r/plugins/gitiles/wikimedia/security/landing-page) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/wikimedia/security/landing-page/%2B/master) | +21 -7 |
|  | [Add Aidil Arief to security hall of fame for reporting two issues](https://gerrit.wikimedia.org/r/c/731990) | [wikimedia/security/landing-page](https://gerrit.wikimedia.org/r/plugins/gitiles/wikimedia/security/landing-page) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/wikimedia/security/landing-page/%2B/master) | +17 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T293589)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T292226 [Release MediaWiki 1.35.5/1.36.3/1.37.1](/T292226) |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T292227 [Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227) |
|  |  | Resolved | Security | [matmarex](/p/matmarex/) | T293589 [CVE-2021-44855: Blind Stored XSS via Upload Image via URL](/T293589) |

Mentioned In [T297896: Apply changes from 1.35.5 to unsupported legacy branch `REL1\_31`](/T297896)
[T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227) Mentioned Here [T292226: Release MediaWiki 1.35.5/1.36.3/1.37.1](/T292226)
[rEVED4947420650ec: Transform the search widget to show image details](/rEVED4947420650ecfe9f06df0cbf4136ebd73c1a8624)
[T293556: Stored XSS via WikibaseMediaInfo caption fields at commons.wikimedia.org (CVE-2021-46146)](/T293556)
### Event Timeline

[aidilarf28](/p/aidilarf28/) created this task.[Oct 18 2021, 2:29 AM2021-10-18 02:29:09 (UTC+0)](#7434701)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/4468472/)[Oct 18 2021, 2:29 AM2021-10-18 02:29:10 (UTC+0)](#7434712)

[Aklapper](/p/Aklapper/) added a project: [Vuln-XSS](/tag/vuln-xss/).[Oct 18 2021, 7:48 AM2021-10-18 07:48:52 (UTC+0)](#7435058)Comment Actions

Thanks a lot for reporting this! I'm going to cross-link to your other report at [T293556: Stored XSS via WikibaseMediaInfo caption fields at commons.wikimedia.org (CVE-2021-46146)](/T293556).

[aidilarf28](/p/aidilarf28/) added a comment.[Oct 18 2021, 7:57 AM2021-10-18 07:57:30 (UTC+0)](#7435091)Comment Actions

Hi [@Aklapper](/p/Aklapper/)

Thanks for responds :)

It might be a little different from the previous report, because in the previous report XSS was triggered from Caption and in this report XSS was triggered in Author and Source Name, And XSS was triggered in Blind on Wikipedia Main Page :)

[matmarex](/p/matmarex/) claimed this task.[Oct 18 2021, 12:04 PM2021-10-18 12:04:05 (UTC+0)](#7435793)[matmarex](/p/matmarex/) added a project: [VisualEditor](/tag/visualeditor/).[matmarex](/p/matmarex/) subscribed.Comment Actions

Thanks for the report, I can reproduce the problem.

It's a bug in VisualEditor media dialog, occurring regardless of how the image was uploaded. Several of the image metadata fields are displayed incorrectly. We take the HTML from the API (where the payload is safely escaped), and then remove all formatting from it and treat the resulting plain text as if it was HTML, leading to the bug.

It looks like the bug was already present in the first version of that code from 2015 ([rEVED4947420650ec: Transform the search widget to show image details](/rEVED4947420650ecfe9f06df0cbf4136ebd73c1a8624)).

It's probably difficult to exploit in practice, since you'd have to trick the user into opening the editor, searching for an image name or URL that you provide, and then inserting that image. (It's not exploitable by simply following a link.)

I'm working on a patch, it's a bit complicated since some metadata fields are supposed to be HTML, and I want to make sure we're handling all cases right.

[matmarex](/p/matmarex/) added a comment.[Oct 18 2021, 12:39 PM2021-10-18 12:39:26 (UTC+0)](#7435882)Comment Actions

Patch:

0001-SECURITY-ve.ui.MWMediaDialog-Escape-plaintext-image-.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/vihgw7yikbdyidbhoh73/PHID-FILE-l4mkigxwka4glcphntz6/0001-SECURITY-ve.ui.MWMediaDialog-Escape-plaintext-image-.patch)

This is the simplest patch that fixes the vulnerability, without double-escaping other fields.

There are some other improvements to be made (fixing raw HTML messages, and avoiding parsing and escaping HTML several times), but I haven't finished investigating that, and we can do those later in public with normal code review.

[Reedy](/p/Reedy/) renamed this task from [ SECURITY VULNERABILIT ] Blind Stored XSS at https://id.wikipedia.org/ Via Upload Image Via URL to [ SECURITY VULNERABILITY ] Blind Stored XSS at https://id.wikipedia.org/ Via Upload Image Via URL.[Oct 18 2021, 1:31 PM2021-10-18 13:31:12 (UTC+0)](#7436050)[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Oct 18 2021, 2:30 PM2021-10-18 14:30:41 (UTC+0)](#7436469)[sbassett](/p/sbassett/) added projects: [SecTeam-Processed](/tag/secteam-processed/), [Patch-For-Review](/tag/patch-for-review/).Comment Actions

+1 to [@matmarex](/p/matmarex/)' patch above. The [Security-Team](/tag/security-team/) should be able to have this deployed by today's security deployment window (21:00 UTC) at the latest.

[sbassett](/p/sbassett/) triaged this task as High priority.[Oct 18 2021, 2:30 PM2021-10-18 14:30:58 (UTC+0)](#7436473)[sbassett](/p/sbassett/) changed Risk Rating from N/A to High.[matmarex](/p/matmarex/) added a subscriber: [VPuffetMichel](/p/VPuffetMichel/).[Oct 18 2021, 2:59 PM2021-10-18 14:59:24 (UTC+0)](#7436728)[matmarex](/p/matmarex/) added a subscriber: [ppelberg](/p/ppelberg/).[Oct 18 2021, 3:45 PM2021-10-18 15:45:04 (UTC+0)](#7437057)[matmarex](/p/matmarex/) added a subscriber: [DLynch](/p/DLynch/).[Oct 18 2021, 4:56 PM2021-10-18 16:56:07 (UTC+0)](#7437450)[matmarex](/p/matmarex/) added a comment.[Oct 18 2021, 8:33 PM2021-10-18 20:33:40 (UTC+0)](#7438356)Comment Actions

Patch for the other improvements I promised in my previous comment:

*[not a security patch, no need to deploy this]*

0002-ve.ui.MWMediaDialog-Clean-up-image-metadata-display.patch10 KB[Download](https://phab.wmfusercontent.org/file/download/jp6dutz3vtizugrfwp4b/PHID-FILE-r4c37nnwxekjeaultnd4/0002-ve.ui.MWMediaDialog-Clean-up-image-metadata-display.patch)

At first I wanted to wait until I can submit it publicly for code review in Gerrit, but then I realized that we'll probably need to wait until the next MediaWiki security release (because VisualEditor is now a bundled extension), and I don't know when that will be and it might be a while. I'm uploading it here so that I don't accidentally lose it, but feel free to review now if you want.

[sbassett](/p/sbassett/) added subscribers: [Mstyles](/p/Mstyles/), [Reedy](/p/Reedy/).[Oct 18 2021, 8:45 PM2021-10-18 20:45:58 (UTC+0)](#7438410)Comment Actions
> In [T293589#7438356](/T293589#7438356), [@matmarex](/p/matmarex/) wrote:
>
> Patch for the other improvements I promised in my previous comment:
>
> *[not a security patch, no need to deploy this]*

Ok, thanks.

> At first I wanted to wait until I can submit it publicly for code review in Gerrit, but then I realized that we'll probably need to wait until the next MediaWiki security release (because VisualEditor is now a bundled extension), and I don't know when that will be and it might be a while. I'm uploading it here so that I don't accidentally lose it, but feel free to review now if you want.

We (mainly [@Reedy](/p/Reedy/)) have been getting them out pretty consistently at the end of each quarter. So the next one ([T292226](/T292226)) would likely be released around that last week or December 2021, or maybe a bit before that due to end-of-the-year holidays, etc.

[@Mstyles](/p/Mstyles/) and I still plan to deploy the security patch from [T293589#7435882](/T293589#7435882) in about 15 minutes, along with the one from [T293556#7437990](/T293556#7437990).

[sbassett](/p/sbassett/) added a parent task: [T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227).[Oct 18 2021, 9:52 PM2021-10-18 21:52:27 (UTC+0)](#7438696)[Mstyles](/p/Mstyles/) added a comment.[Oct 18 2021, 10:07 PM2021-10-18 22:07:31 (UTC+0)](#7438754)Comment Actions

deployed 10/18 to production (<https://sal.toolforge.org/log/zRBxlXwBa_6PSCT9WSay>)

[Mstyles](/p/Mstyles/) lowered the priority of this task from High to Low.[Oct 18 2021, 10:07 PM2021-10-18 22:07:46 (UTC+0)](#7438756)[Mstyles](/p/Mstyles/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[aidilarf28](/p/aidilarf28/) added a comment.[Oct 19 2021, 2:11 AM2021-10-19 02:11:37 (UTC+0)](#7439096)Comment Actions

Hi [@sbassett](/p/sbassett/)

After I double checked, it seems this behavior has been fixed.

Can you confirm it?

[sbassett](/p/sbassett/) added a comment.[Oct 19 2021, 2:34 PM2021-10-19 14:34:16 (UTC+0)](#7440707)Comment Actions
> In [T293589#7439096](/T293589#7439096), [@aidilarf28](/p/aidilarf28/) wrote:
>
> After I double checked, it seems this behavior has been fixed.
>
> Can you confirm it?

Yes, this issue is now fixed within Wikimedia production. The issue is still private and will be held for the next security release, due out sometime towards the end of December 2021, where it will be publicly disclosed. Thanks again for the report.

[matmarex](/p/matmarex/) added a subscriber: [Esanders](/p/Esanders/).[Oct 19 2021, 3:56 PM2021-10-19 15:56:21 (UTC+0)](#7441322)Comment Actions

FYI, [@Esanders](/p/Esanders/) has started working on a lint check that would prevent adding vulnerable code in the future: <https://github.com/wikimedia/eslint-plugin-no-jquery/pull/284>. This is likely to have many false positives, so it might not be practical to enable everywhere, but we're hoping to do it for VisualEditor at least.

[sbassett](/p/sbassett/) added a comment.[Oct 19 2021, 4:23 PM2021-10-19 16:23:06 (UTC+0)](#7441463)Comment Actions

[@Esanders](/p/Esanders/), [@matmarex](/p/matmarex/) - That's great. The [Security-Team](/tag/security-team/) definitely encourages this kind of proactive security development. At some point it might make sense to move a rule a like this to semgrep or another security-related tool, but we can address that at some later date, likely next year when Gitlab should be far more active and the canonical source for most Wikimedia repos.

[ppelberg](/p/ppelberg/) moved this task from [To Triage](/project/board/483/) to [Triaged](/project/board/483/) on the [VisualEditor](/tag/visualeditor/) board.[Oct 21 2021, 3:36 PM2021-10-21 15:36:42 (UTC+0)](#7448500)[Reedy](/p/Reedy/) renamed this task from [ SECURITY VULNERABILITY ] Blind Stored XSS at https://id.wikipedia.org/ Via Upload Image Via URL to Blind Stored XSS via Upload Image via URL.[Oct 22 2021, 8:17 PM2021-10-22 20:17:58 (UTC+0)](#7452249)[sbassett](/p/sbassett/) merged a task: Restricted Task.[Oct 25 2021, 8:14 PM2021-10-25 20:14:23 (UTC+0)](#7456830)[sbassett](/p/sbassett/) added a subscriber: [Dylsss](/p/Dylsss/).

[Reedy](/p/Reedy/) closed this task as Resolved.[Nov 3 2021, 6:47 PM2021-11-03 18:47:42 (UTC+0)](#7479235)Comment Actions

Would be useful to know which branches this applies to/needs backporting to for reference to MW release branches

[matmarex](/p/matmarex/) added a comment.[Nov 3 2021, 7:06 PM2021-11-03 19:06:57 (UTC+0)](#7479341)Comment Actions

All of them, the buggy code dates to 2015 ([T293589#7435793](/T293589#7435793)).

[Reedy](/p/Reedy/) added a comment.[Nov 3 2021, 7:27 PM2021-11-03 19:27:33 (UTC+0)](#7479474)Comment Actions

Thanks! Will have to see how trivial the backports are (in a month or so!)

[sbassett](/p/sbassett/) added a subscriber: [jeena](/p/jeena/).Edited · [Nov 16 2021, 6:25 PM2021-11-16 18:25:00 (UTC+0)](#7507604)Comment Actions

Per conversation with [@jeena](/p/jeena/), rebased security patch which should apply cleanly to wmf.9:

01-T293589-rev2.patch1 KB[Download](https://phab.wmfusercontent.org/file/download/mgzy4gwdgsrcqxv4xh24/PHID-FILE-qva6l2qcrzgquqrdof2b/01-T293589-rev2.patch)

[Reedy](/p/Reedy/) mentioned this in [T292227: Tracking bug for MediaWiki 1.35.5/1.36.3/1.37.1](/T292227).[Dec 10 2021, 7:55 PM2021-12-10 19:55:41 (UTC+0)](#7563815)

[Reedy](/p/Reedy/) added a comment.[Dec 10 2021, 8:09 PM2021-12-10 20:09:38 (UTC+0)](#7563868)Comment Actions

Looks like this should apply fairly cleanly all the way back to REL1\_35.

[Reedy](/p/Reedy/) renamed this task from Blind Stored XSS via Upload Image via URL to CVE-2021-44855: Blind Stored XSS via Upload Image via URL.[Dec 13 2021, 3:03 AM2021-12-13 03:03:55 (UTC+0)](#7565337)[aidilarf28](/p/aidilarf28/) added a comment.[Dec 13 2021, 3:27 AM2021-12-13 03:27:32 (UTC+0)](#7565358)Comment Actions

Hi [@Reedy](/p/Reedy/) [@sbassett](/p/sbassett/)

Can the URL of this report be disclosed, sir?

[sbassett](/p/sbassett/) added a comment.[Dec 13 2021, 2:47 PM2021-12-13 14:47:11 (UTC+0)](#7566490)Comment Actions
> In [T293589#7565358](/T293589#7565358), [@aidilarf28](/p/aidilarf28/) wrote:
>
> Hi [@Reedy](/p/Reedy/) [@sbassett](/p/sbassett/)
>
> Can the URL of this report be disclosed, sir?

Hey - [@Reedy](/p/Reedy/) should have the security release out sometime this week or early next week. At that time, this task will be made public, and the url will be disclosed. We would appreciate if you could wait until this task is officially made public to disclose the url.

[Reedy](/p/Reedy/) added a subscriber: [gerritbot](/p/gerritbot/).[Dec 13 2021, 9:40 PM2021-12-13 21:40:06 (UTC+0)](#7567790)[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:30 PM2021-12-15 19:30:31 (UTC+0)](#7573380)Comment Actions

Change 747575 had a related patch set uploaded (by Reedy; author: Reedy):

[mediawiki/core@REL1\_35] Bug: T293589

<https://gerrit.wikimedia.org/r/747575>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:31 PM2021-12-15 19:31:38 (UTC+0)](#7573385)Comment Actions

Change 747582 had a related patch set uploaded (by Reedy; author: Reedy):

[mediawiki/core@REL1\_36] Bug: T293589

<https://gerrit.wikimedia.org/r/747582>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:32 PM2021-12-15 19:32:42 (UTC+0)](#7573390)Comment Actions

Change 747592 had a related patch set uploaded (by Reedy; author: SBassett):

[mediawiki/extensions/VisualEditor@master] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747592>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:32 PM2021-12-15 19:32:48 (UTC+0)](#7573392)Comment Actions

Change 747589 had a related patch set uploaded (by Reedy; author: Reedy):

[mediawiki/core@REL1\_37] Bug: T293589

<https://gerrit.wikimedia.org/r/747589>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:34 PM2021-12-15 19:34:45 (UTC+0)](#7573406)Comment Actions

Change 747593 had a related patch set uploaded (by Reedy; author: SBassett):

[mediawiki/extensions/VisualEditor@REL1\_37] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747593>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:35 PM2021-12-15 19:35:05 (UTC+0)](#7573408)Comment Actions

Change 747594 had a related patch set uploaded (by Reedy; author: SBassett):

[mediawiki/extensions/VisualEditor@REL1\_36] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747594>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:35 PM2021-12-15 19:35:42 (UTC+0)](#7573417)Comment Actions

Change 747595 had a related patch set uploaded (by Reedy; author: SBassett):

[mediawiki/extensions/VisualEditor@REL1\_35] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747595>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:50 PM2021-12-15 19:50:45 (UTC+0)](#7573480)Comment Actions

Change 747575 **abandoned** by Reedy:

[mediawiki/core@REL1\_35] Bug: T293589

Reason:

<https://gerrit.wikimedia.org/r/747575>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:50 PM2021-12-15 19:50:47 (UTC+0)](#7573481)Comment Actions

Change 747589 **abandoned** by Reedy:

[mediawiki/core@REL1\_37] Bug: T293589

Reason:

<https://gerrit.wikimedia.org/r/747589>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:50 PM2021-12-15 19:50:49 (UTC+0)](#7573482)Comment Actions

Change 747582 **abandoned** by Reedy:

[mediawiki/core@REL1\_36] Bug: T293589

Reason:

<https://gerrit.wikimedia.org/r/747582>

[Reedy](/p/Reedy/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-bb7jrucco5du26y/)" to "Public (No Login Required)".[Dec 15 2021, 7:52 PM2021-12-15 19:52:14 (UTC+0)](#7573485)[Reedy](/p/Reedy/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-6cikokiee7mal3r/)" to "All Users".[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 7:59 PM2021-12-15 19:59:00 (UTC+0)](#7573531)Comment Actions

Change 747595 **merged** by jenkins-bot:

[mediawiki/extensions/VisualEditor@REL1\_35] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747595>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:09 PM2021-12-15 20:09:12 (UTC+0)](#7573563)Comment Actions

Change 747593 **merged** by jenkins-bot:

[mediawiki/extensions/VisualEditor@REL1\_37] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747593>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:33 PM2021-12-15 20:33:51 (UTC+0)](#7573660)Comment Actions

Change 747594 **merged** by jenkins-bot:

[mediawiki/extensions/VisualEditor@REL1\_36] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747594>

[gerritbot](/p/gerritbot/) added a comment.[Dec 15 2021, 8:48 PM2021-12-15 20:48:45 (UTC+0)](#7573715)Comment Actions

Change 747592 **merged** by jenkins-bot:

[mediawiki/extensions/VisualEditor@master] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747592>

[ReleaseTaggerBot](/p/ReleaseTaggerBot/) added a project: [MW-1.38-notes (1.38.0-wmf.16; 2022-01-03)](/project/view/5648/).[Dec 15 2021, 9:00 PM2021-12-15 21:00:28 (UTC+0)](#7573813)[matmarex](/p/matmarex/) added a comment.[Dec 16 2021, 12:54 AM2021-12-16 00:54:56 (UTC+0)](#7574305)Comment Actions

I submitted the patch with non-security improvements (from [T293589#7438356](/T293589#7438356)) to Gerrit now: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/VisualEditor/+/747652](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/VisualEditor/%2B/747652)

[gerritbot](/p/gerritbot/) added a comment.[Dec 16 2021, 4:33 PM2021-12-16 16:33:20 (UTC+0)](#7575668)Comment Actions

Change 747703 had a related patch set uploaded (by Robert Vogel; author: SBassett):

[mediawiki/extensions/VisualEditor@REL1\_31] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

<https://gerrit.wikimedia.org/r/747703>

[Legoktm](/p/Legoktm/) mentioned this in [T297896: Apply changes from 1.35.5 to unsupported legacy branch `REL1\_31`](/T297896).[Dec 16 2021, 5:30 PM2021-12-16 17:30:18 (UTC+0)](#7575882)[sbassett](/p/sbassett/) added a comment.[Dec 16 2021, 6:53 PM2021-12-16 18:53:06 (UTC+0)](#7576063)Comment Actions

[@aidilarf28](/p/aidilarf28/) - Just to follow up, the security release is out and this task is now public. Feel free to reference it and the url directly.

[gerritbot](/p/gerritbot/) added a comment.[Dec 17 2021, 8:43 AM2021-12-17 08:43:57 (UTC+0)](#7577088)Comment Actions

Change 747703 **abandoned** by Robert Vogel:

[mediawiki/extensions/VisualEditor@REL1\_31] SECURITY: ve.ui.MWMediaDialog: Escape plaintext image metadata fields

Reason:

<https://gerrit.wikimedia.org/r/747703>

[• mmodell](/p/mmodell/) subscribed.[Jan 4 2022, 9:01 PM2022-01-04 21:01:37 (UTC+0)](#7597126)This comment was removed by [• mmodell](/p/mmodell/).Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
