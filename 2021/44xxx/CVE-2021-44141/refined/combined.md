=== Content from www.samba.org_6d78153d_20250114_205816.html ===

## CVE-2021-44141.html:

```

===========================================================
== Subject:     Information leak via symlinks of existance of
==		files or directories outside of the exported
==		share.
==
== CVE ID#:     CVE-2021-44141
==
==
== Versions:    All versions of the Samba file server prior to
==              4.15.5.
==
== Summary:     A client can use a symlink to discover if a named
==              or directory exists on the filesystem outside of
==              the exported share. The user must have permissions
==		to query a symlink inside the exported share using
==		SMB1 with unix extensions turned on.
===========================================================

===========
Description
===========

All versions of Samba prior to 4.15.5 are vulnerable to a malicious
client using a server symlink to determine if a file or directory
exists in an area of the server file system not exported under the
share definition. SMB1 with unix extensions has to be enabled in order
for this attack to succeed.

Clients that have write access to the exported part of the file system
under a share via SMB1 unix extensions or via NFS can create symlinks
that point to arbitrary files or directories on the server filesystem.

Clients can then use SMB1 unix extension information queries to
determine if the target of the symlink exists or not by examining
error codes returned from the smbd server. There is no ability to
access these files or directories, only to determine if they exist or
not.

If SMB1 is turned off and only SMB2 is used, or unix extensions are
not enabled then there is no way to discover if a symlink points to a
valid target or not via SMB2. For this reason, even if symlinks are
created via NFS, if the Samba server does not allow SMB1 with unix
extensions there is no way to exploit this bug.

Finding out what files or directories exist on a file server can help
attackers guess system user names or the exact operating system
release and applications running on the server hosting Samba which may
help mount further attacks.

SMB1 has been disabled on Samba since version 4.11.0 and
onwards. Exploitation of this bug has not been seen in the wild.

==================
Patch Availability
==================

Patches addressing this issue has been posted to:

    https://www.samba.org/samba/security/

Samba version 4.15.5 has been issued as a security release to correct
the defect. Samba administrators are advised to upgrade to this
release as soon as possible. Due to the complexity of the fixes needed
for this problem, back ports to earlier Samba versions have not been
provided. For users of earlier Samba versions, please see the
"Workaround and mitigating factors" section of this document.

==================
CVSSv3.1 calculation
==================

CVSS:AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C/CR:L/IR:L/AR:L/MAV:N/MAC:L/MPR:L/MUI:N/MS:U/MC:H/MI:N/MA:N

base score of 4.2

=================================
Workaround and mitigating factors
=================================

Do not enable SMB1 (please note SMB1 is disabled by default in Samba
from version 4.11.0 and onwards). This prevents the creation or
querying of symbolic links via SMB1. If SMB1 must be enabled for
backwards compatibility then add the parameter:

unix extensions = no

to the [global] section of your smb.conf and restart smbd. This
prevents SMB1 clients from creating or reading symlinks on the
exported file system.

However, if the same region of the file system is also exported
allowing write access via NFS, NFS clients can create symlinks that
allow SMB1 with unix extensions clients to discover the existance of
the NFS created symlink targets.  For non-patched versions of Samba we
recommend only exporting areas of the file system by either SMB2 or
NFS, not both.

=======
Credits
=======

Reported by Stefan Behrens of <sbehrens@giantdisaster.de>
Jeremy Allison of Google and the Samba Team provided the fix.

==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================

```



=== Content from security.gentoo.org_d0636a05_20250114_205815.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities — GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


