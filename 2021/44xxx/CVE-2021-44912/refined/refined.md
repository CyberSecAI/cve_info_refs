The content is related to CVE-2021-44912.

**Root cause of vulnerability:** Unrestricted file upload in `modules/menu/menu.admin.controller.php` when uploading a "Normal button".

**Weaknesses/vulnerabilities present:**
- Lack of file extension validation allows uploading arbitrary files.
- Inadequate `.htaccess` configuration, which only restricted PHP files but allowed HTML uploads, leading to Stored XSS.
- Older versions (before XE 1.11.2) with improper .htaccess could allow PHP file uploads resulting in remote code execution.

**Impact of exploitation:**
- Uploading HTML files leads to Stored XSS vulnerabilities.
- Uploading PHP files can lead to remote code execution (RCE) if the `.htaccess` configuration is not set correctly (particularly in versions prior to XE 1.11.2).

**Attack vectors:**
- The vulnerability exists in the file upload functionality when creating or modifying menu "normal buttons" via the admin panel.
- An attacker can upload a malicious file with an arbitrary extension.

**Required attacker capabilities/position:**
- Requires administrative access to the vulnerable application to access the file upload functionality.
- An attacker needs to be logged in as an admin to access `/index.php?module=admin&act=dispMenuAdminSiteMap` or similar administrative functionality.