=== Content from packetstormsecurity.com_70c8d74a_20250114_185859.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_0b30c3f7_20250114_185901.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](52)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](42)

![](/shared/images/nst-icons.svg#search)

# CVE-2021-44033: Ionic Identity Vault PIN Unlock Lockout Bypass (Android & iOS)

---

*From*: Emanuel DUSS <emanuel.duss () compass-security com>

*Date*: Fri, 19 Nov 2021 09:21:08 +0000

---

```
#############################################################
#
# COMPASS SECURITY ADVISORY
# <https://www.compass-security.com/research/advisories/>
#
#############################################################
#
# Product:  Identity Vault
# Vendor:   Ionic
# CSNC ID:  CSNC-2021-020
# CVE ID:   CVE-2021-44033
# Subject:  PIN Unlock Lockout Bypass (Android & iOS)
# Severity: Medium
# Effect:   Authentication Bypass
# Author:   Emanuel Duss <emanuel.duss () compass-security com>
# Date:     2021-11-19
#
#############################################################

Introduction
------------

Ionic Identity Vault is a secure storage solution for Android and iOS mobile
apps which can e.g. be used to store authentication information like access
tokens [1]. This information can be protected, so that the user must
authenticate first, before the information is unlocked.

Identity Vault provides different authentication methods:

- Memory only storage (not persisted at all)
- Secure storage (without user authentication)
- Passcode (PIN) authentication
- Biometric authentication (optionally with device PIN fallback)

The Passcode (PIN) authentication mechanism can be configured with a lockout
counter, which will clear the secure storage after a specified number of failed
unlocks.

During a customer project, we could bypass the PIN unlock lockout mechanism.
This allows an attacker with physical access to the device to brute force all
possible unlock PIN combinations without being blocked.

Affected
--------

- Vulnerable: Ionic Identity Vault <= 5.0.4
- Not vulnerable: Ionic Identity Vault >= 5.0.5

Description
-----------

The failed unlock counter is only stored in memory and can therefore be
bypassed. An attacker with physical access to the phone is therefore able to
brute force the PIN of the user without being blocked.

For example, if the lockout threshold is set to 5, an attacker can perform 4
failed unlocks and close the app to clear the failed unlock counter. The app can
then be opened again to get 4 more unlock attempts. This can be repeated until
the correct PIN was found.

Technical Description
---------------------

# Vulnerability

On Android, the logic of the lockout functionality is implemented in the
`getData` method of the `com.ionicframework.IdentityVault.VaultBase` class.
This method tracks the count of failed authentication attempts and clears the
vault after the configured amount of possible failed unlocks is reached:

    public void getData() throws VaultError {
        try {
            if (this.data == null) {
            // [...]
            }
        } catch (AuthFailedError e) {
            lock();
            int I = this.failedUnlockAttempts + 1;
            this.failedUnlockAttempts = I;
            if (I ≥ this.allowedInvalidUnlockAttempts) {
                clear();
                this.failedUnlockAttempts = 0;
                throw new TooManyFailedAttemptsError();
            }
            throw e;
        } catch (Exception e2) {
            throw new VaultError(e2.getLocalizedMessage());
        }
    }

This shows that the failed unlock count `failedUnlockAttempts` is not stored
anywhere and only kept in memory.

The code on iOS looks similar and therefore the same vulnerability applies to
both Android and iOS.

# Exploit

The following steps can be performed to bypass the number of unlock
attempts and get endless tries:

- Open the app
- Try several PIN unlock attempts until before the last possible attempt which
  would clear the secure storage
- Close the app (this will clear the `failedUnlockAttempts`)
- Start at step 1 again and try the next PINs.

All these steps can be automated by using the Android Debug Bridge (adb) [2].

Vulnerability Classification
----------------------------

CVSS v3.1 Metrics [3]:

- CVSS Base Score: 5.9 (Medium)
- CVSS Vector: AV:P/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N

Workaround / Fix
----------------

# Ionic Identity Vault Library Vendor

A counter of the failed unlock attempts should be stored on the phone. This
counter should only be readable by the app itself and not by other apps. It can
e.g., be stored in the application directory.

Note: An attacker with root access on the phone can always bypass such lockout
mechanisms by hooking the functions which perform the check. A lockout counter
stored in the application directory still protects against non-root attackers.
It's therefore not necessary to specially protect/encrypt the failed unlock
counter.

# Ionic Identity Vault Library Users

Customers of the Ionic Identity Vault should use the updated version Identity
Vault 5.0.5 which fixes the issue [4].

Timeline
--------

2021-08-05: Vulnerability discovered
2021-09-06: Informed Ionic about the vulnerability
2021-09-07: Ionic told they will fix it and inform me when the fix is available
2021-10-25: Asked Ionic about the current state
2021-10-25: Ionic told it's already fixed.
2021-11-18: Requested CVE ID @ MITRE
2021-11-19: Assigned CVE-2021-44033
2021-11-19: Coordinated public disclosure

References
----------

[1] <https://ionic.io/docs/identity-vault>
[2] <https://developer.android.com/studio/command-line/adb>
[3] <https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N&version=3.1>
[4] <https://ionic.io/docs/identity-vault/changelog> --> [5.0.5] (2021-09-30)

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](52)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](42)

### Current thread:

* **CVE-2021-44033: Ionic Identity Vault PIN Unlock Lockout Bypass (Android & iOS)** *Emanuel DUSS (Nov 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from ionic.io_5a7ecabb_20250114_185902.html ===


[Skip to main content](#__docusaurus_skipToContent_fallback)[![Identity Vault Logo](/docs/identity-vault/img/logos/logo-light.png)![Identity Vault Logo](/docs/identity-vault/img/logos/logo-dark.png)](/docs/identity-vault/)[5.0](/docs/identity-vault/)

* [5.0](/docs/identity-vault/changelog)
* [4.3](/docs/identity-vault/4.3/changelog)
* [4.2](/docs/identity-vault/4.2/changelog)
* [4.1](/docs/identity-vault/4.1)
* [4.0](/docs/identity-vault/4.0)
* [3.6](/docs/identity-vault/3.6)
* [3.5](/docs/identity-vault/3.5)
* [3.4](/docs/identity-vault/3.4)
* [3.3](/docs/identity-vault/3.3)
* [3.2](/docs/identity-vault/3.2)
* [3.1](/docs/identity-vault/3.1)
* [3.0](/docs/identity-vault/3.0)
* [2.0](/docs/identity-vault/2.0)
![Identity Vault Logo](/docs/identity-vault/img/components/product-dropdown/logo.png)![Identity Vault Logo](/docs/identity-vault/img/components/product-dropdown/logo.png)Identity Vault Docs![more icon](/docs/identity-vault/assets/ideal-img/icon-more.5434974.27.png)![more icon](/docs/identity-vault/assets/ideal-img/icon-more.5230332.27.png)
## Products

* [![appflow logo](/docs/identity-vault/assets/ideal-img/logo-appflow.79bf9aa.43.png)![appflow logo](/docs/identity-vault/assets/ideal-img/logo-appflow.64f5f2f.43.png)Appflow](https://ionic.io/docs/appflow)
* [![portals logo](/docs/identity-vault/assets/ideal-img/logo-portals.0c94e9c.44.png)![portals logo](/docs/identity-vault/assets/ideal-img/logo-portals.45dcaad.44.png)Portals](https://ionic.io/docs/portals)
## Open Source

* [![Ionic Framework logo](/docs/identity-vault/assets/ideal-img/logo-framework.9739870.44.png)![Ionic Framework logo](/docs/identity-vault/assets/ideal-img/logo-framework.166f43d.44.png)Ionic Framework](https://ionicframework.com/docs)
* [![Capacitor logo](/docs/identity-vault/assets/ideal-img/logo-capacitor.cd63ad3.44.png)![Capacitor logo](/docs/identity-vault/assets/ideal-img/logo-capacitor.67c3540.44.png)Capacitor](https://capacitorjs.com/docs)
* [![Stencil logo](/docs/identity-vault/assets/ideal-img/logo-stencil.fbf94aa.50.png)![Stencil logo](/docs/identity-vault/assets/ideal-img/logo-stencil.b6753c6.50.png)Stencil](https://stenciljs.com/docs)
[Community Hub](https://ionic.link/discord)[Forum](https://forum.ionicframework.com)[![Twitter logo](/docs/identity-vault/assets/ideal-img/logo-twitter.ac32845.34.png)![Twitter logo](/docs/identity-vault/assets/ideal-img/logo-twitter.d2eb4dc.34.png)](https://twitter.com/ionicframework)[![Discord logo](/docs/identity-vault/assets/ideal-img/logo-discord.5546f8f.36.png)![Discord logo](/docs/identity-vault/assets/ideal-img/logo-discord.f120621.36.png)](https://ionic.link/discord)[![Github logo](/docs/identity-vault/assets/ideal-img/logo-github.4176cf3.34.png)![Github logo](/docs/identity-vault/assets/ideal-img/logo-github.45e33a9.34.png)](https://github.com/ionic-team)

* [Overview](/docs/identity-vault/)
* [Installation](/docs/identity-vault/install)
* [Tutorials](/docs/identity-vault/angular/getting-started)
  + [Angular](/docs/identity-vault/angular/getting-started)
    - [Getting Started](/docs/identity-vault/angular/getting-started)
    - [Startup Strategies](/docs/identity-vault/angular/startup-strategies)
    - [The Device API](/docs/identity-vault/angular/device-api)
    - [Custom Passcode Vaults](/docs/identity-vault/angular/custom-passcode)
  + [React](/docs/identity-vault/react/getting-started)
    - [Getting Started](/docs/identity-vault/react/getting-started)
    - [Startup Strategies](/docs/identity-vault/react/startup-strategies)
    - [The Device API](/docs/identity-vault/react/device-api)
    - [Custom Passcode Vaults](/docs/identity-vault/react/custom-passcode)
  + [Vue](/docs/identity-vault/vue/getting-started)
    - [Getting Started](/docs/identity-vault/vue/getting-started)
    - [Startup Strategies](/docs/identity-vault/vue/startup-strategies)
    - [The Device API](/docs/identity-vault/vue/device-api)
    - [Custom Passcode Vaults](/docs/identity-vault/vue/custom-passcode)
* [Cookbook](/docs/identity-vault/browser)
  + [Browser Support](/docs/identity-vault/browser)
  + [Implementing a Custom Passcode Workflow](/docs/identity-vault/cookbook-custom-passcode)
  + [Troubleshooting](/docs/identity-vault/troubleshooting)
* [Reference](/docs/identity-vault/vault-preference)
  + [Vault Preference](/docs/identity-vault/vault-preference)
  + [Vault Configuration](/docs/identity-vault/vault-configuration)
  + [Vault Limitations](/docs/identity-vault/vault-limitations)
  + [Classes](/docs/identity-vault/classes/browservault)
    - [BrowserVault](/docs/identity-vault/classes/browservault)
    - [Device](/docs/identity-vault/classes/device)
    - [IVLogger](/docs/identity-vault/classes/ivlogger)
    - [Vault](/docs/identity-vault/classes/vault)
    - [VaultMigrator](/docs/identity-vault/classes/vaultmigrator)
  + [Interfaces](/docs/identity-vault/interfaces/deviceerror)
    - [DeviceError](/docs/identity-vault/interfaces/deviceerror)
    - [IdentityVaultConfig](/docs/identity-vault/interfaces/identityvaultconfig)
    - [PromptConfig](/docs/identity-vault/interfaces/promptconfig)
    - [VaultError](/docs/identity-vault/interfaces/vaulterror)
  + [Enums](/docs/identity-vault/enums/androidbiometriccryptopreference)
    - [AndroidBiometricCryptoPreference](/docs/identity-vault/enums/androidbiometriccryptopreference)
    - [BiometricPermissionState](/docs/identity-vault/enums/biometricpermissionstate)
    - [BiometricSecurityStrength](/docs/identity-vault/enums/biometricsecuritystrength)
    - [DeviceErrorCodes](/docs/identity-vault/enums/deviceerrorcodes)
    - [DeviceSecurityType](/docs/identity-vault/enums/devicesecuritytype)
    - [LogLevel](/docs/identity-vault/enums/loglevel)
    - [SupportedBiometricType](/docs/identity-vault/enums/supportedbiometrictype)
    - [VaultErrorCodes](/docs/identity-vault/enums/vaulterrorcodes)
    - [VaultType](/docs/identity-vault/enums/vaulttype)
  + [Cryptography](/docs/identity-vault/cryptography)
  + [Reference Apps](/docs/identity-vault/reference-apps)
  + [Changelog](/docs/identity-vault/changelog)
  + [Upgrading](/docs/identity-vault/upgrading)
  + [Support Policy](/docs/identity-vault/support-policy)
[![Identity Vault Logo](/docs/identity-vault/img/logos/logo-light.png)![Identity Vault Logo](/docs/identity-vault/img/logos/logo-dark.png)](/docs/identity-vault/)Platform

* [Capacitor](https://capacitorjs.com/docs)
* [Framework](https://ionicframework.com/docs)
* [Appflow](https://ionic.io/docs/appflow)
* [Identity Vault](/docs/identity-vault/)
* [Auth Connect](https://ionic.io/docs/auth-connect)
* [Secure Storage](https://ionic.io/docs/secure-storage)
* [Premier Plugins](https://ionic.io/docs/premier-plugins)
Version: 5.0
# Changelog

[## 5.14.4](#release-5.14.4)patch
### September 12, 2024

### What's Changed

* **Fix:** Android Avoid clearing the `FLAG_SECURE` flag on Android when `hideScreenOnBackground` is not used. ([RMET-3631](https://outsystemsrd.atlassian.net/browse/RMET-3631))
* **Fix:** Android Fixed an issue where the data object in an empty vault would not be properly set and calling `getValue` resulted in an improper `NullException`. ([RMET-3548](https://outsystemsrd.atlassian.net/browse/RMET-3548))
[## 5.14.3](#release-5.14.3)patch
### July 29, 2024

### What's Changed

* **Fix:** Android Fixes an issue where the data in an empty `DeviceSecurityStrongVault` would not be properly set and calling `getValue` resulted in an improper `NullException`. ([RMET-3548](https://outsystemsrd.atlassian.net/browse/RMET-3548))
[## 5.14.2](#release-5.14.2)patch
### June 11, 2024

### What's Changed

* **Fix:** AndroidiOS Correctly respond when a passcode is needed from the user for a `Custom Passcode Vault` instead of throwing an unrelated error. ([RMET-3254](https://outsystemsrd.atlassian.net/browse/RMET-3254))
[## 5.14.1](#release-5.14.1)patch
### May 29, 2024

### What's Changed

* **Fix:** Android Handle a potential error when reading or printing error data from the Device plugin ([RMET-3402](https://outsystemsrd.atlassian.net/browse/RMET-3402))
[## 5.14.0](#release-5.14.0)minor
### May 03, 2024

### What's Changed

* **Fix:** AndroidiOS When `lockAfterBackgrounded` is `undefined`, the vault should remain unlocked when backgrounded. If locking the vault immediately is desired, set `lockAfterBackgrounded` to `0`. ([RMET-3271](https://outsystemsrd.atlassian.net/browse/RMET-3271))
* **Fix:** AndroidiOS Ensure errors are properly surfaced during vault initialization
* **Fix:** Android Fixes a crash with Identity Vault on Android 14 when using Capacitor 6. ([RMET-3370](https://outsystemsrd.atlassian.net/browse/RMET-3370))
* **Fix:** Android Fixes an issue where the app backgrounded time was being incorrectly set due to a race condition when Custom Tabs was opened and the immediately closed
* **Fix:** Android Calling `getKeys` on an empty vault should now properly return an empty array instead of throwing an error ([RMET-3221](https://outsystemsrd.atlassian.net/browse/RMET-3221))
* **Fix:** AndroidiOS Fixes various issues with the initial state of a vault upon creation ([RMET-3350](https://outsystemsrd.atlassian.net/browse/RMET-3350))
* **Fix:** iOS Calling `isBiometricsAllowed` now correctly returns deined if a user already denied biometrics permissions for the application
* **Fix:** Web Properly updates the internal lock state in lock/unlock calls to the `BrowserVault` ([RMET-3321](https://outsystemsrd.atlassian.net/browse/RMET-3321))
[## 5.13.0](#release-5.13.0)minor
### April 04, 2024

### What's Changed

* **Fix:** Android Correctly handles null logger callbacks to ensure we return a proper error
* **Fix:** Android Write background entered time on pause to ensure it exists when resuming the application ([RMET-3270](https://outsystemsrd.atlassian.net/browse/RMET-3270))
* **Fix:** iOS Properly returns a response when biometric permissions are denied ([RMET-3168](https://outsystemsrd.atlassian.net/browse/RMET-3168))
* **Feature:**  Updates the getting started guides with new tutorials
[## 5.12.4](#release-5.12.4)patch
### Febraury 01, 2024

### What's Changed

* **Chore:**  Version bump only
[## 5.12.3](#release-5.12.3)patch
### January 18, 2024

### What's Changed

* **Fix:** Android Prevent calling `showBiometricPrompt()` from locking the vault
[## 5.12.2](#release-5.12.2)patch
### January 09, 2024

### What's Changed

* **Fix:**  Fixes an undefined error that was being thrown
[## 5.12.1](#release-5.12.1)patch
### October 11, 2023

### What's Changed

* **Fix:**  Handle vault resume events properly when an application is using multiple vault instances
[## 5.12.0](#release-5.12.0)minor
### September 21, 2023

### What's Changed

* **Feature:**  Adds support for a new `logLevel` configuration parameter to enable more verbose logging
* **Fix:** Android Fixes a crash from an incorrect intent string name in the BiometricActivity
* **Fix:** iOS Adds a fix to avoid breaking applications that utilize Apple CarPlay
* **Fix:** Web Updates the `BrowserVault` interface to match the new API surface
* **Fix:**  Persist the `backgroundEnteredTime` in the keychain / shared preferences so that it is not lost if the app is killed and restarted by the operating system
[## 5.11.1](#release-5.11.1)patch
### June 21, 2023

### What's Changed

* **Fix:**  Properly settings the passcode when creating a new Custom Passcode vault
[## 5.11.0](#release-5.11.0)minor
### June 20, 2023

### New `initialize` method

We no longer recommend configuring your instance of Identity Vault using the constructor. Initializing a new vault is an asynchronous operation, and the constructor does not provide a way to handle errors or know when the initialization is complete. Instead, use the new `initialize` method, which returns a promise and provides a way to handle errors.

### What's Changed

* **Feature:**  Adds `initialize` method
* **Fix:** Android Invalidate vault and throw an error when all device biometrics or credentials are removed
* **Fix:** Android Remove setting java version from the gradle file
[## 5.10.1](#release-5.10.1)patch
### May 12, 2023

### What's Changed

* **Chore:**  Version bump only
[## 5.10.0](#release-5.10.0)minor
### May 12, 2023

### What's Changed

* **Feature:** Android Use AndroidX lifecycle dependencies
[## 5.9.6](#release-5.9.6)patch
### February 01, 2023

### What's Changed

* **Fix:**  Catch and handle errors thrown when retrying vault operations
[## 5.9.5](#release-5.9.5)patch
### January 03, 2023

### What's Changed

* **Fix:** Android Allow a Device Security vault to be cleared without providing biometric credentials
* **Fix:** iOS Improve interoperability with 3rd party Cordova packages
[## 5.9.4](#release-5.9.4)patch
### November 30, 2022

### What's Changed

* **Fix:** Android Handle a privacy screen dialog crash when the Activity is destroyed
* **Fix:**  Properly handle `null` values in `setValue`
[## 5.9.3](#release-5.9.3)patch
### July 22, 2022

### What's Changed

* **Fix:** Android Fixes a window manager crash when the privacy dialog tries to appear
* **Fix:**  Set the default value for `hideScreenOnBackground` to `false`
[## 5.9.2](#release-5.9.2)patch
### August 05, 2022

### What's Changed

* **Fix:**  Invalidate an inconsistent Device Security vault when the user interacts with the vault
[## 5.9.1](#release-5.9.1)patch
### July 22, 2022

### What's Changed

* **Fix:** Android Check Device Security vault consistency on app resume
* **Fix:** Android Properly trigger the privacy screen on Android 12+ or on devices using Gesture Navigation
* **Fix:** iOS Properly check the system passcode status in `isBiometricsEnabled`
* **Fix:**  Ignore `shouldClearVaultAfterTooManyFailedAttempts` vault configuration setting for non Custom Passcode vaults
[## 5.9.0](#release-5.9.0)minor
### July 11, 2022

### What's Changed

* **Feature:**  Allow using `setCustomPasscode` to change the passcode on a vault
* **Fix:** Android Handle inconsistencies with Device Security vault and the current biometric strength
* **Fix:** Android Avoid throwing an error when calling `isEmpty` if device biometrics are disabled
[## 5.8.0](#release-5.8.0)minor
### June 08, 2022

### New `isBiometricsAllowed` method

The Device class exposes a new method `isBiometricsAllowed()` that returns the current state of biometric permissions.

### What's Changed

* **Feature:**  Adds new `isBiometricsAllowed()` method

Additional NotesOn Android and iOS devices with TouchID, this `isBiometricsAllowed()` always returns `granted`[## 5.7.3](#release-5.7.3)patch
### May 16, 2022

### What's Changed

* **Fix:** Android Removed JCenter dependencies
* **Fix:**  Add support for multiple instances of the Vault Migrator class to migrate multiple vaults
[## 5.7.2](#release-5.7.2)patch
### May 09, 2022

### What's Changed

* **Fix:** Android Fixes a null pointer exception on activity result
[## 5.7.1](#release-5.7.1)patch
### April 20, 2022

### What's Changed

* **Fix:**  Fixes StrongBox compatibility detection
* **Fix:** iOS Fixes a crash on Cordova when `onError` was initialized
* **Fix:** iOS Avoid throwing an error when only a system passcode was setup for a device when creating a vault using `DeviceSecurityType.Both`
[## 5.7.0](#release-5.7.0)minor
### April 05, 2022

### What's Changed

* **Feature:**  Adds support for the `onLock` trigger to In Memory vaults
* **Fix:** iOS Fixes a bug where `showBiomtricPrompt` would never resolve
[## 5.6.0](#release-5.6.0)minor
### March 29, 2022

### What's Changed

* **Feature:**  Adds a timeout boolean to the `onLock` handler to indicate if the vault was locked due to a timeout
* **Feature:** Android Adds a flag to dim the background when the biometric prompt is shown
* **Fix:** Android Properly handle missing resource strings in the Vault Migrator class
[## 5.5.2](#release-5.5.2)patch
### March 02, 2022

### What's Changed

* **Fix:**  Correctly triggers the `onError` callback on the vault that is throwing the error
[## 5.5.1](#release-5.5.1)patch
### February 22, 2022

### What's Changed

* **Fix:** iOS Correctly invalidate a vault when the registered biometrics change
[## 5.5.0](#release-5.5.0)minor
### February 07, 2022

### What's Changed

* **Feature:** Android Skip prompt for biometrics when creating a new vault on Android
* **Fix:**  Adds support for `isEmpty()` to In Memory vaults
[## 5.4.0](#release-5.4.0)minor
### January 05, 2022

### New `showBiometricPrompt` method

The Device class exposes a new method `showBiometricPrompt()` that enabled you to programmatically show a biometric prompt to the user. This method returns a `Promise<void>` that resolves when the user successfully authenticates using biometric or the promise is rejected with a standard `VaultError` code and message if a failure state occurs.

```
try {
  await Device.showBiometricPrompt(promptConfig);
  // biometric prompt succeeded successfully
 } catch (err) {
  // handle error
 }

```
### What's Changed

* **Feature:**  Adds ability to programmatically show the biometric prompt
* **Fix:** Android Avoids vault key collisions when switching biometrics or removing system pin
[## 5.3.1](#release-5.3.1)patch
### December 10, 2021

### What's Changed

* **Fix:**  Fixes an issue when using a version of TypeScript < 3.8
[## 5.3.0](#release-5.3.0)minor
### December 06, 2021

### New `onPasscodeRequested` callback mechanism

Prior to this release, the `onPasscodeRequested` handler was invoked whenever a user was required to enter their passcode to unlock a Custom Passcode Vault. Once they did, it was intended that `setCustomPasscode` would be called to set the entered passcode and unlock the vault. However, this flow often caused problems and was very unintuitive.

We have added a new callback handler to the `onPasscodeRequested` method to simplify this process. Now, when the user is required to enter their passcode, the `onPasscodeRequested` handler will be invoked with a new second argument. This second argument is a callback that should be called with the entered passcode. Once the callback is called, the vault will be unlocked and the data will be accessible.

```
vault.onPasscodeRequested((isPasscodeSetRequest, onComplete) => {
  const message = isPasscodeSetRequest
    ? 'Setup Passcode' // passcode is being set for first time
    : 'Enter passcode'; // passcode is being asked for unlock
  const passcode = window.prompt(message) || '';
  onComplete(passcode);
});

```
### What's Changed

* **Feature:**  Adds a new callback mechanism for handling `onPasscodeRequested`
[## 5.2.0](#release-5.2.0)minor
### November 22, 2021

### New `isEmpty` method

Vaults now have the ability to programmatically check if the vault is empty. This can be used without needing to unlock the vault and read the data.

### What's Changed

* **Feature:**  Added `isEmpty()` method
* **Fix:** Android Resolves a crash that can occur on Android where the biometric prompt background conflicts with the application theme settings
* **Fix:**  Avoids errors thrown when `onUnlock` listener is set to `null` for Secure Storage vaults
[## 5.1.2](#release-5.1.2)patch
### November 16, 2021

### What's Changed

* **Fix:** Android Correctly handles some uncaught errors related to Android Keystore operations
* **Fix:**  Provides a proper error message when a malformed config object is passed
* **Fix:**  Fixes a class name collision with the Device plugin and `@capacitor/device`
[## 5.1.1](#release-5.1.1)patch
### October 27, 2021

### What's Changed

* **Fix:**  Fixes a crash when importing complex objects into the vault
* **Fix:**  Removes built in localizations
[## 5.1.0](#release-5.1.0)minor
### October 11, 2021

### New `Device.hasSecureHardware` method

We have added the ability to check if the running device has a secure hardware enclave. This should be used to programmatically determine if the device supports secure storage mechanisms so your application can react accordingly.

### What's Changed

* **Feature:**  Add `hasSecureHardware` device check
* **Fix:**  Ensure that the `VaultError.biometericsLockedOut` error is thrown when the device biometrics are locked out
* **Fix:**  Don't unnecessarily trigger the `onError` handler for `MissingBiometrticError`
[## 5.0.5](#release-5.0.5)patch
### September 30, 2021

### What's Changed

* **Fix:**  Properly set the `isLockedOutOfBiometrics` flag after getting locked out biometrics
* **Fix:** iOS Remove vaults on iOS after re-install that can be moved due to iCloud
* **Fix:**  Allow `DeviceSecurity` vaults to be cleared without biometrics
* **Fix:**  Security: Fix ability to bypass max invalid unlock attempts on a vault
* **Fix:** Android Security: Implements strong Android Keystore protections
* **Fix:** Android Security: Properly set `setUserAuthenticationParam` based on the device security type
[## 5.0.4](#release-5.0.4)patch
### September 17, 2021

### What's Changed

* **Fix:**  Properly handles vault data when biometrics have been changed or invalidated
[## 5.0.3](#release-5.0.3)patch
### September 07, 2021

### What's Changed

* **Fix:**  Fixes `lockOnBackgrounded` regression
[## 5.0.2](#release-5.0.2)patch
### September 01, 2021

### What's Changed

* **Fix:**  Correctly enforce requirement of `cordova-android@10`
* **Fix:**  Correctly implements keychain access control requirements for `CustomPasscode` vault
* **Fix:**  `InMemoryVault` clears correctly when vault is locked
* **Fix:**  Check the vault exists before attempting to read values from the vault to avoid null runtime errors
* **Fix:** Android Handle `null` and `undefined` values in the `lockAfterBackgrounded` setting on Android
* **Fix:**  Replaced deprecated functions and cleaned up swift warnings from compiler
* **Fix:**  Align biometric attempt error codes between iOS and Android
[## 5.0.1](#release-5.0.1)patch
### August 10, 2021

### What's Changed

* **Fix:** iOS Fixes the splash screen not dismissing on iOS when `hideScreenOnBacgkround` is enabled
* **Fix:**  Fixes support for Identity Vault 5 in Cordova applications
* **Fix:**  Uses the correct encoding when writing vault data
[## 5.0.0](#release-5.0.0)major
### July 28, 2021

### New API Surface

This release marks a major milestore for Identity Vault and introduces a completely new API surface and requires a migration from older versions. See the [migration guide](https://ionic.io/docs/identity-vault/upgrading) for full migration details.

### Non-Secure Browser Vault Implementation

A new browser vault has been added that does not implement any secure storage mechanisms and is intended to be used for development purposes only. See the [Browser Vault documentation](https://ionic.io/docs/identity-vault/classes/browservault) for details.

### What's Changed

* **Breaking Change:**  New API Surface
* **Feature:**  Improved compatibility with other non-Angular frameworks
* **Feature:**  Enhanced local development experience
* **Feature:** Android Android Class 2 Biometrics support
[PreviousReference Apps](/docs/identity-vault/reference-apps)[NextUpgrading](/docs/identity-vault/upgrading)

