=== Content from github.com_1bb9c7a3_20250114_232310.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F1672d6f46bbd6f6d42f0903ce9a313927ae2836b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F1672d6f46bbd6f6d42f0903ce9a313927ae2836b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=thexerteproject%2Fxerteonlinetoolkits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[thexerteproject](/thexerteproject)
/
**[xerteonlinetoolkits](/thexerteproject/xerteonlinetoolkits)**
Public

* [Notifications](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)
* [Star
   64](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues
  173](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests
  8](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects
  0](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

Additional navigation options

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

## Commit

[Permalink](/thexerteproject/xerteonlinetoolkits/commit/1672d6f46bbd6f6d42f0903ce9a313927ae2836b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security! Check and verify paths used by move\_uploaded\_file

[Browse files](/thexerteproject/xerteonlinetoolkits/tree/1672d6f46bbd6f6d42f0903ce9a313927ae2836b)
Browse the repository at this point in the history

```
 - Make sure uploaded files can only be saved in the USER-FILES
   subfolder
```

* Loading branch information

[![@torinfo](https://avatars.githubusercontent.com/u/5166596?s=40&v=4)](/torinfo)

[torinfo](/thexerteproject/xerteonlinetoolkits/commits?author=torinfo "View all commits by torinfo")
committed
Mar 22, 2021

1 parent
[76a7c73](/thexerteproject/xerteonlinetoolkits/commit/76a7c73190c0678f682dc7269e75516b10b8d4fc)

commit 1672d6f

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**21 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* editor

  + editor/uploadImage.php
    [uploadImage.php](#diff-a112eccd6b267dfd98aaec21e444e5892a2d1d8dc2b02fe4e7bd10f9a0038945)
* modules

  + decision/engine

    - modules/decision/engine/upload.php
      [upload.php](#diff-ed0c3467fab3e9eca655fd0b20cc3360a911cdd8eefcb8e60c8c1661bc9d8c18)
  + site/engine

    - modules/site/engine/upload.php
      [upload.php](#diff-15d321a70f4bb4310dc739cdef50ee7cd256297d97a1b5077c848c9147c04242)
* website\_code/php/import

  + website\_code/php/import/fileupload.php
    [fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc)

## There are no files selected for viewing

11 changes: 11 additions & 0 deletions

11
[editor/uploadImage.php](#diff-a112eccd6b267dfd98aaec21e444e5892a2d1d8dc2b02fe4e7bd10f9a0038945 "editor/uploadImage.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/1672d6f46bbd6f6d42f0903ce9a313927ae2836b/editor/uploadImage.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -71,6 +71,17 @@ function sanitizeName($file, &$response) |
|  |  | exit(-1); |
|  |  | } |
|  |  |  |
|  |  | // Check upload path, should contain USER-FILES |
|  |  | if (strpos($\_REQUEST['uploadURL'], 'USER-FILES') === false) |
|  |  | { |
|  |  | // Invalid folder, reject! |
|  |  | $response->uploaded = 0; |
|  |  | $response->error = IMAGEUPOLOAD\_NOT\_UPLOADED; |
|  |  |  |
|  |  | echo json\_encode($response); |
|  |  | exit(-1); |
|  |  | } |
|  |  |  |
|  |  | if (isset($\_FILES['upload']['error']) && $\_FILES['upload']['error'] != 0) |
|  |  | { |
|  |  | switch($\_FILES['upload']['error']) { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[modules/decision/engine/upload.php](#diff-ed0c3467fab3e9eca655fd0b20cc3360a911cdd8eefcb8e60c8c1661bc9d8c18 "modules/decision/engine/upload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/1672d6f46bbd6f6d42f0903ce9a313927ae2836b/modules/decision/engine/upload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -96,6 +96,8 @@ |
|  |  | $pass = false; |
|  |  | if (strpos($\_FILES['Filedata']['name'], '...') !== false) |
|  |  | $pass = false; |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false) |
|  |  | $pass = false; |
|  |  |  |
|  |  | if ($pass === false) { |
|  |  | receive\_message($\_SESSION['toolkits\_logon\_username'], "UPLOAD", "CRITICAL", "Invalid filename: " . $\_FILES['Filedata']['name'], "Invalid filename: " . $\_FILES['Filedata']['name']); |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[modules/site/engine/upload.php](#diff-15d321a70f4bb4310dc739cdef50ee7cd256297d97a1b5077c848c9147c04242 "modules/site/engine/upload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/1672d6f46bbd6f6d42f0903ce9a313927ae2836b/modules/site/engine/upload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -79,6 +79,8 @@ |
|  |  | $pass = false; |
|  |  | if (strpos($\_FILES['Filedata']['name'], '...') !== false) |
|  |  | $pass = false; |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false) |
|  |  | $pass = false; |
|  |  |  |
|  |  | if ($pass === false) { |
|  |  | receive\_message($\_SESSION['toolkits\_logon\_username'], "UPLOAD", "CRITICAL", "Invalid filename: " . $\_FILES['Filedata']['name'], "Invalid filename: " . $\_FILES['Filedata']['name']); |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[website\_code/php/import/fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc "website_code/php/import/fileupload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/1672d6f46bbd6f6d42f0903ce9a313927ae2836b/website_code/php/import/fileupload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,6 +55,12 @@ function convertToBytes(string $from): ?int { |
|  |  | \_debug("Session is invalid or expired"); |
|  |  | die("Session is invalid or expired"); |
|  |  | } |
|  |  | if (strpos($\_POST['mediapath'], 'USER-FILES') === false) |
|  |  | { |
|  |  | // Invalid upload path |
|  |  | \_debug("Invalid or illegal mediapath"); |
|  |  | die("Invalid or illegal mediapath"); |
|  |  | } |
|  |  |  |
|  |  | \_load\_language\_file("/website\_code/php/import/fileupload.inc"); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1672d6f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F1672d6f46bbd6f6d42f0903ce9a313927ae2836b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_95cd6176_20250114_232310.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from riklutz.nl_b096502a_20250114_232314.html ===

[Skip to content](#content)

[Rik Lutz](https://riklutz.nl/)

Yet Another Network Engineer

     Menu

* [Whoami](https://riklutz.nl/whoami/)

![](https://riklutz.nl/wp-content/uploads/2021/03/cropped-bgHeader-1.png)

 by: [admin](https://riklutz.nl/author/admin/)Posted on: [November 3, 2021April 1, 2022](https://riklutz.nl/2021/11/03/authenticated-file-upload-to-remote-code-execution-in-xerte/)
# Authenticated file upload to Remote Code Execution in Xerte

This is the third and final vulnerability found over a longer period of time in Xerte (for now?). This happened about a year after the previous vulnerabilities. Because of this, a lot of fixes and improvements had been applied to the project, making this vulnerability a lot harder and more fun to uncover! The vulnerability found was an authenticated file upload to Remote Code Execution (RCE).

“Xerte is an award-winning suite of browser-based tools that allow anyone with a web browser to create interactive learning materials quickly and easily.” – <https://www.xerte.org.uk>. Xerte is an OpenSource project and can be found at: <https://github.com/thexerteproject/xerteonlinetoolkits>.

## PoC and discovery

When creating learning materials users have multiple ways of uploading files. One way is to upload files to the project as a whole, this was patched. But its also possible to upload files to a slide (much like a power point slide). This can be done via:

![](https://riklutz.nl/wp-content/uploads/2021/11/afbeelding-1.png)

When inspecting this file upload in the chrome developer tools, we notice that a *mediapath* variable is present. The mediapath defines where the file is saved. This path is not validated and files can be saved anywhere on the server:

![](https://riklutz.nl/wp-content/uploads/2021/11/afbeelding-4.png)

Naturaly the first thing to upload is an PHP webshell. The user’s media folder can’t execute php files due to htaccess, but other folders can. Sadly this is not allowed due to a decently big upload extension blacklist:

![](https://riklutz.nl/wp-content/uploads/2021/11/afbeelding-5-1024x310.png)

The blacklist contains the following extensions, a lot of useful extensions are blocked:

```
php,php5,pl,cgi,exe,vbs,pif,application,gadget,msi,msp,com,scr,hta,htaccess,ini,cpl,msc,jar,bat,cmd,vb,vbe,jsp,jse,ws,wsf,wsc,wsh,ps1,ps1xml,ps2,ps2xml,psc1,psc2,msh,msh1,msh2,mshxml,msh1xml,msh2xml,scf,lnk,inf,reg,docm,dotm,xlsm,xltm,xlam,pptm,potm,ppam,ppsm,sldm
```

Its important to note that: after uploading, the PHP function *move\_uploaded\_file* is used to move the file to the destination. The function *move\_uploaded\_file* will overwrite any existing file without question. What if the developers did a php include somewhere, where they forgot to add the .php extension to the file. Just overwrite the existing file and have the website include my file! All the include calls in the project where validated but all of them, rightfully so, included .php files.

While reading the code my eye caught a function called *\_load\_language\_file.* Xerte is available in lots of different languages and language files use a .inc extension. These .inc files often include php code and .inc is not on the upload blacklist! Can we overwrite an existing .inc file with our php code and have it executed when a page is loaded?:

![](https://riklutz.nl/wp-content/uploads/2021/11/afbeelding-6.png)

When loading the landing page the PHP in our .inc file is executed:

![](https://riklutz.nl/wp-content/uploads/2021/11/afbeelding-7.png)

**Time Line**

* 05/03/2021: Initial disclosure to vendor
* 05/03/2021: Initial response from vendor
* 06/03/2021: Vendor acknowledges the problem
* 06/05/2021: Fix has been deployed, asked to verify fix
* 07/05/2021: File upload still possible by path traversal (media path wrongly checked)
* 10/05/2021: Fix has been deployed
* 24/02/2022: CVE-2021-44664 assigned

[Security](https://riklutz.nl/category/security/)

## Post navigation

[Previous PostPrevious   Unauthenticated Remote Code Execution in Narrowcasting client](https://riklutz.nl/2021/10/30/unauthenticated-remote-code-execution-in-narrowcasting-client/)[Next PostNext Prowise Reflect v1.09 remote keystroke injection](https://riklutz.nl/2021/12/07/prowise-reflect-v1-09-remote-keystroke-injection/)

Search for:

## Recent Posts

* [Accessing my own data at ‘mijn ista’ (browser plugin)](https://riklutz.nl/2022/11/25/accessing-my-own-data-at-mijn-ista-browser-plugin/)
* [Finding password lists and credit card information using google dorks](https://riklutz.nl/2022/06/10/finding-password-lists-and-credit-card-information-using-google-dorks/)
* [Prowise Reflect v1.09 remote keystroke injection](https://riklutz.nl/2021/12/07/prowise-reflect-v1-09-remote-keystroke-injection/)
* [Authenticated file upload to Remote Code Execution in Xerte](https://riklutz.nl/2021/11/03/authenticated-file-upload-to-remote-code-execution-in-xerte/)
* [Unauthenticated Remote Code Execution in Narrowcasting client](https://riklutz.nl/2021/10/30/unauthenticated-remote-code-execution-in-narrowcasting-client/)
## Recent Comments

Theme Mero Blog by [Kantipur Themes](https://kantipurthemes.com/)



=== Content from github.com_a82a3871_20250114_232312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F6daeb81d089d4a561e22f931fff1327660a7d1b5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F6daeb81d089d4a561e22f931fff1327660a7d1b5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=thexerteproject%2Fxerteonlinetoolkits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[thexerteproject](/thexerteproject)
/
**[xerteonlinetoolkits](/thexerteproject/xerteonlinetoolkits)**
Public

* [Notifications](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits) You must be signed in to change notification settings
* [Fork
  61](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)
* [Star
   64](/login?return_to=%2Fthexerteproject%2Fxerteonlinetoolkits)

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues
  173](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests
  8](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects
  0](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

Additional navigation options

* [Code](/thexerteproject/xerteonlinetoolkits)
* [Issues](/thexerteproject/xerteonlinetoolkits/issues)
* [Pull requests](/thexerteproject/xerteonlinetoolkits/pulls)
* [Actions](/thexerteproject/xerteonlinetoolkits/actions)
* [Projects](/thexerteproject/xerteonlinetoolkits/projects)
* [Wiki](/thexerteproject/xerteonlinetoolkits/wiki)
* [Security](/thexerteproject/xerteonlinetoolkits/security)
* [Insights](/thexerteproject/xerteonlinetoolkits/pulse)

## Commit

[Permalink](/thexerteproject/xerteonlinetoolkits/commit/6daeb81d089d4a561e22f931fff1327660a7d1b5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Prohibit path traversal on upload

[Browse files](/thexerteproject/xerteonlinetoolkits/tree/6daeb81d089d4a561e22f931fff1327660a7d1b5)
Browse the repository at this point in the history

```
 - Thank you Rik Lutz
```

* Loading branch information

[![@torinfo](https://avatars.githubusercontent.com/u/5166596?s=40&v=4)](/torinfo)

[torinfo](/thexerteproject/xerteonlinetoolkits/commits?author=torinfo "View all commits by torinfo")
committed
May 7, 2021

1 parent
[df5c417](/thexerteproject/xerteonlinetoolkits/commit/df5c4175fe78e24435c4918a831d6de982522a2a)

commit 6daeb81

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**5 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* editor

  + elfinder/php

    - editor/elfinder/php/connector.php
      [connector.php](#diff-1e73f90b9202746994eead108e840cbce3d33d4bb66bb688198cf74c3cfeeefa)
  + editor/uploadImage.php
    [uploadImage.php](#diff-a112eccd6b267dfd98aaec21e444e5892a2d1d8dc2b02fe4e7bd10f9a0038945)
* modules

  + decision/engine

    - modules/decision/engine/upload.php
      [upload.php](#diff-ed0c3467fab3e9eca655fd0b20cc3360a911cdd8eefcb8e60c8c1661bc9d8c18)
  + site/engine

    - modules/site/engine/upload.php
      [upload.php](#diff-15d321a70f4bb4310dc739cdef50ee7cd256297d97a1b5077c848c9147c04242)
* website\_code/php/import

  + website\_code/php/import/fileupload.php
    [fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[editor/elfinder/php/connector.php](#diff-1e73f90b9202746994eead108e840cbce3d33d4bb66bb688198cf74c3cfeeefa "editor/elfinder/php/connector.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/6daeb81d089d4a561e22f931fff1327660a7d1b5/editor/elfinder/php/connector.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,7 +39,7 @@ |
|  |  | $rootpath = $\_REQUEST['uploadDir']; |
|  |  | $rooturl = $\_REQUEST['uploadURL']; |
|  |  |  |
|  |  | if (strpos($rootpath, 'USER-FILES') === false || strpos($rooturl, 'USER-FILES') === false) |
|  |  | if (strpos($rootpath, 'USER-FILES') === false  || strpos($rootpath, '../') !== false || strpos($rooturl, 'USER-FILES') === false) |
|  |  | { |
|  |  | die("Invalid upload location"); |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[editor/uploadImage.php](#diff-a112eccd6b267dfd98aaec21e444e5892a2d1d8dc2b02fe4e7bd10f9a0038945 "editor/uploadImage.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/6daeb81d089d4a561e22f931fff1327660a7d1b5/editor/uploadImage.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -72,7 +72,7 @@ function sanitizeName($file, &$response) |
|  |  | } |
|  |  |  |
|  |  | // Check upload path, should contain USER-FILES |
|  |  | if (strpos($\_REQUEST['uploadURL'], 'USER-FILES') === false) |
|  |  | if (strpos($\_REQUEST['uploadPath'], 'USER-FILES') === false || strpos($\_REQUEST['uploadPath'], '../') !== false || strpos($\_REQUEST['uploadURL'], 'USER-FILES') === false) |
|  |  | { |
|  |  | // Invalid folder, reject! |
|  |  | $response->uploaded = 0; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[modules/decision/engine/upload.php](#diff-ed0c3467fab3e9eca655fd0b20cc3360a911cdd8eefcb8e60c8c1661bc9d8c18 "modules/decision/engine/upload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/6daeb81d089d4a561e22f931fff1327660a7d1b5/modules/decision/engine/upload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -96,7 +96,7 @@ |
|  |  | $pass = false; |
|  |  | if (strpos($\_FILES['Filedata']['name'], '...') !== false) |
|  |  | $pass = false; |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false) |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false || strpos($\_GET['path'], '../') !== false) |
|  |  | $pass = false; |
|  |  |  |
|  |  | if ($pass === false) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[modules/site/engine/upload.php](#diff-15d321a70f4bb4310dc739cdef50ee7cd256297d97a1b5077c848c9147c04242 "modules/site/engine/upload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/6daeb81d089d4a561e22f931fff1327660a7d1b5/modules/site/engine/upload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -79,7 +79,7 @@ |
|  |  | $pass = false; |
|  |  | if (strpos($\_FILES['Filedata']['name'], '...') !== false) |
|  |  | $pass = false; |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false) |
|  |  | if (strpos($\_GET['path'], 'USER-FILES') === false || strpos($\_GET['path'], '../') !== false) |
|  |  | $pass = false; |
|  |  |  |
|  |  | if ($pass === false) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[website\_code/php/import/fileupload.php](#diff-27433bb0be90e431d40986f9afebe9ee2f8d1025a7f9e55c3cd7a86f1f8e3fdc "website_code/php/import/fileupload.php")

Show comments

[View file](/thexerteproject/xerteonlinetoolkits/blob/6daeb81d089d4a561e22f931fff1327660a7d1b5/website_code/php/import/fileupload.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,7 +55,7 @@ function convertToBytes(string $from): ?int { |
|  |  | \_debug("Session is invalid or expired"); |
|  |  | die("Session is invalid or expired"); |
|  |  | } |
|  |  | if (strpos($\_POST['mediapath'], 'USER-FILES') === false) |
|  |  | if (strpos($\_POST['mediapath'], 'USER-FILES') === false || strpos($\_POST['mediapath'], '../') !== false) |
|  |  | { |
|  |  | // Invalid upload path |
|  |  | \_debug("Invalid or illegal mediapath"); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6daeb81`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthexerteproject%2Fxerteonlinetoolkits%2Fcommit%2F6daeb81d089d4a561e22f931fff1327660a7d1b5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


