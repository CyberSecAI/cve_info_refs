=== Content from github.com_b4b97d7d_20250114_205329.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpiuppi%2FProof-of-Concepts%2Fblob%2Fmain%2FEngineering%2FSQLi-KnowageSuite.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpiuppi%2FProof-of-Concepts%2Fblob%2Fmain%2FEngineering%2FSQLi-KnowageSuite.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=piuppi%2FProof-of-Concepts)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[piuppi](/piuppi)
/
**[Proof-of-Concepts](/piuppi/Proof-of-Concepts)**
Public

* [Notifications](/login?return_to=%2Fpiuppi%2FProof-of-Concepts) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fpiuppi%2FProof-of-Concepts)
* [Star
   4](/login?return_to=%2Fpiuppi%2FProof-of-Concepts)

* [Code](/piuppi/Proof-of-Concepts)
* [Pull requests
  0](/piuppi/Proof-of-Concepts/pulls)
* [Actions](/piuppi/Proof-of-Concepts/actions)
* [Projects
  0](/piuppi/Proof-of-Concepts/projects)
* [Security](/piuppi/Proof-of-Concepts/security)
* [Insights](/piuppi/Proof-of-Concepts/pulse)

Additional navigation options

* [Code](/piuppi/Proof-of-Concepts)
* [Pull requests](/piuppi/Proof-of-Concepts/pulls)
* [Actions](/piuppi/Proof-of-Concepts/actions)
* [Projects](/piuppi/Proof-of-Concepts/projects)
* [Security](/piuppi/Proof-of-Concepts/security)
* [Insights](/piuppi/Proof-of-Concepts/pulse)

## Files

 main
## Breadcrumbs

1. [Proof-of-Concepts](/piuppi/Proof-of-Concepts/tree/main)
2. /[Engineering](/piuppi/Proof-of-Concepts/tree/main/Engineering)
/
# SQLi-KnowageSuite.md

Copy path Blame  Blame
## Latest commit

## History

[History](/piuppi/Proof-of-Concepts/commits/main/Engineering/SQLi-KnowageSuite.md)76 lines (44 loc) · 6.21 KB main
## Breadcrumbs

1. [Proof-of-Concepts](/piuppi/Proof-of-Concepts/tree/main)
2. /[Engineering](/piuppi/Proof-of-Concepts/tree/main/Engineering)
/
# SQLi-KnowageSuite.md

Top
## File metadata and controls

* Preview
* Code
* Blame

76 lines (44 loc) · 6.21 KB[Raw](https://github.com/piuppi/Proof-of-Concepts/raw/refs/heads/main/Engineering/SQLi-KnowageSuite.md)
# CVE-2021-30055 : A SQL injection vulnerability in Knowage Suite version 7.1 exists in the documentexecution/url analytics driver component via the 'par\_year' parameter when running a report.

### Overview

Knowage (<https://www.knowage-suite.com>) is the Open Source Business Analytics Suite combining traditional and big data sources into valuable and meaningful information.

### Description

The SQLi vulnerability in the **'documentexecution'** component can be exploited via the '**par\_year**' parameter, using an SQL payload to trigger a **'boolean-based blind'** injection.

### Impact

This vulnerability allows attackers with limited privileges to execute arbitrary SQL commands on the database server, exfiltrate sensitive data and perform privilege escalation by gaining access as a superadmin.

### Timeline

* **2021-02-09**: Discovered and reported to [Knowage](https://www.knowage-suite.com)
* **2021-02-09**: Got instant response from Knowage development team, "Thanks for your analysis report. We will evaluate your finding and get back to you soon with our feedback."
* **2021-03-22**: Knowage Team fixed this issue in Knowage version 7.4.0
* **2021-04-05**: I have obtained the [CVE-2021-30055](https://nvd.nist.gov/vuln/detail/CVE-2021-30055) and published the PoC

### Discovered by

#### [Gianluca Palma](https://www.linkedin.com/in/piuppi/) ([@piuppi](https://twitter.com/piuppi)) of [Engineering Ingegneria Informatica S.p.A.](https://www.eng.it)

#### [Antonio Scibilia](https://www.linkedin.com/in/nynuz/) of [Cybertech S.r.l.](https://cybertech.eu)

### Proof of concept (POC)

#### Reproducing Steps

After logging into the **Knowage** application with an unprivileged user, it was possible to call any available Cockpit document and run the corresponding report.

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-cockpit-report.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-cockpit-report.png)

Sending the report execution, filtered by year, generates a POST request that invokes the **'documentexecution/url'** method where in this specific case the **"par\_year "** parameter is not properly sanitised and allows the SQL code to be embedded and executed in the query.

##### Request:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-payload-R.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-payload-R.png)

if the bolean condition is **true**, the application generates an error code (no. 1077) relating to the analytical driver used by the 'cockpit' document

##### Response:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-response-true.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-response-true.png)

while in the case of a **false** condition, a generic validation message is generated for the parameter.

##### Response:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-response-false.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-response-false.png)

Once the correct payload was found, it was possible to exfiltrate various sensitive contents from the back-end database, including the **password hashes of Knowage users**, below:

##### SBI\_USER table enumeration

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-sbi_user-table.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-sbi_user-table.png)

##### Passwords hash

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-sbi_user-password.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-sbi_user-password.png)

After retrieving the hashes of the users, we analysed the source code available **[here](https://github.com/KnowageLabs/Knowage-Server/blob/master/cas/src/main/java/it/eng/spagobi/authentication/handler/AsymmetricProviderSingleton.java)** relating to the mechanism for storing user passwords in the database, and it emerged that the hashes are of type **HMAC-SHA1** and the **secret** is hard-coded in the **AsymmetricProviderSingleton.java** file.

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-hmacsha1.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-hmacsha1.png)

So, it was possible to write a dictionary-based decryptor in Python that allowed us to retrieve the password of the **biadmin** user (SUPERADMIN) in clear text:

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-knowagedecryptor.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-knowagedecryptor.png)

and we were finally able to access the web application as biadmin (SUPERADMIN user):

[![Screenshot](/piuppi/Proof-of-Concepts/raw/main/Engineering/images/sqli-biadmin.png)](/piuppi/Proof-of-Concepts/blob/main/Engineering/images/sqli-biadmin.png)

### Suggestions

The most effective way to prevent SQL injection attacks is to use parameterized queries (also known as prepared statements) for all database access. This method uses two steps to incorporate potentially tainted data into SQL queries: first, the application specifies the structure of the query, leaving placeholders for each item of user input; second, the application specifies the contents of each placeholder. Because the structure of the query has already been defined in the first step, it is not possible for malformed data in the second step to interfere with the query structure. You should review the documentation for your database and application platform to determine the appropriate APIs which you can use to perform parameterized queries. It is strongly recommended that you parameterize every variable data item that is incorporated into database queries, even if it is not obviously tainted, to prevent oversights occurring and avoid vulnerabilities being introduced by changes elsewhere within the code base of the application.

You should be aware that some commonly employed and recommended mitigations for SQL injection vulnerabilities are not always effective:

* One common defense is to double up any single quotation marks appearing within user input before incorporating that input into a SQL query. This defense is designed to prevent malformed data from terminating the string into which it is inserted. However, if the data being incorporated into queries is numeric, then the defense may fail, because numeric data may not be encapsulated within quotes, in which case only a space is required to break out of the data context and interfere with the query. Further, in second-order SQL injection attacks, data that has been safely escaped when initially inserted into the database is subsequently read from the database and then passed back to it again. Quotation marks that have been doubled up initially will return to their original form when the data is reused, allowing the defense to be bypassed.
* Another often cited defense is to use stored procedures for database access. While stored procedures can provide security benefits, they are not guaranteed to prevent SQL injection attacks. The same kinds of vulnerabilities that arise within standard dynamic SQL queries can arise if any SQL is dynamically constructed within stored procedures. Further, even if the procedure is sound, SQL injection can arise if the procedure is invoked in an unsafe manner using user-controllable data.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


