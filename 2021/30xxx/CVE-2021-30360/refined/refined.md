Based on the provided content, here's an analysis of CVE-2021-30360:

**Root cause of vulnerability:**
The vulnerability stems from the way the Check Point Enterprise Endpoint Security Client for Windows handles repair operations using the Windows Installer framework. An MSI file, cached in `c:\windows\installer`, can be triggered by an unprivileged user to perform a repair operation.

**Weaknesses/vulnerabilities present:**
- **Insecure file operations:** During the repair process, the Windows Installer service, running under the SYSTEM context, executes temporary files in the user's %TEMP% directory. This allows an attacker to manipulate these temporary files and gain SYSTEM privileges.
- **Insufficient Privilege check:** The repair operation can be triggered by any authenticated local user, and it leads to execution of code with elevated privileges (SYSTEM).

**Impact of exploitation:**
- A local, unprivileged attacker can gain SYSTEM level privileges, allowing them to take complete control of the system.

**Attack vectors:**
- The attack vector is local. An authenticated user can trigger the repair operation using Windows Installer API or by directly running `msiexec.exe /fa c:\windows\installer\[XXXXX].msi`.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated local user on the Windows system running the vulnerable Check Point Endpoint Security Client.
- The attacker does not need to have any administrative privileges initially.
- The attacker needs to be able to trigger a repair operation using msiexec.exe or the windows installer API.

**Additional Notes:**
- The provided document includes more technical details than the basic CVE description.
- The vulnerability was fixed in version E86.20 of the Check Point Enterprise Endpoint Security Client for Windows.
- The vulnerability was reported by Ronnie Salomonsen from Mandiant.
- The timeline of discovery, reporting, and patching is also detailed in the document.