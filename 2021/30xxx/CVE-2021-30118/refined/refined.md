```
{
  "CVE-2021-30118": {
    "description": "An attacker can upload files with the privilege of the Web Server process for Kaseya VSA Unified Remote Monitoring & Management (RMM) 9.5.4.2149 and subsequently use these files to execute asp commands. The api /SystemTab/uploader.aspx is vulnerable to an unauthenticated arbitrary file upload leading to RCE. An attacker can upload files with the privilege of the Web Server process and subsequently use these files to execute asp commands.",
    "root_cause": "The vulnerability lies in the `/SystemTab/uploader.aspx` API, which allows unauthenticated arbitrary file uploads. The session ID cookie required by the API is not validated, making it possible for an attacker to bypass authentication. The attacker can control the file name and location through the `qqfile` and `PathData` parameters, respectively.",
    "vulnerabilities": [
      "Unauthenticated arbitrary file upload",
        "Missing session validation",
       "Remote Code Execution"
    ],
    "impact": "This vulnerability allows an attacker to upload files with arbitrary content to any location on the server where the webserver process has write access, including the webroot. By uploading files containing executable code (e.g., ASPX), an attacker can execute this code in the context of the webserver, leading to a full system compromise and potential exfiltration of credentials or confidential data.",
    "attack_vectors": [
      "Send a POST request to `/SystemTab/uploader.aspx`",
        "Provide a filename through `qqfile` parameter",
        "Specify the upload path using the `PathData` parameter",
        "Include an arbitrary session ID cookie (not validated)."
    ],
    "attacker_capabilities": "The attacker does not need to be authenticated and only needs to send a crafted HTTP POST request to the vulnerable endpoint. A basic understanding of HTTP requests and server file paths is necessary.",
      "fixes": "Upgrade on-premise to version 9.5.6 or above"
  }
}
```