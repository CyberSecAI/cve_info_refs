=== Content from security.gentoo.org_11c1cebd_20250114_194250.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# wpa\_supplicant, hostapd: Multiple Vulnerabilities — GLSA **202309-16**

Multiple vulnerabilities have been discovered in wpa\_supplicant and hostapd, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **net-wireless/hostapd** on all architectures |
| --- | --- |
| Affected versions | < **2.10** |
| Unaffected versions | >= **2.10** |

| Package | **net-wireless/wpa\_supplicant** on all architectures |
| --- | --- |
| Affected versions | < **2.10** |
| Unaffected versions | >= **2.10** |

### Background

wpa\_supplicant is a WPA Supplicant with support for WPA and WPA2 (IEEE 802.11i / RSN). hostapd is a user space daemon for access point and authentication servers.

### Description

Multiple vulnerabilities have been discovered in hostapd and wpa\_supplicant. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All wpa\_supplicant users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-wireless/wpa_supplicant-2.10"

```

All hostapd users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-wireless/hostapd-2.10"

```
### References

* [CVE-2021-30004](https://nvd.nist.gov/vuln/detail/CVE-2021-30004)
* [CVE-2022-23303](https://nvd.nist.gov/vuln/detail/CVE-2022-23303)
* [CVE-2022-23304](https://nvd.nist.gov/vuln/detail/CVE-2022-23304)

**Release date**

September 30, 2023

**Latest revision**

September 30, 2023: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [768759](https://bugs.gentoo.org/show_bug.cgi?id=768759)
* [780135](https://bugs.gentoo.org/show_bug.cgi?id=780135)
* [780138](https://bugs.gentoo.org/show_bug.cgi?id=780138)
* [831332](https://bugs.gentoo.org/show_bug.cgi?id=831332)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from w1.fi_b27519fc_20250114_194250.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [hostap](/cgit/hostap/) | android-jb android-kk android-l android-m aosp-jb aosp-kk main pending |
| --- | --- | --- |
| hostapd/wpa\_supplicant | Jouni Malinen |

| [about](/cgit/hostap/about/)[summary](/cgit/hostap/)[refs](/cgit/hostap/refs/?id=a0541334a6394f8237a4393b7372693cd7e96f15)[log](/cgit/hostap/log/)[tree](/cgit/hostap/tree/?id=a0541334a6394f8237a4393b7372693cd7e96f15)[commit](/cgit/hostap/commit/?id=a0541334a6394f8237a4393b7372693cd7e96f15)[diff](/cgit/hostap/diff/?id=a0541334a6394f8237a4393b7372693cd7e96f15)[stats](/cgit/hostap/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jouni Malinen <j@w1.fi> | 2021-03-13 18:19:31 +0200 |
| --- | --- | --- |
| committer | Jouni Malinen <j@w1.fi> | 2021-03-14 11:37:58 +0200 |
| commit | [a0541334a6394f8237a4393b7372693cd7e96f15](/cgit/hostap/commit/?id=a0541334a6394f8237a4393b7372693cd7e96f15) ([patch](/cgit/hostap/patch/?id=a0541334a6394f8237a4393b7372693cd7e96f15)) | |
| tree | [547631e61fd28a30ca37bdd869f4e023be1b22cf](/cgit/hostap/tree/?id=a0541334a6394f8237a4393b7372693cd7e96f15) | |
| parent | [94beb8e3677a0fc7e79534819679bcbe39444880](/cgit/hostap/commit/?id=94beb8e3677a0fc7e79534819679bcbe39444880) ([diff](/cgit/hostap/diff/?id=a0541334a6394f8237a4393b7372693cd7e96f15&id2=94beb8e3677a0fc7e79534819679bcbe39444880)) | |
| download | [hostap-a0541334a6394f8237a4393b7372693cd7e96f15.tar.gz](/cgit/hostap/snapshot/hostap-a0541334a6394f8237a4393b7372693cd7e96f15.tar.gz)[hostap-a0541334a6394f8237a4393b7372693cd7e96f15.tar.bz2](/cgit/hostap/snapshot/hostap-a0541334a6394f8237a4393b7372693cd7e96f15.tar.bz2)[hostap-a0541334a6394f8237a4393b7372693cd7e96f15.zip](/cgit/hostap/snapshot/hostap-a0541334a6394f8237a4393b7372693cd7e96f15.zip) | |

ASN.1: Validate DigestAlgorithmIdentifier parametersThe supported hash algorithms do not use AlgorithmIdentifier parameters.
However, there are implementations that include NULL parameters in
addition to ones that omit the parameters. Previous implementation did
not check the parameters value at all which supported both these cases,
but did not reject any other unexpected information.
Use strict validation of digest algorithm parameters and reject any
unexpected value when validating a signature. This is needed to prevent
potential forging attacks.
Signed-off-by: Jouni Malinen <j@w1.fi>
[Diffstat](/cgit/hostap/diff/?id=a0541334a6394f8237a4393b7372693cd7e96f15)

| -rw-r--r-- | [src/tls/pkcs1.c](/cgit/hostap/diff/src/tls/pkcs1.c?id=a0541334a6394f8237a4393b7372693cd7e96f15) | 21 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [src/tls/x509v3.c](/cgit/hostap/diff/src/tls/x509v3.c?id=a0541334a6394f8237a4393b7372693cd7e96f15) | 20 | |  |  |  | | --- | --- | --- | |

2 files changed, 41 insertions, 0 deletions

| diff --git a/src/tls/pkcs1.c b/src/tls/pkcs1.cindex bbdb0d72d..5761dfed0 100644--- a/[src/tls/pkcs1.c](/cgit/hostap/tree/src/tls/pkcs1.c?id=94beb8e3677a0fc7e79534819679bcbe39444880)+++ b/[src/tls/pkcs1.c](/cgit/hostap/tree/src/tls/pkcs1.c?id=a0541334a6394f8237a4393b7372693cd7e96f15)@@ -244,6 +244,8 @@ int pkcs1\_v15\_sig\_ver(struct crypto\_public\_key \*pk, os\_free(decrypted); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "PKCS #1: DigestInfo",+ hdr.payload, hdr.length);  pos = hdr.payload; end = pos + hdr.length;@@ -265,6 +267,8 @@ int pkcs1\_v15\_sig\_ver(struct crypto\_public\_key \*pk, os\_free(decrypted); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "PKCS #1: DigestAlgorithmIdentifier",+ hdr.payload, hdr.length); da\_end = hdr.payload + hdr.length;  if (asn1\_get\_oid(hdr.payload, hdr.length, &oid, &next)) {@@ -273,6 +277,23 @@ int pkcs1\_v15\_sig\_ver(struct crypto\_public\_key \*pk, os\_free(decrypted); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "PKCS #1: Digest algorithm parameters",+ next, da\_end - next);++ /\*+ \* RFC 5754: The correct encoding for the SHA2 algorithms would be to+ \* omit the parameters, but there are implementation that encode these+ \* as a NULL element. Allow these two cases and reject anything else.+ \*/+ if (da\_end > next &&+ (asn1\_get\_next(next, da\_end - next, &hdr) < 0 ||+ !asn1\_is\_null(&hdr) ||+ hdr.payload + hdr.length != da\_end)) {+ wpa\_printf(MSG\_DEBUG,+ "PKCS #1: Unexpected digest algorithm parameters");+ os\_free(decrypted);+ return -1;+ }  if (!asn1\_oid\_equal(&oid, hash\_alg)) { char txt[100], txt2[100];diff --git a/src/tls/x509v3.c b/src/tls/x509v3.cindex a8944dd2f..df337ec4d 100644--- a/[src/tls/x509v3.c](/cgit/hostap/tree/src/tls/x509v3.c?id=94beb8e3677a0fc7e79534819679bcbe39444880)+++ b/[src/tls/x509v3.c](/cgit/hostap/tree/src/tls/x509v3.c?id=a0541334a6394f8237a4393b7372693cd7e96f15)@@ -1964,6 +1964,7 @@ int x509\_check\_signature(struct x509\_certificate \*issuer, os\_free(data); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "X509: DigestInfo", hdr.payload, hdr.length);  pos = hdr.payload; end = pos + hdr.length;@@ -1985,6 +1986,8 @@ int x509\_check\_signature(struct x509\_certificate \*issuer, os\_free(data); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "X509: DigestAlgorithmIdentifier",+ hdr.payload, hdr.length); da\_end = hdr.payload + hdr.length;  if (asn1\_get\_oid(hdr.payload, hdr.length, &oid, &next)) {@@ -1992,6 +1995,23 @@ int x509\_check\_signature(struct x509\_certificate \*issuer, os\_free(data); return -1; }+ wpa\_hexdump(MSG\_MSGDUMP, "X509: Digest algorithm parameters",+ next, da\_end - next);++ /\*+ \* RFC 5754: The correct encoding for the SHA2 algorithms would be to+ \* omit the parameters, but there are implementation that encode these+ \* as a NULL element. Allow these two cases and reject anything else.+ \*/+ if (da\_end > next &&+ (asn1\_get\_next(next, da\_end - next, &hdr) < 0 ||+ !asn1\_is\_null(&hdr) ||+ hdr.payload + hdr.length != da\_end)) {+ wpa\_printf(MSG\_DEBUG,+ "X509: Unexpected digest algorithm parameters");+ os\_free(data);+ return -1;+ }  if (x509\_sha1\_oid(&oid)) { if (signature->oid.oid[6] != 5 /\* sha-1WithRSAEncryption \*/) { |
| --- |

generated by [cgit v1.2.3-70-g09d2](https://git.zx2c4.com/cgit/about/) ([git 2.46.0](https://git-scm.com/)) at 2025-01-14 18:15:54 +0000


