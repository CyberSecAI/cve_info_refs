The provided content relates to CVE-2021-30014.

**Root cause of vulnerability:**
Integer overflow in the `gf_bs_read_ue_log` function, which reads variable-length unsigned integers from a bitstream. The function can return a negative value that is then used as an index into an array, leading to a crash. Specifically, the issue arises in `hevc_parse_slice_segment` when parsing the `pps_id`.

**Weaknesses/vulnerabilities present:**
- Integer overflow: The `gf_bs_read_ue_log` function can return negative values.
- Lack of proper bounds checking: The code does not check if `pps_id` is negative before using it as an array index.

**Impact of exploitation:**
- Crash: A crafted media file can cause a crash due to out-of-bounds access.

**Attack vectors:**
- Crafted media file: The vulnerability can be triggered by providing a specially crafted media file with a manipulated `pps_id` value.

**Required attacker capabilities/position:**
- The attacker needs to be able to supply a crafted media file to the vulnerable application.

**Additional details:**
- The vulnerability exists in `media_tools/av_parsers.c` within the function `hevc_parse_slice_segment`.
- The fix involved adding safety checks to ensure the parsed IDs are within their valid ranges before being used. This was done in the `gf_avc_read_sps_bs_internal`, `gf_avc_read_pps_bs_internal`, `hevc_parse_slice_segment`, `gf_hevc_read_vps_bs_internal`, `gf_hevc_read_sps_bs_internal`, `gf_hevc_read_pps_bs_internal`, `gf_media_vvc_read_vps_bs_internal`, `gf_media_vvc_read_sps_bs_internal`, `gf_media_vvc_read_pps_bs_internal`, and `vvc_parse_picture_header` functions.
- The vulnerability was reported by user `treebacker`.
- The fix was implemented in commit `51cdb67ff7c5f1242ac58c5aa603ceaf1793b788`.