- **Root cause of vulnerability**: The Knowage cockpit engine before version 7.4 uses the `SBI_HOST` parameter to construct internal URLs without proper sanitization. This parameter is used to manage 'Angular localization'.
- **Weaknesses/vulnerabilities present**: Cross-site scripting (XSS) vulnerability due to the lack of proper sanitization of user-supplied input in the `SBI_HOST` parameter. Specifically, the application reflects the unsanitized input within the HTML DOM by creating a `script` tag with a `src` attribute that includes the attacker-controlled value.
- **Impact of exploitation**: An attacker can inject arbitrary JavaScript code that will be executed in the victim's browser within the context of their application session. This allows the attacker to perform actions on the victim's behalf, steal sensitive information (like session cookies), and log keystrokes.
- **Attack vectors**: The vulnerability is exploited through a GET request to `/knowagecockpitengine/api/1.0/pages/execute` via the `SBI_HOST` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to craft a malicious URL containing the XSS payload and induce a user to access that URL through various means like sending the link via email or instant message.