```
{
  "vulnerability": {
    "root_cause": "The `capcom.sys` driver, intended to prevent cheating in *Street Fighter V*, has a vulnerability that allows user-mode applications to disable System Management Mode Protection (SMEP), execute arbitrary code at a provided pointer with kernel privileges, and then re-enable SMEP. This is achieved through a vulnerable IOCTL service that takes a user-land pointer, disables SMEP, executes code at the pointer, and re-enables SMEP.",
    "weaknesses": [
      "The driver exposes an IOCTL service that allows user-mode code to execute arbitrary code in the kernel (ring 0)",
      "The driver disables SMEP, which is a crucial security mechanism designed to prevent kernel-level code from executing code in user-owned memory pages."
    ],
    "impact": "An attacker can gain arbitrary code execution in the kernel with full system privileges, which can be leveraged to fully compromise a Windows system.",
    "attack_vectors": [
      "A user-mode application needs to pass control codes (0xAA012044 and 0xAA013044) to the IOCTL service along with a pointer to shellcode."
    ],
    "required_capabilities": "The attacker needs to have a user-mode application running on the vulnerable Windows system and knowledge of the driver's IOCTL codes and vulnerability.",
     "additional_notes": "The `mhyprot` driver from Genshin Impact has similar vulnerabilities that allow arbitrary kernel memory read/write from usermode, but not arbitrary code execution directly."
  }
}
```