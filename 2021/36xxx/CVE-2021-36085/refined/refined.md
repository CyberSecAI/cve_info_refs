```
{
  "vulnerability": {
    "root_cause": "The vulnerability lies in the way `libsepol` handles class permissions when resetting the Abstract Syntax Tree (AST). Specifically, when resetting a permission, the code destroys the `classperms` list but doesn't destroy the data within the list which leads to a use-after-free vulnerability.",
    "weaknesses": [
      "Use-after-free"
    ],
    "impact": "A use-after-free vulnerability can lead to crashes, denial of service, or potentially arbitrary code execution if an attacker can control the freed memory.",
    "attack_vectors": "The vulnerability is triggered during the parsing and processing of SELinux policies. An attacker could exploit this by crafting a malicious SELinux policy that triggers the vulnerable code path during policy loading/compilation or policy reset.",
    "required_attacker_capabilities": "An attacker needs to provide a malicious SELinux policy that triggers the vulnerable code during processing, compilation, or reset, requiring knowledge of the SELinux policy format."
  },
  "additional_details": {
    "fix": "The fix involves modifying the `cil_reset_perm` function to also call `cil_reset_classperms_list(perm->classperms)` before destroying the list, ensuring that the class permissions in the list are also destroyed, preventing use-after-free.",
      "affected_code": "The commit `2d35fcc7e9e976a2346b1de20e54f8663e8a6cba` on the SELinux project addresses this vulnerability.",
    "note": "The provided github content shows the fix commit that addresses the use-after-free. The content from the Fedora mailing list links to the bugzilla entries that correspond to this CVE and others that are fixed in the same update. No additional useful information from bugs.chromium.org was found."
  }
}
```