```
{
  "vulnerability": {
    "root_cause": "Heap-use-after-free in the `copy_string` function within libarchive.",
    "weaknesses": [
      "Heap-use-after-free"
    ],
    "impact": "Arbitrary code execution due to memory corruption, unexpected application termination.",
    "attack_vectors": "Processing a maliciously crafted archive file.",
    "required_capabilities": "Ability to provide a crafted archive file as input to an application using the vulnerable libarchive library.",
    "additional_details": "The vulnerability occurs in the `copy_string` function, and can be triggered during the decompression of a block, specifically in `do_uncompress_block` and `process_block` functions."
  },
    "affected_products":[
        {"name":"libarchive",
        "versions": [
          "v3.4.1",
          "v3.4.2",
          "v3.4.3",
          "v3.5.0",
          "v3.5.1",
          "v3.5.2"
          ]
        },
        {"name":"iOS", "versions":["15.4"]},
        {"name":"iPadOS", "versions":["15.4"]},
        {"name":"watchOS", "versions":["8.5"]},
        {"name":"macOS", "versions":["Monterey 12.3"]},
        {"name":"Gentoo", "versions":["<3.6.1"]}
    ]
}
```