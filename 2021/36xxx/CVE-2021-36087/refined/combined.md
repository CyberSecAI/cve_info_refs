=== Content from github.com_49db3185_20250114_223517.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Foss-fuzz-vulns%2Fblob%2Fmain%2Fvulns%2Fselinux%2FOSV-2021-585.yaml)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Foss-fuzz-vulns%2Fblob%2Fmain%2Fvulns%2Fselinux%2FOSV-2021-585.yaml)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=google%2Foss-fuzz-vulns)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[google](/google)
/
**[oss-fuzz-vulns](/google/oss-fuzz-vulns)**
Public

* [Notifications](/login?return_to=%2Fgoogle%2Foss-fuzz-vulns) You must be signed in to change notification settings
* [Fork
  39](/login?return_to=%2Fgoogle%2Foss-fuzz-vulns)
* [Star
   143](/login?return_to=%2Fgoogle%2Foss-fuzz-vulns)

* [Code](/google/oss-fuzz-vulns)
* [Issues
  1](/google/oss-fuzz-vulns/issues)
* [Pull requests
  1](/google/oss-fuzz-vulns/pulls)
* [Actions](/google/oss-fuzz-vulns/actions)
* [Projects
  0](/google/oss-fuzz-vulns/projects)
* [Security](/google/oss-fuzz-vulns/security)
* [Insights](/google/oss-fuzz-vulns/pulse)

Additional navigation options

* [Code](/google/oss-fuzz-vulns)
* [Issues](/google/oss-fuzz-vulns/issues)
* [Pull requests](/google/oss-fuzz-vulns/pulls)
* [Actions](/google/oss-fuzz-vulns/actions)
* [Projects](/google/oss-fuzz-vulns/projects)
* [Security](/google/oss-fuzz-vulns/security)
* [Insights](/google/oss-fuzz-vulns/pulse)

## Files

 main
## Breadcrumbs

1. [oss-fuzz-vulns](/google/oss-fuzz-vulns/tree/main)
2. /[vulns](/google/oss-fuzz-vulns/tree/main/vulns)
3. /[selinux](/google/oss-fuzz-vulns/tree/main/vulns/selinux)
/
# OSV-2021-585.yaml

Copy path Blame  Blame
## Latest commit

## History

[History](/google/oss-fuzz-vulns/commits/main/vulns/selinux/OSV-2021-585.yaml)62 lines (61 loc) · 1.61 KB main
## Breadcrumbs

1. [oss-fuzz-vulns](/google/oss-fuzz-vulns/tree/main)
2. /[vulns](/google/oss-fuzz-vulns/tree/main/vulns)
3. /[selinux](/google/oss-fuzz-vulns/tree/main/vulns/selinux)
/
# OSV-2021-585.yaml

Top
## File metadata and controls

* Code
* Blame

62 lines (61 loc) · 1.61 KB[Raw](https://github.com/google/oss-fuzz-vulns/raw/refs/heads/main/vulns/selinux/OSV-2021-585.yaml)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162id: OSV-2021-585summary: Heap-buffer-overflow in ebitmap\_match\_anydetails: | OSS-Fuzz report: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=32675
 ``` Crash type: Heap-buffer-overflow READ 8 Crash state: ebitmap\_match\_any avtab\_map cil\_check\_neverallow ```modified: '2022-04-13T03:04:42.321301Z'published: '2021-03-31T00:00:26.273923Z'references:- type: REPORT url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=32675affected:- package: name: selinux ecosystem: OSS-Fuzz ranges: - type: GIT repo: https://github.com/SELinuxProject/selinux events: - introduced: 0451adebdf153eee1f69914141311114a0130982 - fixed: 340f0eb7f3673e8aacaf0a96cbfcd4d12a405521 - fixed: bad0a746e9f4cf260dedba5828d9645d50176aac versions: - '3.2' - 3.2-rc3 - checkpolicy-3.2 - checkpolicy-3.2-rc3 - libselinux-3.2 - libselinux-3.2-rc3 - libsemanage-3.2 - libsemanage-3.2-rc3 - libsepol-3.2 - libsepol-3.2-rc3 - mcstrans-3.2 - mcstrans-3.2-rc3 - policycoreutils-3.2 - policycoreutils-3.2-rc3 - restorecond-3.2 - restorecond-3.2-rc3 - secilc-3.2 - secilc-3.2-rc3 - selinux-dbus-3.2 - selinux-dbus-3.2-rc3 - selinux-gui-3.2 - selinux-gui-3.2-rc3 - selinux-python-3.2 - selinux-python-3.2-rc3 - selinux-sandbox-3.2 - selinux-sandbox-3.2-rc3 - semodule-utils-3.2 - semodule-utils-3.2-rc3 ecosystem\_specific: fixed\_range: d1a34d3f1df5e90c9e01fcd9791c26db89064a7e:340f0eb7f3673e8aacaf0a96cbfcd4d12a405521 severity: MEDIUM database\_specific: fixed\_range: d1a34d3f1df5e90c9e01fcd9791c26db89064a7e:bad0a746e9f4cf260dedba5828d9645d50176aac

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_912a511b_20250114_223514.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSELinuxProject%2Fselinux%2Fcommit%2F340f0eb7f3673e8aacaf0a96cbfcd4d12a405521)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSELinuxProject%2Fselinux%2Fcommit%2F340f0eb7f3673e8aacaf0a96cbfcd4d12a405521)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=SELinuxProject%2Fselinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[SELinuxProject](/SELinuxProject)
/
**[selinux](/SELinuxProject/selinux)**
Public

* [Notifications](/login?return_to=%2FSELinuxProject%2Fselinux) You must be signed in to change notification settings
* [Fork
  361](/login?return_to=%2FSELinuxProject%2Fselinux)
* [Star
   1.4k](/login?return_to=%2FSELinuxProject%2Fselinux)

* [Code](/SELinuxProject/selinux)
* [Issues
  81](/SELinuxProject/selinux/issues)
* [Pull requests
  25](/SELinuxProject/selinux/pulls)
* [Discussions](/SELinuxProject/selinux/discussions)
* [Actions](/SELinuxProject/selinux/actions)
* [Projects
  0](/SELinuxProject/selinux/projects)
* [Wiki](/SELinuxProject/selinux/wiki)
* [Security](/SELinuxProject/selinux/security)
* [Insights](/SELinuxProject/selinux/pulse)

Additional navigation options

* [Code](/SELinuxProject/selinux)
* [Issues](/SELinuxProject/selinux/issues)
* [Pull requests](/SELinuxProject/selinux/pulls)
* [Discussions](/SELinuxProject/selinux/discussions)
* [Actions](/SELinuxProject/selinux/actions)
* [Projects](/SELinuxProject/selinux/projects)
* [Wiki](/SELinuxProject/selinux/wiki)
* [Security](/SELinuxProject/selinux/security)
* [Insights](/SELinuxProject/selinux/pulse)

## Commit

[Permalink](/SELinuxProject/selinux/commit/340f0eb7f3673e8aacaf0a96cbfcd4d12a405521)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

libsepol/cil: Check for statements not allowed in optional blocks

[Browse files](/SELinuxProject/selinux/tree/340f0eb7f3673e8aacaf0a96cbfcd4d12a405521)
Browse the repository at this point in the history

```
While there are some checks for invalid statements in an optional
block when resolving the AST, there are no checks when building the
AST.

OSS-Fuzz found the following policy which caused a null dereference
in cil_tree_get_next_path().
  (blockinherit b3)
  (sid SID)
  (sidorder(SID))
  (optional o
    (ibpkeycon :(1 0)s)
    (block b3
      (filecon""block())
      (filecon""block())))

The problem is that the blockinherit copies block b3 before
the optional block is disabled. When the optional is disabled,
block b3 is deleted along with everything else in the optional.
Later, when filecon statements with the same path are found an
error message is produced and in trying to find out where the block
was copied from, the reference to the deleted block is used. The
error handling code assumes (rightly) that if something was copied
from a block then that block should still exist.

It is clear that in-statements, blocks, and macros cannot be in an
optional, because that allows nodes to be copied from the optional
block to somewhere outside even though the optional could be disabled
later. When optionals are disabled the AST is reset and the
resolution is restarted at the point of resolving macro calls, so
anything resolved before macro calls will never be re-resolved.
This includes tunableifs, in-statements, blockinherits,
blockabstracts, and macro definitions. Tunable declarations also
cannot be in an optional block because they are needed to resolve
tunableifs. It should be fine to allow blockinherit statements in
an optional, because that is copying nodes from outside the optional
to the optional and if the optional is later disabled, everything
will be deleted anyway.

Check and quit with an error if a tunable declaration, in-statement,
block, blockabstract, or macro definition is found within an
optional when either building or resolving the AST.

Signed-off-by: James Carter <jwcart2@gmail.com>
```

* Loading branch information

[![@jwcart2](https://avatars.githubusercontent.com/u/11771386?s=40&v=4)](/jwcart2)

[jwcart2](/SELinuxProject/selinux/commits?author=jwcart2 "View all commits by jwcart2")
committed
Apr 19, 2021

1 parent
[8a74c05](/SELinuxProject/selinux/commit/8a74c05b97050bd226d61fc162e04dcdf8e91247)

commit 340f0eb

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**35 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* libsepol/cil/src

  + libsepol/cil/src/cil\_build\_ast.c
    [cil\_build\_ast.c](#diff-50e51ff57d3ae808906395ca0f39371b58c11b862e0cd698c66b7910b0507cf6)
  + libsepol/cil/src/cil\_resolve\_ast.c
    [cil\_resolve\_ast.c](#diff-0990019e7233dda4e13abf9dbc70f60d32e73909085a0e88b989d42fbb02a709)

## There are no files selected for viewing

32 changes: 32 additions & 0 deletions

32
[libsepol/cil/src/cil\_build\_ast.c](#diff-50e51ff57d3ae808906395ca0f39371b58c11b862e0cd698c66b7910b0507cf6 "libsepol/cil/src/cil_build_ast.c")

Show comments

[View file](/SELinuxProject/selinux/blob/340f0eb7f3673e8aacaf0a96cbfcd4d12a405521/libsepol/cil/src/cil_build_ast.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,6 +52,7 @@ struct cil\_args\_build { |
|  |  | struct cil\_tree\_node \*tunif; |
|  |  | struct cil\_tree\_node \*in; |
|  |  | struct cil\_tree\_node \*macro; |
|  |  | struct cil\_tree\_node \*optional; |
|  |  | struct cil\_tree\_node \*boolif; |
|  |  | }; |
|  |  |  |
| Expand Down  Expand Up | | @@ -6071,6 +6072,7 @@ int \_\_cil\_build\_ast\_node\_helper(struct cil\_tree\_node \*parse\_current, uint32\_t \*f |
|  |  | struct cil\_tree\_node \*tunif = args->tunif; |
|  |  | struct cil\_tree\_node \*in = args->in; |
|  |  | struct cil\_tree\_node \*macro = args->macro; |
|  |  | struct cil\_tree\_node \*optional = args->optional; |
|  |  | struct cil\_tree\_node \*boolif = args->boolif; |
|  |  | struct cil\_tree\_node \*ast\_node = NULL; |
|  |  | int rc = SEPOL\_ERR; |
| Expand Down  Expand Up | | @@ -6121,6 +6123,18 @@ int \_\_cil\_build\_ast\_node\_helper(struct cil\_tree\_node \*parse\_current, uint32\_t \*f |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (optional != NULL) { |
|  |  | if (parse\_current->data == CIL\_KEY\_TUNABLE || |
|  |  | parse\_current->data == CIL\_KEY\_IN || |
|  |  | parse\_current->data == CIL\_KEY\_BLOCK || |
|  |  | parse\_current->data == CIL\_KEY\_BLOCKABSTRACT || |
|  |  | parse\_current->data == CIL\_KEY\_MACRO) { |
|  |  | rc = SEPOL\_ERR; |
|  |  | cil\_tree\_log(parse\_current, CIL\_ERR, "%s is not allowed in optionals", (char \*)parse\_current->data); |
|  |  | goto exit; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (boolif != NULL) { |
|  |  | if (parse\_current->data != CIL\_KEY\_TUNABLEIF && |
|  |  | parse\_current->data != CIL\_KEY\_CALL && |
| Expand Down  Expand Up | | @@ -6462,6 +6476,10 @@ int \_\_cil\_build\_ast\_first\_child\_helper(\_\_attribute\_\_((unused)) struct cil\_tree\_n |
|  |  | args->macro = ast; |
|  |  | } |
|  |  |  |
|  |  | if (ast->flavor == CIL\_OPTIONAL) { |
|  |  | args->optional = ast; |
|  |  | } |
|  |  |  |
|  |  | if (ast->flavor == CIL\_BOOLEANIF) { |
|  |  | args->boolif = ast; |
|  |  | } |
| Expand Down  Expand Up | | @@ -6492,6 +6510,19 @@ int \_\_cil\_build\_ast\_last\_child\_helper(struct cil\_tree\_node \*parse\_current, void |
|  |  | args->macro = NULL; |
|  |  | } |
|  |  |  |
|  |  | if (ast->flavor == CIL\_OPTIONAL) { |
|  |  | struct cil\_tree\_node \*n = ast->parent; |
|  |  | args->optional = NULL; |
|  |  | /\* Optionals can be nested \*/ |
|  |  | while (n && n->flavor != CIL\_ROOT) { |
|  |  | if (n->flavor == CIL\_OPTIONAL) { |
|  |  | args->optional = n; |
|  |  | break; |
|  |  | } |
|  |  | n = n->parent; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (ast->flavor == CIL\_BOOLEANIF) { |
|  |  | args->boolif = NULL; |
|  |  | } |
| Expand Down  Expand Up | | @@ -6520,6 +6551,7 @@ int cil\_build\_ast(struct cil\_db \*db, struct cil\_tree\_node \*parse\_tree, struct ci |
|  |  | extra\_args.tunif = NULL; |
|  |  | extra\_args.in = NULL; |
|  |  | extra\_args.macro = NULL; |
|  |  | extra\_args.optional = NULL; |
|  |  | extra\_args.boolif = NULL; |
|  |  |  |
|  |  | rc = cil\_tree\_walk(parse\_tree, \_\_cil\_build\_ast\_node\_helper, \_\_cil\_build\_ast\_first\_child\_helper, \_\_cil\_build\_ast\_last\_child\_helper, &extra\_args); |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[libsepol/cil/src/cil\_resolve\_ast.c](#diff-0990019e7233dda4e13abf9dbc70f60d32e73909085a0e88b989d42fbb02a709 "libsepol/cil/src/cil_resolve_ast.c")

Show comments

[View file](/SELinuxProject/selinux/blob/340f0eb7f3673e8aacaf0a96cbfcd4d12a405521/libsepol/cil/src/cil_resolve_ast.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3808,8 +3808,10 @@ int \_\_cil\_resolve\_ast\_node\_helper(struct cil\_tree\_node \*node, uint32\_t \*finished |
|  |  |  |
|  |  | if (optional != NULL) { |
|  |  | if (node->flavor == CIL\_TUNABLE || |
|  |  | node->flavor == CIL\_IN || |
|  |  | node->flavor == CIL\_BLOCK || |
|  |  | node->flavor == CIL\_BLOCKABSTRACT || |
|  |  | node->flavor == CIL\_MACRO) { |
|  |  | /\* tuanbles and macros are not allowed in optionals\*/ |
|  |  | cil\_tree\_log(node, CIL\_ERR, "%s statement is not allowed in optionals", cil\_node\_to\_string(node)); |
|  |  | rc = SEPOL\_ERR; |
|  |  | goto exit; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `340f0eb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSELinuxProject%2Fselinux%2Fcommit%2F340f0eb7f3673e8aacaf0a96cbfcd4d12a405521) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lore.kernel.org_b31ba6c6_20250114_223529.html ===

```
[selinux.vger.kernel.org archive mirror](../../?t=20210723173313)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#e564d8b0f60d32f04d8928b5ee107f106e1dff3b3) libsepol CVE patch issue
@ 2021-07-23 15:42 Garrett Tucker
  2021-07-23 17:18 ` [James Carter](#m7540528856fc43b183352f5b0e5c8c2eb9fe3351)
  [0 siblings, 1 reply; 3+ messages in thread](#r564d8b0f60d32f04d8928b5ee107f106e1dff3b3)
From: Garrett Tucker @ 2021-07-23 15:42 UTC ([permalink](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/) / [raw](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/raw))
  To: [selinux](../../../selinux/?t=20210723154305)

Hi everyone, I'm a product security engineer at Red Hat and we noticed
that libsepol CVE-2021-36087 was assigned, and marked as resolved
within the OSS-Fuzz project. The patch info provided for the CVE
appears to be wrong, and after looking into the provided commits and
commit ranges, these seem to be the wrong commits and commit ranges
for this CVE.

Would anyone be able to confirm if there is a fix for this CVE, and if
so, point us towards the correct patch for this.

All the best,

Garrett

[^](#m564d8b0f60d32f04d8928b5ee107f106e1dff3b3) [permalink](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/) [raw](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/raw) [reply](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/#R)	[[flat](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/T/#u)|[nested](../../CAEN2sdo3wVKXnEUASFTbhR81kOYNgU1CbR0XMUNCTt8keOHC6A%40mail.gmail.com/t/#u)] [3+ messages in thread](#r564d8b0f60d32f04d8928b5ee107f106e1dff3b3)
```

---

```
[*](#e7540528856fc43b183352f5b0e5c8c2eb9fe3351) Re: libsepol CVE patch issue
  2021-07-23 15:42 [libsepol CVE patch issue](#m564d8b0f60d32f04d8928b5ee107f106e1dff3b3) Garrett Tucker
@ 2021-07-23 17:18 ` James Carter
  2021-07-23 17:32   ` [Garrett Tucker](#m8d880444fc5a2624ddfeade07718db8e5385b020)
  [0 siblings, 1 reply; 3+ messages in thread](#r7540528856fc43b183352f5b0e5c8c2eb9fe3351)
From: James Carter @ 2021-07-23 17:18 UTC ([permalink](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/) / [raw](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/raw))
  To: Garrett Tucker; +Cc: [SElinux list](../../../selinux/?t=20210723171837)

On Fri, Jul 23, 2021 at 11:43 AM Garrett Tucker <gtucker@redhat.com> wrote:
>
> Hi everyone, I'm a product security engineer at Red Hat and we noticed
> that libsepol CVE-2021-36087 was assigned, and marked as resolved
> within the OSS-Fuzz project. The patch info provided for the CVE
> appears to be wrong, and after looking into the provided commits and
> commit ranges, these seem to be the wrong commits and commit ranges
> for this CVE.
>
> Would anyone be able to confirm if there is a fix for this CVE, and if
> so, point us towards the correct patch for this.
>

It is very hard to figure out what is going on in the policy provided
by the fuzzer. The best I can figure out is that the problem was
caused by something in an optional block that had been disabled and
deleted being referred to outside of the optional block. Removing all
of the optional blocks that are going to be disabled anyway eliminates
the problem, so that seems to confirm that idea.

This commit prevents that whole class of bugs from occurring.
340f0eb7f3673e8aacaf0a96cbfcd4d12a405521
libsepol/cil: Check for statements not allowed in optional blocks

The problem is definitely there before this patch. After this patch an
error is produced because a block is declared in an optional.

I hope that helps,
Jim

> All the best,
>
> Garrett
>

[^](#m7540528856fc43b183352f5b0e5c8c2eb9fe3351) [permalink](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/) [raw](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/raw) [reply](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/#R)	[[flat](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/T/#u)|[nested](../../CAP%2BJOzT0%2B%2BKp1zNVDY77i92RcosdvC5hyFRQJ8vwmkCin1Ebig%40mail.gmail.com/t/#u)] [3+ messages in thread](#r7540528856fc43b183352f5b0e5c8c2eb9fe3351)
```

---

```
[*](#e8d880444fc5a2624ddfeade07718db8e5385b020) Re: libsepol CVE patch issue
  2021-07-23 17:18 ` [James Carter](#m7540528856fc43b183352f5b0e5c8c2eb9fe3351)
@ 2021-07-23 17:32   ` Garrett Tucker
  [0 siblings, 0 replies; 3+ messages in thread](#r8d880444fc5a2624ddfeade07718db8e5385b020)
From: Garrett Tucker @ 2021-07-23 17:32 UTC ([permalink](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/) / [raw](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/raw))
  To: James Carter; +Cc: [SElinux list](../../../selinux/?t=20210723173313)

Thanks for the detailed explanation Jim, that definitely helps clear
things up on our end.

All the best,

Garrett

On Fri, Jul 23, 2021 at 1:18 PM James Carter <jwcart2@gmail.com> wrote:
>
> On Fri, Jul 23, 2021 at 11:43 AM Garrett Tucker <gtucker@redhat.com> wrote:
> >
> > Hi everyone, I'm a product security engineer at Red Hat and we noticed
> > that libsepol CVE-2021-36087 was assigned, and marked as resolved
> > within the OSS-Fuzz project. The patch info provided for the CVE
> > appears to be wrong, and after looking into the provided commits and
> > commit ranges, these seem to be the wrong commits and commit ranges
> > for this CVE.
> >
> > Would anyone be able to confirm if there is a fix for this CVE, and if
> > so, point us towards the correct patch for this.
> >
>
> It is very hard to figure out what is going on in the policy provided
> by the fuzzer. The best I can figure out is that the problem was
> caused by something in an optional block that had been disabled and
> deleted being referred to outside of the optional block. Removing all
> of the optional blocks that are going to be disabled anyway eliminates
> the problem, so that seems to confirm that idea.
>
> This commit prevents that whole class of bugs from occurring.
> 340f0eb7f3673e8aacaf0a96cbfcd4d12a405521
> libsepol/cil: Check for statements not allowed in optional blocks
>
> The problem is definitely there before this patch. After this patch an
> error is produced because a block is declared in an optional.
>
> I hope that helps,
> Jim
>
>
> > All the best,
> >
> > Garrett
> >
>

[^](#m8d880444fc5a2624ddfeade07718db8e5385b020) [permalink](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/) [raw](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/raw) [reply](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/#R)	[[flat](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/T/#u)|[nested](../../CAEN2sdqJKHvDzPnxS-J8grU8fSf32DDtx%3Dkyh84OsCq_Vm%2ByaQ%40mail.gmail.com/t/#u)] [3+ messages in thread](#r8d880444fc5a2624ddfeade07718db8e5385b020)
```

---

```
end of thread, other threads:[[~2021-07-23 17:33 UTC](../../?t=20210723173313) | [newest](../../)]

Thread overview: 3+ messages (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2021-07-23 15:42 [libsepol CVE patch issue](#m564d8b0f60d32f04d8928b5ee107f106e1dff3b3) Garrett Tucker
2021-07-23 17:18 ` [James Carter](#m7540528856fc43b183352f5b0e5c8c2eb9fe3351)
2021-07-23 17:32   ` [Garrett Tucker](#m8d880444fc5a2624ddfeade07718db8e5385b020)

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from lists.fedoraproject.org_7636949f_20250114_223520.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR.mbox.gz?message=U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/#U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR)

# [SECURITY] Fedora 35 Update: libsepol-3.3-2.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

15 Nov
2021

15 Nov
'21

5:48 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-67efe88c29
2021-11-15 05:45:24.448553
--------------------------------------------------------------------------------

Name : libsepol
Product : Fedora 35
Version : 3.3
Release : 2.fc35
URL : <https://github.com/SELinuxProject/selinux/wiki>
Summary : SELinux binary policy manipulation library
Description :
Security-enhanced Linux is a feature of the Linux�� kernel and a number
of utilities with enhanced security functionality designed to add
mandatory access controls to Linux. The Security-enhanced Linux
kernel contains new architectural components originally developed to
improve the security of the Flask operating system. These
architectural components provide general support for the enforcement
of many kinds of mandatory access control policies, including those
based on the concepts of Type Enforcement��, Role-based Access
Control, and Multi-level Security.

libsepol provides an API for the manipulation of SELinux binary policies.
It is used by checkpolicy (the policy compiler) and similar tools, as well
as by programs like load\_policy that need to perform specific transformations
on binary policies such as customizing policy boolean settings.

--------------------------------------------------------------------------------
Update Information:

Fixed libsepol.pc
--------------------------------------------------------------------------------
ChangeLog:

\* Thu Nov 11 2021 Petr Lautrbach plautrba@redhat.com - 3.3-2
- Use correct libdir in libsepol.pc (#2018492)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1979663 - CVE-2021-36084 libsepol: use-after-free in \_\_cil\_verify\_classperms() [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1979663>
[ 2 ] Bug #1979665 - CVE-2021-36085 libsepol: use-after-free in \_\_cil\_verify\_classperms() [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1979665>
[ 3 ] Bug #1979667 - CVE-2021-36086 libsepol: use-after-free in cil\_reset\_classpermission() [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1979667>
[ 4 ] Bug #1979669 - CVE-2021-36087 libsepol: heap-based buffer overflow in ebitmap\_match\_any() [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1979669>
[ 5 ] Bug #2018492 - pkg-config returns bad library flags on 64-bit
<https://bugzilla.redhat.com/show_bug.cgi?id=2018492>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-67efe88c29' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR/#U7ZYR3PIJ75N6U2IONJWCKZ5L2NKJTGR)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from bugs.chromium.org_59b66b1f_20250114_223509.html ===


