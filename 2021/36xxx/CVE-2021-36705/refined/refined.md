Based on the provided content, here's an analysis of CVE-2021-36705:

**Root Cause of Vulnerability:**

The vulnerability lies in the `set_TR069` function within the `adm.cgi` binary. Specifically, the value of the `TR069_local_port` parameter, obtained from a web request, is directly used in a `sprintf` call to construct an `iptables` command that is then executed by `system()`. This lack of input sanitization allows for command injection.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The primary vulnerability is a command injection flaw. The unsanitized user-supplied `TR069_local_port` parameter is directly incorporated into a shell command.
*   **Lack of Input Validation:** The application does not validate or sanitize the `TR069_local_port` parameter before using it in the `system()` call.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** An attacker can execute arbitrary commands on the router with root privileges by injecting malicious commands into the `TR069_local_port` parameter.
*   **Full System Compromise:** Successful exploitation allows the attacker to gain complete control over the affected device, potentially leading to data theft, service disruption, or further network attacks.
*   **Reverse Shell:** The attacker can establish a reverse shell to maintain persistent access and control.

**Attack Vectors:**

*   **HTTP POST Requests:** The vulnerability is exploited through HTTP POST requests to the `adm.cgi` binary, with a `page` parameter set to `TR069`.
*   **`TR069_local_port` Parameter:** The malicious commands are injected within the `TR069_local_port` parameter's value.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network access to the router's web interface.
*   **Authentication:** The attacker must be authenticated to access the admin console and trigger the vulnerable function. The write up mentions "Post-Auth Command Injections".
*   **Knowledge of Vulnerable Parameter:** The attacker must know that the `TR069_local_port` parameter is vulnerable and how to manipulate it.