=== Content from www.kb.cert.org_c2403661_20250114_220610.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#131152

## Microsoft Windows Print Spooler Point and Print allows installation of arbitrary queue-specific files

#### Vulnerability Note VU#131152

Original Release Date: 2021-07-18 | Last Revised: 2021-09-14

---

### Overview

Microsoft Windows allows for non-admin users to be able to install printer drivers via Point and Print. Printers installed via this technique also install queue-specific files, which can be arbitrary libraries to be loaded by the privileged Windows Print Spooler process.

### Description

Microsoft Windows allows for users who lack administrative privileges to still be able to install printer drivers, which execute with `SYSTEM` privileges via the Print Spooler service. This ability is achieved through a capability called [Point and Print](https://docs.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-point-and-print). Starting with the update for [MS16-087](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-087), Microsoft requires that printers installable via Point are either signed by a [WHQL release signature](https://docs.microsoft.com/en-us/windows-hardware/drivers/install/whql-release-signature), or are signed by a certificate that is explicitly trusted by the target system, such as an installed test signing certificate. The intention for this change is to avoid installation of malicious printer drivers, which can allow for Local Privilege Escalation (LPE) to `SYSTEM`.

While Windows enforces that driver packages themselves are signed by a trusted source, Windows printer drivers can specify [queue-specific files](https://docs.microsoft.com/en-us/windows-hardware/drivers/print/installing-queue-specific-files) that are associated with the use of the device. For example, a shared printer can specify a `CopyFiles` directive for arbitrary files. These files, which may be copied over alongside the digital-signature-enforced printer driver files are **not** covered by any signature requirement. Furthermore, these files can be used to overwrite any of the signature-verified files that were placed on a system during printer driver install. The remote printer can also be configured to automatically execute code in any files dropped by the `CopyFiles` directive. This can allow for LPE to `SYSTEM` on a vulnerable system.

An exploit for this vulnerability is [publicly available](https://twitter.com/gentilkiwi/status/1416429860566847490).

### Impact

By connecting to a malicious printer, an attacker may be able to execute arbitrary code with `SYSTEM` privileges on a vulnerable system.

### Solution

Microsoft has published updates for [CVE-2021-36958](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958) regarding this issue. Please also consider the following workarounds:

#### Block outbound SMB traffic at your network boundary

Public exploits for this vulnerability utilize SMB for connectivity to a malicious shared printer. If outbound connections to SMB resources are blocked, then this vulnerability may be mitigated for malicious SMB printers that are hosted outside of your network. Note that an attacker local to your network would be able to share a printer via SMB, which would be unaffected by any outbound SMB traffic rules.

#### Configure both PackagePointAndPrintServerList and PackagePointAndPrintOnly settings

Microsoft Windows has a Group Policy called "Package Point and Print - Approved servers", which is reflected in the `HKLM\Software\Policies\Microsoft\Windows NT\Printers\PackagePointAndPrint\PackagePointAndPrintServerList` and `HKLM\Software\Policies\Microsoft\Windows NT\Printers\PackagePointAndPrint\ListofServers` registry values. This policy can restrict which servers can be used by non-administrative users to install printers via Point and Print. Configure this policy to prevent installation of printers from arbitrary servers.

To ensure that Microsoft Windows only attempts to install Package Point and Print printers, and therefore restricting printer connections to the approved servers list, you must also set the `HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PackagePointAndPrint\PackagePointAndPrintOnly` registry value to `1`. The Group Policy setting that corresponds to this value is called "Use only Package Point and print". Setting this value to "Enabled" will enforce that only Package Point and Print printers will be used.

**Both** of these settings must be configured to protect against exploitation of this vulnerability.

#### Block the ability to modify the print spooler drivers directory

Courtesy of the [TRUESEC Blog](https://blog.truesec.com/2021/06/30/fix-for-printnightmare-cve-2021-1675-exploit-to-keep-your-print-servers-running-while-a-patch-is-not-available/), this vulnerability can be mitigated by preventing the `SYSTEM` account from being able to modify the `C:\Windows\System32\spool\drivers` directory contents.

To enable this mitigation, from a privileged PowerShell session, run:

```
$Path = "C:\Windows\System32\spool\drivers"
$Acl = (Get-Item $Path).GetAccessControl('Access')
$Ar = New-Object  System.Security.AccessControl.FileSystemAccessRule("System", "Modify", "ContainerInherit, ObjectInherit", "None", "Deny")
$Acl.AddAccessRule($Ar)
Set-Acl $Path $Acl

```

To revert the mitigation to allow printer driver installation or modification, run:

```
$Path = "C:\Windows\System32\spool\drivers"
$Acl = (Get-Item $Path).GetAccessControl('Access')
$Ar = New-Object System.Security.AccessControl.FileSystemAccessRule("System", "Modify", "ContainerInherit, ObjectInherit", "None", "Deny")
$Acl.RemoveAccessRule($Ar)
Set-Acl $Path $Acl

```
#### Stop and disable the Print Spooler

The Print Spooler can be disabled in a privileged PowerShell session by running the following commands:

```
Stop-Service -Name Spooler -Force
Set-Service -Name Spooler -StartupType Disabled

```

**Impact of workaround** Disabling the Print Spooler service disables the ability to print both locally and remotely.

### Acknowledgements

This vulnerability was publicly disclosed by Benjamin Delpy. Microsoft credits Victor Mata with reporting this issue to them.

This document was written by Will Dormann.

### Vendor Information

131152
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Microsoft](#Microsoft) Affected

Notified:  2021-07-18
Updated: 2021-07-18

| **CVE-2021-36958** | Affected |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

### References

* <https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958>
* <https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-087>
* <https://docs.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-point-and-print>
* <https://docs.microsoft.com/en-us/windows-hardware/drivers/install/whql-release-signature>
* <https://docs.microsoft.com/en-us/windows-hardware/drivers/print/installing-queue-specific-files>
* <https://twitter.com/gentilkiwi/status/1416429860566847490>
* <https://blog.truesec.com/2021/06/30/fix-for-printnightmare-cve-2021-1675-exploit-to-keep-your-print-servers-running-while-a-patch-is-not-available/>

### Other Information

| **CVE IDs:** | [CVE-2021-36958](http://web.nvd.nist.gov/vuln/detail/CVE-2021-36958) |
| --- | --- |
| **Date Public:** | 2021-07-18 |
| **Date First Published:** | 2021-07-18 |
| **Date Last Updated:** | 2021-09-14 22:44 UTC |
| **Document Revision:** | 17 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_c4cb04da_20250115_193417.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan
[Edit](https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/print/introduction-to-point-and-print.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Introduction to Point and Print

* Article
* 12/18/2024
* 1 contributor

Feedback

## In this article

*Point and Print* refers to the capability of allowing a user to create a connection to a remote printer without providing disks or other installation media. All necessary files and configuration information are automatically downloaded from the print server to the client.

Point and Print technology provides two methods by which you can specify files that should be sent from the print server to the client machine:

* Files can be associated with a printer driver. These files are associated with every print queue that uses the driver.
* Files can be associated with individual print queues.

When a user application calls the [**AddPrinterConnection**](/en-us/windows/win32/printdocs/addprinterconnection) function to make a printer connection, the following operations are performed:

* Driver-associated and queue-associated files are downloaded from the print server to the client.
* Current values of the printer's configuration parameters, which are stored in the server's registry under the printer's key, are downloaded to the client.

## See also

[Supporting Point and Print During Printer Installations](supporting-point-and-print-during-printer-installations)

[**AddPrinterConnection**](/en-us/windows/win32/printdocs/addprinterconnection)

---

## Feedback

Was this page helpful?

Yes

No

[Provide product feedback](https://support.microsoft.com/help/4021566/windows-10-send-feedback-to-microsoft-with-feedback-hub-app)|[Get help at Microsoft Q&A](https://learn.microsoft.com/en-us/answers/tags/384/windows-hardware-performance)

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from msrc.microsoft.com_04f4fce4_20250115_193410.html ===
You need to enable JavaScript to run this app.

=== Content from docs.microsoft.com_bbeaf256_20250115_193529.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2016/ms16-087.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS16-087 - Critical

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Security Update for Windows Print Spooler Components (3170005)

Published: July 12, 2016

**Version:** 1.0

## Executive Summary

This security update resolves vulnerabilities in Microsoft Windows. The more severe of the vulnerabilities could allow remote code execution if an attacker is able to execute a man-in-the-middle (MiTM) attack on a workstation or print server, or set up a rogue print server on a target network.

This security update is rated Critical for all supported releases of Microsoft Windows. For more information, see the **Affected Software and Vulnerability Severity Ratings** section.

The update addresses the vulnerabilities by:

* Correcting how the Windows Print Spooler service writes to the file system
* Issuing a warning to users who attempt to install untrusted printer drivers

For more information about the vulnerabilities, see the **Vulnerability Information** section.

For more information about this update, see [Microsoft Knowledge Base Article 3170005](https://support.microsoft.com/kb/3170005).

## Affected Software and Vulnerability Severity Ratings

The following software versions or editions are affected. Versions or editions that are not listed are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

The severity ratings indicated for each affected software assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletinâs release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [July bulletin summary](https://technet.microsoft.com/library/security/ms16-jul).

| **Operating System** | [**Windows Print Spooler Remote Code Execution Vulnerability - CVE-2016-3238**](https://www.cve.org/CVERecord?id=CVE-2016-3238) | [**Windows Print Spooler Elevation of Privilege Vulnerability - CVE-2016-3239**](https://www.cve.org/CVERecord?id=CVE-2016-3239) | \*\*Updates Replaced\*         \*\* |
| --- | --- | --- | --- |
| **Windows Vista** |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=4f32492b-32d6-4011-8e45-d8f669478756) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5ce0dc8d-ee92-42b8-9093-503c11b08e4c) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| **Windows Server 2008** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=de72b4bd-2ba5-4564-9f28-4eb3158aba88) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2ce4da68-efac-4cf1-9377-71363bb8d908) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2b037d86-959a-46ee-b1e1-907814b4e599) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| **Windows 7** |  |  |  |
| [Windows 7 for 32-bit Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=c268dba8-edfd-4967-ada0-cd088433d1fc) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2839894 in [MS13-050](https://go.microsoft.com/fwlink/?linkid=299243) |
| [Windows 7 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=faf59ced-bf3c-4e9d-a9a9-00363b2b8011) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2839894 in [MS13-050](https://go.microsoft.com/fwlink/?linkid=299243) |
| **Windows Server 2008 R2** |  |  |  |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6e1eee96-e3ea-45b8-b8c8-aa9866dd8bff) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2839894 in [MS13-050](https://go.microsoft.com/fwlink/?linkid=299243) |
| [Windows Server 2008 R2 for Itanium-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=60d2eda6-3fe2-4502-938b-e1837477ed4b) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2839894 in [MS13-050](https://go.microsoft.com/fwlink/?linkid=299243) |
| **Windows 8.1** |  |  |  |
| [Windows 8.1 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=e510c869-199c-4b03-9f13-33acd7aedbec) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| [Windows 8.1 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=e7febad8-792b-4084-9858-e9a277707bb9) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |  |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=0734c375-d31b-4779-870b-1ff42bed53cb) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=b89e295a-5151-49b6-94a9-8fe00d0ebc62) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| **Windows RT** |  |  |  |
| Windows RT 8.1[1](3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| **Windows 10** |  |  |  |
| [Windows 10 for 32-bit Systems](https://support.microsoft.com/kb/3163912)[2](3163912) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | [3163017](https://support.microsoft.com/kb/3163017) |
| [Windows 10 for x64-based Systems](https://support.microsoft.com/kb/3163912)[2](3163912) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | [3163017](https://support.microsoft.com/kb/3163017) |
| [Windows 10 Version 1511 for 32-bit Systems](https://support.microsoft.com/kb/3172985)[2](3172985) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | [3163018](https://support.microsoft.com/kb/3163018) |
| [Windows 10 Version 1511 for x64-based Systems](https://support.microsoft.com/kb/3172985)[2](3172985) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | [3163018](https://support.microsoft.com/kb/3163018) |
| **Server Core installation option** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=de72b4bd-2ba5-4564-9f28-4eb3158aba88) (Server Core installation) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2ce4da68-efac-4cf1-9377-71363bb8d908) (Server Core installation) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2712808 in [MS12-054](https://go.microsoft.com/fwlink/?linkid=257914) |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6e1eee96-e3ea-45b8-b8c8-aa9866dd8bff) (Server Core installation) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | 2839894 in [MS13-050](https://go.microsoft.com/fwlink/?linkid=299243) |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=0734c375-d31b-4779-870b-1ff42bed53cb) (Server Core installation) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=b89e295a-5151-49b6-94a9-8fe00d0ebc62) (Server Core installation) (3170455) | **Critical**  Remote Code Execution | **Important**  Elevation of Privilege | None |

[1]This update is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130).

[2]Windows 10 updates are cumulative. The monthly security release includes all security fixes for vulnerabilities that affect Windows 10, in addition to non-security updates. The updates are available via the [Microsoft Update Catalog](https://catalog.update.microsoft.com/v7/site/home.aspx).

**Note** The vulnerabilities discussed in this bulletin affect Windows Server 2016 Technical Preview 4 and Windows Server 2016 Technical Preview 5. An update is available for Windows Server 2016 Technical Preview 5 via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130). However, no update is available for Windows Server 2016 Technical Preview 4. To be protected from the vulnerability, Microsoft recommends that customers running Windows Server 2016 Technical Preview 4 upgrade to Windows Server 2016 Technical Preview 5.

\*The Updates Replaced column shows only the latest update in any chain of superseded updates. For a comprehensive list of updates replaced, go to the [Microsoft Update Catalog](https://catalog.update.microsoft.com/v7/site/home.aspx), search for the update KB number, and then view update details (updates replaced information is provided on the Package Details tab).

## Vulnerability Information

## Windows Print Spooler Remote Code Execution Vulnerability - CVE-2016-3238

A remote code execution vulnerability exists when the Windows Print Spooler service does not properly validate print drivers while installing a printer from servers. An attacker who successfully exploited this vulnerability could use it to execute arbitrary code and take control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

To exploit this vulnerability, an attacker must be able to execute a man-in-the-middle ([MiTM](https://technet.microsoft.com/library/security/dn848375.aspx)) attack on a workstation or print server, or set up a rogue print server on a target network. The update addresses the vulnerability by issuing a warning to users who attempt to install untrusted printer drivers.

The following table contains links to the standard entry for each vulnerability in the Common Vulnerabilities and Exposures list:

| **Vulnerability Title** | **CVE number** | **Publicly disclosed** | **Exploited** |
| --- | --- | --- | --- |
| Windows Print Spooler Remote Code Execution Vulnerability | [CVE-2016-3238](https://www.cve.org/CVERecord?id=CVE-2016-3238) | No | No |

### Mitigating Factors

The following [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) may be helpful in your situation.

Depending on the operating system you are running and its configuration, you may be able to change Point and Print Restrictions policies to enable users to print only to specific print servers that you trust. For information about specific operating systems and configuration options, see:

* [Microsoft Knowledge Base Article 2307161](https://support.microsoft.com/kb/2307161)
* [Microsoft Knowledge Base Article 319939](https://support.microsoft.com/kb/319939)

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

## Windows Print Spooler Elevation of Privilege Vulnerability - CVE-2016-3239

An elevation of privilege vulnerability exists when the Windows Print Spooler service improperly allows arbitrary writing to the file system. An attacker who successfully exploited this vulnerability could run arbitrary code with elevated system privileges. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

To exploit this vulnerability, an attacker would have to log on to an affected system and run a specially crafted script or application. The update addresses the vulnerability by correcting how the Windows Print Spooler Component writes to the file system.

The following table contains links to the standard entry for each vulnerability in the Common Vulnerabilities and Exposures list:

| **Vulnerability Title** | **CVE number** | **Publicly disclosed** | **Exploited** |
| --- | --- | --- | --- |
| Windows Print Spooler Elevation of Privilege Vulnerability | [CVE-2016-3239](https://www.cve.org/CVERecord?id=CVE-2016-3239) | No | No |

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/mt674627.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (July 12, 2016): Bulletin published.

*Page generated 2016-07-11 11:49-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from portal.msrc.microsoft.com_3add7fb5_20250114_220609.html ===
You need to enable JavaScript to run this app.
