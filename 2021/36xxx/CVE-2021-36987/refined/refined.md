Based on the provided content, here's the breakdown of CVE-2021-36987:

**Root Cause of Vulnerability:**

*   The vulnerability is caused by a race condition that leads to nodes in a linked list being freed multiple times.

**Weaknesses/Vulnerabilities Present:**

*   **Double Free:** The core issue is that memory associated with linked list nodes is being released more than once, leading to a double-free vulnerability.
*   **Race Condition:** The vulnerability is triggered by a race condition, indicating that the timing of concurrent operations on the linked list is crucial for exploitation.

**Impact of Exploitation:**

*   **System Restart:** Successful exploitation of the double-free vulnerability can cause the affected device to restart due to system instability and memory corruption.

**Attack Vectors:**

*   The provided document does not detail how an attacker would trigger the race condition, or the specific context in which this linked list is manipulated. Further analysis of specific code is needed to determine the attack vector.

**Required Attacker Capabilities/Position:**

*   The attacker would need the ability to trigger the race condition. This likely involves some form of interaction with the system which would lead to the linked list being manipulated in a way that triggers the double free. The document does not specify the required level of access.

**Affected Versions:**

*   EMUI 11.0.0
*   EMUI 10.1.1
*   Magic UI 4.0.0
*   Magic UI 3.1.1