=== Content from doc.powerdns.com_ffb8dad0_20250114_205108.html ===

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2022-01.html "PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor") |
* [previous](powerdns-advisory-2020-06.html "PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »
* [Security Advisories](index.html) »

[PowerDNS Authoritative Server](../indexTOC.html)

#### Previous topic

[PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support](powerdns-advisory-2020-06.html "previous chapter")

#### Next topic

[PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html "next chapter")

## Contents

* [PowerDNS Authoritative Nameserver](../index.html)
* [Installing PowerDNS](../installation.html)
* [Upgrade Notes](../upgrading.html)
* [DNS Modes of Operation](../modes-of-operation.html)
* [Migrating to PowerDNS](../migration.html)
* [Running and Operating](../running.html)
* [Security of PowerDNS](../security.html)
* [Performance and Tuning](../performance.html)
* [DNSSEC](../dnssec/index.html)
* [Per zone settings: Domain Metadata](../domainmetadata.html)
* [Dynamic DNS Update (RFC 2136)](../dnsupdate.html)
* [Catalog Zones (RFC 9432)](../catalog.html)
* [TSIG](../tsig.html)
* [Lua Records](../lua-records/index.html)
* [Guides and How Tos](../guides/index.html)
* [Backends](../backends/index.html)
* [Built-in Webserver and HTTP API](../http-api/index.html)
* [Manual Pages](../manpages/index.html)
* [Authoritative Server Settings](../settings.html)
* [Security Advisories](index.html)
  + [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
  + PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server
  + [PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support](powerdns-advisory-2020-06.html)
  + [PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html)
  + [PowerDNS Security Advisory 2019-06: Denial of service via crafted zone records](powerdns-advisory-2019-06.html)
  + [PowerDNS Security Advisory 2019-05: Denial of service via NOTIFY packets](powerdns-advisory-2019-05.html)
  + [PowerDNS Security Advisory 2019-04: Denial of service via crafted zone records](powerdns-advisory-2019-04.html)
  + [PowerDNS Security Advisory 2019-03: Insufficient validation in the HTTP remote backend](powerdns-advisory-2019-03.html)
  + [PowerDNS Security Advisory 2018-05: Packet cache pollution via crafted query](powerdns-advisory-2018-05.html)
  + [PowerDNS Security Advisory 2018-03: Crafted zone record can cause a denial of service](powerdns-advisory-2018-03.html)
  + [PowerDNS Security Advisory 2018-02: Buffer overflow in dnsreplay](powerdns-advisory-2018-02.html)
  + [PowerDNS Security Advisory 2017-04: Missing check on API operations](powerdns-advisory-2017-04.html)
  + [PowerDNS Security Advisory 2016-05: Crafted zone record can cause a denial of service](powerdns-advisory-2016-05.html)
  + [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
  + [PowerDNS Security Advisory 2016-03: Denial of service via the web server](powerdns-advisory-2016-03.html)
  + [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
  + [PowerDNS Security Advisory 2016-01: Crafted queries can cause unexpected backend load](powerdns-advisory-2016-01.html)
  + [PowerDNS Security Advisory 2015-03: Packet parsing bug can lead to crashes](powerdns-advisory-2015-03.html)
  + [PowerDNS Security Advisory 2015-02: Packet parsing bug can cause thread or process abortion](powerdns-advisory-2015-02.html)
  + [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
  + [PowerDNS Security Advisory 2012-01: PowerDNS Authoritative Server can be caused to generate a traffic loop](powerdns-advisory-2012-01.html)
  + [PowerDNS Security Advisory 2008-03: Some PowerDNS Configurations can be forced to restart remotely](powerdns-advisory-2008-03.html)
  + [PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html)
  + [Older security advisories](index.html#older-security-advisories)
* [Changelogs](../changelog/index.html)
* [End of life statements](../appendices/EOL.html)
* [Frequently Asked Questions](../appendices/FAQ.html)
* [Backend writersâ guide](../appendices/backend-writers-guide.html)
* [Compiling PowerDNS](../appendices/compiling.html)
* [Cryptographic software and export control](../appendices/crypto-export.html)
* [Internals](../appendices/internals.html)
* [Supported Record Types](../appendices/types.html)
* [PowerDNS/dnsdist license](../common/license.html)

### This Page

* [Show Source](../_sources/security-advisories/powerdns-advisory-2021-01.rst.txt)

1. [Docs](../indexTOC.html)
2. [Security Advisories](index.html)
3. PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server

# PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server[Â¶](#powerdns-security-advisory-2021-01-specific-query-crashes-authoritative-server "Permalink to this headline")

* CVE: CVE-2021-36754
* Date: July 26th, 2021
* Affects: PowerDNS Authoritative version 4.5.0
* Not affected: 4.4.x and below, 4.5.1
* Severity: High
* Impact: Denial of service
* Exploit: This problem can be triggered via a specific query packet
* Risk of system compromise: None
* Solution: Upgrade to 4.5.1, or filter queries in `dnsdist`

PowerDNS Authoritative Server 4.5.0 (and the alpha/beta/rc1/rc2 prereleases that came before it) will crash with an uncaught out of bounds exception if it receives a query with QTYPE 65535. The offending code was not present in earlier versions, and they are not affected.

Users that cannot upgrade immediately, but do have dnsdist in place, can use dnsdist to filter such queries before they do harm, with something like `addAction(QTypeRule(65535), RCodeAction(DNSRCode.REFUSED))`.

When the PowerDNS Authoritative Server is run inside a supervisor like supervisord or systemd, an uncaught exception crash will lead to an automatic restart, limiting the impact to a somewhat degraded service.

We would like to thank Reinier Schoof and Robin Geuze of TransIP for noticing crashes in production, immediately letting us know, and helping us figure out what was happening.

[PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support](powerdns-advisory-2020-06.html "previous chapter (use the left arrow)")

[PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html "next chapter (use the right arrow)")

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2022-01.html "PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor") |
* [previous](powerdns-advisory-2020-06.html "PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »
* [Security Advisories](index.html) »

© Copyright PowerDNS.COM BV. Created using [Sphinx](http://sphinx.pocoo.org/).



=== Content from www.openwall.com_cd755066_20250114_205107.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <9120e36f89c0b082a73fa2dfaf46036d09d6f22e.camel@powerdns.com>
Date: Mon, 26 Jul 2021 14:47:04 +0200
From: Peter van Dijk <peter.van.dijk@...erdns.com>
To: oss-security@...ts.openwall.com
Subject: security advisory 2021-01 for PowerDNS Authoritative Server 4.5.0

Hello,

today we have released PowerDNS Authoritative Server 4.5.1, fixing a
remotely triggered crash present in version 4.5.0. No other versions
are affected.

Tarballs and signatures are available at
<https://downloads.powerdns.com/releases/>, and a single patch is
available at <https://downloads.powerdns.com/patches/2021-01/>. However,
4.5.1 contains no other changes.

Please find the full text of the advisory below.

PowerDNS Security Advisory 2021-01: Specific query crashes
Authoritative Server

-  CVE: CVE-2021-36754
-  Date: July 26th, 2021
-  Affects: PowerDNS Authoritative version 4.5.0
-  Not affected: 4.4.x and below, 4.5.1
-  Severity: High
-  Impact: Denial of service
-  Exploit: This problem can be triggered via a specific query packet
-  Risk of system compromise: None
-  Solution: Upgrade to 4.5.1, or filter queries in ``dnsdist``

PowerDNS Authoritative Server 4.5.0 (and the alpha/beta/rc1/rc2
prereleases that came before it) will crash with an uncaught out of
bounds exception if it receives a query with QTYPE 65535. The offending
code was not present in earlier versions, and they are not affected.

Users that cannot upgrade immediately, but do have dnsdist in place,
can use dnsdist to filter such queries before they do harm, with
something like ``addAction(QTypeRule(65535),
RCodeAction(DNSRCode.REFUSED))``.

When the PowerDNS Authoritative Server is run inside a supervisor like
supervisord or systemd, an uncaught exception crash will lead to an
automatic restart, limiting the impact to a somewhat degraded service.

We would like to thank Reinier Schoof and Robin Geuze of TransIP for
noticing crashes in production, immediately letting us know, and
helping us figure out what was happening.

Kind regards,
--
Peter van Dijk
PowerDNS.COM BV - <https://www.powerdns.com/>

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (915 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from doc.powerdns.com_dbbec69f_20250114_205108.html ===

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2008-02.html "PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof") |
* [previous](../settings.html "Authoritative Server Settings") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »

[PowerDNS Authoritative Server](../indexTOC.html)

#### Previous topic

[Authoritative Server Settings](../settings.html "previous chapter")

#### Next topic

[PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html "next chapter")

## Contents

* [PowerDNS Authoritative Nameserver](../index.html)
* [Installing PowerDNS](../installation.html)
* [Upgrade Notes](../upgrading.html)
* [DNS Modes of Operation](../modes-of-operation.html)
* [Migrating to PowerDNS](../migration.html)
* [Running and Operating](../running.html)
* [Security of PowerDNS](../security.html)
* [Performance and Tuning](../performance.html)
* [DNSSEC](../dnssec/index.html)
* [Per zone settings: Domain Metadata](../domainmetadata.html)
* [Dynamic DNS Update (RFC 2136)](../dnsupdate.html)
* [Catalog Zones (RFC 9432)](../catalog.html)
* [TSIG](../tsig.html)
* [Lua Records](../lua-records/index.html)
* [Guides and How Tos](../guides/index.html)
* [Backends](../backends/index.html)
* [Built-in Webserver and HTTP API](../http-api/index.html)
* [Manual Pages](../manpages/index.html)
* [Authoritative Server Settings](../settings.html)
* Security Advisories
  + [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
  + [PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server](powerdns-advisory-2021-01.html)
  + [PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support](powerdns-advisory-2020-06.html)
  + [PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html)
  + [PowerDNS Security Advisory 2019-06: Denial of service via crafted zone records](powerdns-advisory-2019-06.html)
  + [PowerDNS Security Advisory 2019-05: Denial of service via NOTIFY packets](powerdns-advisory-2019-05.html)
  + [PowerDNS Security Advisory 2019-04: Denial of service via crafted zone records](powerdns-advisory-2019-04.html)
  + [PowerDNS Security Advisory 2019-03: Insufficient validation in the HTTP remote backend](powerdns-advisory-2019-03.html)
  + [PowerDNS Security Advisory 2018-05: Packet cache pollution via crafted query](powerdns-advisory-2018-05.html)
  + [PowerDNS Security Advisory 2018-03: Crafted zone record can cause a denial of service](powerdns-advisory-2018-03.html)
  + [PowerDNS Security Advisory 2018-02: Buffer overflow in dnsreplay](powerdns-advisory-2018-02.html)
  + [PowerDNS Security Advisory 2017-04: Missing check on API operations](powerdns-advisory-2017-04.html)
  + [PowerDNS Security Advisory 2016-05: Crafted zone record can cause a denial of service](powerdns-advisory-2016-05.html)
  + [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
  + [PowerDNS Security Advisory 2016-03: Denial of service via the web server](powerdns-advisory-2016-03.html)
  + [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
  + [PowerDNS Security Advisory 2016-01: Crafted queries can cause unexpected backend load](powerdns-advisory-2016-01.html)
  + [PowerDNS Security Advisory 2015-03: Packet parsing bug can lead to crashes](powerdns-advisory-2015-03.html)
  + [PowerDNS Security Advisory 2015-02: Packet parsing bug can cause thread or process abortion](powerdns-advisory-2015-02.html)
  + [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
  + [PowerDNS Security Advisory 2012-01: PowerDNS Authoritative Server can be caused to generate a traffic loop](powerdns-advisory-2012-01.html)
  + [PowerDNS Security Advisory 2008-03: Some PowerDNS Configurations can be forced to restart remotely](powerdns-advisory-2008-03.html)
  + [PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html)
  + [Older security advisories](#older-security-advisories)
* [Changelogs](../changelog/index.html)
* [End of life statements](../appendices/EOL.html)
* [Frequently Asked Questions](../appendices/FAQ.html)
* [Backend writersâ guide](../appendices/backend-writers-guide.html)
* [Compiling PowerDNS](../appendices/compiling.html)
* [Cryptographic software and export control](../appendices/crypto-export.html)
* [Internals](../appendices/internals.html)
* [Supported Record Types](../appendices/types.html)
* [PowerDNS/dnsdist license](../common/license.html)

### This Page

* [Show Source](../_sources/security-advisories/index.rst.txt)

1. [Docs](../indexTOC.html)
2. Security Advisories

# Security Advisories[Â¶](#security-advisories "Permalink to this headline")

All security advisories for the PowerDNS Authoritative Server are listed here.

* [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
* [PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server](powerdns-advisory-2021-01.html)
* [PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support](powerdns-advisory-2020-06.html)
* [PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html)
* [PowerDNS Security Advisory 2019-06: Denial of service via crafted zone records](powerdns-advisory-2019-06.html)
* [PowerDNS Security Advisory 2019-05: Denial of service via NOTIFY packets](powerdns-advisory-2019-05.html)
* [PowerDNS Security Advisory 2019-04: Denial of service via crafted zone records](powerdns-advisory-2019-04.html)
* [PowerDNS Security Advisory 2019-03: Insufficient validation in the HTTP remote backend](powerdns-advisory-2019-03.html)
* [PowerDNS Security Advisory 2018-05: Packet cache pollution via crafted query](powerdns-advisory-2018-05.html)
* [PowerDNS Security Advisory 2018-03: Crafted zone record can cause a denial of service](powerdns-advisory-2018-03.html)
* [PowerDNS Security Advisory 2018-02: Buffer overflow in dnsreplay](powerdns-advisory-2018-02.html)
* [PowerDNS Security Advisory 2017-04: Missing check on API operations](powerdns-advisory-2017-04.html)
* [PowerDNS Security Advisory 2016-05: Crafted zone record can cause a denial of service](powerdns-advisory-2016-05.html)
* [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
* [PowerDNS Security Advisory 2016-03: Denial of service via the web server](powerdns-advisory-2016-03.html)
* [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
* [PowerDNS Security Advisory 2016-01: Crafted queries can cause unexpected backend load](powerdns-advisory-2016-01.html)
* [PowerDNS Security Advisory 2015-03: Packet parsing bug can lead to crashes](powerdns-advisory-2015-03.html)
* [PowerDNS Security Advisory 2015-02: Packet parsing bug can cause thread or process abortion](powerdns-advisory-2015-02.html)
* [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
* [PowerDNS Security Advisory 2012-01: PowerDNS Authoritative Server can be caused to generate a traffic loop](powerdns-advisory-2012-01.html)
* [PowerDNS Security Advisory 2008-03: Some PowerDNS Configurations can be forced to restart remotely](powerdns-advisory-2008-03.html)
* [PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html)

## Older security advisories[Â¶](#older-security-advisories "Permalink to this headline")

Version 3.0 of the PowerDNS recursor contains a denial of service bug which can be exploited remotely.
This bug, which we believe to only lead to a crash, has been fixed in 3.0.1.
There are no guarantees however, so an upgrade from 3.0 is highly recommended.

All versions of PowerDNS before 2.9.21.1 do not respond to certain queries.
This in itself is not a problem, but since the discovery by Dan Kaminsky of a new spoofing technique, this silence for queries PowerDNS considers invalid, within a valid domain, allows attackers more chances to feed *other* resolvers bad data.

All versions of PowerDNS before 2.9.18 contain the following two bugs, which only apply to installations running with the LDAP backend, or installations providing recursion to a limited range of IP addresses.
If any of these apply to you, an upgrade is highly advised:

* The LDAP backend did not properly escape all queries, allowing it to
  fail and not answer questions. We have not investigated further risks
  involved, but we advise LDAP users to update as quickly as possible
  (Norbert Sendetzky, Jan de Groot)
* Questions from clients denied recursion could blank out answers to
  clients who are allowed recursion services, temporarily. Reported by
  Wilco Baan. This wouldâve made it possible for outsiders to blank out
  a domain temporarily to your users. Luckily PowerDNS would send out
  SERVFAIL or Refused, and not a denial of a domainâs existence.

All versions of PowerDNS before 2.9.17 are known to suffer from remote denial of service problems which can disrupt operation.
Please upgrade to 2.9.17 as this page will only contain detailed security information from 2.9.17 onwards.

[Authoritative Server Settings](../settings.html "previous chapter (use the left arrow)")

[PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html "next chapter (use the right arrow)")

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2008-02.html "PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof") |
* [previous](../settings.html "Authoritative Server Settings") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »

© Copyright PowerDNS.COM BV. Created using [Sphinx](http://sphinx.pocoo.org/).


