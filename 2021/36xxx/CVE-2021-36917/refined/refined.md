Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2021-36917:

**Root Cause:**

*   **Broken Access Control:** The plugin lacked proper authorization and authentication checks, allowing unprivileged users to execute privileged actions.
*   **SQL Injection:** The plugin was vulnerable to SQL injection due to improper handling of user-supplied IP address headers. The `hmwp_get_user_ip` function retrieved the IP address from multiple headers, including those that can be easily spoofed.
*   **Insecure Token Exposure:** The plugin exposed a reset token in the HTML output and via email during the process of changing the admin path. This token could be used to deactivate the plugin.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:** Unsanitized input from HTTP headers was directly incorporated into SQL queries.
*   **Broken Access Control:** Missing authorization checks allowed unauthenticated access to sensitive functionality.
*   **Information Disclosure:** A reset token was exposed to unauthenticated users, allowing them to deactivate the plugin.

**Impact of Exploitation:**

*   **SQL Injection:** An attacker could potentially read or modify data in the database.
*   **Deactivation of Plugin:** An unauthenticated user could retrieve a reset token and use it to deactivate the plugin. This could disrupt the functionality of a website that relies on the plugin for security or other essential functions.

**Attack Vectors:**

*   **HTTP Header Manipulation:** The SQL injection vulnerability could be exploited by crafting malicious HTTP requests with spoofed IP address headers.
*   **Direct URL Access:** The reset token was exposed via a crafted URL, /wp-admin/admin-ajax.php?die\_message=new\_admin&action=heartbeat, and via email. This URL did not require any authentication to access.

**Required Attacker Capabilities/Position:**

*   **Unauthenticated Access:** The attacker did not need to be authenticated to exploit these vulnerabilities.
*   **Network Access:** The attacker needed to be able to send HTTP requests to the target server.

**Additional Notes:**

*   The vulnerable versions of the plugin are <= 6.2.3.
*   The vulnerabilities were fixed in version 6.2.4.
*   Patchstack issued a virtual patch to mitigate the issue before the official fix was released.
*   The SQL injection vulnerability was due to the lack of sanitization of the IP address before being used in a SQL query.
*   The reset token was exposed because it was directly printed on the screen and included in an email during a specific process related to admin path changes.

This content provides more detail than the official CVE description, as it outlines the specific vulnerable code snippets and explains the exact mechanisms of exploitation.