Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The root cause of the vulnerability lies in how MediaWiki's `ActorStore` handles database connections when suppressing users via the `Special:CentralAuth` page. Specifically, when a user is suppressed across multiple wikis, the `ActorStore::checkDatabaseDomain` function was not properly verifying if the database connection domain matches the expected one. This issue arose because cross-wiki blocks were being handled without proper awareness of the target wiki, leading to operations being performed in the context of the wrong wiki.

**Weaknesses/Vulnerabilities:**

*   **Incorrect Database Context:** The code was not properly ensuring that database operations, particularly those related to user blocks and suppressions, were executed within the correct wiki's database context. This is due to the `ActorStore` not properly checking if the database connection domain matches the expected wiki.
*   **Cross-wiki Blocking Issues:**  The implementation of cross-wiki blocking was flawed, causing autoblocks to be created in the context of the wrong wiki (usually metawiki), which resulted in errors.
*   **CentralAuth Specific:** This issue primarily affected scenarios where CentralAuth was used for cross-wiki user management, particularly for user suppression.
*   **Autoblock Logic:** The logic for autoblocks was not "wiki-aware", meaning that when a user was blocked across wikis, the associated autoblocks were being created on the wrong wiki.

**Impact of Exploitation:**

*   **Suppression Failure:** The primary impact was that global suppressions (hiding a user's identity across all wikis) issued through `Special:CentralAuth` would fail with an `InvalidArgumentException`. This prevented administrators from effectively hiding or locking user accounts across the wiki farm.
*   **Incorrect Autoblocks:**  Autoblocks were being created in the wrong wiki, which could lead to unexpected behavior and block users on wikis where they haven't committed violations, or fail to apply the blocks to the wiki where the violation occurred.
*   **Operational Disruption:**  The inability to properly suppress accounts could lead to operational disruptions, especially in cases where a user needs to be quickly hidden due to privacy or security reasons.

**Attack Vectors:**

*   The vulnerability was triggered when administrators used the `Special:CentralAuth` page to suppress users globally, particularly when cross-wiki blocking was involved.
*   The specific actions were related to the `CentralAuthUser::doLocalSuppression` method, which was not correctly handling database connections during suppression.
*   The `CheckUser` extension contributed to the problem through its retroactive autoblocking functionality, which was not wiki-aware.

**Required Attacker Capabilities/Position:**

*   **Administrative Access:** The "attacker" in this case was primarily an administrator or a user with sufficient rights to use the `Special:CentralAuth` interface and perform user suppression.
*   **Cross-wiki Context:** The issue was primarily triggered during cross-wiki operations, meaning the user attempting suppression would need to have the necessary permissions to perform actions across multiple wikis.

**Additional Notes:**

*   The provided information is more detailed than a typical CVE description as it includes the stack trace, code snippets, and the context of the problem within the MediaWiki environment.
*   The resolution involved a combination of disabling autoblocks for CentralAuth-issued suppressions as a temporary workaround, and subsequently implementing proper cross-wiki awareness in the blocking mechanisms.
*   The fix involved modifications to several parts of the MediaWiki code, including `ActorStore`, `DatabaseBlockStore`, `CentralAuthUser`, and the `CheckUser` extension.
*   The provided information also describes how patches were backported to different MediaWiki releases and branches.