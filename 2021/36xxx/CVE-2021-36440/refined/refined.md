Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the `download` function within `AdminUpdateController.class.php`. This function downloads a zip file from a URL specified by the `file_url` parameter, then extracts its contents. Critically, it lacks proper validation of the downloaded file's contents and where they're extracted to.

**Weaknesses/Vulnerabilities:**

*   **Unrestricted File Upload:** The primary vulnerability is the ability to upload arbitrary files. The application downloads a ZIP file from a provided URL without verifying its contents, allowing an attacker to include malicious files within the archive.
*   **Arbitrary File Overwrite/Creation:** Upon extraction of the malicious ZIP, files within the archive are written to the `Public/Uploads/update/` directory, which is accessible via the web, allowing overwriting of existing files or creation of new ones.
*   **Lack of Input Sanitization/Validation:** The `file_url` parameter is not validated. This allows an attacker to provide any URL, including ones pointing to malicious ZIP files.

**Impact of Exploitation:**

*   **Remote Code Execution:** By uploading a malicious PHP file (e.g., `phpinfo7.php` as shown in the provided example), an attacker can achieve remote code execution. The uploaded file is placed in the web accessible directory `Public/Uploads/update/` which can be accessed via the browser.
*   **Full System Compromise:**  Remote code execution could lead to full compromise of the server.
*   **Data Breach:** By executing arbitrary code, an attacker could gain unauthorized access to data stored on the server.
*   **Website Defacement:**  An attacker could overwrite website files to deface the site.

**Attack Vectors:**

*   **Network-based:** The attack is performed over the network. The attacker sends a crafted HTTP POST request to the vulnerable endpoint (`/server/index.php?s=/api/adminUpdate/download`).
*   **File Download and Extraction:** The attacker controls the content of a ZIP file through the `file_url` parameter. This file is then downloaded and extracted by the server.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must be able to send HTTP requests to the server hosting the vulnerable application.
*   **Knowledge of Vulnerable Endpoint:** The attacker must know the vulnerable endpoint (`/server/index.php?s=/api/adminUpdate/download`).
*   **Ability to Host a Malicious ZIP File:** The attacker needs to host a malicious ZIP file on a server they control and make it accessible via a URL.

**Additional Details:**

*   The provided code snippets confirm the lack of validation of the downloaded file content, which allowed writing malicious files to the server.
*   The vulnerability exists in ShowDoc versions prior to 2.9.6
*   The fix included permission control to prevent this type of attack.
*   The Github Advisory provides a CVSS v3 base score of 9.8
*   The PoC provided shows a malicious `phpinfo7.php` file included in the zip which is accessible via the browser.