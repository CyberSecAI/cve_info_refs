Based on the provided content, here's the breakdown of CVE-2021-36697:

**Root Cause of Vulnerability:**

The vulnerability stems from the Pandora FMS File Manager not properly restricting the upload of files with specific extensions, particularly the `.htaccess` file. This allows an attacker to overwrite existing `.htaccess` files. By crafting a specific `.htaccess` file, the attacker can instruct the webserver to treat files with arbitrary extensions (e.g., `.kpmghungary`) as PHP files. This allows the execution of malicious PHP code.

**Weaknesses/Vulnerabilities Present:**

1.  **Unrestricted File Upload:** The File Manager does not adequately restrict file extensions, allowing the upload of `.htaccess` files.
2.  **`.htaccess` Overwrite:** The ability to overwrite `.htaccess` files enables the attacker to change server configuration.
3.  **Arbitrary Code Execution:** By using a crafted `.htaccess` to map custom extensions to PHP execution, an attacker can upload and execute PHP code.

**Impact of Exploitation:**

Successful exploitation results in arbitrary code execution on the server. The attacker can gain a reverse shell, enabling full control of the system.

**Attack Vectors:**

1.  **File Manager Access:** The attacker needs access to the Pandora FMS File Manager, which is an administrative feature.
2.  **.htaccess Overwrite:** The attacker uploads a malicious `.htaccess` file via the File Manager.
3.  **Custom Extension Upload:** The attacker uploads a file with a custom extension (e.g., `.kpmghungary`) containing malicious PHP code.
4.  **PHP Code Execution:** The attacker sends a request to the uploaded file, which is now treated as a PHP script due to the modified `.htaccess` file, thus executing the malicious code.

**Required Attacker Capabilities/Position:**

1.  **Administrative Access:** The attacker needs administrative privileges to access the File Manager.
2.  **Network Connectivity:** The attacker needs network connectivity to the Pandora FMS server and to their machine if they intend to establish a reverse shell.
3. **Knowledge of target:** The attacker needs to know the file path of the folder to which the '.htaccess' file will be uploaded.

**Additional Information (from the provided content):**

*   The exploit can be chained with an XSS vulnerability (CVE-2021-36698) that was discovered in the Event Filters. The XSS vulnerability allows a lower-level user to execute javascript that can perform the same steps, bypassing the need to have admin credentials to upload the malicious '.htaccess' file.
*   The provided exploit script automates the login, `.htaccess` upload, custom extension file upload, and PHP execution process.
*   The attacker can modify the `.htaccess` file to use any arbitrary file extension for PHP execution.
*   The attacker can upload any php code, including those that create a reverse shell.

This content provides significantly more detail than the typical CVE description.