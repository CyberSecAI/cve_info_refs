Based on the provided content, here's an analysis of CVE-2021-36698:

**Root Cause of Vulnerability:**

The root cause is the ability to upload and overwrite arbitrary files, specifically the `.htaccess` file, using the File Manager in Pandora FMS. This feature allows an attacker to modify the webserver's configuration.

**Weaknesses/Vulnerabilities Present:**

1.  **Unrestricted File Upload:** The File Manager does not properly restrict file extensions, allowing the upload of files like `.htaccess`.
2.  **`.htaccess` Overwrite:** The ability to overwrite the `.htaccess` file allows for manipulation of server-side configurations.
3.  **Chained Exploitation:** The vulnerability is chained with a stored XSS vulnerability, which can be leveraged by a low-privileged user to trigger the file upload, making it more impactful.

**Impact of Exploitation:**

1.  **Remote Code Execution (RCE):** By modifying the `.htaccess` file, the attacker can configure the server to execute files with a custom extension (e.g., ".kpmghungary") as PHP code. This allows the attacker to upload and execute arbitrary code on the server, leading to complete system compromise.
2.  **Cross-Site Scripting (XSS):** A stored XSS vulnerability allows the execution of arbitrary JavaScript code within the context of the application. This can lead to session hijacking, data theft, or further exploitation of the system.

**Attack Vectors:**

1.  **File Upload:** An attacker exploits the File Manager to upload a malicious `.htaccess` file. This is possible because file extensions are not properly restricted by the file upload functionality.
2.  **`.htaccess` Manipulation:** The uploaded `.htaccess` file configures the webserver to treat files with a specific extension (e.g., .kpmghungary) as PHP files.
3.  **Malicious File Upload:** The attacker uploads a file with the custom extension, containing malicious PHP code.
4. **Chaining with XSS:** Low-privileged users can exploit a stored XSS vulnerability in event filters to execute Javascript that triggers the file upload and RCE, expanding the attack surface.

**Required Attacker Capabilities/Position:**

1.  **Authentication:** The attacker needs valid administrator credentials to access the File Manager or a low-privileged user to trigger the XSS.
2.  **Network Access:** The attacker needs network access to the Pandora FMS server to send HTTP requests.

**Additional Details from the Content:**

*   The content provides a detailed step-by-step exploit scenario with code examples demonstrating how to leverage both vulnerabilities.
*   The provided python exploit script highlights how to chain the vulnerabilities to achieve RCE using a custom .htaccess file and extension.
*   The XSS vulnerability can be triggered by creating a new event filter containing Javascript code.
*   The attacker can store a Javascript payload on a separate server and load it via the XSS vector to trigger the exploit chain.

This detailed explanation is far more comprehensive than a basic CVE description would typically provide, offering specific details on how to exploit the vulnerability.