```
{
  "vulnerability": {
    "cve_id": "CVE-2021-36980",
    "description": "While decoding RAW_ENCAP action, decode_ed_prop() might re-allocate ofpbuf if there is not enough space left. However, function 'decode_NXAST_RAW_ENCAP' continues to use old pointer to 'encap' structure leading to write-after-free and incorrect decoding.",
    "affected_component": "Open vSwitch",
    "root_cause": "The vulnerability stems from a use-after-free error during the decoding of RAW_ENCAP actions. Specifically, the decode_ed_prop() function might reallocate the ofpbuf, leading to a dangling pointer in decode_NXAST_RAW_ENCAP.",
    "vulnerability_details": {
      "weakness": "Use-after-free",
      "impact": "Write-after-free leading to potential memory corruption and incorrect decoding.",
      "attack_vector": "The vulnerability is triggered while processing a specially crafted OpenFlow message containing a RAW_ENCAP action.",
      "attacker_capabilities": "An attacker needs the ability to send OpenFlow messages to the vulnerable Open vSwitch instance."
    },
    "references": [
      "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=27851",
      "https://github.com/openvswitch/ovs/commit/8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
      "https://github.com/openvswitch/ovs/commit/38744b1bcb022c611712527f039722115300f58f",
      "https://github.com/openvswitch/ovs/commit/9926637a80d0d243dbf9c49761046895e9d1a8e2",
       "https://github.com/openvswitch/ovs/commit/6d67310f4d2524b466b98f05ebccc1add1e8cf35",
      "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/openvswitch/OSV-2020-2197.yaml",
      "https://github.com/openvswitch/ovs/commit/65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
        "https://github.com/openvswitch/ovs/commit/77cccc74deede443e8b9102299efc869a52b65b2"
    ],
        "patches": [
          "https://github.com/openvswitch/ovs/commit/8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
           "https://github.com/openvswitch/ovs/commit/38744b1bcb022c611712527f039722115300f58f",
          "https://github.com/openvswitch/ovs/commit/9926637a80d0d243dbf9c49761046895e9d1a8e2",
            "https://github.com/openvswitch/ovs/commit/6d67310f4d2524b466b98f05ebccc1add1e8cf35",
            "https://github.com/openvswitch/ovs/commit/65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
            "https://github.com/openvswitch/ovs/commit/77cccc74deede443e8b9102299efc869a52b65b2"
        ],
    "gentoo_advisory": {
      "glsa_id": "202311-16",
      "affected_versions": "< 2.17.6",
      "unaffected_versions": ">= 2.17.6",
       "severity": "low",
      "exploitable": "remote",
        "references": [
            "https://nvd.nist.gov/vuln/detail/CVE-2020-27827",
            "https://nvd.nist.gov/vuln/detail/CVE-2020-35498",
            "https://nvd.nist.gov/vuln/detail/CVE-2021-3905",
            "https://nvd.nist.gov/vuln/detail/CVE-2021-36980",
            "https://nvd.nist.gov/vuln/detail/CVE-2022-4337",
            "https://nvd.nist.gov/vuln/detail/CVE-2022-4338",
            "https://nvd.nist.gov/vuln/detail/CVE-2023-1668",
            "https://bugs.gentoo.org/show_bug.cgi?id=765346",
            "https://bugs.gentoo.org/show_bug.cgi?id=769995",
            "https://bugs.gentoo.org/show_bug.cgi?id=803107",
            "https://bugs.gentoo.org/show_bug.cgi?id=887561"
           ]
    }
  }
}
```