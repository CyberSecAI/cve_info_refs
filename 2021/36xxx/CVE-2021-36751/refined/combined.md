=== Content from pretalx.c3voc.de_e6bb35c5_20250114_200731.html ===

![Remote Rhein Ruhr Stage](/media/rc3-2021-r3s/img/R3S_event_header_4096_rrAicmH.png)

# [The event’s logo](/rc3-2021-r3s/schedule/%20%20%20%20)

[Schedule](/rc3-2021-r3s/schedule/)
[Sessions](/rc3-2021-r3s/talk/)
[Speakers](/rc3-2021-r3s/speaker/)

[English](/rc3-2021-r3s/locale/set?locale=en&next=/rc3-2021-r3s/talk/QMYGR3/%3F)
[Deutsch](/rc3-2021-r3s/locale/set?locale=de&next=/rc3-2021-r3s/talk/QMYGR3/%3F)
•

[login](/rc3-2021-r3s/login/)

### Practical bruteforce of military grade AES-1024 [.ical](/rc3-2021-r3s/talk/QMYGR3.ics) 2021-12-28 16:30–17:50, r3s - Monheim/Rhein **Language:** English

Sony, SanDisk, and Lexar provide encryption software for their USB keys, hard drives, and other storage products. The software is already present when buying a new product and used to keep data on the storage safe. This solution is developed by a 3rd party called ENCSecurity. The security claims of this solution were very strong *i.e.* "Ultimate encryption using 1024 bit AES keys Military grade". Our analysis of the DataVault software revealed three serious flaws impacting the security of the DataVault solution. This presentation is a look the flaws we identified along with our process for discovery and how the vulnerabilities were addressed.

---

The DataVault solution is a stand-alone application used by default as an encryption solution for many Sony, SanDisk, and Lexar products and as well used by some libraries to offer data security. This solution was not analyzed before, and the strong security claims were not assessed to match the reality. This presentation gives background details of the analysis and the context which brought us to perform the analysis. The method for reverse engineering and inspecting the DataVault solution will be presented. It turned out that the key derivation function was PBKDF2 using 1000 iteration of MD5 to derive the encryption key. The salt used to derive the keys is constant and hardcoded in all the solutions and all the vendors. This makes it easier for an attacker to guess the user password of a vault using time/memory tradeoff attack techniques such as rainbow tables and to re-use the tables to retrieve passwords for all users using the software. The implementation itself was incorrect and even with a randomly generated unique salt, it would be effortless to recover the password of a user. Other flaws of the key derivation function will be discussed and compared with nowadays good practices.

The data encryption method was also found to be malleable, allowing malicious modifications of files in a vault without any detection. No data integrity mechanism was set up. The settings of the full version of the software allows choosing between 4 different levels of security, namely AES-128, 256, 512 and 1024 bits. The encryption method has been reversed and is a CTR like construction based on AES-128 using a single key. Multiple iterations of encryptions are chained with the keys obtained by the key derivation function used as IVs. However, it turned out after the analysis that all these modes offer only a security level of 128-bit.

A plugin in John the ripper software to allow everyone to "practically brute force military grade AES-1024" will be released at the time of the presentation.

We have a continuous, welcomed, and constructive collaboration with the ENCSecurity company. During this presentation, we will explain the coordinated disclosure process, which was difficult since it impacted several vendors and some deployed libraries. The solution which was provided for the correction will be presented and compared to the best practice standards along with a discussion of the process of selecting the specific improvements.

See also:
[slides
(3.3 MB)](https://pretalx.c3voc.de/media/rc3-2021-r3s/submissions/QMYGR3/resources/Practical_bruteforce_of_AES-1024_military_grad_eMKqvfW.pdf)

[![The speaker’s profile picture](/rc3-2021-r3s/speaker/avatar.svg)](/rc3-2021-r3s/speaker/3WDXD8/)

[Sylvain Pelissier](/rc3-2021-r3s/speaker/3WDXD8/)

Cryptography expert in the research team at Kudelski Security. His favorite topics are Cryptography, Hardware attacks and vulnerability research in general. He worked on security of Cryptography algorithms implementations on different platforms as well as on critical code security audits. He like playing and organizing CTFs.

[![The speaker’s profile picture](/rc3-2021-r3s/speaker/avatar.svg)](/rc3-2021-r3s/speaker/YRWM3H/)

[Boi Sletterink](/rc3-2021-r3s/speaker/YRWM3H/)

I'm a defence-oriented IT security freelancer with a keen interest in hacking, cryptography and salsa dancing. My interest in cryptography started when I broke ARJ encryption to play the game my brother tried to keep for himself. With a broad set of IT skills and interests, my work ranges from teaching CISSP preparation courses to development to interim CTO roles.

powered by [pretalx](https://pretalx.com)
·
Contact us
·
[Imprint](https://r3s.nrw/impressum/)


