=== Content from discuss.hashicorp.com_9bac8f9e_20250114_234900.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-20 - Vault’s Integrated Storage Backend Database File May Have Excessively Broad Permissions](/t/hcsec-2021-20-vault-s-integrated-storage-backend-database-file-may-have-excessively-broad-permissions/28168)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

August 12, 2021, 10:22pm

1

**Bulletin ID:** HCSEC-2021-20

**Affected Products / Versions:** Vault and Vault Enterprise 1.4.0 up to 1.7.3; fixed in 1.8.0.

**Publication Date:** August 12, 2021

**Summary**

When initializing Vault’s Integrated Storage backend, excessively broad filesystem permissions may be set for the underlying Bolt database used by Vault’s Raft implementation. This vulnerability, CVE-2021-38553, was fixed in Vault 1.8.0.

**Background**

Vault’s [Integrated Storage](https://www.vaultproject.io/docs/concepts/integrated-storage) was introduced in Vault 1.4.0, providing a built-in highly available storage backend. As [documented](https://www.vaultproject.io/docs/internals/integrated-storage), the Integrated Storage backend uses the Raft consensus protocol, which uses BoltDB as an underlying datastore.

**Details**

During initialization of the Integrated Storage backend, Vault creates a database file on disk with potentially excessive filesystem permissions, though these vary depending on the operating system’s umask values. This `vault.db` file is written to the location configured by the [`path`](https://www.vaultproject.io/docs/configuration/storage/raft#path) parameter in Vault’s Raft configuration.

Most Vault environments are unlikely to have significant exposure as a result of this issue:

* Only Vault clusters utilizing Integrated Storage are affected.
* The default system umask on each Vault node will likely cause a less-broad permission to be applied.
* In the Vault [security model](https://www.vaultproject.io/docs/internals/security#external-threat-overview), storage backends are considered untrusted by design. Barrier encryption is applied before data is written to Vault storage backends including Integrated Storage, guarding against unauthorized access or tampering of data. However, the database file could be deleted, potentially resulting in denial of service.
* Vault’s [production hardening guide](https://learn.hashicorp.com/tutorials/vault/production-hardening) recommends a single tenancy model, which reduces the likelihood of another process or user manipulating the host’s filesystem.

**Remediation**

Customers using Vault’s Integrated Storage should evaluate the risk associated with this issue in conjunction with the mitigating factors noted above, and consider reviewing and possibly updating filesystem permissions for the `vault.db` file across their Vault nodes.

New deployments of Vault or Vault Enterprise 1.8.0 or newer will create the Integrated Storage database with more restrictive filesystem permissions by default.

**Acknowledgement**

This issue was identified by the Vault engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

September 2, 2021, 3:09pm

2

**Update Regarding Risk Scoring**

The CVSS score originally published to the NIST [NVD](https://nvd.nist.gov/) for this issue was 9.8 (Critical), with a vector string [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

In contrast, HashiCorp’s internal CVSS scoring was 4.4 (Medium), with a vector string [CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H).

Points for consideration regarding this score:

* To exploit this vulnerability, the attacker requires code execution on the host running the Vault process. For this reason, Attack Vector should be Local, and Privileges Required should be High.
* Storage Backends in Vault are [considered untrusted by design](https://www.vaultproject.io/docs/internals/security#external-threat-overview): Vault’s Barrier Encryption uses authenticated encryption for any data persisted to storage backends, including the Bolt database in question. As such, impact to Confidentiality and Integrity should be None (impact to Availability remains High).

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-12 - Vault’s Microsoft SQL Database Storage Backend Vulnerable to SQL Injection Via Configuration File](https://discuss.hashicorp.com/t/hcsec-2023-12-vault-s-microsoft-sql-database-storage-backend-vulnerable-to-sql-injection-via-configuration-file/52080)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7336 | March 30, 2023 |
| [HCSEC-2021-33 - Vault’s KV Secrets Engine With Integrated Storage Exposed to Authenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7061 | December 14, 2021 |
| [HCSEC-2024-26 - Vault Vulnerable to Denial of Service Through Memory Exhaustion When Processing Raft Cluster Join Requests](https://discuss.hashicorp.com/t/hcsec-2024-26-vault-vulnerable-to-denial-of-service-through-memory-exhaustion-when-processing-raft-cluster-join-requests/71047)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 1009 | October 31, 2024 |
| [HCSEC-2021-10 - Vault’s Cassandra Integrations Did Not Validate TLS Certificates](https://discuss.hashicorp.com/t/hcsec-2021-10-vault-s-cassandra-integrations-did-not-validate-tls-certificates/23463)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7481 | April 21, 2021 |
| [HCSEC-2022-15 - Vault Enterprise Does Not Verify Existing Voter Status When Joining An Integrated Storage HA Node](https://discuss.hashicorp.com/t/hcsec-2022-15-vault-enterprise-does-not-verify-existing-voter-status-when-joining-an-integrated-storage-ha-node/42420)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 8249 | July 26, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from security.gentoo.org_58090d82_20250114_234902.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# HashiCorp Vault: Multiple Vulnerabilities — GLSA **202207-01**

Multiple vulnerabilities have been discovered in HashiCorp Vault, the worst of which could result in denial of service.

### Affected packages

| Package | **app-admin/vault** on all architectures |
| --- | --- |
| Affected versions | < **1.10.3** |
| Unaffected versions | >= **1.10.3** |

### Background

HashiCorp Vault is a tool for managing secrets.

### Description

Multiple vulnerabilities have been discovered in HashiCorp Vault. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All HashiCorp Vault users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/vault-1.10.3"

```
### References

* [CVE-2020-25594](https://nvd.nist.gov/vuln/detail/CVE-2020-25594)
* [CVE-2021-27668](https://nvd.nist.gov/vuln/detail/CVE-2021-27668)
* [CVE-2021-3024](https://nvd.nist.gov/vuln/detail/CVE-2021-3024)
* [CVE-2021-3282](https://nvd.nist.gov/vuln/detail/CVE-2021-3282)
* [CVE-2021-32923](https://nvd.nist.gov/vuln/detail/CVE-2021-32923)
* [CVE-2021-37219](https://nvd.nist.gov/vuln/detail/CVE-2021-37219)
* [CVE-2021-38553](https://nvd.nist.gov/vuln/detail/CVE-2021-38553)
* [CVE-2021-38554](https://nvd.nist.gov/vuln/detail/CVE-2021-38554)
* [CVE-2021-41802](https://nvd.nist.gov/vuln/detail/CVE-2021-41802)
* [CVE-2021-43998](https://nvd.nist.gov/vuln/detail/CVE-2021-43998)
* [CVE-2021-45042](https://nvd.nist.gov/vuln/detail/CVE-2021-45042)
* [CVE-2022-25243](https://nvd.nist.gov/vuln/detail/CVE-2022-25243)
* [CVE-2022-30689](https://nvd.nist.gov/vuln/detail/CVE-2022-30689)

**Release date**

July 29, 2022

**Latest revision**

July 29, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [768312](https://bugs.gentoo.org/show_bug.cgi?id=768312)
* [797244](https://bugs.gentoo.org/show_bug.cgi?id=797244)
* [808093](https://bugs.gentoo.org/show_bug.cgi?id=808093)
* [817269](https://bugs.gentoo.org/show_bug.cgi?id=817269)
* [827945](https://bugs.gentoo.org/show_bug.cgi?id=827945)
* [829493](https://bugs.gentoo.org/show_bug.cgi?id=829493)
* [835070](https://bugs.gentoo.org/show_bug.cgi?id=835070)
* [845405](https://bugs.gentoo.org/show_bug.cgi?id=845405)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


