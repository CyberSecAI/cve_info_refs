```
{
  "cve": "CVE-2021-38162",
  "description": "The vulnerability is an HTTP desynchronization vulnerability, specifically of the TE.CL type, present in SAP Web Dispatcher when the parameter `wdisp/HTTP/use_pool_for_new_conn` is enabled. When an attacker sends both 'Content-Length' (CL) and 'Transfer-Encoding' (TE) headers in the same request, the SAP Web Dispatcher processes the TE header, treating the body as chunked, while the backend SAP system's ICM service processes only the CL header. This discrepancy allows the attacker to inject a malicious request that will be processed as a new request, leading to several impacts.",
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from the SAP Web Dispatcher and the backend SAP system's ICM service processing HTTP headers ('Content-Length' and 'Transfer-Encoding') differently, leading to a desynchronization.",
    "weaknesses": [
      "HTTP Request Smuggling",
       "HTTP Desync",
       "CWE-444"
     ],
    "impact": [
      "Denial of Service by injecting an invalid prefix request",
      "Malicious requests with victim's credentials/information",
      "User data theft",
      "Cross-Site Scripting (XSS) via reflected content injection",
      "Web Cache Poisoning",
      "Session hijacking via Open Redirect"
    ],
    "attack_vectors": [
      "Sending a crafted HTTP request with both 'Content-Length' and 'Transfer-Encoding' headers",
      "Injecting a request as a prefix into a victim's request"
    ],
    "attacker_capabilities": "The attacker needs to send a crafted HTTP request to the SAP Web Dispatcher. No prior authentication or elevated privileges are required for the initial attack."
  }
}
```