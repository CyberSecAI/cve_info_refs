=== Content from www.mozilla.org_4cca222d_20250115_102910.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-43

## Security Vulnerabilities fixed in Firefox 93

Announced
October 5, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 93

#### [#CVE-2021-38496: Use-after-free in MessageTask](#CVE-2021-38496)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

During operations on MessageTasks, a task may have been removed while it was still scheduled, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1725335](https://bugzilla.mozilla.org/show_bug.cgi?id=1725335)

#### [#CVE-2021-38497: Validation message could have been overlaid on another origin](#CVE-2021-38497)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Through use of `reportValidity()` and `window.open()`, a plain-text validation message could have been overlaid on another origin, leading to possible user confusion and spoofing attacks.

##### References

* [Bug 1726621](https://bugzilla.mozilla.org/show_bug.cgi?id=1726621)

#### [#CVE-2021-38498: Use-after-free of nsLanguageAtomService object](#CVE-2021-38498)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

During process shutdown, a document could have caused a use-after-free of a languages service object, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1729642](https://bugzilla.mozilla.org/show_bug.cgi?id=1729642)

#### [#CVE-2021-32810: Data race in crossbeam-deque](#CVE-2021-32810)

Reporter
Maor Kleinberger
Impact
moderate
##### Description

In the crossbeam crate, one or more tasks in the worker queue could have been be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this could have caused a double free and a memory leak.

##### References

* [Bug 1729813](https://bugzilla.mozilla.org/show_bug.cgi?id=1729813)
* [Bug https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw](https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw)

#### [#CVE-2021-38500: Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](#CVE-2021-38500)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Andreas Pehrson and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1725854%2C1728321)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38501: Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](#CVE-2021-38501)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Kevin Brosnan, Mihai Alexandru Michis, and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685354%2C1715755%2C1723176)

#### [#CVE-2021-38499: Memory safety bugs fixed in Firefox 93](#CVE-2021-38499)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Julien Cristau, Christian Holler reported memory safety bugs present in Firefox 92. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1723170%2C1725356%2C1727364)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_f7595193_20250115_102909.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1726621)
* [XML](/show_bug.cgi?ctype=xml&id=1726621)

Closed
[Bug 1726621](/show_bug.cgi?id=1726621)
(CVE-2021-38497)

Opened 3 years ago
Closed 3 years ago

# Show form validationMessage on any website with window.open

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Show form validationMessage on any website with window.open

## Categories

### (Toolkit :: UI Widgets, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=UI%20Widgets#UI%20Widgets)

UI Widgets
▾

Toolkit :: UI Widgets
Shared UI Widgets: XUL Widgets, HTML Widgets, and Acorn (Design System) Widgets.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=UI%20Widgets&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=UI%20Widgets&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=UI%20Widgets)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 91

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

94 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox-esr91 | [93+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=93%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox91 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=wontfix) |
| firefox92 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix) |
| firefox93 | [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=verified) |
| firefox94 | [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | unaffected |
| firefox-esr91 | 93+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox91 |  | wontfix |
| firefox92 |  | wontfix |
| firefox93 | + | verified |
| firefox94 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8407f1551cb10122bad1fc181e6177ac?d=mm&size=40)  [mstriemer](/user_profile?user_id=492360)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1724668](/show_bug.cgi?id=1724668 "RESOLVED FIXED - pocket dialog persists after new url entered")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1731665](/show_bug.cgi?id=1731665 "RESOLVED FIXED - Land tests for hiding form validationMessage in response to window.open")

Dependency [tree](/showdependencytree.cgi?id=1726621&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1726621)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1684792](/show_bug.cgi?id=1684792 "RESOLVED FIXED - Form validation popups appear at a wrong place")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2021-38508](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), [CVE-2021-38509](/show_bug.cgi?id=1718571 "VERIFIED FIXED - Javascript dialog remains active in window after redirect")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main93+][adv-esr91.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-38497

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main93+][adv-esr91.2+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3451241_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [formvalidity-windowopen.html](/attachment.cgi?id=9237103)  [3 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.62 KB, text/html |  | [Details](/attachment.cgi?id=9237103&action=edit) |
| --- | --- | --- |
| [Firefox - Spoof validationMessage with Window Open.mp4](/attachment.cgi?id=9237105)  [3 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   545.60 KB, video/mp4 |  | [Details](/attachment.cgi?id=9237105&action=edit) |
| [Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin](/attachment.cgi?id=9239043)  [3 years ago](#c11)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c20 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c22 "3 years ago") | [Details](/attachment.cgi?id=9239043&action=edit) | [Review](/attachment.cgi?id=9239043) |
| [WIP: Bug 1726621 - tests](/attachment.cgi?id=9239044)  [3 years ago](#c12)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9239044&action=edit) | [Review](/attachment.cgi?id=9239044) |
| [advisory.txt](/attachment.cgi?id=9243765)  [3 years ago](#c25)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   293 bytes, text/plain |  | [Details](/attachment.cgi?id=9243765&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1726621#c0)• 3 years ago |
|  | |

Attached file
[formvalidity-windowopen.html](attachment.cgi?id=9237103)
— [Details](attachment.cgi?id=9237103&action=edit)

After call `reportValidity()` then open target URL with `window.open()` the [reportValidity validationMessage](https://developer.mozilla.org/en-US/docs/Web/API/HTMLSelectElement/setCustomValidity) will appear on the target website, it also looks to be called from the target website which is more convincing.

As the validationMessage appear on trusted website, users are more likely to trust to follow the message instructions.

Mozregression show it is regression of [Bug 1684792, open form validation popup anchored at screen coordinate as datetime picker and select do so that it is positioned correctly in out of process iframes](https://bugzilla.mozilla.org/show_bug.cgi?id=1684792)

## Affected version:

* Firefox Nightly 93.0a1 (2021-08-19) (64-bit)
* Firefox 91.0.1 (64-bit)

## Unaffected version:

* Firefox ESR 78.13.0esr (64-bit)

## Steps to reproduce:

1. Visit attached formvalidity-windowopen.html
2. Click "Start Spoof validationMessage" button
3. validationMessage will appear on Twitter website
4. If you're logged in, then press Enter to like the tweet
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1726621#c1)• 3 years ago |
|  | |

Attached video
[Firefox - Spoof validationMessage with Window Open.mp4](attachment.cgi?id=9237105)
— [Details](attachment.cgi?id=9237105&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1726621#c2)• 3 years ago |
|  | |

Related to [bug 1366818](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") a little, but the fixes probably need to be orthogonal.

Neil, I suspect this is because we used the `browser.popupAnchor` before, and don't anymore, so now tabswitches that destroy the anchor's frame no longer cause the popup to hide. Is that plausible?

I suspect we should make the form validation popup `tabspecific`, or perhaps even `locationspecific`, once [bug 1724668](/show_bug.cgi?id=1724668 "RESOLVED FIXED - pocket dialog persists after new url entered") lands...

Type: task → defect
[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected)
[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected)
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Component: Security → XUL WidgetsFlags: needinfo?(enndeakin)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)OS: Unspecified → AllProduct: Firefox → ToolkitHardware: Unspecified → DesktopSee Also: → [CVE-2021-38508](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")Version: unspecified → Firefox 91

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1726621#c3)• 3 years ago |
|  | |

Oh, and thank you, Irvan, for the detailed analysis of what versions are affected and finding a regression window! Super helpful. If you don't mind sharing, I'm curious how you found this particular issue, and particularly if it was somewhat chance, and then you realized later it didn't work in esr, or if you looked at commits or other patterns. :-)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1726621#c4)• 3 years ago |
|  | |

(In reply to :Gijs (out; back Aug 31st; he/him) from [comment #3](/show_bug.cgi?id=1726621#c3 "VERIFIED FIXED - Show form validationMessage on any website with window.open"))

> Oh, and thank you, Irvan, for the detailed analysis of what versions are affected and finding a regression window! Super helpful.

Thanks Gijs for the update, by using mozregression I can easily identify the regression window, it's a very useful tool to find out what causing the bugs.

> If you don't mind sharing, I'm curious how you found this particular issue, and particularly if it was somewhat chance, and then you realized later it didn't work in esr, or if you looked at commits or other patterns. :-)

I was playing with HTML5 API especially [HTMLFormElement.reportValidity()](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/reportValidity) then after the XUL dialog appears, I then press `Ctrl + W` to close the tab, surprisingly the XUL dialog still appear on current tab (reported as [bug 1713259](/show_bug.cgi?id=1713259 "RESOLVED FIXED - Show form reportValidity validationMessage on any website")).

Then after a few month I revisited the testcase, I recently realize I able to switch tab with `Alt+2`, after switch tab with the keyboard shortcut surprisingly the XUL dialog is also still appear on target website (reported as this bug) =).

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a416346_580382)• 3 years ago |

[status-firefox91](/buglist.cgi?f1=cf_status_firefox91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox91&o1=equals&v1=wontfix)

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1726621#c5)• 3 years ago |
|  | |

> Neil, I suspect this is because we used the `browser.popupAnchor` before, and don't anymore, so now tabswitches that destroy the anchor's frame no longer cause the popup to hide. Is that plausible?

The popup should be anchored by rectangle passed from the child process. There isn't any mechanism that hides it in the popup code.

But it looks like there might be some browser-piece that does some of this, but I don't have any extra knowledge of that than you would.

Flags: needinfo?(enndeakin)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a441783_75935)• 3 years ago |

[status-firefox92](/buglist.cgi?f1=cf_status_firefox92&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox92&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1726621#c6)• 3 years ago |
|  | |

Possible dupe of [bug 1718571](/show_bug.cgi?id=1718571 "VERIFIED FIXED - Javascript dialog remains active in window after redirect")? That blames blames a different regressor: [bug 1680637](/show_bug.cgi?id=1680637 "RESOLVED FIXED - Implement tabmodal alert/confirm/prompt dialogs to use SubDialog instead of TabModalPrompt")

Flags: needinfo?(enndeakin)Regressed by: [1684792](/show_bug.cgi?id=1684792 "RESOLVED FIXED - Form validation popups appear at a wrong place")See Also: → [CVE-2021-38509](/show_bug.cgi?id=1718571 "VERIFIED FIXED - Javascript dialog remains active in window after redirect")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a527444_546015)• 3 years ago |

Has Regression Range: --- → yes

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1726621#c7)• 3 years ago |
|  | |

[Tracking Requested - why for this release]:

You don't get a lot of control to pull off spoofing, but the result is so unusual that it's easy to believe at least some people being suckered in. There's no interaction there so the harm is fully down to what your text can convince someone to do.

[tracking-firefox93](/buglist.cgi?f1=cf_tracking_firefox93&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%3F)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1726621#c8)• 3 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #6](/show_bug.cgi?id=1726621#c6 "VERIFIED FIXED - Show form validationMessage on any website with window.open"))

> Possible dupe of [bug 1718571](/show_bug.cgi?id=1718571 "VERIFIED FIXED - Javascript dialog remains active in window after redirect")? That blames blames a different regressor: [bug 1680637](/show_bug.cgi?id=1680637 "RESOLVED FIXED - Implement tabmodal alert/confirm/prompt dialogs to use SubDialog instead of TabModalPrompt")

I can't see that bug.

Flags: needinfo?(enndeakin)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1726621#c9)• 3 years ago |
|  | |

I've CC'ed you.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a563678_580382)• 3 years ago |

[tracking-firefox93](/buglist.cgi?f1=cf_tracking_firefox93&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox93&o1=equals&v1=%2B)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1726621#c10)• 3 years ago |
|  | |

(In reply to Neil Deakin from [comment #5](/show_bug.cgi?id=1726621#c5 "VERIFIED FIXED - Show form validationMessage on any website with window.open"))

> > Neil, I suspect this is because we used the `browser.popupAnchor` before, and don't anymore, so now tabswitches that destroy the anchor's frame no longer cause the popup to hide. Is that plausible?
>
> The popup should be anchored by rectangle passed from the child process. There isn't any mechanism that hides it in the popup code.

Sure, but before [bug 1684792](/show_bug.cgi?id=1684792 "RESOLVED FIXED - Form validation popups appear at a wrong place") we anchored it to a specific DOM node and its frame, rather than a rect directly. When we anchor a popup to a DOM node's frame, doesn't destruction of the frame (because the node gets hidden) mean the popup gets hidden, like moving the frame means the popup moves? Like e.g. [bug 1725151](/show_bug.cgi?id=1725151 "RESOLVED WORKSFORME - OSX Big Sur: Extension widgets close and stuck when hovering top bar").

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a1131071_159069)• 3 years ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1726621#c11)• 3 years ago |
|  | |

Attached file
[Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin](attachment.cgi?id=9239043)
— [Details](attachment.cgi?id=9239043&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1726621#c12)• 3 years ago |
|  | |

Attached file
[WIP: Bug 1726621 - tests](attachment.cgi?id=9239044) (obsolete)
— [Details](attachment.cgi?id=9239044&action=edit)

Depends on D124268

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a2765436_159069)• 3 years ago |

Blocks: [1731665](/show_bug.cgi?id=1731665 "RESOLVED FIXED - Land tests for hiding form validationMessage in response to window.open")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1726621#c13)• 3 years ago |
|  | |

Comment on [attachment 9239044](/attachment.cgi?id=9239044 "WIP: Bug 1726621 - tests") [[details]](/attachment.cgi?id=9239044&action=edit "WIP: Bug 1726621 - tests")

WIP: [Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") - tests

Revision D124269 was moved to [bug 1731665](/show_bug.cgi?id=1731665 "RESOLVED FIXED - Land tests for hiding form validationMessage in response to window.open"). Setting [attachment 9239044](/attachment.cgi?id=9239044 "WIP: Bug 1726621 - tests") [[details]](/attachment.cgi?id=9239044&action=edit "WIP: Bug 1726621 - tests") to obsolete.

[Attachment #9239044](/attachment.cgi?id=9239044&action=edit "WIP: Bug 1726621 - tests") -
Attachment is obsolete: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1726621#c14)• 3 years ago |
|  | |

Comment on [attachment 9239043](/attachment.cgi?id=9239043 "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") [[details]](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin")

[Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-moderate security issue
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: See [comment 0](/show_bug.cgi?id=1726621#c0 "VERIFIED FIXED - Show form validationMessage on any website with window.open")
* **List of other uplifts needed**: n/a
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Relatively straightforward changes to how the popup validation code works.
* **String changes made/needed**: N/A
[Attachment #9239043](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") -
Flags: approval-mozilla-beta?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a2765609_159069)• 3 years ago |

Flags: qe-verify+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1726621#c15)• 3 years ago |
|  | |

Comment on [attachment 9239043](/attachment.cgi?id=9239043 "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") [[details]](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin")

[Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate issue early in the ESR lifetime
* **User impact if declined**: see above
* **Fix Landed on Version**: 94, uplift to 93
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Relatively straightforward change.

Note: ESR form doesn't have a "also needs uplift" field, but uplifting this to 91esr requires uplifting <https://bugzilla.mozilla.org/show_bug.cgi?id=1724668> too. I think the same risk assessment applies to that patch, but it got marked `wontfix` for esr91...

* **String or UUID changes made by this patch**: Nope
[Attachment #9239043](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a2769307_75935)• 3 years ago |

Depends on: [1724668](/show_bug.cgi?id=1724668 "RESOLVED FIXED - pocket dialog persists after new url entered")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1726621#c16)• 3 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/724917f8288f0f3ed6d752886f5f806b10750d5b>

Backed out for failing browser-chrome's toolkit/components/passwordmgr/test/browser/browser\_doorhanger\_remembering.js:

<https://hg.mozilla.org/integration/autoland/rev/c0c56312270bf844146e2de5301fc200ae1e1735>

Push which ran failed tasks: <https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=1fc975f877678b2dee224c9d729357c5fca3395d&selectedTaskRun=WlfLgjpjR62jQO0YPdKCNw.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=352154709&repo=autoland>

```
[task 2021-09-20T21:29:52.083Z] 21:29:52     INFO - TEST-PASS | toolkit/components/passwordmgr/test/browser/browser_doorhanger_remembering.js | Triggering menuitem # 0 -
[task 2021-09-20T21:29:52.084Z] 21:29:52     INFO - waiting for verifyConfirmationHint
[task 2021-09-20T21:29:52.084Z] 21:29:52     INFO - Buffered messages logged at 21:25:36
[task 2021-09-20T21:29:52.085Z] 21:29:52     INFO - Console message: [JavaScript Warning: "telemetry.state_file_read_errors - Unknown scalar."]
[task 2021-09-20T21:29:52.086Z] 21:29:52     INFO - Console message: [JavaScript Warning: "telemetry.generated_new_client_id - Unknown scalar."]
[task 2021-09-20T21:29:52.087Z] 21:29:52     INFO - Buffered messages logged at 21:26:51
[task 2021-09-20T21:29:52.089Z] 21:29:52     INFO - Longer timeout required, waiting longer...  Remaining timeouts: 1
[task 2021-09-20T21:29:52.090Z] 21:29:52     INFO - Buffered messages logged at 21:27:36
[task 2021-09-20T21:29:52.093Z] 21:29:52     INFO - Console message: [JavaScript Error: "1632173256526	addons.xpi	ERROR	System addon update list error Error: got node name: html, expected: updates" {file: "resource://gre/modules/Log.jsm" line: 723}]
[task 2021-09-20T21:29:52.094Z] 21:29:52     INFO - append@resource://gre/modules/Log.jsm:723:12
[task 2021-09-20T21:29:52.094Z] 21:29:52     INFO - log@resource://gre/modules/Log.jsm:379:16
[task 2021-09-20T21:29:52.095Z] 21:29:52     INFO - error@resource://gre/modules/Log.jsm:387:10
[task 2021-09-20T21:29:52.095Z] 21:29:52     INFO - updateSystemAddons/res<@resource://gre/modules/addons/XPIInstall.jsm:4042:25
[task 2021-09-20T21:29:52.095Z] 21:29:52     INFO -
[task 2021-09-20T21:29:52.096Z] 21:29:52     INFO - Buffered messages finished
[task 2021-09-20T21:29:52.097Z] 21:29:52     INFO - TEST-UNEXPECTED-FAIL | toolkit/components/passwordmgr/test/browser/browser_doorhanger_remembering.js | Test timed out -

```
Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1726621#c17)• 3 years ago |
|  | |

(In reply to Sebastian Hengst [:aryx] (needinfo on intermittent or backout) from [comment #16](/show_bug.cgi?id=1726621#c16 "VERIFIED FIXED - Show form validationMessage on any website with window.open"))

> Landed: <https://hg.mozilla.org/integration/autoland/rev/724917f8288f0f3ed6d752886f5f806b10750d5b>
>
> Backed out for failing browser-chrome's toolkit/components/passwordmgr/test/browser/browser\_doorhanger\_remembering.js:
>
> <https://hg.mozilla.org/integration/autoland/rev/c0c56312270bf844146e2de5301fc200ae1e1735>
>
> Push which ran failed tasks: <https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=1fc975f877678b2dee224c9d729357c5fca3395d&selectedTaskRun=WlfLgjpjR62jQO0YPdKCNw.0>
>
> Failure log: <https://treeherder.mozilla.org/logviewer?job_id=352154709&repo=autoland>
>
> ```
> [task 2021-09-20T21:29:52.083Z] 21:29:52     INFO - TEST-PASS | toolkit/components/passwordmgr/test/browser/browser_doorhanger_remembering.js | Triggering menuitem # 0 -
> [task 2021-09-20T21:29:52.084Z] 21:29:52     INFO - waiting for verifyConfirmationHint
> [task 2021-09-20T21:29:52.084Z] 21:29:52     INFO - Buffered messages logged at 21:25:36
> [task 2021-09-20T21:29:52.085Z] 21:29:52     INFO - Console message: [JavaScript Warning: "telemetry.state_file_read_errors - Unknown scalar."]
> [task 2021-09-20T21:29:52.086Z] 21:29:52     INFO - Console message: [JavaScript Warning: "telemetry.generated_new_client_id - Unknown scalar."]
> [task 2021-09-20T21:29:52.087Z] 21:29:52     INFO - Buffered messages logged at 21:26:51
> [task 2021-09-20T21:29:52.089Z] 21:29:52     INFO - Longer timeout required, waiting longer...  Remaining timeouts: 1
> [task 2021-09-20T21:29:52.090Z] 21:29:52     INFO - Buffered messages logged at 21:27:36
> [task 2021-09-20T21:29:52.093Z] 21:29:52     INFO - Console message: [JavaScript Error: "1632173256526	addons.xpi	ERROR	System addon update list error Error: got node name: html, expected: updates" {file: "resource://gre/modules/Log.jsm" line: 723}]
> [task 2021-09-20T21:29:52.094Z] 21:29:52     INFO - append@resource://gre/modules/Log.jsm:723:12
> [task 2021-09-20T21:29:52.094Z] 21:29:52     INFO - log@resource://gre/modules/Log.jsm:379:16
> [task 2021-09-20T21:29:52.095Z] 21:29:52     INFO - error@resource://gre/modules/Log.jsm:387:10
> [task 2021-09-20T21:29:52.095Z] 21:29:52     INFO - updateSystemAddons/res<@resource://gre/modules/addons/XPIInstall.jsm:4042:25
> [task 2021-09-20T21:29:52.095Z] 21:29:52     INFO -
> [task 2021-09-20T21:29:52.096Z] 21:29:52     INFO - Buffered messages finished
> [task 2021-09-20T21:29:52.097Z] 21:29:52     INFO - TEST-UNEXPECTED-FAIL | toolkit/components/passwordmgr/test/browser/browser_doorhanger_remembering.js | Test timed out -
>
> ```

Sigh, this test is racy and expects that it can wait for a confirmation hint even if it destroys the tab that created the form submit password saved doorhanger. It wins the race pre-patch, but loses post-patch because the code for `tabspecific` and `locationspecific` attributes became stricter about what it considers open/closed panels when switching tabs.

I'll fix the test and trypush to be safe, I guess, now that this has hit autoland anyway...

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1726621#c18)• 3 years ago |
|  | |

Try was green-ish: <https://treeherder.mozilla.org/jobs?repo=try&revision=3ee2e379719babf58b991f2029c5d9b0d2da5c48&selectedTaskRun=SIqPl6EbQNud9SQRTRT_ag.0>

so relanding with the test fix: <https://hg.mozilla.org/integration/autoland/rev/ccb6051234799b83d138e2b5b679381152460327>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1726621#c19)• 3 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/ccb605123479>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 94 Branch

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1726621#c20)• 3 years ago |
|  | |

Comment on [attachment 9239043](/attachment.cgi?id=9239043 "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") [[details]](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin")

[Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin

Approved for our last 93 beta, thanks.

[Attachment #9239043](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1726621#c21)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/d1c2bb0f625f>

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3004469_551058)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1726621#c22)• 3 years ago |
|  | |

Comment on [attachment 9239043](/attachment.cgi?id=9239043 "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") [[details]](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin")

[Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin

Approved for 91.2esr.

[Attachment #9239043](/attachment.cgi?id=9239043&action=edit "Bug 1726621 - ensure form validation popup always hides on tabswitches, navigations, etc., r?NeilDeakin") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1726621#c23)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/611073b6e2f0>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)
[tracking-firefox94](/buglist.cgi?f1=cf_tracking_firefox94&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [93+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=93%2B)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3072135_458186)• 3 years ago |

QA Whiteboard: [qa-triaged] → [qa-triaged][post-critsmash-triage]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1726621#c24)• 3 years ago |
|  | |

Reproduced the issue reported in [comment 0](/show_bug.cgi?id=1726621#c0 "VERIFIED FIXED - Show form validationMessage on any website with window.open") using old Nightly build 93.0a1 (2021-08-19). Verified that using latest Nightly 94.0a1, Firefox 93.0b9 and latest ESR 91 build from treeherder across platforms (Windows 10, Ubuntu 18.04 and macOS 11.5) the validation message is no longer displayed when using the testcase.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged][post-critsmash-triage] → [post-critsmash-triage]
[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=verified)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3451241_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3457931_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3458092_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv- → [reporter-external] [client-bounty-form] [verif?][adv-main93+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3458746_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main93+] → [reporter-external] [client-bounty-form] [verif?][adv-main93+][adv-esr91.2+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1726621#c25)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9243765)
— [Details](attachment.cgi?id=9243765&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a3621459_578488)• 3 years ago |

Alias: CVE-2021-38497

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a32159855_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1726621#a87688681_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1726621&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_a2d91c0e_20250115_102910.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-45

## Security Vulnerabilities fixed in Firefox ESR 91.2

Announced
October 5, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.2

#### [#CVE-2021-38496: Use-after-free in MessageTask](#CVE-2021-38496)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

During operations on MessageTasks, a task may have been removed while it was still scheduled, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1725335](https://bugzilla.mozilla.org/show_bug.cgi?id=1725335)

#### [#CVE-2021-38497: Validation message could have been overlaid on another origin](#CVE-2021-38497)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Through use of `reportValidity()` and `window.open()`, a plain-text validation message could have been overlaid on another origin, leading to possible user confusion and spoofing attacks.

##### References

* [Bug 1726621](https://bugzilla.mozilla.org/show_bug.cgi?id=1726621)

#### [#CVE-2021-38498: Use-after-free of nsLanguageAtomService object](#CVE-2021-38498)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

During process shutdown, a document could have caused a use-after-free of a languages service object, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1729642](https://bugzilla.mozilla.org/show_bug.cgi?id=1729642)

#### [#CVE-2021-32810: Data race in crossbeam-deque](#CVE-2021-32810)

Reporter
Maor Kleinberger
Impact
moderate
##### Description

In the crossbeam crate, one or more tasks in the worker queue could have been be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this could have caused a double free and a memory leak.

##### References

* [Bug 1729813](https://bugzilla.mozilla.org/show_bug.cgi?id=1729813)
* [Bug https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw](https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw)

#### [#CVE-2021-38500: Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](#CVE-2021-38500)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Andreas Pehrson and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93, Firefox ESR 78.15, and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1725854%2C1728321)

#### [#CVE-2021-38501: Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](#CVE-2021-38501)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Kevin Brosnan, Mihai Alexandru Michis, and Christian Holler reported memory safety bugs present in Firefox 92 and Firefox ESR 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 93 and Firefox ESR 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685354%2C1715755%2C1723176)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5df6384f_20250115_102910.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-47

## Security Vulnerabilities fixed in Thunderbird 91.2

Announced
October 6, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2021-38502: Downgrade attack on SMTP STARTTLS connections](#CVE-2021-38502)

Reporter
Mattias Jacobsson
Impact
high
##### Description

Thunderbird ignored the configuration to require STARTTLS security for an SMTP connection. A MITM could perform a downgrade attack to intercept transmitted messages, or could take control of the authenticated session to execute SMTP commands chosen by the MITM. If an unprotected authentication method was configured, the MITM could obtain the authentication credentials, too.

##### References

* [Bug 1733366](https://bugzilla.mozilla.org/show_bug.cgi?id=1733366)

#### [#CVE-2021-38496: Use-after-free in MessageTask](#CVE-2021-38496)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

During operations on MessageTasks, a task may have been removed while it was still scheduled, resulting in memory corruption and a potentially exploitable crash.

##### References

* [Bug 1725335](https://bugzilla.mozilla.org/show_bug.cgi?id=1725335)

#### [#CVE-2021-38497: Validation message could have been overlaid on another origin](#CVE-2021-38497)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Through use of `reportValidity()` and `window.open()`, a plain-text validation message could have been overlaid on another origin, leading to possible user confusion and spoofing attacks.

##### References

* [Bug 1726621](https://bugzilla.mozilla.org/show_bug.cgi?id=1726621)

#### [#CVE-2021-38498: Use-after-free of nsLanguageAtomService object](#CVE-2021-38498)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

During process shutdown, a document could have caused a use-after-free of a languages service object, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1729642](https://bugzilla.mozilla.org/show_bug.cgi?id=1729642)

#### [#CVE-2021-32810: Data race in crossbeam-deque](#CVE-2021-32810)

Reporter
Maor Kleinberger
Impact
moderate
##### Description

In the crossbeam crate, one or more tasks in the worker queue could have been be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this could have caused a double free and a memory leak.

##### References

* [Bug 1729813](https://bugzilla.mozilla.org/show_bug.cgi?id=1729813)
* [Bug https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw](https://github.com/crossbeam-rs/crossbeam/security/advisories/GHSA-pqqp-xmhj-wgcw)

#### [#CVE-2021-38500: Memory safety bugs fixed in Thunderbird 91.2](#CVE-2021-38500)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Andreas Pehrson and Christian Holler reported memory safety bugs present in Thunderbird 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1725854%2C1728321)

#### [#CVE-2021-38501: Memory safety bugs fixed in Thunderbird 91.2](#CVE-2021-38501)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Kevin Brosnan, Mihai Alexandru Michis, and Christian Holler reported memory safety bugs present in Thunderbird 91.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685354%2C1715755%2C1723176)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


