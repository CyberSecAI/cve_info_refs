=== Content from noob3xploiter.medium.com_929f85aa_20250114_232037.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4eb322f64823&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-3-yet-another-buffer-overflow-4eb322f64823&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-3-yet-another-buffer-overflow-4eb322f64823&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Hacking the Tenda AC10–1200 Router Part 3: Yet Another Buffer Overflow

[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:88:88/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---byline--4eb322f64823--------------------------------)

[Brandon Roldan](/?source=post_page---byline--4eb322f64823--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fec6efbb67a4&operation=register&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-3-yet-another-buffer-overflow-4eb322f64823&user=Brandon+Roldan&userId=ec6efbb67a4&source=post_page-ec6efbb67a4--byline--4eb322f64823---------------------post_header-----------)

4 min read·Aug 10, 2021

--

Listen

Share

Hi. This is my third writeup in my hacking the tenda ac10 series where i try to get a cve. Lets get started.

So while looking through the functions that accept user inputs, i found this one function called `fromSetIpMacBind`

![]()

Here’s what it do, first it get the value of the parameter list then store its value to the variable called `var_3f8_1`

![]()

Then, it move this `var_3f8_1` variable to another variable `var_40c_1`

![]()

Then check if `0xa` is in `var_40c_1` using `strchr` which doesnt matter since either way, there will be a `strcpy` which will cause the buffer overflow.

![]()

Now lets try it out. `fromSetIpMacBind` is referenced in `formDefineTenda`

![]()

This means our vulnerable endpoint is `SetIpMacBind`. Now lets try it out

![]()

It doesnt work. For some reason, it didnt reach our `strcpy`. Lets track out why.

![]()

This is the code before the strchr that we expected. Here, we can see that it checks if `var_404_1` is less than `var_410_1`. If it is, it will jump somewhere else and will not execute the `strchr` and `strcpy` that we expected. Now lets see what is the value of these two. Starting with `var_404_1`

![]()![]()

We can see that its value is the `atoi` of the bindnum parameter. What atoi does is it convert our string input to integer. Now lets find out what is the value of `var_410_1`. This one is a little complicated

![]()

Here, it checks if `var_404_1` is not less than zero and less than `0x21`. (var\_404\_1 is the atoi of the bindnum parameter). If yes, it will set the value of `var_410_1` to 1 or 0x1. The other variables are not that important. Then, the check happens

![]()

If `var_404_1` is less than `var_410_1`, it will not execute our strcpy and the exploit will fail. So what we have to do is make `var_401_1` to 1, because then, `var_404_1` will be greater than `var_410_1` which then will execute our strcpy.

Now to set `var_410_1` to 1, the value of the parameter `bindnum` should be greater than 0 and less than 0x21 as stated here

![]()

Now lets try it again but this time lets provide the bindnum parameter.

If we set `bindnum` parameter to 33(0x21) or higher, we can see that it will fail

![]()

But if we set it between 1 and 32, it will succeed

![]()

No response. That means we crashed the server and our exploit is successful.

We can further confirm it by looking at the emulation

![]()

This is the end of the writeup. I tried contacting tenda but they havent responded so i decided to disclose it now.

Thanks for reading

Join the discord server: <https://discord.gg/bugbounty>

[Hacking](https://medium.com/tag/hacking?source=post_page-----4eb322f64823--------------------------------)[Infosec](https://medium.com/tag/infosec?source=post_page-----4eb322f64823--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----4eb322f64823--------------------------------)[Hack](https://medium.com/tag/hack?source=post_page-----4eb322f64823--------------------------------)[Security](https://medium.com/tag/security?source=post_page-----4eb322f64823--------------------------------)

--

--

[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:96:96/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---post_author_info--4eb322f64823--------------------------------)[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:128:128/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---post_author_info--4eb322f64823--------------------------------)Follow[## Written by Brandon Roldan](/?source=post_page---post_author_info--4eb322f64823--------------------------------)[686 Followers](/followers?source=post_page---post_author_info--4eb322f64823--------------------------------)·[9 Following](/following?source=post_page---post_author_info--4eb322f64823--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4eb322f64823--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4eb322f64823--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----4eb322f64823--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4eb322f64823--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4eb322f64823--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4eb322f64823--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4eb322f64823--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4eb322f64823--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4eb322f64823--------------------------------)[Teams](https://medium.com/business?source=post_page-----4eb322f64823--------------------------------)


