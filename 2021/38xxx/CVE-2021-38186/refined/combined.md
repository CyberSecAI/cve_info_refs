=== Content from raw.githubusercontent.com_4c8b603d_20250115_101601.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0063"
package = "comrak"
date = "2021-05-04"
url = "https://github.com/kivikakk/comrak/releases/tag/0.10.1"
categories = ["format-injection"]
keywords = ["xss"]
aliases = ["CVE-2021-38186", "GHSA-6wj2-g87r-pm62"]
[versions]
patched = [">= 0.10.1"]
```
# XSS in `comrak`
[comrak](https://github.com/kivikakk/comrak) operates by default in a "safe"
mode of operation where unsafe content, such as arbitrary raw HTML or URLs with
non-standard schemes, are not permitted in the output. This is per the
reference GFM implementation, [cmark-gfm](https://github.com/github/cmark).
Ampersands were not being correctly escaped in link targets, making it possible
to fashion unsafe URLs using schemes like `data:` or `javascript:` by entering
them as HTML entities, e.g. `data:`. The intended
behaviour, demonstrated upstream, is that these should be escaped and therefore
harmless, but this behaviour was broken in comrak.


=== Content from rustsec.org_a7987624_20250115_101602.html ===


RUSTSEC-2021-0063: comrak: XSS in `comrak` › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/comrak/RUSTSEC-2021-0063.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/comrak/RUSTSEC-2021-0063.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0063)

# RUSTSEC-2021-0063

XSS in `comrak`

Reported
May 4, 2021

Issued
May 4, 2021

(last modified: June 13, 2023)

Package
[comrak](/packages/comrak.html)
([crates.io](https://crates.io/crates/comrak))

Type
Vulnerability

Categories

* [format-injection](/categories/format-injection.html)

Keywords
[#xss](/keywords/xss.html)

Aliases

* [CVE-2021-38186](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38186)
* [GHSA-6wj2-g87r-pm62](https://github.com/advisories/GHSA-6wj2-g87r-pm62)

References

* <https://github.com/kivikakk/comrak/releases/tag/0.10.1>

Patched

* `>=0.10.1`

### Description

[comrak](https://github.com/kivikakk/comrak) operates by default in a "safe"
mode of operation where unsafe content, such as arbitrary raw HTML or URLs with
non-standard schemes, are not permitted in the output. This is per the
reference GFM implementation, [cmark-gfm](https://github.com/github/cmark).

Ampersands were not being correctly escaped in link targets, making it possible
to fashion unsafe URLs using schemes like `data:` or `javascript:` by entering
them as HTML entities, e.g. `&#x64&#x61&#x74&#x61&#x3a`. The intended
behaviour, demonstrated upstream, is that these should be escaped and therefore
harmless, but this behaviour was broken in comrak.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


