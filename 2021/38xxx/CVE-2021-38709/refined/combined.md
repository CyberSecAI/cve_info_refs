=== Content from compo.sr_bf57faa7_20250114_201452.html ===

[Skip navigation](#maincontent)
[![Composr logo](https://compo.sr/themes/composr_homesite/images_custom/composr_homesite/composr_full_logo.png)](https://compo.sr/start.htm)

* [GitLab](https://gitlab.com/composr-foundation/composr)
* [Community Forum](https://compo.sr/forum/forumview.htm)
* [Join](https://compo.sr/join.htm?redirect=https%3A%3Aslash%3A%3Aslash%3Acompo.sr%3Aslash%3Anews%3Aslash%3Aview%3Aslash%3Aannouncements%3Aslash%3Atwo-new-xss-security.htm)
* [Log in](https://compo.sr/login.htm?redirect=https%3A%3Aslash%3A%3Aslash%3Acompo.sr%3Aslash%3Anews%3Aslash%3Aview%3Aslash%3Aannouncements%3Aslash%3Atwo-new-xss-security.htm)

Search

* [Home](https://compo.sr/start.htm)
* [About](https://compo.sr/features.htm)
  + [Features](https://compo.sr/features.htm)
  + [Composr compared](https://compo.sr/compare.htm)
  + [Our vision](https://compo.sr/vision.htm)
  + [What we're not](https://compo.sr/antifeatures.htm)
  + [Demo](https://compo.sr/demo.htm)
  + [Maintenance status](https://compo.sr/maintenance-status.htm)
* [Download](https://compo.sr/download.htm)
  + [Composr](https://compo.sr/download.htm)
  + [Translations](https://compo.sr/downloads/browse/addons/version-10/translations.htm)
  + [Translations (rough)](https://compo.sr/transifex.htm)
  + [Addons](https://compo.sr/downloads/browse/addons/version-10.htm)
  + [Themes](https://compo.sr/downloads/browse/addons/version-10/themes.htm)
  + [Themeing compatibility](https://compo.sr/themeing-changes.htm)
* [Support](https://compo.sr/support.htm)
  + [Report Issue / Feature](https://compo.sr/report-issue.htm)
  + [Support Resources](https://compo.sr/support.htm)
  + [Tutorials](https://compo.sr/docs/tutorials.htm)
  + [FAQ](https://compo.sr/docs/faq.htm)
  + [Developer docs](https://compo.sr/docs/codebook.htm)
* [Community](https://compo.sr/community.htm)
  + [Community](https://compo.sr/community.htm)
  + [Forums](https://compo.sr/forum/forumview.htm)
  + [Chat](https://compo.sr/chat.htm)
  + [Issue Tracker](https://compo.sr/tracker.htm)
  + [Site Showcase](https://compo.sr/community/community-sites.htm)
* [Contribute](https://compo.sr/contributions.htm)
  + [Ways to contribute](https://compo.sr/contributions.htm)
  + [Community stars](https://compo.sr/stars.htm)
  + [Composr partners](https://compo.sr/partners.htm)

[Home](https://compo.sr/start.htm "Go upwards to Home") → [News archive](https://compo.sr/news.htm "Go upwards to News archive") → Two new XSS security holes, and resolutions

# Two new XSS security holes, and resolutions

* 8,893 views
* Added 15th August 2021, 9:01 pm
* Author: [Chris Graham](https://compo.sr/authors/browse/Chris%3Aspace%3AGraham.htm "Author: Chris Graham")
  ![](https://compo.sr/uploads/auto_thumbs/thumb__50__box__https%3B%2147%2147compo.sr%2147%2147uploads%2147cns_avatars%21472ChrisAva.png)

Hello,

Two security holes were recently discovered in current and previous versions of Composr CMS.

These issues have been fixed in the new version released today, 10.0.38. In this news post we will explain the issues and provide temporary mitigations for those who do not wish to immediately upgrade to 10.0.38.

## Vulnerability 1: XSS in Comcode

**Bug:**
An attacker can inject JavaScript via Comcode.
This issue is tagged as CVE-2021-38708.

**Affects:**
Composr CMS sites that have the "Subject to a more liberal HTML filter" privilege. By default only staff have this privilege, so most sites will not be vulnerable (assuming staff can be trusted).

**Reason for mistake:**
There is a special way of writing invalid HTML that manages to evade our filter.

**Fix in v10.0.38:**
The filter has been tweaked to handle the new case, and our test set tweaked to check it.

**Temporary mitigation:**
Download the [latest manual extractor installer](https://compo.sr/download.htm) and replace your `sources/input_filter.php` file.

## Vulnerability 2: XSS in staff\_messaging addon

**Bug:**
An attacker can inject JavaScript via the messaging system.
This issue is tagged as CVE-2021-38709.

**Affects:**
Composr CMS sites that have the `staff_messaging` addon installed and in active use. The addon is installed by default, and the default mechanism for the default contact form, so many sites will be vulnerable.

**Reason for mistake:**
There is a very specific mistake in our sanitisation for this addon.

**Fix in v10.0.38:**
The very specific mistake has been corrected.

**Temporary mitigation:**
Download the [latest manual extractor installer](https://compo.sr/download.htm) and replace your `themes/default/templates/MESSAGING_MESSAGE_SCREEN.tpl` file.

## Credit

These issues were reported to us responsibly by onemanteam123321. We have great appreciation for groups and individuals who report vulnerabilities to us responsibly.

This news article is filed under the following categories:

* [Announcements](https://compo.sr/news/browse/announcements.htm)

Don't fill this field, it is here to catch spam-bots that fill in forms automatically
Sort by
Relevance
Newest first
Oldest first
Rating
Popularity

## Comments

There have been no comments yet

[Print](https://compo.sr/news/view/announcements/two-new-xss-security.htm?wide_print=1 "Print (this link will open in a new window)")
[Tell a friend](https://compo.sr/recommend.htm?from=https%3A%3Aslash%3A%3Aslash%3Acompo.sr%3Aslash%3Anews%3Aslash%3Aview%3Aslash%3Aannouncements%3Aslash%3Atwo-new-xss-security.htm&title=Two%3Aspace%3Anew%3Aspace%3AXSS%3Aspace%3Asecurity%3Aspace%3Aholes%2C%3Aspace%3Aand%3Aspace%3Aresolutions "Tell a friend (this link will open in a new window)")
[Share on Twitter](http://twitter.com/home?status=RT%20https%3A%2F%2Fcompo.sr%2Fnews%2Fview%2Fannouncements%2Ftwo-new-xss-security.htm "Share on Twitter (this link will open in a new window)")
[Add to Digg](http://digg.com/submit?phase=2&url=https%3A%2F%2Fcompo.sr%2Fnews%2Fview%2Fannouncements%2Ftwo-new-xss-security.htm "Add to Digg (this link will open in a new window)")

![](https://compo.sr/themes/composr_homesite/images/1x/edited.png)
Edited
16th August 2021

Back to Top

* [Composr CMS](https://compo.sr/start.htm)
* [Keyboard shortcuts](https://compo.sr/keymap.htm)
* [expenditure-torpid](https://compo.sr/defencepassage.php)
* [Support](https://compo.sr/support.htm)
* [Rules](https://compo.sr/rules.htm)
* [Privacy](https://compo.sr/privacy.htm)
* [Log in](https://compo.sr/login.htm?redirect=https%3A%3Aslash%3A%3Aslash%3Acompo.sr%3Aslash%3Anews%3Aslash%3Aview%3Aslash%3Aannouncements%3Aslash%3Atwo-new-xss-security.htm)
* [Mobile version](https://compo.sr/news/view/announcements/two-new-xss-security.htm?keep_mobile=1)

Copyright © [ocProducts Ltd](https://ocproducts.com/start.htm), 2025. All rights reserved. Composr was formerly known as ocPortal.

**Did you know?** We want your website to be financially sustainable. Advanced advertising and eCommerce features come standard.

[![Composr is Open Source](https://compo.sr/themes/composr_homesite/images_custom/composr_homesite/img-open-source.jpg)](https://compo.sr/licence.htm)

[![Composr uses HTML5](https://compo.sr/themes/composr_homesite/images_custom/composr_homesite/img-html5.jpg)](https://compo.sr/docs/tutorials/Web%3Aspace%3Astandards%3Aspace%3A%3Aamp%3A%3Aspace%3AAccessibility.htm)


