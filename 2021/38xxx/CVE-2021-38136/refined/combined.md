=== Content from www.shielder.it_ac06941d_20250115_082201.html ===
[![shielder logo homepage](https://www.shielder.com/img/logoshielder.svg)](https://www.shielder.com/ "homepage")

* [Home](https://www.shielder.com/ "Home")
* [Company](https://www.shielder.com/company "Company")
* [Services](https://www.shielder.com/services "Services")
* [Advisories](https://www.shielder.com/advisories "Advisories")
* [Blog](https://www.shielder.com/blog "Blog")
* [Careers](https://www.shielder.com/careers "Careers")
* [Contacts](https://www.shielder.com/contacts "Contacts")
* ENG[ENG](https://www.shielder.com/advisories/corero_secure_watch_managed_services-get_snapshot-path-traversal/ "ENG")
  [ITA](https://www.shielder.com/it/advisories/corero_secure_watch_managed_services-get_snapshot-path-traversal/ "ITA")
# Corero SecureWatch Managed Services 9.7.2.0020 get\_snapshot Path Traversal

Corero SecureWatch Managed Services 9.7.2.0020 is affected by a Path Traversal vulnerability via the `snap_file` parameter in the `/it-IT/splunkd/__raw/services/get_snapshot` HTTP API endpoint. A ’low privileged’ attacker can read any file on the target host.

## Product Description (from vendor)

“SecureWatch Managed Services are a comprehensive suite of configuration optimization, monitoring and mitigation response services. This round-the-clock service, delivered by Coreroâs highly experienced Security Operations Center, is tailored to meet the security policy requirements and business goals of each SmartWall customer that engages in a SecureWatch managed service plan.” More information is available at <https://www.corero.com/product/managed-ddos-protection-services/>

### CVE

* [CVE-2021-38136](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38136)

### Root Cause Analysis

The file `/opt/splunk/etc/apps/securewatch_analytics_tdd/bin/snapshot_handler/snapshotHandler.py`, reachable via a HTTP request to `/it-IT/splunkd/__raw/services/get_snapshot`, uses the “snap\_file” parameter to build the path of file to provide inside the HTTP response, without sanitizing the user input in any way.

| ```  1  2  3  4  5  6  7  8  9 10 11 12 13 14  ``` | ``` class GetSnapshot(splunk.rest.BaseRestHandler):     def handle_GET(self):         try:             snap_file = unquote(self.request['query']['snap_file'])             with open('/corero/snapshots/' + snap_file, mode='rb') as file:                 fileContent = file.read()         except IOError as e:             logging.error("command '{}' return with error (code {}) {}".format(e.cmd, e.returncode, e.output))             raise cherrypy.HTTPError(500, "Error while reading snapshot:{})".format(e.strerror))         self.response.headers["Content-Type"] = 'application/octet-stream'         self.response.write(fileContent)  ``` |
| --- | --- |

By traversing the `/corero/snapshots/` path it is possible to read any file on the target host.

### Proof of Concept

1. Log-in Corero Firewall with a user with “swa-monitor” privileges
2. Visit the following URL: https://$host/it-IT/splunkd/\_\_raw/services/get\_snapshot?snap\_file=../../../../../../../../../../etc/shadow
3. Notice the content of the /etc/shadow file in the server response

### Impact

An attacker with access to an account having ‘swa-monitor’ privileges can read the contents of any file on the target host.

### Remediation

Upgrade Corero SecureWatch Managed Services to version 9.7.5 or later. (Note: we didn’t verify the patch.)

## Disclosure Timeline

* 01/12/2020: The vulnerability is found during an assessment for a Shielder client and reported to the vendor
* 09/12/2020: The vendor fixes the vulnerability with the release of Corero SecureWatch Managed Services version 9.7.5
* 06/08/2021: Shielder’s advisory is made public

## Credits

Giulio `[linset](https://twitter.com/Linset_10)` Casciaro from Shielder

This advisory was first published on https://www.shielder.com/advisories/corero\_secure\_watch\_managed\_services-get\_snapshot-path-traversal/

[Advisory](/types/advisory)

Date

6 August 2021

Info

Shielder S.p.A.

P.I. 11435310013

REA TO - 1213132

Registered Capital: 81.000,00 â¬

[Via
Palestro, 1/C
10064 Pinerolo (TO) Italy](https://www.google.it/maps/place/Shielder/%4044.8833849%2C7.3303863%2C17z/data%3D%213m1%214b1%214m5%213m4%211s0x4788250440849fa5%3A0x74cf10f2092abc85%218m2%213d44.8833849%214d7.332575 "corporate headquarters")

![ISO27001](/img/iso27001.png)![ISO9001](/img/iso9001.png)

Contacts

info@shielder.com

Landline:
(+39) 0121 - 39 36 42

Commercial:
(+39) 345 - 30 31 983

Technical:
(+39) 393 - 16 66 814

Sitemap

[Home](https://www.shielder.com/ "Home")

[Company](https://www.shielder.com/company "Company")

[Services](https://www.shielder.com/services "Services")

[Advisories](https://www.shielder.com/advisories "Advisories")

[Blog](https://www.shielder.com/blog "Blog")

[Careers](https://www.shielder.com/careers "Careers")

[Contacts](https://www.shielder.com/contacts "Contacts")

Copyright Â© Shielder 2014 - 2024
[Disclosure policy](/disclosure-policy "Disclosure Policy")
[Privacy policy](/privacy-policy "Privacy Policy")
