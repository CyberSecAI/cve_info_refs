=== Content from raw.githubusercontent.com_f7855a39_20250114_193740.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0075"
package = "ark-r1cs-std"
date = "2021-07-08"
categories = ["crypto-failure"]
keywords = ["r1cs", "zksnark", "arkworks"]
url = "https://github.com/arkworks-rs/r1cs-std/pull/70"
aliases = ["CVE-2021-38194", "GHSA-qj3v-q2vj-4c8h"]
[versions]
patched = [">= 0.3.1"]
[affected]
functions = { "ark\_r1cs\_std::FieldVar::mul\_by\_inverse" = ["< 0.3.0"] }
```
# Flaw in `FieldVar::mul\_by\_inverse` allows unsound R1CS constraint systems
Versions `0.2.0` to `0.3.0` of ark-r1cs-std did not enforce any constraints in the `FieldVar::mul\_by\_inverse` method, allowing a malicious prover to produce an unsound proof that passes all verifier checks.
This method was used primarily in scalar multiplication for [`short\_weierstrass::ProjectiveVar`](https://docs.rs/ark-r1cs-std/0.3.0/ark\_r1cs\_std/groups/curves/short\_weierstrass/struct.ProjectiveVar.html).
This bug was fixed in commit `47ddbaa`, and was released as part of version `0.3.1` on `crates.io`.


=== Content from rustsec.org_57195ee3_20250114_193743.html ===


RUSTSEC-2021-0075: ark-r1cs-std: Flaw in `FieldVar::mul\_by\_inverse` allows unsound R1CS constraint systems › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/ark-r1cs-std/RUSTSEC-2021-0075.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/ark-r1cs-std/RUSTSEC-2021-0075.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0075)

# RUSTSEC-2021-0075

Flaw in `FieldVar::mul_by_inverse` allows unsound R1CS constraint systems

Reported
July 8, 2021

Issued
July 9, 2021

(last modified: June 13, 2023)

Package
[ark-r1cs-std](/packages/ark-r1cs-std.html)
([crates.io](https://crates.io/crates/ark-r1cs-std))

Type
Vulnerability

Categories

* [crypto-failure](/categories/crypto-failure.html)

Keywords
[#r1cs](/keywords/r1cs.html)
[#zksnark](/keywords/zksnark.html)
[#arkworks](/keywords/arkworks.html)

Aliases

* [CVE-2021-38194](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38194)
* [GHSA-qj3v-q2vj-4c8h](https://github.com/advisories/GHSA-qj3v-q2vj-4c8h)

References

* <https://github.com/arkworks-rs/r1cs-std/pull/70>

Patched

* `>=0.3.1`

Affected Functions
Version
`ark_r1cs_std::FieldVar::mul_by_inverse`

* `<0.3.0`

### Description

Versions `0.2.0` to `0.3.0` of ark-r1cs-std did not enforce any constraints in the `FieldVar::mul_by_inverse` method, allowing a malicious prover to produce an unsound proof that passes all verifier checks.
This method was used primarily in scalar multiplication for [`short_weierstrass::ProjectiveVar`](https://docs.rs/ark-r1cs-std/0.3.0/ark_r1cs_std/groups/curves/short_weierstrass/struct.ProjectiveVar.html).

This bug was fixed in commit `47ddbaa`, and was released as part of version `0.3.1` on `crates.io`.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


