=== Content from www.debian.org_c71d4ad5_20250114_201514.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DSA 5034-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5034-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 2 Jan 2022 17:01:50 +0000
* *Message-id*: <[[🔎]](/msgid-search/20220102170150.GA31860%40seger.debian.org) [20220102170150.GA31860@seger.debian.org](msg00000.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5034-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
January 02, 2022                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For the oldstable distribution (buster), these problems have been fixed
in version 1:91.4.1-1~deb10u1.

For the stable distribution (bullseye), these problems have been fixed in
version 1:91.4.1-1~deb11u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmHR2XsACgkQEMKTtsN8
TjYd7w//ak0oRg6eCbfKob7RuhyUJ+6VsRhi4OUhuJBn78TsdwY6RWn63FZLqR0k
zUPM77KHdbL1dBE4Cphijqk8SQWAiWjKY0qceTA0QLJD3in9ZeyZQ3pGElynfRfQ
b42lYuAeo04CxKxgdrvHcLtDTfVFTWTUS7bwB7uzufu5AwflESPJuDW+e98nG0Nh
8lP/jBk6MpPJ4+smPQY2TeRyicd+a5C7JIe1dZAh7MhDJ+KJ2n1/1K3DUUR2eCo/
MYlw00nXs/Vr1BJxwWxSfl9ahxUcOWQWZ8SjtvIJTJXSjw1RoP+1Vefln7rpKgDH
2rUbsWJwS5B/83e2mDvsatgCZPNVsecMDrvWWVoctJm652pdqIAXvBxtyncoSm+S
Wmn5gdGec9IHXSUty1wO2pXrbfUKtr3H5qtyoesDBvhlXrYeyI5jNYTrO6V493le
j0WmZC0sypibI1jMOfOR68BYeDVl7kz737e6I4OoaNg4UUbXXBPgDOdFBaODt9ql
egTHI2wMCuszUBUo3PfVp1pyvb2Lnr27NisQNU2rvDV/MSXba3tsEUXj+ka4UVQZ
XcAUEcWKUVBn4utbJQJ81k3/KbVsAo0emN9cSM3z4opHpkmLGeyyvvPMwE8+Y/FM
RqFfsn4wRGDgwOZyGCWZ9NERvQ/r+DeBWp/Ca5Cw1fyho/4mFQY=
=jRWO
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_0ee21338_20250114_201515.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-48

## Security Vulnerabilities fixed in Firefox 94

Announced
November 2, 2021
Impact
high
Products
Firefox
Fixed in

* Firefox 94

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Firefox could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43530: Universal XSS in Firefox for Android via QR Code URLs](#CVE-2021-43530)

Reporter
Hafiizh
Impact
high
##### Description

A Universal XSS vulnerability was present in Firefox for Android resulting from improper sanitization when processing a URL scanned from a QR code.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1736886](https://bugzilla.mozilla.org/show_bug.cgi?id=1736886)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-43531: Web Extensions could access pre-redirect URL when their context menu was triggered by a user](#CVE-2021-43531)

Reporter
Rob Wu
Impact
moderate
##### Description

When a user loaded a Web Extensions context menu, the Web Extension could access the post-redirect URL of the element clicked. If the Web Extension lacked the WebRequest permission for the hosts involved in the redirect, this would be a same-origin-violation leaking data the Web Extension should have access to. This was fixed to provide the pre-redirect URL. This is related to CVE-2021-43532 but in the context of Web Extensions.

##### References

* [Bug 1659155](https://bugzilla.mozilla.org/show_bug.cgi?id=1659155)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43532: 'Copy Image Link' context menu action could have been abused to see authentication tokens](#CVE-2021-43532)

Reporter
Ademar Nowasky Junior
Impact
low
##### Description

The 'Copy Image Link' context menu action would copy the final image URL after redirects. By embedding an image that triggered authentication flows - in conjunction with a Content Security Policy that stopped a redirection chain in the middle - the final image URL could be one that contained an authentication token used to takeover a user account. If a website tricked a user into copy and pasting the image link back to the page, the page would be able to steal the authentication tokens. This was fixed by making the action return the original URL, before any redirects.

##### References

* [Bug 1719203](https://bugzilla.mozilla.org/show_bug.cgi?id=1719203)

#### [#CVE-2021-43533: URL Parsing may incorrectly parse internationalized domains](#CVE-2021-43533)

Reporter
Taiga Shirakura
Impact
low
##### Description

When parsing internationalized domain names, high bits of the characters in the URLs were sometimes stripped, resulting in inconsistencies that could lead to user confusion or attacks such as phishing.

##### References

* [Bug 1724233](https://bugzilla.mozilla.org/show_bug.cgi?id=1724233)

#### [#CVE-2021-43534: Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_710f37d2_20250114_201510.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 2863-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2863-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Wed, 29 Dec 2021 15:08:44 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20211229140844.4D47C2A01EC%40andromeda) [20211229140844.4D47C2A01EC@andromeda](msg00030.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2863-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2021                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 91.4.1esr-1~deb9u1
CVE ID         : CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43534 CVE-2021-43535
                 CVE-2021-43536 CVE-2021-43537 CVE-2021-43538 CVE-2021-43539
                 CVE-2021-43541 CVE-2021-43542 CVE-2021-43543 CVE-2021-43545
                 CVE-2021-43546

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

For Debian 9 stretch, these problems have been fixed in version
91.4.1esr-1~deb9u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHMa+gACgkQnUbEiOQ2
gwJ1fxAAlShXtzdoIbA8nzTMODGnFqcZlcbnLRBJHRz2wqooV8AQfyzMqoZH9Ac+
iZPZ0hsK94j4CfGv+HjIJDag3xrqifKRmNu+C7EDp6A85a0jtu34OlKu4GcDeGO+
4D+cLd4ODc9qxSGT9DoMrqEhX8AHZbIBMq9ULcFtJziqlkRJQgjJ7VHnboI8phR3
kPjVead/5ktIjM9/ke3XL2dmKsT/8eUV3V1BkIpReZhMkqvHfMjXU0OYj9KX3nRe
6NHmoiNVTGhEmXGZ+YyVPSg3vQ60rs9VVKgDryBA8nqvZDmb4V+cNXXeE3mc2ytK
bLdE/diLNL2hVtmXrx3j7DAuieXV5GKGOhvx+OtOU4wgxnnzT5JO4gu0taOUSOlp
RY8CJjJC8MwkGbmvzfIImzWY0a7OrjyX1CalYs/Liv8pGP8xYzjM5hzGXE9P1HhP
Ap+ES6j5TeYEzIlUM8YmtdYOnDu1ae5a+FUUIHtMZY9B9+AypY1qq7XJx69KNyLK
dyERuMDhVohNRMdim7enVZeePyfLsE5Ywexaw0YgiHMJSSLWdPRuy1U/X9JN+1op
mT66RRdNl64maq3ZkSOjmyzNM7zpsYZ3hsXX6U2DkqGsc+Q3xlb4/ncRriJx4rZO
8bN0h9L3Zobb4ItOVSI4BvqMNYh0oKCBRNhp8O2Uj0bIxNCHvhg=
=pQH3
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_d669cd63_20250114_201514.html ===


---

[[Date Prev](msg00211.html)][[Date Next](msg00213.html)]
[[Thread Prev](msg00211.html)][[Thread Next](msg00213.html)]
[[Date Index](maillist.html#00212)]
[[Thread Index](threads.html#00212)]

# [SECURITY] [DSA 5026-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5026-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 19 Dec 2021 15:23:09 +0000
* *Message-id*: <[[🔎]](/msgid-search/20211219152309.GA28709%40seger.debian.org) [20211219152309.GA28709@seger.debian.org](msg00212.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5026-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 19, 2021                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2021-43546 CVE-2021-43545 CVE-2021-43543 CVE-2021-43542
                 CVE-2021-43541 CVE-2021-43539 CVE-2021-43538 CVE-2021-43537
                 CVE-2021-43536 CVE-2021-43535 CVE-2021-43534 CVE-2021-38509
                 CVE-2021-38508 CVE-2021-38507 CVE-2021-38506 CVE-2021-38504
                 CVE-2021-38503

Multiple security issues have been found in the Mozilla Firefox
web browser, which could potentially result in the execution
of arbitrary code, information disclosure or spoofing.

Debian follows the extended support releases (ESR) of Firefox. Support
for the 78.x series has ended, so starting with this update we're now
following the 91.x releases.

Between 78.x and 91.x, Firefox has seen a number of feature updates. For
more information please refer to
<https://www.mozilla.org/en-US/firefox/91.0esr/releasenotes/>

For the oldstable distribution (buster) one more final toolchain update
is needed, updated packages will shortly be available as 91.4.1esr-1~deb10u1

For the stable distribution (bullseye), these problem have been fixed in
version 91.4.1esr-1~deb11u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmG/ThkACgkQEMKTtsN8
TjYUEhAAqvtyXOssLe1+WtXdIeDNPCq4SCVnqKiVx2k+CJ8UVD1+NRGP0c4lRWG+
jORSEG+/iTcglfPKWb36Wly+xTafkZ5H1//SJCECwMCg6aq6EqlFZM50g6o6zOr/
szad8i/Dirh0G08AMzoab3VIm1RdlXmcZ6HWlaD59zMTm5ZakzikIX1rWhM0KPq4
dU9Pp3nwkcBlKmY90VTr3QGxOaolu1tes+y2r7ZwP8ZhVSFYV5wkPVAgvS9ybSih
yAvxVlB9f/aYjnfo4kzKBhZENoFz/h9qdp8hg00DI7Olw0WJkmU6soDh75FqJ4j4
XMzYAWEqnDyxFpU9t+RBUPFMNFERc/iVFDQaIuF6WDq2ud7Pzpj+byvSsL5kuaob
k4PMHv/SSLVrMWlsj9nO0ee9ih60W+FTIIjhz9Kt2zwY1OX+CBsxWOK86VEJk+7R
m30yhAvJMjqjZtBICF6bvv9ny+FYixQb8rCpRh172NpBlMC8pB0ypvWL4Y4iJK5n
Tj5zmL8iGDYrsZnqgIs5MThM5HLAw4vzBAPfQOB7PDyeWnj+uT+oYcPqOuxIB17Y
FHbIKxjGSMqdWtq/FZ9iP9Sga45hanlMEmu0UZqXFfMKXCY6/cVPk7k5l9vRmwXt
ds+PzAROBdEY2A9KXrct9bXRXdboOj2s2fpgaLU+SPy4xqEN2/I=
=AqRn
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_b809ed9d_20250114_201510.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 2874-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2874-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Tue, 4 Jan 2022 11:10:10 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20220104101010.737312AA2C8%40andromeda) [20220104101010.737312AA2C8@andromeda](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2874-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 04, 2022                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:91.4.1-1~deb9u1
CVE ID         : CVE-2021-4126 CVE-2021-38496 CVE-2021-38500 CVE-2021-38502
                 CVE-2021-38503 CVE-2021-38504 CVE-2021-38506 CVE-2021-38507
                 CVE-2021-38508 CVE-2021-38509 CVE-2021-43528 CVE-2021-43529
                 CVE-2021-43534 CVE-2021-43535 CVE-2021-43536 CVE-2021-43537
                 CVE-2021-43538 CVE-2021-43539 CVE-2021-43541 CVE-2021-43542
                 CVE-2021-43543 CVE-2021-43545 CVE-2021-43546 CVE-2021-44538

Multiple security issues were discovered in Thunderbird, which could
result in the execution of arbitrary code, spoofing, information disclosure,
downgrade attacks on SMTP STARTTLS connections or misleading display of
OpenPGP/MIME signatures.

For Debian 9 stretch, these problems have been fixed in version
1:91.4.1-1~deb9u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmHUHP4ACgkQnUbEiOQ2
gwIdhhAAsYJeGaKX7EakOQSqKqWksvfDg41A+TA01hpygOvfipqGlJl4sBCFHtfm
vPY4w6A+RsJWPohOch+DMc9EfXOJ1ivMp0nMMky/8xYYksAQqeThtwBfm2wHWpGT
IZAtn5doZe/53P++ejD5xLnCC19oCdBbEHsPj3p6OWzEUByqfPZBAv02lA+0pqqo
Mga52gFMI6xy4wmeuQZGtKsyI/hujLbYHnp7Rb8+3uwisb7QkzeVod77z211pGon
ifobrw52Bfa0Cb1e9Xesg70TDsZlPPlUnqHaUC5pE+OxS0Vx1G4Eur1+wQ9ao4V8
djlJWhmj1+1wNlSJ91Fsk0UQ+y6cVli4MU5wzIufQ0TdN+hMjQD0nuCejnjhQjPc
YNK7jYUwM4+DFGswYdpvoNa2uNtKzsu7sZQW9kfeF7H2uLoJgAUdNRdKrNmUrofQ
C4E2CsI3wTQxE9gmWX+LRGKr9r6QF15es7KCEGuFlAToVCh/d6vXF0f9IaH0ZE05
6W4sfcYoj6HKHEcKONuh6codpRceKx6gPgh+2n0pdoUNNlz/AbO0is+SiIInILlI
dYSdTxPLK0fZxD+ufi2E9IaQ2VvRg0Y933pQvjn3xbCCk7xehM7TD55LlwfUWPGb
/ffeEgwsObhA0cmV3jN6+bvxM9Tbk7DSd4Q30fuqSy8od5Ih0i4=
=kFGv
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_067c0658_20250114_201512.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202208-14**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **91.12.0** |
| Unaffected versions | >= **91.12.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-91.12.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-91.12.0"

```
### References

* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-29967](https://nvd.nist.gov/vuln/detail/CVE-2021-29967)
* [CVE-2021-29969](https://nvd.nist.gov/vuln/detail/CVE-2021-29969)
* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38492](https://nvd.nist.gov/vuln/detail/CVE-2021-38492)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-40529](https://nvd.nist.gov/vuln/detail/CVE-2021-40529)
* [CVE-2021-43528](https://nvd.nist.gov/vuln/detail/CVE-2021-43528)
* [CVE-2021-43529](https://nvd.nist.gov/vuln/detail/CVE-2021-43529)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0566](https://nvd.nist.gov/vuln/detail/CVE-2022-0566)
* [CVE-2022-1196](https://nvd.nist.gov/vuln/detail/CVE-2022-1196)
* [CVE-2022-1197](https://nvd.nist.gov/vuln/detail/CVE-2022-1197)
* [CVE-2022-1520](https://nvd.nist.gov/vuln/detail/CVE-2022-1520)
* [CVE-2022-1529](https://nvd.nist.gov/vuln/detail/CVE-2022-1529)
* [CVE-2022-1802](https://nvd.nist.gov/vuln/detail/CVE-2022-1802)
* [CVE-2022-1834](https://nvd.nist.gov/vuln/detail/CVE-2022-1834)
* [CVE-2022-2200](https://nvd.nist.gov/vuln/detail/CVE-2022-2200)
* [CVE-2022-2226](https://nvd.nist.gov/vuln/detail/CVE-2022-2226)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* [CVE-2022-24713](https://nvd.nist.gov/vuln/detail/CVE-2022-24713)
* [CVE-2022-26381](https://nvd.nist.gov/vuln/detail/CVE-2022-26381)
* [CVE-2022-26383](https://nvd.nist.gov/vuln/detail/CVE-2022-26383)
* [CVE-2022-26384](https://nvd.nist.gov/vuln/detail/CVE-2022-26384)
* [CVE-2022-26386](https://nvd.nist.gov/vuln/detail/CVE-2022-26386)
* [CVE-2022-26387](https://nvd.nist.gov/vuln/detail/CVE-2022-26387)
* [CVE-2022-26485](https://nvd.nist.gov/vuln/detail/CVE-2022-26485)
* [CVE-2022-26486](https://nvd.nist.gov/vuln/detail/CVE-2022-26486)
* [CVE-2022-28281](https://nvd.nist.gov/vuln/detail/CVE-2022-28281)
* [CVE-2022-28282](https://nvd.nist.gov/vuln/detail/CVE-2022-28282)
* [CVE-2022-28285](https://nvd.nist.gov/vuln/detail/CVE-2022-28285)
* [CVE-2022-28286](https://nvd.nist.gov/vuln/detail/CVE-2022-28286)
* [CVE-2022-28289](https://nvd.nist.gov/vuln/detail/CVE-2022-28289)
* [CVE-2022-29909](https://nvd.nist.gov/vuln/detail/CVE-2022-29909)
* [CVE-2022-29911](https://nvd.nist.gov/vuln/detail/CVE-2022-29911)
* [CVE-2022-29912](https://nvd.nist.gov/vuln/detail/CVE-2022-29912)
* [CVE-2022-29913](https://nvd.nist.gov/vuln/detail/CVE-2022-29913)
* [CVE-2022-29914](https://nvd.nist.gov/vuln/detail/CVE-2022-29914)
* [CVE-2022-29916](https://nvd.nist.gov/vuln/detail/CVE-2022-29916)
* [CVE-2022-29917](https://nvd.nist.gov/vuln/detail/CVE-2022-29917)
* [CVE-2022-31736](https://nvd.nist.gov/vuln/detail/CVE-2022-31736)
* [CVE-2022-31737](https://nvd.nist.gov/vuln/detail/CVE-2022-31737)
* [CVE-2022-31738](https://nvd.nist.gov/vuln/detail/CVE-2022-31738)
* [CVE-2022-31740](https://nvd.nist.gov/vuln/detail/CVE-2022-31740)
* [CVE-2022-31741](https://nvd.nist.gov/vuln/detail/CVE-2022-31741)
* [CVE-2022-31742](https://nvd.nist.gov/vuln/detail/CVE-2022-31742)
* [CVE-2022-31747](https://nvd.nist.gov/vuln/detail/CVE-2022-31747)
* [CVE-2022-34468](https://nvd.nist.gov/vuln/detail/CVE-2022-34468)
* [CVE-2022-34470](https://nvd.nist.gov/vuln/detail/CVE-2022-34470)
* [CVE-2022-34472](https://nvd.nist.gov/vuln/detail/CVE-2022-34472)
* [CVE-2022-34478](https://nvd.nist.gov/vuln/detail/CVE-2022-34478)
* [CVE-2022-34479](https://nvd.nist.gov/vuln/detail/CVE-2022-34479)
* [CVE-2022-34481](https://nvd.nist.gov/vuln/detail/CVE-2022-34481)
* [CVE-2022-34484](https://nvd.nist.gov/vuln/detail/CVE-2022-34484)
* [CVE-2022-36318](https://nvd.nist.gov/vuln/detail/CVE-2022-36318)
* [CVE-2022-36319](https://nvd.nist.gov/vuln/detail/CVE-2022-36319)
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

August 10, 2022

**Latest revision**

August 10, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [794085](https://bugs.gentoo.org/show_bug.cgi?id=794085)
* [802759](https://bugs.gentoo.org/show_bug.cgi?id=802759)
* [807943](https://bugs.gentoo.org/show_bug.cgi?id=807943)
* [811912](https://bugs.gentoo.org/show_bug.cgi?id=811912)
* [813501](https://bugs.gentoo.org/show_bug.cgi?id=813501)
* [822294](https://bugs.gentoo.org/show_bug.cgi?id=822294)
* [828539](https://bugs.gentoo.org/show_bug.cgi?id=828539)
* [831040](https://bugs.gentoo.org/show_bug.cgi?id=831040)
* [833520](https://bugs.gentoo.org/show_bug.cgi?id=833520)
* [834805](https://bugs.gentoo.org/show_bug.cgi?id=834805)
* [845057](https://bugs.gentoo.org/show_bug.cgi?id=845057)
* [846596](https://bugs.gentoo.org/show_bug.cgi?id=846596)
* [849047](https://bugs.gentoo.org/show_bug.cgi?id=849047)
* [857048](https://bugs.gentoo.org/show_bug.cgi?id=857048)
* [864577](https://bugs.gentoo.org/show_bug.cgi?id=864577)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_827a400d_20250114_201519.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-49

## Security Vulnerabilities fixed in Firefox ESR 91.3

Announced
November 2, 2021
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.3

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Firefox before versions 94 and ESR 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Firefox for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Firefox could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of navigations, Firefox could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Firefox 93 and Firefox ESR 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 94 and Firefox ESR 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_ffa2d904_20250114_201511.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202202-03**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **97.0** |
| Unaffected versions | >= **91.6.0**>= **97.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-91.6.0:esr"

```

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-91.6.0:esr"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-97.0:rapid"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-97.0:rapid"

```
### References

* [CVE-2021-29970](https://nvd.nist.gov/vuln/detail/CVE-2021-29970)
* [CVE-2021-29972](https://nvd.nist.gov/vuln/detail/CVE-2021-29972)
* [CVE-2021-29974](https://nvd.nist.gov/vuln/detail/CVE-2021-29974)
* [CVE-2021-29975](https://nvd.nist.gov/vuln/detail/CVE-2021-29975)
* [CVE-2021-29976](https://nvd.nist.gov/vuln/detail/CVE-2021-29976)
* [CVE-2021-29977](https://nvd.nist.gov/vuln/detail/CVE-2021-29977)
* [CVE-2021-29980](https://nvd.nist.gov/vuln/detail/CVE-2021-29980)
* [CVE-2021-29981](https://nvd.nist.gov/vuln/detail/CVE-2021-29981)
* [CVE-2021-29982](https://nvd.nist.gov/vuln/detail/CVE-2021-29982)
* [CVE-2021-29984](https://nvd.nist.gov/vuln/detail/CVE-2021-29984)
* [CVE-2021-29985](https://nvd.nist.gov/vuln/detail/CVE-2021-29985)
* [CVE-2021-29986](https://nvd.nist.gov/vuln/detail/CVE-2021-29986)
* [CVE-2021-29987](https://nvd.nist.gov/vuln/detail/CVE-2021-29987)
* [CVE-2021-29988](https://nvd.nist.gov/vuln/detail/CVE-2021-29988)
* [CVE-2021-29989](https://nvd.nist.gov/vuln/detail/CVE-2021-29989)
* [CVE-2021-29990](https://nvd.nist.gov/vuln/detail/CVE-2021-29990)
* [CVE-2021-30547](https://nvd.nist.gov/vuln/detail/CVE-2021-30547)
* [CVE-2021-38491](https://nvd.nist.gov/vuln/detail/CVE-2021-38491)
* [CVE-2021-38493](https://nvd.nist.gov/vuln/detail/CVE-2021-38493)
* [CVE-2021-38495](https://nvd.nist.gov/vuln/detail/CVE-2021-38495)
* [CVE-2021-38503](https://nvd.nist.gov/vuln/detail/CVE-2021-38503)
* [CVE-2021-38504](https://nvd.nist.gov/vuln/detail/CVE-2021-38504)
* [CVE-2021-38506](https://nvd.nist.gov/vuln/detail/CVE-2021-38506)
* [CVE-2021-38507](https://nvd.nist.gov/vuln/detail/CVE-2021-38507)
* [CVE-2021-38508](https://nvd.nist.gov/vuln/detail/CVE-2021-38508)
* [CVE-2021-38509](https://nvd.nist.gov/vuln/detail/CVE-2021-38509)
* [CVE-2021-4129](https://nvd.nist.gov/vuln/detail/CVE-2021-4129)
* [CVE-2021-4140](https://nvd.nist.gov/vuln/detail/CVE-2021-4140)
* [CVE-2021-43536](https://nvd.nist.gov/vuln/detail/CVE-2021-43536)
* [CVE-2021-43537](https://nvd.nist.gov/vuln/detail/CVE-2021-43537)
* [CVE-2021-43538](https://nvd.nist.gov/vuln/detail/CVE-2021-43538)
* [CVE-2021-43539](https://nvd.nist.gov/vuln/detail/CVE-2021-43539)
* [CVE-2021-43540](https://nvd.nist.gov/vuln/detail/CVE-2021-43540)
* [CVE-2021-43541](https://nvd.nist.gov/vuln/detail/CVE-2021-43541)
* [CVE-2021-43542](https://nvd.nist.gov/vuln/detail/CVE-2021-43542)
* [CVE-2021-43543](https://nvd.nist.gov/vuln/detail/CVE-2021-43543)
* [CVE-2021-43545](https://nvd.nist.gov/vuln/detail/CVE-2021-43545)
* [CVE-2021-43546](https://nvd.nist.gov/vuln/detail/CVE-2021-43546)
* [CVE-2022-0511](https://nvd.nist.gov/vuln/detail/CVE-2022-0511)
* [CVE-2022-22737](https://nvd.nist.gov/vuln/detail/CVE-2022-22737)
* [CVE-2022-22738](https://nvd.nist.gov/vuln/detail/CVE-2022-22738)
* [CVE-2022-22739](https://nvd.nist.gov/vuln/detail/CVE-2022-22739)
* [CVE-2022-22740](https://nvd.nist.gov/vuln/detail/CVE-2022-22740)
* [CVE-2022-22741](https://nvd.nist.gov/vuln/detail/CVE-2022-22741)
* [CVE-2022-22742](https://nvd.nist.gov/vuln/detail/CVE-2022-22742)
* [CVE-2022-22743](https://nvd.nist.gov/vuln/detail/CVE-2022-22743)
* [CVE-2022-22745](https://nvd.nist.gov/vuln/detail/CVE-2022-22745)
* [CVE-2022-22747](https://nvd.nist.gov/vuln/detail/CVE-2022-22747)
* [CVE-2022-22748](https://nvd.nist.gov/vuln/detail/CVE-2022-22748)
* [CVE-2022-22751](https://nvd.nist.gov/vuln/detail/CVE-2022-22751)
* [CVE-2022-22753](https://nvd.nist.gov/vuln/detail/CVE-2022-22753)
* [CVE-2022-22754](https://nvd.nist.gov/vuln/detail/CVE-2022-22754)
* [CVE-2022-22755](https://nvd.nist.gov/vuln/detail/CVE-2022-22755)
* [CVE-2022-22756](https://nvd.nist.gov/vuln/detail/CVE-2022-22756)
* [CVE-2022-22757](https://nvd.nist.gov/vuln/detail/CVE-2022-22757)
* [CVE-2022-22758](https://nvd.nist.gov/vuln/detail/CVE-2022-22758)
* [CVE-2022-22759](https://nvd.nist.gov/vuln/detail/CVE-2022-22759)
* [CVE-2022-22760](https://nvd.nist.gov/vuln/detail/CVE-2022-22760)
* [CVE-2022-22761](https://nvd.nist.gov/vuln/detail/CVE-2022-22761)
* [CVE-2022-22762](https://nvd.nist.gov/vuln/detail/CVE-2022-22762)
* [CVE-2022-22763](https://nvd.nist.gov/vuln/detail/CVE-2022-22763)
* [CVE-2022-22764](https://nvd.nist.gov/vuln/detail/CVE-2022-22764)
* MOZ-2021-0004
* MOZ-2021-0005
* MOZ-2021-0006
* MOZ-2021-0007
* MOZ-2021-0008

**Release date**

February 21, 2022

**Latest revision**

February 21, 2022: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [802768](https://bugs.gentoo.org/show_bug.cgi?id=802768)
* [807947](https://bugs.gentoo.org/show_bug.cgi?id=807947)
* [813498](https://bugs.gentoo.org/show_bug.cgi?id=813498)
* [821385](https://bugs.gentoo.org/show_bug.cgi?id=821385)
* [828538](https://bugs.gentoo.org/show_bug.cgi?id=828538)
* [831039](https://bugs.gentoo.org/show_bug.cgi?id=831039)
* [832992](https://bugs.gentoo.org/show_bug.cgi?id=832992)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_28edad45_20250114_201509.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1366818)
* [XML](/show_bug.cgi?ctype=xml&id=1366818)

Closed
[Bug 1366818](/show_bug.cgi?id=1366818)
(CVE-2021-38508)

Opened 8 years ago
Closed 3 years ago

# Spoofing dialog and don't exit fullscreen mode

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Spoofing dialog and don't exit fullscreen mode

## Categories

### (Core :: DOM: Core & HTML, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

54 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

95 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox-esr91 | [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox93 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix) |
| firefox94 | [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified) |
| firefox95 | [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 |  | wontfix |
| firefox-esr91 | 94+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox93 |  | wontfix |
| firefox94 | + | verified |
| firefox95 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Laraweron, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d1c01b439cdad09c283ada379958e4ce?d=mm&size=40)  [Laraweron](/user_profile?user_id=580744)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

26 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1735429](/show_bug.cgi?id=1735429 "RESOLVED FIXED - Add tests for bug 1366818")

Dependency [tree](/showdependencytree.cgi?id=1366818&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1366818)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1736545](/show_bug.cgi?id=1736545 "RESOLVED FIXED - Crash in [@ nsWrapperCache::GetWrapper]")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1736341](/show_bug.cgi?id=1736341 "RESOLVED DUPLICATE - Permission prompt spoof via form validation UI")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1437219](/show_bug.cgi?id=1437219 "RESOLVED DUPLICATE - Addressbar spoofing attack with using fullscreen (popup show up over fullscreen mode and hide the fullscreen notification)"), [CVE-2021-38497](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open"), [CVE-2023-32205](/show_bug.cgi?id=1753339 "VERIFIED FIXED - Autofill prompt can render over browser UI and permission prompts, allows spoofing of browser UI")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [adv-main94+][adv-esr91.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-38508

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main94+][adv-esr91.3+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a139804262_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (15 files, 2 obsolete files)

| [dialog.jpg](/attachment.cgi?id=8870073)  [8 years ago](#c0)  [Raphael](/user_profile?user_id=580744)   89.73 KB, image/jpeg |  | [Details](/attachment.cgi?id=8870073&action=edit) |
| --- | --- | --- |
| [spoof(old\_not work).html](/attachment.cgi?id=8870075)  [8 years ago](#c1)  [Raphael](/user_profile?user_id=580744)   718 bytes, text/html |  | [Details](/attachment.cgi?id=8870075&action=edit) |
| [spoof2.html](/attachment.cgi?id=8870079)  [8 years ago](#c3)  [Raphael](/user_profile?user_id=580744)   3.27 KB, text/html |  | [Details](/attachment.cgi?id=8870079&action=edit) |
| [fullscreen.html](/attachment.cgi?id=8870080)  [8 years ago](#c4)  [Raphael](/user_profile?user_id=580744)   1.25 KB, text/html |  | [Details](/attachment.cgi?id=8870080&action=edit) |
| [spoof.html](/attachment.cgi?id=8870082)  [8 years ago](#c5)  [Raphael](/user_profile?user_id=580744)   313 bytes, text/html |  | [Details](/attachment.cgi?id=8870082&action=edit) |
| [Nightly.jpg](/attachment.cgi?id=8870299)  [8 years ago](#c9)  [Raphael](/user_profile?user_id=580744)   88.97 KB, image/jpeg |  | [Details](/attachment.cgi?id=8870299&action=edit) |
| [spoof2(Nightly-55ver).html](/attachment.cgi?id=8870300)  [8 years ago](#c10)  [Raphael](/user_profile?user_id=580744)   3.07 KB, text/html |  | [Details](/attachment.cgi?id=8870300&action=edit) |
| [Nightly\_2.jpg](/attachment.cgi?id=8870360)  [8 years ago](#c13)  [Raphael](/user_profile?user_id=580744)   74.58 KB, image/jpeg |  | [Details](/attachment.cgi?id=8870360&action=edit) |
| [Screenshot\_2.jpg](/attachment.cgi?id=9106012)  [5 years ago](#c18)  [Raphael](/user_profile?user_id=580744)   147.88 KB, image/jpeg |  | [Details](/attachment.cgi?id=9106012&action=edit) |
| [Bug 1366818 - Fix spoofing dialog for invalid form elements;](/attachment.cgi?id=9119063)  [5 years ago](#c26)  [John Dai[:jdai]](/user_profile?user_id=525840)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9119063&action=edit) | [Review](/attachment.cgi?id=9119063) |
| [spoof\_cover\_screenshot.png](/attachment.cgi?id=9119114)  [5 years ago](#c27)  [John Dai[:jdai]](/user_profile?user_id=525840)   159.30 KB, image/png |  | [Details](/attachment.cgi?id=9119114&action=edit) |
| [spoof\_cover\_chromium.png](/attachment.cgi?id=9119145)  [5 years ago](#c30)  [John Dai[:jdai]](/user_profile?user_id=525840)   111.53 KB, image/png |  | [Details](/attachment.cgi?id=9119145&action=edit) |
| [Bug 1366818 - Make pop-up notification on top of the window;](/attachment.cgi?id=9120509)  [5 years ago](#c36)  [John Dai[:jdai]](/user_profile?user_id=525840)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9120509&action=edit) | [Review](/attachment.cgi?id=9120509) |
| [spoof\_cover\_apply\_patch\_on\_windows.png](/attachment.cgi?id=9142304)  [5 years ago](#c42)  [John Dai[:jdai]](/user_profile?user_id=525840)   110.41 KB, image/png |  | [Details](/attachment.cgi?id=9142304&action=edit) |
| [Bug 1366818, r?emilio](/attachment.cgi?id=9236535)  [3 years ago](#c61)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c71 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c73 "3 years ago") | [Details](/attachment.cgi?id=9236535&action=edit) | [Review](/attachment.cgi?id=9236535) |
| [Bug 1366818 - part 2, r?emilio](/attachment.cgi?id=9236538)  [3 years ago](#c62)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9236538&action=edit) | [Review](/attachment.cgi?id=9236538) |
| [advisory.txt](/attachment.cgi?id=9248064)  [3 years ago](#c77)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   359 bytes, text/plain |  | [Details](/attachment.cgi?id=9248064&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1366818#c0)• 8 years ago |
|  | |

Attached image
[dialog.jpg](attachment.cgi?id=8870073)
— [Details](attachment.cgi?id=8870073&action=edit)

User Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36
Steps to reproduce:
Open Poc
1.spoof.html.(Fake Message Box)
2.spoof2.html (Spoofing Notification window)
3.fullscreen.html (Don't exit fullscreen mode)
Actual results:
SetCustomValidity method displays a message on top of all Windows, under certain circumstances, this may lead to the substitution of the message browser

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1366818#c1)• 8 years ago |
|  | |

Attached file
[spoof(old\_not work).html](attachment.cgi?id=8870075) (obsolete)
— [Details](attachment.cgi?id=8870075&action=edit)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1366818#c2)• 8 years ago |
|  | |

Comment on [attachment 8870075](/attachment.cgi?id=8870075 "spoof(old_not work).html") [[details]](/attachment.cgi?id=8870075&action=edit "spoof(old_not work).html")
spoof(old\_not work).html
<script>
function aaa()
{
window.open('[https://laraweron.mysit.ru/ff/2.html','palette\_navig2','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,copyhistory=no,width=1,height=1,screenX=400,screenY=1000](https://laraweron.mysit.ru/ff/2.html%27%2C%27palette_navig2%27%2C%27toolbar%3Dno%2Clocation%3Dno%2Cdirectories%3Dno%2Cstatus%3Dno%2Cmenubar%3Dno%2Cscrollbars%3Dno%2Cresizable%3Dno%2Ccopyhistory%3Dno%2Cwidth%3D1%2Cheight%3D1%2CscreenX%3D400%2CscreenY%3D1000)' );
}
</script>
<a href="<http://google.com>" onclick='aaa();'>click me</a>

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1366818#c3)• 8 years ago |
|  | |

Attached file
[spoof2.html](attachment.cgi?id=8870079)
— [Details](attachment.cgi?id=8870079&action=edit)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1366818#c4)• 8 years ago |
|  | |

Attached file
[fullscreen.html](attachment.cgi?id=8870080)
— [Details](attachment.cgi?id=8870080&action=edit)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a392_580744)• 8 years ago |

[Attachment #8870075](/attachment.cgi?id=8870075&action=edit "spoof(old_not work).html") -
Attachment description: spoof.html → spoof(old\_not work).html

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1366818#c5)• 8 years ago |
|  | |

Attached file
[spoof.html](attachment.cgi?id=8870082)
— [Details](attachment.cgi?id=8870082&action=edit)

|  | [Loic](/user_profile?user_id=337567) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a2985_337567)• 8 years ago |

Component: Untriaged → DOM: Core & HTMLProduct: Firefox → Core

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1366818#c6)• 8 years ago |
|  | |

I believe that this is a security errorGroup: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1366818#c7)• 8 years ago |
|  | |

I'm bouncing this back to front-end. The "Core" back-end components seem to be handling things OK and just set state; it's the UX that's wrong for both examples. The popup is positioned and displayed from browser/modules/FormSubmitObserver.jsm
1) the popup is displayed relative to the form element, but no attempt is made to make sure the form element is visible or on-screen. Web Content must not be able to trigger Web-supplied text into a chrome element that can float outside the browser window. By positioning the element just off screen the message pointer bleeds into the browser chrome and can spoof a legit door hanger, or in this case try to cover up part of one of our own door hangers.
NB: the spoof2 example is not terribly convincing in Nightly, in part because we've changed our UI and things no longer line up. Ignore the sloppiness, assume that with more care this could be customized to each platform and version. Focus instead on the fact that a floating top-most element has escaped the "line of death" (<https://textslashplain.com/2017/01/14/the-line-of-death/> )
2) the fullscreen example is annoying, but probably should be a separate bug. You can escape using hotkeys to switch to another tab, or Cmd-W to close the window. Why is this example able to eat the ESC that quits fullscreen, but not the others? In any case fullscreen content should never be able to evade ESC.
Gijs: what would be a better component for this bug?Component: DOM: Core & HTML → GeneralFlags: needinfo?(gijskruitbosch+bugs)Product: Core → Firefox

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a16901_1689)• 8 years ago |

Group: core-security → firefox-core-security

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1366818#c8)• 8 years ago |
|  | |

> NB: the spoof2 example is not terribly convincing in Nightly, in part
> because we've changed our UI and things no longer line up.
Changed the code for version 55 Firefox Nightly

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1366818#c9)• 8 years ago |
|  | |

Attached image
[Nightly.jpg](attachment.cgi?id=8870299)
— [Details](attachment.cgi?id=8870299&action=edit)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1366818#c10)• 8 years ago |
|  | |

Attached file
[spoof2(Nightly-55ver).html](attachment.cgi?id=8870300)
— [Details](attachment.cgi?id=8870300&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1366818#c11)• 8 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #7](/show_bug.cgi?id=1366818#c7 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
> I'm bouncing this back to front-end. The "Core" back-end components seem to
> be handling things OK and just set state; it's the UX that's wrong for both
> examples. The popup is positioned and displayed from
> browser/modules/FormSubmitObserver.jsm
>
> 1) the popup is displayed relative to the form element, but no attempt is
> made to make sure the form element is visible or on-screen.
Actually, this isn't quite true - we do make an 'attempt' to check the form element is visible, see [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"). I'm not sure why the focus manager thinks opacity:0 elements are focusable... we can add lazy bounds checking for the scroll position stuff, and/or constrain at what positions we allow the popup to open in the first place.
> Web Content must
> not be able to trigger Web-supplied text into a chrome element that can
> float outside the browser window.
This sounds like we should just stop showing custom validity error messages at all, then. We don't have in-browser-content-anchored popups.
> By positioning the element just off screen
> the message pointer bleeds into the browser chrome and can spoof a legit
> door hanger, or in this case try to cover up part of one of our own door
> hangers.
I don't think any interaction is possible with these form validity popups.
> NB: the spoof2 example is not terribly convincing in Nightly, in part
> because we've changed our UI and things no longer line up. Ignore the
> sloppiness, assume that with more care this could be customized to each
> platform and version. Focus instead on the fact that a floating top-most
> element has escaped the "line of death"
> (<https://textslashplain.com/2017/01/14/the-line-of-death/> )
>
> 2) the fullscreen example is annoying, but probably should be a separate
> bug.
Yes.
> You can escape using hotkeys to switch to another tab, or Cmd-W to
> close the window. Why is this example able to eat the ESC that quits
> fullscreen, but not the others? In any case fullscreen content should never
> be able to evade ESC.
The form submit popup eats escape to hide that popup, and it's reshown every 50ms because the form is submitted every 50ms.
IMO we should use the popup blocker (ie require user input) to control form submissions and/or the showing of these validity messages, but I don't know if that would break the web. What do other browsers that implement custom validity form submission checking do with this stuff?
> Gijs: what would be a better component for this bug?
Typically form validation stuff has lived in Core::DOM, judging by e.g. [bug 1088761](/show_bug.cgi?id=1088761 "RESOLVED FIXED - Add support for reportValidity() for form controls") and [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"), so I think the original component was correct... anyway, :jdai, are you able to take a look at this? I can help with reviews etc., but I don't have cycles to dive into this in detail right now.Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(jdai)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1366818#c12)• 8 years ago |
|  | |

In the 55th version of Firefox, the notification message about the geolocation is added to the alert, but there is no such word when using the function. (navigator.mediaDevices.getUserMedia)
I changed the code for version 55 Firefox.
Example: <http://laraweron.mysit.ru/ff/ff_night.html>
I assume that the function (navigator.mediaDevices.getUserMedia) requires a corresponding message.

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1366818#c13)• 8 years ago |
|  | |

Attached image
[Nightly\_2.jpg](attachment.cgi?id=8870360)
— [Details](attachment.cgi?id=8870360&action=edit)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1366818#c14)• 8 years ago |
|  | |

> > Gijs: what would be a better component for this bug?
>
> Typically form validation stuff has lived in Core::DOM, judging by e.g. bug
> 1088761 and [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"), so I think the original component was correct...
> anyway, :jdai, are you able to take a look at this? I can help with reviews
> etc., but I don't have cycles to dive into this in detail right now.
Sure. I would like to take this bug. I also set this bug to Core::DOM component. Feel free to reset component if anyone have concern.Assignee: nobody → jdaiGroup: firefox-core-securityStatus: UNCONFIRMED → ASSIGNEDComponent: General → DOMEver confirmed: trueFlags: needinfo?(jdai)Product: Firefox → Core

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1366818#c15)• 8 years ago |
|  | |

Re-adding the sec flag.Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1366818#c16)• 8 years ago |
|  | |

(In reply to :Gijs from [comment #11](/show_bug.cgi?id=1366818#c11 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
> I don't think any interaction is possible with these form validity popups.
No, but they can cover other elements and gain some authority by being able to appear anchored outside the content window. The screenshots here might be about the worst you can do: try to elicit clicks on some other permission prompt by "replacing" the text. It's not terribly convincing if you see these a lot (there's a drop shadow across the top of the buttons, plus the font/style is all wrong) but might fool a more casual user. Maybe put up a message "from the browser" about some emergency patch and when the user clicks open up a fake Mozilla site as part of a social engineering attack.Group: core-security → dom-core-securityComponent: DOM → DOM: Core & HTMLKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1366818#c17)• 8 years ago |
|  | |

After I tested other browsers behavior, Chrome and Safari have same behavior as firefox which means it'll keep showing popup window every small time period. The test is spoof2(Nightly-55ver).html.

|  | [Andrew Overholt [:overholt]](/user_profile?user_id=442218) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a9948190_442218)• 7 years ago |

Priority: -- → P3

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a20830598_525840)• 7 years ago |

Assignee: jdai → nobodyStatus: ASSIGNED → NEW

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a21534405_1689)• 7 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a25065700_1689)• 7 years ago |

See Also: → [1437219](/show_bug.cgi?id=1437219 "RESOLVED DUPLICATE - Addressbar spoofing attack with using fullscreen (popup show up over fullscreen mode and hide the fullscreen notification)")

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1366818#c18)• 5 years ago |
|  | |

Attached image
[Screenshot\_2.jpg](attachment.cgi?id=9106012)
— [Details](attachment.cgi?id=9106012&action=edit)

After two years, this bug has not been fixed why ?

Test PoC <https://karmaim.000webhostapp.com/2019.html>

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a77684872_1689)• 5 years ago |

Flags: needinfo?(dveditz) → needinfo?(htsai)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1366818#c19)• 5 years ago |
|  | |

Thanks for comments and reporting the issue. We weren't getting to the bug as we were working on other critical or higher priority issues according to the triage result. Thank you for the understanding.

Flags: needinfo?(htsai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1366818#c20)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1366818&comment_id=14489554 "1 revision") |
|  | |

(In reply to Raphael from [comment #18](/show_bug.cgi?id=1366818#c18 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Created [attachment 9106012](/attachment.cgi?id=9106012 "Screenshot_2.jpg") [[details]](/attachment.cgi?id=9106012&action=edit "Screenshot_2.jpg")
>
> Screenshot\_2.jpg
>
> After two years, this bug has not been fixed why ?
>
> Test PoC <https://karmaim.000webhostapp.com/2019.html>

Dear reporter,

I'm fixing [bug 1551758](/show_bug.cgi?id=1551758 "RESOLVED FIXED - Form submission reentrancy protection for 'submit' and 'invalid' event"), I hope it can fix this issue. Thank you for your patient.

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1366818#c21)• 5 years ago |
|  | |

(In reply to John Dai[:jdai] from [comment #20](/show_bug.cgi?id=1366818#c20 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to Raphael from [comment #18](/show_bug.cgi?id=1366818#c18 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > Created [attachment 9106012](/attachment.cgi?id=9106012 "Screenshot_2.jpg") [[details]](/attachment.cgi?id=9106012&action=edit "Screenshot_2.jpg")
> >
> > Screenshot\_2.jpg
> >
> > After two years, this bug has not been fixed why ?
> >
> > Test PoC <https://karmaim.000webhostapp.com/2019.html>
>
> Dear reporter,
>
> I'm fixing [bug 1551758](/show_bug.cgi?id=1551758 "RESOLVED FIXED - Form submission reentrancy protection for 'submit' and 'invalid' event"), I hope it can fix this issue. Thank you for your patient.

After fixed [bug 1551758](/show_bug.cgi?id=1551758 "RESOLVED FIXED - Form submission reentrancy protection for 'submit' and 'invalid' event"), It prevents keep showing popup window every small time period. However, it still show custom validity popups and cover part of door hanger in [spoof2(Nightly-55ver).html](https://bugzilla.mozilla.org/attachment.cgi?id=8870300).

(In reply to :Gijs (he/him) from [comment #11](/show_bug.cgi?id=1366818#c11 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to Daniel Veditz [:dveditz] from [comment #7](/show_bug.cgi?id=1366818#c7 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > I'm bouncing this back to front-end. The "Core" back-end components seem to
> >
> > be handling things OK and just set state; it's the UX that's wrong for both
> >
> > examples. The popup is positioned and displayed from
> >
> > browser/modules/FormSubmitObserver.jsm
> >
> > 1. the popup is displayed relative to the form element, but no attempt is
> >
> >    made to make sure the form element is visible or on-screen.
>
> Actually, this isn't quite true - we do make an 'attempt' to check the form
>
> element is visible, see [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"). I'm not sure why the focus manager
>
> thinks opacity:0 elements are focusable... we can add lazy bounds checking
>
> for the scroll position stuff, and/or constrain at what positions we allow
>
> the popup to open in the first place.

The test [spoof2(Nightly-55ver).html](https://bugzilla.mozilla.org/attachment.cgi?id=8870300) set `opacity:1` at test() function. In [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"), we did check form element visibility, however, we treat offscreen elements can be focused in [here](https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/dom/base/nsFocusManager.cpp#1521-1534). AFAICK, focus manager are following as spec said for offscreen elements can be focused. According below comments, I think we should stop showing form validity error messages if the elements are not in the browser's viewport. Does that sounds make sense to you?

> > Web Content must
> >
> > not be able to trigger Web-supplied text into a chrome element that can
> >
> > float outside the browser window.
>
> This sounds like we should just stop showing custom validity error messages
>
> at all, then. We don't have in-browser-content-anchored popups.
>
> > By positioning the element just off screen
> >
> > the message pointer bleeds into the browser chrome and can spoof a legit
> >
> > door hanger, or in this case try to cover up part of one of our own door
> >
> > hangers.
>
> I don't think any interaction is possible with these form validity popups.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1366818#c22)• 5 years ago |
|  | |

(In reply to John Dai[:jdai] from [comment #21](/show_bug.cgi?id=1366818#c21 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to John Dai[:jdai] from [comment #20](/show_bug.cgi?id=1366818#c20 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > (In reply to Raphael from [comment #18](/show_bug.cgi?id=1366818#c18 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
> >
> > > Created [attachment 9106012](/attachment.cgi?id=9106012 "Screenshot_2.jpg") [[details]](/attachment.cgi?id=9106012&action=edit "Screenshot_2.jpg")
> > >
> > > Screenshot\_2.jpg
> > >
> > > After two years, this bug has not been fixed why ?
> > >
> > > Test PoC <https://karmaim.000webhostapp.com/2019.html>
> >
> > Dear reporter,
> >
> > I'm fixing [bug 1551758](/show_bug.cgi?id=1551758 "RESOLVED FIXED - Form submission reentrancy protection for 'submit' and 'invalid' event"), I hope it can fix this issue. Thank you for your patient.
>
> After fixed [bug 1551758](/show_bug.cgi?id=1551758 "RESOLVED FIXED - Form submission reentrancy protection for 'submit' and 'invalid' event"), It prevents keep showing popup window every small time period. However, it still show custom validity popups and cover part of door hanger in [spoof2(Nightly-55ver).html](https://bugzilla.mozilla.org/attachment.cgi?id=8870300).
>
> (In reply to :Gijs (he/him) from [comment #11](/show_bug.cgi?id=1366818#c11 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > (In reply to Daniel Veditz [:dveditz] from [comment #7](/show_bug.cgi?id=1366818#c7 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
> >
> > > I'm bouncing this back to front-end. The "Core" back-end components seem to
> > >
> > > be handling things OK and just set state; it's the UX that's wrong for both
> > >
> > > examples. The popup is positioned and displayed from
> > >
> > > browser/modules/FormSubmitObserver.jsm
> > >
> > > 1. the popup is displayed relative to the form element, but no attempt is
> > >
> > >    made to make sure the form element is visible or on-screen.
> >
> > Actually, this isn't quite true - we do make an 'attempt' to check the form
> >
> > element is visible, see [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"). I'm not sure why the focus manager
> >
> > thinks opacity:0 elements are focusable... we can add lazy bounds checking
> >
> > for the scroll position stuff, and/or constrain at what positions we allow
> >
> > the popup to open in the first place.
>
> The test [spoof2(Nightly-55ver).html](https://bugzilla.mozilla.org/attachment.cgi?id=8870300) set `opacity:1` at test() function. In [bug 1319078](/show_bug.cgi?id=1319078 "RESOLVED FIXED - Form validation should account for the visibility/focusability of the input element"), we did check form element visibility, however, we treat offscreen elements can be focused in [here](https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/dom/base/nsFocusManager.cpp#1521-1534). AFAICK, focus manager are following as spec said for offscreen elements can be focused. According below comments, I think we should stop showing form validity error messages if the elements are not in the browser's viewport. Does that sounds make sense to you?

I think it makes sense not to show the validation error message if the element is outside the viewport. We can probably check this in the parent, and check that the point at which we're anchoring the validation popup is within the bounds of the frame for the originating browsing context.

However, we probably want to make sure that on a normal, non-bad-actor page, we scroll broken form elements that show the validity error into view? Maybe? Or are there spec reasons not to do that?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(jdai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1366818#c23)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1366818#c22 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> I think it makes sense not to show the validation error message if the element is outside the viewport. We can probably check this in the parent, and check that the point at which we're anchoring the validation popup is within the bounds of the frame for the originating browsing context.
>
> However, we probably want to make sure that on a normal, non-bad-actor page, we scroll broken form elements that show the validity error into view? Maybe? Or are there spec reasons not to do that?

The [spec](https://html.spec.whatwg.org/#interactively-validate-the-constraints) doesn't define UI behavior for validation popup and any focusable invalid fields will show the error outline. I expect we will show validation popup at first invalid element in the viewport, and show the error outline for focusable invalid elements which including outside the viewport's invalid elements.

Flags: needinfo?(jdai)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1366818#c24)• 5 years ago |
|  | |

(In reply to John Dai[:jdai] from [comment #23](/show_bug.cgi?id=1366818#c23 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1366818#c22 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > I think it makes sense not to show the validation error message if the element is outside the viewport. We can probably check this in the parent, and check that the point at which we're anchoring the validation popup is within the bounds of the frame for the originating browsing context.
> >
> > However, we probably want to make sure that on a normal, non-bad-actor page, we scroll broken form elements that show the validity error into view? Maybe? Or are there spec reasons not to do that?
>
> The [spec](https://html.spec.whatwg.org/#interactively-validate-the-constraints) doesn't define UI behavior for validation popup and any focusable invalid fields will show the error outline. I expect we will show validation popup at first invalid element in the viewport, and show the error outline for focusable invalid elements which including outside the viewport's invalid elements.

OK. Then yeah, this makes sense - are you able to work on this?

Flags: needinfo?(jdai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1366818#c25)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #24](/show_bug.cgi?id=1366818#c24 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to John Dai[:jdai] from [comment #23](/show_bug.cgi?id=1366818#c23 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1366818#c22 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
> >
> > > I think it makes sense not to show the validation error message if the element is outside the viewport. We can probably check this in the parent, and check that the point at which we're anchoring the validation popup is within the bounds of the frame for the originating browsing context.
> > >
> > > However, we probably want to make sure that on a normal, non-bad-actor page, we scroll broken form elements that show the validity error into view? Maybe? Or are there spec reasons not to do that?
> >
> > The [spec](https://html.spec.whatwg.org/#interactively-validate-the-constraints) doesn't define UI behavior for validation popup and any focusable invalid fields will show the error outline. I expect we will show validation popup at first invalid element in the viewport, and show the error outline for focusable invalid elements which including outside the viewport's invalid elements.
>
> OK. Then yeah, this makes sense - are you able to work on this?

Yes, I'm working on it. :-)

Flags: needinfo?(jdai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1366818#c26)• 5 years ago |
|  | |

Attached file
[Bug 1366818 - Fix spoofing dialog for invalid form elements;](attachment.cgi?id=9119063)
— [Details](attachment.cgi?id=9119063&action=edit)

If the invalid form element offscreen, it won't display validation popup

for user.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a82924588_600971)• 5 years ago |

Assignee: nobody → jdaiStatus: NEW → ASSIGNED

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1366818#c27)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1366818&comment_id=14577527 "4 revisions") |
|  | |

Attached image
[spoof\_cover\_screenshot.png](attachment.cgi?id=9119114)
— [Details](attachment.cgi?id=9119114&action=edit)

I'm not very familiar with the door hanger, but basically, we should make the geolocation door hanger at the top of the window, otherwise, form invalid pop-up still can cover the geolocation door hanger. Maybe adding `z-index` to the door hanger to achieve it, but I could be wrong.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1366818#c28)• 5 years ago |
|  | |

(In reply to John Dai[:jdai] from [comment #27](/show_bug.cgi?id=1366818#c27 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Created [attachment 9119114](/attachment.cgi?id=9119114 "spoof_cover_screenshot.png") [[details]](/attachment.cgi?id=9119114&action=edit "spoof_cover_screenshot.png")
>
> spoof\_cover\_screenshot.png
>
> I'm not very familiar with the door hanger, but basically we should make door hanger at the top of the window, otherwise, form invalid pop-up still can cover the door hanger. Maybe adding `z-index` to the door hanger to achieve it.

They're both popups, I don't know that we can specify a relative ordering. I don't *think* `z-index` comes into it, because they're different OS-level widgets - but I could well be wrong. Neil, do you know?

Flags: needinfo?(enndeakin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1366818#c29)• 5 years ago |
|  | |

We could also just make sure that form validation popups hide permission doorhangers and vice versa.

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1366818#c30)• 5 years ago |
|  | |

Attached image
[spoof\_cover\_chromium.png](attachment.cgi?id=9119145)
— [Details](attachment.cgi?id=9119145&action=edit)

(In reply to :Gijs (he/him) from [comment #29](/show_bug.cgi?id=1366818#c29 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> We could also just make sure that form validation popups hide permission doorhangers and vice versa.

Upload chromium behavior for reference.

|  | [(inactive) Nihanth Subramanya [:nhnt11]](/user_profile?user_id=481547) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1366818#c31)• 5 years ago |
|  | |

Gijs, Neil: Is it possible to enforce a rule where any doorhangers that are anchored to elements in web content are always displayed below doorhangers that are anchored to elements in browser chrome?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1366818#c32)• 5 years ago |
|  | |

(In reply to Nihanth Subramanya [:nhnt11] from [comment #31](/show_bug.cgi?id=1366818#c31 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Gijs, Neil: Is it possible to enforce a rule where any doorhangers that are anchored to elements in web content are always displayed below doorhangers that are anchored to elements in browser chrome?

The popups are in the parent and the anchor is in content; the popup manager has no idea we're "anchoring to content" because the parent process has no reference to the content process element. We just pass some coordinates from the content process and anchor on those in the parent. So no, I don't think we can do what you suggest in a 'general' sense, because the popup manager is not aware we're anchoring to a content element.

Note that in addition to the approach in the (current version of the) patch, we should also sanitize coordinates sent by the child in the parent to avoid displaying popups outside of the browser viewport, to avoid the same attack being possible from a compromised child process.

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1366818#c33)• 5 years ago |
|  | |

We don't have a mechanism to change the level of a popup while it is open. The workaround is to just close the popups and reopen them in the order you want. It might be possible to implement something that just calls nsIWidget::Show or something similar to what it does.

Flags: needinfo?(enndeakin)

|  | [(inactive) Nihanth Subramanya [:nhnt11]](/user_profile?user_id=481547) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1366818#c34)• 5 years ago |
|  | |

(In reply to Neil Deakin from [comment #33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> We don't have a mechanism to change the level of a popup while it is open. The workaround is to just close the popups and reopen them in the order you want. It might be possible to implement something that just calls nsIWidget::Show or something similar to what it does.

Is it possible to set the level of a popup just before showing it? i.e. if we have a popup A already open, can we control whether a new popup B gets shown above or below it?

(In reply to :Gijs (he/him) from [comment #32](/show_bug.cgi?id=1366818#c32 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to Nihanth Subramanya [:nhnt11] from [comment #31](/show_bug.cgi?id=1366818#c31 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > Gijs, Neil: Is it possible to enforce a rule where any doorhangers that are anchored to elements in web content are always displayed below doorhangers that are anchored to elements in browser chrome?
>
> The popups are in the parent and the anchor is in content; the popup manager has no idea we're "anchoring to content" because the parent process has no reference to the content process element. We just pass some coordinates from the content process and anchor on those in the parent. So no, I don't think we can do what you suggest in a 'general' sense, because the popup manager is not aware we're anchoring to a content element.
>
> Note that in addition to the approach in the (current version of the) patch, we should also sanitize coordinates sent by the child in the parent to avoid displaying popups outside of the browser viewport, to avoid the same attack being possible from a compromised child process.

Whoever is passing the coordinates should know though, right? Can we force consumers to declare their intent and rely on developers and reviewers to pass the right one?

Flags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1366818#c35)• 5 years ago |
|  | |

> Is it possible to set the level of a popup just before showing it? i.e. if we have a popup A already open, can we control whether a new popup B gets shown above or below it?

Well, one can always implement code that does this, or implement any window ordering behaviour. But since we only have a need to open a popup frontmost, we don't have any code that manipulates the ordering of popups, either before or after they have been opened.

Implementing this would require work on each platform's widget code.

Flags: needinfo?(enndeakin)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1366818#c36)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1366818&comment_id=14589443 "3 revisions") |
|  | |

Attached file
[Bug 1366818 - Make pop-up notification on top of the window;](attachment.cgi?id=9120509)
— [Details](attachment.cgi?id=9120509&action=edit)

This patch makes the door hanger pop-up on top of the window, form validation pop-up default set level by the parent so that we can make sure the door hanger will be top of form validation pop-up. Note: This patch only works well on MacOS, not for Linux now.

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1366818#c37)• 5 years ago |
|  | |

Hey, can you help us understand what the next step is here? Thanks!

Flags: needinfo?(jdai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1366818#c38)• 5 years ago |
|  | |

Hi Emilio,

Per [comment 36](/show_bug.cgi?id=1366818#c36 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), I made the notification pop-up at the top of the window on macOS so that the form validation pop-up will under notification pop-up, however, it requires some work on each platform. Is it possible to support at Layout? If not, maybe [comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") is another way to approach. Thank you.

Flags: needinfo?(jdai) → needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1366818#c39)• 5 years ago |
|  | |

So is the issue that gtk widgets don't honor `level="top"`? That's not really a layout issue, it's a Widget :: Gtk issue.

I'm happy to poke at it if necessary, though it may be worth pinging the folks with more GTK background (Martin Stransky, Karl Tomlinson) first.

Also, does your patch work on Windows?

It's not clear to me what concrete thing you want to do with [comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")? We could theoretically support dynamic switching of popup levels, maybe. At least I think in GTK it is possible.

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1366818#c40)• 5 years ago |
|  | |

Also, level="top" may ignore other windows that aren't Firefox, is that what you want?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1366818#c41)• 5 years ago |
|  | |

How hard would it be to reimplement the form validation popup and display it in the child instead, using the [same layers / anon content as the devtools inspector & co](https://searchfox.org/mozilla-central/rev/72e3388f74458d369af4f6cdbaeaacb719523b8c/devtools/server/actors/highlighters/utils/markup.js#300) (so it can't be interfered with by web content)? This would also fix the positioning issues we've had with this generally, would mean it automatically goes away if the document unloads, etc. It'd also make it easier for this code to live in the child instead of requiring IPC at all... It could also potentially live more in C++ land which may be more comfortable for the DOM folks who've been working on this?

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1366818#c42)• 5 years ago |
|  | |

Attached image
[spoof\_cover\_apply\_patch\_on\_windows.png](attachment.cgi?id=9142304)
— [Details](attachment.cgi?id=9142304&action=edit)

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #39](/show_bug.cgi?id=1366818#c39 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> So is the issue that gtk widgets don't honor `level="top"`? That's not really a layout issue, it's a Widget :: Gtk issue.

Yes, it seems the `level="top"` can't work on Linux platform.

> I'm happy to poke at it if necessary, though it may be worth pinging the folks with more GTK background (Martin Stransky, Karl Tomlinson) first.
>
> Also, does your patch work on Windows?

Yes, it work on windows, please check the attachment file.

> It's not clear to me what concrete thing you want to do with [comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")? We could theoretically support dynamic switching of popup levels, maybe. At least I think in GTK it is possible.

[Comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") seems to remember and recognize all the pop-up so that it can close all the pop-up then open the notification pop-up at front. I will redirect to GTK forks. Thank you.

Hi Karl,

Base on GTK background, do you think [comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), [comment 38](/show_bug.cgi?id=1366818#c38 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") or [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") is more approachable? Thank you.

Flags: needinfo?(karlt)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1366818#c43)• 5 years ago |
|  | |

[Comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") sounds like the preferred solution to me. Pop-ups are only needed when there is a desire to extend some display beyond the bounds of the browser main window or above other windows. Each of those are non-goals for the prompt message.

Having content messages in a pop-up blurs the boundaries of chrome and content. Tooltips are also popups containing content messages, but I feel uncomfortable about them also.

I don't know how approachable the solution of [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") is due to existing dependence on existing infrastructure, but it would be worth checking and [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") seems to indicate that it has been achieved before. (I'm not clear that moving to C++ would be an advantage though.)

Having form validation messages implemented in the child would mean they would not look like native pop-ups, but that may be an advantage to clarify the chrome/content boundary.

I'm not clear on the distinction between [comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") and [comment 38](/show_bug.cgi?id=1366818#c38 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode").

Closing and re-opening windows ([comment 33](/show_bug.cgi?id=1366818#c33 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")) depends on having a list of unrelated popups and would lead to some flickering. Essentially it is a way to implement level="top" ([comment 38](/show_bug.cgi?id=1366818#c38 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")). There may be a better way, but I don't know because this is not something that is normally required.

Pop-ups are usually either transient (tooltips) or have focus and only one window has focus at a time, so that it can be dismissed with Esc, for example. If there is more than one pop-up, then they are related and have a hierarchy so that it is clear which has focus.

By only showing pop-ups when the app has focus, apps don't compete with each other to show the foremost window.

Here, both pop-ups are within the same app, but the same issues with competing for attention are involved, and I assume Esc does not dismiss one of the pop-ups. How would the user know which popup Esc would dismiss?

It is also a bug if content can steal focus without user action.

If [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") is not an option, then, rather than trying to set z-levels for pop-ups, I'd suggest ensuring that popups are dismissed when they (or their parent widgets) lose focus.

Flags: needinfo?(karlt)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1366818#c44)• 5 years ago |
|  | |

[Comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") would also fix some long-standing issues with these popups, like these sticking around when scrolling and so on.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1366818#c45)• 5 years ago |
|  | |

Isn't [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") really hard because of same issues we've had with <select size=1> popup, when the document causing the popup is some cross-origin iframe. iframe which is triggering the popup maybe really small and using parent document's area to show the popup would be cross-origin information leak.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1366818#c46)• 5 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #45](/show_bug.cgi?id=1366818#c45 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Isn't [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") really hard because of same issues we've had with <select size=1> popup, when the document causing the popup is some cross-origin iframe. iframe which is triggering the popup maybe really small and using parent document's area to show the popup would be cross-origin information leak.

My understanding is that the highlighter code from the inspector uses native anon content and therefore isn't web-observable, so I wouldn't have thought so (ie even if we inserted in the parent document)? I mean, there might be mouseenter events or such, but I would not expect that to be any worse than with the chrome overlay we have now...

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1366818#c47)• 5 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #45](/show_bug.cgi?id=1366818#c45 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Isn't [comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") really hard because of same issues we've had with <select size=1> popup, when the document causing the popup is some cross-origin iframe. iframe which is triggering the popup maybe really small and using parent document's area to show the popup would be cross-origin information leak.

But `<select>` has to render outside of the viewport of the iframe to be usable. Maybe we don't have the same constraint with form popups. They're less critical IMHO.

> My understanding is that the highlighter code from the inspector uses native anon content and therefore isn't web-observable, so I wouldn't have thought so (ie even if we inserted in the parent document)? I mean, there might be mouseenter events or such, but I would not expect that to be any worse than with the chrome overlay we have now...

In presence of spectre I think you can pretty much assume that every data that goes through the process can be observed, even if not trivially.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1366818#c48)• 5 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #47](/show_bug.cgi?id=1366818#c47 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> But `<select>` has to render outside of the viewport of the iframe to be usable. Maybe we don't have the same constraint with form popups. They're less critical IMHO.

Really? How would we position the popup in an iframe which is very small? Or not show them at all? That would be rather breaking change.

(When <select> was discussed, it was suggested that small iframes with <select> would be rare, but it took like 5 minutes to find examples. So I have no particular trust that there aren't small iframes which trigger popups)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1366818#c49)• 5 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #48](/show_bug.cgi?id=1366818#c48 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Really? How would we position the popup in an iframe which is very small? Or not show them at all? That would be rather breaking change.
>
> (When <select> was discussed, it was suggested that small iframes with <select> would be rare, but it took like 5 minutes to find examples. So I have no particular trust that there aren't small iframes which trigger popups)

I assume it'd just get clipped by the viewport of the iframe. Select is different because you need to see the popup to interact with it, and the popup can get much larger than the form validation popups.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1366818#c50)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1366818&comment_id=14788715 "2 revisions") |
|  | |

So basically the popup wouldn't be shown at all if we want to show also the relevant form control.

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1366818#c51)• 4 years ago |
|  | |

John, are you actively working on this sec issue?

Flags: needinfo?(jdai)

|  | [John Dai[:jdai]](/user_profile?user_id=525840) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1366818#c52)• 4 years ago |
|  | |

(In reply to Neha Kochar [:neha] from [comment #51](/show_bug.cgi?id=1366818#c51 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> John, are you actively working on this sec issue?

No, I'm not working on this sec issue.

Flags: needinfo?(jdai)

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1366818#c53)• 4 years ago |
|  | |

Jens, could you pls find another assignee for this if jdai isn't planning to work on this?

Flags: needinfo?(jstutte)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a128323826_1689)• 4 years ago |

[Attachment #8870075](/attachment.cgi?id=8870075&action=edit "spoof(old_not work).html") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1366818#c54)• 4 years ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #43](/show_bug.cgi?id=1366818#c43 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> [Comment 41](/show_bug.cgi?id=1366818#c41 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode") sounds like the preferred solution to me. Pop-ups are only needed when there is a desire to extend some display beyond the bounds of the browser main window or above other windows. Each of those are non-goals for the prompt message.

Anti-goals, even.

Keep content-generated messages in content, like we've done with javascript alerts/prompts. We've long talked about the "[line of death](https://textslashplain.com/2017/01/14/the-line-of-death/)" in browser UI, but it's a "plane of death", too. If it web-generated content floats up into a new OS plane it becomes confusable with browser UI, or can be used to hide legit browser UI (as here). Looks cool, but any feature like it ends up causing us no end of problems.

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1366818#c55)• 4 years ago |
|  | |

Hi Olli, Emilio, can you briefly re-state what is the desired behavior now here and what should be implemented? From reading the comments I am not having the impression that we reached consensus already, but I might just not have enough context.

Flags: needinfo?(emilio)Flags: needinfo?(bugs)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1366818#c56)• 4 years ago |
|  | |

So there are multiple things that could be done here. Tweaking the z-index of the form message panel might be the easiest. Others like rendering them on the child etc are a bit trickier, as Olli noted in [comment 50](/show_bug.cgi?id=1366818#c50 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), and would probably at least need UX input.

I suspect Gijs is probably in a better position to assess the different trade-offs here, though he's on PTO... Perhaps Johann would have feedback?

Flags: needinfo?(emilio) → needinfo?(jhofmann)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a129159850_646284)• 4 years ago |

Flags: needinfo?(jstutte)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a130119114_159069)• 4 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1366818#c57)• 4 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #56](/show_bug.cgi?id=1366818#c56 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> So there are multiple things that could be done here. Tweaking the z-index of the form message panel might be the easiest.

This isn't really *that* easy, I think? It's a `panel` right now, so it's not in the same widget level window as the main window, which is why it appears on top of everything else. To make it lower z-index than the full screen warning we'd either need a bunch of work on panel widget code (see [comment 35](/show_bug.cgi?id=1366818#c35 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode")), or have it no longer be a panel, instead absolutely positioning something on top of web content that lives inside the same widget window. I don't know how likely that is to cause issues; in the past there was an effort to split the browser up into different "zones" for web rendering / gfx's benefit, but I think that project didn't end up going anywhere. I don't know if making similar work harder is a problem. In this case we'd also need to re-implement its dismissal ourselves (ie hide it when other stuff gets focus or escape is pressed, which right now the panel code deals with for us).

> Others like rendering them on the child etc are a bit trickier, as Olli noted in [comment 50](/show_bug.cgi?id=1366818#c50 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), and would probably at least need UX input.

I'm a little confused. Why can't we show them using the toplevel child? Yes, this might leak information to the top frame from the inner frame in the presence of spectre/meltdown; are there reasonable cases where this is problematic, the inner frame doesn't want to / can't use `X-Frame-Options` or similar, and the presence/absence of a form validation popup would be quite that interesting to the toplevel child? I'm struggling to imagine such a situation, especially as the toplevel likely can't engineer a situation where such a validation popup would appear for the inner frame (ie that'd depend on user input and/or the behaviour of the prospective victim site), and even where it does, its wording is likely not predictable. But either way, it doesn't really have any UX implications that way, right? (ni for this)

> I suspect Gijs is probably in a better position to assess the different trade-offs here, though he's on PTO... Perhaps Johann would have feedback?

Other options that would help here would be not showing form validation warnings if the form is auto-submitted (no user interaction), or not re-showing the warning for the same document / browsing context more than once (but it may be tricky to keep track of that information).

Ultimately I think anything other than a band-aid is likely to need significant re-architecturing work, which does also mean it's more important we pick the right solution, which I guess is why this bug hasn't progressed much - it's hard to determine which solution is least-bad.

In terms of band-aids, we could add code to the form validation popup that checks for other open popups (checking with `querySelectorAll` + checking the popups' `state` properties) before allowing it to open, and/or hides itself if other panels/popups open (by listening for `popupshowing` events). Does that seem like a reasonable enough fix here? (ni for this also) Because perhaps then we should just opt for that rather than spend more time debating the pros and cons of the various options to completely redo the implementation...

Flags: needinfo?(jhofmann)Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1366818#c58)• 4 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #57](/show_bug.cgi?id=1366818#c57 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> > Others like rendering them on the child etc are a bit trickier, as Olli noted in [comment 50](/show_bug.cgi?id=1366818#c50 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), and would probably at least need UX input.
>
> I'm a little confused. Why can't we show them using the toplevel child? Yes, this might leak information to the top frame from the inner frame in the presence of spectre/meltdown; are there reasonable cases where this is problematic, the inner frame doesn't want to / can't use `X-Frame-Options` or similar, and the presence/absence of a form validation popup would be quite that interesting to the toplevel child? I'm struggling to imagine such a situation, especially as the toplevel likely can't engineer a situation where such a validation popup would appear for the inner frame (ie that'd depend on user input and/or the behaviour of the prospective victim site), and even where it does, its wording is likely not predictable. But either way, it doesn't really have any UX implications that way, right? (ni for this)

One could argue that on a small window a custom validation message might want to overflow the content area... But that's an issue as soon as we get away from `<panel>`s. I don't think the space there is a huge issue if we're willing to accept that, though I don't know if that would be acceptable security-wise.

> > I suspect Gijs is probably in a better position to assess the different trade-offs here, though he's on PTO... Perhaps Johann would have feedback?
>
> Other options that would help here would be not showing form validation warnings if the form is auto-submitted (no user interaction), or not re-showing the warning for the same document / browsing context more than once (but it may be tricky to keep track of that information).

The user-interaction bit at least seems relatively straight forward. We have a `HasValidUserGestureActivation` on the window context.

> Ultimately I think anything other than a band-aid is likely to need significant re-architecturing work, which does also mean it's more important we pick the right solution, which I guess is why this bug hasn't progressed much - it's hard to determine which solution is least-bad.

Nod.

> In terms of band-aids, we could add code to the form validation popup that checks for other open popups (checking with `querySelectorAll` + checking the popups' `state` properties) before allowing it to open, and/or hides itself if other panels/popups open (by listening for `popupshowing` events). Does that seem like a reasonable enough fix here? (ni for this also) Because perhaps then we should just opt for that rather than spend more time debating the pros and cons of the various options to completely redo the implementation...

There may be multiple form validation popups, that's one of the tricky cases I guess. The popup manager does keep track of all the open popups so we could use that... I guess it depends on how urgently should we fix this, but not opposed to such a band-aid.

Flags: needinfo?(emilio)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1366818#c59)• 3 years ago |
|  | |

That band-aid could in practice work rather well.

Assignee: jdai → nobodyStatus: ASSIGNED → NEW

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1366818#c60)• 3 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #58](/show_bug.cgi?id=1366818#c58 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> (In reply to :Gijs (he/him) from [comment #57](/show_bug.cgi?id=1366818#c57 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))
>
> > In terms of band-aids, we could add code to the form validation popup that checks for other open popups (checking with `querySelectorAll` + checking the popups' `state` properties) before allowing it to open, and/or hides itself if other panels/popups open (by listening for `popupshowing` events). Does that seem like a reasonable enough fix here? (ni for this also) Because perhaps then we should just opt for that rather than spend more time debating the pros and cons of the various options to completely redo the implementation...
>
> There may be multiple form validation popups, that's one of the tricky cases I guess. The popup manager does keep track of all the open popups so we could use that... I guess it depends on how urgently should we fix this, but not opposed to such a band-aid.

There's only 1 popup per parent browser window, and I guess I would expect that switching parent/browser windows will hide popups in the other window anyway. This appears to work for me, so the WIP patch I'm about to put up doesn't do anything explicit to deal with that case.

Flags: needinfo?(bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1366818#c61)• 3 years ago |
|  | |

Attached file
[Bug 1366818, r?emilio](attachment.cgi?id=9236535)
— [Details](attachment.cgi?id=9236535&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a133679420_600971)• 3 years ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1366818#c62)• 3 years ago |
|  | |

Attached file
[Bug 1366818 - part 2, r?emilio](attachment.cgi?id=9236538) (obsolete)
— [Details](attachment.cgi?id=9236538&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a134107738_159069)• 3 years ago |

See Also: → [CVE-2021-38497](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open")

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1366818#c63)• 3 years ago |
|  | |

Vulnerability fixed, what's next?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1366818#c64)• 3 years ago |
|  | |

(In reply to Raphael from [comment #63](/show_bug.cgi?id=1366818#c63 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"))

> Vulnerability fixed, what's next?

[Bug 1726621](/show_bug.cgi?id=1726621 "VERIFIED FIXED - Show form validationMessage on any website with window.open") may have helped a bit, but the problem in [attachment 8870079](/attachment.cgi?id=8870079 "spoof2.html") [[details]](/attachment.cgi?id=8870079&action=edit "spoof2.html") is not fixed yet, AFAIK. I need to update the patches that I wrote here, add automated tests, and then land them - but I've been out for most of the past 7 weeks and I haven't gotten around to it.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1366818#c65)• 3 years ago |
|  | |

I filed [bug 1735327](/show_bug.cgi?id=1735327 "NEW - Try only showing form validation information when the document has transient user activation (ie when form submission / a reportValidity call is the result of user action)") for requiring user action for form validation UI to be shown (ie the current "part 2" patch here that I'll likely abandon - I'm not sure I'll find time to put it in 1735327, as doing this "properly" will also involve updating all the automated tests for this code...).

I'll work on getting part 1 ready to land in this bug, to address the sec issue.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138609155_159069)• 3 years ago |

Blocks: [1735429](/show_bug.cgi?id=1735429 "RESOLVED FIXED - Add tests for bug 1366818")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138609492_600971)• 3 years ago |

[Attachment #9236538](/attachment.cgi?id=9236538&action=edit "Bug 1366818 - part 2, r?emilio") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138609507_600971)• 3 years ago |

[Attachment #9236535](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio") -
Attachment description: Bug 1366818, part 1, r?emilio → Bug 1366818, r?emilio

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1366818#c66)• 3 years ago |
|  | |

r=emilio

<https://hg.mozilla.org/integration/autoland/rev/69569fc1cf6f4c84ea80903aa056bb7c2f3d25c6>

<https://hg.mozilla.org/mozilla-central/rev/69569fc1cf6f>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 95 Branch

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1366818#c67)• 3 years ago |
|  | |

Comment on [attachment 9236535](/attachment.cgi?id=9236535 "Bug 1366818, r?emilio") [[details]](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio")

[Bug 1366818](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), r?emilio

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-moderate issue (spoofing of browser messaging)
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Open [attachment 8870300](/attachment.cgi?id=8870300 "spoof2(Nightly-55ver).html") [[details]](/attachment.cgi?id=8870300&action=edit "spoof2(Nightly-55ver).html"). The form validation popup with custom text should not appear persistently at the same time as the geolocation permission popup.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Relatively straightforward JS only changes to form validation panels opening/hiding, which have pre-existing automated tests (I'm adding a test for this issue too but it's not landing until we've landed this fix on supported branches or decided not to).
* **String changes made/needed**: Nope

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate
* **User impact if declined**: See above
* **Fix Landed on Version**: 95
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: See above
* **String or UUID changes made by this patch**: Nope
[Attachment #9236535](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio") -
Flags: approval-mozilla-esr91?
[Attachment #9236535](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio") -
Flags: approval-mozilla-beta?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138676102_159069)• 3 years ago |

Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138702508_75935)• 3 years ago |

[status-firefox93](/buglist.cgi?f1=cf_status_firefox93&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox93&o1=equals&v1=wontfix)
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox94](/buglist.cgi?f1=cf_tracking_firefox94&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%2B)
[tracking-firefox95](/buglist.cgi?f1=cf_tracking_firefox95&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [94+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=94%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1366818#c68)• 3 years ago |
|  | |

Changing the priority to p1 as the bug is tracked by a release manager for the current beta.

See [What Do You Triage](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html) for more information

Priority: P3 → P1

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a138723449_458186)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1366818#c69)• 3 years ago |
|  | |

Reproduced the issue with the the custom text pop-up being displayed on top of the geolocation permission pop-up using an old Nightly build from 2021-10-11. Verified that using latest Nightly build across platforms (Windows 10, Ubuntu 18.04 and macOS 11.6) this does not happen anymore. The text pop-up is displayed after the geolocation one is dismissed.

[status-firefox95](/buglist.cgi?f1=cf_status_firefox95&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox95&o1=equals&v1=verified)

|  | [Raphael](/user_profile?user_id=580744)  Reporter |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1366818#c70)• 3 years ago |
|  | |

I am sincerely glad that after five years the error has been fixed. The expiration date of the error reward has not expired yet ?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1366818#c71)• 3 years ago |
|  | |

Comment on [attachment 9236535](/attachment.cgi?id=9236535 "Bug 1366818, r?emilio") [[details]](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio")

[Bug 1366818](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), r?emilio

Approved for 94.0b7.

[Attachment #9236535](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1366818#c72)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/0abafedb0d37>

[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1366818#c73)• 3 years ago |
|  | |

Comment on [attachment 9236535](/attachment.cgi?id=9236535 "Bug 1366818, r?emilio") [[details]](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio")

[Bug 1366818](/show_bug.cgi?id=1366818 "VERIFIED FIXED - Spoofing dialog and don't exit fullscreen mode"), r?emilio

Approved for 91.3esr.

[Attachment #9236535](/attachment.cgi?id=9236535&action=edit "Bug 1366818, r?emilio") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1366818#c74)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/41aba950cd86>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1366818#c75)• 3 years ago |
|  | |

Also verified that this is also fixed on 94.0b7 and latest esr91 build from treeherder across platforms (Windows 10, Ubuntu 18.04 and macOS 11.6).

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox94](/buglist.cgi?f1=cf_status_firefox94&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox94&o1=equals&v1=verified)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a139178331_546716)• 3 years ago |

Regressions: [1736545](/show_bug.cgi?id=1736545 "RESOLVED FIXED - Crash in [@ nsWrapperCache::GetWrapper]")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a139698420_578488)• 3 years ago |

Flags: sec-bounty?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a139710973_578488)• 3 years ago |

Whiteboard: [adv-main94+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a139804262_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1366818#c77)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9248064)
— [Details](attachment.cgi?id=9248064&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a139886906_578488)• 3 years ago |

Whiteboard: [adv-main94+] → [adv-main94+][adv-esr91.3+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a140306566_578488)• 3 years ago |

Alias: CVE-2021-38508

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a148945713_691597)• 3 years ago |

See Also: → [CVE-2023-32205](/show_bug.cgi?id=1753339 "VERIFIED FIXED - Autofill prompt can render over browser UI and permission prompts, allows spoofing of browser UI")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a166110095_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1366818#a221615849_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1366818&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Raphael](/user_profile?user_id=580744)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0e2a32c7_20250114_201520.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2021-50

## Security Vulnerabilities fixed in Thunderbird 91.3

Announced
November 3, 2021
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.3

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*
This advisory was updated January 17, 2023 to add CVE-2021-43529. This fix was included in the original release of Thunderbird 91.3, but did not appear in the advisory published at that time.

#### [#CVE-2021-43529: Memory corruption when processing S/MIME messages](#CVE-2021-43529)

Reporter
Tavis Ormandy
Impact
critical
##### Description

Thunderbird versions prior to 91.3.0 are vulnerable to the heap overflow described in CVE-2021-43527 when processing S/MIME messages. Thunderbird versions 91.3.0 and later will not call the vulnerable code when processing S/MIME messages that contain certificates with DER-encoded DSA or RSA-PSS signatures.
Note: This advisory was added on January 17, 2023 after discovering it was inadvertently left out of the original advisory. The fix was included in the original release of Thunderbird 91.3.

##### References

* [Bug 1738501](https://bugzilla.mozilla.org/show_bug.cgi?id=1738501)

#### [#CVE-2021-38503: iframe sandbox rules did not apply to XSLT stylesheets](#CVE-2021-38503)

Reporter
Armin Ebert
Impact
high
##### Description

The iframe sandbox rules were not correctly applied to XSLT stylesheets, allowing an iframe to bypass restrictions such as executing scripts or navigating the top-level frame.

##### References

* [Bug 1729517](https://bugzilla.mozilla.org/show_bug.cgi?id=1729517)

#### [#CVE-2021-38504: Use-after-free in file picker dialog](#CVE-2021-38504)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When interacting with an HTML input element's file picker dialog with `webkitdirectory` set, a use-after-free could have resulted, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1730156](https://bugzilla.mozilla.org/show_bug.cgi?id=1730156)

#### [#CVE-2021-38505: Windows 10 Cloud Clipboard may have recorded sensitive user data](#CVE-2021-38505)

Reporter
Sergey Galich
Impact
high
##### Description

Microsoft introduced a new feature in Windows 10 known as Cloud Clipboard which, if enabled, will record data copied to the clipboard to the cloud, and make it available on other computers in certain scenarios. Applications that wish to prevent copied data from being recorded in Cloud History must use specific clipboard formats; and Thunderbird before version 91.3 did not implement them. This could have caused sensitive data to be recorded to a user's Microsoft account.
*This bug only affects Thunderbird for Windows 10+ with Cloud Clipboard enabled. Other operating systems are unaffected.*

##### References

* [Bug 1730194](https://bugzilla.mozilla.org/show_bug.cgi?id=1730194)

#### [#CVE-2021-38506: Thunderbird could be coaxed into going into fullscreen mode without notification or warning](#CVE-2021-38506)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of web navigations, Thunderbird could have entered fullscreen mode without notification or warning to the user. This could lead to spoofing attacks on the browser UI including phishing.

##### References

* [Bug 1730750](https://bugzilla.mozilla.org/show_bug.cgi?id=1730750)

#### [#CVE-2021-38507: Opportunistic Encryption in HTTP2 could be used to bypass the Same-Origin-Policy on services hosted on other ports](#CVE-2021-38507)

Reporter
Takeshi Terada
Impact
high
##### Description

The Opportunistic Encryption feature of HTTP2 (RFC 8164) allows a connection to be transparently upgraded to TLS while retaining the visual properties of an HTTP connection, including being same-origin with unencrypted connections on port 80. However, if a second encrypted port on the same IP address (e.g. port 8443) did not opt-in to opportunistic encryption; a network attacker could forward a connection from the browser to port 443 to port 8443, causing the browser to treat the content of port 8443 as same-origin with HTTP. This was resolved by disabling the Opportunistic Encryption feature, which had low usage.

##### References

* [Bug 1730935](https://bugzilla.mozilla.org/show_bug.cgi?id=1730935)

#### [#CVE-2021-43535: Use-after-free in HTTP2 Session object](#CVE-2021-43535)

Reporter
Julien Cristau
Impact
high
##### Description

A use-after-free could have occured when an HTTP2 session object was released on a different thread, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1667102](https://bugzilla.mozilla.org/show_bug.cgi?id=1667102)

#### [#CVE-2021-38508: Permission Prompt could be overlaid, resulting in user confusion and potential spoofing](#CVE-2021-38508)

Reporter
Raphael
Impact
moderate
##### Description

By displaying a form validity message in the correct location at the same time as a permission prompt (such as for geolocation), the validity message could have obscured the prompt, resulting in the user potentially being tricked into granting the permission.

##### References

* [Bug 1366818](https://bugzilla.mozilla.org/show_bug.cgi?id=1366818)

#### [#CVE-2021-38509: Javascript alert box could have been spoofed onto an arbitrary domain](#CVE-2021-38509)

Reporter
Ademar Nowasky Junior
Impact
moderate
##### Description

Due to an unusual sequence of attacker-controlled events, a Javascript `alert()` dialog with arbitrary (although unstyled) contents could be displayed over top an uncontrolled webpage of the attacker's choosing.

##### References

* [Bug 1718571](https://bugzilla.mozilla.org/show_bug.cgi?id=1718571)

#### [#CVE-2021-38510: Download Protections were bypassed by .inetloc files on Mac OS](#CVE-2021-38510)

Reporter
Hou JingYi
Impact
moderate
##### Description

The executable file warning was not presented when downloading .inetloc files, which, due to a flaw in Mac OS, can run commands on a user's computer.
*Note: This issue only affected Mac OS operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1731779](https://bugzilla.mozilla.org/show_bug.cgi?id=1731779)

#### [#CVE-2021-43534: Memory safety bugs fixed in Thunderbird ESR 91.3](#CVE-2021-43534)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Valentin Gosu, and Andrew McCreight reported memory safety bugs present in Thunderbird 91.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1606864%2C1712671%2C1730048%2C1735152)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


