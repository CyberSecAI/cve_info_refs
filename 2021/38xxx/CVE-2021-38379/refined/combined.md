=== Content from cfengine.com_ee9db894_20250114_184055.html ===


* [GitHub](https://github.com/cfengine)
* [Blog](/blog/)
* [Docs](https://docs.cfengine.com)
* [Developers](/developers/)
* [Customer support](https://support.northern.tech/hc/en-us)

[![CFEngine](/images/cfengine-logo.svg)](/)

* Product
  ![](/images/arrow-down.svg)
  + [Overview](/product-overview/)
  + [Features](/features/)
  + [Community vs Enterprise](/community-vs-enterprise-comparison/)
* Solutions
  ![](/images/arrow-down.svg)
  + [Infrastructure automation](/solutions/infrastructure-automation/)
  + [Security automation](/solutions/security-automation/)
  + [Compliance automation](/solutions/compliance-automation/)
* Resources
  ![](/images/arrow-down.svg)
  + [Case studies](/case-studies/)
  + [White papers](/white-papers/)
  + [Videos](/videos/)
  + [Webinars](/webinars/)
  + [Developers](/developers/)
  + Downloads
    ![](/images/arrow-down.svg)
    - [Quick install](/downloads/quick-install/)
    - [Enterprise](/downloads/cfengine-enterprise/)
    - [Community](/downloads/cfengine-community/)
    - [Nightly packages](/downloads/cfengine-community-nightly/)
  ![CFEngine Build logo](/developers/cfengine_build_logo.svg)
* [Support & services](/support-services/)
* [Contact us](/contact/)

[Try for free](/download/)

![](/images/closed-menu.svg)

[<The CFEngine Blog](/blog/)
# CVE-2021-38379 & CVE-2021-36756 - Exported report permissions and certificate checking in Federated Reporting

* [cve](/tags/cve/)
* [security](/tags/security/)

![](https://pbs.twimg.com/profile_images/1322835898589990912/y8XN5L9A.jpg)

Posted by [Vratislav Podzimek](/author/vratislav-podzimek/)
October 27, 2021

![](/images/line-gradient.svg)

Share this

[![Twitter](/images/twitter-share-icon.svg)](//twitter.com/share?url=https://cfengine.com%2fblog%2f2021%2fcve-2021-38379-and-cve-2021-36756%2f&text=CVE-2021-38379%20%26%20CVE-2021-36756%20-%20Exported%20report%20permissions%20and%20certificate%20checking%20in%20Federated%20Reporting&via=CFEngine)

[![LinkedIn](/images/linkedin-share-icon.svg)](//www.linkedin.com/shareArticle?url=https://cfengine.com%2fblog%2f2021%2fcve-2021-38379-and-cve-2021-36756%2f&title=CVE-2021-38379%20%26%20CVE-2021-36756%20-%20Exported%20report%20permissions%20and%20certificate%20checking%20in%20Federated%20Reporting)

[![Facebook](/images/facebook-share-icon.svg)](//www.facebook.com/sharer/sharer.php?u=https://cfengine.com%2fblog%2f2021%2fcve-2021-38379-and-cve-2021-36756%2f)

The CFEngine engineering team has recently discovered two security issues in the *CFEngine Enterprise* product:

* CVE-2021-38379 - Publicly available exported reports
* CVE-2021-36756 - Certificate not checked in Federated Reporting

While the latter one (`CVE-2021-36756`) only affects *CFEngine Enterprise* deployments using the *Federated Reporting* functionality, the former one (`CVE-2021-38379`) affects all deployments running all supported versions of *CFEngine Enterprise* (and many unsupported versions, 3.5 or newer, to be more precise).
Both issues were discovered internally during development and testing and we have no indications of these vulnerabilities being exploited or known of outside of the development team.

## CVE-2021-38379 - Publicly available exported reports

### Description

*CFEngine Enterprise* uses the `tmp` directory in the HTML document root (for example <https://hub.example.com/tmp/>) for temporary files that need to be accessed by users of *Mission Portal*, the *CFEngine Enterprise* web user interface.
This directory needs to be publicly accessible because it includes files that are needed for the basic functionality.
Unfortunately, this directory has also been used for files with exported reports, for example <https://hub.example.com/tmp/CFEngine_Enterprise_advancedreports-09-15-2021-abcdef.pdf>.
An attacker can try making requests to the hub machine with the URLs in the above easily predictable format and get access to reports generated by users using *Mission Portal*.

### Detection

All deployments running *CFEngine Enterprise* version 3.5 and newer are affected.

### Impact

An attacker with network access to the hub machine (port `443`) can obtain reports generated by users in *Mission Portal* with potentially sensitive data.

### Mitigation

Because the mechanisms for making the exported reports available for users are part of the *CFEngine Enterprise* binaries, the only possible mitigation for this CVE is to upgrade the hub installations to one of the newest supported releases of *CFEngine Enterprise* - version *3.15.4-2* or *3.18.0-2*.
**Client machines are not affected by this CVE as they don't run the *Mission Portal* web user interface.**

The newest supported releases of *CFEngine Enterprise* use a separate directory for exported reports which is not publicly accessible and the names of the files with the exported reports are practically impossible to predict so even logged in users cannot get access to other users' exported reports.

This issue has been registered as *CVE-2021-38379* in [the official public CVE registry](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38379).

## CVE-2021-36756 - Certificate not checked in Federated Reporting

### Description

*CFEngine Enterprise* deployments using the *Federated Reporting* feature to collect reports from multiple hubs (called *feeders*) to one aggregating hub (called *superhub*) don't properly check the TLS certificates of *feeder* hubs when connecting them to the *superhub*.
An attacker can use IP spoofing, DNS spoofing or other common techniques to direct the traffic from the *superhub* to their own machine instead of the real *feeder* hub and get it connected to the *superhub*.
The *superhub*-*feeder* connection process exchanges secrets that are then used to ensure integrity and authenticity of the data sent by the *feeder*.
So the attacker can feed the *superhub* fake data or, even worse, harmful data that can damage the *superhub* database.
**Feeder hubs and their data are not affected by this vulnerability.**

### Detection

All *CFEngine Enterprise* deployments using the *Federated Reporting* feature are affected by this vulnerability.

### Mitigation

The only possible mitigation of this vulnerability is re-installation of all *superhubs* and re-connection of all the *feeder* hubs.
The newest supported releases of *CFEngine Enterprise* - version *3.15.4-2* and *3.18.0-2* - ensure that the TLS certificates of *feeder* hubs are verified, either automatically if they are using standard certificates with certificate chains signed by trusted certification authorities, or manually by the admin user if they use self-signed certificates.
Fortunately, the *superhubs* usually don't serve policy (except to themselves) and the only exclusive data they have is their own reporting data and its history.
The configuration, saved queries, dashboards etc.
can be preserved using the [Import & Export API](https://docs.cfengine.com/docs/3.18/reference-enterprise-api-ref-export-import-api.html).

To re-install all *superhubs* and re-connect all *feeder* hubs, please follow the [instructions for a superhub upgrade](https://docs.cfengine.com/docs/3.18/enterprise-cfengine-guide-federated-reporting.html#superhub-upgrade) provided as part of the [online *CFEngine Enterprise* documentation](https://docs.cfengine.com/docs/3.18/enterprise-cfengine-guide.html).
Please notice that all the *feeder* hubs need to be disabled (reverted to normal hubs) before they can be re-connected to *superhubs*.

This issue has been registered as *CVE-2021-36756* in [the official public CVE registry](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36756).

## Packages for the newest releases of CFEngine Enterprise

The previously released 3.18.0 and 3.15.4 hub packages are affected by these vulnerabilities and have been replaced by new packages.
Only the vulnerabilities were fixed in these re-releases.
The new packages have a `-2` in the filename and new checksums.
They are now available in the [Downloads section of the website](/downloads/cfengine-enterprise/), [cf-remote](https://pypi.org/project/cf-remote/), etc.
For completeness, the links to the new packages and their checksums are provided below:

### 3.18.0-2 packages

| Operating System | Checksum |
| --- | --- |
| [Debian 9](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/debian_9_x86_64/cfengine-nova-hub_3.18.0-2.debian9_amd64.deb) | `sha256=05bceb8b50085f857d4d19a2b6a566efa9cae1ecae18fbfb237d56eef9ad1599` |
| [Debian 10](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/debian_10_x86_64/cfengine-nova-hub_3.18.0-2.debian10_amd64.deb) | `sha256=a770b2cac3f09083e77f39611a8e8b6b52dd2b95d9b0419aa5aa5a933aae368b` |
| [RHEL/CentOS 6](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/redhat_6_x86_64/cfengine-nova-hub-3.18.0-2.el6.x86_64.rpm) | `sha256=adfb77b1bf0804abd1ff0c0e3d642b35f32f740399888d0d3b10ab1cbaf4fdce` |
| [RHEL/CentOS 7](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/redhat_7_x86_64/cfengine-nova-hub-3.18.0-2.el7.x86_64.rpm) | `sha256=c6cd356b2d8da807520c2ceeee5ce8ffc5f30fc035d47129bc2caa7525fbbe5f` |
| [RHEL/CentOS 8](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/redhat_8_x86_64/cfengine-nova-hub-3.18.0-2.el8.x86_64.rpm) | `sha256=d68a5351c7784de370a21fc4d91dfeb403e81143681b07d9fc468505192f2b3d` |
| [Ubuntu 16](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/ubuntu_16_x86_64/cfengine-nova-hub_3.18.0-2.ubuntu16_amd64.deb) | `sha256=dc319d1416e09f27f470d57deca0413936f00b52f81eb6f07edf22e2426db1c5` |
| [Ubuntu 18](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/ubuntu_18_x86_64/cfengine-nova-hub_3.18.0-2.ubuntu18_amd64.deb) | `sha256=cf803129761ef27efab452c82d4078b81c7f8827474a4138f948858df25c7f97` |
| [Ubuntu 20](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.18.0/hub/ubuntu_20_x86_64/cfengine-nova-hub_3.18.0-2.ubuntu20_amd64.deb) | `sha256=101eefe4ffa69dfb3d3139dfdf805db909f41d20f13d362aa69e9ed0917516b2` |

### 3.15.4-2 packages

| Operating System | Checksum |
| --- | --- |
| [Debian 8](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/debian_8_x86_64/cfengine-nova-hub_3.15.4-2.debian8_amd64.deb) | `sha256=2739b0cf23b08408305ccc93e63d4a10bf70b5c00651500f1c03d46a2fe57109` |
| [Debian 9](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/debian_9_x86_64/cfengine-nova-hub_3.15.4-2.debian9_amd64.deb) | `sha256=f85eccab440fbc818e0dbfb09462a8eb700a3e20b16aeb3b77ceb19af0b20106` |
| [Debian 10](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/debian_10_x86_64/cfengine-nova-hub_3.15.4-2.debian10_amd64.deb) | `sha256=a54a0293af1449d244742e80b0812a9f84a48b7b9d90838decdbeb1666d3d0c9` |
| [RHEL/CentOS 6](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/redhat_6_x86_64/cfengine-nova-hub-3.15.4-2.el6.x86_64.rpm) | `sha256=f64330a48d23f152ac45da6426664f92f920474585662d1506f4b66769cbc59d` |
| [RHEL/CentOS 7](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/redhat_7_x86_64/cfengine-nova-hub-3.15.4-2.el7.x86_64.rpm) | `sha256=993f36a660f63acce1da1723da0db66d62c5ad6c4a55f1c293ad50656d94f2b7` |
| [RHEL/CentOS 8](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/redhat_8_x86_64/cfengine-nova-hub-3.15.4-2.el8.x86_64.rpm) | `sha256=6ea8f76335d6a5950ef636f9e3d44737cfa9bc092a6dba702c5d2e4c9e779329` |
| [Ubuntu 14](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/ubuntu_14_x86_64/cfengine-nova-hub_3.15.4-2.ubuntu14_amd64.deb) | `sha256=e4fccfc3b7fa6f5f31ec1d91c388cf344901bbfcb110e446d326c277f6965dde` |
| [Ubuntu 16](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/ubuntu_16_x86_64/cfengine-nova-hub_3.15.4-2.ubuntu16_amd64.deb) | `sha256=7f9540ec066cd971e7a223fdd93d85b31be58c76325c22388389e59c06745b3c` |
| [Ubuntu 18](https://cfengine-package-repos.s3.amazonaws.com/enterprise/Enterprise-3.15.4/hub/ubuntu_18_x86_64/cfengine-nova-hub_3.15.4-2.ubuntu18_amd64.deb) | `sha256=5817cfb9bf5048866cb8554585cc3a24183e1f0290316371429801b023184807` |

In case of any questions, feel free to [contact us](https://cfengine.com/support/).

### Explore posts by tags

* [announcements](/tags/announcements/)
* [ansible](/tags/ansible/)
* [api](/tags/api/)
* [bash](/tags/bash/)
* [c](/tags/c/)
* [case-studies](/tags/case-studies/)
* [cf-remote](/tags/cf-remote/)
* [cf-runagent](/tags/cf-runagent/)
* [cf-secret](/tags/cf-secret/)
* [change-in-behavior](/tags/change-in-behavior/)
* [cmdb](/tags/cmdb/)
* [community](/tags/community/)
* [compliance](/tags/compliance/)
* [containers](/tags/containers/)
* [custom-promise-types](/tags/custom-promise-types/)
* [cve](/tags/cve/)
* [design](/tags/design/)
* [developers](/tags/developers/)
* [docker](/tags/docker/)
* [feature-friday](/tags/feature-friday/)
* [git](/tags/git/)
* [guest-blog-posts](/tags/guest-blog-posts/)
* [holiday](/tags/holiday/)
* [inventory](/tags/inventory/)
* [mission-portal](/tags/mission-portal/)
* [modules](/tags/modules/)
* [monthly-module-monday](/tags/monthly-module-monday/)
* [open-source](/tags/open-source/)
* [performance](/tags/performance/)
* [policy-analyzer](/tags/policy-analyzer/)
* [policy-language](/tags/policy-language/)
* [python](/tags/python/)
* [releases](/tags/releases/)
* [reporting](/tags/reporting/)
* [scalability](/tags/scalability/)
* [security](/tags/security/)
* [services](/tags/services/)
* [tooling](/tags/tooling/)
* [troubleshooting](/tags/troubleshooting/)
* [webinars](/tags/webinars/)
* [white-papers](/tags/white-papers/)
* [windows](/tags/windows/)

### Recent posts

* [CFEngine 3.25 released - Auditability](/blog/2025/cfengine-3-25-released-auditability/)
  January 6, 2025
* [See what services are running on your hosts](/blog/2024/inventory-running-services/)
  January 6, 2025
* [Feature Friday #42: ob-cfengine3](/blog/2024/feature-friday-42-ob-cfengine3/)
  December 27, 2024

## Try CFEngine Enterprise for free

Sign up for CFEngine Enterprise and connect up to 25
hosts for free. No credit card required. Get started in
minutes.

[Try enterprise for free](/download/)
![](/images/features/sla-background.svg)

![](/images/comments.svg)
Get in touch with us
 to discuss how we can help!

[Contact us](/contact/)

![](/images/mail.svg)
Sign up for
 our newsletter

Sign up

By signing up, you agree to your email address being stored and used to receive newsletters about CFEngine.
We use tracking in our newsletter emails to improve our marketing content.

![CFEngine](/images/cfengine-logo-white.svg)

* ![](/images/line-gradient.svg)
  About CFEngine
  + [Overview](/product-overview/)
  + [Features](/features/)
  + [Community vs Enterprise](/community-vs-enterprise-comparison/)
* ![](/images/line-gradient.svg)
  Community
  + [GitHub](https://github.com/cfengine)
  + [Matrix](https://matrix.to/#/#CFEngine:matrix.org)
  + [CFEngine Build](https://build.cfengine.com/)
* ![](/images/line-gradient.svg)
  Resources
  + [Developer resources](/developers/)
  + [Downloads](/downloads/quick-install/)
  + [Blog](/blog/)
* ![](/images/line-gradient.svg)
  Get started
  + [Try for free](/free-download/)
  + [Documentation](https://docs.cfengine.com/docs)
* ![](/images/line-gradient.svg)
  Company
  + [About us](https://northern.tech/about-us/mission-strategy)
  + [Legal](https://northern.tech/legal)
  + [Careers](https://northern.tech/careers/open-positions)
  + [Contact us](/contact/)

![](/images/footer-background-right.svg)

![](/images/footer-background-left.svg)

![Northern.tech logo](/images/northern-tech-logo.svg)
CFEngine is developed and maintained by [Northern.tech](https://northern.tech/).
[Career](https://northern.tech/careers/our-mission)
[Legal](https://northern.tech/legal)

© 2025 [Northern.tech](https://northern.tech) AS



=== Content from docs.cfengine.com_c3ce41ae_20250114_184056.html ===

master
Version 3.24 (LTS)
Version 3.23 (EOL non-LTS)
Version 3.22 (non-LTS)
Version 3.21 (LTS)
Version 3.20 (EOL non-LTS)
Version 3.19 (EOL non-LTS)
Version 3.18 (LTS)
Version 3.17 (EOL non-LTS)
Version 3.16 (EOL non-LTS)
Version 3.15 (EOL LTS)
Version 3.12 (EOL LTS)
Version 3.14 (EOL non-LTS)
Version 3.13 (EOL non-LTS)
Version 3.11 (EOL non-LTS)
Version 3.10 (EOL LTS)
Version 3.9 (EOL non-LTS)
Version 3.8 (EOL non-LTS)
Version 3.7 (EOL LTS)
Version 3.6 (EOL)
Version 3.5 (EOL)
Version 3.0 (archive)
Version 2.0 (archive)

[![CFEngine Homepage](media/images/cfengine-logo.svg)](https://cfengine.com)

* [Home](index.html)
* [Guide](guide.html)
* [CFEngine Enterprise](enterprise-cfengine-guide.html)
* [Examples](examples.html)
* [Reference](reference.html)
* [Download](http://www.cfengine.com/product/free-download/)

* [Install and Get Started](enterprise-cfengine-guide-install-get-started.html)
* [User Interface](enterprise-cfengine-guide-user-interface.html)
* [Settings](enterprise-cfengine-guide-settings.html)
* [Health](enterprise-cfengine-guide-health.html)
* [Hosts](enterprise-cfengine-guide-hosts-health.html)
* [Alerts and Notifications](enterprise-cfengine-guide-alerts-notifications.html)
* [Custom actions for Alerts](enterprise-cfengine-guide-alerts-custom-actions.html)
* [Enterprise Reporting](enterprise-cfengine-guide-reporting.html)
* [Federated Reporting](enterprise-cfengine-guide-federated-reporting.html)
* [Measurements app](enterprise-cfengine-guide-measurements.html)
* [Enterprise API](enterprise-cfengine-guide-enterprise-api.html)
* [Best Practices](enterprise-cfengine-guide-best-practices.html)
* [High Availability](enterprise-cfengine-guide-high-availability.html)
* [Hub Administration](enterprise-cfengine-guide-hub_administration.html)
* [License](enterprise-cfengine-guide-license.html)

Table of Contents

# CFEngine Enterprise

Table of Contents

CFEngine Enterprise is an IT automation platform that uses a model-based approach to manage your infrastructure, and applications at WebScale while providing best-in-class scalability, security, enterprise-wide visibility and control.

## WebScale IT Automation

CFEngine Enterprise provides a secure and stable platform for building and managing both physical and virtual infrastructure. Its distributed architecture, minimal dependencies, and lightweight autonomous agents enable you to manage 5,000 nodes from a single policy server.

WebScale does not just imply large server deployments. The speed at which changes are conceived and committed across infrastructure and applications is equally important. Due to execution times measurable in seconds, and one of the most efficient verification mechanisms, CFEngine reduces exposure to unwarranted changes, and prevents extreme delays for planned changes that need to be applied urgently at scale.

## Intelligent Automation of Infrastructure

Automate your infrastructure with self-service capabilities. CFEngine Enterprise enables you to take advantage of agile, secure, and scalable infrastructure automation that makes repairs using a policy-based approach.

## Policy-Based Application Deployment

Achieve repeatable, error-free and automated deployment of middleware and application components to a datacenter or cloud-based infrastructure. Along with infrastructure, automated application deployment provides a standardized platform.

## Self-Healing Continuous Operations

Gain visibility into your infrastructure and applications, and be alerted to issues immediately. CFEngine Enterprise contains built-in inventory and reporting modules that automate troubleshooting and compliance checks, as well as remediate in a self-healing fashion.

## CFEngine Enterprise Features

### User Interface

The CFEngine Enterprise Mission Portal provides a central dashboard for real-time monitoring, search, and reporting for immediate visibility into your environmentâs actual vs desired state. You can also use Mission Portal to set individual and group alerts and track system events that make you aware of specific infrastructure changes.

![Dashboard](Dashboard.png)

### Scalability

CFEngine Enterprise has a simple distributed architecture that scales with minimal resource consumption. Its pull-based system eliminates the need for server-side processing, which means that a single policy server can concurrently serve up to 5,000 nodes doing 5 minute runs with minimal hardware requirements.

### Configurable Data Feeds

The CFEngine Enterprise [`Mission Portal`](enterprise-cfengine-guide-high-availability.html#mission-portal "High Availability - Mission Portal") provides System Administrators and Infrastructure Engineers with detailed information about the actual state of the IT infrastructure and how that compares with the desired state.

### Federation and SQL Reporting

CFEngine Enterprise has the ability to create federated structures, in which parts of organizations can have their own configuration policies, while at the same time the central IT organization may impose some policies that are more global in nature.

### Monitoring and reporting

The CFEngine Enterprise Mission Portal contains continual reporting that details compliance with policies, repairs and any failures of hosts to match their desired state.

### Role-based access control

Users can be assigned roles that limit their access levels throughout the Mission Portal.

[Download all CFEngine documentation](cfengine-documentation-3.18.tar.gz) for offline reading.

CFEngine

470 Ramona Street,

Palo Alto, CA 94301

Phone: +1 650 560-4888

[Contact Us](http://cfengine.com/engage/contact/)

| [Left Menu](#left-menu) | [Go to Top](#top) | [Table of Content](#right-menu) |
| --- | --- | --- |


