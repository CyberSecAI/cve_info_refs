=== Content from nostarttls.secvuln.info_0db94bdd_20250115_112352.html ===

![logo](images/nostarttls.svg)
# NO STARTTLS

## Why TLS is better without STARTTLS A Security Analysis of STARTTLS in the Email Context

by Damian Poddebniak¹, Fabian Ising¹, Hanno Böck², and Sebastian Schinzel¹

¹ Münster University of Applied Sciences ² Independent Researcher

*Full paper [published
at USENIX Security 21](https://www.usenix.org/conference/usenixsecurity21/presentation/poddebniak)*

## Introduction

Connections between email clients and servers provide two ways to be protected with TLS: While implicit TLS
encrypts the connection from the start and runs on a separate port, STARTTLS
provides a mechanism to upgrade existing unencrypted connections to TLS.

Sometimes STARTTLS is seen as an opportunistic encryption mode that provides TLS protection
only when available. This is trivially vulnerable to downgrade attacks. However, modern email clients
usually have the expectation that STARTTLS is enforced, and when enabled, no unencrypted communication
is possible.

Upgrading connections via STARTTLS is fragile and vulnerable to a number of security
vulnerabilities and attacks. We found more than 40 vulnerabilities in STARTTLS implementations. We
conclude that these vulnerabilities are so common that we recommend
avoiding using STARTTLS when possible.

![Steps of an email submission and access. From left to right: Author (Email Client), Provider, Provider, Recipient (Email Client).](images/email.svg)

## Attacks

We assume a Meddler-in-the-Middle (MitM) attacker who can modify connections established between an
email client and the email server of a provider.

### Stealing Login Credentials with SMTP and IMAP via Command Injection

In 2011 Postfix developer Wietse Venema [described a bug
in STARTTLS implementations](http://www.postfix.org/CVE-2011-0411.html) that allowed
injecting plaintext commands that a server interprets as if they were part of the
encrypted connection. This works by sending additional commands with the STARTTLS command to the
server in the same TCP segment.

We found that despite being known since 2011, this vulnerability is still very common. We found
15 vulnerable implementations, and in scans, 2% of all mail servers showed this vulnerability.

This command injection can be used to steal credentials with the SMTP and IMAP protocols.

Our attack requires a Meddler in the Middle (MitM) attacker that can modify network traffic and has
login credentials for their own account on the same server. The attacker can inject commands
that authenticate them and then start sending (SMTP) or storing (IMAP) an email.
The login credentials sent by the victim will be stored in the email that the attacker
can access.

The command injection can also be used for a cross-protocol attack to serve HTTPS content with
the mail server's certificate. Detailed descriptions of these attacks can be found in our paper.

### Mailbox content forgery via Response Injection

We discovered an attack similar to the command injection in email client applications.
We call this a response injection.
This bug affected many popular mail clients, including Apple Mail, Mozilla Thunderbird, Claws Mail, and
Mutt.

By injecting additional content to the server message in response to the STARTTLS command before the TLS
handshake,
we can inject server commands that the client will process as if they were part of the encrypted connection.
This
can be used to forge mailbox content.

### IMAP connection downgrade via PREAUTH and credential-stealing with REFERRAL

In the IMAP protocol, a server can signal the client in the first message that it is already authenticated
via
the PREAUTH command. The protocol forbids using the STARTTLS command in an authenticated state. Therefore, if
a client application accepts PREAUTH, it cannot enforce STARTTLS.

A Meddler in the Middle attacker can use this to prevent STARTTLS from upgrading the connection and force
a client to an unencrypted connection.

This vulnerability was originally [found in
Trojitá in 2014](http://jkt.flaska.net/blog/Trojita_0_4_1__a_security_update_for_CVE_2014_2567.html). We discovered that multiple other
email client applications were vulnerable to the same bug.

This bug is especially severe in combination with the IMAP features [Login Referrals](https://datatracker.ietf.org/doc/html/rfc2221) and [Mailbox Referrals](https://datatracker.ietf.org/doc/html/rfc2193).
These commands allow a server to instruct a client to log into another IMAP server. By using PREAUTH to
prevent an encrypted connection, an attacker can use referrals to force a client to send credentials to an
attacker-controlled server.
Fortunately, the referral features are not supported by many clients.
We found only one client - Alpine - vulnerable to this combination of PREAUTH and referrals.

### Additional Attacks

We found additional attacks, whose security impact may vary for implementations.
Please see our paper to learn more about these attacks.

## Conclusion

All vulnerabilities described here rely on the transition of an insecure connection to a
secure connection.
Implicit TLS does not have such a transition and is therefore not vulnerable to any of these attacks.
We therefore consider implicit TLS a more secure option than STARTTLS.

We also point out that STARTTLS always introduces at least one extra connection
round trip. So implicit TLS generally provides better performance.

## Impact

The demonstrated attacks require an active attacker and may be recognized when
used against an email client that tries to enforce the transition to TLS.
We have informed all popular email client and server vendors and most issues are already
fixed.
We think that the demonstrated attacks would be difficult to execute on a large scale, and we
primarily expect them to be used in targeted attacks.
As a general recommendation, you should always update your software and (to also profit from faster
connections)
reconfigure your email client to use implicit TLS only (see below).

## Recommendations

### For Email Client Users

If possible, we recommend that users check and configure their email clients to use SMTP, POP3 and IMAP with
implicit TLS on dedicated ports, i.e., SMTP/Submission on port 465, POP3 on port 995, and IMAP on port 993.
This is in line with already existing recommendations in
[RFC 8314](https://datatracker.ietf.org/doc/html/rfc8314#section-3) and was already recommended
by [security professionals](https://www.agwa.name/blog/post/starttls_considered_harmful) before.

Some mail service providers, notably Microsoft and Apple, do not support implicit TLS for SMTP/Submission.
We recommend that users ask their mail service providers to offer the more secure implicit TLS option.

### For Application Developers

Both email server and client applications should offer implicit TLS by default.
In the long term, software developers may decide to not support STARTTLS at all and thus simplify both
their code and configuration dialogs and files.

We recommend auditing all applications supporting STARTTLS - both on the server and the client side -
for the bugs discovered.
Most importantly, applications need to ensure that no unencrypted content gets processed as part of an
encrypted connection.
IMAP applications must make sure that they do not allow PREAUTH in combination with STARTTLS.
We provide the [EAST toolkit](https://github.com/fhms-its/EAST), which allows testing
applications.

### For Mail Server Administrators

Make sure your server supports implicit TLS for all supported protocols.
If possible, consider disabling STARTTLS for IMAP, POP3 and SMTP submission.

If you really need to support STARTTLS, we recommend testing your server with our tool for the command
injection vulnerability for all supported protocols.
If your server software is vulnerable, you should ask your vendor for a security update.

## FAQ

### Isn't STARTTLS insecure anyway?

STARTTLS is used in two "modes", "opportunistic", and "enforced".
Email clients must authenticate themselves with a username and password before submitting a new email or
accessing existing emails.
For these connections, the transition to TLS via STARTTLS **must** be strictly enforced because a
downgrade would reveal the username and password and give an attacker full access to the email account.

### How can I test if my software is vulnerable?

We provide the [EAST toolkit](https://github.com/fhms-its/EAST) that allows testing email clients
and servers.

**Testing an email server** for the command injection is relatively easy with our [Command Injection Tester](https://github.com/Email-Analysis-Toolkit/command-injection-tester).
[testssl.sh](https://github.com/drwetter/testssl.sh) (dev version) and
[TLS-Attacker](https://github.com/tls-attacker/TLS-Attacker/tree/starttls)/[TLS-Scanner](https://github.com/tls-attacker/TLS-Scanner/tree/starttls) (starttls branch) also check for the command injection.

**Testing an email client** is more complex, and we refer to EAST's [Fake Mail Server](https://github.com/Email-Analysis-Toolkit/fake-mail-server) component.

### Are other protocols with support for STARTTLS or similar mechanisms affected?

We expect to see similar vulnerabilities in other protocols using STARTTLS, e.g., XMPP, FTP, IRC, or LDAP.
Thus, our recommendation to avoid STARTTLS and use implicit TLS when possible applies to those protocols as
well.
We encourage security researchers to look for such vulnerabilities in other protocols.

Some protocols only support STARTTLS and provide no implicit TLS mechanism.
We recommend that standards bodies define implicit TLS modes for these protocols and that future protocols
do this by default and avoid STARTTLS completely.

### What about communication between email servers (MTA to MTA)?

Traditionally, STARTTLS between email servers only protects against passive attacks and is vulnerable to
active attacks such as STARTTLS stripping.
Thus STARTTLS vulnerabilities do not give an advantage to the attacker.

However, efforts like [MTA-STS](https://datatracker.ietf.org/doc/html/rfc8461) and [DANE](https://datatracker.ietf.org/doc/html/rfc7671) provide authentication mechanisms for MTA
to MTA connections.
Therefore, server software should be investigated for STARTTLS vulnerabilities as well.
Particularly relevant are the buffering bugs, which can happen both for the sending (response injection) and
receiving (command injection) side of a mail server.
We have found and reported some vulnerabilities in server software during our research.

Currently, there is no standardized way to use implicit TLS for MTA to MTA connections.
Therefore, it is not possible to avoid STARTTLS without changes to the protocol specification.

### How important is this?

[It's not the most important thing you should worry about today.](https://www.ipcc.ch/assessment-report/ar6/)

### How can I contact you?

You can reach us via mail or twitter:

* Damian Poddebniak, [@duesee@norden.social](https://norden.social/%40duesee), poddebniak@fh-muenster.de
* Fabian Ising, [@Murgi](https://twitter.com/Murgi), F.Ising@fh-muenster.de
* [Hanno Böck](https://hboeck.de/), [@hanno@mastodon.social](https://mastodon.social/%40hanno), hanno@hboeck.de
* Sebastian Schinzel, [@seecurity](https://twitter.com/seecurity), schinzel@fh-muenster.de

## Reported Vulnerabilities

The following is a list of all STARTTLS-related vulnerabilities we found during our research.
None of the issues would be present if implicit TLS had been used exclusively.
Due to different kinds of reports, not all issues are publicly documented.
All issues were reported more than 90 days ago.

### Email Clients

As an end user, make sure to use the newest version of your email software.
The following list serves as a quick check if your client is still affected.

#### Response Injection (Buffering)

| Product | Protocol | Status | Links |
| --- | --- | --- | --- |
| Apple Mail (macOS) | SMTP/POP3/IMAP | Fixed in macOS High Sierra 10.13.6/Big Sur 11.4 | [CVE-2020-9941](https://nvd.nist.gov/vuln/detail/CVE-2020-9941), [CVE-2021-30696](https://nvd.nist.gov/vuln/detail/CVE-2021-30696) |
| Apple Mail (iOS/iPadOS) | SMTP/POP3/IMAP | Fixed in iOS/iPadOS 14.0 | [CVE-2020-9941](https://nvd.nist.gov/vuln/detail/CVE-2020-9941) |
| Mozilla Thunderbird | IMAP | Fixed in 78.7.0 | [CVE-2020-15685](https://nvd.nist.gov/vuln/detail/CVE-2020-15685), [Vendor advisory](https://www.mozilla.org/en-US/security/advisories/mfsa2021-05/), [Bug report](https://bugzilla.mozilla.org/show_bug.cgi?id=1622640) |
| Claws Mail | SMTP/POP3/IMAP | Fixed in 3.17.6 for SMTP/POP3, See libEtPan for IMAP | [CVE-2020-15917](https://nvd.nist.gov/vuln/detail/CVE-2020-15917) |
| Mutt | IMAP/SMTP/POP3 | Fixed in 1.14.4 | [CVE-2020-14954](https://nvd.nist.gov/vuln/detail/CVE-2020-14954) |
| NeoMutt | IMAP/SMPT/POP3 | Fixed in 2020-06-19 | [Commit/Patch](https://github.com/neomutt/neomutt/commit/fb013ec666759cb8a9e294347c7b4c1f597639cc), see also [CVE-2020-14954](https://nvd.nist.gov/vuln/detail/CVE-2020-14954) |
| Evolution | SMTP/POP3 | Fixed in 3.36.4 (evolution-data-server) | [CVE-2020-14928](https://nvd.nist.gov/vuln/detail/CVE-2020-14928) |
| LibEtPan (Mail Framework for C Language) | IMAP/SMTP/POP3 | Fixed in repository, unreleased | [CVE-2020-15953](https://nvd.nist.gov/vuln/detail/CVE-2020-15953) |
| Exim (MTA sending) | SMTP | Unfixed (reported privately) | [CVE-2021-38371](https://nvd.nist.gov/vuln/detail/CVE-2021-38371) |
| Gmail (iOS/iPadOS) | SMTP/IMAP | Unfixed (reported privately) | - |
| Mail.ru, MyMail | SMTP | Unfixed (reported privately, report closed as not applicable) | - |
| Yandex | SMTP/IMAP | Unfixed (reported privately) | - |
| PHP (stream\_socket\_enable\_crypto) | SMTP/POP3/IMAP | Unfixed | [Bug report (private)](https://bugs.php.net/bug.php?id=80008) |

#### Negotiation and Tampering bugs

| Product | Description | Protocol | Status | Links |
| --- | --- | --- | --- | --- |
| Gmail (Android) | Leak of emails | IMAP | Fixed (retested in 2021.07.11.387440246) | - |
| Gmail (Go) | Leak of emails | IMAP | Fixed (retested in 2020.10.15.341102866) | - |
| Samsung Email | Leak of emails | IMAP | Fixed (untested) | - |
| Alpine | Untagged responses accepted before STARTTLS | IMAP | fixed in 2.25 | [CVE-2021-38370](https://nvd.nist.gov/vuln/detail/CVE-2021-38370), [Release notes](https://alpineapp.email/alpine/release/alpine-2.25.html) |
| Trojitá Trojita | Untagged responses accepted before STARTTLS | IMAP | Unknown | [Bug report](https://bugs.kde.org/show_bug.cgi?id=432353) |
| Mozilla Thunderbird | Server responses prior to STARTTLS processed | IMAP | Fixed in 78.12 | [CVE-2021-29969](https://nvd.nist.gov/vuln/detail/CVE-2021-29969), [Vendor advisory](https://www.mozilla.org/en-US/security/advisories/mfsa2021-30/) |
| KMail | STARTTLS ignored when "Server requires authentication" not checked | SMTP | Unfixed | [Bug report](https://bugs.kde.org/show_bug.cgi?id=423423) |
| Sylpheed | STARTTLS stripping | IMAP | Unknown | [Bug report](https://sylpheed.sraoss.jp/redmine/issues/322) |
| OfflineIMAP | STARTTLS stripping | IMAP | Unknown | [Bug report](https://github.com/OfflineIMAP/offlineimap/issues/669) |
| GMX / Web.de Mail Collector | STARTTLS stripping | POP3/IMAP | Fixed | - |
| Mail.ru, MyMail, Email app for Gmail | STARTTLS Stripping | SMTP | Unfixed (report closed as not applicable) | - |

#### Avoiding Encryption via IMAP PREAUTH

| Product | Status | Links |
| --- | --- | --- |
| Apple Mail (iOS/iPadOS) | Fixed in iOS 15.1 | - |
| Mozilla Thunderbird | Fixed in 68.9.0 | [CVE-2020-12398](https://nvd.nist.gov/vuln/detail/CVE-2020-12398) |
| Alpine | Fixed in 2.23 | [CVE-2020-14929](https://nvd.nist.gov/vuln/detail/CVE-2020-14929), [Commit](https://repo.or.cz/alpine.git/commit/000edd9036b6aea5e6a06900ecd6c58faec665ab) |
| Mutt | Fixed in 1.14.3 | [CVE-2020-14093](https://nvd.nist.gov/vuln/detail/CVE-2020-14093) |
| NeoMutt | Fixed in Release 2020-06-19 | [Commit/Patch](https://github.com/neomutt/neomutt/commit/9909cde1f332d2f641c6aec0eb92adf0a150c7e5), see also [CVE-2020-14093](https://nvd.nist.gov/vuln/detail/CVE-2020-14093) |
| GMX / Web.de Mail Collector | Fixed | - |

#### Certificate Validation

| Product | Protocol | Description | Status | Links |
| --- | --- | --- | --- | --- |
| OfflineIMAP | IMAP | Accepts untrusted certificates | Unknown | [Bug report](https://github.com/OfflineIMAP/offlineimap/issues/669) |
| GMX / Web.de Mail Collector | POP3/IMAP | Accepts untrusted certificates | Still allows self-signed | - |
| Yandex | SMTP/IMAP | Accepts untrusted certificates | Unknown (report closed as not eligible) | - |
| Mail.ru, MyMail | SMTP | Accepts untrusted certificates (SMTP, IMAP) | Unknown (report closed as duplicate) | - |
| Outlook (Android & iOS) | SMTP/IMAP | Certificate hostname not checked (SMTP, IMAP) | Unknown (report closed as low/medium severity) | - |
| Geary | SMTP/IMAP | Accepting an untrusted certificate creates a permanent trust exception for all certificates | Fixed in 3.36.3 | [CVE-2020-24661](https://nvd.nist.gov/vuln/detail/CVE-2020-24661) |
| Trojitá Trojita | SMTP | Accepts untrusted certificates | Fixed in repository (77ddd5d4) (no official releases) | [CVE-2020-15047](https://nvd.nist.gov/vuln/detail/CVE-2020-15047) |
| Ruby Net::SMTP | SMTP | Only checks hostname, ignores certificate signature | Fixed in 2.7.2 | [Bug report](https://hackerone.com/reports/980249) |

#### Crashes

| Product | Protocol | Description | Status | Links |
| --- | --- | --- | --- | --- |
| Alpine | IMAP | Crash when LIST or LSUB send before STARTTLS | Fixed in 2.25 | [CVE-2021-46853](https://nvd.nist.gov/vuln/detail/CVE-2021-46853), [Release notes](https://alpineapp.email/alpine/release/alpine-2.25.html) |
| Balsa | IMAP | Nullptr dereference when TLS required and PREAUTH send | Fixed in 2.5.10 | [CVE-2020-16118](https://nvd.nist.gov/vuln/detail/CVE-2020-16118) |
| Balsa | IMAP | Stack overflow due to repeated BAD answer to CAPABILITY command | Fixed in 2.6.3 | [Bug Report](https://gitlab.gnome.org/GNOME/balsa/-/issues/48) |
| Balsa | IMAP | Crash on untagged EXPUNGE response | Fixed in 2.6.3 | [Bug Report](https://gitlab.gnome.org/GNOME/balsa/-/issues/54) |
| Evolution | IMAP | Invalid free when no auth mechanisms in greeting | Fixed in >3.35.91 | [CVE-2020-16117](https://nvd.nist.gov/vuln/detail/CVE-2020-16117) |

#### Miscellaneous

| Product | Protocol | Description | Status | Links |
| --- | --- | --- | --- | --- |
| KMail | POP3 | Setup wizard in POP3 defaults to unencrypted connections | Unfixed | [Bug Report](https://bugs.kde.org/show_bug.cgi?id=423426) |
| KMail | POP3 | Config shows "encrypted", but it isn't | Unfixed | [CVE-2020-15954](https://nvd.nist.gov/vuln/detail/CVE-2020-15954) |
| KMail | SMTP/IMAP | Dialog loop "forces" the user to accept invalid certificates | Unfixed | [Bug Report](https://bugs.kde.org/show_bug.cgi?id=423424) |
| Mozilla Thunderbird | POP3 | Infinite loop when POP3 server replies with -ERR to STLS command | Unknown | [Bug Report](https://bugzilla.mozilla.org/show_bug.cgi?id=1641882) |
| Trojitá Trojita | SMTP/IMAP | Hard to choose implicit TLS due to typo (German) | Fixed | [Bug Report](https://bugs.kde.org/show_bug.cgi?id=416942) |
| Trojitá Trojita | SMTP | SMTP defaults to plaintext on port 587 | Unknown | [Bug Report](https://bugs.kde.org/show_bug.cgi?id=432354) |

### Email Servers

We found 320.000 vulnerable email servers in an Internet-wide scan and conducted a coordinated disclosure
involving different CERTs.
It is impracticable to inform and keep track of the update process of all mail service providers on the
Internet, and thus we identified and prioritized popular mail service
providers.
We only list these in the following table.

Server issues are generally more severe than client issues.
Unfortunately, no client configuration prevents server issues from being exploited, not even the usage of
implicit TLS.
Thus, you must ensure that your server (or your mail service provider) is not affected by STARTTLS issues.

You can use our [command\_injection\_tester tool](https://github.com/Email-Analysis-Toolkit/command-injection-tester) to verify that your server is not affected by the
most severe issue.

#### Command Injection (Buffering)

| Product | Protocol | Status | Links |
| --- | --- | --- | --- |
| Nemesis (used by GMX / Web.de, provider) | POP3/IMAP | Fixed (reported privately) | - |
| Interia.pl (provider) | SMTP/POP3/IMAP | Fixed (reported privately) | - |
| Yahoo (only MTA-to-MTA, provider) | SMTP | Unfixed (reported privately) | - |
| Yandex (provider) | SMTP/POP3/IMAP | Unfixed (reported privately) | - |
| s/qmail | SMTP | Fixed in 4.0.09 | [CVE-2020-15955](https://nvd.nist.gov/vuln/detail/CVE-2020-15955) |
| Coremail | SMTP/POP3/IMAP | Unfixed (reported via CERT) | - |
| Citadel | SMTP/POP3/IMAP | Unfixed | [CVE-2020-29547](https://nvd.nist.gov/vuln/detail/CVE-2020-29547), [Bug report](https://uncensored.citadel.org/dotgoto?room=Citadel%20Security) |
| Gordano GMS | POP3/IMAP | Unfixed | [CVE-2021-37844](https://nvd.nist.gov/vuln/detail/CVE-2021-37844) |
| recvmail | SMTP | Fixed in 3.1.2 (reported privately) | - |
| SmarterMail | POP3 | Fixed in Build 7537 | [CVE-2020-29548](https://nvd.nist.gov/vuln/detail/CVE-2020-29548) |
| Burp Collaborator | SMTP | Fixed in 2020.9.2 | [Bug report](https://hackerone.com/reports/953219), [Vendor release notes](https://portswigger.net/burp/releases/professional-community-2020-9-2) |
| Dovecot | SMTP | Fixed in 2.3.14.1 and 2.3.15 | [CVE-2021-33515](https://nvd.nist.gov/vuln/detail/CVE-2021-33515) |
| Mercury/32 | SMTP/POP3/IMAP | Fixed in 4.90 | [CVE-2021-33487](https://nvd.nist.gov/vuln/detail/CVE-2021-33487) |
| QMail Toaster (1.4.1) | SMTP | Project discontinued | - |
| Courier | POP3 | Fixed in 1.1.5 (reported privately), known since 2013 | [Discussion from 2013](https://sourceforge.net/p/courier/mailman/courier-imap/thread/525D3389.4080507%40csi.uned.es/), [CVE-2021-38084](https://nvd.nist.gov/vuln/detail/CVE-2021-38084), [Fix](https://sourceforge.net/p/courier/mailman/message/37329216/) |
| PHP (stream\_socket\_enable\_crypto) | SMTP/POP3/IMAP | Unfixed | [Bug report (private)](https://bugs.php.net/bug.php?id=80008) |

#### Session Fixation

| Product | Protocol | Status | Links |
| --- | --- | --- | --- |
| Citadel | POP3/IMAP | Reported via forum, unfixed | [Forum with report](https://uncensored.citadel.org/dotgoto?room=Citadel%20Security), [CVE-2021-37845](https://nvd.nist.gov/vuln/detail/CVE-2021-37845) |
| IPswitch iMail | POP3/IMAP | Fixed in iMail 12.5.8 | [CVE-2021-37846](https://nvd.nist.gov/vuln/detail/CVE-2021-37846), [Changelog](https://docs.ipswitch.com/_Messaging/IMailServer/v12.5.8/ReleaseNotes/index.htm#link2) |

#### Miscellaneous Issues

| Product | Protocol | Description | Status | Links |
| --- | --- | --- | --- | --- |
| Nemesis (used by GMX / Web.de, provider) | SMTP | Advertises authentication before STARTTLS even though it is disabled | Fixed (reported via Bugbounty) | - |

### Media reports

[Golem.de: Sicherheitsrisiko STARTTLS](https://www.golem.de/news/verschluesselung-sicherheitsrisiko-starttls-2108-158714.html)

[The Hacker News: Dozens of STARTTLS Related Flaws Found Affecting Popular Email Clients](https://thehackernews.com/2021/08/dozens-of-starttls-related-flaws-found.html)

[The Record: STARTTLS implementations in email clients & servers plagued by 40+ vulnerabilities](https://therecord.media/starttls-implementations-in-email-clients-servers-plagued-by-40-vulnerabilities/)

[SecurityLab.ru: Десятки уязвимостей в протоколе STARTTLS затрагивают популярные почтовые клиенты](https://www.securitylab.ru/news/523448.php)

[LWN: STARTTLS considered harmful](https://lwn.net/Articles/866481/)

[Bulletproof TLS Newsletter: Vulnerabilities show fragility of STARTTLS](https://www.feistyduck.com/bulletproof-tls-newsletter/issue_80_vulnerabilities_show_fragility_of_starttls)

[APNIC blog: Vulnerabilities show why STARTTLS should be avoided if possible](https://blog.apnic.net/2021/11/18/vulnerabilities-show-why-starttls-should-be-avoided-if-possible/)

### Presentations

[USENIX Security '21 - Why TLS is better without STARTTLS](https://www.youtube.com/watch?v=cJhJdMC_PGI)

[Driving IT Conference 2021: STARTTLS endangers your E-Mail passwords](https://videos.ida.dk/media/STARTTLS%2Bendangers%2Byour%2BE-Mail%2Bpasswords%2Bv%2BHanno%2BB%C3%B6ck/1_8t4x51z0/235923713)

### Followup research

After we published our research some people found similar bugs in other software and other
protocols using STARTTLS.

[StartTLS in LDAP](https://fy.blackhats.net.au/blog/html/2021/08/12/starttls_in_ldap.html)

[nbdkit: Reset structured replies on STARTTLS (CVE-2021-3716)](https://listman.redhat.com/archives/libguestfs/2021-August/msg00077.html)

[fetchmail: STARTTLS session encryption bypassing (CVE-2021-39272)](https://www.fetchmail.info/fetchmail-SA-2021-02.txt)

[curl 7.79.0 fixes two STARTTLS vulnerabilities](https://daniel.haxx.se/blog/2021/09/15/curl-7-79-0-secure-local-cookies/)

[CVE-2021-38542: Apache James vulnerable to STARTTLS command injection (IMAP and POP3)](https://lists.apache.org/thread/j8p5n4g431hwy78qro6mwchbogq1zpck)

[CVE-2021-32066: A StartTLS stripping vulnerability in Net::IMAP](https://www.ruby-lang.org/en/news/2021/07/07/starttls-stripping-in-net-imap/)

The website design was "stolen" from the DROWN website and slightly adapted;
it was created by [Sarah Madden](http://sarahmadden.com/).
The logo was created by [foxitalic](https://twitter.com/foxitalic).
Logo, design, and content of this website are under a
[CC0](https://creativecommons.org/publicdomain/zero/1.0/) license.
| [Imprint](/imprint)

First published: 2021-08-09, last changes: 2024-01-24



=== Content from bugs.gentoo.org_3ea87aca_20250115_112352.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 807613
<mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)
Last modified: 2023-01-11 05:25:24 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=807613&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=807613&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 807613**](show_bug.cgi?id=807613)
(CVE-2021-38370, CVE-2021-46853)
- <mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-38370, CVE-2021-46853 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://nostarttls.secvuln.info> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [807352](show_bug.cgi?id=807352 "IN_PROGRESS - [Tracker] NO STARTTLS collection of vulnerabilities") | |  | Show dependency [tree](showdependencytree.cgi?id=807613&hide_resolved=1) | |  | | Reported: | 2021-08-10 20:04 UTC by John Helmert III | | --- | --- | | Modified: | 2023-01-11 05:25 UTC ([History](show_activity.cgi?id=807613)) | | CC List: | 2 users (show)  gentoo.2019 proxy-maint | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [CVE-2020-14929](show_bug.cgi?id=728822 "RESOLVED FIXED - <mail-client/alpine-2.23: Fails to upgrade to secure TLS connection (STARTTLS) (CVE-2020-14929)") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=807613&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=807613&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-08-10 20:04:32 UTC  ``` CVE-2021-38370:  In Alpine through 2.24, untagged responses from an IMAP server are accepted before STARTTLS.  There's also an issue described on the NO STARTTLS website that says "Crash when LIST or LSUB send before STARTTLS". Both the status of this issue and the CVE are "Unknown (reported via email). ```  [Comment 1](#c1)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-08-10 20:05:32 UTC  ``` The vulnerability described in this bug was also in the NO STARTTLS report. ```  [Comment 2](#c2)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 20:13:57 UTC  ``` Hm. I'm not sure this was ever addressed by upstream.  There's another vulnerability in the NO STARTTLS report that doesn't have a CVE, too:  "Crash when LIST or LSUB send before STARTTLS" ```  [Comment 3](#c3)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 20:25:25 UTC  ``` Just requested a CVE for the second issue and mailed upstream. ```  [Comment 4](#c4)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 21:53:08 UTC  ``` Upstream says both of these are fixed by:   commit e58edb33f71687cb0b12c10a6cea2db2f8a35011 Author: Eduardo Chappa <chappa@washington.edu> Date:   Sun Aug 15 20:53:04 2021 -0600      * The c-client library parses information from an IMAP server during       non-authenticated state which could lead to denial of service.       Reported by Damian Poddebniak from Münster University of Applied       Sciences.   Which is in 2.25 and onwards, so we've been fixed for a while. ```  [Comment 5](#c5)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-05 16:23:36 UTC  ``` I got another mail from upstream, and with their consent I'm reproducing the text of it here as context for the CVE, along with my reply:  > > Dear John, > > > >    I took a look at > > > > <https://nvd.nist.gov/vuln/detail/CVE-2021-46853> > > > > and the description of the report says > > > > Alpine before 2.25 allows remote attackers to cause a denial of service > > (daemon crash) when LIST or LSUB is sent before STARTTLS. > > > > Do you mean to say that Alpine sends a LIST or LSUB comand before > > STARTTLS and it is crashing servers? If that is the case, this is wrong. > > Could you please clarify this? > > I didn't write the description. I have in the past for CVEs I've > requested, but stopped once I noticed that MITRE just ended up writing > their own descriptions anyway. I'm not surprised they outright got it > wrong, and even if it were the case that Alpine could crash remote > servers, that would be a vulnerability in the server and not the > software that triggered the crash. I'll attempt to get them to correct > the description. > > Do you mind if I reproduce the text of your email into a comment on > our bugzilla? It will be easier to convince them if I can point to > your saying that it's wrong. ```  [Comment 6](#c6)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-22 17:24:06 UTC  ``` GLSA request filed. ```  [Comment 7](#c7)  Larry the Git Cow   gentoo-dev  2023-01-11 05:22:53 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80>  commit d167c115f5378da115e01a8dce0dc7d221bf0d80 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2023-01-11 05:18:50 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2023-01-11 05:22:06 +0000      [ GLSA 202301-07 ] Alpine: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/807613>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202301-07.xml | 43 +++++++++++++++++++++++++++++++++++++++++++  1 file changed, 43 insertions(+) ```  [Comment 8](#c8)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-01-11 05:25:24 UTC  ``` GLSA released, all done! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=807613)
* - [XML](show_bug.cgi?ctype=xml&id=807613)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=807613)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=807613&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=807613&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=807613&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_48a1ca02_20250114_182507.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 807613
<mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)
Last modified: 2023-01-11 05:25:24 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=807613&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=807613&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 807613**](show_bug.cgi?id=807613)
(CVE-2021-38370, CVE-2021-46853)
- <mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<mail-client/alpine-2.25: STARTTLS vulnerabilities (CVE-2021-38370)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-38370, CVE-2021-46853 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://nostarttls.secvuln.info> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [807352](show_bug.cgi?id=807352 "IN_PROGRESS - [Tracker] NO STARTTLS collection of vulnerabilities") | |  | Show dependency [tree](showdependencytree.cgi?id=807613&hide_resolved=1) | |  | | Reported: | 2021-08-10 20:04 UTC by John Helmert III | | --- | --- | | Modified: | 2023-01-11 05:25 UTC ([History](show_activity.cgi?id=807613)) | | CC List: | 2 users (show)  gentoo.2019 proxy-maint | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [CVE-2020-14929](show_bug.cgi?id=728822 "RESOLVED FIXED - <mail-client/alpine-2.23: Fails to upgrade to secure TLS connection (STARTTLS) (CVE-2020-14929)") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=807613&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=807613&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-08-10 20:04:32 UTC  ``` CVE-2021-38370:  In Alpine through 2.24, untagged responses from an IMAP server are accepted before STARTTLS.  There's also an issue described on the NO STARTTLS website that says "Crash when LIST or LSUB send before STARTTLS". Both the status of this issue and the CVE are "Unknown (reported via email). ```  [Comment 1](#c1)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-08-10 20:05:32 UTC  ``` The vulnerability described in this bug was also in the NO STARTTLS report. ```  [Comment 2](#c2)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 20:13:57 UTC  ``` Hm. I'm not sure this was ever addressed by upstream.  There's another vulnerability in the NO STARTTLS report that doesn't have a CVE, too:  "Crash when LIST or LSUB send before STARTTLS" ```  [Comment 3](#c3)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 20:25:25 UTC  ``` Just requested a CVE for the second issue and mailed upstream. ```  [Comment 4](#c4)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-01 21:53:08 UTC  ``` Upstream says both of these are fixed by:   commit e58edb33f71687cb0b12c10a6cea2db2f8a35011 Author: Eduardo Chappa <chappa@washington.edu> Date:   Sun Aug 15 20:53:04 2021 -0600      * The c-client library parses information from an IMAP server during       non-authenticated state which could lead to denial of service.       Reported by Damian Poddebniak from Münster University of Applied       Sciences.   Which is in 2.25 and onwards, so we've been fixed for a while. ```  [Comment 5](#c5)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-05 16:23:36 UTC  ``` I got another mail from upstream, and with their consent I'm reproducing the text of it here as context for the CVE, along with my reply:  > > Dear John, > > > >    I took a look at > > > > <https://nvd.nist.gov/vuln/detail/CVE-2021-46853> > > > > and the description of the report says > > > > Alpine before 2.25 allows remote attackers to cause a denial of service > > (daemon crash) when LIST or LSUB is sent before STARTTLS. > > > > Do you mean to say that Alpine sends a LIST or LSUB comand before > > STARTTLS and it is crashing servers? If that is the case, this is wrong. > > Could you please clarify this? > > I didn't write the description. I have in the past for CVEs I've > requested, but stopped once I noticed that MITRE just ended up writing > their own descriptions anyway. I'm not surprised they outright got it > wrong, and even if it were the case that Alpine could crash remote > servers, that would be a vulnerability in the server and not the > software that triggered the crash. I'll attempt to get them to correct > the description. > > Do you mind if I reproduce the text of your email into a comment on > our bugzilla? It will be easier to convince them if I can point to > your saying that it's wrong. ```  [Comment 6](#c6)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-11-22 17:24:06 UTC  ``` GLSA request filed. ```  [Comment 7](#c7)  Larry the Git Cow   gentoo-dev  2023-01-11 05:22:53 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80>  commit d167c115f5378da115e01a8dce0dc7d221bf0d80 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2023-01-11 05:18:50 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2023-01-11 05:22:06 +0000      [ GLSA 202301-07 ] Alpine: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/807613>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202301-07.xml | 43 +++++++++++++++++++++++++++++++++++++++++++  1 file changed, 43 insertions(+) ```  [Comment 8](#c8)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-01-11 05:25:24 UTC  ``` GLSA released, all done! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=807613)
* - [XML](show_bug.cgi?ctype=xml&id=807613)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=807613)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=807613&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=807613&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=807613&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_06752f1d_20250114_182508.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Alpine: Multiple Vulnerabilities — GLSA **202301-07**

Multiple vulnerabilities have been found in Alpine, the worst of which could result in denial of service.

### Affected packages

| Package | **mail-client/alpine** on all architectures |
| --- | --- |
| Affected versions | < **2.25** |
| Unaffected versions | >= **2.25** |

### Background

Alpine is an easy to use text-based based mail and news client.

### Description

Multiple vulnerabilities have been discovered in Alpine. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Alpine users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/alpine-2.25"

```
### References

* [CVE-2021-38370](https://nvd.nist.gov/vuln/detail/CVE-2021-38370)
* [CVE-2021-46853](https://nvd.nist.gov/vuln/detail/CVE-2021-46853)

**Release date**

January 11, 2023

**Latest revision**

January 11, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [807613](https://bugs.gentoo.org/show_bug.cgi?id=807613)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from alpineapp.email_9e254fbf_20250115_112354.html ===

![Alpine Logo](../../images/alpinelogo.gif)

# Alpine Email Program

## Welcome!

The purpose of this page is to distribute releases of Alpine, as well as
to provide users with documentation on Alpine. All documentation needed to
configure Alpine can be found in the binary, and this page may provide
extra documentation. In any case, you are not required, nor encouraged to
access this site to run Alpine. You can run Alpine in your computer
without the need to ever visit this site. All documentation needed to
configure Alpine can be found in the binary, and can be read by either
pressing the "?" command or by pressing "^G" in Alpine.
This site does not use cookies, runs javascript, or tracks you in any
form.

**Privacy Policy**

Your privacy is important to me. When you access this site a log is kept
on the pages you visited. I have access to daily logs which are normally
erased, and if I do not see them, I miss them. I must login to this site
about twice a month, and I take a look at the site logs at that time. The
logs record your IP address, the date and time when you made a request to
the server, the exact request you made, the http status code received by
your server, and the browser you used. When I read the logs, I only look
at which pages people have accessed, and make a mental note about them,
and I do not make any concerted effort to associate an IP address with a
pattern of visits. This information is just for purposes of me knowing
what pages users visited, and nothing more. I have had access to this
information since March 2020, and no information previous to that time is
available to me.

I also find it amusing to read the 404 errors. It shows people looking for
newer versions of Alpine, and other plugins that do not exist. I try not
to link to missing pages, but if I do, please report it to me so that I
can fix it.

While I do not do anything to link you with your visit to this site, I do
not know what my free web site provider does with this information.
Continuing that idea, I do not know what your ISP does with this data
either, and if you contact me, I do not know what my email service
provider or your email service does with that information either. However,
if you contact me, I will use that information to contact you back in case
I need to, and I will only contact you in reference to
the topic of your message. I will never ask you for passwords, or
sensitive information that is not needed to debug an issue you might have
found. I normally keep records of all messages that are sent to me and
those that I send. I sometimes need to access those records to remind me
of past issues and their solutions. If you would like me to delete records
of my conversation with you, I will do so, but you must initiate that
request.

Finally, rest assured that I will never sell or share information about
your visit to this site, or the fact you contacted me, with anyone.

### **Latest Release Version 2.25**

* **Source Code**
  [**alpine-2.25.tar.xz**](../../alpine/release/src/Old/alpine-2.25.tar.xz)
  (MD5: 50e59c7979f43fcc7a45e43760e2a97d
  (SHA256: 658a150982f6740bb4128e6dd81188eaa1212ca0bf689b83c2093bb518ecf776)

  * **Windows Binary**
    + For Windows 10 or any 64 bit version of WIndows: [**alpine-2.25.zip**](../../alpine/release/src/Old/alpine-2.25.zip)

      (MD5: 0aa2f784549fb4e144182a38e95033a1)

      (SHA256: b97cddad140a00e91d17a33d4029731033586718660d4acbaa8c3dc8cb54e581)+ For an old version of Windows, such as XP, which is 32 bit: [**alpine-2.25\_32bits.zip**](../../alpine/release/src/Old/alpine-2.25_32bits.zip)

        (MD5: 351f72709ac3ee12f17e489955da8e39)

        (SHA256: 28a9740a7fdcfe11301d5950404d229d2a8cda605d114dc1ba807cf2d36b0f79)

This version is released under the Apache License Version 2.0.

Version 2.25 includes several new features and bug fixes.

Additions include:

* Unix Alpine: New configuration variable ssl-ciphers that allows
  users to list the ciphers to use when connecting to a SSL server.
  Based on a collaboration with Professor Martin Trusler.* New hidden feature enable-delete-before-writing
    to add support for terminals that need lines to be deleted
    before being written. Based on a collaboration with Professor
    Martin Trusler.* Experimental: The instruction to remove the double quotes from the processing of
      customized headers existed in pine, but it was removed in alpine. Restoring
      old Alpine behavior. See
      [this](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=981781)* Add the capability to record http debug. This is necessary to debug XOAUTH2
        authentication, and records sensitive login information. Do not share your
        debug file if you use this form of debug.* Remove the ability to choose between the device and authorize methods
          to login to outlook, since the original client-id can only be used
          for the device method. One needs a special client-id and client-secret
          to use the authorize method in Outlook.* PC-Alpine only: Some service providers produce access tokens that are
            too long to save in the Windows Credentials, so the access tokens will
            be split and saved as several pieces. This means that old versions of
            Alpine will NOT be able to use saved passwords once this new version of
            Alpine is used.* PC-Alpine: Debug files used to be created with extension .txt1, .txt2, etc.
              Rename those files so that they have extension .txt.* Always follow "suppress-asterisks-in-password-prompt" setting in the
                various password prompts. Submitted by Étienne Deparis.* Use 'alpine -F' instead of 'pine -F' as the browser default pager.
                  Submitted by Étienne Deparis.* Introduction of OTHER CMDS menu for the browser/pilot to let
                    people discover the two new commands: "1" is a toggle that
                    switches between 1 column and multicolumn mode. The "." command
                    toggles between hiding or showing hidden files, and the "G"
                    command to travel between directories. Contributed by Étienne
                    Deparis.* Add option -xoauth2-flow to the command line, so that users can specify the
                      parameters to set up an xoauth2 connection through the command line.* Alpine deletes, from its internal memory and external cache, passwords
                        that do not work, even if they were saved by the user.* New format for saving passwords in the windows credential manager
                          for PC-Alpine. Upon starting this new version of Alpine the passwords
                          saved in the credential manager are converted to the new format and
                          they will not be recognized by old versions of Alpine, but only by
                          this and newer versions of Alpine.* Enabled encryption protocols in PC-Alpine are based on those enabled
                            in the system, unless one is specified directly.

Bugs that have been addressed include:

* The c-client library parses information from an IMAP server during
  non-authenticated state which could lead to denial of service.
  Reported by Damian Poddebniak from Münster University of Applied
  Sciences.* Memory corruption when alpine searches for a string that is
    an incomplete utf8 string in a local folder. This could happen by
    chopping a string to make it fit a buffer without regard to its content.
    We fix the string so that chopping it does not damage it. Reported
    by Andrew.* Crash in the ntlm authenticator when the user name does not include
      a domain. Reported and fixed by Anders Skargren.* When forwarding a message, replacing an attachment might make Alpine
        re-attach the original attachment. Reported by Michael Traxler.* When an attachment is deleted, the saved message with the deleted
          attachment contains extra null characters after the end of the
          attachment boundary.* Tcp and http debug information is not printed unless the default
            debug level is set to 1. Print this if requested, regardless of what
            the default debug level is.* When trying to select a folder for saving a message, one can only enter
              a subfolder by pressing the ">" command, rather than the normal
              navigation by pressing "Return". Reported by Ulf-Dietrich Braunmann.* Crash when attempting to remove a configuration for a XOAUTH2 server
                that has no usernames configured.* Crash caused by saving (and resaving) XOAUTH2 refresh and access tokens
                  in PC-Alpine. Reported by Karl Lindauer.

In order to compile this source code you need OpenSSL version 1.0.0c or
later. In addition, Alpine can be compiled with recent versions of LibreSSL.

In order to decompress use the command

tar -Jxf alpine-2.25.tar.xz

This page Copyright 2021 © Eduardo Chappa

[Terms of Service](../../legal/terms.html)
[Alpine Privacy Policy](../../legal/privacy.html)
[Contact Information](../../alpine/contact.html)
**Links to old releases**
[Alpine 2.24](../../alpine/release/alpine-2.24.html)
[Alpine 2.23](../../alpine/release/alpine-2.23.html)
[Alpine 2.22](../../alpine/release/alpine-2.22.html)
[Alpine 2.21](../../alpine/release/alpine-2.21.html)
[Alpine 2.20](../../alpine/release/alpine-2.20.html)
[Alpine 2.11](../../alpine/release/alpine-2.11.html)
[Alpine 2.10](../../alpine/info/alpine.html)
[Alpine 2.01](../../alpine/release/src/Old/alpine-2.01.clean.tar.lzma)
**[Patches for Alpine](../../alpine/index.html)**
**Help for Alpine**
[Compiling Alpine](../../alpine/alpine-info/build/index.html)
[XOAUTH2](../../alpine/alpine-info/misc/xoauth2.html)
[ooauth2.py script](../../scripts/ooauth2.html)
[S/MIME](../../alpine/alpine-info/misc/smime.html)
[Flowed Text](../../alpine/alpine-info/misc/flowed.html)
[Maildrops](../../alpine/alpine-info/maildrop/index.html)
[Filters](../../alpine/alpine-info/filters/index.html)
[Roles](../../alpine/alpine-info/roles/index.html)
[Scores](../../alpine/alpine-info/scores/index.html)
[Headers](../../alpine/alpine-info/misc/headers.html)
[Index Screen](../../alpine/alpine-info/misc/index-format.html)
[Signature](../../alpine/alpine-info/misc/signature.html)
[Search](../../alpine/alpine-info/misc/search.html)
[Mailcap and Mime](../../alpine/alpine-info/misc/mime.html)
[The Compose Command](../../alpine/alpine-info/commands/compose.html)
[The Reply Command](../../alpine/alpine-info/commands/reply.html)
[Folder Collections](../../alpine/alpine-info/collections/index.html)
[Incoming Folders](../../alpine/alpine-info/collections/incoming-folders/index.html)
[Mail Collection](../../alpine/alpine-info/collections/Mail/index.html)
[News Collection](../../alpine/alpine-info/collections/News/index.html)
**Other Links**
[Patches for Pine](../../pine/index.html)
[Help for Pine](../../pine/pine-info/index.html)
[Identities for Powers of Fibonacci Numbers](../../math/fqidentities.pdf)
[Collection of Identities for Powers of Fibonacci Numbers](../../math/identities.pdf)
[Old Home Page](../../history.html)

Last Updated Sat 18 Sep 2021 09:41:11 AM MDT



=== Content from gitweb.gentoo.org_5838f47f_20250115_112350.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
GitWeb

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Gentoo Repository](/repo/gentoo.git)
* [Repositories](/repo/)
* [Projects](/proj/)
* [Developer Overlays](/dev/)
* [User Overlays](/user/)
* [Data](/data/)
* [Websites](/sites/)

| [cgit logo](/) | [index](/) : [data/glsa.git](/data/glsa.git/) | glsamakerdev master |
| --- | --- | --- |
| Gentoo Linux Security Advisories | Gentoo Security <security@gentoo.org> |

| [summary](/data/glsa.git/)[refs](/data/glsa.git/refs/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)[log](/data/glsa.git/log/)[tree](/data/glsa.git/tree/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)[commit](/data/glsa.git/commit/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)[diff](/data/glsa.git/diff/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | GLSAMaker <glsamaker@gentoo.org> | 2023-01-11 05:18:50 +0000 |
| --- | --- | --- |
| committer | John Helmert III <ajak@gentoo.org> | 2023-01-10 23:22:06 -0600 |
| commit | [d167c115f5378da115e01a8dce0dc7d221bf0d80](/data/glsa.git/commit/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80) ([patch](/data/glsa.git/patch/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)) | |
| tree | [beb245254f055051dff8af43e89c88a1cea3a3f6](/data/glsa.git/tree/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80) | |
| parent | [[ GLSA 202301-06 ] liblouis: Multiple Vulnerabilities](/data/glsa.git/commit/?id=34441de4265fa8cf17547bd256447ecec4367521) ([diff](/data/glsa.git/diff/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80&id2=34441de4265fa8cf17547bd256447ecec4367521)) | |
| download | [glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.tar.gz](/data/glsa.git/snapshot/glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.tar.gz)[glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.tar.bz2](/data/glsa.git/snapshot/glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.tar.bz2)[glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.zip](/data/glsa.git/snapshot/glsa-d167c115f5378da115e01a8dce0dc7d221bf0d80.zip) | |

[ GLSA 202301-07 ] Alpine: Multiple VulnerabilitiesBug: https://bugs.gentoo.org/807613
Signed-off-by: GLSAMaker <glsamaker@gentoo.org>
Signed-off-by: John Helmert III <ajak@gentoo.org>
[Diffstat](/data/glsa.git/diff/?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)

| -rw-r--r-- | [glsa-202301-07.xml](/data/glsa.git/diff/glsa-202301-07.xml?id=d167c115f5378da115e01a8dce0dc7d221bf0d80) | 43 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 43 insertions, 0 deletions

| diff --git a/glsa-202301-07.xml b/glsa-202301-07.xmlnew file mode 100644index 00000000..432c14e7--- /dev/null+++ b/[glsa-202301-07.xml](/data/glsa.git/tree/glsa-202301-07.xml?id=d167c115f5378da115e01a8dce0dc7d221bf0d80)@@ -0,0 +1,43 @@+<?xml version="1.0" encoding="UTF-8"?>+<!DOCTYPE glsa SYSTEM "http://www.gentoo.org/dtd/glsa.dtd">+<glsa id="202301-07">+ <title>Alpine: Multiple Vulnerabilities</title>+ <synopsis>Multiple vulnerabilities have been found in Alpine, the worst of which could result in denial of service.</synopsis>+ <product type="ebuild">alpine</product>+ <announced>2023-01-11</announced>+ <revised count="1">2023-01-11</revised>+ <bug>807613</bug>+ <access>remote</access>+ <affected>+ <package name="mail-client/alpine" auto="yes" arch="\*">+ <unaffected range="ge">2.25</unaffected>+ <vulnerable range="lt">2.25</vulnerable>+ </package>+ </affected>+ <background>+ <p>Alpine is an easy to use text-based based mail and news client.</p>+ </background>+ <description>+ <p>Multiple vulnerabilities have been discovered in Alpine. Please review the CVE identifiers referenced below for details.</p>+ </description>+ <impact type="low">+ <p>Please review the referenced CVE identifiers for details.</p>+ </impact>+ <workaround>+ <p>There is no known workaround at this time.</p>+ </workaround>+ <resolution>+ <p>All Alpine users should upgrade to the latest version:</p>+ + <code>+ # emerge --sync+ # emerge --ask --oneshot --verbose ">=mail-client/alpine-2.25"+ </code>+ </resolution>+ <references>+ <uri link="https://nvd.nist.gov/vuln/detail/CVE-2021-38370">CVE-2021-38370</uri>+ <uri link="https://nvd.nist.gov/vuln/detail/CVE-2021-46853">CVE-2021-46853</uri>+ </references>+ <metadata tag="requester" timestamp="2023-01-11T05:18:50.361361Z">ajak</metadata>+ <metadata tag="submitter" timestamp="2023-01-11T05:18:50.363738Z">ajak</metadata>+</glsa> \ No newline at end of file |
| --- |

### Questions or comments?

Please feel free to [contact us](https://www.gentoo.org/inside-gentoo/contact/).

**© 2001–2024 Gentoo Authors**

Gentoo is a trademark of the Gentoo Foundation, Inc. and of Förderverein Gentoo e.V.
The contents of this document, unless otherwise expressly stated, are licensed under the
[CC-BY-SA-4.0](https://creativecommons.org/licenses/by-sa/4.0/) license.
The [Gentoo Name and Logo Usage Guidelines](https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html) apply.


