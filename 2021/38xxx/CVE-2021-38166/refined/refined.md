```
{
  "vulnerability": {
    "root_cause": "Integer overflow in the calculation of memory allocation size within the `__htab_map_lookup_and_delete_batch` function in the BPF subsystem.",
    "weaknesses": [
      "Integer overflow leading to out-of-bounds write",
       "Insufficient validation of input parameters"
    ],
    "impact": "Denial of Service (DoS), potential arbitrary code execution, information disclosure",
    "attack_vectors": [
       "Local attacker with CAP_SYS_ADMIN can easily trigger by using BPF_F_ZERO_SEED to force hash collisions",
        "Local attacker without CAP_SYS_ADMIN can trigger by guessing the random seed, though this is less likely"
    ],
    "required_capabilities": "Local access. For easier exploitation, CAP_SYS_ADMIN is needed, but it is possible without it by guessing the random seed used for hash generation."
  },
  "affected_components": [
    "Linux kernel's BPF subsystem",
    "NetApp products incorporating vulnerable Linux Kernel versions prior to 5.13.8"
   ],
  "references": [
    "https://lore.kernel.org/bpf/20210806150419.109658-1-th.yasumatsu@gmail.com",
     "https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=c4eb1f403243fc7bbb7de644db8587c03de36da6",
    "https://security.netapp.com/advisory/ntap-20210909-0001",
    "https://bugzilla.redhat.com/show_bug.cgi?id=1993190",
    "https://www.debian.org/security/2021/dsa-4978"
  ],
    "remediation": "The integer overflow vulnerability was addressed by switching from `kvmalloc()` to `kvmalloc_array()` in the `__htab_map_lookup_and_delete_batch` function. This ensures correct memory allocation based on the multiplication of element size and the number of elements (bucket_size).",
    "additional_notes": "The vulnerability was found in the batch operations for hash table BPF maps. The vulnerability can be triggered by causing multiple keys to hash to the same bucket and forcing an integer overflow when allocating memory for batch operations. Unprivileged access to `bpf()` is disabled by default in Debian, which serves as a mitigation for this vulnerability. NetApp has stated they have no plans to address this vulnerability for some of their affected products."
}
```