=== Content from www.wordfence.com_4512c680_20250115_082347.html ===


![Post Title teaser on background showing ripped black and red posterboard](https://www.wordfence.com/wp-content/uploads/2021/10/xss-vuln-in-social-autoposter-plugin-100000-sites-feature.jpg)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

October 28, 2021

# XSS Vulnerability in NextScripts: Social Networks Auto-Poster Plugin Impacts 100,000 Sites

*Note: To receive disclosures like this in your inbox the moment they’re published, you can subscribe to our* [*WordPress Security Mailing List*](https://www.wordfence.com/subscribe-to-the-wordfence-email-list/)*.*

On August 19, 2021, the Wordfence Threat Intelligence team began the disclosure process for a reflected Cross-Site Scripting(XSS) vulnerability we found in [NextScripts: Social Networks Auto-Poster](https://wordpress.org/plugins/social-networks-auto-poster-facebook-twitter-g/), a WordPress plugin with over 100,000 installations.

The plugin’s developer responded, so we confidentially provided the full disclosure the next day, on August 20, 2021. After several weeks without updates, we followed up with the developer on September 27, 2021, and a patched version of the plugin, 4.3.21, was released on October 4, 2021.

All Wordfence users, including Wordfence Premium customers as well as those still using the free version of Wordfence, are protected against this vulnerability by our firewall’s built-in cross-site scripting protection.

---

**Description:** Reflected Cross-Site Scripting(XSS)

**Affected Plugin:** NextScripts: Social Networks Auto-Poster

**Plugin Slug:** social-networks-auto-poster-facebook-twitter-g

**Affected Versions:** <= 4.3.20

**CVE ID:** [CVE-2021-38356](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38356)

**CVSS Score:** 6.1(Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Ramuel Gall

**Fully Patched Version:** 4.3.21

The `nxs_ReposterListTable::column_title` function in `inc/nxs_class_snap.php` echoed out the value of `$_REQUEST[‘page’]` when an administrator was visiting the plugin administration page at `wp-admin/admin.php?admin.php?page=nxssnap-post`.

```
    function column_post_title($item){
        //Build row actions
        $actions = array(
            'edit'      => sprintf('<a href="?page=%s&action=%s&item=%s">Edit</a>',$_REQUEST['page'],'edit',$item->ID),
            'delete'    => sprintf('<a href="?page=%s&action=%s&item=%s">Delete</a>',$_REQUEST['page'],'delete',$item->ID),
        );
        //Return the title contents
        return sprintf('%1$s <span style="color:silver">(id:%2$s)</span>%3$s',
            /*$1%s*/ $item->post_title,
            /*$2%s*/ $item->ID,
            /*$3%s*/ $this->row_actions($actions)
        );
    }
```

WordPress uses the value of the `$_GET[‘page’]` parameter in order to determine which administrative page to serve content for. It is also common practice for developers to use `$_REQUEST` for values stored in either `$_GET` or `$_POST`, as the `$_REQUEST` superglobal contains everything set in both `$_GET` and `$_POST`. As such, `$_REQUEST[‘page’]` might be expected to be set to the same value as `$_GET[‘page’]`.

However, thanks to a quirk of how PHP orders parameters that are present in multiple superglobal variables, it was possible to perform a reflected cross-site scripting attack.

In most PHP configurations, depending on the `request_order` (or the `variables_order` if `request_order` is not set), `$_POST` takes precedence over `$_GET` when populating `$_REQUEST`. In other words, if both `$_GET[‘page’]` and `$_POST[‘page’]` are set, `$_REQUEST[‘page’]` will be set to the contents of `$_POST[‘page’]`, rather than `$_GET[‘page’]`.

This meant that it was possible to execute JavaScript in the browser of a logged-in administrator by tricking them into visiting a self-submitting form that sent a `POST` request to their site, for example,  `hxxps://victimsite.site/wp-admin/admin.php?page=nxssnap-post`, with the `$_POST[‘page’]` parameter set to malicious JavaScript.

The `$_GET[‘page’]` parameter could be set to `nxssnap-post`, so that WordPress would route the victim to the correct page, and then the malicious JavaScript in `$_POST[‘page’]` would be echoed out on that page.

As with all XSS attacks, malicious JavaScript running in an administrator’s session could be used to add malicious administrative users or insert backdoors into a site, and thus be used for site takeover.

## Timeline

**August 19, 2021** – We finish our investigation and begin the disclosure process for NextScripts: Social Networks Auto-Poster.

**August 20, 2021** – We send over full disclosure to the plugin developer.

**September 27, 2021** – We follow up with the plugin developer as the plugin has not yet been patched.

**October 4, 2021** – A patched version of the plugin, 4.3.21, becomes available.

## Conclusion

In today’s post, we covered a reflected Cross-Site Scripting(XSS) vulnerability that relied on a relatively obscure quirk of how PHP handles superglobal variables.

All Wordfence users, including [Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog2021028&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) customers and free Wordfence users are protected by our firewall’s built-in XSS protection. Nonetheless, we strongly recommend updating to the latest version of the plugin available, which is 4.3.23 at this time.

If you know a friend or colleague who is using this plugin on their site, we highly recommend forwarding this advisory to them to help keep their sites protected as this is a serious vulnerability that can lead to complete site takeover.

*If your site has been compromised by an attack on this or any other plugin, our* [*Professional Site Cleaning*](https://www.wordfence.com/wordfence-site-cleanings/?promo_id=blog20211028&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) *services can help you get back in business.*

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fxss-vulnerability-in-nextscripts-social-networks-auto-poster-plugin-impacts-100000-sites%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fxss-vulnerability-in-nextscripts-social-networks-auto-poster-plugin-impacts-100000-sites%2F&text=XSS%20Vulnerability%20in%20NextScripts%3A%20Social%20Networks%20Auto-Poster%20Plugin%20Impacts%20100%2C000%20Sites&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2021%2F10%2Fxss-vulnerability-in-nextscripts-social-networks-auto-poster-plugin-impacts-100000-sites%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


