=== Content from noob3xploiter.medium.com_c3627ec1_20250115_091358.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F92cd88e1d503&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-2-strcpy-buffer-overflow-92cd88e1d503&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-2-strcpy-buffer-overflow-92cd88e1d503&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Hacking the Tenda AC10–1200 Router Part 2: Strcpy Buffer Overflow

[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:88:88/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---byline--92cd88e1d503--------------------------------)

[Brandon Roldan](/?source=post_page---byline--92cd88e1d503--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fec6efbb67a4&operation=register&redirect=https%3A%2F%2Fnoob3xploiter.medium.com%2Fhacking-the-tenda-ac10-1200-router-part-2-strcpy-buffer-overflow-92cd88e1d503&user=Brandon+Roldan&userId=ec6efbb67a4&source=post_page-ec6efbb67a4--byline--92cd88e1d503---------------------post_header-----------)

4 min read·Aug 7, 2021

--

Listen

Share

Hi. This would be another series of writeup where we will try to hack the tenda ac10 1200 and try to get a cve. This writeup is fairly short so lets get started

While looking through the functions of tenda, i found this one interesting function `saveParentControlInfo`

![]()

What made this function interesting is this.

![]()

We can see here that it get the value of the post parameter `urls` using `websGetVar` then save its value to the variable `var_3bc`. If we follow this variable, we will see this.

![]()

We can see that it is used as an argument to `strcpy`. Now as we all know, `strcpy` is vulnerable to buffer overflow. So lets try it our, if we send a a long string in the `urls` parameter, the server should crash. But first, we have to find out the vulnerable endpoint.

Looking at the cross references to `saveParentControlInfo`, i saw a cross references to `formDefineTendDa`

![]()

That means, our vulnerable endpoint is `saveParentControlInfo`, so now, we can test it out.

I tried it out in burpsuite and saw this,

![]()

`“errCode”:1` , that is not what were expecting, lets find out why that happened. After reversing the function once again, i found the `errCode: 1`

![]()

We can see the error code string there. Now lets see what causes it to jump there.

![]()

Here, we can see that it checks if the `var_3b4` is equals to zero, if it is, it will jump to the errCode. if we follow this `var_3b4`,

![]()

We can see that it is the output of `websGetVar` with time parameter. In our last attempt, we didnt send a time parameter so it is equal to null which caused the jump to the errCode. Lets try it again but this time, lets provide a time parameter

![]()

No response, lets try it again

![]()

Failed to connect. That means we successfully crashed the web server. We can confirm it even more by looking at the emulation

![]()

So we have a buffer overflow confirmed.

Sadly, we cant overwrite the program pointer since this is a heap overflow. If we go back to the vulnerable strcpy

![]()

We can see that in the first argument ***$a0***, it uses the variable `var_3d8 + 0x50`. If we trace back this `var_3d8`, we can see that it is the output of `malloc`

![]()

meaning, it is pointing to the heap, not the stack, thats why we cant overwrite the program pointer with what we want. However, with heap overflow, we can overwrite the other data in the heap. But i will end the writeup now.

Other parameter is also vulnerable like deviceId and time but i didnt talked about them since it is already reported and is already a cve [CVE-2020–13393](https://joel-malwarebenchmark.github.io/blog/2020/04/28/cve-2020-13393-Tenda-vulnerability/). This one is not a cve yet tho so this is the one that i focused in this writeup.

I tried contacting tenda but they didnt responded so i decided to publish this writeup now.

Thanks for reading.

Join the discord server: <https://discord.gg/bugbounty>

[Hacking](https://medium.com/tag/hacking?source=post_page-----92cd88e1d503--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----92cd88e1d503--------------------------------)[Infosec](https://medium.com/tag/infosec?source=post_page-----92cd88e1d503--------------------------------)[Hack](https://medium.com/tag/hack?source=post_page-----92cd88e1d503--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----92cd88e1d503--------------------------------)

--

--

[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:96:96/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---post_author_info--92cd88e1d503--------------------------------)[![Brandon Roldan](https://miro.medium.com/v2/resize:fill:128:128/1*jPpWOq7bOfLUQ0zhtegAhA.jpeg)](/?source=post_page---post_author_info--92cd88e1d503--------------------------------)Follow[## Written by Brandon Roldan](/?source=post_page---post_author_info--92cd88e1d503--------------------------------)[686 Followers](/followers?source=post_page---post_author_info--92cd88e1d503--------------------------------)·[9 Following](/following?source=post_page---post_author_info--92cd88e1d503--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----92cd88e1d503--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----92cd88e1d503--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----92cd88e1d503--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----92cd88e1d503--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----92cd88e1d503--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----92cd88e1d503--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----92cd88e1d503--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----92cd88e1d503--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----92cd88e1d503--------------------------------)[Teams](https://medium.com/business?source=post_page-----92cd88e1d503--------------------------------)


