Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability is a stored Cross-Site Scripting (XSS) issue in the ticket creation flow of Dolibarr ERP & CRM v14.0.2. The application's built-in Web Application Firewall (WAF) uses a deny list to block certain HTML tags and JavaScript events, but it fails to block all dangerous events. Specifically, the `onbeforecopy` and `onbeforecut` events were not blocked, allowing for XSS injection. Additionally, the filtering mechanism only replaces tags in `< >` and does not filter the events when they are added on attributes.

**Weaknesses/Vulnerabilities Present:**
*   **Stored XSS:** Malicious scripts are stored within the application (in this case, within a ticket message) and are executed when a user interacts with the affected content.
*   **Insufficient Input Sanitization:** The WAF's deny list approach is not comprehensive enough to prevent XSS attacks. The filtering is not applied on the attributes.
*   **Bypassable WAF:** The use of a deny list allowed attackers to find vectors not blocked (like `onbeforecopy` and `onbeforecut` events), effectively bypassing the WAF.

**Impact of Exploitation:**
*   **Privilege Escalation:** A low-level user, with access to the Tickets module, can gain full administrative privileges.
*   **Account Takeover:** Successful exploitation can lead to site-wide account takeovers.
*   **Anti-CSRF Token Theft:** Attackers could potentially steal Anti-CSRF tokens, leading to further malicious actions.
*   **Arbitrary Code Execution:** The XSS vulnerability allows the execution of arbitrary JavaScript in the context of the user that loads the page.

**Attack Vectors:**
*   **Ticket Creation:** A low-level user crafts a malicious payload within the "message" field of a ticket.
*   **Administrator Interaction:** An administrator needs to copy the text from the malicious message for the XSS to be triggered. The vulnerability also works by simply viewing the ticket.

**Required Attacker Capabilities/Position:**
*   **Authenticated User:** The attacker needs to be an authenticated user with at least access to the Tickets module.
*   **Knowledge of WAF Weakness:** The attacker needs to know about the bypassable WAF to craft a working payload using the non-blocked events.

**Additional Notes:**
* The vulnerability is specific to Dolibarr ERP & CRM version 14.0.2 and earlier.
* The vulnerability was acknowledged and fixed by the vendor after being reported.
* A proof of concept is available in Exploit-DB and Packet Storm Security.
* The filtering was also ineffective because it was only applied to tags inside `< >` and not to attributes.