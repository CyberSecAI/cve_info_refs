=== Content from packetstormsecurity.com_9210d407_20250114_190122.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from truedigitalsecurity.com_ed45fca0_20250114_190124.html ===


[![](https://www.ciso.inc/wp-content/uploads/2023/05/CISO-logo-white.svg)](/)

* [Services](https://www.ciso.inc/capabilities/)
  + [Risk & Compliance](https://www.ciso.inc/capabilities/strategy-risk-solutions/)
    - [Audit & Compliance](https://www.ciso.inc/capabilities/strategy-risk-solutions/audit-compliance-services/)
    - [CMMC for DoD Contractors](https://www.ciso.inc/industries/cmmc-dod-contractors/)
    - [FedRAMP as a Service](https://www.ciso.inc/capabilities/strategy-risk-solutions/fedramp-as-a-service/)
    - [Managed Compliance & Security](https://www.ciso.inc/capabilities/strategy-risk-solutions/managed-compliance-security-offering/)
    - [Risk Assessments](https://www.ciso.inc/capabilities/strategy-risk-solutions/cybersecurity-risk-assessment-services/)
    - [Tabletop Exercises](https://www.ciso.inc/capabilities/strategy-risk-solutions/managed-compliance-security-offering/tabletop-exercises/)
    - [vCISO Services](https://www.ciso.inc/capabilities/strategy-risk-solutions/managed-compliance-security-offering/virtual-ciso-vciso-services/)
  + [Cyber Defense Operations](https://www.ciso.inc/capabilities/cyber-defense/)
    - [Incident Response](https://www.ciso.inc/capabilities/cyber-defense/cyber-incident-response/)
    - [MDR](https://www.ciso.inc/capabilities/cyber-defense/managed-detection-and-response-mdr/)
    - [MVP](https://www.ciso.inc/capabilities/cyber-defense/patch-vulnerability-management-mvp/)
    - [SIEM](https://www.ciso.inc/capabilities/cyber-defense/security-information-event-management/)
    - [Security Operations Center (SOC) as a Service](https://www.ciso.inc/capabilities/cyber-defense/soc-service/)
    - [XDR](https://www.ciso.inc/capabilities/cyber-defense/extended-detection-and-response-xdr/)
  + [Security Testing & Training](https://www.ciso.inc/capabilities/readiness-resiliency-solutions/)
    - [Penetration Testing Services](https://www.ciso.inc/capabilities/readiness-resiliency-solutions/penetration-testing-services/)
    - [Tabletop Exercises](https://www.ciso.inc/capabilities/strategy-risk-solutions/managed-compliance-security-offering/tabletop-exercises/)
    - [Training Programs](https://www.ciso.inc/capabilities/readiness-resiliency-solutions/training/)
  + [Secure IT & Architecture](https://www.ciso.inc/capabilities/security-architecture-engineering/)
    - [Advanced Firewall Management](https://www.ciso.inc/capabilities/security-architecture-engineering/advanced-firewall-management/)
    - [Data Protection as a Service (DPaaS)](https://www.ciso.inc/managed-services-solutions/secured-managed-services/data-protection-as-a-service/)
    - [Remediation](https://www.ciso.inc/capabilities/security-architecture-engineering/remediation/)
    - [Secured Managed Services (SMS)](https://www.ciso.inc/managed-services-solutions/secured-managed-services/)
* [Products](https://www.ciso.inc/capabilities/platforms/)
  + [Argo Security Management](https://www.ciso.inc/capabilities/platforms/argo-security-management/)
  + [CHECKLIGHT® Security Monitoring](https://www.ciso.inc/capabilities/platforms/checklight-security-monitoring/)
  + [CISO Edge Cloud Security Platform](https://www.ciso.inc/capabilities/platforms/ciso-edge-cloud-security-platform/)
  + [TalaTek Intelligent Governance and Risk Integrated Solution (TiGRIS)](https://www.ciso.inc/capabilities/platforms/tigris-enterprise-grc/)
* [Industries](https://www.ciso.inc/industries/)
  + [Energy & Utilities](https://www.ciso.inc/industries/energy-utilities/)
  + [Healthcare](https://www.ciso.inc/industries/healthcare/)
  + [Investment M&A](https://www.ciso.inc/industries/investment-ma/)
  + [Financial](https://www.ciso.inc/industries/financial/)
  + [Federal](https://www.ciso.inc/industries/cmmc-dod-contractors/)
  + [State, Local & Tribal Government](https://www.ciso.inc/industries/state-local-government-cybersecurity/)
  + [Business](https://www.ciso.inc/industries/business/)
* [Investors](https://ir.ciso.inc)
  + [Overview](https://ir.ciso.inc)
  + [Press Releases](https://ir.ciso.inc/press-releases/)
* [About](/company/)
  + [Company](https://www.ciso.inc/company/)
  + [Leadership](https://www.ciso.inc/company/leadership/)
  + [Careers](https://www.ciso.inc/company/careers/)
  + [Contact Us](https://www.ciso.inc/company/contact-us/)
* [Insights](https://www.ciso.inc/insights/)
  + [Blog](https://www.ciso.inc/insights/blog/)
  + [Case Studies](https://www.ciso.inc/category/case-studies/)
  + [Infographics](https://www.ciso.inc/category/infographics/)
  + [Media](https://www.ciso.inc/category/insights/in-the-news/)
  + [Webcasts & Videos](https://www.ciso.inc/category/webcasts-videos/)
  + [White Papers](https://www.ciso.inc/category/white-paper/)
  + [Service Overviews](https://www.ciso.inc/category/insights/services-overviews/)
Search for:

[Request A Consultation](/request-a-consultation/)

# Advisory Summary 2021 – Dolibarr ERP

## cve-2021-42220

##### **Dolibarr ERP & CRM v14.0.2 suffers from a stored XSS vulnerability in the ticket creation flow that allows a low level user (with full access to the Tickets module) to achieve full permissions. For this attack vector to work, an administrator user needs to copy the text in the “message” box.**

### Impact

Authenticated attackers could perform actions in the context of high privilege users. This vulnerability could lead to site-wide account takeovers, privilege escalation and Anti-CSRF tokens pillage.

### Affected Vendor

| **Vendor** | **Product** |
| --- | --- |
| Dolibarr | Dolibarr ERP CRM 14.0.2 and earlier versions |

## Vulnerability Summary

The built-in WAF (Web application Firewall) uses a deny list to block the some HTML tags and most JavaScript events except for onbeforecopy and onbeforecut. In order to exploit this vulnerability, an authenticated attacker needs to craft a payload that does not include any of the forbidden HTML tags and JavaScript events.

**CVE: CVE-2021-42220 (<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42220>)**

// For XSS Injection done by closing textarea to execute content into a textarea field

$inj += preg\_match(‘/<\/textarea/i’, $val);

$inj += preg\_match(‘/<audio/i’, $val);

$inj += preg\_match(‘/<embed/i’, $val);

$inj += preg\_match(‘/<iframe/i’, $val);

$inj += preg\_match(‘/<object/i’, $val);

$inj += preg\_match(‘/<script/i’, $val);

$inj += preg\_match(‘/Set\.constructor/i’, $val); // ECMA script 6

if (!defined(‘NOSTYLECHECK’)) {

$inj += preg\_match(‘/<style/i’, $val);

$inj += preg\_match(‘/base\s+href/si’, $val);

$inj += preg\_match(‘/=data:/si’, $val);

$inj += preg\_match(‘/on(mouse|drag|key|load|touch|pointer|select|transition)([a-z]\*)\s\*=/i’, $val); // onmousexxx can be set on img or any html tag like <img title=’…’ onmouseover=alert(1)>

$inj += preg\_match(‘/on(abort|afterprint|animation|auxclick|beforeprint|beforeunload|blur

$val);

$inj += preg\_match(‘/on(dblclick|drop|durationchange|emptied|ended|error|focus|focusin|foc

$val);

$inj += preg\_match(‘/on(lostpointercapture|offline|online|pagehide|pageshow)\s\*=/i’, $val);

$inj += preg\_match(‘/on(paste|pause|play|playing|progress|ratechange|reset|resize|scroll|s

$val);

$inj += preg\_match(‘/on(timeupdate|toggle|unload|volumechange|waiting|wheel)\s\*=/i’, $val);

$tmpval = preg\_replace(‘/<[^<]+>/’, ”, $val);

// List of dom events is on https://www.w3schools.com/jsref/dom\_obj\_event.asp and https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers

$inj += preg\_match(‘/on(mouse|drag|key|load|touch|pointer|select|transition)

([a-z]**)\s**=/i’, $val); // onmousexxx can be set on img or any html tag like <img title=’…’ onmouseover=alert(1)>

$inj += preg\_match(‘/on(abort|afterprint|animation|auxclick|beforeprint|beforeunload|blur

$tmpval);

$inj += preg\_match(‘/on(dblclick|drop|durationchange|emptied|ended|error|focus|focusin|foc

$tmpval);

$inj += preg\_match(‘/on(lostpointercapture|offline|online|pagehide|pageshow)\s\*=/i’, $tmpval);

$inj += preg\_match(‘/on(paste|pause|play|playing|progress|ratechange|reset|resize|scroll|s

$tmpval);

$inj += preg\_match(‘/on(timeupdate|toggle|unload|volumechange|waiting|wheel)\s\*=/i’, $tmpval);

Deny list implemented in main.inc.php line 87.

### Proof of Concept

We have released a proof of concept in the following sources:

* <https://www.exploit-db.com/exploits/50432>
* <https://packetstormsecurity.com/files/164544/Dolibarr-ERP-CRM-14.0.2-Cross-Site-Scripting-Privilege-Escalation.html>

### Solution

Update to version 14.0.3 or newest version.

### Timeline

* 10/8/2021 – Contact with vendor.
* 10/8/2021 – Vulnerability acknowleged and fix released.

#### Researcher Who Discovered Vulnerability: Oscar Gutierrez

[![](/wp-content/uploads/2023/05/CISO-logo-white.svg)](/)

6900 E. Camelback Road, Suite 900
Scottsdale, AZ 85251

480-389-3444

[![LinkedIn Icon Gold](https://www.ciso.inc/wp-content/uploads/2023/05/LinkedIn_Yellow.svg)](https://www.linkedin.com/company/cisoglobal)
[![X Logo](https://www.ciso.inc/wp-content/uploads/2024/01/X_LtBlue.svg)](https://twitter.com/CISOGlobalInc)
[![Facebook Icon](https://www.ciso.inc/wp-content/uploads/2024/01/Facebook_LtBlue.svg)](https://www.facebook.com/CISOinc)
[![YouTube Icon](https://www.ciso.inc/wp-content/uploads/2024/01/YouTube_LtBlue.svg)](https://www.youtube.com/%40cisoglobalinc)
[![Instagram Icon](https://www.ciso.inc/wp-content/uploads/2024/01/Insta_LtBlue.svg)](https://www.instagram.com/cisoglobalinc/)

Menu

* [**Services**](/capabilities/)
* [**Products**](/capabilities/platforms/)
* [**Industries**](/industries/)
* [**Investors**](https://ir.ciso.inc/)
* [**About CISO Global**](/company/)
* [**Insights**](/insights/)

[![Better Business Bureau Accredited Business](https://www.ciso.inc/wp-content/uploads/2024/02/bbb-accredited.svg)](https://www.bbb.org/us/az/scottsdale/profile/cyber-security/ciso-global-1126-1000082812)
[![Cyber AB (CMMC) Licensed Training Provider (LTP) Badge](https://www.ciso.inc/wp-content/uploads/2023/05/CATCO-LTD.png)](https://cyberab.org/Catalog#!/c/s/Results/Format/list/Page/1/Size/9/Sort/NameAscending?term=ciso%20global)
[![AICPA SOC Badge - SOC for Service Organizations ](https://www.ciso.inc/wp-content/uploads/2024/02/21972-312_SOC_NonCPA-WHITE.svg)](http://www.aicpa.org/soc4so)

Copyright CISO Global . All Rights Reserved.

[Privacy Policy](/privacy-policy/) | [MSA](/msa-0623/)


