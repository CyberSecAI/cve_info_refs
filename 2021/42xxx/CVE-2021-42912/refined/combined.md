=== Content from medium.com_5d41c05f_20250114_200615.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F10b64fd10ce2&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40windsormoreira%2Ffiberhome-an5506-os-command-injection-cve-2021-42912-10b64fd10ce2&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40windsormoreira%2Ffiberhome-an5506-os-command-injection-cve-2021-42912-10b64fd10ce2&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Fiberhome AN5506 OS Command Injection (CVE-2021-42912)

[![Windsor Moreira](https://miro.medium.com/v2/resize:fill:88:88/1*eVWZXweyY0gRU3K-e3pgng.jpeg)](/%40windsormoreira?source=post_page---byline--10b64fd10ce2--------------------------------)

[Windsor Moreira](/%40windsormoreira?source=post_page---byline--10b64fd10ce2--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3e7eeca2f110&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40windsormoreira%2Ffiberhome-an5506-os-command-injection-cve-2021-42912-10b64fd10ce2&user=Windsor+Moreira&userId=3e7eeca2f110&source=post_page-3e7eeca2f110--byline--10b64fd10ce2---------------------post_header-----------)

3 min read·Dec 15, 2021

--

1

Listen

Share

FiberHome ONU GPON AN5506 is affected by an OS command injection vulnerability. This vulnerability allows the attacker, once logged in, to send commands to the operating system as the root user via the ping diagnostic tool, bypassing the IP address field, and concatenating OS commands with a semicolon.

Hello, guys! So, here I share info about a new vulnerability in Fiberhome ONU GPON reported by me and how it works.

```
     Affected Versions
DEVICE MODEL   SOFTWARE VER.
AN5506-01-A       RP0509
AN5506-01-B       RP2610
AN5506-02-B       RP2520
AN5506-02-B       RP2521
AN5506-02-B       RP2603
AN5506-04-B       RP2510
AN5506–04-F       RP2617
AN5506-04-G2G     RP2560
```

Firstly, I’ll explain how I got to this vulnerability.

I was having some problems with my internet connection, specifically with ping packets, I couldn’t ping any internet address, neither from my operating system nor from my virtual machine or system booted in live mode. So, to understand what was happening on I decided to perform ping diagnosis from my router and was here that all start.

![]()

Ping diagnosis page

Initially I didn’t think to exploit or something like. But the response time each packet induced me to try to change the quantities of replies so that replied with only one packet.. and I got success.

How should this be run on the server side:

```
ping -c 1 8.8.8.8
```
![]()

Output of the manipulated ping command.

After realizing that I had a OS command injection vulnerability on my hands I tried to bypass ping command and execute commands directly.

On the linux operating system, in particular, it is possible to concatenate the execution of commands using semicolon.

```
Example: ping -c 1 8.8.8.8; whoami
```

So I bypass with the following command:

```
ping ;whoami;id; cat /proc/version
```
![]()

Output of the manipulated ping command.

In the source code of the page ([/application/ping\_diagnosis.asp](https://codeshare.io/0gnrOv)) I found these functions in javascript that refer to the ping function.

![]()

Input validations (or no?)

Apparently there are some validations in the IP address field (ping\_ip), but only one of the rules is specific to prevent entries with the pipe “|” character.

For the challenge, I tried to bypass this validation with url encode and it was also possible to run commands.

![]()

Character pipe with URL encoded

![]()

Bypass with character pipe url encoded

This vulnerability is only possible because of non-validation of user input.

![]()

Function that receive ping\_ip.value without validation.

Reference: <https://portswigger.net/web-security/os-command-injection>

CVE: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42912>
NVD: <https://nvd.nist.gov/vuln/detail/CVE-2021-42912>

\*The vendor was contacted on 10/2021 via e-mail, but so far there have been no responses.

--

--

1

[![Windsor Moreira](https://miro.medium.com/v2/resize:fill:96:96/1*eVWZXweyY0gRU3K-e3pgng.jpeg)](/%40windsormoreira?source=post_page---post_author_info--10b64fd10ce2--------------------------------)[![Windsor Moreira](https://miro.medium.com/v2/resize:fill:128:128/1*eVWZXweyY0gRU3K-e3pgng.jpeg)](/%40windsormoreira?source=post_page---post_author_info--10b64fd10ce2--------------------------------)Follow[## Written by Windsor Moreira](/%40windsormoreira?source=post_page---post_author_info--10b64fd10ce2--------------------------------)[15 Followers](/%40windsormoreira/followers?source=post_page---post_author_info--10b64fd10ce2--------------------------------)·[1 Following](/%40windsormoreira/following?source=post_page---post_author_info--10b64fd10ce2--------------------------------)

Pentester | Ethical Hacker | Cybersecurity Consultant | Security Researcher | CTF Player

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----10b64fd10ce2--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----10b64fd10ce2--------------------------------)[About](/about?autoplay=1&source=post_page-----10b64fd10ce2--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----10b64fd10ce2--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----10b64fd10ce2--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----10b64fd10ce2--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----10b64fd10ce2--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----10b64fd10ce2--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----10b64fd10ce2--------------------------------)[Teams](/business?source=post_page-----10b64fd10ce2--------------------------------)



=== Content from onu.com_1e9d46ca_20250114_200614.html ===


Please note: Javascript needs to be enabled to use all the functionality of ONU. Parts of this website will not work until you do. Please enable Javascript before proceeding.

[![onu.com](/img/clients/onu/onu-logo-2023.png "onu.com")](https://www.onu.com/en/)

Offer/Request
**Offer**
[Flatshares](/en/housing-offers.html?cat=0)
[1 Room Flats](/en/housing-offers.html?cat=1)
[Flats](/en/housing-offers.html?cat=2)
[Houses](/en/housing-offers.html?cat=3)

**Request**
[Flatshares](/en/housing-requests.html?cat=0)
[1 Room Flats](/en/housing-requests.html?cat=1)
[Flats](/en/housing-requests.html?cat=2)
[Houses](/en/housing-requests.html?cat=3)

Create an Ad
[Create Offer](/en/get-started.html)
[Create Request](/en/place-request.html)

My Account

[![onu.com](/img/onu-net-logo-white.png)
onu.com](/en/)

Main navigation

Nice to have you here

at **onu.com!**

[Offer/Request](#collapseOffersAndRequests)
**Offer**
[Flatshares](/en/housing-offers.html?cat=0)
[1 Room Flats](/en/housing-offers.html?cat=1)
[Flats](/en/housing-offers.html?cat=2)
[Houses](/en/housing-offers.html?cat=3)
**Request**
[Flatshares](/en/housing-requests.html?cat=0)
[1 Room Flats](/en/housing-requests.html?cat=1)
[Flats](/en/housing-requests.html?cat=2)
[Houses](/en/housing-requests.html?cat=3)

[Create an Ad](#collapseCreateAd)
[Create Offer](/en/get-started.html)
[Create Request](/en/place-request.html)

[Help / Contact](#collapseHelpAndContact)
[Help Center](/en/help-center.html)
[Legal Notice](/en/legal.html)
[Advertising](/en/ic/online-werbung.html)

Sign In

#### Ad blocker enabled

An ad blocker is enabled in your browser. Please note that not all contents of the site can potentially be displayed correctly depending on the ad blocker settings.

# More than 8,000 new Ads per day

**No city found**

**Please select a category**

Flatshares

1 Room Flats

Flats

Houses

Offers
Requests

## How to use us successfully

On onu.com you can quickly and easily advertise your Ad for an apartment to share, a flat or a house for rent or short term rent.

## Create Offers

If you are searching for a new flat or house mate or your next tenant, please create your Offer here.

[Create Offer](https://www.onu.com/en/place-offer.html)
## Create Requests

If you are interested in finding a new home, please insert your Request here. Good luck!

[Create Request](https://www.onu.com/en/place-request.html)

---

---

![](/img/icons/CO2-Seal-Icon-EN.png)

[Help Center](/en/help-center.html)
|
[Legal Notice](/en/legal.html)
|
[General Terms and Conditions](/en/agb.html)
|
[Privacy Policy](/en/data-protection.html)
|
[Cookie settings](/?cmpscreencustom)

[Forgotten Password?](/en/password-reset.html)
|
[Feedback](/en/contact.html?section=suggestion)

|
[View Offers](/en/housing-offers.html)
|
[Insert Offer](/en/place-offer.html)
|
[View Requests](/en/housing-requests.html)
|
[Insert Request](/en/place-request.html)

![](/img/icons/CO2-Seal-Icon-EN.png)

en

* [Deutsch](/)
* [English](/en/)
* [Español](/es/)

![](/img/clients/onu/icons/loading.png)

×
#### Sorry for the inconvenience.

This service is temporarily unavailable. We are working on a solution, please try again later.

Thank you for your patience.

OK

×
#### Sorry for the inconvenience.

There was a problem processing your request, please try again.

Thank you for your understanding.

OK

×
#### It looks like your request has timed out.

When you close this message, the browser will automatically refresh the page. Then please try again.

Thank you for your understanding.

OK

* Private
* Real estate company

#### Welcome to our business section!

Register now and benefit from exclusive features. We would also be happy to advise you personally: +49 89 215 286 821

![](/img/register-sofa.png)

Company Name \*

Title \*
Ms/Mrs
Mr
Not specified

First Name \*

Last Name \*

Email Address \*

Password (8 - 64 characters) \*

Re-type Password \*

I understand and accept the
[General Terms and Conditions](/en/agb.html).

NEXT

Already have an account?
Sign In

* Please select a title.
* Please select a title.
* Please select a title.
* Please enter a First Name.
* Please enter a valid First Name.
* The First Name can be no longer than 50 characters.
* Please enter a Last Name.
* Please enter a valid Last Name.
* The Last Name can be no longer than 50 characters.
* Please enter a Company Name.
* The Company Name can be no longer than 100 characters.
* Please enter an Email Address
* This Email Address is already registered on onu.com.
* Please enter a valid email address.
* This is too long, please enter max. 191 characters.
* Please enter a password and re-type it in the field below.
* Passwords must be at least 8 characters.
* Passwords can be no longer than 64 characters.
* The passwords you entered do not match.
* The entered password is very insecure. Please choose a different password.
* You have to agree to our Terms and Conditions.
* You have to agree to our Terms and Conditions.

#### Nice that you stop by!

Register now and find your new home or the ideal tenant.

![](/img/register-sofa.png)

Title \*
Ms/Mrs
Mr
Not specified

First Name \*

Last Name \*

Email Address \*

Password (8 - 64 characters) \*

Re-type Password \*

I understand and accept the
[General Terms and Conditions](/en/agb.html).

NEXT

Already have an account?
Sign In

* Please select a title.
* Please select a title.
* Please select a title.
* Please enter a First Name.
* Please enter a valid First Name.
* The First Name can be no longer than 50 characters.
* Please enter a Last Name.
* Please enter a valid Last Name.
* The Last Name can be no longer than 50 characters.
* Please enter an Email Address
* This Email Address is already registered on onu.com.
* Please enter a valid email address.
* This is too long, please enter max. 191 characters.
* Please enter a password and re-type it in the field below.
* Passwords must be at least 8 characters.
* Passwords can be no longer than 64 characters.
* The passwords you entered do not match.
* The entered password is very insecure. Please choose a different password.
* You have to agree to our Terms and Conditions.
* You have to agree to our Terms and Conditions.

According to the EU law of the General Data Protection Regulation, users have to agree if the personal data first name, last name and email address are used. This information is necessary to create an account, to get in contact with other users and thus, to allow the successful brokerage of housing.

Back

Congratulations, your account has been created. Please log in.

#### ATTENTION

#### DELETE ACCOUNT

Please enter a valid Email Address and/or Password.
Unknown Email Address or Password. Please try again.

#### Welcome back

Nice to see you are back! To benefit from all features available on onu.com, please log in. We wish you much success.

Email Address:

Password:

[Forgotten Password?](/en/password-reset.html)

 Remember Me

You have not ticked the first checkbox and thus, have not agreed to the processing of your personal data. This means that you will not be able to use WG-Gesucht.de. In this case, your account has to be deleted according to the Data Protection Regulation.

Incorrect Email Address/Username or Password.

An error occurred while deleting your account. We apologize for the inconvenience.

Don’t have an account?

Register now

* Please enter an Email Address.
* Please enter a Password.

×
#### General Data Protection Regulation

You have not ticked the first checkbox. Thus, you will not be able to use your account anymore. Please note that nothing will change with the handling of your data at onu.com after May 25th. You have already agreed to our Terms and Conditions and to the data protection information with the creation of your account. However, the EU law obliges us to request the agreement again.


