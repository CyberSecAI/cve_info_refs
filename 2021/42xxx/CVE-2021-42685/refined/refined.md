The provided content discusses multiple vulnerabilities, including CVE-2021-42685, found in the Eltima SDK and related products used for "USB over Ethernet" functionality in various cloud services.

**Root Cause of Vulnerability:**
The root cause lies in the improper handling of user-supplied buffers within the `wspvuhub.sys` driver, specifically in IOCTL handlers `0x22005B` and `0x22001B`. These handlers use `METHOD_NEITHER` for data transfer, which requires the driver to handle buffer validation, probing, and locking, which is not being done correctly.

**Weaknesses/Vulnerabilities Present:**
- Lack of proper buffer validation.
- Insecure arithmetic operations on user-controlled data when calculating copy size for `memmove` operations, leading to potential integer overflows.
- Double fetches and arbitrary pointer dereferences due to the improper handling of user-mode addresses.
- Missing ACL enforcements on IOCTL handlers.

**Impact of Exploitation:**
- Privilege escalation to kernel mode.
- Ability to disable security products.
- Overwrite system components.
- Corrupt the operating system.
- Arbitrary code execution in kernel mode.
- Potential for sandbox escape.
- Possible use in second-stage browser attacks.

**Attack Vectors:**
- Sending specially crafted `IRP_MJ_DEVICE_CONTROL` packets with malicious input data through the vulnerable IOCTLs.
- Exploitation through a local user context, even without elevated privileges.
- Potentially exploitable from sandboxes and as a second-stage browser attack.

**Required Attacker Capabilities/Position:**
- Ability to send IRP\_MJ\_DEVICE\_CONTROL packets to the vulnerable device, typically a local user.
- Some knowledge of Windows Kernel IO Manager (IOMgr) and IOCTL handling.
- Ability to craft a specific IRP with specific values for `alloc_size` and `copy_size` to cause an integer overflow, leading to out-of-bounds write during memmove operation.

**Additional Information:**
- The vulnerabilities are present in both client-side and server-side components due to code sharing.
- Affected products include Amazon Workspaces, Amazon Nimble Studio, Amazon NICE DCV, NoMachine, Accops HyWorks, Eltima USB Network Gate, Amzetta zPortal, FlexiHub, and Donglify.
- The `wspvuhub.sys` and `wspusbfilter.sys` drivers are specifically identified as vulnerable.
- The vulnerable code has been present since the introduction of the WSP protocol around 2020.
- The document explains how to trigger the vulnerability by sending a specific IOCTL request, and describes how the size calculation during the copy operation goes wrong.
- The vulnerability allows an attacker to overwrite kernel memory due to the integer overflow, leading to arbitrary code execution.