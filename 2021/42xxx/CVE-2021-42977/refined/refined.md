The provided content contains information about CVE-2021-42977.

**Root cause of vulnerability:**
The root cause of the vulnerability lies in the insecure handling of user-provided input buffers within the Eltima SDK, specifically in the `wspvuhub.sys` and `wspusbfilter.sys` drivers. The vulnerable IOCTL handlers are 0x22005B and 0x22001B, which use the `METHOD_NEITHER` transfer type, requiring the handlers to perform their own validation, probing, locking, and mapping of buffers. The code lacks proper input validation and performs insecure arithmetic operations on user-controlled data when calculating buffer copy sizes, leading to integer overflows.

**Weaknesses/vulnerabilities present:**
- Improper input validation of user-controlled data.
- Integer overflows due to insecure arithmetic operations when calculating buffer copy sizes.
- Lack of proper buffer validation, probing, and locking when using the METHOD_NEITHER transfer type.
- Double fetch and arbitrary pointer dereference possibilities.
- The device accepts IOCTLs without ACL enforcements allowing exploitation from sandboxes.

**Impact of exploitation:**
Successful exploitation can lead to:
- Privilege escalation, allowing a user without privileges to run code in kernel mode.
- Disabling of security products.
- Overwriting of system components.
- Corruption of the operating system.
- Arbitrary code execution in kernel mode.
- Potential for lateral movement within an organization's network.

**Attack vectors:**
- Sending specially crafted IRP packets with manipulated parameters to the vulnerable IOCTL handlers.
- Triggering the vulnerability through the `DeviceIoControl` function with crafted input sizes exceeding allocated buffer size.
- Local privilege escalation.
- Possible second-stage browser attacks or other sandbox escapes, although modern browsers have IOCTL allow lists.

**Required attacker capabilities/position:**
- Ability to execute code on a system with the vulnerable drivers installed.
- No specific privileges required to trigger the vulnerability.
- The attacker can be a local user or an attacker who has gained access to an organizationâ€™s network.