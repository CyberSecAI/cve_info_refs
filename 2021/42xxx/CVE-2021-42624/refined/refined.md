The content is related to CVE-2021-42624.

**Root cause of vulnerability:**
The vulnerability is a buffer overflow in the `list_common()` function within the ftpproto.c file. The function uses `sprintf()` to format strings into a buffer, without proper bounds checking. Specifically, when handling symbolic links, the `readlink()` output is copied into a temporary buffer `tmp` and then appended to the main buffer `buf` using `sprintf()`.  If the combined size of the already formatted string in `buf`, the symlink target, and the filename exceeds the size of `buf` (1024 bytes), a buffer overflow occurs.

**Weaknesses/vulnerabilities present:**
- Buffer overflow vulnerability due to the use of `sprintf()` without bounds checking.
- The sizes of `buf` and `tmp` are fixed at 1024, which is insufficient to hold all the possible data.
- The code uses `off += sprintf()`, which accumulates the offset into the buffer, but does not prevent overflow if the sum of the writes exceeds buffer size.

**Impact of exploitation:**
- A buffer overflow can lead to arbitrary code execution, denial of service, or other unexpected behaviors.

**Attack vectors:**
- An attacker can create a symbolic link with a long target path name.
- When the `list_common()` function is called, the `readlink()` output (target path name) will overflow the `buf` buffer during string formatting.

**Required attacker capabilities/position:**
- An attacker needs to be able to trigger the `list_common()` function, which is likely via an FTP LIST command.
- The attacker must be able to create a symbolic link on the server's file system to trigger the vulnerable code path.