- **Root cause of vulnerability**: The AppGuard Agent for Windows installation uses the Windows Installer framework, caching an MSI file in `c:\windows\installer`. An unprivileged user can trigger a repair operation, which initiates file operations in the user's `%TEMP%` folder, some of which are executed with SYSTEM privileges, including temporary files.
- **Weaknesses/vulnerabilities present**: Creation of temporary files in a directory with insecure permissions (CWE-379). The vulnerability lies in the fact that the repair operation, triggered by an unprivileged user, causes the Windows Installer service (running as SYSTEM) to create and execute files in the user's temp folder.
- **Impact of exploitation**: Successful exploitation grants a local unprivileged attacker SYSTEM level privileges.
- **Attack vectors**: A local attacker can trigger the repair operation using the Windows Installer API or the command `msiexec.exe /fa c:\windows\installer\[XXXXX].msi`.
- **Required attacker capabilities/position**: The attacker needs to be an authenticated local user. The exploit is described as trivial to produce.