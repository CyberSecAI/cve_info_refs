```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a divide-by-zero error in the Delta compression codec within ClickHouse. This occurs when the first byte of the compressed buffer, which is used as the divisor in a modulo operation, is set to zero.",
    "weaknesses": [
      "Divide-by-zero error"
    ],
    "impact": "Denial of Service (DoS). The server crashes when the divide-by-zero condition is triggered.",
    "attack_vectors": "The vulnerability can be triggered by sending a malicious, specially crafted compressed query to the ClickHouse server via its web interface using the 'decompress=1' URL parameter.",
    "required_capabilities": "The attacker needs to have valid credentials to access the ClickHouse server, even read-only access is sufficient. The attacker also needs to be able to send requests to the ClickHouse web interface."
  },
    "additional_details": {
      "technical_details": "The ClickHouse server allows users to send compressed queries. The server reads the query's content, including a compression method, and decompresses it. The vulnerability occurs when the server attempts to decompress data using the Delta compression codec and the first byte of the compressed data is 0, leading to a division by zero during decompression: `UInt8 bytes_size = source[0]; UInt8 bytes_to_skip = uncompressed_size % bytes_size;`",
      "exploitation": "By crafting a compressed payload where the first byte is 0 when using the Delta codec, an attacker can force a division by zero operation, causing a server crash.",
      "fixes": "Upgrade ClickHouse to version v21.10.2.15-stable or later. As a workaround, firewall rules can be added to restrict access to the web port (8123) and the TCP serverâ€™s port (9000) to specific clients only."
    }
}
```