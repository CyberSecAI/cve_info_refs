This document discusses multiple vulnerabilities, including CVE-2021-42990, found in the Eltima SDK and related products used by various cloud services for USB over Ethernet functionality.

**Root Cause of Vulnerability:**
The vulnerabilities stem from insecure handling of user-supplied buffers in the IOCTL handlers of the `wspvuhub.sys` and `wspusbfilter.sys` drivers. Specifically, the IOCTL handlers 0x22005B and 0x22001B use the `METHOD_NEITHER` transfer type, which requires the driver to handle buffer validation, probing, locking, and mapping. The driver fails to properly validate user-controlled buffer sizes and performs insecure arithmetic operations when calculating the copy size, leading to integer overflows.

**Weaknesses/Vulnerabilities Present:**
- Insecure handling of `METHOD_NEITHER` buffers.
- Lack of buffer verification and validation.
- Missing overflow checks in arithmetic operations related to buffer size calculations.
- Integer overflows when calculating `memmove` size parameters.
- Double fetch possibilities.
- Arbitrary pointer dereferences.

**Impact of Exploitation:**
- Privilege escalation to kernel mode.
- Ability to bypass security products.
- Potential for arbitrary code execution in kernel mode.
- Overwriting system components.
- Corrupting the operating system.
- Unimpeded malicious operations.

**Attack Vectors:**
- Sending specially crafted IRP (I/O Request Packets) to vulnerable driver IOCTL handlers with manipulated buffer sizes.

**Required Attacker Capabilities/Position:**
- Local access to the system is sufficient to exploit the vulnerability, as the driver does not enforce Access Control Lists (ACL) on IOCTLs.
- The vulnerability can be triggered from sandboxes.
- Potential for exploitation as a second-stage browser attack or in other sandboxed environments, however modern browsers limit IOCTL requests.