```
{
  "vulnerability": {
    "cveID": "CVE-2021-42074",
    "description": "An issue was discovered in Barrier before 2.3.4. An unauthenticated attacker can cause a segmentation fault in the barriers component (aka the server-side implementation of Barrier) by quickly opening and closing TCP connections while sending a Hello message for each TCP session.",
    "affected_versions": "before 2.3.4",
    "fixed_versions": "2.3.4",
     "root_cause": "A race condition or use-after-free vulnerability exists in the server-side application when handling rapid connection open/close cycles during the initial handshake.",
    "weaknesses": [
      "Use-after-free",
      "Race condition"
    ],
    "impact": "Denial of service via segmentation fault, potentially other more severe impacts (code execution) if the root cause is further investigated.",
    "attack_vector": "Remote, unauthenticated network access via TCP.",
     "required_capabilities": "Ability to establish TCP connections to the vulnerable service and send crafted Hello messages.",
    "details": "The vulnerability is triggered by quickly opening and closing TCP socket connections to the Barrier server while sending a 'Hello' message with each connection. This can cause a segmentation fault due to a use-after-free issue. The server attempts to write to an already closed socket within the `SecureSocket::secureWrite` function, specifically when called through `TCPSocket::serviceConnected` function after the socket has been closed by other code. A thread in `SocketMultiplexer::serviceThread` is used for handling the connection, which results in a race condition."
  }
}
```