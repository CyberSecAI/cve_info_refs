=== Content from www.smartmontools.org_c5f1828e_20250115_131640.html ===


[![smartmontools](/raw-attachment/wiki/images/smart_logo.gif)](https://www.smartmontools.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [Roadmap](/roadmap)
* [View Tickets](/report)
* [Browse Source](/browser)
* [Search](/search)

[wiki:](/wiki "View WikiStart")[WikiStart](/wiki/WikiStart "View WikiStart")
## Context Navigation

* [Start Page](/wiki/WikiStart)
* [Index](/wiki/TitleIndex)
* [History](/wiki/WikiStart?action=history)

---

Jump to: | [Download](/wiki/Download) | [Documentation](/wiki/TocDoc) | [FAQ](/wiki/FAQ) | [Help](/wiki/Help) | [Device Support](/wiki/TocSupport) | [Contribute](/wiki/WikiStart#ContributetoSmartmontools) | [Links](/wiki/Links) |

## News

* `2024-11-26`: **[​Alexander Shaduri](https://shaduri.dev/) released [​version 2.0.1 of GSmartControl](https://github.com/ashaduri/gsmartcontrol/releases/tag/v2.0.1) (a graphical user interface for smartctl).**
* `2024-01-03`: Project Trac and Wiki upgraded to the [latest 1.6 version](https://www.smartmontools.org/ticket/1419).
* `2023-09-16`: The CI builds at [​builds.smartmontools.org](https://builds.smartmontools.org) are now reproducible if the same [​SOURCE\_DATE\_EPOCH](https://reproducible-builds.org/docs/source-date-epoch/), build recipes and toolchains are used.
* `2023-08-01`: **We released [​version 7.4 of Smartmontools](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.4/). See the [NEWS](/browser/tags/RELEASE_7_4/smartmontools/NEWS) file and the [ticket report](/query?milestone=Release+7.4) to get a summary of the changes and new features.**
* `2023-06-30`: CI builds ([​builds.smartmontools.org](https://builds.smartmontools.org)) for macOS now support arm64 and x86\_64 architectures, i386 requires build from source. This will also be the case for future release builds.
* `2022-10-10`: **20th anniversary** of [smartmontools first release](/changeset/13) - see also [smartmontools history](/wiki/History).
* `2022-02-28`: We released [​version 7.3 of Smartmontools](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.3/).
* `2022-02-04`: Alexander Shaduri released [​version 1.1.4 of GSmartControl](https://github.com/ashaduri/gsmartcontrol/releases/tag/v1.1.4) (a graphical user interface for smartctl).
* `2021-10-23`: **There is a security issue if `smartd` is used conjunction with GNU mailutils < 3.13. See ticket [#1535](/ticket/1535 "#1535: defect: Code execution vulnerability if smartd uses 'mail' from GNU mailutils ... (closed: fixed)") for details and various possible fixes.**
* `2020-12-30`: We released [​version 7.2 of Smartmontools](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.2/).
* `2019-12-30`: We released [​version 7.1 of Smartmontools](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.1/).
* `2018-12-30`: We released [​version 7.0 of Smartmontools](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.0/).
* ...see [here for further news](/wiki/News)
## About Smartmontools

[![S.M.A.R.T.-Logo](/raw-attachment/wiki/images/smart_logo.gif "S.M.A.R.T.-Logo")](/attachment/wiki/images/smart_logo.gif)
The smartmontools package contains two utility programs (`smartctl` and `smartd`)
to control and monitor storage systems using the *Self-Monitoring, Analysis and
Reporting Technology System* (SMART) built into most modern ATA/SATA, SCSI/SAS and NVMe disks.
In many cases, these utilities will provide advanced warning of disk degradation and failure.
Smartmontools was originally derived from the Linux [​smartsuite package](https://sourceforge.net/projects/smartsuite/) and actually supports ATA/SATA, [SCSI](/browser/trunk/www/smartmontools_scsi.xml)/SAS and [NVMe](/wiki/NVMe_Support) disks and also SCSI/SAS tape devices.
It should run on any modern Linux, FreeBSD, NetBSD, OpenBSD, Darwin (macOS), Solaris, Windows, Cygwin, OS/2, eComStation or QNX system.
Smartmontools can also be run from one of many different [Live CDs/DVDs](/wiki/LiveCDs).

Sourcecode tarballs and precompiled packages for Darwin (macOS) and Windows are available at the [​project page at Sourceforge](https://sourceforge.net/projects/smartmontools/files/smartmontools/).

[![...](https://img.shields.io/sourceforge/dt/smartmontools/smartmontools/7.4?label=7.4%20downloads "Total Downloads of 7.4")](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.4/stats/timeline)
[![...](https://img.shields.io/sourceforge/dw/smartmontools/smartmontools/7.4?label= "Weekly Downloads of 7.4")](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.4/stats/timeline)
[![...](https://img.shields.io/sourceforge/dt/smartmontools/smartmontools/7.3?label=7.3%20downloads "Total Downloads of 7.3")](https://sourceforge.net/projects/smartmontools/files/smartmontools/7.3/stats/timeline)
...
[![...](https://img.shields.io/sourceforge/dt/smartmontools?label=all%20downloads "Total Downloads since 2002")](https://sourceforge.net/projects/smartmontools/files/stats/timeline?dates=2002-10-01+to+2024-12-31)

Precompiled packages are available from the repositories of various distributions, see the [Packages](/wiki/Packages) page or [​Repology.org](https://repology.org/project/smartmontools/versions).
Some examples:

[![Arch](https://repology.org/badge/version-for-repo/arch/smartmontools.svg?header=Arch "Arch")](https://www.archlinux.org/packages/?q=smartmontools)
[![Fedora](https://repology.org/badge/version-for-repo/fedora_38/smartmontools.svg?header=Fedora%2038 "Fedora")](https://src.fedoraproject.org/rpms/smartmontools)
[![Debian](https://repology.org/badge/version-for-repo/debian_12_backports/smartmontools.svg?header=Debian%2012 "Debian")](https://packages.debian.org/bookworm-backports/smartmontools)
[![Ubuntu](https://repology.org/badge/version-for-repo/ubuntu_24_04/smartmontools.svg?header=Ubuntu%2024.04 "Ubuntu")](https://packages.ubuntu.com/noble/smartmontools)
[![FreeBSD](https://repology.org/badge/version-for-repo/freebsd/smartmontools.svg?header=FreeBSD "FreeBSD")](https://www.freshports.org/sysutils/smartmontools)
[![NetBSD](https://repology.org/badge/version-for-repo/pkgsrc_current/smartmontools.svg?header=NetBSD "NetBSD")](http://pkgsrc.se/sysutils/smartmontools)
[![OpenBSD](https://repology.org/badge/version-for-repo/openbsd/smartmontools.svg?header=OpenBSD "OpenBSD")](https://openports.pl/path/sysutils/smartmontools)
[![macOS (brew)](https://repology.org/badge/version-for-repo/homebrew/smartmontools.svg?header=macOS%20%28brew%29 "macOS (brew)")](https://github.com/Homebrew/homebrew-core/commits/master/Formula/smartmontools.rb)
[![macOS (ports)](https://repology.org/badge/version-for-repo/macports/smartmontools.svg?header=macOS%20%28ports%29 "macOS (ports)")](https://github.com/macports/macports-ports/tree/master/sysutils/smartmontools)
[![OpenIndiana](https://repology.org/badge/version-for-repo/openindiana/smartmontools.svg?header=OpenIndiana "OpenIndiana")](http://pkg.openindiana.org/hipster/en/search.shtml?token=smartmontools&action=Search)
[![Windows](https://repology.org/badge/version-for-repo/chocolatey/smartmontools.svg?header=Windows%20%28choco%29 "Windows")](https://chocolatey.org/packages/smartmontools)
[![Cygwin](https://repology.org/badge/version-for-repo/cygwin/smartmontools.svg?header=Cygwin "Cygwin")](https://cygwin.com/packages/summary/smartmontools.html)
...
[![in repositories](https://repology.org/badge/tiny-repos/smartmontools.svg "to repository overview")](https://repology.org/badge/vertical-allrepos/smartmontools.svg)

Due to OS-specific issues and also depending on the different state of smartmontools development on the platforms, device support is not the same for all OS platforms.
See info about [RAID-controller](/wiki/Supported_RAID-Controllers), [USB](/wiki/USB) and [NVMe](/wiki/NVMe_Support) support here on the homepage and of course in the [manpages](/wiki/TocDoc#Manpages).

Thanks to Alexander Shaduri, there is also a graphical user interface for `smartctl` available.
Go to the Homepage of [​GSmartControl](https://gsmartcontrol.sourceforge.io/) to get all info and the software itself.
Have a look at the [​screenshots](https://gsmartcontrol.sourceforge.io/home/index.php/Screenshots)
and the [​feature list](https://gsmartcontrol.sourceforge.io/home/index.php/About) to get an impression of this nice tool.

## Contribute to Smartmontools

#### Device Information

If your drive is not in the [current version of smartmontools drive database](/browser/trunk/smartmontools/drivedb.h)[​](/export/HEAD/trunk/smartmontools/drivedb.h "Download"), you can help to improve smartmontools information by [sending a report about your drive](/wiki/FAQ#MyATASATAdriveisnotinthesmartctlsmartddatabase) to our mailinglist [​smartmontools-database](https://listi.jpberlin.de/mailman/listinfo/smartmontools-database).

We collect info about [USB devices that have been successfully or unsuccessfully tested with smartmontools](/wiki/Supported_USB-Devices). If you have a device not listed there, please tell us the test result, by editing the wiki page, and/or by sending an email to the [​smartmontools-database mailinglist](https://listi.jpberlin.de/mailman/listinfo/smartmontools-database).

#### Bug Reports

To submit a bug report or propose an enhancement for smartmontools create a [new ticket here in trac](/newticket). Login is needed for that. If you don't want to register an account, you can also send the info to our [​smartmontools-support](https://listi.jpberlin.de/mailman/listinfo/smartmontools-support) mailing list.

#### Patches

Patches are welcome! **The most convenient way for us is, when you attach them to a [new ticket here in trac](/newticket)**. But it's also possible to submit patches for code review to [​developers mailinglist](https://listi.jpberlin.de/mailman/listinfo/smartmontools-devel). You don't need to be member of the mailinglist for it. Our list moderator will approve posting requests in these cases. Your patches should refer to our recent code base in [SVN](/wiki/Download#InstalllatestunreleasedcodefromSVNrepository). You should also have a look at the documents in the [developers area here in the wiki](/wiki/TocDeveloper). You will find info about smartmontools software architecture and tutorials and guidelines from our developers there.

#### GitHub mirror and Circle CI integration

For those who prefer to use git and GitHub we maintain an [​official mirror](https://github.com/smartmontools/smartmontools/) of the smartmontools project. Feel free to fork, submit PR-s and issues. The mirror is updated every 15 minutes from our sourceforge SVN. Also a Circle CI Continuous Integration and Delivery system has been setup, see [​builds page](https://circleci.com/gh/smartmontools/smartmontools) for the details. Every commit to the GitHub triggers a new build and provides [​a source tarball and various binaries](https://builds.smartmontools.org) as artifacts.

* GitHub: [![...](https://img.shields.io/github/issues/smartmontools/smartmontools?logo=github&label=issues "Open Issues")](https://github.com/smartmontools/smartmontools/issues) [![...](https://img.shields.io/github/issues-closed/smartmontools/smartmontools?label= "Closed Issues")](https://github.com/smartmontools/smartmontools/issues?q=is%3Aclosed) [![...](https://img.shields.io/github/issues-pr/smartmontools/smartmontools?logo=github&label=pull%20requests "Open PRs")](https://github.com/smartmontools/smartmontools/pulls) [![...](https://img.shields.io/github/issues-pr-closed/smartmontools/smartmontools?label= "Closed PRs")](https://github.com/smartmontools/smartmontools/pulls?q=is%3Aclosed)

* Trunk build status: [![Build Status](https://circleci.com/gh/smartmontools/smartmontools.svg?style=svg "Build Status")](https://circleci.com/gh/smartmontools/smartmontools)

* CodeQL scanning: [![...](/smartmontools/smartmontools/actions/workflows/codeql.yml/badge.svg "CodeQL scanning")](https://github.com/smartmontools/smartmontools/security/code-scanning)

#### Incident Reports

If you see a failure or have a problem with [our project facilities](/wiki/TocDeveloper#Facilities) you may report it to
`smartmontools-devel@listi.jpberlin.de`. You don't need to be subscribed for that. Your mail will then go to the list moderator and she will take action to solve the issue. Project uptime is monitored on the [​status page](https://status.smartmontools.org/) hosted by BetterStack service.

#### License

Smartmontools (and content in this wiki) are published under [​GNU GPL](https://www.gnu.org/licenses/gpl-2.0.html#SEC1).

[Last modified](/wiki/WikiStart?action=diff&version=214 "Version 214 by Christian Franke: Remove outdated News")
[6 weeks ago](/timeline?from=2024-12-01T15%3A59%3A57%2B01%3A00&precision=second "See timeline at Dec 1, 2024, 3:59:57 PM")
Last modified on Dec 1, 2024, 3:59:57 PM

**Note:**
See [TracWiki](/wiki/TracWiki)
for help on using the wiki.

### Download in other formats:

* [Plain Text](/wiki/WikiStart?format=txt)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Validator: [Check XHTML](https://validator.w3.org/check?uri=referer)



=== Content from www.claudiokuenzler.com_87cd204a_20250115_081806.html ===


Toggle navigation

[![Start](/favicon-16x16.png)](/)

* [home](/)
* [about](/about)
* [all articles](/ALL)
* [howto archive](/howtos/)
* [monitoring plugins](/monitoring-plugins/)
* [search](/search/)

# [Monitoring plugin check\_smart 6.9.1 released: Security fix in pseudo-device path](/blog/1068/check_smart-6.9.1-security-fix-release-pseudo-device-path)

Written by [Claudio Kuenzler](/about/) - [2 comments](#Comments)

Published on April 8th 2021 - last updated on October 15th 2021 - Listed in [Monitoring](/Monitoring) [Hardware](/Hardware) [Security](/Security)

---

An internal security audit at [SUSE](https://www.suse.com/) has come across a potential security issue in the [check\_smart script, a monitoring plugin to check physical hard-, solid sate and NVMe drives](/monitoring-plugins/check_smart.php).

Since version 6.1, the -d parameter also [supports a so-called pseudo device](/blog/866/check_smart-6.1-allows-using-pseudo-device-dev-bus-n), located at /dev/bus/XX and representing drive(s) behind a raid controller in certain systems. To detect this path in the input, the regular expression was not good enough. This lead to the possibility, that someone could use whatever path as input, as long as it contained the string "/dev/bus" and a number:

$ sudo ./check\_smart.pl -d /tmp/dev/bus/99 -i ata
[sudo] password for ck:
UNKNOWN: Drive  S/N :  No health status line found|

To execute check\_smart, sudo privileges are (unfortunately) required. The monitoring plugin launches smartctl in the background. Even though smartctl does not execute the path in any way but rather tries to read from it, it cannot be excluded that some method exists to execute the path.

The regex was fixed in the newest release 6.9.1 and an attempt to use a path outside of /dev/ results in the following error now:

$ sudo ./check\_smart.pl -d /tmp/dev/bus/99 -i ata
[sudo] password for ck:
Could not find any valid block/character special device for device /tmp/dev/bus/99  !

 **As 6.9.1 is a security release, an update is strongly recommended.**

Thanks to Wolfgang Frisch from SUSE for the great collaboration and information exchange.

## CVE-2021-42257

This (security) bug has been published as [CVE-2021-42257](https://nvd.nist.gov/vuln/detail/CVE-2021-42257) on October 11th 2021.

### Add a comment

Show form to leave a comment

Anti Spam Question: What's the short name for Wireless LAN? All capital letters.

### Comments (newest first)

[ck](https://www.claudiokuenzler.com/blog/1068/check_smart-6.9.1-security-fix-release-pseudo-device-path) from Switzerland wrote on Oct 15th, 2021:

*DimeCadmium, no, I was not aware of this. Thank you for your e-mail for reporting this.*

---

DimeCadmium from wrote on Oct 14th, 2021:

*Did you also fix your parameter quoting issues (as on display in the oss-security posting)?*

---

[![RSS feed](/graph/content/rss.png)](/rss.xml)
#### Blog Tags:

   [AWS](/AWS)   [Android](/Android)   [Ansible](/Ansible)   [Apache](/Apache)   [Apple](/Apple)   [Atlassian](/Atlassian)   [BSD](/BSD)   [Backup](/Backup)   [Bash](/Bash)   [Bluecoat](/Bluecoat)   [CMS](/CMS)   [Chef](/Chef)   [Cloud](/Cloud)   [Coding](/Coding)   [Consul](/Consul)   [Containers](/Containers)   [CouchDB](/CouchDB)   [DB](/DB)   [DNS](/DNS)   [Database](/Database)   [Databases](/Databases)   [Docker](/Docker)   [ELK](/ELK)   [Elasticsearch](/Elasticsearch)   [Filebeat](/Filebeat)   [FreeBSD](/FreeBSD)   [Galera](/Galera)   [Git](/Git)   [GlusterFS](/GlusterFS)   [Grafana](/Grafana)   [Graphics](/Graphics)   [HAProxy](/HAProxy)   [HTML](/HTML)   [Hacks](/Hacks)   [Hardware](/Hardware)   [Icinga](/Icinga)   [Influx](/Influx)   [Internet](/Internet)   [Java](/Java)   [KVM](/KVM)   [Kibana](/Kibana)   [Kodi](/Kodi)   [Kubernetes](/Kubernetes)   [LVM](/LVM)   [LXC](/LXC)   [Linux](/Linux)   [Logstash](/Logstash)   [Mac](/Mac)   [Macintosh](/Macintosh)   [Mail](/Mail)   [MariaDB](/MariaDB)   [Minio](/Minio)   [MongoDB](/MongoDB)   [Monitoring](/Monitoring)   [Multimedia](/Multimedia)   [MySQL](/MySQL)   [NFS](/NFS)   [Nagios](/Nagios)   [Network](/Network)   [Nginx](/Nginx)   [OSSEC](/OSSEC)   [OTRS](/OTRS)   [Observability](/Observability)   [Office](/Office)   [OpenSearch](/OpenSearch)   [PGSQL](/PGSQL)   [PHP](/PHP)   [Perl](/Perl)   [Personal](/Personal)   [PostgreSQL](/PostgreSQL)   [Postgres](/Postgres)   [PowerDNS](/PowerDNS)   [Proxmox](/Proxmox)   [Proxy](/Proxy)   [Python](/Python)   [Rancher](/Rancher)   [Rant](/Rant)   [Redis](/Redis)   [Roundcube](/Roundcube)   [SSL](/SSL)   [Samba](/Samba)   [Seafile](/Seafile)   [Security](/Security)   [Shell](/Shell)   [SmartOS](/SmartOS)   [Solaris](/Solaris)   [Surveillance](/Surveillance)   [Systemd](/Systemd)   [TLS](/TLS)   [Tomcat](/Tomcat)   [Ubuntu](/Ubuntu)   [Unix](/Unix)   [VMWare](/VMWare)   [VMware](/VMware)   [Varnish](/Varnish)   [Virtualization](/Virtualization)   [Windows](/Windows)   [Wireless](/Wireless)   [Wordpress](/Wordpress)   [Wyse](/Wyse)   [ZFS](/ZFS)   [Zoneminder](/Zoneminder)

---

© 2008 - 2025 by Claudio Kuenzler. Powered by [![Powered by Infiniroot](/graph/lay/infiniroot.gif)](https://www.infiniroot.com).



=== Content from build.opensuse.org_f37ee967_20250115_131638.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 892026

This request supersedes:
[request 892017](/request/show/892017)
([Show diff](/request/show/892026?diff_to_superseded=892017))

##### Overview

### Request 892026 accepted

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

* Created by
  [lrupp](/users/lrupp)
  over 3 years ago
* In state
  [accepted](/request/show/892026#request-history)
* Supersedes
  [892017](/request/show/892017)

* [Submit monitoring-plugins-smart.openSUSE\_Backports\_SLE-15-SP3](#Submit_monitoring-plugins-smart_openSUSE_Backports_SLE-15-SP32194869)

Loading...

* [Comments for request 892026
  0](#comments)

*No comments available*

##### Request History

![Lars Vogdt's avatar](https://www.gravatar.com/avatar/dd04d885c1ff480b45dc654071c7db18?s=38&d=robohash "Lars Vogdt")

[lrupp](/users/lrupp)
created request
[over 3 years ago](#request-creation "2021-05-10 11:41 UTC")

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9535659 "2021-05-10 11:45 UTC")

ok

---

![Wolfgang Engel's avatar](https://www.gravatar.com/avatar/1365c492fd53804228ee6d8e00ada8b3?s=38&d=robohash "Wolfgang Engel")

[bigironman](/users/bigironman)
added as a reviewer
[over 3 years ago](#status-history-9539358 "2021-05-10 21:35 UTC")

Being evaluated by staging project "openSUSE:Backports:SLE-15-SP3:Staging:adi:8"

---

![Wolfgang Engel's avatar](https://www.gravatar.com/avatar/1365c492fd53804228ee6d8e00ada8b3?s=38&d=robohash "Wolfgang Engel")

[bigironman](/users/bigironman)
accepted review
[over 3 years ago](#status-history-9539361 "2021-05-10 21:35 UTC")

Picked "openSUSE:Backports:SLE-15-SP3:Staging:adi:8"

---

![Wolfgang Engel's avatar](https://www.gravatar.com/avatar/1365c492fd53804228ee6d8e00ada8b3?s=38&d=robohash "Wolfgang Engel")

[bigironman](/users/bigironman)
accepted review
[over 3 years ago](#status-history-9539481 "2021-05-11 05:52 UTC")

Staging Project openSUSE:Backports:SLE-15-SP3:Staging:adi:8 got accepted.

---

![Wolfgang Engel's avatar](https://www.gravatar.com/avatar/1365c492fd53804228ee6d8e00ada8b3?s=38&d=robohash "Wolfgang Engel")

[bigironman](/users/bigironman)
approved review
[over 3 years ago](#status-history-9539484 "2021-05-11 05:52 UTC")

Staging Project openSUSE:Backports:SLE-15-SP3:Staging:adi:8 got accepted.

---

![Wolfgang Engel's avatar](https://www.gravatar.com/avatar/1365c492fd53804228ee6d8e00ada8b3?s=38&d=robohash "Wolfgang Engel")

[bigironman](/users/bigironman)
accepted request
[over 3 years ago](#status-history-9539487 "2021-05-11 05:52 UTC")

Staging Project openSUSE:Backports:SLE-15-SP3:Staging:adi:8 got accepted.

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from idp-portal.suse.com_6b95d262_20250115_212311.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from build.opensuse.org_b6899bb0_20250115_131637.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 892027

##### Overview

### Request 892027 accepted

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

* Created by
  [lrupp](/users/lrupp)
  over 3 years ago
* In state
  [accepted](/request/show/892027#request-history)

* [Incident monitoring-plugins-smart.openSUSE\_Leap\_15.2\_Update](#Incident_monitoring-plugins-smart_openSUSE_Leap_15_2_Update2194872)

Loading...

* [Comments for request 892027
  1](#comments)

---

![Leap Reviewbot's avatar](https://www.gravatar.com/avatar/0207d16fd2a6bd00f61444a7a815198e?s=35&d=robohash "Leap Reviewbot")

[Leap Reviewbot (leaper)](/users/leaper)
-
[over 3 years ago](#comment-1454142 "2021-05-10 11:45 UTC")

<!-- Leaper state=done result=accepted -->

home:lrupp:branches:OBS\_Maintained:monitoring-plugins-smart/monitoring-plugins-smart.openSUSE\_Leap\_15.2\_Update@c89a1686fead1fc290f75d1c1534ff91 -> openSUSE:Leap:15.2:Update/monitoring-plugins-smart

expected origin is 'None' (unchanged)

##### Request History

![Lars Vogdt's avatar](https://www.gravatar.com/avatar/dd04d885c1ff480b45dc654071c7db18?s=38&d=robohash "Lars Vogdt")

[lrupp](/users/lrupp)
created request
[over 3 years ago](#request-creation "2021-05-10 11:41 UTC")

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9535662 "2021-05-10 11:45 UTC")

ok

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[over 3 years ago](#status-history-9535671 "2021-05-10 11:46 UTC")

Check script succeeded

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
accepted review
[over 3 years ago](#status-history-9535761 "2021-05-10 12:03 UTC")

ok

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
approved review
[over 3 years ago](#status-history-9535764 "2021-05-10 12:03 UTC")

ok

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
moved maintenance target to openSUSE:Maintenance:16250
[over 3 years ago](#status-history-9535977 "2021-05-10 12:44 UTC")

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
accepted request
[over 3 years ago](#status-history-9535980 "2021-05-10 12:44 UTC")

accepted request 892027:Thanks!

For information about the update, see https://build.opensuse.org/project/maintenance\_incidents/openSUSE:Maintenance

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from www.claudiokuenzler.com_0c897be1_20250115_081807.html ===


Toggle navigation

[![Start](/favicon-16x16.png)](/)

* [home](/)
* [about](/about)
* [all articles](/ALL)
* [howto archive](/howtos/)
* [monitoring plugins](/monitoring-plugins/)
* [search](/search/)

# check\_smart monitoring plugin

Last update: September 16, 2024

This is a monitoring plugin to monitor the values of SMART (Self-Monitoring, Analysis and Reporting Technology) attributes of hard and solid state drives, using smartmontool's smartctl in the background.
(S)ATA, SCSI/SAS and NVMe drives are supported. The plugin is a fork of check\_smart released in 2009 by Kurt Yoder. Since then the plugin has undergone a lot of changes. It allows to monitor drives behind hardware controllers and added a lot of parameters to fine tune the checks and set thresholds (on a per attribute setting).

[![](img/check-smart-fox-800.jpg)](img/check-smart-fox.jpg)

## Introduction to physical drive monitoring

Monitoring of physical hard drives (HDDs), solid state drives (SSDs) or NVMe drives is crucial in production environments. Whether the drives are running in a server or on a workstation, you want to know if a drive is starting to fail so you can pro-actively plan actions - before it's too late. See the following articles for real life examples:

* [Multiple ways to monitor physical hard drives, very different results](https://www.claudiokuenzler.com/blog/469/multiple-several-ways-monitor-physical-hard-drive-disk)
* [I am an egg boiler, too, said the hard drive and caused application issues](https://www.claudiokuenzler.com/blog/881/hard-drive-high-temperature-causes-application-issues-latency)
* [check\_smart.pl saves server lifes (defect hard drive detected)](https://www.claudiokuenzler.com/blog/411/check_smart-saves-server-lifes-defect-hard-drive-detected)
* [Troubleshooting bad server performance caused by hard drives with huge Load Cycle count](https://www.claudiokuenzler.com/blog/1307/troubleshooting-bad-server-performance-high-iowait-hard-drive-load-cycle-count)

Depending on the type of the drive, the SMART output is different. The plugin is able to handle ATA, SCSI and NVMe drives and adjust itself to the SMART output of these different interface types.

### Monitoring (S)ATA drives

As of this writing (March 2020), the most used drives are currently ATA-based hard or solid state drives. The (S)ATA interface exists on all motherboards, the SATA standard is currently in version 3 allowing theoretical transfer speeds of up to 6Gbit/s. Both hard drives and solid state drives (with a SATA connector) are using the ATA SMART output.

The ATA S.M.A.R.T. table features a list of SMART attributes. These attributes can either be counters (example: Power\_On\_Hours) or show a specific value (example: Temperature). The attribute names are not always the same, depending on the vendors of the physical drive. A good overview of existing attributes can be found on [Wikipedias SMART page](https://en.wikipedia.org/wiki/S.M.A.R.T.).

The **check\_smart** monitoring plugin runs a couple of checks on ATA drives. First the current health status of the drive is retrieved. If health of the drive seems to be OK, the plugin will retrieve all the SMART attributes and their current values and compare them to given thresholds (using the -w parameter, optional). The plugin adds performance data on single drive checks which is handy to long-term monitoring of drives.

### Monitoring SCSI/SAS drives

Compared to ATA drives, SCSI drives do not have SMART attributes. The available data for analysis and pre-failure guessing is very limited. Basically the relevant information can only be found in the **grown defect list** counter. **check\_smart** is actively monitoring this counter (thresholds are possible with -b parameter), besides doing the normal health and temperature checks.

The usage of SCSI drives is declining due to the rise of ATA-based SSD and NVMe drives. However note that SAS drives are basically SCSI drives and are still widely used in enterprise servers.

### Monitoring NVMe drives

NVMe drives use, like ATA drives, a list of SMART attributes to help identify (pre-fail) problems of a drive. However the attributes are not compatible with the ATA attributes. **check\_smart** mainly focuses on the **Critical\_Warning** attribute which represents the drive status. The plugin also actively monitors the **Media\_and\_Data\_Integrity\_Errors** counter which could help to identify a failing NVMe drive.

The plugin adds performance data on single drive checks which is handy to long-term monitoring of drives.

Monitoring of NVMe drives is possible since check\_smart 6.7.0.

## Commercial support

If you are looking for commercial support for this monitoring plugin, need customized modifications or in general customized monitoring plugins, [contact us at Infiniroot.com](https://www.infiniroot.com/contact/).

## Download

[![Download check_smart.pl](/graph/content/download.gif)](check_smart.pl)

[**check\_smart.pl**](check_smart.pl)

20774 downloads so far...

Download plugin and save it in your Nagios/Monitoring plugin folder (usually /usr/lib/nagios/plugins, depends on your distribution). Afterwards adjust the permissions (usually chmod 755).

Community contributions welcome on [GitHub repo](https://github.com/Napsty/check_smart).

### Package installation

The check\_smart plugin is available on RPM-based Linux distributions as package [**monitoring-plugins-smart**](https://build.opensuse.org/package/show/server%3Amonitoring/monitoring-plugins-smart), maintained in the [server:monitoring](https://build.opensuse.org/repositories/server%3Amonitoring) repository. Check the link for available Linux distributions.

## Version history / Changelog

Feb 3, 2009: Kurt Yoder - initial version of script (rev 1.0)

Jul 8, 2013: Claudio Kuenzler - support hardware raids like megaraid (rev 2.0)

Jul 9, 2013: Claudio Kuenzler - update help output (rev 2.1)

Oct 11, 2013: Claudio Kuenzler - making the plugin work on FreeBSD (rev 3.0)

Oct 11, 2013: Claudio Kuenzler - allowing -i sat (SATA on FreeBSD) (rev 3.1)

[Nov 4, 2013: Claudio Kuenzler - works now with CCISS on FreeBSD (rev 3.2)](http://www.claudiokuenzler.com/blog/410/check_smart-support-cciss-hp-raid-warning-elements-in-grown-defect-list)

Nov 4, 2013: Claudio Kuenzler - elements in grown defect list causes warning (rev 3.3)

Nov 6, 2013: Claudio Kuenzler - add threshold option "bad" (-b) (rev 4.0)

Nov 7, 2013: Claudio Kuenzler - modified help (rev 4.0)

Nov 7, 2013: Claudio Kuenzler - bugfix in threshold logic (rev 4.1)

Mar 19, 2014: Claudio Kuenzler - bugfix in defect list perfdata (rev 4.2)

Apr 22, 2014: Jerome Lauret - implemented -g to do a global lookup (rev 5.0)

Apr 25, 2014: Claudio Kuenzler - cleanup, merge Jeromes code, perfdata output fix (rev 5.1)

May 5, 2014: Caspar Smit - Fixed output bug in global check / issue #3 (rev 5.2)

Feb 4, 2015: Caspar Smit and cguadall - Allow detection of more than 26 devices / issue #5 (rev 5.3)

Feb 5, 2015: Bastian de Groot - Different ATA vs. SCSI lookup (rev 5.4)

Feb 11, 2015: Josh Behrends - Allow script to run outside of nagios plugins dir / wiki url update (rev 5.5)

Feb 11, 2015: Claudio Kuenzler - Allow script to run outside of nagios plugins dir for FreeBSD too (rev 5.5)

Mar 12, 2015: Claudio Kuenzler - Change syntax of -g parameter (regex is now awaited from input) (rev 5.6)

Feb 6, 2017: Benedikt Heine - Fix Use of uninitialized value $device (rev 5.7)

[Oct 10, 2017: Bobby Jones - Allow multiple devices for interface type megaraid, e.g. "megaraid,[1-5]" (rev 5.8)](/blog/739/monitoring-plugin-check_smart-5.8-regex-megaraid-interface)

[Apr 28, 2018: Pavel Pulec (Inuits) - allow type "auto" (rev 5.9)](/blog/772/check_smart-version-5.9-released)

[May 5, 2018: Claudio Kuenzler - Check selftest log for errors using new parameter -s (rev 5.10)](/blog/775/monitoring-plugin-check_smart-new-version-5.10-selftest)

[Dec 27, 2018: Claudio Kuenzler - Add exclude list (-e) to ignore certain attributes (5.11)](/blog/818/monitoring-plugin-check_smart-5.11-introducing-exclude-ignore-list)

[Jan 8, 2019: Claudio Kuenzler - Fix 'Use of uninitialized value' warnings (5.11.1)](/blog/821/monitoring-plugin-check_smart-5.11.1-bugfix-released)

[Jun 4, 2019: Claudio Kuenzler - Add raw check list (-r) and warning thresholds (-w) (6.0)](/blog/864/major-release-check_smart-multi-attribute-value-checks-warning-thresholds)

[Jun 11, 2019: Claudio Kuenzler - Allow using pseudo bus device /dev/bus/N (6.1)](/blog/866/check_smart-6.1-allows-using-pseudo-device-dev-bus-n)

[Aug 19, 2019: Claudio Kuenzler - Add device model and serial number in output (6.2)](/blog/886/version-6.2-monitoring-plugin-check_smart-quicker-identification-drives-with-problems)

[Oct 1, 2019: Michael Krahe - Allow exclusion from perfdata as well (-E) and by attribute number (6.3)](/blog/903/check_smart-6.3-completely-ignore-smart-attributes)

[Oct 29, 2019: Jesse Becker - Remove dependency on utils.pm, add quiet parameter (6.4)](/blog/905/check_smart-6.4-released-plugin-independency-new-quiet-parameter)

[Nov 22, 2019: Claudio Kuenzler - Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list (6.5)](/blog/912/check_smart-6.5-default-attribute-raw-list-defined)

[Nov 29, 2019: Claudio Kuenzler - Add 3ware and cciss devices for global (-g) check, adjust output (6.6)](/blog/914/check_smart-6.6-multiple-drives-check-megaraid-3ware-cciss-controllers)

Dec 4, 2019: Ander Punnar - Fix 'deprecation warning on regex with curly brackets' (6.6.1)

[Mar 25, 2020: Claudio Kuenzler - Add support for NVMe devices (6.7.0)](/blog/942/check_smart-monitoring-plugin-supports-nvme-drives)

[Jun 2, 2020: Claudio Kuenzler - Bugfix to make --warn work (6.7.1)](/blog/964/bugfix-release-6.7.1-check_smart)

[Oct 14, 2020: Claudio Kuenzler - Allow skip self-assessment check (--skip-self-assessment) (6.8.0)](/blog/1012/check_smart-6.8-skip-smart-self-assessment-command-timeout-attribute)

[Oct 14, 2020: Claudio Kuenzler - Add Command\_Timeout to default raw list (6.8.0)](/blog/1012/check_smart-6.8-skip-smart-self-assessment-command-timeout-attribute)

[Mar 3, 2021: Evan Felix - Allow use of colons in pathnames so /dev/disk/by-path/ device names work (6.9.0)](/blog/1056/check-smart-6.9.0-pci-device-name-percent-lifetime-remain-ssd-attribute)

[Mar 4, 2021: Claudio Kuenzler - Add SSD attribute Percent\_Lifetime\_Remain check (-l|--ssd-lifetime) (6.9.0)](/blog/1056/check-smart-6.9.0-pci-device-name-percent-lifetime-remain-ssd-attribute)

[Apr 8, 2021: Claudio Kuenzler - Fix regex for pseudo-devices (6.9.1)](/blog/1068/check_smart-6.9.1-security-fix-release-pseudo-device-path)

[Jul 6, 2021: Bernhard Bittner - Add aacraid devices (6.10.0)](/blog/1099/check-smart-6.10.0-aacraid-controller-support)

[Oct 4, 2021: Claudio Kuenzler + Peter Newman - Handle dots in NVMe attributes, prioritize (order) alerts (6.11.0)](/blog/1132/check_smart-6.11-released-output-priority-criticality-notice)

[Dec 10, 2021: Claudio Kuenzler - Security fix in path for pseudo-devices, add Erase\_Fail\_Count\_Total, fix NVMe perfdata (6.12.0)](/blog/1154/check_smart-6.12-security-nvme-performance-data-fix-erase-fail-count-total)

[Dec 10, 2021: Claudio Kuenzler - Bugfix in interface handling (6.12.1)](/blog/1154/check_smart-6.12-security-nvme-performance-data-fix-erase-fail-count-total)

[Dec 16, 2021: Lorenz Kaestle - Bugfix when interface parameter was missing in combination with -g (6.12.2)](/blog/1157/monitoring-plugin-check_smart-6.12.2-bugfix-release)

[Apr 27, 2022: Claudio Kuenzler - Allow skip temperature check (--skip-temp-check) (6.13.0)](/blog/1210/check_smart-6.13.0-skip-temperature-check-improve-missing-smartctl-command)

[Apr 27, 2022: Peter Newman - Better handling of missing or non-executable smartctl command (6.13.0)](/blog/1210/check_smart-6.13.0-skip-temperature-check-improve-missing-smartctl-command)

[Apr 29, 2023: Nick Bertrand - Show drive(s) causing UNKNOWN status using -g/--global check (6.14.0)](/blog/1310/check-smart-6.14.0-released-multiple-improvements-enhancements)

[Apr 29, 2023: Claudio Kuenzler - Add possibility to hide serial number (--hide-sn) (6.14.0)](/blog/1310/check-smart-6.14.0-released-multiple-improvements-enhancements)

[Apr 29, 2023: Claudio Kuenzler - Add default check on Load Cycle Count (ignore using --skip-load-cycles) (6.14.0)](/blog/1310/check-smart-6.14.0-released-multiple-improvements-enhancements)

[Sep 20, 2023: Yannick Martin - Fix default Percent\_Lifetime\_Remain threshold handling when -w is given (6.14.1)](/blog/1347/monitoring-plugin-check_smart-6.14.1-bugfix-release)

[Sep 20, 2023: Claudio Kuenzler - Fix debug output for raw check list, fix --hide-serial in debug output (6.14.1)](/blog/1347/monitoring-plugin-check_smart-6.14.1-bugfix-release)

[Mar 15, 2024: Yannick Martin - Fix nvme check when auto interface is given and device is nvme (6.14.2)](/blog/1397/monitoring-plugin-check_smart-6.14.2-bugfix-release-nvme)

[Sep 10, 2024: Claudio Kuenzler - Fix performance data format, missing perfdata in SCSI drives (6.14.3)](/blog/1441/monitoring-plugin-check_smart-6.14.3-performance-data-fixes)

## Requirements

* Perl
* smartmontools package (smartctl command is required)
* sudo package (and relevant sudo permission entry in /etc/sudoers)
* For cciss (HP SmartArray) controllers: smartmontools >= 5.37
* For NVMe drives: smartmontools >= 6.5

### Sudoers entry

This plugin needs to run as root, otherwise you're not able to lauch smartctl correctly. You have two options:

* Launch the plugin itself with sudo
* Launch the plugin itself as nagios user and the smartctl command as root with sudo

Here are some examples you can add to your sudoers with the command "visudo":

nagios ALL = NOPASSWD: /usr/local/libexec/nagios/check\_smart.pl # for option 1 on FreeBSD

nagios ALL = NOPASSWD: /usr/local/sbin/smartctl # for option 2 on FreeBSD

nagios ALL = NOPASSWD: /usr/lib/nagios/plugins/check\_smart.pl # for option 1 on Linux

nagios ALL = NOPASSWD: /usr/sbin/smartctl # for option 2 on Linux

## Definition of the parameters

| Short | Long | Description |
| --- | --- | --- |
| -d | --device | A physical block device to be SMART monitored, eg /dev/sda. Since 6.9.0 disk pci path is also working (/dev/disk/by-path/pci-0000:03:00.1-ata-1). Pseudo-device /dev/bus/N is allowed. |
| -g | --global | A glob expression of physical devices to be monitored, eg -g "/dev/sd[a-z]" for devices /dev/sda until /dev/sdz or -g "/dev/sd{a,b,d}" for devices /dev/sda, /dev/sdb and /dev/sdd. If you have many drives exceeding the letter Z, you can use -g "/dev/sd\*[a-z]" for all /dev/sda until /dev/sdzzzz. It is also possible to use -g in conjunction with drives behind megaraid, cciss or 3ware controllers. Example: -g /dev/sda -i 'megaraid,[0-3]'. The global check allows to quickly identify obvious errors on multiple drives, however it will not show details of each drive. This parameter will omit performance data. For a detailed check including performance data for historical graphing, a single drive check (using -d) is advised. |
| -i | --interface | Drive's interface type, must be one of: **auto, ata, scsi, nvme, 3ware,N, areca,N, hpt,L/M/N, cciss,N, megaraid,N, aacraid,N,N,N** *See [Supported RAID-Controllers on the Smartmontools wiki](https://www.smartmontools.org/wiki/Supported_RAID-Controllers) for interface types* If used in combination with -g/--global, megaraid, 3ware and cciss interface supports glob expression, eg -i "megaraid,[8-9]" |
| -r\* | --raw\* | List (comma separated, without spaces!) of SMART attributes to check for their raw values. **ATA default**: 'Current\_Pending\_Sector, Reallocated\_Sector\_Ct, Program\_Fail\_Cnt\_Total, Uncorrectable\_Error\_Cnt, Offline\_Uncorrectable, Runtime\_Bad\_Block, Reported\_Uncorrect, Reallocated\_Event\_Count' **NVMe default**: 'Media\_and\_Data\_Integrity\_Errors' |
| -b\* | --bad\* | Threshold value (integer) when to warn for N bad entries (ATA: Current Pending Sector, SCSI: Grown defect list) Note: Deprecated for ATA since check\_smart version 6.0, use -w instead. Continue to use -b for SCSI drives. |
| -w\* | --warn\* | Comma separated list of thresholds for ATA drives (e.g. -w 'Reallocated\_Sector\_Ct=10,Current\_Pending\_Sector=62'). |
| -e\* | --exclude\* | List of (comma separated) SMART attributes which should be excluded (=ignored) from checks. Note that these attributes still appear in performance data. Also supports "When\_failed" values, e.g. "In\_the\_past" or "FAILING\_NOW". |
| -E\* | --exclude-all\* | List of (comma separated) SMART attributes which should be excluded (=ignored) **completely**, for both checks and performance data. Also supports "When\_failed" values, e.g. "In\_the\_past" or "FAILING\_NOW". |
| -s\* | --selftest\* | Additionally check SMART's selftest log for errors. |
| -l\* | --ssd-lifetime\* | Additionally check attribute 'Percent\_Lifetime\_Remain' which is available on some SSD drives. Note that this counter is "reversed" meaning it starts from 0. This could be confusing to some, but makes sense for setting a threshold at a value close to 100. By enabling this option, 'Percent\_Lifetime\_Remain=90' is added to the warning list. See [details](/blog/1056/check-smart-6.9.0-pci-device-name-percent-lifetime-remain-ssd-attribute) for more information. |
| -q\* | --quiet\* | When faults are detected, only show failing drive(s) (only affects output when used with -g parameter). |
| -h\* | --help | Show help/usage |
| -v\* | --version\* | Show plugin version |
| N/A | --skip-self-assessment | Skip the SMART self assessment health check (not recommended). |
| N/A | --skip-temp-check | Skip temperature comparison current vs. drive max temperature (not recommended). |
| N/A | --skip-load-cycles | Skip check of SMART attribute 193 (Load\_Cycle\_Count), deemed unsafe after reaching 600K load/unload cycles. |
| N/A | --hide-sn | Do not show serial number of drive(s) in output. |
| N/A | --debug\* | Show debugging information |

\* optional parameter

**Either -d or -g parameter is required. -i is always required.**

-e and -E exclude lists can co-exist.

## Usage / running the plugin on the command line

Usage:

./check\_smart.pl (-d string|-g regex) -i string [-r list] [-w list] [-b int] [-e list] [-s] [--debug]

Example: Single SATA Drive:

./check\_smart.pl -d /dev/sda -i ata

WARNING: Reallocated\_Sector\_Ct is non-zero (3), Program\_Fail\_Cnt\_Total is non-zero (3), Runtime\_Bad\_Block is non-zero (3), Uncorrectable\_Error\_Cnt is non-zero (1)|Reallocated\_Sector\_Ct=3 Power\_On\_Hours=31415 Power\_Cycle\_Count=889 Program\_Fail\_Count\_Chip=2 Erase\_Fail\_Count\_Chip=0 Wear\_Leveling\_Count=873 Used\_Rsvd\_Blk\_Cnt\_Chip=386 Used\_Rsvd\_Blk\_Cnt\_Tot=752 Unused\_Rsvd\_Blk\_Cnt\_Tot=3280 Program\_Fail\_Cnt\_Total=3 Erase\_Fail\_Count\_Total=0 Runtime\_Bad\_Block=3 Uncorrectable\_Error\_Cnt=1 ECC\_Error\_Rate=1 Offline\_Uncorrectable=0 CRC\_Error\_Count=262 Available\_Reservd\_Space=1630 Total\_LBAs\_Written=3363787529 Total\_LBAs\_Read=3278685684

Example: Single SATA Drive with warning thresholds:

./check\_smart.pl -d /dev/sda -i ata -w 'Reallocated\_Sector\_Ct=4,Runtime\_Bad\_Block=4,Uncorrectable\_Error\_Cnt=2'

WARNING: Reallocated\_Sector\_Ct is non-zero (3) (but less than threshold 4), Program\_Fail\_Cnt\_Total is non-zero (3), Runtime\_Bad\_Block is non-zero (3) (but less than threshold 4), Uncorrectable\_Error\_Cnt is non-zero (1) (but less than threshold 2)|Reallocated\_Sector\_Ct=3 Power\_On\_Hours=31415 Power\_Cycle\_Count=889 Program\_Fail\_Count\_Chip=2 Erase\_Fail\_Count\_Chip=0 Wear\_Leveling\_Count=873 Used\_Rsvd\_Blk\_Cnt\_Chip=386 Used\_Rsvd\_Blk\_Cnt\_Tot=752 Unused\_Rsvd\_Blk\_Cnt\_Tot=3280 Program\_Fail\_Cnt\_Total=3 Erase\_Fail\_Count\_Total=0 Runtime\_Bad\_Block=3 Uncorrectable\_Error\_Cnt=1 ECC\_Error\_Rate=1 Offline\_Uncorrectable=0 CRC\_Error\_Count=262 Available\_Reservd\_Space=1630 Total\_LBAs\_Written=3363863033 Total\_LBAs\_Read=3278685684

Example: Single SATA Drive but exclude certain attribute checks (yet keep the attribute data in performance data):

./check\_smart.pl -d /dev/sda -i ata -e 'Reallocated\_Sector\_Ct,Program\_Fail\_Cnt\_Total'

WARNING: Runtime\_Bad\_Block is non-zero (3), Uncorrectable\_Error\_Cnt is non-zero (1)|Reallocated\_Sector\_Ct=3 Power\_On\_Hours=31416 Power\_Cycle\_Count=889 Program\_Fail\_Count\_Chip=2 Erase\_Fail\_Count\_Chip=0 Wear\_Leveling\_Count=873 Used\_Rsvd\_Blk\_Cnt\_Chip=386 Used\_Rsvd\_Blk\_Cnt\_Tot=752 Unused\_Rsvd\_Blk\_Cnt\_Tot=3280 Program\_Fail\_Cnt\_Total=3 Erase\_Fail\_Count\_Total=0 Runtime\_Bad\_Block=3 Uncorrectable\_Error\_Cnt=1 ECC\_Error\_Rate=1 Offline\_Uncorrectable=0 CRC\_Error\_Count=262 Available\_Reservd\_Space=1630 Total\_LBAs\_Written=3363924329 Total\_LBAs\_Read=3278685684

Example: Single SATA Drive but completely exclude certain attribute from check and performance data:

./check\_smart.pl -d /dev/sda -i ata -E 'Reallocated\_Sector\_Ct,Program\_Fail\_Cnt\_Total'

WARNING: Runtime\_Bad\_Block is non-zero (3), Uncorrectable\_Error\_Cnt is non-zero (1)|Power\_On\_Hours=31416 Power\_Cycle\_Count=889 Program\_Fail\_Count\_Chip=2 Erase\_Fail\_Count\_Chip=0 Wear\_Leveling\_Count=873 Used\_Rsvd\_Blk\_Cnt\_Chip=386 Used\_Rsvd\_Blk\_Cnt\_Tot=752 Unused\_Rsvd\_Blk\_Cnt\_Tot=3280 Erase\_Fail\_Count\_Total=0 Runtime\_Bad\_Block=3 Uncorrectable\_Error\_Cnt=1 ECC\_Error\_Rate=1 Offline\_Uncorrectable=0 CRC\_Error\_Count=262 Available\_Reservd\_Space=1630 Total\_LBAs\_Written=3363924329 Total\_LBAs\_Read=3278685684

Example: Single SATA Drive with manual override which attributes should be checked for their raw values:

./check\_smart.pl -d /dev/sda -i ata -r 'Uncorrectable\_Error\_Cnt'

WARNING: Uncorrectable\_Error\_Cnt is non-zero (1)|Reallocated\_Sector\_Ct=3 Power\_On\_Hours=31416 Power\_Cycle\_Count=889 Program\_Fail\_Count\_Chip=2 Erase\_Fail\_Count\_Chip=0 Wear\_Leveling\_Count=873 Used\_Rsvd\_Blk\_Cnt\_Chip=386 Used\_Rsvd\_Blk\_Cnt\_Tot=752 Unused\_Rsvd\_Blk\_Cnt\_Tot=3280 Program\_Fail\_Cnt\_Total=3 Erase\_Fail\_Count\_Total=0 Runtime\_Bad\_Block=3 Uncorrectable\_Error\_Cnt=1 ECC\_Error\_Rate=1 Offline\_Uncorrectable=0 CRC\_Error\_Count=262 Available\_Reservd\_Space=1630 Total\_LBAs\_Written=3363995193 Total\_LBAs\_Read=3278685684

Example: Drive attached to MegaRAID controller:

./check\_smart.pl -d /dev/sda -i megaraid,8

Example: Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

/usr/local/libexec/nagios/check\_smart.pl -d /dev/pass0 -i scsi

Example: SATA drives behind Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

/usr/local/libexec/nagios/check\_smart.pl -d /dev/pass12 -i sat

Example: SCSI drives behind HP RAID (CCISS) on FreeBSD 6.0:

/usr/local/libexec/nagios/check\_smart.pl -d /dev/ciss0 -i cciss,0

OK: no SMART errors detected|defect\_list=0 sent\_blocks=3093462752 temperature=24;;68

/usr/local/libexec/nagios/check\_smart.pl -d /dev/ciss0 -i cciss,3

WARNING: 48 Elements in grown defect list | defect\_list=48 sent\_blocks=1137657348 temperature=22;;68

Example: Using threshold option (-b) to ignore 1 bad element, warning only when 2 bad elements are found:

/usr/local/libexec/nagios/check\_smart.pl -d /dev/ciss0 -i cciss,1 -b 2

OK: 1 Elements in grown defect list (but less than threshold 2)|defect\_list=1;2;2;; sent\_blocks=2769458900762624 temperature=27;;65

Example: Check all SATA disks (sda - sdz) at the same time on Linux:

/usr/lib/nagios/plugins/check\_smart.pl -g "/dev/sd[a-z]" -i ata

OK: [/dev/sda] - Device is clean --- [/dev/sdb] - Device is clean|

Example: Check all SCSI disks behind Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

/usr/local/libexec/nagios/check\_smart.pl -g "/dev/pass[1-9]" -i scsi

OK: [/dev/pass0] - Device is clean --- [/dev/pass1] - Device is clean --- [/dev/pass2] - Device is clean --- [/dev/pass3] - Device is clean --- [/dev/pass4] - Device is clean --- [/dev/pass5] - Device is clean --- [/dev/pass6] - Device is clean --- [/dev/pass7] - Device is clean --- [/dev/pass8] - Device is clean --- [/dev/pass9] - Device is clean |

Example: Single SCSI drive on FreeBSD 10.1:

/usr/local/libexec/nagios/check\_smart.pl -d /dev/da0 -i scsi

OK: no SMART errors detected. |sent\_blocks=14067306 temperature=34;;60

Example: Check multiple drives behind a HP Proliant raid controller (cciss interface):

/usr/lib/nagios/plugins/check\_smart.pl -g /dev/sda -i "cciss,[0-3]"

OK: [cciss,1] - Device is clean --- [cciss,2] - Device is clean --- [cciss,3] - Device is clean|

Example: Check a single NVMe drive:

/usr/lib/nagios/plugins/check\_smart.pl -d /dev/nvme0 -i nvme

OK: Drive Samsung SSD 970 PRO 512GB S/N XXXXXXXXXXXXXXX: no SMART errors detected. |Temperature=34 Available\_Spare=100 Available\_Spare\_Threshold=10 Percentage\_Used=0 Data\_Units\_Read=2854 Data\_Units\_Written=107590 Host\_Read\_Commands=67150 Host\_Write\_Commands=1406316 Controller\_Busy\_Time=20 Power\_Cycles=16 Power\_On\_Hours=105 Unsafe\_Shutdowns=6 Media\_and\_Data\_Integrity\_Errors=0 Error\_Information\_Log\_Entries=0 Warning\_\_Comp.\_Temperature\_Time=0 Critical\_Comp.\_Temperature\_Time=0 Temperature\_Sensor\_1=34 Temperature\_Sensor\_2=33

Example: Check multiple NVMe drives:

/usr/lib/nagios/plugins/check\_smart.pl -g "/dev/nvme[0-9]" -i nvme

OK: [/dev/nvme0] - Device is clean --- [/dev/nvme1] - Device is clean|

## Command definition (NRPE)

Example command definition for single drive in your nrpe.cfg:

command[check\_smart]=sudo /usr/lib/nagios/plugins/check\_smart.pl -d $ARG1$ -i $ARG2$ -w $ARG3$

Example command definition for multiple drives using -g parameter in your nrpe.cfg:

command[check\_smart\_multidrive]=sudo /usr/lib/nagios/plugins/check\_smart.pl -g $ARG1$ -i $ARG2$ -w $ARG3$

## Service definition

### Service definition in Nagios, Icinga 1.x, Shinken, Naemon

Basic check of a single drive (or drive in software raid):

# Check SMART of a typical single disk (or used in software
raid)

define service{

  use generic-service

  host\_name mylinux1

  service\_description Disk SMART Status SDA

  check\_command check\_nrpe!check\_smart!-a "/dev/sda" "sat" "Current\_Pending\_Sector=14,Reallocated\_Sector\_Count=3"

}

Check SMART of multiple disks at same time:

# Check SMART of multiple disks with regex (looking for /dev/sda until /dev/sdf)

define service{

  use generic-service

  host\_name mylinux1

  service\_description Disk SMART Status

  check\_command check\_nrpe!check\_smart\_all!-a "/dev/sd[a-f]" "sat" "Current\_Pending\_Sector=14,Reallocated\_Sector\_Count=3"

}

Check SMART of a drive behind a cciss (HP SmartArray) controller:

# Check SMART of a drive behind a cciss (HP SmartArray)
raid controller

define service{

  use generic-service

  host\_name myhpproliant1

  service\_description Disk SMART Status cciss2

  check\_command check\_nrpe!check\_smart!-a "/dev/cciss/c0d0" "cciss,2" "Current\_Pending\_Sector=14,Reallocated\_Sector\_Count=3"

}

Here the argument 3 ($ARG3$) is "Current\_Pending\_Sector=14,Reallocated\_Sector\_Count=3". This means that this drive already has 13 pending sectors and 2 reallocated sectors. The warning thesholds are set to 14 for the Current\_Pending\_Sector attribute and to 3 for the Reallocated\_Sector\_Count attribute. As soon as the drive reaches 14 (or more) pending sectors or 3 (or more) reallocated sectors, the plugin will return a warning. This helps to see if a disk is really failing and the number of defect sectors are growing.

### Service object definition Icinga 2.x

Check a single SATA drive with specific warning threshold

# SMART Check of drive sda

object Service "Hardware" {

  import "generic-service"

  host\_name "linuxserver1"

  check\_command = "nrpe"

  vars.nrpe\_command = "check\_smart"

  vars.nrpe\_arguments = ["/dev/sda", "sat", "Current\_Pending\_Sector=14,Reallocated\_Sector\_Count=3"]

}

## Screenshots

[![check_smart SSD Lifetime warning](img/smart-warning-percent-lifetime-remaining.png)](img/smart-warning-percent-lifetime-remaining.png)
[![check_smart multiple drives, one failed](img/check_smart-drive-failed.png)](img/check_smart-drive-failed.png)
[![check_smart multiple drives with drive names](/graph/news/886-smart-drive-names.png)](/graph/news/886-smart-drive-names.png)
[![check_smart multiple drives in icingaweb2](img/check_smart-icingaweb2.png)](img/check_smart-icingaweb2.png)
[![check_smart multiple alerts](/graph/news/411-check-smart-freebsd-disk-failure.jpg)](/graph/news/411-check-smart-freebsd-disk-failure.jpg)
[![check_smart warning](/graph/news/410-check-smart-elements-in-glist.jpg)](/graph/news/410-check-smart-elements-in-glist.jpg)
[![check_smart warning](/graph/news/415-199-elements.jpg)](/graph/news/415-199-elements.jpg)
[![check_smart all ok with values below threshold](/graph/news/415-bad-elements-noted.jpg)](/graph/news/415-bad-elements-noted.jpg)
[![check_smart self log warning](img/check-smart-selflog.png)](img/check-smart-selflog.png)

[![RSS feed](/graph/content/rss.png)](/rss.xml)

[Introduction](#Introduction)

[Commercial Support](#CommercialSupport)

[Download](#Download)

[Version history / changelog](#History)

[Requirements](#Requirements)

[Sudoers entry](#Sudoers)

[Definition of parameters](#Parameters)

[Usage](#Usage)

[Command definition (NRPE)](#CommandDefinition)

[Service definition](#ServiceDefinition)

[Screenshots](#Screenshots)

---

© 2008 - 2025 by Claudio Kuenzler. Powered by [![Powered by Infiniroot](/graph/lay/infiniroot.gif)](https://www.infiniroot.com).



=== Content from build.opensuse.org_c1e6c329_20250115_131642.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 892025

##### Overview

### Request 892025 accepted

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

* Created by
  [lrupp](/users/lrupp)
  over 3 years ago
* In state
  [accepted](/request/show/892025#request-history)

* [Incident monitoring-plugins-smart.openSUSE\_Backports\_SLE-15-SP2\_Update](#Incident_monitoring-plugins-smart_openSUSE_Backports_SLE-15-SP2_Update2194866)

Loading...

* [Comments for request 892025
  1](#comments)

---

![Leap Reviewbot's avatar](https://www.gravatar.com/avatar/0207d16fd2a6bd00f61444a7a815198e?s=35&d=robohash "Leap Reviewbot")

[Leap Reviewbot (leaper)](/users/leaper)
-
[over 3 years ago](#comment-1454139 "2021-05-10 11:45 UTC")

<!-- Leaper state=seen result=None -->

home:lrupp:branches:OBS\_Maintained:monitoring-plugins-smart/monitoring-plugins-smart.openSUSE\_Backports\_SLE-15-SP2\_Update@4fd4cd4298f3fe610bf7f93500118154 -> openSUSE:Backports:SLE-15-SP2:Update/monitoring-plugins-smart

expected origin is 'openSUSE:Leap:15.2' (changed)

##### Request History

![Lars Vogdt's avatar](https://www.gravatar.com/avatar/dd04d885c1ff480b45dc654071c7db18?s=38&d=robohash "Lars Vogdt")

[lrupp](/users/lrupp)
created request
[over 3 years ago](#request-creation "2021-05-10 11:41 UTC")

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9535656 "2021-05-10 11:45 UTC")

ok

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[over 3 years ago](#status-history-9535668 "2021-05-10 11:46 UTC")

Check script succeeded

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
added factory-source as a reviewer
[over 3 years ago](#status-history-9535755 "2021-05-10 12:03 UTC")

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
accepted review
[over 3 years ago](#status-history-9535758 "2021-05-10 12:03 UTC")

ok

---

![Source in Factory Checker's avatar](https://www.gravatar.com/avatar/3eae06ed19da3700fa70ae5e289bc8ba?s=38&d=robohash "Source in Factory Checker")

[factory-source](/users/factory-source)
accepted review
[over 3 years ago](#status-history-9535884 "2021-05-10 12:30 UTC")

ok

---

![Source in Factory Checker's avatar](https://www.gravatar.com/avatar/3eae06ed19da3700fa70ae5e289bc8ba?s=38&d=robohash "Source in Factory Checker")

[factory-source](/users/factory-source)
approved review
[over 3 years ago](#status-history-9535887 "2021-05-10 12:30 UTC")

ok

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
moved maintenance target to openSUSE:Maintenance:16250
[over 3 years ago](#status-history-9535983 "2021-05-10 12:44 UTC")

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
accepted request
[over 3 years ago](#status-history-9535986 "2021-05-10 12:44 UTC")

accepted request 892025:Thanks!

For information about the update, see https://build.opensuse.org/project/maintenance\_incidents/openSUSE:Maintenance

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from build.opensuse.org_237a6d65_20250115_131638.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 892024

##### Overview

### Request 892024 accepted

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

* Created by
  [lrupp](/users/lrupp)
  over 3 years ago
* In state
  [accepted](/request/show/892024#request-history)

* [Incident monitoring-plugins-smart.openSUSE\_Backports\_SLE-15-SP1\_Update](#Incident_monitoring-plugins-smart_openSUSE_Backports_SLE-15-SP1_Update2194863)

Loading...

* [Comments for request 892024
  1](#comments)

---

![Leap Reviewbot's avatar](https://www.gravatar.com/avatar/0207d16fd2a6bd00f61444a7a815198e?s=35&d=robohash "Leap Reviewbot")

[Leap Reviewbot (leaper)](/users/leaper)
-
[over 3 years ago](#comment-1454136 "2021-05-10 11:45 UTC")

<!-- Leaper state=seen result=None -->

home:lrupp:branches:OBS\_Maintained:monitoring-plugins-smart/monitoring-plugins-smart.openSUSE\_Backports\_SLE-15-SP1\_Update@b2e760596c55d5d44e322f03be830fb1 -> openSUSE:Backports:SLE-15-SP1:Update/monitoring-plugins-smart

expected origin is 'openSUSE:Leap:15.1' (changed)

##### Request History

![Lars Vogdt's avatar](https://www.gravatar.com/avatar/dd04d885c1ff480b45dc654071c7db18?s=38&d=robohash "Lars Vogdt")

[lrupp](/users/lrupp)
created request
[over 3 years ago](#request-creation "2021-05-10 11:41 UTC")

This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker

to modify SMART settings due to insufficient input validation in check\_smart (bsc#1183057).

In addition, the following new features are integrated:

+ Allows using PCI device paths as device name(s) (#64)

+ Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

+ Allow skip self-assessment check (--skip-self-assessment)

+ Add Command\_Timeout to default raw list

+ Added support for NVMe drives

+ The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

+ Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

+ Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9535653 "2021-05-10 11:45 UTC")

ok

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[over 3 years ago](#status-history-9535665 "2021-05-10 11:46 UTC")

Check script succeeded

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
added factory-source as a reviewer
[over 3 years ago](#status-history-9535749 "2021-05-10 12:03 UTC")

---

![Maintenance Bot's avatar](https://www.gravatar.com/avatar/d40ae16c579506b3cf2d501283c920ff?s=38&d=robohash "Maintenance Bot")

[maintbot](/users/maintbot)
accepted review
[over 3 years ago](#status-history-9535752 "2021-05-10 12:03 UTC")

ok

---

![Source in Factory Checker's avatar](https://www.gravatar.com/avatar/3eae06ed19da3700fa70ae5e289bc8ba?s=38&d=robohash "Source in Factory Checker")

[factory-source](/users/factory-source)
accepted review
[over 3 years ago](#status-history-9535878 "2021-05-10 12:30 UTC")

ok

---

![Source in Factory Checker's avatar](https://www.gravatar.com/avatar/3eae06ed19da3700fa70ae5e289bc8ba?s=38&d=robohash "Source in Factory Checker")

[factory-source](/users/factory-source)
approved review
[over 3 years ago](#status-history-9535881 "2021-05-10 12:30 UTC")

ok

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
moved maintenance target to openSUSE:Maintenance:16250
[over 3 years ago](#status-history-9535992 "2021-05-10 12:44 UTC")

---

![Marcus Meissner's avatar](https://www.gravatar.com/avatar/c48e3c23b2f532518ecc31a60bea2ab8?s=38&d=robohash "Marcus Meissner")

[msmeissn](/users/msmeissn)
accepted request
[over 3 years ago](#status-history-9535995 "2021-05-10 12:44 UTC")

accepted request 892024:Thanks!

For information about the update, see https://build.opensuse.org/project/maintenance\_incidents/openSUSE:Maintenance

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from build.opensuse.org_a46473de_20250115_131639.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 892023

This request supersedes:
[request 892019](/request/show/892019)
([Show diff](/request/show/892023?diff_to_superseded=892019))

##### Overview

### Request 892023 accepted

- Update to 6.9.1:

 This is a security-release (bsc#1183057)

 + Fixes the regular expression for pseudo-devices under the /dev/bus/N path.

 from 6.9.0

 + Allows using PCI device paths as device name(s) (#64)

 + Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

 from 6.8.0

 + Allow skip self-assessment check (--skip-self-assessment)

 + Add Command\_Timeout to default raw list

 from 6.7.1

 + Bugfix to make --warn work (issue #54)

 from 6.7.0

 + Added support for NVMe drives

 from 6.6.1

 + Fix 'deprecation warning on regex with curly brackets' (6.6.1)

 from 6.6.0

 + The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

 + Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

 from 6.5.0:

 + Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

 + As of 6.5 the following SMART attributes are by default checked and

 may result in alert when threshold (default 0 is reached):

 'Current\_Pending\_Sector,Reallocated\_Sector\_Ct,Program\_Fail\_Cnt\_Total,

* Created by
  [lrupp](/users/lrupp)
  over 3 years ago
* In state
  [accepted](/request/show/892023#request-history)
* Supersedes
  [892019](/request/show/892019)

* [Submit monitoring-plugins-smart](#Submit_monitoring-plugins-smart2194860)

Loading...

* [Comments for request 892023
  0](#comments)

*No comments available*

##### Request History

![Lars Vogdt's avatar](https://www.gravatar.com/avatar/dd04d885c1ff480b45dc654071c7db18?s=38&d=robohash "Lars Vogdt")

[lrupp](/users/lrupp)
created request
[over 3 years ago](#request-creation "2021-05-10 11:40 UTC")

- Update to 6.9.1:

 This is a security-release (bsc#1183057)

 + Fixes the regular expression for pseudo-devices under the /dev/bus/N path.

 from 6.9.0

 + Allows using PCI device paths as device name(s) (#64)

 + Introduce new optional parameter -l/--ssd-lifetime) which additionally

 checks SMART attribute "Percent\_Lifetime\_Remain"

 (available on some SSD drives). (#66 #67)

 from 6.8.0

 + Allow skip self-assessment check (--skip-self-assessment)

 + Add Command\_Timeout to default raw list

 from 6.7.1

 + Bugfix to make --warn work (issue #54)

 from 6.7.0

 + Added support for NVMe drives

 from 6.6.1

 + Fix 'deprecation warning on regex with curly brackets' (6.6.1)

 from 6.6.0

 + The feature was requested in #30 . This PR adds the possibility to

 use 3ware,N and cciss,N drives in combination with the

 global -g parameter.

 + Furthermore this PR adjusts the output of the plugin when the -g

 is used in combination with hardware raid controllers. Instead of

 showing the logical device name (/dev/sda for example), the plugin

 will now show the controller with drive number

 from 6.5.0:

 + Add Reported\_Uncorrect and Reallocated\_Event\_Count to default raw list.

 + As of 6.5 the following SMART attributes are by default checked and

 may result in alert when threshold (default 0 is reached):

 'Current\_Pending\_Sector,Reallocated\_Sector\_Ct,Program\_Fail\_Cnt\_Total,

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
added opensuse-review-team as a reviewer
[over 3 years ago](#status-history-9535641 "2021-05-10 11:40 UTC")

Please review sources

---

![Factory Auto's avatar](https://www.gravatar.com/avatar/3be6bec62ce4af49b4b555cbd8bd3b9d?s=38&d=robohash "Factory Auto")

[factory-auto](/users/factory-auto)
accepted review
[over 3 years ago](#status-history-9535644 "2021-05-10 11:40 UTC")

Check script succeeded

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[over 3 years ago](#status-history-9535650 "2021-05-10 11:45 UTC")

ok

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
added as a reviewer
[over 3 years ago](#status-history-9535674 "2021-05-10 11:50 UTC")

Being evaluated by staging project "openSUSE:Factory:Staging:adi:89"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9535677 "2021-05-10 11:50 UTC")

Picked "openSUSE:Factory:Staging:adi:89"

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/5cdd10d836bdda3796cf6bc1ab2d5a78?s=38&d=robohash "Dominique Leuenberger")

[dimstar](/users/dimstar)
accepted review
[over 3 years ago](#status-history-9535776 "2021-05-10 12:05 UTC")

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted review
[over 3 years ago](#status-history-9538494 "2021-05-10 13:39 UTC")

Staging Project openSUSE:Factory:Staging:adi:89 got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
approved review
[over 3 years ago](#status-history-9538497 "2021-05-10 13:39 UTC")

Staging Project openSUSE:Factory:Staging:adi:89 got accepted.

---

![Dominique Leuenberger's avatar](https://www.gravatar.com/avatar/58018ece4601a5b60720b91442e2612d?s=38&d=robohash "Dominique Leuenberger")

[dimstar\_suse](/users/dimstar_suse)
accepted request
[over 3 years ago](#status-history-9538500 "2021-05-10 13:39 UTC")

Staging Project openSUSE:Factory:Staging:adi:89 got accepted.

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from bugzilla.suse.com_82304535_20250115_081805.html ===


| Bugzilla – Bug 1183057 | VUL-0: CVE-2021-42257: monitoring-plugins-smart: unprivileged user can modify SMART settings due to insufficient input validation in check\_smart.pl | Last modified: 2021-10-14 19:31:33 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1183057)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1183057**](show_bug.cgi?id=1183057)
(CVE-2021-42257)
- VUL-0: CVE-2021-42257: monitoring-plugins-smart: unprivileged user can modify SMART settings due to insufficient input validation in check\_smart.pl

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2021-42257: monitoring-plugins-smart: unprivileged user can modify...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2021-42257 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | openSUSE Distribution | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | openSUSE | | [Component:](describecomponents.cgi?product=openSUSE Distribution "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=openSUSE%20Distribution&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | Leap 15.1 | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P2 - High **Severity**: Normal ([vote](page.cgi?id=voting/user.html&bug_id=1183057#vote_1183057)) | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Lars Vogdt | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/279235/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1176157](show_bug.cgi?id=1176157 "RESOLVED FIXED") [1180880](show_bug.cgi?id=1180880 "RESOLVED FIXED") | |  | Show dependency [tree](showdependencytree.cgi?id=1183057&hide_resolved=1) / [graph](showdependencygraph.cgi?id=1183057) | |  | | Reported: | 2021-03-04 20:37 UTC by Wolfgang Frisch | | --- | --- | | Modified: | 2021-10-14 19:31 UTC ([History](show_activity.cgi?id=1183057)) | | CC List: | 5 users (show)  jsegitz lars.vogdt matthias.gerstner nix wolfgang.frisch | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * [1191671](show_bug.cgi?id=1191671 "RESOLVED FIXED - VUL-0: monitoring-plugins-smart: sudoers config grants the nagios user unfiltered access to smartctl") | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1183057) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1183057&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1183057&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1183057#c0)  Wolfgang Frisch   2021-03-04 20:37:50 UTC  ``` +++ This bug was initially created as a clone of [Bug #1180880](show_bug.cgi?id=1180880 "RESOLVED FIXED") +++  The script `check_smart.pl` in monitoring-plugins-smart [0] is supposed to gather read-only information about hard drives by calling `smartctl` [1]. The latter requires root privileges, so the package grants passwordless access to the nagios user via `/etc/sudoers.d/monitoring-plugins-smart`.  Example intended usage: /usr/lib/nagios/plugins/check_smart -i auto -d /dev/sda >OK: Drive  ST2000LM007-1R8174 S/N WDZJESC2: no SMART errors detected.  An oversight in the script's input validation of the device (-d) parameter allows the unprivileged `nagios` user to modify SMART settings, disable SMART monitoring entirely, shut down the drive or degrade the drive's performance by disabling its read cache.  The -d parameter is validated as follows: ``` if (-b $opt_dl || -c $opt_dl || $opt_dl =~ m/\/dev\/bus\/\d/) { 	$device .= $opt_dl.":";  } else { 	warn "$opt_dl is not a valid block/character special device!\n\n" if $opt_debug; } ```  So an acceptable device name would be a block special device, a char special device or match the regex `/dev/bus/\d`. Critically, this regex matches even when /dev/bus/\d is just a _substring_ of any arbitrary directory, for example `/tmp/dev/bus/1/sda`.  Later, this parameter is used to spawn a subprocess: ``` my $full_command = "$smart_command -d $interface -Hi $device" my @output = `$full_command`; ```  This can be exploited to pass arbitrary parameters to smartctl, some of which affect the drive's behavior negatively.  Steps to reproduce: -------------------  # simulate nagios user su -l -s /bin/bash nagios mkdir -p /tmp/dev/bus/1/ ln -s /dev/sda /tmp/dev/bus/1/ ls -l /tmp/dev/bus/1/sda  >lrwxrwxrwx 1 nagios nagios 8 Mar  4 21:27 /tmp/dev/bus/1/sda -> /dev/sda  /usr/lib/nagios/plugins/check_smart --debug -i auto -d "/tmp/dev/bus/1/sda -s off"  >(debug) executing: >sudo smartctl -d auto -Hi /tmp/dev/bus/1/sda -s off >SMART Disabled.  Remediation: ------------ - Improve the validation regex, e.g. ^/dev/bus/\d$ - Prevent shell command injection, e.g. by passing a list to the system function.  [0] <https://github.com/Napsty/check_smart/> [1] <https://www.smartmontools.org/> ``` [Comment 5](show_bug.cgi?id=1183057#c5)  Wolfgang Frisch   2021-04-29 17:54:10 UTC  ``` Upstream fix: <https://github.com/Napsty/check_smart/pull/68/commits/ae31b1a4c244323bdd20b04a7545830d96f36e9d> ``` [Comment 7](show_bug.cgi?id=1183057#c7)  Lars Vogdt   2021-05-10 11:20:23 UTC  ``` Upgraded package submitted in server:monitoring.  SR to openSUSE:Factory               -> 892019 openSUSE:Backports:SLE-15-SP1:Update -> 892015 openSUSE:Backports:SLE-15-SP2:Update -> 892016 openSUSE:Backports:SLE-15-SP3        -> 892017 openSUSE:Leap:15.2:Update            -> 892018  All upgraded to the version in server:monitoring.  Suggestion for the Patchinfo:  This upgrade to version 6.9.1 mainly fixes a security issue, which allows an attacker to modify SMART settings due to insufficient input validation in check_smart ([bsc#1183057](http://bugzilla.suse.com/show_bug.cgi?id=1183057)).  In addition, the following new features are integrated: + Allows using PCI device paths as device name(s) (#64) + Introduce new optional parameter -l/--ssd-lifetime) which additionally     checks SMART attribute "Percent_Lifetime_Remain"     (available on some SSD drives). (#66 #67) + Allow skip self-assessment check (--skip-self-assessment) + Add Command_Timeout to default raw list + Added support for NVMe drives + The feature was requested in #30 . This PR adds the possibility to   use 3ware,N and cciss,N drives in combination with the    global -g parameter. + Furthermore this PR adjusts the output of the plugin when the -g    is used in combination with hardware raid controllers. Instead of   showing the logical device name (/dev/sda for example), the plugin   will now show the controller with drive number + Add Reported_Uncorrect and Reallocated_Event_Count to default raw list. ``` [Comment 8](show_bug.cgi?id=1183057#c8)  OBSbugzilla Bot   2021-05-10 12:20:03 UTC  ``` This is an autogenerated message for OBS integration: This bug (1183057) was mentioned in <https://build.opensuse.org/request/show/892023> Factory / monitoring-plugins-smart <https://build.opensuse.org/request/show/892024> Backports:SLE-15-SP1 / monitoring-plugins-smart <https://build.opensuse.org/request/show/892025> Backports:SLE-15-SP2 / monitoring-plugins-smart <https://build.opensuse.org/request/show/892026> Backports:SLE-15-SP3 / monitoring-plugins-smart <https://build.opensuse.org/request/show/892027> 15.2 / monitoring-plugins-smart ``` [Comment 9](show_bug.cgi?id=1183057#c9)  Swamp Workflow Management   2021-05-10 22:18:05 UTC  ``` openSUSE-SU-2021:0706-1: An update that contains security fixes can now be installed.  Category: security (important) Bug References: 1183057 CVE References:  JIRA References:  Sources used: openSUSE Leap 15.2 (src):    monitoring-plugins-smart-6.9.1-lp152.4.3.1 openSUSE Backports SLE-15-SP2 (src):    monitoring-plugins-smart-6.9.1-bp152.4.3.1 openSUSE Backports SLE-15-SP1 (src):    monitoring-plugins-smart-6.9.1-bp151.4.3.1 ``` [Comment 10](show_bug.cgi?id=1183057#c10)  Wolfgang Frisch   2021-10-14 16:30:23 UTC  ``` CVE-2021-42257 was assigned to this issue. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1183057)
* - [XML](show_bug.cgi?ctype=xml&id=1183057)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1183057)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1183057)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from github.com_16a4bd5a_20250115_131641.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNapsty%2Fcheck_smart%2Fpull%2F68%2Fcommits%2Fae31b1a4c244323bdd20b04a7545830d96f36e9d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNapsty%2Fcheck_smart%2Fpull%2F68%2Fcommits%2Fae31b1a4c244323bdd20b04a7545830d96f36e9d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=Napsty%2Fcheck_smart)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Napsty](/Napsty)
/
**[check\_smart](/Napsty/check_smart)**
Public

* [Notifications](/login?return_to=%2FNapsty%2Fcheck_smart) You must be signed in to change notification settings
* [Fork
  19](/login?return_to=%2FNapsty%2Fcheck_smart)
* [Star
   67](/login?return_to=%2FNapsty%2Fcheck_smart)

* [Code](/Napsty/check_smart)
* [Issues
  7](/Napsty/check_smart/issues)
* [Pull requests
  1](/Napsty/check_smart/pulls)
* [Actions](/Napsty/check_smart/actions)
* [Projects
  0](/Napsty/check_smart/projects)
* [Wiki](/Napsty/check_smart/wiki)
* [Security](/Napsty/check_smart/security)
* [Insights](/Napsty/check_smart/pulse)

Additional navigation options

* [Code](/Napsty/check_smart)
* [Issues](/Napsty/check_smart/issues)
* [Pull requests](/Napsty/check_smart/pulls)
* [Actions](/Napsty/check_smart/actions)
* [Projects](/Napsty/check_smart/projects)
* [Wiki](/Napsty/check_smart/wiki)
* [Security](/Napsty/check_smart/security)
* [Insights](/Napsty/check_smart/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FNapsty%2Fcheck_smart%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FNapsty%2Fcheck_smart%2Fissues%2Fnew%2Fchoose)
to your account

# Fix regex for pseudo-devices #68

 Merged

[Napsty](/Napsty)
merged 2 commits into
[master](/Napsty/check_smart/tree/master "Napsty/check_smart:master")
from
[6.9.1](/Napsty/check_smart/tree/6.9.1 "Napsty/check_smart:6.9.1")

Apr 8, 2021

[Conversation
0](/Napsty/check_smart/pull/68)
[Commits
2](/Napsty/check_smart/pull/68/commits)
[Checks
0](/Napsty/check_smart/pull/68/checks)
[Files changed](/Napsty/check_smart/pull/68/files)

 Merged

# [Fix regex for pseudo-devices](#top) #68

Changes from **1 commit**

Commits

[Show all changes

2 commits](/Napsty/check_smart/pull/68/files)
Select commit
Hold shift + click to select a range

[`ae31b1a`
Fix regex for pseudo-devices

Napsty Mar 17, 2021](/Napsty/check_smart/pull/68/commits/ae31b1a4c244323bdd20b04a7545830d96f36e9d)
[`282f674`
Bump release date

Napsty Apr 8, 2021](/Napsty/check_smart/pull/68/commits/282f67412f6ae779959f20ccbc3d7f4a033fa038)

**File filter**

### Filter by extension

Filter by extension

.pl
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/Napsty/check_smart/pull/68/commits/ae31b1a4c244323bdd20b04a7545830d96f36e9d)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Prev

 [Next](/Napsty/check_smart/pull/68/commits/282f67412f6ae779959f20ccbc3d7f4a033fa038)Next commit

Fix regex for pseudo-devices

* Loading branch information

[![@Napsty](https://avatars.githubusercontent.com/u/3702203?s=40&v=4)](/Napsty)

[Napsty](/Napsty/check_smart/commits?author=Napsty "View all commits by Napsty")
committed
Mar 17, 2021

commit ae31b1a4c244323bdd20b04a7545830d96f36e9d

## There are no files selected for viewing

5 changes: 3 additions & 2 deletions

5
[check\_smart.pl](#diff-bd1f0b18d94ef20d2eb78c4f4838341f4ac8f368525ac68ba5671472d94d3ffc "check_smart.pl")

Show comments

[View file](/Napsty/check_smart/blob/ae31b1a4c244323bdd20b04a7545830d96f36e9d/check_smart.pl)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,13 +47,14 @@ |
|  |  | # Oct 14, 2020: Claudio Kuenzler - Add Command\_Timeout to default raw list (6.8.0) |
|  |  | # Mar 3, 2021: Evan Felix - Allow use of colons in pathnames so /dev/disk/by-path/ device names work (6.9.0) |
|  |  | # Mar 4, 2021: Claudio Kuenzler - Add SSD attribute Percent\_Lifetime\_Remain check (-l|--ssd-lifetime) (6.9.0) |
|  |  | # Mar 17, 2021: Claudio Kuenzler - Fix regex for pseudo-devices (6.9.1) |
|  |  |  |
|  |  | use strict; |
|  |  | use Getopt::Long; |
|  |  | use File::Basename qw(basename); |
|  |  |  |
|  |  | my $basename = basename($0); |
|  |  | my $revision = '6.9.0'; |
|  |  | my $revision = '6.9.1'; |
|  |  |  |
|  |  | # Standard Nagios return codes |
|  |  | my %ERRORS=('OK'=>0,'WARNING'=>1,'CRITICAL'=>2,'UNKNOWN'=>3,'DEPENDENT'=>4); |
| Expand Down  Expand Up | | @@ -114,7 +115,7 @@ |
|  |  |  |
|  |  | foreach my $opt\_dl (@dev){ |
|  |  | warn "Found $opt\_dl\n" if $opt\_debug; |
|  |  | if (-b $opt\_dl || -c $opt\_dl || $opt\_dl =~ m/\/dev\/bus\/\d/) { |
|  |  | if (-b $opt\_dl || -c $opt\_dl || $opt\_dl =~ m/^\/dev\/bus\/\d/) { |
|  |  | $device .= $opt\_dl."|"; |
|  |  |  |
|  |  | } else { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_998704dc_20250115_081804.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <6c9845d6-fc90-38f1-e90c-3ff65d0a9eca@suse.com>
Date: Thu, 14 Oct 2021 19:47:12 +0200
From: Wolfgang Frisch <wolfgang.frisch@...e.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2021-42257: check_smart.pl: unprivileged user can alter hard
 drive settings

Hello oss-security,

during a routine audit of scripts in openSUSE, I discovered a
vulnerability in `check_smart.pl` [4], a plugin for systems monitoring
software to monitor the values of SMART attributes of hard and solid
state drives, using smartmontools in the background.

## Brief
`check_smart.pl` [1][2] from version 6.1 through 6.9 contained an
insufficient input validation that allowed an unprivileged user to
modify SMART settings, disable SMART monitoring entirely, shut down a
drive or degrade a drive's performance by disabling its read cache. The
bug was fixed with the release of version 6.9.1 [3].

## Detailed description
`check_smart.pl` needs to run as root in order to execute `smartctl`.
This is achieved with an entry in `/etc/sudoers`, which allows a lesser
privileged user, e.g. the one the monitoring system runs under, to
execute it. User input that is passed to `smartctl` is sufficiently
validated apart from one minor oversight.

The -d parameter is validated as follows:
> if (-b $opt_dl || -c $opt_dl || $opt_dl =~ m/\/dev\/bus\/\d/) {
>   # OK
> } else {
>   # NOT OK
> }

Later on, this parameter is passed verbatim to smartctl:
> my $full_command = "$smart_command -d $interface -Hi $device"

So an acceptable device name would be a block special device, a char
special device or match the regex `/dev/bus/\d`. Critically, this regex
matches even when /dev/bus/\d is just a _substring_ of any arbitrary
directory, for example `/tmp/dev/bus/1/sda`.

This can be exploited to pass arbitrary parameters to smartctl, some of
which affect the drive's behavior negatively:

### Steps to reproduce
> su -l -s /bin/bash nagios
> mkdir -p /tmp/dev/bus/1/
> ln -s /dev/sda /tmp/dev/bus/1/
> ls -l /tmp/dev/bus/1/sda
>
> /usr/lib/nagios/plugins/check_smart --debug -i auto -d "/tmp/dev/bus/1/sda -s off"
>
> SMART Disabled.

The upstream developer Claudio Kuenzler was very responsive and quickly
remediated the problem with the release of check_smart-6.9.1 [3].

[1] <https://github.com/Napsty/check_smart>
[2] <https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php>
[3]
<https://www.claudiokuenzler.com/blog/1068/check_smart-6.9.1-security-fix-release-pseudo-device-path>
[4] <https://bugzilla.suse.com/show_bug.cgi?id=1183057>

Best regards,
Wolfgang

--
Wolfgang Frisch <wolfgang.frisch@...e.com>
Security Engineer
OpenPGP fingerprint: A2E6 B7D4 53E9 544F BC13  D26B D9B3 56BD 4D4A 2D15
SUSE Software Solutions Germany GmbH
Maxfeldstr. 5, 90409 Nuremberg, Germany
(HRB 36809, AG Nürnberg)
Managing Director: Felix Imendörffer

Download attachment "[OpenPGP_signature](2/1)" of type "application/pgp-signature" (841 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_dc8a243a_20250115_131643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNapsty%2Fcheck_smart%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNapsty%2Fcheck_smart%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Napsty%2Fcheck_smart)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Napsty](/Napsty)
/
**[check\_smart](/Napsty/check_smart)**
Public

* [Notifications](/login?return_to=%2FNapsty%2Fcheck_smart) You must be signed in to change notification settings
* [Fork
  19](/login?return_to=%2FNapsty%2Fcheck_smart)
* [Star
   67](/login?return_to=%2FNapsty%2Fcheck_smart)

Monitoring Plugin to check hard drives, solid state drives and NVMe drives using SMART

[www.claudiokuenzler.com/monitoring-plugins/check\_smart.php](https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php "https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php")

### License

[GPL-3.0 license](/Napsty/check_smart/blob/master/COPYING.md)

[67
stars](/Napsty/check_smart/stargazers) [19
forks](/Napsty/check_smart/forks) [Branches](/Napsty/check_smart/branches) [Tags](/Napsty/check_smart/tags) [Activity](/Napsty/check_smart/activity)
 [Star](/login?return_to=%2FNapsty%2Fcheck_smart)

 [Notifications](/login?return_to=%2FNapsty%2Fcheck_smart) You must be signed in to change notification settings

* [Code](/Napsty/check_smart)
* [Issues
  7](/Napsty/check_smart/issues)
* [Pull requests
  1](/Napsty/check_smart/pulls)
* [Actions](/Napsty/check_smart/actions)
* [Projects
  0](/Napsty/check_smart/projects)
* [Wiki](/Napsty/check_smart/wiki)
* [Security](/Napsty/check_smart/security)
* [Insights](/Napsty/check_smart/pulse)

Additional navigation options

* [Code](/Napsty/check_smart)
* [Issues](/Napsty/check_smart/issues)
* [Pull requests](/Napsty/check_smart/pulls)
* [Actions](/Napsty/check_smart/actions)
* [Projects](/Napsty/check_smart/projects)
* [Wiki](/Napsty/check_smart/wiki)
* [Security](/Napsty/check_smart/security)
* [Insights](/Napsty/check_smart/pulse)

# Napsty/check\_smart

    master[Branches](/Napsty/check_smart/branches)[Tags](/Napsty/check_smart/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[145 Commits](/Napsty/check_smart/commits/master/) | | |
| [.github/workflows](/Napsty/check_smart/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/Napsty/check_smart/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [.travis.yml](/Napsty/check_smart/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/Napsty/check_smart/blob/master/.travis.yml ".travis.yml") |  |  |
| [COPYING.md](/Napsty/check_smart/blob/master/COPYING.md "COPYING.md") | | [COPYING.md](/Napsty/check_smart/blob/master/COPYING.md "COPYING.md") |  |  |
| [README.md](/Napsty/check_smart/blob/master/README.md "README.md") | | [README.md](/Napsty/check_smart/blob/master/README.md "README.md") |  |  |
| [SSD-TBW-Warranty.md](/Napsty/check_smart/blob/master/SSD-TBW-Warranty.md "SSD-TBW-Warranty.md") | | [SSD-TBW-Warranty.md](/Napsty/check_smart/blob/master/SSD-TBW-Warranty.md "SSD-TBW-Warranty.md") |  |  |
| [check\_smart.pl](/Napsty/check_smart/blob/master/check_smart.pl "check_smart.pl") | | [check\_smart.pl](/Napsty/check_smart/blob/master/check_smart.pl "check_smart.pl") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-3.0 license
# check\_smart monitoring plugin

## Full and up to date documentation

Please go to <https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php> for a complete and updated documentation including changelog, extensive usage examples, monitoring configurations (including Nagios, Icinga 1, Icinga 2, Shinken and Naemon).

## Introduction

This is a plugin to monitor the health and values of SMART attributes of hard (HDD), solid state (SSD) and NVMe drives. The plugin is a fork of check\_smart released in 2009 by Kurt Yoder. Since then the plugin has undergone a lot of changes. It allows to monitor drives behind hardware controllers and added a lot of parameters to fine tune the checks and set thresholds (on a per attribute setting).

## Sudoers entry

This plugin needs to run as root, otherwise you're not able to lauch smartctl correctly.
You have two options

1. Launch the plugin itself as root with sudo
2. Lauch the plugin as Nagios user and the smartctl command as root with sudo

Entry in sudoers (of course adapt your paths if necessary):

```
nagios   ALL = NOPASSWD: /usr/lib/nagios/plugins/check_smart.pl    # for option 1
nagios   ALL = NOPASSWD: /usr/local/sbin/smartctl                  # for option 2

```

## Successful tests/examples

SATA disk behind MDRaid (Software Raid) on Linux:

```
/usr/lib/nagios/plugins/check_smart.pl -d /dev/sda -i ata

```

MegaRAID on Linux:

```
/usr/lib/nagios/plugins/check_smart.pl -d /dev/sda -i megaraid,8

```

Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

```
/usr/local/libexec/nagios/check_smart.pl -d /dev/pass0 -i scsi

```

SATA drives behind Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

```
/usr/local/libexec/nagios/check_smart.pl -d /dev/pass12 -i sat

```

SCSI drives behind HP RAID (CCISS) on FreeBSD 6.0:

```
/usr/local/libexec/nagios/check_smart.pl -d /dev/ciss0 -i cciss,0
OK: no SMART errors detected|defect_list=0 sent_blocks=3093462752 temperature=24;;68

/usr/local/libexec/nagios/check_smart.pl -d /dev/ciss0 -i cciss,3
WARNING: 48 Elements in grown defect list | defect_list=48 sent_blocks=1137657348 temperature=22;;68

```

Using threshold option (-b) to ignore 1 bad element, warning only when 2 bad elements are found:

```
/usr/local/libexec/nagios/check_smart.pl -d /dev/ciss0 -i cciss,1 -b 2
OK: 1 Elements in grown defect list (but less than threshold 2)|defect_list=1;2;2;; sent_blocks=2769458900762624 temperature=27;;65

```

SCSI drives behind HP RAID (CCISS) on Linux (Ubuntu hardy):

```
/usr/lib/nagios/plugins/check_smart.pl -d /dev/cciss/c0d0 -i cciss,0
OK: no SMART errors detected. |

```

Check all SATA disks (sda - sdz) at the same time on Linux:

```
/usr/lib/nagios/plugins/check_smart.pl -g "/dev/sd[a-z]" -i ata
OK: [/dev/sda] - Device is clean --- [/dev/sdb] - Device is clean|

```

Check all SCSI disks behind Intel RAID on FreeBSD 9.2 ("kldload mfip.ko" required):

```
/usr/local/libexec/nagios/check_smart.pl -g /dev/pass[1-9] -i scsi
OK: [/dev/pass0] - Device is clean --- [/dev/pass1] - Device is clean --- [/dev/pass2] - Device is clean --- [/dev/pass3] - Device is clean --- [/dev/pass4] - Device is clean --- [/dev/pass5] - Device is clean --- [/dev/pass6] - Device is clean --- [/dev/pass7] - Device is clean --- [/dev/pass8] - Device is clean --- [/dev/pass9] - Device is clean |

```

Single SCSI drive on FreeBSD 10.1:

```
/usr/local/libexec/nagios/check_smart.pl -d /dev/da0 -i scsi
OK: no SMART errors detected. |sent_blocks=14067306 temperature=34;;60

```

Single NVMe drive on Linux:

```
/usr/lib/nagios/plugins/check_smart.pl -d /dev/nvme0 -i nvme
OK: Drive Samsung SSD 970 PRO 512GB S/N XXXXXXXXXXXXXXX: no SMART errors detected. |Temperature=34 Available_Spare=100 Available_Spare_Threshold=10 Percentage_Used=0 Data_Units_Read=2854 Data_Units_Written=107590 Host_Read_Commands=67150 Host_Write_Commands=1406316 Controller_Busy_Time=20 Power_Cycles=16 Power_On_Hours=105 Unsafe_Shutdowns=6 Media_and_Data_Integrity_Errors=0 Error_Information_Log_Entries=0 Warning__Comp._Temperature_Time=0 Critical_Comp._Temperature_Time=0 Temperature_Sensor_1=34 Temperature_Sensor_2=33

```

see <https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php> for more examples

## About

Monitoring Plugin to check hard drives, solid state drives and NVMe drives using SMART

[www.claudiokuenzler.com/monitoring-plugins/check\_smart.php](https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php "https://www.claudiokuenzler.com/monitoring-plugins/check_smart.php")

### Topics

[monitoring](/topics/monitoring "Topic: monitoring")
[disk](/topics/disk "Topic: disk")
[sas](/topics/sas "Topic: sas")
[drive](/topics/drive "Topic: drive")
[ssd](/topics/ssd "Topic: ssd")
[nagios-plugins](/topics/nagios-plugins "Topic: nagios-plugins")
[smart](/topics/smart "Topic: smart")
[nvme](/topics/nvme "Topic: nvme")
[sata](/topics/sata "Topic: sata")
[scsi](/topics/scsi "Topic: scsi")
[monitoring-plugins](/topics/monitoring-plugins "Topic: monitoring-plugins")
[harddrive](/topics/harddrive "Topic: harddrive")
[megaraid](/topics/megaraid "Topic: megaraid")
[cciss](/topics/cciss "Topic: cciss")
[intel-raid](/topics/intel-raid "Topic: intel-raid")
[monitoring-plugin](/topics/monitoring-plugin "Topic: monitoring-plugin")
[solid-state-disk](/topics/solid-state-disk "Topic: solid-state-disk")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-3.0 license](#GPL-3.0-1-ov-file)

[Activity](/Napsty/check_smart/activity)
### Stars

[**67**
stars](/Napsty/check_smart/stargazers)
### Watchers

[**10**
watching](/Napsty/check_smart/watchers)
### Forks

[**19**
forks](/Napsty/check_smart/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNapsty%2Fcheck_smart&report=Napsty+%28user%29)

## [Releases 28](/Napsty/check_smart/releases)

[6.14.3
Latest

Sep 10, 2024](/Napsty/check_smart/releases/tag/6.14.3)
[+ 27 releases](/Napsty/check_smart/releases)

## [Packages 0](/users/Napsty/packages?repo_name=check_smart)

No packages published

## [Contributors 13](/Napsty/check_smart/graphs/contributors)

## Languages

* [Perl
  100.0%](/Napsty/check_smart/search?l=perl)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


