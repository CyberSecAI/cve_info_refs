- **Root cause of vulnerability**: The Barracuda Network Access Client (NAC/VPN) for Windows uses the Windows Installer framework and caches an MSI file in `c:\windows\installer`. An unprivileged user can trigger a repair operation on this MSI file. This repair operation causes file operations in the user's %TEMP% folder, some of which are performed with SYSTEM privileges. This includes executing temporary files.
- **Weaknesses/vulnerabilities present**: The vulnerability is a local privilege escalation caused by insecure handling of temporary files during a repair operation. Specifically, the Windows Installer service, which runs as SYSTEM, executes temporary files in the user's %TEMP% directory.
- **Impact of exploitation**: A successful exploit allows a local unprivileged attacker to gain SYSTEM level privileges.
- **Attack vectors**: The attack vector is local. An attacker must have local access to the machine and be able to trigger a repair operation. This can be done using the Windows Installer API or by running `msiexec.exe /fa c:\windows\installer\[XXXXX].msi`.
- **Required attacker capabilities/position**: The attacker needs to have an authenticated local user account on the system where Barracuda Network Access Client is installed.