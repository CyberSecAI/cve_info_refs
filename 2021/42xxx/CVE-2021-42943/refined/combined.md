=== Content from devbrain.com.br_5ed25d52_20250114_222338.html ===


[![Paulo Hennig](https://devbrain.com.br/wp-content/uploads/2020/09/Screen-Shot-2020-09-14-at-12.00.06-140x140.png)](https://devbrain.com.br)

Paulo Hennig

Cyber Security Engineer

Cloud Security - AWS / Azure

Automation - Python / Shell Script

Code Review - Java / Javascript / PHP / Python

IaC - Cloudformation / Terraform

Red Team

Pentester

* [About](https://devbrain.com.br)
* [Resume](https://devbrain.com.br#resume)
* [Projects](https://devbrain.com.br#projects)
* [Content](https://devbrain.com.br#blog)

[![Paulo Hennig](https://devbrain.com.br/wp-content/uploads/2020/09/Screen-Shot-2020-09-14-at-12.00.06-140x140.png)](https://devbrain.com.br)

Paulo Hennig

Cyber Security Engineer

Cloud Security - AWS / Azure

Automation - Python / Shell Script

Code Review - Java / Javascript / PHP / Python

IaC - Cloudformation / Terraform

Red Team

Pentester

[Download CV](http://devbrain.com.br/cv.html)
[Contact Me](https://www.linkedin.com/in/paulo-hennig-94a67955/)

# Blog Post

# CVE-2021-42943

May 16, 2022
[Uncategorized](https://devbrain.com.br/index.php/category/uncategorized/) by [phennig](https://devbrain.com.br/index.php/author/phennig/)

Stored cross-site scripting (XSS) in admin/usermanager.php over IPPlan v4.92b allows remote attackers to inject arbitrary web script or HTML via the userid parameter

* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42943>
* <https://vuldb.com/?id.200027>

## Details

In a nutshell, given the lack of validations among certain input fields controlled by the user, we can only notice a “trim” for the userid parameter(`code:admin/usermanager.php -> administrator$userid=trim($userid);`) that’s also accepting strings in a form that should not be controlled by the user during an account creation:

![](https://devbrain.com.br/wp-content/uploads/2022/05/Pasted-image-20220516133042.png)

User creation

Given the way this data is stored in the database and rendered by the PHP application (i.e., directly from the DB), it makes possible to proceed with different set of injections such as the example below with our javascript injection, corresponding the CVE-2021-42943

![](https://devbrain.com.br/wp-content/uploads/2022/05/Pasted-image-20220516132945-1024x267.png)

DB data

![](https://devbrain.com.br/wp-content/uploads/2022/05/Pasted-image-20220516132804-1024x352.png)

Persistent XSS PoC

## Remediation

Although ipplan isn’t a brand new application, it seems we have different organizations relying on its functionalities as the information provided can be very useful in order to track the network segmentation across a given environment. If this is your scenario and you want to get rid of such vulnerabilities, ensure to avoid the user ID parameter of the UI and let the database control such information with the proper increment, having the primary keys and foreign keys accordingly which will require a few changes on the code and also in the database structure. Another option that can reduce the impact of such scenario is to use an INT data type for your column. Also, ensure to add the validation/sanitization such as the usage of htmlspecialchars() function within PHP in order to convert special characters to HTML entities correctly.

Share

##

[Next](https://devbrain.com.br/index.php/2022/05/24/impact-awareness-bounty-submission/)


