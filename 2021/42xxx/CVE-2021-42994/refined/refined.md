This document provides details about multiple vulnerabilities, including CVE-2021-42994, that were discovered in the Eltima SDK and products that utilize it for USB over Ethernet functionality.

**Root cause of vulnerability:**
The vulnerability stems from improper handling of user-controlled buffers within the driver's IOCTL handlers (specifically 0x22005B and 0x22001B) which use METHOD_NEITHER for data transfer. This means the driver is responsible for validating, probing, and mapping user-supplied buffers, however, it lacks proper checks and uses insecure arithmetic operations.

**Weaknesses/vulnerabilities present:**
*   **Integer overflow:** Insecure arithmetic operations are performed on user-controlled data when calculating the `memmove` size parameter, potentially leading to integer overflows. This occurs when the copy size is greater than allocated size or due to insecure calculations.
*   **Missing buffer validation:** The code lacks proper validation, probing, and locking of user-mode buffers passed via the `METHOD_NEITHER` I/O control code.
*   **Double fetch:** The vulnerability can be triggered by passing different parameters for the allocation and copy functions, and this leads to reading/writing of user-mode addresses without proper probing.
*   **Arbitrary pointer dereference:** The lack of buffer validation and insecure arithmetic can lead to arbitrary pointer dereference and memory corruption.

**Impact of exploitation:**
*   **Privilege escalation:** Successful exploitation can lead to local privilege escalation to kernel mode, allowing an attacker to run arbitrary code with SYSTEM privileges.
*   **Bypass security products:** Attackers can use these vulnerabilities to disable or bypass security software.
*   **System corruption:** Exploitation can lead to overwriting system components and corrupting the operating system.
*   **Remote code execution:** Due to the shared vulnerable code, both the client and server side of remote desktop solutions are vulnerable.
*   **Lateral movement:** Attackers can potentially use this vulnerability to move laterally within an organization's network.

**Attack vectors:**
*   **Local user:** Any user on the computer can exploit the vulnerability, even without administrative privileges.
*   **Sandboxed environments:** The vulnerability can be triggered from sandboxes due to the lack of ACL enforcements on the device.
*   **Second stage browser attack:** While modern browsers have a list of allowed IOCTLs requests, this attack could be used as a second stage browser attack.

**Required attacker capabilities/position:**
*   The attacker needs to be able to execute code on the target system.
*   No special privileges are required to trigger the vulnerability.

The document also mentions that the issue affects multiple vendors and products including AWS (Amazon WorkSpaces, Nimble Studio, NICE DCV), NoMachine, Accops, Eltima USB Network Gate, Amzetta, FlexiHub, and Donglify.
The vulnerable driver is `wspvuhub.sys` and `wspusbfilter.sys`
The document provides a proof of concept example to trigger the vulnerability using IOCTL 0x22001B with a crafted IRP.