- **Root cause of vulnerability:** The vulnerability lies in the way the NetBiblio WebOPAC software handles user-submitted search terms when querying external resources like Wikipedia. Specifically, the search term is reflected in the JavaScript response without proper sanitization, allowing for the injection of arbitrary code. The initial patch attempted to fix this by encoding the user input, but this was later changed to escaping single quotes, which could be bypassed by prepending a backslash.
- **Weaknesses/vulnerabilities present:** Reflected Cross-Site Scripting (XSS) vulnerability due to lack of proper input sanitization or encoding of user-supplied search terms before being reflected in the JavaScript response.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code within a victim's session by tricking them into clicking a specially crafted link. This can be used to perform malicious actions in the context of the NetBiblio WebOPAC, potentially leading to data theft, session hijacking, or other malicious activities.
- **Attack vectors:** The attack vector is through a crafted URL that includes a malicious JavaScript payload within the `searchTerm` parameter. The user needs to be tricked into clicking this link.
- **Required attacker capabilities/position:** The attacker needs to be able to craft a malicious URL and social engineer a user to click on it. No specific network position is required.