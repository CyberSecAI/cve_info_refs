- **Root cause of vulnerability**: Changes in the underlying functionality of the Google Cloud secrets engine in Vault 1.8.0 and above introduced roleset-specific endpoints, which when combined with permissive policies using globs (`*`), grants users with "read" permissions to the `/gcp/roleset/*` path the ability to issue Google Cloud service account credentials.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the overly permissive policy configuration that utilizes globs (`*`) in conjunction with the new roleset-specific endpoints in Vault's Google Cloud secrets engine. This allows users with read access to the roleset path to create service account credentials, which they should not be able to do.
- **Impact of exploitation**: A user with `read` permissions on the `/gcp/roleset/*` path can gain the ability to issue Google Cloud service account credentials, effectively elevating their privileges.
- **Attack vectors**: The attack vector involves leveraging the `read` permission on the `/gcp/roleset/*` path when using Vault's Google Cloud secrets engine with policies that include a glob (`*`).
- **Required attacker capabilities/position**: The attacker requires a valid Vault identity with at least `read` permission on the `/gcp/roleset/*` path. The vulnerability is specific to Vault versions 1.8.0 and later, using the Google Cloud secrets engine.