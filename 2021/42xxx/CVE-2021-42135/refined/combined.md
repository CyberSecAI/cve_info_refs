=== Content from discuss.hashicorp.com_10edbd79_20250115_091745.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-28 - Vault's Google Cloud Secrets Engine Policies With Globs May Provide Additional Privileges in Vault 1.8.0 Onwards](/t/hcsec-2021-28-vaults-google-cloud-secrets-engine-policies-with-globs-may-provide-additional-privileges-in-vault-1-8-0-onwards/30422)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

October 7, 2021, 8:55pm

1

**Bulletin ID:** HCSEC-2021-28

**Affected Products / Versions:** Vault and Vault Enterprise since 1.8.0.

**Publication Date:** October 7, 2021

**Summary**

The Google Cloud secrets engine in Vault or Vault Enterprise (“Vault”) 1.8.0 and above may provide users, under specific conditions, with more privileges than in prior versions. Due to changes in the underlying functionality of the Google Cloud secrets engine, policies that use globs (`*`) may provide more privileges in Vault versions 1.8.0 onwards. This possible configuration weakness has been assigned CVE-2021-42135.

**Background**

[Vault’s Google Cloud secrets engine](https://www.vaultproject.io/docs/secrets/gcp) allows Vault to interact with Google Cloud and create scoped credentials or service accounts on the cloud platform. [Vault’s policy syntax](https://www.vaultproject.io/docs/concepts/policies#policy-syntax) describes what actions a user can perform on a given path, and provides fine-grained access controls to help enforce the principle of least privilege to secrets stored in Vault.

**Details**

An external party reported that, starting with Vault 1.8.0, it was possible for permissive policies that use a glob (`*`) to grant them further permissions. The introduction of roleset-specific endpoints (noted in the 1.8.0 [changelog](https://github.com/hashicorp/vault/blob/main/CHANGELOG.md#180)) would allow a user with “read” permissions to the `/gcp/roleset/*` path to issue Google Cloud service account credentials.

If the Google Cloud secret engine policies do not contain a glob (`*`) or are otherwise sufficiently restrictive, the behavior remains unchanged.

**Remediation**

Vault’s Google Cloud secrets engine documentation has been updated to provide additional guidance regarding [roleset-related policy definition](https://www.vaultproject.io/docs/secrets/gcp#roleset-policy-considerations).

Vault operators using the Google Cloud secrets engine, particularly running Vault 1.8.0 and above, should review their Vault policies to ensure they meet their requirements and adhere to the principle of least privilege. They should specifically look for policy with endpoints and glob usage as noted above and consider moving to a wildcard.

**Acknowledgement**

This issue was identified by [mdgreenfield](https://github.com/mdgreenfield) who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-30 - Vault’s Google Cloud Secrets Engine Removed Existing IAM Conditions When Creating / Updating Rolesets](https://discuss.hashicorp.com/t/hcsec-2023-30-vault-s-google-cloud-secrets-engine-removed-existing-iam-conditions-when-creating-updating-rolesets/58654)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7801 | September 28, 2023 |
| [HCSEC-2020-09 - Vault's GCP Secrets Engine Service Account Keys Not Enforcing Configured TTL](https://discuss.hashicorp.com/t/hcsec-2020-09-vaults-gcp-secrets-engine-service-account-keys-not-enforcing-configured-ttl/18092)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4098 | November 25, 2020 |
| [HCSEC-2020-17 - Vault’s GCP Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-17-vault-s-gcp-auth-method-allows-authentication-bypass/18102)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4196 | November 25, 2020 |
| [Vault policy for GCP Secrets Engine](https://discuss.hashicorp.com/t/vault-policy-for-gcp-secrets-engine/37954)  [Vault](/c/vault/30) | 1 | 374 | April 4, 2022 |
| [HCSEC-2022-09 - Vault PKI Secrets Engine Policy Results In Incorrect Wildcard Certificate Issuance](https://discuss.hashicorp.com/t/hcsec-2022-09-vault-pki-secrets-engine-policy-results-in-incorrect-wildcard-certificate-issuance/36600)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7874 | March 4, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


