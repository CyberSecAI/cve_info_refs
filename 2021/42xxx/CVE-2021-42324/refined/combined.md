=== Content from exatel.pl_8ec163f4_20250114_202657.html ===

[![Exatel logotyp](https://exatel.pl/app/uploads/2020/09/logo.png "exatel logo")](https://exatel.pl/)

Szukaj:

EN

###### 22 340 66 60

bok@exatel.pl

* [O nas](https://exatel.pl/o-nas/)
  + [Aktualności](https://exatel.pl/o-nas/aktualnosci/)
  + [O EXATEL](https://exatel.pl/o-nas/)
  + [Realizacje](https://exatel.pl/realizacje/)
  + [Zarząd](https://exatel.pl/zarzad/)
  + [Dokumenty korporacyjne i handlowe](https://exatel.pl/dokumenty-korporacyjne-i-handlowe/)
  + [Zrównoważony Rozwój GK EXATEL](https://exatel.pl/zrownowazony-rozwoj-gk-exatel/)
* [Oferta](https://exatel.pl/uslugi/telekomunikacja/)
  + [Telekomunikacja](https://exatel.pl/uslugi/telekomunikacja/)
    - [SDN (Software Defined Network)](https://exatel.pl/uslugi/telekomunikacja/sdn/)
    - [Quality Internet – bezpieczny Internet dla firm](https://exatel.pl/uslugi/telekomunikacja/internet-dla-firm/)
    - Transmisja danych
      * [MPLS VPN](https://exatel.pl/uslugi/telekomunikacja/mpls-vpn/)
      * [Łącza dzierżawione / Wavelength](https://exatel.pl/uslugi/telekomunikacja/dzierzawa-laczy/)
      * [Low Latency – transmisja z najniższym opóźnieniem](https://exatel.pl/uslugi/telekomunikacja/low-latency/)
      * [Łączność satelitarna](https://exatel.pl/uslugi/teleport-satelitarny-exatel/)
    - Komunikacja
      * [Telefonia VOIP dla firm – VaaS (Voice as a Service)](https://exatel.pl/uslugi/telekomunikacja/voice-aas/)
      * [Telefonia VOIP dla firm – Telefonia IP](https://exatel.pl/uslugi/telekomunikacja/telefonia-ip/)
      * [Call Center / Contact Center](https://exatel.pl/uslugi/telekomunikacja/call-center/)
      * [Usługa One Number](https://exatel.pl/uslugi/telekomunikacja/usluga-one-number/)
      * [Infolinia dla firm](https://exatel.pl/uslugi/telekomunikacja/infolinia-dla-firm/)
      * [Zoom dla firm](https://exatel.pl/uslugi/telekomunikacja/zoom/)
  + [Cyberbezpieczeństwo](https://exatel.pl/uslugi/cyberbezpieczenstwo/)
    - [TAMA PRO7 – ochrona przed aplikacyjnymi atakami DDoS](https://exatel.pl/uslugi/cyberbezpieczenstwo/anty-ddos-tama-pro7/)
    - [Anty-DDoS TAMA – ochrona przed atakami DDoS](https://exatel.pl/uslugi/cyberbezpieczenstwo/anty-ddos-tama/)
    - [Security Operations Center](https://exatel.pl/uslugi/cyberbezpieczenstwo/soc/)
    - [Testy penetracyjne](https://exatel.pl/uslugi/cyberbezpieczenstwo/testy-penetracyjne-sieci/)
    - [Audyt bezpieczeństwa](https://exatel.pl/uslugi/cyberbezpieczenstwo/audyt-bezpieczenstwa-it/)
    - [Rekonesans bezpieczeństwa](https://exatel.pl/uslugi/cyberbezpieczenstwo/rekonesans-bezpieczenstwa/)
    - [Cyber EDUKACJA](https://exatel.pl/uslugi/cyberbezpieczenstwo/cyber-edukacja/)
    - [Kampanie phishingowe](https://exatel.pl/uslugi/cyberbezpieczenstwo/phishing/)
  + [Dla Operatorów](https://exatel.pl/uslugi/operatorzy/)
    - [Hurt SMS](https://exatel.pl/uslugi/telekomunikacja/hurt-sms/)
    - [Transmisja danych w technologii Ethernet](https://exatel.pl/uslugi/operatorzy/ethernet-2/)
    - [Dzierżawa łączy telekomunikacyjnych dla operatorów](https://exatel.pl/uslugi/operatorzy/dzierzawa-laczy/)
    - [Quality Internet](https://exatel.pl/uslugi/operatorzy/quality-internet-niezawodny-internet-dla-operatorow/)
    - [Internet Exchange Points – dostęp do peeringów EXATEL](https://exatel.pl/uslugi/operatorzy/internet-exchange-points/)
    - [Low Latency – transmisja z najniższym opóźnieniem](https://exatel.pl/uslugi/operatorzy/low-latency/)
    - [Transmisja danych w technologii Ethernet dla operatorów](https://exatel.pl/uslugi/operatorzy/ethernet/)
    - [Tranzyt IP – dostęp do Internetu z BGP](https://exatel.pl/uslugi/operatorzy/tranzyt-ip/)
    - [Multiport EXATEL](https://exatel.pl/uslugi/operatorzy/multiport-exatel/)
    - [Hurt głosu](https://exatel.pl/uslugi/operatorzy/hurt-glosu/)
  + [ICT](https://exatel.pl/uslugi/ict/)
    - [Private 5G Connectivity](https://exatel.pl/uslugi/ict/private-5g-connectivity/)
    - [Budowa infrastruktury](https://exatel.pl/uslugi/ict/budowa-infrastruktury/)
    - [Utrzymanie infrastruktury od EXATEL](https://exatel.pl/uslugi/ict/utrzymanie-infrastruktury-od-exatel/)
    - [Cloud Connect](https://exatel.pl/uslugi/ict/cloud-connect/)
    - [Kolokacja – Data Center](https://exatel.pl/uslugi/ict/kolokacja/)
    - [Zarządzany Firewall / UTM](https://exatel.pl/uslugi/ict/utm/)
    - [EXATEL WLAN](https://exatel.pl/uslugi/ict/exatel-wlan/)
  + [Łączność satelitarna](https://exatel.pl/uslugi/teleport-satelitarny-exatel/)
  + [EDIH](https://exatel.pl/edih/)
* [Wiedza i blogi](https://exatel.pl/wiedza/materialy/)
  + [Materiały](https://exatel.pl/wiedza/materialy/)
  + [FAQ](https://exatel.pl/wiedza/faq/)
    - [Biznes](/wiedza/faq/#biznes)
    - [Cyberbezpieczeństwo](/wiedza/faq/#cyberbezpieczenstwo)
    - [ICT](/wiedza/faq/#ict)
    - [Inne](/wiedza/faq/#inne)
    - [Operatorzy głosowi](/wiedza/faq/#operatorzy-glosowi)
    - [SDN](/wiedza/faq/#sdn)
    - [Sektor publiczny](/wiedza/faq/#sektor-publiczny)
    - [TAMA](/wiedza/faq/#tama)
    - [Telekomunikacja](/wiedza/faq/#telekomunikacja)
  + [Słowniczek](https://exatel.pl/wiedza/slowniczek/)
* [Badania i rozwój](https://exatel.pl/badania-i-rozwoj/)
* [Klub Bezpieczny Samorząd](https://exatel.pl/klub-bezpieczny-samorzad-exatel/)
* [Kariera](https://exatel.pl/kariera/oferty-pracy/)
  + [Oferty pracy](https://exatel.pl/kariera/oferty-pracy/)
  + [Ludzie EXATEL](https://exatel.pl/kariera/ludzie/)
  + [Praca w EXATEL](https://exatel.pl/kariera/praca-w-exatel/)
    - [EXATEL same korzyści](https://exatel.pl/kariera/praca-w-exatel/#korzysci)
    - [Czym się zajmujemy](https://exatel.pl/kariera/praca-w-exatel/#o-exatel)
    - [Cyberbezpieczeństwo](https://exatel.pl/kariera/praca-w-exatel/#cyberbezpieczenstwo)
    - [Rozwój oprogramowania](https://exatel.pl/kariera/praca-w-exatel/#rozwoj-oprogramowania)
    - [Architektura i planowanie sieci](https://exatel.pl/kariera/praca-w-exatel/#architektura)
    - [Biuro Zarządzania Siecią](https://exatel.pl/kariera/praca-w-exatel/#BSS)
    - [Utrzymanie i Rozwój Infrastruktury](https://exatel.pl/kariera/praca-w-exatel/#utrzymanie)
  + [Rekrutacja](https://exatel.pl/kariera/rekrutacja/)
  + [Benefity](https://exatel.pl/kariera/benefity/)
* [Kontakt](https://exatel.pl/kontakt/)

* [Program partnerski](https://exatel.pl/partnerzy/)

[![EXATEL](https://exatel.pl/app/themes/exatel/assets/images/logo-exatel.png)](https://exatel.pl)

* [](https://www.facebook.com/ExatelPL)
* [](https://twitter.com/exatel_pl)
* [](https://www.youtube.com/channel/UC-Fiagc5U4UR_lBqJRnUHvw)
* [](https://www.linkedin.com/company/exatel/)

Szukaj

* [EN](/en/)

[![bip logo](https://exatel.pl/app/themes/exatel/assets/images/Logo_BIP_uproszczone.svg)](https://exatel.pl/bip/)

* 

Szukaj

* [EN](/en/)

[![bip logo](https://exatel.pl/app/themes/exatel/assets/images/Logo_BIP_uproszczone.svg)](https://exatel.pl/bip/)

*  22 340 66 60
*  bok@exatel.pl

Szukaj

* [EN](/en/)

[![bip logo](https://exatel.pl/app/themes/exatel/assets/images/Logo_BIP_uproszczone.svg)](https://exatel.pl/bip/)

22 340 66 60
22 340 66 60
bok@exatel.pl

* [O nas](https://exatel.pl/o-nas/)
  + [Aktualności](https://exatel.pl/o-nas/aktualnosci/)
  + [O EXATEL](https://exatel.pl/o-nas/)
  + [Realizacje](https://exatel.pl/realizacje/)
  + [Zarząd](https://exatel.pl/zarzad/)
  + [Dokumenty korporacyjne i handlowe](https://exatel.pl/dokumenty-korporacyjne-i-handlowe/)
  + [Zrównoważony Rozwój GK EXATEL](https://exatel.pl/zrownowazony-rozwoj-gk-exatel/)
* [Oferta](https://exatel.pl/uslugi/telekomunikacja/)
  + [Telekomunikacja](https://exatel.pl/uslugi/telekomunikacja/)
    - [SDN (Software Defined Network)](https://exatel.pl/uslugi/telekomunikacja/sdn/)
    - [Quality Internet – bezpieczny Internet dla firm](https://exatel.pl/uslugi/telekomunikacja/internet-dla-firm/)
    - Transmisja danych
      * [MPLS VPN](https://exatel.pl/uslugi/telekomunikacja/mpls-vpn/)
      * [Łącza dzierżawione / Wavelength](https://exatel.pl/uslugi/telekomunikacja/dzierzawa-laczy/)
      * [Low Latency – transmisja z najniższym opóźnieniem](https://exatel.pl/uslugi/telekomunikacja/low-latency/)
      * [Łączność satelitarna](https://exatel.pl/uslugi/teleport-satelitarny-exatel/)
    - Komunikacja
      * [Telefonia VOIP dla firm – VaaS (Voice as a Service)](https://exatel.pl/uslugi/telekomunikacja/voice-aas/)
      * [Telefonia VOIP dla firm – Telefonia IP](https://exatel.pl/uslugi/telekomunikacja/telefonia-ip/)
      * [Call Center / Contact Center](https://exatel.pl/uslugi/telekomunikacja/call-center/)
      * [Usługa One Number](https://exatel.pl/uslugi/telekomunikacja/usluga-one-number/)
      * [Infolinia dla firm](https://exatel.pl/uslugi/telekomunikacja/infolinia-dla-firm/)
      * [Zoom dla firm](https://exatel.pl/uslugi/telekomunikacja/zoom/)
  + [Cyberbezpieczeństwo](https://exatel.pl/uslugi/cyberbezpieczenstwo/)
    - [TAMA PRO7 – ochrona przed aplikacyjnymi atakami DDoS](https://exatel.pl/uslugi/cyberbezpieczenstwo/anty-ddos-tama-pro7/)
    - [Anty-DDoS TAMA – ochrona przed atakami DDoS](https://exatel.pl/uslugi/cyberbezpieczenstwo/anty-ddos-tama/)
    - [Security Operations Center](https://exatel.pl/uslugi/cyberbezpieczenstwo/soc/)
    - [Testy penetracyjne](https://exatel.pl/uslugi/cyberbezpieczenstwo/testy-penetracyjne-sieci/)
    - [Audyt bezpieczeństwa](https://exatel.pl/uslugi/cyberbezpieczenstwo/audyt-bezpieczenstwa-it/)
    - [Rekonesans bezpieczeństwa](https://exatel.pl/uslugi/cyberbezpieczenstwo/rekonesans-bezpieczenstwa/)
    - [Cyber EDUKACJA](https://exatel.pl/uslugi/cyberbezpieczenstwo/cyber-edukacja/)
    - [Kampanie phishingowe](https://exatel.pl/uslugi/cyberbezpieczenstwo/phishing/)
  + [Dla Operatorów](https://exatel.pl/uslugi/operatorzy/)
    - [Hurt SMS](https://exatel.pl/uslugi/telekomunikacja/hurt-sms/)
    - [Transmisja danych w technologii Ethernet](https://exatel.pl/uslugi/operatorzy/ethernet-2/)
    - [Dzierżawa łączy telekomunikacyjnych dla operatorów](https://exatel.pl/uslugi/operatorzy/dzierzawa-laczy/)
    - [Quality Internet](https://exatel.pl/uslugi/operatorzy/quality-internet-niezawodny-internet-dla-operatorow/)
    - [Internet Exchange Points – dostęp do peeringów EXATEL](https://exatel.pl/uslugi/operatorzy/internet-exchange-points/)
    - [Low Latency – transmisja z najniższym opóźnieniem](https://exatel.pl/uslugi/operatorzy/low-latency/)
    - [Transmisja danych w technologii Ethernet dla operatorów](https://exatel.pl/uslugi/operatorzy/ethernet/)
    - [Tranzyt IP – dostęp do Internetu z BGP](https://exatel.pl/uslugi/operatorzy/tranzyt-ip/)
    - [Multiport EXATEL](https://exatel.pl/uslugi/operatorzy/multiport-exatel/)
    - [Hurt głosu](https://exatel.pl/uslugi/operatorzy/hurt-glosu/)
  + [ICT](https://exatel.pl/uslugi/ict/)
    - [Private 5G Connectivity](https://exatel.pl/uslugi/ict/private-5g-connectivity/)
    - [Budowa infrastruktury](https://exatel.pl/uslugi/ict/budowa-infrastruktury/)
    - [Utrzymanie infrastruktury od EXATEL](https://exatel.pl/uslugi/ict/utrzymanie-infrastruktury-od-exatel/)
    - [Cloud Connect](https://exatel.pl/uslugi/ict/cloud-connect/)
    - [Kolokacja – Data Center](https://exatel.pl/uslugi/ict/kolokacja/)
    - [Zarządzany Firewall / UTM](https://exatel.pl/uslugi/ict/utm/)
    - [EXATEL WLAN](https://exatel.pl/uslugi/ict/exatel-wlan/)
  + [Łączność satelitarna](https://exatel.pl/uslugi/teleport-satelitarny-exatel/)
  + [EDIH](https://exatel.pl/edih/)
* [Wiedza i blogi](https://exatel.pl/wiedza/materialy/)
  + [Materiały](https://exatel.pl/wiedza/materialy/)
  + [FAQ](https://exatel.pl/wiedza/faq/)
    - [Biznes](/wiedza/faq/#biznes)
    - [Cyberbezpieczeństwo](/wiedza/faq/#cyberbezpieczenstwo)
    - [ICT](/wiedza/faq/#ict)
    - [Inne](/wiedza/faq/#inne)
    - [Operatorzy głosowi](/wiedza/faq/#operatorzy-glosowi)
    - [SDN](/wiedza/faq/#sdn)
    - [Sektor publiczny](/wiedza/faq/#sektor-publiczny)
    - [TAMA](/wiedza/faq/#tama)
    - [Telekomunikacja](/wiedza/faq/#telekomunikacja)
  + [Słowniczek](https://exatel.pl/wiedza/slowniczek/)
* [Badania i rozwój](https://exatel.pl/badania-i-rozwoj/)
* [Klub Bezpieczny Samorząd](https://exatel.pl/klub-bezpieczny-samorzad-exatel/)
* [Kariera](https://exatel.pl/kariera/oferty-pracy/)
  + [Oferty pracy](https://exatel.pl/kariera/oferty-pracy/)
  + [Ludzie EXATEL](https://exatel.pl/kariera/ludzie/)
  + [Praca w EXATEL](https://exatel.pl/kariera/praca-w-exatel/)
    - [EXATEL same korzyści](https://exatel.pl/kariera/praca-w-exatel/#korzysci)
    - [Czym się zajmujemy](https://exatel.pl/kariera/praca-w-exatel/#o-exatel)
    - [Cyberbezpieczeństwo](https://exatel.pl/kariera/praca-w-exatel/#cyberbezpieczenstwo)
    - [Rozwój oprogramowania](https://exatel.pl/kariera/praca-w-exatel/#rozwoj-oprogramowania)
    - [Architektura i planowanie sieci](https://exatel.pl/kariera/praca-w-exatel/#architektura)
    - [Biuro Zarządzania Siecią](https://exatel.pl/kariera/praca-w-exatel/#BSS)
    - [Utrzymanie i Rozwój Infrastruktury](https://exatel.pl/kariera/praca-w-exatel/#utrzymanie)
  + [Rekrutacja](https://exatel.pl/kariera/rekrutacja/)
  + [Benefity](https://exatel.pl/kariera/benefity/)
* [Kontakt](https://exatel.pl/kontakt/)

 Stefan Żaryn Starszy Inżynier ds. Bezpieczeństwa Ofensywnego EXATEL

# (CVE-2021-42324) Metacharacter Injection **w przełącznikach DCN S4600-10P-SI**

9 Lutego 2022

Udostępnij
[ Facebook](https://www.facebook.com/sharer.php?u=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
[ Twitter](https://x.com/share?url=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
[ LinkedIn](https://www.linkedin.com/shareArticle?url=?url=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
 Kopiuj link

## Krótki opis podatności

**Podczas wykonywania testów penetracyjnych natrafiłem na ciekawą  [podatność](https://exatel.pl/uslugi/cyberbezpieczenstwo/) w jednym z urządzeń  firmy DCN. Firmware przełączników DCN S4600-10P-SI w wersjach między R0241.0370, a R0241.0470, był podatny na atak Metacharacter Injection, umożliwiając na ucieczkę z przygotowanego przez producenta sandboxa, i w efekcie wykonywanie komend z uprawnieniami *root* bezpośrednio na systemie operacyjnym urządzenia. Podatna funkcjonalność związana z nagrywaniem ruchu sieciowego narzędziem *tcpdump* nie waliduje otrzymanych danych, a następnie przekazuje je bezpośrednio do powłoki systemowej.**

**Do wykorzystania podatności atakujący musi mieć dostęp do powłoki systemowej urządzenia. Podatność może zostać wykorzystana nawet przez użytkowników o najniższych uprawnieniach.**

## Metacharacter Injection

Metaznaki to znaki, które są specjalnie interpretowane przez daną powłokę. Różne powłoki mają różne zbiory metaznaków, jednak w tym artykule skupię się na powłoce *sh* ([Bourne shell](https://en.wikipedia.org/wiki/Bourne_shell)) i podatności OS Command Injection.

Metaznaki dostępne w powłoce sh:

| Znak | Funkcja |  |
| --- | --- | --- |
| > | Przekierowanie strumienia wyjściowego |  |
| >> | Przekierowanie strumienia wyjściowego (tryb append) |  |
| < | Przekierowanie strumienia wejściowego |  |
| \* | Znak wildcard; zero lub więcej znaków |  |
| ? | Znak wildcard; jeden znak |  |
| [ ] | Znak wildcard; dowolny znak znajdujący się w nawiasach (np. [abc]) |  |
| `cmd` | Command Substitution; wykonywana jest komenda między znakami „ |  |
| $(cmd) | Command Substitution; wykonywana jest komenda między znakami () |  |
| | | Pipe; służy do przekierowania wyjścia z jednej komendy do drugiej |  |
| ; | Znak końca komendy |  |
| || | Operator logcziny OR |  |
| && | Operator logiczny AND |  |
| ( ) | Grupuje komendy |  |
| & | Uruchamia daną komendę w tle |  |
| # | Komentarz |  |
| $ | Pobiera wartość danej zmiennej |  |
| \ | Znak ucieczki |  |

Typ ataku Metacharacter Injection polega na “wstrzyknięciu” tych znaków do wykonywanej komendy, w taki sposób aby doprowadzić do niezamierzonego zachowania ze strony podatnej aplikacji.

Przykładem występowania takiej podatności może być następujący skrypt PHP  <?php system(„echo ” . $\_REQUEST[„string”]); ?>

![](https://exatel.pl/app/uploads/2022/02/Foto_1.png)

Skrypt oczekuje przesłania zmiennej o nazwie *string*, a następnie dokleja zawartość tej zmiennej do polecenia *echo*, które jest wykonywane jako komenda systemowa. Przez dodanie metaznaku “;” (średnik), atakujący jest w stanie zakończyć wykonywaną komendę *echo*, a następnie wykonać własne komendy (w tym przypadku komenda *id*). Po przesłaniu stringu *test;id*, całość wykonywanej komendy będzie wyglądać:

echo test;id

Jest to jeden z najprostszych przykładów występowania podatności Metacharacter / OS Command Injection i stanowi bazę do wykorzystania podatności występującej w urządzeniach DCN S4600-10P-SI.

Przykłady użycia innych metaznaków

* „ (backticks)

  ![](https://exatel.pl/app/uploads/2022/02/Foto_2.png)
* && (operator logiczny AND)

  ![](https://exatel.pl/app/uploads/2022/02/Foto_3.png)
* $()

  ![](https://exatel.pl/app/uploads/2022/02/Foto_4.png)

## Podatność w kodzie

Przełącznik udostępnia funkcjonalność nagrywania ruchu sieciowego komendą *capture*. Komenda ta jest dostępna dla wszystkich użytkowników urządzenia, niezależnie od ich poziomu uprawnień.

![](https://exatel.pl/app/uploads/2022/02/Foto_5.png)

“Pod maską” komenda *capture* uruchamia program *tcpdump*, dołączając do niego argumenty podane przez użytkownika.

Zmienne podane przez użytkownika nie są walidowane przed doklejeniem ich do komend systemowych używanych do zbudowania skryptu uruchamiającego program *tcpdump*. Dzięki temu możliwe jest doklejenie swoich komend do tych, które są wykonywane przez program. Poniżej zaprezentowany jest wycinek kodu podatnej funkcji *imi\_shell\_execute\_tcpdump\_command\_Local* wraz z krótkim opisem.

![](https://exatel.pl/app/uploads/2022/02/Foto_6.png)

Analizując powyższy wycinek funkcji można zauważyć, w jaki sposób budowany jest skrypt uruchamiający program *tcpdump.*

Zmienna *tcpdump\_command* przechowuje ścieżkę wywołania i argumenty programu *tcpdump*. W trakcie działania programu doklejana jest do niej ścieżka do pliku podanego przez użytkownika. W efekcie, wykonywane polecenie pod koniec działania funkcji wygląda następująco:

tcpdump <argumenty> -w <ścieżka do zapisu pliku>

W momencie kiedy użytkownik do ścieżki pliku doda metaznaki (np. średnik) polecenie przyjmie taką formę

tcpdump <argumenty> -w <ścieżka do zapisu pliku>;<komenda>

co daje możliwość wykonania komend na systemie.

Dalsze iteracje podatności w różnych wersjach oprogramowania działają na tej samej zasadzie, różniąc się jedynie sposobem wykonania komend przez użycie różnych metaznaków lub mechanizmów powłoki systemowej.

## Kolejne wersje oprogramowania

### R0241.0370

Podatność pierwszy raz została zauważona w tej wersji oprogramowania, w parametrze *file*. Aby wykonać komendy na systemie należało wstawić średnik, a następnie skorzystać z mechanizmu ‘[command substitution](https://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html)’.

Dodatkowo, przez dodanie cudzysłowów możliwe było wstawienie znaku spacji, który normalnie był traktowany jako separator parametrów. Prawidłowo skonstruowany payload wyglądał zatem tak:

capture match icmp count 1 file ‘o;”$(<command>)”’

Przykład wykonania komendy ls -l /

![](https://exatel.pl/app/uploads/2022/02/Foto_7.png)

Widok na interfejsie Serial

![](https://exatel.pl/app/uploads/2022/02/Foto_8.png)

### R0241.0439

Parametr *file* nadal jest podatny na wstrzyknięcie metaznaków, jednak tym razem użycie znaku cudzysłowu jest zabronione. Znak ten jest potrzebny do wstawienia spacji do komendy. Aby to obejść można wykorzystać kodowanie heksadecymalne znaku spacji, a następnie rozwiązanie go do pełnoprawnej spacji.

Przykład wyłączenia procesu sterującego i otrzymanie powłoki systemowej na interfejsie Serial

![](https://exatel.pl/app/uploads/2022/02/Foto_9.png)

Wynik na interfejsie Serial, razem z wykonaniem komendy id

![](https://exatel.pl/app/uploads/2022/02/Foto_10.png)

Wykonanie tak zapisanej komendy jest możliwe dzięki właściwościom powłoki systemowej obecnej na urządzeniu.

;privesc=pkill$’\x20’nos;$privesc;

Pierwsza część payloadu przypisuje wartość *pkill$’\x20’nos* do zmiennej *privesc.* Druga część wykonuje polecenie, które znajduje się tej zmiennej. Dzięki właściwościom powłoki systemowej, ciąg znaków *pkill$’\x20’nos* rozwiązuje się do *pkill nos*, co jest poprawnym poleceniem systemowym, które zostaje następnie wykonane.

### R0241.0445

W kolejnej wersji firmware, podatność została załatana w parametrze *file.* W trakcie testów okazało się jednak, że pozostałe parametry komendy *capture* są nadal podatne na ten sam wektor ataku, co widać na przykładzie parametru *source-port*.

Dodatkowo, przy próbie mitygacji, uniemożliwiono korzystanie z funkcjonalności przy domyślnych parametrach. W nowej wersji firmware, niemożliwe było wstawienie znaków specjalnych do nazwy pliku. Wśród tych znaków był też znak kropki (”.”). Domyślna wartość nazwy pliku, tj. ta, która zostaje użyta jeśli użytkownik nie poda swojej własnej, to *default.pcap*. Po wgraniu poprawki, w momencie gdy program otrzymywał taką nazwę zwracał błąd o złej nazwie pliku, mimo że użytkownik nie podał żadnej. Aby skorzystać z podatności, należy podać nazwę pliku, która nie będzie zawierać znaków specjalnych.

Błąd wyświetlany przy użyciu domyślnej nazwy pliku

![](https://exatel.pl/app/uploads/2022/02/Foto_11.png)

Przykład wykonania komendy ls -la

![](https://exatel.pl/app/uploads/2022/02/Foto_12.png)

Widok na interfejsie Serial

![](https://exatel.pl/app/uploads/2022/02/Foto_13.png)

### R0241.0453

W tej wersji firmware, poprzednie metody wykonywania komend nie działają w taki sam sposób. Parametry *source-port* oraz *destination-port* nadal są podatne, jednak metoda z dopisaniem średnika różni się w działaniu. Sposobem na obejście tego jest użycie znaku ampersand (”&”). Umożliwia to na natychmiastowe wykonanie komendy.

Przykład wykonania komendy ls -la

![](https://exatel.pl/app/uploads/2022/02/Foto_14.png)

Widok na interfejsie Serial

![](https://exatel.pl/app/uploads/2022/02/Foto_15.png)

Metoda ze średnikiem cały czas działa, jednak w trochę zmieniony sposób. Wydane polecenie wykonuje się dopiero w momencie, kiedy użytkownik zatrzyma wszystkie procesy nagrywania ruchu sieciowego komendą *capture packet force stop*.

Przykład wykonania komendy ls -la

![](https://exatel.pl/app/uploads/2022/02/Foto_16.png)

Widok na interfejsie Serial

![](https://exatel.pl/app/uploads/2022/02/Foto_17.png)

### R0241.0470

W tej wersji producent firmware podszedł do problemu globalnie, dla każdego parametru. W trakcie testów nie udało mi się obejść [zabezpieczeń](https://exatel.pl/uslugi/cyberbezpieczenstwo/) wprowadzonych w nowej wersji. Należy pamiętać jednak, że możliwe jest zrobienie tzw. downgrade firmware’u do niższych wersji gdzie podatność nadal istnieje.

## Podsumowanie

Proces naprawienia podatności zajął w sumie około 6 miesięcy i aż cztery nowe wersje firmware. W trakcie prób naprawy producent skupił się wyłącznie na payloadach wskazanych w zgłoszeniu, co skutecznie uniemożliwiło wykonanie tego samego ataku dwukrotnie, ale nie rozwiązywało istniejącego problemu. Dopiero w ostatniej opisywanej wersji firmware, podatność została załatana przez poprawną walidację wszystkich parametrów.

## Timeline

* 06.04.2021 – Zgłoszenie podatności do producenta
* 05.2021 – Wydanie wersji R0241.0349
* 28.05.2021 – Zgłoszenie podatności w wersji R0241.0349
* 06.2021 – Wydanie wersji R0241.0445
* 23.06.2021 – Zgłoszenie podatności w wersji R0241.0445
* 07.2021 – Wydanie wersji R0241.0453
* 24.08.2021 – Zgłoszenie podatności w wersji R0241.0453
* 09.2021 – Wydanie wersji R0241.0470 z poprawioną podatnością
* 12.10.2021 – Zgłoszenie CVE

 Stefan Żaryn Starszy Inżynier ds. Bezpieczeństwa Ofensywnego EXATEL

Opublikowane przez: Piotr Mierzwiński

Udostępnij
[ Facebook](https://www.facebook.com/sharer.php?u=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
[ Twitter](https://x.com/share?url=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
[ LinkedIn](https://www.linkedin.com/shareArticle?url=?url=https://exatel.pl/wiedza/materialy/artykuly/cve-2021-42324-metacharacter-injection-w-przelacznikach-dcn-s4600-10p-si/)
 Kopiuj link

Wróć

## Inne **artykuły\_**

18 Października 2024

[![](https://exatel.pl/app/uploads/2024/10/1200-627-komputer.jpg)
Artykuł](https://exatel.pl/wiedza/materialy/artykuly/niewidzialne-zagrozenia-bezpieczenstwo-w-cieniu-security-blind-spots/)
## [Niewidzialne zagrożenia: bezpieczeństwo w cieniu „security blind spots...](https://exatel.pl/wiedza/materialy/artykuly/niewidzialne-zagrozenia-bezpieczenstwo-w-cieniu-security-blind-spots/ "Niewidzialne zagrożenia: bezpieczeństwo w cieniu „security blind spots”")

20 Marca 2024

[![](https://exatel.pl/app/uploads/2024/03/1200-627-kod-QR.jpg)
Artykuł](https://exatel.pl/wiedza/materialy/artykuly/skanuj-bezpiecznie-czyli-o-kodach-qr-ich-wykorzystaniu-i-cyberbezpieczenstwie-slow-kilka/)
## [Skanuj bezpiecznie! Czyli o kodach QR, ich wykorzystaniu i cyberbezpieczeństwie...](https://exatel.pl/wiedza/materialy/artykuly/skanuj-bezpiecznie-czyli-o-kodach-qr-ich-wykorzystaniu-i-cyberbezpieczenstwie-slow-kilka/ "Skanuj bezpiecznie! Czyli o kodach QR, ich wykorzystaniu i cyberbezpieczeństwie słów kilka")

W obecnym świecie, w którym mobilność i wygoda są kluczowymi aspektami, kody QR (z ang. Quick Response) stały się nieodł...

26 Stycznia 2024

[![](https://exatel.pl/app/uploads/2023/08/1200-627-paszportyzacja-2.jpg)
Artykuł](https://exatel.pl/wiedza/materialy/artykuly/jak-wygladaja-ataki-ddos-na-przykladzie-romeo-i-julia/)
## [Jak wyglądają ataki DDoS na przykładzie „Romea i Julii”](https://exatel.pl/wiedza/materialy/artykuly/jak-wygladaja-ataki-ddos-na-przykladzie-romeo-i-julia/ "Jak wyglądają ataki DDoS na przykładzie „Romea i Julii”")

Cześć! Jak spędziłeś ostatni dzień? Słuchałeś muzyki online? Być może oglądałeś jakieś filmy lub seriale? Wielu ludzi mu...

![Exatel logotyp](https://exatel.pl/app/uploads/2020/09/logo.png "exatel logo")

[Nadzór właścicielski](/nadzor-wlascicielski "Nadzór właścicielski")
[Materiały korporacyjne](/materialy-korporacyjne "Materiały korporacyjne")
[Deklaracja dostępności](/deklaracja-dostepnosci "Deklaracja dostępności")

[Kariera](/kariera/oferty-pracy/ "Kariera")

[Polityka prywatności](/polityka-prywatnosci "Polityka prywatności")

[Kontakt](/kontakt "Kontakt")

**EXATEL SA**
 ul. Perkuna 47
 04-164 Warszawa
 bok@exatel.pl

22 340 66 60

* [Obserwuj](https://pl-pl.facebook.com/ExatelPL "Śledź na Facebook")
* [Obserwuj](https://twitter.com/exatel_pl "Śledź na ")
* [Obserwuj](https://www.youtube.com/channel/UC-Fiagc5U4UR_lBqJRnUHvw "Śledź na Youtube")
* [Obserwuj](https://pl.linkedin.com/company/exatel "Śledź na LinkedIn")

[![Exatel logotyp](https://exatel.pl/app/uploads/2020/09/logo.png "exatel logo")](http://exatel.pl)

[Dokumenty korporacyjne i handlowe](/dokumenty-korporacyjne-i-handlowe/ "Dokumenty korporacyjne i handlowe")
[Deklaracja dostępności](/deklaracja-dostepnosci "Deklaracja dostępności")
[Zgłoś nieprawidłowość](https://exatel.pl/zglos-nieprawidlowosc/)

[Kariera](/kariera/oferty-pracy/ "Kariera")

[Polityka prywatności](/polityka-prywatnosci "Polityka prywatności")

[Kontakt](/kontakt "Kontakt")

**EXATEL SA**
 ul. Perkuna 47
 04-164 Warszawa
 bok@exatel.pl

22 340 66 60

* [Obserwuj](https://pl-pl.facebook.com/ExatelPL "Śledź na Facebook")
* [Obserwuj](https://twitter.com/exatel_pl "Śledź na ")
* [Obserwuj](https://www.youtube.com/channel/UC-Fiagc5U4UR_lBqJRnUHvw "Śledź na Youtube")
* [Obserwuj](https://pl.linkedin.com/company/exatel "Śledź na LinkedIn")

Wszystkie prawa zastrzeżone przez EXATEL S.A. z siedzibą w Warszawie, ul. Perkuna 47, 04-164 Warszawa, spółka wpisana do rejestru przedsiębiorców w Sądzie Rejonowym dla m. st. Warszawy, XIV Wydział Gospodarczy, pod numerem KRS: 0000044577, kapitał zakładowy: 576 854 559 PLN, kapitał opłacony w całości, NIP: 527-010-45-68, BDO: 000250055.

## Bądź **na bieżąco\_**

**Error:** Contact form not found.

Ta strona wykorzystuje pliki cookie. Używamy informacji zapisanych za pomocą plików cookies w celu zapewnienia maksymalnej wygody w korzystaniu z naszego serwisu.

Więcej informacji znajdziesz w dokumencie [Polityka Prywatności.](https://exatel.pl/polityka-prywatnosci/)

Ustawienia zaawansowane
Zaakceptuj wszystkie

##### Ustawienia zaawansowane

Ta strona wykorzystuje pliki cookie. Używamy informacji zapisanych za pomocą plików cookies w celu zapewnienia maksymalnej wygody w korzystaniu z naszego serwisu.

Więcej informacji znajdziesz w dokumencie [Polityka Prywatności](https://exatel.pl/polityka-prywatnosci/).

**Niezbędne**Te pliki cookie są niezbędne dla funkcjonowania strony internetowej i nie mogą być wyłączone w naszych systemach. Są one zazwyczaj ustawiane tylko w odpowiedzi na działania podejmowane przez użytkownika, które sprowadzają się do zapytania o usługi, takie jak ustawienie preferencji prywatności, logowanie lub wypełnianie formularzy. Można ustawić przeglądarkę tak, aby blokowała lub ostrzegała o tych plikach cookie, ale niektóre części witryny nie będą wtedy działały. Te pliki cookie nie przechowują żadnych danych osobowych.

**Funkcjonalne**Te pliki cookie są niezbędne dla funkcjonowania strony internetowej i nie mogą być wyłączone w naszych systemach. Są one zazwyczaj ustawiane tylko w odpowiedzi na działania podejmowane przez użytkownika, które sprowadzają się do zapytania o usługi, takie jak ustawienie preferencji prywatności, logowanie lub wypełnianie formularzy. Można ustawić przeglądarkę tak, aby blokowała lub ostrzegała o tych plikach cookie, ale niektóre części witryny nie będą wtedy działały. Te pliki cookie nie przechowują żadnych danych osobowych.

**Statystyczne**Te pliki cookie są niezbędne dla funkcjonowania strony internetowej i nie mogą być wyłączone w naszych systemach. Są one zazwyczaj ustawiane tylko w odpowiedzi na działania podejmowane przez użytkownika, które sprowadzają się do zapytania o usługi, takie jak ustawienie preferencji prywatności, logowanie lub wypełnianie formularzy. Można ustawić przeglądarkę tak, aby blokowała lub ostrzegała o tych plikach cookie, ale niektóre części witryny nie będą wtedy działały. Te pliki cookie nie przechowują żadnych danych osobowych.

**Marketingowe**Te pliki cookie są niezbędne dla funkcjonowania strony internetowej i nie mogą być wyłączone w naszych systemach. Są one zazwyczaj ustawiane tylko w odpowiedzi na działania podejmowane przez użytkownika, które sprowadzają się do zapytania o usługi, takie jak ustawienie preferencji prywatności, logowanie lub wypełnianie formularzy. Można ustawić przeglądarkę tak, aby blokowała lub ostrzegała o tych plikach cookie, ale niektóre części witryny nie będą wtedy działały. Te pliki cookie nie przechowują żadnych danych osobowych.

Zapisz
Zaakceptuj wszystkie

×

## Zapisz się **do newslettera**

![](https://exatel.pl/app/themes/exatel/assets/icons/docs.png)

otrzymasz darmowe raporty i ekspertyzy

![](https://exatel.pl/app/themes/exatel/assets/icons/hand-shake.png)

zaproszenia na unikalne wydarzenia

![](https://exatel.pl/app/themes/exatel/assets/icons/bulb.png)

tylko wartościowe materiały

\*Wyrażam zgodę na przesyłanie informacji marketingowych na podany przeze mnie adrese-mail i numer telefonu przez EXATEL S.A.
(czytaj więcej)

\*Wyrażam zgodę na przesyłanie informacji handlowych na podany przeze mnie adres e-mail i numer telefonu przez EXATEL S.A.
(czytaj więcej)

\*Wyrażam zgodę na analizę danych w celu zoptymalizowania i dopasowania treści zakupowych od EXATEL S.A.
(czytaj więcej)

Wypełnienie formularza oznacza, że znasz naszą [Politykę prywatności](/polityka-prywatnosci). Pola oznaczone gwiazdką są obowiązkowe. Wyrażenie zgód jest niezbędne do wymiany informacji związanych z komunikacją.

![](https://exatel.pl/app/themes/exatel/assets/icons/icon-submit.jpg)

Dziękujemy!

Na Twój adres email
wysłaliśmy potwierdzenie.


