- **Root cause of vulnerability**: The application allows users to upload custom avatars which are displayed in various parts of the application.
- **Weaknesses/vulnerabilities present**:  The application does not properly sanitize user-uploaded avatar files, allowing for the injection of malicious JavaScript code. While a Content Security Policy (CSP) is in place, it can be bypassed by crafting specific avatar files. This is a Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: Successful exploitation could allow an attacker to execute arbitrary JavaScript code in the context of other users' browsers, potentially leading to session hijacking, data theft, or other malicious activities.
- **Attack vectors**: The attacker uploads a crafted avatar file containing malicious javascript code.
- **Required attacker capabilities/position**: An attacker needs to be able to upload an avatar in the application. This could be any user with the ability to set an avatar.