- **Root cause of vulnerability**: The vulnerability stems from a missing check for the `EPIPE` error in the `post_msg` function within the `accel-ppp`'s PPTP control module. The `post_msg` function attempts to write data to a socket, but if the socket is closed or broken, the `write` function may return -1 with `errno` set to `EPIPE`. The code handling the return value of `write` does not handle `EPIPE` correctly, resulting in a negative value being used as an offset in a subsequent `memcpy` operation, leading to a stack buffer underflow.
- **Weaknesses/vulnerabilities present**:
    - Stack buffer underflow vulnerability in the `post_msg` function, specifically at the `memcpy` operation due to a missing `EPIPE` check.
    - Inadequate error handling in the `post_msg` function when a `write` operation fails with `EPIPE`.
- **Impact of exploitation**: The stack buffer underflow can lead to a crash of the `accel-pppd` service and potentially allow arbitrary code execution.
- **Attack vectors**:
    - Sending a specific sequence of PPTP control messages can trigger the vulnerability.
    - The specific sequence includes a `PPTP Start Control Connection Request`, followed by a `PPTP Outgoing Call Request`, and then a `PPTP Call Clear Request`
    - The attacker needs to establish a PPTP control connection with the server.
- **Required attacker capabilities/position**:
    - The attacker must be able to send specifically crafted PPTP packets to the vulnerable server
    - The attacker must be able to open a TCP connection with the server.