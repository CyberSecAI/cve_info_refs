Based on the provided content, here's the vulnerability information for CVE-2021-40966:

**Root cause of vulnerability:**
- The application fails to properly sanitize or encode user-supplied input (specifically filenames).

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.

**Impact of exploitation:**
- Malicious JavaScript code embedded within a filename can be executed in the browsers of other users who access the file manager.
- This could lead to various attacks, including session hijacking, redirection to malicious sites, or other unauthorized actions within the context of the user's browser session.

**Attack vectors:**
- A malicious user uploads a file to the server using the file manager.
- The uploaded file has a malicious filename that includes HTML and JavaScript.
- When other users browse the file system using the file manager, the malicious JavaScript in the filename is executed.

**Required attacker capabilities/position:**
- The attacker needs the ability to upload files to the TinyFileManager instance.
- The attacker does not necessarily need administrative privileges, as any user who can upload files can inject the malicious filename.

**Affected Versions:**
- All versions up to and including 2.4.6 of TinyFileManager are affected.

**Additional details:**
- The vulnerability resides in `/tinyfilemanager.php`.
- The vulnerability is triggered when a server is given a file that contains HTML and JavaScript in its name.
- The malicious code in the file name is executed when the user accesses the server (file directory).