=== Content from www.soteritsecurity.com_64a1bcd7_20250115_100433.html ===

[![SOTER logo](/img/SOTER_logoblack.svg)](/)
 Menu

* [Sito](/ "Chi siamo")
* [Blog](/blog "Chi siamo")

[Indice dei post](/blog/)

# CMS Made Simple from SQL-injection to RCE - CVE-2021-40961

[SQL-Injection](/blog/tags/sql-injection/)
[SQLi](/blog/tags/sqli/)
[Research](/blog/tags/research/)
[CMS-Made-Simple](/blog/tags/cms-made-simple/)
[RCE](/blog/tags/rce/)
##### Riccardo Krauter, Daniele Scanu

30/01/2023

Share:

TL;DR: Vi raccontiamo una delle nostre ricerche: CVE-2021-40961 - SQL-Injection to Remote Code Execution su CMS Made Simple.

---

### Introduzione

Oggi vi vogliamo parlare della scoperta, da parte di un membro del team di Soter (Riccardo [âp4wâ](https://twitter.com/p4w16) Krauter), del **CVE-2021-40961** relativo ad una **SQL-injection** su **CMS Made Simple** sfruttabile da un utente autenticato con bassi privilegi. Lâarticolo ha lâobiettivo di mostrare come, anche una vulnerabilitÃ  apparentemente limitata, possa essere concatenta ad altre in modo da ottenere un forte impatto. Per ottenere questo risultato Ã¨ stato fondamentale lâaiuto di Daniele [âsk4â](https://twitter.com/sk4pwn) Scanu che ha giÃ  scoperto, negli anni passati, numerose vulnerabilitÃ  su **CMS Made Simple**.

### Discovering the SQL-injection

Lâanalisi Ã¨ partita dai moduli di CMS MS, in partcolare Ã¨ stato analizzato il modulo **news**. Questo modulo viene utlizzato per la pubblicazione di articoli sul portale, la cosa importante Ã¨ che questo modulo puÃ² essere utlizzato anche da utenze con bassi privilegi (non amministrative). Attraverso lâanalisi statica del codice sorgenete Ã¨ stato possibile individuare una vulnerabilitÃ  di SQL-injection allâinterno del file `modules/News/function.admin_articlestab.php`. Di seguito la porzione di codice interessata.

```
if( isset($params['submitfilter']) ) {
    //die("i'm here!");
    if( isset( $params['category']) ) {
        $this->SetPreference('article_category',trim($params['category']));
    }
    if( isset( $params['sortby'] ) ) {
        $this->SetPreference('article_sortby', str_replace("'",'_',$params['sortby']));
    }
    if( isset( $params['pagelimit'] ) ) {
        $this->SetPreference('article_pagelimit',(int)$params['pagelimit']);
    }
    $allcategories = (isset($params['allcategories'])?$params['allcategories']:'no');
    $this->SetPreference('allcategories',$allcategories);
    unset($_SESSION['news_pagenumber']);
    $pagenumber = 1;
}

....

$query1 = "SELECT SQL_CALC_FOUND_ROWS n.*, nc.long_name FROM ".CMS_DB_PREFIX."module_news n LEFT OUTER JOIN ".CMS_DB_PREFIX."module_news_categories nc ON n.news_category_id = nc.news_category_id ";
$parms = array();
if ($curcategory != '') {
    $query1 .= " WHERE nc.long_name LIKE ?";
    if( $allcategories == 'yes' ) {
        $parms[] = $curcategory.'%';
    }
    else {
        $parms[] = $curcategory;
    }
}
$query1 .= ' ORDER by '.$sortby;

```

Come Ã¨ possibile osservare, lâapplicazione prende un parametro controllabile da un utente di nome `sortby`, ed esegue dapprima una sanificazione mediante sostituzione del carattere apice `'` (`str_replace("'",'_',$params['sortby']));`). Solo poche righe di codice dopo, tale parametro viene concatenato in una query SQL (`$query1 .= ' ORDER by '.$sortby;`). Il problema in questo caso Ã¨ che, nonostante la sanificazione, Ã¨ possibile iniettare codice senza far uso dellâapice (che verrebbe comunque rimosso).
A questo punto non rimaneva che testare lâapplicazione e verificare che la vulnerabilitÃ  fosse sfruttabile. Nella parte di codice iniziale potete notare che Ã¨ stata inserita lâistruzione commentata `//die("i'm here!");` questo Ã¨ uno dei metodi veloci che utilizziamo per fare test dinamici e verificare di raggiungere una certa porzione di codice; infatti la funzione `die` termina lo script stampando la stringa passata come parametro. Navigando lâapplicazione utilizzando il menÃ¹ Ã¨ possibile raggiungere la sezione **News** ed eventalmente generare la seguente richiesta POST.

![img post-req](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/news.png)

![img post-req](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/new-base.png)

![img post-req](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/normal-req.png)

Come Ã¨ ossibile osservare, ci sono due news presenti. Inoltre, nella richiesta POST câÃ¨ un parametro `m1_sortby` che risulta essere proprio quello valutato nella porzione di codice riportata precedentemente, ora lâobiettivo Ã¨ arrivare quantomeno ad un PoC di SQL-injection. A tale proposito Ã¨ utile tornare al codice sorgente e analizzare la query che viene eseguita. Infatti, Ã¨ possibile iniettare codice SQL immediatemente dopo la keyword **ORDER BY**.
Sfruttare una SQL-injection in una clausola **ORDER BY** Ã¨ particolare; infatti, non Ã¨ piÃ¹ possibile usare **UNION**, **WHERE**, **OR** e altre keyword in questo punto della query. Per lâexploit utilizzeremo una **query annidata** al posto del parametro della **ORDER BY**. Una **query annidata** Ã¨ sostanzialmente una **SELECT** allâinterno di unâaltra istruzione. Unâaltra cosa importante da notare attraverso lâanalisi dinamica Ã¨ che, anche nel caso in cui si inserisca un payload che generi una query sintatticamente errata, il CMS non Ã¨ verboso nella risposta.

![img post-req](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/wrong-syntax.png)

![img post-req](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/wrong-syntax-resp.png)

Come Ã¨ possibile osservare nelle immagini soprastanti, se la query presenta un errore di sintassi, il CMS risponde con *nessun articolo creato*. Inoltre, non potendo usare lo **UNION** statement, non Ã¨ possibile estrarre dati dal database aggiungendoli con quelli restituiti in pagina. In questo caso una valida alternativa per ottenere un PoC Ã¨ quella di usare un payload **time-based**, ossia un payload di SQL che obbliga il database ad attendere per un periodo di tempo specificato prima di rispondere.
Un payload **time-based** funzionante Ã¨ il seguente:

```
(SELECT (CASE WHEN 1=1 THEN sleep(2) ELSE news_id END)) -- -

```

Questo payload contiene un costrutto `CASE WHEN` con una clausola **vera** `1=1`. Nel caso in cui la condizione sia **vera** verrÃ  eseguita la funzione `sleep()`; altrimenti se la condizione fosse **falsa**, verrebbe restituito il campo `news_id`.
Nelle immagini sottostanti Ã¨ possibile osservare che la vulnerabilitÃ  di **SQL-injection** esiste ed Ã¨ sfruttabile quantomeno con una tecnica basata sul tempo.

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/poc-sqli.png)

Infatti, la rispsota arriva al client sempre dopo 4 secondi, questo perchÃ¨ il payload iniettato ha forzato il database a eseguire una **sleep** di 2 secondi per ogni risultato restituito (2 articoli).
La tecnica time based ha perÃ² le sue limitazioni, prima di tutto lâestrazione dei dati dal DB risulta lenta proprio a casusa delle varie **sleep** che si aggiungono ai normali delay dovuti ai tempi di conessione ed elaborazione delle richieste HTTP tra client e server. Inoltre, potrebbe anche dare falsi positivi soprattutto se il tempo di sleep risulta essere troppo vicino a quello di una normale richiesta, ed Ã¨ necessario quindi adattarlo bene alla situazione, altrimenti il rischio di avere degli errori nei dati estratti Ã¨ alto. Preferibilmente sarebbe meglio poter contare su una tecnica del tipo **blind-boolean**, ossia una tecnica che fa uso dellâinferenza logica e si basa sullâinvio di una query SQL al database che costringe lâapplicazione a restituire un risultato diverso a seconda che la query restituisca un risultato VERO o FALSO. A tale proposito vecchie esperienze maturate grazie ai CTF sono tornate utili; infatti esiste un meteodo per forzare il DB ad andare in errore sfruttando lâoverflow dei numerici. Potete trovare il writeup del CTF a questo [indirizzo](https://github.com/beerpwn/ctf/tree/master/2019/Bsides_Dheli_CTF_2019/web). In sostanza questa tecnica prevede il controllo di un errore del DBMS, ad esempio se la condizione Ã¨ VERA allora viene volutamente mandato in errore il database, in caso contrario nessun errore viene forzato. La distinzione tra le diverse risposte offre la possibilitÃ  di eseguire lâestrazione dei dati dal db.
Questa tecnica, Ã¨ sicuramente piÃ¹ affidabile e veloce rispetto alla **time-based**.

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/request-pow.png)

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/response-pow.png)

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/request-pow-small.png)

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/response-pow-200.png)

Nelle immagini sopra Ã¨ possibile osservare come la risposta del server cambia nel momento in cui si forza il DB a eseguire la funzione `pow(99999,99999)`. Questo errore di overflow numerico Ã¨ particolare; infatti, a differenza di errori di sintassi nella query SQL, fa restituire un `500 Internal Server Error` come risposta.
A questo punto non rimane che da costruire un payload che consenta di estrarre dati dal DB come il seguente.

```
(SELECT (CASE WHEN (SELECT ascii(substring(username,{},{})) FROM cms_users where user_id=1)={} THEN pow(9999,9999) ELSE news_id END)) -- -

```

Con questo payload, Ã¨ possibile enumerare un carattere alla volta un dato contenuto in una tabella del DB. In caso il match della seguente condizione `ascii(substring(username,{},{})) FROM cms_users where user_id=1)={}` sia corretto, ossia abbiamo testato il carattere giusto, allora il database andrÃ  ad eseguire la funzione `pow(9999,9999)`, forzando cosÃ¬ il DBMS ad un errore di overflow numerico. In caso contrario nessun errore verrÃ  forzato e la risposta sarÃ  una normale `200 OK`. A questo punto abbiamo un metodo per fare inferenza ed estrarre dati arbitrari dal DB. Di seguito alcune immagini che dimostrano il funzionamento di questa tecnica.

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/poc-username-extraction.png)

![img SQLi-poc](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/poc-username-extraction-2.png)

Potete trovare documentazione utile a questo [indirzzo](https://dev.mysql.com/doc/refman/8.0/en/out-of-range-and-overflow.html) per quanto riguarda questo tipo di errore su MySQL, mentre a questo [indirizzo](https://www.w3resource.com/mysql/mysql-data-types.php) informazioni utili sui tipi di dato in MySQL.

### Ricerca di vecchie vulnerabilitÃ

A questo punto uno dei nostri interessi era quello di unire questa vulnerabilitÃ  con altre vulnerabilitÃ  che dessero un impatto ancora piÃ¹ alto. Dopo un pÃ² di ricerche, abbiamo scoperto che lâexploit di **Remote Code Execution** relativo al **CVE-2018-10086** Ã¨ ancora funzionante sulla versione **2.2.15** del CMS. Lâunico problema da risolvere ora era trovare un modo per fare privilege escalation, in quanto per sfruttare questâultimo **CVE-2018-10086** sono necessari privilegi ammistrativi sul CMS, mentre per la **SQL-injection** scoperta no.

### Chaining all together

Una delle cose piÃ¹ semplici da immaginare nel momento in cui si scopre una SQL-injection Ã¨ quella di estrarre dati sensibili dal database come ad esmpio utenti e password. Una volta ottenuti gli hash di utenze amministrative Ã¨ possibile provare a craccare gli stessi per ottenere la password di accesso. Purtroppo perÃ² questo tipo di attacco Ã¨ fortemente dipendente dalla robustezza della password scelta; infatti se la password risultasse molto robusta, allora questo attacco potrebbe fallire (nel senso che di solito richiederebbe un tempo troppo lungo e risorse computazionali non accessibili allâattaccante).
Dopo un pÃ² di ricerche Ã¨ stato possibile osservare che la funzionalitÃ  di reset della password potrebbe essere sfruttata per eseuguire un privilege escalation. La procedura di reset infatti prevede che si conosca solo lâusername dellâutenza di cui si vuole eseguire il ripristino della password e questa informazione Ã¨ tranquillamente estraibile dal database mediante la **SQL-injection** scoperta. DopodichÃ¨, viene inviato un **token** di reset per e-mail allâindirizzo email associato allâutenza. Lo stesso **token** viene salvato anche nel database, quindi possiamo di nuovo sfruttare la **SQL-injection** per estrarlo dal DB ed eseguire il reset della password.
Per riassumere gli step sono:

* Da utente non privilegiato sfruttare il **CVE-2021-40961** di **SQL-injection** per estrarre un nome utente relativo ad utenza con alti privilegi;
* Eseguire la richiesta di reset della password con il nome utente estratto nel passo precedente;
* Da utente non privilegiato sfruttare nuovamente il **CVE-2021-40961** per estrarre il token di reset della password;
* Resettare la password per lâutenza amministrativa utilizzando il token ottenuto;
* Una volta loggati come amministratore, sfruttare il **CVE-2018-10086** per ottenere Remote Code Execution sul server remoto.

Per automatizzare il tutto, abbiamo scritto un python script che Ã¨ in grado di automatizzare la procedura descritta fino a creare una webshell sul server remoto mediante la quale Ã¨ possibile eseguire comandi di sistema.
Lo script Ã¨ reperibile al seguente [indirizzo](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/SQLi-RCE-CVE-2021-40961.zip).
Abbiamo anche creato un video che usa il python script per ottenere **RCE** su un nostro endpoit sul quale abbiamo installato il CMS.

![alt video](/blog/assets/posts-2023/2023-01-30-CMS-Made-Simple_CVE-2021-40961/cve-2021.gif)

### Reference

* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-40961>
* <https://beerpwn.github.io/ctf/2019/Bsides_Dheli_CTF_2019/web/>

---

Condividi il post:

[Torna alla lista dei post](/blog/)

#### Soter IT Security S.r.l.

* Email: info@soteritsecurity.com
* Sede Operativa: [Via Challant 36, Torino](https://g.page/r/CTv2qZKbvnH_EAE "Sede Operativa Soter It Security")
* Sede Legale: corso Peschiera 254, Torino
* C.F. e P.IVA: 12447780011

[Privacy Policy](https://www.iubenda.com/privacy-policy/24845081 "Privacy Policy ")

[Cookie Policy](https://www.iubenda.com/privacy-policy/24845081/cookie-policy "Cookie Policy ")

![](/img/SOTER_logoblack.svg)



=== Content from packetstormsecurity.com_8cbc8b18_20250115_100429.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from twitter.com_839401de_20250115_140014.html ===



=== Content from beerpwn.github.io_e77327b4_20250115_225030.html ===

[# ctf](/ctf/)
## ctf writeup repo

[View on GitHub](https://github.com/beerpwn/ctf)

# WRITEUP Seek You EI (Blind-SQLi)

## **Author:** p4w @ beerpwn team

![Image desc](/ctf/2019/Bsides_Dheli_CTF_2019/web/challenge_desc.png)
![Image desc](/ctf/2019/Bsides_Dheli_CTF_2019/web/vuln_param.png)

First thing I had to do was to bypass the firwall that blocks the usage of `_` character. As we noticed from the image above, this character is used by a vulnerable query as GET parameter name. The first trick is based on a bahavior of php that automatically converts the `.` into `_`, so we can use this behavior to bypass the restriction.
The GET parameter is vulnerable to SQL-injection. The main problem here is that the output don’t change in any way if the query match for something or not.
The first idea that I had is to leak the database using time-based technique, but unfortunately the firewall block us. I start to enumerate the firewall rules and comes out that `sleep` and `bench` words were blacklisted, then no time delay for us. Also other words match the firewall rules eg `like`,`if` etc…
After a bit of try and errors I noticed that if the query has some syntax error, the server replies with a blank response that is different from the normal one. Then **server error** means **blank response**.
So the idea that I had was:
what if I control this behavior with a query in order to trigger a boolean condition to extract information?
The question that I had to answer now was “how can I force a server error with a query?”. Well, after some time my brain comes out with an answer: using some “heavy” operation number to cause a MySQL server side error!
To do that the `pow()` function seems to be a good candidate. Behaving that the flow was correct I builded a payload to prove that.

```
asd' OR pow(99999999, pow(99999999, pw regexp '^')) --

```

This payload will produce an error when the regex match because the regexp return 1, then the dbms has to calc `99999999^(99999999^1)` and this result should be too big; instead when the regexp fail the match then it return 0 so the dbms calc should be `99999999^(99999999^0) = 99999999^1`.
Regex match generate blank resp:
![Image poc](/ctf/2019/Bsides_Dheli_CTF_2019/web/sqli_poc_error.png)

Regex NOT match generate resp with contents:
![Image poc](/ctf/2019/Bsides_Dheli_CTF_2019/web/sqli_poc_not_error.png)

As you can see from the image above the techinique works like a charm so we have the control over the server error and we can build our blind exploit from this behavior.
[Here](./sqli_exploit.py) you can find the full exploit that I written during the CTF.
And here you can see the output of the script extracting the admin pwd:

![Image of exploit](/ctf/2019/Bsides_Dheli_CTF_2019/web/exploit_output.png)

Oh and obviously flag time ;

![Image of exploit](/ctf/2019/Bsides_Dheli_CTF_2019/web/flag_time.png)

Cheers, p4w!



=== Content from twitter.com_24b635a7_20250115_225032.html ===



=== Content from github.com_371507f4_20250115_100427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbeerpwn%2FCVE%2Fblob%2Fmaster%2Fcms_made_simple_2021%2Fsqli_order_by%2FCMS-MS-SQLi-report.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbeerpwn%2FCVE%2Fblob%2Fmaster%2Fcms_made_simple_2021%2Fsqli_order_by%2FCMS-MS-SQLi-report.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=beerpwn%2FCVE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[beerpwn](/beerpwn)
/
**[CVE](/beerpwn/CVE)**
Public

* [Notifications](/login?return_to=%2Fbeerpwn%2FCVE) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fbeerpwn%2FCVE)
* [Star
   17](/login?return_to=%2Fbeerpwn%2FCVE)

* [Code](/beerpwn/CVE)
* [Issues
  0](/beerpwn/CVE/issues)
* [Pull requests
  0](/beerpwn/CVE/pulls)
* [Actions](/beerpwn/CVE/actions)
* [Projects
  0](/beerpwn/CVE/projects)
* [Security](/beerpwn/CVE/security)
* [Insights](/beerpwn/CVE/pulse)

Additional navigation options

* [Code](/beerpwn/CVE)
* [Issues](/beerpwn/CVE/issues)
* [Pull requests](/beerpwn/CVE/pulls)
* [Actions](/beerpwn/CVE/actions)
* [Projects](/beerpwn/CVE/projects)
* [Security](/beerpwn/CVE/security)
* [Insights](/beerpwn/CVE/pulse)

## Files

 master
## Breadcrumbs

1. [CVE](/beerpwn/CVE/tree/master)
2. /[cms\_made\_simple\_2021](/beerpwn/CVE/tree/master/cms_made_simple_2021)
3. /[sqli\_order\_by](/beerpwn/CVE/tree/master/cms_made_simple_2021/sqli_order_by)
/
# CMS-MS-SQLi-report.md

Copy path Blame  Blame
## Latest commit

## History

[History](/beerpwn/CVE/commits/master/cms_made_simple_2021/sqli_order_by/CMS-MS-SQLi-report.md)18 lines (10 loc) · 828 Bytes master
## Breadcrumbs

1. [CVE](/beerpwn/CVE/tree/master)
2. /[cms\_made\_simple\_2021](/beerpwn/CVE/tree/master/cms_made_simple_2021)
3. /[sqli\_order\_by](/beerpwn/CVE/tree/master/cms_made_simple_2021/sqli_order_by)
/
# CMS-MS-SQLi-report.md

Top
## File metadata and controls

* Preview
* Code
* Blame

18 lines (10 loc) · 828 Bytes[Raw](https://github.com/beerpwn/CVE/raw/refs/heads/master/cms_made_simple_2021/sqli_order_by/CMS-MS-SQLi-report.md)
## SQL injection

### Author: Riccardo Krauter @ [Soter IT Security](https://soteritsecurity.com)

The vulnerability is located in the `modules/News/function.admin_articlestab.php` file.

[![alt img](/beerpwn/CVE/raw/master/cms_made_simple_2021/sqli_order_by/sca_1.PNG)](/beerpwn/CVE/blob/master/cms_made_simple_2021/sqli_order_by/sca_1.PNG)

[![alt img](/beerpwn/CVE/raw/master/cms_made_simple_2021/sqli_order_by/sca_2.PNG)](/beerpwn/CVE/blob/master/cms_made_simple_2021/sqli_order_by/sca_2.PNG)

The `sortby` parameter is sanitized by replacing the `'` with the `_` character. As it is possible to notice the `$sortby` variable is concatenated with `$query1`, but it is possible to inject arbitrary SQL language without using the `'`.
As proof of concept, please consider the following screen-shot

[![alt img](/beerpwn/CVE/raw/master/cms_made_simple_2021/sqli_order_by/sqli_poc.PNG)](/beerpwn/CVE/blob/master/cms_made_simple_2021/sqli_order_by/sqli_poc.PNG)

Notice that the server will sleep for 4 seconds since the query has two results (row).

* time based payload payload: `(SELECT (CASE WHEN 1=1 THEN sleep(2) ELSE news_id END)) --`

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from dev.mysql.com_ca65d264_20250115_225033.html ===

[Skip to Main Content](#main)

The world's most popular open source database

[**Contact MySQL**](https://www.mysql.com/about/contact/)
 |

[Login](https://dev.mysql.com/auth/login/?dest=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F8.0%2Fen%2Fout-of-range-and-overflow.html)  |
[Register](https://dev.mysql.com/auth/register/)

* [MySQL.com](https://www.mysql.com/)
* [Downloads](https://www.mysql.com/downloads/)
* [Documentation](/doc/)
* [Developer Zone](/)

 [Developer Zone](/)
 [Downloads](https://www.mysql.com/downloads/)
 [MySQL.com](https://www.mysql.com/)

[Documentation](/doc/)

* [MySQL Server](/doc/refman/en/)
* [MySQL Enterprise](/doc/index-enterprise.html)
* [Workbench](/doc/workbench/en/)
* [InnoDB Cluster](/doc/mysql-shell/en/mysql-innodb-cluster.html)
* [MySQL NDB Cluster](/doc/index-cluster.html)
* [Connectors](/doc/index-connectors.html)
* [More](/doc/index-other.html)
* [MySQL.com](https://www.mysql.com/)
* [Downloads](https://www.mysql.com/downloads/)
* [Developer Zone](/)

Section Menu:

[Documentation Home](/doc/)

---

MySQL 8.0 Reference Manual

* [Preface and Legal Notices](preface.html)
* [General Information](introduction.html)
* [Installing MySQL](installing.html)
* [Upgrading MySQL](upgrading.html)
* [Downgrading MySQL](downgrading.html)
* [Tutorial](tutorial.html)
* [MySQL Programs](programs.html)
* [MySQL Server Administration](server-administration.html)
* [Security](security.html)
* [Backup and Recovery](backup-and-recovery.html)
* [Optimization](optimization.html)
* [Language Structure](language-structure.html)
* [Character Sets, Collations, Unicode](charset.html)
* [Data Types](data-types.html)
  + [Numeric Data Types](numeric-types.html)
    - [Numeric Data Type Syntax](numeric-type-syntax.html)
    - [Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT,
      MEDIUMINT, BIGINT](integer-types.html)
    - [Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC](fixed-point-types.html)
    - [Floating-Point Types (Approximate Value) - FLOAT, DOUBLE](floating-point-types.html)
    - [Bit-Value Type - BIT](bit-type.html)
    - [Numeric Type Attributes](numeric-type-attributes.html)
    - [Out-of-Range and Overflow Handling](out-of-range-and-overflow.html)
  + [Date and Time Data Types](date-and-time-types.html)
    - [Date and Time Data Type Syntax](date-and-time-type-syntax.html)
    - [The DATE, DATETIME, and TIMESTAMP Types](datetime.html)
    - [The TIME Type](time.html)
    - [The YEAR Type](year.html)
    - [Automatic Initialization and Updating for TIMESTAMP and DATETIME](timestamp-initialization.html)
    - [Fractional Seconds in Time Values](fractional-seconds.html)
    - [What Calendar Is Used By MySQL?](mysql-calendar.html)
    - [Conversion Between Date and Time Types](date-and-time-type-conversion.html)
    - [2-Digit Years in Dates](two-digit-years.html)
  + [String Data Types](string-types.html)
    - [String Data Type Syntax](string-type-syntax.html)
    - [The CHAR and VARCHAR Types](char.html)
    - [The BINARY and VARBINARY Types](binary-varbinary.html)
    - [The BLOB and TEXT Types](blob.html)
    - [The ENUM Type](enum.html)
    - [The SET Type](set.html)
  + [Spatial Data Types](spatial-types.html)
    - [Spatial Data Types](spatial-type-overview.html)
    - [The OpenGIS Geometry Model](opengis-geometry-model.html)
      * [The Geometry Class Hierarchy](gis-geometry-class-hierarchy.html)
      * [Geometry Class](gis-class-geometry.html)
      * [Point Class](gis-class-point.html)
      * [Curve Class](gis-class-curve.html)
      * [LineString Class](gis-class-linestring.html)
      * [Surface Class](gis-class-surface.html)
      * [Polygon Class](gis-class-polygon.html)
      * [GeometryCollection Class](gis-class-geometrycollection.html)
      * [MultiPoint Class](gis-class-multipoint.html)
      * [MultiCurve Class](gis-class-multicurve.html)
      * [MultiLineString Class](gis-class-multilinestring.html)
      * [MultiSurface Class](gis-class-multisurface.html)
      * [MultiPolygon Class](gis-class-multipolygon.html)
    - [Supported Spatial Data Formats](gis-data-formats.html)
    - [Geometry Well-Formedness and Validity](geometry-well-formedness-validity.html)
    - [Spatial Reference System Support](spatial-reference-systems.html)
    - [Creating Spatial Columns](creating-spatial-columns.html)
    - [Populating Spatial Columns](populating-spatial-columns.html)
    - [Fetching Spatial Data](fetching-spatial-data.html)
    - [Optimizing Spatial Analysis](optimizing-spatial-analysis.html)
    - [Creating Spatial Indexes](creating-spatial-indexes.html)
    - [Using Spatial Indexes](using-spatial-indexes.html)
  + [The JSON Data Type](json.html)
  + [Data Type Default Values](data-type-defaults.html)
  + [Data Type Storage Requirements](storage-requirements.html)
  + [Choosing the Right Type for a Column](choosing-types.html)
  + [Using Data Types from Other Database Engines](other-vendor-data-types.html)
* [Functions and Operators](functions.html)
* [SQL Statements](sql-statements.html)
* [MySQL Data Dictionary](data-dictionary.html)
* [The InnoDB Storage Engine](innodb-storage-engine.html)
* [Alternative Storage Engines](storage-engines.html)
* [Replication](replication.html)
* [Group Replication](group-replication.html)
* [MySQL Shell](mysql-shell-userguide.html)
* [Using MySQL as a Document Store](document-store.html)
* [InnoDB Cluster](mysql-innodb-cluster-introduction.html)
* [InnoDB ReplicaSet](mysql-innodb-replicaset-introduction.html)
* [MySQL NDB Cluster 8.0](mysql-cluster.html)
* [Partitioning](partitioning.html)
* [Stored Objects](stored-objects.html)
* [INFORMATION\_SCHEMA Tables](information-schema.html)
* [MySQL Performance Schema](performance-schema.html)
* [MySQL sys Schema](sys-schema.html)
* [Connectors and APIs](connectors-apis.html)
* [MySQL Enterprise Edition](mysql-enterprise.html)
* [MySQL Workbench](workbench.html)
* [MySQL on OCI Marketplace](mysql-oci-marketplace.html)
* [MySQL 8.0 Frequently Asked Questions](faqs.html)
* [Error Messages and Common Problems](error-handling.html)
* [Indexes](indexes.html)
* [MySQL Glossary](glossary.html)

Related Documentation
[MySQL 8.0 Release Notes](/doc/relnotes/mysql/8.0/en/)

[MySQL 8.0 Source Code Documentation](/doc/dev/mysql-server/latest/)

Download
this Manual
[PDF (US Ltr)](https://downloads.mysql.com/docs/refman-8.0-en.pdf)
- 43.3Mb

[PDF (A4)](https://downloads.mysql.com/docs/refman-8.0-en.a4.pdf)
- 43.4Mb

[Man Pages (TGZ)](https://downloads.mysql.com/docs/refman-8.0-en.man-gpl.tar.gz)
- 296.6Kb

[Man Pages (Zip)](https://downloads.mysql.com/docs/refman-8.0-en.man-gpl.zip)
- 402.0Kb

[Info (Gzip)](https://downloads.mysql.com/docs/mysql-8.0.info.gz)
- 4.3Mb

[Info (Zip)](https://downloads.mysql.com/docs/mysql-8.0.info.zip)
- 4.3Mb

Excerpts from this Manual
[MySQL Backup and Recovery](/doc/mysql-backup-excerpt/8.0/en/)

[MySQL Globalization](/doc/mysql-g11n-excerpt/8.0/en/)

[MySQL Information Schema](/doc/mysql-infoschema-excerpt/8.0/en/)

[MySQL Installation Guide](/doc/mysql-installation-excerpt/8.0/en/)

[Security in MySQL](/doc/mysql-security-excerpt/8.0/en/)

[Starting and Stopping MySQL](/doc/mysql-startstop-excerpt/8.0/en/)

[MySQL and Linux/Unix](/doc/mysql-linuxunix-excerpt/8.0/en/)

[MySQL and Windows](/doc/mysql-windows-excerpt/8.0/en/)

[MySQL and macOS](/doc/mysql-macos-excerpt/8.0/en/)

[MySQL and Solaris](/doc/mysql-solaris-excerpt/8.0/en/)

[Building MySQL from Source](/doc/mysql-sourcebuild-excerpt/8.0/en/)

[MySQL Restrictions and Limitations](/doc/mysql-reslimits-excerpt/8.0/en/)

[MySQL Partitioning](/doc/mysql-partitioning-excerpt/8.0/en/)

[MySQL Tutorial](/doc/mysql-tutorial-excerpt/8.0/en/)

[MySQL Performance Schema](/doc/mysql-perfschema-excerpt/8.0/en/)

[MySQL Replication](/doc/mysql-replication-excerpt/8.0/en/)

[Using the MySQL Yum Repository](/doc/mysql-repo-excerpt/8.0/en/)

[MySQL NDB Cluster 8.0](/doc/mysql-cluster-excerpt/8.0/en/)

version 8.0
[9.1](/doc/refman/9.1/en/out-of-range-and-overflow.html)

[9.0](/doc/refman/9.0/en/out-of-range-and-overflow.html)

[8.4
 current](/doc/refman/8.4/en/out-of-range-and-overflow.html)

[5.7](/doc/refman/5.7/en/out-of-range-and-overflow.html)

[8.0
Japanese](/doc/refman/8.0/ja/out-of-range-and-overflow.html)

[MySQL 8.0 Reference Manual](/doc/refman/8.0/en/)  /
...  /
[Data Types](data-types.html)  /
[Numeric Data Types](numeric-types.html)  /

Out-of-Range and Overflow Handling

### 13.1.7 Out-of-Range and Overflow Handling

When MySQL stores a value in a numeric column that is outside
the permissible range of the column data type, the result
depends on the SQL mode in effect at the time:

* If strict SQL mode is enabled, MySQL rejects the
  out-of-range value with an error, and the insert fails, in
  accordance with the SQL standard.
* If no restrictive modes are enabled, MySQL clips the value
  to the appropriate endpoint of the column data type range
  and stores the resulting value instead.

  When an out-of-range value is assigned to an integer column,
  MySQL stores the value representing the corresponding
  endpoint of the column data type range.

  When a floating-point or fixed-point column is assigned a
  value that exceeds the range implied by the specified (or
  default) precision and scale, MySQL stores the value
  representing the corresponding endpoint of that range.

Suppose that a table `t1` has this definition:

```
CREATE TABLE t1 (i1 TINYINT, i2 TINYINT UNSIGNED);
```

With strict SQL mode enabled, an out of range error occurs:

```
mysql> SET sql_mode = 'TRADITIONAL';
mysql> INSERT INTO t1 (i1, i2) VALUES(256, 256);
ERROR 1264 (22003): Out of range value for column 'i1' at row 1
mysql> SELECT * FROM t1;
Empty set (0.00 sec)
```

With strict SQL mode not enabled, clipping with warnings occurs:

```
mysql> SET sql_mode = '';
mysql> INSERT INTO t1 (i1, i2) VALUES(256, 256);
mysql> SHOW WARNINGS;
+---------+------+---------------------------------------------+
| Level   | Code | Message                                     |
+---------+------+---------------------------------------------+
| Warning | 1264 | Out of range value for column 'i1' at row 1 |
| Warning | 1264 | Out of range value for column 'i2' at row 1 |
+---------+------+---------------------------------------------+
mysql> SELECT * FROM t1;
+------+------+
| i1   | i2   |
+------+------+
|  127 |  255 |
+------+------+
```

When strict SQL mode is not enabled, column-assignment
conversions that occur due to clipping are reported as warnings
for [`ALTER TABLE`](alter-table.html "15.1.9 ALTER TABLE Statement"),
[`LOAD DATA`](load-data.html "15.2.9 LOAD DATA Statement"),
[`UPDATE`](update.html "15.2.17 UPDATE Statement"), and multiple-row
[`INSERT`](insert.html "15.2.7 INSERT Statement") statements. In strict
mode, these statements fail, and some or all the values are not
inserted or changed, depending on whether the table is a
transactional table and other factors. For details, see
[Section 7.1.11, “Server SQL Modes”](sql-mode.html "7.1.11 Server SQL Modes").

Overflow during numeric expression evaluation results in an
error. For example, the largest signed
[`BIGINT`](integer-types.html "13.1.2 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT") value is
9223372036854775807, so the following expression produces an
error:

```
mysql> SELECT 9223372036854775807 + 1;
ERROR 1690 (22003): BIGINT value is out of range in '(9223372036854775807 + 1)'
```

To enable the operation to succeed in this case, convert the
value to unsigned;

```
mysql> SELECT CAST(9223372036854775807 AS UNSIGNED) + 1;
+-------------------------------------------+
| CAST(9223372036854775807 AS UNSIGNED) + 1 |
+-------------------------------------------+
|                       9223372036854775808 |
+-------------------------------------------+
```

Whether overflow occurs depends on the range of the operands, so
another way to handle the preceding expression is to use
exact-value arithmetic because
[`DECIMAL`](fixed-point-types.html "13.1.3 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC") values have a larger
range than integers:

```
mysql> SELECT 9223372036854775807.0 + 1;
+---------------------------+
| 9223372036854775807.0 + 1 |
+---------------------------+
|     9223372036854775808.0 |
+---------------------------+
```

Subtraction between integer values, where one is of type
`UNSIGNED`, produces an unsigned result by
default. If the result would otherwise have been negative, an
error results:

```
mysql> SET sql_mode = '';
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT CAST(0 AS UNSIGNED) - 1;
ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in '(cast(0 as unsigned) - 1)'
```

If the [`NO_UNSIGNED_SUBTRACTION`](sql-mode.html#sqlmode_no_unsigned_subtraction)
SQL mode is enabled, the result is negative:

```
mysql> SET sql_mode = 'NO_UNSIGNED_SUBTRACTION';
mysql> SELECT CAST(0 AS UNSIGNED) - 1;
+-------------------------+
| CAST(0 AS UNSIGNED) - 1 |
+-------------------------+
|                      -1 |
+-------------------------+
```

If the result of such an operation is used to update an
`UNSIGNED` integer column, the result is
clipped to the maximum value for the column type, or clipped to
0 if [`NO_UNSIGNED_SUBTRACTION`](sql-mode.html#sqlmode_no_unsigned_subtraction)
is enabled. If strict SQL mode is enabled, an error occurs and
the column remains unchanged.

 [PREV](numeric-type-attributes.html "Previous: Numeric Type Attributes")
 [HOME](index.html "Start")
 [UP](numeric-types.html "Up: Numeric Data Types")
[NEXT](date-and-time-types.html "Next: Date and Time Data Types")

Related Documentation
[MySQL 8.0 Release Notes](/doc/relnotes/mysql/8.0/en/)

[MySQL 8.0 Source Code Documentation](/doc/dev/mysql-server/latest/)

Download
this Manual
[PDF (US Ltr)](https://downloads.mysql.com/docs/refman-8.0-en.pdf)
- 43.3Mb

[PDF (A4)](https://downloads.mysql.com/docs/refman-8.0-en.a4.pdf)
- 43.4Mb

[Man Pages (TGZ)](https://downloads.mysql.com/docs/refman-8.0-en.man-gpl.tar.gz)
- 296.6Kb

[Man Pages (Zip)](https://downloads.mysql.com/docs/refman-8.0-en.man-gpl.zip)
- 402.0Kb

[Info (Gzip)](https://downloads.mysql.com/docs/mysql-8.0.info.gz)
- 4.3Mb

[Info (Zip)](https://downloads.mysql.com/docs/mysql-8.0.info.zip)
- 4.3Mb

Excerpts from this Manual
[MySQL Backup and Recovery](/doc/mysql-backup-excerpt/8.0/en/)

[MySQL Globalization](/doc/mysql-g11n-excerpt/8.0/en/)

[MySQL Information Schema](/doc/mysql-infoschema-excerpt/8.0/en/)

[MySQL Installation Guide](/doc/mysql-installation-excerpt/8.0/en/)

[Security in MySQL](/doc/mysql-security-excerpt/8.0/en/)

[Starting and Stopping MySQL](/doc/mysql-startstop-excerpt/8.0/en/)

[MySQL and Linux/Unix](/doc/mysql-linuxunix-excerpt/8.0/en/)

[MySQL and Windows](/doc/mysql-windows-excerpt/8.0/en/)

[MySQL and macOS](/doc/mysql-macos-excerpt/8.0/en/)

[MySQL and Solaris](/doc/mysql-solaris-excerpt/8.0/en/)

[Building MySQL from Source](/doc/mysql-sourcebuild-excerpt/8.0/en/)

[MySQL Restrictions and Limitations](/doc/mysql-reslimits-excerpt/8.0/en/)

[MySQL Partitioning](/doc/mysql-partitioning-excerpt/8.0/en/)

[MySQL Tutorial](/doc/mysql-tutorial-excerpt/8.0/en/)

[MySQL Performance Schema](/doc/mysql-perfschema-excerpt/8.0/en/)

[MySQL Replication](/doc/mysql-replication-excerpt/8.0/en/)

[Using the MySQL Yum Repository](/doc/mysql-repo-excerpt/8.0/en/)

[MySQL NDB Cluster 8.0](/doc/mysql-cluster-excerpt/8.0/en/)

**Contact MySQL Sales**

USA/Canada: +1-866-221-0634
([More Countries »](https://www.mysql.com/about/contact/phone/))

  [© 2025 Oracle](https://www.oracle.com/legal/copyright.html)

* [Products](https://www.mysql.com/products/)
* [HeatWave](https://www.mysql.com/products/heatwave/)
* [MySQL Enterprise Edition](https://www.mysql.com/products/enterprise/)
* [MySQL Standard Edition](https://www.mysql.com/products/standard/)
* [MySQL Classic Edition](https://www.mysql.com/products/classic/)
* [MySQL Cluster CGE](https://www.mysql.com/products/cluster/)
* [MySQL Embedded (OEM/ISV)](https://www.mysql.com/oem/)

* [Services](https://www.mysql.com/services/)
* [Training](https://www.mysql.com/training/)
* [Certification](https://www.mysql.com/certification/)
* [Support](https://www.mysql.com/support/)

* [Downloads](https://www.mysql.com/downloads/)
* [MySQL Community Server](https://dev.mysql.com/downloads/mysql/)
* [MySQL NDB Cluster](https://dev.mysql.com/downloads/cluster/)
* [MySQL Shell](https://dev.mysql.com/downloads/shell/)
* [MySQL Router](https://dev.mysql.com/downloads/router/)
* [MySQL Workbench](https://dev.mysql.com/downloads/workbench/)

* [Documentation](https://dev.mysql.com/doc/)
* [MySQL Reference Manual](https://dev.mysql.com/doc/refman/en/)
* [MySQL Workbench](https://dev.mysql.com/doc/workbench/en/)
* [MySQL NDB Cluster](https://dev.mysql.com/doc/index-cluster.html)
* [MySQL Connectors](https://dev.mysql.com/doc/index-connectors.html)
* [Topic Guides](https://dev.mysql.com/doc/#topic)

* [About MySQL](https://www.mysql.com/about/)
* [Contact Us](https://www.mysql.com/about/contact/)
* [Blogs](https://blogs.oracle.com/mysql/)
* [How to Buy](https://www.mysql.com/buy-mysql/)
* [Partners](https://www.mysql.com/partners/)
* [Job Opportunities](https://www.mysql.com/about/jobs/)
* [Site Map](https://www.mysql.com/sitemap.html)

  [© 2025 Oracle](https://www.oracle.com/legal/copyright.html)
[Privacy](https://www.oracle.com/legal/privacy/) /
[Do Not Sell My Info](https://www.oracle.com/legal/privacy/privacy-choices.html) |
[Terms of Use](https://www.oracle.com/us/legal/terms/index.html) |
[Trademark Policy](https://www.oracle.com/us/legal/third-party-trademarks/index.html) |



=== Content from seclists.org_f9f8e24e_20250115_100431.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

![](/shared/images/nst-icons.svg#search)

# CMS Made Simple SQL injection on m1\_sortby parameter

---

*From*: riccardo krauter <riccardo.krauter () gmail com>

*Date*: Wed, 17 Mar 2021 12:49:15 +0100

---

```

1) Summary

Affected software  CMS Made Simple-2.2.15
Vendor URL<http://www.cmsmadesimple.org/>  <<http://www.cmsmadesimple.org/>>
Vulnerability      SQL injection

2) Vulnerability Description

The affected software is vulnerable to SQL injection via the m1_sortby POST parameter of the News module, reachable via
the moduleinterface.php page.
The `sortby` parameter is sanitized by replacing the `'` with the `_` character, anyway it is possible to inject arbitrary
SQL language without using the `'`.
This vulnerability is remotely exploitable and require authentication.

```
3) PoC and details
```

<https://github.com/beerpwn/CVE/blob/master/cms_made_simple_2021/sqli_order_by/CMS-MS-SQLi-report.md>

4) Credits

This vulnerability has been discovered and reported
by Riccardo Krauter researcher @ Soter IT Security (soteritsecurity.com).

5) Timeline

2021/02/22  Vendor was informed
2021/02/26  Vendor said he won't fix
2021/03/17  Public disclosure

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

### Current thread:

* **CMS Made Simple SQL injection on m1\_sortby parameter** *riccardo krauter (Mar 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


