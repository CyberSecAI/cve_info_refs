=== Content from launchpad.net_22884c23_20250115_113452.html ===

[Log in / Register](https://launchpad.net/~fungi/%2Blogin)

[![](https://launchpadlibrarian.net/112681987/gnome-gmush-64.png)](https://launchpad.net/~fungi)

## [Jeremy Stanley](https://launchpad.net/~fungi)

* Overview
* [Code](https://code.launchpad.net/~fungi)
* [Bugs](https://bugs.launchpad.net/~fungi)
* [Blueprints](https://blueprints.launchpad.net/~fungi)
* [Translations](https://translations.launchpad.net/~fungi)
* [Answers](https://answers.launchpad.net/~fungi)

<http://fungi.yuggoth.org/>

* [Related packages](https://launchpad.net/~fungi/%2Brelated-packages)
* [Related projects](https://launchpad.net/~fungi/%2Brelated-projects)

## User information

Launchpad Id:
fungi

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-06-16

[![Icon of Nova Bug Team](https://launchpadlibrarian.net/108832444/bug.gif "Member of Nova Bug Team")](/~nova-bugs)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of OpenStack Vulnerability Management team](https://launchpadlibrarian.net/83816787/icon.png "Member of OpenStack Vulnerability Management team")](/~openstack-vuln-mgmt)
[![Icon of Python OpenStack Client Bugs](https://launchpadlibrarian.net/697274771/osc-icon.png "Member of Python OpenStack Client Bugs")](/~python-openstackclient-bugs)
[![Icon of Python OpenStack Client](https://launchpadlibrarian.net/697274843/osc-icon.png "Member of Python OpenStack Client")](/~python-openstackclient)
[![Icon of Swift](https://launchpadlibrarian.net/52560230/os14.png "Member of Swift")](/~swift)

Languages:

English

OpenPGP keys:

97AE496FC02DEC9FC353B2E748F9961143495829

SSH keys:

[fungi@yuggoth.org](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[345](https://launchpad.net/~fungi/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**fungi**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**fungi**
 on
**irc.oftc.net**

## [All bugs in progress](https://launchpad.net/~fungi/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1354829 [Booting from stale snapshots in rax-dfw leads to miscellaneous failures](https://bugs.launchpad.net/openstack-ci/%2Bbug/1354829) |  |
| --- | --- | --- |
| in [OpenStack Core Infrastructure](/openstack-ci), [OpenStack Dashboard (Horizon)](/horizon), [neutron](/neutron), [tempest](/tempest) | | |

| --- | --- | --- | --- | --- | --- |

## [All memberships](https://launchpad.net/~fungi/%2Bparticipation) Latest memberships

| [Oslo Core security contacts](/~oslo-coresec)  Joined on 2023-10-02 | |
| --- | --- |
| [Glance Release](/~glance-release)  Joined on 2021-07-27 | |
| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2020-11-12 | |
| [OpenDev Two-Factor Authentication](/~opendev-2fa)  Joined on 2020-11-05 | |
| [Trove Drivers](/~trove-drivers)  Joined on 2020-06-22 | |

## [Recent activities](https://launchpad.net/~fungi/%2Bkarma) Most active in

| [OpenStack Security Advisory](/ossa) |  |  |  |
| --- | --- | --- | --- |
| [Ubuntu](/ubuntu) |  |  |  |
| [OpenStack Compute (nova)](/nova) |  |  |  |
| [OpenStack Security Notes](/ossn) |  |  |  |
| [Ubuntu Cloud Archive](/cloud-archive) |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_5e5a4196_20250114_185707.html ===

[Log in / Register](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* [Translations](https://translations.launchpad.net/neutron)
* [Answers](https://answers.launchpad.net/neutron)

# [OSSA-2021-005] Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts (CVE-2021-40085)

Bug #1939733 reported by
[Pavel Toporkov](https://launchpad.net/~paul-axe)
on 2021-08-12

[276](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |
|  | [Ubuntu Cloud Archive](https://bugs.launchpad.net/cloud-archive) | New | Undecided | Unassigned |  |
|  | [Queens](https://bugs.launchpad.net/cloud-archive/queens) | Fix Released | Undecided | Unassigned |  |
|  | [Rocky](https://bugs.launchpad.net/cloud-archive/rocky) | Fix Released | Undecided | Unassigned |  |
|  | [Stein](https://bugs.launchpad.net/cloud-archive/stein) | Fix Released | Undecided | Unassigned |  |
|  | [Train](https://bugs.launchpad.net/cloud-archive/train) | Fix Released | Undecided | Unassigned |  |
|  | [Ussuri](https://bugs.launchpad.net/cloud-archive/ussuri) | Fix Committed | Undecided | Unassigned |  |
|  | [Victoria](https://bugs.launchpad.net/cloud-archive/victoria) | Fix Committed | Undecided | Unassigned |  |
|  | [Wallaby](https://bugs.launchpad.net/cloud-archive/wallaby) | Fix Committed | Undecided | Unassigned |  |
|  | [Xena](https://bugs.launchpad.net/cloud-archive/xena) | New | Undecided | Unassigned |  |
|  | [neutron](https://bugs.launchpad.net/neutron) | Fix Released | Critical | [Slawek Kaplonski](https://launchpad.net/~slaweq) |  |
|  | [neutron (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/neutron "Latest release: 2:20.5.0-0ubuntu2, uploaded to main on 2024-11-13 17:20:10.746068+00:00 by Seyeong Kim (seyeongkim), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |
|  | [Bionic](https://bugs.launchpad.net/ubuntu/bionic/%2Bsource/neutron) | New | Undecided | Unassigned |  |
|  | [Focal](https://bugs.launchpad.net/ubuntu/focal/%2Bsource/neutron) | Fix Released | Undecided | Unassigned |  |
|  | [Hirsute](https://bugs.launchpad.net/ubuntu/hirsute/%2Bsource/neutron) | Won't Fix | Undecided | Unassigned |  |
|  | [Impish](https://bugs.launchpad.net/ubuntu/impish/%2Bsource/neutron) | Fix Released | Undecided | Unassigned |  |

### Bug Description

Application doesnt check the input values for extra\_dhcp\_opts port parameter allowing user to use a newline character. The values from extra\_dhcp\_opts are used in rendering of opts file which is passed to dnsmasq as a dhcp-optsfile. Considering this, an attacker can inject any options to that file.

The main direct impact in my opinion is that attacker can push arbitrary dhcp options to another instances connected to the same network. And due to we are able to modify our own port connected to external network, it is possible to push dhcp options to the instances of another tennants using the same external network.

If we go further, there is an known buffer overflow vulnerability in dnsmasq (<https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commitdiff;h=7d04e17444793a840f98a0283968b96502b112dc>) which was not considered as a security issue due to attacker cannot control dhcp opts in most cases and therefore this vulnerability is still exists in most distributives (e.g Ubuntu 20.04.1). In our case dhcp opts is exactly what attacker can modify, so we can trigger buffer overflow there. I even managed to write an exploit which lead to a remote code execution using this buffer overflow vulnerability.

Here the payload to crash dnsmasq as a proof of concept:

```

PUT /v2.0/ports/9db67e0f-537c-494a-a655-c8a0c518d57e HTTP/1.1

Host: openstack

X-Auth-Token: TOKEN

Content-Type: application/json

Content-Length: 170

{"port":{

"extra\_dhcp\_opts":[{"opt\_name":"zzz",

"opt\_value":"xxx\n128,aa:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n120,aa.cc\n128,:"

}]}}

```

Tested on ocata, train and victoria versions.

Vulnerability was found by Pavel Toporkov

See [original description](comments/0)

Tags:

[patch](/neutron/%2Bbugs?field.tag=patch)

## CVE References

* [2021-40085](/bugs/cve/2021-40085 "An issue was discovered in OpenStack ...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-12: |  |  | [#1](/neutron/%2Bbug/1939733/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete

security advisory task has been added while the core security

reviewers for the affected project or projects confirm the bug and

discuss the scope of any vulnerability along with potential

solutions.

Since this report concerns a possible security risk, an incomplete
security advisory task has been added while the core security
reviewers for the affected project or projects confirm the bug and
discuss the scope of any vulnerability along with potential
solutions.

| **description**: | updated |
| --- | --- |
| Changed in ossa: | |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-16: |  |  | [#2](/neutron/%2Bbug/1939733/comments/2) |
| --- | --- | --- | --- |

Thx for reporting it. It seems like it should be private for now. I will work on it.

Thx for reporting it. It seems like it should be private for now. I will work on it.

| Changed in neutron: | |
| --- | --- |
| **assignee**: | nobody → Slawek Kaplonski (slaweq) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-17: |  |  | [#3](/neutron/%2Bbug/1939733/comments/3) |
| --- | --- | --- | --- |

* [Fix v1](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5518537/%2Bfiles/0001-Remove-newline-character-from-dhcp_extra_opt-values.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5518537)
  (3.5 KiB,
  text/plain)

Fix like that can be backported to stable branches. In the future we may propose fix on the API side (in neutron-lib) to remove such newline chars before saving them in db.

Fix like that can be backported to stable branches. In the future we may propose fix on the API side (in neutron-lib) to remove such newline chars before saving them in db.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Rodolfo Alonso (rodolfo-alonso-hernandez)](https://launchpad.net/~rodolfo-alonso-hernandez) wrote on 2021-08-17: |  |  | [#4](/neutron/%2Bbug/1939733/comments/4) |
| --- | --- | --- | --- |

@Slawek, I would split the opt\_value string each time, instead of removing the "\n". That will take only the first part of the string, removing the tail.

>>> opt\_value = "xxx\n128,aa:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n120,aa.cc\n128,:"

>>> opt\_value.split()[0]

"xxx"

@Slawek, I would split the opt\_value string each time, instead of removing the "\n". That will take only the first part of the string, removing the tail.
>>> opt\_value = "xxx\n128,aa:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n120,aa.cc\n128,:"
>>> opt\_value.split()[0]
"xxx"

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-17: |  |  | [#5](/neutron/%2Bbug/1939733/comments/5) |
| --- | --- | --- | --- |

* [Fix v2](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5518554/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5518554)
  (3.6 KiB,
  text/plain)

@Rodolfo, thx for review of the patch. I prepared new version of the patch. Please check it.

@Rodolfo, thx for review of the patch. I prepared new version of the patch. Please check it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-17: |  |  | [#6](/neutron/%2Bbug/1939733/comments/6) |
| --- | --- | --- | --- |

Naive question, but can the same bug be exploited with other characters besides linefeed? Maybe carriage returns (\r), form feeds (\f), or vertical tabs (\v) are treated similarly by dnsmasq?

Naive question, but can the same bug be exploited with other characters besides linefeed? Maybe carriage returns (\r), form feeds (\f), or vertical tabs (\v) are treated similarly by dnsmasq?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pavel Toporkov (paul-axe)](https://launchpad.net/~paul-axe) wrote on 2021-08-18:  [**Re: [Bug 1939733] Re: Remote Code Execution via extra\_dhcp\_opts**](/neutron/%2Bbug/1939733/comments/7) |  |  | [#7](/neutron/%2Bbug/1939733/comments/7) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1939733/comments/7/%2Bdownload) (3.6 KiB)

dnsmasq reads the config file using `fgets` functions, so it depends on its

implementation. As far as i know, the default glibc supports only \n

character as a line delimiter

On Tue, Aug 17, 2021 at 6:41 PM Jeremy Stanley <email address hidden>

wrote:

> Naive question, but can the same bug be exploited with other characters

> besides linefeed? Maybe carriage returns (\r), form feeds (\f), or

> vertical tabs (\v) are treated similarly by dnsmasq?

>

> --

> You received this bug notification because you are subscribed to the bug

> report.

> <https://bugs.launchpad.net/bugs/1939733>

>

> Title:

> Remote Code Execution via extra\_dhcp\_opts

>

> Status in neutron:

> New

> Status in OpenStack Security Advisory:

> Incomplete

>

> Bug description:

> This issue is being treated as a potential security risk under

> embargo. Please do not make any public mention of embargoed

> (private) security vulnerabilities before their coordinated

> publication by the OpenStack Vulnerability Management Team in the

> form of an official OpenStack Security Advisory. This includes

> discussion of the bug or associated fixes in public forums such as

> mailing lists, code review systems and bug trackers. Please also

> avoid private disclosure to other individuals not already approved

> for access to this information, and provide this same reminder to

> those who are made aware of the issue prior to publication. All

> discussion should remain confined to this private bug report, and

> any proposed fixes should be added to the bug as attachments. This

> embargo shall not extend past 2021-11-10 and will be made

> public by or on that date even if no fix is identified.

>

> Application doesnt check the input values for extra\_dhcp\_opts port

> parameter allowing user to use a newline character. The values from

> extra\_dhcp\_opts are used in rendering of opts file which is passed to

> dnsmasq as a dhcp-optsfile. Considering this, an attacker can inject

> any options to that file.

>

> The main direct impact in my opinion is that attacker can push

> arbitrary dhcp options to another instances connected to the same

> network. And due to we are able to modify our own port connected to

> external network, it is possible to push dhcp options to the instances

> of another tennants using the same external network.

>

> If we go further, there is an known buffer overflow vulnerability in

> dnsmasq

> (

> <https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commitdiff;h=7d04e17444793a840f98a0283968b96502b112dc>

> )

> which was not considered as a security issue due to attacker cannot

> control dhcp opts in most cases and therefore this vulnerability is

> still exists in most distributives (e.g Ubuntu 20.04.1). In our case

> dhcp opts is exactly what attacker can modify, so we can trigger

> buffer overflow there. I even managed to write an exploit which lead

> to a remote code execution using this buffer overflow vulnerability.

>

> Here the payload to crash dnsmasq as a proof of concept:

> ```

> PUT /v2.0/ports/9db67e0f-537c-494a-a655-c8a0c518d57e HTTP/1.1

> Host: openstack

> X-Auth-Token: TOKEN

> Content-Type: ...

[Read more...](/neutron/%2Bbug/1939733/comments/7)

dnsmasq reads the config file using `fgets` functions, so it depends on its
implementation. As far as i know, the default glibc supports only \n
character as a line delimiter
On Tue, Aug 17, 2021 at 6:41 PM Jeremy Stanley <1939733@bugs.launchpad.net>
wrote:
> Naive question, but can the same bug be exploited with other characters
> besides linefeed? Maybe carriage returns (\r), form feeds (\f), or
> vertical tabs (\v) are treated similarly by dnsmasq?
>
> --
> You received this bug notification because you are subscribed to the bug
> report.
> https://bugs.launchpad.net/bugs/1939733
>
> Title:
> Remote Code Execution via extra\_dhcp\_opts
>
> Status in neutron:
> New
> Status in OpenStack Security Advisory:
> Incomplete
>
> Bug description:
> This issue is being treated as a potential security risk under
> embargo. Please do not make any public mention of embargoed
> (private) security vulnerabilities before their coordinated
> publication by the OpenStack Vulnerability Management Team in the
> form of an official OpenStack Security Advisory. This includes
> discussion of the bug or associated fixes in public forums such as
> mailing lists, code review systems and bug trackers. Please also
> avoid private disclosure to other individuals not already approved
> for access to this information, and provide this same reminder to
> those who are made aware of the issue prior to publication. All
> discussion should remain confined to this private bug report, and
> any proposed fixes should be added to the bug as attachments. This
> embargo shall not extend past 2021-11-10 and will be made
> public by or on that date even if no fix is identified.
>
> Application doesnt check the input values for extra\_dhcp\_opts port
> parameter allowing user to use a newline character. The values from
> extra\_dhcp\_opts are used in rendering of opts file which is passed to
> dnsmasq as a dhcp-optsfile. Considering this, an attacker can inject
> any options to that file.
>
> The main direct impact in my opinion is that attacker can push
> arbitrary dhcp options to another instances connected to the same
> network. And due to we are able to modify our own port connected to
> external network, it is possible to push dhcp options to the instances
> of another tennants using the same external network.
>
> If we go further, there is an known buffer overflow vulnerability in
> dnsmasq
> (
> https://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commitdiff;h=7d04e17444793a840f98a0283968b96502b112dc
> )
> which was not considered as a security issue due to attacker cannot
> control dhcp opts in most cases and therefore this vulnerability is
> still exists in most distributives (e.g Ubuntu 20.04.1). In our case
> dhcp opts is exactly what attacker can modify, so we can trigger
> buffer overflow there. I even managed to write an exploit which lead
> to a remote code execution using this buffer overflow vulnerability.
>
> Here the payload to crash dnsmasq as a proof of concept:
> ```
> PUT /v2.0/ports/9db67e0f-537c-494a-a655-c8a0c518d57e HTTP/1.1
> Host: openstack
> X-Auth-Token: TOKEN
> Content-Type: application/json
> Content-Length: 170
>
> {"port":{
> "extra\_dhcp\_opts":[{"opt\_name":"zzz",
>
> "opt\_value":"xxx\n128,aa:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\n120,aa.cc\n128,:"
> }]}}
> ```
>
> Tested on ocata, train and victoria versions.
>
> Vulnerability was found by Pavel Toporkov
>
> To manage notifications about this bug go to:
> https://bugs.launchpad.net/neutron/+bug/1939733/+subscriptions
>
>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-18:  [**Re: Remote Code Execution via extra\_dhcp\_opts**](/neutron/%2Bbug/1939733/comments/8) |  |  | [#8](/neutron/%2Bbug/1939733/comments/8) |
| --- | --- | --- | --- |

Thanks. I suppose my remaining concern is more of a theoretical one in that case... dnsmasq does not expect untrusted users to supply configuration, and therefore is not overly concerned with risks related to that workflow. As a result, any bugs in dnsmasq's configuration handling become Neutron security risks and therefore OpenStack's responsibility to deal with. In the long term, this does not seem like a sustainable model under which to operate.

In the near term, I agree the proposed solution should suffice, and since it seems to be backportable to all supported stable branches I'll get started on the impact description and coordinated disclosure timeline for an embargoed security advisory.

Thanks. I suppose my remaining concern is more of a theoretical one in that case... dnsmasq does not expect untrusted users to supply configuration, and therefore is not overly concerned with risks related to that workflow. As a result, any bugs in dnsmasq's configuration handling become Neutron security risks and therefore OpenStack's responsibility to deal with. In the long term, this does not seem like a sustainable model under which to operate.
In the near term, I agree the proposed solution should suffice, and since it seems to be backportable to all supported stable branches I'll get started on the impact description and coordinated disclosure timeline for an embargoed security advisory.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |
| **importance**: | Undecided → High |
| **assignee**: | nobody → Jeremy Stanley (fungi) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-19: |  |  | [#9](/neutron/%2Bbug/1939733/comments/9) |
| --- | --- | --- | --- |

Here's an initial draft for an impact description. Please review and comment. If this summary reasonably captures the vulnerability, I'll use it as the basis for our CVE request to MITRE, notification to downstream stakeholders, and eventual security advisory. Also, Pavel, please let me know if you have any organization you want credited with the discovery alongside your name.

Title: Exposure of dnsmasq buffer overflow via extra\_dhcp\_opts

Reporter: Pavel Toporkov

Products: Neutron

Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1

Description:

Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may trigger a configuration parsing buffer overflow in some older versions of dnsmasq, resulting in denial of service or remote code execution on the hosts where dnsmasq is running. Only deployments with dnsmasq prior to 2.81 or without commit 7d04e17 applied are affected.

Here's an initial draft for an impact description. Please review and comment. If this summary reasonably captures the vulnerability, I'll use it as the basis for our CVE request to MITRE, notification to downstream stakeholders, and eventual security advisory. Also, Pavel, please let me know if you have any organization you want credited with the discovery alongside your name.
Title: Exposure of dnsmasq buffer overflow via extra\_dhcp\_opts
Reporter: Pavel Toporkov
Products: Neutron
Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1
Description:
Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may trigger a configuration parsing buffer overflow in some older versions of dnsmasq, resulting in denial of service or remote code execution on the hosts where dnsmasq is running. Only deployments with dnsmasq prior to 2.81 or without commit 7d04e17 applied are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-19: |  |  | [#10](/neutron/%2Bbug/1939733/comments/10) |
| --- | --- | --- | --- |

On revisiting the initial bug description, I see that I've failed to capture the aspect where the user can also append lines for other configuration outside the options list itself. I'll try to come up with a better summary incorporating that.

On revisiting the initial bug description, I see that I've failed to capture the aspect where the user can also append lines for other configuration outside the options list itself. I'll try to come up with a better summary incorporating that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-19: |  |  | [#11](/neutron/%2Bbug/1939733/comments/11) |
| --- | --- | --- | --- |

Here's a revised impact description:

Title: Exposure of dnsmasq buffer overflow via extra\_dhcp\_opts

Reporter: Pavel Toporkov

Products: Neutron

Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1

Description:

Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may add arbitrary configuration to the dnsmasq process in order to crash the service, change parameters for other tenants sharing the same interface, or otherwise alter that daemon's behavior. This vulnerability may also be used to trigger a configuration parsing buffer overflow in versions of dnsmasq prior 2.81, which could lead to remote code execution. All Neutron deployments are affected.

Here's a revised impact description:
Title: Exposure of dnsmasq buffer overflow via extra\_dhcp\_opts
Reporter: Pavel Toporkov
Products: Neutron
Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1
Description:
Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may add arbitrary configuration to the dnsmasq process in order to crash the service, change parameters for other tenants sharing the same interface, or otherwise alter that daemon's behavior. This vulnerability may also be used to trigger a configuration parsing buffer overflow in versions of dnsmasq prior 2.81, which could lead to remote code execution. All Neutron deployments are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-19: |  |  | [#12](/neutron/%2Bbug/1939733/comments/12) |
| --- | --- | --- | --- |

I also meant to redo the title. How's this?

Title: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts

I also meant to redo the title. How's this?
Title: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-19: |  |  | [#13](/neutron/%2Bbug/1939733/comments/13) |
| --- | --- | --- | --- |

I also seem to have introduced a typo in the penultimate sentence, that should say "versions of dnsmasq prior to 2.81" (I somehow lost the "to" in the most recent revision).

I also seem to have introduced a typo in the penultimate sentence, that should say "versions of dnsmasq prior to 2.81" (I somehow lost the "to" in the most recent revision).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pavel Toporkov (paul-axe)](https://launchpad.net/~paul-axe) wrote on 2021-08-20: |  |  | [#14](/neutron/%2Bbug/1939733/comments/14) |
| --- | --- | --- | --- |

I reviewed the description and it seems to be OK.

I reviewed the description and it seems to be OK.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-20: |  |  | [#15](/neutron/%2Bbug/1939733/comments/15) |
| --- | --- | --- | --- |

Thanks Pavel, also please let me know if you have any organization you want credited with the discovery alongside your name.

Slawek: Rodolfo: If the patch in comment #5 is deemed a sufficient fix for master (Xena), then once someone attaches viable backports for stable/wallaby, stable/victoria, and stable/ussuri branches, I'll schedule a disclosure date and prepare notification under embargo for our downstream stakeholders (distribution package maintainers, public cloud security contacts, and so on).

Thanks Pavel, also please let me know if you have any organization you want credited with the discovery alongside your name.
Slawek: Rodolfo: If the patch in comment #5 is deemed a sufficient fix for master (Xena), then once someone attaches viable backports for stable/wallaby, stable/victoria, and stable/ussuri branches, I'll schedule a disclosure date and prepare notification under embargo for our downstream stakeholders (distribution package maintainers, public cloud security contacts, and so on).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Pavel Toporkov (paul-axe)](https://launchpad.net/~paul-axe) wrote on 2021-08-20: |  |  | [#16](/neutron/%2Bbug/1939733/comments/16) |
| --- | --- | --- | --- |

No, please credit only my name there

No, please credit only my name there

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-22: |  |  | [#17](/neutron/%2Bbug/1939733/comments/17) |
| --- | --- | --- | --- |

Okay, this is what I'll use to request a CVE assignment from MITRE. Once viable backports for stable/wallaby, stable/victoria, and stable/ussuri branches are attached, I'll schedule a disclosure date and prepare notification under embargo for our downstream stakeholders...

Title: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts

Reporter: Pavel Toporkov

Products: Neutron

Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1

Description:

Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may add arbitrary configuration to the dnsmasq process in order to crash the service, change parameters for other tenants sharing the same interface, or otherwise alter that daemon's behavior. This vulnerability may also be used to trigger a configuration parsing buffer overflow in versions of dnsmasq prior to 2.81, which could lead to remote code execution. All Neutron deployments are affected.

Okay, this is what I'll use to request a CVE assignment from MITRE. Once viable backports for stable/wallaby, stable/victoria, and stable/ussuri branches are attached, I'll schedule a disclosure date and prepare notification under embargo for our downstream stakeholders...
Title: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts
Reporter: Pavel Toporkov
Products: Neutron
Affects: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1
Description:
Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may add arbitrary configuration to the dnsmasq process in order to crash the service, change parameters for other tenants sharing the same interface, or otherwise alter that daemon's behavior. This vulnerability may also be used to trigger a configuration parsing buffer overflow in versions of dnsmasq prior to 2.81, which could lead to remote code execution. All Neutron deployments are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Akihiro Motoki (amotoki)](https://launchpad.net/~amotoki) wrote on 2021-08-23: |  |  | [#18](/neutron/%2Bbug/1939733/comments/18) |
| --- | --- | --- | --- |

The proposed fix no longer allows the reported security issue, but can we block it at the API level too?

If the neutron API does not allow multi-line string in the API level, we can block it for further API operations.

Note that we need to consider such extra\_dhcp\_options is already injected, so the proposed fix is required and it looks good.

Perhaps blocking it at the API level is optional so it can be done as a follow-up after the proposed fix is applied.

What in my mind is to implement a validator like below in the API level.

def \_validate\_oneline\_string(data, max\_len=None):

     msg = validators.validate\_string(data, max\_len)

     if msg:

         return msg

     lines = data.splitlines()

     if lines and lines[0] != data:

         msg = \_("Multi-line string is not allowed: '%s'") % data

         LOG.debug(msg)

         return msg

The proposed fix no longer allows the reported security issue, but can we block it at the API level too?
If the neutron API does not allow multi-line string in the API level, we can block it for further API operations.
Note that we need to consider such extra\_dhcp\_options is already injected, so the proposed fix is required and it looks good.
Perhaps blocking it at the API level is optional so it can be done as a follow-up after the proposed fix is applied.
What in my mind is to implement a validator like below in the API level.
def \_validate\_oneline\_string(data, max\_len=None):
msg = validators.validate\_string(data, max\_len)
if msg:
return msg
lines = data.splitlines()
if lines and lines[0] != data:
msg = \_("Multi-line string is not allowed: '%s'") % data
LOG.debug(msg)
return msg

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-23: |  |  | [#19](/neutron/%2Bbug/1939733/comments/19) |
| --- | --- | --- | --- |

* [Fix v2 for stable/wallaby](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519980/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-wallaby.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519980)
  (3.6 KiB,
  text/plain)

Stable/wallaby backport

Stable/wallaby backport

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-23: |  |  | [#20](/neutron/%2Bbug/1939733/comments/20) |
| --- | --- | --- | --- |

* [Fix v2 for stable/victoria](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519981/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-victoria.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519981)
  (3.6 KiB,
  text/plain)

Stable/victoria backport

Stable/victoria backport

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-23: |  |  | [#21](/neutron/%2Bbug/1939733/comments/21) |
| --- | --- | --- | --- |

* [Fix v2 for stable/ussuri](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519982/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-ussuri.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519982)
  (3.6 KiB,
  text/plain)

Stable/ussuri backport

Stable/ussuri backport

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-23: |  |  | [#22](/neutron/%2Bbug/1939733/comments/22) |
| --- | --- | --- | --- |

@Akihiro - that was my idea also but I wanted to do it as next step later. First I wanted to propose solution which can be easily backported.

When that will be solved, I can propose API level validation, some db migration script for existing entries, etc. as a follow-up. Is that ok for You?

@Akihiro - that was my idea also but I wanted to do it as next step later. First I wanted to propose solution which can be easily backported.
When that will be solved, I can propose API level validation, some db migration script for existing entries, etc. as a follow-up. Is that ok for You?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Akihiro Motoki (amotoki)](https://launchpad.net/~amotoki) wrote on 2021-08-23: |  |  | [#23](/neutron/%2Bbug/1939733/comments/23) |
| --- | --- | --- | --- |

@Slawek, it totally works for me. Thanks.

@Slawek, it totally works for me. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-23: |  |  | [#24](/neutron/%2Bbug/1939733/comments/24) |
| --- | --- | --- | --- |

Assuming I get a response from MITRE in the next 24 hours, I'd like to schedule the coordinated disclosure (when we'll switch this bug to public security and push the attached patches to Gerrit) for 15:00 UTC Tuesday 2021-08-31, a week from tomorrow. Is that date and time acceptable to everyone?

Assuming I get a response from MITRE in the next 24 hours, I'd like to schedule the coordinated disclosure (when we'll switch this bug to public security and push the attached patches to Gerrit) for 15:00 UTC Tuesday 2021-08-31, a week from tomorrow. Is that date and time acceptable to everyone?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq) wrote on 2021-08-24: |  |  | [#25](/neutron/%2Bbug/1939733/comments/25) |
| --- | --- | --- | --- |

@Akihiro - thx.

@Jeremy - that works for me, thx a lot.

@Akihiro - thx.
@Jeremy - that works for me, thx a lot.

[Akihiro Motoki (amotoki)](https://launchpad.net/~amotoki)
on 2021-08-25

| Changed in neutron: | |
| --- | --- |
| **importance**: | Undecided → Critical |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2021-08-25

| **summary**: | - Remote Code Execution via extra\_dhcp\_opts+ Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts (CVE-2021-40085) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-25:  [**Re: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts (CVE-2021-40085)**](/neutron/%2Bbug/1939733/comments/26) |  |  | [#26](/neutron/%2Bbug/1939733/comments/26) |
| --- | --- | --- | --- |

Now that MITRE has responded with a CVE assignment, the proposed patches (from comments #5, #19, #20, and #21) have been privately supplied to downstream stakeholders along with a copy of the impact description (from comment #17). We are still within our downstream notification window to be able to proceed with coordinated disclosure at 15:00 UTC on 2021-08-31.

Now that MITRE has responded with a CVE assignment, the proposed patches (from comments #5, #19, #20, and #21) have been privately supplied to downstream stakeholders along with a copy of the impact description (from comment #17). We are still within our downstream notification window to be able to proceed with coordinated disclosure at 15:00 UTC on 2021-08-31.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-31: |  |  | [#27](/neutron/%2Bbug/1939733/comments/27) |
| --- | --- | --- | --- |

Double-checking, is Slawek or one of the other Neutron core reviewers available to get the fix and backports from comments #5, #19, #20, and #21 pushed to Gerrit in roughly half an hour (around 14:00 UTC)? That will give me time to identify the change numbers for inclusion in the public advisory scheduled to go out at 15:00 UTC.

If there's no one available, I'll push the patches to Gerrit myself, but it would be better to have a Neutron core reviewer taking care of it and also working on expedited approvals so we can get them merged as quickly as possible (I can prioritize them in the gate pipeline once they're approved, to speed things along even more).

Double-checking, is Slawek or one of the other Neutron core reviewers available to get the fix and backports from comments #5, #19, #20, and #21 pushed to Gerrit in roughly half an hour (around 14:00 UTC)? That will give me time to identify the change numbers for inclusion in the public advisory scheduled to go out at 15:00 UTC.
If there's no one available, I'll push the patches to Gerrit myself, but it would be better to have a Neutron core reviewer taking care of it and also working on expedited approvals so we can get them merged as quickly as possible (I can prioritize them in the gate pipeline once they're approved, to speed things along even more).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-31: |  |  | [#28](/neutron/%2Bbug/1939733/comments/28) |
| --- | --- | --- | --- |

I heard back from Slawek in IRC and he's pushing the changes to Gerrit now.

I heard back from Slawek in IRC and he's pushing the changes to Gerrit now.

| **information type**: | Private Security → Public Security |
| --- | --- |
| **description**: | updated |
| **summary**: | - Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts (CVE-2021-40085)+ [OSSA-2021-005] Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts+ (CVE-2021-40085) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1939733/comments/29) |  |  | [#29](/neutron/%2Bbug/1939733/comments/29) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: [https://review.opendev.org/c/openstack/neutron/+/806746](https://review.opendev.org/c/openstack/neutron/%2B/806746)

Fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/neutron/+/806746

| Changed in neutron: | |
| --- | --- |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix proposed to neutron (stable/wallaby)**](/neutron/%2Bbug/1939733/comments/30) |  |  | [#30](/neutron/%2Bbug/1939733/comments/30) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/wallaby

Review: [https://review.opendev.org/c/openstack/neutron/+/806748](https://review.opendev.org/c/openstack/neutron/%2B/806748)

Fix proposed to branch: stable/wallaby
Review: https://review.opendev.org/c/openstack/neutron/+/806748

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix proposed to neutron (stable/victoria)**](/neutron/%2Bbug/1939733/comments/31) |  |  | [#31](/neutron/%2Bbug/1939733/comments/31) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/victoria

Review: [https://review.opendev.org/c/openstack/neutron/+/806749](https://review.opendev.org/c/openstack/neutron/%2B/806749)

Fix proposed to branch: stable/victoria
Review: https://review.opendev.org/c/openstack/neutron/+/806749

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix proposed to neutron (stable/ussuri)**](/neutron/%2Bbug/1939733/comments/32) |  |  | [#32](/neutron/%2Bbug/1939733/comments/32) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/ussuri

Review: [https://review.opendev.org/c/openstack/neutron/+/806750](https://review.opendev.org/c/openstack/neutron/%2B/806750)

Fix proposed to branch: stable/ussuri
Review: https://review.opendev.org/c/openstack/neutron/+/806750

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix proposed to ossa (master)**](/neutron/%2Bbug/1939733/comments/33) |  |  | [#33](/neutron/%2Bbug/1939733/comments/33) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: [https://review.opendev.org/c/openstack/ossa/+/806754](https://review.opendev.org/c/openstack/ossa/%2B/806754)

Fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/ossa/+/806754

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-08-31:  [**Fix merged to ossa (master)**](/neutron/%2Bbug/1939733/comments/34) |  |  | [#34](/neutron/%2Bbug/1939733/comments/34) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/ossa/+/806754](https://review.opendev.org/c/openstack/ossa/%2B/806754)

Committed: <https://opendev.org/openstack/ossa/commit/55e0ee4953446267d7900bda9cdfdc9f44a6b72d>

Submitter: "Zuul (22348)"

Branch: master

commit 55e0ee4953446267d7900bda9cdfdc9f44a6b72d

Author: Jeremy Stanley <email address hidden>

Date: Tue Aug 31 13:56:02 2021 +0000

Add OSSA-2021-005 (CVE-2021-40085)

Change-Id: I58b8c608547e24ee144cab805d17c55045e4279a

    Closes-Bug: #1939733

Reviewed: https://review.opendev.org/c/openstack/ossa/+/806754
Committed: https://opendev.org/openstack/ossa/commit/55e0ee4953446267d7900bda9cdfdc9f44a6b72d
Submitter: "Zuul (22348)"
Branch: master
commit 55e0ee4953446267d7900bda9cdfdc9f44a6b72d
Author: Jeremy Stanley <fungi@yuggoth.org>
Date: Tue Aug 31 13:56:02 2021 +0000
Add OSSA-2021-005 (CVE-2021-40085)
Change-Id: I58b8c608547e24ee144cab805d17c55045e4279a
Closes-Bug: #1939733

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-08-31: |  |  | [#35](/neutron/%2Bbug/1939733/comments/35) |
| --- | --- | --- | --- |

<https://security.openstack.org/ossa/OSSA-2021-005.html> is published, announcements have been sent to the usual mailing lists, and MITRE has been notified to switch the assigned CVE public.

https://security.openstack.org/ossa/OSSA-2021-005.html is published, announcements have been sent to the usual mailing lists, and MITRE has been notified to switch the assigned CVE public.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-01:  [**Fix proposed to neutron (stable/train)**](/neutron/%2Bbug/1939733/comments/36) |  |  | [#36](/neutron/%2Bbug/1939733/comments/36) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/train

Review: [https://review.opendev.org/c/openstack/neutron/+/806707](https://review.opendev.org/c/openstack/neutron/%2B/806707)

Fix proposed to branch: stable/train
Review: https://review.opendev.org/c/openstack/neutron/+/806707

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-01:  [**Fix proposed to neutron (stable/stein)**](/neutron/%2Bbug/1939733/comments/37) |  |  | [#37](/neutron/%2Bbug/1939733/comments/37) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/stein

Review: [https://review.opendev.org/c/openstack/neutron/+/806708](https://review.opendev.org/c/openstack/neutron/%2B/806708)

Fix proposed to branch: stable/stein
Review: https://review.opendev.org/c/openstack/neutron/+/806708

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-01:  [**Fix proposed to neutron (stable/rocky)**](/neutron/%2Bbug/1939733/comments/38) |  |  | [#38](/neutron/%2Bbug/1939733/comments/38) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/rocky

Review: [https://review.opendev.org/c/openstack/neutron/+/806862](https://review.opendev.org/c/openstack/neutron/%2B/806862)

Fix proposed to branch: stable/rocky
Review: https://review.opendev.org/c/openstack/neutron/+/806862

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-01:  [**Fix proposed to neutron (stable/queens)**](/neutron/%2Bbug/1939733/comments/39) |  |  | [#39](/neutron/%2Bbug/1939733/comments/39) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/queens

Review: [https://review.opendev.org/c/openstack/neutron/+/806709](https://review.opendev.org/c/openstack/neutron/%2B/806709)

Fix proposed to branch: stable/queens
Review: https://review.opendev.org/c/openstack/neutron/+/806709

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton) wrote on 2021-09-01: |  |  | [#40](/neutron/%2Bbug/1939733/comments/40) |
| --- | --- | --- | --- |

The attachment "Fix v1" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

The attachment "Fix v1" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.
[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-02:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1939733/comments/41) |  |  | [#41](/neutron/%2Bbug/1939733/comments/41) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806746](https://review.opendev.org/c/openstack/neutron/%2B/806746)

Committed: <https://opendev.org/openstack/neutron/commit/df891f0593d234e01f27d7c0376d9702e178ecfb>

Submitter: "Zuul (22348)"

Branch: master

commit df891f0593d234e01f27d7c0376d9702e178ecfb

Author: Slawek Kaplonski <email address hidden>

Date: Tue Aug 31 15:43:11 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806746
Committed: https://opendev.org/openstack/neutron/commit/df891f0593d234e01f27d7c0376d9702e178ecfb
Submitter: "Zuul (22348)"
Branch: master
commit df891f0593d234e01f27d7c0376d9702e178ecfb
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Tue Aug 31 15:43:11 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

| Changed in neutron: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-02:  [**Fix merged to neutron (stable/wallaby)**](/neutron/%2Bbug/1939733/comments/42) |  |  | [#42](/neutron/%2Bbug/1939733/comments/42) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806748](https://review.opendev.org/c/openstack/neutron/%2B/806748)

Committed: <https://opendev.org/openstack/neutron/commit/35a32a1cadf2a6bc182b3c7d7ae46e7cea73576a>

Submitter: "Zuul (22348)"

Branch: stable/wallaby

commit 35a32a1cadf2a6bc182b3c7d7ae46e7cea73576a

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806748
Committed: https://opendev.org/openstack/neutron/commit/35a32a1cadf2a6bc182b3c7d7ae46e7cea73576a
Submitter: "Zuul (22348)"
Branch: stable/wallaby
commit 35a32a1cadf2a6bc182b3c7d7ae46e7cea73576a
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-02:  [**Fix merged to neutron (stable/victoria)**](/neutron/%2Bbug/1939733/comments/43) |  |  | [#43](/neutron/%2Bbug/1939733/comments/43) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806749](https://review.opendev.org/c/openstack/neutron/%2B/806749)

Committed: <https://opendev.org/openstack/neutron/commit/a08e21c15b766a1e3b2b64ae15f95565d9ea6688>

Submitter: "Zuul (22348)"

Branch: stable/victoria

commit a08e21c15b766a1e3b2b64ae15f95565d9ea6688

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806749
Committed: https://opendev.org/openstack/neutron/commit/a08e21c15b766a1e3b2b64ae15f95565d9ea6688
Submitter: "Zuul (22348)"
Branch: stable/victoria
commit a08e21c15b766a1e3b2b64ae15f95565d9ea6688
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-07:  [**Fix merged to neutron (stable/ussuri)**](/neutron/%2Bbug/1939733/comments/44) |  |  | [#44](/neutron/%2Bbug/1939733/comments/44) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806750](https://review.opendev.org/c/openstack/neutron/%2B/806750)

Committed: <https://opendev.org/openstack/neutron/commit/6ac5bc583787b7af6273d5344fcbeef69a48e2e3>

Submitter: "Zuul (22348)"

Branch: stable/ussuri

commit 6ac5bc583787b7af6273d5344fcbeef69a48e2e3

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806750
Committed: https://opendev.org/openstack/neutron/commit/6ac5bc583787b7af6273d5344fcbeef69a48e2e3
Submitter: "Zuul (22348)"
Branch: stable/ussuri
commit 6ac5bc583787b7af6273d5344fcbeef69a48e2e3
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-09:  [**Fix merged to neutron (stable/rocky)**](/neutron/%2Bbug/1939733/comments/45) |  |  | [#45](/neutron/%2Bbug/1939733/comments/45) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806862](https://review.opendev.org/c/openstack/neutron/%2B/806862)

Committed: <https://opendev.org/openstack/neutron/commit/e291dca5d97fc986fc7d85b8ea256a483d815277>

Submitter: "Zuul (22348)"

Branch: stable/rocky

commit e291dca5d97fc986fc7d85b8ea256a483d815277

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Conflicts:

        neutron/tests/unit/agent/linux/test\_dhcp.py

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806862
Committed: https://opendev.org/openstack/neutron/commit/e291dca5d97fc986fc7d85b8ea256a483d815277
Submitter: "Zuul (22348)"
Branch: stable/rocky
commit e291dca5d97fc986fc7d85b8ea256a483d815277
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Conflicts:
neutron/tests/unit/agent/linux/test\_dhcp.py
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-09:  [**Fix merged to neutron (stable/queens)**](/neutron/%2Bbug/1939733/comments/46) |  |  | [#46](/neutron/%2Bbug/1939733/comments/46) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806709](https://review.opendev.org/c/openstack/neutron/%2B/806709)

Committed: <https://opendev.org/openstack/neutron/commit/110fed07cb83deb3abd85073cb351066713b6384>

Submitter: "Zuul (22348)"

Branch: stable/queens

commit 110fed07cb83deb3abd85073cb351066713b6384

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Conflicts:

        neutron/tests/unit/agent/linux/test\_dhcp.py

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806709
Committed: https://opendev.org/openstack/neutron/commit/110fed07cb83deb3abd85073cb351066713b6384
Submitter: "Zuul (22348)"
Branch: stable/queens
commit 110fed07cb83deb3abd85073cb351066713b6384
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Conflicts:
neutron/tests/unit/agent/linux/test\_dhcp.py
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-09:  [**Fix merged to neutron (stable/stein)**](/neutron/%2Bbug/1939733/comments/47) |  |  | [#47](/neutron/%2Bbug/1939733/comments/47) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806708](https://review.opendev.org/c/openstack/neutron/%2B/806708)

Committed: <https://opendev.org/openstack/neutron/commit/e2d6e2d5d2388cd7c135a50129466aaa7ca85cbf>

Submitter: "Zuul (22348)"

Branch: stable/stein

commit e2d6e2d5d2388cd7c135a50129466aaa7ca85cbf

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806708
Committed: https://opendev.org/openstack/neutron/commit/e2d6e2d5d2388cd7c135a50129466aaa7ca85cbf
Submitter: "Zuul (22348)"
Branch: stable/stein
commit e2d6e2d5d2388cd7c135a50129466aaa7ca85cbf
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-09:  [**Fix merged to neutron (stable/train)**](/neutron/%2Bbug/1939733/comments/48) |  |  | [#48](/neutron/%2Bbug/1939733/comments/48) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/806707](https://review.opendev.org/c/openstack/neutron/%2B/806707)

Committed: <https://opendev.org/openstack/neutron/commit/757d8c6e322eeda299aa5e055e38b1ed48977f2d>

Submitter: "Zuul (22348)"

Branch: stable/train

commit 757d8c6e322eeda299aa5e055e38b1ed48977f2d

Author: Slawek Kaplonski <email address hidden>

Date: Mon Aug 23 13:01:37 2021 +0200

Remove dhcp\_extra\_opt value after first newline character

Passing newline to the dnsmasq may cause security issues, especially

    that in case of Neutron that dhcp options' values are controlled by

    cloud users.

    This patch removes everything what is after first newline character

    in the dhcp\_extra\_opt's values before passing them to dnsmasq.

Closes-Bug: #1939733

    Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e

    (cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Reviewed: https://review.opendev.org/c/openstack/neutron/+/806707
Committed: https://opendev.org/openstack/neutron/commit/757d8c6e322eeda299aa5e055e38b1ed48977f2d
Submitter: "Zuul (22348)"
Branch: stable/train
commit 757d8c6e322eeda299aa5e055e38b1ed48977f2d
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Mon Aug 23 13:01:37 2021 +0200
Remove dhcp\_extra\_opt value after first newline character
Passing newline to the dnsmasq may cause security issues, especially
that in case of Neutron that dhcp options' values are controlled by
cloud users.
This patch removes everything what is after first newline character
in the dhcp\_extra\_opt's values before passing them to dnsmasq.
Closes-Bug: #1939733
Change-Id: Ifeaf258f0b5ea86f25620ac4116d618980a7272e
(cherry picked from commit df891f0593d234e01f27d7c0376d9702e178ecfb)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-10:  [**Fix included in openstack/neutron 16.4.1**](/neutron/%2Bbug/1939733/comments/49) |  |  | [#49](/neutron/%2Bbug/1939733/comments/49) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 16.4.1 release.

This issue was fixed in the openstack/neutron 16.4.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-10:  [**Fix included in openstack/neutron 17.2.1**](/neutron/%2Bbug/1939733/comments/50) |  |  | [#50](/neutron/%2Bbug/1939733/comments/50) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 17.2.1 release.

This issue was fixed in the openstack/neutron 17.2.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-10:  [**Fix included in openstack/neutron 18.1.1**](/neutron/%2Bbug/1939733/comments/51) |  |  | [#51](/neutron/%2Bbug/1939733/comments/51) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 18.1.1 release.

This issue was fixed in the openstack/neutron 18.1.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-15:  [**Fix included in openstack/neutron 19.0.0.0rc1**](/neutron/%2Bbug/1939733/comments/52) |  |  | [#52](/neutron/%2Bbug/1939733/comments/52) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 19.0.0.0rc1 release candidate.

This issue was fixed in the openstack/neutron 19.0.0.0rc1 release candidate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-09-29:  [**Related fix proposed to neutron-lib (master)**](/neutron/%2Bbug/1939733/comments/53) |  |  | [#53](/neutron/%2Bbug/1939733/comments/53) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: [https://review.opendev.org/c/openstack/neutron-lib/+/811708](https://review.opendev.org/c/openstack/neutron-lib/%2B/811708)

Related fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/neutron-lib/+/811708

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Christian Rohmann (christian-rohmann)](https://launchpad.net/~christian-rohmann) wrote on 2021-10-11: |  |  | [#54](/neutron/%2Bbug/1939733/comments/54) |
| --- | --- | --- | --- |

@Slawek are you also pushing the new packages to Ubuntu Cloud Archive?

i.e. <https://openstack-ci-reports.ubuntu.com/reports/cloud-archive/ussuri_versions.html> does not show any 16.4.1 as of yet.

@Slawek are you also pushing the new packages to Ubuntu Cloud Archive?
i.e. https://openstack-ci-reports.ubuntu.com/reports/cloud-archive/ussuri\_versions.html does not show any 16.4.1 as of yet.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2021-10-11: |  |  | [#55](/neutron/%2Bbug/1939733/comments/55) |
| --- | --- | --- | --- |

Slawek is one of the upstream Neutron developers. One of the Ubuntu package maintainers will need to take care of Ubuntu's package updates. It's probably mildly confusing that this bug report is marked as affecting the upstream project (where it's been fixed for months) but also the Ubuntu packages which still need the report triaged.

Slawek is one of the upstream Neutron developers. One of the Ubuntu package maintainers will need to take care of Ubuntu's package updates. It's probably mildly confusing that this bug report is marked as affecting the upstream project (where it's been fixed for months) but also the Ubuntu packages which still need the report triaged.

[Bernard Cafarelli (bcafarel)](https://launchpad.net/~bcafarel)
on 2021-11-17

| **tags**: | added: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2021-11-25:  [**Related fix merged to neutron-lib (master)**](/neutron/%2Bbug/1939733/comments/56) |  |  | [#56](/neutron/%2Bbug/1939733/comments/56) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron-lib/+/811708](https://review.opendev.org/c/openstack/neutron-lib/%2B/811708)

Committed: <https://opendev.org/openstack/neutron-lib/commit/1f4c4031ee8a0dc91149dc6a83c7051db7628f23>

Submitter: "Zuul (22348)"

Branch: master

commit 1f4c4031ee8a0dc91149dc6a83c7051db7628f23

Author: Slawek Kaplonski <email address hidden>

Date: Wed Sep 29 12:34:17 2021 +0200

Add oneline\_string validators

Those new validators are used to validate extra\_dhcp\_opt's opt\_name and

    opt\_value fields to not allow multi-line strings to be set there.

Related-Bug: #1939733

    Change-Id: I4dc3a09847205a660dc966d8eabccb4946f9bbc6

Reviewed: https://review.opendev.org/c/openstack/neutron-lib/+/811708
Committed: https://opendev.org/openstack/neutron-lib/commit/1f4c4031ee8a0dc91149dc6a83c7051db7628f23
Submitter: "Zuul (22348)"
Branch: master
commit 1f4c4031ee8a0dc91149dc6a83c7051db7628f23
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Wed Sep 29 12:34:17 2021 +0200
Add oneline\_string validators
Those new validators are used to validate extra\_dhcp\_opt's opt\_name and
opt\_value fields to not allow multi-line strings to be set there.
Related-Bug: #1939733
Change-Id: I4dc3a09847205a660dc966d8eabccb4946f9bbc6

[Slawek Kaplonski (slaweq)](https://launchpad.net/~slaweq)
on 2021-12-17

| **tags**: | removed: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-01-13:  [**Related fix proposed to neutron (master)**](/neutron/%2Bbug/1939733/comments/57) |  |  | [#57](/neutron/%2Bbug/1939733/comments/57) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: [https://review.opendev.org/c/openstack/neutron/+/824641](https://review.opendev.org/c/openstack/neutron/%2B/824641)

Related fix proposed to branch: master
Review: https://review.opendev.org/c/openstack/neutron/+/824641

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-01-19:  [**Related fix merged to neutron (master)**](/neutron/%2Bbug/1939733/comments/58) |  |  | [#58](/neutron/%2Bbug/1939733/comments/58) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/neutron/+/824641](https://review.opendev.org/c/openstack/neutron/%2B/824641)

Committed: <https://opendev.org/openstack/neutron/commit/ef97019c92e96d0bb17785daaf570b04c68be500>

Submitter: "Zuul (22348)"

Branch: master

commit ef97019c92e96d0bb17785daaf570b04c68be500

Author: Slawek Kaplonski <email address hidden>

Date: Thu Jan 13 20:35:53 2022 +0100

Add upgrade check for extra DHCP options

Some time ago with patches [1] and [2] we trimmed extra\_dhcp\_opt name

    and value to first newline character before using them in the dnsmasq

    and later added API validator to not allow such names and/or values with

    newline character in it at all.

    This patch adds upgrade check to warn users if they have old entries

    with newline characters in the database already.

Related-Bug: #1939733

[1] [https://review.opendev.org/c/openstack/neutron/+/806746](https://review.opendev.org/c/openstack/neutron/%2B/806746)

    [2] [https://review.opendev.org/c/openstack/neutron-lib/+/811708](https://review.opendev.org/c/openstack/neutron-lib/%2B/811708)

Change-Id: I9a45d918b5a90f8fc50a9ec43b2a67cf582eb369

Reviewed: https://review.opendev.org/c/openstack/neutron/+/824641
Committed: https://opendev.org/openstack/neutron/commit/ef97019c92e96d0bb17785daaf570b04c68be500
Submitter: "Zuul (22348)"
Branch: master
commit ef97019c92e96d0bb17785daaf570b04c68be500
Author: Slawek Kaplonski <skaplons@redhat.com>
Date: Thu Jan 13 20:35:53 2022 +0100
Add upgrade check for extra DHCP options
Some time ago with patches [1] and [2] we trimmed extra\_dhcp\_opt name
and value to first newline character before using them in the dnsmasq
and later added API validator to not allow such names and/or values with
newline character in it at all.
This patch adds upgrade check to warn users if they have old entries
with newline characters in the database already.
Related-Bug: #1939733
[1] https://review.opendev.org/c/openstack/neutron/+/806746
[2] https://review.opendev.org/c/openstack/neutron-lib/+/811708
Change-Id: I9a45d918b5a90f8fc50a9ec43b2a67cf582eb369

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Murray (brian-murray)](https://launchpad.net/~brian-murray) wrote on 2022-01-26: |  |  | [#59](/neutron/%2Bbug/1939733/comments/59) |
| --- | --- | --- | --- |

The Hirsute Hippo has reached End of Life, so this bug will not be fixed for that release.

The Hirsute Hippo has reached End of Life, so this bug will not be fixed for that release.

| Changed in neutron (Ubuntu Hirsute): | |
| --- | --- |
| **status**: | New → Won't Fix |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Corey Bryant (corey.bryant)](https://launchpad.net/~corey.bryant) wrote on 2022-01-27: |  |  | [#60](/neutron/%2Bbug/1939733/comments/60) |
| --- | --- | --- | --- |

Ubuntu CVE tracker: <https://ubuntu.com/security/cve-2021-40085>

Ubuntu CVE tracker: https://ubuntu.com/security/cve-2021-40085

| Changed in neutron (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |
| Changed in neutron (Ubuntu Impish): | |
| **status**: | New → Fix Released |
| Changed in neutron (Ubuntu Focal): | |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-11-18:  [**Fix included in openstack/neutron queens-eol**](/neutron/%2Bbug/1939733/comments/61) |  |  | [#61](/neutron/%2Bbug/1939733/comments/61) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron queens-eol release.

This issue was fixed in the openstack/neutron queens-eol release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-11-18:  [**Fix included in openstack/neutron rocky-eol**](/neutron/%2Bbug/1939733/comments/62) |  |  | [#62](/neutron/%2Bbug/1939733/comments/62) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron rocky-eol release.

This issue was fixed in the openstack/neutron rocky-eol release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2022-11-18:  [**Fix included in openstack/neutron stein-eol**](/neutron/%2Bbug/1939733/comments/63) |  |  | [#63](/neutron/%2Bbug/1939733/comments/63) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron stein-eol release.

This issue was fixed in the openstack/neutron stein-eol release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2023-10-10:  [**Fix included in openstack/neutron train-eol**](/neutron/%2Bbug/1939733/comments/64) |  |  | [#64](/neutron/%2Bbug/1939733/comments/64) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron train-eol release.

This issue was fixed in the openstack/neutron train-eol release.

[See full activity log](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/neutron/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/neutron/%2Bbug/1939733/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [Fix v1](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5518537/%2Bfiles/0001-Remove-newline-character-from-dhcp_extra_opt-values.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5518537 "Change patch details")
* [Fix v2](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5518554/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5518554 "Change patch details")
* [Fix v2 for stable/wallaby](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519980/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-wallaby.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519980 "Change patch details")
* [Fix v2 for stable/victoria](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519981/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-victoria.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519981 "Change patch details")
* [Fix v2 for stable/ussuri](https://bugs.launchpad.net/neutron/%2Bbug/1939733/%2Battachment/5519982/%2Bfiles/0001-Remove-dhcp_extra_opt-value-after-first-newline-char-stable-ussuri.patch)
  [Edit](/neutron/%2Bbug/1939733/%2Battachment/5519982 "Change patch details")

* [Add patch](/neutron/%2Bbug/1939733/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from lists.debian.org_1b4680b1_20250114_185708.html ===


---

[[Date Prev](msg00037.html)][[Date Next](msg00039.html)]
[[Thread Prev](msg00037.html)][[Thread Next](msg00039.html)]
[[Date Index](maillist.html#00038)]
[[Thread Index](threads.html#00038)]

# [SECURITY] [DLA 3027-1] neutron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3027-1] neutron security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Thu, 26 May 2022 15:33:07 +0100
* *Message-id*: <[[🔎]](/msgid-search/165356892154.768867.5157056908225679588%40copycat) [165356892154.768867.5157056908225679588@copycat](msg00038.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3027-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
May 26, 2022                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : neutron
Version        : 2:9.1.1-3+deb9u3
CVE ID         : CVE-2021-40085
Debian Bug     : #993398

It was discovered that the previous upload to neutron to Debian 9
"Stretch" (ie. version 2:9.1.1-3+deb9u2) was incomplete and did not
actually apply the fix for CVE-2021-40085.

For Debian 9 "Stretch", this has been resolved in version
2:9.1.1-3+deb9u3.

We recommend that you upgrade your neutron packages.

For the detailed security status of neutron please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/neutron>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmKPdZcACgkQHpU+J9Qx
HliMsQ/9HQ1K2nGjNpovf18fwXAYO1JnhP97A6PV4gc33jLYqhh4Nv2M9qSx6DMq
L/Cj/5vvoOv/CUxV8e/Zm6m4NkNT1ebiOJoeKuZ315hPPiZ3UQxyJtPm2m4OHYFa
HqWJT9rxjDYy4wHY5/LiGBjiIASqj9laoJKWdXvix2axmZSWrQ6F7RolPiaIrZnY
qZGeU72RrfR55wBHRw+66e3BwFQA+ydR2gJWX0ViP3WZYtsDFZHDl6LgwJSIB+O3
djy53oYxCXYGjBHTFs62Yaje3/9Di1pNNuWr7kUv4071bKIy070hi0FpMZLMxJEd
ble+JTOzNvoZG6/kcRvGQ+QZoLdfFTlZxVyWF2pimwUSBnx9UzrQo9e3GA+vDpGk
khMoiUEqaIl10GDWM1eZFdU4Xypap7utHmzbC0Y5D15/ZptWoZWu9yH2m2NhBPBt
+Tv3W9thUb78qmKVEJiKEraTLxEYMBPkBvQXhQAP97nvIVzqJ5cxuw3dMDE5dNVK
xb8DU8FJT7i6uc8ZJzMNO2cxNvWG2D/l2NnBZfCeOSuco7GZHpIvllOELTrNWG95
lJIp2wNUuVh60HtD9WTDnrDmGB5l2JS4e6vA46ccCKPJ0ft9rtp5sMowvdns9FqT
8whjgH4Kg3QO+YOvWuGP+/OFItWHaEO5iUwBw+MgkvRWBvJ7KoQ=
=UuO+
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_908d20db_20250114_185703.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20210831150038.5aqn2pqqfrupkjqm@yuggoth.org>
Date: Tue, 31 Aug 2021 15:00:38 +0000
From: Jeremy Stanley <fungi@...goth.org>
To: oss-security@...ts.openwall.com
Subject: [OSSA-2021-005] Neutron: Arbitrary dnsmasq reconfiguration via
 extra_dhcp_opts (CVE-2021-40085)

====================================================================
OSSA-2021-005: Arbitrary dnsmasq reconfiguration via extra_dhcp_opts
====================================================================

:Date: August 31, 2021
:CVE: CVE-2021-40085

Affects
~~~~~~~
- Neutron: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1

Description
~~~~~~~~~~~
Pavel Toporkov reported a vulnerability in Neutron. By supplying a
specially crafted extra_dhcp_opts value, an authenticated user may add
arbitrary configuration to the dnsmasq process in order to crash the
service, change parameters for other tenants sharing the same
interface, or otherwise alter that daemon's behavior. This
vulnerability may also be used to trigger a configuration parsing
buffer overflow in versions of dnsmasq prior to 2.81, which could lead
to remote code execution. All Neutron deployments are affected.

Patches
~~~~~~~
- <https://review.opendev.org/806750> (Ussuri)
- <https://review.opendev.org/806749> (Victoria)
- <https://review.opendev.org/806748> (Wallaby)
- <https://review.opendev.org/806746> (Xena)

Credits
~~~~~~~
- Pavel Toporkov (CVE-2021-40085)

References
~~~~~~~~~~
- <https://launchpad.net/bugs/1939733>
- <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40085>

--
Jeremy Stanley

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (964 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.openstack.org_46911a0f_20250114_185709.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2021-005: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts

# OSSA-2021-005: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts[Â¶](#ossa-2021-005-arbitrary-dnsmasq-reconfiguration-via-extra-dhcp-opts "Link to this heading")

Date:

August 31, 2021

CVE:

CVE-2021-40085

## Affects[Â¶](#affects "Link to this heading")

* Neutron: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1

## Description[Â¶](#description "Link to this heading")

Pavel Toporkov reported a vulnerability in Neutron. By supplying a specially crafted extra\_dhcp\_opts value, an authenticated user may add arbitrary configuration to the dnsmasq process in order to crash the service, change parameters for other tenants sharing the same interface, or otherwise alter that daemonâs behavior. This vulnerability may also be used to trigger a configuration parsing buffer overflow in versions of dnsmasq prior to 2.81, which could lead to remote code execution. All Neutron deployments are affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.opendev.org/806709> (Queens)
* <https://review.opendev.org/806862> (Rocky)
* <https://review.opendev.org/806708> (Stein)
* <https://review.opendev.org/806707> (Train)
* <https://review.opendev.org/806750> (Ussuri)
* <https://review.opendev.org/806749> (Victoria)
* <https://review.opendev.org/806748> (Wallaby)
* <https://review.opendev.org/806746> (Xena)

## Credits[Â¶](#credits "Link to this heading")

* Pavel Toporkov (CVE-2021-40085)

## References[Â¶](#references "Link to this heading")

* <https://launchpad.net/bugs/1939733>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40085>

## Notes[Â¶](#notes "Link to this heading")

* The stable/train, stable/stein, stable/rocky, and stable/queens
  branches are under extended maintenance and will receive no new point
  releases, but patches for them are provided as a courtesy.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2021-005: Arbitrary dnsmasq reconfiguration via extra\_dhcp\_opts
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from www.debian.org_e388c1af_20250114_185709.html ===


---

[[Date Prev](msg00167.html)][[Date Next](msg00169.html)]
[[Thread Prev](msg00167.html)][[Thread Next](msg00169.html)]
[[Date Index](maillist.html#00168)]
[[Thread Index](threads.html#00168)]

# [SECURITY] [DSA 4983-1] neutron security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4983-1] neutron security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 10 Oct 2021 18:06:29 +0000
* *Message-id*: <[[🔎]](/msgid-search/20211010180629.GA7831%40seger.debian.org) [20211010180629.GA7831@seger.debian.org](msg00168.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4983-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 10, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : neutron
CVE ID         : CVE-2021-40085
Debian Bug     : 993398

Pavel Toporkov discovered a vulnerability in Neutron, the OpenStack
virtual network service, which allowed a reconfiguration of dnsmasq
via crafted dhcp_extra_opts parameters.

For the oldstable distribution (buster), this problem has been fixed
in version 2:13.0.7+git.2021.09.27.bace3d1890-0+deb10u1. This update
also fixes CVE-2021-20267.

For the stable distribution (bullseye), this problem has been fixed in
version 2:17.2.1-0+deb11u1. This update also fixes CVE-2021-38598.

We recommend that you upgrade your neutron packages.

For the detailed security status of neutron please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/neutron>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmFjK5YACgkQEMKTtsN8
TjbU1g//UhYzxu7NVB94lMUiL3WvmmOSMwOMl8PoyCiJl/ONKuCF8L3i9dhVxTOg
6qMDytNqOLOgMq4N32Vr0qjvL+bB+ruMEP50baHdOC8hDb84TcjpQUQncokYErBD
zvuY4NtUqfvwdCovdfqgsyovADY0orPFsziXLEe4biuWaQp664fWAJdWaBd+mZfG
O8vxrXGT4Nii651a+ExiXKv9jlVPknILU9nMEtgedi3HCdzL3ESvkD9w5/J7pPOx
Nb0bBnGHazAa6QDM9yeb3lXX1nOtu+C6uLzBqEPGxZVj4iKUV+PbMBHUZxm+t33e
7p0tNZutNHXGTYpBj5+sUtLzVAniUs+P6CesnqjRojr0FEXBm916c5+p6MKHimcS
o1TIKPwMgrZOYYvtpO/QVJKZTqdtgEz9toPDoDbNXNp4Ql5Zx/xc6d7uPRWaFwI7
om5V7JRS8agLrCtZQ7uTyLmM1SuWyetlbyzhR+eAs1dCN4QnF61NCZq1SIzPxeAZ
KmuB8+C2L4fLTJ976cFLEKpM4nJbRqsVq2feF2cGeav+WSDTSIACzlchnuPlaW4n
k2fpuqu7AqEXxfRYHFrMShq1q7A9gZF5B/RHvjYbN4sHmnfy2RqD/cyTyo4X+rw9
et2j6LPAgUfpkZRHkehXMbfEMfbe/t9m0IlRZmYRV2kaxwe1KzU=
=VIDk
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_2e1542e1_20250114_185708.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DLA 2781-1] neutron security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2781-1] neutron security update
* *From*: "Chris Lamb" <lamby@debian.org>
* *Date*: Mon, 11 Oct 2021 10:33:02 -0400 (EDT)
* *Message-id*: <[[🔎]](/msgid-search/163396275802.2454464.4058239004238500658%40copycat) [163396275802.2454464.4058239004238500658@copycat](msg00005.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2781-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                           Chris Lamb
October 11, 2021                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : neutron
Version        : 2:9.1.1-3+deb9u2
CVE ID         : CVE-2021-40085
Debian Bug     : #993398

It was discovered that there was an issue where authenticated
attackers could have reconfigured dnsmasq via a crafted
extra_dhcp_opts value within OpenStack's Neutron virtual network
service.

For Debian 9 "Stretch", this problem has been fixed in version
2:9.1.1-3+deb9u2.

We recommend that you upgrade your neutron packages.

For the detailed security status of neutron please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/neutron>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAmFkSwMACgkQHpU+J9Qx
HlilCw/+NjfSTPE63rFtU9W9DbdfupymqczVIT7JyqQtRiC7mup4W3DhgyP0FBg+
xmT9U98S8/duMD6UIZpmlt/q91rJKJLu+oqEnyDUaLFHNIhsYY5aNs6bsq332SUA
hi1hOf7Npl+BYRmHXZKQBImerSZi6lf7EFoV5QblCdVG5ZJmd5ZVZLKe2NyMCUpL
osYbMUhXdKMTL3/lUQyKUWhKsBsCplskGklZtVltkGbDXGakjQ+t5NhkfTIjue2Q
RJHi/0g+zJQqRhN1vRdVFH8V1ERxWppGyRuPni6w0rMbnVW7isk313tn+irxh8b6
tOQn8VBkhpZZ4X21+GYmTLhECykWkLAXa6pFqmpaTD6OsRO92Fc2Q1VC949y6Z9f
ebs6kYYxCQHvAvGscwhlWpp2sZA2eb+ug+GLRfdnhVlzZSn3h8xYTnsk28Eh7GAr
FpzvPcoel5+dkQ+1WVqiprtsdcz38CDCIxOtHpJwnEeBpAhsLklECivr6/0g0Omp
H4j1OoYPHQ5o9YTeIZLw7E+ggyZhhSbJIAokzKxcqmrOgt/IR1aBNG+Ipghe7K4K
cfyLDxFfVV0nxayBUz45Bhdl8siF5LQAIZzKJSqd7cUrqnCePNodRVnnyQVVKZGd
OGxvezjWMgyq6Aa73EcS6eDUaDUtq1cawSbAocTmvU83bPQ5UTI=
=7iI1
-----END PGP SIGNATURE-----

```

---


