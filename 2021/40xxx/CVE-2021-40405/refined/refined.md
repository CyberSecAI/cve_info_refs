- **Root cause of vulnerability**: The `cgiserver.cgi` process checks for user permissions before executing certain API commands. However, for the `Upgrade` API, if the permission check fails, the device sets the `perform_reboot` flag, leading to an unintended device reboot. This allows a non-authorized user to trigger a reboot.
- **Weaknesses/vulnerabilities present**: Improper Access Control (CWE-284). The vulnerability lies in the logic of the `Upgrade` API, where a failed permission check still results in the device rebooting, bypassing intended access restrictions.
- **Impact of exploitation**: An attacker can trigger a denial of service by forcing the device to reboot, disrupting its functionality and potentially causing operational issues for the device owner.
- **Attack vectors**: A specially crafted HTTP request to the `Upgrade` API.
- **Required attacker capabilities/position**: An attacker needs to be able to send HTTP requests to the device. While the vulnerability requires a logged-in user, it can be chained with a separate vulnerability (TALOS-2021-1420) to exploit it without authentication, which changes the privileges required for the attack to "None".