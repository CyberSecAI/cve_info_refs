=== Content from bugs.launchpad.net_64c3520b_20250115_082637.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1930469/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Need to kill web service authentication session at end of process

Bug #1930469 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2021-06-01

[254](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | Unassigned | [Mahara 21.10.0](https://launchpad.net/mahara/%2Bmilestone/21.10.0) |
|  | [20.04](https://bugs.launchpad.net/mahara/20.04) | Fix Released | High | Unassigned | [Mahara 20.04.5](https://launchpad.net/mahara/%2Bmilestone/20.04.5) |
|  | [20.10](https://bugs.launchpad.net/mahara/20.10) | Fix Released | High | Unassigned | [Mahara 20.10.3](https://launchpad.net/mahara/%2Bmilestone/20.10.3) |
|  | [21.04](https://bugs.launchpad.net/mahara/21.04) | Fix Released | High | Unassigned | [Mahara 21.04.2](https://launchpad.net/mahara/%2Bmilestone/21.04.2) |

### Bug Description

Currently when a token based websesrvice is called it authenticates the owner of the token on the Mahara end so that any functions called by the service can only be executed if the authenticated token owner can run those functions.

One of the problems with the current setup is we don't then kill the session of this token owner when the webservice call is completed.

This means if one hits a site with a crafted URL containing a valid token but no webservice function they will get an error message page, but if they then go to the home page of the site they will find they are logged in as the token owner.

In the webservice\_base\_server class there is the run() method that goes through the steps to do a webservice call and the last part is calling $this->session\_cleanup();

And in that method is nothing to actually handle the logging out of that session

## CVE References

* [2021-40849](/bugs/cve/2021-40849 "In Mahara before 20.04.5, 20.10.3, 21...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2021-06-02: |  |  | [#1](/mahara/%2Bbug/1930469/comments/1) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/11814/>

https://reviews.mahara.org/#/c/11814/

[Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner)
on 2021-08-22

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2021-09-12: |  |  | [#2](/mahara/%2Bbug/1930469/comments/2) |
| --- | --- | --- | --- |

Vulnerability type: Insecure permissions

Attack type: Remote

Impact: Information disclosure, escalation of privileges

Affected components: A token-based web service authenticates the owner of the token so that functions called by the web service can only be executed if the authenticated token owner can run those functions. However, the session of this token is not ended when the web service call throws an error. This means if you try to access a site with a crafted URL containing a valid token but no web service function, there will be an error message page, and if you then go to the homepage of the site, you will be logged in as the token owner.

Suggested description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, the account associated with a web services token is vulnerable to being exploited and logged into, resulting in information disclosure at minimum and often escalation of privileges.

Reported by: Catalyst IT

Bug report: [https://bugs.launchpad.net/mahara/+bug/1930469](https://bugs.launchpad.net/mahara/%2Bbug/1930469)

CVE reference: CVE-2021-40849

Vulnerability type: Insecure permissions
Attack type: Remote
Impact: Information disclosure, escalation of privileges
Affected components: A token-based web service authenticates the owner of the token so that functions called by the web service can only be executed if the authenticated token owner can run those functions. However, the session of this token is not ended when the web service call throws an error. This means if you try to access a site with a crafted URL containing a valid token but no web service function, there will be an error message page, and if you then go to the homepage of the site, you will be logged in as the token owner.
Suggested description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, the account associated with a web services token is vulnerable to being exploited and logged into, resulting in information disclosure at minimum and often escalation of privileges.
Reported by: Catalyst IT
Bug report: https://bugs.launchpad.net/mahara/+bug/1930469
CVE reference: CVE-2021-40849

| **summary**: | - Need to kill webservice authentication session at end of process+ Need to kill web service authentication session at end of process |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2021-09-12: |  |  | [#3](/mahara/%2Bbug/1930469/comments/3) |
| --- | --- | --- | --- |

The above is for the security forum post.

The above is for the security forum post.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1930469/comments/4) |  |  | [#4](/mahara/%2Bbug/1930469/comments/4) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12115>

Committed: <https://git.mahara.org/mahara/mahara/commit/9e405b25c718bbfbb03e4d30b50cc5e71b34da48>

Submitter: Robert Lyon (<email address hidden>)

Branch: main

commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48

Author: Robert Lyon <email address hidden>

Date: Wed Jun 2 14:26:55 2021 +1200

Security [Bug 1930469](/bugs/1930469): Forcing the authenticated user to be logged out

If there is an error in webservice

Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/12115
Committed: https://git.mahara.org/mahara/mahara/commit/9e405b25c718bbfbb03e4d30b50cc5e71b34da48
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: main
commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Jun 2 14:26:55 2021 +1200
Security Bug 1930469: Forcing the authenticated user to be logged out
If there is an error in webservice
Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A patch has been submitted for review**](/mahara/%2Bbug/1930469/comments/5) |  |  | [#5](/mahara/%2Bbug/1930469/comments/5) |
| --- | --- | --- | --- |

Patch for "21.10\_DEV" branch: <https://reviews.mahara.org/12186>

Patch for "21.10\_DEV" branch: https://reviews.mahara.org/12186

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1930469/comments/6) |  |  | [#6](/mahara/%2Bbug/1930469/comments/6) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12186>

Committed: <https://git.mahara.org/mahara/mahara/commit/e85a2fedbbd3c825dc73cf903e641b9a117bd9e4>

Submitter: Robert Lyon (<email address hidden>)

Branch: 21.10\_DEV

commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4

Author: Robert Lyon <email address hidden>

Date: Wed Jun 2 14:26:55 2021 +1200

Security [Bug 1930469](/bugs/1930469): Forcing the authenticated user to be logged out

If there is an error in webservice

Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)

Reviewed: https://reviews.mahara.org/12186
Committed: https://git.mahara.org/mahara/mahara/commit/e85a2fedbbd3c825dc73cf903e641b9a117bd9e4
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 21.10\_DEV
commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Jun 2 14:26:55 2021 +1200
Security Bug 1930469: Forcing the authenticated user to be logged out
If there is an error in webservice
Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A patch has been submitted for review**](/mahara/%2Bbug/1930469/comments/7) |  |  | [#7](/mahara/%2Bbug/1930469/comments/7) |
| --- | --- | --- | --- |

Patch for "21.04\_STABLE" branch: <https://reviews.mahara.org/12187>

Patch for "21.04\_STABLE" branch: https://reviews.mahara.org/12187

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#8](/mahara/%2Bbug/1930469/comments/8) |
| --- | --- | --- | --- |

Patch for "20.10\_STABLE" branch: <https://reviews.mahara.org/12188>

Patch for "20.10\_STABLE" branch: https://reviews.mahara.org/12188

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#9](/mahara/%2Bbug/1930469/comments/9) |
| --- | --- | --- | --- |

Patch for "20.04\_STABLE" branch: <https://reviews.mahara.org/12189>

Patch for "20.04\_STABLE" branch: https://reviews.mahara.org/12189

[Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner)
on 2021-10-28

| **no longer affects**: | mahara/21.10 |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28:  [**A change has been merged**](/mahara/%2Bbug/1930469/comments/10) |  |  | [#10](/mahara/%2Bbug/1930469/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12189>

Committed: <https://git.mahara.org/mahara/mahara/commit/620cd1f0180c378a76d8f5b4a647b533eb235aa5>

Submitter: Robert Lyon (<email address hidden>)

Branch: 20.04\_STABLE

commit 620cd1f0180c378a76d8f5b4a647b533eb235aa5

Author: Robert Lyon <email address hidden>

Date: Wed Jun 2 14:26:55 2021 +1200

Security [Bug 1930469](/bugs/1930469): Forcing the authenticated user to be logged out

If there is an error in webservice

Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)

(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

Reviewed: https://reviews.mahara.org/12189
Committed: https://git.mahara.org/mahara/mahara/commit/620cd1f0180c378a76d8f5b4a647b533eb235aa5
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 20.04\_STABLE
commit 620cd1f0180c378a76d8f5b4a647b533eb235aa5
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Jun 2 14:26:55 2021 +1200
Security Bug 1930469: Forcing the authenticated user to be logged out
If there is an error in webservice
Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)
(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2021-10-28

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#11](/mahara/%2Bbug/1930469/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12187>

Committed: <https://git.mahara.org/mahara/mahara/commit/74f38088a23eaab04af6ac3019e1372582f49e15>

Submitter: Gold (<email address hidden>)

Branch: 21.04\_STABLE

commit 74f38088a23eaab04af6ac3019e1372582f49e15

Author: Robert Lyon <email address hidden>

Date: Wed Jun 2 14:26:55 2021 +1200

Security [Bug 1930469](/bugs/1930469): Forcing the authenticated user to be logged out

If there is an error in webservice

Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)

(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

Reviewed: https://reviews.mahara.org/12187
Committed: https://git.mahara.org/mahara/mahara/commit/74f38088a23eaab04af6ac3019e1372582f49e15
Submitter: Gold (gold@catalyst.net.nz)
Branch: 21.04\_STABLE
commit 74f38088a23eaab04af6ac3019e1372582f49e15
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Jun 2 14:26:55 2021 +1200
Security Bug 1930469: Forcing the authenticated user to be logged out
If there is an error in webservice
Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)
(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2021-10-28: |  |  | [#12](/mahara/%2Bbug/1930469/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/12188>

Committed: <https://git.mahara.org/mahara/mahara/commit/2209dbdaf1754347884f7b4bfac055b666eec368>

Submitter: Robert Lyon (<email address hidden>)

Branch: 20.10\_STABLE

commit 2209dbdaf1754347884f7b4bfac055b666eec368

Author: Robert Lyon <email address hidden>

Date: Wed Jun 2 14:26:55 2021 +1200

Security [Bug 1930469](/bugs/1930469): Forcing the authenticated user to be logged out

If there is an error in webservice

Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)

(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

Reviewed: https://reviews.mahara.org/12188
Committed: https://git.mahara.org/mahara/mahara/commit/2209dbdaf1754347884f7b4bfac055b666eec368
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 20.10\_STABLE
commit 2209dbdaf1754347884f7b4bfac055b666eec368
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Jun 2 14:26:55 2021 +1200
Security Bug 1930469: Forcing the authenticated user to be logged out
If there is an error in webservice
Change-Id: Ic827da3a385aa14f0a342aaf67b509efac154ad4
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 9e405b25c718bbfbb03e4d30b50cc5e71b34da48)
(cherry picked from commit e85a2fedbbd3c825dc73cf903e641b9a117bd9e4)

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1930469/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1930469/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1930469/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1930469/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from mahara.org_63d7811e_20250115_082638.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4165)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4165)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Web services token vulnerablity in Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0,

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Robert Lyon's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=313288)
[Robert Lyon](https://mahara.org/user/robertlyon-1)

Posts: 778

29 October 2021, 16:52

Vulnerability type: Insecure permissions
Attack type: Remote
Impact: Information disclosure, escalation of privileges

Affected components: A token-based web service authenticates the owner of the token so that functions called by the web service can only be executed if the authenticated token owner can run those functions. However, the session of this token is not ended when the web service call throws an error. This means if you try to access a site with a crafted URL containing a valid token but no web service function, there will be an error message page, and if you then go to the homepage of the site, you will be logged in as the token owner.

Description: In Mahara before 20.04.5, 20.10.3, 21.04.2, and 21.10.0, the account associated with a web services token is vulnerable to being exploited and logged into, resulting in information disclosure at minimum and often escalation of privileges.

Reported by: Catalyst IT
Bug report: [https://bugs.launchpad.net/mahara/+bug/1930469](https://bugs.launchpad.net/mahara/%2Bbug/1930469)
CVE reference: CVE-2021-40849

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4165)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)


