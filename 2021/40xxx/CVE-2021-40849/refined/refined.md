Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The root cause is that when a token-based web service is called in Mahara, the session of the authenticated token owner is not terminated after the web service call completes, especially when an error occurs during the process. The `webservice_base_server` class's `run()` method calls `$this->session_cleanup()`, but this method did not handle logging out the user.

**Weaknesses/Vulnerabilities:**
- Insecure session management: The session associated with the web service token owner is not being invalidated upon completion or error, leading to a persistent login.
- Insufficient error handling in web service calls
- A crafted URL with a valid token but no webservice function will authenticate the user associated with the token without that user's knowledge.

**Impact of Exploitation:**
- Information Disclosure: An attacker could potentially gain access to the token owner's information.
- Privilege Escalation: If the token owner has higher privileges, the attacker could inherit those privileges, gaining access to sensitive data or administrative functions.
- Unauthorized Access: An attacker, exploiting the vulnerability, could be logged in as another user without their consent

**Attack Vectors:**
- Crafted URL: An attacker crafts a URL containing a valid web service token but without a valid web service function. This leads to an error, but it also logs the attacker into the site as the token owner.

**Required Attacker Capabilities/Position:**
- The attacker needs to obtain a valid web service token.
- The attacker needs to be able to craft a URL that includes the valid token but does not specify a valid web service function.
- The attacker needs to be able to navigate to the crafted URL
- No user interaction is necessary apart from clicking on the malicious link.

**Versions Affected:**
- Mahara versions before 20.04.5, 20.10.3, 21.04.2, and 21.10.0

**Additional Notes:**
- This vulnerability has been addressed in the fixed versions by ensuring that the user is logged out after a web service call, especially when an error has occurred.
- The fix involved changes to the `webservice_base_server` class, specifically the `session_cleanup()` method.

This detailed breakdown provides more information than the official CVE description.