- **Root cause of vulnerability:** Incorrect default permissions on the installation directory and service binary files of Advantech DeviceOn/iEdge Server, allowing the "Everyone" group full control.
- **Weaknesses/vulnerabilities present:**
    - Incorrect default permissions (CWE-276) on the installation directory and service executable and library files, which are loaded by the PostgreSQL service.
    - The PostgreSQL service runs with "NT AUTHORITY\NETWORK SERVICE" privileges, and those files can be replaced by users in the "Everyone" group due to the incorrect permissions.
    - The service is assigned `SeImpersonatePrivilege` enabling impersonation of user tokens and leading to reliable execution with NT SYSTEM privileges.
- **Impact of exploitation:**
    - Privilege escalation from the "Everyone" group to "NT AUTHORITY\NETWORK SERVICE".
    - Further privilege escalation to "NT SYSTEM" due to the `SeImpersonatePrivilege` assigned to the service.
    - Full control over the system
- **Attack vectors:**
    - An attacker can replace service binary files (such as `psql.exe`, `pg_ctl.exe`, `postgres.exe`, and various DLLs) located in the installation directory with malicious ones.
    - The attacker needs to restart the service to trigger execution of the malicious files
- **Required attacker capabilities/position:**
    - Local access to the system where Advantech DeviceOn/iEdge Server 1.0.2 is installed.
    - Ability to write files to the installation directory (accessible to "Everyone").