=== Content from pan.baidu.com_9c18a032_20250114_195201.html ===


ha\*\*\*\*街短梦
暂无签名
加为好友

![验证码]()

提取文件

添加好友

对方需要你填写验证信息

取消
确定

©2025 Baidu [服务协议](/disk/duty/)|[权利声明](//yun.baidu.com/disk/privacy)|[版本更新](//yun.baidu.com/disk/version)|[帮助中心](http://yun.baidu.com/disk/help)|[问题反馈](http://qingting.baidu.com/index?pid=19)|[版权投诉](http://copyright.baidu.com/index.php/index/complaint)|企业认证



=== Content from github.com_5a40fade_20250114_195155.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions%2Fblob%2Fmain%2FWX%2520applet%2520contact%2520permission%2520vulnerability%2520report.pdf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions%2Fblob%2Fmain%2FWX%2520applet%2520contact%2520permission%2520vulnerability%2520report.pdf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=BESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BESTICSP](/BESTICSP)
/
**[Vulnerabilities-Related-to-Mini-Programs-Permissions](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions)**
Public

* [Notifications](/login?return_to=%2FBESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FBESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions)
* [Star
   5](/login?return_to=%2FBESTICSP%2FVulnerabilities-Related-to-Mini-Programs-Permissions)

* [Code](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions)
* [Issues
  0](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/issues)
* [Pull requests
  0](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/pulls)
* [Actions](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/actions)
* [Projects
  0](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/projects)
* [Security](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/security)
* [Insights](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/pulse)

Additional navigation options

* [Code](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions)
* [Issues](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/issues)
* [Pull requests](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/pulls)
* [Actions](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/actions)
* [Projects](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/projects)
* [Security](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/security)
* [Insights](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/pulse)

## Files

 main
## Breadcrumbs

1. [Vulnerabilities-Related-to-Mini-Programs-Permissions](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/tree/main)
/
# WX applet contact permission vulnerability report.pdf

Copy path
## Latest commit

## History

[History](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/commits/main/WX%20applet%20contact%20permission%20vulnerability%20report.pdf)391 KB main
## Breadcrumbs

1. [Vulnerabilities-Related-to-Mini-Programs-Permissions](/BESTICSP/Vulnerabilities-Related-to-Mini-Programs-Permissions/tree/main)
/
# WX applet contact permission vulnerability report.pdf

Top
## File metadata and controls

391 KBLoadingViewer requires iframe.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from arxiv.org_af3a8291_20250114_195154.html ===
A SMALL LEAK WILL SINK MANY SHIPS: VULNERABILITIES
RELATED TO MINI PROGRAMS PERMISSIONS

2
2
0
2

y
a
M
0
3

]

R
C
.
s
c
[

1
v
2
0
2
5
1
.
5
0
2
2
:
v
i
X
r
a

Jianyi Zhang, Leixin Yang, Yuyang Han, Zhi Sun, Zixiao Xiang
Beijing Electronic Science and Technology Institute
Beijing
zjy@besti.edu.cn

ABSTRACT

As a new format of mobile application, mini programs, which function within a larger app and
are built with HTML, CSS, and JavaScript web technology, have become the way to do almost
everything in China. This paper presents our research on the permissions of mini programs. We
conducted a systematic study on 9 popular mobile app ecosystems, which host over 7 million mini
programs, and tested over 2,580 APIs to understand these emerging systems better. We extracted
a common abstracted model for mini programs permission control and revealed six categories of
potential security vulnerabilities in the permission environments. It is alarming that the current
popular mobile app ecosystems (host apps) under study have at least one security vulnerability. We
present the corresponding attack methods to dissect these potential weaknesses further to exploit the
discovered vulnerabilities. To prove that the revealed vulnerabilities may cause severe consequences
in real-world use, we show three kinds of attacks related to the mini programs’ permissions. We have
responsibly disclosed the newly discovered vulnerabilities, ofﬁcially conﬁrmed and revised. Finally,
we put forward systematic suggestions to strengthen the standardization of mini programs.

Keywords Sensitive permissions · Mini programs · Host apps · Security vulnerabilities

1

Introduction

Mini programs are light (commonly 2-4 MB) applications that run inside a speciﬁc mobile app (host app) [1]. As a new
form of mobile application, leveraging web technologies like HTML, CSS, and JavaScript, mini programs are taking
over the iOS and Android app ecosystems in China. The mini program technology enables the "super app" to bundle
features and capabilities into a single mobile native APP, which lets the users never need to leave this native app. We
call this a host app. Many host app vendors, such as Tencent (WeChat), ByteDance (TikTok) and Alibaba (Alipay),
provide their own framework to support the mini programs [2]. There are various ways to launch a mini program in
these host apps. Users can scan a QR code, directly search the name in the host app, share with a group or friend, launch
it in a content article, or even link between mini programs. Figure 1a shows how to launch the Tesla mini program
in WeChat as an example. With the clear interface and fast loading times, mini programs are very easy to use. More
and more people use mini programs in their everyday life and need not worry about installing too many apps. There
is a mini program for just about anything in China, whether to pay bills, play games, order a taxi, or book a doctor’s
appointment. As of 2021, there are over 1.26 billion monthly active users (MAU) of WeChat [3], 1 billion of TikTok
[4], and over 658 million of Alipay [5]. The total number of the mini programs’ users is close to that of Facebook, the
most popular social network worldwide, which has about 2.89 billion MAU [6].

Since the widespread use of mini programs, any incorrect permission assignments or settings can result in serious
security and privacy problems. However, there is not much research focus on this issue. That is not only because it
is a new mobile application format, but also, more importantly, the permission structure of mini programs is entirely
different from any other current permission-based security model. As we know, the mobile operating system (OS)
is responsible for allowing or denying the use of speciﬁc resources at the app’s run time [7]. The developers should
declare a list of permissions that the user must accept before installing or running an application. Then the OS uses
this security model to restrict every mobile app, native or hybrid, access to advanced or dangerous functionality on the

Running Title for Header

(a) Two ways to access a WeChat mini program.

(b) These mini programs, which operate as a separate
mobile app, can run in the background and function
within another larger app (host app).

Figure 1: Tesla mini program in WeChat. Source: Screenshot.

device [8]. Unlike the current access control models and methods, the permissions of mini programs are based on the
host app authorization. That is, Android or iOS decides whether or not to allow the host apps to have some speciﬁc
permissions, and the host apps authorize users to send pictures or other operations in the mini program. Therefore, from
the view of OS, the permissions of mini programs and the host apps are the same, which means mini programs may
apply for permissions from OS by using the reputation of host apps. It is impossible to control the permissions of mini
programs directly. Once the host app does not authorize the correct permissions to the mini programs, it may cause
security problems[9].

The permission issues in mobile applications have been fully studied in the past, and its permissions management
mechanism is relatively complete and formal[10, 11, 12, 13, 14, 15, 16, 17, 18]. M-Perm[11] can identify normal,
dangerous, and third-party permissions requests in applications to detect permission abuse. DroidNet[12] can provide
advice on whether to accept or reject requests related to sensitive behaviors, helping users to implement low-risk
resource access control on untrusted applications to protect user privacy. However, these studies cannot solve the
relevant security issues in the permissions of the mini programs.

In this paper, we present our systematic analysis of the current mini programs’ permissions, where we dissect its
framework, ecosystem, and potential vulnerabilities. We refer to the deﬁnition of sensitive permissions in Android and
iOS and conduct a series of sensitive permission speciﬁcation tests on mini programs. Speciﬁcally, we systematically
studied 9 popular mobile app ecosystems, which host more than 7 million mini programs, and established an abstract
model for the unique permissions application process of existing mini programs. According to the host App and OS
allow or reject permission application, we divide the application process into three situations: Host App Allow, OS
Allow; Host App Reject, OS Allow; OS Reject. The majority of the vulnerabilities belong to Host App Reject, OS
Allow. According to this abstract model, we investigated more than 2580 APIs and revealed six categories of potential
security vulnerabilities that are common in most of the mini programs we studied. According to the types of leaked
information, we present three kinds of proof-of-concept attacks to analyze these potential weaknesses further. To
prove that the exposed vulnerabilities may cause serious consequences on the real-world systems, we described three
interesting cases of APIs and illegal mini programs. To mitigate the threat of these vulnerabilities, we have listed
recommendations for mini programs, developers, and users.

Finally, to ensure that the mini programs’ mechanism of different host apps had enough time to ﬁx the vulnerabilities,
we contacted them individually about the vulnerabilities several months before submitting this manuscript. This allowed
several different host apps to ﬁnish patching the reported vulnerabilities in writing. We also disclosed the vulnerabilities
to various security response platforms, including Tencent Security Response Center.

In summary, we have made the following contributions in this paper:

• We deeply analyzed the current mini programs permission and presented a common abstracted model of the
permission control of mini programs. To our best knowledge, we systematically studied the mini programs
and the permissions for the ﬁrst time.

• We have detected more than 2,580 APIs. Through large-scale tracking and analysis of sensitive permission
APIs, we have found six categories of potential security vulnerabilities in the process of processing sensitive
permission applications by mini programs.

2

Running Title for Header

Figure 2: The common framework of mini programs

• We conducted empirical research on the currently popular 9 host apps and revealed the security issues
corresponding to the six types of potential security vulnerabilities we discovered in the real world. We also
showed three real-life attacks on the mini programs permissions to prove that the revealed vulnerabilities may
cause serious consequences in real-world use.

• Following the practice of responsible disclosure, we have reported all the discovered design ﬂaws, ofﬁcially

conﬁrmed and revised.

• To mitigate these potential vulnerabilities, we put forward suggestions to strengthen the standardization of the

entire mini programs’ permission, thereby enhancing user privacy protection.

2 Background

2.1 Framework of Mini Programs

Mini programs are a category of applications embedded in host apps without the need of downloading and installing [19].
The ﬂow of mini program framework consists of two components: View (the rendering layer) and App Service (the
logic layer), which are respectively managed by two separate threads, as exhibited in Figure 2. The interface of View is
rendered by WebView component, which handles page displaying and the user event interaction behavior, while the
App Service employs JsCore threads to run JavaScript, for controlling the generation and processing of mini programs
data. The communication between two threads is relayed by the Native app (refers to the client).

The host app in the framework determines whether the mini program has the permission for acquiring the speciﬁc data
through the corresponding API. That is, OS determines whether to allow host apps to have some speciﬁc permissions,
and host apps then transmit authorized data to the mini program through the API. In other words, the permission of mini
programs is inherited from the host app. Hence, if a host app does not properly manage the data and permission, data
privacy and security issues will occur at its mini programs. In this paper, we will focus on the App Service component
to study the authorization mechanism of the host app and the design of API for mini programs.

2.2 Difference to Other Apps

As a new emerging paradigm, mini program has the substantial difference to the existing native app, hybrid app,
progressive web app (PWA), and instant app. Yet, there is little research on mini programs, especially for their potential
security and privacy issues. We brieﬂy summarize the difference between mini programs and other categories of apps
here.

A native app is a mobile application developed speciﬁcally for installing on device’s OS like Android or iOS. A hybrid
app looks like a native app, but at core, it is one kind of web app wrapped in a native container which loads the
information on the page when a user navigates through the application. Although both hybrid apps and mini programs
apply web technology, the hybrid app is still one type of native app that is under the management by OS. In contrast, as

3

WebViewWebViewJSCoreWebViewApp ServiceViewNativeHost AppOSMini ProgramrequestdataAPIRunning Title for Header

Figure 3: Under the iOS system, the system permission pop-up prompt is displayed when Alipay requests runtime
permission (left) and the pop-up prompt when a mini program in Alipay requests permission (right).

a light version of the app, the mini program can only run on a native app’s (host app’s) interface and apply for the host
app’s permissions.

Similar to the mini program, PWA also applies web technology, but differently, PWA is a type of webpage or website
that runs in the browser and can be added to the home screen. Hence, the host environment of PWA is the browser and
the OS manages the PWA’s permission through the browser. Mini programs can be considered as one type of “Instant”
app embedded in host apps for disposable interactions at a fraction of cost of an app. The host environment is a platform
with extra capabilities that can support seamless service and access control for the user data.

Google’s instant app [20] is very similar to mini programs. Both of them allow users to access the application’s content
without additionally installing the application, which can save the application space on the device. In essence, Google’s
instant app is still a native app and under the OS’s permission control while the mini program is under the host apps’.

2.3 Authorization

Permissions in mobile apps can be divided into two types, install-time permissions and runtime permissions[21]. Here,
the runtime permission is also called the dangerous permission, which is related to users’ privacy and can access users’
private data, such as location information, contacts information, etc. These information are considered to be sensitive
and should acquire user’s authorization for access. When requesting the runtime permission, the system will display a
prompt window, as shown in Figure 3.

According to Section 2.1, the framework provides rich APIs to support the mini programs request a resource such as
user information, location information, payment functions, etc. But the user does not authorize the API directly. In mini
program development, the framework divided the dangerous APIs into multiple scope according to the scope of usage.
The users can select scope to authorize. After a scope is authorized, all of its APIs can be used directly.

2.4 Permission Control Abstract Model

We conclude an abstract model common to all mini programs’ permission control, depicted as follows.

Mini programs are "sub-applications" built on mature mobile applications which are then built on the OS. So, mini
programs need to pass two layers of barriers when applying for sensitive permissions from users. That is, mini programs
ﬁrst apply to their host app where they are located and then the host App applies to the OS. As shown in Figure 4,
according to the host app and OS allow or reject permission application scenarios, we categorize the application process
into the following three cases:

4

Running Title for Header

Figure 4: The sensitive permission application process of mini programs. Mini programs run in speciﬁc mobile
applications (host apps), while mobile applications run in the OS.

• Both Host App and OS Allow If a mini program applies for sensitive permission A, but the user has not
applied this permission, the host app will pop up a window (as shown in the left of Figure 3) to ask whether the
user is willing to grant the permission. If it agrees, the host app will continue to apply for sensitive permission
A to the OS, and the OS will pop up a window (the right side of Figure 3) to ask if the user is willing to
grant this permission to the mini program. The mini program will successfully obtain the requested sensitive
permission once the user agrees. Later on, when the user uses the mini program again, he can directly call the
interface.

• Host App Reject but OS Allow In this case, the host app has obtained permission B given by the OS, but
when its mini program wants to apply for permission B, the user chooses to refuse and then directly enters the
interface fail callback. Hence, the mini program fails to obtain permission B. In our later analysis in Section 3,
most vulnerabilities we discover belong to this category.

• OS Reject If the host app does not get the permission C given by the OS, neither the host app nor the mini
programs in it can get this permission. It is worth noting that when the developer calls the API requiring
authorization, the authorization setting will appear in the mini programs’ authorization setting page regardless
of the user’s permission or not. The user can modify the authorization, and the calling result will change
accordingly until the user actively deletes the mini programs. But user authorization setting is not synchronized
with the server. If the user changes the device or switches his account on the same device, the authorization
will be prompted again.

3 Security Analysis

After getting the background knowledge of mini programs, we start to perform the security analysis of mini programs’
sensitive permission application process. According to the three scenarios as we have discussed in Section 2.4, we
discover six categories of potentially vulnerable modes during mini programs’ processing of sensitive permission
applications, as presented in Figure 5. Based on these vulnerabilities, we have created three proof-of-concept attacks.
In this section, we will ﬁrst illustrate the principle for determining the sensitive permission in Section 3.1. Then, we
elaborate the detailed vulnerability in Section 3.2 and present our proof-of-concept attacks in Section 3.3.

5

Host App OS② Allow or Reject ?Allow!Host App Reject, OS AllowOS Reject Request A③ Allow or Reject ?② Allow or Reject ?④ Allow or Reject ?Reject!② Allow or Reject ?Reject!① Request A① Request B③ Request B① Request CAllow!Mini Program Allow!Obtained Permission AObtained Permission AHost App Allow, OS AllowObtained Permission BNot Obtained Permission BNot Obtained Permission CNot Obtained Permission CRunning Title for Header

Figure 5: The vulnerabilities and attacks in the mini programs permissions.

3.1 Whether to Request Authorization

According to 2.3, we know that the mini program framework puts the sensitive APIs into the scope. The framework
determines whether the sensitive data can be obtained or processed by the mini program in the background as a rule
for sensitive operations. For example, in the WeChat mini programs, wx.getLocation obtains the current geographical
location in the background. If there is no user authorization, the current location information will be transmitted without
the user’s awareness. Therefore, the mini program framework puts such APIs into scope for uniﬁed authorization and
management. In contrast, the API of wx.chooseImage is to select pictures from local photo albums or take photos with
cameras. Although the data involved are sensitive, the user needs to select and other interactive operations to send out
the data. The framework will consider the user know and authorize this operation, and this data cannot be transmitted
without the user’s awareness. Hence, the mini program framework does not put this kind of API into scope.

3.2 Potential Vulnerabilities

We conduct a large-scale analysis of APIs from different host apps and target APIs related to sensitive permission.
A total of 2,580 APIs are detected by us. Through large-scale tracking and analysis, examining the documentation,
available source codes, and demos, we identify the following six categories of potential security vulnerabilities in the
process of sensitive permission applications by mini programs.

3.2.1 Reuse Cache Files

When a user quits or deletes the mini programs, the cache ﬁles in the corresponding path should also be deleted, for
reducing the user’s storage space and avoiding being reused. However, suppose the user closes the mini program in the
host app and opens it again for operation. The previously cached temporary ﬁle is still there without being deleted. So,
an attacker has the chance to obtain the local temporary ﬁle path of the previous ﬁle without the user’s awareness.

3.2.2 Permission Encapsulation in Leaked API

Some APIs related to sensitive permissions do not encapsulate permissions well (we refer to these APIs collectively as
PEL-API). This means that any mini program can directly call these APIs to obtain the corresponding permissions,
ignoring the need to apply permission within the host app. The application process of sensitive permissions corre-
sponding to such an issue is shown in Figure 6. When the host app obtains a dangerous permission B from the OS,
the mini programs can get this permission without asking the user’s willingness in a pop-up window. Even having the
pop-up inquiry and the user rejects it, the mini programs can still get this permission. In particular, we divide these
vulnerabilities into the following four categories.

Qualiﬁed Conditions Ignored. According to the description in Section 3.1, when the user must manually operate the
sensitive permissions involved to view, select, or transmit private data, the mini programs will default that the user has
allowed the use of rights in self-operation so that no pop-up will be made. In other words, there is no scope (mentioned
in 2.3) corresponding to these APIs, and as long as the OS opens the relevant permissions for the host app, the mini
programs can call these APIs and get data at will. At this time, sensitive data can only be used when the user interacts

6

Proof-of-concept AttacksVulnerabilitiesPermissionApplication Host App Allow, OS AllowHost App Reject, OS AllowOS RejectSecurity RisksPermission Encapsulation Leaked APIForgotten API Under Permission ControlParameter Settings IgnoredInvalid Permission SettingQualified Conditions IgnoredSecretly Transfer Sensitive DataReuse Cache FilesPermission Management IssuesPermissions Difference in DifferentEnvironmentsContacts AttackLocation Information AttackClipboard Content AttackWebView Bypasses Permission ControlPath1Path2Collect and use user privacy, personal information abuse.Running Title for Header

Figure 6: When Host App Reject and OS Allow, mini programs illegally obtain the process of sensitive permissions.

with mini program, which is equivalent to the user controlling his own sensitive information. Mini programs cannot
steal the user’s sensitive information through this type of API. However, since the API of mini programs will be updated
irregularly, the newly-launched API that involves the same permissions may have the function of stealing users’ private
data. Many old APIs that involve the same permissions do not divide scope into corresponding ones, so these new APIs
become a security risk. We believe that these APIs ignore qualiﬁcation of sensitive permission (whether private data
will be stolen without the user’s awareness).

Forgotten API Under Permission Control. The host apps handle whether the sensitive information can be passed to
the mini program. For example, almost all host apps consider obtain “location information” is the dangerous permission.
Whenever the mini program wants to use the current user’s location, it will ﬁrst apply to the user to ask for his consent.
If the user refuses, the mini program itself cannot locate the user’s speciﬁc location, regardless of whether the host
app has obtained the permission. However, the designer neglected that some APIs should ask for authorization before
sending the location information to the mini programs. In other words, these neglected APIs do not belong to any scope
(mentioned in 2.3) and can be used without user authorization.

Parameter Settings Ignored. From the point of view of its functions, some APIs may not actively obtain the user’s
sensitive permissions. However, the designer neglects the parameter settings in API, which will also steal users’ privacy.
For example, my.chooseCity in the Alipay mini programs is an API to open the city selection list. The parameter
showLocatedCity indicates whether to display the currently located city. If it is set to true, the user’s current city will be
directly located regardless of whether the host program opens the location permission for the mini programs. If the user
does not do anything, the background cannot see any content about the location information. However, as long as the
user selects the area located by the system, the background will return to the current city and latitude and the user’s
longitude, even if the location permission is closed at this time.

Invalid Permission Setting. The permission settings of some APIs are inconsistent with the descriptions in their
ofﬁcial documents. To some extent, this shows that the API related to sensitive permissions in mini programs does
not encapsulate permissions well. For example, wx.choosePoi in the WeChat mini programs realizes the function of
opening the map and selecting the location. It is indicated in the document that the invocation of this API requires
the authorization of scope.userLocation. However, in the actual test, we found that it is inconsistent with the ofﬁcial
document description - the location can be selected without user authorization at all. When the user chooses precise
positioning, the background will return the latitude and longitude data of the current user.

3.2.3 Stealthily Transferring Sensitive Data

Vertical: The application process for this vulnerability is shown in Figure 6. When some mini programs developed
by serious cooperative companies involve sensitive permissions like geographical location, their host apps will ignore
applying for permissions from users. The method shown as in Figure 6 can bypass user authorization for stealthily
transmitting user sensitive information.

Horizontal: Different mini programs developed by the same company may share user information. All the user
sensitive permissions acquired by the mini programs should be made public, and the user has the right to close the
acquisition of sensitive permissions by the mini programs. Our empirical study found that some mini programs obtain
and leverage the user information in their associated mini programs by default, including account information, shipping
address, etc., but never request user’s consent. This type of mini programs skips the permission application step, and

7

② Allow or Reject ?① Request BAllow!Obtained Permission BObtained Permission BNo Ask!④ Allow or Reject ?Reject!③ Request BObtained Permission BHost App OSMini Program Running Title for Header

the authorized permission in the settings is empty, resulting that a user is unable to close authorization of relevant user
information. Users cannot fully control the transmission way and use the scope of their personal information, which
risks continuous opening of permissions and unknown use of personal information.

3.2.4 Permission Management Issues

A mini program may continue to use sensitive permissions to collect users’ privacy information even a user wants to
turn off the permissions after using it. In particular, it can be divided into the following three situations.

Permission Setting Disappears. The permission setting page provides convenience for users to manage permissions
of mini programs. However, some mini programs may get permanent authorization after one-time authorization due to
the lack of setting pages showing permissions. In this case, users cannot view what permissions they have granted to a
mini program, and they cannot cancel the previously granted permission. As long as the host app is not uninstalled,
the permission will remain open to the mini programs. Thus, a mini program can use the previous authorization to
continuously gather and use the user’s personal information, posing a security risk.

Permission Cannot be Deleted. Regarding the validity period of authorization of mini programs, once a user explicitly
agrees or rejects the authorization, such an authorization relationship will be recorded in the background until the user
actively deletes the mini programs. However, the permissions some mini programs may not be able to delete, which can
cause harmful consequences. These mini programs will be able to use the previous authorization to continue collecting
and using users’ personal information.

Unable to Completely Remove Permissions. Although the authorization settings of some mini programs are deleted
after a user actively removes the mini programs, the sensitive personal information (such as ID number) involved will
be retained. And such information can be leveraged for queries and other operations. At this time, the setting options
of related permissions will not be in the mini programs’ settings page, and the user cannot completely remove the
permission. Hence, although a user cancels the authorization, the related mini programs do not update the authorization
in time, thus continuously collecting and using the user’s personal information. This leads to a risk of using a user’s
personal information for abuse.

3.2.5 Webview Bypasses Permission Control

The mini programs can use the web-view page bearing component to open the H5 page in the mini programs. In this
process, the loaded H5 page needs to manually import JS ﬁles (which is a web development toolkit based on the host
apps for web developers) provided by each platform. In this way, developers can apply the capabilities of mobile
phone system such as taking pictures, selecting pictures, and location with the help of host apps to provide users with
a better web experience. After empirical study, we prove that webview can bypass the speciﬁed API when the mini
programs or host apps do not prompt for permission application or the user refuses after prompting. There are two
scenarios to illegally obtain sensitive permissions for mini programs after using the web-view component. First, the
mini programs may completely ignore the OS’s permission control over host apps and host apps’ permission control
over mini programs. They can directly access any sensitive permissions without notifying a user. Even when OS
rejects sensitive permissions from a host app, the mini programs can still obtain such permissions through the web-view
page-bearing component. Second, only the OS’s permission control over host apps is considered, while the host apps’
permission control over mini programs is ignored. The speciﬁc process is shown in Figure 6. In this case, if the OS’s
permission control on host apps is turned off, the mini programs will not obtain the corresponding sensitive permissions.
If the OS’s permission control on the host app is turned on, a user allows host apps to use certain sensitive permission.
Hence, any mini program in host apps can obtain sensitive permission. We would like to remark that both scenarios
may result in the disclosure of user privacy.

3.2.6 Permission Issues in Different Environments

The processing details for some APIs are not the same between different OS and versions. Since the mini program
framework can not handle these APIs differently depending on the running environment, the same operation or program
code will have different results.

For example, apps can read the clipboard contents without the user’s manually selecting “Paste” when the user copies
something. This is by design. Nevertheless, if the user copies sensitive information and leaves it on the clipboard, all
apps can capture it and maybe send it to a remote server. Copying private things from a clipboard is risky. Different
versions of OS have different feedback on this. The Android or old version of iOS will not inform the user when an
application reads the clipboard. Many host apps will also be silent when the mini program reads the clipboard. If OS or
host app does not consider the clipboard permission is dangerous, mini programs with access to the clipboard can steal
the clipboard information of users in the background.

8

Running Title for Header

Table 1: The list of collected 9 host apps.

Tencent

Alibaba

Company

ByteDance

Host App
WeChat
Tencent QQ
Alipay
TouTiao
TouTiao speed Edition
TikTok
Baidu
Baidu
Multi Vendor
QuickAPP
China UnionPay UnionPay
* Only contains Huawei’s data.

Monthly Active Users
1.26 billion [3]
595 million [22]
658 million [5]
[23]

400 million

1 billion [4]
607 million [24]
130 million* [25]
10.6 million [26]

3.3 Proof-of-concept Attacks

The vulnerabilities mentioned above we found can result in users’ sensitive information leakage. Here, we provide
three proof-of-concept attacks to prove the seriousness of these vulnerabilities.

3.3.1 Location Information Attack

An attacker can obtain the user’s location information through the issues mentioned above discovered. For example,
the second, third, and fourth issues discussed in Section 3.2.2 all involve location information leakage. An attacker
may simply call an API with a bug in the design of host apps to obtain user’s location information. Based on which,
an attacker can infer personal information such as user’s hobbies and sports patterns. More serious consequences can
also be resulted, such as being tracked and personal attacks. If an attacker steals a massive amount of personal private
information, the security and trust of the whole society will become an issue.

3.3.2 Contacts Attack

Some mini programs do separate the permission of “contacts”, which can result in serious consequence. For example,
the WeChat mini programs do not divide the permissions of “contacts” separately, so an attacker with ulterior motives
can return and match similar mobile phone numbers in the background by calling wx.searchContacts. Once a user is
enticed to click the button bound to the event, a malicious mini program can traverse the user’s address book information
for fraud.

3.3.3 Clipboard Content Attack

Since the mini program framework does not restrict the apps to read the clipboard, developers only need a few lines
of code to see what users have just copied. If users copy an online banking password to paste and leave this private
information on the clipboard, a malicious mini program can read it in the background and see that data directly. The
same goes for other sensitive data like names, addresses, credit card numbers, or even private photos. Mini programs
can capture everything of user’s clipboard and do whatever they want with it. The copied text could be sent to a remote
server without user’s awareness.

4 Empirical Study

This section presents our empirical study for analyzing the current mini programs permissions. Our goal is twofold. First,
we collect the current popular mini program platforms (Table 1), and then expose potential vulnerabilities as outlined in
Section 3. We also exhibit the security issues exposed in the real world through detection. Second, we conduct case
studies to show some real attacks on the permissions of mini programs, to prove that the revealed vulnerabilities may
cause serious consequences in real-world use.

4.1 Mini Programs Ecosystem

As of June 2021, the number of mini programs in the whole network exceeded 7 million. We have identiﬁed 9 popular
host apps developed by 6 companies, which are listed in Table 1. These 9 host apps are used by tremendous amounts of
users. Each host app has its own development tools. We apply the respective development tools to test on different
host apps. Through empirical study, we discuss their vulnerabilities and list them in Figure 7. In this ﬁgure, the orange
blocks indicate that the host app has corresponding vulnerabilities, green blocks indicate that the host app has ﬁxed

9

Running Title for Header

Figure 7: The vulnerabilities distributions in the collected 9 host apps, where the vertical axis lists the names of host
apps and the horizontal axis lists the vulnerabilities that we have discussed in Section 3. Cell format: <analysis result
on Android> | <analysis result on iOS>

Table 2: The list of Collected PEL-APIs.

Vulnerabilities Host App API
Ignore

WeChat

Forgotten

QQ

Parameter
Invalidation

Alipay
WeChart

wx.searchContacts
MapContext.moveToLocation
MapContext.getCenterLocation
my.chooseCity
wx.choosePoi

vulnerabilities, gray block indicates that the host app does not have such a vulnerability, and light yellow blocks indicate
that it is uncertain if there exists such a vulnerability.

4.2 Vulnerability Analysis

4.2.1 Vulnerable Caching Mechanism

Our study discovered that in WeChat, when a user closes the used mini programs (which have not been deleted from the
recent use) and opens the mini programs again for operation, the previously cached temporary ﬁles still exist. Because
the local temporary ﬁle path can be obtained in the background, the temporary ﬁle can be reused without the user’s
consent before being recycled. In QQ and ByteDance, as long as the user exits the mini programs or reopens the
previously used mini programs, the previous temporary ﬁles will be automatically deleted. Hence, they don’t have the
vulnerable caching issue. This vulnerability has not been found temporarily in mini programs of other host apps.

4.2.2 Vulnerable Issues API

As discussed in Section 3.2.2, this kind of issue comes from that the API related to sensitive permissions does not
encapsulate permissions well. In order to ﬁnd APIs with such vulnerabilities, we set two criteria for analysis: 1)
whether Android and iOS treat the involved permissions as permissions that need to be granted by the user; 2) whether
using permissions by these APIs involves the interaction between users and mini programs. If the user must manually
operate to view, select or transmit private data, then the mini programs default that the user has allowed the use of the
permissions without prompting, so these APIs are not within the scope of our research. Table 2 summarizes the APIs
that we have found so far that are related to sensitive permissions but do not encapsulate permissions well.

10

WeChatQQAlipayBaiduTikTokTouTiaoTouTiao SpeedEditionQuickAPPweb-viewbypassesPermissionmanagementEnvironmentaldifferencesCache-relatedissuesExisted VulnerabilityFixed Vulnerability after Our ReportUnknown or No Discovery YetParameterInvalidationSecretly transferIgnoreForgottenNon-existentUnionPayCell format: Left Android Right iOSRunning Title for Header

4.2.3 Vulnerable Permissions Transfer

Vertical: "Amap" in the Alipay mini program can be opened directly to accurately locate the user, ignoring the
application of the mini program to the user for location permission. Although Alipay and AMap have reached an
in-depth cooperative relationship (both belong to Alibaba Group), this does not mean that their operations can bypass
the user’s willingness. No abnormality was found in the public test code of “demo” provided by Alipay, but using this
mini program alone can directly locate users accurately. This shows that there may be an inconsistency between the
source code of “demo” and the public test code provided. They may use other ways to bypass the user authorization to
transmit the user’s location secretly.

Horizontal: Some companies may share user information among different mini programs. For example, after logging
in the “Pinduodu” mini program in WeChat, the same login information is displayed directly when the user ﬁrst uses
another mini program named “Pinduoduo Coupon”, which is from the same company Pinduoduo Inc. This type of
mini program skips the permission application step, and the authorized permission in the settings is empty. Hence, the
user cannot close the authorization of relevant user information. Users cannot fully control the dissemination of their
personal information and the scope of use, which will lead to the continuous opening of permission and the risk of
personal information being used in unknown circumstances.

4.2.4 Insecure Permission Management

The permission management of UnionPay mini programs is rather messy. Since the security of UnionPay is mainly
related to user identity information and payment, it is not very strict to consider other sensitive permissions such as
microphones, geographic locations, cameras, and photo albums. On the privacy settings page of the UnionPay APP, we
can see the authorization information for mini programs. However, only the authorization of the phone number and
identity information (name, ID number) is displayed. In contrast, other permissions such as location, access to mobile
phone albums, and the camera are ignored, and there is no permission setting page inside mini programs. When a user
grants mini programs sensitive permission such as a microphone, geographical location, camera, and photo album, as
long as the UnionPay app is not uninstalled, the mini programs can always access these permissions.

We found that, in ByteDance, the permission of mini programs cannot be deleted with the deletion of the mini programs.
In the ofﬁcial ByteDance document, there is no clear explanation on the validity period of the authorization and whether
the authorization will remain open after deleting mini programs. Hence, mini programs under ByteDance may use
previous authorizations to continuously access and collect user personal information, posing a security risk.

Although the authorized information of Alipay mini programs can be deleted after a user actively deletes the mini
program, the sensitive personal information involved before (such as ID number) will be retained by individual mini
programs. We have canceled the authorization and removed the mini program, but the relevant information can still be
consulted when entering the mini programs again after a certain period. At this time, the permission setting of the mini
program becomes empty, and the user cannot set the permission on the setting page. This situation indicates that after
the user cancels the authorization, the related mini programs do not update the authorization in time and may continue
to collect and use the user’s sensitive information after the user has canceled the authorization.

4.2.5 Insecure Webview Component

Some mini programs can carry web pages through the webview component. The communication between the webpage
and mini programs is realized by the interfaces provided by the webpage development kit based on host apps provided
by each platform for web page developers. None of the communication outside the provided interface is supported.
Neither QQ nor ByteDance found any interfaces involving dangerous permissions. In the WeChat host app under
Android, it can be determined that the user’s storage information can be obtained using the webview component. That
is, the ﬁrst scenario described in Section 3.2.5 can be used to bypass the normative permission control. The difference
is that in WeChat mini programs under iOS, it is used to obtain the user’s album permission, and the second scenario
is used to obtain the user’s camera permission. The mini programs in Alipay bypass the standard permission control
through the second scenario described in Section 3.2.5, to obtain sensitive permissions such as the user’s camera,
photo album, location, etc., even if these permissions are turned off in the setting page of mini programs at this time.
That is, when users reject these sensitive permissions, the sensitive information can still be obtained by using the
webview component. The mini programs under Baidu, in the iOS environment, can use the second scenario to obtain
the camera permission to take pictures. QuickApp in Huawei can obtain the users’ stored information (pictures, audios,
videos, documents, etc.) through it. This will cause users to disclose their precise location to the attacker without their
awareness. If the user’s mobile phone turns on the GPS when taking photos, then once the mini programs can access the
camera and photo album, the malicious mini programs only need to ﬁlter out which photo taken by the user’s mobile
phone to know its geographical location.

11

Running Title for Header

Figure 8: Examples of getting clipboard contents in Android. Only case 2 and case 3 will prompt the user when the
mini programs get the contents of the user’s clipboard.

4.2.6 Vulnerable Clipboard Mechanism

After iOS 14 upgrade, there will be a pop-up to informs the user when an app reads the contents of the clipboard. Hence,
there will be a notiﬁcation when the mini programs read the clipboard no matter which host apps they run inside.

Android is more complex since there are multiple versions. Xiaomi MIUI12(MIUI is a third-party mobile phone OS
deeply optimized, customized, and developed by Xiaomi based on Android) splits the permission of the clipboard
independently, and users can monitor the reading and writing behavior of each application. However, in other Android
phones (such as Huawei, Vivo, etc.), the permissions control of the clipboard will not inform the users. Under these
OS versions, we test the clipboard permissions on different host apps in the Android environment, and check their
corresponding prompts, with results shown in Figure 8. In order to exhibit that the mini programs have obtained the
contents of a user’s clipboard, we display a modal dialog box. We found that 6 out of the 8 host apps (cases 1, 4, 5, 6 in
Figure 8) did not give any prompt to the user when obtaining the clipboard information, which may be vulnerable to the
theft of clipboard content described in Section 3.3.3. Cases 2 and 3 in Figure 8 show a design example that the mini
programs will prompt when obtaining the contents of a user’s clipboard. However, case 2 only reminds the user that
the mini programs have obtained the clipboard’s contents through a bubble, but the user only knows that it cannot be
blocked (same as the prompt in the iOS environment). In case 3, obtaining the clipboard’s content is set as the user’s
permission to operate. The user must select “Allow” before the mini program can obtain the corresponding information.
We consider these designs with the best security usability practice.

It should be noted that, although it is set as the user’s permission to operate in case 3, there is still an issue with Alipay.
In version 10.2.26.8000, Alipay will pop up a window to ask the user "Apply to obtain the contents of your clipboard",
and the contents of the clipboard have been pasted on the page before clicking "Reject" or "Allow" (this is equivalent to
the mini program still being able to obtain the clipboard information after the user refuses authorization). However, in
version 10.2.23.7100, users cannot get any content after clicking Reject.

12

WeChatBaidu TikTok TouTiao TouTiao SpeedEdition Alipay QQ 123456Quick APP (HUAWEI) Running Title for Header

Figure 9: Overview of measurement methodology

4.3 An Example

WeChat is an application in China with more than 1 billion active users, and it is also one of ﬁve applications in the world
that have surpassed this milestone. 78% of Chinese people aged 16-64 are using WeChat [27]. So, we take WeChat as
an example and detect the API with permission issues in the popular mini programs and expose security issues hidden in
the real world. MiniCrawler[28], an open source WeChat mini program crawler, can be used to automatically download,
unpack and index the mini programs from WeChat. However, the tool has strict requirements on the WeChat version,
and the latest WeChat version API has been replaced, so the tool cannot be used. Our measurement method is shown in
Figure 9.

4.3.1 Implementation

In order to ensure the smooth progress of the experiment, we did not choose the Android simulator (according to the
previous test experience, running small programs with the Android simulator will be very stuck). Instead, we select an
Android entity machine with ROOT permission to carry out our operation, as shown in Figure 9. Our experiment is
mainly divided into the following three parts:

Triggering We use Airtest, a UI automated testing tool based on image recognition and poco control recognition, to
achieve automated clicks on mini programs to obtain the source ﬁles (that is, downloading the source ﬁle package of
mini programs from the server to local). Notably, since mini programs can be used in parallel with the host apps after
clicking, each mini program needs to be completely exited after the simulation click is over. Otherwise, too many open
mini programs will cause the Android emulator slow. In the process of implementation, to achieve as far as possible
that each page of mini programs can be loaded successfully to obtain all the source ﬁles of mini programs, we adopted
LSH image detection algorithm for near repetition to determine whether the current page is consistent with the previous
page if it is consistent, and treat them as the same page. If it is inconsistent, it is considered as the next page. In order to
illustrate our experiment more clearly, the simulation click part is separated into the following three sub-modules:

User Behavior Imitation Module: The function of this module is to imitate the process of users clicking into mini
programs. The program completely replaces the human operation: Automatically clicking the “search” icon to enter the
search bar through the simulated click technology, automatically input the name of mini programs stored in the sample
library in the search bar through the ﬁle retrieval technology, and identify the accurately searched mini programs based
on the image recognition and poco control, to imitate the user behavior and enter mini programs.

Status Monitoring and Recursive Module: The main function of this module is to monitor the current interface
position of mini programs in real-time and recursively scan the page content. By deﬁning a page scanner and combining
LSH image detection algorithm, the depth of the current page is monitored in real-time to determine whether to enter
the next interface or call back to the previous interface through recursive function, for scanning as many different
interfaces of the same mini programs as possible and trying to get all the cache packets of mini programs.

Data Acquisition and Storage Module: The main function of this module is to obtain the source ﬁles of mini
programs. Take WeChat mini programs as an example. In the scenarios of WeChat version 8.0.2, the source ﬁles of
a certain WeChat mini program are all in the path “/data/data/com.tencent.mm/MicroMsg/.../appbrand/pkg”. Then,
we use the shell command to dump the source code of the mini program to the folder named after the WeChat mini
program to facilitate the follow-up work. At the same time, it is also necessary to delete the code packages that have
been transferred to other locations in a speciﬁc folder in time to prevent confusion with the code packages of the next
WeChat mini program.

13

API Dataset WeChatByteDanceQQAliBaiduTriggering ResultsreportAutomatic Code Comparison andManual AnalysisSource code analysisTest API in development toolsDecompileStatic  AnalysisSensitive Permission Detection SystemSource File……Detection in popular Mini ProgramsUser behavior imitation moduleStatus monitoring and recursive moduleData acquisition and storage moduleStatisticsRunning Title for Header

Figure 10: The proportion of wx.getClipboardData in different categories of WeChat mini programs.

Decompile: We obtain the source code of the speciﬁed mini programs through decompilation. We have added a
graphical operation interface to wxappUnpacker [29] for the decompilation script and conﬁgured Nodejs, the running
environment required for the decompilation script, which can decompile the mini program source ﬁles obtained in the
previous step to obtain their source code.

Statistics: This step counts the usage of APIs with permission issues in popular mini programs in the world. Based on
the issues found in section 3.2, we sorted out different mini programs platforms and listed APIs that have permission
issues. Screen these APIs from the source code of the mini programs, and measure the usage of the problematic API in
popular mini programs in the real world.

4.3.2 Results

We refer to the "Aladdin Index" (an intelligent platform for data analysis of the entire network of mini programs), to
select 578 popular mini programs for research, and get 977 mini programs packages after decompression. We take the
permission of the clipboard as an example to detect the severity. Figure 10 shows the proportion of wx.getClipboardData
in various WeChat mini programs. Almost every kind of WeChat mini program use the vulnerable API as a standard
API, which has the potential risk that some mini programs apply these API to invade user privacy.

4.4 Case Studies

In this section, we present our case study of some representative APIs and illegal mini programs.

4.4.1 Stealing Location Information

In the QQ mini program development tool, the index.js ﬁle used qq.createMapContext to create a MapContext object;
then we used MapContext.moveToLocation to move the map center to the current location (at this time, the map
component show-location is set to true); then use MapContext.getCenterLocation to get the latitude and longitude of
the current map center. In the whole process, the user’s geographic location, latitude, and longitude can be accurately
obtained in the background without the user’s authorization. When working with Tencent’s location service to accurately
obtain the location, the user’s speciﬁc location can be obtained. We conﬁrmed that the QQ mini programs could
obtain the coordinates of the center point of the current location without the user’s authorization, regardless of the
Android or iOS system, and successfully transfer the coordinate value, speciﬁc location, and other information to the
mini program background. Without authorization, the mini programs can obtain the user’s precise location. Once the
mini programs associate the location information with the account information in the background, the user’s personal
information is completely exposed. This is equivalent to unauthorized access to the user’s whereabouts (belonging to
personally sensitive information), and the mini programs are suspected of obtaining personal information in violation of
regulations.

14

00.050.10.150.20.250.3EducationTravelTrafficFinanceSelf-operated by merchantsCatering IndustryMedical IndustryRealty BusinessSportsPublic WelfareServing People's LivelihoodExpress DeliveryRunning Title for Header

4.4.2 Stealing Contacts

The API provided by the WeChat mini programs: wx.searchContacts is to ﬁnd the contacts and match a similar mobile
phone number. This API does not specify the number of calls within a period. Suppose the phoneNumber parameter
(the number to be searched) in this function is written in a loop. In that case, most of the information in the user contacts
can be obtained by traversing in sequence. Speciﬁcally, set a button in index.wxml to bind an event. Write the API
wx.searchContacts into this event in the index.js ﬁle, and click this button, the foreground will not respond, and the
background will get the information of the user’s contacts. At this time, if the host environment WeChat has already
obtained the contacts’ permission, the mini programs can obtain part of the contact information without the user’s
awareness. After testing, we have conﬁrmed that WeChat mini programs can use this method to obtain information
of some users’ contacts and successfully pass the obtained information into the mini programs’ background, whether
in Android or iOS, without the user’s authorization and the user’s awareness. Attackers can take advantage of this
vulnerability and bind wx.searchContacts to an inductive button to entice users to click. Sensitive information in the
user’s address book may be read and uploaded to the background, resulting in information leakage.

4.4.3 Stealing Clipboard Information

Take the WeChat mini programs as an example. During the test, we write wx.getClipboardData in the onload function
in the JS code so that the clipboard content can be easily obtained without the user’s awareness. Even if it is not
written in the onload function, binding this event to the button control can also trigger it. In the real world, mini
programs can write some inductive slogans on the button to induce the user to click and then obtain the contents of the
user’s clipboard. After a large number of tests, we have conﬁrmed that many host apps (WeChat, ByteDance, Baidu,
QuickAPP) can obtain user clipboard information and successfully transfer the obtained information into the mini
programs’ background without the user’s authorization and awareness. Suppose the copied content is not destroyed
after the user pastes it into an application. In that case, the content can still be obtained when the user opens a mini
program, thus causing the leakage of sensitive information of the user. For example, when a user copies the name of
a certain product, after opening a shopping mini program, it can read the content of the user’s clipboard and upload
the private information in the background. The vendor of this mini program will know the user may want to buy this
product and push similar commodities or analyze the user’s behavior to push advertisements accurately.

4.5 Responsible Disclosure

We reported the results of our investigation to the Tencent Security Response Center on May 6, 2021, and August 27,
2021, and received their vulnerability conﬁrmation. We also reported vulnerabilities regarding location and contacts
permissions to CVE, received their conﬁrmation of the vulnerability on May 18, 2021, and August 29, 2021, and
obtained CVE numbers CVE-2021-33057 and CVE-2021-40180.

5 Discussion

5.1 Limitations and Future Works

1) We conducted a series of mini programs’ permissions tests based on personal accounts. In other words, the tested
APIs are all for individuals. According to our statistics, the number of APIs open to non-individual developers and
certiﬁed mini programs is 4.6% of the total API numbers. This type of interface usually includes obtaining the user’s
mobile phone number, sports data, etc. Different host apps have different attitudes towards such interfaces. For example,
the WeChat mini programs allow individual developers to obtain user sports data, while in the Alipay mini programs,
this interface is only open to corporate users. Generally, those interfaces that are only open to enterprise users will be
more strictly managed by host apps since these can obtain more data. It is very difﬁcult for us to test the APIs used by
the enterprise accounts. In the future, we will cooperate with enterprises to test and research these APIs.

2) In the 4.3, we take the permissions of the clipboard in the WeChat mini programs as an example to test it in the mini
programs that are currently online. The percentage of detected problems is not large. However, it does not mean that
the vulnerabilities we put forward do not appear in mini programs in other host apps. As more global companies join
the mini programs related discussion, the number of emerging host apps supporting mini programs (such as UnionPay,
NetEase) increases. They just appeared, and the vulnerability proposed in this article may not exist. When host apps
gradually add new mini programs’ functions or APIs, they may also make the vulnerabilities we found in this article, so
the host apps still need to pay more attention to the permissions in the future.

15

Running Title for Header

5.2 Mitigation Measures

The purpose of our empirical analysis was to draw people’s attention to the neglected security issue of the improper use
of sensitive permissions in mini programs. In the face of the rapid development of mini programs and the sharp rise in
the demand for personal privacy protection of mini programs, it is necessary to strengthen the coordination of host apps,
apps vendors, and users to form a management system for personal privacy protection of mini programs.

The responsibility of host apps is the biggest. In essence, mini programs are still software that provides various services
for mobile users. Mini programs are put on shelves through the host apps, and host apps should strictly control the
management of permissions, actively rectify APIs related to users’ sensitive permissions, and protect user privacy with
the most signiﬁcant effort. For the apps vendors, it is necessary to consider how the existing OS handles speciﬁc APIs
and the results feedback. For example, face the clipboard issues, the developer can highlight any word in the app and
select “Copy” or automatically clear the clipboard after a while. Users also need to enhance the security awareness to
protect personal information when using mini programs, be vigilant against mini programs of unknown origin, and
do not quickly authorize their private information to the mini programs to avoid being illegally collected and leaked,
causing unnecessary losses. At the same time, users should be encouraged to report illegal activities actively.

6 Related Work

Reason Exploration. Almomani et al.[30] demonstrated, discussed and compared the latest technologies in the ﬁeld of
Android permissions, and conducted the latest research on Android permissions, revealing that the Android permissions
faces various security issues. Zheran Fang et al. [31] investigate the arising issues in Android security, including coarse
granularity of permissions, incompetent permission administration, insufﬁcient permission documentation, over-claim
of permissions, permission escalation attack, and TOCTOU (Time of Check to Time of Use) attack and put forward
several methods to further reduce Android security risks. Joel Reardon et al.[13] searched for sensitive data being
sent over the network for which the sending app did not have permissions to access it by mechanisms to monitor the
application’s runtime behavior and network trafﬁc. They found that apps can circumvent the permission model and
gain access to protected data without user consent by using both covert and side channels and determined how this
unauthorized access occurs. Mujahid [32] implement a technique in a tool called PERMLYZER, which automatically
detects permission issues from apps APK.

Detection and Protection.
In the Android, the most common is the permission management mechanism of
Android[33, 34, 35, 36]. DroidNet[12] is an Android permission control and recommendation system, which is
an Android permission control framework based on crowdsourcing. It provides recommendations on whether to accept
or reject the permission requests based on decisions from peer expert users, which can help users implement low-risk
resource access control for untrusted applications and protect users’ privacy. HybridGuard[37], a framework based on
the subject authority and ﬁne-grained policy execution for web mobile applications, can accurately monitor all web
codes to ensure the security of mobile applications, in which an interception and policy code is implemented in a single
JavaScript ﬁle, and whether to intercept them is determined by wrapping API about device resource access and DOM
operation and checking the policy. M-Perm[11] is a detection tool that combines string analysis and static analysis to
identify normal, dangerous, and third-party permission requests in applications to detect permission abuse. Cusper[38]
is a new modular design in the Android permission model, which separates the management of system permissions
from custom permissions declared by untrusted third-party applications. It introduces backwards compatible naming
conventions for custom permissions to systematically eliminate and prevent the loopholes of custom permissions.

The mainstream approach for enhancing the Android permission mechanism is to identify over-declared permissions
requested by an app [39, 40, 41, 42], and recommend appropriate permissions for an app [43, 44]. TERMINATOR [16]
provides a safe, reliable, yet non-disruptive approach to protect mobile users against permission misuses.Bin Liu et
al.[14] proposed a Personalized Privacy Assistant (PPA) for mobile applications, which can manage mobile permissions
of mobile applications and predict the privacy settings that users want by asking some questions, and proposed a method
to learn the privacy proﬁle of permission settings. Bao [45] also propose two novel approaches to realize permission
recommendation.

7 Conclusion

The mini program is a new mobile application format that runs inside a mobile app. Although these mini programs
are taking over the traditional mobile OS and have become the way to do almost everything in China, there is little
research on these mini programs, especially for their potential security and privacy issues. In this paper, we conducted a
large-scale analysis of mini programs in different host apps for the ﬁrst time. We have conducted empirical research on 9

16

Running Title for Header

currently popular host apps, revealing the security issues corresponding to the 6 types of potential security vulnerabilities
we have discovered in the real world. We propose corresponding attack methods to analyze these potential weaknesses
to exploit the discovered vulnerabilities. In addition, we also showed three real-life attacks on the mini program’s
permissions to prove that the revealed vulnerabilities may cause serious consequences in real-world use. Following the
practice of responsible disclosure, we have also reported newly discovered vulnerabilities to relevant security platforms,
among which the more serious vulnerabilities obtained the CVE number. Lastly, we put forward a series of suggestions
for the future deployment of mini programs to protect users’ privacy.

References

[1] Mini program platforms 2021: Wechat vs. alibaba vs. baidu. https://www.chinainternetwatch.com/

30749/mini-program-platforms/.

[2] Miniapp standardization white paper. https://www.w3.org/TR/mini-app-white-paper/.

[3] Number of monthly active wechat users from 2nd quarter 2011 to 3rd quarter 2021. https://www.statista.

com/statistics/255778/number-of-active-wechat-messenger-accounts/#statisticContainer.

[4] Tiktok user statistics (2021). https://backlinko.com/tiktok-users.

[5] Number
as
china-leading-payment-apps-based-on-monthly-active-users/.

of monthly
september

china
https://www.statista.com/statistics/1211923/

payment

leading

(mau)

active

2021.

users

apps

the

of

of

in

[6] Number of monthly active facebook users worldwide as of 2nd quarter 2021. https://www.statista.com/

statistics/264810/number-of-monthly-active-facebook-users-worldwide/.

[7] David Barrera, H Güne¸s Kayacik, Paul C Van Oorschot, and Anil Somayaji. A methodology for empirical analysis
of permission-based security models and its application to android. In Proceedings of the 17th ACM conference
on Computer and communications security, pages 73–84, 2010.

[8] William Enck, Machigar Ongtang, and Patrick McDaniel. Understanding android security. IEEE security &

privacy, 7(1):50–57, 2009.

[9] Xiaojuan Ma. App store killer? the storm of wechat mini programs swept over the mobile app ecosystem.

Retrieved November, 15:2019, 2019.

[10] Kathy Wain Yee Au, Yi Fan Zhou, Zhen Huang, and David Lie. Pscout: analyzing the android permission
speciﬁcation. In Proceedings of the 2012 ACM conference on Computer and communications security, pages
217–228, 2012.

[11] Piper Chester, Chris Jones, Mohamed Wiem Mkaouer, and Daniel E Krutz. M-perm: A lightweight detector for
android permission gaps. In 2017 IEEE/ACM 4th International Conference on Mobile Software Engineering and
Systems (MOBILESoft), pages 217–218. IEEE, 2017.

[12] Bahman Rashidi, Carol Fung, Anh Nguyen, Tam Vu, and Elisa Bertino. Android user privacy preserving through

crowdsourcing. IEEE Transactions on Information Forensics and Security, 13(3):773–787, 2017.

[13] Joel Reardon, Álvaro Feal, Primal Wijesekera, Amit Elazari Bar On, Narseo Vallina-Rodriguez, and Serge
Egelman. 50 ways to leak your data: An exploration of apps’ circumvention of the android permissions system.
In 28th {USENIX} Security Symposium ({USENIX} Security 19), pages 603–620, 2019.

[14] Bin Liu, Mads Schaarup Andersen, Florian Schaub, Hazim Almuhimedi, Shikun Aerin Zhang, Norman Sadeh,
Yuvraj Agarwal, and Alessandro Acquisti. Follow my recommendations: A personalized privacy assistant for
mobile app permissions. In Twelfth Symposium on Usable Privacy and Security ({SOUPS} 2016), pages 27–41,
2016.

[15] Ibtisam Mohamed and Dhiren Patel. Android vs ios security: A comparative study. In 2015 12th International

Conference on Information Technology-New Generations, pages 725–730. IEEE, 2015.

[16] Alireza Sadeghi, Reyhaneh Jabbarvand, Negar Ghorbani, Hamid Bagheri, and Sam Malek. A temporal permission
analysis and enforcement framework for android. In Proceedings of the 40th International Conference on Software
Engineering, pages 846–857, 2018.

[17] Michael Backes, Sven Bugiel, Erik Derr, Patrick McDaniel, Damien Octeau, and Sebastian Weisgerber. On
demystifying the android application framework: Re-visiting android permission speciﬁcation analysis. In 25th
{USENIX} security symposium ({USENIX} security 16), pages 1101–1118, 2016.

17

Running Title for Header

[18] Primal Wijesekera, Arjun Baokar, Ashkan Hosseini, Serge Egelman, David Wagner, and Konstantin Beznosov.
Android permissions remystiﬁed: A ﬁeld study on contextual integrity. In 24th {USENIX} Security Symposium
({USENIX} Security 15), pages 499–514, 2015.

[19] Lei Hao, Fucheng Wan, Ning Ma, and Yicheng Wang. Analysis of the development of wechat mini program. In

Journal of Physics: Conference Series, volume 1087, page 062040. IOP Publishing, 2018.

[20] What is instant app (google android instant app)? https://searchmobilecomputing.techtarget.com/

definition/instant-app.

[21] Permissions on android.

https://developer.android.google.cn/guide/topics/permissions/

overview.

[22] Number of monthly active smart device users of tencent qq from 2014 to 2020. https://www.statista.com/

statistics/227352/number-of-active-tencent-im-user-accounts-in-china/.

[23] Bytedance wants to build douyin into a "super application"?

https://min.news/en/tech/

3f449f76f455fb475588cb97c281bf10.html.

[24] Baidu q3 2021 on ai, autonomous driving; mau grown to 607m. https://www.chinainternetwatch.com/

31413/baidu-quarterly/.

[25] The monthly

active

users

of

quick

app.

https://twitter.com/Huawei_devs/status/

1398270846481965063.

[26] Top

payment

apps

in

china

in

2021.

https://ecommercedb.com/en/blogPost/3238/

top-payment-apps-in-china-in-2021#:~:text=The%20payment%20app%20of%20UnionPay,5.
2%20million%20and%208.8%20million.
and
wechat-statistics/.

https://www.businessofapps.com/data/

statistics

revenue

(2021).

usage

[27] Wechat

[28] Yue Zhang, Bayan Turkistani, Allen Yuqing Yang, Chaoshun Zuo, and Zhiqiang Lin. A measurement study
of wechat mini-apps. In Abstract Proceedings of the 2021 ACM SIGMETRICS/International Conference on
Measurement and Modeling of Computer Systems, pages 19–20, 2021.

[29] wxappunpacker. https://github.com/141Mr-liu/wxappUnpacker.
[30] Iman M Almomani and Aala Al Khayer. A comprehensive analysis of the android permissions system. IEEE

Access, 8:216671–216688, 2020.

[31] Zheran Fang, Weili Han, and Yingjiu Li. Permission based android security: Issues and countermeasures.

computers & security, 43:205–218, 2014.

[32] Suhaib Mujahid, Rabe Abdalkareem, and Emad Shihab. Studying permission related issues in android wearable
apps. In 2018 IEEE International Conference on Software Maintenance and Evolution (ICSME), pages 345–356.
IEEE, 2018.

[33] Efthimios Alepis and Constantinos Patsakis. Unravelling security issues of runtime permissions in android.

Journal of Hardware and Systems Security, 3(1):45–63, 2019.

[34] Yuan Zhang, Min Yang, Guofei Gu, and Hao Chen. Rethinking permission enforcement mechanism on mobile

systems. IEEE Transactions on Information Forensics and Security, 11(10):2227–2240, 2016.

[35] Alireza Sadeghi, Hamid Bagheri, Joshua Garcia, and Sam Malek. A taxonomy and qualitative comparison
of program analysis techniques for security assessment of android software. IEEE Transactions on Software
Engineering, 43(6):492–530, 2016.

[36] Darell JJ Tan, Tong-Wei Chua, and Vrizlynn LL Thing. Securing android: a survey, taxonomy, and challenges.

ACM Computing Surveys (CSUR), 47(4):1–45, 2015.

[37] Phu H Phung, Abhinav Mohanty, Rahul Rachapalli, and Meera Sridhar. Hybridguard: A principal-based
permission and ﬁne-grained policy enforcement framework for web-based mobile applications. In 2017 IEEE
Security and Privacy Workshops (SPW), pages 147–156. IEEE, 2017.

[38] Güliz Seray Tuncay, Soteris Demetriou, Karan Ganju, and C Gunter. Resolving the predicament of android custom

permissions. 2018.

[39] Alessandra Gorla, Ilaria Tavecchia, Florian Gross, and Andreas Zeller. Checking app behavior against app
descriptions. In Proceedings of the 36th international conference on software engineering, pages 1025–1035,
2014.

[40] Jiayu Wang and Qigeng Chen. Aspg: Generating android semantic permissions. In 2014 IEEE 17th International

Conference on Computational Science and Engineering, pages 591–598. IEEE, 2014.

18

Running Title for Header

[41] Zhengyang Qu, Vaibhav Rastogi, Xinyi Zhang, Yan Chen, Tiantian Zhu, and Zhong Chen. Autocog: Measuring the
description-to-permission ﬁdelity in android applications. In Proceedings of the 2014 ACM SIGSAC Conference
on Computer and Communications Security, pages 1354–1365, 2014.

[42] Rahul Pandita, Xusheng Xiao, Wei Yang, William Enck, and Tao Xie. {WHYPER}: Towards automating risk
assessment of mobile applications. In 22nd {USENIX} Security Symposium ({USENIX} Security 13), pages
527–542, 2013.

[43] Keman Huang, Jinjing Han, Shizhan Chen, and Zhiyong Feng. A skewness-based framework for mobile app
permission recommendation and risk evaluation. In International Conference on Service-Oriented Computing,
pages 252–266. Springer, 2016.

[44] Zhongxin Liu, Xin Xia, David Lo, and John Grundy. Automatic, highly accurate app permission recommendation.

Automated Software Engineering, 26(2):241–274, 2019.

[45] Lingfeng Bao, David Lo, Xin Xia, and Shanping Li. Automated android application permission recommendation.

Science China Information Sciences, 60(9):1–17, 2017.

19



=== Content from pan.baidu.com_c2e3d06f_20250114_195159.html ===


ha\*\*\*\*街短梦
暂无签名
加为好友

![验证码]()

提取文件

添加好友

对方需要你填写验证信息

取消
确定

©2025 Baidu [服务协议](/disk/duty/)|[权利声明](//yun.baidu.com/disk/privacy)|[版本更新](//yun.baidu.com/disk/version)|[帮助中心](http://yun.baidu.com/disk/help)|[问题反馈](http://qingting.baidu.com/index?pid=19)|[版权投诉](http://copyright.baidu.com/index.php/index/complaint)|企业认证


