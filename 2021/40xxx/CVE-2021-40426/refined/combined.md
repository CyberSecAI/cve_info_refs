=== Content from talosintelligence.com_40bf7905_20250114_205213.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2021-1434

## Sound Exchange libsox sphere.c start\_read() heap-based buffer overflow vulnerability

##### March 23, 2022

##### CVE Number

CVE-2021-40426

##### SUMMARY

A heap-based buffer overflow vulnerability exists in the sphere.c start\_read() functionality of Sound Exchange libsox 14.4.2 and master commit 42b3557e. A specially-crafted file can lead to a heap buffer overflow. An attacker can provide a malicious file to trigger this vulnerability.

##### CONFIRMED VULNERABLE VERSIONS

The versions below were either tested or verified to be vulnerable by Talos or confirmed to be vulnerable by the vendor.

Sound Exchange libsox 14.4.2

Sound Exchange libsox master commit 42b3557e

##### PRODUCT URLS

libsox - <http://sox.sourceforge.net/Main/HomePage>

##### CVSSv3 SCORE

10.0 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

##### CWE

CWE-122 - Heap-based Buffer Overflow

##### DETAILS

Libsox is a well-aged library used for cross-platform audio editing software, originally written in 1991. After decades of development, a wide range of file formats are supported, including .wav, .flac, and .mp3 (with the aid of an external library).

Out of the multitude of file formats that Sound Exchange’s libsox can deal with, today we discuss the extremely obscure NIST Speech Header Resources (SPHERE) file format, which apparently is used for speech recognition. But regardless of the purpose, libsox will still process a given file as a `.sph` assuming that the file header matches:

```
 static char const * auto_detect_format(sox_format_t * ft, char const * ext)
{
  char data[AUTO_DETECT_SIZE];
  size_t len = lsx_readbuf(ft, data, ft->seekable? sizeof(data) : PIPE_AUTO_DETECT_SIZE);
  #define CHECK(type, p2, l2, d2, p1, l1, d1) if (len >= p1 + l1 && \
      !memcmp(data + p1, d1, (size_t)l1) && !memcmp(data + p2, d2, (size_t)l2)) return #type;
  // [...]
  CHECK(sph   , 0, 0, ""     , 0,  7, "NIST_1A")

```

This `auto_detect_format` will be hit from either `sox_open_mem_read` or `sox_open_read`, but only if the filetype is not specified by the arguments. Either way, since it’s possible to hit the processing in `sphere.c` via autodetection, let us look at the `start_read` function for the SPHERE file format:

```
static int start_read(sox_format_t * ft)
{
  unsigned long header_size_ul = 0, num_samples_ul = 0;
  size_t     header_size, bytes_read;
  // [...]
  char           fldname[64], fldtype[16], fldsval[128];
  char           * buf;

  /* Magic header */
  if (lsx_reads(ft, fldname, (size_t)8) || strncmp(fldname, "NIST_1A", (size_t)7) != 0) {   // [1]
    lsx_fail_errno(ft, SOX_EHDR, "Sphere header does not begin with magic word `NIST_1A'");
    return (SOX_EOF);
  }

  if (lsx_reads(ft, fldsval, (size_t)8)) {                                                  // [2]
    lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
    return (SOX_EOF);
  }

  /* Determine header size, and allocate a buffer large enough to hold it. */
  sscanf(fldsval, "%lu", &header_size_ul);                                                  // [3]
  if (header_size_ul < 16) {
    lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
    return (SOX_EOF);
  }

  buf = lsx_malloc(header_size = header_size_ul);                                           // [4]

```

So far the code is pretty standard. We read eight bytes at [1], make sure the “NIST\_1A” magic bytes are there, and then read another eight bytes at [2], this time populating them into the `unsigned long header_size_ul` at [3]. At [4], we then allocate a buffer of that size. Again, pretty standard. Continuing on:

```
  /* Skip what we have read so far */
  header_size -= 16;

  if (lsx_reads(ft, buf, header_size) == SOX_EOF) {       // [5]
    lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
    free(buf);
    return (SOX_EOF);
  }

  header_size -= (strlen(buf) + 1);

```

At [5] we see the main function used for reading our input buffer, `lsx_reads`. Suffice to say, this function is essentially `fgets` (although I’m not actually sure which function has seniority), and `buf` will contain a new line of text from our input buffer every time `lsx_reads` is called. We now finally reach our main processing loop:

```
  while (strncmp(buf, "end_head", (size_t)8) != 0) {    // [6]

    if (strncmp(buf, "sample_n_bytes", (size_t)14) == 0)
      sscanf(buf, "%63s %15s %u", fldname, fldtype, &bytes_per_sample);
    else if (strncmp(buf, "channel_count", (size_t)13) == 0)
      sscanf(buf, "%63s %15s %u", fldname, fldtype, &channels);
      // [...]
      else {
        lsx_fail_errno(ft, SOX_EFMT, "sph: unsupported coding `%s'", fldsval);
        free(buf);
        return SOX_EOF;
      }
    }
    else if (strncmp(buf, "sample_byte_format", (size_t)18) == 0) {
      sscanf(buf, "%53s %15s %127s", fldname, fldtype, fldsval);
      if (strcmp(fldsval, "01") == 0)         /* Data is little endian. */
        ft->encoding.reverse_bytes = MACHINE_IS_BIGENDIAN;
      else if (strcmp(fldsval, "10") == 0)    /* Data is big endian. */
        ft->encoding.reverse_bytes = MACHINE_IS_LITTLEENDIAN;
      else if (strcmp(fldsval, "1")) {
        lsx_fail_errno(ft, SOX_EFMT, "sph: unsupported coding `%s'", fldsval);
        free(buf);
        return SOX_EOF;
      }
    }

    if (lsx_reads(ft, buf, header_size) == SOX_EOF) {   // [7]
      lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
      free(buf);
      return (SOX_EOF);
    }

    header_size -= (strlen(buf) + 1);

```

At [6], we can see that we’re looping until a `end_head` header is found, but in the meantime, we search for various headers in the file (e.g. `"channel_count"`, `"sample_byte_format"`, etc.). After going through the specific buffer line, we read a new one in at [7], then subtract the length of our new buffer plus one at [8]. The `+ 1` compensates for the `\n` or `\x00` bytes that delimit the headers of our file.

But let’s examine a situation in which we provide a file that does not contain a valid `end_head` header:

```
  while (strncmp(buf, "end_head", (size_t)8) != 0) {  // [6]

    if (strncmp(buf, "sample_n_bytes", (size_t)14) == 0)
      sscanf(buf, "%63s %15s %u", fldname, fldtype, &bytes_per_sample);
    else if (strncmp(buf, "channel_count", (size_t)13) == 0)
        // [...]
    }

    if (lsx_reads(ft, buf, header_size) == SOX_EOF) { // [7]
      lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
      free(buf);
      return (SOX_EOF);
    }

    header_size -= (strlen(buf) + 1);

```

At [6] again, we start our loop, which eventually processes our header strings inside, but then at [7] the next header is read via `lsx_reads`. A quick look at `lsx_reads` reveals an important detail:

```
int lsx_reads(sox_format_t * ft, char *c, size_t len)
{
    char *sc;
    char in;

    sc = c;
    do  // [8]
    {
        if (lsx_readbuf(ft, &in, (size_t)1) != 1)
        {
            *sc = 0;
            return (SOX_EOF);
        }
        if (in == 0 || in == '\n')
            break;

        *sc = in;
        sc++;
    } while (sc - c < (ptrdiff_t)len);  // [9]
    *sc = 0;
    return(SOX_SUCCESS);
}

```

Since `lsx_reads` utilizes a `do`/`while` loop ([8], [9]), even though the conditional at [9] depends on a less-than sign and not a less-than-equals-to sign. If our input `len` parameter is 22, then 22 bytes of data are copied over, followed by the null byte write. So in effect, 23 bytes of data get written from a 22 byte len, which is an off-by-one. Curiously, in spite of `lsx_reads` ubiquitous usage in libsox, all the other call sites compensate for this off-by-one, usually with a `-1` to the input `len` parameter when calling. However, in the `sphere.c` code, we see a different compensation:

```
    if (lsx_reads(ft, buf, header_size) == SOX_EOF) {   // [10]
      lsx_fail_errno(ft, SOX_EHDR, "Error reading Sphere header");
      free(buf);
      return (SOX_EOF);
    }

    header_size -= (strlen(buf) + 1);                   // [11]

```

At [11], we can see that an extra byte is subtracted from our `header_size` parameter to compensate for the off-by-one in `lsx_reads`. Thus, if the `header_size` is 22 and our next buffer is read in, `lsx_reads` will stop at 22 bytes (regardless of the length of the rest of the buffer). Then we subtract 23 from `header_size`, resulting in an integer underflow.

With regards to exploitation: While normally such a situation might result in a wild copy (i.e. we couldn’t stop the bug from writing into things we don’t want it to and crashing), we’re bailed out by the overall structure of this function. We’d simply have our next read be our overflow string of any size that we wanted, and then the following read just being `"end_head"`. This would allow us to arbitrarily overwrite data on the heap while also allowing us to continue into the code to actually utilize the heap overflow.

### Crash Information

```
==778467==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6060000000ba at pc 0x0000004bea6e bp 0x7ffeacb7c950 sp 0x7ffeacb7c118
WRITE of size 203 at 0x6060000000ba thread T0
    #0 0x4bea6d in __interceptor_fread (/doop/boop/sox/triage_built/fuzz_sox.bin+0x4bea6d)
    #1 0x7ff5dc360ea7 in lsx_readbuf /doop/boop/sox/triage_built/triage_sox/src/formats_i.c:98:16
    #2 0x7ff5dc4b9bc0 in start_read /doop/boop/sox/triage_built/triage_sox/src/sphere.c:119:18
    #3 0x7ff5dc46c864 in open_read /doop/boop/sox/triage_built/triage_sox/src/formats.c:545:32
    #4 0x7ff5dc46d2bb in sox_open_mem_read /doop/boop/sox/triage_built/triage_sox/src/formats.c:595:10
    #5 0x55623a in LLVMFuzzerTestOneInput /doop/boop/sox/./fuzz_sox_harness.cpp:51:10
    #6 0x456ff3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) fuzzer.o
    #7 0x442b32 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) fuzzer.o
    #8 0x448a5b in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) fuzzer.o
    #9 0x471ef2 in main (/doop/boop/sox/triage_built/fuzz_sox.bin+0x471ef2)
    #10 0x7ff5dbfa1fcf in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #11 0x7ff5dbfa207c in __libc_start_main csu/../csu/libc-start.c:409:3
    #12 0x41f7a4 in _start (/doop/boop/sox/triage_built/fuzz_sox.bin+0x41f7a4)

0x6060000000ba is located 0 bytes to the right of 58-byte region [0x606000000080,0x6060000000ba)
allocated by thread T0 here:
    #0 0x521d83 in __interceptor_realloc (/doop/boop/sox/triage_built/fuzz_sox.bin+0x521d83)
    #1 0x7ff5dc47b388 in lsx_realloc /doop/boop/sox/triage_built/triage_sox/src/xmalloc.c:37:14
    #2 0x7ff5dc4b9376 in start_read /doop/boop/sox/triage_built/triage_sox/src/sphere.c:55:9
    #3 0x7ff5dc46c864 in open_read /doop/boop/sox/triage_built/triage_sox/src/formats.c:545:32
    #4 0x7ff5dc46d2bb in sox_open_mem_read /doop/boop/sox/triage_built/triage_sox/src/formats.c:595:10
    #5 0x55623a in LLVMFuzzerTestOneInput /doop/boop/sox/./fuzz_sox_harness.cpp:51:10
    #6 0x456ff3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) fuzzer.o
    #7 0x442b32 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) fuzzer.o
    #8 0x448a5b in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) fuzzer.o
    #9 0x471ef2 in main (/doop/boop/sox/triage_built/fuzz_sox.bin+0x471ef2)
    #10 0x7ff5dbfa1fcf in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16

SUMMARY: AddressSanitizer: heap-buffer-overflow (/doop/boop/sox/triage_built/fuzz_sox.bin+0x4bea6d) in __interceptor_fread
Shadow bytes around the buggy address:
  0x0c0c7fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff8000: fa fa fa fa fd fd fd fd fd fd fd fa fa fa fa fa
=>0x0c0c7fff8010: 00 00 00 00 00 00 00[02]fa fa fa fa fa fa fa fa
  0x0c0c7fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00

  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==692318==ABORTING

```
##### TIMELINE

2021-12-22 - Initial contact

2022-01-14 - Follow up with vendor; vendor acknowledged

2022-03-23 - Vendor disclosure

##### Credit

Discovered by Lilith >\_> of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2022-1512](/vulnerability_reports/TALOS-2022-1512) [Previous Report

TALOS-2022-1441](/vulnerability_reports/TALOS-2022-1441)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from www.openwall.com_4cb3f227_20250114_205211.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2023/02/04/1) [[thread-next>]](../../../2023/02/04/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Y91yP6mYIZ+UXmgf@alf.mars>
Date: Fri, 3 Feb 2023 21:44:47 +0100
From: Helmut Grohne <helmut@...divi.de>
To: oss-security@...ts.openwall.com
Subject: sox: patches for old vulnerabilities

Hi,

I am working on fixing known vulnerabilities in sox and since upstream
seems mostly dead (no commits in more than a year, no replies to bug
reports), I am posting my results here. My work on sox is compensated by
Freexian SARL.

I located two distinct memory leaks.

The fix for CVE-2017-11358 introduced a regression. Reading any hcom
file would result in an error. This made the test suite fail, but since
nobody seems to run the test suite, this ended up being shipped in e.g.
multiple Debian releases.

On 64bit big endian systems, a 64bit integer is incorrectly truncated to
the upper 32bits. This subsequently causes an assertion failure or a
stack overflow in a -DNDEBUG build. This issue also breaks the test
suite. I do not think that this is exploitable and do not intend to
request a CVE.

I'm attaching patches for these as well as patches for the following
vulnerabilities:
 * CVE-2021-3643 and CVE-2021-23210
 * CVE-2021-23159 and CVE-2021-23172
 * CVE-2021-33844
 * CVE-2021-40426
 * CVE-2022-31650
 * CVE-2022-31651

I welcome reviews and propose adding these patches to distributions that
ship sox. I will upload these patches to Debian.

Please Cc me in replies.

Helmut

View attachment "[fix-resource-leak-comments.patch](3/1)" of type "text/x-diff" (314 bytes)

View attachment "[fix-resource-leak-hcom.patch](3/2)" of type "text/x-diff" (1445 bytes)

View attachment "[fix-regression-in-CVE-2017-11358.patch](3/3)" of type "text/x-diff" (1833 bytes)

View attachment "[fix-hcom-big-endian.patch](3/4)" of type "text/x-diff" (1023 bytes)

View attachment "[CVE-2021-23159.patch](3/5)" of type "text/x-diff" (737 bytes)

View attachment "[CVE-2021-33844.patch](3/6)" of type "text/x-diff" (1102 bytes)

View attachment "[CVE-2021-3643.patch](3/7)" of type "text/x-diff" (652 bytes)

View attachment "[CVE-2021-40426.patch](3/8)" of type "text/x-diff" (822 bytes)

View attachment "[CVE-2022-31650.patch](3/9)" of type "text/x-diff" (1642 bytes)

View attachment "[CVE-2022-31651.patch](3/10)" of type "text/x-diff" (859 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_fbffa963_20250114_205214.html ===


---

[[Date Prev](msg00044.html)][[Date Next](msg00046.html)]
[[Thread Prev](msg00044.html)][[Thread Next](msg00046.html)]
[[Date Index](maillist.html#00045)]
[[Thread Index](threads.html#00045)]

# [SECURITY] [DSA 5356-1] sox security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5356-1] sox security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 20 Feb 2023 19:08:52 +0000
* *Message-id*: <Y/PFRPGRXqeQ02Ys@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5356-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
February 20, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : sox
CVE ID         : CVE-2021-3643 CVE-2021-23159 CVE-2021-23172 CVE-2021-23210
                 CVE-2021-33844 CVE-2021-40426 CVE-2022-31650 CVE-2022-31651
Debian Bug     : 1010374 1012138 1012516 1021133 1021134 1021135

Multiple security issues were discovered in Sox, the Swiss Army knife of
sound processing programs, which could result in denial of service or
potentially the execution of arbitrary code if a malformed audio file
is processed.

For the stable distribution (bullseye), these problems have been fixed in
version 14.4.2+git20190427-2+deb11u1.

We recommend that you upgrade your sox packages.

For the detailed security status of sox please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sox>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmPzxOgACgkQEMKTtsN8
TjYaEhAAlz/kw36CztzPYWoje596qLuQKtTWW6AHLRvE1jOcum2ymDmEqePfjg+b
HXQPGGhU8Fd6StyXFnqrCW7pvrhcIcQNYZfUqvTcmIlOTdumyZxpoIBaRIk7m68H
MFd7o0Nc7/fJpHyAw4Oobn+kyZj1Tf3uoiHrqZS45RUG02jIIKV+7rkYxE7qIzHi
HiS9IBIpeBGljQ4RyLZ+eyNNQuF+7X7Ep29aym6l2nsOSHkDZETvpHKj+4TrMPvZ
QLQJ3hrbPoTIHQtsWWbDX8WD3NwXOBRCXwxIOlnXhjiFN5Toc7x0YB0mTdzmXYQ8
LWex4xDYtM/tJE4oipCV3/iD/c/d9Q3F0y1ielQeVuA6YEdTkLp1RoBUkMeWhXIy
LoDjmOdzNIHPX/8EfPSup83Adwv7Py8g7ZbNWj/FRhUjtpP8j54TD8y3uHQkPmoN
E6UXylMOkckcIO/RjrbNLCWhvtJ3xgTwWZCGurbkA4okVvXvOyS6h+A77OW5CkDq
Xh3hRlsHjsvhjJc5J504r0r4fBulfkrnegoDJEzl9LvPIFtXmx6HZlkVuzMam30o
7neR5Rw2cPd8l0uMsJXevW6xBMB42eAUXd2bhmw7iXNUIOVxZaGMspgHxhI8dkSb
GxmPtBNaUQqtcqSRTzSoKVqkD/rarnjUnMStvxeGd6X1PUU7qJw=
=+n6U
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_3b0fb8cb_20250114_205212.html ===


---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)]
[[Thread Prev](msg00008.html)][[Thread Next](msg00010.html)]
[[Date Index](maillist.html#00009)]
[[Thread Index](threads.html#00009)]

# [SECURITY] [DLA 3315-1] sox security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3315-1] sox security update
* *From*: Helmut Grohne <helmut@subdivi.de>
* *Date*: Fri, 10 Feb 2023 07:10:28 +0100
* *Message-id*: <[[🔎]](/msgid-search/Y%2BXf1FIzV3r9LCf0%40alf.mars) [Y+Xf1FIzV3r9LCf0@alf.mars](msg00009.html)>
* *Mail-followup-to*: Helmut Grohne <helmut@subdivi.de>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3315-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Helmut Grohne
February 10, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : sox
Version        : 14.4.2+git20190427-1+deb10u1
CVE ID         : CVE-2019-13590 CVE-2021-3643 CVE-2021-23159 CVE-2021-23172
                 CVE-2021-23210 CVE-2021-33844 CVE-2021-40426 CVE-2022-31650
                 CVE-2022-31651
Debian Bug     : 933372 1010374 1012138 1012516 1021133 1021134 1021135

This update fixes multiple file format validation vulnerabilities that could
result in memory access violations such as buffer overflows and floating point
exceptions. It also fixes a regression in hcom parsing introduced when fixing
CVE-2017-11358.

CVE-2019-13590

    In sox-fmt.h (startread function), there is an integer overflow on the
    result of integer addition (wraparound to 0) fed into the lsx_calloc macro
    that wraps malloc. When a NULL pointer is returned, it is used without a
    prior check that it is a valid pointer, leading to a NULL pointer
    dereference on lsx_readbuf in formats_i.c.

CVE-2021-3643

    The lsx_adpcm_init function within libsox leads to a
    global-buffer-overflow. This flaw allows an attacker to input a malicious
    file, leading to the disclosure of sensitive information.

CVE-2021-23159

    A vulnerability was found in SoX, where a heap-buffer-overflow occurs
    in function lsx_read_w_buf() in formats_i.c file. The vulnerability is
    exploitable with a crafted file, that could cause an application to
    crash.

CVE-2021-23172

    A vulnerability was found in SoX, where a heap-buffer-overflow occurs
    in function startread() in hcom.c file. The vulnerability is
    exploitable with a crafted hcomn file, that could cause an application
    to crash.

CVE-2021-23210

    A floating point exception (divide-by-zero) issue was discovered in
    SoX in functon read_samples() of voc.c file. An attacker with a
    crafted file, could cause an application to crash.

CVE-2021-33844

    A floating point exception (divide-by-zero) issue was discovered in
    SoX in functon startread() of wav.c file. An attacker with a crafted
    wav file, could cause an application to crash.

CVE-2021-40426

    A heap-based buffer overflow vulnerability exists in the sphere.c
    start_read() functionality of Sound Exchange libsox. A specially-crafted
    file can lead to a heap buffer overflow. An attacker can provide a
    malicious file to trigger this vulnerability.

CVE-2022-31650

    There is a floating-point exception in lsx_aiffstartwrite in aiff.c.

CVE-2022-31651

    There is an assertion failure in rate_init in rate.c.

For Debian 10 buster, these problems have been fixed in version
14.4.2+git20190427-1+deb10u1.

We recommend that you upgrade your sox packages.

For the detailed security status of sox please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sox>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpu6zlgGb8Vg.pgp)**

*Description:* PGP signature

---


