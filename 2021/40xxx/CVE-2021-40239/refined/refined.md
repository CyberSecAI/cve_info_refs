The provided content is related to CVE-2021-40239.

**Root cause of vulnerability:** The vulnerability is caused by the use of `sprintf()` in the `do_retr()` function of the `ftpproto.c` file in the Miniftpd project. Specifically, the `sprintf` calls on lines 718 and 721 are vulnerable to buffer overflows.

**Weaknesses/vulnerabilities present:**
- The `sprintf()` function is used without any bounds checking.
- The buffer `buf` has a defined size `MAX_BUFFER_SIZE` which is 1024 bytes, but the data being written to it using `sprintf` can exceed this size because the length of `sess->arg` which is also defined as `MAX_ARG` equal to 1024 can be added to other strings, leading to a buffer overflow.
- The vulnerability exists in both ASCII and BINARY mode data transfer paths.

**Impact of exploitation:**
- A buffer overflow can occur, potentially leading to arbitrary code execution or denial of service. The attacker can overwrite adjacent memory regions and control the application's behavior.

**Attack vectors:**
- By sending a crafted FTP command to the `do_retr` function, an attacker can control the content of `sess->arg`, causing it to be large enough to overflow the `buf` buffer when used with `sprintf`.

**Required attacker capabilities/position:**
- The attacker needs to be able to send FTP commands to the server and trigger the `do_retr` function. They must be able to provide a long argument to the function.