```
{
  "CVE-2021-40313": {
    "related": true,
    "summary": "SQL injection vulnerability in Piwigo's admin/batch_manager_global.php due to unfiltered parameter selection.",
    "details": {
      "root_cause": "The vulnerability stems from the lack of sanitization of the `selection` parameter within the `admin/batch_manager_global.php` file. This parameter is directly used in a SQL query without proper filtering or escaping.",
      "vulnerabilities": [
        "SQL Injection"
      ],
      "impact": "An attacker can execute arbitrary SQL queries on the Piwigo database, potentially leading to data exfiltration, modification, or complete compromise of the application and its underlying infrastructure.",
      "attack_vectors": "The attack vector is through HTTP requests to the `admin/batch_manager_global.php` endpoint, specifically crafted to include malicious SQL within the `selection[]` parameter.",
     "attacker_capabilities": "The attacker needs to be authenticated as an administrator to access the vulnerable endpoint. They also need to obtain a valid `pwg_token`. This token can be retrieved by visiting the `/admin.php?page=user_list` page after login."
    }
  }
}
```