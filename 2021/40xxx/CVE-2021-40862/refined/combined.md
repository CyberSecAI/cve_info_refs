=== Content from discuss.hashicorp.com_56ae3cb7_20250114_222415.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-25 - Terraform Enterprise Configuration Versions API Discloses Sensitive URL](/t/hcsec-2021-25-terraform-enterprise-configuration-versions-api-discloses-sensitive-url/29508)

[Security](/c/security/52)

[security-terraform](https://discuss.hashicorp.com/tag/security-terraform)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

September 14, 2021, 10:33pm

1

**Bulletin ID:** HCSEC-2021-25

**Affected Products / Versions:** Terraform Enterprise up to v202108-1; fixed in v202109-1.

**Publication Date:** September 14, 2021

**Summary**

Terraform Enterprise versions up to v202108-1 included a sensitive URL in specific responses to the Configuration Versions API, allowing potential privilege escalation or configuration manipulation. This vulnerability, CVE-2021-40862, was fixed in Terraform Enterprise v202109-1.

**Background**

Terraform Enterprise utilizes an internal service for the storage of configuration version information. Access to this service is via URLs containing a securely generated secret ([as documented](https://www.terraform.io/docs/cloud/api/index.html#blob-storage-authentication)) that are generated automatically when configuration versions are created.

**Details**

During internal security testing, it was found that an endpoint associated with the [Configuration Versions API](https://www.terraform.io/docs/cloud/api/configuration-versions.html) (used as part of the [API-driven run workflow](https://www.terraform.io/docs/cloud/run/api.html)) erroneously exposed the sensitive URL associated with a Configuration Version.

A malicious user with read-only access to a workspace could leverage this weakness to perform privilege escalation or unauthorized modification of the Terraform configuration associated with a Terraform Enterprise workspace.

Note that the URLs in question expire after 25 hours.

**Remediation**

The sensitive URL is now only returned by the Configuration Versions API the first time it is generated, as required for Terraform Enterprise operation. The sensitive URL will not be returned on subsequent API interactions.

Customers should update to Terraform Enterprise v202109-1 or newer.

**Acknowledgement**

This issue was identified by the HashiCorp security team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see [Security at HashiCorp](https://hashicorp.com/security).*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2021-18 - Terraform Enterprise Allowed Privilege Escalation Via Run Token](https://discuss.hashicorp.com/t/hcsec-2021-18-terraform-enterprise-allowed-privilege-escalation-via-run-token/27070)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 0 | 7274 | July 20, 2021 |
| [HCSEC-2022-06 - Terraform Enterprise May Capture Sensitive Data In Logs](https://discuss.hashicorp.com/t/hcsec-2022-06-terraform-enterprise-may-capture-sensitive-data-in-logs/36174)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 0 | 7632 | February 24, 2022 |
| [HCSEC-2023-19 - Terraform Enterprise, Docker Engine, and Go’s CVE-2023-24540](https://discuss.hashicorp.com/t/hcsec-2023-19-terraform-enterprise-docker-engine-and-go-s-cve-2023-24540/55536)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 1 | 7052 | June 28, 2023 |
| [HCSEC-2024-19 - Terraform Enterprise’s Single Sign-On And Ruby SAML’s CVE-2024-45409](https://discuss.hashicorp.com/t/hcsec-2024-19-terraform-enterprise-s-single-sign-on-and-ruby-saml-s-cve-2024-45409/70203)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 1 | 982 | October 21, 2024 |
| [Terraform Enterprise v202410-1 (798) is available](https://discuss.hashicorp.com/t/terraform-enterprise-v202410-1-798-is-available/70884)  [Release Notifications](/c/release-notifications/57) | 0 | 16 | October 23, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


