- **Root cause of vulnerability:** The `cgi_check_ability` function in Reolink RLC-410W firmware has an improper access control vulnerability. It fails to properly check permissions for certain API calls, resulting in a default permission of 7 (all permissions granted) for APIs not explicitly handled in the function's switch statement. This allows unprivileged users to execute privileged APIs.

- **Weaknesses/vulnerabilities present:**
    - **Improper Access Control (CWE-284):** The primary vulnerability is the insufficient access control checks in the `cgi_check_ability` function. Specifically, the function uses a default case that grants full permissions (value 7) for API calls not specifically handled by the switch cases. This bypasses intended permission restrictions for certain APIs.
   - Specifically, the following APIs have issues with the access control checks:
        - `UpgradePrepare`
        - `SetMdAlarm`
        - `Format`
        - Various `Get` APIs

- **Impact of exploitation:**
    - **Denial of Service (DoS):** By exploiting the `UpgradePrepare` API, an attacker can force a device reboot. If the `Upgrade` is not executed within 5 minutes of `UpgradePrepare`, the device will reboot. Furthermore, many other services will shutdown, causing additional disruption.
    - **Manipulation of Device Settings:** Exploitation of the `SetMdAlarm` API allows an attacker to change motion detection parameters which can be used to hinder the functionality of the camera.
    - **Data Loss:** The `Format` API can be used to format the SD card, resulting in the deletion of all recorded data. The device will also reboot after formatting.
    - **Information Disclosure:** Access to `Get` APIs without authentication can potentially lead to information disclosure.
    
- **Attack vectors:**
    - The attacker needs to send a specially crafted HTTP request to the vulnerable APIs.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to send HTTP requests to the device.
    - An authenticated user session is required to exploit the improper access control vulnerability directly. However, this authentication requirement can be bypassed using another vulnerability TALOS-2021-1420, allowing unauthenticated access to these APIs.

**Additional notes:**
- The vulnerability is present in Reolink RLC-410W v3.0.0.136\_20121102.
- The report mentions that this vulnerability can be chained with TALOS-2021-1420, which would allow unauthenticated access to the vulnerable APIs.