=== Content from packetstormsecurity.com_d3c6e105_20250114_192126.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.open-emr.org_60d25a44_20250114_192127.html ===

[![](/wiki/skins/Openemr/images/openemr-logo-wiki.svg)](/)

* [Features](/wiki/index.php/OpenEMR_Features)
* [Demo](/demo)
* [Download](/wiki/index.php/OpenEMR_Downloads)
* [Modules](/modules)
* [Blog](/blog)
* [Docs](/wiki)
* [Forum](https://community.open-emr.org/)
* [Chat](/chat)
* Support
  [Professional Support Vendors](/wiki/index.php/Professional_Support)
  [Costs and Support Options](/support)
  [Community Support](https://community.open-emr.org/)
  [Free Basic Live Chat Support](/chat)

# Securing OpenEMR

From OpenEMR Project Wiki

## Contents

* [1 Securing OpenEMR](#Securing_OpenEMR)
  + [1.1 Overview](#Overview)
  + [1.2 OpenEMR](#OpenEMR)
  + [1.3 Network](#Network)
  + [1.4 Apache](#Apache)
  + [1.5 MySQL/MariaDB](#MySQL.2FMariaDB)
  + [1.6 PHP](#PHP)
  + [1.7 XAMPP](#XAMPP)
  + [1.8 Nginx and PHP-FPM](#Nginx_and_PHP-FPM)
  + [1.9 Codebase](#Codebase)
* [2 Security Assessment](#Security_Assessment)
# Securing OpenEMR

## Overview

Securing OpenEMR and your database requires a firm understanding of securing several parts, which at least include OpenEMR itself, Apache, MySQL, PHP, firewall, router, https, certficates, etc. A forum that began to discuss this issue can be [found here](https://community.open-emr.org/t/onsite-or-offsite-patient-portal/2234).
There is also a very nice write up on [Security Assessment](http://open-emr.org/wiki/index.php/Security_Assessment) for EMRs (especially regarding HIPAA compliance) on the wiki.
**This document is always a work in progress.**
## OpenEMR

* After installation/upgrade, ensure you have installed most recent patch.
* After installation/upgrade **remove the setup.php script**, which is not needed for general OpenEMR use.
* After installation/upgrade, **strongly recommend removing** (or ensuring no access to) to the following scripts, which are not needed for general OpenEMR use:

* acl\_setup.php
* acl\_upgrade.php
* admin.php
* sl\_convert.php
* sql\_patch.php
* sql\_upgrade.php
* gacl/setup.php
* ippf\_upgrade.php
* entire contrib directory

* (except for the contrib/icd9, contrib/icd10, contrib/snomed and contrib/rxnorm directories)

* entire tests directory (for versions prior to 5.0.1, this is the Tests directory)
* entire phpmyadmin directory (you do not need to do this for versions 5.0.1 and later, since phpmyadmin is not included in these versions)

* After installing a patch, **strongly recommend removing** (or ensuring no access to) the following script, which is not needed for general OpenEMR use:

* sql\_patch.php

* Settings (Adminstration->Globals in OpenEMR)

* Ensure [Secure Upload Files with White List](/wiki/index.php/Administration_Globals#Secure_Upload_Files_with_White_List "Administration Globals") setting is on.
* Ensure [Enable Encryption of Items Stored on Drive](/wiki/index.php/Administration_Globals#Enable_Encryption_of_Items_Stored_on_Drive "Administration Globals") setting is on.

* Passwords

* Enforce strong/unique passwords, which can be set in Administration->Globals->Security.
* Enforce password expiration, which can be set in Administration->Globals->Security.

* For OpenEMR versions 4.1.1 or less, remove the following file and directory, if they exist:

* FILE: library/openflashchart/php-ofc-library/ofc\_upload\_image.php
* DIRECTORY: library/openflashchart/tmp-upload-images/

* [Enable multi-factor authentication](https://www.open-emr.org/wiki/index.php/Multi-factor_Authentication)

## Network

* On server, consider only opening port 443 (https).
* Consider a firewall that only allows port 443 (https) traffic to the server.

## Apache

* General hardening of Apache, which is [described here](http://www.learncomputer.com/secure-apache/), and here for [apache2.4](http://httpd.apache.org/docs/2.4/misc/security_tips.html).
* Only allow https (ie. turn off http). It's pretty easy to setup for [Debian/Ubuntu](https://www.digitalocean.com/community/tutorials/how-to-create-a-ssl-certificate-on-apache-for-ubuntu-14-04).
* Do not allow direct web access to the following directory

* sites/\*/documents

* Do not allow use of .htaccess files in Apache (ie. turn off the AllowOverride setting).
* If not using portal and want to allow users to access over the internet, then consider using client-sided certificates to only allow users access to site
* If using third party patient portal, then use the current method whereby your instance is not on the internet and connects to the third party patient portal via vpn.
* If want to give access to the onsite patient portal over the internet, then consider using a client-sided certificate to only allow users access to the main OpenEMR login page (this is not optimal, though).

## MySQL/MariaDB

* Ensure the root password is set to something. Pick a hard password; one that includes capital letters, lowercase letters, numbers, and symbols.
* Do the same for the openemr user and give it privileges only to the openemr database.
* If you are using PHPMyAdmin be sure to use two-factor authentication.

## PHP

* Use a [Supported Version of PHP](http://php.net/supported-versions.php).
* Follow the [OpenEMR php settings recommendations](/wiki/index.php/FAQ#What_are_the_correct_PHP_settings_.28can_be_found_in_the_php.ini_file.29.3F "FAQ")

## XAMPP

* If you are using XAMPP, note that this software is extremely unsecure after installation and you need to secure it by configuring the Security Console.

* for newer versions of XAMPP please see this:

Information on setting a root password for the database can be found in the "HOW-TO Guides" for XAMPP for windows version 5.6.20 (enter localhost in browser).

* for older versions (~pre 2016) Navigate to the Security Console via <http://localhost/security/xamppsecurity.php> in the URL address bar.

* If the Welcome page is in German, it can be changed in the left sidebar, under Sprachen. Language selection can also be accomplished from the splash page or in the upper right hand corner of a webpage.

[![1deutsche.png](/wiki/images/3/3a/1deutsche.png)](/wiki/index.php/File%3A1deutsche.png)

* Navigate to the Security section.

[![Secure.png](/wiki/images/4/4b/Secure.png)](/wiki/index.php/File%3ASecure.png)

* The first task is to set the MySQL root password. The question under "Security Risk!" asks if you wish to store the password in plain text. The first word is a verb, not an adjective; "save" instead of "safe". Users who are apt to losing things may wish to choose this option despite an increased risk. Click "Password Changing" button to save.

* The second task is to set the password to the Security Console. Click "Make safe the XAMPP directory" button to save.

* If this password is lost and not saved in plain text, it would be very difficult to gain access to the Security Console to change the MySQL root password. Knowing the MySQL root password allows the user to import the database to a new device or installation of OpenEMR at some future time.
* If the user needs to gain access to phpMyAdmin externally (outside of OpenEMR), he must know the MySQL root password.

* If the user opts to save the passwords in plain text, the paths to the folders containing the passwords are given.

[![Secure1.png](/wiki/images/5/5e/Secure1.png)](/wiki/index.php/File%3ASecure1.png)

* Navigate to the Status section from the left sidebar. If there are 3 green "Secure" bars, this exercise has been successful.

[![Secure2.png](/wiki/images/5/5c/Secure2.png)](/wiki/index.php/File%3ASecure2.png)
## Nginx and PHP-FPM

Check out this article which includes ssl files for securing openemr:

[OpenEMR with Nginx and PHP-FPM](https://www.open-emr.org/wiki/index.php/OpenEMR_with_nginx_and_php-fpm)

Here is a very nice write up on security for Linux systems:

[Top 25 Nginx Web Server Best Security Practices](https://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html)
## Codebase

* [Ongoing project to maintain security of the codebase.](/wiki/index.php/Codebase_Security "Codebase Security")
* Consider adding a specific sqlconf.php override settings when using the patient portal (especially the onsite portal), which can be used to use a separate mysql user (and possibly database).

# Security Assessment

* A security risk assessment is a requirement in the US for compliance with HIPAA and Meaningful Use. There is a very nice write up on this topic on the [Security Assessment](/wiki/index.php/Security_Assessment "Security Assessment") wiki page.

Retrieved from "<https://www.open-emr.org/wiki/index.php?title=Securing_OpenEMR&oldid=33707>"

[Categories](/wiki/index.php/Special%3ACategories "Special:Categories"):

* [Security](/wiki/index.php/Category%3ASecurity "Category:Security")
* [User Guide 4.2.0](/wiki/index.php/Category%3AUser_Guide_4.2.0 "Category:User Guide 4.2.0")
* [User Guide 4.1.2](/wiki/index.php/Category%3AUser_Guide_4.1.2 "Category:User Guide 4.1.2")
* [User Guide 4.1.1](/wiki/index.php/Category%3AUser_Guide_4.1.1 "Category:User Guide 4.1.1")
* [User Guide 4.1.0](/wiki/index.php/Category%3AUser_Guide_4.1.0 "Category:User Guide 4.1.0")
* [User Guide](/wiki/index.php/Category%3AUser_Guide "Category:User Guide")
* [Configuration Guide](/wiki/index.php/Category%3AConfiguration_Guide "Category:Configuration Guide")
* [Developer Guide](/wiki/index.php/Category%3ADeveloper_Guide "Category:Developer Guide")

## Navigation menu

[# OpenEMR Project Wiki](/wiki/index.php/OpenEMR_Wiki_Home_Page)

### Search

### Personal tools

* [Log in](/wiki/index.php?title=Special:UserLogin&returnto=Securing+OpenEMR "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/wiki/index.php/Securing_OpenEMR "View the content page [c]")
* [Discussion](/wiki/index.php?title=Talk:Securing_OpenEMR&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

### Variants

### Views

* [View](/wiki/index.php/Securing_OpenEMR)
* [View source](/wiki/index.php?title=Securing_OpenEMR&action=edit "This page is protected.
  You can view its source [e]")
* [History](/wiki/index.php?title=Securing_OpenEMR&action=history "Past revisions of this page [h]")

### More

### wiki navigation

* [Main wiki page](/wiki/index.php/OpenEMR_Wiki_Home_Page)
* [Categories](/wiki/index.php/Special%3ACategories)
* [Recent changes](/wiki/index.php/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/wiki/index.php/Special%3ARandom "Load a random page [x]")
* [Help](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents "The place to find out")

### Tools

* [What links here](/wiki/index.php/Special%3AWhatLinksHere/Securing_OpenEMR "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/index.php/Special%3ARecentChangesLinked/Securing_OpenEMR "Recent changes in pages linked from this page [k]")
* [Special pages](/wiki/index.php/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/wiki/index.php?title=Securing_OpenEMR&oldid=33707 "Permanent link to this revision of the page")
* [Page information](/wiki/index.php?title=Securing_OpenEMR&action=info "More information about this page")

* [![GNU Free Documentation License 1.3](/wiki/resources/assets/licenses/gnu-fdl.png)](http://www.gnu.org/copyleft/fdl.html)
* [![Powered by MediaWiki](/wiki/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)

* This page was last edited on 25 January 2023, at 04:50.
* Content is available under [GNU Free Documentation License 1.3](http://www.gnu.org/copyleft/fdl.html) unless otherwise noted.

* [Privacy policy](/wiki/index.php/OpenEMR_Project_Wiki%3APrivacy_policy "OpenEMR Project Wiki:Privacy policy")
* [About OpenEMR Project Wiki](/wiki/index.php/OpenEMR_Project_Wiki%3AAbout "OpenEMR Project Wiki:About")
* [Disclaimers](/wiki/index.php/OpenEMR_Project_Wiki%3AGeneral_disclaimer "OpenEMR Project Wiki:General disclaimer")



=== Content from github.com_299ae665_20250114_192127.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fallenenosh%2FCVE-2021-40352)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fallenenosh%2FCVE-2021-40352)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=allenenosh%2FCVE-2021-40352)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[allenenosh](/allenenosh)
/
**[CVE-2021-40352](/allenenosh/CVE-2021-40352)**
Public

* [Notifications](/login?return_to=%2Fallenenosh%2FCVE-2021-40352) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fallenenosh%2FCVE-2021-40352)
* [Star
   2](/login?return_to=%2Fallenenosh%2FCVE-2021-40352)

### License

[MIT license](/allenenosh/CVE-2021-40352/blob/main/LICENSE)

[2
stars](/allenenosh/CVE-2021-40352/stargazers) [0
forks](/allenenosh/CVE-2021-40352/forks) [Branches](/allenenosh/CVE-2021-40352/branches) [Tags](/allenenosh/CVE-2021-40352/tags) [Activity](/allenenosh/CVE-2021-40352/activity)
 [Star](/login?return_to=%2Fallenenosh%2FCVE-2021-40352)

 [Notifications](/login?return_to=%2Fallenenosh%2FCVE-2021-40352) You must be signed in to change notification settings

* [Code](/allenenosh/CVE-2021-40352)
* [Issues
  0](/allenenosh/CVE-2021-40352/issues)
* [Pull requests
  0](/allenenosh/CVE-2021-40352/pulls)
* [Actions](/allenenosh/CVE-2021-40352/actions)
* [Projects
  0](/allenenosh/CVE-2021-40352/projects)
* [Security](/allenenosh/CVE-2021-40352/security)
* [Insights](/allenenosh/CVE-2021-40352/pulse)

Additional navigation options

* [Code](/allenenosh/CVE-2021-40352)
* [Issues](/allenenosh/CVE-2021-40352/issues)
* [Pull requests](/allenenosh/CVE-2021-40352/pulls)
* [Actions](/allenenosh/CVE-2021-40352/actions)
* [Projects](/allenenosh/CVE-2021-40352/projects)
* [Security](/allenenosh/CVE-2021-40352/security)
* [Insights](/allenenosh/CVE-2021-40352/pulse)

# allenenosh/CVE-2021-40352

    main[Branches](/allenenosh/CVE-2021-40352/branches)[Tags](/allenenosh/CVE-2021-40352/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[3 Commits](/allenenosh/CVE-2021-40352/commits/main/) | | |
| [5.png](/allenenosh/CVE-2021-40352/blob/main/5.png "5.png") | | [5.png](/allenenosh/CVE-2021-40352/blob/main/5.png "5.png") |  |  |
| [6.png](/allenenosh/CVE-2021-40352/blob/main/6.png "6.png") | | [6.png](/allenenosh/CVE-2021-40352/blob/main/6.png "6.png") |  |  |
| [LICENSE](/allenenosh/CVE-2021-40352/blob/main/LICENSE "LICENSE") | | [LICENSE](/allenenosh/CVE-2021-40352/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/allenenosh/CVE-2021-40352/blob/main/README.md "README.md") | | [README.md](/allenenosh/CVE-2021-40352/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# CVE-2021-40352

Opnemr Version 6.0.0
Has a security vulnerability where an attacker who has Physician Access can read messages with were sent to others members including admin messages

the vulnerability exits in the print message feature = "pnotes\_print.php?noteid=16"

changing the "noteid=" to any other number will reveal the messages of everyone

Discovered by Allen Enosh Upputori , September 2021 .

CVE issued 31/08/2021

Check the CVE listed here : <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40352>.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/allenenosh/CVE-2021-40352/activity)
### Stars

[**2**
stars](/allenenosh/CVE-2021-40352/stargazers)
### Watchers

[**1**
watching](/allenenosh/CVE-2021-40352/watchers)
### Forks

[**0**
forks](/allenenosh/CVE-2021-40352/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fallenenosh%2FCVE-2021-40352&report=allenenosh+%28user%29)

## [Releases](/allenenosh/CVE-2021-40352/releases)

No releases published

## [Packages 0](/users/allenenosh/packages?repo_name=CVE-2021-40352)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


