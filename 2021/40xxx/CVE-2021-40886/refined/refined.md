- **Root cause of vulnerability**: The vulnerability is caused by insufficient input sanitization of the `fileName` parameter during file upload when the `chunks` parameter is set to a value greater than or equal to 2. The application only checks the `fileName` if `chunks < 2`, allowing a path traversal when `chunks >= 2`.
- **Weaknesses/vulnerabilities present**: Path traversal vulnerability. The application fails to properly sanitize the `fileName` parameter when the `chunks` parameter bypasses the initial check, allowing for directory traversal.
- **Impact of exploitation**: An attacker can upload arbitrary files to the webroot directory, potentially overwriting existing files or creating new ones. This could lead to various attacks, including arbitrary code execution by uploading a malicious file such as an HTML file containing javascript, as shown in the provided exploit example.
- **Attack vectors**: The attack vector is through the file upload functionality of the application, specifically the `upload.process.php` script. The attacker manipulates the `chunks` and `name` parameters in a multipart form data POST request.
- **Required attacker capabilities/position**: The attacker needs to have an "Uploader" role, allowing them access to the file upload functionality. They also need to be able to intercept and modify HTTP requests, which can be done using tools like Burp Suite. The attacker must be able to craft a specific request with the vulnerable parameters set.