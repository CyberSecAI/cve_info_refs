Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
- The vulnerability lies in the Piwigo application's batch manager functionality, specifically within the single mode function. The application fails to sanitize user-supplied input when modifying the author parameter of a picture.

**Weaknesses/Vulnerabilities Present:**
- **Persistent Cross-Site Scripting (XSS):** The application does not properly sanitize or encode user-provided input when updating the author parameter in batch manager mode, allowing the injection of malicious JavaScript code into the author field. This injected script is then stored in the database and executed whenever the affected page is accessed.

**Impact of Exploitation:**
- **Malicious Script Execution:** An attacker can inject arbitrary JavaScript code, potentially leading to:
    - Cookie stealing
    - Session hijacking
    - Defacement of the web page
    - Redirection to malicious websites
    - Other malicious actions within the context of a victim's browser session
- **Persistent XSS:** The injected code persists, meaning the attack impacts anyone who views the affected content.

**Attack Vectors:**
- The attacker must access the batch manager functionality with administrative privileges and use the single mode functionality to modify an image's author field.
- The attacker crafts a malicious payload embedded in the author parameter of the image. In this case, the provided payload is: `<img src=x onerror=alert(document.cookie)>`

**Required Attacker Capabilities/Position:**
- The attacker needs to be authenticated as an administrator to access the batch manager page and modify the image's author field.
- The attacker needs to have network access to the Piwigo application.

**Technical Details:**
- The vulnerable URL is `/admin.php?page=batch_manager&mode=unit`
- The attack vector is the `author-4` parameter in the POST request.
- The provided example POST request demonstrates the injection:
```
POST /admin.php?page=batch_manager&mode=unit HTTP/1.1
Host: 127.0.0.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 152
...
element_ids=4&name-4=test&author-4=11111%3Cimg+src%3Dx+onerror%3Dalert%28document.cookie%29%3E11&date_creation-4=&level-4=0&description-4=&submit=Submit
```

**Mitigation Suggestion:**
- The suggested mitigation is to restrict both user input and output. This involves input validation/sanitization of the author parameter and output encoding when displaying the author field content.