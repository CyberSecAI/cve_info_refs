The provided content is related to CVE-2021-40414.

**Root cause of vulnerability:**
The vulnerability stems from an improper access control issue in the `cgiserver.cgi`'s `cgi_check_ability` function of the Reolink RLC-410W camera. Specifically, certain API calls such as `SetMdAlarm` lack specific handling in the switch statement within `cgi_check_ability`. Consequently, the code defaults to a permission level of 7, granting all logged-in users, including those without administrative privileges, the ability to execute these commands.

**Weaknesses/vulnerabilities present:**
- Improper access control: The `cgi_check_ability` function does not properly restrict access to specific APIs, allowing non-admin users to perform actions they should not be able to.
- Missing cases in switch statement: The `switch` statement within `cgi_check_ability` lacks specific cases for certain APIs, causing them to default to an overly permissive access level.

**Impact of exploitation:**
An attacker can exploit this vulnerability to:
- Modify motion detection parameters (CVE-2021-40414): A non-admin user can alter the motion detection settings using the `SetMdAlarm` API.
- Cause denial of service (CVE-2021-40413): By exploiting the `UpgradePrepare` API, a non-admin user can trigger a device reboot and disrupt services.
- Format the SD card (CVE-2021-40415): A non-admin user can use the `Format` API to delete all recordings on the SD card and reboot the device.
- Access sensitive information (CVE-2021-40416): Although authenticated users could already access most of the GET APIs, this issue coupled with CVE-2021-40416, could allow access to these APIs without authentication.

**Attack vectors:**
An attacker can exploit this vulnerability by sending a specially crafted HTTP request to the vulnerable API endpoints. The attacker must be a logged-in user, however this can be bypassed with CVE-2021-40413.

**Required attacker capabilities/position:**
- The attacker must be a logged-in user. This requirement can be bypassed using CVE-2021-40413, therefore an attacker does not need to authenticate.
- The attacker needs to be able to send HTTP requests to the camera.