Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a memory leak in Neutron's routes middleware. Specifically, when the `routes.middleware.RoutesMiddleware` object is configured with the default `singleton=True`, it uses a thread-local `RequestConfig` object. Due to how eventlet monkey-patches the threading library, the `WeakKeyDictionary` storing request context information is not released, leading to a memory leak with each API request to a nonexistent controller.

**Weaknesses/Vulnerabilities:**

*   **Memory Leak:** Repeated API requests to nonexistent controllers cause a continuous increase in memory consumption by the neutron-api worker process. This is due to the failure to release request context data.

**Impact of Exploitation:**

*   **API Performance Degradation:** Increased memory usage can lead to performance degradation as the system starts to use swap space.
*   **Denial of Service (DoS):** The memory leak eventually leads to a denial of service by exhausting available memory and triggering the kernel OOM killer to terminate the neutron-api worker process.

**Attack Vectors:**

*   **API Requests:** An attacker makes API requests to nonexistent controllers within the Neutron API. For example, sending requests to `/v2.0/blabla`.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker must be an authenticated user of the OpenStack cloud.
*   **Network Access:** The attacker must have the ability to send API requests to the Neutron API endpoint.

**Technical Details:**

*   The `routes.middleware.RoutesMiddleware` uses a `RequestConfig` object. When `singleton=True` (default), a single shared instance is used, storing request-specific data in a `threading.local()` which, under eventlet, becomes `eventlet.corolocal.local()`. The request context is stored in a WeakKeyDictionary within `eventlet.corolocal.local()._local__greens`, which is not released properly.
* The fix involves setting singleton=False in the `RoutesMiddleware` object so that a new RequestConfig is created for each request.

**Affected Versions:**

*   Neutron: <16.4.1, >=17.0.0 <17.2.1, >=18.0.0 <18.1.1