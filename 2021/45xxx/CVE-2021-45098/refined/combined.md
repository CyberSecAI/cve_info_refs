=== Content from github.com_ceec3d33_20250114_211431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  72](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

# Releases: OISF/suricata

[Releases](/OISF/suricata/releases)
[Tags](/OISF/suricata/tags)

Releases ¬∑ OISF/suricata
## 7.0.8

12 Dec 14:46

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-7.0.8](/OISF/suricata/tree/suricata-7.0.8)

[`97e69ff`](/OISF/suricata/commit/97e69ffb1bc2b7358115ee59f460a924893664e8)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.8)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.8](/OISF/suricata/releases/tag/suricata-7.0.8)
[Latest](/OISF/suricata/releases/latest)

[Latest](/OISF/suricata/releases/latest)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-8-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/214>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.8.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.8.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.8>

 Assets
2

 Loading

 ‚ù§Ô∏è
1
 davidetogni reacted with heart emoji
 üöÄ
2
 bmbenson and piyushchauhan2011 reacted with rocket emoji

All reactions

* ‚ù§Ô∏è
  1 reaction
* üöÄ
  2 reactions

 3 people reacted

## 7.0.7

01 Oct 09:14

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-7.0.7](/OISF/suricata/tree/suricata-7.0.7)

[`572a16f`](/OISF/suricata/commit/572a16fb5a28a582c6e219d946485d9778b64014)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.7)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.7](/OISF/suricata/releases/tag/suricata-7.0.7)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-7-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/213>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.7.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.7.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.7>

 Assets
2

 Loading

 üëç
3
 firengate, liuup, and sinbizkit reacted with thumbs up emoji
 üòÑ
1
 firengate reacted with laugh emoji
 üéâ
1
 firengate reacted with hooray emoji
 ‚ù§Ô∏è
2
 firengate and davidetogni reacted with heart emoji
 üöÄ
4
 totpero, Vangreen, firengate, and piyushchauhan2011 reacted with rocket emoji

All reactions

* üëç
  3 reactions
* üòÑ
  1 reaction
* üéâ
  1 reaction
* ‚ù§Ô∏è
  2 reactions
* üöÄ
  4 reactions

 7 people reacted

## 7.0.6

27 Jun 10:22

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-7.0.6](/OISF/suricata/tree/suricata-7.0.6)

[`9db8668`](/OISF/suricata/commit/9db866816606917a0b63d59d1a44abb4a0b55d22)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.6)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.6](/OISF/suricata/releases/tag/suricata-7.0.6)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-6-and-6-0-20-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/211>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.6.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.6.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.6>

 Assets
2

 Loading

 üëç
5
 ShadowUser17, JakePeralta7, firengate, n2duong910, and EthyMoney reacted with thumbs up emoji
 üòÑ
1
 firengate reacted with laugh emoji
 üéâ
3
 inashivb, JakePeralta7, and firengate reacted with hooray emoji
 ‚ù§Ô∏è
1
 firengate reacted with heart emoji
 üöÄ
4
 firengate, JakePeralta7, totpero, and songzetao reacted with rocket emoji

All reactions

* üëç
  5 reactions
* üòÑ
  1 reaction
* üéâ
  3 reactions
* ‚ù§Ô∏è
  1 reaction
* üöÄ
  4 reactions

 8 people reacted

## 6.0.20

27 Jun 10:21

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-6.0.20](/OISF/suricata/tree/suricata-6.0.20)

[`ab01c58`](/OISF/suricata/commit/ab01c5889819d74912af451263ea85a5789a84a9)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.20)

 Loading

[View all tags](/OISF/suricata/tags)

[6.0.20](/OISF/suricata/releases/tag/suricata-6.0.20)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-6-and-6-0-20-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/210>

## Download

<https://www.openinfosecfoundation.org/download/suricata-6.0.20.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-6.0.20.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-6.0.20>

 Assets
2

 Loading

 üëç
1
 ShadowUser17 reacted with thumbs up emoji
 üéâ
1
 inashivb reacted with hooray emoji

All reactions

* üëç
  1 reaction
* üéâ
  1 reaction

 2 people reacted

## 7.0.5

23 Apr 12:27

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-7.0.5](/OISF/suricata/tree/suricata-7.0.5)

[`c4cf7b0`](/OISF/suricata/commit/c4cf7b09f043be5cdd6a38d7030290498b4dfa5b)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.5)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.5](/OISF/suricata/releases/tag/suricata-7.0.5)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-5-and-6-0-19-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/206>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.5.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.5.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.5>

 Assets
2

 Loading

 üëç
1
 firengate reacted with thumbs up emoji
 üòÑ
1
 firengate reacted with laugh emoji
 üéâ
2
 firengate and jstrosch reacted with hooray emoji
 ‚ù§Ô∏è
2
 firengate and davidetogni reacted with heart emoji
 üöÄ
2
 totpero and firengate reacted with rocket emoji

All reactions

* üëç
  1 reaction
* üòÑ
  1 reaction
* üéâ
  2 reactions
* ‚ù§Ô∏è
  2 reactions
* üöÄ
  2 reactions

 4 people reacted

## 6.0.19

23 Apr 12:25

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-6.0.19](/OISF/suricata/tree/suricata-6.0.19)

[`d5f5ca0`](/OISF/suricata/commit/d5f5ca0ec103f1d7242bdcb967ac61d833e849b1)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.19)

 Loading

[View all tags](/OISF/suricata/tags)

[6.0.19](/OISF/suricata/releases/tag/suricata-6.0.19)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-5-and-6-0-19-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/209>

## Download

<https://www.openinfosecfoundation.org/download/suricata-6.0.19.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-6.0.19.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-6.0.19>

 Assets
2

 Loading

All reactions

## 6.0.18

21 Mar 17:32

![@jasonish](https://avatars.githubusercontent.com/u/644115?s=40&v=4)
[jasonish](/jasonish)

[suricata-6.0.18](/OISF/suricata/tree/suricata-6.0.18)

[`7ac695b`](/OISF/suricata/commit/7ac695ba26a95a7c4e3608a7c957ab488e3b1df8)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.18)

 Loading

[View all tags](/OISF/suricata/tags)

[6.0.18](/OISF/suricata/releases/tag/suricata-6.0.18)

## Release Notes

<https://forum.suricata.io/t/suricata-6-0-18-released/4539>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/205>

## Download

<https://www.openinfosecfoundation.org/download/suricata-6.0.18.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-6.0.18.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-6.0.18>

 Assets
2

 Loading

 üëç
1
 firengate reacted with thumbs up emoji
 üòÑ
1
 firengate reacted with laugh emoji
 üöÄ
2
 totpero and firengate reacted with rocket emoji

All reactions

* üëç
  1 reaction
* üòÑ
  1 reaction
* üöÄ
  2 reactions

 2 people reacted

## 7.0.4

19 Mar 16:37

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-7.0.4](/OISF/suricata/tree/suricata-7.0.4)

[`d8bad3b`](/OISF/suricata/commit/d8bad3b1aa7ae1c3a19a348b1b881ca2dc5b68d0)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.4)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.4](/OISF/suricata/releases/tag/suricata-7.0.4)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-4-and-6-0-17-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/202>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.4.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.4.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.4>

 Assets
2

 Loading

 üëç
1
 firengate reacted with thumbs up emoji
 üòÑ
1
 firengate reacted with laugh emoji
 üéâ
2
 firengate and catenacyber reacted with hooray emoji
 ‚ù§Ô∏è
2
 davidetogni and firengate reacted with heart emoji
 üöÄ
2
 inashivb and firengate reacted with rocket emoji

All reactions

* üëç
  1 reaction
* üòÑ
  1 reaction
* üéâ
  2 reactions
* ‚ù§Ô∏è
  2 reactions
* üöÄ
  2 reactions

 4 people reacted

## 6.0.17

19 Mar 16:35

![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)
[victorjulien](/victorjulien)

[suricata-6.0.17](/OISF/suricata/tree/suricata-6.0.17)

[`51285f2`](/OISF/suricata/commit/51285f2f135c7f1c113dee327466734871068885)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.17)

 Loading

[View all tags](/OISF/suricata/tags)

[6.0.17](/OISF/suricata/releases/tag/suricata-6.0.17)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-4-and-6-0-17-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/203>

## Download

<https://www.openinfosecfoundation.org/download/suricata-6.0.17.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-6.0.17.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-6.0.17>

 Assets
2

 Loading

 üëç
1
 Vangreen reacted with thumbs up emoji
 üöÄ
1
 inashivb reacted with rocket emoji

All reactions

* üëç
  1 reaction
* üöÄ
  1 reaction

 2 people reacted

## 7.0.3

08 Feb 12:56

![@inashivb](https://avatars.githubusercontent.com/u/57791542?s=40&v=4)
[inashivb](/inashivb)

[suricata-7.0.3](/OISF/suricata/tree/suricata-7.0.3)

[`be68bbc`](/OISF/suricata/commit/be68bbc4ab288ec84d2fe5e0737ace17ab74ef26)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-7.0.3)

 Loading

[View all tags](/OISF/suricata/tags)

[7.0.3](/OISF/suricata/releases/tag/suricata-7.0.3)

## Release Notes

<https://forum.suricata.io/t/suricata-7-0-3-and-6-0-16-released/>

## Redmine Tracker

<https://redmine.openinfosecfoundation.org/versions/200>

## Download

<https://www.openinfosecfoundation.org/download/suricata-7.0.3.tar.gz>

<https://www.openinfosecfoundation.org/download/suricata-7.0.3.tar.gz.sig>

## Documentation

<https://docs.suricata.io/en/suricata-7.0.3>

 Assets
2

 Loading

 üëç
4
 davidetogni, Vangreen, firengate, and bhaktibhatt reacted with thumbs up emoji
 üöÄ
2
 totpero and firengate reacted with rocket emoji

All reactions

* üëç
  4 reactions
* üöÄ
  2 reactions

 5 people reacted

Previous *1* [2](/OISF/suricata/releases?page=2) [3](/OISF/suricata/releases?page=3) [4](/OISF/suricata/releases?page=4) [5](/OISF/suricata/releases?page=5) [6](/OISF/suricata/releases?page=6) [7](/OISF/suricata/releases?page=7) [8](/OISF/suricata/releases?page=8) [Next](/OISF/suricata/releases?page=2)

Previous [Next](/OISF/suricata/releases?page=2)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from forum.suricata.io_3baa25cf_20250114_211428.html ===


[Suricata](/)

# [Suricata 6.0.4 and 5.0.8 released](/t/suricata-6-0-4-and-5-0-8-released/1942)

[Announcements](/c/announcements/6)

[vjulien](https://forum.suricata.io/u/vjulien)
(Victor Julien)

November 18, 2021, 1:26pm

1

# Suricata 6.0.4 and 5.0.8 released

We are pleased to announce the releases of Suricata 6.0.4 and 5.0.8. These releases are bug fix releases, fixing a number of important issues.

## Get the releases here:

6.0.4: <https://www.openinfosecfoundation.org/download/suricata-6.0.4.tar.gz>

5.0.8: <https://www.openinfosecfoundation.org/download/suricata-5.0.8.tar.gz>

## Notable Changes

LibHTP has been updated to 0.5.39.

Suricata-Update, as bundled with 6.0.4, was updated to 1.2.3.

Various security, performance, accuracy and stability issues have been fixed, including two TCP evasion issues. CVE 2021-37592 was assigned.

Tickets for 5.0.8: [5.0.8 - Suricata - Open Information Security Foundation](https://redmine.openinfosecfoundation.org/versions/170)

Tickets for 6.0.4: [6.0.4 - Suricata - Open Information Security Foundation](https://redmine.openinfosecfoundation.org/versions/169)

The Suricata team is also finalizing our new security policy which will be published soon.

## Special Thanks

fratso, Chang Zedd, Simon Dugas, Eric Leblond, Todd Mortimer, Bill Meeks

## About Suricata

Suricata is a high performance Network Threat Detection, IDS, IPS and Network Security Monitoring engine. Open source and owned by a community run non-profit foundation, the Open Information Security Foundation (OISF). Suricata is developed by OISF, its supporting vendors and the community.

4 Likes

[Suricata 6.0.4 stable packages are now available for Ubuntu on Ubuntu PPA (Launchpad)](https://forum.suricata.io/t/suricata-6-0-4-stable-packages-are-now-available-for-ubuntu-on-ubuntu-ppa-launchpad/1947)

[Suricata 5.0.8 stable packages are now available for Ubuntu on Ubuntu PPA (Launchpad)](https://forum.suricata.io/t/suricata-5-0-8-stable-packages-are-now-available-for-ubuntu-on-ubuntu-ppa-launchpad/1946)

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Suricata 6.0.5 and 5.0.9 released](https://forum.suricata.io/t/suricata-6-0-5-and-5-0-9-released/2415)  [Announcements](/c/announcements/6) | 0 | 2534 | April 21, 2022 |
| [Suricata 6.0.11 released](https://forum.suricata.io/t/suricata-6-0-11-released/3409)  [Announcements](/c/announcements/6) | 2 | 1356 | November 14, 2023 |
| [Suricata 6.0.7 released](https://forum.suricata.io/t/suricata-6-0-7-released/2807)  [Announcements](/c/announcements/6) | 0 | 1257 | September 27, 2022 |
| [Suricata 6.0.6 and 5.0.10 released](https://forum.suricata.io/t/suricata-6-0-6-and-5-0-10-released/2637)  [Announcements](/c/announcements/6) | 2 | 1570 | October 26, 2022 |
| [Suricata 6.0.8 released](https://forum.suricata.io/t/suricata-6-0-8-released/2808)  [Announcements](/c/announcements/6) | 4 | 1622 | November 29, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from github.com_6fe48fbb_20250114_211430.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F50e2b973eeec7172991bf8f544ab06fb782b97df)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F50e2b973eeec7172991bf8f544ab06fb782b97df)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  72](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/50e2b973eeec7172991bf8f544ab06fb782b97df)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

stream/tcp: handle RST with MD5 or AO header

[Browse files](/OISF/suricata/tree/50e2b973eeec7172991bf8f544ab06fb782b97df)
Browse the repository at this point in the history

```
Special handling for RST packets if they have an TCP MD5 or AO header option.
The options hash can't be validated. The end host might be able to validate
it, as it can have a key/password that was communicated out of band.

The sender could use this to move the TCP state to 'CLOSED', leading to
a desync of the TCP session.

This patch builds on top of
[843d0b7](https://github.com/OISF/suricata/commit/843d0b7a10bb45627f94764a6c5d468a24143345) ("stream: support RST getting lost/ignored")

It flags the receiver as having received an RST and moves the TCP state
into the CLOSED state. It then reverts this if the sender continues to
send traffic. In this case it sets the following event:

    stream-event:suspected_rst_inject;

Bug: [#4710](https://github.com/OISF/suricata/pull/4710).
```

* Loading branch information

[![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Nov 12, 2021

1 parent
[3212fa7](/OISF/suricata/commit/3212fa7d2bc514f4e759dbb9e0002203c814a9b5)

commit 50e2b97

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**42 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/decode-tcp.c
    [decode-tcp.c](#diff-5fd957a55484ffe2094878766527d78caa2756c585b69936ba5058fcfadd1b4a)
  + src/decode-tcp.h
    [decode-tcp.h](#diff-7aed0db899af0ff2bc03c921b07ef2e9fac6b4e84967936ff8f67276ac9c4ecf)
  + src/stream-tcp.c
    [stream-tcp.c](#diff-eb5f2a643796d0f25b56ced24a3953eb45318eb325a0648586b5c736ddcb9184)

## There are no files selected for viewing

20 changes: 20 additions & 0 deletions

20
[src/decode-tcp.c](#diff-5fd957a55484ffe2094878766527d78caa2756c585b69936ba5058fcfadd1b4a "src/decode-tcp.c")

Show comments

[View file](/OISF/suricata/blob/50e2b973eeec7172991bf8f544ab06fb782b97df/src/decode-tcp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -183,6 +183,26 @@ static void DecodeTCPOptions(Packet \*p, const uint8\_t \*pkt, uint16\_t pktlen) |
|  |  | ENGINE\_SET\_EVENT(p,TCP\_OPT\_INVALID\_LEN); |
|  |  | } |
|  |  | break; |
|  |  | /\* RFC 2385 MD5 option \*/ |
|  |  | case TCP\_OPT\_MD5: |
|  |  | SCLogDebug("MD5 option, len %u", olen); |
|  |  | if (olen != 18) { |
|  |  | ENGINE\_SET\_INVALID\_EVENT(p,TCP\_OPT\_INVALID\_LEN); |
|  |  | } else { |
|  |  | /\* we can't validate the option as the key is out of band \*/ |
|  |  | p->tcpvars.md5\_option\_present = true; |
|  |  | } |
|  |  | break; |
|  |  | /\* RFC 5925 AO option \*/ |
|  |  | case TCP\_OPT\_AO: |
|  |  | SCLogDebug("AU option, len %u", olen); |
|  |  | if (olen < 4) { |
|  |  | ENGINE\_SET\_INVALID\_EVENT(p,TCP\_OPT\_INVALID\_LEN); |
|  |  | } else { |
|  |  | /\* we can't validate the option as the key is out of band \*/ |
|  |  | p->tcpvars.ao\_option\_present = true; |
|  |  | } |
|  |  | break; |
|  |  | } |
|  |  |  |
|  |  | pkt += olen; |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[src/decode-tcp.h](#diff-7aed0db899af0ff2bc03c921b07ef2e9fac6b4e84967936ff8f67276ac9c4ecf "src/decode-tcp.h")

Show comments

[View file](/OISF/suricata/blob/50e2b973eeec7172991bf8f544ab06fb782b97df/src/decode-tcp.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,6 +54,8 @@ |
|  |  | #define TCP\_OPT\_TFO 0x22 /\* TCP Fast Open \*/ |
|  |  | #define TCP\_OPT\_EXP1 0xfd /\* Experimental, could be TFO \*/ |
|  |  | #define TCP\_OPT\_EXP2 0xfe /\* Experimental, could be TFO \*/ |
|  |  | #define TCP\_OPT\_MD5 0x13 /\* 19: RFC 2385 TCP MD5 option \*/ |
|  |  | #define TCP\_OPT\_AO 0x1d /\* 29: RFC 5925 TCP AO option \*/ |
|  |  |  |
|  |  | #define TCP\_OPT\_SACKOK\_LEN 2 |
|  |  | #define TCP\_OPT\_WS\_LEN 3 |
| Expand Down  Expand Up | | @@ -153,6 +155,8 @@ typedef struct TCPHdr\_ |
|  |  | typedef struct TCPVars\_ |
|  |  | { |
|  |  | /\* commonly used and needed opts \*/ |
|  |  | bool md5\_option\_present; |
|  |  | bool ao\_option\_present; |
|  |  | bool ts\_set; |
|  |  | uint32\_t ts\_val; /\* host-order \*/ |
|  |  | uint32\_t ts\_ecr; /\* host-order \*/ |
| Expand Down | |  |

19 changes: 18 additions & 1 deletion

19
[src/stream-tcp.c](#diff-eb5f2a643796d0f25b56ced24a3953eb45318eb325a0648586b5c736ddcb9184 "src/stream-tcp.c")

Show comments

[View file](/OISF/suricata/blob/50e2b973eeec7172991bf8f544ab06fb782b97df/src/stream-tcp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4433,6 +4433,9 @@ static int StreamTcpPacketStateClosed(ThreadVars \*tv, Packet \*p, |
|  |  | if (ostream->flags & STREAMTCP\_STREAM\_FLAG\_RST\_RECV) { |
|  |  | if (StreamTcpStateDispatch(tv, p, stt, ssn, &stt->pseudo\_queue, ssn->pstate) < 0) |
|  |  | return -1; |
|  |  | /\* if state is still "closed", it wasn't updated by our dispatch. \*/ |
|  |  | if (ssn->state == TCP\_CLOSED) |
|  |  | ssn->state = ssn->pstate; |
|  |  | } |
|  |  | } |
|  |  | return 0; |
| Expand Down  Expand Up | | @@ -5410,7 +5413,6 @@ TmEcode StreamTcpThreadDeinit(ThreadVars \*tv, void \*data) |
|  |  |  |
|  |  | static int StreamTcpValidateRst(TcpSession \*ssn, Packet \*p) |
|  |  | { |
|  |  |  |
|  |  | uint8\_t os\_policy; |
|  |  |  |
|  |  | if (ssn->flags & STREAMTCP\_FLAG\_TIMESTAMP) { |
| Expand Down  Expand Up | | @@ -5448,6 +5450,21 @@ static int StreamTcpValidateRst(TcpSession \*ssn, Packet \*p) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\* RFC 2385 md5 signature header or RFC 5925 TCP AO headerpresent. Since we can't |
|  |  | \* validate these (requires key that is set/transfered out of band), we can't know |
|  |  | \* if the RST will be accepted or rejected by the end host. We accept it, but keep |
|  |  | \* tracking if the sender of it ignores it, which would be a sign of injection. \*/ |
|  |  | if (p->tcpvars.md5\_option\_present || p->tcpvars.ao\_option\_present) { |
|  |  | TcpStream \*receiver\_stream; |
|  |  | if (PKT\_IS\_TOSERVER(p)) { |
|  |  | receiver\_stream = &ssn->server; |
|  |  | } else { |
|  |  | receiver\_stream = &ssn->client; |
|  |  | } |
|  |  | SCLogDebug("ssn %p: setting STREAMTCP\_STREAM\_FLAG\_RST\_RECV on receiver stream", ssn); |
|  |  | receiver\_stream->flags |= STREAMTCP\_STREAM\_FLAG\_RST\_RECV; |
|  |  | } |
|  |  |  |
|  |  | if (ssn->flags & STREAMTCP\_FLAG\_ASYNC) { |
|  |  | if (PKT\_IS\_TOSERVER(p)) { |
|  |  | if (SEQ\_GEQ(TCP\_GET\_SEQ(p), ssn->client.next\_seq)) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `50e2b97`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F50e2b973eeec7172991bf8f544ab06fb782b97df) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from redmine.openinfosecfoundation.org_c6ef2ffe_20250114_211432.html ===


‚ö≤

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #4710

closed

### tcp: Bypass of Payload Detection on TCP RST with options of MD5header

Added by [Chang Zedd](/users/7256) [over 3 years](/projects/suricata/activity?from=2021-09-26 "09/26/2021 02:58 AM") ago.
Updated [about 3 years](/projects/suricata/activity?from=2021-12-17 "12/17/2021 06:52 AM") ago.

Status:ClosedPriority:NormalAssignee:[Victor Julien](/users/4)Target version:[7.0.0-beta1](/versions/150 "10/25/2022")
Affected Versions:[git master](/versions/158)Label:Needs backport to 5.0, Needs backport to 6.0CVE:[2021-45098](https://nvd.nist.gov/vuln/detail/CVE-2021-45098)Git IDs:

50e2b973eeec7172991bf8f544ab06fb782b97df

Severity:HIGHDisclosure Date:

---

**Description**

**Description**
While configuring Suricata on inline mode, it is possible to bypass/evade any http based signature by faking a RST TCP packet with random TCP options of md5header from the client side.

After the three-way handshake packet, it's possible to inject a RST ACK with a random TCP md5header option. Then the client can send http GET request with forbidden URL.
The server will ignore the RST ACK and send the response http packet of the client's request.
These packets will not trigger Suricata reject action.

This strategy both work on 6.0.3 RELEASE and Github latest commit(7.0.0-dev a480ec2ba 2021-09-22)

Server:
apachectl -v
Server version: Apache/2.4.29 (Ubuntu)
Server built: 2021-06-18T11:06:22

**Attached**

You can find attached :
- test.rule : A http rule that detects the string "ultrasurf"
- without\_evasion.pcap : A client which sends the string "ultrasurf" to a server without any evasion technique. It will trigger suricata test.rule REJECT action and receive RST.
- with\_evasion.pcap : A client which sends the string "ultrasurf" to a linux apache server (kernel 5.4.0) with this evasion technique
- poc.py : A python script to play the evasion technique

---

**Files**

[Download all files](/attachments/issues/4710/download "Download all files")

| [poc.py](/attachments/2381) (1.65 KB) [poc.py](/attachments/download/2381/poc.py "Download") | A python script to play the evasion technique | Chang Zedd, 09/26/2021 02:56 AM |  |
| --- | --- | --- | --- |
| [test.rule](/attachments/2382) (101 Bytes) [test.rule](/attachments/download/2382/test.rule "Download") | A http rule that detects the string "ultrasurf" | Chang Zedd, 09/26/2021 02:56 AM |  |
| [with\_evasion.pcapng](/attachments/2383) (2.15 KB) [with\_evasion.pcapng](/attachments/download/2383/with_evasion.pcapng "Download") | A client which sends the string "ultrasurf" to a linux apache server (kernel 5.4.0) with this evasion technique | Chang Zedd, 09/26/2021 02:56 AM |  |
| [without\_evasion.pcapng](/attachments/2384) (984 Bytes) [without\_evasion.pcapng](/attachments/download/2384/without_evasion.pcapng "Download") | A client which sends the string "ultrasurf" to a server without any evasion technique. | Chang Zedd, 09/26/2021 02:56 AM |  |
| [tcpao.pcap](/attachments/2393) (2.47 KB) [tcpao.pcap](/attachments/download/2393/tcpao.pcap "Download") |  | Philippe Antoine, 10/08/2021 10:06 AM |  |

---

**Related issues**
[2](/issues?issue_id=4726%2C4727&set_filter=true&status_id=%2A) (0 open ‚Äî [2 closed](/issues?issue_id=4726%2C4727&set_filter=true&status_id=c))

|  | Copied to Suricata - [Security #4726](/issues/4726): tcp: Bypass of Payload Detection on TCP RST with options of MD5header | Closed | [Shivani Bhardwaj](/users/2194) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | Copied to Suricata - [Security #4727](/issues/4727): Bypass of Payload Detection on TCP RST with options of MD5header | Closed | [Jeff Lucovsky](/users/2518) |  |  |  | Actions |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/4710?tab=history)
* [Notes](/issues/4710?tab=notes)
* [Property changes](/issues/4710?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Victor Julien](/users/4) [over 3 years](/projects/suricata/activity?from=2021-09-26 "09/26/2021 07:59 AM") ago

* **Tracker** changed from *Bug* to *Security*
* **Private** changed from *No* to *Yes*
* **Severity** set to *MODERATE*
* **Label** *Needs backport to 5.0, Needs backport to 6.0* added

ActionsCopy link
[#2](#note-2)
#### Updated by [Chang Zedd](/users/7256) [over 3 years](/projects/suricata/activity?from=2021-09-28 "09/28/2021 01:01 AM") ago

Hi, perhaps I chose the wrong target version. This security issue is verified on both Suricata version 6.0.3 RELEASE and Github latest commit(7.0.0-dev a480ec2ba 2021-09-22). Is there anything I need to do? Thanks!

ActionsCopy link
[#3](#note-3)
#### Updated by [Jeff Lucovsky](/users/2518) [over 3 years](/projects/suricata/activity?from=2021-10-03 "10/03/2021 12:51 PM") ago

* **Copied to** *[Security #4726](/issues/4726): tcp: Bypass of Payload Detection on TCP RST with options of MD5header* added

ActionsCopy link
[#4](#note-4)
#### Updated by [Jeff Lucovsky](/users/2518) [over 3 years](/projects/suricata/activity?from=2021-10-03 "10/03/2021 12:51 PM") ago

* **Copied to** *[Security #4727](/issues/4727): Bypass of Payload Detection on TCP RST with options of MD5header* added

ActionsCopy link
[#5](#note-5)
#### Updated by [Victor Julien](/users/4) [over 3 years](/projects/suricata/activity?from=2021-10-05 "10/05/2021 11:35 AM") ago

* **Description** updated ([diff](/journals/20862/diff?detail_id=21494 "View differences"))

RFC explaining the option <http://www.networksorcery.com/enp/rfc/rfc2385.txt>

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [over 3 years](/projects/suricata/activity?from=2021-10-05 "10/05/2021 11:51 AM") ago

* **Subject** changed from *Bypass of Payload Detection on TCP RST with options of MD5header* to *tcp: Bypass of Payload Detection on TCP RST with options of MD5header*

It looks like that Suricata will not have all the needed info to correctly calculate the hash:
```

       1. the TCP pseudo-header (in the order: source IP address,
          destination IP address, zero-padded protocol number, and
          segment length)
       2. the TCP header, excluding options, and assuming a checksum of
          zero
       3. the TCP segment data (if any)
       4. an independently-specified key or password, known to both TCPs
          and presumably connection-specific

```

Point 4 here is the problem. We don't have a way to get this info from traffic as it is out of band. We also don't have a facility to feed this type of info to Suricata in real time currently.

I think the only way we can address this issue currently is by simply rejecting the RST if it has any md5header option.

ActionsCopy link
[#7](#note-7)
#### Updated by [Victor Julien](/users/4) [over 3 years](/projects/suricata/activity?from=2021-10-05 "10/05/2021 02:20 PM") ago

* **Status** changed from *New* to *Assigned*
* **Assignee** set to *Victor Julien*
* **Severity** changed from *MODERATE* to *HIGH*
* **Affected Versions** *git master* added

ActionsCopy link
[#8](#note-8)
#### Updated by [Philippe Antoine](/users/1820) [over 3 years](/projects/suricata/activity?from=2021-10-08 "10/08/2021 10:17 AM") ago

* **File** [tcpao.pcap](/attachments/2393) [tcpao.pcap](/attachments/download/2393/tcpao.pcap "Download") added

tcpao is the same kind of evasion using option kind 29 from rfc5925

Another way to get such a pcap with option kind 29 is simply to edit the original pcap with your favorite hex editor and change from 0x13 to 0x1d the right byte

ActionsCopy link
[#9](#note-9)
#### Updated by [Philippe Antoine](/users/1820) [over 3 years](/projects/suricata/activity?from=2021-10-08 "10/08/2021 11:03 AM") ago

By the way, this does not work against my raspberry pi, even if it works locally...
That is my raspberry pi sends a RST after the GET request

ActionsCopy link
[#10](#note-10)
#### Updated by [Victor Julien](/users/4) [about 3 years](/projects/suricata/activity?from=2021-11-24 "11/24/2021 03:37 PM") ago

* **Status** changed from *Assigned* to *Closed*
* **Git IDs** updated ([diff](/journals/21428/diff?detail_id=22039 "View differences"))

<https://github.com/OISF/suricata/commit/50e2b973eeec7172991bf8f544ab06fb782b97df>

ActionsCopy link
[#11](#note-11)
#### Updated by [Victor Julien](/users/4) [about 3 years](/projects/suricata/activity?from=2021-12-15 "12/15/2021 07:59 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#12](#note-12)
#### Updated by [Chang Zedd](/users/7256) [about 3 years](/projects/suricata/activity?from=2021-12-17 "12/17/2021 01:22 AM") ago

CVE-2021-45098

ActionsCopy link
[#13](#note-13)
#### Updated by [Victor Julien](/users/4) [about 3 years](/projects/suricata/activity?from=2021-12-17 "12/17/2021 06:52 AM") ago

* **CVE** set to *2021-45098*

Actions
Copy link

Also available in: [Atom](/issues/4710.atom)
[PDF](/issues/4710.pdf)

Powered by [Redmine](https://www.redmine.org/) ¬© 2006-2024 Jean-Philippe Lang

Loading...


