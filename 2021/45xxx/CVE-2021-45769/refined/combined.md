=== Content from github.com_2057565c_20250114_185459.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F368)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F368)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mz-automation%2Flibiec61850)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mz-automation](/mz-automation)
/
**[libiec61850](/mz-automation/libiec61850)**
Public

* [Notifications](/login?return_to=%2Fmz-automation%2Flibiec61850) You must be signed in to change notification settings
* [Fork
  478](/login?return_to=%2Fmz-automation%2Flibiec61850)
* [Star
   913](/login?return_to=%2Fmz-automation%2Flibiec61850)

* [Code](/mz-automation/libiec61850)
* [Issues
  150](/mz-automation/libiec61850/issues)
* [Pull requests
  44](/mz-automation/libiec61850/pulls)
* [Actions](/mz-automation/libiec61850/actions)
* [Projects
  0](/mz-automation/libiec61850/projects)
* [Wiki](/mz-automation/libiec61850/wiki)
* [Security](/mz-automation/libiec61850/security)
* [Insights](/mz-automation/libiec61850/pulse)

Additional navigation options

* [Code](/mz-automation/libiec61850)
* [Issues](/mz-automation/libiec61850/issues)
* [Pull requests](/mz-automation/libiec61850/pulls)
* [Actions](/mz-automation/libiec61850/actions)
* [Projects](/mz-automation/libiec61850/projects)
* [Wiki](/mz-automation/libiec61850/wiki)
* [Security](/mz-automation/libiec61850/security)
* [Insights](/mz-automation/libiec61850/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmz-automation%2Flibiec61850%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmz-automation%2Flibiec61850%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# NULL Pointer Dereference in AcseConnection\_parseMessage #368

Closed

[AiDaiP](/AiDaiP) opened this issue
Dec 23, 2021
· 1 comment

Closed

# [NULL Pointer Dereference in AcseConnection\_parseMessage](#top) #368

[AiDaiP](/AiDaiP) opened this issue
Dec 23, 2021
· 1 comment

## Comments

[![@AiDaiP](https://avatars.githubusercontent.com/u/43956964?s=80&u=ff92a9138fda3e540ab80ed35e8916bfd5088cd8&v=4)](/AiDaiP)

Copy link

### **[AiDaiP](/AiDaiP)** commented [Dec 23, 2021](#issue-1087285521)

| NULL Pointer Dereference in AcseConnection\_parseMessageDescription A NULL Pointer Dereference was discovered in AcseConnection\_parseMessage at src/mms/iso\_acse/acse.c:429. The vulnerability causes a segmentation fault and application crash.  **version**  [8eeb6f0](https://github.com/mz-automation/libiec61850/commit/8eeb6f06b39e4969bc4566d49f72002a7f10353f)  **System information** Ubuntu 20.04 focal, AMD EPYC 7742 64-Core @ 16x 2.25GHz Proof of Concept **poc**  ``` base64 poc AwAAFgLwgA0NAQDBATGBAgABogIAAA==  ```  **command:**  ``` ./server_example_basic_io nc 0.0.0.0 102 < poc  ```  **Result**  ``` ./server_example_basic_io Using libIEC61850 version 1.5.0 Connection opened AddressSanitizer:DEADLYSIGNAL ================================================================= ==4028537==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x55de6e46db68 bp 0x7fac36efcaa0 sp 0x7fac36efc9f0 T3) ==4028537==The signal is caused by a READ memory access. ==4028537==Hint: address points to the zero page.     #0 0x55de6e46db67 in AcseConnection_parseMessage src/mms/iso_acse/acse.c:429     #1 0x55de6e41960b in IsoConnection_handleTcpConnection src/mms/iso_server/iso_connection.c:233     #2 0x55de6e41ac5d in handleTcpConnection src/mms/iso_server/iso_connection.c:472     #3 0x7fac3b7e3608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477     #4 0x7fac3b5bb292 in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x122292)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV src/mms/iso_acse/acse.c:429 in AcseConnection_parseMessage Thread T3 created by T1 here:     #0 0x7fac3b837805 in pthread_create (/lib/x86_64-linux-gnu/libasan.so.5+0x3a805)     #1 0x55de6e3b19dc in Thread_start hal/thread/linux/thread_linux.c:89     #2 0x55de6e41b4f7 in IsoConnection_start src/mms/iso_server/iso_connection.c:581     #3 0x55de6e417bf1 in handleIsoConnections src/mms/iso_server/iso_server.c:520     #4 0x55de6e417c99 in isoServerThread src/mms/iso_server/iso_server.c:554     #5 0x7fac3b7e3608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477  Thread T1 created by T0 here:     #0 0x7fac3b837805 in pthread_create (/lib/x86_64-linux-gnu/libasan.so.5+0x3a805)     #1 0x55de6e3b19dc in Thread_start hal/thread/linux/thread_linux.c:89     #2 0x55de6e4182d2 in IsoServer_startListening src/mms/iso_server/iso_server.c:682     #3 0x55de6e3b9b50 in MmsServer_startListening src/mms/iso_mms/server/mms_server.c:606     #4 0x55de6e3adae9 in IedServer_start src/iec61850/server/impl/ied_server.c:692     #5 0x55de6e39537e in main /root/disk2/fuzzing/libiec61850/test/libiec61850/examples/server_example_basic_io/server_example_basic_io.c:146     #6 0x7fac3b4c00b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)  ==4028537==ABORTING  ```  **gdb**  ``` Using libIEC61850 version 1.5.0 [New Thread 0x7ffff3bff700 (LWP 4048010)] [New Thread 0x7ffff33fe700 (LWP 4048011)] Connection opened [New Thread 0x7ffff2bfd700 (LWP 4048307)]  Thread 4 "server_example_" received signal SIGSEGV, Segmentation fault. [Switching to Thread 0x7ffff2bfd700 (LWP 4048307)] 0x0000555555661b68 in AcseConnection_parseMessage (self=0x608000004020, message=0x6060000030a8) at src/mms/iso_acse/acse.c:429 429         uint8_t messageType = buffer[bufPos++]; LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA ────────────────────────────────────────────[ REGISTERS ]─────────────────────────────────────────────  RAX  0x0  RBX  0x7ffff2bfca20 ◂— 0x41b58ab3  RCX  0x0  RDX  0x0  RDI  0x7ffff2bfca80 —▸ 0x7ffff2bfce60 ◂— 0x0  RSI  0x0  R8   0x0  R9   0x32  R10  0x40  R11  0x0  R12  0xffffe57f944 ◂— 0x0  R13  0x7ffff2bfca20 ◂— 0x41b58ab3  R14  0x7ffff2bfcb40 ◂— 0x41b58ab3  R15  0x7ffff2bfcf80 ◂— 0x0  RBP  0x7ffff2bfcaa0 —▸ 0x7ffff2bfce80 —▸ 0x7ffff2bfceb0 ◂— 0x0  RSP  0x7ffff2bfc9f0 —▸ 0x6060000030a8 ◂— 0x0  RIP  0x555555661b68 (AcseConnection_parseMessage+383) ◂— movzx  eax, byte ptr [rcx] ──────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────  ► 0x555555661b68 <AcseConnection_parseMessage+383>    movzx  eax, byte ptr [rcx]    0x555555661b6b <AcseConnection_parseMessage+386>    mov    byte ptr [rbp - 0x95], al    0x555555661b71 <AcseConnection_parseMessage+392>    mov    ecx, dword ptr [rbp - 0x90]    0x555555661b77 <AcseConnection_parseMessage+398>    mov    edx, dword ptr [rbp - 0x8c]    0x555555661b7d <AcseConnection_parseMessage+404>    lea    rsi, [rdi - 0x40]    0x555555661b81 <AcseConnection_parseMessage+408>    mov    rax, qword ptr [rbp - 0x88]    0x555555661b88 <AcseConnection_parseMessage+415>    mov    rdi, rax    0x555555661b8b <AcseConnection_parseMessage+418>    call   BerDecoder_decodeLength                <BerDecoder_decodeLength>     0x555555661b90 <AcseConnection_parseMessage+423>    mov    dword ptr [rbp - 0x8c], eax    0x555555661b96 <AcseConnection_parseMessage+429>    cmp    dword ptr [rbp - 0x8c], 0    0x555555661b9d <AcseConnection_parseMessage+436>    jns    AcseConnection_parseMessage+448        <AcseConnection_parseMessage+448> ──────────────────────────────────────────[ SOURCE (CODE) ]─────────────────────────────────────────── In file: /root/disk2/fuzzing/libiec61850/test/libiec61850/src/mms/iso_acse/acse.c    424    425     int messageSize = message->size;    426    427     int bufPos = 0;    428  ► 429     uint8_t messageType = buffer[bufPos++];    430    431     int len;    432    433     bufPos = BerDecoder_decodeLength(buffer, &len, bufPos, messageSize);    434 ──────────────────────────────────────────────[ STACK ]─────────────────────────────────────────────── 00:0000│ rsp     0x7ffff2bfc9f0 —▸ 0x6060000030a8 ◂— 0x0 01:0008│         0x7ffff2bfc9f8 —▸ 0x608000004020 ◂— 0x0 02:0010│         0x7ffff2bfca00 —▸ 0x7ffff2bfcb40 ◂— 0x41b58ab3 03:0018│         0x7ffff2bfca08 —▸ 0xa2310146 ◂— 0x0 04:0020│         0x7ffff2bfca10 —▸ 0x100000000 ◂— 0x0 05:0028│         0x7ffff2bfca18 ◂— 0x0 06:0030│ rbx r13 0x7ffff2bfca20 ◂— 0x41b58ab3 07:0038│         0x7ffff2bfca28 —▸ 0x5555556d71d8 ◂— '1 32 4 7 len:431' ────────────────────────────────────────────[ BACKTRACE ]─────────────────────────────────────────────  ► f 0   0x555555661b68 AcseConnection_parseMessage+383    f 1   0x55555560d60c IsoConnection_handleTcpConnection+1422    f 2   0x55555560ec5e handleTcpConnection+43    f 3   0x7ffff7564609 start_thread+217 ────────────────────────────────────────────────────────────────────────────────────────────────────── pwndbg> bt #0  0x0000555555661b68 in AcseConnection_parseMessage (self=0x608000004020, message=0x6060000030a8) at  src/mms/iso_acse/acse.c:429 #1  0x000055555560d60c in IsoConnection_handleTcpConnection (self=0x61100000ff40, isSingleThread=false) at src/mms/iso_server/iso_connection.c:233 #2  0x000055555560ec5e in handleTcpConnection (parameter=0x61100000ff40) at src/mms/iso_server/iso_connection.c:472 #3  0x00007ffff7564609 in start_thread (arg=<optimized out>) at pthread_create.c:477 #4  0x00007ffff733c293 in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[mzillgith](/mzillgith)
added a commit
that referenced
this issue
[Dec 23, 2021](#ref-commit-32087c4)
[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=40&v=4)](/mzillgith)

`[- fix - server crashes when presentation message has no user data (LI…](/mz-automation/libiec61850/commit/32087c47dea6a551610bed3dec7cb94d7d89e5ac "- fix - server crashes when presentation message has no user data (LIB61850-291)(#368)")`
…

`[32087c4](/mz-automation/libiec61850/commit/32087c47dea6a551610bed3dec7cb94d7d89e5ac)`

```
…B61850-291)([#368](https://github.com/mz-automation/libiec61850/issues/368))
```

[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=80&v=4)](/mzillgith)

Copy link

Contributor

### **[mzillgith](/mzillgith)** commented [Dec 23, 2021](#issuecomment-1000134294)

| Thanks for the bug reports. Is confirmed and should be fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=40&v=4)](/mzillgith)
[mzillgith](/mzillgith)
closed this as [completed](/mz-automation/libiec61850/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 10, 2022](#event-5868980502)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmz-automation%2Flibiec61850%2Fissues%2F368)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@mzillgith](https://avatars.githubusercontent.com/u/25686324?s=52&v=4)](/mzillgith) [![@AiDaiP](https://avatars.githubusercontent.com/u/43956964?s=52&v=4)](/AiDaiP)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


