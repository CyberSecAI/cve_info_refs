=== Content from github.com_5cdcbd3f_20250114_215247.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyuezk%2FGlobalProtect-openconnect%2Fissues%2F113)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyuezk%2FGlobalProtect-openconnect%2Fissues%2F113)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=yuezk%2FGlobalProtect-openconnect)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yuezk](/yuezk)
/
**[GlobalProtect-openconnect](/yuezk/GlobalProtect-openconnect)**
Public

* [Notifications](/login?return_to=%2Fyuezk%2FGlobalProtect-openconnect) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Fyuezk%2FGlobalProtect-openconnect)
* [Star
   1.5k](/login?return_to=%2Fyuezk%2FGlobalProtect-openconnect)

* [Code](/yuezk/GlobalProtect-openconnect)
* [Issues
  54](/yuezk/GlobalProtect-openconnect/issues)
* [Pull requests
  0](/yuezk/GlobalProtect-openconnect/pulls)
* [Discussions](/yuezk/GlobalProtect-openconnect/discussions)
* [Actions](/yuezk/GlobalProtect-openconnect/actions)
* [Projects
  0](/yuezk/GlobalProtect-openconnect/projects)
* [Wiki](/yuezk/GlobalProtect-openconnect/wiki)
* [Security](/yuezk/GlobalProtect-openconnect/security)
* [Insights](/yuezk/GlobalProtect-openconnect/pulse)

Additional navigation options

* [Code](/yuezk/GlobalProtect-openconnect)
* [Issues](/yuezk/GlobalProtect-openconnect/issues)
* [Pull requests](/yuezk/GlobalProtect-openconnect/pulls)
* [Discussions](/yuezk/GlobalProtect-openconnect/discussions)
* [Actions](/yuezk/GlobalProtect-openconnect/actions)
* [Projects](/yuezk/GlobalProtect-openconnect/projects)
* [Wiki](/yuezk/GlobalProtect-openconnect/wiki)
* [Security](/yuezk/GlobalProtect-openconnect/security)
* [Insights](/yuezk/GlobalProtect-openconnect/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fyuezk%2FGlobalProtect-openconnect%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fyuezk%2FGlobalProtect-openconnect%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Trivially exploitable priviledge escalation to root vulnerability #113

Closed

[koraa](/koraa) opened this issue
Dec 21, 2021
· 16 comments

Closed

# [Trivially exploitable priviledge escalation to root vulnerability](#top) #113

[koraa](/koraa) opened this issue
Dec 21, 2021
· 16 comments

## Comments

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

### **[koraa](/koraa)** commented [Dec 21, 2021](#issue-1085841586) • edited Loading

| The way GlobalProtect-Openconnect is set up enables arbitrary users to execute commands as root:   1. Install the payload; in this case, a demonstration payload installing itself to /usr/bin/GROOT     ```     echo -e '#!/bin/bash\ncat "$0" > /usr/bin/GROOT\nchmod a+x "$0" /usr/bin/GROOT' > /tmp/groot; bash /tmp/groot        ``` 2. Specify openconnect parameters: `--script=/tmp/groot` 3. Log into any VPN service   This vulnerability can be executed by any user, even a "nobody" user covertly by sending commands to the `com.yuezk.qt.GPService`. This vulnerability can be executed by a user with keyboard access to install a rootkit using the GUI you provided. This vulnerability can be executed as soon as openconnect-globalprotect is installed; even if the gpservice.service systemd service has not been started as the unit file specifies: `BusName=com.yuezk.qt.GPService`. I had to explicitly mask the service to mitigate the vulnerability.  As such, it leaves any host who even has the program installed highly vulnerable; this is the worst case among privilege escalation vulnerabilities.  For a secure-by-default configuration, openconnect-global needs to be updated, so administrator approval is needed to allow specific globalprotect servers or a change in command line parameters.  I propose a root-editable configuration file /etc/openconnect-globalprotect.conf with the following syntax  ```   karolin *.vpn.cupdev.net -i cupdev --script=/etc/vpn/cupdev-ifup.sh  ```  This entry allows the user karolin to connect to any vpn servers with a domain suffix vpn.cupdev.net and the specified openconnect parameters. Groups may be specified by prefixing the user with `%`.  The app could implement a config-editing feature, allowing users to edit the configuration graphically after specifying the administrator password.  I would also suggest disabling systemd dbus activation altogether just to avoid the entire issue of a security bug sticking around even with a stopped unit.  Thank you for all your hard work! |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=40&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)
[koraa](/koraa)
changed the title
~~Trivially Exploitable Priviledge Escalation Vulnerability~~
Trivially exploitable priviledge escalation to root vulnerability
[Dec 21, 2021](#event-5799004395)

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=40&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)
[koraa](/koraa)
mentioned this issue
[Dec 21, 2021](#ref-issue-1085843942)

[Easy to exploit host traffic redirection vulnerability
#114](/yuezk/GlobalProtect-openconnect/issues/114)

Closed

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [Dec 22, 2021](#issuecomment-999501401)

| [@koraa](https://github.com/koraa) Thanks for your solid advice. I will try to fix it. |
| --- |

All reactions

Sorry, something went wrong.

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [Dec 22, 2021](#issuecomment-999529780)

| [@yuezk](https://github.com/yuezk) Feel free to ping me any time; I'll be happy to perform a security review of the fix or answer any questions that may arise! |
| --- |

 👍
2
 yuezk and aloisdg reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [Dec 26, 2021](#issuecomment-1001112365) • edited Loading

| ~~> I would also suggest disabling systemd dbus activation altogether just to avoid the entire issue of a security bug sticking around even with a stopped unit.~~   ~~- It should be easy to disable the dbus activation, by just modifying the unit file.~~2. ~~I'm wondering if it is secure if I made it an auto-starting service as the root user.~~ |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [Dec 26, 2021](#issuecomment-1001114918)

| Hi [@koraa](https://github.com/koraa), below is my understanding, correct me if I were wrong. Thanks.   1. Provide a root-editable configuration file. 2. The GPService runs in the background should not accept the custom parameters pass to the OpenConect CLI. Instead, it should read the parameters configured in the root-editable configuration file. And validate the user who wants to connect to the VPN server is specified in the configuration file. 3. Do I still need to disable the DBus activation after 1 & 2 are implemented? |
| --- |

All reactions

Sorry, something went wrong.

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [Dec 26, 2021](#issuecomment-1001223336)

| That sounds good. I would still disable dbus activation, yes. DBus activation is generally a bad idea as it magnifies security issues; a user should always opt into a service starting, not opt out as they would with DBus activation. |
| --- |

All reactions

Sorry, something went wrong.

[![@la2fda](https://avatars.githubusercontent.com/u/30241805?s=80&u=e5ef4b978b3d3940c4a48498fb17587a752544f9&v=4)](/la2fda)

Copy link

### **[la2fda](/la2fda)** commented [Jan 10, 2022](#issuecomment-1008684459)

| Thanks for a really god job, but [#113](https://github.com/yuezk/GlobalProtect-openconnect/issues/113) is unfortunately a showstopper for my organization. Is there any progress ? |
| --- |

 👍
1
 then4p reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [Jan 10, 2022](#issuecomment-1008692146)

| [@la2fda](https://github.com/la2fda) (Check out my [#110](https://github.com/yuezk/GlobalProtect-openconnect/pull/110) scripting mode, it can be used as a stopgap measure; fetch the ticket as a normal user and use sudo to run the actual openconnect session…it's a bit of work but it's much safer and works nicely) |
| --- |

 👍
2
 la2fda and then4p reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=40&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)
[yuezk](/yuezk)
mentioned this issue
[Jan 25, 2022](#ref-issue-1112004326)

[Privatage escalation to root via Custom Parameters option
#118](/yuezk/GlobalProtect-openconnect/issues/118)

Closed

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [Apr 22, 2022](#issuecomment-1106684608)

| CVE: <https://nvd.nist.gov/vuln/detail/CVE-2021-45809> |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [Apr 25, 2022](#issuecomment-1108334837) • edited Loading

| The OpenConnect extension for Gnome doesn't require the root privilege. I will refer to its implementation. I also did some investigation on [Running OpenConnect as a non-root user](https://www.infradead.org/openconnect/nonroot.html). Will try my best to fix it ASAP. |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=40&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)
[yuezk](/yuezk)
mentioned this issue
[May 9, 2022](#ref-pullrequest-1229564344)

[Prepare release 1.4.3
#149](/yuezk/GlobalProtect-openconnect/pull/149)
 Merged

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [May 9, 2022](#issuecomment-1121198021)

| [@koraa](https://github.com/koraa) I moved the configuration to `/etc/gpservice/gp.conf` in 1.4.3.  ``` ❯ ls -l /etc/gpservice/gp.conf        -rw-r--r-- 1 root root 423  5月  8 21:42 /etc/gpservice/gp.conf ```  More details about the configuration can be found at <https://github.com/yuezk/GlobalProtect-openconnect/wiki/Configuration>.  Do you have any concerns about it? |
| --- |

All reactions

Sorry, something went wrong.

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [May 10, 2022](#issuecomment-1122346566)

| [@yuezk](https://github.com/yuezk) That sounds good! Where was it before? |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [May 10, 2022](#issuecomment-1122448401) • edited Loading

| Previously, the extra arguments for OpenConnect are configured in the settings dialog (the values are saved in `~/.config/com.yuezk.qt` folder) and passed to the `gpservice`. Now I removed the ability to pass the extra args, and `gpservice` will read it from `/etc/gpservice/gp.conf`  At the same time, the user can edit `gp.conf` with the root permission manually to tune the args, instead of editing them in the settings dialog with a normal user permission. |
| --- |

All reactions

Sorry, something went wrong.

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=80&u=3f356bc6713480a38605697399807f7330501b2f&v=4)](/koraa)

Copy link

Contributor

Author

### **[koraa](/koraa)** commented [May 11, 2022](#issuecomment-1123646401)

| That sounds like a good fix to me! |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=40&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)
[yuezk](/yuezk)
closed this as [completed](/yuezk/GlobalProtect-openconnect/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 14, 2022](#event-6609619738)

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [May 14, 2022](#issuecomment-1126658004)

| Fixed in [1.4.3](https://github.com/yuezk/GlobalProtect-openconnect/releases/tag/v1.4.3) |
| --- |

All reactions

Sorry, something went wrong.

[![@TS-CUBED](https://avatars.githubusercontent.com/u/52218856?s=80&v=4)](/TS-CUBED)

Copy link

### **[TS-CUBED](/TS-CUBED)** commented [Jun 12, 2022](#issuecomment-1153202529)

| Does this fix <https://nvd.nist.gov/vuln/detail/CVE-2021-45809> ?  If yes, it may be worth updating the CVE to indicate that this is fixed in v>1.4.3 |
| --- |

All reactions

Sorry, something went wrong.

[![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=80&u=360d8b44ac5874419b7111a08146ec1145948888&v=4)](/yuezk)

Copy link

Owner

### **[yuezk](/yuezk)** commented [Jun 13, 2022](#issuecomment-1153715543)

| [@TS-CUBED](https://github.com/TS-CUBED) Yes. Just submitted the request for updating the description. |
| --- |

All reactions

Sorry, something went wrong.

[![@arderyp](https://avatars.githubusercontent.com/u/6485320?s=40&v=4)](/arderyp)
[arderyp](/arderyp)
mentioned this issue
[Aug 11, 2023](#ref-issue-1501449342)

["Message did not meet security requirements"
#201](/yuezk/GlobalProtect-openconnect/issues/201)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fyuezk%2FGlobalProtect-openconnect%2Fissues%2F113)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@koraa](https://avatars.githubusercontent.com/u/1451261?s=52&v=4)](/koraa) [![@yuezk](https://avatars.githubusercontent.com/u/3297602?s=52&v=4)](/yuezk) [![@la2fda](https://avatars.githubusercontent.com/u/30241805?s=52&v=4)](/la2fda) [![@TS-CUBED](https://avatars.githubusercontent.com/u/52218856?s=52&v=4)](/TS-CUBED)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


