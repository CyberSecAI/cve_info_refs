The provided content is related to CVE-2021-45718.

**Root cause of vulnerability:**
Incorrect lifetime bounds on closures passed to several `rusqlite` functions. These functions register a callback to be invoked later by SQLite. The relaxed lifetime bounds allow a closure referencing borrowed stack values to be passed, which could lead to accessing objects on the stack after they have been dropped.

**Weaknesses/vulnerabilities present:**
- Use-after-free vulnerability due to incorrect lifetime bounds on closures.
- Memory corruption could occur when accessing deallocated stack memory.

**Impact of exploitation:**
- Accessing freed memory on the stack can lead to undefined behavior and memory corruption.
- This could lead to crashes, data leaks, or potentially arbitrary code execution.

**Attack vectors:**
- Passing a closure with references to stack-allocated data to one of the vulnerable `rusqlite` functions.
- SQLite then invokes the callback after the stack frame where the borrowed values reside has been popped.

**Required attacker capabilities/position:**
- Ability to pass closures with references to stack-allocated variables to the vulnerable functions.
- The attacker needs to trigger the callback execution in a state where the referenced data has gone out of scope.

**Affected Functions:**
- `rusqlite::Connection::create_scalar_function`
- `rusqlite::Connection::create_aggregate_function`
- `rusqlite::Connection::create_window_function`
- `rusqlite::Connection::create_collation`
- `rusqlite::Connection::commit_hook`
- `rusqlite::Connection::rollback_hook`
- `rusqlite::Connection::update_hook`

**Affected Versions:**
- Versions `0.25.0`, `0.25.1`, `0.25.2`, `0.25.3`, `0.26.0`, and `0.26.1`

**Patched Versions:**
- Versions `0.25.4` and `0.26.2` and newer