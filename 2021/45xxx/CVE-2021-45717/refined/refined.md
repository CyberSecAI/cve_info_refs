The provided content is related to CVE-2021-45717.

**Root cause of vulnerability:**
The vulnerability stems from incorrect lifetime bounds on closures passed to several `rusqlite` functions that register callbacks to be later invoked by SQLite.

**Weaknesses/vulnerabilities present:**
The relaxed lifetime bounds allow closures referencing borrowed values on the stack to be passed to these functions. This could lead to a use-after-free vulnerability, where Rust code accesses objects on the stack after they have been dropped.

**Impact of exploitation:**
Exploitation could result in memory corruption due to accessing freed memory, potentially leading to crashes or other undefined behavior.

**Attack vectors:**
An attacker would need to provide a crafted closure with references to stack-allocated data that becomes invalid when the function returns. The vulnerability occurs when the SQLite callback is executed later.

**Required attacker capabilities/position:**
The attacker needs to be able to influence the code to call the vulnerable `rusqlite` functions (`create_scalar_function`, `create_aggregate_function`, `create_window_function`, `commit_hook`, `rollback_hook`, `update_hook`, or `create_collation`) with a malicious closure.

**Affected Functions:**
- `rusqlite::Connection::create_scalar_function`
- `rusqlite::Connection::create_aggregate_function`
- `rusqlite::Connection::create_window_function`
- `rusqlite::Connection::create_collation`
- `rusqlite::Connection::commit_hook`
- `rusqlite::Connection::rollback_hook`
- `rusqlite::Connection::update_hook`

**Affected Versions:**
- >= 0.25.0, < 0.25.4
- >= 0.26.0, < 0.26.2

**Patched Versions:**
- >= 0.26.2
- 0.25.4