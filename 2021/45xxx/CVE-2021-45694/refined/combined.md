=== Content from rustsec.org_cd83e661_20250115_084601.html ===


RUSTSEC-2021-0094: rdiff: Window can read out of bounds if Read instance returns more bytes than buffer size › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/rdiff/RUSTSEC-2021-0094.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/rdiff/RUSTSEC-2021-0094.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0094)

# RUSTSEC-2021-0094

Window can read out of bounds if Read instance returns more bytes than buffer size

Reported
February 3, 2021

Issued
August 21, 2021

(last modified: June 13, 2023)

Package
[rdiff](/packages/rdiff.html)
([crates.io](https://crates.io/crates/rdiff))

Type
INFO
Unsound

Categories

* [memory-exposure](/categories/memory-exposure.html)

Aliases

* [CVE-2021-45694](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45694)
* [GHSA-2rxc-8f9w-fjq8](https://github.com/advisories/GHSA-2rxc-8f9w-fjq8)
* [GHSA-q579-9wp9-gfp2](https://github.com/advisories/GHSA-q579-9wp9-gfp2)

References

* <https://github.com/dyule/rdiff/issues/3>

Patched
no patched versions

### Description

`rdiff` performs a diff of two provided strings or files. As part of its reading
code it uses the return value of a `Read` instance to set the length of
its internal character vector.

If the `Read` implementation claims that it has read more bytes than the length
of the provided buffer, the length of the vector will be set to longer than its
capacity. This causes `rdiff` APIs to return uninitialized memory in its API
methods.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from raw.githubusercontent.com_376c9f53_20250115_084601.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0094"
package = "rdiff"
date = "2021-02-03"
url = "https://github.com/dyule/rdiff/issues/3"
categories = ["memory-exposure"]
informational = "unsound"
aliases = ["CVE-2021-45694", "GHSA-2rxc-8f9w-fjq8", "GHSA-q579-9wp9-gfp2"]
[versions]
patched = []
```
# Window can read out of bounds if Read instance returns more bytes than buffer size
`rdiff` performs a diff of two provided strings or files. As part of its reading
code it uses the return value of a `Read` instance to set the length of
its internal character vector.
If the `Read` implementation claims that it has read more bytes than the length
of the provided buffer, the length of the vector will be set to longer than its
capacity. This causes `rdiff` APIs to return uninitialized memory in its API
methods.

