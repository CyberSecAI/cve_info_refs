```
{
  "Root cause of vulnerability": "The vulnerability arises due to an inconsistent CallInfo state during a tail call. Specifically, when the 'checkstackGC' macro is called within 'luaD_pretailcall', it can trigger finalizers. If a finalizer attempts to access the CallInfo ('ci') structure, it will encounter a state where 'ci' is only partially updated, causing 'ci_func(ci)->p' to point to the tail-called function ('f') instead of the current function ('g'). This leads to an out-of-bounds read in 'funcnamefromcode' because the saved program counter ('ci->u.l.savedpc') belongs to function 'g' while accessing the code of function 'f'.",
  "Weaknesses/vulnerabilities present": [
    "Inconsistent CallInfo state during tail calls",
    "Out-of-bounds read due to incorrect program counter usage",
    "Potential heap buffer overflow"
  ],
  "Impact of exploitation": "The vulnerability can cause a crash due to a heap buffer overflow when finalizers are called with an invalid stack, leading to a denial of service.",
  "Attack vectors": "The attack vector is a crafted Lua script that uses tail calls with a large number of arguments combined with garbage collection and finalizers set to an erroneous value.",
  "Required attacker capabilities/position": "The attacker needs the ability to execute arbitrary Lua scripts."
}
```