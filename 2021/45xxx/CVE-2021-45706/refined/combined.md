=== Content from rustsec.org_77e1eaef_20250114_183417.html ===


RUSTSEC-2021-0115: zeroize\_derive: `#[zeroize(drop)]` doesn't implement `Drop` for `enum`s › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/zeroize_derive/RUSTSEC-2021-0115.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/zeroize_derive/RUSTSEC-2021-0115.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0115)

# RUSTSEC-2021-0115

`#[zeroize(drop)]` doesn't implement `Drop` for `enum`s

Reported
September 24, 2021

Issued
September 24, 2021

(last modified: June 13, 2023)

Package
[zeroize\_derive](/packages/zeroize_derive.html)
([crates.io](https://crates.io/crates/zeroize_derive))

Type
Vulnerability

Aliases

* [CVE-2021-45706](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45706)
* [GHSA-c5hx-w945-j4pq](https://github.com/advisories/GHSA-c5hx-w945-j4pq)

References

* <https://github.com/iqlusioninc/crates/issues/876>

Patched

* `>=1.1.1`

### Description

Affected versions of this crate did not implement `Drop` when `#[zeroize(drop)]` was used on an `enum`.

This can result in memory not being zeroed out after dropping it, which is exactly what is intended when adding this attribute.

The flaw was corrected in version 1.2 and `#[zeroize(drop)]` on `enum`s now properly implements `Drop`.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from raw.githubusercontent.com_57a177a4_20250114_183416.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0115"
package = "zeroize\_derive"
date = "2021-09-24"
url = "https://github.com/iqlusioninc/crates/issues/876"
aliases = ["CVE-2021-45706", "GHSA-c5hx-w945-j4pq"]
[versions]
patched = [">= 1.1.1"]
```
# `#[zeroize(drop)]` doesn't implement `Drop` for `enum`s
Affected versions of this crate did not implement `Drop` when `#[zeroize(drop)]` was used on an `enum`.
This can result in memory not being zeroed out after dropping it, which is exactly what is intended when adding this attribute.
The flaw was corrected in version 1.2 and `#[zeroize(drop)]` on `enum`s now properly implements `Drop`.

