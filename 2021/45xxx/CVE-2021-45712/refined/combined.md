=== Content from raw.githubusercontent.com_5c6be748_20250115_091219.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0126"
package = "rust-embed"
date = "2021-11-29"
url = "https://github.com/pyros2097/rust-embed/issues/159"
categories = ["file-disclosure"]
aliases = ["CVE-2021-45712", "GHSA-cgw6-f3mj-h742", "GHSA-xrg3-hmf3-rvgw"]
[versions]
patched = [">= 6.3.0"]
```
# RustEmbed generated `get` method allows for directory traversal when reading files from disk
When running in debug mode and the `debug-embed` (off by default) feature is
not enabled, the generated `get` method does not check that the input path is
a child of the folder given.
This allows attackers to read arbitrary files in the file system if they have
control over the filename given. The following code will print the contents of
your `/etc/passwd` if adjusted with a correct number of `../`s depending on
where it is run from.
```rust
#[derive(rust\_embed::RustEmbed)]
#[folder = "src/"]
pub struct Asset;
fn main() {
let d = Asset::get("../../../etc/passwd").unwrap().data;
println!("{}", String::from\_utf8\_lossy(&d));
}
```
The flaw was corrected by canonicalizing the input filename and ensuring that
it starts with the canonicalized folder path.


=== Content from rustsec.org_02d0dbe5_20250115_091220.html ===


RUSTSEC-2021-0126: rust-embed: RustEmbed generated `get` method allows for directory traversal when reading files from disk › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/rust-embed/RUSTSEC-2021-0126.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/rust-embed/RUSTSEC-2021-0126.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0126)

# RUSTSEC-2021-0126

RustEmbed generated `get` method allows for directory traversal when reading files from disk

Reported
November 29, 2021

Issued
November 29, 2021

(last modified: June 13, 2023)

Package
[rust-embed](/packages/rust-embed.html)
([crates.io](https://crates.io/crates/rust-embed))

Type
Vulnerability

Categories

* [file-disclosure](/categories/file-disclosure.html)

Aliases

* [CVE-2021-45712](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45712)
* [GHSA-cgw6-f3mj-h742](https://github.com/advisories/GHSA-cgw6-f3mj-h742)
* [GHSA-xrg3-hmf3-rvgw](https://github.com/advisories/GHSA-xrg3-hmf3-rvgw)

References

* <https://github.com/pyros2097/rust-embed/issues/159>

Patched

* `>=6.3.0`

### Description

When running in debug mode and the `debug-embed` (off by default) feature is
not enabled, the generated `get` method does not check that the input path is
a child of the folder given.

This allows attackers to read arbitrary files in the file system if they have
control over the filename given. The following code will print the contents of
your `/etc/passwd` if adjusted with a correct number of `../`s depending on
where it is run from.

```
#[derive(rust_embed::RustEmbed)]
#[folder = "src/"]
pub struct Asset;

fn main() {
    let d = Asset::get("../../../etc/passwd").unwrap().data;
    println!("{}", String::from_utf8_lossy(&d));
}

```

The flaw was corrected by canonicalizing the input filename and ensuring that
it starts with the canonicalized folder path.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


