- **Root cause of vulnerability**: The `lru` crate's iterator functions (`iter` and `iter_mut`) return references to key-value pairs. If a function like `pop()` is called to remove a value from the cache while an iterator holds a reference to that value, the value is freed, leading to a use-after-free condition when the iterator is later used.
- **Weaknesses/vulnerabilities present**: Use-after-free.
- **Impact of exploitation**: Memory corruption and potential program crash or undefined behavior.
- **Attack vectors**: By obtaining iterators through `iter` or `iter_mut` functions of `LruCache`, then calling functions like `pop` which removes entries from the `LruCache`, and then later accessing the freed memory through the iterators.
- **Required attacker capabilities/position**: The attacker needs to be able to call functions of the LruCache that modify the cache and also obtain and use the iterators.