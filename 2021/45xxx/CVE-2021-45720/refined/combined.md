=== Content from rustsec.org_e1d182f5_20250114_233107.html ===


RUSTSEC-2021-0130: lru: Use after free in lru crate › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/lru/RUSTSEC-2021-0130.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/lru/RUSTSEC-2021-0130.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0130)

# RUSTSEC-2021-0130

Use after free in lru crate

Reported
December 21, 2021

Issued
December 21, 2021

(last modified: June 13, 2023)

Package
[lru](/packages/lru.html)
([crates.io](https://crates.io/crates/lru))

Type
Vulnerability

Categories

* [memory-corruption](/categories/memory-corruption.html)

Keywords
[#use-after-free](/keywords/use-after-free.html)

Aliases

* [CVE-2021-45720](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45720)
* [GHSA-qqmc-hwqp-8g2w](https://github.com/advisories/GHSA-qqmc-hwqp-8g2w)
* [GHSA-v362-2895-h9r2](https://github.com/advisories/GHSA-v362-2895-h9r2)

References

* <https://github.com/jeromefroe/lru-rs/issues/120>

Patched

* `>=0.7.1`

Affected Functions
Version
`lru::LruCache::iter`

* `<0.7.1`

`lru::LruCache::iter_mut`

* `<0.7.1`

### Description

Lru crate has use after free vulnerability.

Lru crate has two functions for getting an iterator. Both iterators give
references to key and value. Calling specific functions, like pop(), will remove
and free the value, and but it's still possible to access the reference of value
which is already dropped causing use after free.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from raw.githubusercontent.com_75b6798f_20250114_233105.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0130"
package = "lru"
date = "2021-12-21"
url = "https://github.com/jeromefroe/lru-rs/issues/120"
categories = ["memory-corruption"]
keywords = ["use-after-free"]
aliases = ["CVE-2021-45720", "GHSA-qqmc-hwqp-8g2w", "GHSA-v362-2895-h9r2"]
[affected.functions]
"lru::LruCache::iter" = ["< 0.7.1"]
"lru::LruCache::iter\_mut" = ["< 0.7.1"]
[versions]
patched = [">= 0.7.1"]
```
# Use after free in lru crate
Lru crate has use after free vulnerability.
Lru crate has two functions for getting an iterator. Both iterators give
references to key and value. Calling specific functions, like pop(), will remove
and free the value, and but it's still possible to access the reference of value
which is already dropped causing use after free.

