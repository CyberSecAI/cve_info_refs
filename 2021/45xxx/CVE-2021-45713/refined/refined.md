- **Root cause of vulnerability**: Incorrect lifetime bounds on closures accepted by several `rusqlite` functions. These functions register callbacks to be invoked later by SQLite. The relaxed lifetime bounds allowed closures to capture references to stack-allocated data that could be dropped by the time the callback is invoked, resulting in use-after-free conditions.
- **Weaknesses/vulnerabilities present**: Use-after-free vulnerability due to incorrect lifetime management in closures.
- **Impact of exploitation**: Allows accessing memory after it has been freed, leading to potential memory corruption and crashes.
- **Attack vectors**: Passing a closure that captures a reference to a local variable to a vulnerable `rusqlite` function. The vulnerability is triggered when the callback is invoked by SQLite after the stack frame containing the captured data has been deallocated.
- **Required attacker capabilities/position**: An attacker needs to be able to provide a closure to the vulnerable functions that captures stack-allocated data. This typically would occur within normal application logic when registering callbacks.