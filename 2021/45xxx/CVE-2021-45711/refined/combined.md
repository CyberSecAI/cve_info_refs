=== Content from rustsec.org_e5561deb_20250115_082610.html ===


RUSTSEC-2021-0125: simple\_asn1: Panic on incorrect date input to `simple\_asn1` › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/simple_asn1/RUSTSEC-2021-0125.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/simple_asn1/RUSTSEC-2021-0125.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0125)

# RUSTSEC-2021-0125

Panic on incorrect date input to `simple_asn1`

Reported
November 14, 2021

Issued
November 18, 2021

(last modified: June 13, 2023)

Package
[simple\_asn1](/packages/simple_asn1.html)
([crates.io](https://crates.io/crates/simple_asn1))

Type
Vulnerability

Categories

* [denial-of-service](/categories/denial-of-service.html)

Keywords
[#panic](/keywords/panic.html)
[#string\_slice](/keywords/string_slice.html)

Aliases

* [CVE-2021-45711](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45711)
* [GHSA-3m6f-3gfg-4x56](https://github.com/advisories/GHSA-3m6f-3gfg-4x56)
* [GHSA-g4h2-4wvh-grc5](https://github.com/advisories/GHSA-g4h2-4wvh-grc5)

References

* <https://github.com/acw/simple_asn1/issues/27>

Patched

* `>=0.6.1`

Unaffected

* `<0.6.0`

### Description

Version 0.6.0 of the `simple_asn1` crate panics on certain malformed
inputs to its parsing functions, including `from_der` and `der_decode`.
Because this crate is frequently used with inputs from the network, this
should be considered a security vulnerability.

The issue occurs when parsing the old ASN.1 "UTCTime" time format. If an
attacker provides a UTCTime where the first character is ASCII but the
second character is above 0x7f, a string slice operation in the
`from_der_` function will try to slice into the middle of a UTF-8
character, and cause a panic.

This error was introduced in commit
[`d7d39d709577710e9dc8`](https://github.com/acw/simple_asn1/commit/d7d39d709577710e9dc8833ee57d200eef366db8),
which updated `simple_asn1` to use `time` instead of `chrono` because of
[`RUSTSEC-2020-159`](https://rustsec.org/advisories/RUSTSEC-2020-0159).
Versions of `simple_asn1` before 0.6.0 are not affected by this issue.

The [patch](https://github.com/acw/simple_asn1/pull/28) was applied in
`simple_asn1` version 0.6.1.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from raw.githubusercontent.com_0aca992a_20250115_082610.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0125"
package = "simple\_asn1"
date = "2021-11-14"
url = "https://github.com/acw/simple\_asn1/issues/27"
categories = ["denial-of-service"]
keywords = ["panic", "string\_slice"]
aliases = ["CVE-2021-45711", "GHSA-3m6f-3gfg-4x56", "GHSA-g4h2-4wvh-grc5"]
#aliases = ["CVE-YYYY-NNNN"]
#cvss = "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
[versions]
patched = [">=0.6.1"]
unaffected = ["<0.6.0"]
```
# Panic on incorrect date input to `simple\_asn1`
Version 0.6.0 of the `simple\_asn1` crate panics on certain malformed
inputs to its parsing functions, including `from\_der` and `der\_decode`.
Because this crate is frequently used with inputs from the network, this
should be considered a security vulnerability.
The issue occurs when parsing the old ASN.1 "UTCTime" time format. If an
attacker provides a UTCTime where the first character is ASCII but the
second character is above 0x7f, a string slice operation in the
`from\_der\_` function will try to slice into the middle of a UTF-8
character, and cause a panic.
This error was introduced in commit
[`d7d39d709577710e9dc8`](https://github.com/acw/simple\_asn1/commit/d7d39d709577710e9dc8833ee57d200eef366db8),
which updated `simple\_asn1` to use `time` instead of `chrono` because of
[`RUSTSEC-2020-159`](https://rustsec.org/advisories/RUSTSEC-2020-0159).
Versions of `simple\_asn1` before 0.6.0 are not affected by this issue.
The [patch](https://github.com/acw/simple\_asn1/pull/28) was applied in
`simple\_asn1` version 0.6.1.

