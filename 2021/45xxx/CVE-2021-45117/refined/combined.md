=== Content from cert-portal.siemens.com_6aae6556_20250115_085910.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-285795: Denial of Service in OPC-UA in Industrial Products

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 6.5

2022-05-10
2023-10-10
V1.4

SUMMARY

A vulnerability in the underlying third party component OPC UA ANSIC Stack (also called Legacy C-Stack)
affects several industrial products. The vulnerability could cause a crash of the component that includes
the vulnerable part of the stack.

Siemens has released updates for the affected products and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SIMATIC HMI Comfort Outdoor Panels (incl.
SIPLUS variants):
All versions < V17 Update 5

SIMATIC HMI Comfort Panels (incl. SIPLUS vari-
ants):
All versions < V17 Update 5

SIMATIC HMI KTP Mobile Panels KTP400F,
KTP700, KTP700F, KTP900 and KTP900F:
All versions < V17 Update 5

SIMATIC NET PC Software V14:
All versions < V14 SP1 Update 14

SIMATIC NET PC Software V15:
All versions

Update SIMATIC WinCC (TIA Portal) to V17 Up-
date 5 or newer, and then update panel to V17
Update 5 or newer
https://support.industry.siemens.com/cs/ww/en/
view/109746530/
See further
Workarounds and Mitigations

recommendations from section

Update SIMATIC WinCC (TIA Portal) to V17 Up-
date 5 or newer, and then update panel to V17
Update 5 or newer
https://support.industry.siemens.com/cs/ww/en/
view/109746530/
See further
Workarounds and Mitigations

recommendations from section

Update SIMATIC WinCC (TIA Portal) to V17 Up-
date 5 or newer, and then update panel to V17
Update 5 or newer
https://support.industry.siemens.com/cs/ww/en/
view/109746530/
See further
Workarounds and Mitigations

recommendations from section

Update to V14 SP1 Update 14 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109807351/
See further
Workarounds and Mitigations

recommendations from section

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-285795

© Siemens 2023

Page 1 of 4

Siemens Security Advisory by Siemens ProductCERT

SIMATIC NET PC Software V16:
All versions < V16 Update 6

SIMATIC NET PC Software V17:
All versions < V17 SP 1

SITOP Manager:
All versions < V1.2.4

TeleControl Server Basic V3:
All versions < V3.1.1

Update to V16 Update 6 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109811815/
See further
Workarounds and Mitigations

recommendations from section

Update to V17 SP1 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808270/
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2.4 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109760607/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.1.1 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109812231/
See further
Workarounds and Mitigations

recommendations from section

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• Do not use OPC client feature to connect via untrusted networks or to untrusted OPC-UA communi-

cation partners

• Use VPN for protecting network communication between cells

Product-speciﬁc remediations or mitigations can be found in the section Affected Products and Solution.
Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals. Additional information on Industrial Security by
Siemens can be found at: https://www.siemens.com/industrialsecurity

SSA-285795

© Siemens 2023

Page 2 of 4

Siemens Security Advisory by Siemens ProductCERT

PRODUCT DESCRIPTION

SIMATIC HMI Panels are used for operator control and monitoring of machines and plants.

SIMATIC NET PC software is a software product that is sold separately and implements the communica-
tions product from SIMATIC NET.

SIPLUS extreme products are designed for reliable operation under extreme conditions and are based on
SIMATIC, LOGO!, SITOP, SINAMICS, SIMOTION, SCALANCE or other devices. SIPLUS devices use the
same ﬁrmware as the product they are based on.

SITOP Manager is a tool for commissioning, engineering and monitoring of SITOP power supplies with
communication capabilities.

TeleControl Server Basic allows remote monitoring and control of plants.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2021-45117

The OPC UA ANSIC Stack (also called Legacy C-Stack) was reported to crash when an unexpected
OPC UA Response message status code was accessed via the synchronous Client API. The vulnera-
bility was found in generated code of the OPC Foundation C-Stack. An unexpected status code in
response message will dereference Null pointer leading to crash, ping of death (PoD). This affects a
client, but it might also affect a server when it uses OpcUa_ClientApi_RegisterServer (e.g. register at
LDS). A specially crafted UA server, or Man in the Middle attacker, can cause the OPC UA application
to crash by sending uncertain status code in response message.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-285795

© Siemens 2023

Page 3 of 4

Siemens Security Advisory by Siemens ProductCERT

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2022-05-10):
V1.1 (2022-07-12):
V1.2 (2022-08-09):
V1.3 (2022-10-11):

V1.4 (2023-10-10):

TERMS OF USE

Publication Date
Added ﬁx for SIMATIC NET PC Software V16
Added ﬁx for TeleControl Server Basic
Added SIMATIC HMI Comfort Outdoor Panels and SIMATIC HMI KTP Mobile
Panels to list of affected products
Added ﬁx for SITOP Manager

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-285795

© Siemens 2023

Page 4 of 4



=== Content from files.opcfoundation.org_878eb2b1_20250115_085912.html ===
OPC Foundation Security Bulletin

Security Update for Autogenerated ANSI C Stack Stubs

Published: March 1st, 2022
Version: 1.0

Executive Summary

This security update resolves a vulnerability in the autogenerated ANSI C stack stubs that allows a
malicious server to produce a null pointer error in the client. Any application that uses these stubs is
affected including any application based on the OPCFoundation/UA-AnsiC-Legacy codebase.

This security update has a base score of 6.0 (medium) using the CVSS v3.1 guidelines.

The CVSS vector string is:
AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H/E:F/RL:O/RC:C

Affected Software

The following software has been updated to address the issue:

Download

Release Date

Replacement

 OPCFoundation/UA-Nodeset

This version or any version after it.  GitHub Commit

d69b75a4b90ed21fbf57a330181f29c75fa2b072.

https://github.com/OPCFoundation/UA-
NodeSet/commit/d69b75a4b90ed21fbf57a330181f29c75fa2b0
72

OPC Foundation Vulnerability Information

Vulnerabilities and Exposures list:

Vulnerability

CVE number

Publicly
disclosed

Exploited

CWE-476 NULL Pointer Dereference

CVE-2021-45117

No

No

Mitigating Factors

Exploiting this vulnerability requires a client to choose to connect to a malicious server or an attacker
who can manipulate packets as they travel across the network.

Workarounds

Do not connect to servers that have been discovered via mDNS, an LDS, an untrusted GDS, or a trusted
GDS using SecurityMode=None. Do not call FindServers or GetEndpoints with SecurityMode=None.

Disclaimer

The information provided in this disclosure is provided "as is" without warranty of any kind. OPC
Foundation disclaims all warranties, either express or implied, including the warranties of merchantability
and fitness for a particular purpose. In no event shall OPC Foundation or its suppliers be liable for any
damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special
damages, even if OPC Foundation or its suppliers have been advised of the possibility of such damages.
Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so
the foregoing limitation may not apply.

Revisions

•  V1.0 (March 1st, 2022): Bulletin published.



=== Content from www.youtube.com_651fe830_20250115_085913.html ===
[00:01] in this video we'll take a look at
[00:03] running the unit tests for the NCC stack
[00:07] so we have visual studio 2013 running
[00:11] with the all projects solution loaded
[00:15] and an equivalent Visual Studio 2008
[00:18] solution also exists and it's structured
[00:21] the same as what you see here so under
[00:24] the stack folder you'll see the unit
[00:26] tests project
[00:29] and you can simply
[00:31] build that application it is a console
[00:34] based application and then you can jump
[00:37] right in and debug it
[00:42] if we run that over pull that window
[00:44] over you'll see the the test cases will
[00:47] begin to
[00:49] execute and some of these can take a
[00:52] while there's a lot of different tests
[00:53] that are taking place checking the data
[00:56] types checking the encodings and
[00:58] decodings and connectivity Etc so I can
[01:01] take a little while
[01:05] and once it's done you'll get a message
[01:07] telling you hopefully that all tests are
[01:10] complete
