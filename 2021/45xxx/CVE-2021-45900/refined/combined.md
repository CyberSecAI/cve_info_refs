=== Content from vivoh.com_7454d8e2_20250114_210033.html ===


[![Vivoh](https://vivoh.com/content/images/2022/01/vivoh.png)](https://vivoh.com)

* [Projects](https://vivoh.com/projects/)
* [Team](https://vivoh.com/team/)
* [News](https://vivoh.com/blog/)
* [Contact](https://vivoh.com/contact-us/)

# Vivoh Customer FINRA Finds Vulnerability and Verifies Remediation

Dec 20, 2021

2 min read

SECURITY FINDINGS FOR VIVOH

Author: **Shubham Agrawal (shubham.agrawal@finra.org)**

****Improper API Authentication****

When a user logs in to the application, a cookie is assigned so they can be uniquely identified by the application. Vivoh uses **VIVOH\_AUTH** cookie to check that.

Certain APIs in VIVOH can be successfully executed without proper authentication. This issue can let an attacker impersonate as victim and make state changing requests on their behalf.

****The vulnerable APIs are:****

1. POST, PUT, DELETE request sent to /api/source/
2. POST, PUT, DELETE request sent to /api/rule/
3. PUT request sent to /api/config/

****Note:**** This document shows how to reproduce the POST request issue with source API. The rest of HTTP methods and APIs can be reproduced in the same way.

****Steps to Reproduce:****

1. Create a new source.

![](https://vivoh.com/content/images/2022/01/finra-01.png)

2.   Inspect the new source created and copy it as curl.

![](https://vivoh.com/content/images/2022/01/finra-02.png)

Sample Curl Command:

**curl ‘https://website.org:8443/api/source/new’ -H ‘User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36’ -H ‘Accept: application/json, text/plain, \*/\*’ -H ‘Accept-Language: en-US,en;q=0.5’ –compressed -H ‘Content-Type: application/json;charset=utf-8’ -H ‘Origin: https://website.org:8443’ -H ‘Connection: keep-alive’ -H ‘Cookie: VIVOH\_USERNAME=<insert username>’ -H ‘Pragma: no-cache’ -H ‘Cache-Control: no-cache’ –data-raw ‘{“url”:”https://random-url-curl.com”}’ -k**

(In the above command change the website name and VIVOH\_USERNAME as per your environment.)

Request-Response from BurpSuite:

![](https://vivoh.com/content/images/2022/01/finra-03.png)

3. Paste the curl command in a terminal. Make sure to send only VIVOH\_USERNAME cookie (remove VIVOH\_AUTH cookie) and see the success response.

![](https://vivoh.com/content/images/2022/01/finra-04.png)

4. Confirm the response on UI.

![](https://vivoh.com/content/images/2022/01/finra-05.png)

****Remediation:****

1. On the server side, check if the valid auth cookie is present in the request.
2. Invalidate the auth cookie once the user logs out.

### The issue was fixed, and verification was done.

Following are the proofs:

![](https://vivoh.com/content/images/2022/01/finra-06.png)

In the above screenshot, a POST request to /api/source was sent with only VIVOH\_USERNAME cookie and it threw us unauthenticated error.

![](https://vivoh.com/content/images/2022/01/finra-07.png)

In the above screenshot, a POST request to /api/source was intercepted, the user logged out of the application, and then the request was passed. We got an error in the response saying unauthenticated.

The fix is verified.

[Previous Post](/blog/new-zoom-dvr-service-released/)

[Next Post](/blog/cisco-adds-vivoh/)

Powered by [Ghost](https://ghost.org/)

[![Vivoh](https://vivoh.com/content/images/2022/01/vivoh.png)](https://vivoh.com)


