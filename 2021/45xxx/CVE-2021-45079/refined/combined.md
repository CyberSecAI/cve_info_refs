=== Content from download.strongswan.org_ad54a223_20250115_200752.html ===

[strongSwan Downloads](/)

[strongswan.org](//www.strongswan.org)
[Documentation](//docs.strongswan.org)
[GitHub](//github.com/strongswan/strongswan/)

# Index of /security/CVE-2021-45079

| [ICO] | [Name](?C=N;O=D) | [Last modified](?C=M;O=A) | [Size](?C=S;O=A) |
| --- | --- | --- | --- |
| [[PARENTDIR]](/security/) | [Parent Directory](/security/) |  | - |
| [[TXT]](strongswan-5.0.1-5.4.0_eap_success.patch) | <strongswan-5.0.1-5.4.0_eap_success.patch> | 2022-01-10 12:00 | 5.7K |
| [[TXT]](strongswan-5.0.1-5.4.0_eap_success.patch.sig) | <strongswan-5.0.1-5.4.0_eap_success.patch.sig> | 2022-01-17 10:46 | 659 |
| [[TXT]](strongswan-5.5.0-5.9.4_eap_success.patch) | <strongswan-5.5.0-5.9.4_eap_success.patch> | 2022-01-10 12:00 | 5.7K |
| [[TXT]](strongswan-5.5.0-5.9.4_eap_success.patch.sig) | <strongswan-5.5.0-5.9.4_eap_success.patch.sig> | 2022-01-17 10:46 | 659 |

/security/CVE-2021-45079
—
©
2025
The strongSwan Project



=== Content from github.com_5625dc9a_20250115_200752.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan)

[strongswan](/strongswan)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstrongswan)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Corg-login%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@strongswan](https://avatars.githubusercontent.com/u/457671?s=200&v=4)

# strongSwan

* Verified

  We've verified that the organization **strongswan** controls the domain:

  + **strongswan.org**
  [Learn more about verified organizations](https://docs.github.com/organizations/managing-organization-settings/verifying-or-approving-a-domain-for-your-organization)

* [179
  followers](/orgs/strongswan/followers)
* [https://strongswan.org](https://strongswan.org "https://strongswan.org")

* [Overview](/strongswan)
* [Repositories](/orgs/strongswan/repositories)
* [Projects](/orgs/strongswan/projects)
* [Packages](/orgs/strongswan/packages)
* [People](/orgs/strongswan/people)

More

* [Overview](/strongswan)
* [Repositories](/orgs/strongswan/repositories)
* [Projects](/orgs/strongswan/projects)
* [Packages](/orgs/strongswan/packages)
* [People](/orgs/strongswan/people)

## Pinned Loading

1. [strongswan](/strongswan/strongswan) strongswan Public

   strongSwan - IPsec-based VPN

   C

   [2.4k](/strongswan/strongswan/stargazers)
   [793](/strongswan/strongswan/forks)
2. [strongswan-docs](/strongswan/strongswan-docs) strongswan-docs Public

   AsciiDoc source files for the docs.strongswan.org website

   [13](/strongswan/strongswan-docs/stargazers)
   [33](/strongswan/strongswan-docs/forks)

### Repositories

 Loading

 Type

Select type

All

Public

Sources

Forks

Archived

Mirrors

Templates

 Language

Select language

All

C

Dockerfile

Go

Handlebars

Python

 Sort

Select order

Last updated

Name

Stars

Showing 10 of 12 repositories

* [strongswan](/strongswan/strongswan)
  Public

  strongSwan - IPsec-based VPN

   strongswan/strongswan’s past year of commit activity

  C

  [2,352](/strongswan/strongswan/stargazers)
  [793](/strongswan/strongswan/forks)
  [69](/strongswan/strongswan/issues)
  [44](/strongswan/strongswan/pulls)
  Updated Jan 15, 2025
* [strongswan-antora](/strongswan/strongswan-antora)
  Public

  Antora configuration files for the docs.strongswan.org website

   strongswan/strongswan-antora’s past year of commit activity

  Handlebars

  [2](/strongswan/strongswan-antora/stargazers)
  [2](/strongswan/strongswan-antora/forks)
  [0](/strongswan/strongswan-antora/issues)
  [0](/strongswan/strongswan-antora/pulls)
  Updated Jan 14, 2025
* [strongswan-docs](/strongswan/strongswan-docs)
  Public

  AsciiDoc source files for the docs.strongswan.org website

   strongswan/strongswan-docs’s past year of commit activity

  [13](/strongswan/strongswan-docs/stargazers)
  [33](/strongswan/strongswan-docs/forks)
  [0](/strongswan/strongswan-docs/issues)
  [3](/strongswan/strongswan-docs/pulls)
  Updated Jan 14, 2025
* [strongMan](/strongswan/strongMan)
  Public

  Management UI for strongSwan

   strongswan/strongMan’s past year of commit activity

  Python

  [121](/strongswan/strongMan/stargazers)
  [39](/strongswan/strongMan/forks)
  [7](/strongswan/strongMan/issues)
  [0](/strongswan/strongMan/pulls)
  Updated Dec 9, 2024
* [govici](/strongswan/govici)
  Public

  Go implementation of the VICI protocol

   strongswan/govici’s past year of commit activity

  Go

  [60](/strongswan/govici/stargazers)

  MIT

  [17](/strongswan/govici/forks)
  [1](/strongswan/govici/issues)
  [0](/strongswan/govici/pulls)
  Updated Dec 3, 2024
* [strongTNC](/strongswan/strongTNC)
  Public

  BYOD TNC Database Management Tool

   strongswan/strongTNC’s past year of commit activity

  Python

  [21](/strongswan/strongTNC/stargazers)

  AGPL-3.0

  [10](/strongswan/strongTNC/forks)
  [2](/strongswan/strongTNC/issues)
  [1](/strongswan/strongTNC/pulls)
  Updated Apr 17, 2024
* [fuzzing-corpora](/strongswan/fuzzing-corpora)
  Public

  Corpora for fuzzing parts of the strongSwan code base

   strongswan/fuzzing-corpora’s past year of commit activity

  [8](/strongswan/fuzzing-corpora/stargazers)
  [3](/strongswan/fuzzing-corpora/forks)
  [0](/strongswan/fuzzing-corpora/issues)
  [0](/strongswan/fuzzing-corpora/pulls)
  Updated Nov 24, 2023
* [linux](/strongswan/linux)
  Public

  Forked from
  [torvalds/linux](/torvalds/linux)

  Linux kernel source tree

   strongswan/linux’s past year of commit activity

  C

  [1](/strongswan/linux/stargazers)
  [56,741](/strongswan/linux/forks)
  [0](/strongswan/linux/issues)
  [0](/strongswan/linux/pulls)
  Updated Nov 20, 2023
* [boringssl](/strongswan/boringssl)
  Public

  Forked from
  [google/boringssl](/google/boringssl)

  Mirror of BoringSSL

   strongswan/boringssl’s past year of commit activity

  C

  [2](/strongswan/boringssl/stargazers)
  [795](/strongswan/boringssl/forks)
  [0](/strongswan/boringssl/issues)
  [0](/strongswan/boringssl/pulls)
  Updated Oct 3, 2022
* [davici](/strongswan/davici)
  Public

  Decoupled Asynchronous VICI

   strongswan/davici’s past year of commit activity

  C

  [21](/strongswan/davici/stargazers)

  LGPL-2.1

  [18](/strongswan/davici/forks)
  [5](/strongswan/davici/issues)
  [3](/strongswan/davici/pulls)
  Updated Jan 24, 2022

 [View all repositories](/orgs/strongswan/repositories?type=all)

[#### People](/orgs/strongswan/people)
[![@tobiasbrunner](https://avatars.githubusercontent.com/u/457648?s=70&v=4)](/tobiasbrunner)

#### Top languages

[C](/orgs/strongswan/repositories?language=c&type=all)
[Python](/orgs/strongswan/repositories?language=python&type=all)
[Go](/orgs/strongswan/repositories?language=go&type=all)
[Handlebars](/orgs/strongswan/repositories?language=handlebars&type=all)
[Dockerfile](/orgs/strongswan/repositories?language=dockerfile&type=all)

#### Most used topics

Loading…

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.strongswan.org_ac6be608_20250114_224056.html ===

[![strongSwan Logo](/images/logo.svg)](/)

[Documentation](/documentation.html)
[Support](/support.html)
[License](/license.html)
[About](/about.html)
[**Blog**](/blog/)
[**Download**](/download.html)
[**GitHub**](https://github.com/strongswan)

# Blog

## Release and vulnerability announcements for strongSwan

* [Blog](/blog/)
* [2022](/blog/2022)
* [strongSwan Vulnerability (CVE-2021-45079)](/blog/2022/01/24/strongswan-vulnerability-%28cve-2021-45079%29.html)

## strongSwan Vulnerability (CVE-2021-45079)

Jan 24, 2022

A vulnerability in the EAP client implementation was discovered in strongSwan. All versions since 4.1.2 are affected.

[security fix](/blog/tags/security%2Bfix)[5.9.x](/blog/tags/5.9.x)[5.8.x](/blog/tags/5.8.x)[5.7.x](/blog/tags/5.7.x)[5.6.x](/blog/tags/5.6.x)[5.5.x](/blog/tags/5.5.x)[5.4.x](/blog/tags/5.4.x)[5.3.x](/blog/tags/5.3.x)[5.2.x](/blog/tags/5.2.x)[5.1.x](/blog/tags/5.1.x)[5.0.x](/blog/tags/5.0.x)[4.x](/blog/tags/4.x)

Zhuowei Zhang reported a bug in the EAP authentication client code that may allow to bypass the client and in some scenarios even the server authentication, or could lead to a denial-of-service attack.

### Incorrect Handling of Early EAP-Success Messages

When using EAP authentication ([RFC 3748](https://datatracker.ietf.org/doc/html/rfc3748)), the successful completion of the authentication is indicated by an EAP-Success message sent by the server to the client. strongSwan's EAP client code handled early EAP-Success messages incorrectly, either crashing the IKE daemon or concluding the EAP method prematurely, leading to varying outcomes depending on the configuration. Affected are all strongSwan versions since 4.1.2, depending on the configuration.

[CVE-2021-45079](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-45079) has been assigned for this vulnerability.

#### Introduction to EAP Authentication With IKEv2

IKEv2 clients request EAP authentication by omitting the AUTH payload in the initial IKE\_AUTH request. The VPN server or an AAA server on its behalf will then initiate an EAP method to authenticate the client by sending an EAP-Request message in the IKE\_AUTH response. This and any subsequent EAP messages are encapsulated in EAP payloads that are exchanged in further IKE\_AUTH exchanges.

Once the EAP authentication is complete and the client received an EAP-Success message, it will finally send an AUTH payload, which might incorporate a Master Session Key (MSK) established by the EAP method, in its final IKE\_AUTH request. The VPN server confirms this by including an AUTH payload in its final IKE\_AUTH response (likewise incorporating any established MSK, which it may have received via RADIUS from the AAA server). It's important to note that not all EAP methods are key-generating, in which case `SK_pi|r` is used instead of an MSK to build the AUTH payload.

For the server authentication there are two variations when using EAP:

* In the regular case defined in [RFC 7296](https://datatracker.ietf.org/doc/html/rfc7296), the VPN server will authenticate itself with a certificate right away and include an AUTH payload in the first IKE\_AUTH response. The client won't continue with the authentication if it fails to validate the server's authentication at this point.
* However, if the client and server both support EAP-only authentication ([RFC 5998](https://datatracker.ietf.org/doc/html/rfc5998)), the server may omit the AUTH payload in the initial IKE\_AUTH response. In this case, the server won't be authenticated until the EAP method is concluded and the client validated the AUTH payload received in the final IKE\_AUTH response. Note that this is only permitted for mutual, key-generating EAP methods that are resistant to dictionary attacks (e.g. EAP-TLS, EAP-TTLS or EAP-AKA).

#### Crash Caused by Very Early EAP-Success Messages

To trigger a crash, the VPN or AAA server can send an EAP-Success message right away, without first initiating a specific EAP method. The client code incorrectly assumed that an instance of an EAP method will exist whenever an EAP-Success message is received and unconditionally called the `get_msk()` method to retrieve any MSK established by the assumed EAP method, crashing the daemon due to a NULL-pointer dereference.

#### Authentication Shortcut Due to Early EAP-Success Messages

Early EAP-Success messages sent after initiating an EAP method lead to different results depending on the EAP method and whether EAP-only authentication is used.

The culprit is again the `get_msk()` call mentioned above. Due to the non-key-generating EAP methods that don't establish an MSK, the code ignored a negative result of that call. The AUTH payload was just generated without MSK if none was available, even for methods that would actually be key-generating but were never completed.

EAP-only authentication will not be in use in many common setups, and the VPN server will be required to authenticate with a certificate first. For clients that are configured as such, the EAP/AAA server may shortcut the EAP authentication (depending on the method, see below) but the client can still be sure that the connection is established with the correct VPN server. In these scenarios, the authentication of the EAP/AAA server is usually less important for mutual EAP methods.

However, with EAP-only authentication, e.g. if both peers are configured to authenticate via EAP-TLS only, a rogue VPN server is able to not only bypass the client authentication but also its own. This could then allow such an attacker to read any unencrypted traffic sent by the client through the VPN tunnel, or may even allow it to access hosts behind the client if its local traffic selector included one or more subnets. The latter might be the case in EAP-TTLS/TNC scenarios with mutual attestation (e.g. the [tnc/tnccs-20-mutual-eap](testing/testresults/tnc/tnccs-20-mutual-eap/) test scenario).

Not all EAP methods can be shortcut (and for some, like EAP-GTC or EAP-MD5, there is no difference as they are completed after the client sent its first and only EAP-Response). One particular example is EAP-MSCHAPv2, which is a mutual, key-generating method. While it can't be used for EAP-only authentication because it's prone to dictionary attacks, it still establishes an MSK. And since that MSK incorporates the client's password, an attacker will only be able to produce an MSK and AUTH payload accepted by the client if it knows the client's password.

Remote code execution is not possible due to this issue.

As mentioned in the introduction, credit to Zhuowei Zhang ([@zhuowei](https://twitter.com/zhuowei)) for finding this vulnerability.

### Mitigation

Setups that don't use EAP authentication are not vulnerable, as are configurations that don't use EAP-only authentication and the VPN server is required to authenticate with a certificate first (both our Android client and NetworkManager plugin are configured like that), unless a mutual EAP method is used and the AAA server identity/authentication is important in that particular scenario.

The just released [strongSwan 5.9.5](/blog/2022/01/24/strongswan-5.9.5-released.html) fixes this vulnerability. For older releases, we [provide patches](https://download.strongswan.org/security/CVE-2021-45079) that fix the vulnerability and should apply with appropriate hunk offsets (please note that we don't provide patches for versions < 5.0.1).

If you maintain a custom EAP method/plugin, make sure to change the return value of `get_msk()` to `NOT_SUPPORTED` if the method does not generate an MSK, otherwise, return `FAILED` until the method is complete and an MSK has been established.

**strongSwan Project**

* [Downloads](/download.html)
* [License](/license.html)
* [About](/about.html)
* [Blog](/blog/) ([RSS](/blog/feed.rss))

**Help**

* [Documentation](/documentation.html)
* [Support](/support.html)

**Social**

* [GitHub](https://github.com/strongswan)
* [Bluesky](https://bsky.app/profile/strongswan.org)
* [X/Twitter](https://x.com/strongswan)
* [Facebook](https://www.facebook.com/pages/strongSwan/222380261260881)

**Main Sponsors**
[![secunet](/images/secunet_logo_neg.svg)](https://www.secunet.com/)
[![codelabs](/images/codelabs_logo_rgb_neg.png)](https://www.codelabs.ch/)

**© 2025** by The strongSwan Team

[Imprint](/imprint.html)


