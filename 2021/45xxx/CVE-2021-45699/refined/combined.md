=== Content from rustsec.org_80ff3041_20250114_191606.html ===


RUSTSEC-2021-0108: ckb: Remote memory exhaustion in ckb › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/ckb/RUSTSEC-2021-0108.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/ckb/RUSTSEC-2021-0108.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0108)

# RUSTSEC-2021-0108

Remote memory exhaustion in ckb

Reported
July 25, 2021

Issued
September 10, 2021

(last modified: June 13, 2023)

Package
[ckb](/packages/ckb.html)
([crates.io](https://crates.io/crates/ckb))

Type
Vulnerability

Aliases

* [CVE-2021-45699](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45699)
* [GHSA-2969-8hh9-57jc](https://github.com/advisories/GHSA-2969-8hh9-57jc)
* [GHSA-48vq-8jqv-gm6f](https://github.com/advisories/GHSA-48vq-8jqv-gm6f)

References

* <https://github.com/nervosnetwork/ckb/security/advisories/GHSA-48vq-8jqv-gm6f>

Patched

* `>=0.40.0`

### Description

In the ckb sync protocol, SyncState maintains a HashMap called 'misbehavior' that keeps a score of a peer's violations of the protocol. This HashMap is keyed to PeerIndex (an alias for SessionId), and entries are never removed from it. SessionId is an integer that increases monotonically with every new connection.

A remote attacker can manipulate this HashMap to grow forever, resulting in degraded performance and ultimately a panic on allocation failure or being killed by the OS, depending on the platform.

This is a critical severity security bug. It could be exploited to create a targeted or network-wide denial of service, to reduce the hash power of the network as part of a 51% attack, and perhaps in other creative ways.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.



=== Content from raw.githubusercontent.com_c125663a_20250114_191606.html ===
```toml
[advisory]
id = "RUSTSEC-2021-0108"
package = "ckb"
date = "2021-07-25"
url = "https://github.com/nervosnetwork/ckb/security/advisories/GHSA-48vq-8jqv-gm6f"
aliases = ["CVE-2021-45699", "GHSA-2969-8hh9-57jc", "GHSA-48vq-8jqv-gm6f"]
[versions]
patched = [">= 0.40.0"]
```
# Remote memory exhaustion in ckb
In the ckb sync protocol, SyncState maintains a HashMap called 'misbehavior' that keeps a score of a peer's violations of the protocol. This HashMap is keyed to PeerIndex (an alias for SessionId), and entries are never removed from it. SessionId is an integer that increases monotonically with every new connection.
A remote attacker can manipulate this HashMap to grow forever, resulting in degraded performance and ultimately a panic on allocation failure or being killed by the OS, depending on the platform.
This is a critical severity security bug. It could be exploited to create a targeted or network-wide denial of service, to reduce the hash power of the network as part of a 51% attack, and perhaps in other creative ways.

