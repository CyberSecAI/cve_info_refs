```
id: OSV-2021-678
summary: UNKNOWN WRITE in CompileBlock
details: |
  OSS-Fuzz report: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33555
  ```
  Crash type: UNKNOWN WRITE
  Crash state: CompileBlock Compile\_LoopOrBlock CompileBlockStatements
  ```
modified: '2022-08-31T00:21:39.438080Z'
published: '2021-04-23T00:00:13.900793Z'
references:
- type: REPORT
  url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33555
affected:
- package:
    name: wasm3
    ecosystem: OSS-Fuzz
  ranges:
  - type: GIT
    repo: https://github.com/wasm3/wasm3
    events:
    - introduced: ef7c7f3a7578b9ed362cfbd0d1c6f065678df531
    - fixed: 321ba58316e77b5f4d977897aaa4bdbe43a5e38b
  versions:
  - v0.5.0
ecosystem_specific:
  severity: HIGH
```

Based on the provided information:

**Root cause of vulnerability:** The vulnerability is an "UNKNOWN WRITE" that occurs during the compilation phase, specifically within the `CompileBlock`, `Compile_LoopOrBlock`, and `CompileBlockStatements` functions.

**Weaknesses/vulnerabilities present:** The core weakness is an out-of-bounds write during the compilation process. The exact nature of the write is unknown but it occurs during the compilation of a block of code.

**Impact of exploitation:** The exploitation of this vulnerability leads to a crash due to the "UNKNOWN WRITE". This could potentially be leveraged for denial-of-service or, more severely, for arbitrary code execution if the memory corruption can be controlled by the attacker.

**Attack vectors:** The vulnerability is triggered during the compilation of a WASM file, meaning the attacker needs to provide a crafted WASM file that triggers the specific conditions within the compiler.

**Required attacker capabilities/position:** An attacker needs to provide a malicious WASM file as input to the vulnerable `wasm3` compiler to trigger the vulnerability. The attacker would need to be able to supply the crafted input to a system using the affected version of wasm3.

This information is more detailed than the initial CVE description placeholder.