```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is due to the insecure use of the `unserialize()` function in PHP when importing 'drag and drop into text' (ddwtos) quiz questions in Moodle's legacy XML format. The feedback answer within the XML is not sanitized before being passed to the `unserialize()` function, allowing for PHP Object Injection.",
    "weaknesses": [
      "Unsanitized input to `unserialize()` function",
      "PHP Object Injection vulnerability"
    ],
    "impact": "Successful exploitation allows an attacker to execute arbitrary operating system commands on the server, potentially leading to complete compromise of the Moodle instance and access to sensitive information.",
    "attack_vectors": [
      "Importing a specially crafted Moodle XML file containing a malicious PHP object chain"
    ],
    "required_capabilities": "The attacker needs permissions to create quizzes or import questions. This permission is typically granted to users with the 'teacher' role, but students can also be granted these permissions for specific courses."
  },
  "affected_versions": [
    "3.5 to 3.5.1",
    "3.4 to 3.4.4",
    "3.1 to 3.1.13",
    "earlier unsupported versions"
  ],
  "fixed_versions": [
    "3.5.2",
    "3.4.5",
    "3.3.8",
    "3.1.14"
  ],
  "poc": "The provided XML snippet shows a payload that injects a PHP object chain to execute the `whoami` command on the server.",
  "additional_notes": "The vulnerability was discovered by Johannes Moritz from SEC Consult Vulnerability Lab, with credits to Robin Peraglie from RIPS Technologies for further analysis. Moodle released patches for the vulnerability on 2018-09-10. A workaround involves disabling the import of ddwtos questions through XML files. The vulnerability is tracked as MDL-62880 in Moodle's issue tracker."
}
```