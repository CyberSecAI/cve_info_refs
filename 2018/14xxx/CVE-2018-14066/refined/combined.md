=== Content from hacked0x90.wordpress.com_cf8b2474_20250126_120543.html ===

# [HacKeD](https://hacked0x90.wordpress.com/ "HacKeD")

# Menu

[Skip to content](#content "Skip to content")

* [Home](https://hacked0x90.wordpress.com/)
* [About](https://hacked0x90.wordpress.com/about/)

# Lenovo & Infinix SQL Injection to Mobile SMS Leakage

[July 12, 2018July 16, 2018](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/ "Permalink to Lenovo & Infinix SQL Injection to Mobile SMS Leakage")[hacked0x90](https://hacked0x90.wordpress.com/author/hacked0x90/ "View all posts by hacked0x90")
[1 Comment](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comments)

I’m writing this article to show a critical and easy exploitable vulnerability which i found while playing with drozer framework.

drozer allows you to search for security vulnerabilities in apps and devices by assuming the role of an app with limited privileges and interacting with the Dalvik VM, other apps’ IPC endpoints and the underlying OS.

<https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf>

so let’s begin by mentioning the android version and model of tested device.

Model: Infinix X571

Android Version: 7 with latest security patches.

Model: Lenovo A7020

Android Version: 6 with latest security patches.

![About.jpg](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/about1.jpg?w=242&h=430)![About 2.png](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/about-21.png?w=241&h=428)

Note: After reporting the vulnerability it was discovered that other newer phones were also vulnerable.

so let’s get in to the technical staff, drozer consists of Two components an agent which is installed on the Mobile and it has no privileges and a console application which is on the attacking machine which is used to send commands to the drozer agent to make security assessment on Mobile devices and application.

drozer has a module which scans mobile packages for SQL injection in their sqlite. while i was playing with the scanneer to scan all the mobile packages, i found a vulnerability in an interesting package

**com.android.provider.telephony**

this package contains many sensitive information like Calls,contacts,SMS,…etc.

so what to do if you want to exploit a sql injection vulnerbility? first you search for vulnerable Content provider , also Drozer automatic sql injection scanner will do that for you

from the image you will find content://wappush content provider has a sql injection vulnerability![sqlinjection_wappush 2.png](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/sqlinjection_wappush-2.png?w=665)

looking in to accessible tables you will find SMS. and in order to exploit the vulnerability you can run the following command.

**run app.provider.query content://wappush –projection “\* from ‘SMS’ LIMIT 2”;–**

here we are breaking the query and selecting every thing from SMS table but limiting results by only first TWO.

![SMS Leak 1.jpg](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/sms-leak-1.jpg?w=1235&h=207)

and we can find SMS message with What’s APP activation code and a message from Vodafone as seen in screenshot.

So the main issue is that drozer application has only privilege on INTERNET so it’s not supposed to be able to access SMS messages(it doesn’t have READ\_SMS permission). which is a very great breach to user Privacy, imagine you install an application which has access on GPS and it can read your SMS without your Knowledge.

After reporting the Vulnerability Lenovo fixed the vulnerability in multiple affected phones, i couldn’t reach any security guy from infinix so i’m not able to follow up on the vulnerability but i reported it to support@infinix.com

Finally this vulnerability might affect much more vendors or devices as it seems an issue with custom ROM used by Chinese Phones vendor(MAYBE), but i just had access to these two phones so i were able to verify it exist.

CVE Assigned:  **CVE-2018-14066**.

the link shows vulnerability exploit by drozer

<https://youtu.be/f9ZWNvlEULw>

### Share this:

* [Twitter](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?share=twitter "Click to share on Twitter")
* [Facebook](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

[Uncategorized](https://hacked0x90.wordpress.com/category/uncategorized/)

# Post navigation

[← HG8245H Authentication Bypass](https://hacked0x90.wordpress.com/2017/11/30/hg8245h-authentication-bypass/) [CVE-2017-15123 Exploit →](https://hacked0x90.wordpress.com/2019/07/17/cve-2017-15123-exploit/)

## One thought on “Lenovo & Infinix SQL Injection to Mobile SMS Leakage”

1. ![](https://0.gravatar.com/avatar/f81c45bc59377a959b7da3df09df39646b2e1da703181d232d83cf43178a2986?s=48&d=identicon&r=G) **[Youssef A. Mohamed](http://linkedin.com/in/generaleg)** says:
   [July 16, 2018 at 10:27 am](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comment-25)

   Well done bro!

   [Like](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?like_comment=25&_wpnonce=29bfeb3d15)Like

   [Reply](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?replytocom=25#respond)

### Leave a comment [Cancel reply](/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#respond)

Δ

Search for:

# Archives

* [April 2020](https://hacked0x90.wordpress.com/2020/04/)
* [August 2019](https://hacked0x90.wordpress.com/2019/08/)
* [July 2019](https://hacked0x90.wordpress.com/2019/07/)
* [July 2018](https://hacked0x90.wordpress.com/2018/07/)
* [November 2017](https://hacked0x90.wordpress.com/2017/11/)
* [August 2017](https://hacked0x90.wordpress.com/2017/08/)
* [October 2016](https://hacked0x90.wordpress.com/2016/10/)
* [February 2015](https://hacked0x90.wordpress.com/2015/02/)
* [January 2015](https://hacked0x90.wordpress.com/2015/01/)

# Meta

* [Register](https://wordpress.com/start?ref=wplogin)
* [Log in](https://hacked0x90.wordpress.com/wp-login.php)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/246a14b4c310b4026bb6ece2d474c03de5aa95d93d75420a587d40b429eec7de?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) HacKeD](https://hacked0x90.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fhacked0x90.wordpress.com%2F2018%2F07%2F12%2Flenovo-infinix-sql-injection-to-mobile-sms-leakage%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/246a14b4c310b4026bb6ece2d474c03de5aa95d93d75420a587d40b429eec7de?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) HacKeD](https://hacked0x90.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fhacked0x90.wordpress.com%2F2018%2F07%2F12%2Flenovo-infinix-sql-injection-to-mobile-sms-leakage%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p5GNB2-bD)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/)
  + [View post in Reader](https://wordpress.com/read/blogs/84082108/posts/721)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from hacked0x90.wordpress.com_5279aebd_20250125_213050.html ===

# [HacKeD](https://hacked0x90.wordpress.com/ "HacKeD")

# Menu

[Skip to content](#content "Skip to content")

* [Home](https://hacked0x90.wordpress.com/)
* [About](https://hacked0x90.wordpress.com/about/)

# Lenovo & Infinix SQL Injection to Mobile SMS Leakage

[July 12, 2018July 16, 2018](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/ "Permalink to Lenovo & Infinix SQL Injection to Mobile SMS Leakage")[hacked0x90](https://hacked0x90.wordpress.com/author/hacked0x90/ "View all posts by hacked0x90")
[1 Comment](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comments)

I’m writing this article to show a critical and easy exploitable vulnerability which i found while playing with drozer framework.

drozer allows you to search for security vulnerabilities in apps and devices by assuming the role of an app with limited privileges and interacting with the Dalvik VM, other apps’ IPC endpoints and the underlying OS.

<https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf>

so let’s begin by mentioning the android version and model of tested device.

Model: Infinix X571

Android Version: 7 with latest security patches.

Model: Lenovo A7020

Android Version: 6 with latest security patches.

![About.jpg](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/about1.jpg?w=242&h=430)![About 2.png](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/about-21.png?w=241&h=428)

Note: After reporting the vulnerability it was discovered that other newer phones were also vulnerable.

so let’s get in to the technical staff, drozer consists of Two components an agent which is installed on the Mobile and it has no privileges and a console application which is on the attacking machine which is used to send commands to the drozer agent to make security assessment on Mobile devices and application.

drozer has a module which scans mobile packages for SQL injection in their sqlite. while i was playing with the scanneer to scan all the mobile packages, i found a vulnerability in an interesting package

**com.android.provider.telephony**

this package contains many sensitive information like Calls,contacts,SMS,…etc.

so what to do if you want to exploit a sql injection vulnerbility? first you search for vulnerable Content provider , also Drozer automatic sql injection scanner will do that for you

from the image you will find content://wappush content provider has a sql injection vulnerability![sqlinjection_wappush 2.png](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/sqlinjection_wappush-2.png?w=665)

looking in to accessible tables you will find SMS. and in order to exploit the vulnerability you can run the following command.

**run app.provider.query content://wappush –projection “\* from ‘SMS’ LIMIT 2”;–**

here we are breaking the query and selecting every thing from SMS table but limiting results by only first TWO.

![SMS Leak 1.jpg](https://hacked0x90.wordpress.com/wp-content/uploads/2018/07/sms-leak-1.jpg?w=1235&h=207)

and we can find SMS message with What’s APP activation code and a message from Vodafone as seen in screenshot.

So the main issue is that drozer application has only privilege on INTERNET so it’s not supposed to be able to access SMS messages(it doesn’t have READ\_SMS permission). which is a very great breach to user Privacy, imagine you install an application which has access on GPS and it can read your SMS without your Knowledge.

After reporting the Vulnerability Lenovo fixed the vulnerability in multiple affected phones, i couldn’t reach any security guy from infinix so i’m not able to follow up on the vulnerability but i reported it to support@infinix.com

Finally this vulnerability might affect much more vendors or devices as it seems an issue with custom ROM used by Chinese Phones vendor(MAYBE), but i just had access to these two phones so i were able to verify it exist.

CVE Assigned:  **CVE-2018-14066**.

the link shows vulnerability exploit by drozer

<https://youtu.be/f9ZWNvlEULw>

### Share this:

* [Twitter](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?share=twitter "Click to share on Twitter")
* [Facebook](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

[Uncategorized](https://hacked0x90.wordpress.com/category/uncategorized/)

# Post navigation

[← HG8245H Authentication Bypass](https://hacked0x90.wordpress.com/2017/11/30/hg8245h-authentication-bypass/) [CVE-2017-15123 Exploit →](https://hacked0x90.wordpress.com/2019/07/17/cve-2017-15123-exploit/)

## One thought on “Lenovo & Infinix SQL Injection to Mobile SMS Leakage”

1. ![](https://0.gravatar.com/avatar/f81c45bc59377a959b7da3df09df39646b2e1da703181d232d83cf43178a2986?s=48&d=identicon&r=G) **[Youssef A. Mohamed](http://linkedin.com/in/generaleg)** says:
   [July 16, 2018 at 10:27 am](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comment-25)

   Well done bro!

   [Like](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?like_comment=25&_wpnonce=29bfeb3d15)Like

   [Reply](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/?replytocom=25#respond)

### Leave a comment [Cancel reply](/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#respond)

Δ

Search for:

# Archives

* [April 2020](https://hacked0x90.wordpress.com/2020/04/)
* [August 2019](https://hacked0x90.wordpress.com/2019/08/)
* [July 2019](https://hacked0x90.wordpress.com/2019/07/)
* [July 2018](https://hacked0x90.wordpress.com/2018/07/)
* [November 2017](https://hacked0x90.wordpress.com/2017/11/)
* [August 2017](https://hacked0x90.wordpress.com/2017/08/)
* [October 2016](https://hacked0x90.wordpress.com/2016/10/)
* [February 2015](https://hacked0x90.wordpress.com/2015/02/)
* [January 2015](https://hacked0x90.wordpress.com/2015/01/)

# Meta

* [Register](https://wordpress.com/start?ref=wplogin)
* [Log in](https://hacked0x90.wordpress.com/wp-login.php)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/246a14b4c310b4026bb6ece2d474c03de5aa95d93d75420a587d40b429eec7de?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) HacKeD](https://hacked0x90.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fhacked0x90.wordpress.com%2F2018%2F07%2F12%2Flenovo-infinix-sql-injection-to-mobile-sms-leakage%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/246a14b4c310b4026bb6ece2d474c03de5aa95d93d75420a587d40b429eec7de?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) HacKeD](https://hacked0x90.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fhacked0x90.wordpress.com%2F2018%2F07%2F12%2Flenovo-infinix-sql-injection-to-mobile-sms-leakage%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p5GNB2-bD)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://hacked0x90.wordpress.com/2018/07/12/lenovo-infinix-sql-injection-to-mobile-sms-leakage/)
  + [View post in Reader](https://wordpress.com/read/blogs/84082108/posts/721)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


