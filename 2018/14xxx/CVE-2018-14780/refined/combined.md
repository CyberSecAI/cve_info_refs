=== Content from www.x41-dsec.de_72178f9f_20250126_083809.html ===

[![X41 D-Sec logotype](/assets/images/svg/logo.svg)](/)
![X41 D-Sec logotype](/assets/images/svg/hamburger.svg)

* [Company](/company/)
  + [Mission](/company/#company)
  + [Locations](/company/#locations)
* [News](/news/)
  + [ResearchBlog](/news/)
  + [Lab](/news/lab/)
* [PetâHMR](/pethmr/)
* [Services](/services/)
  + [Code Audit](/services/code-audit/)
  + [Red Teaming](/services/red-teaming/)
  + [Security Research](/services/security-research/)
  + [Penetration Testing](/services/penetration-testing/)
  + [Fuzzing](/services/fuzzing/)
  + [AppSec](/services/appsec/)
* [References](/references/)
* [Contact](/contact/)
* [Jobs](/jobs/)
* [FAQ](/faq/)

Find tomorrowâs vulnerabilities today!

[Read More](/company/)

![Background Image](/generated/assets/images/background/home-1-800-ffca20c13.jpg)

# NEWS

[December 17, 2024

Happy Holidays

Happy Holidays!](/security/job/news/2024/12/17/x41-happy-holidays/)
[December 16, 2024

X41 Audited Backstage

X41 finished auditing the Backstage platform and releases the resulting report.](/security/research/job/news/2024/12/16/backstage-review-2024/)
[December 11, 2024

X41 Reviewed Mullvad VPN

X41 releases the audit report of Mullvad VPN](/news/2024/12/11/mullvad/)
[Read More](/news)

![Background Image](/generated/assets/images/background/home-2-800-f282153cb.jpg)

# SERVICES

We help you handle vulnerabilities in products you use or develop. Beyond identifying individual vulnerabilities, X41 shows you how to improve your products and infrastructure in design and make it resilient even against future threats.

We take care of vendor contacts and work out the technical details with security researchers and developers to do vulnerability reporting.

Our process for finding vulnerabilities and getting them fixed is based on years of experience in uncovering vulnerabilities.

[Read More](/services/)

![Background Image](/generated/assets/images/background/home-3-800-177c5ba6f.jpg)

# PARTNERS

 [![RootSys](/static/images/rootsys.png)](https://www.rootsys.at/ "RootSys")  [![Open Source Technology Improvement Fund](/static/images/ostif.png)](https://ostif.org/ "Open Source Technology Improvement Fund")
# CUSTOMERS

 [![Aspera](/static/images/aspera.png)](https://www.usu.com/de-de/loesungen/usu-software-asset-management/#aspera "Aspera")  [![Avira](/static/images/avira.png)](https://www.avira.com/ "Avira")  [![Klinikum Darmstadt](/static/images/klinikum.png)](https://klinikum-darmstadt.de/ "Klinikum Darmstadt")  [![SoftBank Robotics](/static/images/softbank.png)](https://www.softbankrobotics.com/ "SoftBank Robotics")
## Public Audits

Some of our customers love transparency and publish the results of security audits together with X41. This helps them to show that they actually care about security and aim to improve the robustness of their software and lets the user base of these applications verify that security is not just an empty claim.

### 2024

[Source Code Audit of Backstage](/static/reports/X41-Backstage-Audit-2024-Final-Report-Public.pdf)

[Source Code Audit of Mullvad VPN](/static/reports/X41-Mullvad-Audit-Public-Report-2024-12-10.pdf)

[Source Code Audit of BIND9 for ISC](/static/reports/X41-ISC-BIND9-Code-Audit-Public-Report-2024-02-13.pdf)

### 2023

[Source Code Audit of libjpeg-turbo for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-OSTIF-libjpegturbo-Audit-20230712-Public.pdf)

[Source Code Audit of Go TUF for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-go-tuf-Audit-2023-Final-Report-PUBLIC.pdf)

[Source Code Audit of in-toto for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-in-toto-Audit-2023-Final-Report-PUBLIC.pdf)

[Source Code Audit of c-ares for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-c-ares-Code-Review-2023-OSTIF-Final-Public.pdf)

[Source Code Audit of libcap for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-libcap-Code-Review-2023-OSTIF-Final-Report.pdf)

[Source Code Audit of simplejson for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-OSTIF-simplejson-CodeRview-2023-04-18.pdf)

### 2022

[Source Code Audit of Git for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-OSTIF-Gitlab-Git-Security-Audit-20230117-public.pdf)

[Source Code Audit of The Update Framework for the Open Source Technology Improvement Fund (OSTIF)](/static/reports/X41-TUF-Audit-2022-Final-Report-PUBLIC.pdf)

[Penetration Test on Backstage for the Backstage team](/static/reports/X41-Backstage-Audit-2022-Final-Report-PUBLIC.pdf)

### 2021

[Source Code Review of Selected Options Vault Contracts for Thetanuts.Finance](/static/reports/X41-Audit-Thetanuts-2021-11-Public-Report.pdf)

### 2019

[Unbound DNS Server](/static/reports/X41-Unbound-Security-Audit-2019-Final-Report-Public.pdf)

[Monero RandomX](/static/reports/X41-RandomX-Audit-2019-Final-Report-Public.pdf)

### 2018

[Mozilla Balrog](/static/reports/X41-Balrog-Review-2018-Final-Report-Public.pdf)

[theQRL](https://raw.githubusercontent.com/theQRL/audits/master/X41-theQRL-Review-2018-Final-Report.pdf)

[Wire Secure Messenger (Android)](/static/reports/X41-Kudelski-Wire-Security-Review-Android.pdf)

[Wire Secure Messenger (Web - Calling)](/static/reports/X41-Kudelski-Wire-Security-Review-Web-Calling.pdf)

[Wire Secure Messenger (iOS)](/static/reports/X41-Kudelski-Wire-Security-Review-iOS.pdf)

### 2017

[Wire Secure Messenger (Proteus)](/static/reports/Kudelski-X41-Wire-Report-phase1-20170208.pdf)

## Whitepaper

Custom security research and analysis of attack surface and technical mitigations enables our customers to go beyond the constant cycle of finding security issues in their software or infrastructure.

One such example is the [Browser Whitepaper](https://browser-security.x41-dsec.de/X41-Browser-Security-White-Paper.pdf) that X41 created for Google. X41 covers the differences in security design, implementation and user interface of the Google Chrome, Microsoft Edge and Internet Explorer browsers.

[Read More](/references/)

CONTACT
X41 D-Sec GmbH
Soerser Weg 20
52070 Aachen

+49 (0) 241 9809418-0
+49 (0) 241 9809418-9
info@x41-dsec.de

[PGP Key](/static/pgp/0x6746CF4698A7AB6Epub.asc.txt)

Connect
[Github
![X41 Github](/assets/images/svg/github.svg)](https://github.com/x41sec "X41 Github")
[Mastodon
![X41 Mastodon](/assets/images/svg/mastodon.svg)](https://infosec.exchange/%40x41sec "X41 Mastodon")
[Twitter
![X41 Twitter](/assets/images/svg/twitter.svg)](https://twitter.com/X41Sec "X41 Twitter")
[LinkedIn
![X41 LinkedIn](/assets/images/svg/linkedin.svg)](https://de.linkedin.com/company/x41 "X41 LinkedIn")

[FAQ](/faq/)
[Partners](/references/)
[Terms of Use](/terms/)
[Privacy](/privacy/)
[Imprint](/imprint/)



=== Content from www.x41-dsec.de_8581033d_20250125_124416.html ===

[![X41 D-Sec logotype](/assets/images/svg/logo.svg)](/)
![X41 D-Sec logotype](/assets/images/svg/hamburger.svg)

* [Company](/company/)
  + [Mission](/company/#company)
  + [Locations](/company/#locations)
* [News](/news/)
  + [ResearchBlog](/news/)
  + [Lab](/news/lab/)
* [PetâHMR](/pethmr/)
* [Services](/services/)
  + [Code Audit](/services/code-audit/)
  + [Red Teaming](/services/red-teaming/)
  + [Security Research](/services/security-research/)
  + [Penetration Testing](/services/penetration-testing/)
  + [Fuzzing](/services/fuzzing/)
  + [AppSec](/services/appsec/)
* [References](/references/)
* [Contact](/contact/)
* [Jobs](/jobs/)
* [FAQ](/faq/)

# NEWS

X41 D-Sec GmbH Security Advisory: X41-2018-001

# Multiple Vulnerabilities in Yubico Piv

## Overview

**Confirmed Affected Versions:** 1.5.0

**Confirmed Patched Versions:** -

**Vendor:** Yubico

**Vendor URL:** https://www.yubico.com/

**Credit:** X41 D-Sec GmbH, Eric Sesterhenn

**Status:** Public

**Advisory-URL:** https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/

## Summary and Impact

A buffer overflow and an out of bounds memory read were identified in the yubico-piv-tool-1.5.0, these can be triggered by a malicious token.

X41 did not perform a full test or audit of the software.

## Product Description

YubiKey 4, YubiKey 4 Nano, YubiKey 4C, YubiKey 4C Nano, and YubiKey NEO provide Smart Card functionality based on the Personal Identity Verification (PIV) interface specified in NIST SP 800-73, âCryptographic Algorithms and Key Sizes for PIV.â

# Out of Bounds Write via Malicious APDU

**Severity Rating:** High

**Vector:** APDU Response

**CVE:** CVE-2018-14779

**CWE:** 120

**CVSS Score:** 7.1 (High)

**CVSS Vector:** CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

## Summary and Impact

File lib/ykpiv.c contains the following code in function `ykpiv_transfer_data()`

```
    if(*out_len + recv_len - 2 > max_out) {
      fprintf(stderr, "Output buffer to small, wanted to write %lu, max was %lu.", *out_len + recv_len - 2, max_out);
    }
    if(out_data) {
      memcpy(out_data, data, recv_len - 2);
      out_data += recv_len - 2;
      *out_len += recv_len - 2;
    }
```

It is clearly checked whether the buffer is big enough to hold the data copied using `memcpy()`, but no error handling happens to avoid the `memcpy()` in such cases. This code path can be triggered with malicious data coming from a smartcard.

## Workarounds

None

# Out of Bounds Read via malicious APDU

**Severity Rating:** LOW

**Vector:** APDU Response

**CVE:** CVE-2018-14780

**CWE:** 125

**CVSS Score:** 2.2 (Low)

**CVSS Vector:** CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

## Summary and Impact

File lib/ykpiv.c contains the following code in function `_ykpiv_fetch_object()`

```
if(sw == SW_SUCCESS) {
  size_t outlen;
  int offs = _ykpiv_get_length(data + 1, &outlen);
  if(offs == 0) {
    return YKPIV_SIZE_ERROR;
  }
  memmove(data, data + 1 + offs, outlen);
  *len = outlen;
  return YKPIV_OK;
} else {
  return YKPIV_GENERIC_ERROR;
}
```

In the end, a `memmove()` occurs with a length retrieved from APDU data. This length is not checked if it is outside of the APDU data retrieved. Therefore the `memmove()` could copy bytes behind the allocated data buffer into this buffer.

## Workarounds

None

# Timeline

**2018-02-03** Issues found

**2018-05-22** Vendor contacted

**2018-05-22** Vendor reply

**2018-06-05** Requesting technical feedback from the vendor

**2018-06-06** Vendor confirms bug

**2018-08-01** CVE ID requested

**2018-08-02** CVE ID assigned

**2018-08-08** Patched version released by vendor

Author:
Eric Sesterhenn

Date: February 03, 2018

«
[X41 At Conferences](/news/security/2018/01/30/conferences/)

[Advisory X41-2018-002: Multiple Vulnerabilities in OpenSC](/lab/advisories/x41-2018-002-OpenSC/)
»

CONTACT
X41 D-Sec GmbH
Soerser Weg 20
52070 Aachen

+49 (0) 241 9809418-0
+49 (0) 241 9809418-9
info@x41-dsec.de

[PGP Key](/static/pgp/0x6746CF4698A7AB6Epub.asc.txt)

Connect
[Github
![X41 Github](/assets/images/svg/github.svg)](https://github.com/x41sec "X41 Github")
[Mastodon
![X41 Mastodon](/assets/images/svg/mastodon.svg)](https://infosec.exchange/%40x41sec "X41 Mastodon")
[Twitter
![X41 Twitter](/assets/images/svg/twitter.svg)](https://twitter.com/X41Sec "X41 Twitter")
[LinkedIn
![X41 LinkedIn](/assets/images/svg/linkedin.svg)](https://de.linkedin.com/company/x41 "X41 LinkedIn")

[FAQ](/faq/)
[Partners](/references/)
[Terms of Use](/terms/)
[Privacy](/privacy/)
[Imprint](/imprint/)



=== Content from www.yubico.com_7114399b_20250125_124417.html ===


[Skip to content](#wp--skip-link--target)
EnglishFrançaisDeutsch日本語EspañolSvenska

* [Contact Sales](/contact-us/)
* [Resellers](/support/resellers/)
* [Support](https://support.yubico.com/hc/en-us/)

menu![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[![Yubico Header Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)
Why Yubicoexpand\_more
[Why Yubico](https://www.yubico.com/why-yubico/)
How we help

* [Enterprises](https://www.yubico.com/why-yubico/for-business/)
* [SMBs](https://www.yubico.com/why-yubico/yubico-and-smbs/)
* [Individuals](https://www.yubico.com/why-yubico/for-individuals/)
* [Developers](https://www.yubico.com/why-yubico/for-developers/)

Work with us

* [Careers](https://www.yubico.com/careers/)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Connect & learn

* [Contact Sales](https://www.yubico.com/contact-us/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](/why-yubico/about-us/)
* [The team](/why-yubico/team/)
* [Investors](https://investors.yubico.com/)
* [Innovation history](https://www.yubico.com/why-yubico/yubico-innovation-history/)
* [Secure it Forward](https://www.yubico.com/why-yubico/secure-it-forward/)

![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-easy-to-use-1.jpg)Easy-to-use, secure authenticationWith YubiKey there’s no tradeoff between great security and usabilityWhy YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-google-1.jpg)Proven at scale at GoogleGoogle defends against account takeovers and reduces IT costsGoogle Case Studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)Protecting vulnerable organizationsSecure it Forward: Yubico matches up to 5% of the number of YubiKeys purchased on Yubico.comSecure it Forwardsecurity-advisory
Productsexpand\_more
[All products](/products/)
Hardware

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

Services

* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)
* [YubiEnterprise Delivery](https://www.yubico.com/products/yubienterprise-delivery/)
* [Yubico Enrollment Suite](https://www.yubico.com/products/yubicoenrollmentsuite/)
* [YubiCloud](https://www.yubico.com/products/yubicloud/)

Software and tools

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)
* [Computer login tools](https://www.yubico.com/products/computer-login-tools/)
* [Software Development Toolkits](https://www.yubico.com/products/software-development-toolkits-sdks/)

Discover the YubiKey

* [Using YubiKey is easy](https://www.yubico.com/products/ease-of-use/)
* [Find the right YubiKey](/quiz/)
* [Works with YubiKey](/works-with-yubikey/catalog/)
* [Compare YubiKeys](https://www.yubico.com/store/compare/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-hundreds-services-nav-3-1.jpg)One key for hundreds of apps and servicesYubiKey works out-of-the-box and has no client software or batteryYubico protects yousecurity-advisory
![See YubiKeys as a Service](https://www.yubico.com/wp-content/uploads/2023/03/img-YubiEnterprise-nav-3-1.jpg)YubiKey as a Service delivers scale and savingsGain a future-proofed solution and faster MFA rolloutsYubiKey as a Servicesecurity-advisory
Solutionsexpand\_more
[Solutions overview](/solutions/)
Initiatives

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Executive Order OMB M-22-09](https://www.yubico.com/solutions/executive-order-hub/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Compliance](https://www.yubico.com/solutions/cybersecurity-compliance/)
* [Cyber Insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [Critical infrastructure](https://www.yubico.com/solutions/critical-infrastructure-security/)
* [Secure supply chain](/solutions/supply-chain-security/)
* [Protect call centers](https://www.yubico.com/solutions/call-centers/)

Use cases

* [Hybrid & remote workers](/solutions/secure-hybrid-and-remote-workers/)
* [Secure privileged users](https://www.yubico.com/solutions/privileged-users/)
* [Mobile restricted environments](https://www.yubico.com/solutions/mobile-restricted-environment/)
* [Shared workstations](https://www.yubico.com/solutions/shared-workstations/)

Technologies

* [Microsoft ecosystem](https://www.yubico.com/solutions/microsoft-365-mfa/)
* [Salesforce workspace](https://www.yubico.com/solutions/yubico-and-salesforce/)
* [IAM solutions](https://www.yubico.com/solutions/identity-access-management/)
* [AWS environment](https://www.yubico.com/solutions/yubico-and-amazon-web-services/)
* [HYPR experience](https://www.yubico.com/solutions/hypr-and-yubico/)
* [Okta identity solutions](https://www.yubico.com/solutions/okta-and-yubico/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)The Bridge to PasswordlessBegin the journey to make your organization passwordless Get the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-zero-trust-nav-3.jpg)Accelerate your Zero Trust Strategy7 best authentication practices to jumpstart your Zero Trust programGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-federal-nav-3.jpg)Federal cybersecurity requirements Guidance for leaders to prepare for the modern cyber threat eraGet the white papersecurity-advisory
Industriesexpand\_more
[Industries overview](https://www.yubico.com/industries/)
Industries

* [High tech](https://www.yubico.com/industries/technology/)
* [Federal government](https://www.yubico.com/industries/federal/)
* [Department of Defense](https://www.yubico.com/industries/us-department-of-defense/)
* [Federal systems integrators](https://www.yubico.com/industries/federal-systems-integrators/)
* [State & local government](https://www.yubico.com/industries/state-local-government/)
* [Education](https://www.yubico.com/industries/education/)
* [Financial services](https://www.yubico.com/industries/finance/)

* [Retail & hospitality](https://www.yubico.com/industries/retail-and-hospitality/)
* [Telecommunications](/industries/telecommunications/)
* [Healthcare](https://www.yubico.com/industries/healthcare/)
* [Pharmaceuticals](https://www.yubico.com/industries/pharmaceuticals/)
* [Cryptocurrency](https://www.yubico.com/industries/cryptocurrency/)
* [Energy & natural resources](https://www.yubico.com/industries/energy-and-natural-resources/)
* [Manufacturing](https://www.yubico.com/industries/manufacturing/)
* [Elections & campaigns](https://www.yubico.com/industries/political-campaigns/)
* [Insurance organizations](https://www.yubico.com/industries/phishing-resistant-mfa-and-passwordless-for-insurance-organizations/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-mfg-nav.jpg)Manufacturing and supply chain security Authentication best practices for manufacturingGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-phishing-nav.jpg)Phishing-resistant MFA: Fact vs. FictionMeet requirements for phishing-resistant MFA in OMB M-22-09 guidelinesGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-nat-resources-nav.jpg)Secure energy and natural resources from cyber threats Best practices for phishing-resistant MFA to protect infrastructureGet the white papersecurity-advisory
Resourcesexpand\_more
[All resources](/resources/)
Learn

* [Yubico Blog](https://www.yubico.com/blog/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Developer program](https://developers.yubico.com/)
* [Product briefs](https://www.yubico.com/resource_categories/product-briefs/)
* [Solution briefs](https://www.yubico.com/resource_categories/solution-briefs/)
* [Passkeys](https://www.yubico.com/passkeys/)

Best practices

* [Case studies](https://www.yubico.com/resources/reference-customers/)
* [Get a pilot started](https://www.yubico.com/resources/getting-started/)
* [White papers and reports](https://www.yubico.com/resource_categories/white-papers/)
* [Webinars](https://www.yubico.com/resource_categories/webinars/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-beyondTrust-nav.jpg)BeyondTrust: secured with a subscriptionPrivileged Access Management leader simplifies deploymentSee case studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/04/DCT-608-Navigation-promotional-image-for-451-webinar-390x216-1.jpg)S&P Global Market Intelligence report: old habits die hardOnly 46% of orgs protect their applications with MFA. How about yours?Read the reportsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/08/img-Ebook-nav.jpg)Considering Passkeys for your Enterprise?Learn how to avoid common passkey pitfallsVisit Passkey Hubsecurity-advisory
Supportexpand\_more
 [Support home](https://support.yubico.com/hc/en-us)
Get started

* [Find the right YubiKey](/quiz/)
* [Set up your YubiKey](/setup/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support articles](https://support.yubico.com/hc/en-us/)

Services

* [Support Services](https://www.yubico.com/support/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)

Additional resources

* [Works with YubiKey Program](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular)
* [Buying and shipping information](https://www.yubico.com/support/shipping-and-buying-information/)
* [Security advisories](https://www.yubico.com/support/security-advisories/)
* [Help center](https://support.yubico.com/hc/en-us/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-setup-nav-3.jpg)How to set up your YubiKeyFollow our guided tutorials to start protecting your servicesSet up your YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-find-nav-3.jpg)Find the best YubiKey for your needsTake the guided quiz and see which YubiKeys fit your needsTake the quizsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-accelerate-nav-3.jpg)Accelerate your YubiKey deploymentTechnical and operational guidance for your YubiKey rolloutProfessional Servicessecurity-advisory
Search![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[Subscribe](/products/yubienterprise-subscription/)[Store](/store/)

* # ****Security advisory YSA-2018-03****

  ## Security advisory 2018-08-03 – unchecked buffer in libykpiv

  Published date: **2018-08-08**

  Tracking IDs: **YSA-2018-03**

  CVE: **CVE-2018-14779, CVE-2018-14780**

  ### Summary

  Eric Sesterhenn of [X41 D-Sec](https://www.x41-dsec.de/) notified Yubico of a security issue in libykpiv, a supporting library of the Yubico PIV Tool, YubiKey PIV Manager, and Yubikey Smart Card Minidriver. This issue can allow an attacker with a custom made malicious USB device masquerading as a YubiKey, and physical access to a computer where the Yubico PIV Tool, YubiKey PIV Manager, or YubiKey Smart Card Minidriver is running, to potentially execute arbitrary code on that computer.

  It is not possible to perform this attack with a genuine YubiKey, however, we recommend updating all necessary software included below.

  ### Customer actions

  Yubico recommends that customers using affected versions of the tools update to the latest versions of each (see How to Tell if You Are Affected below). [Libykpiv](https://github.com/Yubico/yubico-piv-tool/) version 1.6.0 addresses the issue. [Libykpiv](https://github.com/Yubico/yubico-piv-tool/) is included in the command line [Yubico PIV Tool](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/), the GUI [YubiKey PIV Manager](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/), and the YubiKey [Smart Card Minidriver](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/). Versions that address this problem are now available.

  We also advise customers continue to exercise caution when utilizing any USB device of unknown origin.

  ### Issue details

  The Libykpiv library prior to version 1.6.0 contains an unchecked buffer, which could allow a buffer overflow. An attacker could use this to attempt to execute malicious code using a specifically crafted USB device masquerading as a YubiKey on a computer where the affected library is currently in use. It is not possible to perform this attack with a genuine YubiKey. In the case of Yubico PIV Tool and YubiKey PIV Manager, malicious code would execute with the same privileges as the user who runs the library. For affected versions of the YubiKey Smart Card Minidriver, malicious code would execute with System level privileges.

  ### How to tell if you are affected

  If you are using a tool that includes a libykpiv version older than 1.6.0, you are affected and should upgrade the tool. Libykpiv is included in the Yubico PIV Tool, the YubiKey PIV Manager, and the YubiKey Smart Card Minidriver for Windows.

  #### Yubico PIV Tool

  If you have only installed the command line PIV tool you can verify the version with the  following command:

  *$ yubico-piv-tool –version*

  ![command line for piv tool](https://www.yubico.com/wp-content/uploads/2020/10/yubico-piv-tool-screenshot-1024x678.png)

  If the version is lower than 1.6.0 you should update ([Yubico PIV Tool](https://developers.yubico.com/yubico-piv-tool/Releases/)).

  #### **Yubico PIV Manager**

  If you are using the PIV Manager GUI tool, the version of the tool can be found by clicking the Help menu in the upper left corner, then selecting About.

  ![PIV Manager GUI tool help settings](https://www.yubico.com/wp-content/uploads/2020/10/yubikey-piv-manager-1-1024x431.png)
  ![about yubikey PIV manager](https://www.yubico.com/wp-content/uploads/2020/10/yubikey-piv-manager-2.png)

  If **Library versions**ykpiv is less than 1.6.0 you should update to YubiKey PIV Manager version 1.4.2f ([YubiKey PIV Manager](https://developers.yubico.com/yubikey-piv-manager/Releases/)).

  #### **Yubikey Smart Card Minidriver (Windows Only)**

  If you are using the YubiKey Smart Card Minidriver:

  1. Open the Windows Device Manager (Start->Run->devmgmt.msc)

  2. From the device tree, select “Smart Cards”.  If this item isn’t present, you may have to select “Show Hidden Devices” from the View menu.

  ![YubiKey Smart Card Minidriver in Windows Device Manager](https://www.yubico.com/wp-content/uploads/2020/10/yubikey-smart-card-minidriver-1-982x1024.png)

  3. Double click on “YubiKey Smart Card Minidriver” and select the Driver tab

  ![YubiKey smart card minidriver properties](https://www.yubico.com/wp-content/uploads/2020/10/yubikey-smart-card-minidriver-2-898x1024.png)

  4. Observe the “Driver Version” field.  If it is less than 3.7.3.160 you are affected. ([YubiKey Smart Card Minidriver](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/))

  ### Downloads

  Download the latest version of Yubico PIV Tool [here](/products/services-software/download/smart-card-drivers-tools/).

  Download the latest version of the YubiKey PIV Manager [here](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/).

  Download the latest version of the YubiKey Smart Card Minidriver [here](https://www.yubico.com/products/services-software/download/smart-card-drivers-tools/).

  **Please note:** the YubiKey Smart Card Minidriver is still undergoing Microsoft driver certification testing. The latest version available on 2018-08-08 is updated and signed by Yubico AB, but not yet signed by Microsoft. We will update this advisory when the Microsoft driver certification testing is complete and signed drivers are available.

  ### Severity

  Yubico has rated this issue as Moderate. For installations with only the PIV Tool or the PIV Manager, the base CVSS v3 score of 2.0. For installations with the Minidriver, the base CVSS score is 6.4.

  ### Timeline

  | 2018/05/22 | Eric Sesterhenn, from [X41 D-Sec](https://www.x41-dsec.de/), informs Yubico of the issues and request an embargo until 2018-08-08. |
  | --- | --- |
  | 2018/08/08 | Yubico releases advisory YSA-2018-03 and updates to libykpiv / Yubico PIV Tool / YubiKey PIV Manager / Yubikey Smart Card Minidriver. |

[![Yubico Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)

* [RSS Feed](https://www.yubico.com/feed/)
* [X](https://x.com/Yubico)
* [LinkedIn](https://www.linkedin.com/company/Yubico)
* [Facebook](https://www.facebook.com/Yubikey)
* [Instagram](https://www.instagram.com/Yubico)
* [YouTube](https://www.youtube.com/c/Yubico)
* [GitHub](https://www.github.com/Yubico)

Find

* [Product finder quiz](/quiz/)

Set up

* [Find set-up guides](/setup/)

Buy

* [Buy online](/store)
* [Contact sales](/contact-us/)

Sign up

* [Get Yubico updates](https://www.yubico.com/email-subscription/)

Why Yubico

* [Careers](https://www.yubico.com/careers/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](https://www.yubico.com/why-yubico/about-us/)
* [Investors](https://investors.yubico.com)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Products

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](https://www.yubico.com/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)

Solutions

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Cyber insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [More solutions](https://www.yubico.com/solutions/)

Industries

* [Industries overview](https://www.yubico.com/industries/)

Resources

* [Yubico blog](https://www.yubico.com/blog/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Developer program](https://developers.yubico.com/)

Support

* [Works with YubiKey](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular/)
* [Help center](https://support.yubico.com/hc/en-us/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support Services](https://www.yubico.com/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [Contact support](https://support.yubico.com/hc/en-us/requests/new/)

EnglishFrançaisDeutsch日本語EspañolSvenska
 Yubico © 2025 All Rights Reserved.

* [Sitemap](/sitemap_index.xml)
* [Cookies](/support/terms-conditions/cookie-notice/)
* [Legal](/support/terms-conditions/)
* [Privacy](/support/terms-conditions/privacy-notice/)
* [Patents](https://www.yubico.com/why-yubico/patents/)
* [Terms of use](/support/terms-conditions/yubico-website-terms-conditions/)
* [Trust](/trust/)



=== Content from lists.ubuntu.com_be8ed54b_20250126_083809.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from usn.ubuntu.com_6b7c402e_20250125_124416.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4276-1: Yubico PIV Tool vulnerabilities

11 February 2020

Yubico PIV Tool could be made to crash or run programs as an administrator if it received specially crafted input.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [yubico-piv-tool](/security/cves?package=yubico-piv-tool) - Command line tool for the YubiKey PIV applet

## Details

It was discovered that libykpiv, a supporting library of the Yubico PIV

Tool and YubiKey PIV Manager, mishandled specially crafted input. An

attacker with a custom-made, malicious USB device could potentially execute

arbitrary code on a computer running the Yubico PIV Tool or Yubikey PIV

Manager.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [libykpiv1](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool)
  -
  [1.4.2-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool/1.4.2-2ubuntu0.1)
* [ykcs11](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool)
  -
  [1.4.2-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool/1.4.2-2ubuntu0.1)
* [yubico-piv-tool](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool)
  -
  [1.4.2-2ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/yubico-piv-tool/1.4.2-2ubuntu0.1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

## References

* [CVE-2018-14779](/security/CVE-2018-14779)
* [CVE-2018-14780](/security/CVE-2018-14780)

## Related notices

* [USN-4846-1](/security/notices/USN-4846-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.openwall.com_472214bb_20250125_124414.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ce2131c4-be44-4426-d290-b3811657a5f7@x41-dsec.de>
Date: Tue, 14 Aug 2018 15:37:20 +0200
From: X41 D-Sec GmbH Advisories <advisories@...-dsec.de>
To: oss-security@...ts.openwall.com
Subject: X41 D-Sec GmbH Security Advisory X41-2018-001: Multiple
 Vulnerabilities in Yubico Piv

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

X41 D-Sec GmbH Security Advisory: X41-2018-001

Multiple Vulnerabilities in Yubico Piv
======================================

Overview
- --------
Confirmed Affected Versions: 1.5.0
Confirmed Patched Versions: 1.6.0
Vendor: Yubico
Vendor URL: <https://www.yubico.com/>
Vendor Advisory URL: <https://www.yubico.com/support/security-advisories>
Credit: X41 D-Sec GmbH, Eric Sesterhenn
Status: Public
Advisory-URL:
<https://www.x41-dsec.de/lab/advisories/x41-2018-001-Yubico-Piv/>

Summary and Impact
- ------------------
A buffer overflow and an out of bounds memory read were identified in
the yubico-piv-tool-1.5.0, these can be triggered by a malicious token.
X41 did not perform a full test or audit on the software.

Product Description
- -------------------
YubiKey 4, YubiKey 4 Nano, YubiKey 4C, YubiKey 4C Nano, and YubiKey
NEO provide Smart Card functionality based on the Personal Identity
Verification (PIV) interface specified in NIST SP 800-73,
“Cryptographic Algorithms and Key Sizes for PIV.”

Out of Bounds Write via Malicious APDU
======================================
Severity Rating: High
Vector: APDU Response
CVE: CVE-2018-14779
CWE: 120
CVSS Score: 7.1 (High)
CVSS Vector: CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

Summary and Impact
- ------------------
File lib/ykpiv.c contains the following code in function
ykpiv_transfer_data()

{% highlight c %}
    if(*outlen + recvlen - 2 > maxout) {
      fprintf(stderr, "Output buffer to small, wanted to write %lu,
max was %lu.", *outlen + recvlen - 2, maxout);
    }
    if(outdata) {
      memcpy(outdata, data, recvlen - 2);
      outdata += recvlen - 2;
      *outlen += recv_len - 2;
    }
{% endhighlight %}

It is clearly checked whether the buffer is big enough to hold the
data copied using memcpy(), but no error handling happens to avoid the
memcpy() in such cases. This code path can be triggered with malicious
data coming from a smartcard.

Workarounds
- -----------
None

Out of Bounds Read via malicious APDU
=====================================
Severity Rating: LOW
Vector: APDU Response
CVE: CVE-2018-14780
CWE: 125
CVSS Score: 2.2 (Low)
CVSS Vector: CVSS:3.0/AV:P/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N

Summary and Impact
- ------------------
File lib/ykpiv.c contains the following code in function
_ykpiv_fetch_object()

{% highlight c %}
if(sw == SWSUCCESS) {
  sizet outlen;
  int offs = ykpivgetlength(data + 1, &outlen);
  if(offs == 0) {
    return YKPIVSIZEERROR;
  }
  memmove(data, data + 1 + offs, outlen);
  *len = outlen;
  return YKPIVOK;
} else {
  return YKPIVGENERICERROR;
}
{% endhighlight %}

In the end, a memmove() occurs with a length retrieved from APDU data.
This length is not checked if it is outside of the APDU data
retrieved. Therefore the memmove() could copy bytes behind the
allocated data buffer into this buffer.

Workarounds
- -----------
None

Timeline
========
2018-02-03 Issues found
2018-05-22 Vendor contacted
2018-05-22 Vendor reply
2018-06-05 Requesting technical feedback from the vendor
2018-06-06 Vendor confirms bug
2018-08-01 CVE ID requested
2018-08-02 CVE ID assigned
2018-08-08 Patched version released by vendor
2018-08-11 Advisory released
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEpwxVTgxAIcUvTugIo5Klpg50CxAFAlty2wYACgkQo5Klpg50
CxBY3Q//Y4ux5/9kpM3ZCGXU7hpjC0nTOKNJY/W4dIKtA14OCc+hLf1tPhOCB170
oimZRyXD6HR4OPGnbpgKAoLbWFBAt6fjwYweKGb2I1qnLsGLt/t9ussY5ElbFHqQ
FGzbQcgp1DcwCI3EWj+AjwQPBzjNvGTqgizq3rbc6coKsbnzeXR1UUWjQb7PFgAW
+O6S74dIaP+J/OwMPye/JkAkAAPiPGfpFp5xFC60d2KZIAdSiK6xg+Ip8i9gYLnQ
6WCagyQe2X8YmeFSvSvx3pAAiUMW8bdgt39j2EuKZLRScyotH6/1ixjC2gm8WY0u
6vlSmFVP/HyRB0u4JKMgY3KkS0CCZhhpPMjK38CctsPN+jt6KcPf2+TEkQK/m6ts
IeU8+XSWGigNFALCJJoIPplXi+/XCs+qzNmq2pRvrNt2rd/7cu3+AxnivxX/9ZUt
pei7+530GWumFXvgBjFlL4GCSKzJDWRM3gfXZK1UPqAIiG1J+MJ2F8Pijui3maq7
/N04sTRGZaTcKT22hgZ9ePrCSOAGqPof1+UUMFjDjTCCDZ2BI9GmsQHkjvFzfKQc
8dBZzzyopo9sD/CloLA3EATH7KdhyCfDKq/oRma5ZhVWgfMGJmlAzLmJXMTiIwwH
SgU/sj8ArM37EYzpO+eqtnaJum9o5GE5p/EkwG1J3N4BeAag9mE=
=wcuQ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


