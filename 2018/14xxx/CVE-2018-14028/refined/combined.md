=== Content from rastating.github.io_12556bbf_20250125_174419.html ===

[![](/assets/images/avatar.jpg)](/)
# [rastating.github.io](/)

# Unrestricted File Upload via Plugin Uploader in WordPress

August 4, 2018

On 11th July, 2018, a pull request was opened on the [WordPress Exploit Framework GitHub Page](https://github.com/rastating/wordpress-exploit-framework/pull/52) to add a new feature that a user ([Vinicius Marangoni](https://github.com/viniciusmarangoni)) had created whilst completing a boot2root machine from VulnHub.

The scenario encountered by the user was that the plugins directory did not have write permissions, preventing them from using the [Admin Shell Upload Module](https://github.com/rastating/wordpress-exploit-framework/blob/development/lib/wpxf/modules/exploit/shell/admin_shell_upload.rb). This led to the discovery that if they were to upload PHP files instead of ZIP files in the plugin uploader - WordPress would accept the files, and then leave a copy in the uploads directory after it failed to process it as a ZIP - leaving a PHP file to be executed.

As he did not realise this was a flaw within the core code, I quickly raised the issue with WordPress and contacted the original discoverer to let them know that they had stumbled upon a bug which needs to be patched.

After a bit of chasing, WordPress responded, but unfortunately did not deem the issue to be within the scope of WordPress and felt that the security issues posed by this were due to server configuration.

I put forward (and still maintain) that this needs to be patched as it is not uncommon to see people revoke write permissions on the `wp-content/plugins` directory, in order to prevent plugins being uploaded. By not validating file types, and not cleaning up after failed uploads, it can allow the compromise of an administrator account to escalate into a compromise of the web server user account via remote code execution.

Despite the disagreement on whether the security issue imposed by this is the responsibility of WordPress to mitigate - there was a mutual agreement that it’s something that should be fixed on a functional level. Alongside the closure of the report, an issue was raised on [Trac](https://core.trac.wordpress.org/ticket/44710) to remedy the issue.

## CVE-ID

[CVE-2018-14028](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14028)

## Versions Affected

All versions as of 4th August, 2018

## Timeline

* **2018-07-11**: Initial discovery and report to vendor
* **2018-07-24**: Request update due to no acknowledgement from vendor
* **2018-08-02**: Initial response from vendor
* **2018-08-03**: Report closed by vendor as non-urgent / out of scope
* **2018-08-04**: Public disclosure of issue

## References

* [GitHub: upload non-encapsulated payload when zip installation fails #52](https://github.com/rastating/wordpress-exploit-framework/pull/52)
* [Trac: Upload plugin and theme functionalities are not removing uploaded files after failure conditions.](https://core.trac.wordpress.org/ticket/44710)

[#wordpress](/tags#wordpress)
[#CVE-2018-14028](/tags#CVE-2018-14028)

---



=== Content from github.com_72eca678_20250125_174418.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frastating%2Fwordpress-exploit-framework%2Fpull%2F52)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frastating%2Fwordpress-exploit-framework%2Fpull%2F52)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rastating%2Fwordpress-exploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 22, 2020. It is now read-only.

[rastating](/rastating)
/
**[wordpress-exploit-framework](/rastating/wordpress-exploit-framework)**
Public archive

* [Notifications](/login?return_to=%2Frastating%2Fwordpress-exploit-framework) You must be signed in to change notification settings
* [Fork
  262](/login?return_to=%2Frastating%2Fwordpress-exploit-framework)
* [Star
   1k](/login?return_to=%2Frastating%2Fwordpress-exploit-framework)

* [Code](/rastating/wordpress-exploit-framework)
* [Issues
  1](/rastating/wordpress-exploit-framework/issues)
* [Pull requests
  0](/rastating/wordpress-exploit-framework/pulls)
* [Actions](/rastating/wordpress-exploit-framework/actions)
* [Projects
  0](/rastating/wordpress-exploit-framework/projects)
* [Wiki](/rastating/wordpress-exploit-framework/wiki)
* [Security](/rastating/wordpress-exploit-framework/security)
* [Insights](/rastating/wordpress-exploit-framework/pulse)

Additional navigation options

* [Code](/rastating/wordpress-exploit-framework)
* [Issues](/rastating/wordpress-exploit-framework/issues)
* [Pull requests](/rastating/wordpress-exploit-framework/pulls)
* [Actions](/rastating/wordpress-exploit-framework/actions)
* [Projects](/rastating/wordpress-exploit-framework/projects)
* [Wiki](/rastating/wordpress-exploit-framework/wiki)
* [Security](/rastating/wordpress-exploit-framework/security)
* [Insights](/rastating/wordpress-exploit-framework/pulse)

# upload non-encapsulated payload when zip installation fails #52

 Merged

[rastating](/rastating)
merged 1 commit into
[rastating:development](/rastating/wordpress-exploit-framework/tree/development "rastating/wordpress-exploit-framework:development")
from
[viniciusmarangoni:development](/viniciusmarangoni/wordpress-exploit-framework/tree/development "viniciusmarangoni/wordpress-exploit-framework:development")

Aug 4, 2018

 Merged

# [upload non-encapsulated payload when zip installation fails](#top) #52

[rastating](/rastating)
merged 1 commit into
[rastating:development](/rastating/wordpress-exploit-framework/tree/development "rastating/wordpress-exploit-framework:development")
from
[viniciusmarangoni:development](/viniciusmarangoni/wordpress-exploit-framework/tree/development "viniciusmarangoni/wordpress-exploit-framework:development")

Aug 4, 2018

[Conversation
1](/rastating/wordpress-exploit-framework/pull/52)
[Commits
1](/rastating/wordpress-exploit-framework/pull/52/commits)
[Checks
0](/rastating/wordpress-exploit-framework/pull/52/checks)
[Files changed](/rastating/wordpress-exploit-framework/pull/52/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![viniciusmarangoni](https://avatars.githubusercontent.com/u/7467615?s=60&v=4)](/viniciusmarangoni)

Copy link

### @viniciusmarangoni **[viniciusmarangoni](/viniciusmarangoni)** commented [Jul 11, 2018](#issue-340333219)

When playng the Stapler CTF ([https://www.vulnhub.com/entry/stapler-1,150/](https://www.vulnhub.com/entry/stapler-1%2C150/)) I realized that wpxf wouldn't able to get a reverse shell using the admin\_shell\_upload module. The module was able to upload the zip file in wp-content/uploads/ but wasn't able to extract it to wp-content/plugins/ because lack of permissions on this dir. I don't know if this is a common behaviour. I wrote a workaround that uploads directly the php payload file (without encapsulating it in a zip) and then accesses the payload in wp-content/uploads/PAYLOADNAME.php

I apologize for any mistake in my code. I'm not familiar with ruby.

Sorry, something went wrong.

All reactions

[![@viniciusmarangoni2](https://avatars.githubusercontent.com/u/42209795?s=40&v=4)](/viniciusmarangoni2)

`[upload non-encapsulated payload when zip installation fails](/rastating/wordpress-exploit-framework/pull/52/commits/19e3493522b434b09b5f2525792370482cdadea4 "upload non-encapsulated payload when zip installation fails")`

`[19e3493](/rastating/wordpress-exploit-framework/pull/52/commits/19e3493522b434b09b5f2525792370482cdadea4)`

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating)
[rastating](/rastating)
self-assigned this
[Aug 4, 2018](#event-1771290877)

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating)
[rastating](/rastating)
added
the
[enhancement](/rastating/wordpress-exploit-framework/labels/enhancement)
label
[Aug 4, 2018](#event-1771290933)

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating)
[rastating](/rastating)
merged commit [`19e3493`](/rastating/wordpress-exploit-framework/commit/19e3493522b434b09b5f2525792370482cdadea4)
into
rastating:development

[Aug 4, 2018](https://github.com/rastating/wordpress-exploit-framework/pull/52#event-1771402661)

[rastating](/rastating)
added a commit
that referenced
this pull request
[Aug 4, 2018](#ref-commit-19f4fdb)
[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating)

`[Land pull request](/rastating/wordpress-exploit-framework/commit/19f4fdb991ffa450234b7bc04bfbb9ec18d47e11 "Land pull request #52") [#52](https://github.com/rastating/wordpress-exploit-framework/pull/52)`

`[19f4fdb](/rastating/wordpress-exploit-framework/commit/19f4fdb991ffa450234b7bc04bfbb9ec18d47e11)`

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=80&v=4)](/rastating)

Copy link

Owner

### **[rastating](/rastating)** commented [Aug 4, 2018](#issuecomment-410481075)

| Thanks for the contribution [@viniciusmarangoni](https://github.com/viniciusmarangoni) - I've just merged it into the development branch 🎉  This should be in the next minor release, which will probably be in a few weeks time. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frastating%2Fwordpress-exploit-framework%2Fpull%2F52).

Reviewers

No reviews

Assignees

[![@rastating](https://avatars.githubusercontent.com/u/2500434?s=40&v=4)](/rastating) [rastating](/rastating)

Labels

[enhancement](/rastating/wordpress-exploit-framework/labels/enhancement)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@viniciusmarangoni](https://avatars.githubusercontent.com/u/7467615?s=52&v=4)](/viniciusmarangoni) [![@rastating](https://avatars.githubusercontent.com/u/2500434?s=52&v=4)](/rastating) [![@viniciusmarangoni2](https://avatars.githubusercontent.com/u/42209795?s=52&v=4)](/viniciusmarangoni2)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from core.trac.wordpress.org_7de00361_20250126_104201.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fticket%2F44710)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Ticket](/ticket/44709 "Ticket #44709")
* [Next Ticket](/ticket/44711 "Ticket #44711") →

---

Opened [6 years ago](/timeline?from=2018-08-03T00%3A11%3A59Z&precision=second "See timeline at 08/03/2018 12:11:59 AM")

Last modified [4 years ago](/timeline?from=2020-12-25T07%3A25%3A08Z&precision=second "See timeline at 12/25/2020 07:25:08 AM")

## [#44710](/ticket/44710) [new](/query?status=new) [defect (bug)](/query?status=!closed&type=defect+(bug))

# Upload plugin and theme functionalities are not removing uploaded files after failure conditions.

| Reported by: | [rawrly's profile](https://profiles.wordpress.org/rawrly) [rawrly](/query?status=!closed&reporter=rawrly) | Owned by: |  |
| --- | --- | --- | --- |
| Milestone: | [Awaiting Review](/milestone/Awaiting%20Review "No date set") | Priority: | [normal](/query?status=!closed&priority=normal) |
| Severity: | [normal](/query?status=!closed&severity=normal) | Version: | [4.9.7](/query?status=!closed&version=4.9.7) |
| Component: | [Administration](/query?status=!closed&component=Administration) | Keywords: | [needs-patch](/query?status=!closed&keywords=~needs-patch) |
| Focuses: |  | Cc: |  |

### Description

Within wp-admin, an administrator user may upload files by using the Upload Plugin functionality (Plugins -> Add New -> Upload plugin) and the Upload Theme functionality (Appearance -> Themes -> Add New -> Upload Theme)

These processes uploads the user submitted file to /wp-content/uploads/{month} first, then attempts to extract it to the plugins or theme directory (The form expects a .zip file, yet allows any mime-type or extension for uploaded files, such as images, or .php files). If the process fails for any reason the uploaded file remains in /wp-content/uploads/ and/or /wp-content/upgrade/

It would be best if the plugin and theme upload functionalities properly clean up the uploaded files if a plugin or theme fail to properly get extracted and/or installed.

Note: On successful installations of a plugin or theme, the uploaded file is being properly removed from /wp-content/uploads/ and/or /wp-content/upgrade/

### Attachments (1)

[44710.diff](/attachment/ticket/44710/44710.diff "View attachment")[​](/raw-attachment/ticket/44710/44710.diff "Download") (824 bytes) - added by sanket.parmar [6 years ago](/timeline?from=2019-06-02T17%3A21%3A30Z&precision=second "See timeline at 06/02/2019 05:21:30 PM").

Download all attachments as: [.zip](/zip-attachment/ticket/44710/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (5)

### [#1](#comment:1) [@SergeyBiryukov](https://profiles.wordpress.org/sergeybiryukov) [6 years](/timeline?from=2018-08-03T01%3A25%3A48Z&precision=second "See timeline at 08/03/2018 01:25:48 AM") ago

* **Keywords**
  *needs-patch* added

### [#2](#comment:2) [@csorbamedia](https://profiles.wordpress.org/csorbamedia) [6 years](/timeline?from=2018-08-30T13%3A20%3A34Z&precision=second "See timeline at 08/30/2018 01:20:34 PM") ago

I have tested this issue and I have the same thing. I'm working on the patch for it and will supply it soon.

### [#3](#comment:3) [@sanket.parmar](https://profiles.wordpress.org/sanketparmar) [6 years](/timeline?from=2019-06-02T17%3A21%3A04Z&precision=second "See timeline at 06/02/2019 05:21:04 PM") ago

Hi All,

I've tried to fix this and added code for that in `wp-admin/includes/class-wp-upgrader.php` file.

### [@sanket.parmar](https://profiles.wordpress.org/sanketparmar) [6 years](/timeline?from=2019-06-02T17%3A21%3A30Z&precision=second "See timeline at 06/02/2019 05:21:30 PM") ago

* **Attachment**
  [*44710.diff*](/attachment/ticket/44710/44710.diff)[​](/raw-attachment/ticket/44710/44710.diff "Download")
  added

### [#4](#comment:4) [@caralin](https://profiles.wordpress.org/caralin) [4 years](/timeline?from=2020-12-25T07%3A25%3A08Z&precision=second "See timeline at 12/25/2020 07:25:08 AM") ago

Hi, I've tried the patch on WordPress 5.6, but the zip file after failed installation doesn't delete in /wp-content/upgrade/. Does this will be patch in later version WordPress?

**Note:** See
[TracTickets](/wiki/TracTickets) for help on using
tickets.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Comma-delimited Text](/ticket/44710?format=csv)
* [Tab-delimited Text](/ticket/44710?format=tab)
* [RSS Feed](/ticket/44710?format=rss)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


