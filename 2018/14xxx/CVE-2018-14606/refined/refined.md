- **Root cause of vulnerability:** The application fails to properly sanitize the milestone name when promoting a milestone. Specifically, HTML entities in the milestone name are converted to HTML tags, which are then rendered in the notification without sanitization, leading to Stored XSS.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability due to improper sanitization of user-supplied data (milestone name) before rendering it in notifications.
- **Impact of exploitation:** An attacker can inject arbitrary JavaScript code that executes in the context of other users' browsers when they receive a notification about the promoted milestone. This can be used to perform malicious actions like modifying user email addresses, stealing CSRF tokens, or accessing other private repositories.
- **Attack vectors:** The attacker needs to create a milestone with a specially crafted name containing HTML entities that, when decoded, form a malicious script. Then the attacker needs to promote this milestone. When a notification is generated for this promotion, the stored XSS will be triggered when the notification is displayed to a user.
- **Required attacker capabilities/position:** The attacker needs to be a user with the ability to create milestones. The vulnerability affects all users who receive notifications about milestones. The XSS is triggered when a user views the notification.