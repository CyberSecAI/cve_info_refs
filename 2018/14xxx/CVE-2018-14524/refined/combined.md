=== Content from savannah.gnu.org_7bd9aaff_20250124_200352.html ===


* [![Back to Savannah Homepage](/images/Savannah.theme/floating.png)](/)
* Not Logged in
* [Login](/account/login.php?uri=%2Fforum%2Fforum.php%3Fforum_id%3D9211 "Login page - you must have registered an account first")
* [New User](/account/register.php "Account registration form")
* This Page
* [Language](/i18n.php?lang_uri=%2Fforum%2Fforum.php%3Fforum_id%3D9211 "Choose website language")
* [Clean Reload](/forum/forum.php?reload=1&forum_id%3D9211 "Reload the page without risk of reposting data")
* Search
* Area to search in
  Groups
  People
  Support
  Bugs
  Tasks
  Patches
* Hosted Projects
* [Hosting requirements](/register/requirements.php)
* [Register New Project](/register/ "Register your project at Savannah")
* [Full List](/search/index.php?type_of_search=soft&words=%%% "Browse the full list of hosted projects")
* [Contributors Wanted](/people/ "Browse the list of request for contributions")
* [Statistics](/stats/ "Browse statistics about Savannah")
* Site Help
* [User Docs: FAQ](/maintenance/FrontPage/)
* [User Docs: In Depth Guide](/maintenance/back-page/ "In-depth Documentation dedicated to any users, including group admins")
* [Get Support](/support/?group=administration "Get help from the Admins of Savannah, when documentation is not enough")
* [Contact Savannah](/contact.php "Contact address of Savannah Admins")
* GNU Project
* [Help GNU](//www.gnu.org/help/help.html)
* [All GNU Packages](//www.gnu.org/software/software.html)
* [Dev Resources](//www.gnu.org/software/devel.html)
* [License List](//www.gnu.org/licenses/license-list.html)
* [GNU Mirrors](//www.gnu.org/prep/ftp.html)
* [![Support freedom](/images/Savannah.theme/thin-image.png)

  Help us protect your freedom and the rights of computer
  users everywhere by becoming a member of the FSF.

  **Join Now!**](//www.fsf.org/associate/support_freedom/join_fsf?referrer=2442)
* Free Software Foundation
* [Coming Events](//www.fsf.org/events/)
* [Free Software Directory](//www.fsf.org/directory/)
* [Cryptographic software legal notice](//savannah.gnu.org/maintenance/SavannahCryptographicRestrictions)
* [Copyright infringement notification](//www.fsf.org/about/dmca-notice)
* Related Forges
* [Savannah Non-GNU](//savannah.nongnu.org/)
* [Puszcza](//puszcza.gnu.org.ua/)

# newsLibreDWG - News: libredwg-0.6 released [alpha]

 Group

* [Main](/projects/libredwg/ "Group main page at Savannah")
  + [Main](/projects/libredwg/)
  + [View members](/project/memberlist.php?group=libredwg)
  + [Search](/project/search.php?group=libredwg)
* [Homepage](http://www.gnu.org/software/libredwg/ "Browse group home page (outside of Savane)")
* [Download](/files/?group=libredwg "Visit download area: files released")
* Docs
* [Support](/support/?group=libredwg "Tech Support Tracker: post, search and manage support requests")
  + [Submit new](/support/?group=libredwg&func=additem)
  + [Browse](/support/?group=libredwg)
  + [Reset to open](/support/?group=libredwg&func=browse&set=open)
  + [Digest](/support/?group=libredwg&func=digest)
  + [Dependencies](/support/dependencies.php?group=libredwg)
  + ~~Export~~
  + [Get statistics](/support/reporting.php?group=libredwg)
  + [Search](/support/?group=libredwg&func=search)
* [Mailing lists](/mail/?group=libredwg "List existing mailing lists")
* [Source code](/projects/libredwg/#devtools "Source code management")
  + [Use CVS](/cvs/?group=libredwg "CVS Repository")
  + [Browse Web Pages Repository](http://git.savannah.gnu.org/cgit/libredwg.git)
  + [Use Git](/git/?group=libredwg "Git Repository")
  + [Browse Git repository](//git.savannah.gnu.org/cgit/libredwg.git)
* [Bugs](/bugs/?group=libredwg "Bug Tracker: report, search and track bugs")
  + [Submit new](/bugs/?group=libredwg&func=additem)
  + [Browse](/bugs/?group=libredwg)
  + [Reset to open](/bugs/?group=libredwg&func=browse&set=open)
  + [Digest](/bugs/?group=libredwg&func=digest)
  + [Dependencies](/bugs/dependencies.php?group=libredwg)
  + ~~Export~~
  + [Get statistics](/bugs/reporting.php?group=libredwg)
  + [Search](/bugs/?group=libredwg&func=search)
* [Tasks](/task/?group=libredwg "Task Manager: post, search and manage tasks")
  + ~~Submit new~~
  + [Browse](/task/?group=libredwg)
  + [Reset to open](/task/?group=libredwg&func=browse&set=open)
  + [Digest](/task/?group=libredwg&func=digest)
  + [Dependencies](/task/dependencies.php?group=libredwg)
  + ~~Export~~
  + [Get statistics](/task/reporting.php?group=libredwg)
  + [Search](/task/?group=libredwg&func=search)
* [Patches](/patch/?group=libredwg "Patch Manager: post, search and manage patches")
  + ~~Submit new~~
  + [Browse](/patch/?group=libredwg)
  + [Reset to open](/patch/?group=libredwg&func=browse&set=open)
  + [Digest](/patch/?group=libredwg&func=digest)
  + [Dependencies](/patch/dependencies.php?group=libredwg)
  + ~~Export~~
  + [Get statistics](/patch/reporting.php?group=libredwg)
  + [Search](/patch/?group=libredwg&func=search)
* [News](/news/?group=libredwg "Read latest News, post News")
  + [Browse](/news/?group=libredwg)
  + [Atom feed](/news/atom.php?group=libredwg)
  + ~~Submit~~
  + ~~Manage~~

Latest News
[**libredwg-0.13.3 released**](/news/?id=10601) *posted by [reini\_urban](/users/reini_urban), Mon 26 Feb 2024 09:46:29 AM UTC*
[**libredwg-0.13.2 released**](/news/?id=10594) *posted by [reini\_urban](/users/reini_urban), Sat 10 Feb 2024 06:13:26 PM UTC*
[**libredwg-0.13.1 bugfix release**](/news/?id=10593) *posted by [reini\_urban](/users/reini_urban), Sat 10 Feb 2024 08:42:52 AM UTC*
[**libredwg-0.13 released**](/news/?id=10590) *posted by [reini\_urban](/users/reini_urban), Sun 04 Feb 2024 09:53:49 AM UTC*
[**libredwg-0.12.5 released**](/news/?id=10078) *posted by [reini\_urban](/users/reini_urban), Sun 06 Feb 2022 09:01:25 PM UTC*
[[30 news in archive]](/news/?group_id=10374)

## [libredwg-0.6 released [alpha]](forum.php?forum_id=9211)

*Item posted by [Reini Urban <reini\_urban>](/users/reini_urban) on Mon 13 Aug 2018 09:48:15 AM UTC.*

See <https://www.gnu.org/software/libredwg/>

API breaking changes:

  \* Removed dwg\_obj\_proxy\_get\_reactors(), use dwg\_obj\_get\_reactors() instead.

  \* Renamed SORTENTSTABLE.owner\_handle to SORTENTSTABLE.owner\_dict.

  \* Renamed all -as-rNNNN program options to --as-rNNNN.

Other newsworthy changes:

  \* Removed all unused type-specific reactors and xdicobjhandle fields,

    use the generic object and entity fields instead.

  \* Added signed BITCODE\_RLd and BITCODE\_BLd (int32\_t) types.

  \* Added unknown\_bits field to all UNSTABLE/DEBUGGING classes.

  \* Custom CFLAGS are now honored.

  \* Support for GNU parallel and coreutils timeout logfile and picat processing.

Important bugfixes:

  \* Fixed previously empty strings for r2007+ for some objects and entities (#34).

  \* Fixed r2010+ picture size calculation (DXF 160, 310), leading to wrong entity offsets.

  \* Added more checks for unstable objects: empty handles, controls, overflows, isnan.

  \* Fixed some common\_entity\_data, mostly with non-indexed colors and gradient filled HATCH

    (#27, #28, #31)

  \* Fixed some proper relative handles, which were previously treated as NULL handle.

  \* Fixed writing TV strings, now the length includes the final \0 char.

  \* Fixed the initial minimal hash size, fixing an endless loop on very small

    (truncated) DWG's (<1000 bytes).

  \* Much less memory leaks.

  \* Improved free, i.e. no more double free with EED data. (#33)

  \* Better perl bindings build support on Windows, prefer local dwg.h over

    installed dwg.h on testing (#29).

  \* Fixed dejagnu compilation on C11 by using -fgnu89-inline (#2)

New features:

  \* Added unstable support for the objects ASSOCDEPENDENCY, ASSOCPLANESURFACEACTIONBODY,

    DBCOLOR, DIMASSOC, DYNAMICBLOCKPURGEPREVENTER, HELIX, LIGHT, PERSSUBENTMANAGER,

    UNDERLAYDEFINITION and the entities MULTILEADER, UNDERLAY.

  \* Added getopt\_long() support to all programs, position independent options.

  \* Implemented examples/unknown to find field layouts of unknown objects.

    With bd and bits helpers to decode unknowns.

    Now with a <http://picat-lang.org> helper. See also HACKING and savannah News.

  \* Implemented parsing ACIS version 2 to the binary SAB format.

  \* Added all missing dwg\_object\_to\_OBJECT() functions for objects.

  \* Added dwg\_ent\_minsert\_set\_num\_cols(), dwg\_ent\_minsert\_set\_num\_rows()

  \* Added --disable-dxf, --enable--debug configure options. With debug there are many

    more unstable objects available.

  \* Added libredwg.pc (#30)

  \* Added valgrind supressions for known darwin/glibc leaks.

  \* Changed and clarified the semver version numbering on development checkouts with

    major.minor[.patch[.build.nonmastercommits-gittag]]. See HACKING.

Here are the compressed sources:

  <http://ftp.gnu.org/gnu/libredwg/libredwg-0.6.tar.gz>   (9.4MB)

  <http://ftp.gnu.org/gnu/libredwg/libredwg-0.6.tar.xz>   (3.5MB)

  <https://github.com/LibreDWG/libredwg/releases/tag/0.6> (also window binaries)

Here are the GPG detached signatures[\*]:

  <http://ftp.gnu.org/gnu/libredwg/libredwg-0.6.tar.gz.sig>

  <http://ftp.gnu.org/gnu/libredwg/libredwg-0.6.tar.xz.sig>

Use a mirror for higher download bandwidth:

  <https://www.gnu.org/order/ftp.html>

Here are the SHA256 checksums:

995da379a27492646867fb490ee406f18049f145d741273e28bf1f38cabc4d5c  libredwg-0.6.tar.gz

6d525ca849496852f62ad6a11b7b801d0aafd1fa1366c45bdb0f11a90bd6f878  libredwg-0.6.tar.xz

21d9619c6858ea25f95a9b6d8d6946e387309023ec17810f4433d8f61e8836af  libredwg-0.6-win32.zip

d029d35715b8d86a68f8dacc7fdb5a5ac6405bc0a1b3457e75fc49c6c4cf6e06  libredwg-0.6-win64.zip

[\*] Use a .sig file to verify that the corresponding file (without the

.sig suffix) is intact.  First, be sure to download both the .sig file

and the corresponding tarball.  Then, run a command like this:

  gpg --verify libredwg-0.6.tar.gz.sig

If that command fails because you don't have the required public key,

then run this command to import it:

  gpg --keyserver keys.gnupg.net --recv-keys B4F63339E65D6414

and rerun the 'gpg --verify' command.

[![Back to the top](/images/Savannah.theme/arrows/top.orig.png)](#top)

Copyright © 2025 Free Software Foundation, Inc.

Verbatim copying and distribution of this entire article
is permitted in any medium, provided this notice is preserved.

The [Levitating,
Meditating, Flute-playing Gnu](//www.gnu.org/graphics/meditate.html) logo is a GNU GPL'ed image provided
by the Nevrax Design Team.

[Page source code](//git.savannah.nongnu.org/cgit/administration/savane.git/plain//frontend/php/forum/forum.php?id=8e7775633ba4c5f6363553bac86768aec1549efa)

Powered by Savane 3.14-8e77.
[Corresponding source code](https://savannah.gnu.org/source/savane-8e7775633ba4c5f6363553bac86768aec1549efa.tar.gz)



=== Content from github.com_795eb1bc_20250124_200352.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibreDWG%2Flibredwg%2Fissues%2F33)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibreDWG%2Flibredwg%2Fissues%2F33)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=LibreDWG%2Flibredwg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LibreDWG](/LibreDWG)
/
**[libredwg](/LibreDWG/libredwg)**
Public

* [Notifications](/login?return_to=%2FLibreDWG%2Flibredwg) You must be signed in to change notification settings
* [Fork
  246](/login?return_to=%2FLibreDWG%2Flibredwg)
* [Star
   1k](/login?return_to=%2FLibreDWG%2Flibredwg)

* [Code](/LibreDWG/libredwg)
* [Issues
  105](/LibreDWG/libredwg/issues)
* [Pull requests
  6](/LibreDWG/libredwg/pulls)
* [Discussions](/LibreDWG/libredwg/discussions)
* [Actions](/LibreDWG/libredwg/actions)
* [Projects
  1](/LibreDWG/libredwg/projects)
* [Security](/LibreDWG/libredwg/security)
* [Insights](/LibreDWG/libredwg/pulse)

Additional navigation options

* [Code](/LibreDWG/libredwg)
* [Issues](/LibreDWG/libredwg/issues)
* [Pull requests](/LibreDWG/libredwg/pulls)
* [Discussions](/LibreDWG/libredwg/discussions)
* [Actions](/LibreDWG/libredwg/actions)
* [Projects](/LibreDWG/libredwg/projects)
* [Security](/LibreDWG/libredwg/security)
* [Insights](/LibreDWG/libredwg/pulse)

# double free in dwg\_free #33

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[double free in dwg\_free](#top)#33Copy linkAssignees [![rurban](https://avatars.githubusercontent.com/u/41809?s=64&u=edffd729778cdefd68f5642614acbd3a6af4fdee&v=4)](/rurban)Labels[bugSomething isn't working](https://github.com/LibreDWG/libredwg/issues?q=state%3Aopen%20label%3A%22bug%22)Something isn't workingMilestone[0.6](https://github.com/LibreDWG/libredwg/milestone/2)[![@jinyu00](https://avatars.githubusercontent.com/u/18465642?v=4&size=80)](/jinyu00)
## Description

[![@jinyu00](https://avatars.githubusercontent.com/u/18465642?v=4&size=48)](/jinyu00)[jinyu00](https://github.com/jinyu00)opened [on Jul 20, 2018](https://github.com/LibreDWG/libredwg/issues/33#issue-343274015)

When open the crafted `dwg` file , it could tigger `double free` in `dwg2svg2`

Let's see the program error output

```
15:20 haclh@ubuntu:examples $ ./dwg2svg2 dfree_poc_155
......................................................................
......................................................................
......................................................................
=================================================================
*** Error in `./dwg2svg2': double free or corruption (fasttop): 0x0000000001336430 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f18b82547e5]
/lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7f18b825d37a]
/lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f18b826153c]
./dwg2svg2[0x499e0b]
./dwg2svg2[0x49a31a]
./dwg2svg2[0x4a18e9]
./dwg2svg2[0x4a239d]
./dwg2svg2[0x40d13f]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f18b81fd830]
./dwg2svg2[0x40d3a9]
======= Memory map: ========
00400000-00569000 r-xp 00000000 08:10 1140093                            /home/haclh/vmdk/fuzz_workplace/libredwg-0.5.1048/examples/dwg2svg2
00768000-00769000 r--p 00168000 08:10 1140093                            /home/haclh/vmdk/fuzz_workplace/libredwg-0.5.1048/examples/dwg2svg2
00769000-0076a000 rw-p 00169000 08:10 1140093                            /home/haclh/vmdk/fuzz_workplace/libredwg-0.5.1048/examples/dwg2svg2
0076a000-0076c000 rw-p 00000000 00:00 0
01319000-0135b000 rw-p 00000000 00:00 0                                  [heap]
7f18b3dea000-7f18b3e00000 r-xp 00000000 08:01 1315919                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f18b3e00000-7f18b3fff000 ---p 00016000 08:01 1315919                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f18b3fff000-7f18b4000000 rw-p 00015000 08:01 1315919                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7f18b4000000-7f18b4021000 rw-p 00000000 00:00 0
7f18b4021000-7f18b8000000 ---p 00000000 00:00 0
7f18b81dd000-7f18b839d000 r-xp 00000000 08:01 1366856                    /lib/x86_64-linux-gnu/libc-2.23.so
7f18b839d000-7f18b859d000 ---p 001c0000 08:01 1366856                    /lib/x86_64-linux-gnu/libc-2.23.so
7f18b859d000-7f18b85a1000 r--p 001c0000 08:01 1366856                    /lib/x86_64-linux-gnu/libc-2.23.so
7f18b85a1000-7f18b85a3000 rw-p 001c4000 08:01 1366856                    /lib/x86_64-linux-gnu/libc-2.23.so
7f18b85a3000-7f18b85a7000 rw-p 00000000 00:00 0
7f18b85a7000-7f18b86af000 r-xp 00000000 08:01 1315583                    /lib/x86_64-linux-gnu/libm-2.23.so
7f18b86af000-7f18b88ae000 ---p 00108000 08:01 1315583                    /lib/x86_64-linux-gnu/libm-2.23.so
7f18b88ae000-7f18b88af000 r--p 00107000 08:01 1315583                    /lib/x86_64-linux-gnu/libm-2.23.so
7f18b88af000-7f18b88b0000 rw-p 00108000 08:01 1315583                    /lib/x86_64-linux-gnu/libm-2.23.so
7f18b88b0000-7f18b88d6000 r-xp 00000000 08:01 1366854                    /lib/x86_64-linux-gnu/ld-2.23.so
7f18b8aaf000-7f18b8ab3000 rw-p 00000000 00:00 0
7f18b8ad4000-7f18b8ad5000 rw-p 00000000 00:00 0
7f18b8ad5000-7f18b8ad6000 r--p 00025000 08:01 1366854                    /lib/x86_64-linux-gnu/ld-2.23.so
7f18b8ad6000-7f18b8ad7000 rw-p 00026000 08:01 1366854                    /lib/x86_64-linux-gnu/ld-2.23.so
7f18b8ad7000-7f18b8ad8000 rw-p 00000000 00:00 0
7fff6f0da000-7fff6f0fb000 rw-p 00000000 00:00 0                          [stack]
7fff6f127000-7fff6f12a000 r--p 00000000 00:00 0                          [vvar]
7fff6f12a000-7fff6f12c000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
Aborted

```

And the output with **asan**

```
15:20 haclh@ubuntu:examples $ ./dwg2svg2 dfree_poc_155
......................................................................
......................................................................
......................................................................
=================================================================
==101914==ERROR: AddressSanitizer: attempting double-free on 0x60400000dbd0 in thread T0:
    #0 0x7f9dcd3e32ca in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x982ca)
    #1 0x642d83 in dwg_free_eed /home/haclh/workplace/libredwg-0.5.1048/src/free.c:283
    #2 0x6513db in dwg_free_UNKNOWN_OBJ /home/haclh/workplace/libredwg-0.5.1048/src/dwg.spec:5437
    #3 0x6513db in dwg_free_BLOCK_HEADER /home/haclh/workplace/libredwg-0.5.1048/src/dwg.spec:2177
    #4 0x664f98 in dwg_free_object /home/haclh/workplace/libredwg-0.5.1048/src/free.c:471
    #5 0x667d2a in dwg_free /home/haclh/workplace/libredwg-0.5.1048/src/free.c:640
    #6 0x42d81d in test_SVG /home/haclh/workplace/libredwg-0.5.1048/examples/dwg2svg2.c:92
    #7 0x42d81d in main /home/haclh/workplace/libredwg-0.5.1048/examples/dwg2svg2.c:482
    #8 0x7f9dccfa182f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #9 0x42de88 in _start (/home/haclh/workplace/libredwg-0.5.1048/examples/dwg2svg2+0x42de88)

0x60400000dbd0 is located 0 bytes inside of 40-byte region [0x60400000dbd0,0x60400000dbf8)
freed by thread T0 here:
    #0 0x7f9dcd3e32ca in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x982ca)
    #1 0x47ee9f in dwg_decode_eed /home/haclh/workplace/libredwg-0.5.1048/src/decode.c:2311

previously allocated by thread T0 here:
    #0 0x7f9dcd3e379a in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x9879a)
    #1 0x47e349 in dwg_decode_eed /home/haclh/workplace/libredwg-0.5.1048/src/decode.c:2304

SUMMARY: AddressSanitizer: double-free ??:0 __interceptor_free
==101914==ABORTING

```

According **debuging**, I found that When open the crafted `dwg` file , `dwg_free` could call `dwg_decode_eed` , in `dwg_free_object` first, it could call `dwg_free_BLOCK_HEADER` to free a pointer (for example : `0x789430` )

```
void
dwg_free_object(Dwg_Object *obj)
{
  switch (obj->type)
    {
    case DWG_TYPE_TEXT:
    ........................
    ........................
    ........................
    case DWG_TYPE_BLOCK_HEADER:
      dwg_free_BLOCK_HEADER(dat, obj);
      break;

```

The backtrace are as below

```
   f 0     7ffff77884f0 free
 ► f 1           49a1c4 dwg_free_BLOCK_HEADER.isra.7+68
   f 2           4a18e9 dwg_free_object+1161
   f 3           4a239d dwg_free+157
   f 4           40d13f main+575
   f 5           40d13f main+575
   f 6     7ffff7724830 __libc_start_main+240

```

And then it could call `dwg_free_BLOCK_HEADER` again , it could call `dwg_free_eed` to free `0x789430` again.

The backtrace are as below

```
pwndbg> bt
#0  __GI___libc_free (mem=0x789430) at malloc.c:2934
#1  0x0000000000499e0b in dwg_free_eed (obj=0x7988e8, obj=0x7988e8) at free.c:283
#2  0x000000000049a31a in dwg_free_BLOCK_HEADER (obj=0x7988e8, _dat=<optimized out>) at dwg.spec:2285
#3  0x00000000004a18e9 in dwg_free_object (obj=0x7988e8) at free.c:471
#4  0x00000000004a239d in dwg_free (dwg=dwg@entry=0x769400 <g_dwg>) at free.c:640
#5  0x000000000040d13f in test_SVG (filename=<optimized out>) at dwg2svg2.c:92
#6  main (argc=argc@entry=2, argv=argv@entry=0x7fffffffe4c8) at dwg2svg2.c:479
#7  0x00007ffff7724830 in __libc_start_main (main=0x40cf00 <main>, argc=2, argv=0x7fffffffe4c8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffffffe4b8) at ../csu/libc-start.c:291
#8  0x000000000040d3a9 in _start ()

```

The poc file

```
https://gitee.com/hac425/fuzz_data/blob/master/double_free_on_libredwg_155

```
## Metadata

### Assignees

* [![@rurban](https://avatars.githubusercontent.com/u/41809?s=64&u=edffd729778cdefd68f5642614acbd3a6af4fdee&v=4)rurban](/rurban)
### Labels

[bugSomething isn't working](https://github.com/LibreDWG/libredwg/issues?q=state%3Aopen%20label%3A%22bug%22)Something isn't working
### Type

No type
### Projects

No projects
### Milestone

* [0.6](https://github.com/LibreDWG/libredwg/milestone/2)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


