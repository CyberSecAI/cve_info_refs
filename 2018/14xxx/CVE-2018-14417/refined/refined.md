**Root cause of vulnerability:**
The `snserv` script in SoftNAS Cloud versions prior to 4.0.3 does not sanitize input parameters, specifically the `recentVersion` parameter, before executing a system command.

**Weaknesses/vulnerabilities present:**
- OS Command Injection (CWE-78): The lack of input sanitization allows an attacker to inject malicious commands into the system.

**Impact of exploitation:**
- Code execution: An unauthenticated attacker can execute arbitrary code on the target server.
- Privilege escalation: The webserver runs as a sudoer user (apache), allowing the injected code to execute with root privileges. This can lead to a complete compromise of the system.

**Attack vectors:**
- The vulnerability is triggered via the `snserv.php` endpoint by manipulating the `recentVersion` parameter.
- This endpoint does not require authentication/session verification, making it accessible to unauthenticated attackers.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the vulnerable SoftNAS Cloud instance.
- No authentication or prior knowledge is necessary beyond the location of the endpoint and the vulnerable parameter.