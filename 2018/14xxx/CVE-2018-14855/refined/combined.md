=== Content from people.cs.kuleuven.be_858d87a8_20250125_034034.html ===
PeriScope: An Effective Probing and Fuzzing
Framework for the Hardware-OS Boundary

Dokyung Song∗, Felicitas Hetzelt†, Dipanjan Das‡, Chad Spensky‡, Yeoul Na∗, Stijn Volckaert∗§,
Giovanni Vigna‡, Christopher Kruegel‡, Jean-Pierre Seifert†, Michael Franz∗

∗Department of Computer Science, University of California, Irvine
†Security in Telecommunications, Technische Universit¨at Berlin
‡Department of Computer Science, University of California, Santa Barbara
§Department of Computer Science, KU Leuven

Abstract—The OS kernel is an attractive target for remote
attackers. If compromised, the kernel gives adversaries full system
access, including the ability to install rootkits, extract sensitive
information, and perform other malicious actions, all while
evading detection. Most of the kernel’s attack surface is situated
along the system call boundary. Ongoing kernel protection efforts
have focused primarily on securing this boundary; several capable
analysis and fuzzing frameworks have been developed for this
purpose.

However, there are additional paths to kernel compromise
that do not involve system calls, as demonstrated by several
recent exploits. For example, by compromising the ﬁrmware of
a peripheral device such as a Wi-Fi chipset and subsequently
sending malicious inputs from the Wi-Fi chipset to the Wi-Fi
driver, adversaries have been able to gain control over the kernel
without invoking a single system call. Unfortunately, there are
currently no practical probing and fuzzing frameworks that can
help developers ﬁnd and ﬁx such vulnerabilities occurring along
the hardware-OS boundary.

We present PERISCOPE, a Linux kernel based probing
framework that enables ﬁne-grained analysis of device-driver
interactions. PERISCOPE hooks into the kernel’s page fault
handling mechanism to either passively monitor and log trafﬁc
between device drivers and their corresponding hardware, or
mutate the data stream on-the-ﬂy using a fuzzing component,
PERIFUZZ, thus mimicking an active adversarial attack. PER-
IFUZZ accurately models the capabilities of an attacker on
peripheral devices, to expose different classes of bugs including,
but not limited to, memory corruption bugs and double-fetch
bugs. To demonstrate the risk that peripheral devices pose, as
well as the value of our framework, we have evaluated PERIFUZZ
on the Wi-Fi drivers of two popular chipset vendors, where we
discovered 15 unique vulnerabilities, 9 of which were previously
unknown.

I.

INTRODUCTION

Modern electronics often include subsystems manufactured
by a variety of different vendors. For example, in a modern
cellphone, besides the main application processor running a
smartphone operating system such as Android, one might ﬁnd

Network and Distributed Systems Security (NDSS) Symposium 2019
24-27 February 2019, San Diego, CA, USA
ISBN 1-891562-55-X
https://dx.doi.org/10.14722/ndss.2019.23176
www.ndss-symposium.org

a number of peripheral devices such as a touchscreen display,
camera modules, and chipsets supporting various networking
protocols (cellular, Wi-Fi, Bluetooth, NFC, etc.). Peripheral
devices by different manufacturers have different inner work-
ings, which are often proprietary. Device drivers bridge the
gap between stable and well-documented operating system
interfaces on one side and peripheral devices on the other,
and make the devices available to the rest of the system.

Device drivers are privileged kernel components that exe-
cute along two different trust boundaries of the system. One
of these boundaries is the system call interface, which exposes
kernel-space drivers to user-space adversaries. The hardware-
OS interface should also be considered a trust boundary,
however, since it exposes drivers to potentially compromised
peripheral hardware. These peripherals should not be trusted,
because they may provide a remote attack vector (e.g., network
devices may receive malicious packets over the air), and
they typically lack basic defense mechanisms. Consequently,
peripheral devices have frequently fallen victim to remote ex-
ploitation [16], [21], [23], [28], [36], [77]. Thus, a device driver
must robustly enforce the hardware-OS boundary, but pro-
gramming errors do occur. Several recently published attacks
demonstrated that peripheral compromise can be turned into
full system compromise (i.e., remote kernel code execution) by
coaxing a compromised device into generating speciﬁc outputs,
which in turn trigger a vulnerability when processed as an input
in a device driver [22], [24].

The trust boundary that separates peripheral subsystems
from kernel drivers is therefore of great interest to security
researchers. In this paper, we present PERISCOPE, which to
our knowledge is the ﬁrst generic framework that facilitates
the exploration of this boundary. PERISCOPE focuses on
two popular device-driver interaction mechanisms: memory-
mapped I/O (MMIO) and direct memory access (DMA). The
key idea is to monitor MMIO or DMA mappings set up by
the driver, and then dynamically trap the driver’s accesses
to such memory regions. PERISCOPE allows developers to
register hooks that it calls upon each trapped access, thereby
enabling them to conduct a ﬁne-grained analysis of device-
driver interactions. For example, one can implement hooks that
record and/or mutate device-driver interactions in support of
reverse engineering, record-and-replay, fuzzing, etc.

To demonstrate the risk that peripheral devices pose, as

well as to showcase versatility of the PERISCOPE framework,
we created PERIFUZZ, a driver fuzzer that simulates attacks
originating in untrusted, compromised peripherals. PERIFUZZ
traps the driver’s read accesses to MMIO and DMA map-
pings, and fuzzes the values being read by the driver. With
a compromised device, these values should be considered to
be under an attacker’s control; the attacker can freely modify
these values at any time, even in between the driver’s reads. If
the driver reads the same memory location multiple times (i.e.,
overlapping fetches [79]) while the data can still be modiﬁed
by the device, double-fetch bugs may be present [45], [68].
PERIFUZZ accurately models this adversarial capability by
fuzzing not only the values being read from different memory
locations, but also ones being read from the same location
multiple times. PERIFUZZ also tracks and logs all overlapping
fetches and warns about ones that occurred before a driver
crash to help identify potential double-fetch bugs.

Existing work on analyzing device-driver interactions typ-
ically runs the entire system including device drivers in a
controlled environment [32], [44], [47], [49], [54], [60], [62],
[66], such as QEMU [20] or S2E [33]. Enabling analysis in
such an environment often requires developer efforts tailored
to speciﬁc drivers or devices, e.g., implementing a virtual
device or annotating driver code to keep symbolic execution
tractable. In contrast, PERISCOPE uses a page fault based in-
kernel monitoring mechanism, which works with all devices
and drivers in their existing testing environment. As long as
the kernel gets recompiled with our framework, PERISCOPE
and PERIFUZZ can analyze device-driver interactions with
relative ease, regardless of whether the underlying device is
virtual or physical, and regardless of the type of the device.
Extending our framework is also straightforward; for example,
PERIFUZZ accepts any user-space fuzzer, e.g., AFL, as a plug-
in, which signiﬁcantly reduces the engineering effort required
to implement proven fuzzing strategies [25], [26], [30], [31],
[37].

We validated our system by running experiments on the
software stacks shipping with the Google Pixel 2 and the
Samsung Galaxy S6, two popular smartphones on the market at
the time of development. To simulate remote attacks that would
occur over the air in a real-world scenario, we focused on the
Wi-Fi drivers of these phones in evaluating our framework.
The Google Pixel 2 and Samsung Galaxy S6 are equipped
with Qualcomm and Broadcom chipsets, respectively. These
two are arguably the most popular Wi-Fi chipset manufacturers
at the time of our experiments. In our experiments, our system
identiﬁed 15 unique vulnerabilities in two device drivers, out
of which 9 vulnerabilities were previously unknown, and 8
new CVEs were assigned. We have reported the discovered
vulnerabilities to the respective vendors and are working with
them on ﬁxing these vulnerabilities. We hope that our tool
will aid developers in hardening the hardware-OS boundary,
leading to better software security.

In summary, this paper makes the following contributions:

•

A probing framework: We introduce PERISCOPE,
the
a generic probing framework that can inspect
interactions between a driver and its corresponding
device. PERISCOPE provides the means to analyze the
hardware-OS boundary, and to build more specialized
analysis tools.

Fig. 1. Hardware-OS interaction mechanisms

•

•

•

•

A fuzzing framework: We extended PERISCOPE
to build PERIFUZZ, a vulnerability discovery tool
tailored to detect driver vulnerabilities occurring along
the hardware-OS boundary. The tool demonstrates the
power of the PERISCOPE framework, and it system-
atizes the exploration of the hardware-OS boundary.

An overlapping fetch fuzzer: PERIFUZZ fuzzes over-
lapping fetches in addition to non-overlapping fetches,
and warns about overlapping fetches that occurred
before a driver crash. A warning observed before a
driver crash may indicate the presence of double-fetch
bugs.

Discovered vulnerabilities: As part of our evaluation,
we discovered previously known and unknown vulner-
abilities in the Wi-Fi drivers of two of the most promi-
nent vendors in the market. We responsibly disclosed
relevant details to the corresponding vendors.

An open-source tool: We open-sourced our tool1, in
order to facilitate further research exploration of the
hardware-OS boundary.

II. BACKGROUND

In this section, we provide the technical background nec-
essary to understand how peripheral devices interact with the
OS. We also discuss isolation mechanisms that allow the OS to
protect itself against misbehaving peripherals, as well as tools
to analyze hardware-OS interactions.

A. Hardware-OS Interaction

Figure 1 illustrates the various ways in which devices can
interact with the OS and the device driver. Although we assume
that the device driver runs on a Linux system with an ARMv8-
A/AArch64 CPU, the following discussion generally applies to
other platforms as well.

1https://github.com/securesystemslab/periscope

2

RegistersDirect Memory Access (DMA)InterruptsPhysicalMemoryMemory AccessesVirtual AddressPhysical AddressBus AddressMMUVirtual AddressPhysical AddressI/O Virtual AddressMain ProcessorPeripheral DeviceMemory-mapped I/O(MMIO)IOMMU1) Interrupts: A device can send a signal to the CPU by
raising an interrupt request on one of the CPU’s interrupt
lines. Upon receiving an interrupt request, ARMv8-A CPUs
ﬁrst mask the interrupt line so that another interrupt request
cannot be raised on the same line while the ﬁrst request is
being handled. Then, the CPU transfers control to the interrupt
handler registered by the OS for that interrupt line. Interrupt
handlers can be conﬁgured at any time, though the OS typically
conﬁgures them at boot time.

Processing Interrupts: To maximize the responsive-
ness and concurrency of the system, the OS attempts to defer
interrupt processing so that the interrupt handler can return
control to the CPU as soon as possible. Typically, interrupt
handlers only process interrupts in full if they were caused
by time-sensitive events or by events that require immediate
attention. All other events are processed at a later time, outside
of the interrupt context. This mechanism is referred to as top-
half and bottom-half interrupt processing in Linux lingo.

In Linux, after performing minimal amount of work in the
hardware interrupt context (hardirq), the device driver sched-
ules the work to be run in either software interrupt context
(softirq), kernel worker threads, or the device driver’s own
kernel threads, based on its priority. For higher priority work,
a device driver can register its own tasklet, a deferred action
to be executed under the software interrupt context, which
also ensures serialized execution. Lower priority work can
further be deferred either to kernel worker threads (using the
workqueue API) or to the device driver’s own kernel threads.

2) Memory-Mapped I/O: Analogous to peripherals using
interrupts to signal the OS and the device driver, the CPU uses
memory-mapped I/O (MMIO) to signal peripherals. MMIO
maps a range of kernel-space virtual addresses to the hardware
registers of peripheral devices. This allows the CPU to use
normal memory access instructions (as opposed to special
I/O instructions) to communicate with the peripheral device.
The CPU observes such memory accesses and redirects them
to the corresponding hardware. In Linux, device drivers call
ioremap to establish an MMIO mapping, and iounmap to
remove it.

3) Direct Memory Access: Direct memory access (DMA)
allows peripheral devices to access physical memory directly.
Typically,
the device transfers data using DMA, and then
signals the CPU using an interrupt. There are two kinds of
DMA buffers: coherent and streaming.

Coherent DMA buffers (also known as consistent DMA
buffers) are usually allocated and mapped only once at the time
of driver initialization. Writes to coherent DMA buffers are
usually uncached, so that values written by either the peripheral
processor or the CPU are immediately visible to the other side.

Streaming DMA buffers are backed by the CPU’s cache,
and have an explicit owner. They can either be owned by the
CPU itself, or by one of the peripheral processors. Certain
kernel-space memory buffers can be “mapped” as streaming
DMA buffers. However, once a streaming DMA buffer is
mapped, the peripheral devices automatically acquires own-
ership over it, and the kernel can no longer write to the buffer.
Unmapping a streaming DMA buffer revokes its ownership
from the peripheral device, and allows the CPU to access the

buffer’s contents. Streaming DMA buffers are typically short-
lived, and are often used for a single data transfer operation.

B. Input/Output Memory Management Unit

Since DMA allows peripherals to access physical memory
directly, its use can be detrimental to the overall stability of
the system if a peripheral device misbehaves. Modern systems
therefore deploy an input output memory management unit
(IOMMU) (also known as system memory management unit,
or SMMU, on the ARMv8-A/AArch64 architecture) to limit
which regions of the physical memory each device can access.
Similar to the CPU’s memory management unit (MMU), the
IOMMU translates device-visible virtual addresses (i.e., I/O
addresses) to physical addresses. The IOMMU uses translation
tables, which are conﬁgured by the OS prior to initiating a
DMA transfer. Device-initiated accesses that fall outside of
the translation table range will trigger faults that are visible to
the OS.

C. Analyzing Hardware-OS Interaction

Vulnerabilities in device drivers can lead to a compromise
of the entire system, since many of these drivers run in kernel
space. To detect these vulnerabilities, driver developers can
to dynamic analysis tools that monitor the driver’s
resort
behavior and report potentially harmful actions. Doing this
ideally requires insight into the communication between the
driver and the device, as this communication can provide the
context necessary to ﬁnd the underlying cause of a vulnera-
bility. Analyzing device-driver communication requires (i) an
instance of the device, whether physical or virtual, and (ii)
a monitoring mechanism to observe and/or inﬂuence device-
driver communication. Existing approaches can therefore be
classiﬁed based on where and how they observe (and possibly
inﬂuence) device-driver interactions.

Device Adaptation: To exercise direct control over the
data sent from the hardware to the driver, an analyst can adapt
the ﬁrmware of real devices to include such capabilities. This
can be done by reverse engineering the ﬁrmware and reﬂashing
a modiﬁed one [64], or by using custom hardware that supports
reprogramming of devices [1]. However, these frameworks are
typically tailored to speciﬁc devices, and given the hetero-
geneity of peripheral devices, their applicability is limited.
For example, Nexmon only works for some Broadcom Wi-Fi
devices [64], and Facedancer11, a custom Universal Serial Bus
(USB) device, can only analyze USB device drivers [1].

Virtual Machine Monitor: A driver can be tested in
conjunction with virtual devices running in a virtual envi-
ronment such as QEMU [20]. The virtual machine monitor
observes the behavior of its guest machines and can easily
support instrumentation of the hardware-OS interface. Previous
work uses existing implementations of virtual devices for
testing the corresponding drivers [44], [66]. For many devices,
however, an implementation of a virtual device does not exist.
In this case, developers must manually implement a virtual
version of their devices to interact with the device driver they
wish to analyze [47]. Several frameworks alleviate the need
for virtual devices by relaying I/O to real devices [71], [80],
but these frameworks generally require a non-trivial porting
effort for each driver and device, and/or do not support DMA.

3

Symbolic Execution: S2E augments QEMU with se-
lective symbolic execution [33]. Several tools leverage S2E to
analyze the interactions between OS kernel and hardware by
selectively converting hardware-provided values into symbolic
values [32], [49], [60], [62]. However, symbolic execution
in general is prohibitively slow due to the path explosion
and constraint solving problem. Moreover, symbolic execution
itself does not reveal vulnerabilities, but rather generates a
set of constraints that must be analyzed by separate checkers.
Writing such a checker is not trivial. Most of the checkers
supported by SymDrive, for example, target stateless bugs
such as kernel API misuses, but ignore memory corruption
bugs [62].

III. PERISCOPE DESIGN

We designed PERISCOPE as a dynamic analysis framework
that can be used to examine bi-directional communication
between devices and their drivers over MMIO and DMA.
Contrary to earlier work on analyzing device-driver commu-
nication on the device side, we analyze this communication
on the driver side, by intercepting the driver’s accesses to
communication channels. PERISCOPE does this by hooking
into the kernel’s page fault handling mechanism. This design
choice makes our framework driver-agnostic; PERISCOPE can
analyze drivers with relative ease, regardless of whether the
underlying device is virtual or real, and regardless of the type
of the peripheral device.

At a high level, PERISCOPE works as follows. First,
PERISCOPE automatically detects when the target device driver
creates a MMIO or DMA memory mapping, and registers it.
Then, the analyst selects the registered mappings that he/she
wishes to monitor. PERISCOPE marks the pages backing these
monitored mappings as not present in the kernel page tables.
Any CPU access to those marked pages therefore triggers a
page fault, even though the data on these pages is present in
physical memory.

When a kernel page fault occurs, PERISCOPE ﬁrst marks
the faulting page as present in the page table ( 1 in Figure 2).
Then,
it determines if the faulting address is part of any
of the monitored regions ( 2 ). If it is not, PERISCOPE re-
executes the faulting instruction ( 5 ), which will now execute
without problems. Afterwards, PERISCOPE marks the page as
not present again ( 7 ), and resumes the normal execution of
the faulting code.

If the faulting address does belong to a monitored region,
PERISCOPE invokes a pre-instruction hook function registered
by the user of the framework, passing information about
the faulting instruction ( 4 ). Then, PERISCOPE re-executes
the faulting instruction ( 5 ). Finally, PERISCOPE invokes the
post-instruction hook registered by the driver ( 6 ), marks the
faulting page as not present again ( 7 ), and resumes the
execution of the faulting code.

A. Memory Access Monitoring

Tracking Allocations: PERISCOPE hooks the kernel
APIs used to allocate and deallocate DMA and MMIO
regions2. We use these hooks to maintain a list of all

2Establishing DMA and MMIO mappings is a highly platform-dependent
process, so device drivers are obliged to use the ofﬁcial kernel APIs to do so.

Fig. 2. PERISCOPE fault handling

DMA/MMIO allocation contexts and their active mappings.
PERISCOPE assigns an identiﬁer to every context in which a
mapping is allocated, and presents the list of all allocation
contexts as well as their active mappings to privileged user-
space programs through the debugfs ﬁle system.

Enabling Monitoring: PERISCOPE exposes a privi-
leged user-space API that enables monitoring of DMA/MMIO
regions on a per-allocation-context basis. Once monitoring
is enabled for a speciﬁc allocation context, PERISCOPE will
ensure that accesses to all current and future regions allocated
in that context trigger page faults.

Clearing Page Presence: PERISCOPE marks all pages
containing monitored regions as not present in the kernel’s
page tables to force accesses to such pages to trigger page
faults. One complication that can arise here is that modern
architectures,
including x86-64 and AArch64, can support
multiple page sizes within the same page table. On AArch64
platforms, a single page table entry can serve physical memory
regions of 4KB, 16KB, or 64KB, for example. If a single
(large) page table entry serves both a monitored and a non-
monitored region, then we split that entry prior to marking the
region as not present. We do this to avoid unnecessary page
faults for non-monitored regions. Note that, even after split-
ting page table entries, PERISCOPE cannot rule out spurious
page faults completely, as some devices support DMA/MMIO
regions that are smaller than the smallest page size supported
by the CPU.

Trapping Page Faults: PERISCOPE hooks the kernel’s
default kernel page fault handler to monitor page faults.
Inside the hook function, we ﬁrst check if the fault originated
from a page that contains one of the monitored regions. If
the fault originated from some other page, we immediately
return from the hook function with an error code and defer
the fault handling to the default page fault handler. If the
fault did originate from a page containing a registered buffer,
PERISCOPE marks that page as present ( 1 ), and then checks

4

PC: LDR/STRPC+4: ......#PFMark PagePresentSingle-stepMark PageNot PresentDecodeInstructionFilteringIrrelevant FaultsDevice Driver123Pre-instructionHookPost-instructionHook4765if the faulting address falls within a monitored region ( 2 ). If
the faulting address is outside a monitored region, we simply
single-step the faulting instruction ( 5 ), mark the faulting page
as not present again ( 7 ), and resume normal execution of
the faulting code. If the faulting address does fall within
a monitored region, however, we proceed to the instruction
decoding step ( 3 ).

Instruction Decoding: In order to accurately monitor
and (potentially) manipulate the communication between the
hardware/ﬁrmware and the device driver, we need to extract
the source register, the destination register and the access width
of the faulting instruction ( 3 in Figure 2). We implemented
a simple AArch64 instruction decoder, which provides this
information for all load and store instructions. PERISCOPE
carries this information along the rest of its fault handling
pipeline.

Pre-instruction Hook: After decoding the instruction,
PERISCOPE calls the pre-instruction hook that the user of
our framework can register ( 4 ). We pass the address of the
faulting instruction, the memory region type (MMIO or DMA
coherent/streaming), the instruction type (load or store), the
destination/source register, and the access register width to this
hook function. The pre-instruction hook function can return
two values: a default value and a skip-single-step value. If the
function returns the latter, PERISCOPE proceeds immediately
to step 6 . Otherwise, PERISCOPE proceeds to step 5 .

PERISCOPE provides a default pre-instruction hook which
logs all memory stores before the value in the source register
is stored to memory. We maintain this log in a kernel-space
circular buffer that can later be read from the ﬁle system using
tracefs.

Single-stepping: When execution returns from the pre-
instruction hook, and the hook function did not return the
skip-single-step value, we re-execute the faulting instruction,
which can now access the page without faulting. We use the
processor’s single-stepping support to ensure that only the
faulting instruction executes, but none of its successors do ( 5 ).

Post-instruction Hook: When PERISCOPE regains con-
trol after single-stepping, it ﬁrst clears the page present ﬂag
for the faulting page again so that future accesses to the
faulting page once again trigger a page fault. Then, it calls the
post-instruction handler, which, similarly to the pre-instruction
handler, has a default implementation that can be overridden
through our API ( 6 ). The default handler logs all memory
loads by examining and logging the value that is now stored
in the destination register.

IV. PERIFUZZ DESIGN

We built PERIFUZZ as a client module for PERISCOPE.
PERIFUZZ can generate and provide inputs for device drivers.
The goal of our fuzzer is to uncover vulnerabilities that could
potentially be exploited by a compromised peripheral device.

Fig. 3. PERIFUZZ overview

feasible because such devices rarely deploy hardware protec-
tion mechanisms or software mitigations. As a result, silent
memory corruptions occur frequently [56], which signiﬁcantly
lowers the bar to mount an attack. That peripherals can turn
malicious after being attacked was demonstrated by successful
remote compromises of several network devices such as eth-
ernet adapters [36], GSM baseband processors [28], [77], and
Wi-Fi processors [16], [21], [23].

IOMMU/SMMU Protection: For many years, a strict
hardware-OS security boundary existed in theory, but it was
not enforced in practice. Most device drivers trusted that the
peripheral was benign, and gave the device access to the
entire physical memory (provided that the device was DMA-
capable), thus opening the door to DMA-based attacks and
rootkits [17], [69]. This situation has changed for the better
with the now widespread deployment of IOMMU units (or
SMMU for AArch64). IOMMUs can prevent the device from
accessing physical memory regions that were not explicitly
mapped by the MMU, and they prevent peripherals from
accessing streaming DMA buffers while these are mapped
for CPU access. The latter restriction can be imposed by
invalidating IOMMU mappings, or by copying the contents
of a streaming DMA buffer to a temporary buffer (which the
peripheral cannot access) before the CPU uses them [52], [53].
We assume that such an IOMMU is in place, and that is being
used correctly.

Summary:

In our model, the attacker can (i) com-
promise a peripheral such as a Wi-Fi chipset over the air
by abusing an existing bug in the peripheral’s ﬁrmware, (ii)
exercise control over the compromised peripheral
to send
arbitrary data to the device driver, and, (iii) not access the
main physical memory, except for memory regions used for
communicating with the device driver.

A. Threat Model

Peripheral Compromise: We assume that the attacker
can compromise a peripheral, which, in turn, can send arbitrary
data to its device driver. Compromising a peripheral device is

B. Design Overview

PERIFUZZ is composed of a number of components, as
illustrated in Figure 3. Our design is fully modular, so each

5

PC: LDRPC+4: ......PeriScope FrameworkPre-instructionHookInjectorDevice Driver#PFSkip single-stepFuzzerExecutorUser spaceKernel spaceregs[dest]=0xDEAD0xDEADPC+=4Post-instructionHookcomponent can be swapped out for an alternative implemen-
tation that exposes the same interface.

Fuzzer: We use a fuzzer that runs in user space.
This component is responsible for generating inputs for the
device driver and processing execution feedback. Our modular
design allows us to use any fuzzer capable of fuzzing user-
space programs. We currently use AFL as our fuzzer, as was
done in several previous works that focus on fuzzing kernel
subsystems [42], [57], [65].

Executor: The executor is a user-space-resident bridge
between the fuzzer (or any input provider) and the injector.
The executor takes an input ﬁle as an argument, and sends
the ﬁle content to the injector via a shared memory region
mapped into both the executor’s and the injector’s address
spaces. The executor then notiﬁes the injector that the input
is ready for injection, and periodically checks if the provided
input has been consumed. PERIFUZZ launches an instance of
the executor for every input the fuzzer generates. The executor
is also used to reproduce a crash by providing the last input
observed before the crash.

Injector: The injector is a kernel-space module that
interfaces with our PERISCOPE framework. The injector reg-
isters a pre-instruction hook with PERISCOPE, which allows
the injector to monitor and manipulate all data the device driver
receives from the device. At every page fault, the injector
ﬁrst checks if fuzzing is currently enabled, and if there is
a fuzzer/executor-provided input that has not been consumed
yet. If both conditions are met, the injector overwrites the
destination register with the input generated by the fuzzer.

Note that PERIFUZZ manipulates only the values device
drivers read from MMIO and DMA mappings, but not the
values they write. PERIFUZZ, in other words, models compro-
mised devices, but not compromised drivers.

C. Fuzzer Input Consumption

We treat each fuzzer-generated input as a serialized se-
quence of memory accesses. In other words, our injector
always consumes and injects the ﬁrst non-consumed inputs
found in the input buffer shared between the executor and
injector. This fuzzer input consumption model allows for
overlapping fetch fuzzing as it automatically provides different
values for multiple accesses to the same offsets within a target
mapping (i.e., overlapping fetches [79]). Providing different
values for overlapping fetches enables us to ﬁnd double-
fetch bugs, if triggering such bugs leads to visible side-effects
such as a driver crash. Our fuzzer also keeps track of the
values returned for overlapping fetches, and can output this
information when a driver crashes,
thereby helping us to
narrow down the cause of the crash. In fact, the double-fetch
bugs we identiﬁed using PERIFUZZ would not have been found
without this information (see Section VI).

Since we assume that the attacker cannot access streaming
DMA buffers while they are mapped for CPU access (see
Section IV-A), we take extra care not to enable overlapping
fetch fuzzing for streaming DMA buffers. To this end, we
maintain a history of read accesses, and consult this history to
determine if a new access overlaps with any previous access.
If they overlap, we return the same values returned for the

Algorithm 1 Fuzzer Input Consumption at Each Driver Read
(cid:46) Initialized when switching fuzzer input
1: global variables
Input ← [...]
2:
InputOf f set ← 0
3:
P revReads ← {}
4:
OverlappingF etches ← {}
5:
6: end global variables
7: function FUZZDRIVERREAD(Address, W idth, T ype)
8:
9:
10:
11:
12:
13:
14:
15:

Overlap ← P rev.range ∩ range(Address, W idth)
if Overlap is not empty then

V alue ← Input[range(InputOf f set, W idth)]
for all P rev in P revReads do

V alue[Overlap] ← P rev.value(Overlap)

if T ype is DMA Streaming then

OverlappingF etches

else

←

OverlappingF etches ∪ {(Overlap, V alue)}

end if

end if

16:
17:
18:
19:
20:
21:
22: end function

end for
InputOf f set ← InputOf f set + W idth
P revReads ← P revReads∪{(Address, W idth, V alue)}
return V alue

previous access, and do not consume any bytes from the fuzzer
input. Algorithm 1 shows how we pick values to inject for each
driver read from an MMIO or DMA mapping.

An additional beneﬁt of our fuzzer input consumption
model is that it helps to keep the input size small, because
we only have to generate fuzzer input bytes for read accesses
that actually happen and not for the entire fuzzed buffer, which
may contain bytes that are never read.

D. Register Value Injection

PERISCOPE provides the destination register and the access
width when it calls into PERIFUZZ’s pre-instruction hook
handler. The fuzzer input is consumed for that exact access
width, and then injected into the destination register. Our pre-
instruction hook function returns the skip-single-step value
to PERISCOPE (see Section III-A), as we have emulated the
faulting load instruction by writing a fuzzed value into its desti-
nation register. Our post-instruction hook function increments
the program counter, so the execution of the driver resumes
from the instruction that follows the fuzzed instruction.

E. Fuzzing Loop

Each iteration of the fuzzing loop consumes a single fuzzer-
generated input. We align each iteration of the fuzzing loop to
the software interrupt handler, i.e., do_softirq. We do not
insert hooks into the hardware interrupt handler, since work is
barely done in the hardware interrupt context. The two hooks
inserted before and after the software interrupt handler demar-
cate a single iteration of the fuzzing loop, in which PERIFUZZ
consecutively consumes bytes in a single fuzzer input. This
design decision allows us to remain device-agnostic, but device
driver developers could provide an alternative device-speciﬁc
deﬁnition of an iteration by inserting those two hooks in their
drivers. Several low priority tasks are often deferred to the
device driver’s own kernel threads, and the fuzzing loop can
be aligned to the task processing loop inside those threads.

6

TABLE I.

LOC MODIFIED IN THE LINUX KERNEL CODE AND THE

TABLE II.

PERIFUZZ IMPLEMENTATION LOC

PERISCOPE FRAMEWORK ITSELF

Description

Linux DMA and MMIO allocation/deallocation APIs
Linux kernel page fault and debug exception handlers
PERISCOPE framework

LoC

92
46
3843

Component

Injector
KCOV (modiﬁcation)
Executor
Python manager and utility scripts

Kernel-space
Kernel-space
User-space
Host

LoC

441
176
338
924

F.

Interfacing with AFL

We use AFL [81], a well-known coverage-guided fuzzer, as
PERIFUZZ’s fuzzing front-end. This is in line with previous
work on fuzzing various kernel subsystems [42], [57], [65].
To fully leverage AFL’s coverage-guidance, we added kernel
coverage and seed generation support in PERIFUZZ.

Coverage-guidance: We modiﬁed and used KCOV to
provide coverage feedback while executing inputs [74]. Ex-
isting implementations of KCOV were developed for fuzzing
system calls and only collect coverage information for code
paths reachable from system calls. To enable device driver
fuzzing, we extended KCOV with support for collecting cov-
erage information for code paths reachable from interrupt
handlers. We also applied a patch to force KCOV to collect
edge coverage information rather than basic block coverage
information [29]. To collect coverage along the execution of
the device driver, it is ﬁrst compiled with coverage instrumen-
tation. This instrumentation informs KCOV of hit basic blocks,
which KCOV records in terms of edge coverage. The executor
component retrieves the coverage feedback from kernel, once
the input has been consumed. Then the executor copies this
coverage information to a memory region shared with the
parent AFL fuzzer process, after which we signal KCOV to
clear the coverage buffer for the next fuzzing iteration.

Automated Seed Generation: Starting with valid test
cases rather than fully random inputs improves the fuzzing ef-
ﬁciency, as this lowers the number of input mutations required
to discover new paths. To collect an initial seed of valid test
cases, we use our PERISCOPE framework to log all accesses
to a user-selected set of buffers. We provide an access log
parser that automatically turns a sequence of accesses into a
seed ﬁle according to our fuzzing input consumption model
(see Section IV-C). That said, this step is optional; one could
start from any arbitrary seed, or craft test cases on their own.

V.

IMPLEMENTATION

A. PERISCOPE

We based our implementation of PERISCOPE on Linux
kernel 4.4 for AArch64. Our framework is, for the most part,
a standalone component that can be ported to other versions
of the Linux kernel and even to vendor-modiﬁed custom
kernels with relative ease. The kernel changes required for
PERISCOPE are relatively small compared to the framework
implementation itself as shown in Table I.

Tracking

Allocations:

the
generic kernel APIs used to allocate/deallocate MMIO and
DMA regions to maintain a list of allocation contexts.
into the dma_alloc_coherent
We insert
these hooks
to track coherent
and dma_free_coherent functions

PERISCOPE

hooks

DMA mappings, into the dma_unmap_page function3 and
dma_map_page to track streaming DMA mappings, and into
ioremap and iounmap to track MMIO mappings.

PERISCOPE assigns a context identiﬁer to every MMIO and
DMA allocation context. This context identiﬁer is the XOR-
sum of all call site addresses that are on the call stack at
allocation time. We mask out the upper bits of all call site
addresses to ensure that context identiﬁers remain the same
across reboots on devices that enable kernel address space
layout randomization (KASLR).

Monitoring Interface: PERISCOPE provides a user-
space interface by exposing debugfs and tracefs ﬁle system
entries. Through this interface, a user can list all allocation
contexts and their active mappings, enable or disable monitor-
ing, and read the circular buffer where PERISCOPE logs all
accesses to the monitored mappings.

As streaming DMA buffer allocations can happen in inter-
rupt contexts, we use a non-blocking spinlock to protect access
to data structures such as the list of monitored mappings. When
accessing these data structures from an interruptible code path,
we additionally disable interrupts to prevent interrupt handlers
from deadlocking while trying to access the same structures.

B. PERIFUZZ

We built PERIFUZZ as a client for PERISCOPE. Table II

summarizes the code we added or changed for PERIFUZZ.

Kernel-User Interface: The injector registers a device
node that exposes device-speciﬁc mmap and ioctl system
calls to the user-space executor. The executor can therefore
create a shared memory mapping via mmap to the debugfs
ﬁle exported by the injector module. Through this interface, the
executor passes the fuzzer input to the injector running in the
kernel space. The ioctl handler of the injector module allows
the executor (i) to enable and disable fuzzing, and (ii) to poll
the consumption status of a fuzzer input it provided. Similarly,
KCOV provides the coverage feedback by exporting another
debugfs ﬁle such that the executor can read the feedback by
mmaping the exported debugfs ﬁle.

Persisting Fuzzer Files: Many fuzzers including AFL
store meta-information about fuzzing and input corpus in the
ﬁle system. However, these ﬁles might not persist if the kernel
crashes before the data is committed to the disk. To avoid
this, we ensure that all the fuzzer ﬁles are made persistent, by
modifying AFL to call fsync after all ﬁle writes. Persisting all
ﬁles allows us (i) to investigate crashes using the last crashing
input and (ii) to resume fuzzing with the existing corpus stored
in the ﬁle system.

3dma_unmap_page unmaps a streaming DMA mapping from the periph-
eral processor. Doing so transfers ownership of the mapping to the device
driver.

7

TABLE IV.

THE NUMBER OF MMIO AND DMA ALLOCATION

CONTEXTS THAT CREATE ATTACKER-ACCESSIBLE MAPPINGS

Driver
qcacld-3.0

bcmdhd4358

MMIO

DMA Coherent

DMA Streaming

1

4

9

11

5

29

TABLE V.
THE NUMBER OF BASIC BLOCKS EXECUTED UNDER WEB
BROWSING TRAFFIC PER KERNEL CONTROL PATH. A BASIC BLOCK COULD
RUN IN INTERRUPT CONTEXT (IRQ), KERNEL THREAD OR WORKER
CONTEXT (KERNEL THREAD), OR OTHERS (OTHERS). SOME BASIC
BLOCKS CAN BE REACHED IN SEVERAL CONTEXTS.

Driver

IRQ

qcacld-3.0

bcmdhd4358

1633
(36.9%)
743
(68.9%)

Kernel
Thread
2902
(65.6%)
284
(26.3%)

Others

Hit / Instrumented

672
(15.2%)
301
(27.9%)

4427/81637

1078/23404

also tested the Samsung Galaxy S6, on which we installed
LineageOS 14.1 and Broadcom’s bcmdhd4358 Wi-Fi driver.
LineageOS 14.1 is a popular custom Android distribution
that includes the exact same Broadcom driver as the ofﬁcial
Android version for the Galaxy S6.

Note that although the Samsung Galaxy S6 has an
IOMMU, it is not being used to protect the physical memory
from rogue Wi-Fi peripherals. Regardless, we did conduct our
experiments under the assumption that IOMMU protection is
in place. Newer versions of the Samsung Galaxy phones do
enable IOMMU protection for Wi-Fi peripherals.

B. Target Attack Surface

The code paths that are reachable from peripheral devices
vary depending on the internal state of the driver (e.g., is the
driver connected, not connected, scanning for networks, etc).
In our evaluation, we assume that the driver has reached a
steady state where it has established a stable connection with
a network. We consider only the code paths reachable in this
state as part of the attack surface. We analyzed this attack
surface by counting (i) the number of allocation contexts that
create attacker-accessible MMIO and DMA mappings and (ii)
the number of driver code paths that are executed while the
user is browsing the web.

Table IV summarizes the MMIO and DMA allocation
contexts in both device drivers, which create mappings that
can be accessed by the attacker while the user is browsing the
web. MMIO and DMA coherent mappings were established
during the driver initialization, and were still mapped to both
the device and the driver by the time the user browses the
web; DMA streaming mappings were destroyed after their use,
but regularly get recreated and mapped to the device while
browsing the web. Thus, an attacker on a compromised Wi-Fi
chipset can easily access these mappings, and write malicious
values in them to trigger and exploit vulnerabilities in the
driver.

We then analyzed the code paths that get exercised under
web browsing trafﬁc, and classiﬁed these paths based on the
context in which they are executed: interrupt context, kernel
thread context, and other contexts (e.g., system call context).
Table V shows the results. Of all the basic blocks executed
under web browsing trafﬁc, 36.9% and 68.9% run in interrupt
context for the qcacld-3.0 and bcmdhd4358 drivers,

Fig. 4. Continuous fuzzing with PERIFUZZ

TABLE III.

TARGET SMARTPHONES

Google Pixel 2

Samsung Galaxy S6

Model Name
Released
SoC
Kernel Version
Wi-Fi Device Driver
Wi-Fi IOMMU Protection

walleye
October, 2017
Snapdragon 835
4.4
qcacld-3.0

SM-G920F
April, 2015
Exynos 7420
3.10
bcmdhd4358

Yes

No

Fuzzing Manager: The fuzzing procedure is com-
pletely automated through Python scripts that run on a host
separate from the target device. The continuous fuzzing loop
is driven by a Python program, as illustrated in Figure 4. The
manager process runs in a loop in which it (i) polls the status
of the fuzzing process, (ii) starts/restarts fuzzing if required,
(iii) detects device reboots, (iv) downloads the kernel log and
the last input generated before the crash after a reboot, and (v)
examines the last kernel log to identify the issue that led to the
crash.4 The manager stores the reports and the last crashing
inputs for investigation and bug reporting.

VI. EVALUATION

We evaluated PERISCOPE and PERIFUZZ by monitoring
and fuzzing the communication between two popular Wi-Fi
chipsets and their device drivers used in several Android
smartphones.

A. Target Drivers

We chose Wi-Fi drivers as our evaluation target because
they present a large attack surface, as evidenced by a recent se-
ries of fully remote exploits [16], [23]. Smartphones frequently
connect to potentially untrusted Wi-Fi access points, and Wi-Fi
drivers and peripherals implement vendor-speciﬁc, complex
internal device-driver interaction protocols (e.g., for ofﬂoading
tasks) that rely heavily on DMA-based communication.

The Wi-Fi peripheral chipset market for smartphones is
dominated by two major vendors: Broadcom and Qualcomm.
We tested two popular Android-based smartphones that each
have a Wi-Fi chipset from one of these vendors, as shown
in Table III. We tested the Google Pixel 2, with Android
8.0.0 Oreo5 and Qualcomm’s qcacld-3.0 Wi-Fi driver. We

4We used Syzkaller’s report package to parse the kernel log.
5android-8.0.0_r0.28

8

HostLast Input & Kernel logQuery reportStart FuzzingCrashReportManager(Re)start FuzzingTABLE VI.

ALLOCATION CONTEXTS SELECTED FOR FUZZING. DC

STANDS FOR DMA COHERENT, DS FOR DMA STREAMING, AND MM FOR
MEMORY-MAPPED I/O.

Driver

qcacld-3.0

bcmdhd4358

Alloc.
Context
QC1
QC2
QC3
QC4

BC1
BC2
BC3
BC4

Alloc.
Type
DC
DC
DS
DS

DC
DC
DC
MM

Alloc.
Size
8200
4
2112
2112

8192
16384
1536
4194304

Used For

DMA buffer mgmt.
DMA buffer mgmt.
FW-Driver message
FW-Driver message

FW-Driver RX info
FW-Driver TX info
FW-Driver ctrl. info
Ring ctrl. info

respectively. Some of the code that executes in interrupt
context may not be reachable from any system calls through
legal control-ﬂow paths, and therefore may not be fuzzed by
system call fuzzers.

C. Target Mappings

We investigated how each of the active mappings are
used by their respective drivers, and enabled fuzzing for
DMA/MMIO regions that are accessed frequently, and that
are used for low-level communication between the driver and
the device ﬁrmware (e.g., for shared ring buffer management).
We used PERISCOPE to determine which regions the driver
accesses frequently, and we manually investigated the driver’s
code to determine the purpose of each region.

For qcacld-3.0, we enabled fuzzing for two allocation
contexts for DMA coherent buffers and two contexts for DMA
streaming buffers. For bcmdhd4358, we enabled fuzzing for
three allocation contexts for DMA coherent buffers and one
allocation context for an MMIO buffer. Table VI summarizes
the allocation contexts for which we enable fuzzing; all the
mappings allocated in those contexts are fuzzed.

D. Fuzzer Seed Generation

We used PERISCOPE’s default tracing facilities to generate
initial seed input ﬁles. For each selected allocation context,
we ﬁrst recorded all allocations of, and all read accesses to
the memory mappings while generating web browsing trafﬁc
for ﬁve minutes. We then parsed the allocation/access log to
generate unique seed input ﬁles. Finally, we used AFL’s corpus
minimization tool to minimize the input ﬁles. This tool replays
each input ﬁle to collect coverage information and uses that
information to exclude redundant ﬁles.

E. Vulnerabilities Discovered

Table VII summarizes the vulnerabilities we discovered us-
ing our fuzzer. Each entry in the table is a unique vulnerability
at a distinct source code location.

Disclosure: We responsibly disclosed these vulnerabil-
ities to the respective vendors. During this process, we were
informed by Qualcomm that some of the bugs had recently
been reported by external researchers or internal auditors.
We marked these bugs as “Known”. All the remaining bugs
were previously unknown, and have been conﬁrmed by the
respective vendors. We included CVE numbers assigned to
the bugs we reported. Also, we included the vendor-speciﬁc,

internal severity ratings for these bugs if communicated by the
respective vendors during the disclosure process.

Error Type and Impact: Vulnerabilities found by PER-
IFUZZ fall into four categories: buffer overﬂows, address leaks,
reachable assertions, and null-pointer dereferences. We mark
buffer overﬂows and address leaks as potentially exploitable,
and reachable assertions and null-pointer dereferences as vul-
nerabilities that can cause a denial-of-service (DoS) attack by
triggering device reboots.

Double-fetch Bugs: We did not attempt to ﬁnd double-
fetch bugs in streaming DMA buffers, since we operated
under the assumption that an IOMMU preventing such bugs
is in place (see Section IV-A). That said, we did identify
several double-fetch bugs in code that accesses coherent DMA
buffers. These bugs can potentially be exploited, even when the
system deploys an IOMMU. We discuss these bugs in detail
in Section VI-G.

F. Case Study I: Design Bug in qcacld-3.0

One of the vulnerabilities we found in qcacld-3.0 is in
code that dereferences a ﬁrmware-provided pointer. PERIFUZZ
fuzzed the pointer value as it was read by the device driver.
The driver then dereferenced the fuzzed pointer and crashed
the kernel. An analysis of this vulnerability revealed that it is in
fact a design issue. The pointer was originally provided by the
driver to the device. Line 11 in Listing 1 turns a kernel virtual
address, which points to a kernel memory region allocated at
Line 4, into a 64-bit integer called cookie. The driver sends
this cookie value to the device, thereby effectively leaking a
kernel address.

1

2

3

4

5

6

7

8

9

10

11

12

13

14

A_STATUS ol_txrx_fw_stats_get(...)
{

...
non_volatile_req =
(cid:44)→
if (!non_volatile_req)
return A_NO_MEMORY;

qdf_mem_malloc(sizeof(*non_volatile_req));

...

address as the cookie */

/* use the non-volatile request object's
(cid:44)→
cookie =
(cid:44)→

ol_txrx_stats_ptr_to_u64(non_volatile_req);

...

}

Listing 1: Kernel address leak in qcacld-3.0

An attacker that controls the peripheral processor can infer
the kernel memory layout based on the cookie values passed
by the driver. This address leak can facilitate exploitation
of memory corruption vulnerabilities even if the kernel uses
randomization-based mitigations such as KASLR. This bug
can be ﬁxed by passing a randomly generated cookie value
rather than a pointer to the device.

G. Case Study II: Double-fetch Bugs in bcmdhd4358

The bcmdhd4358 driver contains several double-fetch
bugs that allow an adversarial Wi-Fi chip to bypass an integrity
check in the driver. Listing 2 shows how the driver accesses

9

TABLE VII.

UNIQUE DEVICE DRIVER VULNERABILITIES FOUND BY PERIFUZZ

Double-fetch

Analysis

Error Type

Alloc.
Type
DC
DS
DS
DS
DS
DS
DS
DS
DS
DC
DC
DC
DC
DC
MM

Alloc.
Context
QC2
QC3
QC3
QC3
QC3
QC3
QC4
QC4
QC4
BC1
BC2
BC2
BC2
BC2
BC4
aQualcomm conﬁrmed the vulnerability but they do not assign CVEs for low-severity ones.
bCVE assigned for the address leak.

Unexpected RX queue index
Unexpected message type
Unexpected peer id
Unexpected number of ﬂows
Unexpected FW-provided pointer
Unexpected TX descriptor id
Unexpected endpoint id
Duplicate message
Unexpected payload length
Unexpected interface id
Unexpected ring id in create rsp.
Unexpected ring id in delete rsp.
Unexpected ring id in ﬂush rsp.
Uninitialized ﬂow ring state
Unexpected ﬂow ring pointer

Buffer Overﬂow
Null-pointer Deref.
Buffer Overﬂow
Buffer Overﬂow
Address Leak/Buffer Ovf.
Buffer Overﬂow
Reachable Assertion
Reachable Assertion
Reachable Assertion
Buffer Overﬂow
Buffer Overﬂow
Buffer Overﬂow
Buffer Overﬂow
Null-pointer Deref.
Buffer Overﬂow

(cid:51)
(cid:51)
(cid:51)
(cid:51)

Status (Severity)

Impact

CVE-2018-11902 (High)
Conﬁrmed (Low)a
Known
Known
CVE-2018-11947 (Med)b
Known
Known (Med)
Known (Med)
Known (Med)
CVE-2018-14852, SVE-2018-11784 (Low)
CVE-2018-14856, SVE-2018-11785 (Low)
CVE-2018-14854, SVE-2018-11785 (Low)
CVE-2018-14855, SVE-2018-11785 (Low)
CVE-2018-14853, SVE-2018-11783 (Low)
CVE-2018-14745, SVE-2018-12029 (Low)

Likely Exploitable
DoS
Likely Exploitable
Likely Exploitable
Likely Exploitable
Likely Exploitable
DoS
DoS
DoS
Likely Exploitable
Likely Exploitable
Likely Exploitable
Likely Exploitable
DoS
Likely Exploitable

a coherent DMA buffer that holds meta-information about
network data. At Line 4 and Line 5, the driver veriﬁes the
integrity of the data in the buffer by calculating and checking
an XOR checksum. The driver then repeatedly accesses this
coherent DMA buffer again. The problem here is that the
device, if compromised, could modify the data between the
point of the initial integrity check, and the subsequent accesses
by the driver.

1

2

3

4

5

6

7

8

9

10

11

12

static uint8 BCMFASTPATH
(cid:44)→

dhd_prot_d2h_sync_xorcsum(dhd_pub_t *dhd,
msgbuf_ring_t *ring, volatile cmn_msg_hdr_t
*msg, int msglen)

(cid:44)→

(cid:44)→
{

...
prot_checksum = bcm_compute_xor32((volatile
(cid:44)→
if (prot_checksum == 0U) { /* checksum is OK */

uint32 *)msg, num_words);

if (msg->epoch == ring_seqnum) {

ring->seqnum++; /* next expected sequence
(cid:44)→
goto dma_completed;

number */

}

}
...

}

Listing 2: Initial fetch and integrity check in bcmdhd4358

PERIFUZZ was able to trigger multiple vulnerabilities by
modifying the data read from this buffer after the integrity
check was completed. We show one buffer overﬂow vulnera-
bility in Listing 3, which was triggered by fuzzing the ifidx
value used at Line 4. The overlapping fetch that occurred
before this buffer overﬂow is a double-fetch bug, because the
overlapping fetch can invalidate a previously passed buffer
integrity check. Thus, in addition to safeguarding the array
access with a bounds check, the driver should copy the contents
of the coherent DMA buffers to a location that cannot be
accessed by the peripheral device, before checking the integrity
of the data in the buffer. Subsequent uses of device-provided
data should also read from the copy of the data, rather than
the DMA buffer itself.

1

2

3

4

5

6

7

8

9

10

11

12

void dhd_rx_frame(dhd_pub_t *dhdp, int ifidx,
void *pktbuf, int numpkt, uint8 chan)
(cid:44)→
{

...
ifp = dhd->iflist[ifidx];
if (ifp == NULL) {

DHD_ERROR(("%s: ifp is NULL. drop packet\n",

__FUNCTION__));

PKTFREE(dhdp->osh, pktbuf, FALSE);
continue;

}
...

}

Listing 3: Buffer overﬂow in bcmdhd4358

H. Case Study III: New Bug in qcacld-3.0

Listing 4 shows a null-pointer deference bug we discovered
in the qcacld-3.0 driver. The pointer to the netbufs_ring
array dereferenced at Line 9 is null, unless the driver is conﬁg-
ured to explicitly allocate this array. The driver conﬁguration
used by the Google Pixel 2 did not contain the entry necessary
to allocate the array. Although the driver never executes the
vulnerable code under normal conditions, we found that the
vulnerable line is reachable through legal control ﬂow paths.

static inline qdf_nbuf_t
(cid:44)→
{

htt_rx_netbuf_pop(htt_pdev_handle pdev)

int idx;
qdf_nbuf_t msdu;

HTT_ASSERT1(htt_rx_ring_elems(pdev) != 0);

idx = pdev->rx_ring.sw_rd_idx.msdu_payld;
msdu = pdev->rx_ring.buf.netbufs_ring[idx];
...

1

2

3

4

5

6

7

8

9

10

11

}

Listing 4: Null-pointer dereference in qcacld-3.0

It is difﬁcult to detect this bug statically, as it requires a
whole-program analysis of the device driver to determine if the
netbufs_ring pointer is initialized whenever the vulnerable
line can execute. PERIFUZZ consistently triggered the bug,

10

TABLE VIII.

TIME CONSUMED BY PERISCOPE’S PAGE FAULT

TABLE IX.

PEAK FUZZING THROUGHPUT FOR EACH FUZZED

HANDLER (MEASURED IN µ SECONDS)

ALLOCATION CONTEXT

Tracing Only
Tracing + Fuzzing

Mean

117.6
227.8

Minimum Maximum

99.8
182.7

194.5
379.7

however. This vulnerability discovery therefore bolsters the
argument that fuzzing can complement manual auditing and
static analysis.

I. Performance Analysis

1) Page Fault: PERISCOPE incurs run-time overhead as it
triggers a page fault for every instruction that accesses the
monitored set of DMA/MMIO regions. We quantiﬁed this
overhead by measuring the number of clock cycles spent
inside PERISCOPE’s page fault handler. We read the AArch64
counter-timer virtual count register CNTVCT_EL0 when enter-
ing the handler and when exiting from the handler, and calcu-
lated the difference between the counter values, divided by the
counter-timer frequency counter CNTFRQ_EL0. To minimize
interference, we disabled hardware interrupts while executing
our page fault handler. We also disabled dynamic frequency
and voltage scaling.

We tested the page fault handler under two conﬁgurations.
In one conﬁguration, PERISCOPE calls the default pre- and
post-instruction hooks that only trace and log memory ac-
cesses. In the other conﬁguration, we registered PERIFUZZ’s
instruction hooks to enable DMA/MMIO fuzzing. Table VIII
shows the mean, minimum, and maximum values over samples
of 500 page fault handler invocations for each conﬁguration.

Note that we deliberately trade performance for deter-
ministic, precise monitoring of device-driver interactions, by
trapping every single access to a set of monitored mappings. In
fact, this design allowed us to temporally distinguish accesses
to the same memory locations, which was essential to ﬁnd the
double-fetch bugs. The drivers still function correctly, albeit
more slowly, when executed under our system, making it
possible to examine device-driver interactions dynamically and
enabling PERIFUZZ to fuzz it.

2) Fuzzing: PERIFUZZ builds on PERISCOPE and has ad-
ditional components that interact with each other, which incur
additional costs. The primary contributors to this additional
cost are: (i) waiting for the peripheral to signal the driver, (ii)
waiting for a software interrupt to be scheduled by the Linux
scheduling subsystem, (iii) interactions with the user-space
fuzzer, which involve at least two user-kernel mode switches
(i.e., one for delivering fuzzer inputs and the other for polling
and retrieving feedback), and (iv) other system activities.

Peak Throughput: We measured the overall fuzzing
throughput to quantify the overhead incorporating all interac-
tions between the PERIFUZZ components. We only report the
peak throughput in Table IX, since crashes and device driver
lockups heavily impact the average fuzzing throughput (see
Section VII-A). The inverse of the peak fuzzing throughput
is a conservative lower bound for the execution time required
to process a single fuzzer-generated input. Although we did
not optimize PERIFUZZ for throughput, we believe that these
numbers are still in a range that makes PERIFUZZ practical
for dynamic analysis.

Driver

qcacld-3.0

bcmdhd4358

Alloc.
Context
QC1
QC2
QC3
QC4

BC1
BC2
BC3
BC4

Peak Throughput
(# of test inputs/sec)
23.67
15.64
18.77
7.63

9.90
14.28
10.49
15.92

Waiting for fuzzer input
Waiting for interrupts
Fuzzing at page faults

10

20

30

40

50

60

70

80

90

100

(a) The execution time of three phases

Fuzzed+Missed
Fuzzed

140

120

100

80

60

40

20

300

275

250

225

200

175

150

125

100

75

50

25

n
o
i
t
a
r
e
t
I

/

)
s

m

(

e
m
T

i

n
o
i
t
a
r
e
t
I

/

s
t
l
u
a
f

e
g
a
p

f
o

#

10

20

30

40

50

60

70

80

90

100

(b) The number of fuzzed and missed page faults

Fig. 5. Fuzzing overhead breakdown

Overhead Breakdown: To illustrate how the fuzzing
throughput can be optimized, we present a breakdown of the
fuzzing overhead. We divide each iteration of the fuzzing loop
into three phases: (i) waiting for fuzzer input to be made
available to our kernel module, (ii) waiting for the device
to raise an interrupt and for the driver to start processing it,
and (iii) fuzzing the data read from monitored I/O mappings
upon page faults. Once the driver has ﬁnished processing the
interrupt, the next iteration begins. We measured the execution
time of each phase in each iteration. To evaluate the impact of
page faults on the fuzzing performance, we also counted the
number of page faults triggered during each iteration.

We performed the experiment while fuzzing the buffer
having the highest peak throughput (QC1). Figure 5a shows
our measurements of per-phase execution time in a stacked
manner, over 100 consecutive iterations of the fuzzing loop.
60% of the total execution time is spent on waiting for the next
fuzzer input to be available. This delay is primarily caused by
a large number of missed page faults, as hinted by Figure 5b.

11

The current implementation of PERIFUZZ can miss page faults,
when they are triggered while PERIFUZZ is preparing for the
next input. This delay can be reduced by disabling page faults
until the next input is ready. The delay caused by waiting
for relevant interrupts, which accounts for 24.2% of the total
execution time, can be reduced by forcing hardware to raise
relevant interrupts more frequently.

The actual fuzzing at each page fault still takes 15.8% of
the total execution time. One way to reduce this overhead is to
trigger page faults only at ﬁrst access to a monitored mapping
within each iteration. At ﬁrst access, the underlying page can
be overwritten with the fuzzer input and then made present, so
that subsequent accesses to the page within the same iteration
do not trigger extra page faults. This would come, however,
at the cost of precision, because it loses precise access tracing
capability, effectively disabling overlapping fetch fuzzing as
well as detection of potential double-fetch bugs.

B. Augmenting the Fuzzing Engine

Although we used mutational, feedback-guided fuzzing to
mutate the data stream on the device-driver interaction path,
our fuzzing framework can also beneﬁt from other fuzzing
techniques. Like DIFUZE [35], static analysis can be intro-
duced to infer the type of an I/O buffer, which can save fuzzing
cycles by respecting the target type when mutating a value. The
dependencies between device-driver interaction messages can
also be inferred using static and trace analysis techniques [41],
[58], which can help fuzzing stateful device-driver interaction
protocols. Alternatively, developers can specify the format of
an I/O buffer and/or interaction protocol in a domain-speciﬁc
language [10], [75]. In addition to improving the mutation
of the data stream, we could use system call fuzzers such
as Syzkaller that generate different user-space programs [75].
These generated programs could actively send requests to the
driver and potentially to the device, which in turn can increase
reachable interrupt code paths. We believe that our modular
framework allows for easy integration of these techniques.

VII. DISCUSSION

C. Combining with Dynamic Analysis

A. Limitations

We discuss problems that limit both the effectiveness and
efﬁciency of PERIFUZZ. These are well-known problems that
also affect other kernel fuzzers, such as system call fuzzers.

1) System Crashes: The OS typically terminates user-space
programs when they crash, and they can be restarted without
much delay. Crashing a user-space program therefore has little
impact on the throughput of fuzzing user-space programs.
Crashes in kernel space, by contrast, cause a system reboot,
which signiﬁcantly lowers the throughput of any kernel fuzzer.
This is particularly problematic if the fuzzer repeatedly hits
shallow bugs, thereby choking the system without making
meaningful progress. We circumvented this problem by dis-
abling certain code paths that contain previously discovered
shallow bugs. This does, however, somewhat reduce the effec-
tiveness of our fuzzer as it cannot traverse the subpaths rooted
at these blacklisted bugs. Note that this problem also affects
other kernel fuzzers, e.g., DIFUZE and Syzkaller [35], [75].

2) Driver Internal States: Due to the signiﬁcant latency
involved in system restarts, whole-system fuzzers typically
fuzz the system without restarting it between fuzzing iterations.
This can limit the effectiveness of such fuzzers, because the
internal states of the target system persist across iterations.
Changing internal states can also lead to instability in the
coverage-guidance, as the same input can exercise different
code paths depending on the system state. This means that
coverage-guidance may not be fully effective. Worse, when
changes to the persisting states accumulate, the device driver
may eventually lock itself up. For example, we encountered
a problem where, after feeding a certain number of invalid
inputs to a driver, the driver decided to disconnect from the
network, reaching an error state from which the driver could
not recover without a device reboot. Existing device driver
checkpointing and recovery mechanisms could be adapted
to alleviate the problem [46], [70], because they provide
mechanisms to roll drivers back to an earlier state. Such a roll
back takes signiﬁcantly less time than a full system reboot.

Our framework runs in a concrete execution environment;
thus, existing dynamic analysis tools can be used to uncover
silent bugs. For example, kernel sanitizers such as address
sanitizer and undeﬁned behavior sanitizer can complement our
fuzzer [48], [63]. Memory safety bugs often silently corrupt
memory without crashing the kernel. Our fuzzer, by itself,
would not be able to reveal such bugs. When combined with
these bugs would be detected. Other
a sanitizer, however,
dynamic analysis techniques such as dynamic taint tracking
can also be adapted to detect security-critical semantic bugs
such as passing security-sensitive values (e.g., kernel virtual
addresses) to untrusted peripherals.

VIII. RELATED WORK

A. Protection against Peripheral Attacks

An IOMMU isolates peripherals from the main processor
by limiting access to physical memory to regions conﬁgured
by the OS. Markuze et al. proposed mechanisms that can
achieve strong IOMMU protection at an affordable perfor-
mance cost [52], [53]. Several other work proposed mech-
anisms that can limit functionalities exposed to potentially
malicious devices [15], [72], [73]. Cinch encapsulates devices
as network endpoints [15], and USBFILTER hooks USB
APIs [73],
to enable user-conﬁgurable, ﬁne-grained access
control. However, neither IOMMU protection nor ﬁne-grained
access control prevents exploitation of vulnerabilities found in
code paths that are still reachable from the device.

The effects of vulnerabilities on these valid code paths can
be mitigated by isolating device drivers from the kernel [27],
[34], [38], [50]. Android, for example, switched from the
kernel-space Bluetooth protocol stack [12] to a user-space
Bluetooth stack [13]. The OS kernel merely acts as a data path
by forwarding incoming packets to the user-space Bluetooth
daemon process. This approach can mitigate vulnerabilities in
the device driver because the driver cannot access kernel mem-
ory and cannot execute privileged instructions. The daemon
process still runs at a higher privilege level than standard user-
space processes, however, and therefore remains an attractive

12

target for adversaries looking to access sensitive data [11].
Additionally, this approach is currently not viable for certain
types of device drivers. High-bandwidth communication de-
vices such as Wi-Fi chips, for example, cannot afford the mode
and context switching overhead incurred by user-space drivers.

B. Kernel Fuzzing

Most kernel fuzzing tools focus on the system call bound-
ary [9], [14], [19], [35], [41], [43], [58], [59], [65], [75].
DIFUZE uses static analysis and performs type-aware fuzzing
of the IOCTL interface, which can expose a substantial
amount of driver functionality to user space [35]. Syzkaller,
a coverage-guided fuzzer, fuzzes a broader set of system
calls, based on system call description written in a domain-
speciﬁc language [75].
IMF infers value-dependence and
order-dependence between system call arguments by analyzing
system call traces [41]. kAFL uses Intel Processor Trace as a
feedback mechanism, to enable OS-independent fuzzing [65].
Digtool uses virtualization to capture and analyze the dynamic
behavior of kernel execution [59].

PERIFUZZ can be augmented with techniques that facilitate
type-aware fuzzing [35], [41], [58], [75], as discussed in
Section VII-B. Tools based on certain hardware features can
fuzz closed-source OSes [59], [65], but smartphones often do
not contain or expose the necessary hardware features to the
end user. For example, most smartphone OSes block access to
the bootloader and to hypervisor mode, thus preventing end
users from running code at the highest privilege level [61].
None of these fuzzers target DMA/MMIO-based interactions
between drivers and devices, nor do they cover code paths that
are not reachable from system calls (e.g., interrupt handlers).

C. Kernel Tracing

There are many general-purpose tools to monitor events in
the Linux kernel. Static kernel instrumentation mechanisms
such as Tracepoint allow the developer to insert so-called
probes [5]. Ftrace and Kprobe are dynamic mechanisms that
can be used to probe functions or individual instructions [6],
[7]. eBPF, the extended version of the Berkeley Packet Filter
mechanism, can attach itself to existing Kprobe and Tracepoint
probes for further processing [40]. LTTng, SystemTap, Ktap
and Dprobe are higher level primitives that build on the
aforementioned tools [2]–[4], [55].

These tools, however, are not well suited to monitoring
device-driver interactions, because they require developers to
identify and instrument each device-driver interaction. These
manual efforts can be alleviated by using page fault based
monitoring, which Mmiotrace uses to trace MMIO-based in-
teractions in x86 and x86-64 [8]. However, Mmiotrace does not
support the DMA interface, i.e., DMA coherent and streaming
buffers, and it lacks the ability to manipulate device-driver
interactions. In contrast, PERISCOPE can trace both MMIO and
DMA interfaces, and can be used to manipulate device-driver
interactions by plugging in PERIFUZZ, enabling adversarial
analysis of device drivers.

D. Kernel Static Analysis

Static analysis tools can detect various types of kernel and
driver vulnerabilities [18], [39], [51], [76], [79]. Dr. Checker

runs pointer and taint analyses speciﬁcally tailored to device
drivers, and feeds the analysis results to various vulnerability
detectors [51]. K-Miner uses an inter-procedural, context-
sensitive pointer analysis to ﬁnd memory corruption vulner-
abilities reachable from system calls [39]. Symbolic execution
can complement these static analyses to work around precision
issues. Deadline [79], for example, uses static analysis to ﬁnd
multi-reads in the kernel, and symbolically checks whether
each multi-read satisﬁes the constraints to be a double-fetch
bug. With the help of this symbolic checking, Deadline can
precisely discern double-fetch bugs from statically identiﬁed
multi-reads. Generally speaking, however, techniques based
on symbolic execution may not scale well due to the path
explosion problem.

Static analysis techniques have traditionally been applied
to the system call interface only. Although the core ideas can
apply to the hardware-OS interface too, statically identifying
the necessary entry points may not be as trivial as with
system calls, since accesses to an I/O mapping are difﬁcult
to distinguish from other memory accesses, and interrupt
processing code can run in different, unrelated contexts (e.g.,
software interrupt context, kernel thread context, etc.).

E. Finding Double-fetch Bugs

Double-fetch bugs are a special case of time-of-check-to-
time-of-use (TOCTTOU) race conditions. They occur when
privileged code fetches a value from a memory location
multiple times, while less privileged code is able to change the
value between the fetches [45], [68]. Previous work explored
multiple reads of user-space memory from OS kernels or
from trusted execution environments [45], [59], [67], [76],
[79], and multiple reads of memory shared between different
hypervisor domains [78]. They either use static analysis (e.g.,
static code pattern matching [76] and symbolic execution [79]),
or dynamic analysis (e.g., memory access tracing followed by
pattern analysis [45], [59], [78] and cache behavior-guided
fuzzing [67]). PERIFUZZ is also a dynamic approach, but
targets a different attack surface: I/O memory mappings shared
between peripheral devices and kernel drivers.

instrumentation or manual analysis of

PERIFUZZ and DECAF are currently the only two tools
that are sufﬁciently generic to support double-fetch fuzzing
the target
without
code [67]. DECAF cannot fuzz double-fetches from MMIO
and DMA coherent mappings, however, because these map-
pings are typically uncached, and DECAF relies on cache side
channels to detect double-fetches.

IX. CONCLUSION

The interactions between peripherals and drivers can be
complex, and hence writing correct device driver software
is hard. Unfortunately, as has been recently demonstrated,
vulnerabilities in wireless communication peripherals and cor-
responding drivers can be exploited to achieve remote kernel
code execution without invoking a single system call. Nonethe-
less, no versatile framework has existed until now that analyzes
the interactions between peripherals and drivers.

This paper presents PERISCOPE, a generic probing frame-
work that addresses the speciﬁc analysis needs of the two pe-
ripheral interface mechanisms MMIO and DMA. Our fuzzing

13

component PERIFUZZ builds upon this framework and can
help the end user ﬁnd bugs in device drivers reachable from a
compromised device; uniquely, PERIFUZZ can expose double-
fetch bugs by fuzzing overlapping fetches, and by warning
about overlapping fetches that occurred before a driver crash.
Using these tools, we found 15 unique vulnerabilities in the
Wi-Fi drivers of two ﬂagship Android smartphones, including
9 previously unknown ones.

ACKNOWLEDGMENT

The authors would like to thank the anonymous reviewers
for their valuable feedback. The authors also thank Paul Kirth
and Joseph Nash for their help with proofreading this paper.
This material is based upon work partially supported by the
Defense Advanced Research Projects Agency under contracts
FA8750-15-C-0124 and FA8750-15-C-0085, by the United
States Ofﬁce of Naval Research under contract N00014-15-
1-2948, N00014-17-1-2011, and N00014-17-1-2782, and by
the National Science Foundation under awards CNS-1619211
and CNS-1513837. Any opinions, ﬁndings, and conclusions or
recommendations expressed in this material are those of the
authors and do not necessarily reﬂect the views of the Defense
Advanced Research Projects Agency or its Contracting Agents,
the Ofﬁce of Naval Research or its Contracting Agents, the
National Science Foundation, or any other agency of the
U.S. Government. The authors also gratefully acknowledge a
gift from Oracle Corporation, and from Google’s Anti-Abuse
group.

REFERENCES

[1]

[2]

[3]
[4]
[5]

[6]

[7]

[8]

[9]

[10]

[11]

[12]

[13]

[14]

“Facedancer11.” [Online]. Available: http://goodfet.sourceforge.net/
hardware/facedancer11
“ktap: A lightweight script-based dynamic tracing tool for Linux.”
[Online]. Available: https://github.com/ktap/ktap
“LTTng.” [Online]. Available: https://lttng.org
“SystemTap.” [Online]. Available: https://sourceware.org/systemtap
“Using the Linux kernel Tracepoints.” [Online]. Available: https:
//www.kernel.org/doc/Documentation/trace/tracepoints.txt
“Kernel probes (Kprobes),” 2004. [Online]. Available: https://www.
kernel.org/doc/Documentation/kprobes.txt
“ftrace - function tracer,” 2008. [Online]. Available: https://www.
kernel.org/doc/Documentation/trace/ftrace.txt
“Memory mapped I/O trace,” 2014.
//nouveau.freedesktop.org/wiki/MmioTrace
“Project Triforce: Run AFL on everything!” 2016. [Online]. Avail-
able:
https://www.nccgroup.trust/us/about-us/newsroom-and-events/
blog/2016/june/project-triforce-run-aﬂ-on-everything
“ProtoFuzz: A protobuf
//blog.trailofbits.com/2016/05/18/protofuzz-a-protobuf-fuzzer
“BlueBorne vulnerabilities,” 2017. [Online]. Available: https://armis.
com/blueborne
“BlueZ: Ofﬁcial Linux Bluetooth protocol stack,” 2018. [Online].
Available: http://www.bluez.org
“Fluoride Bluetooth stack,” 2018. [Online]. Available: https://android.
googlesource.com/platform/system/bt
“Trinity: Linux system call
https://github.com/kernelslacker/trinity

[Online]. Available: https:

[Online]. Available: https:

[Online]. Available:

fuzzer,” 2018.

fuzzer,” 2016.

[15] S. Angel, R. S. Wahby, M. Howald, J. B. Leners, M. Spilo, Z. Sun, A. J.
Blumberg, and M. Walﬁsh, “Defending against malicious peripherals
with Cinch,” in Proceedings of the USENIX Security Symposium, 2016.
[16] N. Artenstein, “BroadPwn: Remotely compromising Android and iOS
via a bug in Broadcom’s Wi-Fi chipsets,” Black Hat USA, 2017.

14

[17] D. Aumaitre and C. Devine, “Subverting Windows 7 x64 kernel with

DMA attacks,” HITBSecConf Amsterdam, 2010.

[18] T. Ball, E. Bounimova, B. Cook, V. Levin, J. Lichtenberg, C. McGarvey,
B. Ondrusek, S. K. Rajamani, and A. Ustuner, “Thorough static analysis
of device drivers,” in Proceedings of the ACM European Conference on
Computer Systems (EuroSys), 2006.
I. Beer,
II,” 2014.
[Online]. Available: https://googleprojectzero.blogspot.com/2014/11/
pwn4fun-spring-2014-safari-part-ii.html

“pwn4fun spring 2014 - Safari

- part

[19]

[20] F. Bellard, “QEMU, a fast and portable dynamic translator,” in Proceed-
ings of the USENIX Annual Technical Conference, FREENIX Track,
2005.

[21] G. Beniamini, “Over the air - vol. 2, pt. 2: Exploiting the Wi-Fi stack
on Apple devices,” 2017. [Online]. Available: https://googleprojectzero.
blogspot.com/2017/10/over-air-vol-2-pt-2-exploiting-wi-ﬁ.html
[22] ——, “Over the air - vol. 2, pt. 3: Exploiting the Wi-Fi stack on Apple
devices,” 2017. [Online]. Available: https://googleprojectzero.blogspot.
com/2017/10/over-air-vol-2-pt-3-exploiting-wi-ﬁ.html

[23] ——, “Over the air: Exploiting Broadcom’s Wi-Fi stack (part 1),”
2017. [Online]. Available: https://googleprojectzero.blogspot.com/2017/
04/over-air-exploiting-broadcoms-wi-ﬁ 4.html

[24] ——, “Over the air: Exploiting Broadcom’s Wi-Fi stack (part 2),”
2017. [Online]. Available: https://googleprojectzero.blogspot.com/2017/
04/over-air-exploiting-broadcoms-wi-ﬁ 11.html

[25] M. B¨ohme, V.-T. Pham, M.-D. Nguyen, and A. Roychoudhury, “Di-
rected greybox fuzzing,” in Proceedings of the ACM Conference on
Computer and Communications Security (CCS), 2017.

[26] M. B¨ohme, V.-T. Pham, and A. Roychoudhury, “Coverage-based grey-
box fuzzing as markov chain,” in Proceedings of the ACM Conference
on Computer and Communications Security (CCS), 2016.

[27] S. Boyd-Wickizer and N. Zeldovich, “Tolerating malicious device
drivers in Linux,” in Proceedings of the USENIX Annual Technical
Conference (ATC), 2010.

[28] A. Cama, “A walk with Shannon: A walkthrough of a pwn2own

baseband exploit,” OPCDE Kenya, 2018.

[29] Q. Casasnovas, “[patch] kcov: add AFL-style tracing,” 2016. [Online].

Available: https://lkml.org/lkml/2016/5/21/58

[30] H. Chen, Y. Xue, Y. Li, B. Chen, X. Xie, X. Wu, and Y. Liu, “Hawkeye:
Towards a desired directed grey-box fuzzer,” in Proceedings of the ACM
Conference on Computer and Communications Security (CCS), 2018.
[31] P. Chen and H. Chen, “Angora: Efﬁcient fuzzing by principled search,”
in Proceedings of the IEEE Symposium on Security and Privacy, 2018.
[32] V. Chipounov and G. Candea, “Reverse engineering of binary device
drivers with RevNIC,” in Proceedings of the ACM European Conference
on Computer Systems (EuroSys), 2010.

[33] V. Chipounov, V. Kuznetsov, and G. Candea, “S2E: A platform for in-
vivo multi-path analysis of software systems,” in Proceedings of the
International Conference on Architectural Support for Programming
Languages and Operating Systems (ASPLOS), 2011.

[34] P. Chubb, “Linux kernel infrastructure for user-level device drivers,” in

[35]

Linux Conference, 2004.
J. Corina, A. Machiry, C. Salls, Y. Shoshitaishvili, S. Hao, C. Kruegel,
and G. Vigna, “DIFUZE: Interface aware fuzzing for kernel drivers,” in
Proceedings of the ACM Conference on Computer and Communications
Security (CCS), 2017.

[36] L. Duﬂot, Y.-A. Perez, G. Valadon, and O. Levillain, “Can you still

trust your network card?” CanSecWest, 2010.

[37] S. Gan, C. Zhang, X. Qin, X. Tu, K. Li, Z. Pei, and Z. Chen, “CollAFL:
Path sensitive fuzzing,” in Proceedings of the IEEE Symposium on
Security and Privacy, 2018.

[38] V. Ganapathy, M. J. Renzelmann, A. Balakrishnan, M. M. Swift,
and S. Jha, “The design and implementation of microdrivers,” in
Proceedings of the International Conference on Architectural Support
for Programming Languages and Operating Systems (ASPLOS), 2008.
[39] D. Gens, S. Schmitt, L. Davi, and A.-R. Sadeghi, “K-Miner: Uncovering
the Network and

memory corruption in Linux,” in Proceedings of
Distributed System Security Symposium (NDSS), 2018.

[40] B. Gregg, “Linux extended BPF (eBPF) tracing tools,” 2018. [Online].

Available: http://www.brendangregg.com/ebpf.html

[41] H. Han and S. K. Cha, “IMF: Inferred model-based fuzzer,” in Pro-
ceedings of the ACM Conference on Computer and Communications
Security (CCS), 2017.
J. Hertz and T. Newsham, “A Linux system call
fuzzer using
TriforceAFL,” 2016. [Online]. Available: https://github.com/nccgroup/
TriforceLinuxSyscallFuzzer

[42]

[43] D. R. Jeong, K. Kim, B. Shivakumar, B. Lee, and I. Shin, “Razzer:
Finding kernel race bugs through fuzzing,” in Proceedings of the IEEE
Symposium on Security and Privacy, 2019, To appear.

[61] N. Redini, A. Machiry, D. Das, Y. Fratantonio, A. Bianchi, E. Gustafson,
Y. Shoshitaishvili, C. Kruegel, and G. Vigna, “BootStomp: On the
the
security of bootloaders in mobile devices,” in Proceedings of
USENIX Security Symposium, 2017.

[62] M. J. Renzelmann, A. Kadav, and M. M. Swift, “SymDrive: Testing
drivers without devices,” in Proceedings of the USENIX Symposium on
Operating Systems Design and Implementation (OSDI), 2012.
[63] A. Ryabinin, “UBSan: run-time undeﬁned behavior sanity checker,”

2014. [Online]. Available: https://lwn.net/Articles/617364

[44] M. Jodeit and M. Johns, “USB device drivers: A stepping stone into
your kernel,” in Proceedings of the European Conference on Computer
Network Defense (EC2ND), 2010.

[64] M. Schulz, D. Wegemer, and M. Hollick, “The Nexmon ﬁrmware anal-
ysis and modiﬁcation framework: Empowering researchers to enhance
Wi-Fi devices,” Computer Communications, 2018.

[45] M. Jurczyk and G. Coldwind, “Identifying and exploiting Windows

kernel race conditions via memory access patterns,” 2013.

[46] A. Kadav, M. J. Renzelmann, and M. M. Swift, “Fine-grained fault
tolerance using device checkpoints,” in Proceedings of the International
Conference on Architectural Support for Programming Languages and
Operating Systems (ASPLOS), 2013.

[47] S. Keil and C. Kolbitsch, “Stateful fuzzing of wireless device drivers

in an emulated environment,” Black Hat Japan, 2007.

[48] A. Konovalov and D. Vyukov, “KernelAddressSanitizer (KASan): a fast
memory error detector for the Linux kernel,” LinuxCon North America,
2015.

[49] V. Kuznetsov, V. Chipounov, and G. Candea, “Testing closed-source
binary device drivers with DDT,” in Proceedings of the USENIX Annual
Technical Conference (ATC), 2010.

[50] B. Leslie, P. Chubb, N. Fitzroy-Dale, S. G¨otz, C. Gray, L. Macpherson,
D. Potts, Y.-T. Shen, K. Elphinstone, and G. Heiser, “User-level device
drivers: Achieved performance,” Journal of Computer Science and
Technology, vol. 20, no. 5, pp. 654–664, 2005.

[51] A. Machiry, C. Spensky, J. Corina, N. Stephens, C. Kruegel, and
G. Vigna, “Dr. Checker: A soundy analysis for Linux kernel drivers,”
in Proceedings of the USENIX Security Symposium, 2017.

[52] A. Markuze, A. Morrison, and D. Tsafrir, “True IOMMU protection
from DMA attacks: When copy is faster than zero copy,” in Proceedings
of the International Conference on Architectural Support for Program-
ming Languages and Operating Systems (ASPLOS), 2016.

[53] A. Markuze, I. Smolyar, A. Morrison, and D. Tsafrir, “DAMN:
Overhead-free IOMMU protection for networking,” in Proceedings of
the International Conference on Architectural Support for Programming
Languages and Operating Systems (ASPLOS), 2018.

[54] M. Mendonc¸a and N. Neves, “Fuzzing Wi-Fi drivers to locate security
vulnerabilities,” in Proceedings of the European Dependable Computing
Conference (EDCC), 2008.

[55] R. J. Moore, “A universal dynamic trace for Linux and other operating
systems,” in Proceedings of the USENIX Annual Technical Conference,
FREENIX Track, 2001.

[56] M. Muench, J. Stijohann, F. Kargl, A. Francillon, and D. Balzarotti,
is not what you crash: Challenges in fuzzing
“What you corrupt
embedded devices,” in Proceedings of the Network and Distributed
System Security Symposium (NDSS), 2018.

[57] V. Nossum and Q. Casasnovas, “Filesystem fuzzing with american fuzzy

lop,” Vault, 2016.

[59]

[58] S. Pailoor, A. Aday, and S. Jana, “Moonshine: Optimizing OS fuzzer
seed selection with trace distillation,” in Proceedings of the USENIX
Security Symposium, 2018.
J. Pan, G. Yan, and X. Fan, “Digtool: A virtualization-based framework
for detecting kernel vulnerabilities,” in Proceedings of the USENIX
Security Symposium, 2017.
J. Patrick-Evans, L. Cavallaro, and J. Kinder, “POTUS: probing off-the-
shelf USB drivers with symbolic fault injection,” in Proceedings of the
USENIX Workshop on Offensive Technologies (WOOT), 2017.

[60]

[65] S. Schumilo, C. Aschermann, R. Gawlik, S. Schinzel, and T. Holz,
“kAFL: Hardware-assisted feedback fuzzing for OS kernels,” in Pro-
ceedings of the USENIX Security Symposium, 2017.

[66] S. Schumilo, R. Spenneberg, and H. Schwartke, “Don’t trust your USB!

how to ﬁnd bugs in USB device drivers,” Black Hat Europe, 2014.

[67] M. Schwarz, D. Gruss, M. Lipp, C. Maurice, T. Schuster, A. Fogh,
and S. Mangard, “Automated detection, exploitation, and elimination
of double-fetch bugs using modern CPU features,” in Proceedings of
the ACM Asia Conference on Computer and Communications Security
(ASIACCS), 2018.

[68] F. J. Serna, “MS08-061 : The case of the kernel mode double-fetch,”
2008. [Online]. Available: https://blogs.technet.microsoft.com/srd/2008/
10/14/ms08-061-the-case-of-the-kernel-mode-double-fetch

[69] P. Stewin and I. Bystrov, “Understanding DMA malware,” in Proceed-
ings of the Conference on Detection of Intrusions and Malware &
Vulnerability Assessment (DIMVA), 2012.

[70] M. M. Swift, M. Annamalai, B. N. Bershad, and H. M. Levy, “Re-
covering device drivers,” in Proceedings of the USENIX Symposium on
Operating Systems Design and Implementation (OSDI), 2004.
[71] S. M. S. Talebi, H. Tavakoli, H. Zhang, Z. Zhang, A. A. Sani, and
Z. Qian, “Charm: Facilitating dynamic analysis of device drivers of
mobile systems,” in Proceedings of the USENIX Security Symposium,
2018.

[72] D. J. Tian, A. Bates, and K. Butler, “Defending against malicious USB
ﬁrmware with GoodUSB,” in Proceedings of the Annual Computer
Security Applications Conference (ACSAC), 2015.

[73] D. J. Tian, N. Scaife, A. Bates, K. Butler, and P. Traynor, “Making USB
great again with USBFILTER,” in Proceedings of the USENIX Security
Symposium, 2016.

[74] D. Vyukov, “kernel: add kcov code coverage,” 2016.

[Online].

Available: https://lwn.net/Articles/671640

[75] ——, “syzkaller - kernel fuzzer,” 2018. [Online]. Available: https:

//github.com/google/syzkaller

[76] P. Wang, J. Krinke, K. Lu, G. Li, and S. Dodier-Lazaro, “How double-
fetch situations turn into double-fetch vulnerabilities: A study of double
fetches in the Linux kernel,” in Proceedings of the USENIX Security
Symposium, 2017.

[77] R.-P. Weinmann, “All your baseband are belong to us,” DeepSec, 2010.
[78] F. Wilhelm, “Xenpwn: Breaking paravirtualized devices,” Black Hat

USA, 2016.

[79] M. Xu, C. Qian, K. Lu, M. Backes, and T. Kim, “Precise and scalable
detection of double-fetch bugs in OS kernels,” in Proceedings of the
IEEE Symposium on Security and Privacy, 2018.
J. Zaddach, L. Bruno, A. Francillon, D. Balzarotti et al., “AVATAR: A
framework to support dynamic security analysis of embedded systems’
ﬁrmwares,” in Proceedings of the Network and Distributed System
Security Symposium (NDSS), 2014.

[80]

[81] M. Zalewski, “American fuzzy lop,” 2018.

[Online]. Available:

http://lcamtuf.coredump.cx/aﬂ

15



=== Content from github.com_dba769c8_20250126_054533.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffeatures%2Fcopilot)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Ffeatures%2Fcopilot&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GitHub Copilot](/features/copilot)Navigation menu. Current page: Overview

* Overview
* [Plans](/features/copilot/plans)
* [Tutorials](/features/copilot/tutorials)
* [Extensions](/features/copilot/extensions)
* [What’s new](/features/copilot/whats-new)
![](https://github.githubassets.com/assets/hero-bg-sm-11153e2d28f8.jpg)GitHub Copilot is now available for free
# The AI editor for everyone

[Get started for free](https://github.com/copilot)[See plans & pricing](/features/copilot/plans?cft=copilot_lo.features_copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) Visual Studio Code? Open nowPause
## GitHub Copilot is used by

![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)![Lyft](https://github.githubassets.com/assets/lyft-ff04a849adcd.svg)![FedEx](https://github.githubassets.com/assets/fedex-4fbd5209ba18.svg)![AT&T](https://github.githubassets.com/assets/atnt-a1d3c3d04a75.svg)![Shopify](https://github.githubassets.com/assets/shopify-c893630d6403.svg)![BMW](https://github.githubassets.com/assets/bmw-72cecc644c23.svg)![H&M](https://github.githubassets.com/assets/hnm-7f6d81c34913.svg)![Honeywell](https://github.githubassets.com/assets/honeywell-cbed470d5960.svg)![EY](https://github.githubassets.com/assets/ey-cd7494447821.svg)![Infosys](https://github.githubassets.com/assets/infosys-935e1fcdf87b.svg)![BBVA](https://github.githubassets.com/assets/bbva-538b46252b6e.svg)PauseFeatures
## Customizable. Contextual. AI-powerful.

PausePause

*Create tests, docs, and more.* Ask GitHub Copilot a question, get the right answer for you, and accept the code with a single click.[Our favorite Copilot prompts](https://docs.github.com/en/copilot/example-prompts-for-github-copilot-chat)

* *Answers that know how you code.* GitHub Copilot can use your code and Custom Instructions to code the way you prefer.
* *Create tests, docs, and more.* Ask GitHub Copilot to generate them and add them to your codebase with just one click.
### Choose your model

Use models like Anthropic's [Claude 3.5 Sonnet](https://docs.github.com/en/copilot/using-github-copilot/using-claude-sonnet-in-github-copilot), OpenAI o1, and GPT 4o to excel at coding tasks one minute — and deeper reasoning and understanding the next.

Pause
### Multi-file edits

Tell GitHub Copilot what to do, and watch it update multiple files right in your editor.

![GitHub Copilot including multiple files in a working set](https://github.githubassets.com/assets/copilot-multifile-3eb48ba0aedf.webp)
### Get AI-based suggestions in real time

GitHub Copilot suggests code completions as you type and turns natural language prompts into coding suggestions based on your project's conventions.

[Use slash commands](https://docs.github.com/en/copilot/using-github-copilot/asking-github-copilot-questions-in-your-ide#slash-commands)PausePause
### Instant feedback

Ask GitHub Copilot to review your work, uncover hidden bugs, fix mistakes, and more—before you get a human review.

[Get early access](https://github.com/features/preview/copilot-code-review)[![GitHub Copilot performing a code review](https://github.githubassets.com/assets/copilot-review-c1d2859ea8a2.webp)](https://github.com/features/preview/copilot-code-review)
### Extensions for your favorite tools

Check logs, create feature flags, and deploy apps—all from Copilot Chat, enhanced by an ecosystem of extensions from third party tools and services.

[Explore GitHub Copilot Extensions](https://github.com/features/copilot/extensions)[![GitHub Copilot Extensions for Azure, Datastax, Docker, MongoDB and Sentry](https://github.githubassets.com/assets/copilot-extensions-f78138bbfae2.webp)](https://github.com/features/copilot/extensions)
### Ask for assistance right in your terminal

[Try Copilot in the CLI](https://docs.github.com/copilot/using-github-copilot/using-github-copilot-in-the-command-line)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-3048272df3eb.webp)![Screenshot of GitHub Copilot CLI in a terminal](https://github.githubassets.com/assets/copilot-terminal-sm-d07a8373a1e6.webp)![](https://github.githubassets.com/assets/copilot-terminal-bg-826e922edd44.webp)
### Chat with your AI pair programmer on-the-go

[![Download GitHub on the Google Play Store](https://github.githubassets.com/assets/google-play-b4758bd0f618.png)](https://play.google.com/store/apps/details?id=com.github.android)[![Download GitHub on the Apple App Store](https://github.githubassets.com/assets/app-store-f73cb66283cf.png)](https://apps.apple.com/app/github/id1477376905?ls=1)![A phone showing GitHub Copilot in GitHub Mobile](https://github.githubassets.com/assets/copilot-mobile-828695350edc.webp)Pricing
## Take flight with GitHub Copilot

New
### Free

For developers looking to get started with GitHub Copilot.

$0 USD  [Get started](https://github.com/copilot)Already have ![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg) VS Code? Open nowIncludes up to 2,000 completions and 50 chat requests per month.Most popular
### Pro

For developers who want unlimited access to GitHub Copilot.

$10 USD per month. First 30 days free.[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)Free for verified students, teachers, and maintainers of popular open source projects. [Learn more](https://github.com/education)
### Business

For teams ready to accelerate their workflows with GitHub Copilot.

$19 USD per user / month[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_CopilotBusiness_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotBusiness)
### Enterprise

For organizations seeking a fully customized GitHub Copilot experience.

$39 USD per user / month[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)[Contact sales](/enterprise/contact?ref_cta=Contact+sales&ref_loc=pricing&ref_page=%2Ffeatures%2Fcopilot&scid=&utm_campaign=Copilot_feature_page_contact_sales_cta_CopilotEnterprise_utmroutercampaign&utm_medium=site&utm_source=github&cft=copilot_lo.features_copilot&utm_content=CopilotEnterprise)GitHub Copilot is available on your favorite platforms:

* [![](https://github.githubassets.com/assets/github-dae1693fc0e0.svg?v=1)GitHub](https://github.com/copilot) GitHub
* [![](https://github.githubassets.com/assets/vscode-41ed661450e9.svg?v=1)VS Code](https://marketplace.visualstudio.com/items?itemName=GitHub.copilot) VS Code
* [![](https://github.githubassets.com/assets/visualstudio-7b2c255a778e.svg?v=1)Visual Studio](https://visualstudio.microsoft.com/github-copilot) Visual Studio
* [![](https://github.githubassets.com/assets/xcode-b8ad451a19a6.svg?v=1)Xcode](https://github.com/github/CopilotForXcode) Xcode
* [![](https://github.githubassets.com/assets/jetbrains-04b2b7606878.svg?v=1)JetBrains IDEs](https://plugins.jetbrains.com/plugin/17718-github-copilot)JetBrains IDEs
* [![](https://github.githubassets.com/assets/neovim-c63bac91528a.svg?v=1)Neovim](https://github.com/github/copilot.vim) Neovim
* [![](https://github.githubassets.com/assets/azure-e978ccb08351.svg?v=1)Azure Data Studio](https://learn.microsoft.com/en-us/azure-data-studio/extensions/github-copilot-extension-overview)Azure Data Studio
Compare featuresFeaturesFreeProBusinessEnterprisePricing$0$10 per month$19 per user / month$39 per user / monthChatChatMessages and interactions Free planUp to 50 per monthUp to 50 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedAccess to OpenAI GPT-4o Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to Anthropic Claude 3.5 Sonnet Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1 Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewAccess to OpenAI o1-mini Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedContext-aware coding support and explanations Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebugging and security remediation assistance Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAccess to knowledge from top open source repositories Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGenerate tests, docs, and more with slash commands Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewWeb search powered by Bing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewExplain failed Actions jobs Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAnswers about issues, PRs, discussions, files, commits, etc. Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewMulti-file editing in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCode completionCode completionReal-time code suggestions Free planUp to 2,000 per monthUp to 2,000 per monthPro planUnlimitedUnlimitedBusiness planUnlimitedUnlimitedEnterprise planUnlimitedUnlimitedComments to code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCustomizationCustomizationTailor chat conversations to your private codebase (unlimited repositories indexed) Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUnlimited integrations with GitHub Copilot Extensions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewBuild a private extension for internal tooling Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewPersonalize responses with custom instructions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedAttach knowledge bases to chat for organizational context Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedFine-tuned models for code completion (coming soon as add-on) Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedSet coding guidelines for code review Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedAI-native experiencesAI-native experiencesInline chat and prompt suggestions Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSlash commands and context variables Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedCommit message generation Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedSummaries for pull requests, issues, and discussions Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode feedback in VS Code Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedExplanations in Visual Studio’s Quick Info Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedDebug assistant in Visual Studio Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewUpgrade assistant for Java in VS Code Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCode review in GitHub Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedPreviewCopilot Workspace in pull requests Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedTechnical Preview access to Copilot Workspace Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedSupported environmentsSupported environmentsEditors and IDEs  - [See all supported editors](https://docs.github.com/en/copilot/managing-copilot/configure-personal-settings/installing-the-github-copilot-extension-in-your-environment)Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedgithub.com Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub Mobile Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedGitHub CLI and Windows Terminal Free planNot includedPro planIncludedBusiness planIncludedEnterprise planIncludedManagement and policiesManagement and policiesPublic code filter with code referencing Free planIncludedPro planIncludedBusiness planIncludedEnterprise planIncludedUser management Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedData excluded from training by default Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedEnterprise-grade security Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedIP indemnity Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedContent exclusions Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedSAML SSO authentication [1](#footnote-1)Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedUsage metrics Free planNot includedPro planNot includedBusiness planIncludedEnterprise planIncludedRequires GitHub Enterprise Cloud Free planNot includedPro planNot includedBusiness planNot includedEnterprise planIncludedHow to get started[Get started](https://github.com/copilot)[Get started](/github-copilot/signup/copilot_individual?cft=copilot_lo.features_copilot.cfi)[Get started](/github-copilot/purchase?priority=business&cft=copilot_lo.features_copilot.cfb)[Get started](/github-copilot/purchase?priority=enterprise&cft=copilot_lo.features_copilot.ce)
## Get the most out of GitHub Copilot

### [Preview the latest features](https://github.com/features/preview)

Be the first to explore what’s next for GitHub Copilot.

See previews
### [Explore The GitHub Blog](https://github.blog/)

Discover the latest in software development with insights, best practices, and more.

Read Blog
### [Visit the GitHub Copilot Trust Center](https://copilot.github.trust.page/)

Gain peace of mind with our security, privacy, and responsible AI policies.

Go to Trust Center
### Frequently asked questions

#### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

#### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

#### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

#### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

GeneralPlans & PricingPrivacyResponsible AI
### General

#### What is GitHub Copilot?

GitHub Copilot transforms the developer experience. Backed by the leaders in AI, Copilot provides contextualized assistance throughout the software development lifecycle, from code completions and chat assistance in the IDE to code explanations and answers to docs in GitHub and more. With Copilot elevating their workflow, developers can focus on more: value, innovation, and happiness.

GitHub Copilot enables developers to focus more energy on problem solving and collaboration and spend less effort on the mundane and boilerplate. That’s why developers who use Copilot report up to 75% higher satisfaction with their jobs than those who don’t and are up to 55% more productive at writing code without sacrifice to quality, which all adds up to engaged developers shipping great software faster.

GitHub Copilot integrates with leading editors, including Visual Studio Code, Visual Studio, JetBrains IDEs, and Neovim, and, unlike other AI coding assistants, is natively built into GitHub. Growing to millions of individual users and tens of thousands of business customers, Copilot is the world’s most widely adopted AI developer tool and the competitive advantage developers ask for by name.

#### Who is eligible to access GitHub Copilot for free?

GitHub Copilot Free is a new free pricing tier with limited functionality for individual developers. Users assigned a Copilot Business or Copilot Enterprise seat are not eligible for access. Users with access to Copilot Pro through a paid subscription, trial, or through an existing verified OSS, Student, Faculty, or MVP account may elect to use Free instead.

#### What languages, IDEs, and platforms does GitHub Copilot support?

GitHub Copilot is trained on all languages that appear in public repositories. For each language, the quality of suggestions you receive may depend on the volume and diversity of training data for that language. For example, JavaScript is well-represented in public repositories and is one of GitHub Copilot’s best supported languages. Languages with less representation in public repositories may produce fewer or less robust suggestions.

GitHub Copilot is available as an extension in Visual Studio Code, Visual Studio, Vim, Neovim, the JetBrains suite of IDEs, and Azure Data Studio. Although code completion functionality is available across all these extensions, chat functionality is currently available only in Visual Studio Code, JetBrains and Visual Studio. GitHub Copilot is also supported in terminals through GitHub CLI and as a chat integration in Windows Terminal Canary. With the GitHub Copilot Enterprise plan, GitHub Copilot is natively integrated into GitHub.com. All plans are supported in GitHub Copilot in GitHub Mobile. GitHub Mobile for Copilot Pro and Copilot Business have access to Bing and public repository code search. Copilot Enterprise in GitHub Mobile gives you additional access to your organization's knowledge.

#### Does GitHub Copilot “copy/paste”?

No, GitHub Copilot generates suggestions using probabilistic determination.

* When thinking about intellectual property and open source issues, it is critical to understand how GitHub Copilot really works. The AI models that create Copilot’s suggestions may be trained on public code, but do not contain any code. When they generate a suggestion, they are not “copying and pasting” from any codebase.
* To generate a code suggestion, the Copilot extension begins by examining the code in your editor—focusing on the lines just before and after your cursor, but also information including other files open in your editor and the URLs of repositories or file paths to identify relevant context. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat in the code editor, the Copilot extension creates a contextual prompt by combining your prompt with additional context including the code file open in your active document, your code selection, and general workspace information, such as frameworks, languages, and dependencies. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.
* To generate a suggestion for chat on GitHub.com, such as providing an answer to a question from your chat prompt, Copilot creates a contextual prompt by combining your prompt with additional context including previous prompts, the open pages on GitHub.com as well as retrieved context from your codebase or Bing search. That information is sent to Copilot’s model, to make a probabilistic determination of what is likely to come next and generate suggestions.

#### What are the differences between the GitHub Copilot Business, GitHub Copilot Enterprise, and GitHub Copilot Individual plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Individual is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in [GitHub Advanced Security](https://github.com/enterprise/advanced-security).

#### What if I do not want Copilot?

Copilot is entirely optional and requires you to opt in before gaining access. You can easily configure its usage directly in the editor, enabling or disabling it at any time. Additionally, you have control over which file types Copilot is active for.

#### How do I control access to Copilot in my company?

Access to Copilot Business and Enterprise is managed by your GitHub Administrator. They can control access to preview features, models, and set Copilot policies for your organization. Additionally, you can use your network firewall to explicitly allow access to Copilot Business and/or block access to Copilot Pro or Free. For more details, refer to the [documentation](https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/managing-access-to-github-copilot-in-your-organization).

### Plans & Pricing

#### What are the differences between the Free, Pro, Business, and Enterprise plans?

GitHub Copilot has multiple offerings for organizations and an offering for individual developers. All the offerings include both code completion and chat assistance. The primary differences between the organization offerings and the individual offering are license management, policy management, and IP indemnity.

Organizations can choose between GitHub Copilot Business and GitHub Copilot Enterprise. GitHub Copilot Business primarily features GitHub Copilot in the coding environment - that is the IDE, CLI and GitHub Mobile. GitHub Copilot Enterprise includes everything in GitHub Copilot Business. It also  adds an additional layer of customization for organizations and integrates into GitHub.com as a chat interface to allow developers to converse with Copilot  throughout the platform. GitHub Copilot Enterprise can index an organization’s codebase for a deeper understanding of the customer’s knowledge for more tailored suggestions and will offer customers access to fine-tuned custom, private models for code completion.

GitHub Copilot Pro is designed for individual developers, freelancers, students, educators, and open source maintainers. The plan includes all the features of GitHub Copilot Business except organizational license management, policy management, and IP indemnity.

#### How can I upgrade my GitHub Copilot Free license to Copilot Pro?

If you're on the Free plan, you can upgrade to Pro through your [Copilot settings page](https://github.com/settings/copilot) or directly on the [Copilot marketing page](https://github.com/features/copilot).

#### What is included in GitHub Copilot Free?

GitHub Copilot Free users are limited to 2000 completions and 50 chat requests (including Copilot Edits).

#### Which plan includes GitHub Copilot Autofix?

GitHub Copilot Autofix provides contextual explanations and code suggestions to help developers fix vulnerabilities in code, and is included in GitHub Advanced Security and available to all public repositories.

### Privacy

#### What personal data does GitHub Copilot process?

GitHub Copilot processes personal data based on how Copilot is accessed and used: whether via GitHub.com, mobile app, extensions, or one of various IDE extensions, or through features like suggestions for the command line interface (CLI), IDE code completions, or personalized chat on GitHub.com. The types of personal data processed may include:

* **User Engagement Data:** This includes pseudonymous identifiers captured on user interactions with Copilot, such as accepted or dismissed completions, error messages, system logs, and product usage metrics.
* **Prompts:** These are inputs for chat or code, along with context, sent to Copilot's AI to generate suggestions.
* **Suggestions:** These are the AI-generated code lines or chat responses provided to users based on their prompts.
* **Feedback Data:** This comprises real-time user feedback, including reactions (e.g., thumbs up/down) and optional comments, along with feedback from support tickets.

#### Does GitHub use Copilot Business or Enterprise data to train GitHub’s model?

No. GitHub does not use either Copilot Business or Enterprise data to train its models.

#### How does GitHub use the Copilot data?

How GitHub uses Copilot data depends on how the user accesses Copilot and for what purpose. Users can access GitHub Copilot through the web, extensions, mobile apps, computer terminal, and various IDEs (Integrated Development Environments). GitHub generally uses personal data to:

* Deliver, maintain, and update the services as per the customer's configuration and usage, to ensure personalized experiences and recommendations
* Troubleshoot, which involves preventing, detecting, resolving, and mitigating issues, including security incidents and product-related problems, by fixing software bugs and maintaining the online services' functionality and up-to-dateness
* Enhance user productivity, reliability, effectiveness, quality, privacy, accessibility, and security by keeping the service current and operational

These practices are outlined in GitHub’s Data Protection Agreement ([DPA)](https://github.com/customer-terms/github-data-protection-agreement), which details our data handling commitments to our data controller customers.

GitHub also uses certain personal data with customer authorization under the DPA, for the following purposes:

* Billing and account management
* To comply with and resolve legal obligations
* For abuse detection, prevention, and protection, virus scanning, and scanning to detect violations of terms of service
* To generate summary reports for calculating employee commissions and partner incentives
* To produce aggregated reports for internal use and strategic planning, covering areas like forecasting, revenue analysis, capacity planning, and product strategy,

For details on GitHub's data processing activities as a controller, particularly for Copilot Pro customers, refer to the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement).

#### How long does GitHub retain Copilot data for Business and Enterprise customers?

If and for how long GitHub’s retains Copilot data depends on how a Copilot user accesses Copilot and for what purpose. The default settings for Copilot Business and Enterprise Customers are as follows:

**Access through IDE for Chat and Code Completions:**

* Prompts and Suggestions: Not retained
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

**All other GitHub Copilot access and use:**

* Prompts and Suggestions: Retained for 28 days.
* User Engagement Data: Kept for two years.
* Feedback Data: Stored for as long as needed for its intended purpose.

#### Why do some Copilot features retain prompts and suggestions?

Retaining prompts and suggestions is necessary for chat on github.com, mobile, and CLI Copilot because those features’ effectiveness depends on using thread history to improve responses. The Copilot model requires access to previous interactions to deliver accurate and relevant suggestions.

#### Does GitHub Copilot support compliance with the GDPR and other data protection laws?

Yes. GitHub and customers can enter a [Data Protection Agreement](https://github.com/customer-terms/github-data-protection-agreement) that supports compliance with the GDPR and similar legislation.

#### Does GitHub Copilot ever output personal data?

While we've designed GitHub Copilot with privacy in mind, the expansive definition of personal data under legislation like the EU’s General Data Protection Regulation (GDPR) means we can't guarantee it will never output such data. The Large Language Model (LLM) powering GitHub Copilot was trained on public code and there were instances in our tests where the tool made suggestions resembling personal data. These suggestions were typically synthesized and not tied to real individuals.

#### How does Copilot allow users to access, alter or delete personal data?

These actions are available to Copilot users as described in the [GitHub Privacy Statement](https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement#your-privacy-rights).

### Responsible AI

#### What are the intellectual property considerations when using GitHub Copilot?

The primary IP considerations for GitHub Copilot relate to copyright. The model that powers Copilot is trained on a broad collection of publicly accessible code, which may include copyrighted code, and Copilot’s suggestions (in rare instances) may resemble the code its model was trained on. Here’s some basic information you should know about these considerations:

Copyright law permits the use of copyrighted works to train AI models:  Countries around the world have provisions in their copyright laws that enable machines to learn, understand, extract patterns, and facts from copyrighted materials, including software code. For example, the European Union, Japan, and Singapore, have express provisions permitting machine learning to develop AI models. Other countries including Canada, India, and the United States also permit such training under their fair use/fair dealing provisions. GitHub Copilot’s AI model was trained with the use of code from GitHub’s public repositories—which are publicly accessible and within the scope of permissible copyright use.

What about copyright risk in suggestions? In rare instances (less than 1% based on GitHub’s research), suggestions from GitHub may match examples of code used to train GitHub’s AI model. Again, Copilot does not “look up” or “copy and paste” code, but is instead using context from a user’s workspace to synthesize and generate a suggestion.

Our experience shows that matching suggestions are most likely to occur in two situations: (i) when there is little or no context in the code editor for Copilot’s model to synthesize, or (ii) when a matching suggestion represents a common approach or method. If a code suggestion matches existing code, there is risk that using that suggestion could trigger claims of copyright infringement, which would depend on the amount and nature of code used, and the context of how the code is used. In many ways, this is the same risk that arises when using any code that a developer does not originate, such as copying code from an online source, or reusing code from a library. That is why responsible organizations and developers recommend that users employ code scanning policies to identify and evaluate potential matching code.

In Copilot, you can opt whether to allow Copilot to suggest code completions that match publicly available code on GitHub.com. For more information, see "[Configuring GitHub Copilot settings on GitHub.com](https://docs-internal-46619-d1aa34.preview.ghdocs.com/en/copilot/configuring-github-copilot/configuring-github-copilot-settings-on-githubcom#enabling-or-disabling-duplication-detection)". If you have allowed suggestions that match public code, GitHub Copilot can provide you with details about the matching code when you accept such suggestions. Matching code does not necessarily mean copyright infringement, so it is ultimately up to the user to determine whether to use the suggestion, and what and who to attribute (along with other license compliance) in appropriate circumstances.

#### Does GitHub Copilot include a filtering mechanism to mitigate risk?

Yes, GitHub Copilot does include an optional code referencing filter to detect and suppress certain suggestions that match public code on GitHub.

* GitHub has created a duplication detection filter to detect and suppress suggestions that contain code segments over a certain length that match public code on GitHub. This filter can be enabled by the administrator for your enterprise and it can apply for all organizations within your enterprise, or the administrator can defer control to individual organizations.
* With the filter enabled, Copilot checks code suggestions for matches or near-matches against public code on GitHub of 65 lexemes or more (on average,150 characters). If there is a match, the suggestion will not be shown to the user.
* In addition to off-topic, harmful, and offensive output filters, GitHub Copilot also scans the outputs for vulnerable code.

#### Does GitHub Copilot include features to make it easier for users to identify potentially relevant open source licenses for matching suggestions?

Yes, GitHub Copilot is previewing a [code referencing feature](https://github.blog/2023-08-03-introducing-code-referencing-for-github-copilot/) as an additional tool to assist users to find and review potentially relevant open source licenses. Code referencing is currently available in Visual Studio Code. This feature searches across public GitHub repositories for code that matches a Copilot suggestion. If there’s a match, users will find its information displayed in the Copilot console log, including where the match occurred, any applicable licenses, and a deep link to learn more. The deep link will take users to a navigable page on GitHub.com to browse examples of the code match and their repository licenses, and see how many repositories—including ones without licenses—that code appears in, as well as links to those repositories. Copilot users can review this information to determine whether the applicable suggestions are suitable for use, and whether additional measures may be necessary to use them.

#### Who owns the suggestions provided by GitHub Copilot?

We don’t determine whether a suggestion is capable of being owned, but we are clear that GitHub does not claim ownership of a suggestion. Whether a suggestion generated by an AI model can be owned depends on many factors (e.g. the intellectual property law in the relevant country, the length of the suggestion, the extent that suggestion is considered ‘functional’ instead of expressive, etc).

* If a suggestion is capable of being owned, our terms are clear: GitHub does not claim ownership.
* GitHub does not claim ownership of any suggestion. In certain cases, it is possible for Copilot to produce similar suggestions to different users. For example, two unrelated users both starting new files to code the quicksort algorithm in Java will likely get the same suggestion. The possibility of providing similar suggestions to multiple users is a common part of generative AI systems.

#### Can GitHub Copilot introduce insecure code in its suggestions?

Public code may contain insecure coding patterns, bugs, or references to outdated APIs or idioms. When GitHub Copilot synthesizes code suggestions based on this data, it can also synthesize code that contains these undesirable patterns. Copilot has filters in place that either block or notify users of insecure code patterns that are detected in Copilot suggestions. These filters target the most common vulnerable coding patterns, including [hardcoded credentials](https://cwe.mitre.org/data/definitions/798.html), [SQL injections](https://cwe.mitre.org/data/definitions/89.html), and [path injections](https://cwe.mitre.org/data/definitions/22.html). Additionally, in recent years we’ve provided tools such as GitHub Advanced Security, GitHub Actions, Dependabot, and CodeQL to open source projects to help improve code quality. Of course, you should always use GitHub Copilot together with good testing and code review practices and security tools, as well as your own judgment.

#### Is GitHub Copilot intended to fully automate code generation and replace developers?

No. Copilot is a tool intended to make developers more efficient. It’s not intended to replace developers, who should continue to apply the same sorts of safeguards and diligence they would apply with regard to any third-party code of unknown origin.

* The product is called “Copilot” not “Autopilot” and it’s not intended to generate code without oversight. You should use exactly the same sorts of safeguards and diligence with Copilot’s suggestions as you would use with any third-party code.
* Identifying best practices for use of third party code is beyond the scope of this section. That said, whatever practices your organization currently uses – rigorous functionality testing, code scanning, security testing, etc. – you should continue these policies with Copilot’s suggestions. Moreover, you should make sure your code editor or editor does not automatically compile or run generated code before you review it.

#### Can GitHub Copilot users simply use suggestions without concern?

Not necessarily. GitHub Copilot users should align their use of Copilot with their respective risk tolerances.

* As noted above, GitHub Copilot is not intended to replace developers, or their individual skill and judgment, and is not intended to fully automate the process of code development. The same risks that apply to the use of any third-party code apply to the use of Copilot’s suggestions.
* Depending on your particular use case, you should consider implementing the protections discussed above. It is your responsibility to assess what is appropriate for the situation and implement appropriate safeguards.
* You’re entitled to IP indemnification from GitHub for the unmodified suggestions when Copilot’s filtering is enabled. If you do elect to enable this feature, the copyright responsibility is ours, not our customers. As part of our ongoing commitment to responsible AI, GitHub and Microsoft extends our IP indemnity and protection support to our customers who are empowering their teams with GitHub Copilot. See [Microsoft's Copilot Copyright Commitment](https://blogs.microsoft.com/on-the-issues/2023/09/07/copilot-copyright-commitment-ai-legal-concerns/) for more details.

#### Does GitHub Copilot support accessibility features?

We are conducting internal testing of GitHub Copilot’s ease of use by developers with disabilities and working to ensure that GitHub Copilot is accessible to all developers. Please feel free to share your feedback on GitHub Copilot accessibility in our [feedback forum](https://github.com/github-community/community/discussions/categories/copilot).

#### Does GitHub Copilot produce offensive outputs?

GitHub Copilot includes filters to block offensive language in the prompts and to avoid synthesizing suggestions in sensitive contexts. We continue to work on improving the filter system to more intelligently detect and remove offensive outputs. If you see offensive outputs, please report them directly to copilot-safety@github.com so that we can improve our safeguards. GitHub takes this challenge very seriously and we are committed to addressing it.

#### Will GitHub Copilot work as well using languages other than English?

Given public sources are predominantly in English, GitHub Copilot will likely work less well in scenarios where natural language prompts provided by the developer are not in English and/or are grammatically incorrect. Therefore, non-English speakers might experience a lower quality of service.

#### What data has GitHub Copilot been trained on?

GitHub Copilot is powered by generative AI models developed by GitHub, OpenAI, and Microsoft. It has been trained on natural language text and source code from publicly available sources, including code in public repositories on GitHub.

1. Data from June 2023. Additional research can be found [here](https://github.blog/news-insights/research/the-economic-impact-of-the-ai-powered-developer-lifecycle-and-lessons-from-github-copilot/).
2. Feature in public beta for Copilot Pro and Business plans. Requires use of repositories, issues, discussions, Actions, and other features of GitHub.
3. Authentication with SAML single sign-on (SSO) available for organizations using GitHub Enterprise Cloud.

## Footnotes

1. [Authentication with SAML single sign-on (SSO)](https://docs.github.com/en/enterprise-cloud%40latest/authentication/authenticating-with-saml-single-sign-on/about-authentication-with-saml-single-sign-on) available for organizations using GitHub Enterprise Cloud.

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* © 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub’s organization on GitHub](https://github.com/github)

You can’t perform that action at this time.



=== Content from github.com_d6ee93d0_20250126_054534.html ===
Disclosure
==========
| Date | Detail |
|---|---|
| `04/23/2018` | reported to Samsung |
| `08/01/2018` | vulnerabilities confirmed and assigned `SVE-2018-11785`, rated \_\_Low\_\_ |
| `08/02/2018` | assigned `CVE-2018-14854`, `CVE-2018-14855` and `CVE-2018-14856`|
| `12/07/2018` | CVE descriptions published https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14854, https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14855, https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14856 |
Affected Product
=============
Samsung Galaxy S6 (SM-G920F), Firmware Version G920FXXU5EQH7
Vulnerabilities
=============
Three potential buffer overflows in
- `drivers/net/wireless/bcmdhd4358/dhd\_pcie.c:5024 (CVE-2018-14856)`
- `drivers/net/wireless/bcmdhd4358/dhd\_pcie.c:5093 (CVE-2018-14854)`
- `drivers/net/wireless/bcmdhd4358/dhd\_pcie.c:5154 (CVE-2018-14855)`
------
#### CVE-2018-14856
```
5016 void
5017 dhd\_bus\_flow\_ring\_create\_response(dhd\_bus\_t \*bus, uint16 flowid, int32 status)
5018 {
5019 flow\_ring\_node\_t \*flow\_ring\_node;
5020 unsigned long flags;
5021
5022 DHD\_INFO(("%s :Flow Response %d \n", \_\_FUNCTION\_\_, flowid));
5023
5024 flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
5025 ASSERT(flow\_ring\_node->flowid == flowid);
5026
5027 if (status != BCME\_OK) {
5028 DHD\_ERROR(("%s Flow create Response failure error status = %d \n",
5029 \_\_FUNCTION\_\_, status));
5030 /\* Call Flow clean up \*/
5031 dhd\_bus\_clean\_flow\_ring(bus, flow\_ring\_node);
5032 return;
5033 }
5034
5035 DHD\_FLOWRING\_LOCK(flow\_ring\_node->lock, flags);
5036 flow\_ring\_node->status = FLOW\_RING\_STATUS\_OPEN;
5037 DHD\_FLOWRING\_UNLOCK(flow\_ring\_node->lock, flags);
5038
5039 dhd\_bus\_schedule\_queue(bus, flowid, FALSE);
5040
5041 return;
5042 }
```
#### CVE-2018-14854
```
5086 void
5087 dhd\_bus\_flow\_ring\_delete\_response(dhd\_bus\_t \*bus, uint16 flowid, uint32 status)
5088 {
5089 flow\_ring\_node\_t \*flow\_ring\_node;
5090
5091 DHD\_INFO(("%s :Flow Delete Response %d \n", \_\_FUNCTION\_\_, flowid));
5092
5093 flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
5094 ASSERT(flow\_ring\_node->flowid == flowid);
5095
5096 if (status != BCME\_OK) {
5097 DHD\_ERROR(("%s Flow Delete Response failure error status = %d \n",
5098 \_\_FUNCTION\_\_, status));
5099 return;
5100 }
5101 /\* Call Flow clean up \*/
5102 dhd\_bus\_clean\_flow\_ring(bus, flow\_ring\_node);
5103
5104 return;
5105 }
```
#### CVE-2018-14855
```
5143 void
5144 dhd\_bus\_flow\_ring\_flush\_response(dhd\_bus\_t \*bus, uint16 flowid, uint32 status)
5145 {
5146 flow\_ring\_node\_t \*flow\_ring\_node;
5147
5148 if (status != BCME\_OK) {
5149 DHD\_ERROR(("%s Flow flush Response failure error status = %d \n",
5150 \_\_FUNCTION\_\_, status));
5151 return;
5152 }
5153
5154 flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
5155 ASSERT(flow\_ring\_node->flowid == flowid);
5156
5157 flow\_ring\_node->status = FLOW\_RING\_STATUS\_OPEN;
5158 return;
5159 }
```
Analysis
========
We will analyse each of the vulnerabilities seperately.
#### CVE-2018-14856
In line `drivers/net/wireless/bcmdhd4358/dhd\_msgbuf.c:4580` below the variable `flow\_create\_resp` is initialized as a pointer to memory that can be modified by the attacker on WiFi SoC. In line `4585` this memory is passed as the parameter `flow\_create\_resp->cmplt.flow\_ring\_id` to the function `dhd\_bus\_flow\_ring\_create\_response`
```
4577 static void
4578 dhd\_prot\_process\_flow\_ring\_create\_response(dhd\_pub\_t \*dhd, void\* buf, uint16 msglen)
4579 {
4580 tx\_flowring\_create\_response\_t \*flow\_create\_resp = (tx\_flowring\_create\_response\_t \*)buf;
4581
4582 DHD\_ERROR(("%s Flow create Response status = %d Flow %d\n", \_\_FUNCTION\_\_,
4583 flow\_create\_resp->cmplt.status, flow\_create\_resp->cmplt.flow\_ring\_id));
4584
4585 dhd\_bus\_flow\_ring\_create\_response(dhd->bus, flow\_create\_resp->cmplt.flow\_ring\_id,
4586 flow\_create\_resp->cmplt.status);
4587 }
```
#### CVE-2018-14854
In line `drivers/net/wireless/bcmdhd4358/dhd\_msgbuf.c:4693` below the variable `flow\_delete\_resp` is initialized as a pointer to memory that can be modified by the attacker on WiFi SoC. In line `4698` this memory is passed as the parameter `low\_delete\_resp->cmplt.flow\_ring\_id` to the function `dhd\_bus\_flow\_ring\_delete\_response`
```
4690 static void
4691 dhd\_prot\_process\_flow\_ring\_delete\_response(dhd\_pub\_t \*dhd, void\* buf, uint16 msglen)
4692 {
4693 tx\_flowring\_delete\_response\_t \*flow\_delete\_resp = (tx\_flowring\_delete\_response\_t \*)buf;
4694
4695 DHD\_INFO(("%s Flow Delete Response status = %d \n", \_\_FUNCTION\_\_,
4696 flow\_delete\_resp->cmplt.status));
4697
4698 dhd\_bus\_flow\_ring\_delete\_response(dhd->bus, flow\_delete\_resp->cmplt.flow\_ring\_id,
4699 flow\_delete\_resp->cmplt.status);
4700 }
```
#### CVE-2018-14855
In line `drivers/net/wireless/bcmdhd4358/dhd\_msgbuf.c:4745` below the variable `flow\_flush\_resp` is initialized as a pointer to memory that can be modified by an attacker on the WiFi SoC. In line `4750` this memory is passed as the parameter `low\_flush\_resp->cmplt.flow\_ring\_id` to the function `dhd\_bus\_flow\_ring\_flush\_response`
```
4742 static void
4743 dhd\_prot\_process\_flow\_ring\_flush\_response(dhd\_pub\_t \*dhd, void\* buf, uint16 msglen)
4744 {
4745 tx\_flowring\_flush\_response\_t \*flow\_flush\_resp = (tx\_flowring\_flush\_response\_t \*)buf;
4746
4747 DHD\_INFO(("%s Flow Flush Response status = %d \n", \_\_FUNCTION\_\_,
4748 flow\_flush\_resp->cmplt.status));
4749
4750 dhd\_bus\_flow\_ring\_flush\_response(dhd->bus, flow\_flush\_resp->cmplt.flow\_ring\_id,
4751 flow\_flush\_resp->cmplt.status);
4752 }
```
Kernel Traces
============
#### CVE-2018-14856
```python
[ 200.743070] ------------[ cut here ]------------
[ 200.743091] Kernel BUG at ffffffc000e939dc [verbose debug info unavailable]
[ 200.743114] Internal error: Oops - BUG: 96000004 [#1] PREEMPT SMP
[ 200.743137] Modules linked in:
[ 200.743164] exynos-snapshot: core register saved(CPU:0)
[ 200.743184] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[ 200.743204] exynos-snapshot: context saved(CPU:0)
[ 200.743315] exynos-snapshot: item - log\_kevents is disabled
[ 200.743391] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G W 3.10.61-TeamNexus-gb11c661e30ff #763
[ 200.743420] task: ffffffc0016e8830 ti: ffffffc0016dc000 task.ti: ffffffc0016dc000
[ 200.743461] PC is at \_raw\_spin\_lock\_irqsave+0x24/0x58
[ 200.743491] LR is at dhd\_os\_spin\_lock+0x24/0x58
[ 200.743514] pc : [] lr : [] pstate: 800000c5
[ 200.743534] sp : ffffffc0016df960
[ 200.743555] x29: ffffffc0016df960 x28: ffffff8000018450
[ 200.743582] x27: 0000000000000010 x26: ffffffc00192d000
[ 200.743603] x25: ffffffc0a0df3c80 x24: 00000000ffffabab
[ 200.743625] x23: ffffffc00192d000 x22: ffffffc09655dd88
[ 200.743646] x21: ffffffc09655dd78 x20: ffffffc0a07cf000
[ 200.743667] x19: 0064656e69666564 x18: 000000000000000a
[ 200.743688] x17: 0000007f9988e3f0 x16: 00000000000029ea
[ 200.743710] x15: 000000000000fff9 x14: 0000000000000002
[ 200.743731] x13: 0000000000005455 x12: 0000000000000005
[ 200.743752] x11: ffffffc0016df980 x10: ffffffc0016df8cf
[ 200.743773] x9 : 7f7f7f7f7f7f7f7f x8 : 206572756c696166
[ 200.743795] x7 : 2065736e6f707365 x6 : ffffffc0016df8d6
[ 200.743816] x5 : 00000000000000cd x4 : 000000000000ffff
[ 200.743838] x3 : ffffffc0016dc000 x2 : 0000000000000040
[ 200.743858] x1 : 0000000000000102 x0 : 0064656e69666564
[ 200.743883]
[ 200.743883] PC: 0xffffffc000e9395c:
[ 200.743914] 395c 35ffffa2 d65f03c0 d503201f d50342df 910003e1 9272c421 aa0103e2 b9405021
[ 200.743956] 397c 11000421 b9005041 f9800011 885ffc01 11404022 88037c02 35ffffa3 4ac14022
[ 200.743994] 399c 340000c2 d50320bf d503205f 485ffc03 4a414062 35ffffa2 d65f03c0 d53b4222
[ 200.744032] 39bc d50342df 910003e1 9272c421 aa0103e3 b9405021 11000421 b9005061 f9800011
[ 200.744069] 39dc 885ffc01 11404023 88047c03 35ffffa4 4ac14023 340000c3 d50320bf d503205f
[ 200.744107] 39fc 485ffc04 4a414083 35ffffa3 aa0203e0 d65f03c0 910003e1 9272c421 aa0103e2
[ 200.744144] 3a1c b9405021 11000421 b9005041 d50320bf d503205f 885ffc01 11000421 37ffffa1
[ 200.744181] 3a3c 88027c01 35ffff82 d65f03c0 910003e1 9272c421 aa0103e2 b9405021 11000421
[ 200.744222]
[ 200.744222] LR: 0xffffffc000832b94:
[ 200.744252] 2b94 b4000060 97ea8e80 b900027f 97ea8e7e aa1303e0 f9400bf3 a8c27bfd d65f03c0
[ 200.744290] 2bb4 d503201f a9be7bfd 910003fd a90153f3 aa0003f3 aa0103f4 97ea8e73 aa1403e1
[ 200.744328] 2bd4 aa1303e0 52800102 94008ff5 a94153f3 a8c27bfd d65f03c0 d503201f a9be7bfd
[ 200.744365] 2bf4 910003fd f9000bf3 aa0003f3 97ea8e66 b4000173 97ea8e64 aa1303e0 9419836a
[ 200.744404] 2c14 aa0003f3 97ea8e60 aa1303e0 f9400bf3 a8c27bfd d65f03c0 d503201f 97ea8e5a
[ 200.744441] 2c34 d2800013 aa1303e0 f9400bf3 a8c27bfd d65f03c0 a9be7bfd 910003fd a90153f3
[ 200.744479] 2c54 aa0003f3 aa0103f4 97ea8e4f b40000b3 97ea8e4d aa1403e1 aa1303e0 94198422
[ 200.744516] 2c74 97ea8e49 a94153f3 a8c27bfd d65f03c0 d503201f a9bb7bfd 910003fd f9000bf3
[ 200.744557]
[ 200.744557] SP: 0xffffffc0016df8e0:
[ 200.744588] f8e0 a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0
[ 200.744624] f900 ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[ 200.744661] f920 00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[ 200.744698] f940 00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[ 200.744735] f960 016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[ 200.744772] f980 016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[ 200.744810] f9a0 a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[ 200.744848] f9c0 016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[ 200.744890]
[ 200.744890] X3: 0xffffffc0016dbf80:
[ 200.744920] bf80 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.744956] bfa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.744992] bfc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.745029] bfe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.745064] c000 00000002 00000000 ffffffff ffffffff 016e8830 ffffffc0 016f0520 ffffffc0
[ 200.745101] c020 0025c408 ffffffc0 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.745138] c040 00000000 00000000 00000000 00000000 00000104 00000000 00000000 00000000
[ 200.745174] c060 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.745214]
[ 200.745214] X6: 0xffffffc0016df856:
[ 200.745244] f854 00000000 016dc000 ffffffc0 0000ffff 00000000 000000cd 00000000 016df8d6
[ 200.745281] f874 ffffffc0 6f707365 2065736e 6c696166 20657275 7f7f7f7f 7f7f7f7f 016df8cf
[ 200.745318] f894 ffffffc0 016df980 ffffffc0 00000005 00000000 00005455 00000000 00000002
[ 200.745355] f8b4 00000000 0000fff9 00000000 000029ea 00000000 9988e3f0 0000007f 0000000a
[ 200.745392] f8d4 00000000 69666564 0064656e a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88
[ 200.745429] f8f4 ffffffc0 0192d000 ffffffc0 ffffabab 00000000 a0df3c80 ffffffc0 0192d000
[ 200.745466] f914 ffffffc0 00000010 00000000 00018450 ffffff80 016df960 ffffffc0 00832c14
[ 200.745503] f934 ffffffc0 016df960 ffffffc0 00e939dc ffffffc0 800000c5 00000000 016df960
[ 200.745540] f954 ffffffc0 00832c0c ffffffc0 016df980 ffffffc0 008c2124 ffffffc0 9655dd78
[ 200.745582]
[ 200.745582] X10: 0xffffffc0016df84f:
[ 200.745612] f84c 00000000 00000040 00000000 016dc000 ffffffc0 0000ffff 00000000 000000cd
[ 200.745649] f86c 00000000 016df8d6 ffffffc0 6f707365 2065736e 6c696166 20657275 7f7f7f7f
[ 200.745686] f88c 7f7f7f7f 016df8cf ffffffc0 016df980 ffffffc0 00000005 00000000 00005455
[ 200.745723] f8ac 00000000 00000002 00000000 0000fff9 00000000 000029ea 00000000 9988e3f0
[ 200.745760] f8cc 0000007f 0000000a 00000000 69666564 0064656e a07cf000 ffffffc0 9655dd78
[ 200.745796] f8ec ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0 ffffabab 00000000 a0df3c80
[ 200.745833] f90c ffffffc0 0192d000 ffffffc0 00000010 00000000 00018450 ffffff80 016df960
[ 200.745870] f92c ffffffc0 00832c14 ffffffc0 016df960 ffffffc0 00e939dc ffffffc0 800000c5
[ 200.745908] f94c 00000000 016df960 ffffffc0 00832c0c ffffffc0 016df980 ffffffc0 008c2124
[ 200.745948]
[ 200.745948] X11: 0xffffffc0016df900:
[ 200.745977] f900 ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[ 200.746014] f920 00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[ 200.746051] f940 00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[ 200.746088] f960 016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[ 200.746125] f980 016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[ 200.746162] f9a0 a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[ 200.746199] f9c0 016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[ 200.746236] f9e0 ffffabab ffffffff 960d8000 ffffffc0 008c8ff0 ffffffc0 00000010 00000000
[ 200.746282]
[ 200.746282] X20: 0xffffffc0a07cef80:
[ 200.746312] ef80 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.746348] efa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.746384] efc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.746420] efe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.746456] f000 960d8000 ffffffc0 9856b000 ffffffc0 96103040 ffffffc0 961030a8 ffffffc0
[ 200.746495] f020 5faab100 ffffffc0 8c4b4000 ffffffc0 00000d7d 00000000 0cf70000 ffffff80
[ 200.746532] f040 00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[ 200.746569] f060 960dafb0 ffffffc0 960dbfb0 ffffffc0 00000000 00000000 00000000 00000000
[ 200.746608]
[ 200.746608] X21: 0xffffffc09655dcf8:
[ 200.746638] dcf8 62206465 6f6d2079 206c6564 756f7267 54007370 6b206568 65727965 65722066
[ 200.746678] dd18 65726566 7365636e 6b206120 65727965 68540066 61632065 6e696472 74696c61
[ 200.746715] dd38 666f2079 65687420 79656b20 20666572 66666964 20737265 6d6f7266 65687420
[ 200.746752] dd58 72616320 616e6964 7974696c 20666f20 20656874 65666572 636e6572 6b206465
[ 200.746789] dd78 752f7965 7571696e 25272065 54002773 64206568 6e696665 6f697469 7369206e
[ 200.746826] dd98 72696320 616c7563 69430072 6c756372 72207261 72656665 65636e65 206f7420
[ 200.746864] ddb8 20656874 65646f6d 7267206c 2070756f 69666564 6974696e 27206e6f 20277325
[ 200.747170] ddd8 69666564 0064656e 63726943 72616c75 66657220 6e657265 74206563 6874206f
[ 200.747258]
[ 200.747258] X22: 0xffffffc09655dd08:
[ 200.747288] dd08 54007370 6b206568 65727965 65722066 65726566 7365636e 6b206120 65727965
[ 200.747326] dd28 68540066 61632065 6e696472 74696c61 666f2079 65687420 79656b20 20666572
[ 200.747363] dd48 66666964 20737265 6d6f7266 65687420 72616320 616e6964 7974696c 20666f20
[ 200.747399] dd68 20656874 65666572 636e6572 6b206465 752f7965 7571696e 25272065 54002773
[ 200.747436] dd88 64206568 6e696665 6f697469 7369206e 72696320 616c7563 69430072 6c756372
[ 200.747473] dda8 72207261 72656665 65636e65 206f7420 20656874 65646f6d 7267206c 2070756f
[ 200.747510] ddc8 69666564 6974696e 27206e6f 20277325 69666564 0064656e 63726943 72616c75
[ 200.747547] dde8 66657220 6e657265 74206563 6874206f 74612065 62697274 20657475 756f7267
[ 200.747588]
[ 200.747588] X23: 0xffffffc00192cf80:
[ 200.747617] cf80 00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[ 200.747655] cfa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747691] cfc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747727] cfe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747763] d000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747800] d020 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747835] d040 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747873] d060 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.747913]
[ 200.747913] X25: 0xffffffc0a0df3c00:
[ 200.747943] 3c00 9f334748 ffffffc0 9f334748 ffffffc0 a0df3d10 ffffffc0 a0df3b10 ffffffc0
[ 200.747981] 3c20 00004000 00000000 00018000 ffffff80 00000001 00000000 9f334400 ffffffc0
[ 200.748018] 3c40 00000001 00000000 00000200 dead0000 00000000 00000000 b7f6f058 ffffffc0
[ 200.748056] 3c60 b9f02600 ffffffc0 ffffffff 00000002 00040004 00000000 00000000 00000000
[ 200.748093] 3c80 00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[ 200.748130] 3ca0 00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[ 200.748166] 3cc0 00000000 00000000 9ce25ec0 ffffffc0 9ce25100 ffffffc0 00000544 00000000
[ 200.748204] 3ce0 00000000 00000000 00000000 00000000 00000100 00000000 00000000 00000000
[ 200.748243]
[ 200.748243] X26: 0xffffffc00192cf80:
[ 200.748274] cf80 00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[ 200.748310] cfa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748346] cfc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748382] cfe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748419] d000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748455] d020 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748491] d040 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748527] d060 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.748568]
[ 200.748568] X29: 0xffffffc0016df8e0:
[ 200.748598] f8e0 a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0
[ 200.748635] f900 ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[ 200.748672] f920 00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[ 200.748711] f940 00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[ 200.748748] f960 016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[ 200.748785] f980 016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[ 200.748822] f9a0 a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[ 200.748859] f9c0 016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[ 200.748896]
[ 200.748918] Process swapper/0 (pid: 0, stack limit = 0xffffffc0016dc058)
[ 200.748943] Stack: (0xffffffc0016df960 to 0xffffffc0016e0000)
[ 200.748973] f960: 016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[ 200.749002] f980: 016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[ 200.749031] f9a0: a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[ 200.749059] f9c0: 016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[ 200.749087] f9e0: ffffabab ffffffff 960d8000 ffffffc0 008c8ff0 ffffffc0 00000010 00000000
[ 200.749117] fa00: 008c909c ffffffc0 016dfa30 ffffffc0 008c90a4 ffffffc0 80000045 00000000
[ 200.749147] fa20: 016dfa30 ffffffc0 008c9024 ffffffc0 016dfa60 ffffffc0 008cab08 ffffffc0
[ 200.749175] fa40: 00000010 00000000 960d8000 ffffffc0 00000010 00000000 00018450 ffffff80
[ 200.749203] fa60: 016dfb00 ffffffc0 008d001c ffffffc0 00000010 00000000 a0df3c80 ffffffc0
[ 200.749231] fa80: 960d8000 ffffffc0 960d0000 ffffffc0 00018450 ffffff80 9ce25ec0 ffffffc0
[ 200.749259] faa0: 00000000 00000000 960da000 ffffffc0 00000400 00000000 00000046 00000000
[ 200.749288] fac0: 00000003 00000000 00f516f8 ffffffc0 960d8000 ffffffc0 0155d190 ffffffc0
[ 200.749317] fae0: 00000000 ffffffc0 00000029 00000010 960d0000 ffffffc0 00f51928 ffffffc0
[ 200.749346] fb00: 016dfb80 ffffffc0 008ba240 ffffffc0 a07cf010 ffffffc0 a07cf000 ffffffc0
[ 200.749374] fb20: 019367d0 ffffffc0 960d8000 ffffffc0 a07cf010 ffffffc0 00000000 00000000
[ 200.749403] fb40: 016e20b0 ffffffc0 01a46000 ffffffc0 01c52000 ffffffc0 00000001 00000000
[ 200.749432] fb60: 00f51b90 ffffffc0 00f516f8 ffffffc0 016dfb80 00000040 0192de00 ffffffc0
[ 200.749462] fb80: 016dfbd0 ffffffc0 008c1b94 ffffffc0 a07cf000 ffffffc0 0192d000 ffffffc0
[ 200.749490] fba0: 00000001 00000000 5faab100 ffffffc0 01a46680 ffffffc0 5faab100 ffffffc0
[ 200.749519] fbc0: 016dfbd0 ffffffc0 008c1b84 ffffffc0 016dfc00 ffffffc0 008302ec ffffffc0
[ 200.749548] fbe0: 960d8000 ffffffc0 a07cf000 ffffffc0 00000000 00000000 016d4d28 ffffffc0
[ 200.749577] fc00: 016dfc20 ffffffc0 0024481c ffffffc0 960dd040 ffffffc0 960dd048 ffffffc0
[ 200.749605] fc20: 016dfc60 ffffffc0 00245040 ffffffc0 00000006 00000000 00000101 00000000
[ 200.749633] fc40: 016d4f88 ffffffc0 00000006 00000000 016e2000 ffffffc0 01a46000 ffffffc0
[ 200.749661] fc60: 016dfcf0 ffffffc0 0024583c ffffffc0 000000c0 00000000 000000ed 00000000
[ 200.749689] fc80: 00000000 00000000 bca74b82 0000002e 60000045 00000000 00000000 00000000
[ 200.749717] fca0: 00000000 00000000 40202000 00000000 00205430 ffffffc0 40000000 00000040
[ 200.749746] fcc0: 016dfcd0 ffffffc0 016f08b0 ffffffc0 ffffd939 00000000 00200000 0000000a
[ 200.749774] fce0: 016d4dd0 ffffffc0 000000ed 00000000 016dfd10 ffffffc0 0020ada4 ffffffc0
[ 200.749802] fd00: 016d6000 ffffffc0 0020ad80 ffffffc0 016dfd40 ffffffc0 002063e8 ffffffc0
[ 200.749831] fd20: 0000200c ffffff80 016dfd70 ffffffc0 01cb1c00 ffffffc0 00002010 ffffff80
[ 200.749860] fd40: 016dfe90 ffffffc0 0020a5e8 ffffffc0 000f4240 00000000 be0bb558 ffffffc0
[ 200.749889] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000008 00000000 f9003000 ffffff80
[ 200.749918] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[ 200.749946] fda0: d4f06280 0030479e ffffffff 00ffffff 3b9aca00 00000000 00000033 00000000
[ 200.749974] fdc0: 00000006 00000000 0225a2cf 00000000 00000024 00000000 000051cf 00000000
[ 200.750003] fde0: 0000338b 00000000 0000328b 00000000 000029ea 00000000 9988e3f0 0000007f
[ 200.750032] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 000371ff 00000000
[ 200.750059] fe20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.750088] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[ 200.750116] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0 00adf490 ffffffc0 60000045 00000000
[ 200.750145] fe80: 00205430 ffffffc0 40000000 00000040 016dfed0 ffffffc0 00adf5cc ffffffc0
[ 200.750173] fea0: be0bb558 ffffffc0 00000000 00000000 01a47000 ffffffc0 01fdd000 ffffffc0
[ 200.750203] fec0: 01953f38 ffffffc0 002a5598 00000001 016dff20 ffffffc0 0020b6ac ffffffc0
[ 200.750231] fee0: 01c525b8 ffffffc0 01c585d8 ffffffc0 01a47000 ffffffc0 00ec6000 ffffffc0
[ 200.750260] ff00: 01a463cb ffffffc0 014b9858 ffffffc0 40200000 00000000 00ec6000 ffffffc0
[ 200.750288] ff20: 016dff30 ffffffc0 002a5618 ffffffc0 016dff80 ffffffc0 00e74184 ffffffc0
[ 200.750317] ff40: 00000002 00000000 016bee08 ffffffc0 01a4d000 ffffffc0 be1bbac0 ffffffc0
[ 200.750345] ff60: 016bee08 ffffffc0 40000000 00000000 40200000 00000000 40202000 00000000
[ 200.750374] ff80: 016dffa0 ffffffc0 01670808 ffffffc0 01c89000 ffffffc0 01670800 ffffffc0
[ 200.750401] ffa0: 00000000 00000000 40205210 00000000 43e77c88 00000000 00000e11 00000000
[ 200.750429] ffc0: 4a000000 00000000 410fd032 00000000 416e9dd8 00000000 00000000 00000000
[ 200.750456] ffe0: 00000000 00000000 016bee08 ffffffc0 00000000 00000000 00000000 00000000
[ 200.750475] Call trace:
[ 200.750502] [] \_raw\_spin\_lock\_irqsave+0x24/0x58
[ 200.750533] [] dhd\_bus\_clean\_flow\_ring+0x30/0xf8
[ 200.750560] [] dhd\_bus\_flow\_ring\_create\_response+0x90/0x480
[ 200.750592] [] dhd\_prot\_process\_flow\_ring\_create\_response+0x40/0xb8
[ 200.750617] [] dhd\_prot\_process\_msgtype+0x14c/0x5a8
[ 200.750641] [] dhd\_prot\_process\_msgbuf\_txcpl+0x1c8/0x3f0
[ 200.750669] [] dhdpcie\_bus\_process\_mailbox\_intr+0x1f4/0x518
[ 200.750694] [] dhd\_bus\_dpc+0x160/0x260
[ 200.750726] [] dhd\_dpc+0x28/0x98
[ 200.750758] [] tasklet\_action+0x90/0x1e0
[ 200.750783] [] \_\_do\_softirq+0x144/0x3e0
[ 200.750809] [] irq\_exit+0x108/0x130
[ 200.750839] [] handle\_IRQ+0x58/0xc8
[ 200.750864] [] gic\_handle\_irq+0x3c/0x88
[ 200.750886] Exception stack(0xffffffc0016dfd50 to 0xffffffc0016dfe70)
[ 200.750910] fd40: 000f4240 00000000 be0bb558 ffffffc0
[ 200.750939] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000008 00000000 f9003000 ffffff80
[ 200.750966] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[ 200.750995] fda0: d4f06280 0030479e ffffffff 00ffffff 3b9aca00 00000000 00000033 00000000
[ 200.751022] fdc0: 00000006 00000000 0225a2cf 00000000 00000024 00000000 000051cf 00000000
[ 200.751050] fde0: 0000338b 00000000 0000328b 00000000 000029ea 00000000 9988e3f0 0000007f
[ 200.751077] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 000371ff 00000000
[ 200.751104] fe20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 200.751133] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[ 200.751158] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0
[ 200.751183] [] el1\_irq+0x64/0xd4
[ 200.751217] [] cpuidle\_idle\_call+0xc0/0x278
[ 200.751242] [] arch\_cpu\_idle+0x8/0x20
[ 200.751275] [] cpu\_startup\_entry+0xcc/0x280
[ 200.751305] [] rest\_init+0x80/0x90
[ 200.751337] [] start\_kernel+0x314/0x32c
[ 200.751363] Code: b9405021 11000421 b9005061 f9800011 (885ffc01)
[ 200.751470] ---[ end trace e1070556e6f65c99 ]---
```
#### CVE-2018-14854
```python
[ 385.605978] Unable to handle kernel NULL pointer dereference at virtual address 00000000
[ 385.606001] pgd = ffffffc000202000
[ 385.606026] [00000000] \*pgd=00000000fa409003, \*pmd=00000000fa40c003, \*pte=0060000011001707
[ 385.606257] Kernel BUG at ffffffc0008c21a0 [verbose debug info unavailable]
[ 385.606279] Internal error: Oops - BUG: 96000045 [#1] PREEMPT SMP
[ 385.606329] Modules linked in:
[ 385.606405] exynos-snapshot: core register saved(CPU:0)
[ 385.606450] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[ 385.606513] exynos-snapshot: context saved(CPU:0)
[ 385.606665] exynos-snapshot: item - log\_kevents is disabled
[ 385.606748] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G W 3.10.61-TeamNexus-gb11c661e30ff #763
[ 385.606799] task: ffffffc0016e8830 ti: ffffffc0016dc000 task.ti: ffffffc0016dc000
[ 385.606866] PC is at dhd\_bus\_clean\_flow\_ring+0xb0/0xf8
[ 385.606890] LR is at dhd\_bus\_clean\_flow\_ring+0x9c/0xf8
[ 385.606919] pc : [] lr : [] pstate: 60000045
[ 385.606938] sp : ffffffc0016df9b0
[ 385.606958] x29: ffffffc0016df9b0 x28: ffffff8000018450
[ 385.606985] x27: 0000000000000010 x26: ffffffc00192d000
[ 385.607013] x25: ffffffc0a000da80 x24: 0000000000000010
[ 385.607035] x23: 0000000000000000 x22: ffffffc095efb7a8
[ 385.607057] x21: ffffffc095efb798 x20: ffffffc0b891c000
[ 385.607077] x19: 0000000000000000 x18: 000000000000000a
[ 385.607105] x17: 0000000000000000 x16: 0000000000000000
[ 385.607126] x15: 0000000000000000 x14: 0000000000000001
[ 385.607148] x13: 0000000000093eab x12: 0000000000000006
[ 385.607169] x11: ffffffc081a514df x10: ffffffc001a514e7
[ 385.607198] x9 : ffffffc001a52138 x8 : 63705f6468642220
[ 385.607219] x7 : 656c6966203a2264 x6 : ffffffc001a51548
[ 385.607239] x5 : 0000000000105578 x4 : 000000000000ffff
[ 385.607260] x3 : 00fffd8f7a5c218c x2 : 0000000000000000
[ 385.607281] x1 : 0000000000000000 x0 : 0000000000000000
[ 385.607310]
[ 385.607310] PC: 0xffffffc0008c2120:
[ 385.607341] 2120 97fdc2b4 aa0003f7 14000008 d503201f 97e8511a f9400280 52800022 aa1303e1
[ 385.607388] 2140 f9400000 97fe4e8f 97e85114 f9400280 aa1603e1 940011ed aa0003f3 b5fffea0
[ 385.607426] 2160 97e8510e 794042c0 34000100 97e8510b 900064c1 b00064c0 52826ee2 911fc021
[ 385.607464] 2180 91218000 97fe5495 97e85104 390102bf a94002a2 52800041 390106a1 aa1703e1
[ 385.607501] 21a0 f9000002 a9400aa0 f9000402 f94032a0 97fdc2a6 f9400280 f9402ea1 940043d1
[ 385.607538] 21c0 794086a2 394116a1 f9400280 940016b7 f9401bf7 a94153f3 a9425bf5 a8c47bfd
[ 385.607576] 21e0 d65f03c0 d503201f a9be7bfd 910003fd a90153f3 aa0003f3 aa0103f4 97e850e7
[ 385.607613] 2200 f0008340 b94e0000 371001c0 97e850e3 f9400260 aa1403e1 9400425a 7100001f
[ 385.607654]
[ 385.607654] LR: 0xffffffc0008c210c:
[ 385.607683] 210c f9001bf7 97e85122 f9400280 97fda546 f94032a0 97fdc2b4 aa0003f7 14000008
[ 385.607721] 212c d503201f 97e8511a f9400280 52800022 aa1303e1 f9400000 97fe4e8f 97e85114
[ 385.607758] 214c f9400280 aa1603e1 940011ed aa0003f3 b5fffea0 97e8510e 794042c0 34000100
[ 385.607795] 216c 97e8510b 900064c1 b00064c0 52826ee2 911fc021 91218000 97fe5495 97e85104
[ 385.607832] 218c 390102bf a94002a2 52800041 390106a1 aa1703e1 f9000002 a9400aa0 f9000402
[ 385.607869] 21ac f94032a0 97fdc2a6 f9400280 f9402ea1 940043d1 794086a2 394116a1 f9400280
[ 385.607906] 21cc 940016b7 f9401bf7 a94153f3 a9425bf5 a8c47bfd d65f03c0 d503201f a9be7bfd
[ 385.607943] 21ec 910003fd a90153f3 aa0003f3 aa0103f4 97e850e7 f0008340 b94e0000 371001c0
[ 385.607983]
[ 385.607983] SP: 0xffffffc0016df930:
[ 385.608014] f930 b891c000 ffffffc0 95efb798 ffffffc0 95efb7a8 ffffffc0 00000000 00000000
[ 385.608050] f950 00000010 00000000 a000da80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[ 385.608093] f970 00018450 ffffff80 016df9b0 ffffffc0 008c218c ffffffc0 016df9b0 ffffffc0
[ 385.608131] f990 008c21a0 ffffffc0 60000045 00000000 016df9b0 ffffffc0 008c218c ffffffc0
[ 385.608174] f9b0 016df9f0 ffffffc0 008c2950 ffffffc0 95efb798 ffffffc0 0000feff 00000000
[ 385.608212] f9d0 0192d000 ffffffc0 b891c000 ffffffc0 00000000 00000000 008c2944 ffffffc0
[ 385.608255] f9f0 016dfa30 ffffffc0 008c8fb8 ffffffc0 00018450 ffffff80 00000000 00000000
[ 385.608298] fa10 95848000 ffffffc0 00018450 ffffff80 008c8f78 ffffffc0 008c8fa8 ffffffc0
[ 385.608342]
[ 385.608342] X6: 0xffffffc001a514c8:
[ 385.608377] 14c8 00000000 00000000 00000000 00000000 00000001 00000000 30303020 32303330
[ 385.608414] 14e8 31343830 20205d34 203a305b 20202020 61777320 72657070 203a302f 30202020
[ 385.608459] 1508 3531205d 38203830 30362e35 32343338 5b49205d 20203a30 20202020 70617773
[ 385.608497] 1528 2f726570 20203a30 5d302020 3a365820 66783020 66666666 30306366 31356131
[ 385.608534] 1548 3a386334 0a0a350a 3162672d 36366331 30336531 23206666 0a333637 6f707365
[ 385.608571] 1568 2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666 30303030
[ 385.608614] 1588 35343831 63202c61 303d7874 63313578 540a3839 2c30203a 73617020 5f646573
[ 385.608651] 15a8 33203a54 66202c30 5f6c6c75 33203a54 63202c30 655f6768 545f646e 2c30203a
[ 385.608699]
[ 385.608699] X9: 0xffffffc001a520b8:
[ 385.608734] 20b8 2c686565 33376435 610a2c68 3d6f6e6c 35313330 33666437 39663466 63306461
[ 385.608772] 20d8 646e7320 636f735f 726f635f 6d702e65 6e776f64 6d69745f 30313d65 7a203030
[ 385.608816] 20f8 5f6f7265 68636473 63695f67 6120313d 6f72646e 6f626469 662e746f 635f706d
[ 385.608853] 2118 69666e6f 0a303d67 00000000 00000000 00000000 00000000 006c6148 ffffffc0
[ 385.608896] 2138 38333132 33313333 66660033 30306366 32356131 3a386230 726c000a 5b203a20
[ 385.608933] 2158 6666663c 63666666 38303030 38313263 205d3e63 61747370 203a6574 30303036
[ 385.608976] 2178 35343030 0a30000a 31626700 36366331 30336531 23206666 0a333637 6f707300
[ 385.609013] 2198 2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666 30303030
[ 385.609059]
[ 385.609059] X10: 0xffffffc001a51467:
[ 385.609089] 1464 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.609133] 1484 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.609169] 14a4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.609210] 14c4 00000000 00000000 00000000 00000000 00000000 00000001 00000000 30303020
[ 385.609255] 14e4 362e3538 35323938 20205d35 203a305b 20202020 61777320 72657070 203a302f
[ 385.609292] 1504 30202020 3531205d 38203430 30362e35 39353039 5b49205d 20203a30 20202020
[ 385.609329] 1524 70617773 2f726570 20203a30 5d302020 30315820 7830203a 66666666 30636666
[ 385.609366] 1544 35613130 37363431 0a0a0a3a 3162672d 36366331 30336531 23206666 0a333637
[ 385.609408] 1564 6f707365 2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666
[ 385.609449]
[ 385.609449] X11: 0xffffffc081a5145f:
[ 385.609479] 145c aa0203fc 58002d1e 58002d20 d63f03c0 39472aa0 35002020 b94196bb 6b1b031f
[ 385.609522] 147c 54001fc1 71000b1f 54001861 34000f7a aa1503e1 90001240 f9457800 f940181e
[ 385.609565] 149c d63f03c0 34000ea0 b94132bb 37f80d1b b9410aa0 b9410ea1 4b1b003c 6b1c001f
[ 385.609603] 14bc 54000c6a 394732a0 35000160 394712a0 35000120 b9418ea0 121b0000 350000c0
[ 385.609647] 14dc b9418aa0 12000400 35000060 39472ea0 14000002 52800020 35000aa0 9000135d
[ 385.609685] 14fc b94dfbbd 3400213d aa1403e1 52822460 f940de7e d63f03c0 aa0003e1 aa0103f4
[ 385.609729] 151c 580027be 580027c0 d63f03c0 d0001342 b94c4442 34002082 aa1403e1 aa0203fb
[ 385.609766] 153c b9400020 f9418000 f940181e d63f03c0 b9410ea2 34002020 aa0003e1 aa0103f4
[ 385.609811] 155c aa0203fb b9400020 f9416c00 f940181e d63f03c0 900012c2 b949d442 34001f42
[ 385.609858]
[ 385.609858] X20: 0xffffffc0b891bf80:
[ 385.609893] bf80 01d09698 ffffffbc 00000000 00001000 84bd5000 00000000 00001000 00000000
[ 385.609932] bfa0 01b966d0 ffffffbc 00000000 00001000 7e1d6000 00000000 00001000 00000000
[ 385.609975] bfc0 01b968c8 ffffffbc 00000000 00001000 7e1df000 00000000 00001000 00000000
[ 385.610013] bfe0 01c6107a ffffffbc 00000000 00001000 81bb9000 00000000 00001000 00000000
[ 385.610055] c000 95848000 ffffffc0 9740c800 ffffffc0 95883040 ffffffc0 958830a8 ffffffc0
[ 385.610101] c020 974ae100 ffffffc0 885c2000 ffffffc0 00000d7d 00000000 0cf70000 ffffff80
[ 385.610137] c040 00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[ 385.610175] c060 9584afb0 ffffffc0 9584bfb0 ffffffc0 00000000 00000000 00000000 00000000
[ 385.610215]
[ 385.610215] X21: 0xffffffc095efb718:
[ 385.610251] b718 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610287] b738 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610328] b758 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610364] b778 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610406] b798 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610442] b7b8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610483] b7d8 00000200 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610520] b7f8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610564]
[ 385.610564] X22: 0xffffffc095efb728:
[ 385.610594] b728 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610636] b748 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610673] b768 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610715] b788 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610757] b7a8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610793] b7c8 00000000 00000000 00000000 00000000 00000200 00000000 00000000 00000000
[ 385.610830] b7e8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610871] b808 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.610920]
[ 385.610920] X25: 0xffffffc0a000da00:
[ 385.610950] da00 9cf6e9c0 ffffffc0 a000d788 ffffffc0 b9ef1330 ffffffc0 9f1a6810 ffffffc0
[ 385.610988] da20 b9ef1330 ffffffc0 019240f8 ffffffc0 a03b9000 ffffffc0 00000002 00000003
[ 385.611026] da40 01744378 ffffffc0 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611068] da60 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611104] da80 00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[ 385.611480] daa0 00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[ 385.611537] dac0 00000000 00000000 9cf63700 ffffffc0 9cf63800 ffffffc0 00000d44 00000000
[ 385.611574] dae0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611619]
[ 385.611619] X26: 0xffffffc00192cf80:
[ 385.611649] cf80 00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[ 385.611692] cfa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611736] cfc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611773] cfe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611810] d000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611846] d020 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611887] d040 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611924] d060 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.611969]
[ 385.611969] X29: 0xffffffc0016df930:
[ 385.611999] f930 b891c000 ffffffc0 95efb798 ffffffc0 95efb7a8 ffffffc0 00000000 00000000
[ 385.612041] f950 00000010 00000000 a000da80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[ 385.612078] f970 00018450 ffffff80 016df9b0 ffffffc0 008c218c ffffffc0 016df9b0 ffffffc0
[ 385.612121] f990 008c21a0 ffffffc0 60000045 00000000 016df9b0 ffffffc0 008c218c ffffffc0
[ 385.612158] f9b0 016df9f0 ffffffc0 008c2950 ffffffc0 95efb798 ffffffc0 0000feff 00000000
[ 385.612199] f9d0 0192d000 ffffffc0 b891c000 ffffffc0 00000000 00000000 008c2944 ffffffc0
[ 385.612236] f9f0 016dfa30 ffffffc0 008c8fb8 ffffffc0 00018450 ffffff80 00000000 00000000
[ 385.612279] fa10 95848000 ffffffc0 00018450 ffffff80 008c8f78 ffffffc0 008c8fa8 ffffffc0
[ 385.612316]
[ 385.612340] Process swapper/0 (pid: 0, stack limit = 0xffffffc0016dc058)
[ 385.612370] Stack: (0xffffffc0016df9b0 to 0xffffffc0016e0000)
[ 385.612395] f9a0: 016df9f0 ffffffc0 008c2950 ffffffc0
[ 385.612430] f9c0: 95efb798 ffffffc0 0000feff 00000000 0192d000 ffffffc0 b891c000 ffffffc0
[ 385.612460] f9e0: 00000000 00000000 008c2944 ffffffc0 016dfa30 ffffffc0 008c8fb8 ffffffc0
[ 385.612488] fa00: 00018450 ffffff80 00000000 00000000 95848000 ffffffc0 00018450 ffffff80
[ 385.612522] fa20: 008c8f78 ffffffc0 008c8fa8 ffffffc0 016dfa60 ffffffc0 008cab08 ffffffc0
[ 385.612551] fa40: 00000010 00000000 95848000 ffffffc0 00000010 00000000 008caaf8 ffffffc0
[ 385.612579] fa60: 016dfb00 ffffffc0 008d001c ffffffc0 00000010 00000000 a000da80 ffffffc0
[ 385.612607] fa80: 95848000 ffffffc0 95840000 ffffffc0 00018450 ffffff80 9cf63700 ffffffc0
[ 385.612635] faa0: 00000000 00000000 9584a000 ffffffc0 00000400 00000000 00000046 00000000
[ 385.612664] fac0: 00000003 00000000 00f516f8 ffffffc0 95848000 ffffffc0 0155d190 ffffffc0
[ 385.612693] fae0: 00000000 ffffffc0 00000029 00000010 95840000 ffffffc0 00f51928 ffffffc0
[ 385.612722] fb00: 016dfb80 ffffffc0 008ba240 ffffffc0 b891c010 ffffffc0 b891c000 ffffffc0
[ 385.612750] fb20: 019367d0 ffffffc0 95848000 ffffffc0 b891c010 ffffffc0 00000000 00000000
[ 385.612779] fb40: 016e20b0 ffffffc0 01a46000 ffffffc0 01c52000 ffffffc0 00000001 00000000
[ 385.612807] fb60: 00f51b90 ffffffc0 00f516f8 ffffffc0 016dfb80 00000040 0192de00 ffffffc0
[ 385.612835] fb80: 016dfbd0 ffffffc0 008c1b94 ffffffc0 b891c000 ffffffc0 0192d000 ffffffc0
[ 385.612863] fba0: 00000001 00000000 974ae100 ffffffc0 01a46680 ffffffc0 974ae100 ffffffc0
[ 385.612891] fbc0: 016dfbd0 ffffffc0 008c1b84 ffffffc0 016dfc00 ffffffc0 008302ec ffffffc0
[ 385.612919] fbe0: 95848000 ffffffc0 b891c000 ffffffc0 00000000 00000000 016d4d28 ffffffc0
[ 385.612959] fc00: 016dfc20 ffffffc0 0024481c ffffffc0 9584d040 ffffffc0 9584d048 ffffffc0
[ 385.612987] fc20: 016dfc60 ffffffc0 00245040 ffffffc0 00000006 00000000 00000101 00000000
[ 385.613016] fc40: 016d4f88 ffffffc0 00000006 00000000 016e2000 ffffffc0 01a46000 ffffffc0
[ 385.613043] fc60: 016dfcf0 ffffffc0 0024583c ffffffc0 000000c0 00000000 000000ed 00000000
[ 385.613072] fc80: 00000000 00000000 c7841cef 00000059 60000045 00000000 00000001 00000000
[ 385.613099] fca0: 00000001 00000000 40202000 00000000 00205430 ffffffc0 40000000 00000040
[ 385.613134] fcc0: 016dfcd0 ffffffc0 016f08b0 ffffffc0 00002170 00000001 00200000 0000000a
[ 385.613163] fce0: 016d4dd0 ffffffc0 000000ed 00000000 016dfd10 ffffffc0 0020ada4 ffffffc0
[ 385.613192] fd00: 016d6000 ffffffc0 0020ad80 ffffffc0 016dfd40 ffffffc0 002063e8 ffffffc0
[ 385.613225] fd20: 0000200c ffffff80 016dfd70 ffffffc0 01cb1c00 ffffffc0 00002010 ffffff80
[ 385.613254] fd40: 016dfe90 ffffffc0 0020a5e8 ffffffc0 000f4240 00000000 be0bb558 ffffffc0
[ 385.613288] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000004 00000000 f9003000 ffffff80
[ 385.613317] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[ 385.613345] fda0: ad0efa80 0034edce ffffffff 00ffffff 3b9aca00 00000000 00209800 ffffffc0
[ 385.613379] fdc0: 00000000 00000000 00000000 00000000 34c5d83d 00000000 00000000 00000000
[ 385.613406] fde0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.613438] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 00080c8c 00000000
[ 385.613465] fe20: 00000001 00000000 00000001 00000000 00000001 00000000 00000001 00000000
[ 385.613494] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[ 385.613529] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0 00adf490 ffffffc0 60000045 00000000
[ 385.613558] fe80: 00205430 ffffffc0 40000000 00000040 016dfed0 ffffffc0 00adf5cc ffffffc0
[ 385.613585] fea0: be0bb558 ffffffc0 00000000 00000000 01a47000 ffffffc0 01fdd000 ffffffc0
[ 385.613619] fec0: 01953f38 ffffffc0 002a5598 00000001 016dff20 ffffffc0 0020b6ac ffffffc0
[ 385.613648] fee0: 01c525b8 ffffffc0 01c585d8 ffffffc0 01a47000 ffffffc0 00ec6000 ffffffc0
[ 385.613683] ff00: 01a463cb ffffffc0 014b9858 ffffffc0 40200000 00000000 00ec6000 ffffffc0
[ 385.613711] ff20: 016dff30 ffffffc0 002a5618 ffffffc0 016dff80 ffffffc0 00e74184 ffffffc0
[ 385.613740] ff40: 00000002 00000000 016bee08 ffffffc0 01a4d000 ffffffc0 be1bbac0 ffffffc0
[ 385.613774] ff60: 016bee08 ffffffc0 40000000 00000000 40200000 00000000 40202000 00000000
[ 385.613802] ff80: 016dffa0 ffffffc0 01670808 ffffffc0 01c89000 ffffffc0 01670800 ffffffc0
[ 385.613838] ffa0: 00000000 00000000 40205210 00000000 43e77c88 00000000 00000e11 00000000
[ 385.613866] ffc0: 4a000000 00000000 410fd032 00000000 416e9dd8 00000000 00000000 00000000
[ 385.613894] ffe0: 00000000 00000000 016bee08 ffffffc0 00000000 00000000 00000000 00000000
[ 385.613912] Call trace:
[ 385.613947] [] dhd\_bus\_clean\_flow\_ring+0xb0/0xf8
[ 385.613974] [] dhd\_bus\_flow\_ring\_delete\_response+0xa4/0x138
[ 385.614004] [] dhd\_prot\_process\_flow\_ring\_delete\_response+0x3c/0x78
[ 385.614031] [] dhd\_prot\_process\_msgtype+0x14c/0x5a8
[ 385.614055] [] dhd\_prot\_process\_msgbuf\_txcpl+0x1c8/0x3f0
[ 385.614085] [] dhdpcie\_bus\_process\_mailbox\_intr+0x1f4/0x518
[ 385.614111] [] dhd\_bus\_dpc+0x160/0x260
[ 385.614142] [] dhd\_dpc+0x28/0x98
[ 385.614173] [] tasklet\_action+0x90/0x1e0
[ 385.614199] [] \_\_do\_softirq+0x144/0x3e0
[ 385.614226] [] irq\_exit+0x108/0x130
[ 385.614254] [] handle\_IRQ+0x58/0xc8
[ 385.614297] [] gic\_handle\_irq+0x3c/0x88
[ 385.614319] Exception stack(0xffffffc0016dfd50 to 0xffffffc0016dfe70)
[ 385.614344] fd40: 000f4240 00000000 be0bb558 ffffffc0
[ 385.614372] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000004 00000000 f9003000 ffffff80
[ 385.614405] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[ 385.614433] fda0: ad0efa80 0034edce ffffffff 00ffffff 3b9aca00 00000000 00209800 ffffffc0
[ 385.614467] fdc0: 00000000 00000000 00000000 00000000 34c5d83d 00000000 00000000 00000000
[ 385.614494] fde0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 385.614521] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 00080c8c 00000000
[ 385.614555] fe20: 00000001 00000000 00000001 00000000 00000001 00000000 00000001 00000000
[ 385.614583] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[ 385.614608] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0
[ 385.614637] [] el1\_irq+0x64/0xd4
[ 385.614672] [] cpuidle\_idle\_call+0xc0/0x278
[ 385.614697] [] arch\_cpu\_idle+0x8/0x20
[ 385.614736] [] cpu\_startup\_entry+0xcc/0x280
[ 385.614770] [] rest\_init+0x80/0x90
[ 385.614803] [] start\_kernel+0x314/0x32c
[ 385.614836] Code: a94002a2 52800041 390106a1 aa1703e1 (f9000002)
[ 385.614979] ---[ end trace 7a106c4f8760a982 ]---
```
#### CVE-2018-14855
A simple heap overflow checking mechanism (allocates selected objects right before a NON-PRESENT page) was used to produce the crash
```python
[ 100.646256] ------------[ cut here ]------------
[ 100.646269] Kernel BUG at ffffffc0008aac18 [verbose debug info unavailable]
[ 100.646284] Internal error: Oops - BUG: 96000007 [#1] PREEMPT SMP
[ 100.646301] Modules linked in:
[ 100.646318] exynos-snapshot: core register saved(CPU:0)
[ 100.646330] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[ 100.646343] exynos-snapshot: context saved(CPU:0)
[ 100.646417] exynos-snapshot: item - log\_kevents is disabled
[ 100.646471] CPU: 0 PID: 5032 Comm: dmesg Tainted: G W 3.10.61-TeamNexus-gb11c661e30ff-dirty #891
[ 100.646490] task: ffffffc0ba76c440 ti: ffffffc07db08000 task.ti: ffffffc07db08000
[ 100.646520] PC is at dhd\_bus\_flow\_ring\_flush\_response+0x68/0xf8
[ 100.646536] LR is at dhd\_bus\_flow\_ring\_flush\_response+0x68/0xf8
[ 100.646551] pc : [] lr : [] pstate: 40000045
[ 100.646563] sp : ffffffc07db0bb70
[ 100.646577] x29: ffffffc07db0bb70 x28: 0000000000000000
[ 100.646594] x27: ffffffc00153c000 x26: ffffffc0958b0000
[ 100.646607] x25: ffffffc095888000 x24: ffffffc0b1c09f80
[ 100.646621] x23: 0000000000000010 x22: ffffff80000185d0
[ 100.646634] x21: ffffffc0a06c8000 x20: 000000000000002a
[ 100.646647] x19: ffffffc054e02000 x18: 000000000000000a
[ 100.646660] x17: 0000007fa2c349a8 x16: 0000007fa2cdc238
[ 100.646673] x15: 0000000000000001 x14: 0000000000000002
[ 100.646686] x13: 00000000000013a8 x12: 0000000000000004
[ 100.646699] x11: ffffffc081a324ee x10: ffffffc001a32504
[ 100.646712] x9 : 7f7f7f7f7f7f7f7f x8 : 666666662065646f
[ 100.646726] x7 : 6e5f676e69725f77 x6 : ffffffc001a3254e
[ 100.646739] x5 : 00000000000000c0 x4 : 0000000000000007
[ 100.646751] x3 : 0000000000000000 x2 : 0000000000000007
[ 100.646764] x1 : 0000000000000100 x0 : 0000000000000044
[ 100.646779]
[ 100.646779] PC: 0xffffffc0008aab98:
[ 100.646798] ab98 a94153f3 a9425bf5 f9401bf7 a8c47bfd d65f03c0 d503201f a9bd7bfd 910003fd
[ 100.646823] abb8 a90153f3 2a0203f3 f90013f5 12003c34 aa0003f5 97e8adf7 35000513 97e8adf5
[ 100.646846] abd8 52800d13 2a1403e1 b0006480 91280000 9416ef21 b94ef2a1 b0006480 9128e000
[ 100.646868] abf8 9416ef1d f94002a1 b0006480 9129c000 f9573821 9bb30693 aa1303e1 9416ef16
[ 100.646890] ac18 79408660 6b14001f 54000181 97e8ade1 39410661 b0006480 912ac000 9416ef0e
[ 100.646912] ac38 3901067f 97e8addb f94013f5 a94153f3 a8c37bfd d65f03c0 97e8add6 90006481
[ 100.646934] ac58 b0006480 52828822 91212021 9122a000 97fe79c2 17ffffee 97e8adce d0003441
[ 100.646957] ac78 911aa021 2a1303e2 910b6021 b0006480 91272000 9416eef8 97e8adc6 f94013f5
[ 100.646982]
[ 100.646982] LR: 0xffffffc0008aab98:
[ 100.647001] ab98 a94153f3 a9425bf5 f9401bf7 a8c47bfd d65f03c0 d503201f a9bd7bfd 910003fd
[ 100.647023] abb8 a90153f3 2a0203f3 f90013f5 12003c34 aa0003f5 97e8adf7 35000513 97e8adf5
[ 100.647045] abd8 52800d13 2a1403e1 b0006480 91280000 9416ef21 b94ef2a1 b0006480 9128e000
[ 100.647066] abf8 9416ef1d f94002a1 b0006480 9129c000 f9573821 9bb30693 aa1303e1 9416ef16
[ 100.647088] ac18 79408660 6b14001f 54000181 97e8ade1 39410661 b0006480 912ac000 9416ef0e
[ 100.647110] ac38 3901067f 97e8addb f94013f5 a94153f3 a8c37bfd d65f03c0 97e8add6 90006481
[ 100.647132] ac58 b0006480 52828822 91212021 9122a000 97fe79c2 17ffffee 97e8adce d0003441
[ 100.647154] ac78 911aa021 2a1303e2 910b6021 b0006480 91272000 9416eef8 97e8adc6 f94013f5
[ 100.647179]
[ 100.647179] SP: 0xffffffc07db0baf0:
[ 100.647198] baf0 0000002a 00000000 a06c8000 ffffffc0 000185d0 ffffff80 00000010 00000000
[ 100.647220] bb10 b1c09f80 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0 0153c000 ffffffc0
[ 100.647242] bb30 00000000 00000000 7db0bb70 ffffffc0 008aac18 ffffffc0 7db0bb70 ffffffc0
[ 100.647263] bb50 008aac18 ffffffc0 40000045 00000000 01a3253c ffffffc0 5f687375 70736572
[ 100.647285] bb70 7db0bba0 ffffffc0 008b0020 ffffffc0 000185d0 ffffff80 958b0000 ffffffc0
[ 100.647307] bb90 00000010 00000000 00000010 00000000 7db0bbc0 ffffffc0 008afe80 ffffffc0
[ 100.647329] bbb0 00000010 00000000 00000010 00000000 7db0bc60 ffffffc0 008b571c ffffffc0
[ 100.647352] bbd0 00000010 00000000 b1c09f80 ffffffc0 958b0000 ffffffc0 000185d0 ffffff80
[ 100.647378]
[ 100.647378] X6: 0xffffffc001a324ce:
[ 100.647397] 24cc 00000000 00000000 00000000 00000001 00000000 30303020 32303330 39333730
[ 100.647419] 24ec 20205d39 203a305b 20202020 20202020 656d6420 203a6773 32333035 3432205d
[ 100.647440] 250c 30206330 34362e30 38373337 5b49205d 20203a30 20202020 20202020 73656d64
[ 100.647462] 252c 35203a67 5d323330 3a365820 66783020 66666666 30306366 32336131 3a656334
[ 100.647483] 254c 0a0a350a 31316267 31363663 66303365 69642d66 20797472 31393823 302b650a
[ 100.647505] 256c 2f633178 38337830 64646120 78303d72 66666666 30386666 31303030 61643538
[ 100.647527] 258c 7463202c 78303d78 31396233 5f630a30 30203a54 6170202c 64657373 203a545f
[ 100.647549] 25ac 202c3036 6c6c7566 203a545f 202c3036 5f676863 5f646e65 30203a54 6572202c
[ 100.647572] 25cc 3a746e63 202c3020 64736963 7830203a 68300a30 6233312c 312c6837 68303034
[ 100.647596]
[ 100.647596] X10: 0xffffffc001a32484:
[ 100.647616] 2484 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.647637] 24a4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.647659] 24c4 00000000 00000000 00000000 00000000 00000000 00000001 00000000 30303020
[ 100.647680] 24e4 362e3030 38363730 20205d30 203a305b 20202020 20202020 656d6420 203a6773
[ 100.647702] 2504 32333035 3532205d 30203430 34362e30 36393537 5b49205d 20203a30 20202020
[ 100.647723] 2524 20202020 73656d64 35203a67 5d323330 30315820 7830203a 66666666 30636666
[ 100.647745] 2544 33613130 34383432 0a0a0a3a 31316267 31363663 66303365 69642d66 20797472
[ 100.647767] 2564 31393823 302b650a 2f633178 38337830 64646120 78303d72 66666666 30386666
[ 100.647791]
[ 100.647791] X11: 0xffffffc081a3246e:
[ 100.647810] 246c f9000be1 f9427e7e d63f03c0 f9000be1 f9427e7e d63f03c0 f9000be0 5280f360
[ 100.647834] 248c f941127e d63f03c0 2a0003e1 f9400be0 17ffffc4 a90107e0 aa0103e0 aa0203e1
[ 100.647855] 24ac f941067e d63f03c0 a94107e0 17ffffc1 f9000be0 f9427e7e d63f03c0 f9000be1
[ 100.647878] 24cc f9427e7e d63f03c0 f9426a7e d63f03c0 17ffff9d 007aedaf 00000050 40700000
[ 100.647899] 24ec 00000000 000000c0 d1400bf0 b940021f f81b0fe0 a90357f4 a9047bf6 b9005be1
[ 100.647922] 250c b9005fe2 79400270 35000410 aa0103e0 aa0203f4 aa0003f5 f941a67e d63f03c0
[ 100.647943] 252c b9400ea1 340003c1 aa1403e2 aa0103f6 d2914271 b9400020 f9404400 f940fc00
[ 100.647965] 254c f940181e d63f03c0 14000009 b9408a74 b9008a7f b9405be0 f941aa7e d63f03c0
[ 100.647987] 256c aa1403e0 f9426e7e d63f03c0 b9405be0 f941aa7e d63f03c0 a94357f4 a9447bf6
[ 100.648015]
[ 100.648015] X19: 0xffffffc054e01f80:
[ 100.648034] 1f80 00007dea 00000000 90e0ee00 ffffffc0 6077da00 ffffffc0 a06c8010 ffffffc0
[ 100.648057] 1fa0 54e01f30 ffffffc0 54e01fa8 ffffffc0 54e01fa8 ffffffc0 00000000 00000000
[ 100.648079] 1fc0 00000000 00000000 07ff0000 00000000 008ada10 ffffffc0 00290001 50e80007
[ 100.648101] 1fe0 7dea798b 439c2500 00003f8f 00000000 7cee3880 ffffffc0 605debc0 ffffffc0
[ 100.648122] 2000
[ 100.648835]
[ 100.648835] X21: 0xffffffc0a06c7f80:
[ 100.648854] 7f80 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.648877] 7fa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.648898] 7fc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.648919] 7fe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.648941] 8000 958b0000 ffffffc0 a00cd800 ffffffc0 54e01f30 ffffffc0 54e01f98 ffffffc0
[ 100.648964] 8020 5f656b00 ffffffc0 89171000 ffffffc0 00000d7d 00000000 0d280000 ffffff80
[ 100.648986] 8040 00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[ 100.649008] 8060 958b2fb0 ffffffc0 958b3fb0 ffffffc0 00000000 00000000 00000000 00000000
[ 100.649032]
[ 100.649032] X24: 0xffffffc0b1c09f00:
[ 100.649051] 9f00 00040001 72683264 6c706378 00000000 00000000 00000000 00000000 00000000
[ 100.649074] 9f20 00016000 ffffff80 f9a0a000 00000000 00000000 00000000 00000000 00000000
[ 100.649095] 9f40 00000000 00000000 9dd78480 ffffffc0 9dd78d80 ffffffc0 00000152 00000000
[ 100.649117] 9f60 00000000 00000000 00000000 00000000 00000000 00000000 00000007 00000000
[ 100.649138] 9f80 00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[ 100.649160] 9fa0 00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[ 100.649182] 9fc0 00000000 00000000 9dd78c00 ffffffc0 9dd78140 ffffffc0 0000015c 00000000
[ 100.649205] 9fe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649228]
[ 100.649228] X25: 0xffffffc095887f80:
[ 100.649247] 7f80 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649269] 7fa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649290] 7fc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649312] 7fe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649333] 8000 b1c05400 ffffffc0 00000000 00000055 00000000 00ff00ec 00080008 00080008
[ 100.649355] 8020 02000002 00000030 b1c05d00 ffffffc0 b1c05b00 ffffffc0 b1c05e00 ffffffc0
[ 100.649377] 8040 b1c09f80 ffffffc0 b1c09f00 ffffffc0 b1c09e00 ffffffc0 00000000 00000000
[ 100.649400] 8060 0001c000 ffffff80 f9a10000 00000000 00000000 00000000 00020000 ffffff80
[ 100.649424]
[ 100.649424] X26: 0xffffffc0958aff80:
[ 100.649443] ff80 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649465] ffa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649487] ffc0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649508] ffe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649530] 0000 b1c05400 ffffffc0 a06c8000 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0
[ 100.649552] 0020 00000001 006f006f 00000000 00000002 00000000 00000000 000005ea 00000100
[ 100.649574] 0040 00000000 00000000 798b50e8 00007dea 00000000 00000000 00000000 00000000
[ 100.649596] 0060 00012a7a 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[ 100.649620]
[ 100.649620] X27: 0xffffffc00153bf80:
[ 100.649639] bf80 69766564 65206563 656d756e 65746172 000a2164 00000000 203a7325 70646864
[ 100.649662] bfa0 20656963 74696e69 696c6169 6620657a 656c6961 000a2e64 70646864 3a656963
[ 100.649684] bfc0 00007325 00000000 203a7325 75716572 5f747365 28717269 61662029 64656c69
[ 100.649707] bfe0 0000000a 00000000 203a7325 20494350 20515249 61207369 6165726c 72207964
[ 100.649729] c000 73696765 65726574 00000a64 00000000 203a7325 6e6e6143 6520746f 6c62616e
[ 100.649751] c020 43502065 65642049 65636976 0000000a 203a7325 31524142 746f4e20 616e6520
[ 100.649773] c040 64656c62 726f6620 69687420 65642073 65636976 69732020 2528657a 2c29646c
[ 100.649795] c060 64646120 78302872 30257830 6c6c3631 000a2978 00000000 693a7325 6d65726f
[ 100.649820]
[ 100.649820] X29: 0xffffffc07db0baf0:
[ 100.649839] baf0 0000002a 00000000 a06c8000 ffffffc0 000185d0 ffffff80 00000010 00000000
[ 100.649861] bb10 b1c09f80 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0 0153c000 ffffffc0
[ 100.649883] bb30 00000000 00000000 7db0bb70 ffffffc0 008aac18 ffffffc0 7db0bb70 ffffffc0
[ 100.649905] bb50 008aac18 ffffffc0 40000045 00000000 01a3253c ffffffc0 5f687375 70736572
[ 100.649927] bb70 7db0bba0 ffffffc0 008b0020 ffffffc0 000185d0 ffffff80 958b0000 ffffffc0
[ 100.649949] bb90 00000010 00000000 00000010 00000000 7db0bbc0 ffffffc0 008afe80 ffffffc0
[ 100.649970] bbb0 00000010 00000000 00000010 00000000 7db0bc60 ffffffc0 008b571c ffffffc0
[ 100.649992] bbd0 00000010 00000000 b1c09f80 ffffffc0 958b0000 ffffffc0 000185d0 ffffff80
[ 100.650014]
[ 100.650028] Process dmesg (pid: 5032, stack limit = 0xffffffc07db08058)
[ 100.650044] Stack: (0xffffffc07db0bb70 to 0xffffffc07db0c000)
[ 100.650060] bb60: 7db0bba0 ffffffc0 008b0020 ffffffc0
[ 100.650078] bb80: 000185d0 ffffff80 958b0000 ffffffc0 00000010 00000000 00000010 00000000
[ 100.650095] bba0: 7db0bbc0 ffffffc0 008afe80 ffffffc0 00000010 00000000 00000010 00000000
[ 100.650113] bbc0: 7db0bc60 ffffffc0 008b571c ffffffc0 00000010 00000000 b1c09f80 ffffffc0
[ 100.650130] bbe0: 958b0000 ffffffc0 000185d0 ffffff80 95888000 ffffffc0 9dd78c00 ffffffc0
[ 100.650148] bc00: 00000400 00000000 00000000 00000000 958b2000 ffffffc0 0000005e 00000000
[ 100.650166] bc20: 958b2000 ffffffc0 00000010 00000000 0153cab8 ffffffc0 008afff8 ffffffc0
[ 100.650185] bc40: 000185d0 ffffff80 008b5588 00000010 00f34c88 ffffffc0 00f34c58 ffffffc0
[ 100.650202] bc60: 7db0bce0 ffffffc0 008a4100 ffffffc0 a06c8010 ffffffc0 a06c8000 ffffffc0
[ 100.650220] bc80: 01916a10 ffffffc0 958b0000 ffffffc0 a06c8010 ffffffc0 00000000 00000000
[ 100.650238] bca0: 016c20b0 ffffffc0 01a26000 ffffffc0 01c33000 ffffffc0 00000001 00000000
[ 100.650256] bcc0: a06c8010 ffffffc0 00f34fa8 ffffffc0 0153c7e8 ffffffc0 00f34fc8 00000040
[ 100.650274] bce0: 7db0bd30 ffffffc0 008a997c ffffffc0 a06c8000 ffffffc0 00000001 00000000
[ 100.650292] bd00: 5f656b00 ffffffc0 016b4d68 ffffffc0 01a26a40 ffffffc0 016b4d68 ffffffc0
[ 100.650310] bd20: 01a26a40 ffffffc0 00000000 00000000 7db0bd60 ffffffc0 00829084 ffffffc0
[ 100.650328] bd40: 958b0000 ffffffc0 a06c8000 ffffffc0 00000000 00000000 01a2e758 ffffffc0
[ 100.650346] bd60: 7db0bd80 ffffffc0 0024450c ffffffc0 958b5040 ffffffc0 958b5048 ffffffc0
[ 100.650364] bd80: 7db0bdc0 ffffffc0 00244d30 ffffffc0 00000006 00000000 00000100 00000000
[ 100.650381] bda0: 016b4fc8 ffffffc0 00000006 00000000 016c2000 ffffffc0 01a26000 ffffffc0
[ 100.650399] bdc0: 7db0be50 ffffffc0 0024552c ffffffc0 000000c0 00000000 000000ed 00000000
[ 100.650416] bde0: 00000000 00000000 6ec56e03 00000017 80000000 00000000 00000001 00000000
[ 100.650434] be00: f855a438 0000007f 00000002 00000000 00000001 00000000 7db08000 ffffffc0
[ 100.650452] be20: 7db0be30 ffffffc0 016d08f0 ffffffc0 ffffb220 00000000 00404000 0000000a
[ 100.650470] be40: 016b4e10 ffffffc0 000000ed 00000000 7db0be70 ffffffc0 0020ada4 ffffffc0
[ 100.650488] be60: 016b6000 ffffffc0 0020ad80 ffffffc0 7db0bea0 ffffffc0 002063e8 ffffffc0
[ 100.650506] be80: 0000200c ffffff80 7db0bed0 ffffffc0 01c92c40 ffffffc0 00002010 ffffff80
[ 100.650524] bea0: f855a410 0000007f 0020aa90 ffffffc0 00000000 00000000 f855a438 0000007f
[ 100.650542] bec0: ffffffff ffffffff a2c34a20 0000007f a281c069 0000007f 724460f6 00000055
[ 100.650559] bee0: 00000001 00000000 724460e0 00000055 724460f7 00000055 a281c06a 0000007f
[ 100.650577] bf00: 00000040 00000000 00000066 00000000 00000001 00000000 ffffff97 00000000
[ 100.650594] bf20: a281c000 0000007f 000013a8 00000000 0ccccccc 00000000 8000002f 00000000
[ 100.650613] bf40: a2cc0fd8 0000007f a2cc0c7c 0000007f a2cdc238 0000007f a2c349a8 0000007f
[ 100.650630] bf60: ffffffff 00000000 a2cde730 0000007f f855a438 0000007f 724460f6 00000055
[ 100.650648] bf80: 00000001 00000000 00000001 00000000 00000001 00000000 f855a438 0000007f
[ 100.650665] bfa0: 00000002 00000000 00000001 00000000 00000000 00000000 f855a410 0000007f
[ 100.650683] bfc0: a2c731a8 0000007f f855a3c0 0000007f a2c34a20 0000007f 80000000 00000000
[ 100.650700] bfe0: 00000003 00000000 ffffffff ffffffff ff000000 ff000000 ff000000 ff000000
[ 100.650713] Call trace:
[ 100.650733] [] dhd\_bus\_flow\_ring\_flush\_response+0x68/0xf8
[ 100.650754] [] dhd\_prot\_process\_flow\_ring\_flush\_response+0x24/0x38
[ 100.650771] [] dhd\_prot\_process\_msgtype+0x29c/0x418
[ 100.650790] [] dhd\_prot\_process\_msgbuf\_txcpl+0x138/0x2b0
[ 100.650808] [] dhdpcie\_bus\_process\_mailbox\_intr+0x1f4/0x360
[ 100.650824] [] dhd\_bus\_dpc+0x158/0x220
[ 100.650847] [] dhd\_dpc+0x28/0x98
[ 100.650868] [] tasklet\_action+0x90/0x1e0
[ 100.650886] [] \_\_do\_softirq+0x144/0x3e0
[ 100.650902] [] irq\_exit+0x108/0x130
[ 100.650921] [] handle\_IRQ+0x58/0xc8
[ 100.650937] [] gic\_handle\_irq+0x3c/0x88
[ 100.650951] Exception stack(0xffffffc07db0beb0 to 0xffffffc07db0bfd0)
[ 100.650966] bea0: 00000000 00000000 f855a438 0000007f
[ 100.650984] bec0: ffffffff ffffffff a2c34a20 0000007f a281c069 0000007f 724460f6 00000055
[ 100.651001] bee0: 00000001 00000000 724460e0 00000055 724460f7 00000055 a281c06a 0000007f
[ 100.651018] bf00: 00000040 00000000 00000066 00000000 00000001 00000000 ffffff97 00000000
[ 100.651036] bf20: a281c000 0000007f 000013a8 00000000 0ccccccc 00000000 8000002f 00000000
[ 100.651054] bf40: a2cc0fd8 0000007f a2cc0c7c 0000007f a2cdc238 0000007f a2c349a8 0000007f
[ 100.651071] bf60: ffffffff 00000000 a2cde730 0000007f f855a438 0000007f 724460f6 00000055
[ 100.651088] bf80: 00000001 00000000 00000001 00000000 00000001 00000000 f855a438 0000007f
[ 100.651105] bfa0: 00000002 00000000 00000001 00000000 00000000 00000000 f855a410 0000007f
[ 100.651120] bfc0: a2c731a8 0000007f f855a3c0 0000007f
[ 100.651137] Code: f9573821 9bb30693 aa1303e1 9416ef16 (79408660)
[ 100.651157] ---[ end trace 6e37f9efafafef6f ]---
```
In-Depth Analysis
=============
### Exploiting the out of bound array access into flow ring array
We found several vulnerabilities relating to the access of an array of pointers to 'flow ring' data structures which are allocated by the bcmdhd4358 WiFi driver. The vulnerabilities occur on several locations within the bcmdhd4358 driver code where the index into the flow ring array (called `flowid`) is obtained directly from data provided by the WiFi peripheral and not validated. We discovered that this was the case in the following functions:
- `dhd\_pcie.c:dhd\_bus\_flow\_ring\_create\_response (CVE-2018-14856)`
- `dhd\_pcie.c:dhd\_bus\_flow\_ring\_delete\_response (CVE-2018-14854)`
- `dhd\_pcie.c:dhd\_bus\_flow\_ring\_flush\_response (CVE-2018-14855)`
Each of these functions receives the flowid as a parameter which is under direct attacker control and uses it to extract an entry from the flow ring array using the macro `DHD\_FLOW\_RING`. The code contains `ASSERT` macros which compare the flowid field of the dereferenced data structure with the attacker controlled value of `flowid`. However a mismatch will only generate a warning message and not lead to alter the program behaviour otherwise.
```
#define DHD\_FLOW\_RING(dhdp, flowid) \
(flow\_ring\_node\_t \*)&(((flow\_ring\_node\_t\*) \
((dhdp)->flow\_ring\_table))[flowid])
```
The function `dhd\_bus\_flow\_ring\_flush\_response` first dereferences the pointer obtained from the flow ring array at offset `flowid` as a variable of the type `flow\_ring\_node\_t` and then proceeds to set the 1 byte long status field of the dereferenced `flow\_ring\_node\_t` structure to the constant `FLOW\_RING\_STATUS\_OPEN` which is zero.
```
void
dhd\_bus\_flow\_ring\_flush\_response(dhd\_bus\_t \*bus, uint16 flowid, uint32 status)
{
flow\_ring\_node\_t \*flow\_ring\_node;
if (status != BCME\_OK) {
DHD\_ERROR(("%s Flow flush Response failure error status = %d \n",
\_\_FUNCTION\_\_, status));
return;
}
// XXX flowid not validated
flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
ASSERT(flow\_ring\_node->flowid == flowid);
// XXX overwrite one byte with 0
flow\_ring\_node->status = FLOW\_RING\_STATUS\_OPEN;
return;
}
```
An attacker can use this to zero an arbitrary byte of kernel memory. To that end he has to find a value for flowid so that the flow ring array base address plus the `flowid \* sizeof(flow\_ring\_node\_t)` points to a memory area containing the byte that the attacker wishes to modify.
The function `dhd\_bus\_flow\_ring\_create\_response` also first dereferences the pointer obtained from the flow ring array at offset flowid as a variable of the type `flow\_ring\_node\_t`. The dereferenced data structure contains a field named `lock` of type `void\*` which is then passed to the function `dhd\_os\_spin\_lock` which either passes the pointer on to the kernel function `spin\_lock\_irqsave`, or does nothing if the lock pointer is zero.
The function `dhd\_bus\_flow\_ring\_create\_response` then overwrites the status byte of the dereferenced `flow\_ring\_node\_t` structure as described in the previous paragraph. Finally the function calls `dhd\_os\_spin\_unlock` on the lock pointer.
This vulnerability is potentially more severe compared to the vulnerability described before since it allows an attacker to trigger
the execution of the `spin\_lock\_irqsave` and `spin\_unlock\_irqrestore` call chains on arbitrary kernel memory, however we did not investigate this further since the capability to zero a byte at an arbitrary address already was sufficient reason to patch the underlying cause of the vulnerability.
```
void
dhd\_bus\_flow\_ring\_create\_response(dhd\_bus\_t \*bus, uint16 flowid, int32 status)
{
flow\_ring\_node\_t \*flow\_ring\_node;
unsigned long flags;
DHD\_INFO(("%s :Flow Response %d \n", \_\_FUNCTION\_\_, flowid));
// XXX flowid not validated
flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
ASSERT(flow\_ring\_node->flowid == flowid);
if (status != BCME\_OK) {
DHD\_ERROR(("%s Flow create Response failure error status = %d \n",
\_\_FUNCTION\_\_, status));
/\* Call Flow clean up \*/
dhd\_bus\_clean\_flow\_ring(bus, flow\_ring\_node);
return;
}
// XXX lock is passed to dhd\_os\_spin\_lock
DHD\_FLOWRING\_LOCK(flow\_ring\_node->lock, flags);
// XXX overwrite one byte with 0
flow\_ring\_node->status = FLOW\_RING\_STATUS\_OPEN;
// XXX lock is passed to dhd\_os\_spin\_unlock
DHD\_FLOWRING\_UNLOCK(flow\_ring\_node->lock, flags);
dhd\_bus\_schedule\_queue(bus, flowid, FALSE);
return;
}
```
Both of the functions `dhd\_bus\_flow\_ring\_create\_response` and `dhd\_bus\_flow\_ring\_delete\_response` pass the `flow\_ring\_node` pointer to the function `dhd\_bus\_clean\_flow\_ring`, which accesses the dereferenced memory in the following ways:
- Obtains the field `lock` from the dereferenced data structure and passes it to `dhd\_os\_spin\_lock` and `dhd\_os\_spin\_unlock`
- Obtains the field `queue` from the dereferenced data structure and passes it to `dhd\_flow\_queue\_dequeue`
- Overwrites the field `status` of the dereferenced data structure with the value zero
- Overwrites the field `active` of the dereferenced data structure with the value zero
- ...
```
void
dhd\_bus\_flow\_ring\_delete\_response(dhd\_bus\_t \*bus, uint16 flowid, uint32 status)
{
flow\_ring\_node\_t \*flow\_ring\_node;
DHD\_INFO(("%s :Flow Delete Response %d \n", \_\_FUNCTION\_\_, flowid));
// XXX flowid not validated
flow\_ring\_node = DHD\_FLOW\_RING(bus->dhd, flowid);
ASSERT(flow\_ring\_node->flowid == flowid);
if (status != BCME\_OK) {
DHD\_ERROR(("%s Flow Delete Response failure error status = %d \n",
\_\_FUNCTION\_\_, status));
return;
}
/\* Call Flow clean up \*/
dhd\_bus\_clean\_flow\_ring(bus, flow\_ring\_node);
return;
}
```
```
void dhd\_bus\_clean\_flow\_ring(dhd\_bus\_t \*bus, void \*node)
{
void \*pkt;
flow\_queue\_t \*queue;
flow\_ring\_node\_t \*flow\_ring\_node = (flow\_ring\_node\_t \*)node;
unsigned long flags;
queue = &flow\_ring\_node->queue;
#ifdef DHDTCPACK\_SUPPRESS
/\* Clean tcp\_ack\_info\_tbl in order to prevent access to flushed pkt,
\* when there is a newly coming packet from network stack.
\*/
dhd\_tcpack\_info\_tbl\_clean(bus->dhd);
#endif /\* DHDTCPACK\_SUPPRESS \*/
/\* clean up BUS level info \*/
DHD\_FLOWRING\_LOCK(flow\_ring\_node->lock, flags);
/\* Flush all pending packets in the queue, if any \*/
while ((pkt = dhd\_flow\_queue\_dequeue(bus->dhd, queue)) != NULL) {
PKTFREE(bus->dhd->osh, pkt, TRUE);
}
ASSERT(flow\_queue\_empty(queue));
flow\_ring\_node->status = FLOW\_RING\_STATUS\_CLOSED;
flow\_ring\_node->active = FALSE;
dll\_delete(&flow\_ring\_node->list);
DHD\_FLOWRING\_UNLOCK(flow\_ring\_node->lock, flags);
/\* Call Flow ring clean up \*/
dhd\_prot\_clean\_flow\_ring(bus->dhd, flow\_ring\_node->prot\_info);
dhd\_flowid\_free(bus->dhd, flow\_ring\_node->flow\_info.ifindex,
flow\_ring\_node->flowid);
}
```


=== Content from github.com_eccafa4a_20250125_034032.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecuresystemslab%2Fperiscope%2Fblob%2Fmaster%2Fbugs-found%2FCVE-2018-14854_CVE-2018-14855_CVE-2018-14856.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecuresystemslab%2Fperiscope%2Fblob%2Fmaster%2Fbugs-found%2FCVE-2018-14854_CVE-2018-14855_CVE-2018-14856.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=securesystemslab%2Fperiscope)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[securesystemslab](/securesystemslab)
/
**[periscope](/securesystemslab/periscope)**
Public

* [Notifications](/login?return_to=%2Fsecuresystemslab%2Fperiscope) You must be signed in to change notification settings
* [Fork
  13](/login?return_to=%2Fsecuresystemslab%2Fperiscope)
* [Star
   64](/login?return_to=%2Fsecuresystemslab%2Fperiscope)

* [Code](/securesystemslab/periscope)
* [Issues
  0](/securesystemslab/periscope/issues)
* [Pull requests
  0](/securesystemslab/periscope/pulls)
* [Actions](/securesystemslab/periscope/actions)
* [Projects
  0](/securesystemslab/periscope/projects)
* [Security](/securesystemslab/periscope/security)
* [Insights](/securesystemslab/periscope/pulse)

Additional navigation options

* [Code](/securesystemslab/periscope)
* [Issues](/securesystemslab/periscope/issues)
* [Pull requests](/securesystemslab/periscope/pulls)
* [Actions](/securesystemslab/periscope/actions)
* [Projects](/securesystemslab/periscope/projects)
* [Security](/securesystemslab/periscope/security)
* [Insights](/securesystemslab/periscope/pulse)

## Files

 master
## Breadcrumbs

1. [periscope](/securesystemslab/periscope/tree/master)
2. /[bugs-found](/securesystemslab/periscope/tree/master/bugs-found)
/
# CVE-2018-14854\_CVE-2018-14855\_CVE-2018-14856.md

Copy path Blame  Blame
## Latest commit

## History

[History](/securesystemslab/periscope/commits/master/bugs-found/CVE-2018-14854_CVE-2018-14855_CVE-2018-14856.md)1064 lines (1006 loc) · 69.2 KB master
## Breadcrumbs

1. [periscope](/securesystemslab/periscope/tree/master)
2. /[bugs-found](/securesystemslab/periscope/tree/master/bugs-found)
/
# CVE-2018-14854\_CVE-2018-14855\_CVE-2018-14856.md

Top
## File metadata and controls

* Preview
* Code
* Blame

1064 lines (1006 loc) · 69.2 KB[Raw](https://github.com/securesystemslab/periscope/raw/refs/heads/master/bugs-found/CVE-2018-14854_CVE-2018-14855_CVE-2018-14856.md)
# Disclosure

| Date | Detail |
| --- | --- |
| `04/23/2018` | reported to Samsung |
| `08/01/2018` | vulnerabilities confirmed and assigned `SVE-2018-11785`, rated **Low** |
| `08/02/2018` | assigned `CVE-2018-14854`, `CVE-2018-14855` and `CVE-2018-14856` |
| `12/07/2018` | CVE descriptions published <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14854>, <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14855>, <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14856> |

# Affected Product

Samsung Galaxy S6 (SM-G920F), Firmware Version G920FXXU5EQH7

# Vulnerabilities

Three potential buffer overflows in

* `drivers/net/wireless/bcmdhd4358/dhd_pcie.c:5024 (CVE-2018-14856)`
* `drivers/net/wireless/bcmdhd4358/dhd_pcie.c:5093 (CVE-2018-14854)`
* `drivers/net/wireless/bcmdhd4358/dhd_pcie.c:5154 (CVE-2018-14855)`

---

#### CVE-2018-14856

```
5016 void
5017 dhd_bus_flow_ring_create_response(dhd_bus_t *bus, uint16 flowid, int32 status)
5018 {
5019    flow_ring_node_t *flow_ring_node;
5020    unsigned long flags;
5021
5022    DHD_INFO(("%s :Flow Response %d \n", __FUNCTION__, flowid));
5023
5024    flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
5025    ASSERT(flow_ring_node->flowid == flowid);
5026
5027    if (status != BCME_OK) {
5028       DHD_ERROR(("%s Flow create Response failure error status = %d \n",
5029            __FUNCTION__, status));
5030       /* Call Flow clean up */
5031       dhd_bus_clean_flow_ring(bus, flow_ring_node);
5032       return;
5033    }
5034
5035    DHD_FLOWRING_LOCK(flow_ring_node->lock, flags);
5036    flow_ring_node->status = FLOW_RING_STATUS_OPEN;
5037    DHD_FLOWRING_UNLOCK(flow_ring_node->lock, flags);
5038
5039    dhd_bus_schedule_queue(bus, flowid, FALSE);
5040
5041    return;
5042 }

```

#### CVE-2018-14854

```
5086 void
5087 dhd_bus_flow_ring_delete_response(dhd_bus_t *bus, uint16 flowid, uint32 status)
5088 {
5089    flow_ring_node_t *flow_ring_node;
5090
5091    DHD_INFO(("%s :Flow Delete Response %d \n", __FUNCTION__, flowid));
5092
5093    flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
5094    ASSERT(flow_ring_node->flowid == flowid);
5095
5096    if (status != BCME_OK) {
5097       DHD_ERROR(("%s Flow Delete Response failure error status = %d \n",
5098           __FUNCTION__, status));
5099       return;
5100    }
5101    /* Call Flow clean up */
5102    dhd_bus_clean_flow_ring(bus, flow_ring_node);
5103
5104    return;
5105 }

```

#### CVE-2018-14855

```
5143 void
5144 dhd_bus_flow_ring_flush_response(dhd_bus_t *bus, uint16 flowid, uint32 status)
5145 {
5146    flow_ring_node_t *flow_ring_node;
5147
5148    if (status != BCME_OK) {
5149       DHD_ERROR(("%s Flow flush Response failure error status = %d \n",
5150           __FUNCTION__, status));
5151       return;
5152    }
5153
5154    flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
5155    ASSERT(flow_ring_node->flowid == flowid);
5156
5157    flow_ring_node->status = FLOW_RING_STATUS_OPEN;
5158    return;
5159 }

```

# Analysis

We will analyse each of the vulnerabilities seperately.

#### CVE-2018-14856

In line `drivers/net/wireless/bcmdhd4358/dhd_msgbuf.c:4580` below the variable `flow_create_resp` is initialized as a pointer to memory that can be modified by the attacker on WiFi SoC. In line `4585` this memory is passed as the parameter `flow_create_resp->cmplt.flow_ring_id` to the function `dhd_bus_flow_ring_create_response`

```
4577 static void
4578 dhd_prot_process_flow_ring_create_response(dhd_pub_t *dhd, void* buf, uint16 msglen)
4579 {
4580    tx_flowring_create_response_t *flow_create_resp = (tx_flowring_create_response_t *)buf;
4581
4582    DHD_ERROR(("%s Flow create Response status = %d Flow %d\n", __FUNCTION__,
4583       flow_create_resp->cmplt.status, flow_create_resp->cmplt.flow_ring_id));
4584
4585    dhd_bus_flow_ring_create_response(dhd->bus, flow_create_resp->cmplt.flow_ring_id,
4586       flow_create_resp->cmplt.status);
4587 }

```

#### CVE-2018-14854

In line `drivers/net/wireless/bcmdhd4358/dhd_msgbuf.c:4693` below the variable `flow_delete_resp` is initialized as a pointer to memory that can be modified by the attacker on WiFi SoC. In line `4698` this memory is passed as the parameter `low_delete_resp->cmplt.flow_ring_id` to the function `dhd_bus_flow_ring_delete_response`

```
4690 static void
4691 dhd_prot_process_flow_ring_delete_response(dhd_pub_t *dhd, void* buf, uint16 msglen)
4692 {
4693    tx_flowring_delete_response_t *flow_delete_resp = (tx_flowring_delete_response_t *)buf;
4694
4695    DHD_INFO(("%s Flow Delete Response status = %d \n", __FUNCTION__,
4696       flow_delete_resp->cmplt.status));
4697
4698    dhd_bus_flow_ring_delete_response(dhd->bus, flow_delete_resp->cmplt.flow_ring_id,
4699       flow_delete_resp->cmplt.status);
4700 }

```

#### CVE-2018-14855

In line `drivers/net/wireless/bcmdhd4358/dhd_msgbuf.c:4745` below the variable `flow_flush_resp` is initialized as a pointer to memory that can be modified by an attacker on the WiFi SoC. In line `4750` this memory is passed as the parameter `low_flush_resp->cmplt.flow_ring_id` to the function `dhd_bus_flow_ring_flush_response`

```
4742 static void
4743 dhd_prot_process_flow_ring_flush_response(dhd_pub_t *dhd, void* buf, uint16 msglen)
4744 {
4745    tx_flowring_flush_response_t *flow_flush_resp = (tx_flowring_flush_response_t *)buf;
4746
4747    DHD_INFO(("%s Flow Flush Response status = %d \n", __FUNCTION__,
4748       flow_flush_resp->cmplt.status));
4749
4750    dhd_bus_flow_ring_flush_response(dhd->bus, flow_flush_resp->cmplt.flow_ring_id,
4751       flow_flush_resp->cmplt.status);
4752 }

```

# Kernel Traces

#### CVE-2018-14856

```
[  200.743070] ------------[ cut here ]------------
[  200.743091] Kernel BUG at ffffffc000e939dc [verbose debug info unavailable]
[  200.743114] Internal error: Oops - BUG: 96000004 [#1] PREEMPT SMP
[  200.743137] Modules linked in:
[  200.743164] exynos-snapshot: core register saved(CPU:0)
[  200.743184] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[  200.743204] exynos-snapshot: context saved(CPU:0)
[  200.743315] exynos-snapshot: item - log_kevents is disabled
[  200.743391] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G        W    3.10.61-TeamNexus-gb11c661e30ff #763
[  200.743420] task: ffffffc0016e8830 ti: ffffffc0016dc000 task.ti: ffffffc0016dc000
[  200.743461] PC is at _raw_spin_lock_irqsave+0x24/0x58
[  200.743491] LR is at dhd_os_spin_lock+0x24/0x58
[  200.743514] pc : [<ffffffc000e939dc>] lr : [<ffffffc000832c14>] pstate: 800000c5
[  200.743534] sp : ffffffc0016df960
[  200.743555] x29: ffffffc0016df960 x28: ffffff8000018450
[  200.743582] x27: 0000000000000010 x26: ffffffc00192d000
[  200.743603] x25: ffffffc0a0df3c80 x24: 00000000ffffabab
[  200.743625] x23: ffffffc00192d000 x22: ffffffc09655dd88
[  200.743646] x21: ffffffc09655dd78 x20: ffffffc0a07cf000
[  200.743667] x19: 0064656e69666564 x18: 000000000000000a
[  200.743688] x17: 0000007f9988e3f0 x16: 00000000000029ea
[  200.743710] x15: 000000000000fff9 x14: 0000000000000002
[  200.743731] x13: 0000000000005455 x12: 0000000000000005
[  200.743752] x11: ffffffc0016df980 x10: ffffffc0016df8cf
[  200.743773] x9 : 7f7f7f7f7f7f7f7f x8 : 206572756c696166
[  200.743795] x7 : 2065736e6f707365 x6 : ffffffc0016df8d6
[  200.743816] x5 : 00000000000000cd x4 : 000000000000ffff
[  200.743838] x3 : ffffffc0016dc000 x2 : 0000000000000040
[  200.743858] x1 : 0000000000000102 x0 : 0064656e69666564
[  200.743883]
[  200.743883] PC: 0xffffffc000e9395c:
[  200.743914] 395c  35ffffa2 d65f03c0 d503201f d50342df 910003e1 9272c421 aa0103e2 b9405021
[  200.743956] 397c  11000421 b9005041 f9800011 885ffc01 11404022 88037c02 35ffffa3 4ac14022
[  200.743994] 399c  340000c2 d50320bf d503205f 485ffc03 4a414062 35ffffa2 d65f03c0 d53b4222
[  200.744032] 39bc  d50342df 910003e1 9272c421 aa0103e3 b9405021 11000421 b9005061 f9800011
[  200.744069] 39dc  885ffc01 11404023 88047c03 35ffffa4 4ac14023 340000c3 d50320bf d503205f
[  200.744107] 39fc  485ffc04 4a414083 35ffffa3 aa0203e0 d65f03c0 910003e1 9272c421 aa0103e2
[  200.744144] 3a1c  b9405021 11000421 b9005041 d50320bf d503205f 885ffc01 11000421 37ffffa1
[  200.744181] 3a3c  88027c01 35ffff82 d65f03c0 910003e1 9272c421 aa0103e2 b9405021 11000421
[  200.744222]
[  200.744222] LR: 0xffffffc000832b94:
[  200.744252] 2b94  b4000060 97ea8e80 b900027f 97ea8e7e aa1303e0 f9400bf3 a8c27bfd d65f03c0
[  200.744290] 2bb4  d503201f a9be7bfd 910003fd a90153f3 aa0003f3 aa0103f4 97ea8e73 aa1403e1
[  200.744328] 2bd4  aa1303e0 52800102 94008ff5 a94153f3 a8c27bfd d65f03c0 d503201f a9be7bfd
[  200.744365] 2bf4  910003fd f9000bf3 aa0003f3 97ea8e66 b4000173 97ea8e64 aa1303e0 9419836a
[  200.744404] 2c14  aa0003f3 97ea8e60 aa1303e0 f9400bf3 a8c27bfd d65f03c0 d503201f 97ea8e5a
[  200.744441] 2c34  d2800013 aa1303e0 f9400bf3 a8c27bfd d65f03c0 a9be7bfd 910003fd a90153f3
[  200.744479] 2c54  aa0003f3 aa0103f4 97ea8e4f b40000b3 97ea8e4d aa1403e1 aa1303e0 94198422
[  200.744516] 2c74  97ea8e49 a94153f3 a8c27bfd d65f03c0 d503201f a9bb7bfd 910003fd f9000bf3
[  200.744557]
[  200.744557] SP: 0xffffffc0016df8e0:
[  200.744588] f8e0  a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0
[  200.744624] f900  ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[  200.744661] f920  00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[  200.744698] f940  00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[  200.744735] f960  016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[  200.744772] f980  016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[  200.744810] f9a0  a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[  200.744848] f9c0  016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[  200.744890]
[  200.744890] X3: 0xffffffc0016dbf80:
[  200.744920] bf80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.744956] bfa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.744992] bfc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.745029] bfe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.745064] c000  00000002 00000000 ffffffff ffffffff 016e8830 ffffffc0 016f0520 ffffffc0
[  200.745101] c020  0025c408 ffffffc0 00000000 00000000 00000000 00000000 00000000 00000000
[  200.745138] c040  00000000 00000000 00000000 00000000 00000104 00000000 00000000 00000000
[  200.745174] c060  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.745214]
[  200.745214] X6: 0xffffffc0016df856:
[  200.745244] f854  00000000 016dc000 ffffffc0 0000ffff 00000000 000000cd 00000000 016df8d6
[  200.745281] f874  ffffffc0 6f707365 2065736e 6c696166 20657275 7f7f7f7f 7f7f7f7f 016df8cf
[  200.745318] f894  ffffffc0 016df980 ffffffc0 00000005 00000000 00005455 00000000 00000002
[  200.745355] f8b4  00000000 0000fff9 00000000 000029ea 00000000 9988e3f0 0000007f 0000000a
[  200.745392] f8d4  00000000 69666564 0064656e a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88
[  200.745429] f8f4  ffffffc0 0192d000 ffffffc0 ffffabab 00000000 a0df3c80 ffffffc0 0192d000
[  200.745466] f914  ffffffc0 00000010 00000000 00018450 ffffff80 016df960 ffffffc0 00832c14
[  200.745503] f934  ffffffc0 016df960 ffffffc0 00e939dc ffffffc0 800000c5 00000000 016df960
[  200.745540] f954  ffffffc0 00832c0c ffffffc0 016df980 ffffffc0 008c2124 ffffffc0 9655dd78
[  200.745582]
[  200.745582] X10: 0xffffffc0016df84f:
[  200.745612] f84c  00000000 00000040 00000000 016dc000 ffffffc0 0000ffff 00000000 000000cd
[  200.745649] f86c  00000000 016df8d6 ffffffc0 6f707365 2065736e 6c696166 20657275 7f7f7f7f
[  200.745686] f88c  7f7f7f7f 016df8cf ffffffc0 016df980 ffffffc0 00000005 00000000 00005455
[  200.745723] f8ac  00000000 00000002 00000000 0000fff9 00000000 000029ea 00000000 9988e3f0
[  200.745760] f8cc  0000007f 0000000a 00000000 69666564 0064656e a07cf000 ffffffc0 9655dd78
[  200.745796] f8ec  ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0 ffffabab 00000000 a0df3c80
[  200.745833] f90c  ffffffc0 0192d000 ffffffc0 00000010 00000000 00018450 ffffff80 016df960
[  200.745870] f92c  ffffffc0 00832c14 ffffffc0 016df960 ffffffc0 00e939dc ffffffc0 800000c5
[  200.745908] f94c  00000000 016df960 ffffffc0 00832c0c ffffffc0 016df980 ffffffc0 008c2124
[  200.745948]
[  200.745948] X11: 0xffffffc0016df900:
[  200.745977] f900  ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[  200.746014] f920  00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[  200.746051] f940  00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[  200.746088] f960  016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[  200.746125] f980  016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[  200.746162] f9a0  a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[  200.746199] f9c0  016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[  200.746236] f9e0  ffffabab ffffffff 960d8000 ffffffc0 008c8ff0 ffffffc0 00000010 00000000
[  200.746282]
[  200.746282] X20: 0xffffffc0a07cef80:
[  200.746312] ef80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.746348] efa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.746384] efc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.746420] efe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.746456] f000  960d8000 ffffffc0 9856b000 ffffffc0 96103040 ffffffc0 961030a8 ffffffc0
[  200.746495] f020  5faab100 ffffffc0 8c4b4000 ffffffc0 00000d7d 00000000 0cf70000 ffffff80
[  200.746532] f040  00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[  200.746569] f060  960dafb0 ffffffc0 960dbfb0 ffffffc0 00000000 00000000 00000000 00000000
[  200.746608]
[  200.746608] X21: 0xffffffc09655dcf8:
[  200.746638] dcf8  62206465 6f6d2079 206c6564 756f7267 54007370 6b206568 65727965 65722066
[  200.746678] dd18  65726566 7365636e 6b206120 65727965 68540066 61632065 6e696472 74696c61
[  200.746715] dd38  666f2079 65687420 79656b20 20666572 66666964 20737265 6d6f7266 65687420
[  200.746752] dd58  72616320 616e6964 7974696c 20666f20 20656874 65666572 636e6572 6b206465
[  200.746789] dd78  752f7965 7571696e 25272065 54002773 64206568 6e696665 6f697469 7369206e
[  200.746826] dd98  72696320 616c7563 69430072 6c756372 72207261 72656665 65636e65 206f7420
[  200.746864] ddb8  20656874 65646f6d 7267206c 2070756f 69666564 6974696e 27206e6f 20277325
[  200.747170] ddd8  69666564 0064656e 63726943 72616c75 66657220 6e657265 74206563 6874206f
[  200.747258]
[  200.747258] X22: 0xffffffc09655dd08:
[  200.747288] dd08  54007370 6b206568 65727965 65722066 65726566 7365636e 6b206120 65727965
[  200.747326] dd28  68540066 61632065 6e696472 74696c61 666f2079 65687420 79656b20 20666572
[  200.747363] dd48  66666964 20737265 6d6f7266 65687420 72616320 616e6964 7974696c 20666f20
[  200.747399] dd68  20656874 65666572 636e6572 6b206465 752f7965 7571696e 25272065 54002773
[  200.747436] dd88  64206568 6e696665 6f697469 7369206e 72696320 616c7563 69430072 6c756372
[  200.747473] dda8  72207261 72656665 65636e65 206f7420 20656874 65646f6d 7267206c 2070756f
[  200.747510] ddc8  69666564 6974696e 27206e6f 20277325 69666564 0064656e 63726943 72616c75
[  200.747547] dde8  66657220 6e657265 74206563 6874206f 74612065 62697274 20657475 756f7267
[  200.747588]
[  200.747588] X23: 0xffffffc00192cf80:
[  200.747617] cf80  00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[  200.747655] cfa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747691] cfc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747727] cfe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747763] d000  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747800] d020  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747835] d040  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747873] d060  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.747913]
[  200.747913] X25: 0xffffffc0a0df3c00:
[  200.747943] 3c00  9f334748 ffffffc0 9f334748 ffffffc0 a0df3d10 ffffffc0 a0df3b10 ffffffc0
[  200.747981] 3c20  00004000 00000000 00018000 ffffff80 00000001 00000000 9f334400 ffffffc0
[  200.748018] 3c40  00000001 00000000 00000200 dead0000 00000000 00000000 b7f6f058 ffffffc0
[  200.748056] 3c60  b9f02600 ffffffc0 ffffffff 00000002 00040004 00000000 00000000 00000000
[  200.748093] 3c80  00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[  200.748130] 3ca0  00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[  200.748166] 3cc0  00000000 00000000 9ce25ec0 ffffffc0 9ce25100 ffffffc0 00000544 00000000
[  200.748204] 3ce0  00000000 00000000 00000000 00000000 00000100 00000000 00000000 00000000
[  200.748243]
[  200.748243] X26: 0xffffffc00192cf80:
[  200.748274] cf80  00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[  200.748310] cfa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748346] cfc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748382] cfe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748419] d000  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748455] d020  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748491] d040  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748527] d060  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.748568]
[  200.748568] X29: 0xffffffc0016df8e0:
[  200.748598] f8e0  a07cf000 ffffffc0 9655dd78 ffffffc0 9655dd88 ffffffc0 0192d000 ffffffc0
[  200.748635] f900  ffffabab 00000000 a0df3c80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[  200.748672] f920  00018450 ffffff80 016df960 ffffffc0 00832c14 ffffffc0 016df960 ffffffc0
[  200.748711] f940  00e939dc ffffffc0 800000c5 00000000 016df960 ffffffc0 00832c0c ffffffc0
[  200.748748] f960  016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[  200.748785] f980  016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[  200.748822] f9a0  a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[  200.748859] f9c0  016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[  200.748896]
[  200.748918] Process swapper/0 (pid: 0, stack limit = 0xffffffc0016dc058)
[  200.748943] Stack: (0xffffffc0016df960 to 0xffffffc0016e0000)
[  200.748973] f960: 016df980 ffffffc0 008c2124 ffffffc0 9655dd78 ffffffc0 008c2114 ffffffc0
[  200.749002] f980: 016df9c0 ffffffc0 008c22f4 ffffffc0 9655dd78 ffffffc0 00f51298 ffffffc0
[  200.749031] f9a0: a07cf000 ffffffc0 0155b8d0 ffffffc0 0192d000 ffffffc0 008c22e8 ffffffc0
[  200.749059] f9c0: 016dfa30 ffffffc0 008c9034 ffffffc0 00018450 ffffff80 0000abab 00000000
[  200.749087] f9e0: ffffabab ffffffff 960d8000 ffffffc0 008c8ff0 ffffffc0 00000010 00000000
[  200.749117] fa00: 008c909c ffffffc0 016dfa30 ffffffc0 008c90a4 ffffffc0 80000045 00000000
[  200.749147] fa20: 016dfa30 ffffffc0 008c9024 ffffffc0 016dfa60 ffffffc0 008cab08 ffffffc0
[  200.749175] fa40: 00000010 00000000 960d8000 ffffffc0 00000010 00000000 00018450 ffffff80
[  200.749203] fa60: 016dfb00 ffffffc0 008d001c ffffffc0 00000010 00000000 a0df3c80 ffffffc0
[  200.749231] fa80: 960d8000 ffffffc0 960d0000 ffffffc0 00018450 ffffff80 9ce25ec0 ffffffc0
[  200.749259] faa0: 00000000 00000000 960da000 ffffffc0 00000400 00000000 00000046 00000000
[  200.749288] fac0: 00000003 00000000 00f516f8 ffffffc0 960d8000 ffffffc0 0155d190 ffffffc0
[  200.749317] fae0: 00000000 ffffffc0 00000029 00000010 960d0000 ffffffc0 00f51928 ffffffc0
[  200.749346] fb00: 016dfb80 ffffffc0 008ba240 ffffffc0 a07cf010 ffffffc0 a07cf000 ffffffc0
[  200.749374] fb20: 019367d0 ffffffc0 960d8000 ffffffc0 a07cf010 ffffffc0 00000000 00000000
[  200.749403] fb40: 016e20b0 ffffffc0 01a46000 ffffffc0 01c52000 ffffffc0 00000001 00000000
[  200.749432] fb60: 00f51b90 ffffffc0 00f516f8 ffffffc0 016dfb80 00000040 0192de00 ffffffc0
[  200.749462] fb80: 016dfbd0 ffffffc0 008c1b94 ffffffc0 a07cf000 ffffffc0 0192d000 ffffffc0
[  200.749490] fba0: 00000001 00000000 5faab100 ffffffc0 01a46680 ffffffc0 5faab100 ffffffc0
[  200.749519] fbc0: 016dfbd0 ffffffc0 008c1b84 ffffffc0 016dfc00 ffffffc0 008302ec ffffffc0
[  200.749548] fbe0: 960d8000 ffffffc0 a07cf000 ffffffc0 00000000 00000000 016d4d28 ffffffc0
[  200.749577] fc00: 016dfc20 ffffffc0 0024481c ffffffc0 960dd040 ffffffc0 960dd048 ffffffc0
[  200.749605] fc20: 016dfc60 ffffffc0 00245040 ffffffc0 00000006 00000000 00000101 00000000
[  200.749633] fc40: 016d4f88 ffffffc0 00000006 00000000 016e2000 ffffffc0 01a46000 ffffffc0
[  200.749661] fc60: 016dfcf0 ffffffc0 0024583c ffffffc0 000000c0 00000000 000000ed 00000000
[  200.749689] fc80: 00000000 00000000 bca74b82 0000002e 60000045 00000000 00000000 00000000
[  200.749717] fca0: 00000000 00000000 40202000 00000000 00205430 ffffffc0 40000000 00000040
[  200.749746] fcc0: 016dfcd0 ffffffc0 016f08b0 ffffffc0 ffffd939 00000000 00200000 0000000a
[  200.749774] fce0: 016d4dd0 ffffffc0 000000ed 00000000 016dfd10 ffffffc0 0020ada4 ffffffc0
[  200.749802] fd00: 016d6000 ffffffc0 0020ad80 ffffffc0 016dfd40 ffffffc0 002063e8 ffffffc0
[  200.749831] fd20: 0000200c ffffff80 016dfd70 ffffffc0 01cb1c00 ffffffc0 00002010 ffffff80
[  200.749860] fd40: 016dfe90 ffffffc0 0020a5e8 ffffffc0 000f4240 00000000 be0bb558 ffffffc0
[  200.749889] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000008 00000000 f9003000 ffffff80
[  200.749918] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[  200.749946] fda0: d4f06280 0030479e ffffffff 00ffffff 3b9aca00 00000000 00000033 00000000
[  200.749974] fdc0: 00000006 00000000 0225a2cf 00000000 00000024 00000000 000051cf 00000000
[  200.750003] fde0: 0000338b 00000000 0000328b 00000000 000029ea 00000000 9988e3f0 0000007f
[  200.750032] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 000371ff 00000000
[  200.750059] fe20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.750088] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[  200.750116] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0 00adf490 ffffffc0 60000045 00000000
[  200.750145] fe80: 00205430 ffffffc0 40000000 00000040 016dfed0 ffffffc0 00adf5cc ffffffc0
[  200.750173] fea0: be0bb558 ffffffc0 00000000 00000000 01a47000 ffffffc0 01fdd000 ffffffc0
[  200.750203] fec0: 01953f38 ffffffc0 002a5598 00000001 016dff20 ffffffc0 0020b6ac ffffffc0
[  200.750231] fee0: 01c525b8 ffffffc0 01c585d8 ffffffc0 01a47000 ffffffc0 00ec6000 ffffffc0
[  200.750260] ff00: 01a463cb ffffffc0 014b9858 ffffffc0 40200000 00000000 00ec6000 ffffffc0
[  200.750288] ff20: 016dff30 ffffffc0 002a5618 ffffffc0 016dff80 ffffffc0 00e74184 ffffffc0
[  200.750317] ff40: 00000002 00000000 016bee08 ffffffc0 01a4d000 ffffffc0 be1bbac0 ffffffc0
[  200.750345] ff60: 016bee08 ffffffc0 40000000 00000000 40200000 00000000 40202000 00000000
[  200.750374] ff80: 016dffa0 ffffffc0 01670808 ffffffc0 01c89000 ffffffc0 01670800 ffffffc0
[  200.750401] ffa0: 00000000 00000000 40205210 00000000 43e77c88 00000000 00000e11 00000000
[  200.750429] ffc0: 4a000000 00000000 410fd032 00000000 416e9dd8 00000000 00000000 00000000
[  200.750456] ffe0: 00000000 00000000 016bee08 ffffffc0 00000000 00000000 00000000 00000000
[  200.750475] Call trace:
[  200.750502] [<ffffffc000e939dc>] _raw_spin_lock_irqsave+0x24/0x58
[  200.750533] [<ffffffc0008c2120>] dhd_bus_clean_flow_ring+0x30/0xf8
[  200.750560] [<ffffffc0008c22f0>] dhd_bus_flow_ring_create_response+0x90/0x480
[  200.750592] [<ffffffc0008c9030>] dhd_prot_process_flow_ring_create_response+0x40/0xb8
[  200.750617] [<ffffffc0008cab04>] dhd_prot_process_msgtype+0x14c/0x5a8
[  200.750641] [<ffffffc0008d0018>] dhd_prot_process_msgbuf_txcpl+0x1c8/0x3f0
[  200.750669] [<ffffffc0008ba23c>] dhdpcie_bus_process_mailbox_intr+0x1f4/0x518
[  200.750694] [<ffffffc0008c1b90>] dhd_bus_dpc+0x160/0x260
[  200.750726] [<ffffffc0008302e8>] dhd_dpc+0x28/0x98
[  200.750758] [<ffffffc000244818>] tasklet_action+0x90/0x1e0
[  200.750783] [<ffffffc00024503c>] __do_softirq+0x144/0x3e0
[  200.750809] [<ffffffc000245838>] irq_exit+0x108/0x130
[  200.750839] [<ffffffc00020ada0>] handle_IRQ+0x58/0xc8
[  200.750864] [<ffffffc0002063e4>] gic_handle_irq+0x3c/0x88
[  200.750886] Exception stack(0xffffffc0016dfd50 to 0xffffffc0016dfe70)
[  200.750910] fd40:                                     000f4240 00000000 be0bb558 ffffffc0
[  200.750939] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000008 00000000 f9003000 ffffff80
[  200.750966] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[  200.750995] fda0: d4f06280 0030479e ffffffff 00ffffff 3b9aca00 00000000 00000033 00000000
[  200.751022] fdc0: 00000006 00000000 0225a2cf 00000000 00000024 00000000 000051cf 00000000
[  200.751050] fde0: 0000338b 00000000 0000328b 00000000 000029ea 00000000 9988e3f0 0000007f
[  200.751077] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 000371ff 00000000
[  200.751104] fe20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  200.751133] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[  200.751158] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0
[  200.751183] [<ffffffc00020a5e4>] el1_irq+0x64/0xd4
[  200.751217] [<ffffffc000adf5c8>] cpuidle_idle_call+0xc0/0x278
[  200.751242] [<ffffffc00020b6a8>] arch_cpu_idle+0x8/0x20
[  200.751275] [<ffffffc0002a5614>] cpu_startup_entry+0xcc/0x280
[  200.751305] [<ffffffc000e74180>] rest_init+0x80/0x90
[  200.751337] [<ffffffc001670804>] start_kernel+0x314/0x32c
[  200.751363] Code: b9405021 11000421 b9005061 f9800011 (885ffc01)
[  200.751470] ---[ end trace e1070556e6f65c99 ]---
```

#### CVE-2018-14854

```
[  385.605978] Unable to handle kernel NULL pointer dereference at virtual address 00000000
[  385.606001] pgd = ffffffc000202000
[  385.606026] [00000000] *pgd=00000000fa409003, *pmd=00000000fa40c003, *pte=0060000011001707
[  385.606257] Kernel BUG at ffffffc0008c21a0 [verbose debug info unavailable]
[  385.606279] Internal error: Oops - BUG: 96000045 [#1] PREEMPT SMP
[  385.606329] Modules linked in:
[  385.606405] exynos-snapshot: core register saved(CPU:0)
[  385.606450] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[  385.606513] exynos-snapshot: context saved(CPU:0)
[  385.606665] exynos-snapshot: item - log_kevents is disabled
[  385.606748] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G        W    3.10.61-TeamNexus-gb11c661e30ff #763
[  385.606799] task: ffffffc0016e8830 ti: ffffffc0016dc000 task.ti: ffffffc0016dc000
[  385.606866] PC is at dhd_bus_clean_flow_ring+0xb0/0xf8
[  385.606890] LR is at dhd_bus_clean_flow_ring+0x9c/0xf8
[  385.606919] pc : [<ffffffc0008c21a0>] lr : [<ffffffc0008c218c>] pstate: 60000045
[  385.606938] sp : ffffffc0016df9b0
[  385.606958] x29: ffffffc0016df9b0 x28: ffffff8000018450
[  385.606985] x27: 0000000000000010 x26: ffffffc00192d000
[  385.607013] x25: ffffffc0a000da80 x24: 0000000000000010
[  385.607035] x23: 0000000000000000 x22: ffffffc095efb7a8
[  385.607057] x21: ffffffc095efb798 x20: ffffffc0b891c000
[  385.607077] x19: 0000000000000000 x18: 000000000000000a
[  385.607105] x17: 0000000000000000 x16: 0000000000000000
[  385.607126] x15: 0000000000000000 x14: 0000000000000001
[  385.607148] x13: 0000000000093eab x12: 0000000000000006
[  385.607169] x11: ffffffc081a514df x10: ffffffc001a514e7
[  385.607198] x9 : ffffffc001a52138 x8 : 63705f6468642220
[  385.607219] x7 : 656c6966203a2264 x6 : ffffffc001a51548
[  385.607239] x5 : 0000000000105578 x4 : 000000000000ffff
[  385.607260] x3 : 00fffd8f7a5c218c x2 : 0000000000000000
[  385.607281] x1 : 0000000000000000 x0 : 0000000000000000
[  385.607310]
[  385.607310] PC: 0xffffffc0008c2120:
[  385.607341] 2120  97fdc2b4 aa0003f7 14000008 d503201f 97e8511a f9400280 52800022 aa1303e1
[  385.607388] 2140  f9400000 97fe4e8f 97e85114 f9400280 aa1603e1 940011ed aa0003f3 b5fffea0
[  385.607426] 2160  97e8510e 794042c0 34000100 97e8510b 900064c1 b00064c0 52826ee2 911fc021
[  385.607464] 2180  91218000 97fe5495 97e85104 390102bf a94002a2 52800041 390106a1 aa1703e1
[  385.607501] 21a0  f9000002 a9400aa0 f9000402 f94032a0 97fdc2a6 f9400280 f9402ea1 940043d1
[  385.607538] 21c0  794086a2 394116a1 f9400280 940016b7 f9401bf7 a94153f3 a9425bf5 a8c47bfd
[  385.607576] 21e0  d65f03c0 d503201f a9be7bfd 910003fd a90153f3 aa0003f3 aa0103f4 97e850e7
[  385.607613] 2200  f0008340 b94e0000 371001c0 97e850e3 f9400260 aa1403e1 9400425a 7100001f
[  385.607654]
[  385.607654] LR: 0xffffffc0008c210c:
[  385.607683] 210c  f9001bf7 97e85122 f9400280 97fda546 f94032a0 97fdc2b4 aa0003f7 14000008
[  385.607721] 212c  d503201f 97e8511a f9400280 52800022 aa1303e1 f9400000 97fe4e8f 97e85114
[  385.607758] 214c  f9400280 aa1603e1 940011ed aa0003f3 b5fffea0 97e8510e 794042c0 34000100
[  385.607795] 216c  97e8510b 900064c1 b00064c0 52826ee2 911fc021 91218000 97fe5495 97e85104
[  385.607832] 218c  390102bf a94002a2 52800041 390106a1 aa1703e1 f9000002 a9400aa0 f9000402
[  385.607869] 21ac  f94032a0 97fdc2a6 f9400280 f9402ea1 940043d1 794086a2 394116a1 f9400280
[  385.607906] 21cc  940016b7 f9401bf7 a94153f3 a9425bf5 a8c47bfd d65f03c0 d503201f a9be7bfd
[  385.607943] 21ec  910003fd a90153f3 aa0003f3 aa0103f4 97e850e7 f0008340 b94e0000 371001c0
[  385.607983]
[  385.607983] SP: 0xffffffc0016df930:
[  385.608014] f930  b891c000 ffffffc0 95efb798 ffffffc0 95efb7a8 ffffffc0 00000000 00000000
[  385.608050] f950  00000010 00000000 a000da80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[  385.608093] f970  00018450 ffffff80 016df9b0 ffffffc0 008c218c ffffffc0 016df9b0 ffffffc0
[  385.608131] f990  008c21a0 ffffffc0 60000045 00000000 016df9b0 ffffffc0 008c218c ffffffc0
[  385.608174] f9b0  016df9f0 ffffffc0 008c2950 ffffffc0 95efb798 ffffffc0 0000feff 00000000
[  385.608212] f9d0  0192d000 ffffffc0 b891c000 ffffffc0 00000000 00000000 008c2944 ffffffc0
[  385.608255] f9f0  016dfa30 ffffffc0 008c8fb8 ffffffc0 00018450 ffffff80 00000000 00000000
[  385.608298] fa10  95848000 ffffffc0 00018450 ffffff80 008c8f78 ffffffc0 008c8fa8 ffffffc0
[  385.608342]
[  385.608342] X6: 0xffffffc001a514c8:
[  385.608377] 14c8  00000000 00000000 00000000 00000000 00000001 00000000 30303020 32303330
[  385.608414] 14e8  31343830 20205d34 203a305b 20202020 61777320 72657070 203a302f 30202020
[  385.608459] 1508  3531205d 38203830 30362e35 32343338 5b49205d 20203a30 20202020 70617773
[  385.608497] 1528  2f726570 20203a30 5d302020 3a365820 66783020 66666666 30306366 31356131
[  385.608534] 1548  3a386334 0a0a350a 3162672d 36366331 30336531 23206666 0a333637 6f707365
[  385.608571] 1568  2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666 30303030
[  385.608614] 1588  35343831 63202c61 303d7874 63313578 540a3839 2c30203a 73617020 5f646573
[  385.608651] 15a8  33203a54 66202c30 5f6c6c75 33203a54 63202c30 655f6768 545f646e 2c30203a
[  385.608699]
[  385.608699] X9: 0xffffffc001a520b8:
[  385.608734] 20b8  2c686565 33376435 610a2c68 3d6f6e6c 35313330 33666437 39663466 63306461
[  385.608772] 20d8  646e7320 636f735f 726f635f 6d702e65 6e776f64 6d69745f 30313d65 7a203030
[  385.608816] 20f8  5f6f7265 68636473 63695f67 6120313d 6f72646e 6f626469 662e746f 635f706d
[  385.608853] 2118  69666e6f 0a303d67 00000000 00000000 00000000 00000000 006c6148 ffffffc0
[  385.608896] 2138  38333132 33313333 66660033 30306366 32356131 3a386230 726c000a 5b203a20
[  385.608933] 2158  6666663c 63666666 38303030 38313263 205d3e63 61747370 203a6574 30303036
[  385.608976] 2178  35343030 0a30000a 31626700 36366331 30336531 23206666 0a333637 6f707300
[  385.609013] 2198  2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666 30303030
[  385.609059]
[  385.609059] X10: 0xffffffc001a51467:
[  385.609089] 1464  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.609133] 1484  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.609169] 14a4  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.609210] 14c4  00000000 00000000 00000000 00000000 00000000 00000001 00000000 30303020
[  385.609255] 14e4  362e3538 35323938 20205d35 203a305b 20202020 61777320 72657070 203a302f
[  385.609292] 1504  30202020 3531205d 38203430 30362e35 39353039 5b49205d 20203a30 20202020
[  385.609329] 1524  70617773 2f726570 20203a30 5d302020 30315820 7830203a 66666666 30636666
[  385.609366] 1544  35613130 37363431 0a0a0a3a 3162672d 36366331 30336531 23206666 0a333637
[  385.609408] 1564  6f707365 2b65736e 30337830 3778302f 64612038 303d7264 66666678 38666666
[  385.609449]
[  385.609449] X11: 0xffffffc081a5145f:
[  385.609479] 145c  aa0203fc 58002d1e 58002d20 d63f03c0 39472aa0 35002020 b94196bb 6b1b031f
[  385.609522] 147c  54001fc1 71000b1f 54001861 34000f7a aa1503e1 90001240 f9457800 f940181e
[  385.609565] 149c  d63f03c0 34000ea0 b94132bb 37f80d1b b9410aa0 b9410ea1 4b1b003c 6b1c001f
[  385.609603] 14bc  54000c6a 394732a0 35000160 394712a0 35000120 b9418ea0 121b0000 350000c0
[  385.609647] 14dc  b9418aa0 12000400 35000060 39472ea0 14000002 52800020 35000aa0 9000135d
[  385.609685] 14fc  b94dfbbd 3400213d aa1403e1 52822460 f940de7e d63f03c0 aa0003e1 aa0103f4
[  385.609729] 151c  580027be 580027c0 d63f03c0 d0001342 b94c4442 34002082 aa1403e1 aa0203fb
[  385.609766] 153c  b9400020 f9418000 f940181e d63f03c0 b9410ea2 34002020 aa0003e1 aa0103f4
[  385.609811] 155c  aa0203fb b9400020 f9416c00 f940181e d63f03c0 900012c2 b949d442 34001f42
[  385.609858]
[  385.609858] X20: 0xffffffc0b891bf80:
[  385.609893] bf80  01d09698 ffffffbc 00000000 00001000 84bd5000 00000000 00001000 00000000
[  385.609932] bfa0  01b966d0 ffffffbc 00000000 00001000 7e1d6000 00000000 00001000 00000000
[  385.609975] bfc0  01b968c8 ffffffbc 00000000 00001000 7e1df000 00000000 00001000 00000000
[  385.610013] bfe0  01c6107a ffffffbc 00000000 00001000 81bb9000 00000000 00001000 00000000
[  385.610055] c000  95848000 ffffffc0 9740c800 ffffffc0 95883040 ffffffc0 958830a8 ffffffc0
[  385.610101] c020  974ae100 ffffffc0 885c2000 ffffffc0 00000d7d 00000000 0cf70000 ffffff80
[  385.610137] c040  00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[  385.610175] c060  9584afb0 ffffffc0 9584bfb0 ffffffc0 00000000 00000000 00000000 00000000
[  385.610215]
[  385.610215] X21: 0xffffffc095efb718:
[  385.610251] b718  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610287] b738  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610328] b758  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610364] b778  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610406] b798  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610442] b7b8  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610483] b7d8  00000200 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610520] b7f8  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610564]
[  385.610564] X22: 0xffffffc095efb728:
[  385.610594] b728  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610636] b748  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610673] b768  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610715] b788  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610757] b7a8  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610793] b7c8  00000000 00000000 00000000 00000000 00000200 00000000 00000000 00000000
[  385.610830] b7e8  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610871] b808  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.610920]
[  385.610920] X25: 0xffffffc0a000da00:
[  385.610950] da00  9cf6e9c0 ffffffc0 a000d788 ffffffc0 b9ef1330 ffffffc0 9f1a6810 ffffffc0
[  385.610988] da20  b9ef1330 ffffffc0 019240f8 ffffffc0 a03b9000 ffffffc0 00000002 00000003
[  385.611026] da40  01744378 ffffffc0 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611068] da60  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611104] da80  00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[  385.611480] daa0  00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[  385.611537] dac0  00000000 00000000 9cf63700 ffffffc0 9cf63800 ffffffc0 00000d44 00000000
[  385.611574] dae0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611619]
[  385.611619] X26: 0xffffffc00192cf80:
[  385.611649] cf80  00000000 00000000 00808310 ffffffc0 00000000 00000000 00000000 00000000
[  385.611692] cfa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611736] cfc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611773] cfe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611810] d000  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611846] d020  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611887] d040  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611924] d060  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.611969]
[  385.611969] X29: 0xffffffc0016df930:
[  385.611999] f930  b891c000 ffffffc0 95efb798 ffffffc0 95efb7a8 ffffffc0 00000000 00000000
[  385.612041] f950  00000010 00000000 a000da80 ffffffc0 0192d000 ffffffc0 00000010 00000000
[  385.612078] f970  00018450 ffffff80 016df9b0 ffffffc0 008c218c ffffffc0 016df9b0 ffffffc0
[  385.612121] f990  008c21a0 ffffffc0 60000045 00000000 016df9b0 ffffffc0 008c218c ffffffc0
[  385.612158] f9b0  016df9f0 ffffffc0 008c2950 ffffffc0 95efb798 ffffffc0 0000feff 00000000
[  385.612199] f9d0  0192d000 ffffffc0 b891c000 ffffffc0 00000000 00000000 008c2944 ffffffc0
[  385.612236] f9f0  016dfa30 ffffffc0 008c8fb8 ffffffc0 00018450 ffffff80 00000000 00000000
[  385.612279] fa10  95848000 ffffffc0 00018450 ffffff80 008c8f78 ffffffc0 008c8fa8 ffffffc0
[  385.612316]
[  385.612340] Process swapper/0 (pid: 0, stack limit = 0xffffffc0016dc058)
[  385.612370] Stack: (0xffffffc0016df9b0 to 0xffffffc0016e0000)
[  385.612395] f9a0:                                     016df9f0 ffffffc0 008c2950 ffffffc0
[  385.612430] f9c0: 95efb798 ffffffc0 0000feff 00000000 0192d000 ffffffc0 b891c000 ffffffc0
[  385.612460] f9e0: 00000000 00000000 008c2944 ffffffc0 016dfa30 ffffffc0 008c8fb8 ffffffc0
[  385.612488] fa00: 00018450 ffffff80 00000000 00000000 95848000 ffffffc0 00018450 ffffff80
[  385.612522] fa20: 008c8f78 ffffffc0 008c8fa8 ffffffc0 016dfa60 ffffffc0 008cab08 ffffffc0
[  385.612551] fa40: 00000010 00000000 95848000 ffffffc0 00000010 00000000 008caaf8 ffffffc0
[  385.612579] fa60: 016dfb00 ffffffc0 008d001c ffffffc0 00000010 00000000 a000da80 ffffffc0
[  385.612607] fa80: 95848000 ffffffc0 95840000 ffffffc0 00018450 ffffff80 9cf63700 ffffffc0
[  385.612635] faa0: 00000000 00000000 9584a000 ffffffc0 00000400 00000000 00000046 00000000
[  385.612664] fac0: 00000003 00000000 00f516f8 ffffffc0 95848000 ffffffc0 0155d190 ffffffc0
[  385.612693] fae0: 00000000 ffffffc0 00000029 00000010 95840000 ffffffc0 00f51928 ffffffc0
[  385.612722] fb00: 016dfb80 ffffffc0 008ba240 ffffffc0 b891c010 ffffffc0 b891c000 ffffffc0
[  385.612750] fb20: 019367d0 ffffffc0 95848000 ffffffc0 b891c010 ffffffc0 00000000 00000000
[  385.612779] fb40: 016e20b0 ffffffc0 01a46000 ffffffc0 01c52000 ffffffc0 00000001 00000000
[  385.612807] fb60: 00f51b90 ffffffc0 00f516f8 ffffffc0 016dfb80 00000040 0192de00 ffffffc0
[  385.612835] fb80: 016dfbd0 ffffffc0 008c1b94 ffffffc0 b891c000 ffffffc0 0192d000 ffffffc0
[  385.612863] fba0: 00000001 00000000 974ae100 ffffffc0 01a46680 ffffffc0 974ae100 ffffffc0
[  385.612891] fbc0: 016dfbd0 ffffffc0 008c1b84 ffffffc0 016dfc00 ffffffc0 008302ec ffffffc0
[  385.612919] fbe0: 95848000 ffffffc0 b891c000 ffffffc0 00000000 00000000 016d4d28 ffffffc0
[  385.612959] fc00: 016dfc20 ffffffc0 0024481c ffffffc0 9584d040 ffffffc0 9584d048 ffffffc0
[  385.612987] fc20: 016dfc60 ffffffc0 00245040 ffffffc0 00000006 00000000 00000101 00000000
[  385.613016] fc40: 016d4f88 ffffffc0 00000006 00000000 016e2000 ffffffc0 01a46000 ffffffc0
[  385.613043] fc60: 016dfcf0 ffffffc0 0024583c ffffffc0 000000c0 00000000 000000ed 00000000
[  385.613072] fc80: 00000000 00000000 c7841cef 00000059 60000045 00000000 00000001 00000000
[  385.613099] fca0: 00000001 00000000 40202000 00000000 00205430 ffffffc0 40000000 00000040
[  385.613134] fcc0: 016dfcd0 ffffffc0 016f08b0 ffffffc0 00002170 00000001 00200000 0000000a
[  385.613163] fce0: 016d4dd0 ffffffc0 000000ed 00000000 016dfd10 ffffffc0 0020ada4 ffffffc0
[  385.613192] fd00: 016d6000 ffffffc0 0020ad80 ffffffc0 016dfd40 ffffffc0 002063e8 ffffffc0
[  385.613225] fd20: 0000200c ffffff80 016dfd70 ffffffc0 01cb1c00 ffffffc0 00002010 ffffff80
[  385.613254] fd40: 016dfe90 ffffffc0 0020a5e8 ffffffc0 000f4240 00000000 be0bb558 ffffffc0
[  385.613288] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000004 00000000 f9003000 ffffff80
[  385.613317] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[  385.613345] fda0: ad0efa80 0034edce ffffffff 00ffffff 3b9aca00 00000000 00209800 ffffffc0
[  385.613379] fdc0: 00000000 00000000 00000000 00000000 34c5d83d 00000000 00000000 00000000
[  385.613406] fde0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.613438] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 00080c8c 00000000
[  385.613465] fe20: 00000001 00000000 00000001 00000000 00000001 00000000 00000001 00000000
[  385.613494] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[  385.613529] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0 00adf490 ffffffc0 60000045 00000000
[  385.613558] fe80: 00205430 ffffffc0 40000000 00000040 016dfed0 ffffffc0 00adf5cc ffffffc0
[  385.613585] fea0: be0bb558 ffffffc0 00000000 00000000 01a47000 ffffffc0 01fdd000 ffffffc0
[  385.613619] fec0: 01953f38 ffffffc0 002a5598 00000001 016dff20 ffffffc0 0020b6ac ffffffc0
[  385.613648] fee0: 01c525b8 ffffffc0 01c585d8 ffffffc0 01a47000 ffffffc0 00ec6000 ffffffc0
[  385.613683] ff00: 01a463cb ffffffc0 014b9858 ffffffc0 40200000 00000000 00ec6000 ffffffc0
[  385.613711] ff20: 016dff30 ffffffc0 002a5618 ffffffc0 016dff80 ffffffc0 00e74184 ffffffc0
[  385.613740] ff40: 00000002 00000000 016bee08 ffffffc0 01a4d000 ffffffc0 be1bbac0 ffffffc0
[  385.613774] ff60: 016bee08 ffffffc0 40000000 00000000 40200000 00000000 40202000 00000000
[  385.613802] ff80: 016dffa0 ffffffc0 01670808 ffffffc0 01c89000 ffffffc0 01670800 ffffffc0
[  385.613838] ffa0: 00000000 00000000 40205210 00000000 43e77c88 00000000 00000e11 00000000
[  385.613866] ffc0: 4a000000 00000000 410fd032 00000000 416e9dd8 00000000 00000000 00000000
[  385.613894] ffe0: 00000000 00000000 016bee08 ffffffc0 00000000 00000000 00000000 00000000
[  385.613912] Call trace:
[  385.613947] [<ffffffc0008c21a0>] dhd_bus_clean_flow_ring+0xb0/0xf8
[  385.613974] [<ffffffc0008c294c>] dhd_bus_flow_ring_delete_response+0xa4/0x138
[  385.614004] [<ffffffc0008c8fb4>] dhd_prot_process_flow_ring_delete_response+0x3c/0x78
[  385.614031] [<ffffffc0008cab04>] dhd_prot_process_msgtype+0x14c/0x5a8
[  385.614055] [<ffffffc0008d0018>] dhd_prot_process_msgbuf_txcpl+0x1c8/0x3f0
[  385.614085] [<ffffffc0008ba23c>] dhdpcie_bus_process_mailbox_intr+0x1f4/0x518
[  385.614111] [<ffffffc0008c1b90>] dhd_bus_dpc+0x160/0x260
[  385.614142] [<ffffffc0008302e8>] dhd_dpc+0x28/0x98
[  385.614173] [<ffffffc000244818>] tasklet_action+0x90/0x1e0
[  385.614199] [<ffffffc00024503c>] __do_softirq+0x144/0x3e0
[  385.614226] [<ffffffc000245838>] irq_exit+0x108/0x130
[  385.614254] [<ffffffc00020ada0>] handle_IRQ+0x58/0xc8
[  385.614297] [<ffffffc0002063e4>] gic_handle_irq+0x3c/0x88
[  385.614319] Exception stack(0xffffffc0016dfd50 to 0xffffffc0016dfe70)
[  385.614344] fd40:                                     000f4240 00000000 be0bb558 ffffffc0
[  385.614372] fd60: 016dfe90 ffffffc0 00adf490 ffffffc0 00000004 00000000 f9003000 ffffff80
[  385.614405] fd80: 01c525b8 ffffffc0 00000003 00000000 01cbb9a0 ffffffc0 00000018 00000000
[  385.614433] fda0: ad0efa80 0034edce ffffffff 00ffffff 3b9aca00 00000000 00209800 ffffffc0
[  385.614467] fdc0: 00000000 00000000 00000000 00000000 34c5d83d 00000000 00000000 00000000
[  385.614494] fde0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  385.614521] fe00: ffffffff 00000000 000f4240 00000000 be0bb558 ffffffc0 00080c8c 00000000
[  385.614555] fe20: 00000001 00000000 00000001 00000000 00000001 00000000 00000001 00000000
[  385.614583] fe40: 40202000 00000000 00205430 ffffffc0 40000000 00000040 016dfe90 ffffffc0
[  385.614608] fe60: 00adf48c ffffffc0 016dfe90 ffffffc0
[  385.614637] [<ffffffc00020a5e4>] el1_irq+0x64/0xd4
[  385.614672] [<ffffffc000adf5c8>] cpuidle_idle_call+0xc0/0x278
[  385.614697] [<ffffffc00020b6a8>] arch_cpu_idle+0x8/0x20
[  385.614736] [<ffffffc0002a5614>] cpu_startup_entry+0xcc/0x280
[  385.614770] [<ffffffc000e74180>] rest_init+0x80/0x90
[  385.614803] [<ffffffc001670804>] start_kernel+0x314/0x32c
[  385.614836] Code: a94002a2 52800041 390106a1 aa1703e1 (f9000002)
[  385.614979] ---[ end trace 7a106c4f8760a982 ]---
```

#### CVE-2018-14855

A simple heap overflow checking mechanism (allocates selected objects right before a NON-PRESENT page) was used to produce the crash

```
[  100.646256] ------------[ cut here ]------------
[  100.646269] Kernel BUG at ffffffc0008aac18 [verbose debug info unavailable]
[  100.646284] Internal error: Oops - BUG: 96000007 [#1] PREEMPT SMP
[  100.646301] Modules linked in:
[  100.646318] exynos-snapshot: core register saved(CPU:0)
[  100.646330] CPUMERRSR: 0000000000000000, L2MERRSR: 0000000000000000
[  100.646343] exynos-snapshot: context saved(CPU:0)
[  100.646417] exynos-snapshot: item - log_kevents is disabled
[  100.646471] CPU: 0 PID: 5032 Comm: dmesg Tainted: G        W    3.10.61-TeamNexus-gb11c661e30ff-dirty #891
[  100.646490] task: ffffffc0ba76c440 ti: ffffffc07db08000 task.ti: ffffffc07db08000
[  100.646520] PC is at dhd_bus_flow_ring_flush_response+0x68/0xf8
[  100.646536] LR is at dhd_bus_flow_ring_flush_response+0x68/0xf8
[  100.646551] pc : [<ffffffc0008aac18>] lr : [<ffffffc0008aac18>] pstate: 40000045
[  100.646563] sp : ffffffc07db0bb70
[  100.646577] x29: ffffffc07db0bb70 x28: 0000000000000000
[  100.646594] x27: ffffffc00153c000 x26: ffffffc0958b0000
[  100.646607] x25: ffffffc095888000 x24: ffffffc0b1c09f80
[  100.646621] x23: 0000000000000010 x22: ffffff80000185d0
[  100.646634] x21: ffffffc0a06c8000 x20: 000000000000002a
[  100.646647] x19: ffffffc054e02000 x18: 000000000000000a
[  100.646660] x17: 0000007fa2c349a8 x16: 0000007fa2cdc238
[  100.646673] x15: 0000000000000001 x14: 0000000000000002
[  100.646686] x13: 00000000000013a8 x12: 0000000000000004
[  100.646699] x11: ffffffc081a324ee x10: ffffffc001a32504
[  100.646712] x9 : 7f7f7f7f7f7f7f7f x8 : 666666662065646f
[  100.646726] x7 : 6e5f676e69725f77 x6 : ffffffc001a3254e
[  100.646739] x5 : 00000000000000c0 x4 : 0000000000000007
[  100.646751] x3 : 0000000000000000 x2 : 0000000000000007
[  100.646764] x1 : 0000000000000100 x0 : 0000000000000044
[  100.646779]
[  100.646779] PC: 0xffffffc0008aab98:
[  100.646798] ab98  a94153f3 a9425bf5 f9401bf7 a8c47bfd d65f03c0 d503201f a9bd7bfd 910003fd
[  100.646823] abb8  a90153f3 2a0203f3 f90013f5 12003c34 aa0003f5 97e8adf7 35000513 97e8adf5
[  100.646846] abd8  52800d13 2a1403e1 b0006480 91280000 9416ef21 b94ef2a1 b0006480 9128e000
[  100.646868] abf8  9416ef1d f94002a1 b0006480 9129c000 f9573821 9bb30693 aa1303e1 9416ef16
[  100.646890] ac18  79408660 6b14001f 54000181 97e8ade1 39410661 b0006480 912ac000 9416ef0e
[  100.646912] ac38  3901067f 97e8addb f94013f5 a94153f3 a8c37bfd d65f03c0 97e8add6 90006481
[  100.646934] ac58  b0006480 52828822 91212021 9122a000 97fe79c2 17ffffee 97e8adce d0003441
[  100.646957] ac78  911aa021 2a1303e2 910b6021 b0006480 91272000 9416eef8 97e8adc6 f94013f5
[  100.646982]
[  100.646982] LR: 0xffffffc0008aab98:
[  100.647001] ab98  a94153f3 a9425bf5 f9401bf7 a8c47bfd d65f03c0 d503201f a9bd7bfd 910003fd
[  100.647023] abb8  a90153f3 2a0203f3 f90013f5 12003c34 aa0003f5 97e8adf7 35000513 97e8adf5
[  100.647045] abd8  52800d13 2a1403e1 b0006480 91280000 9416ef21 b94ef2a1 b0006480 9128e000
[  100.647066] abf8  9416ef1d f94002a1 b0006480 9129c000 f9573821 9bb30693 aa1303e1 9416ef16
[  100.647088] ac18  79408660 6b14001f 54000181 97e8ade1 39410661 b0006480 912ac000 9416ef0e
[  100.647110] ac38  3901067f 97e8addb f94013f5 a94153f3 a8c37bfd d65f03c0 97e8add6 90006481
[  100.647132] ac58  b0006480 52828822 91212021 9122a000 97fe79c2 17ffffee 97e8adce d0003441
[  100.647154] ac78  911aa021 2a1303e2 910b6021 b0006480 91272000 9416eef8 97e8adc6 f94013f5
[  100.647179]
[  100.647179] SP: 0xffffffc07db0baf0:
[  100.647198] baf0  0000002a 00000000 a06c8000 ffffffc0 000185d0 ffffff80 00000010 00000000
[  100.647220] bb10  b1c09f80 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0 0153c000 ffffffc0
[  100.647242] bb30  00000000 00000000 7db0bb70 ffffffc0 008aac18 ffffffc0 7db0bb70 ffffffc0
[  100.647263] bb50  008aac18 ffffffc0 40000045 00000000 01a3253c ffffffc0 5f687375 70736572
[  100.647285] bb70  7db0bba0 ffffffc0 008b0020 ffffffc0 000185d0 ffffff80 958b0000 ffffffc0
[  100.647307] bb90  00000010 00000000 00000010 00000000 7db0bbc0 ffffffc0 008afe80 ffffffc0
[  100.647329] bbb0  00000010 00000000 00000010 00000000 7db0bc60 ffffffc0 008b571c ffffffc0
[  100.647352] bbd0  00000010 00000000 b1c09f80 ffffffc0 958b0000 ffffffc0 000185d0 ffffff80
[  100.647378]
[  100.647378] X6: 0xffffffc001a324ce:
[  100.647397] 24cc  00000000 00000000 00000000 00000001 00000000 30303020 32303330 39333730
[  100.647419] 24ec  20205d39 203a305b 20202020 20202020 656d6420 203a6773 32333035 3432205d
[  100.647440] 250c  30206330 34362e30 38373337 5b49205d 20203a30 20202020 20202020 73656d64
[  100.647462] 252c  35203a67 5d323330 3a365820 66783020 66666666 30306366 32336131 3a656334
[  100.647483] 254c  0a0a350a 31316267 31363663 66303365 69642d66 20797472 31393823 302b650a
[  100.647505] 256c  2f633178 38337830 64646120 78303d72 66666666 30386666 31303030 61643538
[  100.647527] 258c  7463202c 78303d78 31396233 5f630a30 30203a54 6170202c 64657373 203a545f
[  100.647549] 25ac  202c3036 6c6c7566 203a545f 202c3036 5f676863 5f646e65 30203a54 6572202c
[  100.647572] 25cc  3a746e63 202c3020 64736963 7830203a 68300a30 6233312c 312c6837 68303034
[  100.647596]
[  100.647596] X10: 0xffffffc001a32484:
[  100.647616] 2484  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.647637] 24a4  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.647659] 24c4  00000000 00000000 00000000 00000000 00000000 00000001 00000000 30303020
[  100.647680] 24e4  362e3030 38363730 20205d30 203a305b 20202020 20202020 656d6420 203a6773
[  100.647702] 2504  32333035 3532205d 30203430 34362e30 36393537 5b49205d 20203a30 20202020
[  100.647723] 2524  20202020 73656d64 35203a67 5d323330 30315820 7830203a 66666666 30636666
[  100.647745] 2544  33613130 34383432 0a0a0a3a 31316267 31363663 66303365 69642d66 20797472
[  100.647767] 2564  31393823 302b650a 2f633178 38337830 64646120 78303d72 66666666 30386666
[  100.647791]
[  100.647791] X11: 0xffffffc081a3246e:
[  100.647810] 246c  f9000be1 f9427e7e d63f03c0 f9000be1 f9427e7e d63f03c0 f9000be0 5280f360
[  100.647834] 248c  f941127e d63f03c0 2a0003e1 f9400be0 17ffffc4 a90107e0 aa0103e0 aa0203e1
[  100.647855] 24ac  f941067e d63f03c0 a94107e0 17ffffc1 f9000be0 f9427e7e d63f03c0 f9000be1
[  100.647878] 24cc  f9427e7e d63f03c0 f9426a7e d63f03c0 17ffff9d 007aedaf 00000050 40700000
[  100.647899] 24ec  00000000 000000c0 d1400bf0 b940021f f81b0fe0 a90357f4 a9047bf6 b9005be1
[  100.647922] 250c  b9005fe2 79400270 35000410 aa0103e0 aa0203f4 aa0003f5 f941a67e d63f03c0
[  100.647943] 252c  b9400ea1 340003c1 aa1403e2 aa0103f6 d2914271 b9400020 f9404400 f940fc00
[  100.647965] 254c  f940181e d63f03c0 14000009 b9408a74 b9008a7f b9405be0 f941aa7e d63f03c0
[  100.647987] 256c  aa1403e0 f9426e7e d63f03c0 b9405be0 f941aa7e d63f03c0 a94357f4 a9447bf6
[  100.648015]
[  100.648015] X19: 0xffffffc054e01f80:
[  100.648034] 1f80  00007dea 00000000 90e0ee00 ffffffc0 6077da00 ffffffc0 a06c8010 ffffffc0
[  100.648057] 1fa0  54e01f30 ffffffc0 54e01fa8 ffffffc0 54e01fa8 ffffffc0 00000000 00000000
[  100.648079] 1fc0  00000000 00000000 07ff0000 00000000 008ada10 ffffffc0 00290001 50e80007
[  100.648101] 1fe0  7dea798b 439c2500 00003f8f 00000000 7cee3880 ffffffc0 605debc0 ffffffc0
[  100.648122] 2000
[  100.648835]
[  100.648835] X21: 0xffffffc0a06c7f80:
[  100.648854] 7f80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.648877] 7fa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.648898] 7fc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.648919] 7fe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.648941] 8000  958b0000 ffffffc0 a00cd800 ffffffc0 54e01f30 ffffffc0 54e01f98 ffffffc0
[  100.648964] 8020  5f656b00 ffffffc0 89171000 ffffffc0 00000d7d 00000000 0d280000 ffffff80
[  100.648986] 8040  00000006 00000000 000c0000 000c0000 00000000 00000000 00000000 00000001
[  100.649008] 8060  958b2fb0 ffffffc0 958b3fb0 ffffffc0 00000000 00000000 00000000 00000000
[  100.649032]
[  100.649032] X24: 0xffffffc0b1c09f00:
[  100.649051] 9f00  00040001 72683264 6c706378 00000000 00000000 00000000 00000000 00000000
[  100.649074] 9f20  00016000 ffffff80 f9a0a000 00000000 00000000 00000000 00000000 00000000
[  100.649095] 9f40  00000000 00000000 9dd78480 ffffffc0 9dd78d80 ffffffc0 00000152 00000000
[  100.649117] 9f60  00000000 00000000 00000000 00000000 00000000 00000000 00000007 00000000
[  100.649138] 9f80  00030001 74683264 6c706378 00000000 00000000 00000000 00000000 00000000
[  100.649160] 9fa0  00018000 ffffff80 f9a0c000 00000000 00000000 00000000 00000000 00000000
[  100.649182] 9fc0  00000000 00000000 9dd78c00 ffffffc0 9dd78140 ffffffc0 0000015c 00000000
[  100.649205] 9fe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649228]
[  100.649228] X25: 0xffffffc095887f80:
[  100.649247] 7f80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649269] 7fa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649290] 7fc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649312] 7fe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649333] 8000  b1c05400 ffffffc0 00000000 00000055 00000000 00ff00ec 00080008 00080008
[  100.649355] 8020  02000002 00000030 b1c05d00 ffffffc0 b1c05b00 ffffffc0 b1c05e00 ffffffc0
[  100.649377] 8040  b1c09f80 ffffffc0 b1c09f00 ffffffc0 b1c09e00 ffffffc0 00000000 00000000
[  100.649400] 8060  0001c000 ffffff80 f9a10000 00000000 00000000 00000000 00020000 ffffff80
[  100.649424]
[  100.649424] X26: 0xffffffc0958aff80:
[  100.649443] ff80  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649465] ffa0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649487] ffc0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649508] ffe0  00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649530] 0000  b1c05400 ffffffc0 a06c8000 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0
[  100.649552] 0020  00000001 006f006f 00000000 00000002 00000000 00000000 000005ea 00000100
[  100.649574] 0040  00000000 00000000 798b50e8 00007dea 00000000 00000000 00000000 00000000
[  100.649596] 0060  00012a7a 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  100.649620]
[  100.649620] X27: 0xffffffc00153bf80:
[  100.649639] bf80  69766564 65206563 656d756e 65746172 000a2164 00000000 203a7325 70646864
[  100.649662] bfa0  20656963 74696e69 696c6169 6620657a 656c6961 000a2e64 70646864 3a656963
[  100.649684] bfc0  00007325 00000000 203a7325 75716572 5f747365 28717269 61662029 64656c69
[  100.649707] bfe0  0000000a 00000000 203a7325 20494350 20515249 61207369 6165726c 72207964
[  100.649729] c000  73696765 65726574 00000a64 00000000 203a7325 6e6e6143 6520746f 6c62616e
[  100.649751] c020  43502065 65642049 65636976 0000000a 203a7325 31524142 746f4e20 616e6520
[  100.649773] c040  64656c62 726f6620 69687420 65642073 65636976 69732020 2528657a 2c29646c
[  100.649795] c060  64646120 78302872 30257830 6c6c3631 000a2978 00000000 693a7325 6d65726f
[  100.649820]
[  100.649820] X29: 0xffffffc07db0baf0:
[  100.649839] baf0  0000002a 00000000 a06c8000 ffffffc0 000185d0 ffffff80 00000010 00000000
[  100.649861] bb10  b1c09f80 ffffffc0 95888000 ffffffc0 958b0000 ffffffc0 0153c000 ffffffc0
[  100.649883] bb30  00000000 00000000 7db0bb70 ffffffc0 008aac18 ffffffc0 7db0bb70 ffffffc0
[  100.649905] bb50  008aac18 ffffffc0 40000045 00000000 01a3253c ffffffc0 5f687375 70736572
[  100.649927] bb70  7db0bba0 ffffffc0 008b0020 ffffffc0 000185d0 ffffff80 958b0000 ffffffc0
[  100.649949] bb90  00000010 00000000 00000010 00000000 7db0bbc0 ffffffc0 008afe80 ffffffc0
[  100.649970] bbb0  00000010 00000000 00000010 00000000 7db0bc60 ffffffc0 008b571c ffffffc0
[  100.649992] bbd0  00000010 00000000 b1c09f80 ffffffc0 958b0000 ffffffc0 000185d0 ffffff80
[  100.650014]
[  100.650028] Process dmesg (pid: 5032, stack limit = 0xffffffc07db08058)
[  100.650044] Stack: (0xffffffc07db0bb70 to 0xffffffc07db0c000)
[  100.650060] bb60:                                     7db0bba0 ffffffc0 008b0020 ffffffc0
[  100.650078] bb80: 000185d0 ffffff80 958b0000 ffffffc0 00000010 00000000 00000010 00000000
[  100.650095] bba0: 7db0bbc0 ffffffc0 008afe80 ffffffc0 00000010 00000000 00000010 00000000
[  100.650113] bbc0: 7db0bc60 ffffffc0 008b571c ffffffc0 00000010 00000000 b1c09f80 ffffffc0
[  100.650130] bbe0: 958b0000 ffffffc0 000185d0 ffffff80 95888000 ffffffc0 9dd78c00 ffffffc0
[  100.650148] bc00: 00000400 00000000 00000000 00000000 958b2000 ffffffc0 0000005e 00000000
[  100.650166] bc20: 958b2000 ffffffc0 00000010 00000000 0153cab8 ffffffc0 008afff8 ffffffc0
[  100.650185] bc40: 000185d0 ffffff80 008b5588 00000010 00f34c88 ffffffc0 00f34c58 ffffffc0
[  100.650202] bc60: 7db0bce0 ffffffc0 008a4100 ffffffc0 a06c8010 ffffffc0 a06c8000 ffffffc0
[  100.650220] bc80: 01916a10 ffffffc0 958b0000 ffffffc0 a06c8010 ffffffc0 00000000 00000000
[  100.650238] bca0: 016c20b0 ffffffc0 01a26000 ffffffc0 01c33000 ffffffc0 00000001 00000000
[  100.650256] bcc0: a06c8010 ffffffc0 00f34fa8 ffffffc0 0153c7e8 ffffffc0 00f34fc8 00000040
[  100.650274] bce0: 7db0bd30 ffffffc0 008a997c ffffffc0 a06c8000 ffffffc0 00000001 00000000
[  100.650292] bd00: 5f656b00 ffffffc0 016b4d68 ffffffc0 01a26a40 ffffffc0 016b4d68 ffffffc0
[  100.650310] bd20: 01a26a40 ffffffc0 00000000 00000000 7db0bd60 ffffffc0 00829084 ffffffc0
[  100.650328] bd40: 958b0000 ffffffc0 a06c8000 ffffffc0 00000000 00000000 01a2e758 ffffffc0
[  100.650346] bd60: 7db0bd80 ffffffc0 0024450c ffffffc0 958b5040 ffffffc0 958b5048 ffffffc0
[  100.650364] bd80: 7db0bdc0 ffffffc0 00244d30 ffffffc0 00000006 00000000 00000100 00000000
[  100.650381] bda0: 016b4fc8 ffffffc0 00000006 00000000 016c2000 ffffffc0 01a26000 ffffffc0
[  100.650399] bdc0: 7db0be50 ffffffc0 0024552c ffffffc0 000000c0 00000000 000000ed 00000000
[  100.650416] bde0: 00000000 00000000 6ec56e03 00000017 80000000 00000000 00000001 00000000
[  100.650434] be00: f855a438 0000007f 00000002 00000000 00000001 00000000 7db08000 ffffffc0
[  100.650452] be20: 7db0be30 ffffffc0 016d08f0 ffffffc0 ffffb220 00000000 00404000 0000000a
[  100.650470] be40: 016b4e10 ffffffc0 000000ed 00000000 7db0be70 ffffffc0 0020ada4 ffffffc0
[  100.650488] be60: 016b6000 ffffffc0 0020ad80 ffffffc0 7db0bea0 ffffffc0 002063e8 ffffffc0
[  100.650506] be80: 0000200c ffffff80 7db0bed0 ffffffc0 01c92c40 ffffffc0 00002010 ffffff80
[  100.650524] bea0: f855a410 0000007f 0020aa90 ffffffc0 00000000 00000000 f855a438 0000007f
[  100.650542] bec0: ffffffff ffffffff a2c34a20 0000007f a281c069 0000007f 724460f6 00000055
[  100.650559] bee0: 00000001 00000000 724460e0 00000055 724460f7 00000055 a281c06a 0000007f
[  100.650577] bf00: 00000040 00000000 00000066 00000000 00000001 00000000 ffffff97 00000000
[  100.650594] bf20: a281c000 0000007f 000013a8 00000000 0ccccccc 00000000 8000002f 00000000
[  100.650613] bf40: a2cc0fd8 0000007f a2cc0c7c 0000007f a2cdc238 0000007f a2c349a8 0000007f
[  100.650630] bf60: ffffffff 00000000 a2cde730 0000007f f855a438 0000007f 724460f6 00000055
[  100.650648] bf80: 00000001 00000000 00000001 00000000 00000001 00000000 f855a438 0000007f
[  100.650665] bfa0: 00000002 00000000 00000001 00000000 00000000 00000000 f855a410 0000007f
[  100.650683] bfc0: a2c731a8 0000007f f855a3c0 0000007f a2c34a20 0000007f 80000000 00000000
[  100.650700] bfe0: 00000003 00000000 ffffffff ffffffff ff000000 ff000000 ff000000 ff000000
[  100.650713] Call trace:
[  100.650733] [<ffffffc0008aac18>] dhd_bus_flow_ring_flush_response+0x68/0xf8
[  100.650754] [<ffffffc0008b001c>] dhd_prot_process_flow_ring_flush_response+0x24/0x38
[  100.650771] [<ffffffc0008afe7c>] dhd_prot_process_msgtype+0x29c/0x418
[  100.650790] [<ffffffc0008b5718>] dhd_prot_process_msgbuf_txcpl+0x138/0x2b0
[  100.650808] [<ffffffc0008a40fc>] dhdpcie_bus_process_mailbox_intr+0x1f4/0x360
[  100.650824] [<ffffffc0008a9978>] dhd_bus_dpc+0x158/0x220
[  100.650847] [<ffffffc000829080>] dhd_dpc+0x28/0x98
[  100.650868] [<ffffffc000244508>] tasklet_action+0x90/0x1e0
[  100.650886] [<ffffffc000244d2c>] __do_softirq+0x144/0x3e0
[  100.650902] [<ffffffc000245528>] irq_exit+0x108/0x130
[  100.650921] [<ffffffc00020ada0>] handle_IRQ+0x58/0xc8
[  100.650937] [<ffffffc0002063e4>] gic_handle_irq+0x3c/0x88
[  100.650951] Exception stack(0xffffffc07db0beb0 to 0xffffffc07db0bfd0)
[  100.650966] bea0:                                     00000000 00000000 f855a438 0000007f
[  100.650984] bec0: ffffffff ffffffff a2c34a20 0000007f a281c069 0000007f 724460f6 00000055
[  100.651001] bee0: 00000001 00000000 724460e0 00000055 724460f7 00000055 a281c06a 0000007f
[  100.651018] bf00: 00000040 00000000 00000066 00000000 00000001 00000000 ffffff97 00000000
[  100.651036] bf20: a281c000 0000007f 000013a8 00000000 0ccccccc 00000000 8000002f 00000000
[  100.651054] bf40: a2cc0fd8 0000007f a2cc0c7c 0000007f a2cdc238 0000007f a2c349a8 0000007f
[  100.651071] bf60: ffffffff 00000000 a2cde730 0000007f f855a438 0000007f 724460f6 00000055
[  100.651088] bf80: 00000001 00000000 00000001 00000000 00000001 00000000 f855a438 0000007f
[  100.651105] bfa0: 00000002 00000000 00000001 00000000 00000000 00000000 f855a410 0000007f
[  100.651120] bfc0: a2c731a8 0000007f f855a3c0 0000007f
[  100.651137] Code: f9573821 9bb30693 aa1303e1 9416ef16 (79408660)
[  100.651157] ---[ end trace 6e37f9efafafef6f ]---
```

# In-Depth Analysis

### Exploiting the out of bound array access into flow ring array

We found several vulnerabilities relating to the access of an array of pointers to 'flow ring' data structures which are allocated by the bcmdhd4358 WiFi driver. The vulnerabilities occur on several locations within the bcmdhd4358 driver code where the index into the flow ring array (called `flowid`) is obtained directly from data provided by the WiFi peripheral and not validated. We discovered that this was the case in the following functions:

* `dhd_pcie.c:dhd_bus_flow_ring_create_response (CVE-2018-14856)`
* `dhd_pcie.c:dhd_bus_flow_ring_delete_response (CVE-2018-14854)`
* `dhd_pcie.c:dhd_bus_flow_ring_flush_response (CVE-2018-14855)`

Each of these functions receives the flowid as a parameter which is under direct attacker control and uses it to extract an entry from the flow ring array using the macro `DHD_FLOW_RING`. The code contains `ASSERT` macros which compare the flowid field of the dereferenced data structure with the attacker controlled value of `flowid`. However a mismatch will only generate a warning message and not lead to alter the program behaviour otherwise.

```
#define DHD_FLOW_RING(dhdp, flowid) \
 (flow_ring_node_t *)&(((flow_ring_node_t*) \
 ((dhdp)->flow_ring_table))[flowid])

```

The function `dhd_bus_flow_ring_flush_response` first dereferences the pointer obtained from the flow ring array at offset `flowid` as a variable of the type `flow_ring_node_t` and then proceeds to set the 1 byte long status field of the dereferenced `flow_ring_node_t` structure to the constant `FLOW_RING_STATUS_OPEN` which is zero.

```
void
dhd_bus_flow_ring_flush_response(dhd_bus_t *bus, uint16 flowid, uint32 status)
{
   flow_ring_node_t *flow_ring_node;

   if (status != BCME_OK) {
      DHD_ERROR(("%s Flow flush Response failure error status = %d \n",
          __FUNCTION__, status));
      return;
   }

   // XXX flowid not validated
   flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
   ASSERT(flow_ring_node->flowid == flowid);

   // XXX overwrite one byte with 0
   flow_ring_node->status = FLOW_RING_STATUS_OPEN;
   return;
}

```

An attacker can use this to zero an arbitrary byte of kernel memory. To that end he has to find a value for flowid so that the flow ring array base address plus the `flowid * sizeof(flow_ring_node_t)` points to a memory area containing the byte that the attacker wishes to modify.

The function `dhd_bus_flow_ring_create_response` also first dereferences the pointer obtained from the flow ring array at offset flowid as a variable of the type `flow_ring_node_t`. The dereferenced data structure contains a field named `lock` of type `void*` which is then passed to the function `dhd_os_spin_lock` which either passes the pointer on to the kernel function `spin_lock_irqsave`, or does nothing if the lock pointer is zero.

The function `dhd_bus_flow_ring_create_response` then overwrites the status byte of the dereferenced `flow_ring_node_t` structure as described in the previous paragraph. Finally the function calls `dhd_os_spin_unlock` on the lock pointer.

This vulnerability is potentially more severe compared to the vulnerability described before since it allows an attacker to trigger
the execution of the `spin_lock_irqsave` and `spin_unlock_irqrestore` call chains on arbitrary kernel memory, however we did not investigate this further since the capability to zero a byte at an arbitrary address already was sufficient reason to patch the underlying cause of the vulnerability.

```
void
dhd_bus_flow_ring_create_response(dhd_bus_t *bus, uint16 flowid, int32 status)
{
   flow_ring_node_t *flow_ring_node;
   unsigned long flags;

   DHD_INFO(("%s :Flow Response %d \n", __FUNCTION__, flowid));

   // XXX flowid not validated
   flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
   ASSERT(flow_ring_node->flowid == flowid);

   if (status != BCME_OK) {
      DHD_ERROR(("%s Flow create Response failure error status = %d \n",
           __FUNCTION__, status));
      /* Call Flow clean up */
      dhd_bus_clean_flow_ring(bus, flow_ring_node);
      return;
   }

   // XXX lock is passed to dhd_os_spin_lock
   DHD_FLOWRING_LOCK(flow_ring_node->lock, flags);
   // XXX overwrite one byte with 0
   flow_ring_node->status = FLOW_RING_STATUS_OPEN;
   // XXX lock is passed to dhd_os_spin_unlock
   DHD_FLOWRING_UNLOCK(flow_ring_node->lock, flags);

   dhd_bus_schedule_queue(bus, flowid, FALSE);

   return;
}

```

Both of the functions `dhd_bus_flow_ring_create_response` and `dhd_bus_flow_ring_delete_response` pass the `flow_ring_node` pointer to the function `dhd_bus_clean_flow_ring`, which accesses the dereferenced memory in the following ways:

* Obtains the field `lock` from the dereferenced data structure and passes it to `dhd_os_spin_lock` and `dhd_os_spin_unlock`
* Obtains the field `queue` from the dereferenced data structure and passes it to `dhd_flow_queue_dequeue`
* Overwrites the field `status` of the dereferenced data structure with the value zero
* Overwrites the field `active` of the dereferenced data structure with the value zero
* ...

```
void
dhd_bus_flow_ring_delete_response(dhd_bus_t *bus, uint16 flowid, uint32 status)
{
   flow_ring_node_t *flow_ring_node;

   DHD_INFO(("%s :Flow Delete Response %d \n", __FUNCTION__, flowid));

   // XXX flowid not validated
   flow_ring_node = DHD_FLOW_RING(bus->dhd, flowid);
   ASSERT(flow_ring_node->flowid == flowid);

   if (status != BCME_OK) {
      DHD_ERROR(("%s Flow Delete Response failure error status = %d \n",
          __FUNCTION__, status));
      return;
   }
   /* Call Flow clean up */
   dhd_bus_clean_flow_ring(bus, flow_ring_node);

   return;
}

```

```

void dhd_bus_clean_flow_ring(dhd_bus_t *bus, void *node)
{
   void *pkt;
   flow_queue_t *queue;
   flow_ring_node_t *flow_ring_node = (flow_ring_node_t *)node;
   unsigned long flags;

   queue = &flow_ring_node->queue;

#ifdef DHDTCPACK_SUPPRESS
   /* Clean tcp_ack_info_tbl in order to prevent access to flushed pkt,
    * when there is a newly coming packet from network stack.
    */
   dhd_tcpack_info_tbl_clean(bus->dhd);
#endif /* DHDTCPACK_SUPPRESS */

   /* clean up BUS level info */
   DHD_FLOWRING_LOCK(flow_ring_node->lock, flags);

   /* Flush all pending packets in the queue, if any */
   while ((pkt = dhd_flow_queue_dequeue(bus->dhd, queue)) != NULL) {
      PKTFREE(bus->dhd->osh, pkt, TRUE);
   }
   ASSERT(flow_queue_empty(queue));

   flow_ring_node->status = FLOW_RING_STATUS_CLOSED;
   flow_ring_node->active = FALSE;
   dll_delete(&flow_ring_node->list);

   DHD_FLOWRING_UNLOCK(flow_ring_node->lock, flags);

   /* Call Flow ring clean up */
   dhd_prot_clean_flow_ring(bus->dhd, flow_ring_node->prot_info);
   dhd_flowid_free(bus->dhd, flow_ring_node->flow_info.ifindex,
      flow_ring_node->flowid);
}

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


