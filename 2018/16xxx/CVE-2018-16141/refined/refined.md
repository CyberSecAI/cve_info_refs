- **Root cause of vulnerability:** The `do_avatar` function in `ProfileController.class.php` does not properly validate the `imgurl` POST parameter, allowing an attacker to specify an arbitrary file path.
- **Weaknesses/vulnerabilities present:** Arbitrary file deletion due to lack of validation on the `imgurl` parameter, which is then passed to `sp_delete_avatar`. The removal of `/` is insufficient as Windows uses `\` as a path separator.
- **Impact of exploitation:** An attacker can delete arbitrary files on the server, potentially leading to denial of service or the ability to reinstall the application, and perform a takeover, as described by the example of deleting the install.lock file.
- **Attack vectors:** Sending a POST request to `index.php?g=user&m=profile&a=do_avatar` with the `imgurl` parameter set to the path of the file to be deleted.
- **Required attacker capabilities/position:** The attacker needs to be a registered member user of the application. They need to be able to send HTTP POST requests to the server.