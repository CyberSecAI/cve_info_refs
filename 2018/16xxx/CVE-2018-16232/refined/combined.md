=== Content from blog.ipfire.org_27ff4494_20250126_111507.html ===

[**IPFire\_**](/)

[About](/about)
[Download](/download)
[Documentation](/docs)
[Blog](/blog)
[Community](https://community.ipfire.org)
[Support](/support)
[Buy](https://store.lightningwirelabs.com/?utm_source=www.ipfire.org&utm_medium=navigation)

[Donate](/donate)

* [Home](/)
* [Blog](/blog)
* IPFire 2.21 - Core Update 124 released
# IPFire 2.21 - Core Update 124 released

###### by [Michael Tremer](/users/ms), October 15, 2018

Do you like what you are reading?
Subscribe to our newsletter and don't miss out on the latest...

[Join Now](/join)

Dear IPFire Community,

this is the official release announcement for **IPFire 2.21 – Core Update 124**. It brings new features and immensely improves security and performance of the whole system.

Thanks for the people who contributed to this Core Update. Please help us to support everyone’s work with your [donation](https://www.ipfire.org/donate)!

#### IPFire on Amazon Cloud

[IPFire is now available on AWS EC2](https://www.lightningwirelabs.com/products/ipfire/cloud). This is sponsored by Lightning Wire Labs and provides a virtual cloud appliance that is set up within minutes and provides the full set of features of IPFire.

IPFire is ideal to securely connect your infrastructure to the cloud by using IPsec VPNs and provides throughput of multiple tens of gigabits per second! But IPFire can also be used as a small instance that protects your web, mail and other servers in the cloud with the IPFire Intrusion Detection and Prevention Systen, load balance web traffic and many things more.

[Try it now!](https://aws.amazon.com/marketplace/pp/B07HYRD4FX)

#### Kernel Hardening

We have updated the Linux kernel to version 4.14.72 which comes with a large number of bug fixes, especially for network adapters. It has also been hardened against various attack vectors by enabling and testing built-in kernel security features that prohibit access to privileged memory by unprivileged users and similar mechanisms.

Due to this, the update requires a reboot after it has been installed.

#### OpenSSH Hardening

Peter has contributed a number of patches that improve security of the SSH daemon running inside IPFire. For those, who have SSH access enabled, it will now require latest ciphers and key exchange algorithms that make the key handshake and connection not only more secure, but also faster when transferring data.

For those admins who use the console: The SSH client has also been enabled to show a graphic representation of the SSH key presented by the server so that comparing those is easier and man-in-the-middle attacks can be spotted quickly and easily.

#### Unbound Hardening

The settings of the IPFire DNS proxy `unbound` have been hardened to avoid and DNS cache poisoning and use aggressive NSEC by default. The latter will reduce the load on DNS servers on the internet through more aggressive caching and will make DNS resolution of DNSSEC-enabled domains faster.

#### EFI

IPFire now supports booting in EFI mode on BIOSes that support it. Some newer hardware only supports EFI mode and booting IPFire on it was impossible before this update. EFI is only supported on `x86_64`.

Existing installations won’t be upgraded to use EFI. However, the flash image and systems installed with one of the installation images of this update are compatible to be booted in both, BIOS and EFI mode.

Although this change does not improve performance and potentially increases the attack vector on the whole firewall system because of software running underneath the IPFire operating system, we are bringing this change to you to support more hardware. It might be considered to disable EFI in the BIOS if your hardware allows for it.

#### Misc.

* CVE-2018-16232: Remote shell command injection in backup.cgi: It has been brought to our attention that it was possible for an authenticated attacker to inject shell commands through the backup.cgi script of the web user interface. Those commands would have been executed as a non-priviledged user. Thanks to Reginald Dodd to spot this vulnerability and informing us through responsible disclosure.
* The hostname of the system was set incorrectly in the kernel before and is now being set correctly
* Firewall: Creating rules with the same network as source and destination is now possible and renaming a network/host group is now correctly updating all firewall rules
* Cryptography: ChaCha20-Poly1305 is now working on ARM, too
* IPsec: The status of connections in waiting state is now shown correctly at all times; before, they always showed up as enabled although they were disabled.
* pakfire: Some old and unused code has been cleaned out and the mirror health check has been removed, because a download will fail-over to another available mirror anyways
* Intrusion Detection: Emerging Threats rules are now being downloaded over HTTPS rather than HTTP
* Updated packages: `bind` 9.11.4-P1, `iproute2` 4.18.0, `ntp` 4.2.8p12, `openssh` 7.8p1, `parted` 3.2, `pciutils` 3.5.6, `rng-tools` 6.4, `syslinux` 6.04-pre1, `unbound` 1.8.0

#### Add-Ons

* Updated packages: `nano` 3.1, `postfix` 3.3.1

2025 © IPFire.org

[Legal](/legal)

[Sitemap](/sitemap)



=== Content from doddsecurity.com_ac51fdb5_20250125_191130.html ===

[Skip to the content](#site-content)

Search

[Dodd Security](https://doddsecurity.com)

Offensive Security and Application Security Perspectives

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

[Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

# Command Injection on IPFire Firewalls

Posted by [Reginald Dodd](https://doddsecurity.com/author/regg/) on [December 9, 2018](https://doddsecurity.com/213/command-injection-on-ipfire-firewalls/)

![](https://doddsecurity.com/wp-content/uploads/2018/12/IPFire-Firewall-Post5-3-816x427.png)

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

Name: [IPFire Firewall](https://www.ipfire.org/)

Vendor: IPFire

Vulnerability: Command Injection

Affected Versions: Versions before 2.21 – Core Update 124

CVE ID: [CVE-2018-16232](https://blog.ipfire.org/post/ipfire-2-21-core-update-124-released)

IPFire is an open source firewall. I discovered an authenticated command injection in their firewall. The vulnerabilities reside in the backup.cgi file.

I have IPFire running at https://10.10.10.25:444 in Virtual Box. This is a partial view of the backup.cgi page.

![](https://doddsecurity.com/wp-content/uploads/2018/12/ipfire1-2.png)

The “ADDON” parameter is vulnerable to command injection. I injected a bash reverse shell and received a connection back to my listener.

![](https://doddsecurity.com/wp-content/uploads/2018/12/ipfire2.png)

The “FILE” parameter is vulnerable to command injection. I piped the output of the “pwd” command to curl which pointed to my listener. The listener captured the HTTP POST request and my command’s output.

![](https://doddsecurity.com/wp-content/uploads/2018/12/ipfire3.png)

---

#### Timeline

* August 30, 2018 – Vulnerability details were sent to the vendor.
* October 15, 2018 – The vendor released a fixed version.
* December 9, 2018 – Published here.

[command injection](https://doddsecurity.com/tag/command-injection/)[cve](https://doddsecurity.com/tag/cve/)[remote command execution](https://doddsecurity.com/tag/remote-command-execution/)[responsible disclosure](https://doddsecurity.com/tag/responsible-disclosure/)
[![](https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=100&d=mm&r=g)](https://doddsecurity.com/author/regg/)
#### [Reginald Dodd](https://doddsecurity.com/author/regg/)

Reginald is an information security professional with experience that spans numerous industries. He has discovered unknown vulnerabilities in numerous products. He has earned a Master’s degree in Information Security and Assurance, GIAC certifications, and Offensive Security certifications.

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

### The Author

![](https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped.png)

Hi, I’m Reginald Dodd, an offensive security engineer and the author of this blog. This is where I document my perspectives on offensive security and application security in my personal time.

Read my [About Me](http://doddsecurity.com/about/) page for more on me.

### Follow

* [GitHub](https://github.com/doddr)
* [LinkedIn](https://www.linkedin.com/in/reginalddodd/)
* [RSS](https://doddsecurity.com/feed/)
### Categories

* [General](https://doddsecurity.com/category/general/)
* [Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

To the top

© 2025 [Dodd Security](https://doddsecurity.com/)



=== Content from www.ipfire.org_67411f27_20250125_191130.html ===

[**IPFire\_**](/)

[About](/about)
[Download](/download)
[Documentation](/docs)
[Blog](/blog)
[Community](https://community.ipfire.org)
[Support](/support)
[Buy](https://store.lightningwirelabs.com/?utm_source=www.ipfire.org&utm_medium=navigation)

[Donate](/donate)

* [Home](/)
* [Blog](/blog)
* IPFire 2.21 - Core Update 124 released
# IPFire 2.21 - Core Update 124 released

###### by [Michael Tremer](/users/ms), October 15, 2018

Do you like what you are reading?
Subscribe to our newsletter and don't miss out on the latest...

[Join Now](/join)

Dear IPFire Community,

this is the official release announcement for **IPFire 2.21 – Core Update 124**. It brings new features and immensely improves security and performance of the whole system.

Thanks for the people who contributed to this Core Update. Please help us to support everyone’s work with your [donation](https://www.ipfire.org/donate)!

#### IPFire on Amazon Cloud

[IPFire is now available on AWS EC2](https://www.lightningwirelabs.com/products/ipfire/cloud). This is sponsored by Lightning Wire Labs and provides a virtual cloud appliance that is set up within minutes and provides the full set of features of IPFire.

IPFire is ideal to securely connect your infrastructure to the cloud by using IPsec VPNs and provides throughput of multiple tens of gigabits per second! But IPFire can also be used as a small instance that protects your web, mail and other servers in the cloud with the IPFire Intrusion Detection and Prevention Systen, load balance web traffic and many things more.

[Try it now!](https://aws.amazon.com/marketplace/pp/B07HYRD4FX)

#### Kernel Hardening

We have updated the Linux kernel to version 4.14.72 which comes with a large number of bug fixes, especially for network adapters. It has also been hardened against various attack vectors by enabling and testing built-in kernel security features that prohibit access to privileged memory by unprivileged users and similar mechanisms.

Due to this, the update requires a reboot after it has been installed.

#### OpenSSH Hardening

Peter has contributed a number of patches that improve security of the SSH daemon running inside IPFire. For those, who have SSH access enabled, it will now require latest ciphers and key exchange algorithms that make the key handshake and connection not only more secure, but also faster when transferring data.

For those admins who use the console: The SSH client has also been enabled to show a graphic representation of the SSH key presented by the server so that comparing those is easier and man-in-the-middle attacks can be spotted quickly and easily.

#### Unbound Hardening

The settings of the IPFire DNS proxy `unbound` have been hardened to avoid and DNS cache poisoning and use aggressive NSEC by default. The latter will reduce the load on DNS servers on the internet through more aggressive caching and will make DNS resolution of DNSSEC-enabled domains faster.

#### EFI

IPFire now supports booting in EFI mode on BIOSes that support it. Some newer hardware only supports EFI mode and booting IPFire on it was impossible before this update. EFI is only supported on `x86_64`.

Existing installations won’t be upgraded to use EFI. However, the flash image and systems installed with one of the installation images of this update are compatible to be booted in both, BIOS and EFI mode.

Although this change does not improve performance and potentially increases the attack vector on the whole firewall system because of software running underneath the IPFire operating system, we are bringing this change to you to support more hardware. It might be considered to disable EFI in the BIOS if your hardware allows for it.

#### Misc.

* CVE-2018-16232: Remote shell command injection in backup.cgi: It has been brought to our attention that it was possible for an authenticated attacker to inject shell commands through the backup.cgi script of the web user interface. Those commands would have been executed as a non-priviledged user. Thanks to Reginald Dodd to spot this vulnerability and informing us through responsible disclosure.
* The hostname of the system was set incorrectly in the kernel before and is now being set correctly
* Firewall: Creating rules with the same network as source and destination is now possible and renaming a network/host group is now correctly updating all firewall rules
* Cryptography: ChaCha20-Poly1305 is now working on ARM, too
* IPsec: The status of connections in waiting state is now shown correctly at all times; before, they always showed up as enabled although they were disabled.
* pakfire: Some old and unused code has been cleaned out and the mirror health check has been removed, because a download will fail-over to another available mirror anyways
* Intrusion Detection: Emerging Threats rules are now being downloaded over HTTPS rather than HTTP
* Updated packages: `bind` 9.11.4-P1, `iproute2` 4.18.0, `ntp` 4.2.8p12, `openssh` 7.8p1, `parted` 3.2, `pciutils` 3.5.6, `rng-tools` 6.4, `syslinux` 6.04-pre1, `unbound` 1.8.0

#### Add-Ons

* Updated packages: `nano` 3.1, `postfix` 3.3.1

2025 © IPFire.org

[Legal](/legal)

[Sitemap](/sitemap)



=== Content from www.ipfire.org_1cd970f4_20250126_111507.html ===

[**IPFire\_**](/)

[About](/about)
[Download](/download)
[Documentation](/docs)
[Blog](/blog)
[Community](https://community.ipfire.org)
[Support](/support)
[Buy](https://store.lightningwirelabs.com/?utm_source=www.ipfire.org&utm_medium=navigation)

[Donate](/donate)

Latest Release: IPFire 2.29 - Core Update 191 from January 21

[Read More](/blog/ipfire-2-29-core-update-191-released)

Blazing Fire by Oleg Gamulinskii (CC)
https://www.pexels.com/video/blazing-fire-2715412/

# IPFire\_ More Than A Firewall

#### The Open Source Linux-based Firewall Operating System with a Comprehensive Feature Set

### IPFire\_ ‐ The Open Source Firewall

#### Robust Network Security

IPFire offers a powerful and secure firewall solution designed
to protect networks against evolving cyber threats.

#### Tailored to Your Needs

Enjoy the flexibility of customizing IPFire to match your unique
network requirements, ensuring a personalized and secure setup.

#### Community-Driven

Be part of a thriving community where users and developers collaborate,
sharing insights and innovations to enhance IPFire.

[Learn More About IPFire](/about)

##### Looking For More?

##### IPFire Location

IPFire Location is a geolocation service that maps
IP addresses to their geographical locations,
autonomous systems, and more!

[Check It Out](/location)

### Appliances and Support

Experience next-level security with our high-performance
appliances, crafted to optimize IPFire's capabilities.
Whether you're fortifying a business infrastructure or
safeguarding your home network, we have the right
appliance solution tailored for you.

We are your partners in ensuring continuous network security.
Our support solutions keep your systems running smoothly,
providing peace of mind in the ever-evolving landscape of
security.

[Go to Store](https://store.lightningwirelabs.com/?utm_source=www.ipfire.org&utm_medium=frontpage)

![Lightning Wire Labs](/static/img/lightningwirelabs-logo.svg?v=4ce4517fb2c985c39dfd04762425a59779f7614165a7b4052a9318c3eb6011c3c8d0e1aa06cc1508792999dbab8f7987500830196fcd155ffcafd7d2d303c22c)

##### Donate Today

IPFire is being sponsored by its users.
Help us with your donation today!

[Donate](/donate)

2025 © IPFire.org

[Legal](/legal)

[Sitemap](/sitemap)


