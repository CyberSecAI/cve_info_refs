=== Content from gitlab.com_5f214396_20250124_195624.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
076468a9**

authored
Aug 17, 2018
by
**[![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=96&d=identicon "Roberto Rosario")](/rosarior)
[Roberto Rosario](/rosarior)**

[Browse files](/mayan-edms/mayan-edms/-/tree/076468a9225e4630a463c0bbceb8e5b805fe380c)

### Add explicit casting of escaped tag labels to prevent exploit of cross site...

```

Add explicit casting of escaped tag labels to prevent exploit of cross site scripting. Thanks to Lokesh ([@lokesh1095](/lokesh1095 "lokesh1095")) for the report and proposed solutions. Closes GitLab issue [#496](/mayan-edms/mayan-edms/-/issues/496 "Persistent Cross Site Scripting").

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=32&d=identicon)Roberto Rosario <roberto.rosario.gonzalez@gmail.com>
```

parent
[fcb209ca](/mayan-edms/mayan-edms/-/commit/fcb209caaebcd690e6634625860cd08f3276c133)

Loading

Loading

Loading

* [Changes
  2](/mayan-edms/mayan-edms/-/commit/076468a9225e4630a463c0bbceb8e5b805fe380c)

[Hide whitespace changes](/mayan-edms/mayan-edms/-/commit/076468a9225e4630a463c0bbceb8e5b805fe380c?action=show&controller=projects%2Fcommit&id=076468a9225e4630a463c0bbceb8e5b805fe380c&namespace_id=mayan-edms&project_id=mayan-edms&w=1)
[Inline](/mayan-edms/mayan-edms/-/commit/076468a9225e4630a463c0bbceb8e5b805fe380c?view=inline)
[Side-by-side](/mayan-edms/mayan-edms/-/commit/076468a9225e4630a463c0bbceb8e5b805fe380c?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.com_abb1fa72_20250124_195623.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [mayan-edms](/mayan-edms/mayan-edms/-/tree/master)
* [**HISTORY.rst**](/mayan-edms/mayan-edms/-/blob/master/HISTORY.rst)

Find file

[Blame](/mayan-edms/mayan-edms/-/blame/master/HISTORY.rst)
[Permalink](/mayan-edms/mayan-edms/-/blob/2d1f403702dd1ae3fe2d93679b33aabd10b06c3e/HISTORY.rst "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* ![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=64&d=identicon "Roberto Rosario")

  Jan 21, 2025

  [714ce672](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  Â·
  714ce672

  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

  714ce672

  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

To find the state of this project's repository at the time of any of these versions, check out [the tags](/mayan-edms/mayan-edms/-/tags).

Loading



=== Content from gitlab.com_b035189b_20250124_195626.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Persistent Cross Site Scripting

Hi Team,

I have found another Persistent Cross Site Scripting instance in the code.

**Location:**

The vulnerable code lies in following file:
<https://gitlab.com/mayan-edms/mayan-edms/blob/master/mayan/apps/appearance/static/appearance/js/mayan_app.js>

The vulnerable line of code is line 62 and 71.

```
App.tagSelectionTemplate = function (tag, container) {
  var $tag = $(
    '<span class="label label-tag" style="background: ' + tag.element.dataset.color + ';"> ' + tag.text + '</span>'
  );
  container[0].style.background = tag.element.dataset.color;
  return $tag;
}

App.tagResultTemplate = function (tag) {
  if (!tag.element) { return ''; }
  var $tag = $(
    '<span class="label label-tag" style="background: ' + tag.element.dataset.color + ';"> ' + tag.text + '</span>'
  );
  return $tag;
}
```

**Attack Scenario/ Steps:**

1. Create a tag with label value as **test**
2. Then go to documents and select new document
3. Then select document type
4. Now on next screen there is option to select tags. When you click on the input field, above mentioned script executes and creates a new span to display available tag names. In this span tag label value is not escaped so the user's script will execute.
   The spans generated to view available tags would look like this:
   `<span class="label label-tag" style="background: #000000;"> test<script>prompt(document.domain)</script> </span>`

**Proposed Mitigation:**

I would recommend to html encode the `tag.text` value on line 62 and 71.

Let me know in case any other details are required. I would also be requesting a CVE for this, once the patch is pushed.

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


