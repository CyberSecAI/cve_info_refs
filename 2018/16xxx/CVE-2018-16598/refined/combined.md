=== Content from blog.zimperium.com_1838188a_20250124_234037.html ===


[![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)
![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)](https://www.zimperium.com)

Search for:

* [Platform](https://www.zimperium.com/platform/)
* Products
  + MOBILE ENDPOINT SECURITY
    - [Zimperium MTD](https://www.zimperium.com/mtd/)
    - [Zimperium MTD for Chromebooks](https://www.zimperium.com/chromebooks/)
    - [z3A Application Vetting](https://www.zimperium.com/z3a-advanced-app-analysis/)
    - [zSecure Resident Safety](https://www.zimperium.com/zsecure/)
  + MOBILE APPLICATION SECURITY
    - [MAPS Mobile Application Protection Suite](https://www.zimperium.com/mobile-app-protection/)
    - [zScan Application Security Testing](https://www.zimperium.com/zscan/)
    - [zKeyBox Cryptographic Key Protection](https://www.zimperium.com/zkeybox/)
    - [zShield Application Shielding](https://www.zimperium.com/zshield/)
    - [zDefend Runtime Application Self-Protection](https://www.zimperium.com/zdefend/)
  + THREAT INTELLIGENCE
    - [Advanced Mobile Threat Insights](https://www.zimperium.com/support-advancedthreatinsights/)
    - [Mobile Threat Defense Maturity](https://www.zimperium.com/mtd-maturity-model/)
* Use Cases
  + [Combatting Mobile Banking Malware](https://www.zimperium.com/mobile-banking-malware/)
  + [Implementing Mobile Zero Trust](https://www.zimperium.com/zerotrust/)
  + [Securing Mobile O365](https://www.zimperium.com/secureoffice365/)
  + [Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
  + [Ensuring Security Compliance](https://www.zimperium.com/industry/compliance/)
    - [MAS Regulations](/industry/compliance/regulations-mas/)
    - [PSD2 Regulation](https://www.zimperium.com/industry/compliance/psd2-regulation/)
    - [RMiT Regulation](https://www.zimperium.com/industry/compliance/rmit-regulation/)
  + [Neobank Security](https://www.zimperium.com/neobanks/)
  + [Protecting Mobile Payments](https://www.zimperium.com/mobile-payments/)
  + [SoftPOS Certification](https://www.zimperium.com/softpos-providers-secure-with-zimperium/)
  + [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
  + [Connected Medical Devices and Apps](https://www.zimperium.com/industry/healthcare/connected-medical-devices-and-apps/)
* [Industries](https://www.zimperium.com/industry/)
  + [Automotive](https://www.zimperium.com/industry/automotive/)
  + [Banking](/industry/banking/)
  + [Education](https://www.zimperium.com/industry/education/)
  + [Government](https://www.zimperium.com/industry/government/)
  + [State & Local Government](https://www.zimperium.com/state-local-government/)
  + [Healthcare](https://www.zimperium.com/industry/healthcare/)
  + [Insurance](https://www.zimperium.com/industry/insurance/)
  + [Legal](https://www.zimperium.com/?page_id=1284)
  + [Pharmaceutical](https://www.zimperium.com/industry/pharmaceutical/)
  + [Retail & Mobile E-Commerce](https://www.zimperium.com/industry/retail/)
  + [Media and Entertainment](https://www.zimperium.com/ott-app-security-for-media-and-entertainment/)
* Partners
  + [zPartners](https://www.zimperium.com/partners/)
  + [Become a Partner](https://www.zimperium.com/partner-contact/)
* [Company](https://www.zimperium.com/company/)
  + [About Zimperium](https://www.zimperium.com/company/)
  + [News](https://www.zimperium.com/resources/press-releases/)
  + [Careers](https://www.zimperium.com/careers/)
  + [Awards](https://www.zimperium.com/company/awards/)
  + [Contact Zimperium](https://www.zimperium.com/contact-us/)
* [Resources](https://www.zimperium.com/resources/)
  + [Resources](https://www.zimperium.com/resources/)
  + [Events](https://www.zimperium.com/events/)
  + [FAQs](https://www.zimperium.com/faq/)
  + [Glossary](https://www.zimperium.com/glossary/)
  + [Threat Research](https://www.zimperium.com/zlabs/)
* [Blog](/blog/)

Search for:

[Zimperium](https://www.zimperium.com "Go to Zimperium.") > [Blogs](https://www.zimperium.com/blog/ "Go to Blogs.") > [Threat Research](https://www.zimperium.com/blog-category/threat-research/ "Go to the Threat Research Format archives.") > FreeRTOS TCP/IP Stack Vulnerabilities Put A Wide Range of Devices at Risk of Compromise: From Smart Homes to Critical Infrastructure Systems

# FreeRTOS TCP/IP Stack Vulnerabilities Put A Wide Range of Devices at Risk of Compromise: From Smart Homes to Critical Infrastructure Systems

   October 18, 2018
[zLabs](https://www.zimperium.com/author/zlabs/ "Posts by zLabs")

Share this blog

**[![](https://www.zimperium.com/wp-content/uploads/2018/10/FreeRTOS-300x169.png)](/wp-content/uploads/2018/10/FreeRTOS.png)Researchers:** Ori Karliner ([@oriHCX](https://twitter.com/oriHCX))

**Relevant Operating Systems:** FreeRTOS up to V10.0.1 (with FreeRTOS+TCP), AWS FreeRTOS up to V1.3.1, WHIS OpenRTOS and SafeRTOS (With WHIS Connect middleware TCP/IP components) .

**CVE List:**

[wpsm\_comparison\_table id=”4″ class=””]

As a part of our ongoing IoT platform research, [zLabs](https://www.zimperium.com/zlabs) recently analyzed some of the leading operating systems in the IoT market, including FreeRTOS. FreeRTOS is a market leader in the IoT and embedded platforms market, being ported to over 40 hardware platforms over the last 14 years. In November 2017, Amazon Web Services (AWS) took stewardship for the FreeRTOS kernel and its components.

[AWS FreeRTOS](https://github.com/aws/amazon-freertos) aims to provide a fully enabled IoT platform for microcontrollers, by bundling the FreeRTOS kernel together with the FreeRTOS TCP/IP stack, modules for secure connectivity, over the air updates, code signing, AWS cloud support, and more.

With the infrastructure that AWS provide, and the AWS FreeRTOS platform, developers can focus solely on innovation, thus reducing development time and costs.

![YouTube video](data:image/svg+xml...)![YouTube video](https://i.ytimg.com/vi/aeP0A67eNEg/hqdefault.jpg)

There is also a commercial version of FreeRTOS, named [OpenRTOS](https://www.highintegritysystems.com/openrtos/) and maintained by [WITTENSTEIN high integrity systems](https://www.highintegritysystems.com/) (WHIS). WHIS also offers a safety-oriented RTOS named [SafeRTOS](https://www.highintegritysystems.com/safertos/), that is based on the functional model of FreeRTOS, and is certified for use in safety critical systems.

FreeRTOS and SafeRTOS have been used in a wide variety of industries: IoT, Aerospace, Medical, Automotive, and more. Due to the high risk nature of devices in some of these industries, zLabs decided to take a look at the connectivity components that are paired with these OS’s. Clearly, devices that have connectivity to the outside world are at a higher degree of risk of being attacked.

During our research, we discovered multiple vulnerabilities within FreeRTOS’s TCP/IP stack and in the AWS secure connectivity modules. The same vulnerabilities are present in [WHIS Connect](https://www.highintegritysystems.com/middleware/tcpip-networking/) TCP/IP component for OpenRTOSSafeRTOS.

*These vulnerabilities allow an attacker to crash the device, leak information from the device’s memory, and remotely execute code on it, thus completely compromising it.*

We disclosed these vulnerabilities to Amazon, and collaborated (and continue to do so) with them to produce patches to the vulnerabilities we detected.

The patches were deployed for AWS FreeRTOS versions [1.3.2](https://github.com/aws/amazon-freertos/blob/master/CHANGELOG.md) and onwards. We also received confirmation from WHIS that they were exposed to the same vulnerabilities, and those were patched together with Amazon.

Since this is an open source project, we will wait for 30 days before publishing technical details about our findings, to allow smaller vendors to patch the vulnerabilities.

If you suspect that one or more of your products might be vulnerable and want our help with assessing the situation, please contact us at freertos@zimperium.com.

 ![Avatar photo](https://secure.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=90)
##### Author: [zLabs](https://www.zimperium.com/author/zlabs/ "zLabs")

## Post navigation

[Previous Blog](https://www.zimperium.com/blog/webinar-real-world-examples-mobile-threats-detected-hospital/)[Next Blog](https://www.zimperium.com/blog/cve-2018-4282-bounds-read-vulnerability-applet8015ppm-kext/)

##### Recommended Reading

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/FreeRTOS-400x250.jpg)
##### FreeRTOS TCP/IP Stack Vulnerabilities – The Details](https://www.zimperium.com/blog/freertos-tcpip-stack-vulnerabilities-details/ "FreeRTOS TCP/IP Stack Vulnerabilities – The Details")

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/bts-fig-4-400x250.jpg)
##### Analysis of multiple vulnerabilities in different open source BTS products](https://www.zimperium.com/blog/analysis-of-multiple-vulnerabilities-in-different-open-source-bts-products/ "Analysis of multiple vulnerabilities in different open source BTS products")

[![Dissecting mobile native code packers. A case study.](data:image/svg+xml...)![Dissecting mobile native code packers. A case study.](https://zimpstage.wpengine.com/wp-content/uploads/2022/11/default.jpg)

##### Dissecting mobile native code packers. A case study.](https://www.zimperium.com/blog/dissecting-mobile-native-code-packers-case-study/ "Dissecting mobile native code packers. A case study.")

 ![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white-300x46.png)

4055 Valley View Suite 300

Dallas, TX 75244

**US Toll Free:**  844-601-6760

**International:**  +1.415.992.8922

**General:** info@zimperium.com

**Press:** pr@zimperium.com

**[Compliance Hotline](https://my.compliancehotline.com/report/zimperium)**

**[Modern Slavery Act Statement](https://www.zimperium.com/modern-slavery-act-statement/)**

##### Learn More

* [FAQ](https://www.zimperium.com/faq/)
* [Support](https://www.zimperium.com/support/)
* [Blog](https://www.zimperium.com/blog/)
* [Threat Research](https://www.zimperium.com/zlabs/)
* [Glossary](https://www.zimperium.com/glossary/)
* [Responsible Disclosure Policy](https://lp.zimperium.com/hubfs/Zimperium/Zimperium%20Vulnerability%20Disclosure%20Policy%20%281%29.pdf)

##### Our Focus

* [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
* [Mobile Application Security](https://www.zimperium.com/mobile-app-security/)
* [Enterprise Mobile Security](https://www.zimperium.com/enterprise-mobile-security/)
* [Mobile Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
* [Mobile EDR](https://www.zimperium.com/mobile-edr/)

Copyright © 2010-2024 Zimperium.  All Rights Reserved.[Privacy Policy](https://www.zimperium.com/privacy-policy/)  | Privacy Settings



=== Content from blog.zimperium.com_f3bbaef8_20250124_234036.html ===


[![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)
![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)](https://www.zimperium.com)

Search for:

* [Platform](https://www.zimperium.com/platform/)
* Products
  + MOBILE ENDPOINT SECURITY
    - [Zimperium MTD](https://www.zimperium.com/mtd/)
    - [Zimperium MTD for Chromebooks](https://www.zimperium.com/chromebooks/)
    - [z3A Application Vetting](https://www.zimperium.com/z3a-advanced-app-analysis/)
    - [zSecure Resident Safety](https://www.zimperium.com/zsecure/)
  + MOBILE APPLICATION SECURITY
    - [MAPS Mobile Application Protection Suite](https://www.zimperium.com/mobile-app-protection/)
    - [zScan Application Security Testing](https://www.zimperium.com/zscan/)
    - [zKeyBox Cryptographic Key Protection](https://www.zimperium.com/zkeybox/)
    - [zShield Application Shielding](https://www.zimperium.com/zshield/)
    - [zDefend Runtime Application Self-Protection](https://www.zimperium.com/zdefend/)
  + THREAT INTELLIGENCE
    - [Advanced Mobile Threat Insights](https://www.zimperium.com/support-advancedthreatinsights/)
    - [Mobile Threat Defense Maturity](https://www.zimperium.com/mtd-maturity-model/)
* Use Cases
  + [Combatting Mobile Banking Malware](https://www.zimperium.com/mobile-banking-malware/)
  + [Implementing Mobile Zero Trust](https://www.zimperium.com/zerotrust/)
  + [Securing Mobile O365](https://www.zimperium.com/secureoffice365/)
  + [Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
  + [Ensuring Security Compliance](https://www.zimperium.com/industry/compliance/)
    - [MAS Regulations](/industry/compliance/regulations-mas/)
    - [PSD2 Regulation](https://www.zimperium.com/industry/compliance/psd2-regulation/)
    - [RMiT Regulation](https://www.zimperium.com/industry/compliance/rmit-regulation/)
  + [Neobank Security](https://www.zimperium.com/neobanks/)
  + [Protecting Mobile Payments](https://www.zimperium.com/mobile-payments/)
  + [SoftPOS Certification](https://www.zimperium.com/softpos-providers-secure-with-zimperium/)
  + [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
  + [Connected Medical Devices and Apps](https://www.zimperium.com/industry/healthcare/connected-medical-devices-and-apps/)
* [Industries](https://www.zimperium.com/industry/)
  + [Automotive](https://www.zimperium.com/industry/automotive/)
  + [Banking](/industry/banking/)
  + [Education](https://www.zimperium.com/industry/education/)
  + [Government](https://www.zimperium.com/industry/government/)
  + [State & Local Government](https://www.zimperium.com/state-local-government/)
  + [Healthcare](https://www.zimperium.com/industry/healthcare/)
  + [Insurance](https://www.zimperium.com/industry/insurance/)
  + [Legal](https://www.zimperium.com/?page_id=1284)
  + [Pharmaceutical](https://www.zimperium.com/industry/pharmaceutical/)
  + [Retail & Mobile E-Commerce](https://www.zimperium.com/industry/retail/)
  + [Media and Entertainment](https://www.zimperium.com/ott-app-security-for-media-and-entertainment/)
* Partners
  + [zPartners](https://www.zimperium.com/partners/)
  + [Become a Partner](https://www.zimperium.com/partner-contact/)
* [Company](https://www.zimperium.com/company/)
  + [About Zimperium](https://www.zimperium.com/company/)
  + [News](https://www.zimperium.com/resources/press-releases/)
  + [Careers](https://www.zimperium.com/careers/)
  + [Awards](https://www.zimperium.com/company/awards/)
  + [Contact Zimperium](https://www.zimperium.com/contact-us/)
* [Resources](https://www.zimperium.com/resources/)
  + [Resources](https://www.zimperium.com/resources/)
  + [Events](https://www.zimperium.com/events/)
  + [FAQs](https://www.zimperium.com/faq/)
  + [Glossary](https://www.zimperium.com/glossary/)
  + [Threat Research](https://www.zimperium.com/zlabs/)
* [Blog](/blog/)

Search for:

[Zimperium](https://www.zimperium.com "Go to Zimperium.") > [Blogs](https://www.zimperium.com/blog/ "Go to Blogs.") > [Mobile Security](https://www.zimperium.com/blog-category/mobile-security/ "Go to the Mobile Security Format archives."), [Threat Research](https://www.zimperium.com/blog-category/threat-research/ "Go to the Threat Research Format archives.") > FreeRTOS TCP/IP Stack Vulnerabilities – The Details

# FreeRTOS TCP/IP Stack Vulnerabilities – The Details

   December 4, 2018
[Ori Karliner](https://www.zimperium.com/author/ori/ "Posts by Ori Karliner")

Share this blog

Researcher: Ori Karliner ([@oriHCX](https://twitter.com/oriHCX))[![](https://www.zimperium.com/wp-content/uploads/2018/10/FreeRTOS-300x169.png)](/wp-content/uploads/2018/10/FreeRTOS.png)

Following our [blog](/freertos-tcpip-stack-vulnerabilities-put-wide-range-devices-risk-compromise-smart-homes-critical-infrastructure-systems/) from last month, this blog will cover the technical details of our findings.

If you suspect that any of your devices are affected by these vulnerabilities and want our assessment, contact us at freertos@zimperium.com.

## General information

Before we dive into the vulnerabilities, there are some important things to keep in mind.

The FreeRTOS+TCP TCP/IP stack is highly configurable. Some of the vulnerabilities only exist for specific configurations.

All packets are stored using the NetworkBufferDescriptor\_t struct:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/1FreeRTOS.png)](/wp-content/uploads/2018/11/1FreeRTOS.png)

FreeRTOS+TCP offers two allocation schemes for storing the packets:

1. BufferAllocation\_1.c – All packet buffers are statically allocated by the network driver in compile time, at the maximal size a packet can have (ipTOTAL\_ETHERNET\_FRAME\_SIZE).
2. BufferAllocation\_2.c – Packet buffers are allocated dynamically from the heap according to the needed size. Packet buffers have a minimal size – baMINIMAL\_BUFFER\_SIZE. This size depends on the configuration of the TCP/IP stack, but it is either the size of a TCP Packet or an ARP Packet.

Also, in some implementations, the packet buffer might be allocated by the networking driver in a different way. In that case, the impact of the vulnerabilities will differ accordingly.

Depending on the configuration and allocation scheme that is used, some of the vulnerabilities might have different impact levels.

I recommend reading the source code together with this disclosure to fully understand the vulnerabilities, and whether or not they are present in your configuration of FreeRTOS+TCP.

## CVE-2018-16528 – AWS secure connectivity modules – mbedTLS context corruption

The MQTT agent and GGD modules misuse the API of mbedTLS, creating a corrupt mbedTLS context object. The corrupt object may lead to remote code execution.

The MQTT and Greengrass discovery modules are vulnerable in different code flows.

For this disclosure, I will focus on the flow where an MQTT agent connects to a broker  – **prvSetupConnection**.

The function sets up the TLS connection to a certified server.

It initializes the socket, configures the TLS parameters, and then connects to the server:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/2FreeRTOS.png)](/wp-content/uploads/2018/11/2FreeRTOS.png)

**SOCKETS\_Connect** internally calls **TLS\_Connect**, that wraps the mbedTLS library:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/3FreeRTOS.png)](/wp-content/uploads/2018/11/3FreeRTOS.png)

It loops until the TLS handshake is done, or until an error has occurred.

Back to **prvSetupConnection**, we can see that if **SOCKETS\_Connect** fails, **prvGracefulSocketClose** is called.

This function internally cleans up the connection and closes the socket:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/4FreeRTOS.png)](/wp-content/uploads/2018/11/4FreeRTOS.png)

It first receives any data that’s left in the socket, and then it closes it.

**SOCKETS\_Recv** once again wraps **TLS\_Recv**, that wraps mbedTLS:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/5FreeRTOS.png)](/wp-content/uploads/2018/11/5FreeRTOS.png)

This flow is very problematic, as **SOCKETS\_Connect** might have failed because the TLS handshake failed, and now we are using the same mbedTLS context (**pCtx->mbedSslCtx**) for reading data (**mbedtls\_ssl\_read**).

**mbedtls\_ssl\_handshake** might have left the TLS context in a corrupted state, and comments on the mbedTLS API explicitly warn users about this scenario:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/6FreeRTOS.png)](/wp-content/uploads/2018/11/6FreeRTOS.png)

We have found a code flow within mbedTLS that will cause an heap buffer to be free’d twice because of this API misuse, but we will not cover it in this disclosure.

### Impact

An attacker can achieve remote code execution.

## CVE-2018-16522 – AWS secure connectivity modules – uninitialized pointer free

The **SOCKETS\_SetSockOpt** function of the AWS secure sockets module can cause an uninitialized pointer to be free’d.

The flaw only exists in cases where the user supplies a list of 2 or more ALPN protocols.

The user supplies a list of ALPN protocols, and **SOCKETS\_SetSockOpt** saves a copy of them within the socket context.

At first, the Protocol count field is set according to the user supplied length:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/7FreeRTOS.png)](/wp-content/uploads/2018/11/7FreeRTOS.png)

An array of pointers is allocated at the **pxContext->ppcAlpnProtocols** field, each of these pointers will point to a single protocol name:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/8FreeRTOS.png)](/wp-content/uploads/2018/11/8FreeRTOS.png)

Then, the buffers for each protocol name are allocated and assigned to this pointer array:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/9FreeRTOS.png)](/wp-content/uploads/2018/11/9FreeRTOS.png)

The problem is that the **ppcAlpnProtocols** pointer array is not cleaned up (memset to 0) after allocation, which means it will contain data from previous allocations on the heap.

As we can see, if the allocation of a protocol name buffer fails, the code will exit, but only the pointer to that specific buffer will be NULL.

If we have 2 ALPN protocols, and the buffer allocation for the first fails, the pointer to the second remains uninitialized, while the **ulAlpnProtocolsCount** remains at 3.

Later on, when the Socket is closed, we free this array of pointers:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/10FreeRTOS.png)](/wp-content/uploads/2018/11/10FreeRTOS.png)

Which means an uninitialized pointer (**ppcAlpnProtocols[1]**) will be free’d.

### Impact

Combined with a heap exhaustion primitive, an attacker can achieve remote code execution.

## CVE-2018-16526 – usGenerateProtocolChecksum memory corruption

The problematic flow beings in **prvProcessIPPacket**, whilst parsing IP Options:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/11FreeRTOS.png)](/wp-content/uploads/2018/11/11FreeRTOS.png)

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/12FreeRTOS.png)](/wp-content/uploads/2018/11/12FreeRTOS.png)

The code doesn’t handle IP Options at all and simply removes them from the packet by using memmove and truncating the **xDataLength** field of the network buffer.

The problem here, is that the **pxIPHeader->ucVersionHeaderLength** field is not updated accordingly, to represent the new IP header size.

This field is also used when sending packets, in **usGenerateProtocolChecksum**:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/13FreeRTOS.png)](/wp-content/uploads/2018/11/13FreeRTOS.png)

This function is used to generate or check the checksum of the upper layer protocol (TCPUDPICMP…).

The **ucVersionHeaderLength** field is used to determine where the next layer begins (**pxProtPack**), so that the calculated checksum can be placed at the right offset according to the used protocol.

For example, if the outgoing packet is a TCP packet:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/14FreeRTOS.png)](/wp-content/uploads/2018/11/14FreeRTOS.png)

First, the checksum field is zero’d:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/15FreeRTOS.png)](/wp-content/uploads/2018/11/15FreeRTOS.png)

And then the calculated checksum is assigned to this field:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/16FreeRTOS.png)](/wp-content/uploads/2018/11/16FreeRTOS.png)

In many cases a Tx packet is built over the Rx packet buffer, or at least based on it’s IP header.

If the Rx packet had IP options, we know that the code had already removed them, but that it didn’t adjust the **xIPHeader->ucVersionHeaderLength** field accordingly.

That means that when generating the protocol checksum for the transmitted packet, **pxProtPack** will point to the protocol header as if the IP options were still there.

We can cause the protocol checksum to be generated at an offset of up to 40 bytes from it’s real position in the packet, since 40 is the maximal size of IP options.

In cases where the packet buffer was shrinked, or in cases where the Tx packet is based on the IP header of a previous Rx packet, this 40 byte offset may point out of the buffers bounds, and lead to a memory corruption.

There are multiple code flows that can be used for exploitation, but we will not cover them in this disclosure.

### Impact

An attacker can leak information.

(Only with BufferAllocation\_2.c) An attacker can achieve remote code execution on the device.

## CVE-2018-16525  – DNSLLMNR memory corruptioninformation leak

Multiple bugs make it possible for an attacker to corrupt memory or leak information by sending DNSLLMNR packets to the device.

The same function (**ulDNSHandlePacket**) is used to parse both DNS and LLMNR queriesreplies.

The first bug is at the **prvProcessIPPacket** function, whilst dispatching a UDP packet:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/17FreeRTOS.png)](/wp-content/uploads/2018/11/17FreeRTOS.png)

Before the UDP packet is dispatched through **xProcessReceivedUDPPacket**, the total length of the packet (**xDataLength**) is recalculated to represent only the size of the UDP payload.

The bug here is that nothing is done to validate that the peer supplied a valid length in the UDP header (**xUDPHeader.usLength**), meaning that an attacker can cause **xDataLength** to be either smaller or larger than the real payload length.

The next bug is at **prvParseDNSReply**, whilst parsing a DNSLLMNR request.

Generally, the code at **prvParseDNSReply** does nothing to validate that parsed data is within the received packet’s boundaries.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/18FreeRTOS.png)](/wp-content/uploads/2018/11/18FreeRTOS.png)

In case a DNS query of type HOST and class IN was received for the device’s hostname (**xApplicationDNSQueryHook**), the code responds to that request.

First of all, a larger buffer must be allocated for the response, since the response is appended to the original DNS packet:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/19FreeRTOS.png)](/wp-content/uploads/2018/11/19FreeRTOS.png)

The code calculates the new size by adding to **xDataLength** the size of all needed packet headers (UDP, IP, ETH), and the size of the LLMNR response (16), and allocates a new buffer using **pxDuplicateNetworkBufferWithDescriptor**.

As we saw, an attacker can cause **xDataLength** to be either smaller or larger than the real payload size. That means that when the response buffer is allocated, it might be too small to contain the original packet, or that it might be larger, causing **pxDuplicateNetworkBufferWithDescriptor** to copy out of bounds data from the original buffer into the new one (Data that can later be leaked back to the attacker).

To understand the implications of this bug, let’s observe the code that builds the response:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/20FreeRTOS.png)](/wp-content/uploads/2018/11/20FreeRTOS.png)

As we can see, **xOffset1** is used to calculate the offset of the end of the DNS packet, where we want to insert our response. We later use it to build the LLMNR answer using **pxAnswer**.

For the dynamic buffer allocation scheme (BufferAllocation\_2.c), we can cause **pxDuplicateNetworkBufferWithDescriptor** to allocate a buffer that’s too small to contain the response.

That means an attacker can overrun data at a chosen offset (**xOffset1**) from the allocated network buffer, with the **LLMNRAnswer\_t** fields.

For the static buffer allocation scheme (BufferAllocation\_1.c), we can cause **pxDuplicateNetworkBufferWithDescriptor** to corrupt memory outside the new buffer:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/21FreeRTOS.png)](/wp-content/uploads/2018/11/21FreeRTOS.png)

We have full control over the **xDataLength** of the original packet buffer (because of the UDP code bug).

Since buffer have a constant size in this allocation scheme, by supplying an **xDataLength** that’s larger than the static buffer size, we can overflow it.

This vulnerability can also be used to leak information, if an attacker adds another DNS query with truncated length to the packet:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/22FreeRTOS.png)](/wp-content/uploads/2018/11/22FreeRTOS.png)

The only problem an attacker will face is that **usType** and **usClass** are both not in his control (Because they are read out of bounds), and they must both be 1 for an LLMNR response to be sent back.

This can be achieved by using some sort of heap shaping, and will yield in all data between the network buffer and the shaped data offset being sent back to the attacker.

### **Impact**

An attacker can achieve remote code execution.

An attacker can leak information.

## CVE-2018-16599 – NBNS memory corruptioninformation leak

**prvTreatNBNS**, just like **prvParseDNSReply**, doesn’t check if **xDataLength** is large enough to contain the parsed NBNS packet, Thus permitting an attacker to read data out of bounds.

Also, just like **prvParseDNSReply**, **pxDuplicateNetworkBufferWithDescriptor** is used to allocate the Tx packet, and **xDataLength** is controllable by the attacker (via the UDP length field bug):

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/23FreeRTOS.png)](/wp-content/uploads/2018/11/23FreeRTOS.png)

That means that on the static buffer allocation scheme (BufferAllocation\_1.c), an attacker can corrupt memory by supplying an **xDataLength** that’s larger than the static buffer size.

### **Impact**

An attacker can leak information.

(Only with BufferAllocation\_1.c) An attacker can achieve remote code execution.

## CVE-2018-16601 – IP DoSMemory corruption

The function **prvProcessIPPacket** removes the IP options field of an Rx packet if it is present.

The size of the IP header is not validated at any point:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/24FreeRTOS.png)](/wp-content/uploads/2018/11/24FreeRTOS.png)

If an attacker supplies an IP header length field (**uxHeaderLength**) that’s larger than the whole packet (**pxNetworkBuffer->xDataLength**) minus **ipSIZE\_OF\_IPv4\_HEADER** (20), the computation of **xMoveLen** will cause an integer underflow.

This will cause memmove to move a huge chunk of data, covering the entire 32 bit memory area, with a very little range to play with.

### **Impact**

An attacker can cause a DoS.

In some cases, an attacker can achieve remote code execution.

## CVE-2018-16523, CVE-2018-16524 -TCP Options information leakDoS

The function **prvCheckOptions** checks the TCP options supplied within an Rx TCP packet, if there are any:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/FreeRTOS-extra.png)](/wp-content/uploads/2018/11/FreeRTOS-extra.png)

The code doesn’t validate that the packet buffer is large enough to contain the TCP options (**pxNetworkBuffer->xDataLength**):

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/25FreeRTOS.png)](/wp-content/uploads/2018/11/25FreeRTOS.png)

**pucLast** is not checked at all, to see if it fits within the received packet, and the while loop that iterates TCP options only checks whether the current option begins within valid range (**pucPtr** < **pucLast**), but nothing is done to ensure that it ends within the valid range.

Each one of the TCP option handlers can access data out of bounds, and in some cases an attacker can get this data back (thus leaking information).

The **TCP\_OPT\_MSS** handler also contains a DoS vulnerability:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/26FreeRTOS.png)](/wp-content/uploads/2018/11/26FreeRTOS.png)

When recalculating the **RxWindowLength**, if an attacker supplies an MSS of 0, this line will divide by 0 thus raising an exception and causing a DoS.

### **Impact**

An attacker can cause a DoS.

An attacker can leak information.

## CVE-2018-16603 -TCP information leak

**xProcessReceivedTCPPacket** doesn’t validate that the received frame is large enough to contain a TCP header. Fields of the TCP header can be accessed out of bounds:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/27FreeRTOS.png)](/wp-content/uploads/2018/11/27FreeRTOS.png)

If an attacker sends an IP packet with TCP type, but doesn’t include the TCP header, **xLocalPort** and **xRemotePort** will be read out of bounds, and an RST packet using these ports will be sent back with **prvTCPSendReset**, thus leaking data back to the attacker.

### **Impact**

An attacker can leak information.

## CVE-2018-16602 – DHCP information leak

The **prvProcessDHCPReplies** function doesn’t validate that a packet is large enough to be a valid DHCP packet.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/28FreeRTOS.png)](/wp-content/uploads/2018/11/28FreeRTOS.png)

Also, whilst walking the DHCP option fields, length checks aren’t done correctly for the DHCP options:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/29FreeRTOS.png)](/wp-content/uploads/2018/11/29FreeRTOS.png)

As no check is done to see if **pucByte[1]** can even be accessed, and **pucByte** + **ucLength** is not checked against **pucLastByte**.

By making the code read some DHCP parameters out of bounds (For example the offered IP address) an attacker can later observe these values, thus leaking information.

### **Impact**

An attacker can leak information.

## CVE-2018-16600 – ARP information leak

**eARPProcessPacket** doesn’t validate that the received frame is large enough to be an ARP packet:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/30FreeRTOS.png)](/wp-content/uploads/2018/11/30FreeRTOS.png)

Fields of the ARP packet are accessed without doing proper boundary checking, which means out of bounds data can be accessed.

An attacker can leak information by observing the responses for truncated ARP packets.

### **Impact**

An attacker can leak information.

## CVE-2018-16527 – ICMP information leak

**prvProcessICMPPacket** doesn’t validate that the received frame is large enough to be an ICMP packet, and can access fields from this packet out of bounds:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/31FreeRTOS.png)](/wp-content/uploads/2018/11/31FreeRTOS.png)

The attacker can leak information by observing the response to a truncated ICMP echo request.

### **Impact**

An attacker can leak information.

## CVE-2018-16598 – DNS Poisoning

The code takes no steps to prevent DNS Poisoning, As any DNS answer the device receives will be parsed fully, without checking if it matches an outgoing DNS query.

We can see that at the function **xProcessReceivedUDPPacket**:

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/32FreeRTOS.png)](/wp-content/uploads/2018/11/32FreeRTOS.png)

**ulDNSHandlePacket** simply wraps **prvParseDNSReply**.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/11/33FreeRTOS.png)](/wp-content/uploads/2018/11/33FreeRTOS.png)

**prvParseDNSReply** will parse the DNS response, and update the DNS cache accordingly:

### **Impact**

An attacker can poison the DNS cache of the device.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/02/blogCTA_Hackers_1a_720x180px.jpg)](https://get.zimperium.com/how-hackers-execute-mobile-attacks?utm_medium=Blog-CTA-Banner&utm_campaign=Brief&utm_content=How-Hackers-Execute-Mobile-Attacks-Banner)

 ![Avatar photo](https://secure.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=90)
##### Author: [Ori Karliner](https://www.zimperium.com/author/ori/ "Ori Karliner")

## Post navigation

[Previous Blog](https://www.zimperium.com/blog/webinar-deliver-secure-mission-critical-mobile-apps-zimperium-3rd-eye-technologies/)[Next Blog](https://www.zimperium.com/blog/zimperium-scales-billions-thats-b/)

##### Recommended Reading

[![Dissecting mobile native code packers. A case study.](data:image/svg+xml...)![Dissecting mobile native code packers. A case study.](https://zimpstage.wpengine.com/wp-content/uploads/2022/11/default.jpg)

##### Dissecting mobile native code packers. A case study.](https://www.zimperium.com/blog/dissecting-mobile-native-code-packers-case-study/ "Dissecting mobile native code packers. A case study.")

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/ad_Qualcm_1d_1280x720px_blog-400x250.jpg)
##### Multiple Kernel Vulnerabilities Affecting All Qualcomm Devices](https://www.zimperium.com/blog/multiple-kernel-vulnerabilities-affecting-all-qualcomm-devices/ "Multiple Kernel Vulnerabilities Affecting All Qualcomm Devices")

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/CVE_13253_1200x628px-400x250.jpg)
##### CVE-2017-13253: Buffer overflow in multiple Android DRM services](https://www.zimperium.com/blog/cve-2017-13253-buffer-overflow-multiple-android-drm-services/ "CVE-2017-13253: Buffer overflow in multiple Android DRM services")

 ![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white-300x46.png)

4055 Valley View Suite 300

Dallas, TX 75244

**US Toll Free:**  844-601-6760

**International:**  +1.415.992.8922

**General:** info@zimperium.com

**Press:** pr@zimperium.com

**[Compliance Hotline](https://my.compliancehotline.com/report/zimperium)**

**[Modern Slavery Act Statement](https://www.zimperium.com/modern-slavery-act-statement/)**

##### Learn More

* [FAQ](https://www.zimperium.com/faq/)
* [Support](https://www.zimperium.com/support/)
* [Blog](https://www.zimperium.com/blog/)
* [Threat Research](https://www.zimperium.com/zlabs/)
* [Glossary](https://www.zimperium.com/glossary/)
* [Responsible Disclosure Policy](https://lp.zimperium.com/hubfs/Zimperium/Zimperium%20Vulnerability%20Disclosure%20Policy%20%281%29.pdf)

##### Our Focus

* [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
* [Mobile Application Security](https://www.zimperium.com/mobile-app-security/)
* [Enterprise Mobile Security](https://www.zimperium.com/enterprise-mobile-security/)
* [Mobile Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
* [Mobile EDR](https://www.zimperium.com/mobile-edr/)

Copyright © 2010-2024 Zimperium.  All Rights Reserved.[Privacy Policy](https://www.zimperium.com/privacy-policy/)  | Privacy Settings



=== Content from github.com_85788aa7_20250124_234038.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Faws%2Famazon-freertos%2Fblob%2Fv1.3.2%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Faws%2Famazon-freertos%2Fblob%2Fv1.3.2%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=aws%2Famazon-freertos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Dec 8, 2022. It is now read-only.

[aws](/aws)
/
**[amazon-freertos](/aws/amazon-freertos)**
Public archive

* [Notifications](/login?return_to=%2Faws%2Famazon-freertos) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Faws%2Famazon-freertos)
* [Star
   2.5k](/login?return_to=%2Faws%2Famazon-freertos)

* [Code](/aws/amazon-freertos/tree/v1.3.2)
* [Issues
  20](/aws/amazon-freertos/issues)
* [Pull requests
  0](/aws/amazon-freertos/pulls)
* [Actions](/aws/amazon-freertos/actions)
* [Projects
  0](/aws/amazon-freertos/projects)
* [Security](/aws/amazon-freertos/security)
* [Insights](/aws/amazon-freertos/pulse)

Additional navigation options

* [Code](/aws/amazon-freertos/tree/v1.3.2)
* [Issues](/aws/amazon-freertos/issues)
* [Pull requests](/aws/amazon-freertos/pulls)
* [Actions](/aws/amazon-freertos/actions)
* [Projects](/aws/amazon-freertos/projects)
* [Security](/aws/amazon-freertos/security)
* [Insights](/aws/amazon-freertos/pulse)

## Files

 v1.3.2
## Breadcrumbs

1. [amazon-freertos](/aws/amazon-freertos/tree/v1.3.2)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/aws/amazon-freertos/commits/v1.3.2/CHANGELOG.md)387 lines (271 loc) · 14.8 KB v1.3.2
## Breadcrumbs

1. [amazon-freertos](/aws/amazon-freertos/tree/v1.3.2)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

387 lines (271 loc) · 14.8 KB[Raw](https://github.com/aws/amazon-freertos/raw/refs/tags/v1.3.2/CHANGELOG.md)
# Change Log for Amazon FreeRTOS

## V1.3.2 08/21/2018

### New Features

None

### Updates

#### FreeRTOS+TCP

* Multiple security improvements and fixes in packet parsing routines, DNS caching, and TCP sequence number and ID generation.
* Disable NBNS and LLMNR by default.
* Add TCP hang protection by default.

#### Secure Socket for FreeRTOS+TCP

* Improve security in Amazon FreeRTOS Secure Sockets usage of mbedTLS and ALPN.

We thank Ori Karliner of Zimperium zLabs Team for reporting these issues.

## V1.3.1 08/10/2018

### New Features

None

### Updates

#### OTA Beta Update

* Updates to OTA Beta to incorporate a new API for the OTA service. This API is not compatible with the API used in the original OTA Beta released on Dec. 20th.
* Add a "reference bootloader" for use in the OTA process. This bootloader is for use with the Microchip MCU.

#### Amazon FreeRTOS Qualification Program (AFQP) Update

* Update AFQP documentation. For more info on the changes to AFQP, reference the Revision History of the "Amazon FreeRTOS Qualification Program Developer Guide" in the "tests" directory.

#### Device Defender Update

* Add a demo to illustrate the operation of Device Defender for the Windows Simulator and Microchip PIC32MZEF MCU.

#### TI "Hello World" Build Failure Resolution

* Address an issue where the "Hello World" demo did not build with TI CCS 7.3 in AFR 1.3.0 when downloaded from OCW.

## V1.3.0 07/31/2018

### New Features

#### AFQP 1.0 Support

This release of AFR has support for vendors who wish to have their ports qualified for Amazon FreeRTOS through the Amazon FreeRTOS Qualification Program (AFQP). This is the first public release of AFQP tests and documentation. A new top level "tests" directory is added to support this functionality. AFQP documents are available in "tests" directory. [Learn more.](https://docs.aws.amazon.com/freertos/latest/userguide/freertos-qualification-program.html)

#### Device Defender 1.0 Support

AWS IoT Device Defender is an AWS IoT security service that allows users to audit the configuration of their devices, monitor connected devices to detect abnormal behavior, and to mitigate security risks. It gives you the ability to enforce consistent security policies across your AWS IoT device fleet and respond quickly when devices are compromised. Device side support of this feature is part of this release. Devices supported are WinSim and Microchip PIC32MZEF. [Learn more.](https://docs.aws.amazon.com/freertos/latest/userguide/afr-device-defender-library.html)

#### FreeRTOS+POSIX 1.0 Interface

This release includes version 1.0.0 of FreeRTOS+POSIX. FreeRTOS+POSIX is a POSIX compatibility layer that allows existing POSIX applications to run without modifications of FreeRTOS. This release supports POSIX threads, mutexes, barriers, condition variables, semaphores, message queues, clocks, timers, and error numbers. While most of the POSIX functions are implemented and up to specification, limitations in the FreeRTOS kernel precluded the standard implementations of certain functions. The functions which differ from the POSIX specification are identified in their header files. Currently, FreeRTOS+POSIX is only used by drivers of the TI CC3220SF.

### Updates

#### FreeRTOS Kernel V10.0.1

* Add Idle tick counter interface
* Rename posix/ to FreeRTOS\_POSIX/

#### FreeRTOS+TCP V2.0.4

* Fix issues raised by the Coverity scan
  + Fix a typo ulRxWindowLength -> ulTxWindowLength in FreeRTOS\_Sockets.c
  + Fix strncmp length in FreeRTOS\_DNS.c
  + Fix styling in FreeRTOS\_ARP.c
* Fix a spelling typo ";east" -> "least" (response from a pull request)
* Add auto check of network interfaces for WinSim

#### MQTT Agent V1.1.2

* Move MQTT metrics to agent

#### mbedTLS-based PKCS#11 V1.0.3

* Reduce the number of warnings generated

#### PKCS#11 for LPC54018 IoT Module V1.0.1

* Change project baudrate setting to resolve AFQP test failures

#### Secure Sockets for NXP54018\_IoT\_Module V1.0.0 Beta 3

* Update to latest NXP driver to address AFQP 1.0 test failures

#### Secure Sockets for STM32L4 Discovery kit IoT node V1.0.0 Beta 2

* Update to new Inventek driver to resolve AFQP 1.0 test failures

#### Wi-Fi for Curiosity PIC32MZEF V1.0.3

* Change Microchip network param to use a direct address instead of a section to reduce the size of the binary image to allow OTA to continue working.
* Reduce number of warnings generated.

#### Wi-Fi for LPC54018 IoT Module V1.0.1

* Add fixes for Demo and DHCP.

#### Wi-Fi STM32L4 Discovery kit IoT node V1.0.2

* Update for release of AFQP 1.0

#### Wi-Fi for CC3220SF-LAUNCHXL V1.0.2

* Update for release of AFQP 1.0

---

## V1.2.7 05/31/2018

* Update the Texas Instruments SimpleLink CC3220 SDK from version 1.40.01.00 to version 2.10.00.04.
* Fix the MQTT Echo Demo (Hello World Demo) to avoid truncating received strings.
* Modify the Getting Started scripts to check if the AWS CLI is configured.

#### Secure Sockets for CC3220SF-LAUNCHXL V1.0.4

* Update comments for SimpleLink CC3220 SDK version 2.10.00.04.

---

## V1.2.6 05/18/2018

* Fix NXP MCUXpresso project build failure on Linux.

---

## V1.2.5 05/14/2018

* Add support for Espressif's ESP32-DevKitC and ESP-WROVER-KIT.

#### FreeRTOS+TCP V2.0.4

* Add Espressif ESP32 network interface support.

#### mbedTLS-based PKCS#11 V1.0.3

* Implement C\_DigestInit, C\_DigestUpdate, and C\_DigestFinal for SHA-256.
* Implement C\_GenerateKeyPair for non-persistent ECDSA P256.

#### PKCS#11 for ESP32-DevKitC ESP-WROVER-KIT V1.0.0

* Add support for Espressif's ESP32-DevKitC and ESP-WROVER-KIT.

#### Wi-Fi STM32L4 Discovery kit IoT node V1.0.2

* Bug fix to ensure that WIFI\_ConnectAP() switches to the network parameters input,
  even when already connected to a different set.

#### Wi-Fi for ESP32-DevKitC ESP-WROVER-KIT V1.0.0

* Add support for Espressif's ESP32-DevKitC and ESP-WROVER-KIT.

---

## V1.2.4 05/01/2018

* Upgrade to mbedTLS version 2.8.
* Add MCUXpresso IDE demo project for the NXP LPC54018 IoT Module.

#### Crypto V1.0.2

* Minor updates due to mbedTLS crypto interface changes.

#### FreeRTOS+TCP V2.0.3

* Fix a bug where re-transmission and duplicated TCP packets would create a
  computation underflow as well as a memory leak.
* Add new public function FreeRTOS\_UpdateMACAddress() to allow changing the MAC address
  after FreeRTOS\_IPInit. Sometimes the device MAC address is not available at the
  time FreeRTOS\_IPInit() is called, so it needs to be changed afterward.
* Remove non-cryptographic rand() implementation.
* Remove a static variable in functions prvGetHostByName() and prvCreateDNSSocket() to
  make them threadsafe.

#### Greengrass Discovery V1.0.3

* Provide a helpful error message if the Greengrass Discovery JSON does not fit in
  the supplied buffer.

#### MQTT Agent V1.1.2

* Bug fix to avoid socket leak if MQTT Connect fails after a successful TCP
  connection.
* Add support for disabling subscription management feature by defining the macro
  mqttconfigENABLE\_SUBSCRIPTION\_MANAGEMENT as 0.

#### OTA PAL for Curiosity PIC32MZEF V0.9.1

* Update for PKCS#11 PAL layer API changes.

#### OTA PAL for Windows Simulator V0.9.2

* Minor restructuring of file locations.

#### OTA PAL for CC3220SF-LAUNCHXL V0.9.3

* Minor changes to enable test integration.

#### OTA Agent V0.9.4

* Minor restructuring of file locations.

#### mbedTLS-based PKCS#11 V1.0.2

* Combine the mbedTLS based PKCS#11 implementation from Curiosity PIC32MZEF,
  LPC54018 IoT Module, Windows Simulator, and STM32L4 Discovery kit IoT node into a
  single file.
* Add support for public key verification of signatures.
* Fix to free context structures on session failure.
* Update C\_OpenSession to use CKF\_SERIAL\_SESSION flag.

#### PKCS#11 for Curiosity PIC32MZEF V1.0.2

* Create port specific functions for certificate and key access:
  PKCS11\_PAL\_SaveFile(), PKCS11\_PAL\_ReadFile(), PKCS11\_PAL\_ReleaseFileData().

#### PKCS#11 for LPC54018 IoT Module V1.0.1

* Create port specific functions for certificate and key access:
  PKCS11\_PAL\_SaveFile(), PKCS11\_PAL\_ReadFile(), PKCS11\_PAL\_ReleaseFileData().

#### PKCS#11 PAL for Windows Simulator V1.0.2

* Create port specific functions for certificate and key access:
  PKCS11\_PAL\_SaveFile(), PKCS11\_PAL\_ReadFile(), PKCS11\_PAL\_ReleaseFileData().

#### PKCS#11 for STM32L4 Discovery kit IoT node V1.0.1

* Create port specific functions for certificate and key access:
  PKCS11\_PAL\_SaveFile(), PKCS11\_PAL\_ReadFile(), PKCS11\_PAL\_ReleaseFileData().

#### PKCS#11 for CC3220SF-LAUNCHXL V1.0.2

* PKCS#11 implementation for TI based on mbedTLS moved into this file.

#### Secure Socket for FreeRTOS+TCP V1.1.2

* Combine Secure Sockets implementation for Curiosity PIC32MZEF and Windows
  Simulator into a single file.
* Fix return value of SOCKETS\_Socket on error.
* Attempting to create an unsupported UDP socket now triggers an assert.
* Add cryptographic random number generator function for TCP sequence numbers.
* Update the Socket structure to keep track of a connection attempt and added
  support of the ECONN error.

#### Secure Sockets for LPC54018 IoT Module V1.0.0 Beta 3

* Fix minor bug in SOCKETS\_Recv().

#### Secure Sockets for STM32L4 Discovery kit IoT node V1.0.0 Beta 2

* Fix return value of SOCKETS\_Close on error.

#### Secure Sockets for CC3220SF-LAUNCHXL V1.0.3

* Secure sockets printing is now controlled independently using the SOCKETS\_PRINT
  macro. SOCKETS\_PRINT prints TI driver error codes.

#### Shadow V1.0.3

* Change names of configuration constants to be consistent with FreeRTOS style.

#### TLS V1.1.1

* Support AWS IoT Just-in-Time Registration (JITR) by sending optional
  client-issuer certificate.
* Use CKF\_SERIAL\_SESSION flag with PKCS#11.

#### Wi-Fi for Curiosity PIC32MZEF V1.0.3

* Update for setting the MAC Address in WIFI\_On() by using new FreeRTOS+TCP
  function FreeRTOS\_UpdateMACAddress().
* Redefine printing and assert stubs used in the Wi-Fi driver code.
* Add implementation of WIFI\_GetMAC().
* Add implementation of WIFI\_IsConnected().
* Minor bug fixes.

#### Wi-Fi for LPC54018 IoT Module V1.0.2

* Add implementation of WIFI\_IsConnected().
* Fix max DNS name length redefinition.
* Fix compiler errors in MCUXpresso IDE.
* Minor bug fixes.

#### Wi-Fi STM32L4 Discovery kit IoT node V1.0.1

* Add implementation of WIFI\_IsConnected().
* Add NULL pointer checks throughout.
* Minor bug fixes.

#### Wi-Fi for CC3220SF-LAUNCHXL V1.0.2

* Add implementation of WIFI\_IsConnected().
* Add NULL pointer checks throughout.
* Minor bug fixes.

---

## V1.2.3 03/29/2018

* Fix TI IAR project build failure.

---

## V1.2.2 02/27/2018

#### OTA Agent V0.9.3

* Formatting update.

#### OTA PAL for Curiosity PIC32MZEF V0.9.0

* Beta release of the OTA Update support for the Microchip Curiosity PIC32MZEF.

#### PKCS#11 for Curiosity\_PIC32MZEF V1.0.1

* Add support for the management of OTA update code signing keys.

#### Wi-Fi for Curiosity PIC32MZEF V1.0.1

* Update to conditionally compile the entire file.

---

## V1.2.1 02/23/2018

* Add an IAR IDE demo project for the Texas Instruments CC3220SF-LAUNCHXL.
* Add Wi-Fi support for the Microchip Curiosity PIC32MZEF.

#### FreeRTOS+TCP V2.0.2

* Improve NULL variable check in buffer management.

#### MQTT Agent V1.1.1

* Minor bug fix checking for a NULL pointer.

#### OTA Agent V0.9.2

* Update to support NULL OTA file handles.

#### Amazon FreeRTOS OTA PAL for CC3220SF-LAUNCHXL V0.9.2

* Update to support NULL OTA file handles.

#### PKCS#11 for CC3220SF-LAUNCHXL V1.0.1

* Add a dummy variable to a previously empty structure to fix IAR compiler errors.

#### Secure Socket for Windows Simulator V1.1.1

* Formatting update.

#### Secure Sockets for CC3220SF-LAUNCHXL V1.0.2

* Update to print SimpleLink driver-specific error codes when debugging.
* Add error handling for non-blocking sockets.
* Update socket option to return an error if security options are specified after
  a connection.

#### Wi-Fi for Curiosity PIC32MZEF V1.0.1

* Update such that Wi-Fi disconnection waits until the link is down before
  returning.

#### Wi-Fi for CC3220SF-LAUNCHXL V1.0.1

* Fix error in attempting to overwrite a const memory.

---

## V1.2.0 02/06/2018

#### Greengrass Discovery V1.0.2

* Update to send all data until an error is received.

#### MQTT Agent V1.1.0

* Add support for ALPN. ALPN allows MQTT traffic to be sent to
  the AWS IoT broker over port 443 instead of 8883.

#### OTA Agent V0.9.1

* Send a FAILED status from agent when a file too large for the platform
  is received.
* Rename some files.

#### PKCS#11 for Windows Simulator

* Add developer mode key provisioning support.

#### Secure Socket for Curiosity PIC32MZEF V1.0.1

* Add support for ALPN.

#### Secure Socket for Windows Simulator V1.1.0

* Add support for ALPN.

#### Secure Sockets for CC3220SF-LAUNCHXL V1.0.1

* Remove unnecessary server certificate storage on the client side.
* Remove unnecessary global synchronization semaphore.
* Update for other small bugs.

#### Shadow V1.0.2

* Fix error handling bugs.
* Require client tokens.
* Update for other small bugs.

#### TLS V1.1.0

* Add support for ALPN.

---

## V1.1.0 12/20/2017

#### Crypto V1.0.1

* Fix compiler warning for the Microchip Curiosity PIC32MZEF.

#### FreeRTOS+TCP V2.0.1

* Add support for the Microchip Curiosity PIC32MZEF.

#### FreeRTOS Kernel V10.0.1

* Minor bug fixes to allow Linux and C++ builds.

#### Greengrass Discovery V1.0.1

* Reformat console display messages in order to better facilitate demos and debugging.

#### MQTT Agent V1.0.1

* The MQTT Agent now processes commands between successive socket reads to enable faster command handling, especially when the connected socket is receiving data continuously.

#### OTA Agent V0.9.0

* Beta release of OTA Update library for Amazon FreeRTOS. Includes support for the Texas Instruments CC3220SF-LAUNCHXL and Windows Simulator.

#### PKCS#11 for Curiosity PIC32MZEF V1.0.0 Beta 1

* Add support for the Microchip Curiosity PIC32MZEF.

#### Secure Socket for Curiosity PIC32MZEF V1.0.0

* Add support for the Microchip Curiosity PIC32MZEF.

#### Secure Sockets for LPC54018 IoT Module V1.0.0 Beta 2

* Fix bugs in the Secure Sockets implementation for the NXP LPC54018 IoT Module.

#### Shadow V1.0.1

* Fix compiler warning for the Microchip Curiosity PIC32MZEF.

#### Wi-Fi for LPC54018 IoT Module V1.0.1

* Change the Wi-Fi Connection timeout to 10 seconds.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


