=== Content from gitlab.com_abb1fa72_20250125_065624.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [mayan-edms](/mayan-edms/mayan-edms/-/tree/master)
* [**HISTORY.rst**](/mayan-edms/mayan-edms/-/blob/master/HISTORY.rst)

Find file

[Blame](/mayan-edms/mayan-edms/-/blame/master/HISTORY.rst)
[Permalink](/mayan-edms/mayan-edms/-/blob/2d1f403702dd1ae3fe2d93679b33aabd10b06c3e/HISTORY.rst "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* ![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=64&d=identicon "Roberto Rosario")

  Jan 21, 2025

  [714ce672](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  ·
  714ce672

  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

  714ce672

  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

To find the state of this project's repository at the time of any of these versions, check out [the tags](/mayan-edms/mayan-edms/-/tags).

Loading



=== Content from gitlab.com_3bd96aec_20250125_065627.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# DOM based Cross Site Scripting

Hi Team,

I observed a DOM based Cross Site Scripting issue in the code.

**Location:**

The vulnerable code lies in following file:
<https://gitlab.com/mayan-edms/mayan-edms/blob/master/mayan/apps/appearance/templates/appearance/base_plain.html>

The vulnerable line of code is line 37.

```
                var currentHash = window.location.hash;
                if (currentHash.length) {
                    window.location = currentHash.substring(1);
                }
```

Here the value from source window.location.hash is directly passed into sink window.location
This code is embedded on following URLs in the hosting:

1. /authentication/login/
2. /authentication/password/reset/done/
3. /authentication/password/reset/

**Attack Scenario/ Steps:**

So if the URL is like <http://domainname.com/authentication/login/#javascript:alert(document.domain)> then javascript:alert(document.domain) will execute on the login page.

**Proposed Mitigation:**

Replace the following line of code window.location = currentHash.substring(1); with window.location.pathname = currentHash.substring(1);

Let me know in case any other details are required. I would also be requesting a CVE for this, once the patch is pushed.

Edited Aug 16, 2018 by [lokesh1095](/lokesh1095)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_b2e5e3f3_20250125_065625.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
9ebe8059**

authored
Aug 16, 2018
by
**[![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=96&d=identicon "Roberto Rosario")](/rosarior)
[Roberto Rosario](/rosarior)**

[Browse files](/mayan-edms/mayan-edms/-/tree/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e)

### Avoid setting window.location directly to avoid exploit of cross site...

```

Avoid setting window.location directly to avoid exploit of cross site scripting. Thanks to Lokesh ([@lokesh1095](/lokesh1095 "lokesh1095")) for the report and solution. Closes GitLab issue [#494](/mayan-edms/mayan-edms/-/issues/494 "DOM based Cross Site Scripting").

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=32&d=identicon)Roberto Rosario <roberto.rosario.gonzalez@gmail.com>
```

parent
[ed762780](/mayan-edms/mayan-edms/-/commit/ed76278096d5a6bdfd897d1b59ffaca8079d2be5)

Loading

Loading

Loading

Loading

* [Changes
  2](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e)
* [Pipelines
  1](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e/pipelines)

[Hide whitespace changes](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e?action=show&controller=projects%2Fcommit&id=9ebe80595afe4fdd1e2c74358d6a9421f4ce130e&namespace_id=mayan-edms&project_id=mayan-edms&w=1)
[Inline](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e?view=inline)
[Side-by-side](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e?view=parallel)

Loading

* [Roberto Rosario](/rosarior)
  @rosarior

  mentioned in issue [#494 (closed)](/mayan-edms/mayan-edms/-/issues/494 "DOM based Cross Site Scripting")

  ·

  [Aug 16, 2018](#note_95022550)

  mentioned in issue [#494 (closed)](/mayan-edms/mayan-edms/-/issues/494 "DOM based Cross Site Scripting")

  mentioned in issue #494

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


