=== Content from gitlab.com_eebf7c14_20250125_135515.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
48dfc06e**

authored
Aug 16, 2018
by
**[![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=96&d=identicon "Roberto Rosario")](/rosarior)
[Roberto Rosario](/rosarior)**

[Browse files](/mayan-edms/mayan-edms/-/tree/48dfc06e49c7f773749e063f8cc69c95509d1c32)

### Cabinets app: Escape cabinet labels to avoid possible exploit of cross site...

```

Cabinets app: Escape cabinet labels to avoid possible exploit of cross site scripting. Thanks to Lokesh ([@lokesh1095](/lokesh1095 "lokesh1095")) for the report and proposed solutions. Closes GitLab issue [#495](/mayan-edms/mayan-edms/-/issues/495 "Persistent Cross Site Scripting").

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/27302ea0237d5b5b00b6db1edba555bc1456fd5cc37e85359681afb37af57692?s=32&d=identicon)Roberto Rosario <roberto.rosario.gonzalez@gmail.com>
```

parent
[9ebe8059](/mayan-edms/mayan-edms/-/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e)

Loading

Loading

Loading

* [Changes
  2](/mayan-edms/mayan-edms/-/commit/48dfc06e49c7f773749e063f8cc69c95509d1c32)

[Hide whitespace changes](/mayan-edms/mayan-edms/-/commit/48dfc06e49c7f773749e063f8cc69c95509d1c32?action=show&controller=projects%2Fcommit&id=48dfc06e49c7f773749e063f8cc69c95509d1c32&namespace_id=mayan-edms&project_id=mayan-edms&w=1)
[Inline](/mayan-edms/mayan-edms/-/commit/48dfc06e49c7f773749e063f8cc69c95509d1c32?view=inline)
[Side-by-side](/mayan-edms/mayan-edms/-/commit/48dfc06e49c7f773749e063f8cc69c95509d1c32?view=parallel)

Loading

* [Roberto Rosario](/rosarior)
  @rosarior

  mentioned in issue [#495 (closed)](/mayan-edms/mayan-edms/-/issues/495 "Persistent Cross Site Scripting")

  ·

  [Aug 16, 2018](#note_95025634)

  mentioned in issue [#495 (closed)](/mayan-edms/mayan-edms/-/issues/495 "Persistent Cross Site Scripting")

  mentioned in issue #495

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.com_40b32664_20250125_135517.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Persistent Cross Site Scripting

Hi Team,

I've observed a Persistent Cross Site Scripting bug in the code. The issue lies in the JSTree implementation.

**Location:**

The vulnerable code lies in following file:
<https://gitlab.com/mayan-edms/mayan-edms/blob/master/mayan/apps/cabinets/templates/cabinets/cabinet_details.html>

The vulnerable line of code is line 49-52.

```
                        'data' : [
                            {{ jstree_data|safe }}

                        ]
```

**Attack Scenario/ Steps:**

If a user creates a cabinet with following label `"}]}});prompt(document.domain);jstree({'core':{'data':[{"text":"` and then clicks on details button to view the cabinet details.
A navigation area is created via JSTree which displays this label name as well.
Now since JSTree is not escaping the label names, the **"** will break the context and the final view of data will be like this.

```
'data' : [
                            {
"text": ""}]}});prompt(document.domain);jstree({'core':{'data':[{"text":"",
"state": { "opened": true, "selected": true },
"data": { "href": "/cabinets/1/" },
},
                        ]
```

Where `"}]}});` will satisfy upper script part and `;jstree({'core':{'data':[{"text":"` will satisfy lower script part and `prompt(document.domain)` will execute while rendering.

**Proposed Mitigation:**
I have two ideas for the mitigation part.

1. html encode the cabinet labels before passing them to JSTree.
2. Blacklist the **"** and **'** and **(** and **)** characters for cabinet label.

Though I would recommend to go for first option.
Also I found a almost similar thread for JStree escaping issue, maybe it will be of some help:
<https://github.com/vakata/jstree/issues/756>

Let me know in case any other details are required. I would also be requesting a CVE for this, once the patch is pushed.

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_abb1fa72_20250125_135514.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [mayan-edms](/mayan-edms/mayan-edms/-/tree/master)
* [**HISTORY.rst**](/mayan-edms/mayan-edms/-/blob/master/HISTORY.rst)

Find file

[Blame](/mayan-edms/mayan-edms/-/blame/master/HISTORY.rst)
[Permalink](/mayan-edms/mayan-edms/-/blob/2d1f403702dd1ae3fe2d93679b33aabd10b06c3e/HISTORY.rst "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* ![Roberto Rosario's avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=64&d=identicon "Roberto Rosario")

  Jan 21, 2025

  [714ce672](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  ·
  714ce672

  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

  714ce672

  [Add missing release notes partials](/mayan-edms/mayan-edms/-/commit/714ce67203adaa208df2f92d460c3348debde48a)
  Roberto Rosario authored Jan 21, 2025
  ```

  Add missing includes to add the removals, deprecations and
  backward incompatible sections.

  Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/26c1516b386a5b060562c158edec35a780505178602a7798c7ce267a36395512?s=32&d=identicon)Roberto Rosario <roberto.rosario@mayan-edms.com>
  ```

To find the state of this project's repository at the time of any of these versions, check out [the tags](/mayan-edms/mayan-edms/-/tags).

Loading


