=== Content from micco.mars.jp_41301287_20250125_000132.html ===


| | ### Micco's Home Page ### | Welcome to Micco's page!! Sorry, but this web page is written in Japanese. <[English](../../english/index_e.htm)> | | --- | --- | | |
| --- | --- | --- | --- |
| | | â  **[æ´æ°æå ±](../../micindex.html)** | | --- | | â  **[ãã®Webãã¼ã¸ã«ã¤ãã¦](../../notes/note.htm)** | | â  **[ãç¥ãã](../../notes/ann.htm)** | | â  **ãã¦ã³ã­ã¼ã**  | â  [UNLHA32.DLL](../../mysoft/unlha32.htm) | | --- | | â  [UNARJ32.DLL](../../mysoft/unarj32.htm) | | â  [DMZIP32.DLL](../../mysoft/dmzip.htm) | | â  [LHMelt](../../mysoft/lhmelt.htm) | | â  [Win16 ãã­ã°ã©ã](../../mysoft/win16.htm) | | | â  **[DLL ã®ã¤ã³ã¹ãã¼ã«æ¹æ³](../../exp/install.htm)** | | â  **[SFX ã®è¨­å®ä¾](../../exp/sfxsample.htm)** | | â  **[ãããã](../../extra/extra.htm)** |  **[ç·åæå ±ã¯ãã¡ã](http://www.csdinc.co.jp/archiver/index.html)** [[çµ±åã¢ã¼ã«ã¤ã]](http://www.csdinc.co.jp/archiver/index.html) | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | å¯¾å¿ãã©ã¦ã¶ã¼  [[Internet Explorer]](https://www.microsoft.com/ja-jp/download/internet-explorer.aspx) [[Firefox]](http://mozilla.jp/) [[Opera]](http://www.opera.com/) [[Sleipnir]](http://www.fenrir.co.jp/sleipnir/) [[Safari]](http://www.apple.com/jp/safari/) [[Google Chrome]](http://www.google.com/chrome/?hl=ja) | | é£çµ¡åï¼Micco [e-mail] | | [[âãèå¼±æ§æå ±ä¸è¦§ã]](../index.htm) [[âHome]](../../micindex.html)  <å¬éï¼May.15,2017ãæçµæ´æ°ï¼Jan.31,2019>  MHSVI#20170515-02ï¼ UNLHA32.DLL ã«ãããä»»æã® DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§  ---    JPCERT/CC å ±åæ¥ ãMay.7,2017 JVN ä¸è¬åãå¬éæ¥ ãJan.31,2019 æ¦è¦ ãUNLHA32.DLL ã¯ï¼ LZHï¼ LZS å½¢å¼ã«å¯¾å¿ããå§ç¸®ã»å±éç­ã®æ¸åº«æä½ãè¡ãã©ã¤ãã©ãªã¼ã§ãã UNLHA32.DLL ã«ã¯ DLL ãèª­ã¿è¾¼ãéã®æ¤ç´¢ãã¹ã«åé¡ãããï¼ åä¸ãã£ã¬ã¯ããªã¼ã«å­å¨ããç¹å®ã® DLL ãèª­ã¿è¾¼ãã§ãã¾ãèå¼±æ§ ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)) ãå­å¨ãã¾ãã å½±é¿ãåããã¢ã¸ã¥ã¼ã«åã³ã·ã¹ãã  * UNLHA32.DLL Ver 2.67.1.2 åã³ããä»¥å* ä¸è¨ãå©ç¨ãã¦ããã¢ããªã±ã¼ã·ã§ã³ è©³ç´°æå ± ãUNLHA32.DLL ã¯ï¼ ãçµ±åã¢ã¼ã«ã¤ããã® API ä»æ§ã«æºæ ããï¼ LZHï¼ LZS å½¢å¼æ¸åº«ã«å¯¾ãã¦å§ç¸®ã»å±éã¨ãã£ãæä½ãè¡ãããã®ã©ã¤ãã©ãªã¼ã§ãã UNLHA32.DLL ã¯ä¸»ã«å§ç¸®ã»å±éãè¡ãã¢ã¼ã«ã¤ãã¼ã½ããã¦ã§ã¢ããå¼ã³åºãããå½¢ã§ä½¿ç¨ããã¾ããï¼ åä¸ãã£ã¬ã¯ããªã¼ã«å­å¨ããç¹å®ã® DLL ãèª­ã¿è¾¼ãã§ãã¾ãèå¼±æ§ãå«ã¾ãã¦ããï¼ ä»»æã®ã³ã¼ããå®è¡ããããï¼ ã¯ã©ãã·ã¥ãå¼ãèµ·ããããå¯è½æ§ãããã¾ãã æ³å®ãããå½±é¿ ãUNLHA32.DLL ãå©ç¨ãã¦ããã¢ããªã±ã¼ã·ã§ã³ã®åä½ç¶æ³ã«ããç°ãªãã¾ããï¼ å½è©²ã¢ããªã±ã¼ã·ã§ã³ãå®è¡ãã¦ããã¦ã¼ã¶ã¼ã®æ¨©éã§ä»»æã®ã³ã¼ããå®è¡ããããï¼ ãµã¼ãã¹éç¨å¦¨å®³ (DoS) æ»æãåããå¯è½æ§ãããã¾ãã å¯¾ç­æ¹æ³ ãææ°ç (Ver 3.00 ä»¥é) ã¸ãã¼ã¸ã§ã³ã¢ãããè¡ã£ã¦ãã ããã [[ãã¦ã³ã­ã¼ã](../../mysoft/unlha32.htm)] åé¿æ¹æ³  * UNLHA32.DLL ãå©ç¨ããã¢ããªã±ã¼ã·ã§ã³ã«ã¤ãã¦ "C:\Program Files" éä¸ãªã©ã®ä¿è­·ããããã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ããä¸ã§ï¼ UNLHA32.DLL ãã¢ããªã±ã¼ã·ã§ã³ã¨åããã£ã¬ã¯ããªã¼ãã·ã¹ãã ãã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ãã (éå¸ãã¡ã¤ã«ã«ããã¤ã³ã¹ãã¼ã«ãè¡ã£ãå ´åã¯ï¼ ã·ã¹ãã ãã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ããã¾ãã) ãã¨ã§ï¼ åé¿ãè¡ããã¨ãå¯è½ã§ãã ã¢ããªã±ã¼ã·ã§ã³å´ï¼ UNLHA32.DLL å´åæ¹ã®æ¡ä»¶ãæºããããªãã¨åé¿ã¯è¡ãã¾ããã   ãªãï¼ ãã®å¯¾ç­ã§è¡ããã®ã¯æ­£ç¢ºã«ã¯ãåé¡ã®è»½æ¸ãã§ããï¼ ããã¯å¸è²©ã½ãããªã©ãåæ§ã§ï¼ ãã®ç¶æ³ãåé¡è¦ããã®ã§ããã°ï¼ å¸è²©ã½ããã Windows ã®ã¢ã¯ã»ãµãªã¼ãå«ãå¤§å¤æ°ã®ãã­ã°ã©ã ãè©²å½ãããã¨ã«ãªãã¾ãã* ã¢ããªã±ã¼ã·ã§ã³å´ã§ UNLHA32.DLL ã®ä½¿ç¨æç¡ç­ãè¡ããå ´åã¯ï¼ UNLHA32.DLL ãä½¿ç¨ããªãï¼ å¥ã® DLL ãä»£æ¿æ¹æ³ãé¸æããï¼ ã¨ãã£ãè¨­å®ãè¡ããã¨ã§åé¿ãè¡ããã¨ãå¯è½ã§ãã* UNLHA32.DLL ã®éå¸èªå·±è§£åæ¸åº«ã«ã¤ãã¦ã¯ï¼ ãèªå·±è§£åæ¸åº«ãç½®ããã¦ãããã£ã¬ã¯ããªã¼ä¸ã«å½è©²æ¸åº«ä»¥å¤ä½ããã¡ã¤ã«ãå­å¨ãã¦ããªããã¨ãç¢ºèªããä¸ã§å®è¡ããããä½ããã®ã¢ã¼ã«ã¤ãã¼ãä½¿ç¨ãã¦èªå·±è§£åæ¸åº«ã«æ ¼ç´ããã¦ãããã¡ã¤ã«ãç´æ¥å±éããããè¡ããã¨ã§ï¼ åé¿ãè¡ããã¨ãå¯è½ã§ãã æè¡æå ± ãWindows ã«ããã¦ã¯ï¼ ã»ã¼å¨ã¦ã®ãã­ã°ã©ã ã "KERNEL32.DLL" ã "USER32.DLL" ã¨ãã£ãã·ã¹ãã ã©ã¤ãã©ãªã¼ã«å®è£ããã¦ãã Win32 API ãä½¿ç¨ãã¦ãã¾ãã DLL ã®å©ç¨ã«ã¤ãã¦ã¯ï¼ ãå­å¨ãããå¤ããªã DLLããå¿ãããå¿è¦ã¨ããªã DLLãã§ããã°ï¼ LoadLibrary() API ãä½¿ç¨ãã¦ DLL ã®ã­ã¼ããè¡ã£ãä¸ã§ä½¿ç¨ããã API ã®å¼ã³åºãåã GetProcAddress() ã§å¾ãâ¦ã¨ãã£ãæé ãè¸ããã¨ã«ãªãã¾ãã  ä¸æ¹ï¼ ãWin32 API ãä½¿ç¨ããããã« KERNEL32.DLL ã USER32.DLL ãã­ã¼ããã¨ãã£ãï¼ ãå¿ãä½¿ç¨ãã DLLããã·ã¹ãã ãã¡ã¤ã«ã¨ãã¦ Windows ã«å¿ãå«ã¾ãã¦ãã DLLããå©ç¨ããéã«ã¯ï¼ ä¾ãã° USER32.DLL ã§ããã° USER32.LIB ã¨ãã£ãï¼ ããããã® DLL ã«å¯¾å¿ããã¤ã³ãã¼ãã©ã¤ãã©ãªã¼ãä½¿ç¨ãããã¨ã«ããï¼ DLL ã®ã­ã¼ããå¼ã³åºãåã®åå¾ã¨ãã£ãæé ã Windows ã«ä»»ããâ¦ã¨ããææ³ãä¸è¬çã«æ¡ç¨ããã¾ãã ã¤ã³ãã¼ãã©ã¤ãã©ãªã¼ãä½¿ç¨ããå ´åï¼ ãã­ã°ã©ã ã®å®è¡ãã¡ã¤ã«åã«ãå½è©²ãã­ã°ã©ã ãä½¿ç¨ãã DLL ã¨ (ä¾ãã° Win32 API ãªã©ã®) å¼ã³åºãæ©è½ããä¸è¦§ãããã¤ã³ãã¼ããã¼ãã«â¦ã¤ã¾ãï¼ å¤é¨åç§ã®ä¸è¦§è¡¨ãä½æããã¾ãã  ãã¤ã³ãã¼ããã¼ãã«ãå«ã¾ãããã­ã°ã©ã ãèµ·åããã¨ï¼ å®éã«å½è©²ãã­ã°ã©ã ã¸å¶å¾¡ãæ¸¡ãåã®æ®µéã§ï¼ Windows ã®ã·ã¹ãã ã©ã¤ãã©ãªã¼ã§ãã NTDLL.DLL ã«å­å¨ããã¤ã¡ã¼ã¸ã­ã¼ãã¼ãï¼ ã¤ã³ãã¼ããã¼ãã«ä¸ã«ããå¤é¨åç§ã®æå ±ãèª­ã¿è¾¼ãã§ï¼ å¿è¦ãª DLL ã®ã­ã¼ãã¨æ©è½ã®å¼ã³åºãåã®åå¾ãè¡ãã¾ãã èª­ã¿è¾¼ãã  DLL ãã¤ã³ãã¼ããã¼ãã«ããã£ã¦ããã°åæ§ã®æé ãåå¸°çã«è¡ãã¾ãã ãããã®ä½æ¥­ã¯ï¼ å¨ã¦ã®å¤é¨åç§ãè§£æ±ºãããã¾ã§ç¹°ãè¿ããã¾ãã  ãã®éï¼ Windows ã¯å®ããããåªåé ä½ã«å¾ã£ã¦è¤æ°ã®ãã£ã¬ã¯ããªã¼ãæ¤ç´¢ãã¦ DLL ãèª­ã¿è¾¼ã¿ã¾ãã ä¾ãã° Safe DLL search mode ãæå¹ã®å ´åã¯æ¬¡ã®ããã«ãªãã¾ãï¼   1. UNLHA32.DLL ãå¼ã³åºãããã­ã°ã©ã ã®ç½®ããã¦ãããã£ã¬ã¯ããªã¼- ã¦ã¤ã³ãã¦ãºã»ã·ã¹ãã ãã£ã¬ã¯ããªã¼- 16 ãããç¨ã·ã¹ãã ãã£ã¬ã¯ããªã¼- ã¦ã¤ã³ãã¦ãºãã£ã¬ã¯ããªã¼- ã«ã¬ã³ããã£ã¬ã¯ããªã¼- ç°å¢å¤æ° PATH ã§æå®ãããåãã£ã¬ã¯ããªã¼   ãã®æã«ï¼ ãã­ã°ã©ã ã®ç½®ããã¦ãããã£ã¬ã¯ããªã¼ãæãåªåé ä½ã®é«ãæ¤ç´¢å¯¾è±¡ã¨ãªã£ã¦ããããï¼ ã·ã¹ãã  DLL ã¨åãååã®ç´°å·¥ãããæ»æç¨ DLL ããã­ã°ã©ã ã¨åããã£ã¬ã¯ããªã¼ã¸ç½®ããã¨ã§ï¼ åªåçã«æ»æç¨ DLL ãèª­ã¿è¾¼ã¾ãããã¨ãå¯è½ã¨ãªãã¾ãã  DLL ã®èª­ã¿è¾¼ã¿æã«ã¯å¿ãåæåãè¡ããããã¨ããï¼ åæåã«ã¼ãã³ã«ããã¦ãã­ã°ã©ã ã®å®è¡ã«ä½¿ç¨ããã¢ã«ã¦ã³ãããã¤æ¨©éã®ç¯å²ã§ä»»æã®ã³ã¼ããå®è¡ãããã¨ãå¯è½ã¨ãªãã¾ãã åæåã«ã¼ãã³ãå©ç¨ã§ãããã¨ããï¼ ç´°å·¥ãããæ»æç¨ DLL ãã·ã¹ãã  DLL ã®ä»æ§ãæºããã¦ããå¿è¦ã¯ããã¾ããã è£è¶³æå ± ãä»åã®èå¼±æ§ã¯ï¼ MHSVI#20100824ï¼ã[LHMelt ã«ãããå®å¨ã§ãªãã©ã¤ãã©ãªã¼ã®ã­ã¼ãã«ãããªã¢ã¼ãã§ã³ã¼ããå®è¡ãããèå¼±æ§](../2010/mhsvi20100824.htm)ãã¨åãèå¼±æ§ã§ã¯ããã¾ããï¼ ç½®ããã¦ããç¶æ³ã¯å¤§ããç°ãªãã¾ãã ä»åãå®å¨ã§ãªãã©ã¤ãã©ãªã¼ã®ã­ã¼ãããè¡ã£ã¦ããã®ã¯ Windows ã·ã¹ãã ã®ä¸é¨ã§ãã NTDLL.DLL (ä¸ã®ã¤ã¡ã¼ã¸ã­ã¼ãã¼) ã§ããï¼ ãããããã¯ãã¦ã¼ã¶ã¼ãèµ·åãããã¨ãããã­ã°ã©ã  (ï¼UNLHA32.DLL ãå¼ã³åºããã­ã°ã©ã ) è¥ããã¯ UNLHA32.DLL ã¸å¶å¾¡ãæ¸¡ãåãã«è¡ããã¦ãã¾ãã ã¤ã¾ãï¼ UNLHA32.DLL å´ã«ã¯éå¸¸ã®æ¹æ³ã§ã¯å¯¾å¦ã®ãããããªããã¨ã«ãªãã¾ãã  ãã®ç¹ã¯å¸è²©ã½ãããå··ã«æº¢ãã¦ãã Windows ãã­ã°ã©ã ãåãã§ï¼ è¨ã£ã¦ãã¾ãã°ãã»ã¼å¨ã¦ã®ãã­ã°ã©ã ããè©²å½ãã¦ãã¾ããã¨ã«ãªãã¾ãã ãå¸è²©ã½ãããªã©ä¸è¬çãªã¢ããªã±ã¼ã·ã§ã³ã§ã¯ï¼ æ¸ãè¾¼ã¿ã«ç®¡çèæ¨©éãå¿è¦ã¨ãã "C:\Program Files" ãã£ã¬ã¯ããªã¼éä¸ã¸ã¤ã³ã¹ãã¼ã«ãããã±ã¼ã¹ãå¤ãï¼ ãã®åå®å¨æ§ãè¥å¹²é«ã¾ã£ã¦ãããã«éãã¾ããã åå¯¾ã«ï¼ ã¤ã³ã¹ãã¼ã©ã¼ããã¼ã«ï¼ èªå·±è§£åæ¸åº«ã¨ãã£ããã­ã°ã©ã ã¯ãç½®ãå ´æ (å®è¡å ´æ) ãé¸ã°ãä½¿ããããã¨ããï¼ èå¼±æ§ã¨ãã¦åé¡ã«ãªã£ã¦ãããã¨ããã¾ãã ä¿®æ­£ç UNLHA32.DLL ã®éç ãä»åã®èå¼±æ§ã®ç´ ã¨ãªã£ã¦ãã NTDLL.DLL (ã¤ã¡ã¼ã¸ã­ã¼ãã¼) ã®ä»æ§ã§ããï¼ MSVCRT.DLL ã CTL3D.DLLï¼ CTL3DV2.DLL ã¨ãã£ã DLL ã«å§ã¾ãï¼ MFC32.DLL ãªã©ã® MFC ã©ã¤ãã©ãªã¼ã§å¤§åé¡ã¨ãªã£ã¦ãã¾ã£ãããã¼ã¸ã§ã³ãã«ãã®è»½æ¸ç­ã¨ãã¦ï¼ ããã­ã°ã©ã ã¨åããã£ã¬ã¯ããªã¼ã¸ DLL ãéç½®ãããã¨ã§ä½¿ç¨ DLL ããªã¼ãã¼ã©ã¤ããããã¨ããææ³ãå®çãã¦ãã¾ã£ããã¨ããï¼ ä»ã¨ãªã£ã¦ã¯ä»æ§å¤æ´ãè¡ããªãäºæã«é¥ã£ã¦ãã¾ã£ã¦ãã¾ãã ã¾ãï¼ éå»ã®ãããã¿ããï¼ æ¬æ¥è¡ãããã¹ãã(ã·ã¹ãã ã©ã¤ãã©ãªã¼ã«ã¤ãã¦) ã·ã¹ãã ãã£ã¬ã¯ããªã¼ä»¥å¤ããèª­ã¿è¾¼ã¾ãªãï¼ èª­ã¿è¾¼ããªãããã«ãããã¨ãã£ãä¿è­·ç­ã«ã¤ãã¦ãï¼ ä¸é¨ã®ã·ã¹ãã  DLL ã«ããè¬ãããã¦ãã¾ããã  ãã®è¾ºãã¯ MSDN ã§ãèª¬æããã¦ãã¦ï¼ ãããé¿ããããã«ç¨æããã¦ããã®ãï¼ SetDllDirectory() ã SetDefaultDllDirectories()ï¼ SetSearchPathMode()ï¼ LoadLibraryEx() (ã®è¿½å æ©è½) ã¨ãã£ã API ç¾¤ï¼ ããã¦ãªã³ã«ã¼ã¨ãã«ãã¼ã©ã¤ãã©ãªã¼ã«ãããDLL ã®éå»¶ã­ã¼ããã§ãã éå»¶ã­ã¼ãã¯ï¼ ã©ã³ã¿ã¤ã ã®ä¸é¨ã¨ãããããã«ãã¼ã©ã¤ãã©ãªã¼ããã­ã°ã©ã ã®èµ·åå¾ã« LoadLibrary() + GetProcAddress() ãè¡ãæ©è½ã§ï¼ åã«æ¸ããããã­ã°ã©ã å´ã LoadLibrary() + GetProcAddress() ãããã®ã¨æ¬è³ªçã«å¤ããããã¾ããã  ãããã§ï¼ UNLHA32.DLL å´ã§ãããã®æ©è½ãä½¿ã£ã¦èå¼±æ§ã®åé¿ãè¡ããã¨ã«ãªãããã§ããï¼ ããã«ã¯ä»¥ä¸ã®ãããªå¶éãä»ãã¾ã¨ãã¾ãï¼   * KERNEL32.DLL ã®éå»¶ã­ã¼ããè¡ããã¨ã¯åºæ¥ãªã (ãããèª­ã¿è¾¼ã¾ãã¦ããªãã¨ï¼ ãããã DLL ã®ã­ã¼ããè¡ããªãâ¦ã©ãããï¼ ã»ã¼ä½ãåºæ¥ãªãã)* SetDefaultDllDirectories() ãªã©ã®è¨­å®ã«å ããªãï¼ ç¬èªã«ã¼ã«ã®æ¤ç´¢ã¨èª­ã¿è¾¼ã¿ãè¡ããã DLL ã®å­å¨ã Windows 7 ã§ã® SSPICLI.DLL è¾ºããè©²å½ãï¼ ä¸æ»ãå ããå¯¾å¿ãè¡ããªãã¨ï¼ ç´ ç´ãªå¯¾ç­ã ãã§ã¯ãã¤ã¸ã£ãã¯ãæç«ãã¦ãã¾ãã éå»¶ã­ã¼ããªã©ã¯éã«ãã¤ã¸ã£ãã¯ã¸å¯ä¸ãããã¨ã«ãªãã®ã§æ³¨æã* èªèº« (UNLHA32.DLL) ãå¼ã³åºãå´ãã­ã°ã©ã ã«æ¥è§¦ãã¦ããä»ãã­ã°ã©ã  (IME ã (ã·ã¹ãã ãå«ã) ç£è¦ãã¼ã«ã»å¯¾ç­ã½ããã®é¡ã) ã®å­å¨ã ãè±ä»ç°å¢ (ã­ã¼ãã¼ã) ã ã¨å¤§ä¸å¤«ãªã®ã«æ¥æ¬èªç°å¢ã ã¨ãã¤ã¸ã£ãã¯ãæç«ããªã©ã¯ããã* ã·ã¹ãã ã«ããä¿è­·ããã¦ãã DLL ã¨ä¿è­·ããã¦ããªã DLL ã®ï¼ å¼ã³åºãç¶æ³ã«ããä¾å­é¢ä¿ã®å¤åã§çããå½±é¿ã ãå¯¾ç­æ¸ã¿ã¨ããã¦ããã½ããã BCRYPT.DLL è¾ºãã§è»¢ããããªã©ã¯ããã* UNLHA32.DLL ãå¼ã³åºããã­ã°ã©ã å´ (ä¾ãã° LHMelt) ã®å¯¾å¿ç¶æ³* ãå¼ã³åºãããå´ãã§ãã UNLHA32.DLL å´ã§ã¯ SetDefaultDllDirectories() ãä½¿ç¨ã§ããªã (å¼ã³åºãå´ãã­ã°ã©ã ã«å½±é¿ãä¸ãã¦ãã¾ãï¼ ææªãã­ã°ã©ã ãèµ·åã§ããªããªãâ¦ã©ãããï¼ Windows 8/8.1 ã§ã¯ NTDLL.DLL ãä¸è¬ä¿è­·ã¨ã©ã¼ãèµ·ããã)   çµæï¼ ä¿®æ­£çã® UNLHA32.DLL ã«ã¯ä»¥ä¸ã®ãããªéçãå­å¨ãã¾ãã   * Windows 10 ã Windows 8/8.1 ã«ã¤ãã¦ã¯ç¾ç¶åé¿ã§ãã¦ãããã®ã®ï¼ OS ã®ã¢ããã°ã¬ã¼ããä¿®æ­£ãããã®é©ç¨ï¼ å¯¾ç­ã½ããã®å¤æ´ã¨ãã£ãç°å¢ã®å¤åã«ãã DLL ã®ä¾å­é¢ä¿ãå¤åãããã¨ã§ï¼ å¯¾å¿ã§ããªããªãå¯è½æ§ãããã* Windows 7 ã«ã¤ãã¦ã¯ï¼ å°ãªãã¨ã SSPICLI.DLL ã«ã¤ãã¦ç¬èªã«ã¼ã«ã®æ¤ç´¢ã¨èª­ã¿è¾¼ã¿ãè¡ããã¦ãããã¨ããï¼ è¿½å ã®å¯¾ç­ãå¿è¦ã¨ãªã (å¯¾å¿æ¸ã¿ã§ã¯ãããã®ã®ï¼ å±éºæ§ãé«ãã¨ãããã)* Windows Vista ã«ã¤ãã¦ã¯ï¼ KERNEL32.DLL ã NTDLL.DLL ã«ããèª­ã¿è¾¼ã¾ããæç¹ã§ APPHELP.DLL ã«å¯¾ãã DLL ãã¤ã¸ã£ãã¯ãæç«ãã¦ãã¾ããã¨ããï¼ å®å¨ãªå¯¾å¿ã¯ä¸å¯è½ã       ãªãï¼ APPHELP.DLL ã«éã£ã¦è¨ãã°ï¼ åã«ååã® DLL ãä½æããç¨åº¦ã§ã¯ï¼ åæåã«ã¼ãã³ãå«ãã¦å®éã«ã³ã¼ããå®è¡ããããã¨ã¯ãªãã ãã ãï¼ DLL ã®ã­ã¼ããè©¦ã¿ãããããï¼ å®è¡ãã¡ã¤ã«ä»¥å¤ã®å½¢å¼ãä½¿ãããå ´åï¼ ã·ã¹ãã ã«ãããââã¯ Windows ä¸ã§ã¯å®è¡ã§ããªãããã¨ã©ã¼ãå«ãã§ãã¾ãããã®è­¦åãè¡¨ç¤ºãããã ã©ã¡ãã®å ´åãï¼ å®éã«ã­ã¼ããããã®ã¯ã·ã¹ãã ãã£ã¬ã¯ããªã¼ä¸ã®æ­£è¦ç APPHELP.DLL ã¨ãªãã* Windows XP ä»¥åã«ã¤ãã¦ã¯ã·ã¹ãã ã«ä¿è­·æ©è½ãåãã£ã¦ããï¼ å¤æ°ã® DLL ã Vista ã§ã® APPHELP.DLL ã¨åãç¶æ³ã«é¥ã£ã¦ãããã¨ããï¼ å¯¾å¿èªä½ãä¸å¯è½ã* Windows 7/Vista ã«ã¤ãã¦ã¯ï¼ [KB2533623](https://support.microsoft.com/ja-jp/help/2533623/microsoft-security-advisory-insecure-library-loading-could-allow-remote-code-execution) ã®æ´æ°ãã­ã°ã©ã ãé©ç¨ãã¦ãããã¨ãåæã ãããé©ç¨ããã¦ããªãã¨ SetDefaultDllDirectories() API ãªã©ãä½¿ããªããã¨ããï¼ æ ¹æ¬çã«å¯¾å¿ãç ´ç¶»ããã* ãããã UNLHA32.DLL ãå¼ã³åºãå´ã®ãã­ã°ã©ã  (ä¾ãã° LHMelt) ã ãã®èå¼±æ§ã«å¯¾å¿ãã¦ããªãã¨ï¼ UNLHA32.DLL å´ã§ã®å¯¾å¿ãç¡æå³ã¨ãªã£ã¦ãã¾ãã ä¸è¿°ã®ãåé¿æ¹æ³ãã®å¯¾ç­ãè¬ãããã¦ããã®ã§ããã°ï¼ å±éºæ§ã¯å¸è²©ã½ããç­ã¨åãã   Windows XP ä»¥åã® OS ã¯ã¨ãããï¼ Windows 7 ã Vista ã«ã¤ãã¦ã¯ï¼ å¯è½ã§ããã°ãã·ã¹ãã ãã£ã¬ã¯ããªã¼ (è¥ããã¯æ­£è¦ãªãã®ã¨å¤æãã¦ãã DLL ãç½®ããã¦ãããã£ã¬ã¯ããªã¼) ä»¥å¤ã«å­å¨ãã SSPICLI.DLL ã APPHELP.DLL ã«ã¤ãã¦ï¼ å®è¡ãã¢ã¯ã»ã¹ãæå¦ããè¨­å®ãè¡ãããã¨ã§ï¼ å±éºæ§ã®è»½æ¸ãå³ããã¨ãå¯è½ã§ãã æ´æ°å±¥æ­´  * èå¼±æ§æå ±ã®å¬éã[May.15,2017]* åèæå ±ã« JVN ã®æå ± (JVNTA#91240916) ãè¿½å ã[May.25,2017]* ãä¿®æ­£ç UNLHA32.DLL ã®éçãã®é ç®ã«ã¤ãã¦ï¼ Windows Vista ã§ã® APPHELP.DLL ã«é¢ããåé¡ã®æå ±ãæ´æ°ãã[Aug.19,2017]* åèæå ±ã«ãWindows ã¢ããªã±ã¼ã·ã§ã³ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§ã«ã¤ãã¦ã(MHVI#20170718) ã®æå ±ãè¿½å ã[Aug.23,2017]* åèæå ±ã« IPA ã®æå ±ããæ³¨æåèµ·ãWindowsã¢ããªã±ã¼ã·ã§ã³ã®å©ç¨ã«ãããæ³¨æããè¿½å ã[Sep.30,2017]* JVN ã§ã®æå ±å¬éã«ä¼´ãæå ±ãè¿½å ã[Jan.31,2019] åèæå ±  * MHSVI#20170515-01ï¼[UNLHA32.DLL ã§ä½æãããèªå·±è§£åæ¸åº«ã«ãããä»»æã® DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](mhsvi20170515_01.htm) (UNLHA32.DLL ã®éå¸èªå·±è§£åæ¸åº«ãå«ãã)* MHVI#20170718ï¼[Windows ã¢ããªã±ã¼ã·ã§ã³ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§ã«ã¤ãã¦](mhvi20170718.htm)* ä»æ¥ã®åºæ¥äº (May, 2018)ï¼[LHMelt ç­ã§ã® DLL ãã¤ã¸ã£ãã¯å¯¾ç­è¦ãæ¸ã](../../incidents/2018/inci1805.htm#i20180528)* CVE ï¼ [CVE-2018-16189](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16189)* CVE ï¼ [CVE-2018-16190](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16190)* CVE ï¼ [CVE-2019-5911](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5911)* JVN ï¼ [JVN#52168232ãUNLHA32.DLLãUNARJ32.DLLãLHMelting ããã³ LMLzh32.DLL ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/jp/JVN%2352168232/index.html)* JVN ï¼ [JVN#83826673ãUNLHA32.DLLãUNARJ32.DLL ããã³ LHMelting ã®ã¤ã³ã¹ãã¼ã©ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/jp/JVN%2383826673/index.html)* JVN ï¼ [JVNTA#91240916ãWindows ã¢ããªã±ã¼ã·ã§ã³ã«ãã DLL èª­ã¿è¾¼ã¿ãã³ãã³ãå®è¡ã«é¢ããåé¡](http://jvn.jp/ta/JVNTA91240916/index.html)* JVN ï¼ [JVNTA10-238AãMicrosoft Windows ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/cert/JVNTA10-238A/index.html)* JVN ï¼ [JVNVU#707943ãWindows ãã­ã°ã©ã ã® DLL èª­ã¿è¾¼ã¿ã«èå¼±æ§](http://jvn.jp/cert/JVNVU707943/index.html)* JVN iPedia ï¼ [JVNDB-2019-000004](https://jvndb.jvn.jp/ja/contents/2019/JVNDB-2019-000004.html)* JVN iPedia ï¼ [JVNDB-2019-000005](https://jvndb.jvn.jp/ja/contents/2019/JVNDB-2019-000005.html)* IPA ï¼ [ãæ³¨æåèµ·ãWindowsã¢ããªã±ã¼ã·ã§ã³ã®å©ç¨ã«ãããæ³¨æ](http://www.ipa.go.jp/security/ciadr/vul/20170928_dll.html)* ãã¤ã¯ã­ã½ãã ã»ã­ã¥ãªãã£ ã¢ããã¤ã¶ãª ï¼ [2269637ãå®å¨ã§ãªãã©ã¤ãã©ãªã®ã­ã¼ãã«ããããªã¢ã¼ãã§ã³ã¼ããå®è¡ããã](https://docs.microsoft.com/ja-jp/security-updates/securityadvisories/2010/2269637)* MSDN Library ï¼ [Dynamic-Link Library Security](http://msdn.microsoft.com/en-us/library/ff919712%28VS.85%29.aspx)* Microsoft ï¼ [KB2389418ãSecure loading of libraries to prevent DLL preloading attacks](http://support.microsoft.com/en-us/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks)   | [[âPage top]](mhsvi20170515_02.htm) | [[âãèå¼±æ§æå ±ä¸è¦§ã]](../index.htm) [[âHome]](../../micindex.html) | | --- | --- | |



=== Content from micco.mars.jp_c4a4c885_20250125_000135.html ===


| | ### Micco's Home Page ### | Welcome to Micco's page!! Sorry, but this web page is written in Japanese. <[English](../../english/index_e.htm)> | | --- | --- | | |
| --- | --- | --- | --- |
| | | â  **[æ´æ°æå ±](../../micindex.html)** | | --- | | â  **[ãã®Webãã¼ã¸ã«ã¤ãã¦](../../notes/note.htm)** | | â  **[ãç¥ãã](../../notes/ann.htm)** | | â  **ãã¦ã³ã­ã¼ã**  | â  [UNLHA32.DLL](../../mysoft/unlha32.htm) | | --- | | â  [UNARJ32.DLL](../../mysoft/unarj32.htm) | | â  [DMZIP32.DLL](../../mysoft/dmzip.htm) | | â  [LHMelt](../../mysoft/lhmelt.htm) | | â  [Win16 ãã­ã°ã©ã](../../mysoft/win16.htm) | | | â  **[DLL ã®ã¤ã³ã¹ãã¼ã«æ¹æ³](../../exp/install.htm)** | | â  **[SFX ã®è¨­å®ä¾](../../exp/sfxsample.htm)** | | â  **[ãããã](../../extra/extra.htm)** |  **[ç·åæå ±ã¯ãã¡ã](http://www.csdinc.co.jp/archiver/index.html)** [[çµ±åã¢ã¼ã«ã¤ã]](http://www.csdinc.co.jp/archiver/index.html) | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | å¯¾å¿ãã©ã¦ã¶ã¼  [[Internet Explorer]](https://www.microsoft.com/ja-jp/download/internet-explorer.aspx) [[Firefox]](http://mozilla.jp/) [[Opera]](http://www.opera.com/) [[Sleipnir]](http://www.fenrir.co.jp/sleipnir/) [[Safari]](http://www.apple.com/jp/safari/) [[Google Chrome]](http://www.google.com/chrome/?hl=ja) | | é£çµ¡åï¼Micco [e-mail] | | [[âãèå¼±æ§æå ±ä¸è¦§ã]](../index.htm) [[âHome]](../../micindex.html)  <å¬éï¼May.15,2017ãæçµæ´æ°ï¼Jan.31,2019>  MHSVI#20170515-03ï¼ UNARJ32.DLL ã«ãããä»»æã® DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§  ---    JPCERT/CC å ±åæ¥ ãMay.7,2017 JVN ä¸è¬åãå¬éæ¥ ãJan.31,2019 æ¦è¦ ãUNARJ32.DLL ã¯ï¼ ARJ å½¢å¼ã«å¯¾å¿ããå±éç­ã®æ¸åº«æä½ãè¡ãã©ã¤ãã©ãªã¼ã§ãã UNARJ32.DLL ã«ã¯ DLL ãèª­ã¿è¾¼ãéã®æ¤ç´¢ãã¹ã«åé¡ãããï¼ åä¸ãã£ã¬ã¯ããªã¼ã«å­å¨ããç¹å®ã® DLL ãèª­ã¿è¾¼ãã§ãã¾ãèå¼±æ§ ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)) ãå­å¨ãã¾ãã å½±é¿ãåããã¢ã¸ã¥ã¼ã«åã³ã·ã¹ãã  * UNARJ32.DLL Ver 1.10.1.25 åã³ããä»¥å* ä¸è¨ãå©ç¨ãã¦ããã¢ããªã±ã¼ã·ã§ã³ è©³ç´°æå ± ãUNARJ32.DLL ã¯ï¼ ãçµ±åã¢ã¼ã«ã¤ããã® API ä»æ§ã«æºæ ããï¼ ARJ å½¢å¼æ¸åº«ã«å¯¾ãã¦å±éãªã©ã®æä½ãè¡ãããã®ã©ã¤ãã©ãªã¼ã§ãã UNARJ32.DLL ã¯ä¸»ã«å§ç¸®ã»å±éãè¡ãã¢ã¼ã«ã¤ãã¼ã½ããã¦ã§ã¢ããå¼ã³åºãããå½¢ã§ä½¿ç¨ããã¾ããï¼ åä¸ãã£ã¬ã¯ããªã¼ã«å­å¨ããç¹å®ã® DLL ãèª­ã¿è¾¼ãã§ãã¾ãèå¼±æ§ãå«ã¾ãã¦ããï¼ ä»»æã®ã³ã¼ããå®è¡ããããï¼ ã¯ã©ãã·ã¥ãå¼ãèµ·ããããå¯è½æ§ãããã¾ãã æ³å®ãããå½±é¿ ãUNARJ32.DLL ãå©ç¨ãã¦ããã¢ããªã±ã¼ã·ã§ã³ã®åä½ç¶æ³ã«ããç°ãªãã¾ããï¼ å½è©²ã¢ããªã±ã¼ã·ã§ã³ãå®è¡ãã¦ããã¦ã¼ã¶ã¼ã®æ¨©éã§ä»»æã®ã³ã¼ããå®è¡ããããï¼ ãµã¼ãã¹éç¨å¦¨å®³ (DoS) æ»æãåããå¯è½æ§ãããã¾ãã å¯¾ç­æ¹æ³ ãææ°ç (Ver 2.00 ä»¥é) ã¸ãã¼ã¸ã§ã³ã¢ãããè¡ã£ã¦ãã ããã [[ãã¦ã³ã­ã¼ã](../../mysoft/unarj32.htm)] åé¿æ¹æ³  * UNARJ32.DLL ãå©ç¨ããã¢ããªã±ã¼ã·ã§ã³ã«ã¤ãã¦ "C:\Program Files" éä¸ãªã©ã®ä¿è­·ããããã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ããä¸ã§ï¼ UNARJ32.DLL ãã¢ããªã±ã¼ã·ã§ã³ã¨åããã£ã¬ã¯ããªã¼ãã·ã¹ãã ãã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ãã (éå¸ãã¡ã¤ã«ã«ããã¤ã³ã¹ãã¼ã«ãè¡ã£ãå ´åã¯ï¼ ã·ã¹ãã ãã£ã¬ã¯ããªã¼ã«ã¤ã³ã¹ãã¼ã«ããã¾ãã) ãã¨ã§ï¼ åé¿ãè¡ããã¨ãå¯è½ã§ãã ã¢ããªã±ã¼ã·ã§ã³å´ï¼ UNARJ32.DLL å´åæ¹ã®æ¡ä»¶ãæºããããªãã¨åé¿ã¯è¡ãã¾ããã   ãªãï¼ ãã®å¯¾ç­ã§è¡ããã®ã¯æ­£ç¢ºã«ã¯ãåé¡ã®è»½æ¸ãã§ããï¼ ããã¯å¸è²©ã½ãããªã©ãåæ§ã§ï¼ ãã®ç¶æ³ãåé¡è¦ããã®ã§ããã°ï¼ å¸è²©ã½ããã Windows ã®ã¢ã¯ã»ãµãªã¼ãå«ãå¤§å¤æ°ã®ãã­ã°ã©ã ãè©²å½ãããã¨ã«ãªãã¾ãã* ã¢ããªã±ã¼ã·ã§ã³å´ã§ UNARJ32.DLL ã®ä½¿ç¨æç¡ç­ãè¡ããå ´åã¯ï¼ UNARJ32.DLL ãä½¿ç¨ããªãï¼ å¥ã® DLL ãä»£æ¿æ¹æ³ãé¸æããï¼ ã¨ãã£ãè¨­å®ãè¡ããã¨ã§åé¿ãè¡ããã¨ãå¯è½ã§ãã* UNARJ32.DLL ã®éå¸èªå·±è§£åæ¸åº«ã«ã¤ãã¦ã¯ï¼ ãèªå·±è§£åæ¸åº«ãç½®ããã¦ãããã£ã¬ã¯ããªã¼ä¸ã«å½è©²æ¸åº«ä»¥å¤ä½ããã¡ã¤ã«ãå­å¨ãã¦ããªããã¨ãç¢ºèªããä¸ã§å®è¡ããããä½ããã®ã¢ã¼ã«ã¤ãã¼ãä½¿ç¨ãã¦èªå·±è§£åæ¸åº«ã«æ ¼ç´ããã¦ãããã¡ã¤ã«ãç´æ¥å±éããããè¡ããã¨ã§ï¼ åé¿ãè¡ããã¨ãå¯è½ã§ãã æè¡æå ± ãWindows ã«ããã¦ã¯ï¼ ã»ã¼å¨ã¦ã®ãã­ã°ã©ã ã "KERNEL32.DLL" ã "USER32.DLL" ã¨ãã£ãã·ã¹ãã ã©ã¤ãã©ãªã¼ã«å®è£ããã¦ãã Win32 API ãä½¿ç¨ãã¦ãã¾ãã DLL ã®å©ç¨ã«ã¤ãã¦ã¯ï¼ ãå­å¨ãããå¤ããªã DLLããå¿ãããå¿è¦ã¨ããªã DLLãã§ããã°ï¼ LoadLibrary() API ãä½¿ç¨ãã¦ DLL ã®ã­ã¼ããè¡ã£ãä¸ã§ä½¿ç¨ããã API ã®å¼ã³åºãåã GetProcAddress() ã§å¾ãâ¦ã¨ãã£ãæé ãè¸ããã¨ã«ãªãã¾ãã  ä¸æ¹ï¼ ãWin32 API ãä½¿ç¨ããããã« KERNEL32.DLL ã USER32.DLL ãã­ã¼ããã¨ãã£ãï¼ ãå¿ãä½¿ç¨ãã DLLããã·ã¹ãã ãã¡ã¤ã«ã¨ãã¦ Windows ã«å¿ãå«ã¾ãã¦ãã DLLããå©ç¨ããéã«ã¯ï¼ ä¾ãã° USER32.DLL ã§ããã° USER32.LIB ã¨ãã£ãï¼ ããããã® DLL ã«å¯¾å¿ããã¤ã³ãã¼ãã©ã¤ãã©ãªã¼ãä½¿ç¨ãããã¨ã«ããï¼ DLL ã®ã­ã¼ããå¼ã³åºãåã®åå¾ã¨ãã£ãæé ã Windows ã«ä»»ããâ¦ã¨ããææ³ãä¸è¬çã«æ¡ç¨ããã¾ãã ã¤ã³ãã¼ãã©ã¤ãã©ãªã¼ãä½¿ç¨ããå ´åï¼ ãã­ã°ã©ã ã®å®è¡ãã¡ã¤ã«åã«ãå½è©²ãã­ã°ã©ã ãä½¿ç¨ãã DLL ã¨ (ä¾ãã° Win32 API ãªã©ã®) å¼ã³åºãæ©è½ããä¸è¦§ãããã¤ã³ãã¼ããã¼ãã«â¦ã¤ã¾ãï¼ å¤é¨åç§ã®ä¸è¦§è¡¨ãä½æããã¾ãã  ãã¤ã³ãã¼ããã¼ãã«ãå«ã¾ãããã­ã°ã©ã ãèµ·åããã¨ï¼ å®éã«å½è©²ãã­ã°ã©ã ã¸å¶å¾¡ãæ¸¡ãåã®æ®µéã§ï¼ Windows ã®ã·ã¹ãã ã©ã¤ãã©ãªã¼ã§ãã NTDLL.DLL ã«å­å¨ããã¤ã¡ã¼ã¸ã­ã¼ãã¼ãï¼ ã¤ã³ãã¼ããã¼ãã«ä¸ã«ããå¤é¨åç§ã®æå ±ãèª­ã¿è¾¼ãã§ï¼ å¿è¦ãª DLL ã®ã­ã¼ãã¨æ©è½ã®å¼ã³åºãåã®åå¾ãè¡ãã¾ãã èª­ã¿è¾¼ãã  DLL ãã¤ã³ãã¼ããã¼ãã«ããã£ã¦ããã°åæ§ã®æé ãåå¸°çã«è¡ãã¾ãã ãããã®ä½æ¥­ã¯ï¼ å¨ã¦ã®å¤é¨åç§ãè§£æ±ºãããã¾ã§ç¹°ãè¿ããã¾ãã  ãã®éï¼ Windows ã¯å®ããããåªåé ä½ã«å¾ã£ã¦è¤æ°ã®ãã£ã¬ã¯ããªã¼ãæ¤ç´¢ãã¦ DLL ãèª­ã¿è¾¼ã¿ã¾ãã ä¾ãã° Safe DLL search mode ãæå¹ã®å ´åã¯æ¬¡ã®ããã«ãªãã¾ãï¼   1. UNARJ32.DLL ãå¼ã³åºãããã­ã°ã©ã ã®ç½®ããã¦ãããã£ã¬ã¯ããªã¼- ã¦ã¤ã³ãã¦ãºã»ã·ã¹ãã ãã£ã¬ã¯ããªã¼- 16 ãããç¨ã·ã¹ãã ãã£ã¬ã¯ããªã¼- ã¦ã¤ã³ãã¦ãºãã£ã¬ã¯ããªã¼- ã«ã¬ã³ããã£ã¬ã¯ããªã¼- ç°å¢å¤æ° PATH ã§æå®ãããåãã£ã¬ã¯ããªã¼   ãã®æã«ï¼ ãã­ã°ã©ã ã®ç½®ããã¦ãããã£ã¬ã¯ããªã¼ãæãåªåé ä½ã®é«ãæ¤ç´¢å¯¾è±¡ã¨ãªã£ã¦ããããï¼ ã·ã¹ãã  DLL ã¨åãååã®ç´°å·¥ãããæ»æç¨ DLL ããã­ã°ã©ã ã¨åããã£ã¬ã¯ããªã¼ã¸ç½®ããã¨ã§ï¼ åªåçã«æ»æç¨ DLL ãèª­ã¿è¾¼ã¾ãããã¨ãå¯è½ã¨ãªãã¾ãã  DLL ã®èª­ã¿è¾¼ã¿æã«ã¯å¿ãåæåãè¡ããããã¨ããï¼ åæåã«ã¼ãã³ã«ããã¦ãã­ã°ã©ã ã®å®è¡ã«ä½¿ç¨ããã¢ã«ã¦ã³ãããã¤æ¨©éã®ç¯å²ã§ä»»æã®ã³ã¼ããå®è¡ãããã¨ãå¯è½ã¨ãªãã¾ãã åæåã«ã¼ãã³ãå©ç¨ã§ãããã¨ããï¼ ç´°å·¥ãããæ»æç¨ DLL ãã·ã¹ãã  DLL ã®ä»æ§ãæºããã¦ããå¿è¦ã¯ããã¾ããã è£è¶³æå ± ãä»åã®èå¼±æ§ã¯ï¼ MHSVI#20100824ï¼ã[LHMelt ã«ãããå®å¨ã§ãªãã©ã¤ãã©ãªã¼ã®ã­ã¼ãã«ãããªã¢ã¼ãã§ã³ã¼ããå®è¡ãããèå¼±æ§](../2010/mhsvi20100824.htm)ãã¨åãèå¼±æ§ã§ã¯ããã¾ããï¼ ç½®ããã¦ããç¶æ³ã¯å¤§ããç°ãªãã¾ãã ä»åãå®å¨ã§ãªãã©ã¤ãã©ãªã¼ã®ã­ã¼ãããè¡ã£ã¦ããã®ã¯ Windows ã·ã¹ãã ã®ä¸é¨ã§ãã NTDLL.DLL (ä¸ã®ã¤ã¡ã¼ã¸ã­ã¼ãã¼) ã§ããï¼ ãããããã¯ãã¦ã¼ã¶ã¼ãèµ·åãããã¨ãããã­ã°ã©ã  (ï¼UNARJ32.DLL ãå¼ã³åºããã­ã°ã©ã ) è¥ããã¯ UNARJ32.DLL ã¸å¶å¾¡ãæ¸¡ãåãã«è¡ããã¦ãã¾ãã ã¤ã¾ãï¼ UNARJ32.DLL å´ã«ã¯éå¸¸ã®æ¹æ³ã§ã¯å¯¾å¦ã®ãããããªããã¨ã«ãªãã¾ãã  ãã®ç¹ã¯å¸è²©ã½ãããå··ã«æº¢ãã¦ãã Windows ãã­ã°ã©ã ãåãã§ï¼ è¨ã£ã¦ãã¾ãã°ãã»ã¼å¨ã¦ã®ãã­ã°ã©ã ããè©²å½ãã¦ãã¾ããã¨ã«ãªãã¾ãã ãå¸è²©ã½ãããªã©ä¸è¬çãªã¢ããªã±ã¼ã·ã§ã³ã§ã¯ï¼ æ¸ãè¾¼ã¿ã«ç®¡çèæ¨©éãå¿è¦ã¨ãã "C:\Program Files" ãã£ã¬ã¯ããªã¼éä¸ã¸ã¤ã³ã¹ãã¼ã«ãããã±ã¼ã¹ãå¤ãï¼ ãã®åå®å¨æ§ãè¥å¹²é«ã¾ã£ã¦ãããã«éãã¾ããã åå¯¾ã«ï¼ ã¤ã³ã¹ãã¼ã©ã¼ããã¼ã«ï¼ èªå·±è§£åæ¸åº«ã¨ãã£ããã­ã°ã©ã ã¯ãç½®ãå ´æ (å®è¡å ´æ) ãé¸ã°ãä½¿ããããã¨ããï¼ èå¼±æ§ã¨ãã¦åé¡ã«ãªã£ã¦ãããã¨ããã¾ãã ä¿®æ­£ç UNARJ32.DLL ã®éç ãä»åã®èå¼±æ§ã®ç´ ã¨ãªã£ã¦ãã NTDLL.DLL (ã¤ã¡ã¼ã¸ã­ã¼ãã¼) ã®ä»æ§ã§ããï¼ MSVCRT.DLL ã CTL3D.DLLï¼ CTL3DV2.DLL ã¨ãã£ã DLL ã«å§ã¾ãï¼ MFC32.DLL ãªã©ã® MFC ã©ã¤ãã©ãªã¼ã§å¤§åé¡ã¨ãªã£ã¦ãã¾ã£ãããã¼ã¸ã§ã³ãã«ãã®è»½æ¸ç­ã¨ãã¦ï¼ ããã­ã°ã©ã ã¨åããã£ã¬ã¯ããªã¼ã¸ DLL ãéç½®ãããã¨ã§ä½¿ç¨ DLL ããªã¼ãã¼ã©ã¤ããããã¨ããææ³ãå®çãã¦ãã¾ã£ããã¨ããï¼ ä»ã¨ãªã£ã¦ã¯ä»æ§å¤æ´ãè¡ããªãäºæã«é¥ã£ã¦ãã¾ã£ã¦ãã¾ãã ã¾ãï¼ éå»ã®ãããã¿ããï¼ æ¬æ¥è¡ãããã¹ãã(ã·ã¹ãã ã©ã¤ãã©ãªã¼ã«ã¤ãã¦) ã·ã¹ãã ãã£ã¬ã¯ããªã¼ä»¥å¤ããèª­ã¿è¾¼ã¾ãªãï¼ èª­ã¿è¾¼ããªãããã«ãããã¨ãã£ãä¿è­·ç­ã«ã¤ãã¦ãï¼ ä¸é¨ã®ã·ã¹ãã  DLL ã«ããè¬ãããã¦ãã¾ããã  ãã®è¾ºãã¯ MSDN ã§ãèª¬æããã¦ãã¦ï¼ ãããé¿ããããã«ç¨æããã¦ããã®ãï¼ SetDllDirectory() ã SetDefaultDllDirectories()ï¼ SetSearchPathMode()ï¼ LoadLibraryEx() (ã®è¿½å æ©è½) ã¨ãã£ã API ç¾¤ï¼ ããã¦ãªã³ã«ã¼ã¨ãã«ãã¼ã©ã¤ãã©ãªã¼ã«ãããDLL ã®éå»¶ã­ã¼ããã§ãã éå»¶ã­ã¼ãã¯ï¼ ã©ã³ã¿ã¤ã ã®ä¸é¨ã¨ãããããã«ãã¼ã©ã¤ãã©ãªã¼ããã­ã°ã©ã ã®èµ·åå¾ã« LoadLibrary() + GetProcAddress() ãè¡ãæ©è½ã§ï¼ åã«æ¸ããããã­ã°ã©ã å´ã LoadLibrary() + GetProcAddress() ãããã®ã¨æ¬è³ªçã«å¤ããããã¾ããã  ãããã§ï¼ UNARJ32.DLL å´ã§ãããã®æ©è½ãä½¿ã£ã¦èå¼±æ§ã®åé¿ãè¡ããã¨ã«ãªãããã§ããï¼ ããã«ã¯ä»¥ä¸ã®ãããªå¶éãä»ãã¾ã¨ãã¾ãï¼   * KERNEL32.DLL ã®éå»¶ã­ã¼ããè¡ããã¨ã¯åºæ¥ãªã (ãããèª­ã¿è¾¼ã¾ãã¦ããªãã¨ï¼ ãããã DLL ã®ã­ã¼ããè¡ããªãâ¦ã©ãããï¼ ã»ã¼ä½ãåºæ¥ãªãã)* SetDefaultDllDirectories() ãªã©ã®è¨­å®ã«å ããªãï¼ ç¬èªã«ã¼ã«ã®æ¤ç´¢ã¨èª­ã¿è¾¼ã¿ãè¡ããã DLL ã®å­å¨ã Windows 7 ã§ã® SSPICLI.DLL è¾ºããè©²å½ãï¼ ä¸æ»ãå ããå¯¾å¿ãè¡ããªãã¨ï¼ ç´ ç´ãªå¯¾ç­ã ãã§ã¯ãã¤ã¸ã£ãã¯ãæç«ãã¦ãã¾ãã éå»¶ã­ã¼ããªã©ã¯éã«ãã¤ã¸ã£ãã¯ã¸å¯ä¸ãããã¨ã«ãªãã®ã§æ³¨æã* èªèº« (UNARJ32.DLL) ãå¼ã³åºãå´ãã­ã°ã©ã ã«æ¥è§¦ãã¦ããä»ãã­ã°ã©ã  (IME ã (ã·ã¹ãã ãå«ã) ç£è¦ãã¼ã«ã»å¯¾ç­ã½ããã®é¡ã) ã®å­å¨ã ãè±ä»ç°å¢ (ã­ã¼ãã¼ã) ã ã¨å¤§ä¸å¤«ãªã®ã«æ¥æ¬èªç°å¢ã ã¨ãã¤ã¸ã£ãã¯ãæç«ããªã©ã¯ããã* ã·ã¹ãã ã«ããä¿è­·ããã¦ãã DLL ã¨ä¿è­·ããã¦ããªã DLL ã®ï¼ å¼ã³åºãç¶æ³ã«ããä¾å­é¢ä¿ã®å¤åã§çããå½±é¿ã ãå¯¾ç­æ¸ã¿ã¨ããã¦ããã½ããã BCRYPT.DLL è¾ºãã§è»¢ããããªã©ã¯ããã* UNARJ32.DLL ãå¼ã³åºããã­ã°ã©ã å´ (ä¾ãã° LHMelt) ã®å¯¾å¿ç¶æ³* ãå¼ã³åºãããå´ãã§ãã UNARJ32.DLL å´ã§ã¯ SetDefaultDllDirectories() ãä½¿ç¨ã§ããªã (å¼ã³åºãå´ãã­ã°ã©ã ã«å½±é¿ãä¸ãã¦ãã¾ãï¼ ææªãã­ã°ã©ã ãèµ·åã§ããªããªãâ¦ã©ãããï¼ Windows 8/8.1 ã§ã¯ NTDLL.DLL ãä¸è¬ä¿è­·ã¨ã©ã¼ãèµ·ããã)   çµæï¼ ä¿®æ­£çã® UNARJ32.DLL ã«ã¯ä»¥ä¸ã®ãããªéçãå­å¨ãã¾ãã   * Windows 10 ã Windows 8/8.1 ã«ã¤ãã¦ã¯ç¾ç¶åé¿ã§ãã¦ãããã®ã®ï¼ OS ã®ã¢ããã°ã¬ã¼ããä¿®æ­£ãããã®é©ç¨ï¼ å¯¾ç­ã½ããã®å¤æ´ã¨ãã£ãç°å¢ã®å¤åã«ãã DLL ã®ä¾å­é¢ä¿ãå¤åãããã¨ã§ï¼ å¯¾å¿ã§ããªããªãå¯è½æ§ãããã* Windows 7 ã«ã¤ãã¦ã¯ï¼ å°ãªãã¨ã SSPICLI.DLL ã«ã¤ãã¦ç¬èªã«ã¼ã«ã®æ¤ç´¢ã¨èª­ã¿è¾¼ã¿ãè¡ããã¦ãããã¨ããï¼ è¿½å ã®å¯¾ç­ãå¿è¦ã¨ãªã (å¯¾å¿æ¸ã¿ã§ã¯ãããã®ã®ï¼ å±éºæ§ãé«ãã¨ãããã)* Windows Vista ã«ã¤ãã¦ã¯ï¼ KERNEL32.DLL ã NTDLL.DLL ã«ããèª­ã¿è¾¼ã¾ããæç¹ã§ APPHELP.DLL ã«å¯¾ãã DLL ãã¤ã¸ã£ãã¯ãæç«ãã¦ãã¾ããã¨ããï¼ å®å¨ãªå¯¾å¿ã¯ä¸å¯è½ã       ãªãï¼ APPHELP.DLL ã«éã£ã¦è¨ãã°ï¼ åã«ååã® DLL ãä½æããç¨åº¦ã§ã¯ï¼ åæåã«ã¼ãã³ãå«ãã¦å®éã«ã³ã¼ããå®è¡ããããã¨ã¯ãªãã ãã ãï¼ DLL ã®ã­ã¼ããè©¦ã¿ãããããï¼ å®è¡ãã¡ã¤ã«ä»¥å¤ã®å½¢å¼ãä½¿ãããå ´åï¼ ã·ã¹ãã ã«ãããââã¯ Windows ä¸ã§ã¯å®è¡ã§ããªãããã¨ã©ã¼ãå«ãã§ãã¾ãããã®è­¦åãè¡¨ç¤ºãããã ã©ã¡ãã®å ´åãï¼ å®éã«ã­ã¼ããããã®ã¯ã·ã¹ãã ãã£ã¬ã¯ããªã¼ä¸ã®æ­£è¦ç APPHELP.DLL ã¨ãªãã* Windows XP ä»¥åã«ã¤ãã¦ã¯ã·ã¹ãã ã«ä¿è­·æ©è½ãåãã£ã¦ããï¼ å¤æ°ã® DLL ã Vista ã§ã® APPHELP.DLL ã¨åãç¶æ³ã«é¥ã£ã¦ãããã¨ããï¼ å¯¾å¿èªä½ãä¸å¯è½ã* Windows 7/Vista ã«ã¤ãã¦ã¯ï¼ [KB2533623](https://support.microsoft.com/ja-jp/help/2533623/microsoft-security-advisory-insecure-library-loading-could-allow-remote-code-execution) ã®æ´æ°ãã­ã°ã©ã ãé©ç¨ãã¦ãããã¨ãåæã ãããé©ç¨ããã¦ããªãã¨ SetDefaultDllDirectories() API ãªã©ãä½¿ããªããã¨ããï¼ æ ¹æ¬çã«å¯¾å¿ãç ´ç¶»ããã* ãããã UNARJ32.DLL ãå¼ã³åºãå´ã®ãã­ã°ã©ã  (ä¾ãã° LHMelt) ã ãã®èå¼±æ§ã«å¯¾å¿ãã¦ããªãã¨ï¼ UNARJ32.DLL å´ã§ã®å¯¾å¿ãç¡æå³ã¨ãªã£ã¦ãã¾ãã ä¸è¿°ã®ãåé¿æ¹æ³ãã®å¯¾ç­ãè¬ãããã¦ããã®ã§ããã°ï¼ å±éºæ§ã¯å¸è²©ã½ããç­ã¨åãã   Windows XP ä»¥åã® OS ã¯ã¨ãããï¼ Windows 7 ã Vista ã«ã¤ãã¦ã¯ï¼ å¯è½ã§ããã°ãã·ã¹ãã ãã£ã¬ã¯ããªã¼ (è¥ããã¯æ­£è¦ãªãã®ã¨å¤æãã¦ãã DLL ãç½®ããã¦ãããã£ã¬ã¯ããªã¼) ä»¥å¤ã«å­å¨ãã SSPICLI.DLL ã APPHELP.DLL ã«ã¤ãã¦ï¼ å®è¡ãã¢ã¯ã»ã¹ãæå¦ããè¨­å®ãè¡ãããã¨ã§ï¼ å±éºæ§ã®è»½æ¸ãå³ããã¨ãå¯è½ã§ãã ä½è« ãä»åã®èå¼±æ§ã«ã¤ãã¦ã¯ï¼ UNLHA32.DLL ã«é¢ããå½å±ã®æå ±éç¤ºãè¡ãããã¾ã§ã¨ï¼ ãã¡ãã®å¬éãæ§ãã¦ããã®ã§ããï¼ 1 å¹´çµã£ã¦ãä¸åã«éç¤ºãããæ°éããªããã¨ããï¼ ç¾ç¶ã®ãã®ãæ­£å¼çã¨ãã¦å¬éãããã¨ã«ãã¾ããã  ãªãï¼ å½å±å´ã«åé¡ãããã®ã§ã¯ãªãï¼ ããèªèº«ã®å ±åããèå¼±æ§ãä¿®æ­£çã§çºçããªããã¨ãç¢ºèªããããªã©å ±åèå´ã®è¡ãã¹ãä½æ¥­ãè¡ãããªãã£ããçç±ã«ãããã®ã§ãã®ã§ï¼ å¿µã®ããã ã¯ã£ããè¨ã£ã¦ãæ¾ç½®ããããããªãé ­ããå ±åãããªã!!ãã¨ããã®ãæ­£ç´ãªã¨ããã§ãã å½å±å´ã¯åæã«åãã¾ããããï¼ å ±åèã«æ¾ç½®ãããã¨ç°¡åã« 1 å¹´ 2 å¹´ã¨æéã®çµã£ã¦ãã¾ãã®ãç¾ç¶ãªã®ã§â¦ã æ´æ°å±¥æ­´  * èå¼±æ§æå ±ã®å¬éã[May.15,2017]* åèæå ±ã« JVN ã®æå ± (JVNTA#91240916) ãè¿½å ã[May.25,2017]* åé¿æ¹æ³ã« UNARJ32.DLL ã®éå¸èªå·±è§£åæ¸åº«ã«é¢ããæå ±ãè¿½å ã[Aug.23,2017]* åèæå ±ã«ãWindows ã¢ããªã±ã¼ã·ã§ã³ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§ã«ã¤ãã¦ã(MHVI#20170718) ã®æå ±ãè¿½å ã[Aug.23,2017]* åèæå ±ã« IPA ã®æå ±ããæ³¨æåèµ·ãWindowsã¢ããªã±ã¼ã·ã§ã³ã®å©ç¨ã«ãããæ³¨æããè¿½å ã[Sep.30,2017]* å¯¾ç­çå¬éã«ä¼´ãæå ±ã®å¤æ´ã[May.5,2018]* JVN ã§ã®æå ±å¬éã«ä¼´ãæå ±ãè¿½å ã[Jan.31,2019] åèæå ±  * MHSVI#20170515-01ï¼[UNLHA32.DLL ã§ä½æãããèªå·±è§£åæ¸åº«ã«ãããä»»æã® DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](mhsvi20170515_01.htm) (UNARJ32.DLL ã®éå¸èªå·±è§£åæ¸åº«)* MHVI#20170718ï¼[Windows ã¢ããªã±ã¼ã·ã§ã³ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§ã«ã¤ãã¦](mhvi20170718.htm)* ä»æ¥ã®åºæ¥äº (May, 2018)ï¼[LHMelt ç­ã§ã® DLL ãã¤ã¸ã£ãã¯å¯¾ç­è¦ãæ¸ã](../../incidents/2018/inci1805.htm#i20180528)* CVE ï¼ [CVE-2018-16189](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16189)* CVE ï¼ [CVE-2018-16190](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16190)* CVE ï¼ [CVE-2019-5912](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5912)* JVN ï¼ [JVN#52168232ãUNLHA32.DLLãUNARJ32.DLLãLHMelting ããã³ LMLzh32.DLL ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/jp/JVN%2352168232/index.html)* JVN ï¼ [JVN#83826673ãUNLHA32.DLLãUNARJ32.DLL ããã³ LHMelting ã®ã¤ã³ã¹ãã¼ã©ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/jp/JVN%2383826673/index.html)* JVN ï¼ [JVNTA#91240916ãWindows ã¢ããªã±ã¼ã·ã§ã³ã«ãã DLL èª­ã¿è¾¼ã¿ãã³ãã³ãå®è¡ã«é¢ããåé¡](http://jvn.jp/ta/JVNTA91240916/index.html)* JVN ï¼ [JVNTA10-238AãMicrosoft Windows ã«ããã DLL èª­ã¿è¾¼ã¿ã«é¢ããèå¼±æ§](http://jvn.jp/cert/JVNTA10-238A/index.html)* JVN ï¼ [JVNVU#707943ãWindows ãã­ã°ã©ã ã® DLL èª­ã¿è¾¼ã¿ã«èå¼±æ§](http://jvn.jp/cert/JVNVU707943/index.html)* JVN iPedia ï¼ [JVNDB-2019-000004](https://jvndb.jvn.jp/ja/contents/2019/JVNDB-2019-000004.html)* JVN iPedia ï¼ [JVNDB-2019-000005](https://jvndb.jvn.jp/ja/contents/2019/JVNDB-2019-000005.html)* IPA ï¼ [ãæ³¨æåèµ·ãWindowsã¢ããªã±ã¼ã·ã§ã³ã®å©ç¨ã«ãããæ³¨æ](http://www.ipa.go.jp/security/ciadr/vul/20170928_dll.html)* ãã¤ã¯ã­ã½ãã ã»ã­ã¥ãªãã£ ã¢ããã¤ã¶ãª ï¼ [2269637ãå®å¨ã§ãªãã©ã¤ãã©ãªã®ã­ã¼ãã«ããããªã¢ã¼ãã§ã³ã¼ããå®è¡ããã](https://docs.microsoft.com/ja-jp/security-updates/securityadvisories/2010/2269637)* MSDN Library ï¼ [Dynamic-Link Library Security](http://msdn.microsoft.com/en-us/library/ff919712%28VS.85%29.aspx)* Microsoft ï¼ [KB2389418ãSecure loading of libraries to prevent DLL preloading attacks](http://support.microsoft.com/en-us/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks)   | [[âPage top]](mhsvi20170515_03.htm) | [[âãèå¼±æ§æå ±ä¸è¦§ã]](../index.htm) [[âHome]](../../micindex.html) | | --- | --- | |



=== Content from jvn.jp_401df9ab_20250125_000129.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2019/01/31  Last Updated:2019/01/31
# JVN#52168232 UNLHA32.DLL, UNARJ32.DLL, LHMelting and LMLzh32.DLL may insecurely load Dynamic Link Libraries

## Overview

UNLHA32.DLL, UNARJ32.DLL, LHMelting and LMLzh32.DLL provided by Micco may insecurely load Dynamic Link Libraries.

## Products Affected

**CVE-2018-16189**

* UNLHA32.DLL for Win32 prior to Ver 3.00

**CVE-2018-16190**

* UNLHA32.DLL for Win32 Ver 2.67.1.2 and earlier
* UNARJ32.DLL for Win32 Ver 1.10.1.25 and earlier
* LHMelting for Win32 Ver 1.65.3.6 and earlier
* LMLzh32.DLL Ver 2.67.1.2 and earlier

## Description

UNLHA32.DLL, UNARJ32.DLL, LHMelting and LMLzh32.DLL provided by Micco contain vulnerabilities listed below.

* **Self-Extracting Archives created by UNLHA32.DLL may insecurely load Dynamic Link Libraries ([CWE-427](https://cwe.mitre.org/data/definitions/427.html))** - CVE-2018-16189

  | CVSS v3 | CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H | **Base Score: 7.8** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:P/I:P/A:P | **Base Score: 6.8** |
* **Insecurely load specific DLL file in the same directory ([CWE-427](https://cwe.mitre.org/data/definitions/427.html))** - CVE-2018-16190

  | CVSS v3 | CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H | **Base Score: 7.8** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:P/I:P/A:P | **Base Score: 6.8** |

## Impact

* Arbitrary code may be executed with the privilege of the user invoking a vulnerable self-extracting archive file. - CVE-2018-16189
* Arbitrary code may be executed with the privileges of the running applications. - CVE-2018-16190

## Solution

**Solution for CVE-2018-16189:**

**Update UNLHA32.DLL and Recreate Self-Extracting Archive files**

According to the information provided by the developer, update the product which includes UNLHA32.DLL to the latest version and recreate self-extracting archive files.

**Solution for CVE-2018-16190:**

**Update the software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Micco | [Vulnerable](995987/index.html) | 2019/01/31 | [Micco website](http://micco.mars.jp/vul/2017/mhsvi20170515_01.htm) |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

This JVN publication was delayed to 2019/1/31 after the developer's fix was published.

## Vulnerability Analysis by JPCERT/CC

## Credit

Eili Masami reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2018-16189](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16189) |
|  | [CVE-2018-16190](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16190) |
| JVN iPedia | [JVNDB-2019-000004](https://jvndb.jvn.jp/jvndb/JVNDB-2019-000004) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2019 JPCERT/CC and IPA. All rights reserved.



=== Content from jvndb.jvn.jp_8e8ce1e5_20250126_044015.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2019/09/26

| [[Japanese]](/ja/contents/2019/JVNDB-2019-000004.html) | |
| --- | --- |
| JVNDB-2019-000004 | |
| UNLHA32.DLL, UNARJ32.DLL, LHMelting and LMLzh32.DLL may insecurely load Dynamic Link Libraries | |
| Overview | |
| UNLHA32.DLL, UNARJ32.DLL, LHMelting and LMLzh32.DLL provided by Micco contain vulnerabilities listed below. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [7.8](/cvss/en/v3.html#CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H) (High) [IPA Score]**  * Attack Vector: Local * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Unchanged * Confidentiality Impact: High * Integrity Impact: High * Availability Impact: High  **CVSS V2 Severity:Base Metrics [6.8](/cvss/en/v2.html#AV:N/AC:M/Au:N/C:P/I:P/A:P) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Medium * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: Partial   The above CVSS base scores have been assigned for CVE-2018-16189 | |
| ---   **CVSS V3 Severity: Base Metrics: [7.8](/cvss/ja/v3.html#CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H) (High) [IPA Score]**  * Attack Vector: Local * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Unchanged * Confidentiality Impact: High * Integrity Impact: High * Availability Impact: High **CVSS V2 Severity:****Base Metrics: [6.8](/cvss/ja/v2.html#AV:N/AC:M/Au:N/C:P/I:P/A:P) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Medium * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: Partial The above CVSS base scores have been assigned for CVE-2018-16190 | |
| Affected Products | |
|  | |
| Micco  * LHMelting for Win32 * LMLzh32.DLL * UNARJ32.DLL for Win32 * UNLHA32.DLL for Win32 | |
| **CVE-2018-16189** \* UNLHA32.DLL for Win32 prior to Ver 3.00  **CVE-2018-16190** \* UNLHA32.DLL for Win32 Ver 2.67.1.2 and earlier \* UNARJ32.DLL for Win32 Ver 1.10.1.25 and earlier \* LHMelting for Win32 Ver 1.65.3.6 and earlier \* LMLzh32.DLL Ver 2.67.1.2 and earlier | |
| Impact | |
| \* Arbitrary code may be executed with the privilege of the user invoking a vulnerable self-extracting archive file. - CVE-2018-16189 | |
| Solution | |
| Solution for CVE-2018-16189: | |
| Vendor Information | |
| Micco  * JVN : [Information from Micco](https://jvn.jp/en/jp/JVN52168232/995987/index.html) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [No Mapping(CWE-Other)](https://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWEOther) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2018-16189](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16189) 2. [CVE-2018-16190](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16190) | |
| References | |
| 1. JVN : [JVN#52168232](https://jvn.jp/en/jp/JVN52168232/index.html) 2. JVN : [JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/) 3. National Vulnerability Database (NVD) : [CVE-2018-16189](https://nvd.nist.gov/vuln/detail/CVE-2018-16189) 4. National Vulnerability Database (NVD) : [CVE-2018-16190](https://nvd.nist.gov/vuln/detail/CVE-2018-16190) | |
| Revision History | |
| * [2019/01/31] * [2019/09/26] | |

| --- | |
| --- | --- |
| Date Public | 2019/01/31 |
| Date First Published | 2019/01/31 |
| Date Last Updated | 2019/09/26 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)


