=== Content from github.com_73f35344_20250125_171248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2Fecb31dbad39ccdc65868d5d2a37f0f0521250832)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2Fecb31dbad39ccdc65868d5d2a37f0f0521250832)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ImageMagick%2FImageMagick)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ImageMagick](/ImageMagick)
/
**[ImageMagick](/ImageMagick/ImageMagick)**
Public

* [Notifications](/login?return_to=%2FImageMagick%2FImageMagick) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FImageMagick%2FImageMagick)
* [Star
   12.7k](/login?return_to=%2FImageMagick%2FImageMagick)

* [Code](/ImageMagick/ImageMagick)
* [Issues
  123](/ImageMagick/ImageMagick/issues)
* [Pull requests
  4](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

Additional navigation options

* [Code](/ImageMagick/ImageMagick)
* [Issues](/ImageMagick/ImageMagick/issues)
* [Pull requests](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

## Commit

[Permalink](/ImageMagick/ImageMagick/commit/ecb31dbad39ccdc65868d5d2a37f0f0521250832)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

https://github.com/ImageMagick/ImageMagick/issues/1268

[Browse files](/ImageMagick/ImageMagick/tree/ecb31dbad39ccdc65868d5d2a37f0f0521250832)
Browse the repository at this point in the history

* Loading branch information

Cristy
committed
Aug 27, 2018

1 parent
[817f6ab](/ImageMagick/ImageMagick/commit/817f6ab6ed5fe2bb5aebfb0a8ebb034a55fe4bb9)

commit ecb31db

Showing
**1 changed file**
with
**2 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[coders/bmp.c](#diff-787ae9f5f712a008bb9caedf879cc8cf20bcb227ded9b17edce7fe9500a41d5c "coders/bmp.c")

Show comments

[View file](/ImageMagick/ImageMagick/blob/ecb31dbad39ccdc65868d5d2a37f0f0521250832/coders/bmp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -661,6 +661,8 @@ static Image \*ReadBMPImage(const ImageInfo \*image\_info,ExceptionInfo \*exception) |
|  |  | bmp\_info.x\_pixels=ReadBlobLSBLong(image); |
|  |  | bmp\_info.y\_pixels=ReadBlobLSBLong(image); |
|  |  | bmp\_info.number\_colors=ReadBlobLSBLong(image); |
|  |  | if (bmp\_info.number\_colors > GetBlobSize(image)) |
|  |  | ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile"); |
|  |  | bmp\_info.colors\_important=ReadBlobLSBLong(image); |
|  |  | if (image->debug != MagickFalse) |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ecb31db`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fcommit%2Fecb31dbad39ccdc65868d5d2a37f0f0521250832) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from lists.debian.org_3a05a9e3_20250125_171250.html ===


---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)]
[[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)]
[[Date Index](maillist.html#00002)]
[[Thread Index](threads.html#00002)]

# [SECURITY] [DLA 1530-1] imagemagick security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1530-1] imagemagick security update
* *From*: Roberto C. SÃ¡nchez <roberto@debian.org>
* *Date*: Wed, 3 Oct 2018 14:05:30 -0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20181003180529.3dmgcrykuxr3dbsx%40santiago.connexer.com)Â [20181003180529.3dmgcrykuxr3dbsx@santiago.connexer.com](msg00002.html)>
* *Mail-followup-to*: Roberto C. SÃ¡nchez <roberto@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : imagemagick
Version        : 8:6.8.9.9-5+deb8u14
CVE ID         : CVE-2018-16412 CVE-2018-16413 CVE-2018-16642
                 CVE-2018-16643 CVE-2018-16644 CVE-2018-16645
                 CVE-2018-16749

Several security vulnerabilities were discovered in ImageMagick, an
image manipulation program, that allow remote attackers to cause denial
of service (application crash, excessive memory allocation, or other
unspecified effects) or out of bounds memory access via DCM, PWP, CALS,
PICT, BMP, DIB, or PNG image files.

For Debian 8 "Jessie", these problems have been fixed in version
8:6.8.9.9-5+deb8u14.

We recommend that you upgrade your imagemagick packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpPRHC1dT77T.pgp)**

*Description:* PGP signature

---



=== Content from launchpad.net_15793b55_20250126_103149.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[imagemagick package](https://launchpad.net/ubuntu/%2Bsource/imagemagick)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/imagemagick)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/imagemagick)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/imagemagick)

# segfault in png to gif conversion

Bug #1793485 reported by
[Dariusz Gadomski](https://launchpad.net/~dgadomski)
on 2018-09-20

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [imagemagick (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick "Latest release: 8:7.1.1.43+dfsg1-1, uploaded to main on 2024-12-30 04:32:21.794453+00:00 by ImageMagick Packaging Team (pkg-gmagick-im-team), maintained by ImageMagick Packaging Team (pkg-gmagick-im-team)") | Fix Released | High | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Trusty](https://bugs.launchpad.net/ubuntu/trusty/%2Bsource/imagemagick) | Fix Released | High | [Steve Beattie](https://launchpad.net/~sbeattie) |  |
|  | [Xenial](https://bugs.launchpad.net/ubuntu/xenial/%2Bsource/imagemagick) | Fix Released | High | [Steve Beattie](https://launchpad.net/~sbeattie) |  |
|  | [Bionic](https://bugs.launchpad.net/ubuntu/bionic/%2Bsource/imagemagick) | Fix Released | High | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |

### Bug Description

Regression between 8:6.8.9.9-7ubuntu5.9 and 8:6.8.9.9-7ubuntu5.12.

Test case:

1. Download the attached pngs.

2. Run:

/usr/bin/convert -limit memory 512MiB -limit map 0MiB -limit file 10 -delay 16 -loop 0 -coalesce -deconstruct ./\*.png ./output.gif

Expected result:

Process finishes with resulting output.gif.

Actual result:

Process is aborted with SIGSEGV:

Other information:

In my tests looks like it has been introduced in 8:6.8.9.9-7ubuntu5.11 and does not occur on Bionic.

Stack trace:

#0 EncodeImage (image\_info=0x645c40, data\_size=<optimized out>,

Â Â Â Â image=0x636890) at ../../coders/gif.c:676

#1 WriteGIFImage (image\_info=0x640700, image=0x636890)

Â Â Â Â at ../../coders/gif.c:1905

#2 0x00007ffff79a5f0f in WriteImage (image\_info=image\_info@entry=0x618680,

Â Â Â Â image=image@entry=0x62cb30) at ../../magick/constitute.c:1184

#3 0x00007ffff79a684f in WriteImages (image\_info=image\_info@entry=0x60fcd0,

Â Â Â Â images=<optimized out>, images@entry=0x62cb30, filename=<optimized out>,

Â Â Â Â exception=exception@entry=0x602ea0) at ../../magick/constitute.c:1335

#4 0x00007ffff763e84e in ConvertImageCommand (image\_info=0x60fcd0, argc=19,

Â Â Â Â argv=0x6143b0, metadata=0x0, exception=0x602ea0)

Â Â Â Â at ../../wand/convert.c:3215

#5 0x00007ffff76ab527 in MagickCommandGenesis (

Â Â Â Â image\_info=image\_info@entry=0x60aab0,

Â Â Â Â command=0x4007f0 <ConvertImageCommand@plt>, argc=argc@entry=19,

Â Â Â Â argv=argv@entry=0x7fffffffdc68, metadata=metadata@entry=0x0,

Â Â Â Â exception=exception@entry=0x602ea0) at ../../wand/mogrify.c:168

#6 0x0000000000400877 in ConvertMain (argv=0x7fffffffdc68, argc=19)

Â Â Â Â at ../../utilities/convert.c:81

#7 main (argc=19, argv=0x7fffffffdc68) at ../../utilities/convert.c:92

See [original description](comments/0)

Tags:

[regression-update](/ubuntu/%2Bsource/imagemagick/%2Bbugs?field.tag=regression-update)

## CVE References

* [2017-12430](/bugs/cve/2017-12430 "In ImageMagick 7.0.6-1, a memory exha...")
* [2017-13144](/bugs/cve/2017-13144 "In ImageMagick before 6.9.7-10, there...")
* [2018-14434](/bugs/cve/2018-14434 "ImageMagick 7.0.8-4 has a memory leak...")
* [2018-14435](/bugs/cve/2018-14435 "ImageMagick 7.0.8-4 has a memory leak...")
* [2018-14436](/bugs/cve/2018-14436 "ImageMagick 7.0.8-4 has a memory leak...")
* [2018-14437](/bugs/cve/2018-14437 "ImageMagick 7.0.8-4 has a memory leak...")
* [2018-16323](/bugs/cve/2018-16323 "ReadXBMImage in coders/xbm.c in Image...")
* [2018-16640](/bugs/cve/2018-16640 "ImageMagick 7.0.8-5 has a memory leak...")
* [2018-16642](/bugs/cve/2018-16642 "The function InsertRow in coders/cut....")
* [2018-16643](/bugs/cve/2018-16643 "The functions ReadDCMImage in coders/...")
* [2018-16644](/bugs/cve/2018-16644 "There is a missing check for length i...")
* [2018-16645](/bugs/cve/2018-16645 "There is an excessive memory allocati...")
* [2018-16749](/bugs/cve/2018-16749 "In ImageMagick 7.0.7-29 and earlier, ...")
* [2018-16750](/bugs/cve/2018-16750 "In ImageMagick 7.0.7-29 and earlier, ...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dariusz Gadomski (dgadomski)](https://launchpad.net/~dgadomski) wrote on 2018-09-20: |  |  | [#1](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/1) |
| --- | --- | --- | --- |

* [SH\_HL\_08\_Step1\_F028.png](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190921/%2Bfiles/SH_HL_08_Step1_F028.png)
  [Edit](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190921)
  (4.7 KiB,
  image/png)

| Changed in imagemagick (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided â†’ High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dariusz Gadomski (dgadomski)](https://launchpad.net/~dgadomski) wrote on 2018-09-20: |  |  | [#2](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/2) |
| --- | --- | --- | --- |

* [SH\_HL\_08\_Step1\_F029.png](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190922/%2Bfiles/SH_HL_08_Step1_F029.png)
  [Edit](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190922)
  (4.7 KiB,
  image/png)

| **description**: | updated |
| --- | --- |

[Steve Langasek (vorlon)](https://launchpad.net/~vorlon)
on 2018-09-20

| Changed in imagemagick (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody â†’ Marc Deslauriers (mdeslaur) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2018-09-21: |  |  | [#3](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/3) |
| --- | --- | --- | --- |

Thanks for reporting this issue. Looks like we're possibly missing a couple of commits:

<https://github.com/ImageMagick/ImageMagick6/commit/e5e87c087ed48db886be0ff3aff4041d38218192>

<https://github.com/ImageMagick/ImageMagick6/commit/f5d04fc678f67984a1f8c1008dc8eac8ee7e3629>

I'll prepare a regression fix.

Thanks for reporting this issue. Looks like we're possibly missing a couple of commits:
https://github.com/ImageMagick/ImageMagick6/commit/e5e87c087ed48db886be0ff3aff4041d38218192
https://github.com/ImageMagick/ImageMagick6/commit/f5d04fc678f67984a1f8c1008dc8eac8ee7e3629
I'll prepare a regression fix.

| Changed in imagemagick (Ubuntu Bionic): | |
| --- | --- |
| **status**: | New â†’ Fix Released |
| Changed in imagemagick (Ubuntu): | |
| **status**: | New â†’ Fix Released |
| Changed in imagemagick (Ubuntu Trusty): | |
| **status**: | New â†’ In Progress |
| Changed in imagemagick (Ubuntu Xenial): | |
| **status**: | New â†’ In Progress |
| Changed in imagemagick (Ubuntu Trusty): | |
| **assignee**: | nobody â†’ Marc Deslauriers (mdeslaur) |
| Changed in imagemagick (Ubuntu Xenial): | |
| **assignee**: | nobody â†’ Marc Deslauriers (mdeslaur) |
| Changed in imagemagick (Ubuntu Bionic): | |
| **assignee**: | nobody â†’ Marc Deslauriers (mdeslaur) |
| **information type**: | Public â†’ Public Security |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2018-09-25: |  |  | [#4](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/4) |
| --- | --- | --- | --- |

The two additional commits don't seem to fix the segfault. I'm leaning towards reverting 0261-CVE-2017-13144.patch for now...

The two additional commits don't seem to fix the segfault. I'm leaning towards reverting 0261-CVE-2017-13144.patch for now...

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2018-09-26: |  |  | [#5](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/5) |
| --- | --- | --- | --- |

Thanks Marc. I'm preparing an additional imagemagick update, so I'll incorporate that into it. Assigning to myself.

Thanks Marc. I'm preparing an additional imagemagick update, so I'll incorporate that into it. Assigning to myself.

| Changed in imagemagick (Ubuntu Trusty): | |
| --- | --- |
| **assignee**: | Marc Deslauriers (mdeslaur) â†’ Steve Beattie (sbeattie) |
| Changed in imagemagick (Ubuntu Xenial): | |
| **assignee**: | Marc Deslauriers (mdeslaur) â†’ Steve Beattie (sbeattie) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2018-10-04: |  |  | [#6](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/6) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/6/%2Bdownload) (3.1 KiB)

This bug was fixed in the package imagemagick - 8:6.7.7.10-6ubuntu3.13

---------------

imagemagick (8:6.7.7.10-6ubuntu3.13) trusty-security; urgency=medium

[ Steve Beattie ]

Â Â \* SECURITY UPDATE: code execution vulnerabilities in ghostscript as

Â Â Â Â invoked by imagemagick

Â Â Â Â - debian/patches/200-disable-ghostscript-formats.patch: disable

Â Â Â Â Â Â ghostscript handled types by default in policy.xml

Â Â \* SECURITY UPDATE: information leak in ReadXBMImage

Â Â Â Â - debian/patches/CVE-2018-16323.patch: don't leave data

Â Â Â Â Â Â uninitialized with negative pixels

Â Â Â Â - CVE-2018-16323

Â Â \* SECURITY UPDATE: memory leak of colormap in WriteMPCImage

Â Â Â Â - debian/patches/CVE-2018-14434.patch: free colormap on bad

Â Â Â Â Â Â color depth

Â Â Â Â - CVE-2018-14434

Â Â \* SECURITY UPDATE: memory leak in DecodeImage

Â Â Â Â - debian/patches/CVE-2018-14435.patch: free memory when given a

Â Â Â Â Â Â bad plane

Â Â Â Â - CVE-2018-14435

Â Â \* SECURITY UPDATE: memory leak in ReadMIFFImage

Â Â Â Â - debian/patches/CVE-2018-14436.patch: free memory when given a bad

Â Â Â Â Â Â depth

Â Â Â Â - CVE-2018-14436

Â Â \* SECURITY UPDATE: memory leak in parse8BIM

Â Â Â Â - debian/patches/CVE-2018-14437-prereq.patch: check for negative

Â Â Â Â Â Â values

Â Â Â Â - debian/patches/CVE-2018-14437.patch: free strings in error

Â Â Â Â Â Â conditions

Â Â Â Â - CVE-2018-14437

Â Â \* SECURITY UPDATE: memory leak in ReadOneJNGImage

Â Â Â Â - debian/patches/CVE-2018-16640-prereq-1.patch: define DestroyJNG()

Â Â Â Â - debian/patches/CVE-2018-16640-prereq-2.patch: fix DestroyJNG()

Â Â Â Â - debian/patches/CVE-2018-16640.patch: free memory on error

Â Â Â Â - CVE-2018-16640

Â Â \* SECURITY UPDATE: denial of service due to out-of-bounds write

Â Â Â Â in InsertRow

Â Â Â Â - debian/patches/CVE-2018-16642.patch: improve checking for errors

Â Â Â Â - CVE-2018-16642

Â Â \* SECURITY UPDATE: denial of service due to missing fputc checks

Â Â Â Â - debian/patches/CVE-2018-16643.patch: check fputc calls for error

Â Â Â Â - CVE-2018-16643

Â Â \* SECURITY UPDATE: denial of service in ReadDCMImage and

Â Â Â Â ReadPICTImage

Â Â Â Â - debian/patches/CVE-2018-16644-prereq-1.patch: make

Â Â Â Â Â Â ReadRectangle() a boolean returning function and use it.

Â Â Â Â - debian/patches/CVE-2018-16644-prereq-2.patch: check for EOF

Â Â Â Â Â Â when reading from file

Â Â Â Â - debian/patches/CVE-2018-16644-prereq-3.patch: define

Â Â Â Â Â Â ThrowPICTException() macro and use it

Â Â Â Â - debian/patches/CVE-2018-16644-1.patch,

Â Â Â Â Â Â debian/patches/CVE-2018-16644-2.patch: check for invalid length

Â Â Â Â - CVE-2018-16644

Â Â \* SECURITY UPDATE: excessive memory allocation issue in ReadBMPImage

Â Â Â Â - debian/patches/CVE-2018-16645.patch: ensure number\_colors is

Â Â Â Â Â Â not too large

Â Â Â Â - CVE-2018-16645

Â Â \* SECURITY UPDATE: denial of service in ReadOneJNGImage

Â Â Â Â - debian/patches/CVE-2018-16749.patch; check for NULL color\_image

Â Â Â Â - CVE-2018-16749

Â Â \* SECURITY UPDATE: memory leak in formatIPTCfromBuffer

Â Â Â Â - debian/patches/CVE-2018-16750.patch: free memory on error

Â Â Â Â - CVE-2018-16750

[ Marc Deslauriers ]

Â Â \* SECURITY REGRESSION: segfault in png to gif conversion (LP: [#1793485](/bugs/1793485))

Â Â Â Â - debian/patches/0297-CVE-2017-13144.patch: removed pending further

Â Â Â Â Â Â investigation.

Â Â Â Â - debian/patches/CVE-2017-12430.patch: refreshed.

-- Steve Beattie <email address hidden> Fri, 28 Sep 2018 11:...

[Read more...](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/6)

This bug was fixed in the package imagemagick - 8:6.7.7.10-6ubuntu3.13
---------------
imagemagick (8:6.7.7.10-6ubuntu3.13) trusty-security; urgency=medium
[ Steve Beattie ]
\* SECURITY UPDATE: code execution vulnerabilities in ghostscript as
invoked by imagemagick
- debian/patches/200-disable-ghostscript-formats.patch: disable
ghostscript handled types by default in policy.xml
\* SECURITY UPDATE: information leak in ReadXBMImage
- debian/patches/CVE-2018-16323.patch: don't leave data
uninitialized with negative pixels
- CVE-2018-16323
\* SECURITY UPDATE: memory leak of colormap in WriteMPCImage
- debian/patches/CVE-2018-14434.patch: free colormap on bad
color depth
- CVE-2018-14434
\* SECURITY UPDATE: memory leak in DecodeImage
- debian/patches/CVE-2018-14435.patch: free memory when given a
bad plane
- CVE-2018-14435
\* SECURITY UPDATE: memory leak in ReadMIFFImage
- debian/patches/CVE-2018-14436.patch: free memory when given a bad
depth
- CVE-2018-14436
\* SECURITY UPDATE: memory leak in parse8BIM
- debian/patches/CVE-2018-14437-prereq.patch: check for negative
values
- debian/patches/CVE-2018-14437.patch: free strings in error
conditions
- CVE-2018-14437
\* SECURITY UPDATE: memory leak in ReadOneJNGImage
- debian/patches/CVE-2018-16640-prereq-1.patch: define DestroyJNG()
- debian/patches/CVE-2018-16640-prereq-2.patch: fix DestroyJNG()
- debian/patches/CVE-2018-16640.patch: free memory on error
- CVE-2018-16640
\* SECURITY UPDATE: denial of service due to out-of-bounds write
in InsertRow
- debian/patches/CVE-2018-16642.patch: improve checking for errors
- CVE-2018-16642
\* SECURITY UPDATE: denial of service due to missing fputc checks
- debian/patches/CVE-2018-16643.patch: check fputc calls for error
- CVE-2018-16643
\* SECURITY UPDATE: denial of service in ReadDCMImage and
ReadPICTImage
- debian/patches/CVE-2018-16644-prereq-1.patch: make
ReadRectangle() a boolean returning function and use it.
- debian/patches/CVE-2018-16644-prereq-2.patch: check for EOF
when reading from file
- debian/patches/CVE-2018-16644-prereq-3.patch: define
ThrowPICTException() macro and use it
- debian/patches/CVE-2018-16644-1.patch,
debian/patches/CVE-2018-16644-2.patch: check for invalid length
- CVE-2018-16644
\* SECURITY UPDATE: excessive memory allocation issue in ReadBMPImage
- debian/patches/CVE-2018-16645.patch: ensure number\_colors is
not too large
- CVE-2018-16645
\* SECURITY UPDATE: denial of service in ReadOneJNGImage
- debian/patches/CVE-2018-16749.patch; check for NULL color\_image
- CVE-2018-16749
\* SECURITY UPDATE: memory leak in formatIPTCfromBuffer
- debian/patches/CVE-2018-16750.patch: free memory on error
- CVE-2018-16750
[ Marc Deslauriers ]
\* SECURITY REGRESSION: segfault in png to gif conversion (LP: #1793485)
- debian/patches/0297-CVE-2017-13144.patch: removed pending further
investigation.
- debian/patches/CVE-2017-12430.patch: refreshed.
-- Steve Beattie <sbeattie@ubuntu.com> Fri, 28 Sep 2018 11:21:01 -0700

| Changed in imagemagick (Ubuntu Trusty): | |
| --- | --- |
| **status**: | In Progress â†’ Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2018-10-04: |  |  | [#7](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/7) |
| --- | --- | --- | --- |

This bug was fixed in the package imagemagick - 8:6.8.9.9-7ubuntu5.13

---------------

imagemagick (8:6.8.9.9-7ubuntu5.13) xenial-security; urgency=medium

[ Steve Beattie ]

Â Â \* SECURITY UPDATE: code execution vulnerabilities in ghostscript as

Â Â Â Â invoked by imagemagick

Â Â Â Â - debian/patches/200-disable-ghostscript-formats.patch: disable

Â Â Â Â Â Â ghostscript handled types by default in policy.xml

Â Â \* SECURITY UPDATE: information leak in ReadXBMImage

Â Â Â Â - debian/patches/CVE-2018-16323.patch: don't leave data

Â Â Â Â Â Â uninitialized with negative pixels

Â Â Â Â - CVE-2018-16323

Â Â \* SECURITY UPDATE: memory leak of colormap in WriteMPCImage

Â Â Â Â - debian/patches/CVE-2018-14434.patch: free colormap on bad

Â Â Â Â Â Â color depth

Â Â Â Â - CVE-2018-14434

Â Â \* SECURITY UPDATE: memory leak in DecodeImage

Â Â Â Â - debian/patches/CVE-2018-14435.patch: free memory when given a

Â Â Â Â Â Â bad plane

Â Â Â Â - CVE-2018-14435

Â Â \* SECURITY UPDATE: memory leak in ReadMIFFImage

Â Â Â Â - debian/patches/CVE-2018-14436.patch: free memory when given a

Â Â Â Â Â Â bad depth

Â Â Â Â - CVE-2018-14436

Â Â \* SECURITY UPDATE: memory leak in parse8BIM

Â Â Â Â - debian/patches/CVE-2018-14437-prereq.patch: check for negative

Â Â Â Â Â Â values

Â Â Â Â - debian/patches/CVE-2018-14437.patch: free strings in error

Â Â Â Â Â Â conditions

Â Â Â Â - CVE-2018-14437

Â Â \* SECURITY UPDATE: memory leak in ReadOneJNGImage

Â Â Â Â - debian/patches/CVE-2018-16640-prereq-1.patch: define DestroyJNG()

Â Â Â Â - debian/patches/CVE-2018-16640-prereq-2.patch: fix DestroyJNG()

Â Â Â Â - debian/patches/CVE-2018-16640.patch: free memory on error

Â Â Â Â - CVE-2018-16640

Â Â \* SECURITY UPDATE: denial of service due to out-of-bounds write

Â Â Â Â in InsertRow

Â Â Â Â - debian/patches/CVE-2018-16642.patch: improve checking for errors

Â Â Â Â - CVE-2018-16642

Â Â \* SECURITY UPDATE: denial of service due to missing fputc checks

Â Â Â Â - debian/patches/CVE-2018-16643.patch: check fputc calls for error

Â Â Â Â - CVE-2018-16643

Â Â \* SECURITY UPDATE: denial of service in ReadDCMImage and

Â Â Â Â ReadPICTImage

Â Â Â Â - debian/patches/CVE-2018-16644-prereq-1.patch: check for EOF

Â Â Â Â Â Â when reading from file

Â Â Â Â - debian/patches/CVE-2018-16644-prereq-2.patch: define

Â Â Â Â Â Â ThrowPICTException() macro and use it

Â Â Â Â - debian/patches/CVE-2018-16644-1.patch,

Â Â Â Â Â Â debian/patches/CVE-2018-16644-2.patch: check for invalid length

Â Â Â Â - CVE-2018-16644

Â Â \* SECURITY UPDATE: excessive memory allocation issue in ReadBMPImage

Â Â Â Â - debian/patches/CVE-2018-16645.patch: ensure number\_colors is

Â Â Â Â Â Â not too large

Â Â Â Â - CVE-2018-16645

Â Â \* SECURITY UPDATE: denial of service in ReadOneJNGImage

Â Â Â Â - debian/patches/CVE-2018-16749.patch; check for NULL color\_image

Â Â Â Â - CVE-2018-16749

Â Â \* SECURITY UPDATE: memory leak in formatIPTCfromBuffer

Â Â Â Â - debian/patches/CVE-2018-16750.patch: free memory on error

Â Â Â Â - CVE-2018-16750

[ Marc Deslauriers ]

Â Â \* SECURITY REGRESSION: segfault in png to gif conversion (LP: [#1793485](/bugs/1793485))

Â Â Â Â - debian/patches/0261-CVE-2017-13144.patch: removed pending

Â Â Â Â Â Â further investigation.

Â Â Â Â - debian/patches/CVE-2017-12430.patch: refreshed.

-- Steve Beattie <email address hidden> Fri, 28 Sep 2018 11:19:54 -0700

This bug was fixed in the package imagemagick - 8:6.8.9.9-7ubuntu5.13
---------------
imagemagick (8:6.8.9.9-7ubuntu5.13) xenial-security; urgency=medium
[ Steve Beattie ]
\* SECURITY UPDATE: code execution vulnerabilities in ghostscript as
invoked by imagemagick
- debian/patches/200-disable-ghostscript-formats.patch: disable
ghostscript handled types by default in policy.xml
\* SECURITY UPDATE: information leak in ReadXBMImage
- debian/patches/CVE-2018-16323.patch: don't leave data
uninitialized with negative pixels
- CVE-2018-16323
\* SECURITY UPDATE: memory leak of colormap in WriteMPCImage
- debian/patches/CVE-2018-14434.patch: free colormap on bad
color depth
- CVE-2018-14434
\* SECURITY UPDATE: memory leak in DecodeImage
- debian/patches/CVE-2018-14435.patch: free memory when given a
bad plane
- CVE-2018-14435
\* SECURITY UPDATE: memory leak in ReadMIFFImage
- debian/patches/CVE-2018-14436.patch: free memory when given a
bad depth
- CVE-2018-14436
\* SECURITY UPDATE: memory leak in parse8BIM
- debian/patches/CVE-2018-14437-prereq.patch: check for negative
values
- debian/patches/CVE-2018-14437.patch: free strings in error
conditions
- CVE-2018-14437
\* SECURITY UPDATE: memory leak in ReadOneJNGImage
- debian/patches/CVE-2018-16640-prereq-1.patch: define DestroyJNG()
- debian/patches/CVE-2018-16640-prereq-2.patch: fix DestroyJNG()
- debian/patches/CVE-2018-16640.patch: free memory on error
- CVE-2018-16640
\* SECURITY UPDATE: denial of service due to out-of-bounds write
in InsertRow
- debian/patches/CVE-2018-16642.patch: improve checking for errors
- CVE-2018-16642
\* SECURITY UPDATE: denial of service due to missing fputc checks
- debian/patches/CVE-2018-16643.patch: check fputc calls for error
- CVE-2018-16643
\* SECURITY UPDATE: denial of service in ReadDCMImage and
ReadPICTImage
- debian/patches/CVE-2018-16644-prereq-1.patch: check for EOF
when reading from file
- debian/patches/CVE-2018-16644-prereq-2.patch: define
ThrowPICTException() macro and use it
- debian/patches/CVE-2018-16644-1.patch,
debian/patches/CVE-2018-16644-2.patch: check for invalid length
- CVE-2018-16644
\* SECURITY UPDATE: excessive memory allocation issue in ReadBMPImage
- debian/patches/CVE-2018-16645.patch: ensure number\_colors is
not too large
- CVE-2018-16645
\* SECURITY UPDATE: denial of service in ReadOneJNGImage
- debian/patches/CVE-2018-16749.patch; check for NULL color\_image
- CVE-2018-16749
\* SECURITY UPDATE: memory leak in formatIPTCfromBuffer
- debian/patches/CVE-2018-16750.patch: free memory on error
- CVE-2018-16750
[ Marc Deslauriers ]
\* SECURITY REGRESSION: segfault in png to gif conversion (LP: #1793485)
- debian/patches/0261-CVE-2017-13144.patch: removed pending
further investigation.
- debian/patches/CVE-2017-12430.patch: refreshed.
-- Steve Beattie <sbeattie@ubuntu.com> Fri, 28 Sep 2018 11:19:54 -0700

| Changed in imagemagick (Ubuntu Xenial): | |
| --- | --- |
| **status**: | In Progress â†’ Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hajo Locke (hajo-locke)](https://launchpad.net/~hajo-locke) wrote on 2018-10-10: |  |  | [#8](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/8) |
| --- | --- | --- | --- |

Hello,

can last changelogentry assigned to one particular CVE Number?

\* SECURITY UPDATE: code execution vulnerabilities in ghostscript as

Â Â Â Â invoked by imagemagick

Â Â Â Â - debian/patches/200-disable-ghostscript-formats.patch: disable

Â Â Â Â Â Â ghostscript handled types by default in policy.xml

We have reports of users who cant convert pdf-files any more, because policy.xml is forbidding it.

Which risk will we take if we change policy.xml back to former content?

And i think there is a typo in changelog. filename is 300-disable-ghostscript-formats.patch

Hello,
can last changelogentry assigned to one particular CVE Number?
\* SECURITY UPDATE: code execution vulnerabilities in ghostscript as
invoked by imagemagick
- debian/patches/200-disable-ghostscript-formats.patch: disable
ghostscript handled types by default in policy.xml
We have reports of users who cant convert pdf-files any more, because policy.xml is forbidding it.
Which risk will we take if we change policy.xml back to former content?
And i think there is a typo in changelog. filename is 300-disable-ghostscript-formats.patch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2018-10-10: |  |  | [#9](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/9) |
| --- | --- | --- | --- |

Hello Hajo,

Tavis Ormandy has recently discovered enough flaws in ghostscript that the general consensus in the security community is that it is not safe to allow ghostscript to process untrusted inputs. See for example:

I think we should encourage switching to other document

Â Â Â Â formats that we have a better handle on securing. If you

Â Â Â Â do need untrusted ps, I think treating it the same as

Â Â Â Â shell script file you downloaded from the internet.

<https://www.openwall.com/lists/oss-security/2018/10/09/6>

ImageMagick is a well-known and widely-available attack vector.

Whoever would wish to use ImageMagick on untrusted inputs should prepare an AppArmor profile (or SELinux/SMACK/TOMOYO policy) to reflect their expected usage to restrict how much damage can be done, and modify the policy.xml file to explicitly allow using ghostscript through ImageMagick: <https://imagemagick.org/script/security-policy.php>

We debated if this was a change we wanted to make because we knew that it would inconvenience some of our users. However, we feel that someone who needs these tools should know the full risks of these tools and thus be able to mitigate the risks as appropriate in their own environment.

Thanks

Hello Hajo,
Tavis Ormandy has recently discovered enough flaws in ghostscript that the general consensus in the security community is that it is not safe to allow ghostscript to process untrusted inputs. See for example:
I think we should encourage switching to other document
formats that we have a better handle on securing. If you
do need untrusted ps, I think treating it the same as
shell script file you downloaded from the internet.
https://www.openwall.com/lists/oss-security/2018/10/09/6
ImageMagick is a well-known and widely-available attack vector.
Whoever would wish to use ImageMagick on untrusted inputs should prepare an AppArmor profile (or SELinux/SMACK/TOMOYO policy) to reflect their expected usage to restrict how much damage can be done, and modify the policy.xml file to explicitly allow using ghostscript through ImageMagick: https://imagemagick.org/script/security-policy.php
We debated if this was a change we wanted to make because we knew that it would inconvenience some of our users. However, we feel that someone who needs these tools should know the full risks of these tools and thus be able to mitigate the risks as appropriate in their own environment.
Thanks

[Mathew Hodson (mhodson)](https://launchpad.net/~mhodson)
on 2018-10-11

| **tags**: | removed: regression |
| --- | --- |
| Changed in imagemagick (Ubuntu Trusty): | |
| **importance**: | Undecided â†’ High |
| Changed in imagemagick (Ubuntu Xenial): | |
| **importance**: | Undecided â†’ High |
| Changed in imagemagick (Ubuntu Bionic): | |
| **importance**: | Undecided â†’ High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hajo Locke (hajo-locke)](https://launchpad.net/~hajo-locke) wrote on 2018-10-11: |  |  | [#10](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/comments/10) |
| --- | --- | --- | --- |

Hello Seth,

thanks for your answer. My expectations was that flaws are fixed in code and it's not necessary to block filetypes. Unfortunately in hosting/webapplications/shops ImageMagick+Ghostscript are widely used in Standardsoftware. Minutes after Updating some Servers we had reports about failing conversions.

We use apparmor-profiles to protect our internal structure. User itself is only able to read some needed paths and write to his own home. So this risk should be ok for us unless there is an exploit to gain root privileges. If i understand Tavis Ormandy's statement the right way, more flaws are highly probable.

Thanks,

Hajo

Hello Seth,
thanks for your answer. My expectations was that flaws are fixed in code and it's not necessary to block filetypes. Unfortunately in hosting/webapplications/shops ImageMagick+Ghostscript are widely used in Standardsoftware. Minutes after Updating some Servers we had reports about failing conversions.
We use apparmor-profiles to protect our internal structure. User itself is only able to read some needed paths and write to his own home. So this risk should be ok for us unless there is an exploit to gain root privileges. If i understand Tavis Ormandy's statement the right way, more flaws are highly probable.
Thanks,
Hajo

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/imagemagick/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [SH\_HL\_08\_Step1\_F028.png](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190921/%2Bfiles/SH_HL_08_Step1_F028.png)
  [Edit](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190921 "Change attachment details")
* [SH\_HL\_08\_Step1\_F029.png](https://bugs.launchpad.net/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190922/%2Bfiles/SH_HL_08_Step1_F029.png)
  [Edit](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Battachment/5190922 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/imagemagick/%2Bbug/1793485/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â€¢
[Take the tour](https://launchpad.net/%2Btour)
Â â€¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â€¢
[Terms of use](https://launchpad.net/legal)
Â â€¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â€¢
[Contact Launchpad Support](/feedback)
Â â€¢
[Blog](http://blog.launchpad.net/)
Â â€¢
[Careers](https://canonical.com/careers)
Â â€¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â€¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from usn.ubuntu.com_907dfba8_20250125_171253.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4034-1: ImageMagick vulnerabilities

25 June 2019

Several security issues were fixed in ImageMagick.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.04](/security/notices?release=disco)
* [Ubuntu 18.10](/security/notices?release=cosmic)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [imagemagick](/security/cves?package=imagemagick) - Image manipulation programs and library

## Details

It was discovered that ImageMagick incorrectly handled certain malformed

image files. If a user or automated system using ImageMagick were tricked

into opening a specially crafted image, an attacker could exploit this to

cause a denial of service or possibly execute code with the privileges of

the user invoking the program.

Due to a large number of issues discovered in GhostScript that prevent it

from being used by ImageMagick safely, the update for Ubuntu 18.10 and

Ubuntu 19.04 includes a default policy change that disables support for the

Postscript and PDF formats in ImageMagick. This policy can be overridden if

necessary by using an alternate ImageMagick policy configuration.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.14+dfsg-7ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.14%2Bdfsg-7ubuntu2.2)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.14+dfsg-7ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.14%2Bdfsg-7ubuntu2.2)
* [libmagick++-6.q16-8](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.14+dfsg-7ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.14%2Bdfsg-7ubuntu2.2)
* [libmagickcore-6.q16-6](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.14+dfsg-7ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.14%2Bdfsg-7ubuntu2.2)
* [libmagickcore-6.q16-6-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.14+dfsg-7ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.14%2Bdfsg-7ubuntu2.2)

##### Ubuntu 18.10

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.8+dfsg-1ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.8%2Bdfsg-1ubuntu2.2)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.8+dfsg-1ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.8%2Bdfsg-1ubuntu2.2)
* [libmagick++-6.q16-8](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.8+dfsg-1ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.8%2Bdfsg-1ubuntu2.2)
* [libmagickcore-6.q16-6](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.8+dfsg-1ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.8%2Bdfsg-1ubuntu2.2)
* [libmagickcore-6.q16-6-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.10.8+dfsg-1ubuntu2.2](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.10.8%2Bdfsg-1ubuntu2.2)

##### Ubuntu 18.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.7](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.7)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.7](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.7)
* [libmagick++-6.q16-7](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.7](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.7)
* [libmagickcore-6.q16-3](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.7](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.7)
* [libmagickcore-6.q16-3-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.7](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.7)

##### Ubuntu 16.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.14](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.14)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.14](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.14)
* [libmagick++-6.q16-5v5](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.14](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.14)
* [libmagickcore-6.q16-2](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.14](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.14)
* [libmagickcore-6.q16-2-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.14](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.14)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2017-12805](/security/CVE-2017-12805)
* [CVE-2017-12806](/security/CVE-2017-12806)
* [CVE-2018-14434](/security/CVE-2018-14434)
* [CVE-2018-15607](/security/CVE-2018-15607)
* [CVE-2018-16323](/security/CVE-2018-16323)
* [CVE-2018-16412](/security/CVE-2018-16412)
* [CVE-2018-16413](/security/CVE-2018-16413)
* [CVE-2018-16644](/security/CVE-2018-16644)
* [CVE-2018-16645](/security/CVE-2018-16645)
* [CVE-2018-17965](/security/CVE-2018-17965)
* [CVE-2018-17966](/security/CVE-2018-17966)
* [CVE-2018-18016](/security/CVE-2018-18016)
* [CVE-2018-18023](/security/CVE-2018-18023)
* [CVE-2018-18024](/security/CVE-2018-18024)
* [CVE-2018-18025](/security/CVE-2018-18025)
* [CVE-2018-18544](/security/CVE-2018-18544)
* [CVE-2018-20467](/security/CVE-2018-20467)
* [CVE-2019-10131](/security/CVE-2019-10131)
* [CVE-2019-10649](/security/CVE-2019-10649)
* [CVE-2019-10650](/security/CVE-2019-10650)
* [CVE-2019-11470](/security/CVE-2019-11470)
* [CVE-2019-11472](/security/CVE-2019-11472)
* [CVE-2019-11597](/security/CVE-2019-11597)
* [CVE-2019-11598](/security/CVE-2019-11598)
* [CVE-2019-7175](/security/CVE-2019-7175)
* [CVE-2019-7395](/security/CVE-2019-7395)
* [CVE-2019-7396](/security/CVE-2019-7396)
* [CVE-2019-7397](/security/CVE-2019-7397)
* [CVE-2019-7398](/security/CVE-2019-7398)
* [CVE-2019-9956](/security/CVE-2019-9956)

## Related notices

* [USN-6980-1](/security/notices/USN-6980-1)
* [USN-3785-1](/security/notices/USN-3785-1)
* [USN-6985-1](/security/notices/USN-6985-1)
* [USN-7053-1](/security/notices/USN-7053-1)
* [USN-7068-1](/security/notices/USN-7068-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

Â© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_c48dd6e2_20250125_171249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fissues%2F1268)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FImageMagick%2FImageMagick%2Fissues%2F1268)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ImageMagick%2FImageMagick)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ImageMagick](/ImageMagick)
/
**[ImageMagick](/ImageMagick/ImageMagick)**
Public

* [Notifications](/login?return_to=%2FImageMagick%2FImageMagick) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FImageMagick%2FImageMagick)
* [Star
   12.7k](/login?return_to=%2FImageMagick%2FImageMagick)

* [Code](/ImageMagick/ImageMagick)
* [Issues
  123](/ImageMagick/ImageMagick/issues)
* [Pull requests
  4](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

Additional navigation options

* [Code](/ImageMagick/ImageMagick)
* [Issues](/ImageMagick/ImageMagick/issues)
* [Pull requests](/ImageMagick/ImageMagick/pulls)
* [Discussions](/ImageMagick/ImageMagick/discussions)
* [Actions](/ImageMagick/ImageMagick/actions)
* [Security](/ImageMagick/ImageMagick/security)
* [Insights](/ImageMagick/ImageMagick/pulse)

# Potential Out-of-memory in function ReadBMPImage of coders/bmp.c and ReadDIBImage of codes/dib.c.Â #1268

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Potential Out-of-memory in function ReadBMPImage of coders/bmp.c and ReadDIBImage of codes/dib.c.](#top)#1268Copy linkLabels[bug](https://github.com/ImageMagick/ImageMagick/issues?q=state%3Aopen%20label%3A%22bug%22)[![@YangY-Xiao](https://avatars.githubusercontent.com/u/4388415?v=4&size=80)](/YangY-Xiao)
## Description

[![@YangY-Xiao](https://avatars.githubusercontent.com/u/4388415?v=4&size=48)](/YangY-Xiao)[YangY-Xiao](https://github.com/YangY-Xiao)opened [on Aug 27, 2018](https://github.com/ImageMagick/ImageMagick/issues/1268#issue-354236883)
### Prerequisites

* [ Y ] I have written a descriptive issue title
* [ Y ] I have verified that I am using the latest version of ImageMagick
* [ Y ] I have searched [open](https://github.com/ImageMagick/ImageMagick/issues) and [closed](https://github.com/ImageMagick/ImageMagick/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported

### Description

There are two missing check for number\_colors in function ReadBMPImage of coders/bmp.c and ReadDIBImage of codes/dib.c, which may lead to out-of-memory vulnerability.

```
 655         bmp_info.width=(ssize_t) ReadBlobLSBSignedLong(image);
 656         bmp_info.height=(ssize_t) ReadBlobLSBSignedLong(image);
 657         bmp_info.planes=ReadBlobLSBShort(image);
 658         bmp_info.bits_per_pixel=ReadBlobLSBShort(image);
 659         bmp_info.compression=ReadBlobLSBLong(image);
 660         bmp_info.image_size=ReadBlobLSBLong(image);
 661         bmp_info.x_pixels=ReadBlobLSBLong(image);
 662         bmp_info.y_pixels=ReadBlobLSBLong(image);
 663         bmp_info.number_colors=ReadBlobLSBLong(image);
 664         bmp_info.colors_important=ReadBlobLSBLong(image);

```

```
 528   dib_info.width=ReadBlobLSBSignedLong(image);
 529   dib_info.height=ReadBlobLSBSignedLong(image);
 530   dib_info.planes=ReadBlobLSBShort(image);
 531   dib_info.bits_per_pixel=ReadBlobLSBShort(image);
 532   if (dib_info.bits_per_pixel > 32)
 533     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
 534   dib_info.compression=ReadBlobLSBLong(image);
 535   dib_info.image_size=ReadBlobLSBLong(image);
 536   dib_info.x_pixels=ReadBlobLSBLong(image);
 537   dib_info.y_pixels=ReadBlobLSBLong(image);
 538   dib_info.number_colors=ReadBlobLSBLong(image);
 539   dib_info.colors_important=ReadBlobLSBLong(image);
 540   if ((dib_info.bits_per_pixel != 1) && (dib_info.bits_per_pixel != 4) &&
 541       (dib_info.bits_per_pixel != 8) && (dib_info.bits_per_pixel != 16) &&
 542       (dib_info.bits_per_pixel != 24) && (dib_info.bits_per_pixel != 32))
 543     ThrowReaderException(CorruptImageError,"ImproperImageHeader");

```

The patch for bmp and dib is similar. Below is the proposal patch for bmp.c.

```
        bmp_info.width=(ssize_t) ReadBlobLSBSignedLong(image);
        bmp_info.height=(ssize_t) ReadBlobLSBSignedLong(image);
        bmp_info.planes=ReadBlobLSBShort(image);
        bmp_info.bits_per_pixel=ReadBlobLSBShort(image);
        bmp_info.compression=ReadBlobLSBLong(image);
        bmp_info.image_size=ReadBlobLSBLong(image);
        bmp_info.x_pixels=ReadBlobLSBLong(image);
        bmp_info.y_pixels=ReadBlobLSBLong(image);
        bmp_info.number_colors=ReadBlobLSBLong(image);
+      if (bmp_info.number_colors > GetBlobSize(image))
+          ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
        bmp_info.colors_important=ReadBlobLSBLong(image);

```

* ImageMagick version: latest version
## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/ImageMagick/ImageMagick/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from usn.ubuntu.com_5f4f69a1_20250125_171252.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3785-1: ImageMagick vulnerabilities

4 October 2018

Several security issues were fixed in ImageMagick.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [imagemagick](/security/cves?package=imagemagick) - Image manipulation programs and library

## Details

Due to a large number of issues discovered in GhostScript that prevent

it from being used by ImageMagick safely, this update includes a

default policy change that disables support for the Postscript and

PDF formats in ImageMagick. This policy can be overridden if necessary

by using an alternate ImageMagick policy configuration.

It was discovered that several memory leaks existed when handling

certain images in ImageMagick. An attacker could use this to cause a

denial of service. ([CVE-2018-14434](/security/CVE-2018-14434), [CVE-2018-14435](/security/CVE-2018-14435), [CVE-2018-14436](/security/CVE-2018-14436),

[CVE-2018-14437](/security/CVE-2018-14437), [CVE-2018-16640](/security/CVE-2018-16640), [CVE-2018-16750](/security/CVE-2018-16750))

It was discovered that ImageMagick did not properly initialize a

variable before using it when processing MAT images. An attacker could

use this to cause a denial of service or possibly execute arbitrary

code. This issue only affected Ubuntu 18.04 LTS. ([CVE-2018-14551](/security/CVE-2018-14551))

It was discovered that an information disclosure vulnerability existed

in ImageMagick when processing XBM images. An attacker could use this

to expose sensitive information. ([CVE-2018-16323](/security/CVE-2018-16323))

It was discovered that an out-of-bounds write vulnerability existed

in ImageMagick when handling certain images. An attacker could use

this to cause a denial of service or possibly execute arbitrary code.

([CVE-2018-16642](/security/CVE-2018-16642))

It was discovered that ImageMagick did not properly check for errors

in some situations. An attacker could use this to cause a denial of

service. ([CVE-2018-16643](/security/CVE-2018-16643))

It was discovered that ImageMagick did not properly validate image

meta data in some situations. An attacker could use this to cause a

denial of service. ([CVE-2018-16644](/security/CVE-2018-16644))

It was discovered that ImageMagick did not prevent excessive memory

allocation when handling certain image types. An attacker could use

this to cause a denial of service. ([CVE-2018-16645](/security/CVE-2018-16645))

Sergej Schumilo and Cornelius Aschermann discovered that ImageMagick

did not properly check for NULL in some situations when processing

PNG images. An attacker could use this to cause a denial of service.

([CVE-2018-16749](/security/CVE-2018-16749))

USN-3681-1 fixed vulnerabilities in Imagemagick. Unfortunately,

the fix for [CVE-2017-13144](/security/CVE-2017-13144) introduced a regression in ImageMagick in

Ubuntu 14.04 LTS and Ubuntu 16.04 LTS. This update reverts the fix

for [CVE-2017-13144](/security/CVE-2017-13144) for those releases.

We apologize for the inconvenience.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.4](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.4)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.4](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.4)
* [libmagick++-6.q16-7](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.4](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.4)
* [libmagickcore-6.q16-3](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.4](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.4)
* [libmagickcore-6.q16-3-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.9.7.4+dfsg-16ubuntu6.4](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.9.7.4%2Bdfsg-16ubuntu6.4)

##### Ubuntu 16.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.13)
* [imagemagick-6.q16](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.13)
* [libmagick++-6.q16-5v5](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.13)
* [libmagickcore-6.q16-2](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.13)
* [libmagickcore-6.q16-2-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.8.9.9-7ubuntu5.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.8.9.9-7ubuntu5.13)

##### Ubuntu 14.04

* [imagemagick](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.7.7.10-6ubuntu3.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.7.7.10-6ubuntu3.13)
* [libmagick++5](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.7.7.10-6ubuntu3.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.7.7.10-6ubuntu3.13)
* [libmagickcore5](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.7.7.10-6ubuntu3.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.7.7.10-6ubuntu3.13)
* [libmagickcore5-extra](https://launchpad.net/ubuntu/%2Bsource/imagemagick)
  -
  [8:6.7.7.10-6ubuntu3.13](https://launchpad.net/ubuntu/%2Bsource/imagemagick/8%3A6.7.7.10-6ubuntu3.13)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2018-14434](/security/CVE-2018-14434)
* [CVE-2018-14435](/security/CVE-2018-14435)
* [CVE-2018-14436](/security/CVE-2018-14436)
* [CVE-2018-14437](/security/CVE-2018-14437)
* [CVE-2018-14551](/security/CVE-2018-14551)
* [CVE-2018-16323](/security/CVE-2018-16323)
* [CVE-2018-16640](/security/CVE-2018-16640)
* [CVE-2018-16642](/security/CVE-2018-16642)
* [CVE-2018-16643](/security/CVE-2018-16643)
* [CVE-2018-16644](/security/CVE-2018-16644)
* [CVE-2018-16645](/security/CVE-2018-16645)
* [CVE-2018-16749](/security/CVE-2018-16749)
* [CVE-2018-16750](/security/CVE-2018-16750)
* <https://launchpad.net/bugs/1793485>

## Related notices

* [USN-4034-1](/security/notices/USN-4034-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

Â© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.debian.org_20e0f9c0_20250125_171253.html ===


---

[[Date Prev](msg00246.html)][[Date Next](msg00248.html)]
[[Thread Prev](msg00246.html)][[Thread Next](msg00248.html)]
[[Date Index](maillist.html#00247)]
[[Thread Index](threads.html#00247)]

# [SECURITY] [DSA 4316-1] imagemagick security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4316-1] imagemagick security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 12 Oct 2018 20:55:21 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20181012205521.jpscas4wfyio3mwo%40seger.debian.org)Â [20181012205521.jpscas4wfyio3mwo@seger.debian.org](msg00247.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4316-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 12, 2018                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : imagemagick
CVE ID         : CVE-2018-16412 CVE-2018-16413 CVE-2018-16642 CVE-2018-16644
                 CVE-2018-16645

This update fixes several vulnerabilities in Imagemagick, a graphical
software suite. Various memory handling problems or incomplete input
sanitising have been found in the coders for BMP, DIB, PICT, DCM, CUT
and PSD.

For the stable distribution (stretch), these problems have been fixed in
version 8:6.9.7.4+dfsg-11+deb9u6.

We recommend that you upgrade your imagemagick packages.

For the detailed security status of imagemagick please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/imagemagick>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlvBBuEACgkQEMKTtsN8
TjZfXg/+LHxSz7Vm9pP1RtdT4HhcBoBr6uIDpAmhxfs65d9NgEiTAMbeTSK36Wpu
XalpZuGqsBeLTksJUx3D7A7Spc+qxRkpWCSFHfy3bypricHZGq28g60X0t2EfTYk
4qkV/BJwZY5Mov3xuzLw4fRDIj4iRsZPj7woD6jbXsfIbFHNIisHEyUrI+/Ob2mg
+4AQhqo2mbLRu3BRWJfYIBDvNe9kW+u2AlBA0o7tUssxxfURC//2D1zqFvTP40PK
BR91PwAuHZtyk8jgnMYIRbCifvDUGD31HvzB9R+BBOgEc/7rLJY2yLe7e/c5U30R
Cmh9TibMKsnuaidtIhiKqJxctxu4wf6Dt6VMhb60HDpnbQnqcRCP4LNsaBMBDdlY
03vLoy8WYH9o+2BxGoROTRSQJIpz/do4QoE8zh8R90vTLNXECXFlFkwwTcFLDMv5
X6V84UiN6WuN9/hK00XbMe8272fXk+ndC2wqkIpkj4oxKqQyO9Ztmzezf2MLlTpD
aTe8QgJD+otyJ23hDKugaNivr+9VrgiFXm8iDSNl4n+BpRFC2fcMKL3pgeDNNgFp
PIyDYv+tDLfBWie+7bjn27oQIdZcxd1IhGwfHjPDILQFuQYDB9ryLsfWvXaT9tDw
NK26jD5aRuFhZFpEhPqp612VcD3ezNX4ZXlqtRbwVbcD3R7dimg=
=Osgs
-----END PGP SIGNATURE-----

```

---


