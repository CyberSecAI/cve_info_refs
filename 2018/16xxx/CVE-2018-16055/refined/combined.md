=== Content from doddsecurity.com_9648e20a_20250125_104224.html ===

[Skip to the content](#site-content)

Search

[Dodd Security](https://doddsecurity.com)

Offensive Security and Application Security Perspectives

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

[Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

# Command Injection on pfSense Firewalls

Posted by [Reginald Dodd](https://doddsecurity.com/author/regg/) on [December 9, 2018](https://doddsecurity.com/190/command-injection-on-pfsense-firewalls/)

![](https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post4-816x427.png)

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

Name: [pfSense Firewall](https://www.pfsense.org/)

Vendor: Netgate

Vulnerability: Command Injection

Affected Versions: Versions before 2.4.4

CVE ID: [CVE-2018-16055](https://www.pfsense.org/security/advisories/pfSense-SA-18_08.webgui.asc)

An authenticated command injection was discovered on pfSense firewalls. Anyone with access to status\_interfaces.php could relinquish a DHCP lease and inject arbitrary commands under the context of the root user.

I have pfSense’s management interface at 10.10.10.10 in Virtual Box. If you navigate to status\_interfaces.php, check Relinquish Lease, then click the Release button there are two vulnerable HTTP POST parameters.

![](https://doddsecurity.com/wp-content/uploads/2018/12/pfsense1.png)

*For demo purposes, I assigned the WAN interface a random IP because it can’t reach the internet anyway.*

The parameters “ipv” and “ifdescr” are both vulnerable to command injection.

![](https://doddsecurity.com/wp-content/uploads/2018/12/pfsense2.png)

For this example, I am only going to exploit the parameter “ifdescr”. I will inject the id command and pipe the output to a netcat listener.

![](https://doddsecurity.com/wp-content/uploads/2018/12/pfsense4.png)

The listener captured the output, and I can execute commands as the root user.

![](https://doddsecurity.com/wp-content/uploads/2018/12/pfsense5.png)

---

#### Root Cause

Their Github commit with the fixes is located [here](https://github.com/pfsense/pfsense/commit/c45cac34db914f175dc3cbfed8119d08d08aa519). The developer did not use escapeshellarg() on $ifdescr which went into $conf\_file and $ipv (user-controlled parameters) before using them in a shell.

![](https://doddsecurity.com/wp-content/uploads/2018/12/pfsense6-1.png)

---

#### Timeline

* August 26, 2018 – The vulnerability details were sent to the vendor.
* August 27, 2018 – The vendor confirmed the vulnerabilities.
* September 24, 2018 – The vendor released version 2.4.4 with the fixes.
* December 9, 2018 – Published (this post).

[command injection](https://doddsecurity.com/tag/command-injection/)[cve](https://doddsecurity.com/tag/cve/)[remote command execution](https://doddsecurity.com/tag/remote-command-execution/)[responsible disclosure](https://doddsecurity.com/tag/responsible-disclosure/)
[![](https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=100&d=mm&r=g)](https://doddsecurity.com/author/regg/)
#### [Reginald Dodd](https://doddsecurity.com/author/regg/)

Reginald is an information security professional with experience that spans numerous industries. He has discovered unknown vulnerabilities in numerous products. He has earned a Master’s degree in Information Security and Assurance, GIAC certifications, and Offensive Security certifications.

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

### The Author

![](https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped.png)

Hi, I’m Reginald Dodd, an offensive security engineer and the author of this blog. This is where I document my perspectives on offensive security and application security in my personal time.

Read my [About Me](http://doddsecurity.com/about/) page for more on me.

### Follow

* [GitHub](https://github.com/doddr)
* [LinkedIn](https://www.linkedin.com/in/reginalddodd/)
* [RSS](https://doddsecurity.com/feed/)
### Categories

* [General](https://doddsecurity.com/category/general/)
* [Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

To the top

© 2025 [Dodd Security](https://doddsecurity.com/)


