- **Root cause of vulnerability:** Improper rendering/escaping of diff location lines (`@@`) in the Merge Request `Changes` view. Specifically, when the lines contain matching `<` and `>` characters, which are common in many programming languages, they are rendered as HTML elements or stripped instead of being displayed as plain text.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability due to insufficient sanitization of user-controlled input.
- **Impact of exploitation:** An attacker could inject malicious HTML or JavaScript code into a file, which would then be executed in the context of a victim's browser when they view the merge request's changes. This could lead to a variety of attacks such as session hijacking, defacement, or phishing.
- **Attack vectors:**
    - An attacker creates a source file with malicious HTML or JavaScript in a line, specifically within a hunk location (`@@`) in a merge request's diff.
    - The attacker commits this file and creates a merge request.
    - When another user views the merge request's `Changes` tab, the injected code gets executed in the user's browser.
- **Required attacker capabilities/position:**
    - Ability to create/modify files in a project.
    - Ability to create a merge request.