The content is related to CVE-2018-16234.

**Root cause of vulnerability:**
The WhatWeb tool does not properly sanitize the output when using the `--log-json` option. Specifically, it includes the URL from the `Location` header in the JSON output without encoding it. This allows an attacker to inject JavaScript into the output if the target redirects to a URL that contains malicious code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- Lack of output sanitization or encoding in the JSON log file.

**Impact of exploitation:**
- If a user opens the generated JSON log file using a tool that interprets the content (such as a browser), the injected JavaScript code will execute. This could allow an attacker to perform actions like stealing cookies, redirecting users to malicious sites, or performing other client-side attacks.

**Attack vectors:**
- The attacker needs to control the `Location` header of a target website that is scanned by WhatWeb.
- The attacker uses a crafted URL in the Location header, which contains malicious JavaScript code.
- The WhatWeb user must use the `--log-json` option to generate the vulnerable output.
- The generated log file must be opened with a tool that interprets/renders the json data, e.g., a web browser.

**Required attacker capabilities/position:**
- The attacker needs to have a website/server under their control, where they can configure the `Location` header of a HTTP response.
- The attacker needs a WhatWeb user to scan the attacker controlled website using the `log-json` option, and then open the generated log file in a vulnerable tool.