The provided content is related to CVE-2018-16242.

**Root cause of vulnerability:**
The vulnerability stems from the oBike lock using a predictable 32-bit value, representing milliseconds since the chip was powered on, as a challenge (`keySource`). This value is not randomly generated as expected.

**Weaknesses/vulnerabilities present:**
1. **Predictable nonce/challenge:** The `keySource` value is predictable, allowing an attacker to generate and store the corresponding `keys` values, enabling replay attacks.
2. **Replay attack vulnerability:**  The `keys` value, derived from the `keySource` and `encKey`, remains constant for the same input. This allows an attacker to unlock the bike by replaying a previously captured `keys` value.
3. **BLE command for chip reset:** A discovered BLE command can reset the chip, causing predictable `keySource` values within a narrow time window, which simplifies the replay attack.

**Impact of exploitation:**
An attacker can unlock oBikes without authorization, circumventing ride fees.

**Attack vectors:**
1. **Capture the `keySource`, `encKey` and the corresponding `keys` values:** The attacker needs to capture the BLE communication between the bike lock and the mobile app during the unlocking process.
2. **Store and replay:**  The attacker can then replay the captured `keys` value via BLE to the bike lock, which will unlock the bike. This can be done offline, with no need to communicate with the oBike backend.

**Required attacker capabilities/position:**
- Proximity to the oBike to intercept BLE communication.
- Ability to capture and replay BLE communication.
- Knowledge of the oBike protocol or usage of available tools.