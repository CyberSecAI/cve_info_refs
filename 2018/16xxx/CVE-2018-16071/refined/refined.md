```
{
  "vulnerability": {
    "cveID": "CVE-2018-16071",
    "description": "There is a use-after-free in VP9 processing in WebRTC. In the method RtpFrameReferenceFinder::ManageFrameVp9 the following code occurs:\n\n auto gof_info_it = gof_info_.find((codec_header.temporal_idx == 0)\n                                          ? codec_header.tl0_pic_idx - 1\n                                          : codec_header.tl0_pic_idx);\n\n   ... // snip\n\n    info = &gof_info_it->second;\n  }\n\n  // Clean up info for base layers that are too old.\n  uint8_t old_tl0_pic_idx = codec_header.tl0_pic_idx - kMaxGofSaved;\n  auto clean_gof_info_to = gof_info_.lower_bound(old_tl0_pic_idx);\n  gof_info_.erase(gof_info_.begin(), clean_gof_info_to);\n\n  FrameReceivedVp9(frame->id.picture_id, info);\n\ntl0_pic_idx is extracted from the incoming packet, and it if is higher than any picture id that exists in gof_info_, the entire vector will be erased, and info will be used in the call FrameReceivedVp9 even though it has been freed.\n",
    "affectedSoftware": [
      "Chromium",
      "Google Chrome"
    ],
    "rootCause": "The vulnerability is caused by a use-after-free error in the VP9 processing within the WebRTC component. Specifically, a frame's information (`info`) is accessed after the memory it points to has been deallocated (freed).",
     "weaknesses": [
      "Use-after-free"
    ],
    "impact": "A remote attacker could potentially execute arbitrary code or cause a denial of service by triggering the use-after-free vulnerability.",
    "attackVector": "The vulnerability can be triggered by sending specially crafted RTP packets containing VP9 encoded video data. The `tl0_pic_idx` field in the packet header is manipulated to cause the premature release of the frame information.",
    "requiredCapabilities": "An attacker needs the ability to send network packets to the vulnerable WebRTC implementation. No user interaction is required beyond receiving the malicious video stream.",
    "additionalDetails": "The vulnerability resides in the `RtpFrameReferenceFinder::ManageFrameVp9` method. The `gof_info_` map is used to store frame information (`GofInfo`). If the `tl0_pic_idx` from an incoming packet is greater than existing IDs in the map, the map is cleared, and the previously referenced `info` pointer becomes a dangling pointer. Subsequent usage of `info` in `FrameReceivedVp9` results in a use-after-free condition."
  }
}
```