- **Root cause of vulnerability:** Improper sanitization of user-supplied input in the "摘要" (abstract) and "详情" (details) fields when adding or editing user content.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS) vulnerability. Specifically, it appears to be a stored XSS vulnerability, as the malicious script is saved in the database and executed when the content is viewed.
- **Impact of exploitation:** Arbitrary JavaScript code execution within the context of the victim's browser. This could lead to various malicious activities, including session hijacking, cookie theft, defacement of the website, or redirection to malicious sites. The attacker could also potentially perform actions on behalf of the user.
- **Attack vectors:** By posting a content containing XSS payload in "摘要" and "详情" fields via the user content addition page (e.g., `https://www.html-js.cn/users/userAddContent`). The stored XSS payload is then triggered when viewing the content list page (e.g. `https://www.html-js.cn/users/userContents`). An attacker can also inject the XSS payload while editing existing content, which would also lead to XSS execution upon content view.
- **Required attacker capabilities/position:** The attacker must be a logged-in user with the ability to add or edit user-generated content.