=== Content from mantisbt.org_bac26334_20250125_034727.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D24731)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=24731)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0024731 | mantisbt | security | public | 2018-09-03 15:25 | 2018-09-25 04:19 |
|  | | | | | |
|
| Reporter | [geeknik](https://mantisbt.org/bugs/view_user_page.php?id=45947) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Target Version | 2.17.1 | Fixed in Version | 2.17.1 |  | |
|  | | | | | |
|
| Summary | 0024731: CVE-2018-16514: Reflected XSS in view\_filters\_page.php via core/filter\_form\_api.php | | | | |
| Description | On sites that do not have CORS security headers or poorly-configured CORS headers (or for users of Internet Explorer 10, 11 and maybe Edge?), there exists a reflected XSS flaw in view\_filters\_page.php, which I believe is enabled by bad code in core/filter\_form\_api.php starting at Line [0002779](/bugs/view.php?id=2779 "[closed] Programming interface to enter bugs..."): <https://github.com/mantisbt/mantisbt/blob/006cd0cd90c37097e1a065fd3e59ce2534490834/core/filter_form_api.php#L2779>  On sites that do have properly configured CORS headers (and browsers that care about CORS headers), this will show up in the Firefox web console: Content Security Policy: The page’s settings blocked the loading of a resource at self (“script-src”). Source: onmouseover attribute on A element.  Even still, the code is still reflected back across the TD cells despite the browser refusing to execute it: <tr><td class="small-caption category "><a href="/bugs/view\_filters\_page.php/"onmouseover='prompt(1)'bad="?for\_screen=1&static=1&view\_type=simple" id="reporter\_id\_filter" class="dynamic-filter-expander">Reporter</a> | | | | |
| Steps To Reproduce | [https://mantisbt.org/bugs/view\_filters\_page.php/"onmouseover%3d'prompt(1)'bad%3d](https://mantisbt.org/bugs/view_filters_page.php/%22onmouseover%3D%27prompt%281%29%27bad%3D)" | | | | |
| Additional Information | I've attached a screenshot showing the flaw being reproduced on this very site with IE 11.0.9600.19100. | | | | |
| Tags | No tags attached. | | | | |
| Attached Files |  | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=24731&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=24731&graph=dependency)

| related to | [0024580](view.php?id=24580) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2018-13055: Reflected XSS in view filters page |
| --- | --- | --- | --- | --- |

#### Activities

| [geeknik](https://mantisbt.org/bugs/view_user_page.php?id=45947)   [geeknik](https://mantisbt.org/bugs/view_user_page.php?id=45947)  2018-09-03 15:26  reporter    [~0060596](view.php?id=24731#c60596 "Direct link to note") | Screenshot.   [Screenshot\_2018-09-03\_13-51-43.png](file_download.php?file_id=8142&type=bug) (139,214 bytes)      [Screenshot\_2018-09-03\_13-51-43.png](file_download.php?file_id=8142&type=bug) (139,214 bytes) |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-04 04:36  developer    [~0060597](view.php?id=24731#c60597 "Direct link to note") | Thanks for the detailed bug report. We will look into it.  Did you request a CVE for this ? If not, should we take care of it ? How would you like to be credited for the finding ? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-04 11:10  developer    [~0060598](view.php?id=24731#c60598 "Direct link to note") | This is very similar to [0024580](/bugs/view.php?id=24580 "[closed] CVE-2018-13055: Reflected XSS in view filters page") - the attack vector is slightly different (onmouseover) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-04 11:27  developer    [~0060599](view.php?id=24731#c60599 "Direct link to note") | I can reproduce the problem. It is indeed the same root cause as [0024580](/bugs/view.php?id=24580 "[closed] CVE-2018-13055: Reflected XSS in view filters page"), i.e. use of `$_SERVER['PHP_SELF']` to specify the fallback page. Unfortunately the earlier fix (calling *string\_sanitize\_url*) did not fully address the vulnerability.  It's worth mentioning that the same vulnerability also is also present in manage\_filter\_edit\_page.php : [http://path.to/mantisbt/manage\_filter\_edit\_page.php/%22onmouseover%3d'alert("XSS")'bad%3d%22?filter\_id=7621](http://path.to/mantisbt/manage_filter_edit_page.php/%22onmouseover%3D%27alert%28%22XSS%22%29%27bad%3D%22?filter_id=7621)  I think we just need to get rid of using PHP\_SELF. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-05 06:22  developer    [~0060602](view.php?id=24731#c60602 "Direct link to note") | CVE Request 563901 sent to MITRE |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-05 08:12  developer    [~0060603](view.php?id=24731#c60603 "Direct link to note") | Proposed fix, please review   [0001-Use-SCRIPT\_NAME-instead-of-PHP\_SELF.patch](file_download.php?file_id=8144&type=bug) (1,104 bytes)    ``` From 66091a42626631a3063774eb0fb8a4218ab22fd4 Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Wed, 5 Sep 2018 01:39:06 +0200 Subject: [PATCH] Use SCRIPT_NAME instead of PHP_SELF  Fix XSS in view_filters_page.php and manage_filter_edit_page.php  Fixes #24731 ---  core/filter_form_api.php | 5 ++---  1 file changed, 2 insertions(+), 3 deletions(-)  diff --git a/core/filter_form_api.php b/core/filter_form_api.php index 05d5c39e1..7b38752fd 100644 --- a/core/filter_form_api.php +++ b/core/filter_form_api.php @@ -2393,10 +2393,9 @@ function filter_form_draw_inputs( $p_filter, $p_for_screen = true, $p_static = f  	}    	if( null === $p_static_fallback_page ) { -		$p_static_fallback_page = $_SERVER['PHP_SELF']; -		$p_static_fallback_page = string_sanitize_url( $_SERVER['PHP_SELF'] ); +		$p_static_fallback_page = $_SERVER['SCRIPT_NAME'];  	} -	$t_filters_url = $p_static_fallback_page; +	$t_filters_url = helper_mantis_url( $p_static_fallback_page );  	$t_get_params = $_GET;  	$t_get_params['for_screen'] = $p_for_screen;  	$t_get_params['static'] = ON; --  2.16.1.windows.1   ```   [0001-Use-SCRIPT\_NAME-instead-of-PHP\_SELF.patch](file_download.php?file_id=8144&type=bug) (1,104 bytes) |
|  | |
| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2018-09-05 09:26  developer    [~0060604](view.php?id=24731#c60604 "Direct link to note") | Did a few tests. Fix looks good, also concerning [0024580:0060220](/bugs/view.php?id=24580#c60220 "0024580: [2018-07-05 17:10] atrol") |
|  | |
| [geeknik](https://mantisbt.org/bugs/view_user_page.php?id=45947)   [geeknik](https://mantisbt.org/bugs/view_user_page.php?id=45947)  2018-09-05 10:06  reporter    [~0060605](view.php?id=24731#c60605 "Direct link to note") | dregad, can you credit Brian Carpenter - Geeknik Labs? Thank you. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2018-09-05 10:48  developer    [~0060606](view.php?id=24731#c60606 "Direct link to note") | CVE-2018-16514 assigned |
|  | |

#### Related Changesets

| MantisBT: master-2.17 66091a42  2018-09-04 15:39  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=24200) [Diff](https://github.com/mantisbt/mantisbt/commit/66091a42626631a3063774eb0fb8a4218ab22fd4) | Use SCRIPT\_NAME instead of PHP\_SELF | | Affected Issues[0024731](/bugs/view.php?id=24731 "[closed] CVE-2018-16514: Reflected XSS in view_filters_page.php via core/filter_form_api.php") |
| --- | --- | --- | --- |
| mod - core/filter\_form\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/66091a42626631a3063774eb0fb8a4218ab22fd4) [File](https://github.com/mantisbt/mantisbt/blob/66091a42626631a3063774eb0fb8a4218ab22fd4/core/filter_form_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1896 seconds



=== Content from github.com_9157fd00_20250126_054547.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a42626631a3063774eb0fb8a4218ab22fd4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a42626631a3063774eb0fb8a4218ab22fd4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/66091a42626631a3063774eb0fb8a4218ab22fd4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Use SCRIPT\_NAME instead of PHP\_SELF

[Browse files](/mantisbt/mantisbt/tree/66091a42626631a3063774eb0fb8a4218ab22fd4)
Browse the repository at this point in the history

```
Fix XSS in view_filters_page.php and manage_filter_edit_page.php

Fixes #24731
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Sep 4, 2018

1 parent
[c6b2dd5](/mantisbt/mantisbt/commit/c6b2dd5b9e8b2f57b01a978a018e879269707be5)

commit 66091a4

Showing
**1 changed file**
with
**2 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

5 changes: 2 additions & 3 deletions

5
[core/filter\_form\_api.php](#diff-09c02a25efdf9d3f1c303bd5810247961613e21885c2729f24de8e09381e6330 "core/filter_form_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/66091a42626631a3063774eb0fb8a4218ab22fd4/core/filter_form_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2393,10 +2393,9 @@ function filter\_form\_draw\_inputs( $p\_filter, $p\_for\_screen = true, $p\_static = f |
|  |  | } |
|  |  |  |
|  |  | if( null === $p\_static\_fallback\_page ) { |
|  |  | $p\_static\_fallback\_page = $\_SERVER['PHP\_SELF']; |
|  |  | $p\_static\_fallback\_page = string\_sanitize\_url( $\_SERVER['PHP\_SELF'] ); |
|  |  | $p\_static\_fallback\_page = $\_SERVER['SCRIPT\_NAME']; |
|  |  | } |
|  |  | $t\_filters\_url = $p\_static\_fallback\_page; |
|  |  | $t\_filters\_url = helper\_mantis\_url( $p\_static\_fallback\_page ); |
|  |  | $t\_get\_params = $\_GET; |
|  |  | $t\_get\_params['for\_screen'] = $p\_for\_screen; |
|  |  | $t\_get\_params['static'] = ON; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `66091a4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a42626631a3063774eb0fb8a4218ab22fd4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_7b46b536_20250126_054549.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1562 seconds



=== Content from github.com_df8380ab_20250126_054549.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a4262)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a4262)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/66091a42626631a3063774eb0fb8a4218ab22fd4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Use SCRIPT\_NAME instead of PHP\_SELF

[Browse files](/mantisbt/mantisbt/tree/66091a42626631a3063774eb0fb8a4218ab22fd4)
Browse the repository at this point in the history

```
Fix XSS in view_filters_page.php and manage_filter_edit_page.php

Fixes #24731
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Sep 4, 2018

1 parent
[c6b2dd5](/mantisbt/mantisbt/commit/c6b2dd5b9e8b2f57b01a978a018e879269707be5)

commit 66091a4

Showing
**1 changed file**
with
**2 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

5 changes: 2 additions & 3 deletions

5
[core/filter\_form\_api.php](#diff-09c02a25efdf9d3f1c303bd5810247961613e21885c2729f24de8e09381e6330 "core/filter_form_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/66091a42626631a3063774eb0fb8a4218ab22fd4/core/filter_form_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2393,10 +2393,9 @@ function filter\_form\_draw\_inputs( $p\_filter, $p\_for\_screen = true, $p\_static = f |
|  |  | } |
|  |  |  |
|  |  | if( null === $p\_static\_fallback\_page ) { |
|  |  | $p\_static\_fallback\_page = $\_SERVER['PHP\_SELF']; |
|  |  | $p\_static\_fallback\_page = string\_sanitize\_url( $\_SERVER['PHP\_SELF'] ); |
|  |  | $p\_static\_fallback\_page = $\_SERVER['SCRIPT\_NAME']; |
|  |  | } |
|  |  | $t\_filters\_url = $p\_static\_fallback\_page; |
|  |  | $t\_filters\_url = helper\_mantis\_url( $p\_static\_fallback\_page ); |
|  |  | $t\_get\_params = $\_GET; |
|  |  | $t\_get\_params['for\_screen'] = $p\_for\_screen; |
|  |  | $t\_get\_params['static'] = ON; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `66091a4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F66091a4262) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


