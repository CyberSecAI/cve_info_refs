=== Content from jvndb.jvn.jp_1392841a_20250126_010857.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2019/08/28

| [[Japanese]](/ja/contents/2018/JVNDB-2018-000127.html) | |
| --- | --- |
| JVNDB-2018-000127 | |
| EC-CUBE vulnerable to open redirect | |
| Overview | |
| EC-CUBE provided by LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains an open redirect vulnerability (CWE-601). | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [4.7](/cvss/en/v3.html#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N) (Medium) [IPA Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Changed * Confidentiality Impact: None * Integrity Impact: Low * Availability Impact: None  **CVSS V2 Severity:Base Metrics [2.6](/cvss/en/v2.html#AV:N/AC:H/Au:N/C:N/I:P/A:N) (Low) [IPA Score]**  * Access Vector: Network * Access Complexity: High * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None | |
| Affected Products | |
|  | |
| LOCKON CO.,LTD  * EC-CUBE 3.0.0 * EC-CUBE 3.0.1 * EC-CUBE 3.0.2 * EC-CUBE 3.0.3 * EC-CUBE 3.0.4 * EC-CUBE 3.0.5 * EC-CUBE 3.0.6 * EC-CUBE 3.0.7 * EC-CUBE 3.0.8 * EC-CUBE 3.0.9 * EC-CUBE 3.0.10 * EC-CUBE 3.0.11 * EC-CUBE 3.0.12 * EC-CUBE 3.0.12-p1 * EC-CUBE 3.0.13 * EC-CUBE 3.0.14 * EC-CUBE 3.0.15 * EC-CUBE 3.0.16 | |
|  | |
| Impact | |
| When accessing a specially crafted page, the user may be redirected to an arbitrary website. As a result, the user may become a victim of a phishing attack. | |
| Solution | |
| [Update the software] | |
| Vendor Information | |
| LOCKON CO.,LTD  * LOCKON CO.,LTD : [LOCKON CO.,LTD. website](https://www.ec-cube.net/info/weakness/20181113/) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Improper Input Validation(CWE-20)](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE20) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2018-16191](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16191) | |
| References | |
| 1. JVN : [JVN#25359688](https://jvn.jp/en/jp/JVN25359688/index.html) 2. National Vulnerability Database (NVD) : [CVE-2018-16191](https://nvd.nist.gov/vuln/detail/CVE-2018-16191) | |
| Revision History | |
| * [2018/11/28] | |

| --- | |
| --- | --- |
| Date Public | 2018/11/28 |
| Date First Published | 2018/11/28 |
| Date Last Updated | 2019/08/28 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvn.jp_72665943_20250124_123938.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2018/11/28  Last Updated:2018/11/28
# JVN#25359688 EC-CUBE vulnerable to open redirect

## Overview

EC-CUBE contains an open redirect vulnerability.

## Products Affected

* EC-CUBE 3.0.0
* EC-CUBE 3.0.1
* EC-CUBE 3.0.2
* EC-CUBE 3.0.3
* EC-CUBE 3.0.4
* EC-CUBE 3.0.5
* EC-CUBE 3.0.6
* EC-CUBE 3.0.7
* EC-CUBE 3.0.8
* EC-CUBE 3.0.9
* EC-CUBE 3.0.10
* EC-CUBE 3.0.11
* EC-CUBE 3.0.12
* EC-CUBE 3.0.12-p1
* EC-CUBE 3.0.13
* EC-CUBE 3.0.14
* EC-CUBE 3.0.15
* EC-CUBE 3.0.16

## Description

EC-CUBE provided by LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains an open redirect vulnerability ([CWE-601](//cwe.mitre.org/data/definitions/601.html)).

## Impact

When accessing a specially crafted page, the user may be redirected to an arbitrary website. As a result, the user may become a victim of a phishing attack.

## Solution

**Update the software**

Update to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| LOCKON CO.,LTD. | [Vulnerable](491122/index.html) | 2018/11/28 | [LOCKON CO.,LTD. website](https://www.ec-cube.net/info/weakness/20181113/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N
Base Score:
4.7

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:H/Au:N/C:N/I:P/A:N
Base Score:
2.6

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

LOCKON CO.,LTD. reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and LOCKON CO.,LTD. coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2018-16191](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16191) |
| JVN iPedia | [JVNDB-2018-000127](https://jvndb.jvn.jp/jvndb/JVNDB-2018-000127) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.



=== Content from www.ec-cube.net_3efd9d5f_20250124_123939.html ===


| | EC-CUBE 3.0系のオープンリダイレクト脆弱性について | | --- |  |  | | --- | | **更新履歴** | | 2018/11/13 10:30 告知ページの公開。 2018/11/27 16:00 「EC-CUBEのバージョンアップを行う場合」の項を追加。 | |  | | [本件の概要](#summery)   [修正方法](#modifi) | | **EC-CUBE オープンリダイレクト脆弱性に関する修正のお知らせ** | | いつもEC-CUBEをご利用いただきまして、誠にありがとうございます。   **EC-CUBE 3.0.0～3.0.16**に、**1件**の脆弱性があることが判明いたしました。  （本脆弱性における被害報告は現時点でございません）   脆弱性そのものは、EC-CUBEのバージョンアップ、または修正ファイルの反映により  すぐに解決するものです。   皆様にはお手数おかけし誠に申し訳ございません。  本件は、他の脆弱性との組み合わせでのみ発生するため、緊急度は「低」となりますが、  できるだけ速やかに対応をお願いします。 | |  | | **脆弱性の概要** | | 1.オープンリダイレクト脆弱性   危険度： 低  不具合が存在するEC-CUBEのバージョン: 3.0.0～3.0.16  ※EC-CUBE 3.0.3以前をご利用の方へ   EC-CUBE 3.0.3以前のEC-CUBEには、本件以外にも[複数の脆弱性](http://www.ec-cube.net/info/weakness/)がございます。  EC-CUBEのバージョンを3.0.4以上にバージョンアップした上で、  本件の修正を反映してください。 | |  | | ※開発環境がある場合は、まず開発環境でお試しください。  皆様の環境に合わせて、以下修正方法よりいずれかを選択ください。 | | **修正方法1：EC-CUBEのバージョンアップを行う場合** | | EC-CUBE 3.0.17以降の最新版にバージョンアップしていただくことで、本件の脆弱性は修正されます。  以下を参考に、EC-CUBEのバージョンアップをお願い致します。  <http://doc.ec-cube.net/quickstart_update> | |  | | **修正方法2：修正用の差分ファイルを利用する場合** | | 以下の手順に従って、修正ファイルの反映をお願いいたします。  1. 修正ファイルのダウンロード         ご利用中のEC-CUBEのバージョンに該当する修正ファイルをダウンロードしてください。         [バージョンの確認方法]     EC-CUBE管理画面へログイン後、設定>システム設定>システム情報にて確認できます。     カスタマイズによってシステム情報が表示されない場合は、以下のファイルをご確認ください。            ▼src/Eccube/Common/Constant.php(31行目付近)        < 例>-------------------------------------     /\*\*     \* EC-CUBE VERSION.     \*/     const VERSION = '3.0.16';     -----------------------------------------     上記の例の場合、EC-CUBEのバジョンは3.0.16となります。             [修正ファイル]        [EC-CUBE 3.0.4用](./eccube3.0.4_20181022_update_files.zip) (md5:1cfdc6c0d3f54fa8bbde9f36c4c897ba)        [EC-CUBE 3.0.5用](./eccube3.0.5_20181022_update_files.zip) (md5:cd2266eca557ce817d76f3a369106fa8)        [EC-CUBE 3.0.6用](./eccube3.0.6_20181022_update_files.zip) (md5:22c91f4c60c5cc1e52885fe7c47e9e3e)        [EC-CUBE 3.0.7用](./eccube3.0.7_20181022_update_files.zip) (md5:1770b347ee76c33ac327fdc73bdcc8d8)        [EC-CUBE 3.0.8用](./eccube3.0.8_20181022_update_files.zip) (md5:0c30e41e514b73e49ff4bd15384815ee)        [EC-CUBE 3.0.9用](./eccube3.0.9_20181022_update_files.zip) (md5:101405c88d7b0e3cddc9137523c5b94e)        [EC-CUBE 3.0.10用](./eccube3.0.10_20181022_update_files.zip) (md5:9ee827d5ff3cf14672edf3baa380a1d4)        [EC-CUBE 3.0.11用](./eccube3.0.11_20181022_update_files.zip) (md5:12f57c87836cd25a2df5994420481179)        [EC-CUBE 3.0.12用](./eccube3.0.12_20181022_update_files.zip) (md5:b1fc155d524119145b29cf0602f8e7b9)        [EC-CUBE 3.0.13用](./eccube3.0.13_20181022_update_files.zip) (md5:d3b99d4aeb942fb71f2ed713022758c6)        [EC-CUBE 3.0.14用](./eccube3.0.14_20181022_update_files.zip) (md5:ece6c28918c8f3b28551d1a4ce06180b)        [EC-CUBE 3.0.15用](./eccube3.0.15_20181022_update_files.zip) (md5:1ac619e2df9966710cadc260a0c4894e)        [EC-CUBE 3.0.16用](./eccube3.0.16_20181022_update_files.zip) (md5:a0ee8dd6e3b28926fe356edddabd7bfb)         ※EC-CUBE 3.0.3以前のEC-CUBEには、本件以外にも[複数の脆弱性](http://www.ec-cube.net/info/weakness/)がございます。    ※EC-CUBEのバージョンを3.0.4以上にバージョンアップした上で、本件の修正を反映してください。 2. EC-CUBEファイルのバックアップ        EC-CUBEファイル全体のバックアップを行ってください。 3. 修正ファイルの反映        ダウンロードしたファイルを解凍し、EC-CUBEファイルに上書きをしてください。         ※修正ファイルはディレクトリ構造になっているため、ルートディレクトリからそのまま上書きが可能です。    ※EC-CUBE本体のカスタマイズをしている場合、修正箇所の差分をご確認のうえ反映をお願いします。    ※開発環境がある場合は、開発環境での反映・動作確認を行った後に、本番環境への反映をおすすめします。 4. 動作確認        フロント画面および管理画面のログイン画面にて、正常にログインができるかどうかを確認してください。 | |  | | **修正方法3：修正差分を確認して適宜反映する場合** | | EC-CUBE本体のソースコードをカスタマイズされている方向けです。  下記のコード差分情報を参照して頂き、必要な箇所に修正を反映してください。   1) 修正ファイルをダウンロードし、  src/Eccube/Security/Http/Authentication/EccubeAuthenticationFailureHandler.php  src/Eccube/Security/Http/Authentication/EccubeAuthenticationSuccessHandler.php  の2ファイルをコピーしてください。   2) src/Eccube/Application.phpを、以下の差分情報に従って必要箇所を修正してください    [コード差分情報のダウンロードはこちら](./eccube3.0.17_update_files_diff.zip) | |  |  |  | | --- | | **FAQ** | | Q. 私のサイトは大丈夫ですか？   A.  まずは対象バージョンをお確かめください。  脆弱性対象バージョンのEC-CUBEをお使いの場合、対象ファイルを確認ください。  修正がされていない場合、修正方法に沿って修正の対応をお願いいたします。   「 [オフィシャルホスティングパートナー](http://www.ec-cube.net/partner/search.php)をご利用の場合」  「 [インテグレートパートナー](http://www.ec-cube.net/integrate/partner/place.php)が構築している場合」  既に対策されている場合がございます。各パートナー担当者様へお問い合わせ下さい。   この度は、お手数おかけいたしますことを深くお詫び申し上げます。 |  |  | | --- | | **謝辞** | | 本情報は、お問い合わせいただきました開発者様よりご提供いただきました。  この場をお借りして、厚く御礼申し上げます。 |  |  | | --- | | **問い合わせ先** | | EC-CUBE 運営チーム 足立 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


