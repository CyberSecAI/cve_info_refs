=== Content from github.com_3821ccba_20250125_225909.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjaw187%2Fnode-traceroute%2Ftags)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjaw187%2Fnode-traceroute%2Ftags)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Ftag_history&source=header-repo&source_repo=jaw187%2Fnode-traceroute)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jaw187](/jaw187)
/
**[node-traceroute](/jaw187/node-traceroute)**
Public

* [Notifications](/login?return_to=%2Fjaw187%2Fnode-traceroute) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2Fjaw187%2Fnode-traceroute)
* [Star
   25](/login?return_to=%2Fjaw187%2Fnode-traceroute)

* [Code](/jaw187/node-traceroute)
* [Issues
  9](/jaw187/node-traceroute/issues)
* [Pull requests
  3](/jaw187/node-traceroute/pulls)
* [Actions](/jaw187/node-traceroute/actions)
* [Projects
  0](/jaw187/node-traceroute/projects)
* [Wiki](/jaw187/node-traceroute/wiki)
* [Security](/jaw187/node-traceroute/security)
* [Insights](/jaw187/node-traceroute/pulse)

Additional navigation options

* [Code](/jaw187/node-traceroute)
* [Issues](/jaw187/node-traceroute/issues)
* [Pull requests](/jaw187/node-traceroute/pulls)
* [Actions](/jaw187/node-traceroute/actions)
* [Projects](/jaw187/node-traceroute/projects)
* [Wiki](/jaw187/node-traceroute/wiki)
* [Security](/jaw187/node-traceroute/security)
* [Insights](/jaw187/node-traceroute/pulse)

# Tags: jaw187/node-traceroute

[Releases](/jaw187/node-traceroute/releases)
[Tags](/jaw187/node-traceroute/tags)

Tags

## [v1.0.0](/jaw187/node-traceroute/releases/tag/v1.0.0)

Toggle v1.0.0's commit message

```
version 1.0.0

```

* Feb 27, 2016
* [654f100](/jaw187/node-traceroute/commit/654f1002809a46c301c7da5ac4c344879b4cb9a5)
* [zip](/jaw187/node-traceroute/archive/refs/tags/v1.0.0.zip)
* [tar.gz](/jaw187/node-traceroute/archive/refs/tags/v1.0.0.tar.gz)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from snyk.io_ce6ec986_20250126_123621.html ===
You need to enable JavaScript to run this app.[Skip to main content](#main-content)

* Products

  Products

  + [What is Snyk?

    Developer-first security in action](/product/)
  + [Snyk Code

    Secure your code as it's written](/product/snyk-code/)
  + [Snyk Open Source

    Avoid vulnerable dependencies](/product/open-source-security-management/)
  + [Snyk Container

    Keep your base images secure](/product/container-vulnerability-management/)
  + [Snyk IaC

    Fix IaC misconfigurations in-code](/product/infrastructure-as-code-security/)
  + [Snyk AppRisk

    Reduce risk across your business](/product/snyk-apprisk/)
  + [Pricing](/plans/)

  Solutions

  + [Why Snyk?

    Modern security in a single platform](/platform/)
  + [Application security

    Build secure, stay secure](/solutions/application-security/)
  + [Software supply chain security

    Mitigate supply chain risk](/solutions/software-supply-chain-security/)
  + [Secure-AI-generated code

    AI writes, Snyk secures](/solutions/secure-ai-generated-code/)
  + [Zero-day vulnerabilities

    Fix the first day with Snyk](/solutions/zero-day-vulnerability-security/)
  + [Security Intelligence

    Comprehensive vulnerability data](/platform/security-intelligence/)

  Platform

  + [DeepCode AI

    Purpose-built security AI](/platform/deepcode-ai/)
  + [Integrations

    SDLC-spanning security](/integrations/)
  + [Code Checker

    Write better code for free](/code-checker/)

  Audience

  + [Snyk for devs

    Dev-centric info on demand](https://go.snyk.io/2024-dev-onboarding.html)
  + [Snyk for government

    Mission-informed AppSec](/government-security-solution/)
  + [Leaders handbook

    SAST essentials for genAI](/lp/securing-ai-generated-code/)![](https://res.cloudinary.com/snyk/image/upload/v1729618965/default-report.b205b2e0.svg)

  Secure Adoption in Gen AI Era Report

  [Read report](https://go.snyk.io/secure-adoption-in-genai-era.html "Read report")
* Resources

  Our resources

  + [Resource library

    Browse our extensive database](/resource-library/)
  + [Customer resources

    The one stop shop for customers](/customer-resources/)
  + [Ethical hacking

    How ethical hacking can help you](/ethical-hacking-resources/)
  + [Security leaders

    Insights from industry leaders](/security-leaders/)
  + [Top 10 vulns

    See the most common vuln types](/snyk-top-10/)
  + [Blog Section](/blog/)
  + [Snyk's podcasts](/podcasts/the-secure-developer/)
  + [Snyk’s YouTube](https://www.youtube.com/snyksec)

  Our ecosystem

  + [Snyk Learn

    Security education from Snyk](https://learn.snyk.io)
  + [Snyk user docs

    Get started with Snyk](https://docs.snyk.io/)
  + [Snyk Support

    How can we help?](https://support.snyk.io/hc/en-us)
  + [Snyk Vuln Database

    Find new vulnerabilities](https://security.snyk.io/)
  + [Snyk Updates

    Stay in the loop](https://updates.snyk.io/)
  + [Snyk Partner Solutions Directory

    Explore Snyk Partner Integrations](https://partners.snyk.io/English/solutions/)

  Our community

  + [Events & webinars](/events/)
  + [Ambassadors](/snyk-ambassadors/)
  + [Discord channel](https://snyk.co/discordcommunity)![](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1717461856%2Ffeature-snyk-snowflake.jpg&w=2560&q=75)

  Extend the power of your AppSec data with the new Snyk and Snowflake integration

  [Read blog](/blog/snyk-snowflake-data-share/ "Read blog")
* Company

  Company

  ## The developer security platform

  Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

  [More about us](/about/ "More about us")
  + [Our services

    Maximize your AppSec ROI](/services/)
  + [Our customers

    We help customers save time and money](/customers/)
  + [Our partners

    Bringing business class security with partners](/partners/)
  + [Case studies

    Check out our customer stories and stats](/case-studies/)
  + [Newsroom

    See the latest press releases](/news/)
  + [Contact us

    Get in touch with any feedback or questions](/contact-us/)
  + [Careers

    Join Snyk today](/careers/)![](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1730905024%2FSnyk_Probely.jpg&w=2560&q=75)

  Snyk Acquires Developer-First DAST Provider Probely

  [Read press release](/news/snyk-acquires-developer-first-dast-provider-probely/ "Read press release")
* [Pricing](/plans/)

ENSelect your languageEnglishDeutschFrançais日本語Português (BR)Login

Free and Team Plan Customers

* [Snyk

  app.snyk.io](https://app.snyk.io)

Enterprise Plan Customers

* [*🇺🇸*

  Snyk US - 1

  app.snyk.io](https://app.snyk.io)
* [*🇺🇸*

  Snyk US - 2

  app.us.snyk.io](https://app.us.snyk.io)
* [*🇪🇺*

  Snyk EU

  app.eu.snyk.io](https://app.eu.snyk.io)
* [*🇦🇺*

  Snyk AU

  app.au.snyk.io](https://app.au.snyk.io)

The region where your data is hosted follows local agreements, and it may not align with your own location. [Find out more](https://docs.snyk.io/working-with-snyk/regional-hosting-and-data-residency).[Sign up](https://app.snyk.io/signup "Sign up")[Book a live demo](/schedule-a-demo/ "Book a live demo")
# Vulnerability Disclosure

We at Snyk value the security community and believe that a responsible disclosure of security vulnerabilities in open source packages helps us ensure the security and privacy of the users. We aim to provide a disclosure program for the security community to report security issues found within languages including JavaScript, Java, Python, .NET, Go, Ruby and PHP.

Using this form, you can disclose vulnerabilities you’ve found or vulnerabilities that are missing within [Snyk Vulnerability Database](https://security.snyk.io/), and we’ll help you verify the vulnerability and contact the maintainer. In addition, as a CVE Numbering Authority (CNA) we are also able to assign a CVE for the issue.

Before submitting a report, please review our disclosure policy which can be found [here](https://docs.snyk.io/disclosing-vulnerabilities/disclose-a-vulnerability-in-an-open-source-package).

For any questions or follow ups on the disclosure you may email us at report@snyk.io.

### Submit a vuln

## Products & Solutions

* [What is Snyk?](/product/)
* [Developer Security Platform](/platform/)
* [Pricing](/plans/)
## Our Resources

* [Resource library](/resource-library/)
* [Blog](/blog/)
* [Snyk’s podcasts](/podcasts/the-secure-developer/)
## Our Ecosystem

* [Snyk Learn](/platform/learn/)
* [Snyk User Docs](https://docs.snyk.io/)
* [Snyk Support](https://support.snyk.io/hc/en-us)
* [Snyk Vuln Database](https://security.snyk.io/)
* [Snyk Updates](https://updates.snyk.io/)
* [Snyk Trust Center](https://trust.snyk.io/home)
## Company & Community

* [About Snyk](/about/)
* [Contact us](/contact-us/)
* [Book a demo](/schedule-a-demo/)
* [Careers](/careers/)
* [Events & webinars](/events/)
* [Ambassadors](/snyk-ambassadors/)
## Why Snyk

* [Snyk With GitHub](/comparison/github-and-snyk/)
* [Snyk vs Veracode](/comparison/snyk-vs-veracode/)
* [Snyk vs Checkmarx](/comparison/snyk-vs-checkmarx/)
* [Snyk vs Synopsys](/comparison/snyk-vs-synopsys/)

## The developer security platform

Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

[More about us](/about/ "More about us")

© 2025 Snyk Limited
Registered in England and Wales

* [Legal terms](/policies/terms-of-service/)
* [Privacy Notice](/policies/privacy/)
* [Terms of use](/policies/website-terms-of-use/)
* [California residents: do not sell my information](https://preferences.snyk.io/dont_sell)


=== Content from snyk.io_ded6f261_20250125_225912.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. traceroute
# Shell Command Injection Affecting [traceroute](/package/npm/traceroute) package, versions **<=1.0.0**

---

### Severity

 Recommended 0.0critical010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/npm%3Atraceroute%3A20160311#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a published code exploit for this vulnerability.

MatureEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**10.07% (95th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Shell Command Injection vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/malicious-code-injection/)

* Snyk ID**npm:traceroute:20160311**
* published**23 Jan 2018**
* disclosed**9 Nov 2017**
* credit**Dor Dali**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 9 Nov 2017

[CVE-2018-21268  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2018-21268) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-78  (opens in a new tab)](https://cwe.mitre.org/data/definitions/78.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses
## How to fix?

There currently is no fixed version for `traceroute`. A fix is on the master branch but was not published to npm.

## Overview

[`traceroute`](https://www.npmjs.com/package/traceroute) is an npm package used for listing references in a remote git repository.

Affected versions of this package are vulnerable to Arbitrary Command Injection due to the insecure use of `exec`. An attacker can add a newline `%0a` after the host addr, and inject malicious shell commands to disrupt server operation or obtain sensitive information.

### PoC by Dor Dali

```
traceroute = require('traceroute');

host = '127.0.0.1\ntouch /tmp/malicious';

traceroute.trace(host, function (err,hops) {
    // the file /tmp/malicious was created
    console.log(hops);
});

```
## References

* <https://github.com/jaw187/node-traceroute/commit/b99ee024a01a40d3d20a92ad3769cc78a3f6386f>
* <https://github.com/jaw187/node-traceroute/issues/13>
### CVSS Scores

version 3.1
### Snyk

10 critical

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component.

  **Low**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can affect resources beyond the security scope managed by the security authority of the vulnerable component. In this case, the vulnerable component and the impacted component are different and managed by different security authorities.

  **Changed**

* Confidentiality (C)

  There is a total loss of confidentiality, resulting in all resources within the impacted component being divulged to the attacker. Alternatively, access to only some restricted information is obtained, but the disclosed information presents a direct, serious impact. For example, an attacker steals the administrator's password, or private encryption keys of a web server.

  **High**
* Integrity (I)

  There is a total loss of integrity, or a complete loss of protection. For example, the attacker is able to modify any/all files protected by the impacted component. Alternatively, only some files can be modified, but malicious modification would present a direct, serious consequence to the impacted component.

  **High**
* Availability (A)

  Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the impacted component are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the impacted component.

  **Low**
### NVD

9.8 critical
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_6a24678d_20250125_225907.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjaw187%2Fnode-traceroute%2Fcommit%2Fb99ee024a01a40d3d20a92ad3769cc78a3f6386f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjaw187%2Fnode-traceroute%2Fcommit%2Fb99ee024a01a40d3d20a92ad3769cc78a3f6386f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jaw187%2Fnode-traceroute)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jaw187](/jaw187)
/
**[node-traceroute](/jaw187/node-traceroute)**
Public

* [Notifications](/login?return_to=%2Fjaw187%2Fnode-traceroute) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2Fjaw187%2Fnode-traceroute)
* [Star
   25](/login?return_to=%2Fjaw187%2Fnode-traceroute)

* [Code](/jaw187/node-traceroute)
* [Issues
  9](/jaw187/node-traceroute/issues)
* [Pull requests
  3](/jaw187/node-traceroute/pulls)
* [Actions](/jaw187/node-traceroute/actions)
* [Projects
  0](/jaw187/node-traceroute/projects)
* [Wiki](/jaw187/node-traceroute/wiki)
* [Security](/jaw187/node-traceroute/security)
* [Insights](/jaw187/node-traceroute/pulse)

Additional navigation options

* [Code](/jaw187/node-traceroute)
* [Issues](/jaw187/node-traceroute/issues)
* [Pull requests](/jaw187/node-traceroute/pulls)
* [Actions](/jaw187/node-traceroute/actions)
* [Projects](/jaw187/node-traceroute/projects)
* [Wiki](/jaw187/node-traceroute/wiki)
* [Security](/jaw187/node-traceroute/security)
* [Insights](/jaw187/node-traceroute/pulse)

## Commit

[Permalink](/jaw187/node-traceroute/commit/b99ee024a01a40d3d20a92ad3769cc78a3f6386f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

conversion to spawn and stream

[Browse files](/jaw187/node-traceroute/tree/b99ee024a01a40d3d20a92ad3769cc78a3f6386f)
Browse the repository at this point in the history

* Loading branch information

[![@jaw187](https://avatars.githubusercontent.com/u/885557?s=40&v=4)](/jaw187)

[jaw187](/jaw187/node-traceroute/commits?author=jaw187 "View all commits by jaw187")
committed
Mar 11, 2016

1 parent
[a4859a3](/jaw187/node-traceroute/commit/a4859a3a262bc085d2b46f73a8bd974e7cd71568)

commit b99ee02

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**28 additions**
and
**35 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* traceroute.js
  [traceroute.js](#diff-a46aec1d74db3383ef134e9f96c7431de18d74cff5bfb2784e44b676bb34fda3)

## There are no files selected for viewing

3 changes: 1 addition & 2 deletions

3
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/jaw187/node-traceroute/blob/b99ee024a01a40d3d20a92ad3769cc78a3f6386f/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,10 +10,9 @@ |
|  |  | "engines": { |
|  |  | "node": ">=4.0.0" |
|  |  | }, |
|  |  | "dependencies": {}, |
|  |  | "devDependencies": { |
|  |  | "code": "2.x.x", |
|  |  | "lab": "9.x.x" |
|  |  | "lab": "10.x.x" |
|  |  | }, |
|  |  | "bugs": { |
|  |  | "url": "https://github.com/jaw187/node-traceroute/issues" |
| Expand Down | |  |

60 changes: 27 additions & 33 deletions

60
[traceroute.js](#diff-a46aec1d74db3383ef134e9f96c7431de18d74cff5bfb2784e44b676bb34fda3 "traceroute.js")

Show comments

[View file](/jaw187/node-traceroute/blob/b99ee024a01a40d3d20a92ad3769cc78a3f6386f/traceroute.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,23 +18,43 @@ module.exports = internals.Traceroute = {}; |
|  |  |  |
|  |  | internals.Traceroute.trace = function (host, callback) { |
|  |  |  |
|  |  |  |
|  |  | Dns.lookup(host.toUpperCase(), (err) => { |
|  |  |  |
|  |  | if (err && Net.isIP(host) === 0) { |
|  |  | return callback(new Error('Invalid host')); |
|  |  | } |
|  |  |  |
|  |  | const command = (internals.isWin ? 'tracert -d ' : 'traceroute -q 1 -n ') + host; |
|  |  | Child.exec(command, (err, stdout, stderr) => { |
|  |  | const command = (internals.isWin ? 'tracert' : 'traceroute'); |
|  |  | const args = internals.isWin ? ['-d', host] : ['-q', 1, '-n', host]; |
|  |  |  |
|  |  | const traceroute = Child.spawn(command, args); |
|  |  |  |
|  |  | const hops = []; |
|  |  | let counter = 0; |
|  |  | traceroute.stdout.on('data', (data) => { |
|  |  |  |
|  |  | if (err) { |
|  |  | return callback(err); |
|  |  | ++counter; |
|  |  | if ((!internals.isWin && counter < 2) || (internals.isWin && counter < 5)) { |
|  |  | return null; |
|  |  | } |
|  |  |  |
|  |  | const results = internals.parseOutput(stdout); |
|  |  | return callback(null, results); |
|  |  | const result = data.toString().replace(/\n$/,''); |
|  |  | if (!result) { |
|  |  | return null; |
|  |  | } |
|  |  |  |
|  |  | const hop = internals.parseHop(result); |
|  |  | hops.push(hop); |
|  |  | }); |
|  |  |  |
|  |  | traceroute.on('close', (code) => { |
|  |  |  |
|  |  | if (callback) { |
|  |  | return callback(null, hops); |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | return traceroute; |
|  |  | }); |
|  |  | }; |
|  |  |  |
| Expand Down  Expand Up | | @@ -96,29 +116,3 @@ internals.parseHopNix = function (line) { |
|  |  |  |
|  |  | return hop; |
|  |  | }; |
|  |  |  |
|  |  | internals.parseOutput = function (output) { |
|  |  |  |
|  |  | const lines = output.split('\n'); |
|  |  | const hops = []; |
|  |  |  |
|  |  | lines.shift(); |
|  |  | lines.pop(); |
|  |  |  |
|  |  | if (internals.isWin) { |
|  |  | for (let i = 0; i < lines.length; ++i) { |
|  |  | if (/^\s+1/.test(lines[i])) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | lines.splice(0,i); |
|  |  | lines.pop(); |
|  |  | lines.pop(); |
|  |  | } |
|  |  |  |
|  |  | for (let i = 0; i < lines.length; ++i) { |
|  |  | hops.push(internals.parseHop(lines[i])); |
|  |  | } |
|  |  |  |
|  |  | return hops; |
|  |  | }; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b99ee02`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjaw187%2Fnode-traceroute%2Fcommit%2Fb99ee024a01a40d3d20a92ad3769cc78a3f6386f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.linkedin.com_2ccd5a78_20250125_225913.html ===


‏LinkedIn וצדדים שלישיים משתמשים בקובצי Cookie הכרחיים ולא הכרחיים כדי לספק, לאבטח, לנתח ולשפר את השירותים שלנו, וכדי להציג לך מודעות ⁦⁦⁦**⁩⁩⁩רלוונטיות (כולל מודעות מקצועיות ומודעות דרושים⁦⁦⁦**⁩⁩⁩) ב-LinkedIn ומחוצה לה. מידע נוסף נמצא ‏[במדיניות קובצי Cookie](https://www.linkedin.com/legal/cookie-policy)‏ שלנו.⁦⁦⁦

⁩⁩⁩‏⁦⁦

⁩⁩יש לבחור ’הסכמה‘ להסכמה או ’דחייה‘ כדי לדחות קובצי Cookie שלא הכרחיים לשימוש זה. ניתן לעדכן את הבחירות בכל עת בהגדרות ‏[settings](https://www.linkedin.com/mypreferences/g/guest-cookies)‏.⁦⁦

⁩⁩

קבלה

דחייה

מסכים ומצטרף LinkedIn

הלחיצה על ’המשך‘ להצטרפות או להתחברות מהווה את הסמכתך ל‏[הסכם המשתמש](/legal/user-agreement?trk=linkedin-tc_auth-button_user-agreement)‏, ל‏[מדיניות הפרטיות](/legal/privacy-policy?trk=linkedin-tc_auth-button_privacy-policy)‏ ול‏[מדיניות קובצי ה-Cookie](/legal/cookie-policy?trk=linkedin-tc_auth-button_cookie-policy)‏ של LinkedIn.

[דילוג לתוכן הראשי](#main-content)
[‏LinkedIn](/?trk=public_post_nav-header-logo)

* [מאמרים](https://www.linkedin.com/pulse/topics/home/?trk=public_post_guest_nav_menu_articles)
* [אנשים](https://www.linkedin.com/pub/dir/%2B/%2B?trk=public_post_guest_nav_menu_people)
* [למידה](https://www.linkedin.com/learning/search?trk=public_post_guest_nav_menu_learning)
* [משרות](https://www.linkedin.com/jobs/search?trk=public_post_guest_nav_menu_jobs)
* [משחקים](https://www.linkedin.com/games?trk=public_post_guest_nav_menu_games)
* הורדת האפליקציה

[הצטרפות](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_nav-header-join)
[התחברות](https://www.linkedin.com/login?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&fromSignIn=true&trk=public_post_nav-header-signin)

# ‏OP Innovate‏ ‏‏ הצבה

[![צפייה בדף הארגון של ‏OP Innovate‏, גרפיקה]()](https://il.linkedin.com/company/op-innovate?trk=public_post_feed-actor-image)
[OP Innovate](https://il.linkedin.com/company/op-innovate?trk=public_post_feed-actor-name)

 ‏‏1,772‏ עוקבים‏

‏4‏ שנים

נערך

* [דיווח על פוסט הזה](/uas/login?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_ellipsis-menu-semaphore-sign-in-redirect&guestReportContentType=POST&_f=guest-reporting)

CRITICAL level finding in NPM 'Traceroute' package !
Our researchers have found a 'Shell command injection through Traceroute NPM package'.
Read more about the finding and share the post to help spread awareness of potential security flaws in off-the-shelf open-source code:
[https://lnkd.in/eYGmANx](https://lnkd.in/eYGmANx?trk=public_post-text)
Let us review your code:
contactus@op-c.net
[#infosec](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Ffeed%2Fhashtag%2Finfosec&trk=public_post-text) [#cybersecurity](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Ffeed%2Fhashtag%2Fcybersecurity&trk=public_post-text) [#dataprotection](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Ffeed%2Fhashtag%2Fdataprotection&trk=public_post-text) [#NPM](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Ffeed%2Fhashtag%2Fnpm&trk=public_post-text) [#informationsecurity](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Ffeed%2Fhashtag%2Finformationsecurity&trk=public_post-text)

[![Shell Command Injection Through Traceroute NPM Package]()

## Shell Command Injection Through Traceroute NPM Package](https://www.linkedin.com/redir/redirect?url=https%3A%2F%2Fwww%2Eop-c%2Enet%2F2020%2F06%2F17%2Fshell-command-injection-through-traceroute-npm-package%2F&urlhash=pJDa&trk=public_post_feed-article-content)

[![]()
![]()
11](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_social-actions-reactions)

[‏1‏ ‏תגובה‏](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_social-actions-comments)

[לייק](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_like-cta)
[תגובה](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_comment-cta)

שיתוף

* להעתיק
* LinkedIn
* Facebook
* Twitter

[![Amir Dey]()](https://il.linkedin.com/in/amir-dey-4ba797158?trk=public_post_comment_actor-image)

[Amir Dey](https://il.linkedin.com/in/amir-dey-4ba797158?trk=public_post_comment_actor-name)
‏4‏ שנים

* [דווח על תגובה זו](/uas/login?session_redirect=https%3A%2F%2Fwww.linkedin.com%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_comment_ellipsis-menu-semaphore-sign-in-redirect&guestReportContentType=COMMENT&_f=guest-reporting)

Well done!

[לייק](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_comment_like)

[תשובה](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_comment_reply)

‏1‏ ‏רגש‏

לצפייה או הוספת תגובה, ‏[התחברות](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_feed-cta-banner-cta)‏

![](https://media.licdn.com/dms/image/v2/D4D3DAQFHDVxLY8a4FA/image-scale_191_1128/image-scale_191_1128/0/1687697874724/op_innovate_cover?e=2147483647&v=beta&t=7UhcvsSMGXi_X2WZRs7BAOJAo6C2N446ByT7k_N4ykU)

![OP Innovate]()

1,772 עוקבים

[צפייה בפרופיל](https://il.linkedin.com/company/op-innovate?trk=public_post_follow-view-profile)
[מעקב](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Ffeed%2Fupdate%2Furn%3Ali%3Aactivity%3A6678956453086191616&trk=public_post_follow)

* ‏LinkedIn

  ‏© ‏2025‏
* [על אודות](https://about.linkedin.com?trk=d_public_post_footer-about)
* [נגישות](https://www.linkedin.com/accessibility?trk=d_public_post_footer-accessibility)
* [הסכם המשתמש](https://www.linkedin.com/legal/user-agreement?trk=d_public_post_footer-user-agreement)
* [מדיניות פרטיות](https://www.linkedin.com/legal/privacy-policy?trk=d_public_post_footer-privacy-policy)
* [מדיניות עוגיות](https://www.linkedin.com/legal/cookie-policy?trk=d_public_post_footer-cookie-policy)
* [מדיניות זכויות יוצרים](https://www.linkedin.com/legal/copyright-policy?trk=d_public_post_footer-copyright-policy)
* [מדיניות המותג](https://brand.linkedin.com/policies?trk=d_public_post_footer-brand-policy)
* [בקרת אורחים](https://www.linkedin.com/psettings/guest-controls?trk=d_public_post_footer-guest-controls)
* [הנחיות הקהילה](https://www.linkedin.com/legal/professional-community-policies?trk=d_public_post_footer-community-guide)
* + العربية (ערבית)
  + বাংলা (בנגלה)
  + Čeština (צ’כית)
  + Dansk (דנית)
  + Deutsch (גרמנית)
  + Ελληνικά (יוונית)
  + English (אנגלית)
  + Español (ספרדית)
  + فارسی (פרסית)
  + Suomi (פינית)
  + Français (צרפתית)
  + हिंदी (הינדי)
  + Magyar (הונגרית)
  + Bahasa Indonesia (אינדונזית)
  + Italiano (איטלקית)
  + **עברית (Hebrew)**
  + 日本語 (יפנית)
  + 한국어 (קוריאנית)
  + मराठी (מראטהית)
  + Bahasa Malaysia (מלאית)
  + Nederlands (הולנדית)
  + Norsk (נורווגית)
  + ਪੰਜਾਬੀ (פנג’אבי)
  + Polski (פולנית)
  + Português (פורטוגזית)
  + Română (רומנית)
  + Русский (רוסית)
  + Svenska (שוודית)
  + తెలుగు (טלוגו)
  + ภาษาไทย (תאילנדית)
  + Tagalog (טאגאלוג)
  + Türkçe (טורקית)
  + Українська (אוקראינית)
  + Tiếng Việt (וייטנאמית)
  + 简体中文 (סינית (מפושטת))
  + 正體中文 (סינית (מסורתית))
  שפה

![]()
## היכנס כדי להציג תוכן נוסף

צור חשבון בחינם או התחבר כדי להמשיך בחיפוש

 התחברות

## טוב לראות אותך שוב

דוא”ל או טלפון

סיסמה

הצגה

[שכחת סיסמא?](https://www.linkedin.com/uas/request-password-reset?trk=public_post_contextual-sign-in-modal_sign-in-modal_forgot_password)

התחברות

או

הלחיצה על ’המשך‘ להצטרפות או להתחברות מהווה את הסמכתך ל‏[הסכם המשתמש](/legal/user-agreement?trk=public_post_contextual-sign-in-modal_sign-in-modal_auth-button_user-agreement)‏, ל‏[מדיניות הפרטיות](/legal/privacy-policy?trk=public_post_contextual-sign-in-modal_sign-in-modal_auth-button_privacy-policy)‏ ול‏[מדיניות קובצי ה-Cookie](/legal/cookie-policy?trk=public_post_contextual-sign-in-modal_sign-in-modal_auth-button_cookie-policy)‏ של LinkedIn.

פעם ראשונה שלך ב-LinkedIn? ‏[להצטרפות](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_contextual-sign-in-modal_sign-in-modal_join-link)‏

או

פעם ראשונה שלך ב-LinkedIn? ‏[להצטרפות](https://www.linkedin.com/signup/cold-join?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2Fposts%2Fop-innovate_shell-command-injection-through-traceroute-activity-6678956453086191616-Rcpy&trk=public_post_contextual-sign-in-modal_join-link)‏

הלחיצה על ’המשך‘ להצטרפות או להתחברות מהווה את הסמכתך ל‏[הסכם המשתמש](/legal/user-agreement?trk=linkedin-tc_auth-button_user-agreement)‏, ל‏[מדיניות הפרטיות](/legal/privacy-policy?trk=linkedin-tc_auth-button_privacy-policy)‏ ול‏[מדיניות קובצי ה-Cookie](/legal/cookie-policy?trk=linkedin-tc_auth-button_cookie-policy)‏ של LinkedIn.



=== Content from medium.com_25dd99c0_20250125_225910.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa4cf7b6553e3&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40shay_62828%2Fshell-command-injection-through-traceroute-npm-package-a4cf7b6553e3&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40shay_62828%2Fshell-command-injection-through-traceroute-npm-package-a4cf7b6553e3&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Shell Command Injection Through Traceroute NPM Package

[![OP Innovate](https://miro.medium.com/v2/resize:fill:88:88/1*uIEVmjLjXKYVc8wJjcKUdA.png)](/%40shay_62828?source=post_page---byline--a4cf7b6553e3--------------------------------)

[OP Innovate](/%40shay_62828?source=post_page---byline--a4cf7b6553e3--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6489ee97ca0a&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40shay_62828%2Fshell-command-injection-through-traceroute-npm-package-a4cf7b6553e3&user=OP+Innovate&userId=6489ee97ca0a&source=post_page-6489ee97ca0a--byline--a4cf7b6553e3---------------------post_header-----------)

6 min read·Jun 24, 2020

--

Listen

Share

# TL;DR

* Before using any open-source library, verify that it still being actively maintained
* Look for security issues using Github search
* The security ecosystem is not that eco — it lacks synchronization
* Case in point: we share details of a shell command injection vulnerability we found in the ‘Traceroute’ NPM package.
* We provide a POC & recommendations for mitigation
* <https://www.npmjs.com/advisories/1465> ; [https://snyk.io/vuln/npm:traceroute:20160311](https://snyk.io/vuln/npm%3Atraceroute%3A20160311)
# The far-reaching hand of open-source code

People like open-source code. They use it in the form of packages, libraries, modules, and plugins, for all sorts of reasons. This code is publicly available, fully accessible, and is the polar opposite of proprietary software — EVERYBODY is the owner of the code. That’s fantastic, right?! Well not always…

Open-source is almost perfect at doing what it was intended to do: provide extreme efficiency by saving the developer community time and resources developing their product.

Thing is, it’s often implemented without security in mind which allows potential attackers to take advantage of the flaws. The scary part is that once a software repository is published, it is not subjected to any further security testing. Picture the ever-growing stream of downloads and you see how quickly vulnerable software can spread across continents and integrate into software, programs, and commercial products.

NPM (Node Package Manager) is one great way of managing open-source packages. It’s a big software repository that contains Node.js projects, one of them is Traceroute.

![]()

Figure 1- itchy trigger finger

Here are some quick facts about the Traceroute package

* Traceroute is a simple NPM package used as a wrapper for the native traceroute command.
* The code is written in JavaScript
* The package has a download rate of approximately 700 downloads per week.
* The Traceroute.js file is really small — approx. 2500 characters long, 125 lines of code.
* The last version was released on Feb. 2016; the last GitHub commit was on Mar. 2016
# Let’s get technical for a bit

We will now embark on a deep inspection of the vulnerable lines of code in order to explain the source, vector, and possible impact of the script.

Since the code is fairly short and simple, we can spot the issue right away. Let’s look at the main part of the code which takes the “host” parameter and issues the traceroute command towards that host.

```
const command = (internals.isWin ? ‘tracert -d ‘ : ‘traceroute -q 1 -n ‘) + host;
Child.exec(command, (err, stdout, stderr) => { if (err) {
 return callback(err);
 } const results = internals.parseOutput(stdout);
 return callback(null, results);
 });
```

As you can see the flow is:

-Check what OS is running the server (Windows or UNIX-based)

-Take the “host” param

-Based on the result of the OS check in step 1, use node.JS built-in exec command and run the OS native traceroute command as follows –

* if the running system is UNIX-based, the *command* will be:
  `command = 'traceroute -q 1 -n ' + host`
* if the system is Windows-based, the *command* value will change to:
  `command = 'tracert -d ' + host`

In either case, the *command* value will be concatenated with the string value of the host
Variable which is likely to be based on user-input, representing a remote host.

The designated value is supposed to be an IP address or a hostname, but unfortunately, it can contain anything, especially malicious shell commands. The reason it can contain all sorts of commands is that the variable doesn’t get filtered or parsed before being executed. There is no instruction that is set to enforce a masked value of hostname or IP address.

# Exec vs Spawn

The main caveat here is the use of child\_process.exec instead of child\_process.spawn. These functions might sound similar but one is way more secure than the other.

By looking at the documentation (<https://nodejs.org/api/child_process.html>) of the 2 functions we can see that *exec* doesn’t have an “args” argument whereas *spawn* has this argument. This means that if you want to pass an argument to a command run by an *exec* function you do it as part of the command whereas in the *spawn* function it has a designated place. The fix is easy — just switch the *exec* to *spawn* and move the host argument to the argument section.

The way *spawn* handles arguments is similar to SQL prepared statements, which essentially make sure that you’re unable to inject any more commands using supplied arguments.

So now that we understand the issue and how to fix it, we can create a quick POC for this issue

# POC

```
traceroute = require(‘traceroute’);host = ‘127.0.0.1\ntouch /tmp/malicious’;traceroute.trace(host, function (err,hops) {
 // the file /tmp/malicious was created
 console.log(hops);
});
```

By altering the ‘host’ variable and supplying IP/hostname with a newline (value of %0a) followed by a malicious command. The server will run both the traceroute and the malicious command which, in this POC, will create a file called malicious in the /tmp directory.

# Enough with the tech, let’s get to the juicy stuff

## Why is the open-source security ecosystem flawed?

This security flaw was reported to Snyk 3 years ago by Dor Dali, at the time a researcher at OP Innovate. You’d think a reported flaw would cause users to abandon the use of the package. But sadly this is not how the story goes. Most users are not using Snyk to scan their libraries and rely on the NPM audit. NPM was not aware of the issue until Dor reported it to them directly.

This is a serious flaw in the world of vulnerability reporting. These two major players, who publish security advisories on open-source packages (along with other features), aren’t always synced regarding registered vulnerabilities. This lack of synchronization, along with the fact that researchers usually only report to one of them, is a genuine issue that affects all of us and shouldn’t be taken lightly.

![]()
# Avoiding these cases in the future

In order to avoid this in the future, we recommend you ask yourselves the following questions –

1. Is this package being actively maintained?

By looking at the GitHub page of the traceroute package you can see that the last commit was over 4 years ago, in March 2016. Moreover, if you try to look for the vulnerable lines of code we describe above, you see that they are not available in the “master” branch. That’s because the developer of this package has fixed the security issue, but didn’t release a new version and didn’t publish it to NPM repo.

![]()

The fixed commit: <https://github.com/jaw187/node-traceroute/commit/b99ee024a01a40d3d20a92ad3769cc78a3f6386f>

So we can deduce that this package is no longer maintained and therefore is at higher risk of containing vulnerabilities.

2. Does this package have known-vulnerabilities?

This one might sound obvious since no one wants to use a vulnerable application, but this one is also a bit tricky. As the number of security applications that promise to notify you about security vulnerabilities in your open-source applications grows, so does the lack of sync between them. Moreover, some of the security issues are handled directly in GitHub without alerting any of these apps.

A good approach would be to search the Github issues of the application for the term “security” and look for open/closed issues. It is also recommended to search the big two major indexes — Snyk and NPM — separately, for open-source security vulnerabilities.

![]()

Figure 2- software’s patch

Wrapping up: It’s important to remember that open-source code is built and designed to do a job, often without security best practice in mind. We recommend adopting a habit of manually testing any open-source code that is integrated into your solutions, for vulnerabilities it could sneak into your solution. **Manually reviewing the code is *always* the best solution.**

Contact us and learn more about how to secure your code!

contactus@op-c.net

# About us

OP Innovate was established in 2014 to defend global enterprises from the increasing challenges of reducing organizational cybersecurity risk. Our team has unmatched expertise in cyber research, penetration testing & vulnerability assessment, incident response, training, and forensics. Our team members are exposed to cutting-edge responses to today’s most critical cybersecurity concerns allowing us and our partners to remain ahead of the bad guys.

[www.op-c.net](https://www.op-c.net/)

*Discovered by: Dor Dali; Written by Dan Shallom, Cybersecurity experts at* ***OP Innovate.***

[Cybersecurity](/tag/cybersecurity?source=post_page-----a4cf7b6553e3--------------------------------)[Traceroute](/tag/traceroute?source=post_page-----a4cf7b6553e3--------------------------------)[Code Review](/tag/code-review?source=post_page-----a4cf7b6553e3--------------------------------)[Open Source Software](/tag/open-source-software?source=post_page-----a4cf7b6553e3--------------------------------)

--

--

[![OP Innovate](https://miro.medium.com/v2/resize:fill:96:96/1*uIEVmjLjXKYVc8wJjcKUdA.png)](/%40shay_62828?source=post_page---post_author_info--a4cf7b6553e3--------------------------------)[![OP Innovate](https://miro.medium.com/v2/resize:fill:128:128/1*uIEVmjLjXKYVc8wJjcKUdA.png)](/%40shay_62828?source=post_page---post_author_info--a4cf7b6553e3--------------------------------)Follow[## Written by OP Innovate](/%40shay_62828?source=post_page---post_author_info--a4cf7b6553e3--------------------------------)[1 Follower](/%40shay_62828/followers?source=post_page---post_author_info--a4cf7b6553e3--------------------------------)·[1 Following](/%40shay_62828/following?source=post_page---post_author_info--a4cf7b6553e3--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----a4cf7b6553e3--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----a4cf7b6553e3--------------------------------)[About](/about?autoplay=1&source=post_page-----a4cf7b6553e3--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a4cf7b6553e3--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----a4cf7b6553e3--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----a4cf7b6553e3--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a4cf7b6553e3--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a4cf7b6553e3--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----a4cf7b6553e3--------------------------------)[Teams](/business?source=post_page-----a4cf7b6553e3--------------------------------)



=== Content from support.snyk.io_340a6d77_20250126_123621.html ===




=== Content from www.npmjs.com_fbce5947_20250125_225916.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## traceroute

1.0.0Â â¢Â PublicÂ â¢Â Published 9 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [0 Dependencies](?activeTab=dependencies)
* [3 Dependents](?activeTab=dependents)
* [4 Versions](?activeTab=versions)

# node-traceroute

Simple wrapper around native traceroute command. A trace in node will return an array of hops. Each hop contains the hosts in that hop and the respective round trip times of each host.

## Install

```
$ npm install traceroute

```
## Example

```
tracerouteÂ =Â require('traceroute');traceroute.trace('google.com',Â functionÂ (err,hops)Â {Â Â ifÂ (!err)Â console.log(hops);});
```

This example would write the following to the console if run from my network...

```
[Â {Â '66.97.5.249':Â [Â 43.206,Â 43.377,Â 43.379Â ]Â },Â Â {Â '216.182.7.102':Â [Â 43.575,Â 43.799,Â 43.808Â ]Â },Â Â {Â '216.182.7.165':Â [Â 44.538,Â 44.613,Â 44.837Â ]Â },Â Â {Â '216.182.7.253':Â [Â 44.846,Â 56.281,Â 56.303Â ]Â },Â Â {Â '4.53.88.197':Â [Â 57.735,Â 57.707,Â 57.891Â ]Â },Â Â {Â '4.69.155.254':Â [Â 58.618,Â 48.514,Â 48.567Â ]Â },Â Â {Â '4.69.134.77':Â [Â 34.167,Â 44.317Â ],Â '4.69.148.45':Â [Â 44.366Â ]Â },Â Â {Â '4.69.141.22':Â [Â 44.542,Â 44.316,Â 44.642Â ]Â },Â Â {Â '4.69.138.196':Â [Â 44.56,Â 35.554Â ],Â Â Â Â '4.69.138.228':Â [Â 45.035Â ]Â },Â Â {Â '4.59.128.18':Â [Â 35.777,Â 35.827,Â 45.305Â ]Â },Â Â {Â '72.14.238.232':Â [Â 45.621Â ],Â Â Â Â '209.85.255.68':Â [Â 45.079,Â 42.695Â ]Â },Â Â {Â '209.85.251.37':Â [Â 32.588,Â 32.569,Â 32.657Â ]Â },Â Â {Â '209.85.251.9':Â [Â 59.068Â ],Â Â Â Â '209.85.254.48':Â [Â 60.287,Â 75.094Â ]Â },Â Â {Â '66.249.94.22':Â [Â 61.565,Â 62.063Â ],Â Â Â Â '72.14.238.242':Â [Â 63.001Â ]Â },Â Â {Â '64.233.174.140':Â [Â 96.476,Â 97.585Â ],Â Â Â Â '72.14.239.83':Â [Â 98.656Â ]Â },Â Â {Â '64.233.174.191':Â [Â 149.286,Â 93.528,Â 94.405Â ]Â },Â Â {Â '216.239.43.76':Â [Â 83.901,Â 85.089,Â 84.837Â ]Â },Â Â {Â '74.125.224.240':Â [Â 84.645,Â 75.322,Â 75.585Â ]Â }Â ]
```

## Readme

### Keywords

* [traceroute](/search?q=keywords:traceroute)
* [network](/search?q=keywords:network)
* [trace](/search?q=keywords:trace)
* [route](/search?q=keywords:route)
## Package Sidebar

### Install

`npm i traceroute`

### Repository

[Gitgithub.com/jaw187/node-traceroute](https://github.com/jaw187/node-traceroute)

### Homepage

[github.com/jaw187/node-traceroute#readme](https://github.com/jaw187/node-traceroute#readme)

### DownloadsWeekly Downloads

179

### Version

1.0.0

### License

ISC

### Last publish

9 years ago

### Collaborators

* [![jaw187](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci81NTI3OTEzZjcyOGU5N2U2Y2ZiN2VmMTUzMGIyZjcwZD9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.CKQJl-8gmlJe3pY8ag4e1-5ZG8x-sy8jxBGDHUS6UOY "jaw187")](/~jaw187)
[**Try** on RunKit](https://runkit.com/npm/traceroute)[**Report** malware](/support?inquire=security&security-inquire=malware&package=traceroute&version=1.0.0)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from www.npmjs.com_50b608cc_20250125_225915.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rjvj-673q-4hfw)

**GHSA-rjvj-673q-4hfw**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rjvj-673q-4hfw)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [GHSA-rjvj-673q-4hfw](/advisories/GHSA-rjvj-673q-4hfw)

## Command Injection in traceroute

Critical severity

GitHub Reviewed

Published
Sep 4, 2020
to the GitHub Advisory Database
•
Updated Jan 9, 2023

[Vulnerability details](/advisories/GHSA-rjvj-673q-4hfw)
[Dependabot alerts
0](/advisories/GHSA-rjvj-673q-4hfw/dependabot)

## Package

npm

traceroute
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>= 0.0.0

## Patched versions

None

## Description

All versions of `traceroute` are vulnerable to Command Injection. The package fails to sanitize input and passes it directly to an `exec` call, which may allow attackers to execute arbitrary code in the system. The `trace` function is vulnerable and can be abused if the `host` value is controlled by an attacker.

## Recommendation

No fix is currently available. Consider using an alternative package until a fix is made available.

### References

* [https://snyk.io/vuln/npm:traceroute:20160311](https://snyk.io/vuln/npm%3Atraceroute%3A20160311)
* <https://www.npmjs.com/advisories/1465>
* <https://github.com/jaw187/node-traceroute>

Reviewed
Aug 31, 2020

Published to the GitHub Advisory Database
Sep 4, 2020

Last updated
Jan 9, 2023

### Severity

Critical

### EPSS score

### Weaknesses

[CWE-77](/advisories?query=cwe%3A77)

### CVE ID

No known CVE

### GHSA ID

GHSA-rjvj-673q-4hfw

### Source code

[jaw187/node-traceroute](https://github.com/jaw187/node-traceroute)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-rjvj-673q-4hfw/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


