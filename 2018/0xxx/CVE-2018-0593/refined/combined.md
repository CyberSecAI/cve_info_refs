=== Content from blogs.technet.microsoft.com_0b787e23_20250125_184642.html ===

/blog/2018/04/triaging-a-dll-planting-vulnerability/



=== Content from jvn.jp_fc100faf_20250125_184639.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2018/05/17  Last Updated:2018/05/17
# JVN#91151862 Multiple Microsoft Windows applications and installers may insecurely load Dynamic Link Libraries

## Overview

Multiple Microsoft Windows applications and installers may insecurely load Dynamic Link Libraries.

## Products Affected

* Microsoft OneDrive - CVE-2018-0592
* The installer of Microsoft OneDrive - CVE-2018-0593
* Skype for Windows - CVE-2018-0594
* The installer of Skype for Windows - CVE-2018-0595
* The installer of Visual Studio Community - CVE-2018-0596
* The installer of Visual Studio Code - CVE-2018-0597

## Description

Multiple Windows applications and installers provided by Microsoft contain an issue with the DLL search path, which may lead to insecurely loading Dynamic Link Libraries in the same directory where applications and/or installers reside ([CWE-427](https://cwe.mitre.org/data/definitions/427.html)).

Microsoft states that the root cause of this vulnerability is "Application Directory (App Dir) DLL planting" and attacks exploiting this vulnerability are limited, thus there is no plan to release any security updates to address this issue.

For details, refer to "[Application Directory (App Dir) DLL planting](https://blogs.technet.microsoft.com/srd/2018/04/04/triaging-a-dll-planting-vulnerability/)" released by Microsoft.

## Impact

If a crafted DLL file is in the same directory where the vulnerable applicaion and/or installer resides, arbitrary code may be executed with the privilege of the user invoking the application or installer.

## Solution

**Apply Workaround**

* Make sure to allow that the system directories are writable only by administrators, which is the Windows' initial configuration.
* Operate Windows PCs with a standard user (non-administrator) account.  Administrator accounts should be used only when necessary.
* When invoking an installer, make sure there are no unrelated files in the same directory where the installer resides.  It is strongly recommended to copy the installer into a newly created directory and invoke it from that directory.
* Make sure there are no untrusted files in the directory where the application is installed.
* If your organization uses shared directories to place installers for organizational operations, make sure that the shared directory is set read-only for non-administrative users.

Note that some applications including Microsoft OneDrive may be installed in user directories, not in system directories.

Apply respective workarounds in accordance with how respective applications are installed and used.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Microsoft Japan Co.,Ltd. | [Vulnerable](4953/index.html) | 2018/05/17 |  |

## References

1. [Japan Vulnerability Notes JVNTA#91240916](https://jvn.jp/en/ta/JVNTA91240916/)
   Insecure DLL Loading and Command Execution Issues on Many Windows Application Programs

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
Base Score:
7.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:P/I:P/A:P
Base Score:
6.8

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Comment

This analysis assumes that the user is tricked into placing a malicious DLL file prepared by an attacker in a specific folder.

## Credit

Following researchers reported respective vulnerabilities to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning partnership.

CVE-2018-0592, CVE-2018-0593, CVE-2018-0596

Takashi Yoshikawa of Mitsui Bussan Secure Directions, Inc.

CVE-2018-0594

BlackWingCat of Pink Flying Whale

CVE-2018-0595, CVE-2018-0597

Eili Masami

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2018-0592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0592) |
|  | [CVE-2018-0593](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0593) |
|  | [CVE-2018-0594](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0594) |
|  | [CVE-2018-0595](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0595) |
|  | [CVE-2018-0596](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0596) |
|  | [CVE-2018-0597](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0597) |
| JVN iPedia | [JVNDB-2018-000049](https://jvndb.jvn.jp/jvndb/JVNDB-2018-000049) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.


