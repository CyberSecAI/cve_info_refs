=== Content from jvn.jp_11f44a3d_20250125_180839.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2018/02/02  Last Updated:2018/02/02
# JVN#99312352 WordPress plugin "MTS Simple Booking C" vulnerable to cross-site scripting

## Overview

The WordPress plugin "MTS Simple Booking C" contains a cross-site scripting vulnerability.

## Products Affected

* MTS Simple Booking C
* MTS Simple Booking Business version 1.28.0 and earlier

## Description

The WordPress plugin "MTS Simple Booking C" provided by MT Systems Co., Ltd. contains a stored cross-site scripting vulnerability ([CWE-79](//cwe.mitre.org/data/definitions/79.html)).

## Impact

An arbitrary script may be executed on the web browser of a user who logged-in as an administrator.

## Solution

**Update the plugin**

Update the plugin according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| MT Systems Co., Ltd. | [JVN#99312352 Vulnerability in MTS Simple Booking C and countermeasures](http://mtssb.mt-systems.jp/jvn99312352/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
Base Score:
6.1

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:M/Au:N/C:N/I:P/A:N
Base Score:
4.3

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Daichi Takaki of Cryptography Laboratory,Department of Information and Communication Engineering,Tokyo Denki University reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2018-0513](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0513) |
| JVN iPedia | [JVNDB-2018-000010](http://jvndb.jvn.jp/jvndb/JVNDB-2018-000010) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.



=== Content from mtssb.mt-systems.jp_ea83c5f7_20250125_180837.html ===

# [MTS Simple Booking](http://mtssb.mt-systems.jp "MTS Simple Booking")

MTS Simple Booking, WordPress Plugin Software

* [Home](http://mtssb.mt-systems.jp/)
* [Features](http://mtssb.mt-systems.jp/features/)
* [Demos](http://mtssb.mt-systems.jp/demos/)
  + [ビジネス版エステサロン](http://sb.mt-systems.jp/esthe/)
  + [ビジネス版レンタルスタジオ](http://sb.mt-systems.jp/studio/)
* [Documentation](http://mtssb.mt-systems.jp/documentation/)
  + [初めての方](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/)
  + [スタートガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%82%B9%E3%82%BF%E3%83%BC%E3%83%88%E3%82%AC%E3%82%A4%E3%83%89/)
  + [機能ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/)
    - [予約品目](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E4%BA%88%E7%B4%84%E5%93%81%E7%9B%AE/)
    - [スケジュール管理](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E7%AE%A1%E7%90%86/)
    - [各種設定 予約パラメータ](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E5%90%84%E7%A8%AE%E8%A8%AD%E5%AE%9A-%E4%BA%88%E7%B4%84%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF/)
    - [各種設定 予約メール](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E5%90%84%E7%A8%AE%E8%A8%AD%E5%AE%9A-%E4%BA%88%E7%B4%84%E3%83%A1%E3%83%BC%E3%83%AB/)
    - [予約の管理機能](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E7%AE%A1%E7%90%86%E6%A9%9F%E8%83%BD/)
    - [予約カレンダー表示](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E4%BA%88%E7%B4%84%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E8%A1%A8%E7%A4%BA/)
    - [メッセージフィルター](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC/)
    - [複合予約カレンダー](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E8%A4%87%E5%90%88%E4%BA%88%E7%B4%84%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC/)
    - [各種設定 問合せメール(ビジネス版)](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E5%90%84%E7%A8%AE%E8%A8%AD%E5%AE%9A-%E5%95%8F%E5%90%88%E3%81%9B%E3%83%A1%E3%83%BC%E3%83%AB%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E7%89%88/)
    - [オプション機能(ビジネス版)](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E6%A9%9F%E8%83%BD%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E7%89%88/)
  + [ビジネス版追加機能ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E7%89%88%E8%BF%BD%E5%8A%A0%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89/)
  + [表示カレンダーの種類](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E8%A1%A8%E7%A4%BA%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E/)
    - [ショートコードのパラメータ](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E8%A1%A8%E7%A4%BA%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E/%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E8%A1%A8%E7%A4%BA%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%88%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/)
    - [共通のメッセージフィルター](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E8%A1%A8%E7%A4%BA%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E/%E4%BA%88%E7%B4%84%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E5%85%B1%E9%80%9A%E3%81%AE%E3%83%A1%E3%83%83%E3%82%BB%E3%83%BC%E3%82%B8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC/)
    - [時間割選択について](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E8%A1%A8%E7%A4%BA%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%AE%E7%A8%AE%E9%A1%9E/%E4%BA%88%E7%B4%84%E3%81%AE%E6%99%82%E9%96%93%E5%89%B2%E9%81%B8%E6%8A%9E%E3%82%BF%E3%82%A4%E3%83%A0%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/)
  + [ユーザー管理パック利用ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/)
    - [処理の目的](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/%E5%87%A6%E7%90%86%E3%81%AE%E7%9B%AE%E7%9A%84/)
    - [MTS Customer利用ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/mts-customer%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/)
    - [MTS Customer活用ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/mts-customer%E6%B4%BB%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/)
    - [MTS Contact利用ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/mts-contact%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/)
    - [MTS Contact活用ガイド](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF%E5%88%A9%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/mts-contact%E6%B4%BB%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89/)
  + [有償版の入手方法・取引条件](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E6%9C%89%E5%84%9F%E7%89%88%E3%81%AE%E5%85%A5%E6%89%8B%E6%96%B9%E6%B3%95/)
  + [利用規約](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/application%E5%88%A9%E7%94%A8%E8%A6%8F%E7%B4%84/)
  + [プライバシーポリシー](http://mtssb.mt-systems.jp/documentation/wordpress%E3%81%8C%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%90%E3%82%B7%E3%83%BC%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC/)
  + [資料室](http://tm.mt-systems.jp/mtssb/)
* [Information](http://mtssb.mt-systems.jp/information/)
  + [無償版とビジネス版との違い](http://mtssb.mt-systems.jp/information/%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E7%89%88%E3%81%A8%E7%84%A1%E5%84%9F%E7%89%88%E3%81%A8%E3%81%AE%E9%81%95%E3%81%84/)
  + [プラグインの競合について](http://mtssb.mt-systems.jp/information/%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%AE%E7%AB%B6%E5%90%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6/)
* [Download](http://mtssb.mt-systems.jp/downloadp/)
  + [シンプル予約システム](http://mtssb.mt-systems.jp/downloadp/)
  + [ユーザー管理パック](http://mtssb.mt-systems.jp/downloadp/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E7%AE%A1%E7%90%86%E3%83%91%E3%83%83%E3%82%AF/)
  + [ビジネス版(有償DL版)](http://mtssb.mt-systems.jp/%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E4%BA%88%E7%B4%84%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E7%89%88/)
  + [ログインウィジェット](http://mtssb.mt-systems.jp/downloadp/login-widget/)
* [Contact](http://mtssb.mt-systems.jp/inquiry/)
  + [お問合せ](https://app.mt-systems.jp/contact-page/)
  + [お申し込み](http://mtssb.mt-systems.jp/application-jump/)
* [App Top](http://app.mt-systems.jp/)

[RSS](http://mtssb.mt-systems.jp/feed/)

# JVN#99312352 MTS Simple Booking Cの脆弱性とその対応について

WordPressのプラグインとして動作するMTS Simple Booking 簡易予約システムに、クロスサイトスクリプティング(以下XSSと呼びます)の脆弱性が存在することが判明しました。

この脆弱性を悪用された場合、WordPressの管理画面を操作する管理者が悪意ある第三者の攻撃により、第三者が仕込んだ任意のJavaScriptプログラムを実行させられてしまう危険性があります。

ページ下部に置き換えの必要がある修正ファイル、あるいは、PHPプログラムの知識がある方は直接プログラムの編集により対応いただけるよう説明をいたします。それぞれの状況に合った方法で対処くださるようお願いします。

お手数をお掛けして大変申し訳ございません。ご協力下さいますようよろしくお願いします。

### 該当製品について

・無償版の「MTS Simple Booking C Ver.1.2.1」ならびに他のバージョンも含む全製品

・「MTS Simple Bookingビジネス版 Ver.1.28.0」以下の全製品

### 脆弱性の詳細

脆弱性に対する攻撃の対象は、WordPressサイトを操作する管理者を狙った攻撃が第一次攻撃となります。

XSSの脆弱性は予約時に入力する「会社名」と「名前」の入力項目で、当該項目にJavaScriptプログラムを入力して予約を実行すると、管理画面において当該項目を表示する「予約リスト」、あるいは「予約カレンダー」の「表示」で入力項目を表示するとき、挿入されたJavaScriptプログラムが実行されるものです。

### 脆弱性がもたらす脅威

埋め込まれたJavaScriptプログラムは、WordPressサイトを操作する管理者が使用するパソコンのブラウザー上で動作します。ですので、サーバーのシステムやファイル、あるいはパソコンのシステムやファイルを直接改竄することはできません。

予想される危険な攻撃は、特にフィッシングと思われます。

予想される動作は、ブラウザー操作において突然画面が切り替わり、ログインIDとパスワードの入力画面が現れたり、あるいは見覚えのないページが表示されたりするものです。

この状況は大変危険な状態で、そこでログインIDやパスワードを入力したり、あるいはリンクを踏んでマルウェアを含むプログラムをダウンロードしてしまう可能性が非常に高くなります。

もしログイン画面がWordPressのそれと似ていた場合、利用者は不思議に思いながらもIDとパスワードを入力してしまう、可能性が心配されます。

### 攻撃を認識する方法

この攻撃は必ず予約処理を伴うため、管理者へ予約メールが送信されます。攻撃プログラムは予約者の「会社名」、または、「名前」に埋め込まれますので、メールの該当箇所にそれが表示されます。

攻撃プログラムは通常判別されにくいように、意味のない文字列の羅列で、暗号化されていると思われます。

### 攻撃者の情報

攻撃を受けた場合、受信メールの時間からサイトへアクセスした時間を推定し、サーバーに保存されたアクセスログを確認すれば、サイトへ接続した端末のIPアドレスを確認できるかもしれません。

またビジネス版では、保存した予約データに利用した端末のIPアドレスが保管されます。

IPアドレスから直接攻撃者を割り出すことはできませんが、利用されたプロバイダー、踏み台にされたと思われるサーバー、アクセス地域などの情報がわかります。

### 無償版の対策方法

無償版の「MTS Simple Booking C」において、脆弱性のあるプログラムファイルは次の２つあります。それぞれダウンロードしてzipファイルを解凍後、プラグインディレクトリの古いファイルを削除して新しくアップロードするか、あるいは上書きしてください。

mtssb-calendar-admin.phpのzipファイル

[ダウンロード開始](http://mtssb.mt-systems.jp/download/mtssb-calendar-admin-1.4.0.zip?nonce=0b09591f5c)

mtssb-list-admin.phpのzipファイル

[ダウンロード開始](http://mtssb.mt-systems.jp/download/mtssb-list-admin-1.4.0.zip?nonce=0b09591f5c)
### 無償版のパッチ修正について

ソースプログラムの修正箇所を記載します。この作業は、ファイルの置き換えが困難な場合(例えば改造して利用している場合など)に、脆弱箇所を直接修正することで対策することを目的とします。

作業の対象者は、PHPプログラムの修正・編集が可能な技術者です。

ソースプログラムが収められているフォルダーはプラグインのディレクトリです。

#### mtssb-calendar-admin.php

修正対象箇所390行目

```
echo empty($client['name']) ? __('No Name', $this->domain) : $client['name'];
```

修正後

```
echo empty($client['name']) ? __('No Name', $this->domain) : esc_html($client['name']);
```
#### mtssb-list-admin.php

修正対象箇所305行目

```
return (empty($item['client']['company']) ? '' : "{$item['client']['company']}<br />") . $item['client']['name'];
```

修正後

```
return (empty($item['client']['company']) ? '' : sprintf('%s<br />', esc_html($item['client']['company']))) . esc_html($item['client']['name']);
```
###

### ビジネス版の対策方法

ビジネス版の脆弱性のある箇所は「mtssb-calendar-admin.php」ファイルで、「mtssb-list-admin.php」ファイルはVer.1.6.0(2013年)以降で脆弱性はありません。

「MTS Simple Bookingビジネス版」の対策は、ダウンロードサイトに新しいシステム「Ver.1.28.1」を用意しましたので、こちらにアップデートしてご利用ください。なおアップデートを実施する際は、データベースのバックアップを用意して作業を進めるようにお願いします。

ダウンロードサイトは以下のURLです。ログイン後アドミンバー右上のユーザー名からユーザーページを開き、製品名からダウンロードページへ移動いただけます。

<https://app.mt-systems.jp/>

### ビジネス版のパッチ修正について

修正箇所の説明は、ダウロードが可能だったビジネス版Ver.1.26.0(Ver.1.28.0)の「mtssb-calendar-admin.php」ファイルが対象となります。ソースプログラム上部にアップデートのバージョンの履歴がありますが、「Ver.1.21.0」と記載されたものです。

作業の対象者は、PHPプログラムの修正・編集が可能な技術者です。

修正箇所は２箇所あります。

１箇所目の修正箇所425行目

```
echo empty($client['name']) ? __('No Name', $this->domain) : $client['name'];
```

修正後

```
echo empty($client['name']) ? __('No Name', $this->domain) : esc_html($client['name']);
```

２箇所目の修正箇所433行目

```
echo empty($client['name']) ? __('No Name', $this->domain) : $client['name'];
```

修正後

```
echo empty($client['name']) ? __('No Name', $this->domain) : esc_html($client['name']);
```
### その他クッキーについての考察

攻撃された場合、管理者が接続するWordPressサイトとの間のブラウザーに保存されているクッキーデータが、攻撃者に知られてしまう可能性があります(WordPressサイト以外のデータを知られることはありません)。

クッキーにパスワードなど重要なデータを保存することはほとんどありませんが、意図的に重要なデータを保存しているようであれば、それが知られてしまう可能性は残ります。

なお「セッションハイジャック」と呼ばれるサイト接続の乗っ取り行為は、WordPressはPHPのセッション機能を利用していないため、ログインに関して発生することはありません。また、現在のところそのような攻撃は存じ上げておりません。

### 関連情報

JVN#99312352

[WordPress用プラグイン MTS Simple Booking C におけるクロスサイトスクリプティングの脆弱性](http://jvn.jp/jp/JVN99312352/index.html)

### 謝辞

東京電機大学の高木様より本脆弱性のご報告をいただきました。高木様、ならびにご対応いただきましたJPCERT/CCの関係者、皆様に感謝申し上げます。

### 更新履歴

2018年02月01日　このページを公開しました。

2018年02月02日　関連情報にJVNのページへのリンクを追加しました。

### 連絡先

本説明内容に関してご不明な点があれば、以下へメールにてお問い合わせください。多数いただいた場合は順次返信いたしますが、内容により返信が難しいことがあるかもしれませんのでご了承ください。

有限会社エムティシステム <mt-systems@mt-systems.jp>

お問い合わせフォーム：<http://mtssb.mt-systems.jp/inquiry/>

#### カテゴリー

* [Attention](http://mtssb.mt-systems.jp/blog/category/attention/)
* [Bug Fix](http://mtssb.mt-systems.jp/blog/category/bug-fix/)
* [Business Version](http://mtssb.mt-systems.jp/blog/category/business-version/)
* [Knowledge](http://mtssb.mt-systems.jp/blog/category/knowledge/)
* [New Version](http://mtssb.mt-systems.jp/blog/category/new-version/)
* [News](http://mtssb.mt-systems.jp/blog/category/news/)
* [Undocumented](http://mtssb.mt-systems.jp/blog/category/undocumented/)
* [Wordpress Tips](http://mtssb.mt-systems.jp/blog/category/wordpress-tips/)
#### 資料リンク

* [フロントエンドユーザー登録機能](http://dm.mt-systems.jp/mtssb/reference/?p=20)
#### ログイン

ユーザー名またはメールアドレス

パスワード

 ログイン状態を保存する

© [MTS Simple Booking](http://mtssb.mt-systems.jp) 2025


