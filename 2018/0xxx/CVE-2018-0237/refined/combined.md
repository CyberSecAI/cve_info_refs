=== Content from wwws.nightwatchcybersecurity.com_4d3bb5fd_20250125_135450.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Research: Auto-detection of Compressed Files in Apple’s macOS
# Research: Auto-detection of Compressed Files in Apple’s macOS

[February 25, 2018April 23, 2018](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/), [macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)

## Summary

Compressed files on macOS are autodetected by the operating system even if they are renamed to certain other extensions. This can be used to fool users and antivirus software that relies on file extensions by packaging malicious code inside compressed files with different extensions. The vendor (Apple) does not consider this to be a security issue. Most anti-virus vendors for macOS are not affected by this issue. This was originally discovered in macOS v10.11 (El Capitan) and v10.12 (Sierra), but the latest version of macOS v10.13 (High Sierra) was not tested.

## Background

*[NOTE: This bug was originally discovered as a result of [a different set of bugs in Google’s Chrome browser](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/). While the impact of this particular issue isn’t high, it was interesting enough for us to pursue a coordinated disclosure process. Because of the large number of parties involved, the disclosure coordination process took a long time which is why this article took almost two years to publish.]*

On Microsoft Windows, files are identified by their extensions, which appears after the “.” in the filename. On macOS metadata about the file maybe available separately and either a creator code, a type code or a [Uniform Type Identifier](https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.htmlhttps%3A//developer.apple.com/library/content/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html) is used. However, on the Internet (in browsers and email clients) instead of filenames, MIME media types are used with [a registry maintained by IANA](https://www.iana.org/assignments/media-types/media-types.xhtml) on behalf of the IETF. Linux systems use a mix of extensions and media types, with some auto-detection / “sniffing” of media types based on file content. Some mappings do exists across the various systems as well.

For example, a ZIP archive would be identified as follows:

* **Windows** – .zip extension
* **Internet/Linux** – application/zip media type
* **macOS UTI** – com.pkware.zip-archive

Additionally, on most desktop OSes, an association exists between a file type and an application that will open it by default. Those associations are maintained differently from OS to OS, but at their core they associate a particular identifier about a file type such as an extension (Windows) or a media type (browsers), and a program assigned to open it by default. Users are used to this arrangement and many security utilities such as antivirus programs will only look inside files that maybe dangerous. For example, a ZIP file on Windows if renamed to a different extension may not necessarily be scanned by default because double clicking on it will not open it.

Another important point is that malware authors may sometimes try to disguise malicious code by compressing it inside an archive such as a ZIP file. The expectation is that when a user downloads it, they will double click and open it using the default program on that platform, and then will execute the malicious code. This is another reason why this functionality deserves a closer look.

## Details

The following two things were discovered:

1. The compression utility that is part of macOS will open any file extension associated with that program and will try to “sniff” / auto-detect the original file type used. The following file extensions were tested:
   * ZIP Files when renamed as:
     + .AS
     + .CPGZ
     + .PAX
     + .XIP (a Gatekeeper warning will be shown for non-signed files)
   * DMG files when renamed as:
     + .CDR
     + .DART
     + .DC42
     + .DISKCOPY42
     + .DMG
     + .DMGPART
     + .DVDR
     + .IMG
     + .IMGPART
     + .ISO
     + .NDIF
     + .SMI
     + .SPARSEBUNDLE
     + .SPARSEIMAGE
     + .TOAST
     + .UDIF
2. The OS itself (macOS) itself will open and execute some file formats even when renamed to a different extension. Gatekeeper protection is not bypassed. The following extensions are affected:
   * PKG
   * MPKG

To duplicate the first issue, create a ZIP file containing any content (we used the EICAR test file) and rename to include a file extension as any of the compression formats above for ZIP. (AS, CPGZ, PAX or XIP). Send this file to a macOS computer via USB or email or a link; download and double click. The ZIP file will open correctly. You can also do the same thing but with a DMG file for any of the DMG file formats listed above (DC42, ISO, etc).

To duplicate the second issue, create a PKG file containing some code or take an existing one, rename as .MPKG and transfer to a macOS computer. Double click to execute.

All testing was done in May 2016 on a MacBook Pro running MacOS v10.11.3 (El Capitan), and re-tested again in April 2017 on a MacBook running MacOS v10.12.04 (Sierra). It is unclear whether later versions of MacOS are affected since we did not perform testing on versions past v10.12.04 (Sierra).

## Recommendations

There are two issues:

1. Human users and anti-malware software are not aware that macOS supports a large number of legacy compression file types and may not be properly looking out for them or scanning them.
2. Because of the “sniffing” behavior, it would be trivial for an attacker to package malware inside a well known format like ZIP or DMG rename it to one of these extensions. Anti-virus software may fail to scan such archives because they do not expect a ZIP file to be packaged that way.

The information in this article was originally discovered while analyzing Google’s Chrome browser ([details here](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)).

Our recommendations are as follows:

* Apple should consider deprecating or adding a warning for these extensions and removing the “sniffing” support.
* Anti-malware software for macOS should support all of these formats, as well as accounting for the possibility of one format being renamed as another

## Vendor Responses

The vendor (Apple) does not consider this to be a security issue as follows:

> After examining your report we do not see any actual security implications. All of the extensions provided in your report are supported disk image formats and will be treated equally.
>
> After examining your report we do not see any actual security implications. Archive Utility opens archive files and the extensions you provided are archive extensions.
>
> After examining your report we do not see any actual security implications. The Installer app makes it clear when executable code is running even if the file has been renamed.

As per advice of Apple’s security team, we also contacted multiple antivirus vendors that provide AV software for macOS to check if they are affected by this issue. Here is what we got back:

**Vendors That Responded:**

* **Avast** – not affected
* **Avira** – not affected
* **AVG** – related bug for engine versions prior to 4668 has been fixed earlier (see CVE-2017-9977 and [our blog post](https://wwws.nightwatchcybersecurity.com/2017/07/06/avg-antivirus-for-macos-doesnt-scan-inside-disk-images-cve-2017-9977/)); other products not affected
* **BitDefender** – not affected
* **Cisco** – one product impacted, tracked by bug identifier CSCve34034 – ~~no CVE has been issued~~ – Cisco has issued [an advisory](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp) and is tracking this under [CVE-2018-0237](https://nvd.nist.gov/vuln/detail/CVE-2018-0237):
  + ***Cisco AMP Virtual Private Cloud Appliance** – The Cisco AMP appliance does not rely on the file extension when processing ZIP archives or PKG install packages. However, older versions relied on file extension to detect DMG files and so is susceptible to one of the scan evasion problems described in the advisory. The DMG portion is now fixed in **software release 1.4.5**.*
* **ClamXAV (Canimaan Software)** – not affected
* **Comodo** – not affected
* **CyberByte** – not affected
* **Dr. Web** – not affected
* **ESet** – not affected
* **F-Secure** – not affected
* **Intego** – not affected
* **Kaspersky** – not affected
* **Malware Bytes** – not affected
* **Protect Works** – not affected
* **QuickHeal** – not affected
* **Sophos** – not affected
* **Symantec** – not affected
* **Trend Micro** – not affected
* **Webroot** – not affected

**Other Vendors:**

* **360 Total Security** – pending
* **BullGuard** – no response
* **EScanAV** – no response
* **GData** – pending
* **Google Chrome** – safe browsing affected prior to M51 and M52 ([see our blog post here](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/))
* **MacKeeper** – no response
* **McAfee** – no response
* **Panda** – no response
* **QuikAV** – pending
* **Total Defense** – pending

## References

Apple Product Security Followup Numbers: 638059697,  640528823 and 640528841

Cisco Bug # [CSCve34034](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp) / CVE # [CVE-2018-0237](https://nvd.nist.gov/vuln/detail/CVE-2018-0237)

## Credits

Advisory written by Yakov Shafranovich.

## Timeline Summary

2016-03-21: Report # 638059697 submitted

2016-05-04: Reports # 640528823 and 640528841 submitted

2016-05-21: Report # 640528823 rejected

2016-06-22: Report # 638059697 rejected

2016-06-23: Report # 640528841 rejected

2017-03-15: Advisory provided to the vendor for comment

2017-04-23: Retested on macOS Sierra, updated and resent to vendor for comment

2017-04-28: Reply from vendor received

2017-05-01: Retested on a fresh install of macOS Sierra, revised advisory sent to vendor for comment

2017-05-01: Notifications go out to AV vendors

2018-01-24: Second time that notifications go out to AV vendors

2018-02-10: Third and final time that notifications go out to AV vendors

2018-02-10: Final advisory shared with the vendor (Apple) for comment

2018-02-25: Public disclosure

2018-04-23: Updated with the new Cisco advisory and CVE

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Content Injection in DuoLingo’s TinyCards App for Android [CVE-2017-16905]](https://wwws.nightwatchcybersecurity.com/2018/01/04/rce-in-duolingos-tinycards-app-for-android-cve-2017-16905/) [Multiple Instances of Download Protection Bypass in Google’s Chrome →](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)

## 3 thoughts on “Research: Auto-detection of Compressed Files in Apple’s macOS”

1. **[Multiple Instances of Download Protection Bypass in Google’s Chrome | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)** says:
   [February 26, 2018 at 10:28 pm](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-965)

   […] The following extensions were reported, confirmed to be dangerous and fixed, all on MacOS (the underlying issue has been described in a separate blog post here). […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=965#respond)
3. **[Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability [CVE-2018-0237] | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/)** says:
   [April 23, 2018 at 5:51 am](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-1076)

   […] Cisco just issued an advisory for this a days ago and is also using CVE # CVE-2018-0237 and bug ID CSCve34034 for tracking. We responsible disclosed this issue to them severla months ago and the technical details of this issue are available in our earlier blog post. […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=1076#respond)
5. **[YAA: An Obscure MacOS Compressed File Format | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2020/06/14/yaa-an-obscure-macos-compressed-file-format/)** says:
   [June 14, 2020 at 11:12 pm](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-5734)

   […] Google Chrome (here and here), and various anti-virus vendors for MacOS handle compressed files (here). Specifically, handling a novel compressed archive format is something that existing antivirus […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=5734#respond)

### Leave a comment [Cancel reply](/2018/02/25/research-compressed-files-auto-detection-on-macos/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F02%252F25%252Fresearch-compressed-files-auto-detection-on-macos%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F02%252F25%252Fresearch-compressed-files-auto-detection-on-macos%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-k7)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1247)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from wwws.nightwatchcybersecurity.com_f2aef9af_20250126_091057.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability [CVE-2018-0237]
# Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability [CVE-2018-0237]

[April 23, 2018April 23, 2018](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/)[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)

Cisco just issued [an advisory](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp) for this a days ago and is also using CVE # [CVE-2018-0237](https://nvd.nist.gov/vuln/detail/CVE-2018-0237) and bug ID CSCve34034 for tracking. We responsible disclosed this issue to them several months ago and the technical details of this issue are available [in our earlier blog post](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/).

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Content Injection in Samsung Display Solutions Application for Android [CVE-2018-6019]](https://wwws.nightwatchcybersecurity.com/2018/03/01/content-injection-in-samsung-display-solutions-application-for-android-cve-2018-6019/) [Android OS Didn’t use FLAG\_SECURE for Sensitive Settings [CVE-2017-13243] →](https://wwws.nightwatchcybersecurity.com/2018/05/24/android-os-didnt-use-flag_secure-for-sensitive-settings-cve-2017-13243/)

### Leave a comment [Cancel reply](/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F04%252F23%252Fcisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F04%252F23%252Fcisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-Cd)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/2369)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from tools.cisco.com_ee389b52_20250126_091100.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability Medium   Advisory ID:  cisco-sa-20180418-amp  First Published: 2018 April 18 16:00 GMT  Version 1.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCve34034](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCve34034)     CVE-2018-0237     CWE-20       CVSS Score: [Base 5.8](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.0&vector=CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2018-0237     CWE-20       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp/csaf/cisco-sa-20180418-amp.json)   Email      Summary  * A vulnerability in the file type detection mechanism of the Cisco Advanced Malware Protection (AMP) for Endpoints macOS Connector could allow an unauthenticated, remote attacker to bypass malware detection.  Affected Products  * Vulnerable ProductsThis vulnerability affects the macOS Connector of Cisco Advanced Malware Protection (AMP) for Endpoints. For information about affected software releases, consult the Cisco bug ID(s) at the top of this advisory.Products Confirmed Not VulnerableNo other Cisco products are currently known to be affected by this vulnerability.      The following Cisco products are confirmed as not vulnerable:   + AnyConnect Secure Mobility Client for iOS   + AnyConnect Secure Mobility Client for Mac OS X   + AMP for Endpoints Windows Connector   + AMP for Endpoints Linux Connector   + AMP for Endpoints iOS Connector   + AMP for Endpoints Android Connector   + Content Security Management Appliance   + Email Security Appliance   + Web Security Appliance  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * For information about fixed software releases, consult the Cisco bug ID(s) at the top of this advisory.  When considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories and Alerts page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is aware of a public announcement of this vulnerability. However, there have been no reports of malicious use of the vulnerability that is described in this advisory.  Source  * Cisco would like to thank Yakov Shafranovich of Nightwatch Cybersecurity Research for reporting this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.0 | Initial public release. | - | Final | 2018-April-18 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from wwws.nightwatchcybersecurity.com_c369f84c_20250126_091057.html ===

[Skip to content](#content)
[![](https://wwws.nightwatchcybersecurity.com/wp-content/uploads/2016/06/1-coojnfoayruptsimgys6tw.png?w=140)](https://wwws.nightwatchcybersecurity.com/)
# [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/)

## Cybersecurity services and research

Menu

* [Home](https://wwws.nightwatchcybersecurity.com/)
* [Blog](https://wwws.nightwatchcybersecurity.com/blog/)
* [Presentations](https://wwws.nightwatchcybersecurity.com/presentations/)
* [Tools](https://wwws.nightwatchcybersecurity.com/tools/)
* [Contact](https://wwws.nightwatchcybersecurity.com/contact/)

[Home](https://wwws.nightwatchcybersecurity.com/)Research: Auto-detection of Compressed Files in Apple’s macOS
# Research: Auto-detection of Compressed Files in Apple’s macOS

[February 25, 2018April 23, 2018](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/) [nightwatchcyber](https://wwws.nightwatchcybersecurity.com/author/nightwatchcyber/)
[Research](https://wwws.nightwatchcybersecurity.com/category/research/)[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/), [macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)

## Summary

Compressed files on macOS are autodetected by the operating system even if they are renamed to certain other extensions. This can be used to fool users and antivirus software that relies on file extensions by packaging malicious code inside compressed files with different extensions. The vendor (Apple) does not consider this to be a security issue. Most anti-virus vendors for macOS are not affected by this issue. This was originally discovered in macOS v10.11 (El Capitan) and v10.12 (Sierra), but the latest version of macOS v10.13 (High Sierra) was not tested.

## Background

*[NOTE: This bug was originally discovered as a result of [a different set of bugs in Google’s Chrome browser](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/). While the impact of this particular issue isn’t high, it was interesting enough for us to pursue a coordinated disclosure process. Because of the large number of parties involved, the disclosure coordination process took a long time which is why this article took almost two years to publish.]*

On Microsoft Windows, files are identified by their extensions, which appears after the “.” in the filename. On macOS metadata about the file maybe available separately and either a creator code, a type code or a [Uniform Type Identifier](https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.htmlhttps%3A//developer.apple.com/library/content/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html) is used. However, on the Internet (in browsers and email clients) instead of filenames, MIME media types are used with [a registry maintained by IANA](https://www.iana.org/assignments/media-types/media-types.xhtml) on behalf of the IETF. Linux systems use a mix of extensions and media types, with some auto-detection / “sniffing” of media types based on file content. Some mappings do exists across the various systems as well.

For example, a ZIP archive would be identified as follows:

* **Windows** – .zip extension
* **Internet/Linux** – application/zip media type
* **macOS UTI** – com.pkware.zip-archive

Additionally, on most desktop OSes, an association exists between a file type and an application that will open it by default. Those associations are maintained differently from OS to OS, but at their core they associate a particular identifier about a file type such as an extension (Windows) or a media type (browsers), and a program assigned to open it by default. Users are used to this arrangement and many security utilities such as antivirus programs will only look inside files that maybe dangerous. For example, a ZIP file on Windows if renamed to a different extension may not necessarily be scanned by default because double clicking on it will not open it.

Another important point is that malware authors may sometimes try to disguise malicious code by compressing it inside an archive such as a ZIP file. The expectation is that when a user downloads it, they will double click and open it using the default program on that platform, and then will execute the malicious code. This is another reason why this functionality deserves a closer look.

## Details

The following two things were discovered:

1. The compression utility that is part of macOS will open any file extension associated with that program and will try to “sniff” / auto-detect the original file type used. The following file extensions were tested:
   * ZIP Files when renamed as:
     + .AS
     + .CPGZ
     + .PAX
     + .XIP (a Gatekeeper warning will be shown for non-signed files)
   * DMG files when renamed as:
     + .CDR
     + .DART
     + .DC42
     + .DISKCOPY42
     + .DMG
     + .DMGPART
     + .DVDR
     + .IMG
     + .IMGPART
     + .ISO
     + .NDIF
     + .SMI
     + .SPARSEBUNDLE
     + .SPARSEIMAGE
     + .TOAST
     + .UDIF
2. The OS itself (macOS) itself will open and execute some file formats even when renamed to a different extension. Gatekeeper protection is not bypassed. The following extensions are affected:
   * PKG
   * MPKG

To duplicate the first issue, create a ZIP file containing any content (we used the EICAR test file) and rename to include a file extension as any of the compression formats above for ZIP. (AS, CPGZ, PAX or XIP). Send this file to a macOS computer via USB or email or a link; download and double click. The ZIP file will open correctly. You can also do the same thing but with a DMG file for any of the DMG file formats listed above (DC42, ISO, etc).

To duplicate the second issue, create a PKG file containing some code or take an existing one, rename as .MPKG and transfer to a macOS computer. Double click to execute.

All testing was done in May 2016 on a MacBook Pro running MacOS v10.11.3 (El Capitan), and re-tested again in April 2017 on a MacBook running MacOS v10.12.04 (Sierra). It is unclear whether later versions of MacOS are affected since we did not perform testing on versions past v10.12.04 (Sierra).

## Recommendations

There are two issues:

1. Human users and anti-malware software are not aware that macOS supports a large number of legacy compression file types and may not be properly looking out for them or scanning them.
2. Because of the “sniffing” behavior, it would be trivial for an attacker to package malware inside a well known format like ZIP or DMG rename it to one of these extensions. Anti-virus software may fail to scan such archives because they do not expect a ZIP file to be packaged that way.

The information in this article was originally discovered while analyzing Google’s Chrome browser ([details here](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)).

Our recommendations are as follows:

* Apple should consider deprecating or adding a warning for these extensions and removing the “sniffing” support.
* Anti-malware software for macOS should support all of these formats, as well as accounting for the possibility of one format being renamed as another

## Vendor Responses

The vendor (Apple) does not consider this to be a security issue as follows:

> After examining your report we do not see any actual security implications. All of the extensions provided in your report are supported disk image formats and will be treated equally.
>
> After examining your report we do not see any actual security implications. Archive Utility opens archive files and the extensions you provided are archive extensions.
>
> After examining your report we do not see any actual security implications. The Installer app makes it clear when executable code is running even if the file has been renamed.

As per advice of Apple’s security team, we also contacted multiple antivirus vendors that provide AV software for macOS to check if they are affected by this issue. Here is what we got back:

**Vendors That Responded:**

* **Avast** – not affected
* **Avira** – not affected
* **AVG** – related bug for engine versions prior to 4668 has been fixed earlier (see CVE-2017-9977 and [our blog post](https://wwws.nightwatchcybersecurity.com/2017/07/06/avg-antivirus-for-macos-doesnt-scan-inside-disk-images-cve-2017-9977/)); other products not affected
* **BitDefender** – not affected
* **Cisco** – one product impacted, tracked by bug identifier CSCve34034 – ~~no CVE has been issued~~ – Cisco has issued [an advisory](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp) and is tracking this under [CVE-2018-0237](https://nvd.nist.gov/vuln/detail/CVE-2018-0237):
  + ***Cisco AMP Virtual Private Cloud Appliance** – The Cisco AMP appliance does not rely on the file extension when processing ZIP archives or PKG install packages. However, older versions relied on file extension to detect DMG files and so is susceptible to one of the scan evasion problems described in the advisory. The DMG portion is now fixed in **software release 1.4.5**.*
* **ClamXAV (Canimaan Software)** – not affected
* **Comodo** – not affected
* **CyberByte** – not affected
* **Dr. Web** – not affected
* **ESet** – not affected
* **F-Secure** – not affected
* **Intego** – not affected
* **Kaspersky** – not affected
* **Malware Bytes** – not affected
* **Protect Works** – not affected
* **QuickHeal** – not affected
* **Sophos** – not affected
* **Symantec** – not affected
* **Trend Micro** – not affected
* **Webroot** – not affected

**Other Vendors:**

* **360 Total Security** – pending
* **BullGuard** – no response
* **EScanAV** – no response
* **GData** – pending
* **Google Chrome** – safe browsing affected prior to M51 and M52 ([see our blog post here](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/))
* **MacKeeper** – no response
* **McAfee** – no response
* **Panda** – no response
* **QuikAV** – pending
* **Total Defense** – pending

## References

Apple Product Security Followup Numbers: 638059697,  640528823 and 640528841

Cisco Bug # [CSCve34034](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp) / CVE # [CVE-2018-0237](https://nvd.nist.gov/vuln/detail/CVE-2018-0237)

## Credits

Advisory written by Yakov Shafranovich.

## Timeline Summary

2016-03-21: Report # 638059697 submitted

2016-05-04: Reports # 640528823 and 640528841 submitted

2016-05-21: Report # 640528823 rejected

2016-06-22: Report # 638059697 rejected

2016-06-23: Report # 640528841 rejected

2017-03-15: Advisory provided to the vendor for comment

2017-04-23: Retested on macOS Sierra, updated and resent to vendor for comment

2017-04-28: Reply from vendor received

2017-05-01: Retested on a fresh install of macOS Sierra, revised advisory sent to vendor for comment

2017-05-01: Notifications go out to AV vendors

2018-01-24: Second time that notifications go out to AV vendors

2018-02-10: Third and final time that notifications go out to AV vendors

2018-02-10: Final advisory shared with the vendor (Apple) for comment

2018-02-25: Public disclosure

2018-04-23: Updated with the new Cisco advisory and CVE

### Share this:

* [Twitter](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?share=twitter "Click to share on Twitter")
* [Facebook](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?share=facebook "Click to share on Facebook")
Like Loading...

# Post navigation

[← Content Injection in DuoLingo’s TinyCards App for Android [CVE-2017-16905]](https://wwws.nightwatchcybersecurity.com/2018/01/04/rce-in-duolingos-tinycards-app-for-android-cve-2017-16905/) [Multiple Instances of Download Protection Bypass in Google’s Chrome →](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)

## 3 thoughts on “Research: Auto-detection of Compressed Files in Apple’s macOS”

1. **[Multiple Instances of Download Protection Bypass in Google’s Chrome | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2018/02/26/multiple-instances-of-download-protection-bypass-in-googles-chrome/)** says:
   [February 26, 2018 at 10:28 pm](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-965)

   […] The following extensions were reported, confirmed to be dangerous and fixed, all on MacOS (the underlying issue has been described in a separate blog post here). […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=965#respond)
3. **[Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability [CVE-2018-0237] | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2018/04/23/cisco-amp-for-endpoints-macos-connector-dmg-file-malware-bypass-vulnerability-cve-2018-0237/)** says:
   [April 23, 2018 at 5:51 am](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-1076)

   […] Cisco just issued an advisory for this a days ago and is also using CVE # CVE-2018-0237 and bug ID CSCve34034 for tracking. We responsible disclosed this issue to them severla months ago and the technical details of this issue are available in our earlier blog post. […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=1076#respond)
5. **[YAA: An Obscure MacOS Compressed File Format | Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com/2020/06/14/yaa-an-obscure-macos-compressed-file-format/)** says:
   [June 14, 2020 at 11:12 pm](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comment-5734)

   […] Google Chrome (here and here), and various anti-virus vendors for MacOS handle compressed files (here). Specifically, handling a novel compressed archive format is something that existing antivirus […]

   [Reply](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/?replytocom=5734#respond)

### Leave a comment [Cancel reply](/2018/02/25/research-compressed-files-auto-detection-on-macos/#respond)

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed.](https://akismet.com/privacy/)

# Search

Search for:

# Categories

* [Advisories](https://wwws.nightwatchcybersecurity.com/category/advisories/) (66)
* [Opinion](https://wwws.nightwatchcybersecurity.com/category/opinion/) (4)
* [Research](https://wwws.nightwatchcybersecurity.com/category/research/) (43)
* [Tools](https://wwws.nightwatchcybersecurity.com/category/tools/) (4)
* [Uncategorized](https://wwws.nightwatchcybersecurity.com/category/uncategorized/) (2)

# Recent Posts

* [Insecure Bootstrap Process in Google’s Cloud SQL Proxy](https://wwws.nightwatchcybersecurity.com/2023/03/19/insecure-bootstrap-process-in-googles-cloud-sql-proxy/)
* [RFC 9116 / “security.txt” Has Been Published](https://wwws.nightwatchcybersecurity.com/2022/04/27/rfc-9116-security-txt-has-been-published/)
* [GitBleed – Finding Secrets in Mirrored Git Repositories – CVE-2022-24975](https://wwws.nightwatchcybersecurity.com/2022/02/11/gitbleed/)
* [Insecure Bootstrap Process in Oracle Cloud CLI](https://wwws.nightwatchcybersecurity.com/2022/02/06/insecure-bootstrap-process-in-oracle-cloud-cli/)
* [Three Reasons Why Log4J Is So Bad: Ubiquity, Severity and Exploitability](https://wwws.nightwatchcybersecurity.com/2021/12/31/three-reasons-why-log4j-is-so-bad-ubiquity-severity-and-exploitability/)
# Tags

[adobe](https://wwws.nightwatchcybersecurity.com/tag/adobe/)
[airflow](https://wwws.nightwatchcybersecurity.com/tag/airflow/)
[amazon](https://wwws.nightwatchcybersecurity.com/tag/amazon/)
[Android](https://wwws.nightwatchcybersecurity.com/tag/android/)
[apache](https://wwws.nightwatchcybersecurity.com/tag/apache/)
[apple](https://wwws.nightwatchcybersecurity.com/tag/apple/)
[arro](https://wwws.nightwatchcybersecurity.com/tag/arro/)
[asus](https://wwws.nightwatchcybersecurity.com/tag/asus/)
[avg](https://wwws.nightwatchcybersecurity.com/tag/avg/)
[aws](https://wwws.nightwatchcybersecurity.com/tag/aws/)
[boozt](https://wwws.nightwatchcybersecurity.com/tag/boozt/)
[bounties](https://wwws.nightwatchcybersecurity.com/tag/bounties/)
[browsers](https://wwws.nightwatchcybersecurity.com/tag/browsers/)
[bsidesdc](https://wwws.nightwatchcybersecurity.com/tag/bsidesdc/)
[bsidesde](https://wwws.nightwatchcybersecurity.com/tag/bsidesde/)
[bugcrowd](https://wwws.nightwatchcybersecurity.com/tag/bugcrowd/)
[chrome](https://wwws.nightwatchcybersecurity.com/tag/chrome/)
[chromebook](https://wwws.nightwatchcybersecurity.com/tag/chromebook/)
[chromeos](https://wwws.nightwatchcybersecurity.com/tag/chromeos/)
[cisco](https://wwws.nightwatchcybersecurity.com/tag/cisco/)
[conferences](https://wwws.nightwatchcybersecurity.com/tag/conferences/)
[content-spoofing](https://wwws.nightwatchcybersecurity.com/tag/content-spoofing/)
[crosswalk](https://wwws.nightwatchcybersecurity.com/tag/crosswalk/)
[csrf](https://wwws.nightwatchcybersecurity.com/tag/csrf/)
[cve-2019-0221](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0221/)
[cve-2019-0232](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-0232/)
[cve-2019-10320](https://wwws.nightwatchcybersecurity.com/tag/cve-2019-10320/)
[duolingo](https://wwws.nightwatchcybersecurity.com/tag/duolingo/)
[eblaster](https://wwws.nightwatchcybersecurity.com/tag/eblaster/)
[eff](https://wwws.nightwatchcybersecurity.com/tag/eff/)
[facebook](https://wwws.nightwatchcybersecurity.com/tag/facebook/)
[firefox](https://wwws.nightwatchcybersecurity.com/tag/firefox/)
[fireos](https://wwws.nightwatchcybersecurity.com/tag/fireos/)
[github](https://wwws.nightwatchcybersecurity.com/tag/github/)
[gmail](https://wwws.nightwatchcybersecurity.com/tag/gmail/)
[google](https://wwws.nightwatchcybersecurity.com/tag/google/)
[gps](https://wwws.nightwatchcybersecurity.com/tag/gps/)
[hackerone](https://wwws.nightwatchcybersecurity.com/tag/hackerone/)
[intel](https://wwws.nightwatchcybersecurity.com/tag/intel/)
[io17](https://wwws.nightwatchcybersecurity.com/tag/io17/)
[java](https://wwws.nightwatchcybersecurity.com/tag/java/)
[jdk](https://wwws.nightwatchcybersecurity.com/tag/jdk/)
[jenkins](https://wwws.nightwatchcybersecurity.com/tag/jenkins/)
[jre](https://wwws.nightwatchcybersecurity.com/tag/jre/)
[jsonp](https://wwws.nightwatchcybersecurity.com/tag/jsonp/)
[kindle](https://wwws.nightwatchcybersecurity.com/tag/kindle/)
[macos](https://wwws.nightwatchcybersecurity.com/tag/macos/)
[messenger](https://wwws.nightwatchcybersecurity.com/tag/messenger/)
[microsoft](https://wwws.nightwatchcybersecurity.com/tag/microsoft/)
[mozilla](https://wwws.nightwatchcybersecurity.com/tag/mozilla/)
[no-ssl](https://wwws.nightwatchcybersecurity.com/tag/no-ssl/)
[office 365](https://wwws.nightwatchcybersecurity.com/tag/office-365/)
[open-redirect](https://wwws.nightwatchcybersecurity.com/tag/open-redirect/)
[oracle](https://wwws.nightwatchcybersecurity.com/tag/oracle/)
[paypal](https://wwws.nightwatchcybersecurity.com/tag/paypal/)
[pia](https://wwws.nightwatchcybersecurity.com/tag/pia/)
[pillpack](https://wwws.nightwatchcybersecurity.com/tag/pillpack/)
[privacy](https://wwws.nightwatchcybersecurity.com/tag/privacy/)
[qualcomm](https://wwws.nightwatchcybersecurity.com/tag/qualcomm/)
[routers](https://wwws.nightwatchcybersecurity.com/tag/routers/)
[s3](https://wwws.nightwatchcybersecurity.com/tag/s3/)
[samsung](https://wwws.nightwatchcybersecurity.com/tag/samsung/)
[spectorsoft](https://wwws.nightwatchcybersecurity.com/tag/spectorsoft/)
[ssl](https://wwws.nightwatchcybersecurity.com/tag/ssl/)
[supplychainattack](https://wwws.nightwatchcybersecurity.com/tag/supplychainattack/)
[synack](https://wwws.nightwatchcybersecurity.com/tag/synack/)
[tinycards](https://wwws.nightwatchcybersecurity.com/tag/tinycards/)
[tomcat](https://wwws.nightwatchcybersecurity.com/tag/tomcat/)
[united](https://wwws.nightwatchcybersecurity.com/tag/united/)
[vpn](https://wwws.nightwatchcybersecurity.com/tag/vpn/)
[whatsapp](https://wwws.nightwatchcybersecurity.com/tag/whatsapp/)
[wickr](https://wwws.nightwatchcybersecurity.com/tag/wickr/)
[windows](https://wwws.nightwatchcybersecurity.com/tag/windows/)
[yandex](https://wwws.nightwatchcybersecurity.com/tag/yandex/)
[zoho](https://wwws.nightwatchcybersecurity.com/tag/zoho/)
# Subscribe to Blog via Email

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Email Address:

Subscribe

Join 1,120 other subscribers

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Bugcrowd](https://bugcrowd.com/nightwatch-cybersecurity)
* [HackerOne](https://hackerone.com/nightwatch-cybersecurity)
* [Twitter](https://twitter.com/nightwatchcyber)

* [Comment](https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)

  Join 115 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F02%252F25%252Fresearch-compressed-files-auto-detection-on-macos%252F)
* Privacy
* + [![](https://s0.wp.com/i/logo/wpcom-gray-white.png) Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwwws.nightwatchcybersecurity.com%252F2018%252F02%252F25%252Fresearch-compressed-files-auto-detection-on-macos%252F)
  + [Copy shortlink](https://wp.me/p7EvFy-k7)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wwws.nightwatchcybersecurity.com/2018/02/25/research-compressed-files-auto-detection-on-macos/)
  + [View post in Reader](https://wordpress.com/read/blogs/113089212/posts/1247)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from sec.cloudapps.cisco.com_5e716a64_20250126_091100.html ===
{
"document": {
"acknowledgments": [
{
"summary": "Cisco would like to thank Yakov Shafranovich of Nightwatch Cybersecurity Research for reporting this vulnerability."
}
],
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"notes": [
{
"category": "summary",
"title": "Summary",
"text": "A vulnerability in the file type detection mechanism of the Cisco Advanced Malware Protection (AMP) for Endpoints macOS Connector could allow an unauthenticated, remote attacker to bypass malware detection.\r\n\r\nThe vulnerability occurs because the software relies on only the file extension for detecting DMG files. An attacker could exploit this vulnerability by sending a DMG file with a nonstandard extension to a device that is running an affected AMP for Endpoints macOS Connector. An exploit could allow the attacker to bypass configured malware detection.\r\n\r\nThere are no workarounds that address this vulnerability.\r\n\r\nThis advisory is available at the following link:\r\nhttps://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp [\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp\"]"
},
{
"category": "general",
"title": "Vulnerable Products",
"text": "This vulnerability affects the macOS Connector of Cisco Advanced Malware Protection (AMP) for Endpoints. For information about affected software releases, consult the Cisco bug ID(s) at the top of this advisory."
},
{
"category": "general",
"title": "Products Confirmed Not Vulnerable",
"text": "No other Cisco products are currently known to be affected by this vulnerability.\r\n\r\nThe following Cisco products are confirmed as not vulnerable:\r\n\r\nAnyConnect Secure Mobility Client for iOS\r\nAnyConnect Secure Mobility Client for Mac OS X\r\nAMP for Endpoints Windows Connector\r\nAMP for Endpoints Linux Connector\r\nAMP for Endpoints iOS Connector\r\nAMP for Endpoints Android Connector\r\nContent Security Management Appliance\r\nEmail Security Appliance\r\nWeb Security Appliance"
},
{
"category": "general",
"title": "Workarounds",
"text": "There are no workarounds that address this vulnerability."
},
{
"category": "general",
"title": "Fixed Software",
"text": "For information about fixed software releases, consult the Cisco bug ID(s) at the top of this advisory.\r\n\r\nWhen considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories and Alerts page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers."
},
{
"category": "general",
"title": "Vulnerability Policy",
"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco."
},
{
"category": "general",
"title": "Exploitation and Public Announcements",
"text": "The Cisco Product Security Incident Response Team (PSIRT) is aware of a public announcement of this vulnerability. However, there have been no reports of malicious use of the vulnerability that is described in this advisory."
},
{
"category": "general",
"title": "Source",
"text": "Cisco would like to thank Yakov Shafranovich of Nightwatch Cybersecurity Research for reporting this vulnerability."
},
{
"category": "legal\_disclaimer",
"title": "Legal Disclaimer",
"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products."
}
],
"publisher": {
"category": "vendor",
"contact\_details": "Emergency Support:\r\n+1 877 228 7302 (toll-free within North America)\r\n+1 408 525 6532 (International direct-dial)\r\nNon-emergency Support:\r\nEmail: psirt@cisco.com\r\nSupport requests that are received via e-mail are typically acknowledged within 48 hours.",
"issuing\_authority": "Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.\r\nMore information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html",
"name": "Cisco",
"namespace": "https://wwww.cisco.com"
},
"references": [
{
"category": "self",
"summary": "Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp"
},
{
"category": "external",
"summary": "Cisco Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
},
{
"category": "external",
"summary": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180418-amp"
},
{
"category": "external",
"summary": "Cisco Security Advisories and Alerts page",
"url": "https://www.cisco.com/go/psirt"
},
{
"category": "external",
"summary": "Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
}
],
"title": "Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability",
"tracking": {
"current\_release\_date": "2018-04-18T16:00:00+00:00",
"generator": {
"date": "2022-09-03T03:03:15+00:00",
"engine": {
"name": "TVCE"
}
},
"id": "cisco-sa-20180418-amp",
"initial\_release\_date": "2018-04-18T16:00:00+00:00",
"revision\_history": [
{
"date": "2018-04-17T15:32:13+00:00",
"number": "1.0.0",
"summary": "Initial public release."
}
],
"status": "final",
"version": "1.0.0"
}
},
"product\_tree": {
"branches": [
{
"name": "Cisco",
"category": "vendor",
"branches": [
{
"name": "Cisco AMP for Endpoints",
"category": "product\_family",
"product": {
"name": "Cisco AMP for Endpoints ",
"product\_id": "CSAFPID-221075"
}
}
]
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2018-0237",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCve34034"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-221075"
]
},
"release\_date": "2018-04-18T16:00:00+00:00",
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-221075"
],
"url": "https://software.cisco.com"
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 5.8,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N",
"version": "3.0"
},
"products": [
"CSAFPID-221075"
]
}
],
"title": "Cisco AMP for Endpoints macOS Connector DMG File Malware Bypass Vulnerability"
}
]
}

=== Content from sec.cloudapps.cisco.com_efa43f24_20250126_091102.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.0 |
| Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Attack Complexity AC: Low AC: High  Privileges Required PR: None PR: Low PR: High  User Interaction UI: Required UI: None  Scope S: Unchanged S: Changed  Confidentiality Impact C: None C: Low C: High  Integrity Impact I: None I: Low I: High  Availability Impact A: None A: Low A: High     Base Score: 5.8 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Unproven  E: Proof-of-Concept  E: Functional  E: High  E: Not Defined   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Confirmed  RC: Not Defined   Select Report Confidence Parameters     Temporal Score: 5.8 |

| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: Not Defined  CR: High   Integrity Requirement IR: Low  IR: Medium  IR: Not Defined  IR: High   Availability Requirement AR: Low  AR: Medium  AR: Not Defined  AR: High   Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined      Environmental Score: 5.8 |

| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from bst.cloudapps.cisco.com_417998a9_20250126_091101.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.


