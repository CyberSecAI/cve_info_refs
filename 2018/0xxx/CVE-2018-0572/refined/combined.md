=== Content from basercms.net_006e1b80_20250124_201344.html ===


[![baserCMS](/theme/baserofficial-2020/img/common/logo_icon.svg)](/)
[![baserCMS](/theme/baserofficial-2020/img/common/logo_icon.svg)](/)

* [NEWS](/news/)
* [製品情報](/about/)
  + [baserCMSとは？](/about/)
  + [baserCMSの機能](/about/functions)
  + [システム要件](/about/system)
  + [始めてガイド](/about/guide.html)
  + [デモサイト](/demo/)
  + [導入事例](/works/)
* [マーケット](http://market.basercms.net/)
* [サポート](https://forum.basercms.net)
  + [公式ガイド](https://baserproject.github.io/)
  + [ユーザーズフォーラム](https://forum.basercms.net)
  + [ユーザーマニュアル](/pdf/manual/usermanual.pdf)
  + [お問い合わせ](/contact/)
* [制作会社を探す](/partners/)
* [ホスティングを探す](/hosting/)
* [ダウンロード](/download/)
  + [baserCMS](/download/)
  + [デザインデータ](/download/design_data)

* [Web
  クリエイター
  の方へ](/creator/)
* [参加・貢献
  （コミュニティ）](/community/)

* [TOP](/)
* [NEWS](/news/)
* [製品情報](/about/)
  + [baserCMSとは？](/about/)
  + [baserCMSの機能](/about/functions)
  + [システム要件](/about/system)
  + [始めてガイド](/about/guide.html)
  + [デモサイト](/demo/)
  + [導入事例](/works/)
* [マーケット](http://market.basercms.net/)
* [サポート](https://forum.basercms.net/)
  + [公式ガイド](https://baserproject.github.io/)
  + [ユーザーズフォーラム](https://forum.basercms.net)
  + [ユーザーマニュアル](/pdf/manual/usermanual.pdf)
  + [お問い合わせ](/contact/)
* [制作会社を探す](/partners/)
* [ホスティングを探す](/hosting/)
* [ダウンロード](/download/)
* [Webクリエイターの方へ](/creator/)
* [参加・貢献（コミュニティ）](/community/)
* [開発者の方へ](/developer/)

ダウンロード数/**...**最新バージョン/**...**

[![baserCMS 5 カスタムコンテンツ機能を備え、ヘッドレス化](/theme/baserofficial-2020/img/common/bnr_baserCMS5.png?1707464788)](/ver5/)

![baserCMS](/theme/baserofficial-2020/img/common/logo.svg)
ダウンロード数/
...回
最新バージョン/
...

[今すぐダウンロード](/download/index.html)

# SECURITY セキュリティ情報

## 2018/05/18 コードインジェクションをはじめとする複数の脆弱性

# コードインジェクションをはじめとする複数の脆弱性

2018年05月18日

baserCMSに、コードインジェクションをはじめとする複数の脆弱性があります。

baserCMSの旧バージョンで運営されている方は必ずご対応をお願いいたします。

## 影響を受けるシステム

* baserCMS 3.0.15 およびそれ以前のバージョン
* baserCMS 4.1.0.1 およびそれ以前のバージョン

## 想定される影響

* **(1)コマンドインジェクション**

  システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、固定ページにおいて任意のコードを実行される可能性があります。
* **(2)クロスサイトスクリプティング**

  システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、パンくず、canonicalタグ、ニックネームにおいて任意のコードを実行される可能性があります。
* **(3)アップロードファイル管理機能における危険なタイプのファイルの無制限アップロード**

  システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、phpファイル等の危険なタイプのファイルがアップロードされる可能性があります。
* **(4)コンテンツ管理機能におけるアクセス制限不備**

  システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、コンテンツ一覧を制限していても、URLを直接入力する事により、各コンテンツの編集画面にアクセスされる可能性があります。
* **(5)公開期限が過ぎたコンテンツに対するアクセス制限不備**

  インストールが正常に行われていない場合、URLを直接指定する事により、ファイルアップローダーでアップロードしたファイルについて公開期限外でもアクセスされる可能性があります。
* **(6)テーマ管理機能におけるクロスサイトスクリプティング**

  システム管理グループ以外のユーザーに管理システムへのログインを許可している場合、テーマのファイル管理において任意のコードを実行される可能性があります。
* **(7)メールフォームのファイル添付機能におけるアクセス制限不備**

  インストールが正常に行われていない場合、URLを直接指定する事により、メールフォームで送信したファイルについてアクセスされる可能性があります。

## 対策方法

### 最新バージョンにアップデートする

最新バージョン 3.0.16 / 4.1.1 にアップデートすることで対応する事ができます。

次のページより最新バージョンのダウンロードを行い、リリースノートに基づきバージョンアップ作業を行います。

* [baserCMS 3.0.16 ダウンロード](/packages/download/basercms/3.0.16)
* [baserCMS 4.1.1 ダウンロード](/packages/download/basercms/4.1.1)

### 修正プログラムを適用する

早急に対応する場合には提供されている修正プログラムを適用します。

[2018年5月18日配布 修正パッチ一覧](/patch/20180518)

なお、以前、8月23日に配布した修正プログラムを適用しておらず、そちらも適用する場合は、上記の修正プログラムの前に適用しておきます。

[2017年8月23日配布 修正パッチ一覧](https://basercms.net/patch/20170823)

### (1)コマンドインジェクションについての対策

baserCMSでは、固定ページにおいて、PHPコードの登録を許容する仕様となっていますが、システム管理者グループ以外のユーザーへのPHPコード登録を許容しない場合は、最新版へのアップデート後、または、修正プログラムの適用後に、app/Config/install.php の一番最後の行に、下記のコードを記述し保存してください。

`<?php Configure::write('BcApp.allowedPhpOtherThanAdmins', false); ?>`

なお、最新版の新規インストールにおいては、初期状態にて、システム管理者グループ以外のユーザーへのPHPコード登録を許容しない設定となっています。

### (2)クロスサイトスクリプティングについての対策

現在利用しているテーマにおいて、下記のファイルが存在する場合は、最新版アップデート後、または、修正プログラムの適用後に、ファイルの修正が必要です。

なお、ファイル内に対象コードが存在しない場合は対応は不要です。

Elements/crumbs.php

```
$this->BcBaser->addCrumb($crumb['name']);
　　↓
$this->BcBaser->addCrumb(h($crumb['name']));
```
```
$this->BcBaser->addCrumb($crumb['name'], $crumb['url']);
　　↓
$this->BcBaser->addCrumb(h($crumb['name']), $crumb['url']);

```

Elements/widgets/blog\_author\_archives.php

```
<?php $this->BcBaser->link($title, $this->request->params['Content']['name'] . '/archives/author/' . $author['User']['name']) ?>
　　↓
<?php $this->BcBaser->link($title, $this->request->params['Content']['name'] . '/archives/author/' . $author['User']['name'], ['escape' => true]) ?>

```

Elements/smartphone/widgets/blog\_author\_archives.php

```
<?php $this->BcBaser->link($title, $this->request->params['Content']['name'] . '/archives/author/' . $author['User']['name']) ?>
　　↓
<?php $this->BcBaser->link($title, $this->request->params['Content']['name'] . '/archives/author/' . $author['User']['name'], ['escape' => true]) ?>
```
### (4)コンテンツ管理機能におけるアクセス制限不備についての対策

コンテンツ管理機能でアクセス制限を行う際には、配下のコンテンツの詳細画面について、該当ページのURLを全て登録してください。

## 謝辞

この脆弱性情報公表にあたり、IPA、JPCERT/CC に謝辞を申し上げます。

[デモサイトを見る](/demo/)
[今すぐダウンロード](/download/index.html)

baserCMSの最新ニュースをお届けします

* [TOP](/)
* [NEWS](/news/)
  + [お知らせ](/news/archives/category/news)
  + [リリースノート](/news/archives/category/release)
  + [プレスリリース](/news/archives/category/press_release)
  + [イベント情報](/news/archives/category/event)
  + [レポート](/news/archives/category/report)
  + [マーケット](/news/archives/category/market)
* [プレスリリース](/press_release/)
* [製品情報](/about/)
  + [baserCMSとは？](/about/)
  + [baserCMSの機能](/about/functions)
  + [始めてガイド](/about/guide.html)
  + [デモサイト](/demo/)
  + [導入事例](/works/)

* [マーケット](https://market.basercms.net/)
* [サポート](https://forum.basercms.net/)
  + [ユーザーズフォーラム](https://forum.basercms.net/)
  + [ユーザーマニュアル](/pdf/manual/usermanual.pdf)
  + [お問い合わせ](/contact/)
* [制作会社を探す](/partners/)
* [ホスティングを探す](/hosting/)
* [baserCMSダウンロード](/download/)
  + [デザインデータダウンロード](/download/design_data)

* [Webクリエイターの方へ](/creator/)
  + [baserCMS公式ガイド](https://baserproject.github.io/)
  + [テーマ制作チュートリアル](/files/baser4tutorial.zip)
* [参加・貢献（コミュニティ）](/community/)
  + [コンセプト](/community/concept)
  + [コミュニティの歴史](/community/history)
  + [baserCMSのチーム](/community/team/)
  + [プロジェクトに寄付](/donate)
  + [開発者の方へ](/developer/)
  + [baser井戸端もくもく会](/community/idomoku/)
  + [スペシャルサンクス](/thanks/)

* [開発者の方へ](/developer/)
  + [ソフトウェア要件](/about/system)
  + [ライセンス](/about/license)
  + [baserCMSのGitHub](https://github.com/baserproject/basercms)
  + [baserCMS API Document](http://api.basercms.net/)
* [支援企業](/thanks/)
  + [NPO法人ベーサー・ファウンデーション](http://baserfoundation.org/)
  + [株式会社ディーゼロ](https://www.d-zero.co.jp/)
  + [株式会社キャッチアップ](https://catchup.co.jp/)
* [baserCMS雑談広場](https://www.facebook.com/groups/basercms.zatsudan/)

* [![X](/theme/baserofficial-2020/img/common/icn_x.svg)](http://twitter.com/basercms)
* [![facebook](/theme/baserofficial-2020/img/common/icn_facebook.svg)](https://www.facebook.com/basercms)
* [![instagram](/theme/baserofficial-2020/img/common/icn_instagram.svg)](https://www.instagram.com/basercms/)

© 2009 - 2025 baserCMS All rights reserved.



=== Content from jvn.jp_6e2e8841_20250124_201342.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2018/05/22  Last Updated:2018/05/22
# JVN#67881316 Multiple vulnerabilities in baserCMS

## Overview

baserCMS provided by baserCMS Users Community contains multiple vulnerabilities.

## Products Affected

* baserCMS 4.1.0.1 and earlier versions
* baserCMS 3.0.15 and earlier versions

## Description

baserCMS provided by baserCMS Users Community is an opensource content management system. baserCMS contains multiple vulnerabilities listed below.

* **Command injection ([CWE-94](https://cwe.mitre.org/data/definitions/94.html))** - CVE-2018-0569

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L | **Base Score: 6.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:P/A:P | **Base Score: 6.5** |
* **Cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2018-0570

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N | **Base Score: 5.4** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:S/C:N/I:P/A:N | **Base Score: 3.5** |
* **Unrestricted Upload of File with Dangerous Type in upload file management function ([CWE-434](https://cwe.mitre.org/data/definitions/434.html))** - CVE-2018-0571

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N | **Base Score: 4.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:N/I:P/A:N | **Base Score: 4.0** |
* **Restrict access permissions failure in contents management function ([CWE-264](https://cwe.mitre.org/data/definitions/264.html))** - CVE-2018-0572

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N | **Base Score: 4.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:N/A:N | **Base Score: 4.0** |
* **Restrict access permissions failture for a content with a period being public is expired ([CWE-264](https://cwe.mitre.org/data/definitions/264.html))** - CVE-2018-0573

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N | **Base Score: 5.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:N/C:P/I:N/A:N | **Base Score: 5.0** |
* **Cross-site scripting in theme management function ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2018-0574

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | **Base Score: 6.1** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:N/C:N/I:P/A:N | **Base Score: 5.0** |
* **Restrict access permissions failure in the function to attach files in mail form ([CWE-264](https://cwe.mitre.org/data/definitions/264.html))** - CVE-2018-0575

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N | **Base Score: 5.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:N/C:P/I:N/A:N | **Base Score: 5.0** |

## Impact

* A remote attacker may execute arbitrary code with the operation manager privilege - CVE-2018-0569
* An attacker who can log in to the product as a site operator privilege may execute arbitrary OS commands - CVE-2018-0570
* An attacker who can log in to the product as a site operator privilege may upload arbitrary files - CVE-2018-0571
* An attacker who can log in to the product as a site operator privilege may view or alter a restricted content - CVE-2018-0572
* A remote attacker may view a file which is uploaded by a site user - CVE-2018-0573
* An arbitrary script may be executed on the user's web browser where the user accesses the theme management function - CVE-2018-0574
* A remote attacker may view a file which is uploaded by a site user. - CVE-2018-0575

## Solution

Solution for CVE-2018-0570, CVE-2018-0571, CVE-2018-0573, CVE-2018-0574, and CVE-2018-0575ï¼

**Update the software**

Update to the latest version according to the information provided by the developer.

According to the developer, CVE-2018-0573 and CVE-2018-0575 vulnerabilities do not exist if the product has been successfully installed.  Those 2 vulnerabilities exist only in the situation where the installation of the product failed with issues such as access restrictions, etc.

Solution for CVE-2018-0569:

**Update the software and then configure a user authentication properly**

Update the software first, and then set a user authentication enabled/disabled.  If a user authentication is enabled, a system administrator's privilege is required to save a script in an article.

The developer states that all authentications besides a system administrator's authentication becomes disabled, and then setting respective authentications enabled/disabled appropriately becomes possible after updating the software to the latest version.

All users authentications are enabled if installing the software for the first time using the latest installer.

Solution for CVE-2018-0572:

**Apply a Workaround**

When restricting access control using contents management function, be sure to register all URLs of the pages that need to be accessed.

For more information, refer to the [developer's website](https://basercms.net/security/JVN67881316).

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| baserCMS Users Community | [Vulnerable](995230/index.html) | 2018/05/22 | [baserCMS Users Community website](https://basercms.net/security/JVN67881316) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

Following researchers reported respective vulnerabilities to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning partnership.

CVE-2018-0569, CVE-2018-0570, CVE-2018-0571, CVE-2018-0572, and CVE-2018-0573

Toshitsugu Yoneyama and Gaku Mochizuki of Mitsui Bussan Secure Directions, Inc.

CVE-2018-0574 and CVE-2018-0575

Gaku Mochizuki of Mitsui Bussan Secure Directions, Inc.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2018-0569](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0569) |
|  | [CVE-2018-0570](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0570) |
|  | [CVE-2018-0571](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0571) |
|  | [CVE-2018-0572](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0572) |
|  | [CVE-2018-0573](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0573) |
|  | [CVE-2018-0574](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0574) |
|  | [CVE-2018-0575](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0575) |
| JVN iPedia | [JVNDB-2018-000055](https://jvndb.jvn.jp/jvndb/JVNDB-2018-000055) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2018 JPCERT/CC and IPA. All rights reserved.


