=== Content from bugzilla.redhat.com_0ba2abe2_20250125_225944.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1576174)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1576174)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1576174)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1576174

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1576174**](show_bug.cgi?id=1576174)
- (Excessive Iteration in PdfPagesTree::GetPageNode()) podofo Denial of Service

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
(Excessive Iteration in PdfPagesTree::GetPageNode()) podofo Denial of Service

| | [Keywords](describekeywords.cgi): |  | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED EOL | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora EPEL | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora EPEL "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | podofo | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | epel7 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Dan Horák | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1576174&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1576174&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2018-05-09 04:22 UTC by Zhiyuan Wang of Chengdu Qihoo360 Tech Co. Ltd | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-07-09 02:20 UTC ([History](show_activity.cgi?id=1576174)) | | [CC List:](page.cgi?id=fields.html#cclist) | 3 users (show)  carnil dan manisandro | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2024-07-09 02:20:50 UTC | | | Type: | Bug | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**crash demo file**](attachment.cgi?id=1433509 "View the content of the attachment") (2.29 KB, application/pdf)  [2018-05-09 04:22 UTC](#attach_1433509 "Go to the comment associated with the attachment"), Zhiyuan Wang of Chengdu Qihoo360 Tech Co. Ltd | *no flags* | [Details](attachment.cgi?id=1433509&action=edit) | | [View All](attachment.cgi?bugid=1576174&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1576174#c0)  Zhiyuan Wang of Chengdu Qihoo360 Tech Co. Ltd    2018-05-09 04:22:55 UTC  ``` Created [attachment 1433509](attachment.cgi?id=1433509 "crash demo file") [[details]](attachment.cgi?id=1433509&action=edit "crash demo file") crash demo file  Description of problem: there is an Excessive Iteration in the PdfPagesTree::GetPageNode() function of PdfPagesTree.cpp:423. Remote attackers could leverage this vulnerability to cause a denial of service through a crafted pdf file.  Version-Release number of selected component (if applicable): podofo 0.9.5  Detailed analysis of crash: $ gdb podofomerge  (gdb) r crash.pdf crash.pdf out.pdf ... CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R CRITICAL: Requesting page index 0. Invalid datatype referenced in kids array: Dictionary Reference to invalid object: 1 0 R  Program received signal SIGSEGV, Segmentation fault. 0xb785b197 in __find_specmb (format=0xb7f79464 "%s") at printf-parse.h:108 108	printf-parse.h: No such file or directory.     (gdb) bt #0  0xb785b197 in __find_specmb (format=0xb7f79464 "%s") at printf-parse.h:108 #1  _IO_vfprintf_internal (s=0xbf800538, format=0xb7f79464 "%s", ap=0xbf802b3c "5j\367\267Wqķ") at vfprintf.c:1312 #2  0xb785d671 in buffered_vfprintf (s=s@entry=0xb79cbcc0 <_IO_2_1_stderr_>, format=format@entry=0xb7f79464 "%s", args=args@entry=0xbf802b3c "5j\367\267Wqķ") at vfprintf.c:2320 #3  0xb785b2d1 in _IO_vfprintf_internal (s=0xb79cbcc0 <_IO_2_1_stderr_>, format=0xb7f79464 "%s", ap=0xbf802b3c "5j\367\267Wqķ") at vfprintf.c:1293 #4  0xb790e456 in ___fprintf_chk (fp=0xb79cbcc0 <_IO_2_1_stderr_>, flag=1, format=0xb7f79464 "%s") at fprintf_chk.c:35 #5  0xb7c47347 in fprintf (__fmt=0xb7f79464 "%s", __stream=<optimized out>) at /usr/include/i386-linux-gnu/bits/stdio2.h:98 #6  PoDoFo::PdfError::LogMessageInternal (eLogSeverity=PoDoFo::eLogSeverity_Critical,      pszMsg=0xb7f8a408 "Requesting page index %i. Invalid datatype referenced in kids array: %s\nReference to invalid object: %i %i R\n", args=@0xbf802b68: 0xbf802b88 "")     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/base/PdfError.cpp:574 #7  0xb7c476aa in PoDoFo::PdfError::LogMessage (eLogSeverity=PoDoFo::eLogSeverity_Critical,      pszMsg=0xb7f8a408 "Requesting page index %i. Invalid datatype referenced in kids array: %s\nReference to invalid object: %i %i R\n") at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/base/PdfError.cpp:528 #8  0xb7edd832 in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:447 #9  0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #10 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #11 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #12 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #13 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #14 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #15 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #16 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #17 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #18 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...})     at /home/zzuf/pdf-fuzz/podofo-0.9.5/src/doc/PdfPagesTree.cpp:423 #19 0xb7eddc8b in PoDoFo::PdfPagesTree::GetPageNode (this=0x8062540, nPageNum=134615064, pParent=0x8061018, rLstParents=std::deque with 52325 elements = {...}) ...   PdfPagesTree.cpp:312:  PdfObject* PdfPagesTree::GetPageNode( int nPageNum, PdfObject* pParent,                                        PdfObjectList & rLstParents )  {    ...         // We have to traverse the tree         while( it != rKidsArray.end() )          {            ...             else if( (*it).IsReference() )              {                 PdfObject* pChild = GetRoot()->GetOwner()->GetObject( (*it).GetReference() );                 if (!pChild)                  {                     PdfError::LogMessage( eLogSeverity_Critical, "Requesting page index %i. Child not found: %s\n",                                            nPageNum, (*it).GetReference().ToString().c_str());                      return NULL;                 }                  if( this->IsTypePages(pChild) )                  {                     int childCount = GetChildCount( pChild );                     if( childCount < nPageNum + 1 ) // Pages are 0 based, but count is not                     {                         // skip this page node                         // and go to the next one                         nPageNum -= childCount;                     }                     else                     {                         rLstParents.push_back( pParent );                         return this->GetPageNode( nPageNum, pChild, rLstParents );  //?????????????????????????????????                     }                 }                 else if( this->IsTypePage(pChild) )                  {                     if( 0 == nPageNum )                     {                         rLstParents.push_back( pParent );                         return pChild;                     }                       // Skip a normal page                     if(nPageNum > 0 )                         nPageNum--;                 } 		else 		{                     const PdfReference & rLogRef = pChild->Reference();                     pdf_objnum nLogObjNum = rLogRef.ObjectNumber();                     pdf_gennum nLogGenNum = rLogRef.GenerationNumber(); 		    PdfError::LogMessage( eLogSeverity_Critical,                                           "Requesting page index %i. "                         "Invalid datatype referenced in kids array: %s\n"                         "Reference to invalid object: %i %i R\n", nPageNum,                         pChild->GetDataTypeString(), nLogObjNum, nLogGenNum);                 }             }             else             {                 PdfError::LogMessage( eLogSeverity_Critical, "Requesting page index %i. Invalid datatype in kids array: %s\n",                                        nPageNum, (*it).GetDataTypeString());                  return NULL;             }                          ++it;         }     }      return NULL; }   How reproducible:  use podofomerge to read the attached poc file.  Steps to Reproduce: 1. podofomerge crash.pdf crash.pdf out.pdf   ```  [Comment 1](show_bug.cgi?id=1576174#c1)  Troy Dawson    2024-07-09 02:20:50 UTC  ``` EPEL 7 entered end-of-life (EOL) status on 2024-06-30.\n\nEPEL 7 is no longer maintained, which means that it\nwill not receive any further security or bug fix updates.\n As a result we are closing this bug.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1576174&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


