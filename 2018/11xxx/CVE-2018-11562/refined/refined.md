Based on the provided commit information, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
- The vulnerability is a reflected Cross-Site Scripting (XSS) issue.
- The `toggleDeletedAttributes` function was using `Router::url( $this->here, true )` to generate the URL, which was vulnerable because it did not properly sanitize URL components, allowing malicious JavaScript to be injected via the URL parameters.
- This malicious URL with JavaScript payload is triggered when a user clicks the "Include deleted attributes" tab on the event view.

**Weaknesses/Vulnerabilities Present:**
- **Reflected XSS:** The application reflected unsanitized user-supplied input (the URL) into the HTML output. Specifically, the `onClick` event handler in the "Include deleted attributes" section uses the unsanitized URL within javascript function call.
- **Insufficient Input Sanitization:** The application failed to sanitize the URL parameters before embedding them within the HTML.

**Impact of Exploitation:**
- **Arbitrary JavaScript Execution:** An attacker could inject malicious JavaScript code that would execute in the victim's browser when they click on the vulnerable "Include deleted attributes" tab, in the context of the user session.
- **Session Hijacking:** The attacker might be able to steal user session cookies or other sensitive data.
- **Malicious Actions:** An attacker could potentially perform unauthorized actions on behalf of the victim if they click on the malicious URL.

**Attack Vectors:**
- **Malicious URL:** The attacker creates a crafted URL containing a JavaScript payload.
- **Social Engineering:** The attacker would then need to trick the victim into visiting the malicious URL.
- **Triggered via User Interaction:** When the user clicks the "Include deleted attributes" tab on the event view, the malicious JavaScript is executed.

**Required Attacker Capabilities/Position:**
- **URL crafting:** Attacker must be capable of crafting a URL with a JavaScript payload
- **Social engineering:** The attacker needs to find a way to trick the victim into visiting the malicious URL.
- The attacker does not need any privileged access to the application server to execute the attack since the XSS is reflected.

**Additional Notes:**
- The fix for this vulnerability involved sanitizing the URL before inserting it into the HTML, by replacing the usage of Router::url with the code shown in diff which uses `urlencode()` to encode all parts of the URL before using it
- The commit message explicitly mentions that the vulnerability was reported by Jarek Kozluk from zbp.pl.