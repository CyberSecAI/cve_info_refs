=== Content from mahara.org_606f0a4d_20250124_164127.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Security issue relating to the upload of a virus-infected file <17.04.8; <17.10.5: <18.04.1

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Cecilia Vela's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=432415)
[Cecilia Vela](https://mahara.org/user/cecilia-1)

Posts: 110

30 May 2018, 17:35

Virus scanner does not check Leap2A zip files

Vulnerability type: Upload of a virus-infected file

Description:
Mahara 17.04 before 17.04.8 and 17.10 before 17.10.5 and 18.04 before 18.04.1 can be used as medium to transmit viruses by placing infected files into a Leap2A archive and uploading that to Mahara. In contrast to other ZIP files that are uploaded, ClamAV (when activated) does not check Leap2A archives for viruses, allowing malicious files to be available for download. While files cannot be executed on Mahara itself, Mahara can be used to transfer such files to user computers.

Reported by Swe Zin Lynn, The Australian National University
Bug report: <https://bugs.launchpad.net/bugs/1770535>
CVE reference: [CVE-2018-11196](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11196)

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_ba8681f5_20250126_021916.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1770535/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Able to upload a virus file to Files section

Bug #1770535 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2018-05-11

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.10.0](https://launchpad.net/mahara/%2Bmilestone/18.10.0) |
|  | [17.04](https://bugs.launchpad.net/mahara/17.04) | Fix Released | High | Unassigned | [Mahara 17.04.8](https://launchpad.net/mahara/%2Bmilestone/17.04.8) |
|  | [17.10](https://bugs.launchpad.net/mahara/17.10) | Fix Released | High | Unassigned | [Mahara 17.10.5](https://launchpad.net/mahara/%2Bmilestone/17.10.5) |
|  | [18.04](https://bugs.launchpad.net/mahara/18.04) | Fix Released | High | Unassigned | [Mahara 18.04.1](https://launchpad.net/mahara/%2Bmilestone/18.04.1) |
|  | [18.10](https://bugs.launchpad.net/mahara/18.10) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.10.0](https://launchpad.net/mahara/%2Bmilestone/18.10.0) |

### Bug Description

If I try to upload the benign test virus file called "eicar.com" from <https://www.ikarussecurity.com/support/virus-info/test-viruses/> Mahara spots it and alerts user it is a virus

However, if I try to upload the eicar\_com.zip file it lets me (which is bad) but understandable as the signature of the virus file can be hidden via compression. And a user could only be infected if they download the zip and extract it locally.

But if I then press the 'Decompress' button it extracts the zip file and doesn't complain. This is bad as all one needs to do to upload a virus is to wrap it in a zip file and then extract it and now they can trick another user to click on the file directly.

When importing a zip file via Importer and clamav is on it checks the files of the zip for viruses but when extracting a zip file in Files section it does not.

We need to tidy this up so that uploading a zip file gets checked properly as well.

## CVE References

* [2018-11196](/bugs/cve/2018-11196 "Mahara 17.04 before 17.04.8 and 17.10...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2018-05-11: |  |  | [#1](/mahara/%2Bbug/1770535/comments/1) |
| --- | --- | --- | --- |

Note to self:

Files that are in play

htdocs/lib/uploadmanager.php - holds function that does scan

htdocs/import/file/lib.php - looks to do clamav correctly

htdocs/artefact/file/extract.php- looks to not do clamav check

Note to self:
Files that are in play
htdocs/lib/uploadmanager.php - holds function that does scan
htdocs/import/file/lib.php - looks to do clamav correctly
htdocs/artefact/file/extract.php- looks to not do clamav check

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2018-05-12: |  |  | [#2](/mahara/%2Bbug/1770535/comments/2) |
| --- | --- | --- | --- |

I've begun a bug at: <https://reviews.mahara.org/#/c/8856/>

Currently only looks at double checking a zip file for virus files if a user click the 'Decompress' button in Content -> Files section.

If a virus is found it moves the file to quarantine and deletes the file info from Mahara.

I've begun a bug at: https://reviews.mahara.org/#/c/8856/
Currently only looks at double checking a zip file for virus files if a user click the 'Decompress' button in Content -> Files section.
If a virus is found it moves the file to quarantine and deletes the file info from Mahara.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2018-05-16: |  |  | [#3](/mahara/%2Bbug/1770535/comments/3) |
| --- | --- | --- | --- |

For the security announcement:

Virus scanner does not check Leap2A zip files

Vulnerability type: Upload of a virus-infected file

Description:

Mahara 17.04 before 17.04.8 and 17.10 before 17.10.5 and 18.04 before 18.04.1 can be used as medium to transmit viruses by placing infected files into a Leap2A archive and uploading that to Mahara. In contrast to other ZIP files that are uploaded, ClamAV (when activated) does not check Leap2A archives for viruses, allowing malicious files to be available for download. While files cannot be executed on Mahara itself, Mahara can be used to transfer such files to user computers.

Bug report: <https://bugs.launchpad.net/bugs/1770535>

CVE reference: CVE-2018-11196 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11196>

For the security announcement:
Virus scanner does not check Leap2A zip files
Vulnerability type: Upload of a virus-infected file
Description:
Mahara 17.04 before 17.04.8 and 17.10 before 17.10.5 and 18.04 before 18.04.1 can be used as medium to transmit viruses by placing infected files into a Leap2A archive and uploading that to Mahara. In contrast to other ZIP files that are uploaded, ClamAV (when activated) does not check Leap2A archives for viruses, allowing malicious files to be available for download. While files cannot be executed on Mahara itself, Mahara can be used to transfer such files to user computers.
Bug report: https://bugs.launchpad.net/bugs/1770535
CVE reference: CVE-2018-11196 https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11196

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2018-05-17: |  |  | [#4](/mahara/%2Bbug/1770535/comments/4) |
| --- | --- | --- | --- |

Discoverer credit: Swe Zin Lynn, The Australian National University

Discoverer credit: Swe Zin Lynn, The Australian National University

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2018-05-17: |  |  | [#5](/mahara/%2Bbug/1770535/comments/5) |
| --- | --- | --- | --- |

Another scenario: If an infected file is exported as "File" format from Moodle to Mahara, it is successfully exported without any error/warning.

Another scenario: If an infected file is exported as "File" format from Moodle to Mahara, it is successfully exported without any error/warning.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ghada El-Zoghbi (ghada-z)](https://launchpad.net/~ghada-z) wrote on 2018-05-21: |  |  | [#6](/mahara/%2Bbug/1770535/comments/6) |
| --- | --- | --- | --- |

Just tried the last scenario reported (without the patch):

Scenario: If an infected file is exported as "File" format from Moodle to Mahara, it is successfully exported without any error/warning.

I can confirm that Mahara catches the virus when it's exported as 'File' (archive or plain file).

Just tried the last scenario reported (without the patch):
Scenario: If an infected file is exported as "File" format from Moodle to Mahara, it is successfully exported without any error/warning.
I can confirm that Mahara catches the virus when it's exported as 'File' (archive or plain file).

[Cecilia Vela Gurovic (ceciliavg)](https://launchpad.net/~ceciliavg)
on 2018-05-30

| **information type**: | Private Security → Public Security |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1770535/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1770535/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1770535/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1770535/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


