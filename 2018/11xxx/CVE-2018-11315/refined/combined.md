=== Content from github.com_62af9b40_20250125_065931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrannondorsey%2Fradio-thermostat)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrannondorsey%2Fradio-thermostat)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=brannondorsey%2Fradio-thermostat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[brannondorsey](/brannondorsey)
/
**[radio-thermostat](/brannondorsey/radio-thermostat)**
Public

* [Notifications](/login?return_to=%2Fbrannondorsey%2Fradio-thermostat) You must be signed in to change notification settings
* [Fork
  12](/login?return_to=%2Fbrannondorsey%2Fradio-thermostat)
* [Star
   35](/login?return_to=%2Fbrannondorsey%2Fradio-thermostat)

Radio Thermostat CT50 & CT80 REST API notes

[35
stars](/brannondorsey/radio-thermostat/stargazers) [12
forks](/brannondorsey/radio-thermostat/forks) [Branches](/brannondorsey/radio-thermostat/branches) [Tags](/brannondorsey/radio-thermostat/tags) [Activity](/brannondorsey/radio-thermostat/activity)
 [Star](/login?return_to=%2Fbrannondorsey%2Fradio-thermostat)

 [Notifications](/login?return_to=%2Fbrannondorsey%2Fradio-thermostat) You must be signed in to change notification settings

* [Code](/brannondorsey/radio-thermostat)
* [Issues
  0](/brannondorsey/radio-thermostat/issues)
* [Pull requests
  0](/brannondorsey/radio-thermostat/pulls)
* [Actions](/brannondorsey/radio-thermostat/actions)
* [Projects
  0](/brannondorsey/radio-thermostat/projects)
* [Security](/brannondorsey/radio-thermostat/security)
* [Insights](/brannondorsey/radio-thermostat/pulse)

Additional navigation options

* [Code](/brannondorsey/radio-thermostat)
* [Issues](/brannondorsey/radio-thermostat/issues)
* [Pull requests](/brannondorsey/radio-thermostat/pulls)
* [Actions](/brannondorsey/radio-thermostat/actions)
* [Projects](/brannondorsey/radio-thermostat/projects)
* [Security](/brannondorsey/radio-thermostat/security)
* [Insights](/brannondorsey/radio-thermostat/pulse)

# brannondorsey/radio-thermostat

   Â master[Branches](/brannondorsey/radio-thermostat/branches)[Tags](/brannondorsey/radio-thermostat/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[3 Commits](/brannondorsey/radio-thermostat/commits/master/) | | |
| [.images](/brannondorsey/radio-thermostat/tree/master/.images ".images") | | [.images](/brannondorsey/radio-thermostat/tree/master/.images ".images") |  |  |
| [README.md](/brannondorsey/radio-thermostat/blob/master/README.md "README.md") | | [README.md](/brannondorsey/radio-thermostat/blob/master/README.md "README.md") |  |  |
| [RTCOAWiFIAPIV1\_3.pdf](/brannondorsey/radio-thermostat/blob/master/RTCOAWiFIAPIV1_3.pdf "RTCOAWiFIAPIV1_3.pdf") | | [RTCOAWiFIAPIV1\_3.pdf](/brannondorsey/radio-thermostat/blob/master/RTCOAWiFIAPIV1_3.pdf "RTCOAWiFIAPIV1_3.pdf") |  |  |
| View all files | | |

## Repository files navigation

* README
# Radio Thermostat REST API

[![Radio thermostat image](/brannondorsey/radio-thermostat/raw/master/.images/amazon.png)](/brannondorsey/radio-thermostat/blob/master/.images/amazon.png)

The Radio Thermostat CT50 & CT80 (perhaps other models too) support a documented REST API to control heating/cooling in your house from your LAN. This is particularly interesting because there doesn't seem to be any authentication to access this API, leaving anyone on the network to have full control of the device. Daniel Crowly of Trustwave SpiderLabs [reported this vulnerability](https://web.archive.org/web/20180401193243/https%3A//www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2013-022/?fid=3870) back in 2013, but the company doesn't seem to give a sh!t.

> CVE: CVE-2013-4860
> CWE: CWE-287 Improper Authentication

> When on the same network as a Radio Thermostat unit, no authentication is
> required to use any part of the API. Users on the same subnet as the unit
> can query and change various settings such as the operation mode, wifi
> connection settings, and temperature thresholds.

Worse yet, there is no [Host or Referer [sic] header validation](https://github.com/brannondorsey/host-validation), which can expose the device to the WAN via a [DNS Rebinding attack](https://en.wikipedia.org/wiki/DNS_rebinding) (using [`whonow`](https://github.com/brannondorsey/whonow) or another malicious DNS server). I've done this successfully myself by sending someone on another network a link that, once followed, will set the target temperature in their house to 95 degrees.

Here I've provided a few notes on how the API works. If you have one of these devices you can control it via CURL using the code below. Any HTTP client should work too, as I've controlled the device via JavaScript's `fetch` API in the browser too. This isn't an exhaustive list of API endpoints and functionality, but its a quick overview of some of the most interesting stuff. For more info, see the official API documentation PDF below.

[Official Radio Thermostsat API Documentation PDF](/brannondorsey/radio-thermostat/blob/master/RTCOAWiFiAPIV1_3.pdf)

If you do have one of these suckers, you should play with it, but then I'd recommend disabling WiFi or disconnecting it from your home network as it is trivial for attackers to control the temperature in your house so long as you are browsing the web on the same network.

There is also a [Python API](https://github.com/mhrivnak/radiotherm) for communicating with the device, however I have not used it myself. I've confirmed that this API works with a CT50 I purchased on Amazon in March 2018 (version V1.94, firmware v1.04.84, and API version 113).

```
#!/bin/bash

THERMOSTAT="192.168.1.100"

# general stats
curl "${THERMOSTAT}/tstat" -X GET

# get the thermosat model
curl "${THERMOSTAT}/tstat/model" -X GET

# version
curl "${THERMOSTAT}/tstat/version" -X GET

# current temperature
curl "${THERMOSTAT}/tstat/temp" -X GET

# thermostat operating mode
# tmode: 0 = OFF, 1 = HEAT, 2 = COOL, 3 = AUTO
curl "${THERMOSTAT}/tstat/tmode" -X GET
curl "${THERMOSTAT}/tstat" -d '{"tmode": 0}' -X POST # OFF
curl "${THERMOSTAT}/tstat" -d '{"tmode": 1}' -X POST # HEAT
curl "${THERMOSTAT}/tstat" -d '{"tmode": 2}' -X POST # COOL
curl "${THERMOSTAT}/tstat" -d '{"tmode": 3}' -X POST # AUTO

# fan mode
# fmode: 0 = AUTO, 1 = AUTO/CIRCULATE, 2 = ON
curl "${THERMOSTAT}/tstat/fmode" -X GET
curl "${THERMOSTAT}/tsta" -d '{"fmode": 0}' -X POST # AUTO
curl "${THERMOSTAT}/tsta" -d '{"fmode": 1}' -X POST # AUTO/CIRCULATE
curl "${THERMOSTAT}/tsta" -d '{"fmode": 2}' -X POST # ON

# check if the target temperature has a temporary override
# override: 0 = DISABLED, 1 = ENABLED
curl "${THERMOSTAT}/tstat/override" -X GET

# target temperature hold status
# hold: 0 = DISABLED, 1 = ENABLED
curl "${THERMOSTAT}/tstat/hold" -X GET
curl "${THERMOSTAT}/tstat" -d '{"hold": 1}' -X POST

# set absolute heat (have to set mode and heat)
curl "${THERMOSTAT}/tstat" -d '{"tmode": 1, "a_heat": 95}' -X POST

# set absolute cool (have to set mode and cool)
curl "${THERMOSTAT}/tstat" -d '{"tmode": 2, "a_cool": 35}' -X POST

# set the temporary target heat AND mode (heat mode)
# t_heat: accepts values between 35-95
curl "${THERMOSTAT}/tstat" -d '{"t_heat": 95}' -X POST

# set the temporary target heat AND mode (cool mode)
# t_heat: accepts values between 35-95
curl "${THERMOSTAT}/tstat" -d '{"t_cool": 35}' -X POST

# LED
curl "${THERMOSTAT}/tstat/led" -d '{"energy_led": 0}' -X POST # OFF
curl "${THERMOSTAT}/tstat/led" -d '{"energy_led": 1}' -X POST # GREEN
curl "${THERMOSTAT}/tstat/led" -d '{"energy_led": 2}' -X POST # YELLO
curl "${THERMOSTAT}/tstat/led" -d '{"energy_led": 4}' -X POST # RED

# Messaging/Text
# user messaging area (only available on CT80)
# uma: line = 0, 1 message = string
curl "${THERMOSTAT}/tstat/uma" -d '{"line": 0, "message": "pwnd by braxxox"}' -X POST
# price messaging area, can only write numbers (like, BOOBS)
# uma: line = 0, 1, 2, 3 (corresponding to energy unit kW, etc) message = numbers
curl "${THERMOSTAT}/tstat/pma" -d '{"line": 1, "message": "80085"}' -X POST

# Night Light
curl "${THERMOSTAT}/tstat/night_light" -X GET

# CT80 only I believe
curl "${THERMOSTAT}/tstat/night_light" -d '{"intensity": 0}' -X POST # OFF
curl "${THERMOSTAT}/tstat/night_light" -d '{"intensity": 1}' -X POST # 25%
curl "${THERMOSTAT}/tstat/night_light" -d '{"intensity": 2}' -X POST # 50%
curl "${THERMOSTAT}/tstat/night_light" -d '{"intensity": 3}' -X POST # 75%
curl "${THERMOSTAT}/tstat/night_light" -d '{"intensity": 4}' -X POST # 100%

# it looks like this might provide an auth key!
curl "${THERMOSTAT}/cloud" -X GET

# get system information
curl "${THERMOSTAT}/sys" -X GET

# get the system name
curl "${THERMOSTAT}/sys/name" -X GET
curl "${THERMOSTAT}/sys/name" -d '{"name": "hack the planet!"}' -X POST

# get WiFi network information
curl "${THERMOSTAT}/sys/network" -X GET

# get supported modes and API endpoints on the system
# httpd_handlers is contains key value pairs like "path" : [SUPPORTS_GET, SUPPORTS_POST]
# "httpd_handlers":{
#     "/tstat":[1,1],
#     â€œ/cloudâ€: [1,1],
#     "/sys/network":[1,1],
#     â€œ/sys/updater":[0,1],
#     "/sys/filesystem":[0,1],
#     "/sys/firmware":[0,1],
#     "/sys/fs-image":[0,1],
#     "/sys/fw-image":[0,1],
#     "/sys/command":[0,1],
#     "/sys/services":[1,0],
#     "/sys/mode":[1,1],
#     "/sys/name":[1,1],
#     â€œ/sys/rebootâ€:[1,1],
# }
curl "${THERMOSTAT}/sys/system" -X GET

# get live diagnostic stats
curl "${THERMOSTAT}/sys/diag/stats/live" -X GET

# get live diagnostic history
curl "${THERMOSTAT}/sys/diag/stats/history" -X GET

# reboot the device
curl "${THERMOSTAT}/sys/command" -d '{"command": "reboot"}' -X POST
```

## About

Radio Thermostat CT50 & CT80 REST API notes

### Resources

[Readme](#readme-ov-file)

[Activity](/brannondorsey/radio-thermostat/activity)
### Stars

[**35**
stars](/brannondorsey/radio-thermostat/stargazers)
### Watchers

[**6**
watching](/brannondorsey/radio-thermostat/watchers)
### Forks

[**12**
forks](/brannondorsey/radio-thermostat/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fbrannondorsey%2Fradio-thermostat&report=brannondorsey+%28user%29)

## [Releases](/brannondorsey/radio-thermostat/releases)

No releases published

## [Packages 0](/users/brannondorsey/packages?repo_name=radio-thermostat)

No packages published

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.wired.com_d0690ada_20250125_065933.html ===
[Skip to main content](#main-content)Open Navigation MenuMenu[![WIRED](/verso/static/wired-us/assets/logo-header.svg)](/)Millions of Streaming Devices Are Vulnerable to a Retro Web Attack

* [Security](/category/security/)
* [Politics](https://www.wired.com/category/politics/)
* [Gear](/category/gear/)
* [The Big Story](/category/big-story/)
* [Business](/category/business/)
* [Science](/category/science/)
* [Culture](/category/culture/)
* [Ideas](/category/ideas/)
* [Merch](https://shop.wired.com/)
More*Chevron*[SearchSearch](/search/)

* [Security](/category/security/)
* [Politics](https://www.wired.com/category/politics/)
* [Gear](/category/gear/)
* [The Big Story](/category/big-story/)
* [Business](/category/business/)
* [Science](/category/science/)
* [Culture](/category/culture/)
* [Ideas](/category/ideas/)
* [Merch](https://shop.wired.com/)

* [Podcasts](/podcasts/)
* [Video](/video/)
* [Newsletters](https://www.wired.com/newsletter?sourceCode=navbar)
* [Magazine](https://www.wired.com/magazine)
* [Travel](http://wired.com/travel)
* [Steven Levy's Plaintext Column](https://www.wired.com/tag/plaintext/)
* [WIRED Classics from the Archive](https://www.wired.com/tag/wired-classic/)
* [Events](https://www.wired.com/tag/wired-events/)
* [WIRED Insider](/category/wiredinsider/)
* [WIRED Consulting](/tag/wired-consulting/%20)
* [Coupons](https://www.wired.com/coupons)
[Lily Hay Newman](/author/lily-hay-newman/)[Security](/category/security)Jun 19, 2018 4:51 PM
# Millions of Streaming Devices Are Vulnerable to a Retro Web Attack

Using a technique called DNS rebinding, one amateur hacker found vulnerabilities in devices from Google, Roku, Sonos, and more.![Image may contain Utility Pole and Plot](https://media.wired.com/photos/5b295efcc9906c0948a27130/master/w_2560%2Cc_limit/dns_rebinding-FINAL.jpg)HOTLITTLEPOTATOSave this storySaveSave this storySave

In March, artist and programmer Brannon Dorsey became interested in a retro web attack called DNS rebinding, teaching himself how to illicitly access controls and data by exploiting known browser weaknesses. It's a vulnerability that researchers have poked at on and off for yearsâ€”which is one reason Dorsey couldn't believe what he found.

Sitting in his Chicago apartment, two blocks from Lake Michigan, Dorsey did what anyone with a newfound hacking skill would: He tried to attack devices he owned. Instead of being blocked at every turn, though, Dorsey quickly discovered that the media streaming and smart home gadgets he used every day were vulnerable to varying degrees to DNS rebinding attacks. He could gather all sorts of data from them that he never would have expected.

"I'm technical, but I'm not an information security professional," Dorsey says. "I didnâ€™t reverse any binaries or do any intense digging. I just followed my curiosities and suddenly I found some sketchy shit. I was just sitting there thinking 'I cannot be the only person in the world who is seeing this.'"

Between his own gadgets and borrowing others from friends, Dorsey found DNS rebinding vulnerabilities in virtually every model of Google Home, Chromecast, Sonos Wi-Fi speakers, Roku streaming devices, and some smart thermostats. Dorsey's experimental attacks, which he outlined in [research published Tuesday](https://medium.com/%40brannondorsey/ea7098a2d325), didn't give him full keys to the kingdom, but in each case he could gain more control and extract more data than he should have been able to.

> 'I just followed my curiosities and suddenly I found some sketchy shit.'

Brannon Dorsey

For example, on Roku devices running Roku OS 8.0 or lower, Dorsey found that an attacker could use the streamer's External Control API to control buttons and key presses on the device, access the inputs for device sensors like the accelerometer, gyroscope, and magnetometer, search content on the device, and even launch apps. On Sonos Wi-Fi speakers, an attacker could access extensive information about the Wi-Fi network a speaker is connected to, useful for mapping out network attributes and broader recon. And by attacking the public API in Google's connected devices, an hacker could trigger Google Home and Chromecast restarts at will. That result in essentially a denial of service attack, keeping users from being able to interact with their device, or sending it offline at strategic times. Attackers could also get Google Home and Chromecast to cough up information about the Wi-Fi network they are connected to, and triangulate it with the list of nearby Wi-Fi networks to accurately geolocate the devices.

In a DNS rebinding attack, a hacker capitalizes on weaknesses in how browsers implement web protocols. They craft malicious websites that can game the trust protections meant to block unauthorized communication between web services. From there, an attacker uses methods like phishing or malvertising to trick victims into clicking a link to their site, and then moves to illicitly access whatever controls and data are exposed on their device or network. One wrong click or tap and and attacker could take over your smart device.

Though DNS rebinding stems from some fundamental issues with how browsers mediate trust relationships online, sites and services can also limit their exposures using relatively simple mechanisms like authentication protections or HTTPS encrypted connections. This may be why this class of attacks hasn't generated sustained interest or concern among security professionals.

Most Popular

* [![Trump Wants a War With Cartels&-and May Just Get One](https://media.wired.com/photos/679171eb8f0de7e17273dc6a/1:1/w_350%2Ch_350%2Cc_limit/undefined)](https://www.wired.com/story/trump-executive-order-mexico-drug-cartels-terrorist-organizations/#intcid=_wired-right-rail_7ce3a871-3de8-48cd-a990-aebd4fe9cdbf_popular4-1-reranked-by-vidi_fallback_cral-top2-2)Policy[Trump Wants a War With Cartelsâ€”and May Just Get One](https://www.wired.com/story/trump-executive-order-mexico-drug-cartels-terrorist-organizations/#intcid=_wired-right-rail_7ce3a871-3de8-48cd-a990-aebd4fe9cdbf_popular4-1-reranked-by-vidi_fallback_cral-top2-2)By Anna Lagos

But over past seven months, there has been a growing understanding in the security community that DNS rebinding bugs may represent a much larger group of vulnerabilities than people have previously acknowledged. Google Project Zero researcher Tavis Ormandy recently found DNS rebinding vulnerabilities in the [Transmission BitTorrent client](https://bugs.chromium.org/p/project-zero/issues/detail?id=1447) and the update mechanism for [Blizzard video games](https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&desc=2), and researchers have also discovered the bugs in various Ethereum walletsâ€”potentially exposing people's cryptocurrency.

DNS rebinding bugs have a "history of being dismissed by developers, and many times it is left as an unaddressed issue," Ariel Zelivansky, a researcher at the security firm Twistlock, [wrote in a prescient February warning](https://www.twistlock.com/2018/02/28/dear-developers-beware-dns-rebinding/) about the rise of DNS rebinding vulnerabilities.

In the months that Dorsey was looking into the topic, another researcher from the security firm Tripwire, Craig Young, also discovered the bug in Google Home and Chromecast, and [published](https://www.tripwire.com/state-of-security/vert/googles-newest-feature-find-my-home/#.WyfDEMLoy-g.twitter) his [findings](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/) on Monday.

> 'This reflects an issue in a fundamental feature of the internet as itâ€™s been designed.'

Joseph Pantoga, Red Balloon

One root cause of these vulnerabilities is that devices on the same Wi-Fi network generally trust each other, since they've all been admitted to the same club. But this assumption can lead to accidental exposures. Communication channels meant for use by other devices on a network can potentially also be maliciously accessed by remote websites with just a small amount of manipulation. Many of the bugs Dorsey found could be solved by adding basic authentication mechanisms to device APIs.

"This reflects an issue in a fundamental feature of the internet as itâ€™s been designed," says Joseph Pantoga, a research scientist at the internet of things security firm Red Balloon. "DNS rebinding attacks have been brought up many times in the past, but new features in Internet of Things devices including geolocation and collection of personal data make it something people should really be aware of. The problem is exacerbated by IoT devices having APIs intended for communication with other, unauthenticated devices on the network."

Google, Roku, and Sonos have all patched or are in the process of patching their device operating systems to plug the vulnerabilities Dorsey described. â€œAfter recently becoming aware of the DNS Rebinding issue, we created a software patch which is now rolling out to customers," a Roku spokesperson told WIRED. Sonos similarly added that, "Upon learning about the DNS Rebinding Attack, we immediately began work on a fix that will roll out in a July software update.â€ Google said in a statement that, "We're aware of the report and will be rolling out a fix in the coming weeks."

Despite the positive response, experts note that lack of awareness about avoiding these bugs in the first place has led to a situation in which millions and millions of devices are known to be vulnerable to some degree, with millions more likely vulnerable as well. Dorsey says that he hopes his research raises awareness about the ubiquity of the problem. "DNS rebinding has become the elephant in the room," he says. "A ton of things are vulnerable to it and it's become a systemic problem. So ultimately approaching vendors one at a time isn't going to solve it. The whole industry needs to know to check for this and fix it."

---

More Great WIRED Stories

* The hustlers fueling cryptocurrencyâ€™s [marketing machine](https://www.wired.com/story/the-hustlers-fueling-cryptocurrencys-marketing-machine/?mbid=BottomRelatedStories_Sections_2)
* This elite Microsoft hacker team [keeps Windows PCs safe](https://www.wired.com/story/microsoft-windows-red-team/?mbid=BottomRelatedStories_Sections_2)
* The brilliant vigilance of Seattle's [gargantuan new tunnel](https://www.wired.com/story/seattle-sr-99-tunnel-tech-bertha/?mbid=BottomRelatedStories_Sections_2)
* A new [era of Frankensoftware](https://www.wired.com/story/frankensoftware/?mbid=BottomRelatedStories_Sections_2) is upon us
* PHOTO ESSAY: Inside the Arctic Circle, golden hour has nothing on [golden day](https://www.wired.com/story/golden-hour-arctic-photography/?mbid=BottomRelatedStories_Sections_2)
* Get even more of our inside scoops with our weekly [Backchannel newsletter](https://www.wired.com/newsletter/?name=backchannel&sourcecode=BottomStories)
[![](https://media.wired.com/photos/65e835799fa4c1a0001881a9/1:1/w_270%2Cc_limit/undefined)](/author/lily-hay-newman/)[Lily Hay Newman](/author/lily-hay-newman/) is a senior writer at WIRED focused on information security, digital privacy, and hacking. She previously worked as a technology reporter at Slate, and was the staff writer for Future Tense, a publication and partnership between Slate, the New America Foundation, and Arizona State University. Her work... [Read more](/author/lily-hay-newman/)Senior Writer

* [X](https://www.twitter.com/lilyhnewman)
Topics[hacks](/tag/hacks/)[DNS](/tag/dns/)[IoT](/tag/iot/)[Google](/tag/google/)[Sonos](/tag/sonos/)[roku](/tag/roku/)Read More[![Our Favorite Linen Sheets to Upgrade Your Sleep](https://media.wired.com/photos/673c584369b6fb64e8978199/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-linen-sheets/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[Our Favorite Linen Sheets to Upgrade Your Sleep](https://www.wired.com/gallery/best-linen-sheets/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)Linen might not be your first choice for bedsheets, but itâ€™s got enough benefits that itâ€™s worth a try. Hereâ€™s the linen we love sleeping on. Nena Farrell [![The Best Kindles to Take Your Library Anywhere](https://media.wired.com/photos/678acf053db157eb73d27d97/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-kindle/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Kindles to Take Your Library Anywhere](https://www.wired.com/gallery/best-kindle/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)Hereâ€™s how Amazonâ€™s ebook readers stack upâ€”and which one might be right for you.Brenda Stolyar[![The Best Mobile Controllers for Gaming on the Go](https://media.wired.com/photos/67802fe403f6b57dd22028a9/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-mobile-game-controllers-for-iphone-android/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Mobile Controllers for Gaming on the Go](https://www.wired.com/gallery/best-mobile-game-controllers-for-iphone-android/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)Touchscreens donâ€™t always get the job done. Try one of these WIRED-tested controllers for your iPhone or Android instead.Simon Hill[![The Best Noise-Canceling Headphones to Escape Reality](https://media.wired.com/photos/66d6147731e907649f495666/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-noise-canceling-headphones/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Noise-Canceling Headphones to Escape Reality](https://www.wired.com/gallery/best-noise-canceling-headphones/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)Tune out (or rock out) with our favorite over-ears and earbuds.Parker Hall[![The 6 Best Sunrise Alarms to Help You Rise and Shine](https://media.wired.com/photos/66e8a93f60b097c88e51a0f5/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-sunrise-alarm-clocks/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The 6 Best Sunrise Alarms to Help You Rise and Shine](https://www.wired.com/gallery/best-sunrise-alarm-clocks/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)If you want to wake up with the sun but aren't a morning person, these bedside devices can simulate a sunrise whenever you want to rouse for the day (and a sunset, too). Nena Farrell [![The Best 7 Space Heaters of 2025](https://media.wired.com/photos/677ab07444bfffc9819f9710/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/the-best-space-heaters/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best 7 Space Heaters of 2025](https://www.wired.com/gallery/the-best-space-heaters/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)These portable heaters will heat a room quickly, quietly, and safely.Matthew Korfhage[![The Best Air Quality Monitors Weâ€™ve Tried](https://media.wired.com/photos/6781425bced74e457dc3a713/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-indoor-air-quality-monitors/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Air Quality Monitors Weâ€™ve Tried](https://www.wired.com/gallery/best-indoor-air-quality-monitors/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)These WIRED-tested indoor air-quality monitors have been teaching us things about our air quality we can never unsee.Lisa Wood Shapiro[![The Best Dry Shampoos to Extend Your Style](https://media.wired.com/photos/67897ce6b50cbf8e216d4b17/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/the-best-dry-shampoos/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Dry Shampoos to Extend Your Style](https://www.wired.com/gallery/the-best-dry-shampoos/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)I spent months testing 25-plus dry shampoos on day-two hair and beyondâ€”these are the most effective formulas you can buy.Kat Merck[![The Best USB Flash Drives for Ultra-Portable Storage](https://media.wired.com/photos/676c618ff68c6835a33c7b54/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-usb-flash-drives/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best USB Flash Drives for Ultra-Portable Storage](https://www.wired.com/gallery/best-usb-flash-drives/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)These WIRED-tested memory sticks are a virtual filing cabinet in your pocket.Simon Hill[![10 More of the Coolest Things Weâ€™ve Seen at CES 2025](https://media.wired.com/photos/677c4c835c3b6bd576bf387a/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/ces-2025-photo-gallery-day-2/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[10 More of the Coolest Things Weâ€™ve Seen at CES 2025](https://www.wired.com/gallery/ces-2025-photo-gallery-day-2/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)More of the wild ideas and clever innovations weâ€™re seeing this week at techâ€™s big show in Las Vegas.Gear Team[![The Best Electric Kick Scooters](https://media.wired.com/photos/677075ade58d29773908c64f/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-electric-scooters/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Electric Kick Scooters](https://www.wired.com/gallery/best-electric-scooters/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)These WIRED-tested two-wheelers will help you scoot scoot scoot around town.Julian Chokkattu[![The Best Massagers for People Who Donâ€™t Have Time to Relax](https://media.wired.com/photos/6785cc89d53d1a327709e762/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-massagers/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)[The Best Massagers for People Who Donâ€™t Have Time to Relax](https://www.wired.com/gallery/best-massagers/#intcid=_wired-article-bottom-recirc_8f0ddcf4-dbe8-430c-92f1-23877c6cb6c0_roberta-similarity1_fallback_popular4-1)Donâ€™t cancel therapy just yet, but these portable, at-home massagers might be the hack you need after stressful days.Boutayna Chokrane [![WIRED](/verso/static/wired-us/assets/logo-reverse.svg)](/)WIRED is where tomorrow is realized. It is the essential source of information and ideas that make sense of a world in constant transformation. The WIRED conversation illuminates how technology is changing every aspect of our livesâ€”from culture to business, science to design. The breakthroughs and innovations that we uncover lead to new ways of thinking, new connections, and new industries.

More From WIRED

* [Subscribe](https://www.wired.com/subscribe/)
* [Newsletters](https://www.wired.com/newsletter?sourceCode=HeaderAndFooter)
* [FAQ](https://www.wired.com/about/faq/)
* [WIRED Staff](https://www.wired.com/about/wired-staff/)
* [WIRED Education](https://www.wirededucation.com/)
* [Editorial Standards](https://www.wired.com/about/wired-on-background-policy/)
* [Archive](https://archive.wired.com/t/storefront/storefront)
* [RSS](https://www.wired.com/about/rss-feeds/)
* [Accessibility Help](https://www.wired.com/about/accessibility-help/)

Reviews and Guides

* [Reviews](https://www.wired.com/category/gear/reviews/)
* [Buying Guides](https://www.wired.com/category/gear/buying-guides/)
* [Mattresses](https://www.wired.com/gallery/best-mattresses/)
* [Electric Bikes](https://www.wired.com/gallery/best-electric-bikes/)
* [Soundbars](https://www.wired.com/gallery/best-soundbars/)
* [Streaming Guides](https://www.wired.com/tag/culture-guides/)
* [Wearables](https://www.wired.com/tag/wearables/)
* [TVs](https://www.wired.com/gallery/best-tvs/)
* [Coupons](https://www.wired.com/tag/coupons/)
* [Code Guarantee](https://www.wired.com/coupons/info/code-guarantee.html)
* [Gift Guides](/tag/gift-guides/)

* [Advertise](https://www.condenast.com/brands/wired)
* [Contact Us](https://www.wired.com/about/feedback/)
* [Manage Account](https://www.wired.com/account/profile)
* [Jobs](https://www.wired.com/about/wired-jobs/)
* [Press Center](https://www.wired.com/about/press/)
* [CondÃ© Nast Store](https://www.condenaststore.com/)
* [User Agreement](https://www.condenast.com/user-agreement/)
* [Privacy Policy](http://www.condenast.com/privacy-policy#privacypolicy)
* [Your California Privacy Rights](http://www.condenast.com/privacy-policy#privacypolicy-california)

Â© 2025 CondÃ© Nast. All rights reserved. *WIRED* may earn a portion of sales from products that are purchased through our site as part of our Affiliate Partnerships with retailers. The material on this site may not be reproduced, distributed, transmitted, cached or otherwise used, except with the prior written permission of CondÃ© Nast. [Ad Choices](http://www.aboutads.info)

###### Select international site

United StatesLargeChevron

* [Italia](https://www.wired.it/)
* [JapÃ³n](https://wired.jp/)
* [Czech Republic & Slovakia](https://www.wired.cz/)

* [Facebook](https://www.facebook.com/wired/)
* [X](https://twitter.com/wired/)
* [Pinterest](https://pinterest.com/wired/)
* [YouTube](https://www.youtube.com/user/wired/)
* [Instagram](https://instagram.com/wired/)
* [Tiktok](https://www.tiktok.com/%40wired?lang=en)


=== Content from medium.com_2e16682b_20250125_065931.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea7098a2d325&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Attacking Private Networks from the Internet with DNS Rebinding

[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:88:88/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---byline--ea7098a2d325--------------------------------)

[Brannon Dorsey](/%40brannondorsey?source=post_page---byline--ea7098a2d325--------------------------------)

Â·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9242793add7d&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&user=Brannon+Dorsey&userId=9242793add7d&source=post_page-9242793add7d--byline--ea7098a2d325---------------------post_header-----------)

20 min readÂ·Jun 19, 2018

--

17

Listen

Share

> TL;DR Following the wrong link could allow remote attackers to control your WiFi router, Google Home, Roku, Sonos speakers, home thermostats and more.

The home WiFi network is a sacred place; your own local neighborhood of cyberspace. There we connect our phones, laptops, and â€œsmartâ€ devices to each other and to the Internet and in turn we *improve our lives*, or so we are told. By the late twenty teens, our local networks have become populated by a growing number of devices. From smart TVs and media players to home assistants, security cameras, refrigerators, door locks and thermostats, our home networks are a haven for trusted personal and domestic devices.

Many of these devices offer limited or non-existent authentication to access and control their services. They inherently trust other machines on the network in the same way that you would inherently trust someone youâ€™ve allowed into your home. They use protocols like Universal Plug and Play (UPnP) and HTTP to communicate freely between one another but are inherently protected from inbound connections from the Internet by means of their routerâ€™s firewall. They operate in a sort of walled garden, safe from external threat. Or so their developers probably thought.

A few months ago, I began to follow a winding path of research into a 10 year-old network attack called [**DNS rebinding**](https://en.wikipedia.org/wiki/DNS_rebinding). Put simply, DNS rebinding allows a remote attacker to bypass a victimâ€™s network firewall and use their web browser as a proxy to communicate directly with devices on their private home network. By following the wrong link, or being served a malicious banner advertisement, you could inadvertently provide an attacker with access to the thermostat that controls the temperature in your home.

```
NOTE: This research has been simultaneously released with a counterpart [WIRED article](https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/) on the subject by Lily Hay Newman.
```
# What is DNS Rebinding?

To better understand how DNS rebinding works itâ€™s helpful to first understand the security mechanism that it evades; the web browserâ€™s [*same-origin policy*](https://en.wikipedia.org/wiki/Same-origin_policy). Many moons ago, browser vendors decided it probably wouldnâ€™t be a good idea for web pages served from one domain to be able to make arbitrary requests to another domain without explicit permission from that second domain. If you follow a malicious link on the web, the web page you arrive at shouldnâ€™t be able to make an HTTP request to your bank website and leverage your logged in-session there to empty your account. Browsers restrict this behavior by limiting HTTP requests originating from a domain to access only other resources that are also located on that domain (or another domain that explicitly enables [*cross-origin resource sharing*](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)).

> DNS can be abused to trick web browsers into communicating with servers they donâ€™t intend to.

The code at `http://malicious.website` canâ€™t make a standard XMLHttpRequest to `http://bank.com/transfer-fund` because `malicious.website` and `bank.com` are different domains and therefor the browser treats them as **separate origins**. Browsers enforce this by requiring that the protocol, domain name, and port number of a URL being requested is identical to the URL of the page requesting it. Sounds good, right?

Not so fast. Behind every domain name lies an IP address. `malicious.website` may reside at `34.192.228.43` and `bank.com` may call `171.159.228.150` home. The *Domain Name System* (DNS) provides a useful mechanism of translating easy-to-remember domain names into the IP addresses that our computerâ€™s actually use to talk to each other. The catch is that modern browsers use URLs to evaluate same-origin policy restrictions, not IP addresses. What would happen if the IP address of `malicious.website` were to quickly changed from `34.192.228.43` to the IP address of `171.159.228.150`? According to the browser, nothing would have changed. But now, instead of communicating with the server that originally hosted the website files at `malicious.website`, your browser would actually be talking to `bank.com`. See the problem? DNS can be abused to trick web browsers into communicating with servers they donâ€™t intend to.

DNS rebinding has received a few brief moments of attention over the past year when vulnerabilities were found in a few popular pieces of software. Most notably, [Blizzardâ€™s video games](https://www.bleepingcomputer.com/news/security/blizzard-fixes-dns-rebinding-flaw-that-put-all-the-companys-users-at-risk/), the [Transmission torrent client](https://www.exploit-db.com/exploits/43665/), and several [Ethereum cryptocurrency wallets](https://ret2got.wordpress.com/2018/01/19/how-your-ethereum-can-be-stolen-using-dns-rebinding/) were vulnerable to DNS rebinding attacks until recently. In just the wrong circumstance, the Ethereum Geth vulnerability could have given a remote attacker full-control of the victimâ€™s Ethereum account, and with it, all of their coin.

> DNS rebinding allows a remote attacker to bypass a victimâ€™s network firewall and use their web browser as a proxy to communicate directly with devices on their private home network.

# How DNS Rebinding works

1. An attacker controls a malicious DNS server that answers queries for a domain, say `rebind.network`.
2. The attacker tricks a user into loading `http://rebind.network` in their browser. There are many ways they could do this, from phishing to persistent XSS or by [buying an HTML banner ad](/%40brannondorsey/browser-as-botnet-or-the-coming-war-on-your-web-browser-be920c4f718).
3. Once the victim follows the link, their web browser makes a DNS request looking for the IP address of `rebind.network`. When it receives the victimâ€™s DNS request, the attacker controlled DNS server responds with `rebind.network`â€™s real IP address, `34.192.228.43`. It also sets the [TTL value](https://en.wikipedia.org/wiki/Time_to_live) on the response the be 1 second so that the victimâ€™s machine wonâ€™t cache it for long.
4. The victim loads the web page from `http://rebind.network` which contains malicious JavaScript code that begins executing on the victimâ€™s web browser. The page begins repeatedly making some strange looking POST requests to `http://rebind.network/thermostat`with a JSON payload like `{â€œtmodeâ€: 1, â€œa_heatâ€: 95}`.
5. At first, these requests are sent to the attackerâ€™s web server running on `34.192.228.43`, but after a while ([browser DNS caching is weird](https://youtu.be/Q0JG_eKLcws?t=27m50s)) the browserâ€™s resolver observes that the DNS entry for `rebind.network` is stale and so it makes another DNS lookup.
6. The attackerâ€™s malicious DNS server receives the victimâ€™s second DNS request, but this time it responds with the IP address `192.168.1.77`, which happens to be an IP address of a [smart thermostat](https://github.com/brannondorsey/radio-thermostat) on the victimâ€™s local network.
7. The victimâ€™s machine receives this malicious DNS response and begins to point to HTTP requests intended for `http://rebind.network` to `192.168.1.77`. As far as the browser is concerned nothing has changed and so it sends another POST to `http://rebind.network/thermostat`.
8. This time, that POST request gets sent to the small unprotected web server running on the victimâ€™s WiFi-connected thermostat. The thermostat processes the request and the temperature in the victimâ€™s home is set to 95 degrees ðŸ”¥.

This scenario is an actual exploit ([CVE-2018â€“11315](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11315%29)) that Iâ€™ve found and used against my Radio Thermostat CT50 â€œsmartâ€ thermostat. The implications and impact of an attack like this can have far reaching and devastating effects on devices or services running on a private network. By using a victimâ€™s web browser as a sort of HTTP proxy, DNS rebinding attacks can bypass network firewalls and make every device on your protected intranet available to a remote attacker on the Internet.

# Whatâ€™s Vulnerable?

After finding and exploiting this vulnerability in the very first device that I poked around with, I feared that there were likely many other IoT devices that could also be targeted. I began to collect and borrow some of the more popular smart home devices on the market today. Over the next few weeks every device that I got my hands on fell victim to DNS rebinding in one way or another, leading to information being leaked, or in some cases, full device control. Google Home, Chromecast, Roku, Sonos WiFi speakers, and certain smart thermostats could all be interfaced with in some way by an unauthorized remote attacker. Seems like a big problem huh?

> The idea that the local network is a safe haven is a fallacy. If we continue to believe it people are going to get hurt.

Iâ€™ve been in contact with the vendors of these products and all of them are working on or have already released security patches (more on that disclosure in [this essay](/%40brannondorsey/going-public-fast-thoughts-on-disclosure-policy-2d10ebc1f70d)). Those are just the companies whose devices Iâ€™ve personally tested in my spare time. If companies with such high profiles are failing to prevent against DNS rebinding attacks there must be countless other vendors that are as well.

![]()

Proof of concept DNS rebinding attack @ <http://rebind.network>

Iâ€™ve authored a proof-of-concept exploit that you can use to target these devices on your home network today. That demo is live at [http://rebind.network.](http://rebind.network)

## Google Home

![]()

Google Home Mini

The apps used to control Google Home products make use of an undocumented REST API running on port 8008 of these devices (e.g. `http://192.168.1.208:8008`). The first mention of this service that Iâ€™ve been able to find [surfaced back in 2013](http://fiquett.com/2013/07/chromecast-traffic-sniffing/) when Brandon Fiquett wrote about a Local API he found while sniffing the WiFi traffic to his Chromecast. Fast forward five years and it seems that Google has integrated that same mysterious API into all of its Google Home products, and as you can imagine, that undocumented API is fairly well documented by amateurs and hobbyists at this point. In fact, earlier this year Rithvik Vibhu published [detailed API docs](https://rithvikvibhu.github.io/GHLocalApi/) to the public.

This API provides extensive device control without any form of authentication. Some of the most interesting features include the ability to launch entertainment apps and play content, scan and join nearby WiFi networks, reboot, and even factory reset the device.

Imagine a scenario where youâ€™re browsing the web and all of a sudden your Google Home factory resets. What if your roommate left their web browser open on their laptop and an HTML advertisement sends your Chromecast into reboot loops while you are trying to watch a movie? One of my favorite attack scenarios targeting this API is an abuse of the WiFi scanning capability. Attackers could pair this information with [publicly accessible wardriving](https://wigle.net/) data and get accurate geolocation using only your list of nearby WiFi networks. This attack would be successful even if youâ€™ve disabled your web browserâ€™s geolocation API and are using a VPN to tunnel your traffic through another country.

[Here is an example](https://pastebin.com/raw/U3tUqmRf) of some of the data that Iâ€™ve exfiltrated from my own Chromecast. Can you figure out where I might be writing this post from?

```
UPDATE (06/19/2018): [Craig Young's simultaneous and independent research](https://www.tripwire.com/state-of-security/vert/googles-newest-feature-find-my-home/#.WyfDEMLoy-g.twitter) on this vulnerability was disclosed yesterday, just ahead of this post. He actually created a PoC for the geolocation attack scenario that I described above, but never implemented! His work, and [Brian Kreb's commentary on it](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/) are both excellent ðŸ‘ðŸ‘ðŸ‘.I notified Google about this vulnerability when I discovered it in March and again in April after receiving no response. According to Kreb's post, Young reported the bug to Google in May and his ticket was closed with "Status: Wonâ€™t Fix (Intended Behavior)." It wasn't until Krebs himself contacted Google that they agreed to patch the vulnerability. Google is expected to release a patch in mid-July 2018.
```
## Sonos WiFi Speakers

![]()

Sonos Play:1

Like Google Home, Sonos WiFi speakers can also be controlled by a remote attacker (CVE-2018â€“11316). By following the wrong link you could find your pleasant evening jazz play list [interrupted by content of a very different sort](https://www.youtube.com/watch?v=dQw4w9WgXcQ). Thatâ€™s fun for simple pranks, but ultimately pretty harmless, right?

After a bit of digging I found a few other interesting links to be followed on the Sonos UPnP web server that might not be so innocent. It appears that several hidden web pages are accessible on the device for debugging purposes. `http://192.168.1.76:1400/support/review` serves an [XML file](https://pastebin.com/raw/nPjhJQmk) that appears to contain the output of several Unix commands run on the Sonos device (which itself seems to run a distribution of Linux).

`http://192.168.1.76:1400/tools` provides a bare bones HTML form that lets you run a few of these Unix commands on the Sonos device yourself! The Sonos HTTP API allows a remote attacker to map internal and external networks using the `traceroute` command and probe hosts with ICMP requests with `ping` using simple POST requests. An attacker could use a Sonos device as a pivot point to gather useful network topology and connectivity information to be used in a follow up attack.

```
UPDATE (06/19/2018): Sonos has published a statement along with this public release; "Upon learning about the DNS Rebinding Attack, we immediately began work on a fix that will roll out in a July software update."
```
## Roku

![]()

RokuTV

While exploring the network in the lounge at my work building, I found an HTTP server running on port `8060` of a RokuTV. I soon found that Rokuâ€™s [External Control API](https://sdkdocs.roku.com/display/sdkdoc/External%2BControl%2BAPI) provides control over basic functionality of the device, like launching apps, searching, and playing content. Interestingly, it also allows direct control over button and key presses like a virtual remote, as well as input for several sensors including an accelerometer, orientation sensor, gyroscope and even a magnetometer (why?) As youâ€™ve probably guessed, this local API requires no authentication and can be exploited via DNS rebinding (CVE-2018â€“11314).

I reported these findings to the Roku security team, who initially responded saying:

> There is no security risk to our customersâ€™ accounts or the Roku platform with the use of this APIâ€¦ We are aware of web apps like <http://remoku.tv> that can be loaded into a browser and used to interact with the Roku on the same local network.

After [describing a detailed attack scenario](https://pastebin.com/raw/53HcBbmR), a security VP at the company clarified that their team does â€œconsider this a valid threat and it is not mundane in the least.â€ To the teamâ€™s credit, they immediately halted the release roll out of Roku OS 8.1 and began to develop a patch, which they expected could take as long as 3â€“4 months if they couldnâ€™t find a solution that worked in time for their upcoming release.

After some consideration, I informed the team that I was working with a reporter at WIRED and that we were likely going to publish the research quickly. The next morning I received an email from the team that a patch had been developed and was already in the process of being pushed to over 20 million devices through a firmware update!

```
UPDATE (06/19/2018): Roku has released a statement along with this public release; â€œAfter recently becoming aware of the DNS Rebinding issue, we created a software patch which is now rolling out to customers. Note that any potential exploitation of this vulnerability poses no security risk to our customersâ€™ accounts, our channel partnersâ€™ content security or the Roku platform.â€
```
## Radio Thermostat

![]()

Radio Thermostat CT50

The Radio Thermostat CT50 & CT80 devices have by far the most consequential IoT device vulnerabilities Iâ€™ve found so far. These devices are some of the cheapest â€œsmartâ€ thermostats available on the market today. I purchased one to play with after being tipped off to their lack of security by [CVE-2013â€“4860](https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2013-022/?fid=3870), which reported that the device had no form of authentication and could be controlled by anyone on the network. Daniel Crowley of Trustwave SpiderLabs had attempted to contact the vendor several times before ultimately publishing the vulnerability after hearing no response from the company. Unfortunately, this lack of response is a recurring theme of vulnerability disclosure over the years, especially with smaller manufacturers. I expected that the chances that the vulnerability had gone unpatched for five years was actually high, so I purchased a brand new CT50.

That assumption turned out to be correct and the thermostatâ€™s control API left the door wide open for DNS rebinding shenanigans. Itâ€™s probably pretty obvious the kind of damage that can be done if your buildingâ€™s thermostat can be controlled by remote attackers. The PoC at <http://rebind.network> exfiltrates some basic information from the thermostat before setting the target temperature to 95Â° F. That temperature can be dangerous, or even deadly in the summer months to an elderly or disabled occupant. Not to mention that if your device is targeted while youâ€™re on vacation you could return home to a whopper of a utility bill.

The severity of this vulnerability, and the continued negligence by the Radio Thermostat Company of America whoâ€™ve had years to fix it, are perfect examples of why we need [security regulation for IoT devices](https://www.warner.senate.gov/public/index.cfm/2017/8/senators-introduce-bipartisan-legislation-to-improve-cybersecurity-of-internet-of-things-iot-devices).

## WiFi Routers

If youâ€™ve been following all of this so far you may have already started to think of other devices on home networks that could be targeted. Would it surprise you to learn that, historically, network routers themselves are some of the most common targets to DNS rebinding attacks? Probably not.

Thatâ€™s because network routers hold the keys to the kingdom. Own the router and you own the network. There are two common attack vectors that Iâ€™ve seen with DNS rebinding:

1. `POST`ing default credentials to a login page like `http://192.168.1.1/login`to own router admin. Once the attacker has authenticated they have full device control and can configure the network as they please.
2. Using a routerâ€™s [*Internet Gateway Device* (IGD) interface](https://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol) through UPnP to configure permanent port forwarding connections and expose arbitrary UDP & TCP ports on the network to the public Internet.

The first is pretty basic. Many routers ship with default login credentials and consumers never change them. Sure, maybe they will enable WPA2 and set a WiFi password, but I bet many of them donâ€™t realize their routerâ€™s configuration panel is still accessible to anyone on the network using â€œadmin:adminâ€.

The second attack is even worse, a downright travesty. Somehow, in this day and age, most brand-spanking-new home routers still ship with UPnP servers enabled by default. These UPnP servers provide admin-like control over router configuration to any unauthenticated machine on the network over HTTP. Any machine on the network, or the public Internet through DNS rebinding, can use IGD/UPnP to configure a routerâ€™s DNS server, add & remove NAT and WAN port mappings, view the # of bytes sent/received on the network, and access the routerâ€™s public IP address (check out [upnp-hacks.org](http://www.upnp-hacks.org/upnp.html) for more info).

A DNS rebinding attack that targets a routerâ€™s UPnP server can punch a hole in the victimâ€™s firewall, leaving a permanent entry point to execute raw TCP & UDP attacks against devices on the network without being bound to the normal HTTP-only limitations of DNS rebinding attacks. They can even configure port forwarding rules that forward traffic to external IP addresses on the Internet, allowing an attacker to add a victimâ€™s router as a node in a large network of infected routers that can be used to mask their traffic from authorities (see Akamaiâ€™s recent [UPnProxy research](https://www.akamai.com/us/en/multimedia/documents/white-paper/upnproxy-blackhat-proxies-via-nat-injections-white-paper.pdf)).

IGD also provides an interface to discover a routerâ€™s public IP address through a simple unauthenticated HTTP request. This functionality, combined with DNS rebinding, can be used to de-anonymize users who are otherwise attempting to mask their public IP address through a VPN or by using TOR.

In my experience router vulnerability to DNS rebinding is a mixed bag. Iâ€™ve seen routers that completely block DNS rebinding attacks, routers that randomize their UPnP server port to make discovery and attack more difficult, and Iâ€™ve seen routers that are completely wide-open to the attack. I should mention though that Iâ€™ve largely stayed away from applying my DNS rebinding research to routers so far... Mostly because Iâ€™m almost too afraid to look ðŸ˜¨.

# The Walled Garden Is a Lie

How is it that so many devices today could be vulnerable to an attack that was introduced [over ten years ago](https://crypto.stanford.edu/dns/)? There are likely more reasons for this than I can explain, but Iâ€™m willing to bet money on two of them.

The first is awareness. Best I can tell, DNS rebinding isnâ€™t as popular of an attack as it should be. Sure, security nerds [*may* have heard of it](https://twitter.com/brannondorsey/status/1003394858931970048) but Iâ€™d wager that very few of them have actually ever tried it. Itâ€™s historically been a sort of cumbersome and difficult to pull off attack in practice. You have to spin up a malicious DNS server in the cloud, write some custom JavaScript payload targeting a specific service, serve that to a victim on a target network, and then figure out how to use their web browser to pivot to a target machine running that service, which you probably donâ€™t know the IP address of. Thereâ€™s overhead and itâ€™s error prone. (Iâ€™ve written some tooling to ease some of that pain. More belowâ€¦)

> We need developers to write software that treats local private networks as if they were hostile public networks.

Even if DNS rebinding becomes more popular in cybersecurity communities, that isnâ€™t a guarantee that weâ€™ll see a large drop in the number of vulnerable devices. Thatâ€™s because security nerds arenâ€™t the ones implementing these APIs, web developers are. Sure web developers *should* know that externally facing API endpoints need authorization of some kind, but there is a recurring general consensus that private networks themselves can be used to secure intranet facing APIs. Local APIs consistently offload trust and security to the private network itself. Why would your local REST API need authorization if your router has it? Entire protocols like UPnP are built around the idea that devices on the same network can trust each other. This is the root of the problem.

We need developers to write software that treats local private networks as if they were hostile public networks. The idea that the local network is a safe haven is a fallacy. If we continue to believe it people are going to get hurt.

# Protecting against DNS Rebinding

## Consumers

As the user of a product or service you are often at the mercy of the the people who built it. Fortunately, in the case of DNS rebinding, you have some control over protecting your network so long as you can make changes to your routerâ€™s configuration. [OpenDNS Home](https://www.opendns.com/home-internet-security/) is a free DNS service that can be configured to filter suspicious IP addresses like private IP ranges out of DNS responses. You should be able to change the DNS server your router uses from the default ISPâ€™s DNS server to one of OpenDNS Homeâ€™s DNS servers in your router settings.

If youâ€™d prefer to control this filtering on your router itself instead of trusting a public DNS server like OpenDNS to do it, you can use Dnsmasq or opt to install [libre router firmware like DD-RT](https://dd-wrt.com/) on the router itself. Either of these solutions are adequate if you have control over your router, but watch out, because you may still be a target of DNS rebinding attacks whenever you are on a network that hasnâ€™t been explicitly configured to protect against them.

## Developers

If youâ€™re a developer, or are involved in creating a product that has an HTTP API, there are several things you can do to protect it from DNS rebinding attacks. There are three simple solutions to choose from.

The first, and simplest to implement without side-effects to your existing system, is to add â€œHostâ€ header validation to your HTTP server. This header is included in all HTTP requests sent from a modern browser and it contains the host (hostname:port) of the server it is expecting to communicate with. This value can be a domain name or an IP address, but either way, the server that receives the request should validate that itâ€™s own host matches the host being requested. Because DNS rebinding relies on the change of an underlying IP address associated with a domain name, the Host header included in a malicious HTTP request thatâ€™s been rebound to a target service will maintain the original domain name as its Host header value. A malicious POST request to your routerâ€™s login page will have a Host header value that doesnâ€™t match your routerâ€™s hostname or IP address on the network. It would instead look like `Host: malicious.website`. Web servers should validate that the requested Host header matches itâ€™s expected value exactly and respond with a `403 Forbidden` HTTP status code if it doesnâ€™t. Iâ€™ve written [an NPM module](https://github.com/brannondorsey/host-validation) that does this for Express.js web servers, but it should be pretty easy to implement in any web server or language.

Another effective method of spoiling DNS rebinding attacks is to use HTTPS instead of HTTP, even for local network connections. When rebinding occurs, the service being targeted will have an SSL certificate that isnâ€™t valid for `malicious.website` and so a security warning will block the request from reaching your API endpoint. This solution has the added bonus of providing extra privacy and security for your users in general with the usual benefits that come with TLS/SSL. Vendors have historically shied away from shipping IoT devices with their own TLS/SSL certificates, but the Plex media server software has tackled this problem in an interesting way by actually [using DNS rebinding to issue certificates](https://blog.filippo.io/how-plex-is-doing-https-for-all-its-users/) and protect their customers!

Probably the best solution, albeit the one that involves the most potential disruption to your existing service, is to add some form of user authentication to your API. If your API controls real world functionality or provides access to sensitive information it should be accessible to select parties only. Period. It should not be accessible to the entire private network and therefore the public Internet as well through DNS rebinding. There is absolutely no reason that any device on the WiFi network should be able to arbitrarily control the heat in a building. People forget how easy it is to [crack WPA2 WiFi](https://github.com/brannondorsey/wifi-cracking).

# Tooling & Details

To help spread awareness of DNS rebinding attacks Iâ€™ve built tooling and libraries that others can use to author their own DNS rebinding attacks. Aside from the JavaScript payload written to target a specific device or service, the process of delivering that payload, interacting with the malicious DNS server, and enumerating hosts on the victimâ€™s private network is pretty much the same between different attack targets. To lower the barrier to entry to learn about and perform DNS rebinding attacks, Iâ€™ve open sourced:

* A â€œmaliciousâ€ DNS server called [whonow](https://github.com/brannondorsey/whonow)
* A front-end JavaScript library called [DNS rebind toolkit](https://github.com/brannondorsey/dns-rebind-toolkit)

## Whonow DNS Server

[Whonow](https://github.com/brannondorsey/whonow) is a custom DNS server that lets you specify DNS responses and rebind rules dynamically **using domain requests themselves**. Hereâ€™s an example of how it works:

```
# respond to DNS queries for this domain with 34.192.228.43 the first
# time it is requested and then 192.168.1.1 every time after that.
A.34.192.228.43.1time.192.168.1.1.forever.rebind.network# respond first with 34.192.228.43, then 192.168.1.1 the next five
# times, and then start all over again (1, then 5, foreverâ€¦)
A.34.192.228.43.1time.192.168.1.1.5times.repeat.rebind.network
```

Whatâ€™s great about dynamic DNS Rebinding rules is that you donâ€™t have to spin up your own malicious DNS server to start exploiting the browserâ€™s same-origin policy. Instead, everyone can share the same public whonow server running on port 53 of rebind.network.

You can try it now if youâ€™d like, just use `dig` to query the public whonow instance. It responds to requests for `*rebind.network` domain names.

```
# dig is a unix command for making DNS requests
dig A.10.10.10.50.forever.rebind.network;; QUESTION SECTION:
;10.10.10.50.forever.rebind.network. IN A;; ANSWER SECTION:
10.10.10.50.forever.rebind.network. 1 IN A 10.10.10.50
```

Whonow always sets TTL values to one second so you can expect that itâ€™s responses wonâ€™t stay in a DNS resolverâ€™s cache for long.

![]()

Whonow public server output

## DNS Rebind Toolkit

[DNS Rebind Toolkit](http://github.com/brannondorsey/dns-rebind-toolkit) is a utility library that automates the process of executing DNS rebinding attacks. Once youâ€™ve written a JavaScript payload to target a specific service, DNS Rebind Toolkit can help you deploy that attack on a victimâ€™s network.

* It uses a [WebRTC IP address leak](https://github.com/diafygi/webrtc-ips) to discover the victimâ€™s local IP address.
* It automates network subnet enumeration so that you can target devices even if you donâ€™t know their IP addresses on the private network.
* It automates the DNS rebinding portion of the attack. You get a Promise that resolves once the rebind has finished.
* It uses whonow behind the scenes so that you donâ€™t have to worry about the DNS server component of a DNS rebinding attack.
* It comes with several payloads for attacking common IoT devices and well-documented examples so that you learn to write your own exploits.

Launching an attack against a Google Home device on a 192.168.1.1/24 subnet is as easy as embedding a code snippet in and `index.html` page.

That `index.html` file will launch the attack, spawning one iframe for each IP address in the array passed to `rebind.attack(â€¦)`. Each iframe embeds `payloads/google-home.html` with the following JavaScript snippet:

# ðŸŒðŸ”— Links & Thanks ðŸ‘

Thanks to Lily Hay Newman for three months of helpful conversations leading towards her [coverage of this research in WIRED](https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/). Mega-thanks to [William Robertson](https://medium.com/u/b6495f5d83eb?source=post_page---user_mention--ea7098a2d325--------------------------------) for his help with this work, especially for letting me pwn his home network + Sonos device ðŸ¤. Iâ€™d also like to thank the security teams at both Roku and Sonos for their swift response in developing and deploying firmware updates to protect their users against DNS rebinding attacks.

Below are a collection of DNS rebinding resources Iâ€™ve found useful in my research. You might too!

* [Stanfordâ€™s Original DNS Rebinding Research](https://crypto.stanford.edu/dns/) (2007)
* [DNS Rebinding with Robert RSnake Hansen](https://www.youtube.com/watch?v=FIQGKIE3Fv0) (great video)
* [CORS, *the Frontendian*](https://frontendian.co/cors)
* [Luke Youngâ€™s DEFCON 25 â€œAchieving Reliable DNS Rebindingâ€](https://www.youtube.com/watch?v=Q0JG_eKLcws)
* [Ricky Lawshaeâ€™s DEFCON 19 SOAP & UPnP Talk](https://www.youtube.com/watch?v=dT0b5DWq9b8)
* [UPnP Hacks website](http://www.upnp-hacks.org/upnp.html)
* [Dear developers, beware of DNS Rebinding](https://www.twistlock.com/2018/02/28/dear-developers-beware-dns-rebinding/)
* [Practical Attacks with DNS Rebinding](https://www.tripwire.com/state-of-security/vert/practical-attacks-dns-rebinding/)
* [Original Blizzard Gameâ€™s DNS rebinding bug report by Tavis Ormandy](https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&desc=2)
[DNS](/tag/dns?source=post_page-----ea7098a2d325--------------------------------)[Security](/tag/security?source=post_page-----ea7098a2d325--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----ea7098a2d325--------------------------------)[Hacking](/tag/hacking?source=post_page-----ea7098a2d325--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----ea7098a2d325--------------------------------)

--

--

17

[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:96:96/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:128:128/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)Follow[## Written by Brannon Dorsey](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)[894 Followers](/%40brannondorsey/followers?source=post_page---post_author_info--ea7098a2d325--------------------------------)Â·[111 Following](/%40brannondorsey/following?source=post_page---post_author_info--ea7098a2d325--------------------------------)

Artist | Programmer | Researcher

Follow
## Responses (17)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----ea7098a2d325--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----ea7098a2d325--------------------------------)[About](/about?autoplay=1&source=post_page-----ea7098a2d325--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ea7098a2d325--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----ea7098a2d325--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----ea7098a2d325--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea7098a2d325--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea7098a2d325--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----ea7098a2d325--------------------------------)[Teams](/business?source=post_page-----ea7098a2d325--------------------------------)


