- **Root cause of vulnerability**: The application does not properly sanitize user-provided input when displaying user profiles, leading to stored Cross-Site Scripting (XSS).
- **Weaknesses/vulnerabilities present**: Stored XSS vulnerability in user profile settings. The application also has a CSRF vulnerability which is mentioned in the context of this issue.
- **Impact of exploitation**: A read-only user can inject malicious JavaScript code through their profile settings. When an administrator views the user list, the malicious script is executed, leading to actions like adding an administrator account, changing a user's role to admin or modifying admin passwords, through the CSRF vulnerability.
- **Attack vectors**: By sending a POST request to the user profile update endpoint (`https://demo.domainmod.org/settings/profile/`) with malicious JavaScript code in the `new_first_name` and `new_last_name` fields. This injected code is then executed when an admin views the user list.
- **Required attacker capabilities/position**: The attacker needs to have a read-only user account. They also need the administrator to visit the page displaying the injected content. Combining this with a CSRF vulnerability allows for more significant impact.