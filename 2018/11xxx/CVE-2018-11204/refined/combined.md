=== Content from github.com_404bf5aa_20250125_043207.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTwi1ight%2Ffuzzing-pocs%2Ftree%2Fmaster%2Fhdf5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTwi1ight%2Ffuzzing-pocs%2Ftree%2Fmaster%2Fhdf5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=Twi1ight%2Ffuzzing-pocs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Twi1ight](/Twi1ight)
/
**[fuzzing-pocs](/Twi1ight/fuzzing-pocs)**
Public

* [Notifications](/login?return_to=%2FTwi1ight%2Ffuzzing-pocs) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FTwi1ight%2Ffuzzing-pocs)
* [Star
   0](/login?return_to=%2FTwi1ight%2Ffuzzing-pocs)

* [Code](/Twi1ight/fuzzing-pocs)
* [Issues
  0](/Twi1ight/fuzzing-pocs/issues)
* [Pull requests
  0](/Twi1ight/fuzzing-pocs/pulls)
* [Actions](/Twi1ight/fuzzing-pocs/actions)
* [Projects
  0](/Twi1ight/fuzzing-pocs/projects)
* [Security](/Twi1ight/fuzzing-pocs/security)
* [Insights](/Twi1ight/fuzzing-pocs/pulse)

Additional navigation options

* [Code](/Twi1ight/fuzzing-pocs)
* [Issues](/Twi1ight/fuzzing-pocs/issues)
* [Pull requests](/Twi1ight/fuzzing-pocs/pulls)
* [Actions](/Twi1ight/fuzzing-pocs/actions)
* [Projects](/Twi1ight/fuzzing-pocs/projects)
* [Security](/Twi1ight/fuzzing-pocs/security)
* [Insights](/Twi1ight/fuzzing-pocs/pulse)

## Files

 master
## Breadcrumbs

1. [fuzzing-pocs](/Twi1ight/fuzzing-pocs/tree/master)
/
# hdf5

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/Twi1ight/fuzzing-pocs/commits/master/hdf5) master
## Breadcrumbs

1. [fuzzing-pocs](/Twi1ight/fuzzing-pocs/tree/master)
/
# hdf5

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/Twi1ight/fuzzing-pocs/tree/master) | | |
| [H5D\_\_btree\_decode\_key-H5Dbtree.c\_697-div\_by\_zero](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero "H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero") | | [H5D\_\_btree\_decode\_key-H5Dbtree.c\_697-div\_by\_zero](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero "H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero") |  |  |
| [H5D\_\_chunk\_init-H5Dchunk.c\_1022-div\_by\_zero](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5D__chunk_init-H5Dchunk.c_1022-div_by_zero "H5D__chunk_init-H5Dchunk.c_1022-div_by_zero") | | [H5D\_\_chunk\_init-H5Dchunk.c\_1022-div\_by\_zero](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5D__chunk_init-H5Dchunk.c_1022-div_by_zero "H5D__chunk_init-H5Dchunk.c_1022-div_by_zero") |  |  |
| [H5O\_\_chunk\_deserialize-H5Ocache.c\_1566-null\_point\_dereference](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference "H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference") | | [H5O\_\_chunk\_deserialize-H5Ocache.c\_1566-null\_point\_dereference](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference "H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference") |  |  |
| [H5O\_fill\_new\_decode-H5Ofill.c\_233-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O_fill_new_decode-H5Ofill.c_233-oob_read "H5O_fill_new_decode-H5Ofill.c_233-oob_read") | | [H5O\_fill\_new\_decode-H5Ofill.c\_233-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O_fill_new_decode-H5Ofill.c_233-oob_read "H5O_fill_new_decode-H5Ofill.c_233-oob_read") |  |  |
| [H5O\_fill\_old\_decode-H5Ofill.c\_337-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O_fill_old_decode-H5Ofill.c_337-oob_read "H5O_fill_old_decode-H5Ofill.c_337-oob_read") | | [H5O\_fill\_old\_decode-H5Ofill.c\_337-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5O_fill_old_decode-H5Ofill.c_337-oob_read "H5O_fill_old_decode-H5Ofill.c_337-oob_read") |  |  |
| [H5S\_hyper\_make\_spans-H5Shyper.c\_6139-null\_pointer\_dereference](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference "H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference") | | [H5S\_hyper\_make\_spans-H5Shyper.c\_6139-null\_pointer\_dereference](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference "H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference") |  |  |
| [H5VM\_memcpyvv-H5VM.c\_1626-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5VM_memcpyvv-H5VM.c_1626-oob_read "H5VM_memcpyvv-H5VM.c_1626-oob_read") | | [H5VM\_memcpyvv-H5VM.c\_1626-oob\_read](/Twi1ight/fuzzing-pocs/blob/master/hdf5/H5VM_memcpyvv-H5VM.c_1626-oob_read "H5VM_memcpyvv-H5VM.c_1626-oob_read") |  |  |
| [README.md](/Twi1ight/fuzzing-pocs/blob/master/hdf5/README.md "README.md") | | [README.md](/Twi1ight/fuzzing-pocs/blob/master/hdf5/README.md "README.md") |  |  |
| View all files | | |

## [README.md](#readme)

# HDF5-1.10.2 vulnerabilities

HDF5 is a data model, library, and file format for storing and managing data.

Download link: <https://portal.hdfgroup.org/display/support/Downloads>

All testcase run with h5dump

### Null pointer dereference in H5O\_\_chunk\_deserialize

```
(gdb) r H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference
Starting program: /opt/test/h5dump H5O__chunk_deserialize-H5Ocache.c_1566-null_point_dereference

Program received signal SIGSEGV, Segmentation fault.
H5O__chunk_deserialize (oh=oh@entry=0x975210, addr=<optimized out>, len=<optimized out>, image=image@entry=0x975000 "\001", udata=udata@entry=0x7fffffffd0c0, dirty=dirty@entry=0x7fffffffcf9b)
    at /opt/hdf5-1.10.2/src/H5Ocache.c:1566
1566	                oh->nlink = *refcount;
(gdb) p refcount
$1 = (H5O_refcount_t *) 0x0

```

### Division by zero in H5D\_\_chunk\_init

```
(gdb) r H5D__chunk_init-H5Dchunk.c_1022-div_by_zero
Program received signal SIGFPE, Arithmetic exception.
0x0000000000465691 in H5D__chunk_init (f=0x971730, dxpl_id=720575940379279368, dset=0x97d1f0, dapl_id=<optimized out>) at /opt/hdf5-1.10.2/src/H5Dchunk.c:1022
1022	            rdcc->scaled_dims[u] = dset->shared->curr_dims[u] / dset->shared->layout.u.chunk.dim[u];
(gdb) x/i $pc
=> 0x465691 <H5D__chunk_init+321>:	div    %rcx
(gdb) i r
rax            0x14	20
rbx            0x97d1f0	9949680
rcx            0x0	0
rdx            0x0	0

```

### Null pointer dereference in H5S\_hyper\_make\_spans

```
(gdb) r H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference
Starting program: /opt/test/h5dump H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference
HDF5 "H5S_hyper_make_spans-H5Shyper.c_6139-null_pointer_dereference" {
GROUP "/" {
   DATASET "Compressed_Data" {
      DATATYPE  H5T_STD_I32BE
      DATASPACE  SCALAR

Program received signal SIGSEGV, Segmentation fault.
H5S_hyper_make_spans (block=0x7fffffff98d0, count=0x7fffffff97c0, stride=0x7fffffff96b0, start=0x7fffffff95a0, rank=0) at /opt/hdf5-1.10.2/src/H5Shyper.c:6139
6139	    down->count = 1;
(gdb) p down
$2 = (H5S_hyper_span_info_t *) 0x0

```

### Division by zero in H5D\_\_btree\_decode\_key

```
(gdb) r H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero
Starting program: /opt/test/h5dump H5D__btree_decode_key-H5Dbtree.c_697-div_by_zero
Program received signal SIGFPE, Arithmetic exception.
0x0000000000646ac5 in H5D__btree_decode_key (shared=<optimized out>, raw=0x978da8 "\024", _key=0x97a928) at /opt/hdf5-1.10.2/src/H5Dbtree.c:697
697	        key->scaled[u] = tmp_offset / layout->dim[u];
(gdb) p layout->dim[u]
value has been optimized out
(gdb) x/i $pc
=> 0x646ac5 <H5D__btree_decode_key+229>:	div    %rcx
(gdb) i r
rax            0x100000640	4294968896
rbx            0x97a7e0	9938912
rcx            0x0	0
rdx            0x0	0

```

### Out of bound read in H5VM\_memcpyvv

```
(gdb) r H5VM_memcpyvv-H5VM.c_1626-oob_read
Starting program: /opt/test/h5dump H5VM_memcpyvv-H5VM.c_1626-oob_read
HDF5 "H5VM_memcpyvv-H5VM.c_1626-oob_read" {
GROUP "/" {
   DATASET "Compressed_Data" {
      DATATYPE  H5T_STD_I32BE
      DATASPACE  SIMPLE { ( 100, 20 ) / ( 100, 20 ) }

Program received signal SIGSEGV, Segmentation fault.
__memcpy_sse2_unaligned () at ../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S:35
35	../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S: No such file or directory.
(gdb) bt
#0  __memcpy_sse2_unaligned () at ../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S:35
#1  0x0000000000627a1f in memcpy (__len=80, __src=<optimized out>, __dest=<optimized out>) at /usr/include/x86_64-linux-gnu/bits/string3.h:53
#2  H5VM_memcpyvv (_dst=0x7ffff7e68018, dst_max_nseq=<optimized out>, dst_curr_seq=dst_curr_seq@entry=0x7fffffffa5c8, dst_len_arr=dst_len_arr@entry=0x7fffffffa5d8,
    dst_off_arr=dst_off_arr@entry=0x7fffffffa5c0, _src=0x995440, src_max_nseq=20, src_curr_seq=0x7fffffffa5d0, src_len_arr=0x98eac8, src_off_arr=0x990af8) at /opt/hdf5-1.10.2/src/H5VM.c:1626
......
(gdb) f 2
#2  H5VM_memcpyvv (_dst=0x7ffff7e68018, dst_max_nseq=<optimized out>, dst_curr_seq=dst_curr_seq@entry=0x7fffffffa5f8, dst_len_arr=dst_len_arr@entry=0x7fffffffa608,
    dst_off_arr=dst_off_arr@entry=0x7fffffffa5f0, _src=0x9953c0, src_max_nseq=20, src_curr_seq=0x7fffffffa600, src_len_arr=0x98ea48, src_off_arr=0x990a78) at /opt/csn/hdf5-1.10.2/src/H5VM.c:1626
1626	            HDmemcpy(dst, src, tmp_src_len);
(gdb) p src
$22 = <optimized out>

```

As we can see, the src is optimized out, so we check the source code, and found the src is computed:

```
1613	    /* Compute buffer offsets */
1614	    dst = (unsigned char *)_dst + *dst_off_ptr;
1615	    src = (const unsigned char *)_src + *src_off_ptr;  // <------ src
1616
1617	/* Work through the sequences */
1618	/* (Choose smallest sequence available initially) */
1619
1620	    /* Source sequence is less than destination sequence */
1621	    if(tmp_src_len < tmp_dst_len) {
1622	src_smaller:
1623	        acc_len = 0;
1624	        do {
1625	            /* Copy data */
1626	            HDmemcpy(dst, src, tmp_src_len);  //<-------- crash here
```

back to gdb, we could see the out of bound read

```
(gdb) p _src
$23 = (const void *) 0x9953c0
(gdb) p *src_off_ptr
$24 = 131152
(gdb) p (const unsigned char *)_src + *src_off_ptr
$25 = (const unsigned char *) 0x9b5410 <error: Cannot access memory at address 0x9b5410>

```

### Out of bound read in H5O\_fill\_new\_decode and H5O\_fill\_old\_decode

```
(gdb) r H5O_fill_new_decode-H5Ofill.c_233-oob_read
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /opt/test/h5dump H5O_fill_new_decode-H5Ofill.c_233-oob_read

Program received signal SIGSEGV, Segmentation fault.
__memcpy_sse2_unaligned () at ../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S:38
38	../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S: No such file or directory.
(gdb) bt
#0  __memcpy_sse2_unaligned () at ../sysdeps/x86_64/multiarch/memcpy-sse2-unaligned.S:38
#1  0x000000000053285d in memcpy (__len=<optimized out>, __src=0x9753b0, __dest=<optimized out>) at /usr/include/x86_64-linux-gnu/bits/string3.h:53
#2  H5O_fill_new_decode (f=<optimized out>, dxpl_id=<optimized out>, open_oh=<optimized out>, mesg_flags=<optimized out>, ioflags=<optimized out>, p_size=<optimized out>, p=0x9753b0 "\v")
    at /opt/hdf5-1.10.2/src/H5Ofill.c:233
#3  H5O_fill_new_shared_decode (f=<optimized out>, dxpl_id=<optimized out>, open_oh=<optimized out>, mesg_flags=<optimized out>, ioflags=<optimized out>, p_size=<optimized out>, p=0x9753a8 "\002\003\002\001")
    at /opt/hdf5-1.10.2/src/H5Oshared.h:82
......
(gdb) f 2
#2  H5O_fill_new_decode (f=<optimized out>, dxpl_id=<optimized out>, open_oh=<optimized out>, mesg_flags=<optimized out>, ioflags=<optimized out>, p_size=<optimized out>, p=0x9753b0 "\v")
    at /opt/hdf5-1.10.2/src/H5Ofill.c:233
233	                HDmemcpy(fill->buf, p, (size_t)fill->size);
(gdb) p p
$5 = (const uint8_t *) 0x9753b0 "\v"
(gdb) p fill
$6 = (H5O_fill_t *) 0x97eaf0
(gdb) p *fill
$7 = {sh_loc = {type = 0, file = 0x0, msg_type_id = 0, u = {loc = {index = 0, oh_addr = 0}, heap_id = {id = "\000\000\000\000\000\000\000", val = 0}}}, version = 2, type = 0x0, size = 8388608,
  buf = 0x7ffff6cff010, alloc_time = H5D_ALLOC_TIME_INCR, fill_time = H5D_FILL_TIME_IFSET, fill_defined = true}
(gdb) p fill->buf
$8 = (void *) 0x7ffff6cff010
(gdb) p fill->size
$9 = 8388608
(gdb) p p+fill->size
$10 = (const uint8_t *) 0x11753b0 <error: Cannot access memory at address 0x11753b0>

```

the `HDmemcpy` is just a wrapper of memcpy, the size `fill->size` is large than p's size, which caused `p+fill->size` out of bound.

this issue exist in `H5O_fill_old_decode` too, in file `H5Ofill.c` line 337

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


