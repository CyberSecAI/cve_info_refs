- **Root cause of vulnerability**: The `download_agent_installer.php` file in Quest KACE Systems Management Appliance allows unauthenticated users to execute arbitrary commands due to insufficient input sanitization. Specifically, the `orgid` parameter is vulnerable to command injection.
- **Weaknesses/vulnerabilities present**: Command Injection. The application fails to sanitize the input provided via the `orgid` parameter in the request to `download_agent_installer.php`.
- **Impact of exploitation**: Successful exploitation allows an unauthenticated attacker to execute arbitrary commands on the server as the web server user (`www`).
- **Attack vectors**: Sending a crafted HTTP GET request to the `download_agent_installer.php` endpoint, with a malicious payload injected into the `orgid` parameter. The attacker does not need prior authentication, only knowledge of the appliance's serial number (which can be obtained from `about.php`) and a valid agent version.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to send HTTP requests to the vulnerable appliance.
    - The attacker needs to know or be able to determine:
        - A valid Organization ID (default is usually `1`).
        - A valid Windows agent version (can be found on the KACE website or within the `\\kace.local\client\agent_provisioning\windows_platform` Samba share, if file sharing is enabled).
        - The appliance serial number (can be obtained from `about.php` endpoint).