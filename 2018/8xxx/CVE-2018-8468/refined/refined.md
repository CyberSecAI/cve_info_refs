```
{
  "Root cause": "A series of vulnerabilities in Microsoft Edge and Internet Explorer that when chained together, allow for arbitrary code execution outside of the browser sandbox.",
  "Weaknesses/vulnerabilities": [
    "**Edge content process privilege escalation:** The `EdgeUrlUtils::IsAboutFlagsResUri` method in `eModel.dll` incorrectly determines if a URL should spawn a privileged content process. It only checks the scheme and if the URL ends with `/edgehtml.dll/flags.htm`, allowing an attacker to use a crafted URL like `res://apds.dll/redirect.html?target=javascript:alert(1)//edgehtml.dll/flags.htm` to trigger a privileged process.",
    "**Internet Explorer Compatibility View bypass:** A privileged content process can request the host to launch IE for certain sites. The host only checks the domain against the IE compatibility view list, allowing the attacker to use an arbitrary scheme like `file://`. This bypasses security checks and enables redirection to the attacker's controlled files.",
    "**Internet Explorer ShellExecuteExW vulnerability:** When given a `file://` URL that points to a folder, Internet Explorer opens the folder using `ShellExecuteExW`. This allows the attacker to create a specially crafted `.lnk` file that bypasses the folder check and executes arbitrary files, achieving code execution."
  ],
  "Impact of exploitation": "Successful exploitation of these vulnerabilities allows an attacker to execute arbitrary code outside of the Microsoft Edge sandbox, potentially leading to full system compromise.",
  "Attack vectors": [
    "Crafted URL to exploit the Edge content process privilege escalation vulnerability.",
    "Abuse of the privileged process's ability to launch IE with an arbitrary scheme.",
    "Malicious LNK file exploiting the Internet Explorer `ShellExecuteExW` function."
  ],
  "Required attacker capabilities/position": [
    "Ability to trigger the crafted URL in Microsoft Edge",
    "Ability to host a samba server with a domain on the IE compatibility list. The provided exploit uses a modified host file for testing purposes, demonstrating the capability without owning a domain",
    "Ability to deliver the malicious .lnk file to the targeted machine"
  ]
}
```