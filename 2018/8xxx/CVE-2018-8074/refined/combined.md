=== Content from www.yiiframework.com_12391f21_20250124_191040.html ===

[![Yii PHP Framework](/image/logo.svg)](/)

* [Guide](/doc/guide)
* [API](/doc/api)
* [Wiki](/wiki)
* [Forum](/forum)
* Community
  + [Live Chat](/chat)
  + [Extensions](/extensions)
  + [Resources](/community)
  + [Members](/user)
  + [Hall of Fame](/user/halloffame)
  + [Badges](/badges)
* More
  + Learn
  + [Books](/books)
  + [Resources](/resources)
  + Develop
  + [Download Yii](/download)
  + [Report an Issue](/report-issue)
  + [Report a Security Issue](/security)
  + [Contribute to Yii](/contribute)
  + [Donate](/donate)
  + About
  + [What is Yii?](/doc/guide/2.0/en/intro-yii)
  + [Release Cycle](/release-cycle)
  + [News](/news)
  + [License](/license)
  + [Team](/team)
  + [Official Logos and Design](/logo)

* [Login](/login)

Yii Framework News

Mar 20, 2018
## [Releasing Yii 2.0.15 and database extensions with security fixes](/news/168/releasing-yii-2-0-15-and-database-extensions-with-security-fixes)

Today we are releasing several versions for Yii 2.0.x and official extensions to fix a security issue.

The problem addressed in these patches exists in ActiveRecord shortcut methods `findOne()` and `findAll()`, which may
allow [SQL injection](https://en.wikipedia.org/wiki/SQL_injection) if input is not prepared properly. We consider this as a security issue in Yii because the documentation for these methods did not contain an explicit warning that there are cases when passing unfiltered user input might be dangerous. Thanks to [analitic1983](https://github.com/analitic1983) for making us aware of the issue.

The nature of this issue does not solely exists in the Yii Framework but depends on how an application uses Yii.
We have changed Yii to be more robust against the worst impact of the problem (SQL injection), but applications may still be vulnerable
and changes to application code are necessary in some cases. As a safety measure, `findOne()` and `findAll()` are now limited to filter on
columns that are AR properties only. In the following we will explain the problem in more detail
and show which application code is affected and what needs to be adjusted on upgrade.

For discussion on this issue, [there is a forum topic](http://www.yiiframework.com/forum/index.php/topic/76661-releasing-yii-2015-and-database-extensions-with-security-fixes/).

### Summary of Affected Classes, Methods and Composer Packages [¶](#summary-of-affected-classes-methods-and-composer-packages)

1. [Not Affected Code](#not-affected-code)
2. [Affected Code](#affected-code)

* `yii\db\ActiveRecord::findOne()` and `yii\db\ActiveRecord::findAll()` in `yiisoft/yii2` referenced as [CVE-2018-7269](https://nvd.nist.gov/vuln/detail/CVE-2018-7269).
  Methods allow [SQL injection](https://en.wikipedia.org/wiki/SQL_injection) if input is not prepared properly. Attackers could probably execute arbitrary SQL queries
  or circumvent access checking methods applied on query level.
* `yii\redis\ActiveRecord::findOne()` and `yii\redis\ActiveRecord::findAll()` in `yiisoft/yii2-redis` referenced as [CVE-2018-8073](https://nvd.nist.gov/vuln/detail/CVE-2018-8073).
  Methods allow [remote code execution](https://en.wikipedia.org/wiki/Remote_code_execution) in redis servers lua script environment. Attackers could probably manipulate
  data on the redis server.
* `yii\elasticsearch\ActiveRecord::findOne()` and `yii\elasticsearch\ActiveRecord::findAll()` in `yiisoft/yii2-elasticsearch` referenced as [CVE-2018-8074](https://nvd.nist.gov/vuln/detail/CVE-2018-8074).
  Methods may allow injecting different search condition than desired or cause an error response from the elasticsearch server.

### Is my Application Affected? [¶](#is-my-application-affected)

This vulnerability affects all releases of the 2.0.x branch. It is fixed in Yii 2.0.15. For versions below 2.0.15, we have released two patch versions, 2.0.13.2 and 2.0.12.1, which apply the fix to 2.0.13.1 and 2.0.12 respectively. Users of 2.0.14, can upgrade to 2.0.15, there are no other changes made in this release.

#### Not Affected Code [¶](#not-affected-code)

The methods `findOne()` and `findAll()` accept a single argument, which can be scalar or array. If the calling code ensures that a scalar is passed
or if client inputs cannot modify the array's structure, your application is **not** affected by this issue.
The following code examples are **not** affected by this issue (examples shown for `findOne()` are valid also for `findAll()`):

```
// yii\web\Controller ensures that $id is scalar
public function actionView($id)
{
    $model = Post::findOne($id);
    // ...
}

```
```
// casting to (int) or (string) ensures no array can be injected (an exception will be thrown so this is not a good practise)
$model = Post::findOne((int) Yii::$app->request->get('id'));

```
```
// explicitly specifying the colum to search, passing a scalar or array here will always result in finding a single record
$model = Post::findOne(['id' => Yii::$app->request->get('id')]);

```
#### Affected Code [¶](#affected-code)

The following code however **is vulnerable**, an attacker could inject an array with an arbitrary condition and even exploit SQL injection:

```
$model = Post::findOne(Yii::$app->request->get('id'));

```

For the above example, the SQL injection part is fixed with the patches provided in this release, but an attacker may still be able to search
records by different condition than a primary key search and violate your application business logic. So passing user input directly like this can cause problems and should be avoided.

### How do I Upgrade? [¶](#how-do-i-upgrade)

If you are using Yii 2.0.14:

```
composer require "yiisoft/yii2":"~2.0.15.0"

```

If you are using Yii 2.0.13:

```
composer require "yiisoft/yii2":"~2.0.13.2"

```

If you are using Yii 2.0.12:

```
composer require "yiisoft/yii2":"~2.0.12.1"

```

If you are using `yii2-redis` extension:

```
composer require "yiisoft/yii2-redis":"~2.0.8"

```

If you are using `yii2-elasticsearch` extension:

```
composer require "yiisoft/yii2-elasticsearch":"~2.0.5"

```

**Update:** We have since released further patches to lower the impact of the BC break introduced by the security fix, so you get versions 2.0.15.1, 2.0.13.3 and 2.0.12.2 from the above.

### Upgrading isn't Enough! [¶](#upgrading-isnt-enough)

Upgrading Yii addresses the SQL injection but doesn't make `findOne()` and `findAll()` safe in general. Check all usages of `findOne()` and `findAll()` in your application. Also note, that `where()` and `filterWhere()` never escape column names, so if you need to pass a variable as a column name, make sure it is safe.

## Related News

* [Yii 2.0.49](/news/576/yii-2-0-49)
* [Yii 1.1.29 is released](/news/587/yii-1-1-29-is-released)
* [Yii 2.0.50](/news/639/yii-2-0-50)
* [Yii 2.0.51](/news/650/yii-2-0-51)
* [Yii 1.1.30 is released](/news/669/yii-1-1-30-is-released)

## Tags

* [2.0.12](/news?tag=2-0-12)
* [2.0.13](/news?tag=2-0-13)
* [elasticsearch](/news?tag=elasticsearch)
* [redis](/news?tag=redis)
* [release](/news?tag=release)
* [security](/news?tag=security)
* [Yii 2.0](/news?tag=yii-2-0)

## News Archive

* [2025](/news?year=2025) (5)
* [2024](/news?year=2024) (80)
* [2023](/news?year=2023) (90)
* [2022](/news?year=2022) (82)
* [2021](/news?year=2021) (101)
* [2020](/news?year=2020) (64)
* [2019](/news?year=2019) (75)
* [2018](/news?year=2018) (32)
* [2017](/news?year=2017) (35)
* [2016](/news?year=2016) (30)
* [2015](/news?year=2015) (9)
* [2014](/news?year=2014) (6)
* [2013](/news?year=2013) (11)
* [2012](/news?year=2012) (14)
* [2011](/news?year=2011) (10)
* [2010](/news?year=2010) (10)
* [2009](/news?year=2009) (23)
* [2008](/news?year=2008) (5)

* About
* [About Yii](/doc/guide/2.0/en/intro-yii)
* [News](/news)
* [License](/license)
* [Contact Us](/contact)

* Downloads
* [Framework](/download)
* [Documentation](/download#offline-documentation)
* [Extensions](/extensions)
* [Logo](/logo)

* Documentation
* [Guide](/doc/guide)
* [API](/doc/api)
* [Wiki](/wiki)
* [Resources](/resources)

* Development
* [Contribute](/contribute)
* [Latest Updates](https://github.com/yiisoft/yii2/commits/master)
* [Report a Bug](/report-issue)
* [Report Security Issue](/security)

* Community
* [Forum](/forum)
* [Live Chat](/chat)
* [Facebook Group](https://www.facebook.com/groups/yiitalk/)
* [Hall of Fame](/user/halloffame)
* [Badges](/badges)

* [Terms of service](/tos)
* [License](/license)
* [Website Source Code](https://github.com/yiisoft-contrib/yiiframework.com)
* © 2008 - 2025 Yii
* Design: [Eshill](https://www.eshill.ru/)

* [Terms of service](/tos)
* [License](/license)
* [Website Source Code](https://github.com/yiisoft-contrib/yiiframework.com)
* © 2008 - 2025 Yii
* Design: [Eshill](https://www.eshill.ru/)

* Supported by
* [![OpenCollective](/image/collective.png)](https://opencollective.com/yiisoft)
* [![JetBrains logo](/image/jetbrains.svg)](https://www.jetbrains.com/?from=yii)


