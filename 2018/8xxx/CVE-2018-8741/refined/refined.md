```
{
  "cveId": "CVE-2018-8741",
  "baseScore": "8.8",
  "severity": "High",
  "attackVector": "Network",
  "attackComplexity": "Low",
  "privilegesRequired": "Low",
  "userInteraction": "None",
  "scope": "Unchanged",
  "confidentialityImpact": "High",
  "integrityImpact": "High",
  "availabilityImpact": "High",
  "weaknesses": [
    "CWE-22"
  ],
  "description": "A directory traversal flaw in SquirrelMail 1.4.22 allows an authenticated attacker to exfiltrate (or potentially delete) files from the hosting server, related to ../ in the att_local_name field in Deliver.class.php.",
  "vulnerabilityDetails": {
    "rootCause": "The vulnerability is caused by a missing sanitization of user-supplied input, specifically the 'att_local_name' parameter. This parameter, used when attaching files, allows for path traversal. The application deserializes this parameter, which contains the path to the temporary file intended for attachment, and does not properly validate it before using it in a file operation.",
    "vulnerabilities": [
      "Directory Traversal: An attacker can use path traversal sequences (like `../`) within the `att_local_name` parameter to access files outside the intended directory."
    ],
    "impact": "An attacker can read arbitrary files on the server by attaching them to an email. If the user running the application has sufficient privileges, they can potentially delete files as well.",
    "attackVectors": "The vulnerability can be exploited through the web interface of SquirrelMail by crafting a malicious `att_local_name` parameter within the attachment functionality.",
    "attackerCapabilities": "The attacker needs to be an authenticated user of the SquirrelMail application.  An additional vulnerability for pre-authentication exploitation would be required for an unauthenticated attack."
  },
   "patchDetails": {
    "fixes": [
      "A patch was created to sanitize the filename and ensure it only contains letters and numbers, or terminates the process otherwise.",
       "Another patch uses realpath() to ensure that the file path stays within the attachment directory.",
      "Another approach encodes the filename using base64, and then decodes it when necessary"
    ],
      "vendorFixes": [
      "Squirrelmail has addressed the vulnerability by implementing input sanitization in the compose.php file.",
           "Patches have been released in squirrelmail versions 1.4.23"
      ]
  }
}
```