=== Content from lists.debian.org_50de9806_20250124_231740.html ===


---

[[Date Prev](msg00030.html)][[Date Next](msg00032.html)]
[[Thread Prev](msg00030.html)][[Thread Next](msg00032.html)]
[[Date Index](maillist.html#00031)]
[[Thread Index](threads.html#00031)]

# [SECURITY] [DLA 2936-1] libgit2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2936-1] libgit2 security update
* *From*: Utkarsh Gupta <guptautkarsh2102@gmail.com>
* *Date*: Mon, 21 Mar 2022 06:09:43 +0530
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/CAPP0f956ZXVvXt8yR9s8Wqthm-nVwDNU0JCXNSSRwfk4umy9OA%40mail.gmail.com)Â [CAPP0f956ZXVvXt8yR9s8Wqthm-nVwDNU0JCXNSSRwfk4umy9OA@mail.gmail.com](msg00031.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2936-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Utkarsh Gupta
March 07, 2022                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : libgit2
Version        : 0.25.1+really0.24.6-1+deb9u1
CVE ID         : CVE-2018-8098 CVE-2018-8099 CVE-2018-10887 CVE-2018-10888
                 CVE-2018-15501 CVE-2020-12278 CVE-2020-12279
Debian Bug     : 892961 892962 903508 903509

Multiple vulnerabilities were found in libgit2, a low-level Git library,
and are as follows:

CVE-2018-8098

    Integer overflow in the index.c:read_entry() function while
    decompressing a compressed prefix length in libgit2 before
    v0.26.2 allows an attacker to cause a denial of service
    (out-of-bounds read) via a crafted repository index file.

CVE-2018-8099

    Incorrect returning of an error code in the index.c:read_entry()
    function leads to a double free in libgit2 before v0.26.2, which
    allows an attacker to cause a denial of service via a crafted
    repository index file.

CVE-2018-10887

    It has been discovered that an unexpected sign extension in
    git_delta_apply function in delta-apply.c file may lead to an
    integer overflow which in turn leads to an out of bound read,
    allowing to read before the base object. An attacker may use
    this flaw to leak memory addresses or cause a Denial of Service.

CVE-2018-10888

    A missing check in git_delta_apply function in delta-apply.c file,
    may lead to an out-of-bound read while reading a binary delta file.
    An attacker may use this flaw to cause a Denial of Service.

CVE-2018-15501

    In ng_pkt in transports/smart_pkt.c in libgit2, a remote attacker
    can send a crafted smart-protocol "ng" packet that lacks a '\0'
    byte to trigger an out-of-bounds read that leads to DoS.

CVE-2020-12278

    path.c mishandles equivalent filenames that exist because of NTFS
    Alternate Data Streams. This may allow remote code execution when
    cloning a repository. This issue is similar to CVE-2019-1352.

CVE-2020-12279

    checkout.c mishandles equivalent filenames that exist because of
    NTFS short names. This may allow remote code execution when cloning
    a repository. This issue is similar to CVE-2019-1353.

For Debian 9 stretch, these problems have been fixed in version
0.25.1+really0.24.6-1+deb9u1.

We recommend that you upgrade your libgit2 packages.

For the detailed security status of libgit2 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libgit2>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmI3yRwACgkQgj6WdgbD
S5ZcuxAAopr5ghcwWV9388Xn31ec9sibrnjFbeOuuim7JAO8NjP8jqzOBILnayqS
DtCsJ++inIaQbeCe1kiHHoo9IVRr796KSHiiOzbufB2wawrXEThIP8Hxzhe/7eYl
aWKj3MFk18+kulZr+2HpFGlCDoajnKXkNhud2ArLewJZwXRpD83i3k/NnA7AWp+0
7ei+7jEoohT1bfytmVOyVx78POd8NXRKZTt1HRZsjbUDwYjbVp488ddtBmE9akU8
fhYxCEUSPnQc+ySYTERoJOGV4baxAk7ks29dCbdSjd2P1mapf0QjkWZKQoeswLjX
heju/COKPfZDti+Fgs6xH9dsD48bYuBrqSx0MzXibrHVVwBkcaXXkKBXNR6mXv/F
RqSnl/6haRXHHCHLCNARGIAwRjNk9RzUjcb6bg0312yFyD6Gq97nRLvDANHLEsMw
2Bofvh1gCkCE7or7q7O/qq/KuBlmzcrDci06TYfkigzClU4nRS5ARE4yPyh6S/wt
M1SQb4RC9+rQ+gthRzPFjMonUKiq2oH15256CeB4qP7czUpcjLlbU/CSxvnDdYrs
bB2J+cCDpyV9RIVJCD8ujMjIkIBxFhEB4PVKOYnjZl6xjO6xWQnZVeMDMazyfCyB
RD8P/kTEaD02vTfuMtB47/ao8rGd1w/bfbpMMfCE5Zz6gfyojQE=
=i74o
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_a031c30b_20250124_231739.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibgit2%2Flibgit2%2Fcommit%2F58a6fe94cb851f71214dbefac3f9bffee437d6fe)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibgit2%2Flibgit2%2Fcommit%2F58a6fe94cb851f71214dbefac3f9bffee437d6fe)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=libgit2%2Flibgit2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libgit2](/libgit2)
/
**[libgit2](/libgit2/libgit2)**
Public

* [Notifications](/login?return_to=%2Flibgit2%2Flibgit2) You must be signed in to change notification settings
* [Fork
  2.4k](/login?return_to=%2Flibgit2%2Flibgit2)
* [Star
   9.8k](/login?return_to=%2Flibgit2%2Flibgit2)

* [Code](/libgit2/libgit2)
* [Issues
  356](/libgit2/libgit2/issues)
* [Pull requests
  88](/libgit2/libgit2/pulls)
* [Discussions](/libgit2/libgit2/discussions)
* [Actions](/libgit2/libgit2/actions)
* [Projects
  0](/libgit2/libgit2/projects)
* [Security](/libgit2/libgit2/security)
* [Insights](/libgit2/libgit2/pulse)

Additional navigation options

* [Code](/libgit2/libgit2)
* [Issues](/libgit2/libgit2/issues)
* [Pull requests](/libgit2/libgit2/pulls)
* [Discussions](/libgit2/libgit2/discussions)
* [Actions](/libgit2/libgit2/actions)
* [Projects](/libgit2/libgit2/projects)
* [Security](/libgit2/libgit2/security)
* [Insights](/libgit2/libgit2/pulse)

## Commit

[Permalink](/libgit2/libgit2/commit/58a6fe94cb851f71214dbefac3f9bffee437d6fe)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

index: convert `read_entry` to return entry size via an out-param

[Browse files](/libgit2/libgit2/tree/58a6fe94cb851f71214dbefac3f9bffee437d6fe)
Browse the repository at this point in the history

```
The function `read_entry` does not conform to our usual coding style of
returning stuff via the out parameter and to use the return value for
reporting errors. Due to most of our code conforming to that pattern, it
has become quite natural for us to actually return `-1` in case there is
any error, which has also slipped in with commit [5625d86](https://github.com/libgit2/libgit2/commit/5625d86b994fd81f1b0d887890e8168d7b5f46cc) (index:
support index v4, 2016-05-17). As the function returns an `size_t` only,
though, the return value is wrapped around, causing the caller of
`read_tree` to continue with an invalid index entry. Ultimately, this
can lead to a double-free.

Improve code and fix the bug by converting the function to return the
index entry size via an out parameter and only using the return value to
indicate errors.

Reported-by: Krishna Ram Prakash R <krp@gtux.in>
Reported-by: Vivek Parikh <viv0411.parikh@gmail.com>
```

* Loading branch information

[![@pks-t](https://avatars.githubusercontent.com/u/4056630?s=40&v=4)](/pks-t)

[pks-t](/libgit2/libgit2/commits?author=pks-t "View all commits by pks-t")
committed
Mar 10, 2018

1 parent
[d11c4a1](/libgit2/libgit2/commit/d11c4a1a464f10c69d5cc58824e980ea5045d439)

commit 58a6fe9

Showing
**1 changed file**
with
**13 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

22 changes: 13 additions & 9 deletions

22
[src/index.c](#diff-92aa11bc79b898a56e4f87d8da8e6c12a4a3e82e84e80dd499d956acec7aefe7 "src/index.c")

Show comments

[View file](/libgit2/libgit2/blob/58a6fe94cb851f71214dbefac3f9bffee437d6fe/src/index.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2299,8 +2299,9 @@ static size\_t index\_entry\_size(size\_t path\_len, size\_t varint\_len, uint32\_t flag |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | static size\_t read\_entry( |
|  |  | static int read\_entry( |
|  |  | git\_index\_entry \*\*out, |
|  |  | size\_t \*out\_size, |
|  |  | git\_index \*index, |
|  |  | const void \*buffer, |
|  |  | size\_t buffer\_size, |
| Expand All | | @@ -2314,7 +2315,7 @@ static size\_t read\_entry( |
|  |  | char \*tmp\_path = NULL; |
|  |  |  |
|  |  | if (INDEX\_FOOTER\_SIZE + minimal\_entry\_size > buffer\_size) |
|  |  | return 0; |
|  |  | return -1; |
|  |  |  |
|  |  | /\* buffer is not guaranteed to be aligned \*/ |
|  |  | memcpy(&source, buffer, sizeof(struct entry\_short)); |
| Expand Down  Expand Up | | @@ -2356,7 +2357,7 @@ static size\_t read\_entry( |
|  |  |  |
|  |  | path\_end = memchr(path\_ptr, '\0', buffer\_size); |
|  |  | if (path\_end == NULL) |
|  |  | return 0; |
|  |  | return -1; |
|  |  |  |
|  |  | path\_length = path\_end - path\_ptr; |
|  |  | } |
| Expand Down  Expand Up | | @@ -2386,16 +2387,20 @@ static size\_t read\_entry( |
|  |  | entry.path = tmp\_path; |
|  |  | } |
|  |  |  |
|  |  | if (entry\_size == 0) |
|  |  | return -1; |
|  |  |  |
|  |  | if (INDEX\_FOOTER\_SIZE + entry\_size > buffer\_size) |
|  |  | return 0; |
|  |  | return -1; |
|  |  |  |
|  |  | if (index\_entry\_dup(out, index, &entry) < 0) { |
|  |  | git\_\_free(tmp\_path); |
|  |  | return 0; |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | git\_\_free(tmp\_path); |
|  |  | return entry\_size; |
|  |  | \*out\_size = entry\_size; |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | static int read\_header(struct index\_header \*dest, const void \*buffer) |
| Expand Down  Expand Up | | @@ -2499,10 +2504,9 @@ static int parse\_index(git\_index \*index, const char \*buffer, size\_t buffer\_size) |
|  |  | /\* Parse all the entries \*/ |
|  |  | for (i = 0; i < header.entry\_count && buffer\_size > INDEX\_FOOTER\_SIZE; ++i) { |
|  |  | git\_index\_entry \*entry = NULL; |
|  |  | size\_t entry\_size = read\_entry(&entry, index, buffer, buffer\_size, last); |
|  |  | size\_t entry\_size; |
|  |  |  |
|  |  | /\* 0 bytes read means an object corruption \*/ |
|  |  | if (entry\_size == 0) { |
|  |  | if ((error = read\_entry(&entry, &entry\_size, index, buffer, buffer\_size, last)) < 0) { |
|  |  | error = index\_error\_invalid("invalid entry"); |
|  |  | goto done; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `58a6fe9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibgit2%2Flibgit2%2Fcommit%2F58a6fe94cb851f71214dbefac3f9bffee437d6fe) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


