```
{
  "vulnerability_details": {
    "root_cause": "The Data Sharing Service (DSSVC) has a Time-of-Check Time-of-Use (TOCTOU) vulnerability in the `PolicyChecker::CheckFilePermission` function.",
    "weaknesses": [
      "The `CheckFilePermission` function uses `OPEN_ALWAYS` as the disposition when calling `CreateFile`, even when the code expects the file to already exist. This causes a new file to be created if one doesn't exist and then deleted via `DeleteFile` if the operation is assumed to have created a new file.",
       "There's a TOCTOU vulnerability because the path passed to `CreateFile` doesn't necessarily refer to the same file that is passed to `DeleteFile`."
    ],
    "impact": "Arbitrary file deletion. An attacker can delete a file they would normally not have permission to delete.",
    "attack_vectors": [
      "Mount point manipulation: An attacker can specify a path with a mount point, and then change the mount point to point somewhere else between the `CreateFile` and `DeleteFile` calls.",
      "Per-user C: redirection:  An attacker can set up a per-user C: drive redirection which will cause the `CreateFile` call to open a new file in an arbitrary directory but the `DeleteFile` will operate out of impersonation with the system supplied C: drive."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to supply a file path to the vulnerable service (DSSVC). The attacker requires the ability to create mount points, or set up a per-user C: drive redirection."
  }
}
```