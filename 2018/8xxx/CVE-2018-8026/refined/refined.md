```
{
  "vulnerability": {
    "root_cause": "The vulnerability stems from the use of an insecure `DocumentBuilderFactory` to parse XML files (`currency.xml` and `enumsConfig.xml`) within the Apache Solr application.",
    "weaknesses": [
      "XXE (XML External Entity) injection due to improper XML parsing configuration"
    ],
    "impact": "Successful exploitation of this vulnerability could lead to:\n\n  *   Disclosure of sensitive information by reading arbitrary files on the server.\n  *   Server-side request forgery (SSRF) attacks.",
    "attack_vectors": [
      "An attacker crafts malicious XML files (`currency.xml` or `enumsConfig.xml`) with an external entity that attempts to fetch an external DTD and subsequently reads server files via ftp.",
        "The malicious XML files are uploaded to the Solr server as part of a configset. When a collection is created using this configset, the vulnerable XML parsing logic is triggered."
    ],
    "required_capabilities": [
      "Attacker needs to upload a malicious configset to the Solr server.",
        "Attacker needs an accessible server to host malicious `xxe.dtd` file."
    ],
        "additional_information": "The vulnerability affects Apache Solr versions 6.0.0 through 6.6.4 and 7.0.0 through 7.3.1. The vulnerability exists in `FileExchangeRateProvider.java` and `AbstractEnumField.java` classes where the `DocumentBuilderFactory` is instantiated without disabling external entity processing. This leads to XXE vulnerability."
  }
}
```