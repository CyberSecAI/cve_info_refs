```json
{
  "cveId": "CVE-2018-8449",
  "relatedContent": [
    {
      "source": "www.exploit-db.com_6f2380f0_20250124_144019.html",
      "vulnerabilityDetails": {
        "rootCause": "A Time-of-Check Time-of-Use (TOCTOU) race condition vulnerability exists in the `CiSetFileCache` kernel function. While previous TOCTOU issues with cache signing were mitigated through `NtSetCachedSigningLevel`, a similar vulnerability can be exploited through `NtCreateSection` when a process runs with an elevated section signing level.",
        "weaknesses": [
          "TOCTOU race condition in `CiSetFileCache` during image section creation.",
           "Lack of write access check when creating an image section with a writable file handle."
        ],
        "impact": "Bypassing WDAC (Windows Defender Application Control) policies, CIG (Code Integrity Guard), and potentially PPL (Protected Processes Light). An attacker can 'cache sign' an arbitrary executable, allowing execution of unsigned code.",
        "attackVectors": [
          "Creating an image section with a writable file handle using `NtCreateSection`.",
          "Exploiting a race condition by rewriting the file contents after the initial check but before caching the signature."
        ],
         "requiredCapabilities": "Attacker needs to elevate the section signing level of the current process, either by using `SetProcessMitigationPolicy` or running in a WDAC/CIG process. The attacker also needs write access to a signed file and the ability to set an oplock on a catalog file."
      }
    }
  ]
}
```