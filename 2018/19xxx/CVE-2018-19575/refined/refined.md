- **Root cause of vulnerability:** The vulnerability stems from a lack of proper authorization checks when creating comments. The application allows a user who is authorized to comment on one issue to create a comment on a different issue by manipulating the `noteable_id` parameter in the POST request.
- **Weaknesses/vulnerabilities present:**
  - **Insecure Direct Object Reference (IDOR):** The application does not validate if the user is authorized to comment on the issue specified by `noteable_id`.
  - **Lack of Authorization Checks:** The system relies on the client-side to determine what issues can be commented on, and doesn't re-validate server-side.
- **Impact of exploitation:**
  - Users can bypass locked issue restrictions and post comments.
  - Users can comment on confidential issues they are not authorized to access, potentially leading to information disclosure.
- **Attack vectors:**
  - The attack vector is a crafted POST request to the `/notes` endpoint.
- **Required attacker capabilities/position:**
  - The attacker needs to have the ability to comment on at least one public issue in the target project.
  - The attacker needs to be able to intercept and modify HTTP requests (e.g. using a proxy like Burp Suite).
  - To comment on locked issues, the attacker needs to know the `noteable_id` of the target issue.
  - To comment on confidential issues, the attacker also needs to discover the `noteable_id` of that issue. This is slightly harder since it is not visible to unauthorized users.