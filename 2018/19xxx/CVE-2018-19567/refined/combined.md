=== Content from seclists.org_d55bb09f_20250124_231646.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](170)
[By Date](date.html#171)
[![Next](/images/right-icon-16x16.png)](172)

[![Previous](/images/left-icon-16x16.png)](168)
[By Thread](index.html#171)
[![Next](/images/right-icon-16x16.png)](175)

![](/shared/images/nst-icons.svg#search)

# Re: Crashes and memory safety bugs in dcraw

---

*From*: Ian Zimmerman <itz () very loosely org>

*Date*: Fri, 23 Nov 2018 09:17:43 -0800

---

```
On 2018-11-23 09:22, Hanno Böck wrote:

```
> ```
> dcraw is a tool to process raw images from digital cameras.
> It easily crashes with various issues (tested version 9.28.0). This was
> very shallow testing (afl fuzzing with random inputs, not starting with
> valid images), I assume there's much more. I reported those a long time
> ago to its author, he didn't seem interested in fixing such issues.
>
> Some applications use dcraw automatically to parse images (gthumb,
> kphotoalbum, kde thumbnailers, gwenview).
>
> ```

```

An important side note: because dcraw intentionally doesn't provide a
library, only an executable, code from it is bundled in at least some
applications that use it; thus updating the dcraw package in a distro
will not by itself be the end of this problem for the distro.  One such
application : RawTherapee

--
Please don't Cc: me privately on mailing lists and Usenet,
if you also post the followup to the list or newsgroup.
To reply privately _only_ on Usenet and on broken lists
which rewrite From, fetch the TXT record for no-use.mooo.com.

```

---

[![Previous](/images/left-icon-16x16.png)](170)
[By Date](date.html#171)
[![Next](/images/right-icon-16x16.png)](172)

[![Previous](/images/left-icon-16x16.png)](168)
[By Thread](index.html#171)
[![Next](/images/right-icon-16x16.png)](175)

### Current thread:

* [Crashes and memory safety bugs in dcraw](165) *Hanno Böck (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](166) *Agostino Sarubbo (Nov 23)*
    - [Re: Crashes and memory safety bugs in dcraw](167) *Hanno Böck (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](168) *Marcus Meissner (Nov 23)*
  + **Re: Crashes and memory safety bugs in dcraw** *Ian Zimmerman (Nov 23)*
    - [Re: Re: Crashes and memory safety bugs in dcraw](175) *Bob Friesenhahn (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](184) *Marcus Meissner (Nov 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_3ac0dfae_20250124_231646.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](164)
[By Date](date.html#165)
[![Next](/images/right-icon-16x16.png)](166)

[![Previous](/images/left-icon-16x16.png)](201)
[By Thread](index.html#165)
[![Next](/images/right-icon-16x16.png)](166)

![](/shared/images/nst-icons.svg#search)

# Crashes and memory safety bugs in dcraw

---

*From*: Hanno Böck <hanno () hboeck de>

*Date*: Fri, 23 Nov 2018 09:22:17 +0100

---

```
Hi,

dcraw is a tool to process raw images from digital cameras.
It easily crashes with various issues (tested version 9.28.0). This was
very shallow testing (afl fuzzing with random inputs, not starting with
valid images), I assume there's much more. I reported those a long time
ago to its author, he didn't seem interested in fixing such issues.

Some applications use dcraw automatically to parse images (gthumb,
kphotoalbum, kde thumbnailers, gwenview).

Input samples are base64.

Segfault / memory read on invalid address in crop_masked_pixels
---------------------------------------------------------------

TU0wMIEwMDAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMIX/MDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMLTCMDAw
MDAwAAAAMDAwMDAwMDAwMDAwMMaN

==6511==ERROR: AddressSanitizer: SEGV on unknown address 0x7fa0aa2ad79e (pc 0x0000005992fe bp 0x7ffdd236bb50 sp
0x7ffdd236b9e0 T0)
==6511==The signal is caused by a READ memory access.
    #0 0x5992fd in crop_masked_pixels /mnt/ram/dcraw/dcraw.c:3775:20
    #1 0x668a33 in main /mnt/ram/dcraw/dcraw.c:10406:7
    #2 0x7fa05f3264ca in __libc_start_main (/lib64/libc.so.6+0x234ca)
    #3 0x41c629 in _start (/mnt/ram/dcraw/a.out+0x41c629)

Heap out of bounds read in parse_tiff_ifd
-----------------------------------------

TU0wMIAwMDAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMMUWMDAAAAA=

==6729==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61100000013f at pc 0x00000043690d bp 0x7ffeaaba2270
sp 0x7ffeaaba1a18
READ of size 256 at 0x61100000013f thread T0
    #0 0x43690c in __interceptor_index (/mnt/ram/dcraw/a.out+0x43690c)
    #1 0x5ec1d1 in parse_tiff_ifd /mnt/ram/dcraw/dcraw.c:6014:46
    #2 0x60cc64 in parse_tiff /mnt/ram/dcraw/dcraw.c:6193:9
    #3 0x63d0d6 in identify /mnt/ram/dcraw/dcraw.c:8674:16
    #4 0x666eab in main /mnt/ram/dcraw/dcraw.c:10252:15
    #5 0x7f1ec0bfc4ca in __libc_start_main (/lib64/libc.so.6+0x234ca)
    #6 0x41c629 in _start (/mnt/ram/dcraw/a.out+0x41c629)

0x61100000013f is located 0 bytes to the right of 255-byte region [0x611000000040,0x61100000013f)
allocated by thread T0 here:
    #0 0x4c6b23 in malloc (/mnt/ram/dcraw/a.out+0x4c6b23)
    #1 0x5ec070 in parse_tiff_ifd /mnt/ram/dcraw/dcraw.c:6012:24
    #2 0x60cc64 in parse_tiff /mnt/ram/dcraw/dcraw.c:6193:9
    #3 0x63d0d6 in identify /mnt/ram/dcraw/dcraw.c:8674:16
    #4 0x666eab in main /mnt/ram/dcraw/dcraw.c:10252:15
    #5 0x7f1ec0bfc4ca in __libc_start_main (/lib64/libc.so.6+0x234ca)

Invalid memory read in crop_masked_pixels
-----------------------------------------

TU0wMIEwMDAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMIX/MDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMLTCMDAw
MDAwAAAAMDAwMDAwMDAwMDAwMMaN

==6893==ERROR: AddressSanitizer: SEGV on unknown address 0x7f5514dad79e (pc 0x0000005992fe bp 0x7ffc83994ad0 sp
0x7ffc83994960 T0)
==6893==The signal is caused by a READ memory access.
    #0 0x5992fd in crop_masked_pixels /mnt/ram/dcraw/dcraw.c:3775:20
    #1 0x668a33 in main /mnt/ram/dcraw/dcraw.c:10406:7
    #2 0x7f54c9df64ca in __libc_start_main (/lib64/libc.so.6+0x234ca)
    #3 0x41c629 in _start (/mnt/ram/dcraw/a.out+0x41c629)

floating point exception / segfault in parse_tiff_ifd
-----------------------------------------------------

TU0wMIAwMDAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMP0JMDAAAAAA

==6910==ERROR: AddressSanitizer: FPE on unknown address 0x0000005f70ee (pc 0x0000005f70ee bp 0x7ffc259155f0 sp
0x7ffc259142a0 T0)
    #0 0x5f70ed in parse_tiff_ifd /mnt/ram/dcraw/dcraw.c:6055:43
    #1 0x60cc64 in parse_tiff /mnt/ram/dcraw/dcraw.c:6193:9
    #2 0x63d0d6 in identify /mnt/ram/dcraw/dcraw.c:8674:16
    #3 0x666eab in main /mnt/ram/dcraw/dcraw.c:10252:15
    #4 0x7fc98bd024ca in __libc_start_main (/lib64/libc.so.6+0x234ca)
    #5 0x41c629 in _start (/mnt/ram/dcraw/a.out+0x41c629)

floating point exception in kodac_radc_load_raw
-----------------------------------------------

UFhOAA==

==6919==ERROR: AddressSanitizer: FPE on unknown address 0x00000054e85e (pc 0x00000054e85e bp 0x7fffc0b15150 sp
0x7fffc0b10be0 T0)
    #0 0x54e85d in kodak_radc_load_raw /mnt/ram/dcraw/dcraw.c:2272:34
    #1 0x6687ad in main /mnt/ram/dcraw/dcraw.c:10395:10
    #2 0x7f8f61ecf4ca in __libc_start_main (/lib64/libc.so.6+0x234ca)
    #3 0x41c629 in _start (/mnt/ram/dcraw/a.out+0x41c629)

--
Hanno Böck
<https://hboeck.de/>

mail/jabber: hanno () hboeck de
GPG: FE73757FA60E4E21B937579FA5880072BBB51E42

```

---

[![Previous](/images/left-icon-16x16.png)](164)
[By Date](date.html#165)
[![Next](/images/right-icon-16x16.png)](166)

[![Previous](/images/left-icon-16x16.png)](201)
[By Thread](index.html#165)
[![Next](/images/right-icon-16x16.png)](166)

### Current thread:

* **Crashes and memory safety bugs in dcraw** *Hanno Böck (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](166) *Agostino Sarubbo (Nov 23)*
    - [Re: Crashes and memory safety bugs in dcraw](167) *Hanno Böck (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](168) *Marcus Meissner (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](171) *Ian Zimmerman (Nov 23)*
    - [Re: Re: Crashes and memory safety bugs in dcraw](175) *Bob Friesenhahn (Nov 23)*
  + [Re: Crashes and memory safety bugs in dcraw](184) *Marcus Meissner (Nov 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


