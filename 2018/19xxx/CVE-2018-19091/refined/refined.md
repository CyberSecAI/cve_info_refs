The provided content describes multiple XSS vulnerabilities in the tianti project.

**Root Cause of Vulnerability:**
The root cause is the lack of proper input sanitization and output encoding in multiple modules of the application. User-provided data is directly included in the HTML output without any escaping, leading to XSS.

**Weaknesses/Vulnerabilities:**
1. **Stored XSS in userlist module:** User-provided data for role names and descriptions is stored in the database and then displayed on the user list page without proper sanitization.
2.  **Stored XSS in article management module:** User-provided data in the article management module is stored and displayed without proper sanitization.
3.  **Reflected XSS in usermanagement module:** User-provided input is reflected back in the HTML output on the user list page without proper sanitization when searching for users by keyword.

**Impact of Exploitation:**
*   **Cookie Disclosure:** An attacker can steal user cookies by injecting JavaScript code that accesses `document.cookie`, potentially leading to session hijacking.
*   **Escalation of Privileges:** By stealing cookies of administrative users, an attacker can escalate privileges and gain unauthorized access to sensitive functionalities and data within the application.
*   **Arbitrary JavaScript Execution:** An attacker can execute arbitrary JavaScript in the context of the victim's browser, potentially leading to account compromise, data theft, and other malicious activities.

**Attack Vectors:**
1.  **Userlist module (stored XSS):**
    *   Attacker sends a crafted POST request to `/tianti-module-admin/user/ajax/save_role` with a malicious payload in the `name` field. This payload is stored in the database.
    *   When an admin user views the user list page, the malicious payload is rendered, executing the injected script.
2.  **Article management module (stored XSS):**
    *   Attacker injects a malicious payload into a field within the article management module.
    *   When other users view the affected content, the malicious payload is rendered and executed.
3.  **Usermanagement module (reflected XSS):**
    *   Attacker sends a crafted POST request to `/tianti-module-admin/user/list` with a malicious payload in the `userName` field.
    *   The server includes this unsanitized payload in the response, which is then rendered by the victim's browser, executing the injected script.

**Required Attacker Capabilities/Position:**
*   Attacker needs to be able to interact with the application either by having an authenticated session or by sending unauthenticated requests to the vulnerable endpoints.
*   For stored XSS, the attacker would need to have the ability to add or modify roles/articles.
*   For reflected XSS, the attacker would need to lure a user into clicking a crafted link or form, sending the malicious payload.