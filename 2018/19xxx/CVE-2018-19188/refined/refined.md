Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

The root cause of the vulnerability is insufficient input validation and sanitization of user-supplied data within the Payfort PHP SDK. Specifically, the SDK directly echoes user-provided parameters in several PHP files without proper encoding or sanitization.

**Weaknesses/Vulnerabilities:**

*   **Reflected Cross-Site Scripting (XSS):** The primary vulnerability is reflected XSS, occurring in `success.php`, `route.php` and `error.php`. These files directly output user-controlled input via the `$_REQUEST` array without sanitization or encoding.
*   The code in `success.php` at line 16, and lines 36, `error.php` at lines 19 and 40, and in `route.php` at line 12,  is vulnerable to XSS.

**Impact of Exploitation:**

*   An attacker can inject malicious JavaScript code into the pages by crafting specific URLs or POST requests with malicious parameters.
*   If a victim clicks on the crafted link, the malicious script executes in the victim's browser within the context of the vulnerable web application. This can allow the attacker to:
    *   Steal cookies or session tokens
    *   Hijack user sessions
    *   Rewrite page content
    *   Potentially capture sensitive information entered by the user
    *  Redirect the user to a malicious site

**Attack Vectors:**

*   **GET Request:** Attacker crafts a malicious URL with XSS payload in the `fort_id` parameter for `success.php`, the `error_msg` parameter for `error.php` or any parameter name/value for both `success.php` and `error.php`.
*   **POST Request:** Attacker sends a malicious POST request to `route.php` with XSS payload in the `paymentMethod` parameter.

**Required Attacker Capabilities/Position:**

*   The attacker must be able to craft and send malicious HTTP GET or POST requests to the vulnerable web application.
*   The attacker needs to induce a user to access the crafted malicious URL or submit the malicious POST request to trigger the XSS payload.

**Additional Information:**

*   The vulnerability is present in the Payfort PHP SDK and could affect any business implementing the SDK.
*   The vulnerable code is present in the simulator pages for developers. The developers acknowledged the vulnerability, but stated that the pages are only for developers, not realizing the pages are publicly accessible.
*   The issue was reported to PayFort in Feb 2017 and later to Amazon's Security team, with confirmation of a fix.
*   The vulnerable SDK version is based on GitHub commit `703c96f` from April 26.

This content provides more detail than the basic CVE description, including the specific vulnerable files, lines of code, and attack vectors, as well as a proof of concept exploit for each.