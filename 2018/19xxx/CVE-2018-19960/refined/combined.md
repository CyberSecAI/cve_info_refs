=== Content from security-tracker.debian.org_58d61964_20250126_012414.html ===

# CVE-2018-19960

| **Name** | CVE-2018-19960 |
| --- | --- |
| **Description** | The debug\_mode function in web/web.py in OnionShare through 1.3.1, when --debug is enabled, uses the /tmp/onionshare\_server.log pathname for logging, which might allow local users to overwrite files or obtain sensitive information by using this pathname. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2018-19960) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-19960); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2018-19960), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2018-19960), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2018-19960), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2018-19960), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-19960), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2018-19960), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2018-19960), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2018-19960)/[CVE](https://www.suse.com/security/cve/CVE-2018-19960/), GitHub [advisories](https://github.com/advisories?query=CVE-2018-19960)/[code](https://github.com/search?type=Code&q=%22CVE-2018-19960%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2018-19960%22), [web search](https://duckduckgo.com/html?q=%22CVE-2018-19960%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [915859](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=915859) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [onionshare](/tracker/source-package/onionshare) ([PTS](https://tracker.debian.org/pkg/onionshare)) | bullseye | 2.2-3+deb11u2 | fixed |
|  | bookworm | 2.6-5~deb12u1 | fixed |
|  | sid, trixie | 2.6.2-4 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [onionshare](/tracker/source-package/onionshare) | source | (unstable) | 1.3.2-1 | unimportant |  | [915859](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=915859) |

## Notes

```
[jessie] - onionshare <no-dsa> (contrib not supported)
<https://github.com/micahflee/onionshare/issues/837>
Negligible (and disputable) security impact, as the debug mode is not enabled by default

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_230e659c_20250124_135018.html ===

# Debian Bug report logs - #915859 uses a fixed filename in /tmp

[![version graph](version.cgi?fixed=onionshare%2F1.3.2-1;width=2;found=onionshare%2F1.3-1;absolute=0;height=2;package=onionshare;collapse=1)](version.cgi?fixed=onionshare%2F1.3.2-1;found=onionshare%2F1.3-1;absolute=0;info=1;package=onionshare;collapse=1)

Package:
[onionshare](pkgreport.cgi?package=onionshare);
Maintainer for [onionshare](pkgreport.cgi?package=onionshare) is [Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>](pkgreport.cgi?maint=pkg-privacy-maintainers%40lists.alioth.debian.org); Source for [onionshare](pkgreport.cgi?package=onionshare) is [src:onionshare](pkgreport.cgi?src=onionshare) ([PTS](https://tracker.debian.org/pkg/onionshare), [buildd](https://buildd.debian.org/onionshare), [popcon](https://qa.debian.org/popcon.php?package=onionshare)).

Reported by: [Peter Palfrader <weasel@debian.org>](pkgreport.cgi?submitter=weasel%40debian.org)

Date: Fri, 7 Dec 2018 11:42:01 UTC

Severity: *grave*

Tags: security, upstream

Found in version onionshare/1.3-1

Fixed in version onionshare/1.3.2-1

**Done:** Ulrike Uhlig <ulrike@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <https://github.com/micahflee/onionshare/issues/837>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=915859;mbox=yes), [status mbox](bugreport.cgi?bug=915859;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=915859;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`:

`Bug#915859`; Package `onionshare`.
(Fri, 07 Dec 2018 11:42:04 GMT) ([full text](bugreport.cgi?bug=915859;msg=2), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Peter Palfrader <weasel@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`.
(Fri, 07 Dec 2018 11:42:04 GMT) ([full text](bugreport.cgi?bug=915859;msg=4), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=5), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=weasel%40debian.org)
From: Peter Palfrader <weasel@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: uses a fixed filename in /tmp
Date: Fri, 7 Dec 2018 11:40:00 +0000
```
Package: onionshare
Version: 1.3-1
Severity: grave
Tags: security

onionshare uses /tmp/onionshare_server.log as a logfile with --debug.

in onionshare/web.py:
| def debug_mode():
|     temp_dir = tempfile.gettempdir()
|     log_handler = logging.FileHandler(
|         os.path.join(temp_dir, 'onionshare_server.log'))

tempfile.gettempdir() returns /tmp.  It does not give you a
dedicated temp-directory.  It is not mkdtemp.

--
                            |  .''`.       ** Debian **
      Peter Palfrader       | : :' :      The  universal
 <https://www.palfrader.org/> | `. `'      Operating System
                            |   `-    <https://www.debian.org/>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`:

`Bug#915859`; Package `onionshare`.
(Fri, 07 Dec 2018 12:09:06 GMT) ([full text](bugreport.cgi?bug=915859;msg=7), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `intrigeri <intrigeri@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`.
(Fri, 07 Dec 2018 12:09:06 GMT) ([full text](bugreport.cgi?bug=915859;msg=9), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 915859@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=10), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=intrigeri%40debian.org)
From: intrigeri <intrigeri@debian.org>
To: Peter Palfrader <weasel@debian.org>, 915859@bugs.debian.org
Subject: Re: [Pkg-privacy-maintainers] Bug#915859: uses a fixed filename in /tmp
Date: Fri, 07 Dec 2018 13:04:57 +0100
```
Hi,

Peter Palfrader:
> onionshare uses /tmp/onionshare_server.log as a logfile with --debug.

Good catch!

While that code obviously conflicts with basic secure programming best
practices, it seems to me that the default settings of the
fs.protected_symlinks and fs.protected_hardlinks sysctls protect
Debian users against exploitation, so I find RC severity hard to
justify given this only affects users who manually pass --debug under
a non-default sysctl/kernel configuration.

In any case, this should be fixed :)

Cheers,
--
intrigeri

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`:

`Bug#915859`; Package `onionshare`.
(Fri, 07 Dec 2018 12:09:07 GMT) ([full text](bugreport.cgi?bug=915859;msg=12), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Peter Palfrader <weasel@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`.
(Fri, 07 Dec 2018 12:09:07 GMT) ([full text](bugreport.cgi?bug=915859;msg=14), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 915859@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=15), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=weasel%40debian.org)
From: Peter Palfrader <weasel@debian.org>
To: intrigeri <intrigeri@debian.org>
Cc: 915859@bugs.debian.org
Subject: Re: [Pkg-privacy-maintainers] Bug#915859: uses a fixed filename in
/tmp
Date: Fri, 7 Dec 2018 12:06:38 +0000
```
On Fri, 07 Dec 2018, intrigeri wrote:

> Hi,
>
> Peter Palfrader:
> > onionshare uses /tmp/onionshare_server.log as a logfile with --debug.
>
> Good catch!
>
> While that code obviously conflicts with basic secure programming best
> practices, it seems to me that the default settings of the
> fs.protected_symlinks and fs.protected_hardlinks sysctls protect
> Debian users against exploitation, so I find RC severity hard to
> justify given this only affects users who manually pass --debug under
> a non-default sysctl/kernel configuration.
>
> In any case, this should be fixed :)

In addition to the security issues of bad tempfile handling, it causes
onionshare to break for me as on this system several users run
onionshare.

--
                            |  .''`.       ** Debian **
      Peter Palfrader       | : :' :      The  universal
 <https://www.palfrader.org/> | `. `'      Operating System
                            |   `-    <https://www.debian.org/>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`:

`Bug#915859`; Package `onionshare`.
(Fri, 07 Dec 2018 15:54:04 GMT) ([full text](bugreport.cgi?bug=915859;msg=17), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`.
(Fri, 07 Dec 2018 15:54:04 GMT) ([full text](bugreport.cgi?bug=915859;msg=19), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 915859@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=20), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Peter Palfrader <weasel@debian.org>, 915859@bugs.debian.org
Cc: intrigeri <intrigeri@debian.org>
Subject: Re: Bug#915859: [Pkg-privacy-maintainers] Bug#915859: uses a fixed
filename in /tmp
Date: Fri, 7 Dec 2018 16:51:05 +0100
```
Conrol: retitle -1 onionshare: [CVE-2018-19960](https://security-tracker.debian.org/tracker/CVE-2018-19960): uses a fixed filename in /tmp

Hi,

So it will additionally allow potentially denial of service on
multi-user systems.

Not sure if the grave severity is warranted, though, will leave this
discussion to you both :)

For tracking the issue, I have requested a CVE from MITRE, which got
assigned [CVE-2018-19960](https://security-tracker.debian.org/tracker/CVE-2018-19960).

Regards,
Salvatore

```

---

**Added tag(s) upstream.**
Request was from `Ulrike Uhlig <ulrike@debian.org>`
to `control@bugs.debian.org`.
(Tue, 11 Dec 2018 10:45:09 GMT) ([full text](bugreport.cgi?bug=915859;msg=22), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=22), [link](#21)).

---

**Set Bug forwarded-to-address to '<https://github.com/micahflee/onionshare/issues/837>'.**
Request was from `Ulrike Uhlig <ulrike@debian.org>`
to `control@bugs.debian.org`.
(Tue, 11 Dec 2018 10:45:09 GMT) ([full text](bugreport.cgi?bug=915859;msg=24), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=24), [link](#23)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`:

`Bug#915859`; Package `onionshare`.
(Wed, 12 Dec 2018 15:51:03 GMT) ([full text](bugreport.cgi?bug=915859;msg=26), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `ulrike@debian.org`:

Extra info received and forwarded to list. Copy sent to `Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>`.
(Wed, 12 Dec 2018 15:51:03 GMT) ([full text](bugreport.cgi?bug=915859;msg=28), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 915859@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=29), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=ulrike%40debian.org)
From: Ulrike Uhlig <ulrike@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 915859@bugs.debian.org,
Peter Palfrader <weasel@debian.org>
Subject: Re: Bug#915859: [Pkg-privacy-maintainers] Bug#915859: uses a fixed
filename in /tmp
Date: Wed, 12 Dec 2018 15:49:00 +0000
```
Hi!

Salvatore Bonaccorso:

> So it will additionally allow potentially denial of service on
> multi-user systems.
>
> Not sure if the grave severity is warranted, though, will leave this
> discussion to you both :)

Ack, grave sounds a bit grave.

> For tracking the issue, I have requested a CVE from MITRE, which got
> assigned [CVE-2018-19960](https://security-tracker.debian.org/tracker/CVE-2018-19960).

Thank you.

I've asked upstream to fix it yesterday, and they did. So I'll upload a
newer version of onionshare a bit later this week (probably not today
though).

Cheers!
u.

```

---

**Reply sent**
to `Ulrike Uhlig <ulrike@debian.org>`:

You have taken responsibility.
(Thu, 13 Dec 2018 16:21:03 GMT) ([full text](bugreport.cgi?bug=915859;msg=31), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=31), [link](#30)).

---

**Notification sent**
to `Peter Palfrader <weasel@debian.org>`:

Bug acknowledged by developer.
(Thu, 13 Dec 2018 16:21:03 GMT) ([full text](bugreport.cgi?bug=915859;msg=33), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=33), [link](#32)).

---

[Message #34](#34) received at 915859-close@bugs.debian.org ([full text](bugreport.cgi?bug=915859;msg=34), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=34), reply):

![](/cgi-bin/libravatar.cgi?email=ulrike%40debian.org)
From: Ulrike Uhlig <ulrike@debian.org>
To: 915859-close@bugs.debian.org
Subject: Bug#915859: fixed in onionshare 1.3.2-1
Date: Thu, 13 Dec 2018 16:20:07 +0000
```
Source: onionshare
Source-Version: 1.3.2-1

We believe that the bug you reported is fixed in the latest version of
onionshare, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 915859@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Ulrike Uhlig <ulrike@debian.org> (supplier of updated onionshare package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 13 Dec 2018 16:20:37 +0100
Source: onionshare
Binary: onionshare
Architecture: source all
Version: 1.3.2-1
Distribution: unstable
Urgency: medium
Maintainer: Debian Privacy Tools Maintainers <pkg-privacy-maintainers@lists.alioth.debian.org>
Changed-By: Ulrike Uhlig <ulrike@debian.org>
Description:
 onionshare - Share a file over Tor Hidden Services anonymously and securely
Closes: [915859](bugreport.cgi?bug=915859)
Changes:
 onionshare (1.3.2-1) unstable; urgency=medium
 .
   * New upstream version. (Closes: #[915859](bugreport.cgi?bug=915859).)
     - In debug mode, stop saving flask debug log in /tmp, where all users can
       access it
     - Updated Tor to 0.2.3.10.
   * debian/README.source:
     - Improve instructions for updating and building this package.
   * debian/gbp.conf:
     - Improve rules.
   * debian/rules:
     - Adapt.
Checksums-Sha1:
 83ec2c6d3765cf4e59af5e0ba8d76a7150c41689 2170 onionshare_1.3.2-1.dsc
 e0ddce8e92ea21a745fe40998acdf01c94696657 436856 onionshare_1.3.2.orig.tar.gz
 86c5f0cd693d00b4477094e41005f79214bee566 5676 onionshare_1.3.2-1.debian.tar.xz
 0f9d47d1a3fd2917e2a73260f4c7e199665432be 104636 onionshare_1.3.2-1_all.deb
 a4bcdc442319cb9840baf5d37e05928136168169 12724 onionshare_1.3.2-1_amd64.buildinfo
Checksums-Sha256:
 f94d730256a589d6430f8d5d8b6bd1f3b263509c416b14f5ee4c5af2e0c09865 2170 onionshare_1.3.2-1.dsc
 deb6d2c25a9c0fdb0f37d9ab38a168b028256a4b6015fe6b678224bf33465042 436856 onionshare_1.3.2.orig.tar.gz
 e2c5b6a0c94d7fffbe62b25d3ef3df3dd325a456d2d9dfd385b9f0bdf751961b 5676 onionshare_1.3.2-1.debian.tar.xz
 65dbf0c079a084c2c649cd84cd20d472110fdced0690c90e36f640bb5176578f 104636 onionshare_1.3.2-1_all.deb
 f45976b955b7af2bbaea1ea6f746f4a7168c64ffcea9f98f71f02306f1b5d329 12724 onionshare_1.3.2-1_amd64.buildinfo
Files:
 0f60ecbae30490e0da13557ee9cb72c0 2170 net optional onionshare_1.3.2-1.dsc
 5316de2e366a9c9cd182742f995276f5 436856 net optional onionshare_1.3.2.orig.tar.gz
 0ed8aec88224caddad674438bf1e9c66 5676 net optional onionshare_1.3.2-1.debian.tar.xz
 900fbcd2e2673be0262533391f7a2c37 104636 net optional onionshare_1.3.2-1_all.deb
 b355a507e99549774af95e3c828e80d1 12724 net optional onionshare_1.3.2-1_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQJGBAEBCgAwFiEE7eP0RD800mGVFNeQsUuww42GHPEFAlwSfuYSHHVscmlrZUBk
ZWJpYW4ub3JnAAoJELFLsMONhhzx8e0P+we2TO5xvW1gfcI5DVdqI5TtpklXxLmj
k5wRSCj9I+MxzoHfoqyxJIJ3psJQFG7mJBCMtvcTFq12YOPu7m2efckq/vzd5upu
VrQbnrytzPKkZAD7FXtH4CWQzXq2IKjsPJGehNyED+bzl6ATx8Oa4cbW0dv1n4jP
A7RaSdOZsko+FUuFUMMuodwHz3+XjQN7cw5mYOTiTDJXj/XaItVgo9M8Hb5R32vx
6fd9tEAITn9y7LFiUOzTmEbB2yyWSKg5zFXdM0HRnyWAZqirVqOvc1y5SMIygWe0
j+uGKx+GNaUrECQJExc0/zQEYPajmx8128ntIvFYdEdQLD4nsezV9JT3UQtcas6q
na6ETCFFI0pwrvmT/uIGDO1ugYPrReXRm5LpW7tpOgAcJ0TmdmoI9s7A9FYPmA9W
eJMtgMeCnwUdN8syb81PAb/Fk0QECIbm4FVPU+Vz/4TsqGSHZuDNMeXBFCKCccOt
N11HhdMBDSpn9acbB5XyBWvplSSNfc4sVSXBMdO1PaHGujKc/5mGNdaM4GJnDCZX
rpqafVBOgeVzcdDpevLxBBIht9vw+ZL4URq0nk6ZEmTgMcGaU5MTKBJutcKacziq
88YkiAtZPgNeNcS5fYMjhOPQbhR6iuSUvPkEKoOG/PS9t3gEr5sfbwsEmADXqMb4
DJP5F7WJPmK7
=BUFT
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 16 Jan 2019 07:29:17 GMT) ([full text](bugreport.cgi?bug=915859;msg=36), [mbox](bugreport.cgi?bug=915859;mbox=yes;msg=36), [link](#35)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=915859).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 13:50:18 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


