=== Content from gitlab.com_6d1e27a1_20250125_060516.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ee' was moved to 'gitlab-org/gitlab'. Please update any links and bookmarks that may still have the old path.

# SSRF in Prometheus integration

**[HackerOne report #427364](https://hackerone.com/reports/427364)** by bull on 2018-10-23:

Hi,

I have found an issue which can be used by an attacker to make internal request to localhost i.e 127.0.0.1 and all local ip range.

# Issue:

So the problem here is it blocks localhost url input, but providing external links and if it redirects, the gitlab doesn't make any check after redirect and make request to internal network. i can also evade path with `#`

# POC:

* log into gitlab and create project and go to integrations
* now go to the prometheus integration and enter in the api url `http://bullbucket.s3-website-us-east-1.amazonaws.com/scuscscnhfdfssadqdq` which redirects to `http://127.0.0.1:12345/ssrf/dbvdbhvdb/local#`
* open netcat at port `12345` in gitlab ee to check if request is really made to internal network or not.

[Screen\_Recording\_2018-10-23\_at\_8.14.36\_PM.mov](https://user-content.gitlab-static.net/2b408e79152a3a2717a0015f1b4bedaf45532b4e/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3432373336342f3336343836302f53637265656e5f5265636f7264696e675f323031382d31302d32335f61745f382e31342e33365f504d2e6d6f76 "Download 'Screen_Recording_2018-10-23_at_8.14.36_PM.mov'")

Please let me know if you need any more information or if i missed something
Thanks
[@bull](/bull "PB")

## Impact

access to internal services

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Recording\_2018-10-23\_at\_8.14.36\_PM.mov](https://h1.sec.gitlab.net/a/427364/364860/Screen_Recording_2018-10-23_at_8.14.36_PM.mov)

## Fix

Security issue: <https://dev.gitlab.org/gitlab/gitlabhq/issues/2736>

Edited Nov 15, 2018 by [Reuben Pereira](/rpereira2)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


