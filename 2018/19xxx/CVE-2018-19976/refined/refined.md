```
{
  "vulnerability": {
    "CVE": "CVE-2018-19976",
    "description": "In YARA 3.8.1, bytecode in a specially crafted compiled rule is exposed to information about its environment, in libyara/exec.c. This is a consequence of the design of the YARA virtual machine.",
    "affected_versions": "YARA 3.8.1",
    "patched_versions": ">= 3.10.0",
    "references": [
      "https://nvd.nist.gov/vuln/detail/CVE-2018-19976",
      "https://github.com/VirusTotal/yara/issues/999",
      "https://bnbdr.github.io/posts/extracheese/",
      "https://github.com/bnbdr/swisscheese/",
        "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DFFXDAMP6GJ337LIOTVF5I4T6QGMN3ZR/"
    ],
      "weaknesses": [
        "CWE-200"
      ],
    "cvss_score": "5.5",
    "attack_vector": "Local",
    "attack_complexity": "Low",
    "privileges_required": "None",
    "user_interaction": "Required",
    "scope": "Unchanged",
      "confidentiality_impact": "High",
    "integrity_impact": "None",
      "availability_impact": "None",
    "epss_score": "0.091%"

  },
  "technical_details": {
    "root_cause": "The design of the YARA virtual machine (yvm) allows compiled bytecode to access information about its environment, specifically due to the way `yobj` pointers are handled.",
      "vulnerabilities": [
          "Information exposure through the design of YARA's virtual machine (yvm). Loading a `yobj` to the stack exposes its pointer, which an attacker can manipulate using arithmetic opcodes to point to arbitrary memory locations.",
           "The lack of checks in the OP_COUNT opcode, allowing to read a DWORD from an arbitrary address pointed to by a manipulated `yobj`.",
           "Uninitialized virtual memory (`vmem`) can leak addresses from the real stack."
      ],
    "impact": "A specially crafted, malicious compiled YARA rule can leverage the described vulnerabilities to leak information, potentially arbitrary addresses from memory.",
    "attack_vector": "Local: An attacker needs to provide a malicious compiled YARA rule to a vulnerable system.",
    "attacker_capabilities": "An attacker needs to be able to craft a malicious compiled YARA rule. They do not need any privileges and user interaction is required.",
      "additional_information": "The YARA virtual machine uses a stack (vstack) and a small scratch memory (vmem). The bytecode has several core types of yvals (int64, double, pointer, object, match-string, string, regex). The object type corresponds to the YR_OBJECT struct, used for named objects exposed by yvm and its modules. Modules can export functions for the bytecode to call. `PARANOID_EXEC` was introduced to mitigate maliciously compiled bytecode by adding boundary checks but it did not address the info-leak."
  }
}
```