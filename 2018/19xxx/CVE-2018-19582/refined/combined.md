=== Content from gitlab.com_a8b254a0_20250125_180128.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

Project 'gitlab-org/gitlab-ee' was moved to 'gitlab-org/gitlab'. Please update any links and bookmarks that may still have the old path.

# IDOR at /drafts/publish/

**[HackerOne report #429908](https://hackerone.com/reports/429908)** by lucky\_sen on 2018-10-28:

**Summary:** I found IDOR vulnerability at the endpoint `/drafts/publish` which enable me to publish unauthorised drafts.

**Description:**
There is a feature in discussion where we can save our review as draft and then publish it later. I notice that the `ID` parameter are not properly check before publish any draft review so i am able to publish any one draft review even there discussion are confidential and i don't have access on it .

## Steps To Reproduce:

1. Make 2 accounts A and B and create separate merge requests in both of them.
2. Make a draft review in both merge requests by clicking *Start a review*. Note down B's draft id from the response.
3. Go through A's account and publish a comment by clicking *Add comment now*.
4. Intercept the request and change the Id parameter with B's draft id. (B's draft successfully published)

## Supporting Material/References:

* [![Screenshot_2018-10-28_15_13_21.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/80c95fdb30c5b7aca65b7dd0888cd59df4e346e4/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3432393930382f3336373339382f53637265656e73686f745f323031382d31302d32385f31355f31335f32312e706e67)
* [![Screenshot_2018-10-28_15_13_36.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/04cb08467347fb08b166f8b9d40f1384d6d34160/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3432393930382f3336373339392f53637265656e73686f745f323031382d31302d32385f31355f31335f33362e706e67)
* [![Screenshot_2018-10-28_15_13_49.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/075396cfb4311ad2652db93dad22750e289a1781/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f3432393930382f3336373430302f53637265656e73686f745f323031382d31302d32385f31355f31335f34392e706e67)

## Impact

Attacker are able to publish some one confidential draft with out any authentication.

***Thanks!***

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2018-10-28\_15\_13\_49.png](https://h1.sec.gitlab.net/a/429908/367400/Screenshot_2018-10-28_15_13_49.png)
* [Screenshot\_2018-10-28\_15\_13\_36.png](https://h1.sec.gitlab.net/a/429908/367399/Screenshot_2018-10-28_15_13_36.png)
* [Screenshot\_2018-10-28\_15\_13\_21.png](https://h1.sec.gitlab.net/a/429908/367398/Screenshot_2018-10-28_15_13_21.png)

Edited Oct 29, 2018 by [Dennis Appelt](/dappelt)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


