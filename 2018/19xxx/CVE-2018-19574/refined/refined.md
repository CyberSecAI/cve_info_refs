- **Root cause of vulnerability**: The application allows arbitrary protocols in the callback URLs for OAuth applications, specifically `javascript:` protocol.
- **Weaknesses/vulnerabilities present**: Reflected Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of a user's browser session when the user authorizes a malicious OAuth application. This could lead to session hijacking, data theft, or other malicious actions.
- **Attack vectors**: By crafting a malicious OAuth application with a `javascript:` protocol in the redirect URI, and tricking a user into authorizing the application. The crafted URL will be similar to `/oauth/authorize?client_id=[APP-ID]&redirect_uri=javascript://%250aalert(document.domain)&response_type=code&state=A` where [APP-ID] is the malicious application's ID
- **Required attacker capabilities/position**: The attacker needs to be able to create an OAuth application on the GitLab instance and needs to be able to trick the user into clicking on the OAuth authorization link.