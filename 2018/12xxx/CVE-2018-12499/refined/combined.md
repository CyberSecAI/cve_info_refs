=== Content from blog.sean-wright.com_5a8acf86_20250125_065923.html ===

 [Sean Wright](https://blog.sean-wright.com)

* [Home](https://blog.sean-wright.com/)
* [About Me](https://portfolio.sean-wright.com/)
* [Events](https://blog.sean-wright.com/events/)
* [Findings/Vulnerabilities](https://blog.sean-wright.com/findings/)
* [Videos](https://blog.sean-wright.com/videos/)
* [Talks](https://blog.sean-wright.com/talks/)
* [Media](https://blog.sean-wright.com/media/)

* [Security Resources](https://seanwrightsec.super.site/)
* [Resources](https://blog.sean-wright.com/resources/)
* [Authory](https://authory.com/seanwrightsec)
* [Analytics](https://plausible.io/blog.sean-wright.com)
* [Photography](https://photography.sean-wright.com/)
* [Recommendations](https://blog.sean-wright.com/recommendations/)

[Log In](/signin/)
[Subscribe](/signup/)

[Sign up](/signup/)
[Sign in](/signin/)
  Theme

* [Home](https://blog.sean-wright.com/)
* [About Me](https://portfolio.sean-wright.com/)
* [Events](https://blog.sean-wright.com/events/)
* [Findings/Vulnerabilities](https://blog.sean-wright.com/findings/)
* [Videos](https://blog.sean-wright.com/videos/)
* [Talks](https://blog.sean-wright.com/talks/)
* [Media](https://blog.sean-wright.com/media/)

* [Security Resources](https://seanwrightsec.super.site/)
* [Resources](https://blog.sean-wright.com/resources/)
* [Authory](https://authory.com/seanwrightsec)
* [Analytics](https://plausible.io/blog.sean-wright.com)
* [Photography](https://photography.sean-wright.com/)
* [Recommendations](https://blog.sean-wright.com/recommendations/)

Please enter at least 3 characters
0results found

https
certificate
vulnerability
tls
password
dns

# Motorola MBP853 - Certificate Validation Vulnerability (CVE-2018-12499)

![Motorola MBP853 - Certificate Validation Vulnerability (CVE-2018-12499)](/content/images/size/w100/2018/06/lens-490806_1920.jpg)

# Finding

**Date Published:** 22 June 2018

**CVE:** CVE-2018-12499

**CVSSv3 Base Score:** 7.4 ([CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS%3A3.0%2FAV%3AN%2FAC%3AH%2FPR%3AN%2FUI%3AN%2FS%3AU%2FC%3AH%2FI%3AH%2FA%3AN&ref=blog.sean-wright.com))

**Vendors Contacted:** Motorola

**Discovered By:** Sean Wright

## Summary

The Motorola MBP853 firmware does not correctly validate server certificates. This allows for a Man in The Middle (MiTM) attack to take place between a Motorola MBP853 camera and the servers which communicates with. In one such instance, it was identified that the device was downloading what appeared to be a client certificate to the device.

## Version Affected

This finding was found in the device with the model number MBP853CONNECT.

## Details

1. Startup Ettercap to ARPSpoof the device and obtain packets to and from the device:

   `sudo ettercap -T -i wlp58s0 -M arp:remote /192.168.0.163// ///`
2. Setup iptable rules to forward the appropriate traffic to BurpSuite

   `sudo iptables -t nat -A PREROUTING -i wlp58s0 -p tcp --dport 80 -j REDIRECT --to-port 8080 sudo iptables -t nat -A PREROUTING -i wlp58s0 -p tcp --dport 443 -j REDIRECT --to-port 8080 sudo iptables -t nat -A PREROUTING -i wlp58s0 -p tcp --dport 8883 -j REDIRECT --to-port 8080`
3. Configure BurpSuite to listen for the traffic

* In the Proxy tab, select the Options subtab and then select the current listener and click on the Edit button.

  ![Screenshot-from-2018-06-17-03-47-18](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-47-18.png)
* Set the Bind to address radio button to be All interfaces.

  ![Screenshot-from-2018-06-17-03-48-12](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-48-12.png)
* Click on the Request handling tab and check the Support invisible proxying checkbox.

  ![Screenshot-from-2018-06-17-03-48-42](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-48-42.png)
* Click on the OK button to accept the changes.

4. Start up the camera and monitor the BurpSuite Proxy's HTTP History subtab for traffic:

   ![Screenshot-from-2018-06-17-03-49-07](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-49-07.png)
5. Monitor the traffic logs for the request `https://hubble-resources.s3.amazonaws.com/mqtt-certificates/devices/<id>/client.key` and observe the private key in the response to the request:

   Request

   ![Screenshot-from-2018-06-17-03-50-20](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-50-20.png)

   Response

   ![Screenshot-from-2018-06-17-03-50-46](https://blog.sean-wright.com/content/images/2018/06/Screenshot-from-2018-06-17-03-50-46.png)
6. Confirm that a certificate is in the response to the request `https://hubble-resources.s3.amazonaws.com/mqtt-certificates/devices/<device-id>/client.crt`.

## CVSS 3

**CVSS Vector:** [CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS%3A3.0%2FAV%3AN%2FAC%3AH%2FPR%3AN%2FUI%3AN%2FS%3AU%2FC%3AH%2FI%3AH%2FA%3AN&ref=blog.sean-wright.com)

**Base Score:** 7.4

### Base Score Metrics

#### Exploitability Metrics

**Network Vector:** Network (AV:N)

**Attack Complexity:** High (AC:H)

**Privileges Required:** None (PR:N)

**User Interaction:** None (UI:N)

**Scope:** Unchanged (S:U)

#### Impact Metrics

**Confidentiality Impact:** High (C:H)

**Integrity Impact:** High (I:H)

**Availability Impact:** None (A:N)

# Resolution

Issue has yet to be resolved as of 22 June 2018.

# Vendor Notification

* 14 April 2018 - Initially contacted vendor.
* 27 April 2018 - No response received, requested update from vendor.
* 29 April 2018 - Received response from vendor requesting details of the issue.
* 8 May 2018 - Passed appropriate details on the vednor.
* 10 May 2018 - Vendor requested more detailed details about the issue.
* 11 May 2018 - Full details of the issue passed onto the vendor.
* 11 May 2018 - Vendor confirmed reciept of the details, stating that they would respond in a week.
* 19 May 2018 - Vendor sent update requesting for further patience on details from their technical team.
* 12 June 2018 - Requested update on the status of the issue.
* 18 June 2018 - Further request for update informing intentions of publishing the found issue.
* 22 June 2018 - Issue publicly published.

Sean Wright
Personal blog of application security advocate, blogging about application security related topics, focused primarily on web based applications.

Navigation

* [Home](https://blog.sean-wright.com/)
* [About Me](https://portfolio.sean-wright.com/)
* [Events](https://blog.sean-wright.com/events/)
* [Findings/Vulnerabilities](https://blog.sean-wright.com/findings/)
* [Videos](https://blog.sean-wright.com/videos/)
* [Talks](https://blog.sean-wright.com/talks/)
* [Media](https://blog.sean-wright.com/media/)

* [Security Resources](https://seanwrightsec.super.site/)
* [Resources](https://blog.sean-wright.com/resources/)
* [Authory](https://authory.com/seanwrightsec)
* [Analytics](https://plausible.io/blog.sean-wright.com)
* [Photography](https://photography.sean-wright.com/)
* [Recommendations](https://blog.sean-wright.com/recommendations/)

Subscribe

Subscribe

Great! Check your inbox and click the link.

Sorry, something went wrong. Please try again.

©2025 [Sean Wright](https://blog.sean-wright.com).
Published with [Ghost](https://ghost.org) & [Nikko](https://brightthemes.com/themes/nikko/).

Great! You’ve successfully signed up.

Welcome back! You've successfully signed in.

You've successfully subscribed to Sean Wright.

Your link has expired.

Success! Check your email for magic link to sign-in.

Success! Your billing info has been updated.

Your billing was not updated.


