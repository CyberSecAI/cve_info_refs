=== Content from github.com_eaaa16fb_20250124_165500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Freleases%2Ftag%2Fv1.8.11)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Freleases%2Ftag%2Fv1.8.11)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=ethereum%2Fgo-ethereum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethereum](/ethereum)
/
**[go-ethereum](/ethereum/go-ethereum)**
Public

* [Notifications](/login?return_to=%2Fethereum%2Fgo-ethereum) You must be signed in to change notification settings
* [Fork
  20.5k](/login?return_to=%2Fethereum%2Fgo-ethereum)
* [Star
   48.2k](/login?return_to=%2Fethereum%2Fgo-ethereum)

* [Code](/ethereum/go-ethereum/tree/v1.8.11)
* [Issues
  189](/ethereum/go-ethereum/issues)
* [Pull requests
  92](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects
  0](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

Additional navigation options

* [Code](/ethereum/go-ethereum/tree/v1.8.11)
* [Issues](/ethereum/go-ethereum/issues)
* [Pull requests](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

1. [Releases](/ethereum/go-ethereum/releases)
2. [v1.8.11](/ethereum/go-ethereum/releases/tag/v1.8.11)

# Streamline (v1.8.11)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/ethereum/go-ethereum/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.8.11)

 Loading

[View all tags](/ethereum/go-ethereum/tags)

![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)
[karalabe](/karalabe)
released this
12 Jun 14:11

·
[837 commits](/ethereum/go-ethereum/compare/v1.8.11...release/1.8)
to release/1.8
since this release

[v1.8.11](/ethereum/go-ethereum/tree/v1.8.11)

[`dea1ce0`](/ethereum/go-ethereum/commit/dea1ce052a10cd7d401a5c04f83f371a06fe293c)

This commit was signed with the committer’s **verified signature**.

[![](https://avatars.githubusercontent.com/u/129561?s=64&v=4)](/karalabe)
[karalabe](/karalabe)
Péter Szilágyi

GPG key ID: E9AE538CEDF8293D

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Geth v1.8.11 (Streamline) is our biweekly maintenance release, focusing mainly on performance. Overall this release is ~28% lighter on disk IO and ~23% faster on block processing:

* Reduce full-node database rate of growth by 28% ([#16810](https://github.com/ethereum/go-ethereum/pull/16810)).
* Speed up `ethash` verification cache generation by 24% ([#16857](https://github.com/ethereum/go-ethereum/pull/16857)).
* Increase the Merkle trie hashing performance by 12-50% ([#16896](https://github.com/ethereum/go-ethereum/pull/16896)).
* Increase block processing and propagation speed by 15-25% ([#16882](https://github.com/ethereum/go-ethereum/pull/16882)).
* Reduce runtime complexity of retrieving pending transactions ([#16958](https://github.com/ethereum/go-ethereum/pull/16958)).
* Cap cache allowance to Go's GC limits and stabilize memory ([#16800](https://github.com/ethereum/go-ethereum/pull/16800)).
* Reduce database lookups for reverse header retrieval requests ([#16946](https://github.com/ethereum/go-ethereum/pull/16946)).

Not performance improvement, but nice nonetheless:

* Extend `abigen` to support binding contracts from `STDIN` ([#16683](https://github.com/ethereum/go-ethereum/pull/16683)).
* Extend bad block tracking and reporting to full blocks ([#16902](https://github.com/ethereum/go-ethereum/pull/16902)).

Beside the improvements, there are also a few bugs squashed:

* Fix invalid errors for balance retrievals of non-existing blocks ([#16942](https://github.com/ethereum/go-ethereum/pull/16942)).
* Enforce RPC timeouts to avoid stalling HTTP connections ([#16880](https://github.com/ethereum/go-ethereum/pull/16880)).
* Fix a goroutine leak in light clients for cancelled requests ([#16861](https://github.com/ethereum/go-ethereum/pull/16861)).
* Fix a goroutine leak in light clients for timed out requests ([#16776](https://github.com/ethereum/go-ethereum/pull/16776)).
* Fix an invalid header request handling in light servers ([#16891](https://github.com/ethereum/go-ethereum/pull/16891)).
* Fix light server tracking regression in light clients ([#16947](https://github.com/ethereum/go-ethereum/pull/16947)).
* Fix miner to handle side blocks more gracefully ([#16751](https://github.com/ethereum/go-ethereum/pull/16751)).
* Fix 4byte tracer to count external CALLs too ([#16879](https://github.com/ethereum/go-ethereum/pull/16879)).
* Fix shutdown hang on invalid genesis json ([#16794](https://github.com/ethereum/go-ethereum/pull/16794)).

For a full rundown of the changes please consult the [Geth 1.8.11](https://github.com/ethereum/go-ethereum/milestone/72?closed=1) release milestone.

**Binaries and mobile libraries are available [on our download page](https://geth.ethereum.org/downloads).**

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e41a3b7e_20250124_165456.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fcommit%2Fa5237a27eaf81946a3edb4fafe13ed6359d119e4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fcommit%2Fa5237a27eaf81946a3edb4fafe13ed6359d119e4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ethereum%2Fgo-ethereum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethereum](/ethereum)
/
**[go-ethereum](/ethereum/go-ethereum)**
Public

* [Notifications](/login?return_to=%2Fethereum%2Fgo-ethereum) You must be signed in to change notification settings
* [Fork
  20.5k](/login?return_to=%2Fethereum%2Fgo-ethereum)
* [Star
   48.2k](/login?return_to=%2Fethereum%2Fgo-ethereum)

* [Code](/ethereum/go-ethereum)
* [Issues
  189](/ethereum/go-ethereum/issues)
* [Pull requests
  92](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects
  0](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

Additional navigation options

* [Code](/ethereum/go-ethereum)
* [Issues](/ethereum/go-ethereum/issues)
* [Pull requests](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

## Commit

[Permalink](/ethereum/go-ethereum/commit/a5237a27eaf81946a3edb4fafe13ed6359d119e4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

les: add Skip overflow check to GetBlockHeadersMsg handler ([#16891](https://github.com/ethereum/go-ethereum/pull/16891))

[Browse files](/ethereum/go-ethereum/tree/a5237a27eaf81946a3edb4fafe13ed6359d119e4)
Browse the repository at this point in the history

* Loading branch information

[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&v=4)](/zsfelfoldi) [![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)](/karalabe)

[zsfelfoldi](/ethereum/go-ethereum/commits?author=zsfelfoldi "View all commits by zsfelfoldi")
authored and
[karalabe](/ethereum/go-ethereum/commits?author=karalabe "View all commits by karalabe")
committed
Jun 5, 2018

1 parent
[7a22e89](/ethereum/go-ethereum/commit/7a22e89080b2be624c2659c8ea9dc34820400ffd)

commit a5237a2

Showing
**1 changed file**
with
**18 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

25 changes: 18 additions & 7 deletions

25
[les/handler.go](#diff-2866d9140130ae8ce8861b548eb71a9e8ca687b1431b0f6f03756489090f44b2 "les/handler.go")

Show comments

[View file](/ethereum/go-ethereum/blob/a5237a27eaf81946a3edb4fafe13ed6359d119e4/les/handler.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,7 @@ package les |
|  |  |  |
|  |  | import ( |
|  |  | "encoding/binary" |
|  |  | "encoding/json" |
|  |  | "errors" |
|  |  | "fmt" |
|  |  | "math/big" |
| Expand Down  Expand Up | | @@ -441,7 +442,7 @@ func (pm \*ProtocolManager) handleMsg(p \*peer) error { |
|  |  |  |
|  |  | // Advance to the next header of the query |
|  |  | switch { |
|  |  | case query.Origin.Hash != (common.Hash{}) && query.Reverse: |
|  |  | case hashMode && query.Reverse: |
|  |  | // Hash based traversal towards the genesis block |
|  |  | for i := 0; i < int(query.Skip)+1; i++ { |
|  |  | if header := pm.blockchain.GetHeader(query.Origin.Hash, number); header != nil { |
| Expand All | | @@ -452,16 +453,26 @@ func (pm \*ProtocolManager) handleMsg(p \*peer) error { |
|  |  | break |
|  |  | } |
|  |  | } |
|  |  | case query.Origin.Hash != (common.Hash{}) && !query.Reverse: |
|  |  | case hashMode && !query.Reverse: |
|  |  | // Hash based traversal towards the leaf block |
|  |  | if header := pm.blockchain.GetHeaderByNumber(origin.Number.Uint64() + query.Skip + 1); header != nil { |
|  |  | if pm.blockchain.GetBlockHashesFromHash(header.Hash(), query.Skip+1)[query.Skip] == query.Origin.Hash { |
|  |  | query.Origin.Hash = header.Hash() |
|  |  | var ( |
|  |  | current = origin.Number.Uint64() |
|  |  | next = current + query.Skip + 1 |
|  |  | ) |
|  |  | if next <= current { |
|  |  | infos, \_ := json.MarshalIndent(p.Peer.Info(), "", " ") |
|  |  | p.Log().Warn("GetBlockHeaders skip overflow attack", "current", current, "skip", query.Skip, "next", next, "attacker", infos) |
|  |  | unknown = true |
|  |  | } else { |
|  |  | if header := pm.blockchain.GetHeaderByNumber(next); header != nil { |
|  |  | if pm.blockchain.GetBlockHashesFromHash(header.Hash(), query.Skip+1)[query.Skip] == query.Origin.Hash { |
|  |  | query.Origin.Hash = header.Hash() |
|  |  | } else { |
|  |  | unknown = true |
|  |  | } |
|  |  | } else { |
|  |  | unknown = true |
|  |  | } |
|  |  | } else { |
|  |  | unknown = true |
|  |  | } |
|  |  | case query.Reverse: |
|  |  | // Number based traversal towards the genesis block |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a5237a2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fcommit%2Fa5237a27eaf81946a3edb4fafe13ed6359d119e4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_aea0f973_20250124_165458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fpull%2F16891)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fpull%2F16891)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ethereum%2Fgo-ethereum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethereum](/ethereum)
/
**[go-ethereum](/ethereum/go-ethereum)**
Public

* [Notifications](/login?return_to=%2Fethereum%2Fgo-ethereum) You must be signed in to change notification settings
* [Fork
  20.5k](/login?return_to=%2Fethereum%2Fgo-ethereum)
* [Star
   48.2k](/login?return_to=%2Fethereum%2Fgo-ethereum)

* [Code](/ethereum/go-ethereum)
* [Issues
  189](/ethereum/go-ethereum/issues)
* [Pull requests
  92](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects
  0](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

Additional navigation options

* [Code](/ethereum/go-ethereum)
* [Issues](/ethereum/go-ethereum/issues)
* [Pull requests](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fethereum%2Fgo-ethereum%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fethereum%2Fgo-ethereum%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# les: add Skip overflow check to GetBlockHeadersMsg handler #16891

 Merged

[karalabe](/karalabe)
merged 1 commit into
[ethereum:master](/ethereum/go-ethereum/tree/master "ethereum/go-ethereum:master")
from
[zsfelfoldi:getblockheaders-fix](/zsfelfoldi/go-ethereum/tree/getblockheaders-fix "zsfelfoldi/go-ethereum:getblockheaders-fix")

Jun 5, 2018

 Merged

# [les: add Skip overflow check to GetBlockHeadersMsg handler](#top) #16891

[karalabe](/karalabe)
merged 1 commit into
[ethereum:master](/ethereum/go-ethereum/tree/master "ethereum/go-ethereum:master")
from
[zsfelfoldi:getblockheaders-fix](/zsfelfoldi/go-ethereum/tree/getblockheaders-fix "zsfelfoldi/go-ethereum:getblockheaders-fix")

Jun 5, 2018

[Conversation
2](/ethereum/go-ethereum/pull/16891)
[Commits
1](/ethereum/go-ethereum/pull/16891/commits)
[Checks
0](/ethereum/go-ethereum/pull/16891/checks)
[Files changed](/ethereum/go-ethereum/pull/16891/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=60&v=4)](/zsfelfoldi)

Copy link

Contributor

### @zsfelfoldi **[zsfelfoldi](/zsfelfoldi)** commented [Jun 4, 2018](#issue-329232203)

This PR adds the same check for GetBlockHeadersMsg.Skip overflow attack that has already been implemented for the ETH protocol.

Sorry, something went wrong.

All reactions

[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&v=4)](/zsfelfoldi)

`[les: add Skip overflow check to GetBlockHeadersMsg handler](/ethereum/go-ethereum/pull/16891/commits/514e4450c521616fd4bc7cabca2c62a0b5406af7 "les: add Skip overflow check to GetBlockHeadersMsg handler")`

`[514e445](/ethereum/go-ethereum/pull/16891/commits/514e4450c521616fd4bc7cabca2c62a0b5406af7)`

[![karalabe](https://avatars.githubusercontent.com/u/129561?s=60&v=4)](/karalabe)

**[karalabe](/karalabe)**
approved these changes
[Jun 5, 2018](#pullrequestreview-125845443)

 [View reviewed changes](/ethereum/go-ethereum/pull/16891/files/514e4450c521616fd4bc7cabca2c62a0b5406af7)

Copy link

Member

### @karalabe **[karalabe](/karalabe)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)](/karalabe)
[karalabe](/karalabe)
added this to the [1.8.10](/ethereum/go-ethereum/milestone/71) milestone
[Jun 5, 2018](#event-1662958749)

[![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)](/karalabe)
[karalabe](/karalabe)
merged commit [`a5237a2`](/ethereum/go-ethereum/commit/a5237a27eaf81946a3edb4fafe13ed6359d119e4)
into
ethereum:master

[Jun 5, 2018](https://github.com/ethereum/go-ethereum/pull/16891#event-1662963906)

[![@holiman](https://avatars.githubusercontent.com/u/142290?s=80&u=cc1c365b40d8b3b84e2622effc8c8f7792e2a216&v=4)](/holiman)

Copy link

Contributor

### **[holiman](/holiman)** commented [Jun 5, 2018](#issuecomment-394638015)

| Might want to add  ``` diff --git a/les/handler_test.go b/les/handler_test.go index 31aad3ed4..fde7c2a11 100644 --- a/les/handler_test.go +++ b/les/handler_test.go @@ -75,6 +75,11 @@ func testGetBlockHeaders(t *testing.T, protocol int) {                         &getBlockHeadersData{Origin: hashOrNumber{Number: limit / 2}, Amount: 1},                         []common.Hash{bc.GetBlockByNumber(limit / 2).Hash()},                 }, +               // Overflow attack +               { +                       &getBlockHeadersData{Origin: hashOrNumber{Hash:bc.GetBlockByNumber(1).Hash()}, Amount: 1,Skip:0xFFFFFFFFFFFFFFFF}, +                               []common.Hash{}, +               },                 // Multiple headers should be retrievable in both directions                 {  ``` |
| --- |

All reactions

Sorry, something went wrong.

[kielbarry](/kielbarry)
pushed a commit
to kielbarry/go-ethereum
that referenced
this pull request
[Jun 7, 2018](#ref-commit-215122c)
[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&u=a44e4d9e7b8e5aa3a64a52dc4e14211f370c4ce2&v=4)](/zsfelfoldi) [![@kielbarry](https://avatars.githubusercontent.com/u/16748843?s=40&v=4)](/kielbarry)

`[les: add Skip overflow check to GetBlockHeadersMsg handler (](/kielbarry/go-ethereum/commit/215122c9c3839826c85528ad1f3cbc4d0dea7bb3 "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)")[ethereum#…](https://github.com/ethereum/go-ethereum/pull/16891)`
…

`[215122c](/kielbarry/go-ethereum/commit/215122c9c3839826c85528ad1f3cbc4d0dea7bb3)`

```
[…16891](https://github.com/ethereum/go-ethereum/pull/16891))
```

[![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)](/karalabe)
[karalabe](/karalabe)
modified the milestones:
[1.8.10](/ethereum/go-ethereum/milestone/71),
[1.8.11](/ethereum/go-ethereum/milestone/72)
[Jun 11, 2018](#event-1673227199)

[kielbarry](/kielbarry)
pushed a commit
to kielbarry/go-ethereum
that referenced
this pull request
[Jul 9, 2018](#ref-commit-d2a38b3)
[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&u=a44e4d9e7b8e5aa3a64a52dc4e14211f370c4ce2&v=4)](/zsfelfoldi) [![@kielbarry](https://avatars.githubusercontent.com/u/16748843?s=40&v=4)](/kielbarry)

`[les: add Skip overflow check to GetBlockHeadersMsg handler (](/kielbarry/go-ethereum/commit/d2a38b30e9e70b913669154f2ab05f78c95a2b53 "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)")[ethereum#…](https://github.com/ethereum/go-ethereum/pull/16891)`
…

`[d2a38b3](/kielbarry/go-ethereum/commit/d2a38b30e9e70b913669154f2ab05f78c95a2b53)`

```
[…16891](https://github.com/ethereum/go-ethereum/pull/16891))
```

[firmianavan](/firmianavan)
pushed a commit
to firmianavan/go-ethereum
that referenced
this pull request
[Aug 28, 2018](#ref-commit-ddbe25d)
[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&u=a44e4d9e7b8e5aa3a64a52dc4e14211f370c4ce2&v=4)](/zsfelfoldi) [![@firmianavan](https://avatars.githubusercontent.com/u/25193549?s=40&v=4)](/firmianavan)

`[les: add Skip overflow check to GetBlockHeadersMsg handler (](/firmianavan/go-ethereum/commit/ddbe25dd12a56e1636cd9ab430a4771f1615e0b5 "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)")[ethereum#…](https://github.com/ethereum/go-ethereum/pull/16891)`
…

`[ddbe25d](/firmianavan/go-ethereum/commit/ddbe25dd12a56e1636cd9ab430a4771f1615e0b5)`

```
[…16891](https://github.com/ethereum/go-ethereum/pull/16891))
```

[TuitionCoin](/TuitionCoin)
added a commit
to FinTechToken/go-ethereum
that referenced
this pull request
[Jun 16, 2019](#ref-commit-6005027)
[![@TuitionCoin](https://avatars.githubusercontent.com/u/29800199?s=40&u=aa21e31728c758933efdc75e72e7ad658b833d38&v=4)](/TuitionCoin)

`[1.8.12 stable (](/FinTechToken/go-ethereum/commit/6005027e9759f764a65af82777677e91184eaa46 "1.8.12 stable (#12)

* build: add -e and -X flags to get more information on #16433 (#16443)

* core: remove stray account creations in state transition (#16470)

The 'from' and 'to' methods on StateTransitions are reader methods and
shouldn't have inadvertent side effects on state.

It is safe to remove the check in 'from' because account existence is
implicitly checked by the nonce and balance checks. If the account has
non-zero balance or nonce, it must exist. Even if the sender account has
nonce zero at the start of the state transition or no balance, the nonce
is incremented before execution and the account will be created at that
time.

It is safe to remove the check in 'to' because the EVM creates the
account if necessary.

Fixes #15119

* travis, appveyor: bump to Go 1.10.1

* travis.yml: add TEST_PACKAGES to speed up swarm testing (#16456)

This commit is meant to allow ecosystem projects such as ethersphere
to minimize CI build times by specifying an environment variable with
the packages to run tests on.

If the environment variable isn't defined the build script will test
all packages so this shouldn't affect the main go-ethereum repository.

* les: add ps.lock.Unlock() before return (#16360)

* core/state: fix bug in copy of copy State

* core/state: fix ripemd-cornercase in Copy

* core: txpool stable underprice drop order, perf fixes

* miner: remove contention on currentMu for pending data retrievals (#16497)

* ethdb: add leveldb write delay statistic (#16499)

* eth/downloader: wait for all fetcher goroutines to exit before terminating (#16509)

* cmd/clef, signer: initial poc of the standalone signer (#16154)

* signer: introduce external signer command

* cmd/signer, rpc: Implement new signer. Add info about remote user to Context

* signer: refactored request/response, made use of urfave.cli

* cmd/signer: Use common flags

* cmd/signer: methods to validate calldata against abi

* cmd/signer: work on abi parser

* signer: add mutex around UI

* cmd/signer: add json 4byte directory, remove passwords from api

* cmd/signer: minor changes

* cmd/signer: Use ErrRequestDenied, enable lightkdf

* cmd/signer: implement tests

* cmd/signer: made possible for UI to modify tx parameters

* cmd/signer: refactors, removed channels in ui comms, added UI-api via stdin/out

* cmd/signer: Made lowercase json-definitions, added UI-signer test functionality

* cmd/signer: update documentation

* cmd/signer: fix bugs, improve abi detection, abi argument display

* cmd/signer: minor change in json format

* cmd/signer: rework json communication

* cmd/signer: implement mixcase addresses in API, fix json id bug

* cmd/signer: rename fromaccount, update pythonpoc with new json encoding format

* cmd/signer: make use of new abi interface

* signer: documentation

* signer/main: remove redundant  option

* signer: implement audit logging

* signer: create package 'signer', minor changes

* common: add 0x-prefix to mixcaseaddress in json marshalling + validation

* signer, rules, storage: implement rules + ephemeral storage for signer rules

* signer: implement OnApprovedTx, change signing response (API BREAKAGE)

* signer: refactoring + documentation

* signer/rules: implement dispatching to next handler

* signer: docs

* signer/rules: hide json-conversion from users, ensure context is cleaned

* signer: docs

* signer: implement validation rules, change signature of call_info

* signer: fix log flaw with string pointer

* signer: implement custom 4byte databsae that saves submitted signatures

* signer/storage: implement aes-gcm-backed credential storage

* accounts: implement json unmarshalling of url

* signer: fix listresponse, fix gas->uint64

* node: make http/ipc start methods public

* signer: add ipc capability+review concerns

* accounts: correct docstring

* signer: address review concerns

* rpc: go fmt -s

* signer: review concerns+ baptize Clef

* signer,node: move Start-functions to separate file

* signer: formatting

* light: new CHTs (#16515)

* params: release Geth v1.8.4

* VERSION, params: begin v1.8.5 release cycle

* build: enable goimports and varcheck linters (#16446)

* core/asm: remove unused condition (#16487)

* cmd/utils: fix help template issue for subcommands (#16351)

* rpc: clean up IPC handler (#16524)

This avoids logging accept errors on shutdown and removes
a bit of duplication. It also fixes some goimports lint warnings.

* core/asm: accept uppercase instructions (#16531)

* all: fix various typos (#16533)

* fix typo

* fix typo

* fix typo

* rpc: handle HTTP response error codes (#16500)

* whisper/whisperv6: post returns the hash of sent message (#16495)

* ethclient: add DialContext and Close (#16318)

DialContext allows users to pass a Context object for cancellation.
Close closes the underlying RPC connection.

* vendor: update elastic/gosigar so that it compiles on OpenBSD (#16542)

* eth/downloader: fix for Issue #16539 (#16546)

* params: release Geth v1.8.5 - Dirty Derivative²

* VERSION, params: begin Geth 1.8.6 release cycle

* cmd/geth: update the copyright year in the geth command usage (#16537)

* Revert \"Dockerfile.alltools: fix invalid command\"

* Revert \"cmd/puppeth: fix node deploys for updated dockerfile user\"

* Dockerfile: revert the user change PR that broke all APIs

* Dockerfile: drop legacy discovery v5 port mappings

* params: release v1.8.6 to fix docker images

* VERSION, params: begin release cycle 1.8.7

* cmd/geth, mobile: add memsize to pprof server (#16532)

* cmd/geth, mobile: add memsize to pprof server

This is a temporary change, to be reverted before the next release.

* cmd/geth: fix variable name

* core/types: avoid duplicating transactions on changing signer (#16435)

* core/state: cache missing storage entries (#16584)

* cmd/utils: point users to --syncmode under DEPRECATED (#16572)

Indicate that --light and --fast options are replaced by --syncmode

* trie: remove unused `buf` parameter (#16583)

* core, eth: fix tracer dirty finalization

* travis.yml: remove obsolete brew-cask install

* whisper: Golint fixes in whisper packages (#16637)

* vendor: fix leveldb crash when bigger than 1 TiB

* core: ensure local transactions aren't discarded as underpriced

This fixes an issue where local transactions are discarded as
underpriced when the pool and queue are full.

* evm/main: use blocknumber from genesis

* accounts: golint updates for this or self warning (#16627)

* tests: golint fixes for tests directory (#16640)

* trie: golint iterator fixes (#16639)

* internal: golint updates for this or self warning (#16634)

* core: golint updates for this or self warning (#16633)

* build: Add ldflags -s -w when building aar

Smaller size on mobile is always good.
Might also solve our maven central upload problem

* cmd/clef: documentation about setup (#16568)

clef: documentation about setup

* params: release geth 1.8.7

* VERSION, params: begin v1.8.8 release cycle

* log: changed if-else blocks to conform with golint (#16661)

* p2p: changed if-else blocks to conform with golint (#16660)

* les: changed if-else blocks to conform with golint (#16658)

* accounts: changed if-else blocks to conform with golint (#16654)

* rpc: golint error with context as last parameter (#16657)

* rpc/*: golint error with context as last parameter

* Update json.go

* metrics: golint updates for this or self warning (#16635)

* metrics/*: golint updates for this or self warning

* metrics/*: golint updates for this or self warning, updated pr from feedback

* consensus/ethash: fixed typo (#16665)

* event: golint updates for this or self warning (#16631)

* event/*: golint updates for this or self warning

* event/*: golint updates for this or self warning, pr updated per feedback

* eth: golint updates for this or self warning (#16632)

* eth/*:golint updates for this or self warning

* eth/*: golint updates for this or self warning, pr updated per feedback

* signer: fix golint errors (#16653)

* signer/*: golint fixes

Specifically naming and comment formatting for documentation

* signer/*: fixed naming error crashing build

* signer/*: corrected error

* signer/core: fix tiny error whitespace

* signer/rules: fix test refactor

* whisper/mailserver: pass init error to the caller (#16671)

* whisper/mailserver: pass init error to the caller

* whisper/mailserver: add returns to fmt.Errorf

* whisper/mailserver: check err in mailserver init test

* common: changed if-else blocks to conform with golint (#16656)

* mobile: add GetStatus Method for Receipt (#16598)

* core/rawdb: separate raw database access to own package (#16666)

* rlp: fix some golint warnings (#16659)

* p2p: fix some golint warnings (#16577)

* eth/filters: derive FilterCriteria from ethereum.FilterQuery (#16629)

* p2p/simulations/adapters: fix websocket log line parsing in exec adapter (#16667)

* build: specify the key to use when invoking gpg:sign-and-deploy-file (#16696)

* crypto: fix golint warnings (#16710)

* p2p: don't discard reason set by Disconnect (#16559)

Peer.run was discarding the reason for disconnection sent to the disc
channel by Disconnect.

* cmd: various golint fixes (#16700)

* cmd: various golint fixes

* cmd: update to pr change request

* cmd: update to pr change request

* eth: golint fixes to variable names (#16711)

* eth/filter: check nil pointer when unsubscribe (#16682)

* eth/filter: check nil pointer when unsubscribe

* eth/filters, accounts, rpc: abort system if subscribe failed

* eth/filter: add crit log before exit

* eth/filter, event: minor fixes

* whisper/shhclient: update call to shh_generateSymKeyFromPassword to pass a string (#16668)

* all: get rid of error when creating memory database (#16716)

* all: get rid of error when create mdb

* core: clean up variables definition

* all: inline mdb definition

* event: document select case slice use and add edge case test (#16680)

Feed keeps active subscription channels in a slice called 'f.sendCases'.
The Send method tracks the active cases in a local variable 'cases'
whose value is f.sendCases initially. 'cases' shrinks to a shorter
prefix of f.sendCases every time a send succeeds, moving the successful
case out of range of the active case list.

This can be confusing because the two slices share a backing array. Add
more comments to document what is going on. Also add a test for removing
a case that is in 'f.sentCases' but not 'cases'.

* travis: use Android NDK 16b (#16562)

* bmt: golint updates for this or self warning (#16628)

* bmt/*: golint updates for this or self warning

* Update bmt.go

* light: new CHT for mainnet and ropsten (#16736)

* params: release go-ethereum v1.8.8

* VERSION, params: start 1.8.9 release cycle

* accounts/abi: allow abi: tags when unpacking structs

Go code users can now tag event struct members with `abi:` to specify in what fields the event will be de-serialized.

See PR #16648 for details.

* travis: try to upgrade android builder to trusty

* p2p/enr: updates for discovery v4 compatibility (#16679)

This applies spec changes from ethereum/EIPs#1049 and adds support for
pluggable identity schemes.

Some care has been taken to make the \"v4\" scheme standalone. It uses
public APIs only and could be moved out of package enr at any time.

A couple of minor changes were needed to make identity schemes work:

- The sequence number is now updated in Set instead of when signing.
- Record is now copy-safe, i.e. calling Set on a shallow copy doesn't
  modify the record it was copied from.

* all: collate new transaction events together

* core, eth: minor txpool event cleanups

* travis, appveyor: bump Go release to 1.10.2

* core, consensus: fix some typos in comment code and output log

* eth: propagate blocks and transactions async

* trie: fixes to comply with golint (#16771)

* log: fixes for golint warnings (#16775)

* node: all golint warnings fixed (#16773)

* node: all golint warnings fixed

* node: rm per peter

* node: rm per peter

* vendor, ethdb: print warning log if leveldb is performing compaction (#16766)

* vendor: update leveldb package

* ethdb: print warning log if db is performing compaction

* ethdb: update annotation and log

* core/types: convert status type from uint to uint64 (#16784)

* trie: support proof generation from the iterator

* core/vm: fix typo in instructions.go (#16788)

* core: use a wrapped map to remove contention in `TxPool.Get`. (#16670)

* core: use a wrapped `map` and `sync.RWMutex` for `TxPool.all` to remove contention in `TxPool.Get`.

* core: Remove redundant `txLookup.Find` and improve comments on txLookup methods.

* trie: cleaner logic, one less func call

* eth, node, trie: fix minor typos (#16802)

* params: release go-ethereum v1.8.9

* VERSION, params: begin 1.8.10 release cycle

* ethereum: fix a typo in FilterQuery{} (#16827)

Fix a spelling mistake in comment

* eth/fetcher: reuse variables for hash and number (#16819)

* whisper/shhclient: update call to shh_post to expect string instead of bool (#16757)

Fixes #16756

* common: improve documentation comments (#16701)

This commit adds many comments and removes unused code.
It also removes the EmptyHash function, which had some uses
but was silly.

* core/vm: fix typo in comment

* p2p/discv5: add egress/ingress traffic metrics to discv5 udp transport (#16369)

* core: improve test for TransactionPriceNonceSort (#16413)

* trie: rename TrieSync to Sync and improve hexToKeybytes (#16804)

This removes a golint warning: type name will be used as trie.TrieSync by
other packages, and that stutters; consider calling this Sync.

In hexToKeybytes len(hex) is even and (even+1)/2 == even/2, remove the +1.

* core: fix transaction event asynchronicity

* params: release Geth 1.8.10 hotfix

* VERSION, params: begin 1.8.11 release cycle

* ethstats: fix last golint warning (#16837)

* console: squash golint warnings (#16836)

* rpc: use HTTP request context as top-level context (#16861)

* consensus/ethash: reduce keccak hash allocations (#16857)

Use Read instead of Sum to avoid internal allocations and
copying the state.

name                      old time/op  new time/op  delta
CacheGeneration-8          764ms ± 1%   579ms ± 1%  -24.22%  (p=0.000 n=20+17)
SmallDatasetGeneration-8  75.2ms ±12%  60.6ms ±10%  -19.37%  (p=0.000 n=20+20)
HashimotoLight-8          1.58ms ±11%  1.55ms ± 8%     ~     (p=0.322 n=20+19)
HashimotoFullSmall-8      4.90µs ± 1%  4.88µs ± 1%   -0.31%  (p=0.013 n=19+18)

* core, eth, trie: streaming GC for the trie cache (#16810)

* core, eth, trie: streaming GC for the trie cache

* trie: track memcache statistics

* rpc: set timeouts for http server, see #16859

* metrics: expvar support for ResettingTimer (#16878)

* metrics: expvar support for ResettingTimer

* metrics: use integers for percentiles; remove Overall

* metrics: fix edge-case panic for index-out-of-range

* cmd/geth: cap cache allowance

* core: fix typo in comment code

* les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)

* eth/tracers: fix minor off-by-one error (#16879)

* tracing: fix minor off-by-one error

* tracers: go generate

* core: concurrent background transaction sender ecrecover

* miner: not call commitNewWork if it's a side block (#16751)

* cmd/abigen: support for reading solc output from stdin (#16683)

Allow the --abi flag to be given - to indicate that it should read the
ABI information from standard input. It expects to read the solc output
with the --combined-json flag providing bin, abi, userdoc, devdoc, and
metadata, and works very similarly to the internal invocation of solc,
except it allows external invocation of solc.

This facilitates integration with more complex solc invocations, such
as invocations that require path remapping or --allow-paths tweaks.

Simple usage example:

    solc --combined-json bin,abi,userdoc,devdoc,metadata *.sol | abigen --abi -

* params: fix golint warnings (#16853)

params: fix golint warnings

* vendor: added vendor packages necessary for the swarm-network-rewrite merge (#16792)

* vendor: added vendor packages necessary for the swarm-network-rewrite merge into ethereum master

* vendor: removed multihash deps

* trie: reduce hasher allocations (#16896)

* trie: reduce hasher allocations

name    old time/op    new time/op    delta
Hash-8    4.05µs ±12%    3.56µs ± 9%  -12.13%  (p=0.000 n=20+19)

name    old alloc/op   new alloc/op   delta
Hash-8    1.30kB ± 0%    0.66kB ± 0%  -49.15%  (p=0.000 n=20+20)

name    old allocs/op  new allocs/op  delta
Hash-8      11.0 ± 0%       8.0 ± 0%  -27.27%  (p=0.000 n=20+20)

* trie: bump initial buffer cap in hasher

* whisper: re-insert #16757 that has been lost during a merge (#16889)

* cmd/puppeth: fixed a typo in a wizard input query (#16910)

* core: relax type requirement for bc in ApplyTransaction (#16901)

* trie: avoid unnecessary slicing on shortnode decoding (#16917)

optimization code

* cmd/ethkey: add command to change key passphrase (#16516)

This change introduces

    ethkey changepassphrase <keyfile>

to change the passphrase of a key file.

* metrics: return an empty snapshot for NilResettingTimer (#16930)

* light: new CHTs for mainnet and ropsten (#16926)

* ethclient: fix RPC parse error of Parity response (#16924)

The error produced when using a Parity RPC was the following:

ERROR: transaction did not get mined: failed to get tx for txid 0xbdeb094b3278019383c8da148ff1cb5b5dbd61bf8731bc2310ac1b8ed0235226: json: cannot unmarshal non-string into Go struct field txExtraInfo.blockHash of type common.Hash

* core: improve getBadBlocks to return full block rlp (#16902)

* core: improve getBadBlocks to return full block rlp

* core, eth, ethapi: changes to getBadBlocks formatting

* ethapi: address review concerns

* rpc: fix a comment typo (#16929)

* rpc: support returning nil pointer big.Ints (null)

* trie: don't report the root flushlist as an alloc

* metrics: removed repetitive calculations (#16944)

* core/rawdb: wrap db key creations (#16914)

* core/rawdb: use wrappered helper to assemble key

* core/rawdb: wrappered helper to assemble key

* core/rawdb: rewrite the wrapper, pass common.Hash

* ethdb: gracefullly handle quit channel (#16794)

* ethdb: gratefullly handle quit channel

* ethdb: minor polish

* internal/ethapi: reduce pendingTransactions to O(txs+accs) from O(txs*accs)

* les: pass server pool to protocol manager (#16947)

* metrics: fix gofmt linter warnings

* crypto: replace ToECDSAPub with error-checking func UnmarshalPubkey (#16932)

ToECDSAPub was unsafe because it returned a non-nil key with nil X, Y in
case of invalid input. This change replaces ToECDSAPub with
UnmarshalPubkey across the codebase.

* core, eth, les: more efficient hash-based header chain retrieval (#16946)

* les: fix retriever logic (#16776)

This PR fixes a retriever logic bug. When a peer had a soft timeout
and then a response arrived, it always assumed it was the same peer
even though it could have been a later requested one that did not time
out at all yet. In this case the logic went to an illegal state and
deadlocked, causing a goroutine leak.

Fixes #16243 and replaces #16359.
Thanks to @riceke for finding the bug in the logic.

* params: release go-ethereum v1.8.11

* VERSION, params: begin v1.8.12 release cycle

* core: change comment to match code more closely (#16963)

* internal/web3ext: fix method name for enabling mutex profiling (#16964)

* eth/fetcher: fix annotation (#16969)

* core/asm: correct comments typo (#16975)

core/asm/lexer: correct comments typo

* console: correct some comments typo (#16971)

console/console: correct some comments typo

*  #15685 made peer_test.go more portable by using random free port instead of hardcoded port 30303 (#15687)

Improves test portability by resolving 127.0.0.1:0
to get a random free port instead of the hard coded one. Now
the test works if you have a running node on the same
interface already.

Fixes #15685

* all: library changes for swarm-network-rewrite (#16898)

This commit adds all changes needed for the merge of swarm-network-rewrite.
The changes:

- build: increase linter timeout
- contracts/ens: export ensNode
- log: add Output method and enable fractional seconds in format
- metrics: relax test timeout
- p2p: reduced some log levels, updates to simulation packages
- rpc: increased maxClientSubscriptionBuffer to 20000

* core/vm: optimize MSTORE and SLOAD (#16939)

* vm/test: add tests+benchmarks for mstore

* core/vm: less alloc and copying for mstore

* core/vm: less allocs in sload

* vm: check for errors more correctly

* eth/filters: make filterLogs func more readable (#16920)

* cmd/utils: fix NetworkId default when -dev is set (#16833)

Prior to this change, when geth was started with `geth -dev -rpc`,
it would report a network id of `1` in response to the `net_version` RPC
request. But the actual network id it used to verify transactions
was `1337`.

This change causes geth instead respond with `1337` to the `net_version`
RPC when geth is started with `geth -dev -rpc`.

* travis, appveyor: update to Go 1.10.3

* common: all golint warnings removed (#16852)

* common: all golint warnings removed

* common: fixups

* eth: conform better to the golint standards (#16783)

* eth: made changes to conform better to the golint standards

* eth: fix comment nit

* core: reduce nesting in transaction pool code (#16980)

* bmt: fix package documentation comment (#16909)

* common/number: delete unused package (#16983)

This package was meant to hold an improved 256 bit integer library, but
the effort was abandoned in 2015. AFAIK nothing ever used this package.
Time to say goodbye.

* core/asm: correct comments typo (#16974)

* core/asm/compiler: correct comments typo

core/asm/compiler: correct comments typo

* Correct comments typo

* internal/debug: use pprof goroutine writer for debug_stacks (#16892)

* debug: Use pprof goroutine writer in debug.Stacks() to ensure all goroutines are captured.

* Up to 64MB limit, previous code only captured first 1MB of goroutines.

* internal/debug: simplify stacks handler

* fix typo

* fix pointer receiver

* accounts/keystore: assign schema as const instead of var (#16985)

* cmd: remove faucet/puppeth dead code (#16991)

* cmd/faucet: authGitHub is not used anymore

* cmd/puppeth: remove not used code

* mobile: correct comment typo in geth.go (#17021)

* accounts/usbwallet: correct comment typo (#17008)

* core: remove dead code, limit test code scope (#17006)

* core: move test util var/func to test file

* core: remove useless func

*  accounts/usbwallet: correct comment typo (#16998)

* signer: remove useless errorWrapper (#17003)

* travis: use NDK 17b for Android archives (#17029)

* tracers: fix err in 4byte, add some opcode analysis tools

* accounts: remove deadcode isSigned (#16990)

* mobile: correct comment typo in ethereum.go (#17040)

* cmd/geth: remove the tail \",\" from genesis config (#17028)

remove the tail \",\" from genesis config,  which will cause genesis config parse error .

* trie: cache collapsed tries node, not rlp blobs (#16876)

The current trie memory database/cache that we do pruning on stores
trie nodes as binary rlp encoded blobs, and also stores the node
relationships/references for GC purposes. However, most of the trie
nodes (everything apart from a value node) is in essence just a
collection of references.

This PR switches out the RLP encoded trie blobs with the
collapsed-but-not-serialized trie nodes. This permits most of the
references to be recovered from within the node data structure,
avoiding the need to track them a second time (expensive memory wise).

* swarm: network rewrite merge

* les: handle conn/disc/reg logic in the eventloop (#16981)

* les: handle conn/disc/reg logic in the eventloop

* les: try to dial before start eventloop

* les: handle disconnect logic more safely

* les: grammar fix

* log: Change time format

- Keep the tailing zeros.
- Limit precision to milliseconds.

* swarm/fuse: Disable fuse tests, they are flaky (#17072)

* swarm/pss: Hide big network tests under longrunning flag (#17074)

* whisper: Reduce message loop log from Warn to Info (#17055)

* core/vm: clear linter warnings (#17057)

* core/vm: clear linter warnings

* core/vm: review input

* core/vm.go: revert lint in noop as per request

* build: make build/goimports.sh more potable

* node: remove formatting from ResettingTimer metrics if requested in raw

* ethstats: comment minor correction (#17102)

spell correction from `repors` to `reports`

* ethdb, core: implement delete for db batch (#17101)

* vendor: update docker/docker/pkg/reexec so that it compiles on OpenBSD (#17084)

* trie: fix a temporary memory leak in the memcache

* cmd/geth: export metrics to InfluxDB (#16979)

* cmd/geth: add flags for metrics export

* cmd/geth: update usage fields for metrics flags

* metrics/influxdb: update reporter logger to adhere to geth logging convention

* node: documentation typo fix (#17113)

* core/vm: reuse bigint pools across transactions (#17070)

* core/vm: A pool for int pools

* core/vm: fix rebase issue

* core/vm: push leftover stack items after execution, not before

* cmd/p2psim: add exit error output and exit code (#17116)

* p2p/discover: move bond logic from table to transport (#17048)

* p2p/discover: move bond logic from table to transport

This commit moves node endpoint verification (bonding) from the table to
the UDP transport implementation. Previously, adding a node to the table
entailed pinging the node if needed. With this change, the ping-back
logic is embedded in the packet handler at a lower level.

It is easy to verify that the basic protocol is unchanged: we still
require a valid pong reply from the node before findnode is accepted.

The node database tracked the time of last ping sent to the node and
time of last valid pong received from the node. Node endpoints are
considered verified when a valid pong is received and the time of last
pong was called 'bond time'. The time of last ping sent was unused. In
this commit, the last ping database entry is repurposed to mean last
ping _received_. This entry is now used to track whether the node needs
to be pinged back.

The other big change is how nodes are added to the table. We used to add
nodes in Table.bond, which ran when a remote node pinged us or when we
encountered the node in a neighbors reply. The transport now adds to the
table directly after the endpoint is verified through ping. To ensure
that the Table can't be filled just by pinging the node repeatedly, we
retain the isInitDone check. During init, only nodes from neighbors
replies are added.

* p2p/discover: reduce findnode failure counter on success

* p2p/discover: remove unused parameter of loadSeedNodes

* p2p/discover: improve ping-back check and comments

* p2p/discover: add neighbors reply nodes always, not just during init

* consensus/ethash: fixed documentation typo (#17121)

\"proot-of-work\" to \"proof-of-work\"

* light: new CHTs (#17124)

* les: add announcement safety check to light fetcher (#17034)

* params: v1.8.12 stable

* 1.8.12")[#12](https://github.com/FinTechToken/go-ethereum/pull/12)[)](/FinTechToken/go-ethereum/commit/6005027e9759f764a65af82777677e91184eaa46 "1.8.12 stable (#12)

* build: add -e and -X flags to get more information on #16433 (#16443)

* core: remove stray account creations in state transition (#16470)

The 'from' and 'to' methods on StateTransitions are reader methods and
shouldn't have inadvertent side effects on state.

It is safe to remove the check in 'from' because account existence is
implicitly checked by the nonce and balance checks. If the account has
non-zero balance or nonce, it must exist. Even if the sender account has
nonce zero at the start of the state transition or no balance, the nonce
is incremented before execution and the account will be created at that
time.

It is safe to remove the check in 'to' because the EVM creates the
account if necessary.

Fixes #15119

* travis, appveyor: bump to Go 1.10.1

* travis.yml: add TEST_PACKAGES to speed up swarm testing (#16456)

This commit is meant to allow ecosystem projects such as ethersphere
to minimize CI build times by specifying an environment variable with
the packages to run tests on.

If the environment variable isn't defined the build script will test
all packages so this shouldn't affect the main go-ethereum repository.

* les: add ps.lock.Unlock() before return (#16360)

* core/state: fix bug in copy of copy State

* core/state: fix ripemd-cornercase in Copy

* core: txpool stable underprice drop order, perf fixes

* miner: remove contention on currentMu for pending data retrievals (#16497)

* ethdb: add leveldb write delay statistic (#16499)

* eth/downloader: wait for all fetcher goroutines to exit before terminating (#16509)

* cmd/clef, signer: initial poc of the standalone signer (#16154)

* signer: introduce external signer command

* cmd/signer, rpc: Implement new signer. Add info about remote user to Context

* signer: refactored request/response, made use of urfave.cli

* cmd/signer: Use common flags

* cmd/signer: methods to validate calldata against abi

* cmd/signer: work on abi parser

* signer: add mutex around UI

* cmd/signer: add json 4byte directory, remove passwords from api

* cmd/signer: minor changes

* cmd/signer: Use ErrRequestDenied, enable lightkdf

* cmd/signer: implement tests

* cmd/signer: made possible for UI to modify tx parameters

* cmd/signer: refactors, removed channels in ui comms, added UI-api via stdin/out

* cmd/signer: Made lowercase json-definitions, added UI-signer test functionality

* cmd/signer: update documentation

* cmd/signer: fix bugs, improve abi detection, abi argument display

* cmd/signer: minor change in json format

* cmd/signer: rework json communication

* cmd/signer: implement mixcase addresses in API, fix json id bug

* cmd/signer: rename fromaccount, update pythonpoc with new json encoding format

* cmd/signer: make use of new abi interface

* signer: documentation

* signer/main: remove redundant  option

* signer: implement audit logging

* signer: create package 'signer', minor changes

* common: add 0x-prefix to mixcaseaddress in json marshalling + validation

* signer, rules, storage: implement rules + ephemeral storage for signer rules

* signer: implement OnApprovedTx, change signing response (API BREAKAGE)

* signer: refactoring + documentation

* signer/rules: implement dispatching to next handler

* signer: docs

* signer/rules: hide json-conversion from users, ensure context is cleaned

* signer: docs

* signer: implement validation rules, change signature of call_info

* signer: fix log flaw with string pointer

* signer: implement custom 4byte databsae that saves submitted signatures

* signer/storage: implement aes-gcm-backed credential storage

* accounts: implement json unmarshalling of url

* signer: fix listresponse, fix gas->uint64

* node: make http/ipc start methods public

* signer: add ipc capability+review concerns

* accounts: correct docstring

* signer: address review concerns

* rpc: go fmt -s

* signer: review concerns+ baptize Clef

* signer,node: move Start-functions to separate file

* signer: formatting

* light: new CHTs (#16515)

* params: release Geth v1.8.4

* VERSION, params: begin v1.8.5 release cycle

* build: enable goimports and varcheck linters (#16446)

* core/asm: remove unused condition (#16487)

* cmd/utils: fix help template issue for subcommands (#16351)

* rpc: clean up IPC handler (#16524)

This avoids logging accept errors on shutdown and removes
a bit of duplication. It also fixes some goimports lint warnings.

* core/asm: accept uppercase instructions (#16531)

* all: fix various typos (#16533)

* fix typo

* fix typo

* fix typo

* rpc: handle HTTP response error codes (#16500)

* whisper/whisperv6: post returns the hash of sent message (#16495)

* ethclient: add DialContext and Close (#16318)

DialContext allows users to pass a Context object for cancellation.
Close closes the underlying RPC connection.

* vendor: update elastic/gosigar so that it compiles on OpenBSD (#16542)

* eth/downloader: fix for Issue #16539 (#16546)

* params: release Geth v1.8.5 - Dirty Derivative²

* VERSION, params: begin Geth 1.8.6 release cycle

* cmd/geth: update the copyright year in the geth command usage (#16537)

* Revert \"Dockerfile.alltools: fix invalid command\"

* Revert \"cmd/puppeth: fix node deploys for updated dockerfile user\"

* Dockerfile: revert the user change PR that broke all APIs

* Dockerfile: drop legacy discovery v5 port mappings

* params: release v1.8.6 to fix docker images

* VERSION, params: begin release cycle 1.8.7

* cmd/geth, mobile: add memsize to pprof server (#16532)

* cmd/geth, mobile: add memsize to pprof server

This is a temporary change, to be reverted before the next release.

* cmd/geth: fix variable name

* core/types: avoid duplicating transactions on changing signer (#16435)

* core/state: cache missing storage entries (#16584)

* cmd/utils: point users to --syncmode under DEPRECATED (#16572)

Indicate that --light and --fast options are replaced by --syncmode

* trie: remove unused `buf` parameter (#16583)

* core, eth: fix tracer dirty finalization

* travis.yml: remove obsolete brew-cask install

* whisper: Golint fixes in whisper packages (#16637)

* vendor: fix leveldb crash when bigger than 1 TiB

* core: ensure local transactions aren't discarded as underpriced

This fixes an issue where local transactions are discarded as
underpriced when the pool and queue are full.

* evm/main: use blocknumber from genesis

* accounts: golint updates for this or self warning (#16627)

* tests: golint fixes for tests directory (#16640)

* trie: golint iterator fixes (#16639)

* internal: golint updates for this or self warning (#16634)

* core: golint updates for this or self warning (#16633)

* build: Add ldflags -s -w when building aar

Smaller size on mobile is always good.
Might also solve our maven central upload problem

* cmd/clef: documentation about setup (#16568)

clef: documentation about setup

* params: release geth 1.8.7

* VERSION, params: begin v1.8.8 release cycle

* log: changed if-else blocks to conform with golint (#16661)

* p2p: changed if-else blocks to conform with golint (#16660)

* les: changed if-else blocks to conform with golint (#16658)

* accounts: changed if-else blocks to conform with golint (#16654)

* rpc: golint error with context as last parameter (#16657)

* rpc/*: golint error with context as last parameter

* Update json.go

* metrics: golint updates for this or self warning (#16635)

* metrics/*: golint updates for this or self warning

* metrics/*: golint updates for this or self warning, updated pr from feedback

* consensus/ethash: fixed typo (#16665)

* event: golint updates for this or self warning (#16631)

* event/*: golint updates for this or self warning

* event/*: golint updates for this or self warning, pr updated per feedback

* eth: golint updates for this or self warning (#16632)

* eth/*:golint updates for this or self warning

* eth/*: golint updates for this or self warning, pr updated per feedback

* signer: fix golint errors (#16653)

* signer/*: golint fixes

Specifically naming and comment formatting for documentation

* signer/*: fixed naming error crashing build

* signer/*: corrected error

* signer/core: fix tiny error whitespace

* signer/rules: fix test refactor

* whisper/mailserver: pass init error to the caller (#16671)

* whisper/mailserver: pass init error to the caller

* whisper/mailserver: add returns to fmt.Errorf

* whisper/mailserver: check err in mailserver init test

* common: changed if-else blocks to conform with golint (#16656)

* mobile: add GetStatus Method for Receipt (#16598)

* core/rawdb: separate raw database access to own package (#16666)

* rlp: fix some golint warnings (#16659)

* p2p: fix some golint warnings (#16577)

* eth/filters: derive FilterCriteria from ethereum.FilterQuery (#16629)

* p2p/simulations/adapters: fix websocket log line parsing in exec adapter (#16667)

* build: specify the key to use when invoking gpg:sign-and-deploy-file (#16696)

* crypto: fix golint warnings (#16710)

* p2p: don't discard reason set by Disconnect (#16559)

Peer.run was discarding the reason for disconnection sent to the disc
channel by Disconnect.

* cmd: various golint fixes (#16700)

* cmd: various golint fixes

* cmd: update to pr change request

* cmd: update to pr change request

* eth: golint fixes to variable names (#16711)

* eth/filter: check nil pointer when unsubscribe (#16682)

* eth/filter: check nil pointer when unsubscribe

* eth/filters, accounts, rpc: abort system if subscribe failed

* eth/filter: add crit log before exit

* eth/filter, event: minor fixes

* whisper/shhclient: update call to shh_generateSymKeyFromPassword to pass a string (#16668)

* all: get rid of error when creating memory database (#16716)

* all: get rid of error when create mdb

* core: clean up variables definition

* all: inline mdb definition

* event: document select case slice use and add edge case test (#16680)

Feed keeps active subscription channels in a slice called 'f.sendCases'.
The Send method tracks the active cases in a local variable 'cases'
whose value is f.sendCases initially. 'cases' shrinks to a shorter
prefix of f.sendCases every time a send succeeds, moving the successful
case out of range of the active case list.

This can be confusing because the two slices share a backing array. Add
more comments to document what is going on. Also add a test for removing
a case that is in 'f.sentCases' but not 'cases'.

* travis: use Android NDK 16b (#16562)

* bmt: golint updates for this or self warning (#16628)

* bmt/*: golint updates for this or self warning

* Update bmt.go

* light: new CHT for mainnet and ropsten (#16736)

* params: release go-ethereum v1.8.8

* VERSION, params: start 1.8.9 release cycle

* accounts/abi: allow abi: tags when unpacking structs

Go code users can now tag event struct members with `abi:` to specify in what fields the event will be de-serialized.

See PR #16648 for details.

* travis: try to upgrade android builder to trusty

* p2p/enr: updates for discovery v4 compatibility (#16679)

This applies spec changes from ethereum/EIPs#1049 and adds support for
pluggable identity schemes.

Some care has been taken to make the \"v4\" scheme standalone. It uses
public APIs only and could be moved out of package enr at any time.

A couple of minor changes were needed to make identity schemes work:

- The sequence number is now updated in Set instead of when signing.
- Record is now copy-safe, i.e. calling Set on a shallow copy doesn't
  modify the record it was copied from.

* all: collate new transaction events together

* core, eth: minor txpool event cleanups

* travis, appveyor: bump Go release to 1.10.2

* core, consensus: fix some typos in comment code and output log

* eth: propagate blocks and transactions async

* trie: fixes to comply with golint (#16771)

* log: fixes for golint warnings (#16775)

* node: all golint warnings fixed (#16773)

* node: all golint warnings fixed

* node: rm per peter

* node: rm per peter

* vendor, ethdb: print warning log if leveldb is performing compaction (#16766)

* vendor: update leveldb package

* ethdb: print warning log if db is performing compaction

* ethdb: update annotation and log

* core/types: convert status type from uint to uint64 (#16784)

* trie: support proof generation from the iterator

* core/vm: fix typo in instructions.go (#16788)

* core: use a wrapped map to remove contention in `TxPool.Get`. (#16670)

* core: use a wrapped `map` and `sync.RWMutex` for `TxPool.all` to remove contention in `TxPool.Get`.

* core: Remove redundant `txLookup.Find` and improve comments on txLookup methods.

* trie: cleaner logic, one less func call

* eth, node, trie: fix minor typos (#16802)

* params: release go-ethereum v1.8.9

* VERSION, params: begin 1.8.10 release cycle

* ethereum: fix a typo in FilterQuery{} (#16827)

Fix a spelling mistake in comment

* eth/fetcher: reuse variables for hash and number (#16819)

* whisper/shhclient: update call to shh_post to expect string instead of bool (#16757)

Fixes #16756

* common: improve documentation comments (#16701)

This commit adds many comments and removes unused code.
It also removes the EmptyHash function, which had some uses
but was silly.

* core/vm: fix typo in comment

* p2p/discv5: add egress/ingress traffic metrics to discv5 udp transport (#16369)

* core: improve test for TransactionPriceNonceSort (#16413)

* trie: rename TrieSync to Sync and improve hexToKeybytes (#16804)

This removes a golint warning: type name will be used as trie.TrieSync by
other packages, and that stutters; consider calling this Sync.

In hexToKeybytes len(hex) is even and (even+1)/2 == even/2, remove the +1.

* core: fix transaction event asynchronicity

* params: release Geth 1.8.10 hotfix

* VERSION, params: begin 1.8.11 release cycle

* ethstats: fix last golint warning (#16837)

* console: squash golint warnings (#16836)

* rpc: use HTTP request context as top-level context (#16861)

* consensus/ethash: reduce keccak hash allocations (#16857)

Use Read instead of Sum to avoid internal allocations and
copying the state.

name                      old time/op  new time/op  delta
CacheGeneration-8          764ms ± 1%   579ms ± 1%  -24.22%  (p=0.000 n=20+17)
SmallDatasetGeneration-8  75.2ms ±12%  60.6ms ±10%  -19.37%  (p=0.000 n=20+20)
HashimotoLight-8          1.58ms ±11%  1.55ms ± 8%     ~     (p=0.322 n=20+19)
HashimotoFullSmall-8      4.90µs ± 1%  4.88µs ± 1%   -0.31%  (p=0.013 n=19+18)

* core, eth, trie: streaming GC for the trie cache (#16810)

* core, eth, trie: streaming GC for the trie cache

* trie: track memcache statistics

* rpc: set timeouts for http server, see #16859

* metrics: expvar support for ResettingTimer (#16878)

* metrics: expvar support for ResettingTimer

* metrics: use integers for percentiles; remove Overall

* metrics: fix edge-case panic for index-out-of-range

* cmd/geth: cap cache allowance

* core: fix typo in comment code

* les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)

* eth/tracers: fix minor off-by-one error (#16879)

* tracing: fix minor off-by-one error

* tracers: go generate

* core: concurrent background transaction sender ecrecover

* miner: not call commitNewWork if it's a side block (#16751)

* cmd/abigen: support for reading solc output from stdin (#16683)

Allow the --abi flag to be given - to indicate that it should read the
ABI information from standard input. It expects to read the solc output
with the --combined-json flag providing bin, abi, userdoc, devdoc, and
metadata, and works very similarly to the internal invocation of solc,
except it allows external invocation of solc.

This facilitates integration with more complex solc invocations, such
as invocations that require path remapping or --allow-paths tweaks.

Simple usage example:

    solc --combined-json bin,abi,userdoc,devdoc,metadata *.sol | abigen --abi -

* params: fix golint warnings (#16853)

params: fix golint warnings

* vendor: added vendor packages necessary for the swarm-network-rewrite merge (#16792)

* vendor: added vendor packages necessary for the swarm-network-rewrite merge into ethereum master

* vendor: removed multihash deps

* trie: reduce hasher allocations (#16896)

* trie: reduce hasher allocations

name    old time/op    new time/op    delta
Hash-8    4.05µs ±12%    3.56µs ± 9%  -12.13%  (p=0.000 n=20+19)

name    old alloc/op   new alloc/op   delta
Hash-8    1.30kB ± 0%    0.66kB ± 0%  -49.15%  (p=0.000 n=20+20)

name    old allocs/op  new allocs/op  delta
Hash-8      11.0 ± 0%       8.0 ± 0%  -27.27%  (p=0.000 n=20+20)

* trie: bump initial buffer cap in hasher

* whisper: re-insert #16757 that has been lost during a merge (#16889)

* cmd/puppeth: fixed a typo in a wizard input query (#16910)

* core: relax type requirement for bc in ApplyTransaction (#16901)

* trie: avoid unnecessary slicing on shortnode decoding (#16917)

optimization code

* cmd/ethkey: add command to change key passphrase (#16516)

This change introduces

    ethkey changepassphrase <keyfile>

to change the passphrase of a key file.

* metrics: return an empty snapshot for NilResettingTimer (#16930)

* light: new CHTs for mainnet and ropsten (#16926)

* ethclient: fix RPC parse error of Parity response (#16924)

The error produced when using a Parity RPC was the following:

ERROR: transaction did not get mined: failed to get tx for txid 0xbdeb094b3278019383c8da148ff1cb5b5dbd61bf8731bc2310ac1b8ed0235226: json: cannot unmarshal non-string into Go struct field txExtraInfo.blockHash of type common.Hash

* core: improve getBadBlocks to return full block rlp (#16902)

* core: improve getBadBlocks to return full block rlp

* core, eth, ethapi: changes to getBadBlocks formatting

* ethapi: address review concerns

* rpc: fix a comment typo (#16929)

* rpc: support returning nil pointer big.Ints (null)

* trie: don't report the root flushlist as an alloc

* metrics: removed repetitive calculations (#16944)

* core/rawdb: wrap db key creations (#16914)

* core/rawdb: use wrappered helper to assemble key

* core/rawdb: wrappered helper to assemble key

* core/rawdb: rewrite the wrapper, pass common.Hash

* ethdb: gracefullly handle quit channel (#16794)

* ethdb: gratefullly handle quit channel

* ethdb: minor polish

* internal/ethapi: reduce pendingTransactions to O(txs+accs) from O(txs*accs)

* les: pass server pool to protocol manager (#16947)

* metrics: fix gofmt linter warnings

* crypto: replace ToECDSAPub with error-checking func UnmarshalPubkey (#16932)

ToECDSAPub was unsafe because it returned a non-nil key with nil X, Y in
case of invalid input. This change replaces ToECDSAPub with
UnmarshalPubkey across the codebase.

* core, eth, les: more efficient hash-based header chain retrieval (#16946)

* les: fix retriever logic (#16776)

This PR fixes a retriever logic bug. When a peer had a soft timeout
and then a response arrived, it always assumed it was the same peer
even though it could have been a later requested one that did not time
out at all yet. In this case the logic went to an illegal state and
deadlocked, causing a goroutine leak.

Fixes #16243 and replaces #16359.
Thanks to @riceke for finding the bug in the logic.

* params: release go-ethereum v1.8.11

* VERSION, params: begin v1.8.12 release cycle

* core: change comment to match code more closely (#16963)

* internal/web3ext: fix method name for enabling mutex profiling (#16964)

* eth/fetcher: fix annotation (#16969)

* core/asm: correct comments typo (#16975)

core/asm/lexer: correct comments typo

* console: correct some comments typo (#16971)

console/console: correct some comments typo

*  #15685 made peer_test.go more portable by using random free port instead of hardcoded port 30303 (#15687)

Improves test portability by resolving 127.0.0.1:0
to get a random free port instead of the hard coded one. Now
the test works if you have a running node on the same
interface already.

Fixes #15685

* all: library changes for swarm-network-rewrite (#16898)

This commit adds all changes needed for the merge of swarm-network-rewrite.
The changes:

- build: increase linter timeout
- contracts/ens: export ensNode
- log: add Output method and enable fractional seconds in format
- metrics: relax test timeout
- p2p: reduced some log levels, updates to simulation packages
- rpc: increased maxClientSubscriptionBuffer to 20000

* core/vm: optimize MSTORE and SLOAD (#16939)

* vm/test: add tests+benchmarks for mstore

* core/vm: less alloc and copying for mstore

* core/vm: less allocs in sload

* vm: check for errors more correctly

* eth/filters: make filterLogs func more readable (#16920)

* cmd/utils: fix NetworkId default when -dev is set (#16833)

Prior to this change, when geth was started with `geth -dev -rpc`,
it would report a network id of `1` in response to the `net_version` RPC
request. But the actual network id it used to verify transactions
was `1337`.

This change causes geth instead respond with `1337` to the `net_version`
RPC when geth is started with `geth -dev -rpc`.

* travis, appveyor: update to Go 1.10.3

* common: all golint warnings removed (#16852)

* common: all golint warnings removed

* common: fixups

* eth: conform better to the golint standards (#16783)

* eth: made changes to conform better to the golint standards

* eth: fix comment nit

* core: reduce nesting in transaction pool code (#16980)

* bmt: fix package documentation comment (#16909)

* common/number: delete unused package (#16983)

This package was meant to hold an improved 256 bit integer library, but
the effort was abandoned in 2015. AFAIK nothing ever used this package.
Time to say goodbye.

* core/asm: correct comments typo (#16974)

* core/asm/compiler: correct comments typo

core/asm/compiler: correct comments typo

* Correct comments typo

* internal/debug: use pprof goroutine writer for debug_stacks (#16892)

* debug: Use pprof goroutine writer in debug.Stacks() to ensure all goroutines are captured.

* Up to 64MB limit, previous code only captured first 1MB of goroutines.

* internal/debug: simplify stacks handler

* fix typo

* fix pointer receiver

* accounts/keystore: assign schema as const instead of var (#16985)

* cmd: remove faucet/puppeth dead code (#16991)

* cmd/faucet: authGitHub is not used anymore

* cmd/puppeth: remove not used code

* mobile: correct comment typo in geth.go (#17021)

* accounts/usbwallet: correct comment typo (#17008)

* core: remove dead code, limit test code scope (#17006)

* core: move test util var/func to test file

* core: remove useless func

*  accounts/usbwallet: correct comment typo (#16998)

* signer: remove useless errorWrapper (#17003)

* travis: use NDK 17b for Android archives (#17029)

* tracers: fix err in 4byte, add some opcode analysis tools

* accounts: remove deadcode isSigned (#16990)

* mobile: correct comment typo in ethereum.go (#17040)

* cmd/geth: remove the tail \",\" from genesis config (#17028)

remove the tail \",\" from genesis config,  which will cause genesis config parse error .

* trie: cache collapsed tries node, not rlp blobs (#16876)

The current trie memory database/cache that we do pruning on stores
trie nodes as binary rlp encoded blobs, and also stores the node
relationships/references for GC purposes. However, most of the trie
nodes (everything apart from a value node) is in essence just a
collection of references.

This PR switches out the RLP encoded trie blobs with the
collapsed-but-not-serialized trie nodes. This permits most of the
references to be recovered from within the node data structure,
avoiding the need to track them a second time (expensive memory wise).

* swarm: network rewrite merge

* les: handle conn/disc/reg logic in the eventloop (#16981)

* les: handle conn/disc/reg logic in the eventloop

* les: try to dial before start eventloop

* les: handle disconnect logic more safely

* les: grammar fix

* log: Change time format

- Keep the tailing zeros.
- Limit precision to milliseconds.

* swarm/fuse: Disable fuse tests, they are flaky (#17072)

* swarm/pss: Hide big network tests under longrunning flag (#17074)

* whisper: Reduce message loop log from Warn to Info (#17055)

* core/vm: clear linter warnings (#17057)

* core/vm: clear linter warnings

* core/vm: review input

* core/vm.go: revert lint in noop as per request

* build: make build/goimports.sh more potable

* node: remove formatting from ResettingTimer metrics if requested in raw

* ethstats: comment minor correction (#17102)

spell correction from `repors` to `reports`

* ethdb, core: implement delete for db batch (#17101)

* vendor: update docker/docker/pkg/reexec so that it compiles on OpenBSD (#17084)

* trie: fix a temporary memory leak in the memcache

* cmd/geth: export metrics to InfluxDB (#16979)

* cmd/geth: add flags for metrics export

* cmd/geth: update usage fields for metrics flags

* metrics/influxdb: update reporter logger to adhere to geth logging convention

* node: documentation typo fix (#17113)

* core/vm: reuse bigint pools across transactions (#17070)

* core/vm: A pool for int pools

* core/vm: fix rebase issue

* core/vm: push leftover stack items after execution, not before

* cmd/p2psim: add exit error output and exit code (#17116)

* p2p/discover: move bond logic from table to transport (#17048)

* p2p/discover: move bond logic from table to transport

This commit moves node endpoint verification (bonding) from the table to
the UDP transport implementation. Previously, adding a node to the table
entailed pinging the node if needed. With this change, the ping-back
logic is embedded in the packet handler at a lower level.

It is easy to verify that the basic protocol is unchanged: we still
require a valid pong reply from the node before findnode is accepted.

The node database tracked the time of last ping sent to the node and
time of last valid pong received from the node. Node endpoints are
considered verified when a valid pong is received and the time of last
pong was called 'bond time'. The time of last ping sent was unused. In
this commit, the last ping database entry is repurposed to mean last
ping _received_. This entry is now used to track whether the node needs
to be pinged back.

The other big change is how nodes are added to the table. We used to add
nodes in Table.bond, which ran when a remote node pinged us or when we
encountered the node in a neighbors reply. The transport now adds to the
table directly after the endpoint is verified through ping. To ensure
that the Table can't be filled just by pinging the node repeatedly, we
retain the isInitDone check. During init, only nodes from neighbors
replies are added.

* p2p/discover: reduce findnode failure counter on success

* p2p/discover: remove unused parameter of loadSeedNodes

* p2p/discover: improve ping-back check and comments

* p2p/discover: add neighbors reply nodes always, not just during init

* consensus/ethash: fixed documentation typo (#17121)

\"proot-of-work\" to \"proof-of-work\"

* light: new CHTs (#17124)

* les: add announcement safety check to light fetcher (#17034)

* params: v1.8.12 stable

* 1.8.12")`
…

`[6005027](/FinTechToken/go-ethereum/commit/6005027e9759f764a65af82777677e91184eaa46)`

```
* build: add -e and -X flags to get more information on [ethereum#16433](https://github.com/ethereum/go-ethereum/issues/16433) ([ethereum#16443](https://github.com/ethereum/go-ethereum/pull/16443))

* core: remove stray account creations in state transition ([ethereum#16470](https://github.com/ethereum/go-ethereum/pull/16470))

The 'from' and 'to' methods on StateTransitions are reader methods and
shouldn't have inadvertent side effects on state.

It is safe to remove the check in 'from' because account existence is
implicitly checked by the nonce and balance checks. If the account has
non-zero balance or nonce, it must exist. Even if the sender account has
nonce zero at the start of the state transition or no balance, the nonce
is incremented before execution and the account will be created at that
time.

It is safe to remove the check in 'to' because the EVM creates the
account if necessary.

Fixes [ethereum#15119](https://github.com/ethereum/go-ethereum/issues/15119)

* travis, appveyor: bump to Go 1.10.1

* travis.yml: add TEST_PACKAGES to speed up swarm testing ([ethereum#16456](https://github.com/ethereum/go-ethereum/pull/16456))

This commit is meant to allow ecosystem projects such as ethersphere
to minimize CI build times by specifying an environment variable with
the packages to run tests on.

If the environment variable isn't defined the build script will test
all packages so this shouldn't affect the main go-ethereum repository.

* les: add ps.lock.Unlock() before return ([ethereum#16360](https://github.com/ethereum/go-ethereum/pull/16360))

* core/state: fix bug in copy of copy State

* core/state: fix ripemd-cornercase in Copy

* core: txpool stable underprice drop order, perf fixes

* miner: remove contention on currentMu for pending data retrievals ([ethereum#16497](https://github.com/ethereum/go-ethereum/pull/16497))

* ethdb: add leveldb write delay statistic ([ethereum#16499](https://github.com/ethereum/go-ethereum/pull/16499))

* eth/downloader: wait for all fetcher goroutines to exit before terminating ([ethereum#16509](https://github.com/ethereum/go-ethereum/pull/16509))

* cmd/clef, signer: initial poc of the standalone signer ([ethereum#16154](https://github.com/ethereum/go-ethereum/pull/16154))

* signer: introduce external signer command

* cmd/signer, rpc: Implement new signer. Add info about remote user to Context

* signer: refactored request/response, made use of urfave.cli

* cmd/signer: Use common flags

* cmd/signer: methods to validate calldata against abi

* cmd/signer: work on abi parser

* signer: add mutex around UI

* cmd/signer: add json 4byte directory, remove passwords from api

* cmd/signer: minor changes

* cmd/signer: Use ErrRequestDenied, enable lightkdf

* cmd/signer: implement tests

* cmd/signer: made possible for UI to modify tx parameters

* cmd/signer: refactors, removed channels in ui comms, added UI-api via stdin/out

* cmd/signer: Made lowercase json-definitions, added UI-signer test functionality

* cmd/signer: update documentation

* cmd/signer: fix bugs, improve abi detection, abi argument display

* cmd/signer: minor change in json format

* cmd/signer: rework json communication

* cmd/signer: implement mixcase addresses in API, fix json id bug

* cmd/signer: rename fromaccount, update pythonpoc with new json encoding format

* cmd/signer: make use of new abi interface

* signer: documentation

* signer/main: remove redundant  option

* signer: implement audit logging

* signer: create package 'signer', minor changes

* common: add 0x-prefix to mixcaseaddress in json marshalling + validation

* signer, rules, storage: implement rules + ephemeral storage for signer rules

* signer: implement OnApprovedTx, change signing response (API BREAKAGE)

* signer: refactoring + documentation

* signer/rules: implement dispatching to next handler

* signer: docs

* signer/rules: hide json-conversion from users, ensure context is cleaned

* signer: docs

* signer: implement validation rules, change signature of call_info

* signer: fix log flaw with string pointer

* signer: implement custom 4byte databsae that saves submitted signatures

* signer/storage: implement aes-gcm-backed credential storage

* accounts: implement json unmarshalling of url

* signer: fix listresponse, fix gas->uint64

* node: make http/ipc start methods public

* signer: add ipc capability+review concerns

* accounts: correct docstring

* signer: address review concerns

* rpc: go fmt -s

* signer: review concerns+ baptize Clef

* signer,node: move Start-functions to separate file

* signer: formatting

* light: new CHTs ([ethereum#16515](https://github.com/ethereum/go-ethereum/pull/16515))

* params: release Geth v1.8.4

* VERSION, params: begin v1.8.5 release cycle

* build: enable goimports and varcheck linters ([ethereum#16446](https://github.com/ethereum/go-ethereum/pull/16446))

* core/asm: remove unused condition ([ethereum#16487](https://github.com/ethereum/go-ethereum/pull/16487))

* cmd/utils: fix help template issue for subcommands ([ethereum#16351](https://github.com/ethereum/go-ethereum/pull/16351))

* rpc: clean up IPC handler ([ethereum#16524](https://github.com/ethereum/go-ethereum/pull/16524))

This avoids logging accept errors on shutdown and removes
a bit of duplication. It also fixes some goimports lint warnings.

* core/asm: accept uppercase instructions ([ethereum#16531](https://github.com/ethereum/go-ethereum/pull/16531))

* all: fix various typos ([ethereum#16533](https://github.com/ethereum/go-ethereum/pull/16533))

* fix typo

* fix typo

* fix typo

* rpc: handle HTTP response error codes ([ethereum#16500](https://github.com/ethereum/go-ethereum/pull/16500))

* whisper/whisperv6: post returns the hash of sent message ([ethereum#16495](https://github.com/ethereum/go-ethereum/pull/16495))

* ethclient: add DialContext and Close ([ethereum#16318](https://github.com/ethereum/go-ethereum/pull/16318))

DialContext allows users to pass a Context object for cancellation.
Close closes the underlying RPC connection.

* vendor: update elastic/gosigar so that it compiles on OpenBSD ([ethereum#16542](https://github.com/ethereum/go-ethereum/pull/16542))

* eth/downloader: fix for Issue [ethereum#16539](https://github.com/ethereum/go-ethereum/issues/16539) ([ethereum#16546](https://github.com/ethereum/go-ethereum/pull/16546))

* params: release Geth v1.8.5 - Dirty Derivative²

* VERSION, params: begin Geth 1.8.6 release cycle

* cmd/geth: update the copyright year in the geth command usage ([ethereum#16537](https://github.com/ethereum/go-ethereum/pull/16537))

* Revert "Dockerfile.alltools: fix invalid command"

* Revert "cmd/puppeth: fix node deploys for updated dockerfile user"

* Dockerfile: revert the user change PR that broke all APIs

* Dockerfile: drop legacy discovery v5 port mappings

* params: release v1.8.6 to fix docker images

* VERSION, params: begin release cycle 1.8.7

* cmd/geth, mobile: add memsize to pprof server ([ethereum#16532](https://github.com/ethereum/go-ethereum/pull/16532))

* cmd/geth, mobile: add memsize to pprof server

This is a temporary change, to be reverted before the next release.

* cmd/geth: fix variable name

* core/types: avoid duplicating transactions on changing signer ([ethereum#16435](https://github.com/ethereum/go-ethereum/pull/16435))

* core/state: cache missing storage entries ([ethereum#16584](https://github.com/ethereum/go-ethereum/pull/16584))

* cmd/utils: point users to --syncmode under DEPRECATED ([ethereum#16572](https://github.com/ethereum/go-ethereum/pull/16572))

Indicate that --light and --fast options are replaced by --syncmode

* trie: remove unused `buf` parameter ([ethereum#16583](https://github.com/ethereum/go-ethereum/pull/16583))

* core, eth: fix tracer dirty finalization

* travis.yml: remove obsolete brew-cask install

* whisper: Golint fixes in whisper packages ([ethereum#16637](https://github.com/ethereum/go-ethereum/pull/16637))

* vendor: fix leveldb crash when bigger than 1 TiB

* core: ensure local transactions aren't discarded as underpriced

This fixes an issue where local transactions are discarded as
underpriced when the pool and queue are full.

* evm/main: use blocknumber from genesis

* accounts: golint updates for this or self warning ([ethereum#16627](https://github.com/ethereum/go-ethereum/pull/16627))

* tests: golint fixes for tests directory ([ethereum#16640](https://github.com/ethereum/go-ethereum/pull/16640))

* trie: golint iterator fixes ([ethereum#16639](https://github.com/ethereum/go-ethereum/pull/16639))

* internal: golint updates for this or self warning ([ethereum#16634](https://github.com/ethereum/go-ethereum/pull/16634))

* core: golint updates for this or self warning ([ethereum#16633](https://github.com/ethereum/go-ethereum/pull/16633))

* build: Add ldflags -s -w when building aar

Smaller size on mobile is always good.
Might also solve our maven central upload problem

* cmd/clef: documentation about setup ([ethereum#16568](https://github.com/ethereum/go-ethereum/pull/16568))

clef: documentation about setup

* params: release geth 1.8.7

* VERSION, params: begin v1.8.8 release cycle

* log: changed if-else blocks to conform with golint ([ethereum#16661](https://github.com/ethereum/go-ethereum/pull/16661))

* p2p: changed if-else blocks to conform with golint ([ethereum#16660](https://github.com/ethereum/go-ethereum/pull/16660))

* les: changed if-else blocks to conform with golint ([ethereum#16658](https://github.com/ethereum/go-ethereum/pull/16658))

* accounts: changed if-else blocks to conform with golint ([ethereum#16654](https://github.com/ethereum/go-ethereum/pull/16654))

* rpc: golint error with context as last parameter ([ethereum#16657](https://github.com/ethereum/go-ethereum/pull/16657))

* rpc/*: golint error with context as last parameter

* Update json.go

* metrics: golint updates for this or self warning ([ethereum#16635](https://github.com/ethereum/go-ethereum/pull/16635))

* metrics/*: golint updates for this or self warning

* metrics/*: golint updates for this or self warning, updated pr from feedback

* consensus/ethash: fixed typo ([ethereum#16665](https://github.com/ethereum/go-ethereum/pull/16665))

* event: golint updates for this or self warning ([ethereum#16631](https://github.com/ethereum/go-ethereum/pull/16631))

* event/*: golint updates for this or self warning

* event/*: golint updates for this or self warning, pr updated per feedback

* eth: golint updates for this or self warning ([ethereum#16632](https://github.com/ethereum/go-ethereum/pull/16632))

* eth/*:golint updates for this or self warning

* eth/*: golint updates for this or self warning, pr updated per feedback

* signer: fix golint errors ([ethereum#16653](https://github.com/ethereum/go-ethereum/pull/16653))

* signer/*: golint fixes

Specifically naming and comment formatting for documentation

* signer/*: fixed naming error crashing build

* signer/*: corrected error

* signer/core: fix tiny error whitespace

* signer/rules: fix test refactor

* whisper/mailserver: pass init error to the caller ([ethereum#16671](https://github.com/ethereum/go-ethereum/pull/16671))

* whisper/mailserver: pass init error to the caller

* whisper/mailserver: add returns to fmt.Errorf

* whisper/mailserver: check err in mailserver init test

* common: changed if-else blocks to conform with golint ([ethereum#16656](https://github.com/ethereum/go-ethereum/pull/16656))

* mobile: add GetStatus Method for Receipt ([ethereum#16598](https://github.com/ethereum/go-ethereum/pull/16598))

* core/rawdb: separate raw database access to own package ([ethereum#16666](https://github.com/ethereum/go-ethereum/pull/16666))

* rlp: fix some golint warnings ([ethereum#16659](https://github.com/ethereum/go-ethereum/pull/16659))

* p2p: fix some golint warnings ([ethereum#16577](https://github.com/ethereum/go-ethereum/pull/16577))

* eth/filters: derive FilterCriteria from ethereum.FilterQuery ([ethereum#16629](https://github.com/ethereum/go-ethereum/pull/16629))

* p2p/simulations/adapters: fix websocket log line parsing in exec adapter ([ethereum#16667](https://github.com/ethereum/go-ethereum/pull/16667))

* build: specify the key to use when invoking gpg:sign-and-deploy-file ([ethereum#16696](https://github.com/ethereum/go-ethereum/pull/16696))

* crypto: fix golint warnings ([ethereum#16710](https://github.com/ethereum/go-ethereum/pull/16710))

* p2p: don't discard reason set by Disconnect ([ethereum#16559](https://github.com/ethereum/go-ethereum/pull/16559))

Peer.run was discarding the reason for disconnection sent to the disc
channel by Disconnect.

* cmd: various golint fixes ([ethereum#16700](https://github.com/ethereum/go-ethereum/pull/16700))

* cmd: various golint fixes

* cmd: update to pr change request

* cmd: update to pr change request

* eth: golint fixes to variable names ([ethereum#16711](https://github.com/ethereum/go-ethereum/pull/16711))

* eth/filter: check nil pointer when unsubscribe ([ethereum#16682](https://github.com/ethereum/go-ethereum/pull/16682))

* eth/filter: check nil pointer when unsubscribe

* eth/filters, accounts, rpc: abort system if subscribe failed

* eth/filter: add crit log before exit

* eth/filter, event: minor fixes

* whisper/shhclient: update call to shh_generateSymKeyFromPassword to pass a string ([ethereum#16668](https://github.com/ethereum/go-ethereum/pull/16668))

* all: get rid of error when creating memory database ([ethereum#16716](https://github.com/ethereum/go-ethereum/pull/16716))

* all: get rid of error when create mdb

* core: clean up variables definition

* all: inline mdb definition

* event: document select case slice use and add edge case test ([ethereum#16680](https://github.com/ethereum/go-ethereum/pull/16680))

Feed keeps active subscription channels in a slice called 'f.sendCases'.
The Send method tracks the active cases in a local variable 'cases'
whose value is f.sendCases initially. 'cases' shrinks to a shorter
prefix of f.sendCases every time a send succeeds, moving the successful
case out of range of the active case list.

This can be confusing because the two slices share a backing array. Add
more comments to document what is going on. Also add a test for removing
a case that is in 'f.sentCases' but not 'cases'.

* travis: use Android NDK 16b ([ethereum#16562](https://github.com/ethereum/go-ethereum/pull/16562))

* bmt: golint updates for this or self warning ([ethereum#16628](https://github.com/ethereum/go-ethereum/pull/16628))

* bmt/*: golint updates for this or self warning

* Update bmt.go

* light: new CHT for mainnet and ropsten ([ethereum#16736](https://github.com/ethereum/go-ethereum/pull/16736))

* params: release go-ethereum v1.8.8

* VERSION, params: start 1.8.9 release cycle

* accounts/abi: allow abi: tags when unpacking structs

Go code users can now tag event struct members with `abi:` to specify in what fields the event will be de-serialized.

See PR [ethereum#16648](https://github.com/ethereum/go-ethereum/pull/16648) for details.

* travis: try to upgrade android builder to trusty

* p2p/enr: updates for discovery v4 compatibility ([ethereum#16679](https://github.com/ethereum/go-ethereum/pull/16679))

This applies spec changes from [ethereum/EIPs#1049](https://github.com/ethereum/EIPs/pull/1049) and adds support for
pluggable identity schemes.

Some care has been taken to make the "v4" scheme standalone. It uses
public APIs only and could be moved out of package enr at any time.

A couple of minor changes were needed to make identity schemes work:

- The sequence number is now updated in Set instead of when signing.
- Record is now copy-safe, i.e. calling Set on a shallow copy doesn't
  modify the record it was copied from.

* all: collate new transaction events together

* core, eth: minor txpool event cleanups

* travis, appveyor: bump Go release to 1.10.2

* core, consensus: fix some typos in comment code and output log

* eth: propagate blocks and transactions async

* trie: fixes to comply with golint ([ethereum#16771](https://github.com/ethereum/go-ethereum/pull/16771))

* log: fixes for golint warnings ([ethereum#16775](https://github.com/ethereum/go-ethereum/pull/16775))

* node: all golint warnings fixed ([ethereum#16773](https://github.com/ethereum/go-ethereum/pull/16773))

* node: all golint warnings fixed

* node: rm per peter

* node: rm per peter

* vendor, ethdb: print warning log if leveldb is performing compaction ([ethereum#16766](https://github.com/ethereum/go-ethereum/pull/16766))

* vendor: update leveldb package

* ethdb: print warning log if db is performing compaction

* ethdb: update annotation and log

* core/types: convert status type from uint to uint64 ([ethereum#16784](https://github.com/ethereum/go-ethereum/pull/16784))

* trie: support proof generation from the iterator

* core/vm: fix typo in instructions.go ([ethereum#16788](https://github.com/ethereum/go-ethereum/pull/16788))

* core: use a wrapped map to remove contention in `TxPool.Get`. ([ethereum#16670](https://github.com/ethereum/go-ethereum/pull/16670))

* core: use a wrapped `map` and `sync.RWMutex` for `TxPool.all` to remove contention in `TxPool.Get`.

* core: Remove redundant `txLookup.Find` and improve comments on txLookup methods.

* trie: cleaner logic, one less func call

* eth, node, trie: fix minor typos ([ethereum#16802](https://github.com/ethereum/go-ethereum/pull/16802))

* params: release go-ethereum v1.8.9

* VERSION, params: begin 1.8.10 release cycle

* ethereum: fix a typo in FilterQuery{} ([ethereum#16827](https://github.com/ethereum/go-ethereum/pull/16827))

Fix a spelling mistake in comment

* eth/fetcher: reuse variables for hash and number ([ethereum#16819](https://github.com/ethereum/go-ethereum/pull/16819))

* whisper/shhclient: update call to shh_post to expect string instead of bool ([ethereum#16757](https://github.com/ethereum/go-ethereum/pull/16757))

Fixes [ethereum#16756](https://github.com/ethereum/go-ethereum/issues/16756)

* common: improve documentation comments ([ethereum#16701](https://github.com/ethereum/go-ethereum/pull/16701))

This commit adds many comments and removes unused code.
It also removes the EmptyHash function, which had some uses
but was silly.

* core/vm: fix typo in comment

* p2p/discv5: add egress/ingress traffic metrics to discv5 udp transport ([ethereum#16369](https://github.com/ethereum/go-ethereum/pull/16369))

* core: improve test for TransactionPriceNonceSort ([ethereum#16413](https://github.com/ethereum/go-ethereum/pull/16413))

* trie: rename TrieSync to Sync and improve hexToKeybytes ([ethereum#16804](https://github.com/ethereum/go-ethereum/pull/16804))

This removes a golint warning: type name will be used as trie.TrieSync by
other packages, and that stutters; consider calling this Sync.

In hexToKeybytes len(hex) is even and (even+1)/2 == even/2, remove the +1.

* core: fix transaction event asynchronicity

* params: release Geth 1.8.10 hotfix

* VERSION, params: begin 1.8.11 release cycle

* ethstats: fix last golint warning ([ethereum#16837](https://github.com/ethereum/go-ethereum/pull/16837))

* console: squash golint warnings ([ethereum#16836](https://github.com/ethereum/go-ethereum/pull/16836))

* rpc: use HTTP request context as top-level context ([ethereum#16861](https://github.com/ethereum/go-ethereum/pull/16861))

* consensus/ethash: reduce keccak hash allocations ([ethereum#16857](https://github.com/ethereum/go-ethereum/pull/16857))

Use Read instead of Sum to avoid internal allocations and
copying the state.

name                      old time/op  new time/op  delta
CacheGeneration-8          764ms ± 1%   579ms ± 1%  -24.22%  (p=0.000 n=20+17)
SmallDatasetGeneration-8  75.2ms ±12%  60.6ms ±10%  -19.37%  (p=0.000 n=20+20)
HashimotoLight-8          1.58ms ±11%  1.55ms ± 8%     ~     (p=0.322 n=20+19)
HashimotoFullSmall-8      4.90µs ± 1%  4.88µs ± 1%   -0.31%  (p=0.013 n=19+18)

* core, eth, trie: streaming GC for the trie cache ([ethereum#16810](https://github.com/ethereum/go-ethereum/pull/16810))

* core, eth, trie: streaming GC for the trie cache

* trie: track memcache statistics

* rpc: set timeouts for http server, see [ethereum#16859](https://github.com/ethereum/go-ethereum/issues/16859)

* metrics: expvar support for ResettingTimer ([ethereum#16878](https://github.com/ethereum/go-ethereum/pull/16878))

* metrics: expvar support for ResettingTimer

* metrics: use integers for percentiles; remove Overall

* metrics: fix edge-case panic for index-out-of-range

* cmd/geth: cap cache allowance

* core: fix typo in comment code

* les: add Skip overflow check to GetBlockHeadersMsg handler ([ethereum#16891](https://github.com/ethereum/go-ethereum/pull/16891))

* eth/tracers: fix minor off-by-one error ([ethereum#16879](https://github.com/ethereum/go-ethereum/pull/16879))

* tracing: fix minor off-by-one error

* tracers: go generate

* core: concurrent background transaction sender ecrecover

* miner: not call commitNewWork if it's a side block ([ethereum#16751](https://github.com/ethereum/go-ethereum/pull/16751))

* cmd/abigen: support for reading solc output from stdin ([ethereum#16683](https://github.com/ethereum/go-ethereum/pull/16683))

Allow the --abi flag to be given - to indicate that it should read the
ABI information from standard input. It expects to read the solc output
with the --combined-json flag providing bin, abi, userdoc, devdoc, and
metadata, and works very similarly to the internal invocation of solc,
except it allows external invocation of solc.

This facilitates integration with more complex solc invocations, such
as invocations that require path remapping or --allow-paths tweaks.

Simple usage example:

    solc --combined-json bin,abi,userdoc,devdoc,metadata *.sol | abigen --abi -

* params: fix golint warnings ([ethereum#16853](https://github.com/ethereum/go-ethereum/pull/16853))

params: fix golint warnings

* vendor: added vendor packages necessary for the swarm-network-rewrite merge ([ethereum#16792](https://github.com/ethereum/go-ethereum/pull/16792))

* vendor: added vendor packages necessary for the swarm-network-rewrite merge into ethereum master

* vendor: removed multihash deps

* trie: reduce hasher allocations ([ethereum#16896](https://github.com/ethereum/go-ethereum/pull/16896))

* trie: reduce hasher allocations

name    old time/op    new time/op    delta
Hash-8    4.05µs ±12%    3.56µs ± 9%  -12.13%  (p=0.000 n=20+19)

name    old alloc/op   new alloc/op   delta
Hash-8    1.30kB ± 0%    0.66kB ± 0%  -49.15%  (p=0.000 n=20+20)

name    old allocs/op  new allocs/op  delta
Hash-8      11.0 ± 0%       8.0 ± 0%  -27.27%  (p=0.000 n=20+20)

* trie: bump initial buffer cap in hasher

* whisper: re-insert [ethereum#16757](https://github.com/ethereum/go-ethereum/pull/16757) that has been lost during a merge ([ethereum#16889](https://github.com/ethereum/go-ethereum/pull/16889))

* cmd/puppeth: fixed a typo in a wizard input query ([ethereum#16910](https://github.com/ethereum/go-ethereum/pull/16910))

* core: relax type requirement for bc in ApplyTransaction ([ethereum#16901](https://github.com/ethereum/go-ethereum/pull/16901))

* trie: avoid unnecessary slicing on shortnode decoding ([ethereum#16917](https://github.com/ethereum/go-ethereum/pull/16917))

optimization code

* cmd/ethkey: add command to change key passphrase ([ethereum#16516](https://github.com/ethereum/go-ethereum/pull/16516))

This change introduces

    ethkey changepassphrase <keyfile>

to change the passphrase of a key file.

* metrics: return an empty snapshot for NilResettingTimer ([ethereum#16930](https://github.com/ethereum/go-ethereum/pull/16930))

* light: new CHTs for mainnet and ropsten ([ethereum#16926](https://github.com/ethereum/go-ethereum/pull/16926))

* ethclient: fix RPC parse error of Parity response ([ethereum#16924](https://github.com/ethereum/go-ethereum/pull/16924))

The error produced when using a Parity RPC was the following:

ERROR: transaction did not get mined: failed to get tx for txid 0xbdeb094b3278019383c8da148ff1cb5b5dbd61bf8731bc2310ac1b8ed0235226: json: cannot unmarshal non-string into Go struct field txExtraInfo.blockHash of type common.Hash

* core: improve getBadBlocks to return full block rlp ([ethereum#16902](https://github.com/ethereum/go-ethereum/pull/16902))

* core: improve getBadBlocks to return full block rlp

* core, eth, ethapi: changes to getBadBlocks formatting

* ethapi: address review concerns

* rpc: fix a comment typo ([ethereum#16929](https://github.com/ethereum/go-ethereum/pull/16929))

* rpc: support returning nil pointer big.Ints (null)

* trie: don't report the root flushlist as an alloc

* metrics: removed repetitive calculations ([ethereum#16944](https://github.com/ethereum/go-ethereum/pull/16944))

* core/rawdb: wrap db key creations ([ethereum#16914](https://github.com/ethereum/go-ethereum/pull/16914))

* core/rawdb: use wrappered helper to assemble key

* core/rawdb: wrappered helper to assemble key

* core/rawdb: rewrite the wrapper, pass common.Hash

* ethdb: gracefullly handle quit channel ([ethereum#16794](https://github.com/ethereum/go-ethereum/pull/16794))

* ethdb: gratefullly handle quit channel

* ethdb: minor polish

* internal/ethapi: reduce pendingTransactions to O(txs+accs) from O(txs*accs)

* les: pass server pool to protocol manager ([ethereum#16947](https://github.com/ethereum/go-ethereum/pull/16947))

* metrics: fix gofmt linter warnings

* crypto: replace ToECDSAPub with error-checking func UnmarshalPubkey ([ethereum#16932](https://github.com/ethereum/go-ethereum/pull/16932))

ToECDSAPub was unsafe because it returned a non-nil key with nil X, Y in
case of invalid input. This change replaces ToECDSAPub with
UnmarshalPubkey across the codebase.

* core, eth, les: more efficient hash-based header chain retrieval ([ethereum#16946](https://github.com/ethereum/go-ethereum/pull/16946))

* les: fix retriever logic ([ethereum#16776](https://github.com/ethereum/go-ethereum/pull/16776))

This PR fixes a retriever logic bug. When a peer had a soft timeout
and then a response arrived, it always assumed it was the same peer
even though it could have been a later requested one that did not time
out at all yet. In this case the logic went to an illegal state and
deadlocked, causing a goroutine leak.

Fixes [ethereum#16243](https://github.com/ethereum/go-ethereum/issues/16243) and replaces [ethereum#16359](https://github.com/ethereum/go-ethereum/pull/16359).
Thanks to [@riceke](https://github.com/riceke) for finding the bug in the logic.

* params: release go-ethereum v1.8.11

* VERSION, params: begin v1.8.12 release cycle

* core: change comment to match code more closely ([ethereum#16963](https://github.com/ethereum/go-ethereum/pull/16963))

* internal/web3ext: fix method name for enabling mutex profiling ([ethereum#16964](https://github.com/ethereum/go-ethereum/pull/16964))

* eth/fetcher: fix annotation ([ethereum#16969](https://github.com/ethereum/go-ethereum/pull/16969))

* core/asm: correct comments typo ([ethereum#16975](https://github.com/ethereum/go-ethereum/pull/16975))

core/asm/lexer: correct comments typo

* console: correct some comments typo ([ethereum#16971](https://github.com/ethereum/go-ethereum/pull/16971))

console/console: correct some comments typo

*  [ethereum#15685](https://github.com/ethereum/go-ethereum/issues/15685) made peer_test.go more portable by using random free port instead of hardcoded port 30303 ([ethereum#15687](https://github.com/ethereum/go-ethereum/pull/15687))

Improves test portability by resolving 127.0.0.1:0
to get a random free port instead of the hard coded one. Now
the test works if you have a running node on the same
interface already.

Fixes [ethereum#15685](https://github.com/ethereum/go-ethereum/issues/15685)

* all: library changes for swarm-network-rewrite ([ethereum#16898](https://github.com/ethereum/go-ethereum/pull/16898))

This commit adds all changes needed for the merge of swarm-network-rewrite.
The changes:

- build: increase linter timeout
- contracts/ens: export ensNode
- log: add Output method and enable fractional seconds in format
- metrics: relax test timeout
- p2p: reduced some log levels, updates to simulation packages
- rpc: increased maxClientSubscriptionBuffer to 20000

* core/vm: optimize MSTORE and SLOAD ([ethereum#16939](https://github.com/ethereum/go-ethereum/pull/16939))

* vm/test: add tests+benchmarks for mstore

* core/vm: less alloc and copying for mstore

* core/vm: less allocs in sload

* vm: check for errors more correctly

* eth/filters: make filterLogs func more readable ([ethereum#16920](https://github.com/ethereum/go-ethereum/pull/16920))

* cmd/utils: fix NetworkId default when -dev is set ([ethereum#16833](https://github.com/ethereum/go-ethereum/pull/16833))

Prior to this change, when geth was started with `geth -dev -rpc`,
it would report a network id of `1` in response to the `net_version` RPC
request. But the actual network id it used to verify transactions
was `1337`.

This change causes geth instead respond with `1337` to the `net_version`
RPC when geth is started with `geth -dev -rpc`.

* travis, appveyor: update to Go 1.10.3

* common: all golint warnings removed ([ethereum#16852](https://github.com/ethereum/go-ethereum/pull/16852))

* common: all golint warnings removed

* common: fixups

* eth: conform better to the golint standards ([ethereum#16783](https://github.com/ethereum/go-ethereum/pull/16783))

* eth: made changes to conform better to the golint standards

* eth: fix comment nit

* core: reduce nesting in transaction pool code ([ethereum#16980](https://github.com/ethereum/go-ethereum/pull/16980))

* bmt: fix package documentation comment ([ethereum#16909](https://github.com/ethereum/go-ethereum/pull/16909))

* common/number: delete unused package ([ethereum#16983](https://github.com/ethereum/go-ethereum/pull/16983))

This package was meant to hold an improved 256 bit integer library, but
the effort was abandoned in 2015. AFAIK nothing ever used this package.
Time to say goodbye.

* core/asm: correct comments typo ([ethereum#16974](https://github.com/ethereum/go-ethereum/pull/16974))

* core/asm/compiler: correct comments typo

core/asm/compiler: correct comments typo

* Correct comments typo

* internal/debug: use pprof goroutine writer for debug_stacks ([ethereum#16892](https://github.com/ethereum/go-ethereum/pull/16892))

* debug: Use pprof goroutine writer in debug.Stacks() to ensure all goroutines are captured.

* Up to 64MB limit, previous code only captured first 1MB of goroutines.

* internal/debug: simplify stacks handler

* fix typo

* fix pointer receiver

* accounts/keystore: assign schema as const instead of var ([ethereum#16985](https://github.com/ethereum/go-ethereum/pull/16985))

* cmd: remove faucet/puppeth dead code ([ethereum#16991](https://github.com/ethereum/go-ethereum/pull/16991))

* cmd/faucet: authGitHub is not used anymore

* cmd/puppeth: remove not used code

* mobile: correct comment typo in geth.go ([ethereum#17021](https://github.com/ethereum/go-ethereum/pull/17021))

* accounts/usbwallet: correct comment typo ([ethereum#17008](https://github.com/ethereum/go-ethereum/pull/17008))

* core: remove dead code, limit test code scope ([ethereum#17006](https://github.com/ethereum/go-ethereum/pull/17006))

* core: move test util var/func to test file

* core: remove useless func

*  accounts/usbwallet: correct comment typo ([ethereum#16998](https://github.com/ethereum/go-ethereum/pull/16998))

* signer: remove useless errorWrapper ([ethereum#17003](https://github.com/ethereum/go-ethereum/pull/17003))

* travis: use NDK 17b for Android archives ([ethereum#17029](https://github.com/ethereum/go-ethereum/pull/17029))

* tracers: fix err in 4byte, add some opcode analysis tools

* accounts: remove deadcode isSigned ([ethereum#16990](https://github.com/ethereum/go-ethereum/pull/16990))

* mobile: correct comment typo in ethereum.go ([ethereum#17040](https://github.com/ethereum/go-ethereum/pull/17040))

* cmd/geth: remove the tail "," from genesis config ([ethereum#17028](https://github.com/ethereum/go-ethereum/pull/17028))

remove the tail "," from genesis config,  which will cause genesis config parse error .

* trie: cache collapsed tries node, not rlp blobs ([ethereum#16876](https://github.com/ethereum/go-ethereum/pull/16876))

The current trie memory database/cache that we do pruning on stores
trie nodes as binary rlp encoded blobs, and also stores the node
relationships/references for GC purposes. However, most of the trie
nodes (everything apart from a value node) is in essence just a
collection of references.

This PR switches out the RLP encoded trie blobs with the
collapsed-but-not-serialized trie nodes. This permits most of the
references to be recovered from within the node data structure,
avoiding the need to track them a second time (expensive memory wise).

* swarm: network rewrite merge

* les: handle conn/disc/reg logic in the eventloop ([ethereum#16981](https://github.com/ethereum/go-ethereum/pull/16981))

* les: handle conn/disc/reg logic in the eventloop

* les: try to dial before start eventloop

* les: handle disconnect logic more safely

* les: grammar fix

* log: Change time format

- Keep the tailing zeros.
- Limit precision to milliseconds.

* swarm/fuse: Disable fuse tests, they are flaky ([ethereum#17072](https://github.com/ethereum/go-ethereum/pull/17072))

* swarm/pss: Hide big network tests under longrunning flag ([ethereum#17074](https://github.com/ethereum/go-ethereum/pull/17074))

* whisper: Reduce message loop log from Warn to Info ([ethereum#17055](https://github.com/ethereum/go-ethereum/pull/17055))

* core/vm: clear linter warnings ([ethereum#17057](https://github.com/ethereum/go-ethereum/pull/17057))

* core/vm: clear linter warnings

* core/vm: review input

* core/vm.go: revert lint in noop as per request

* build: make build/goimports.sh more potable

* node: remove formatting from ResettingTimer metrics if requested in raw

* ethstats: comment minor correction ([ethereum#17102](https://github.com/ethereum/go-ethereum/pull/17102))

spell correction from `repors` to `reports`

* ethdb, core: implement delete for db batch ([ethereum#17101](https://github.com/ethereum/go-ethereum/pull/17101))

* vendor: update docker/docker/pkg/reexec so that it compiles on OpenBSD ([ethereum#17084](https://github.com/ethereum/go-ethereum/pull/17084))

* trie: fix a temporary memory leak in the memcache

* cmd/geth: export metrics to InfluxDB ([ethereum#16979](https://github.com/ethereum/go-ethereum/pull/16979))

* cmd/geth: add flags for metrics export

* cmd/geth: update usage fields for metrics flags

* metrics/influxdb: update reporter logger to adhere to geth logging convention

* node: documentation typo fix ([ethereum#17113](https://github.com/ethereum/go-ethereum/pull/17113))

* core/vm: reuse bigint pools across transactions ([ethereum#17070](https://github.com/ethereum/go-ethereum/pull/17070))

* core/vm: A pool for int pools

* core/vm: fix rebase issue

* core/vm: push leftover stack items after execution, not before

* cmd/p2psim: add exit error output and exit code ([ethereum#17116](https://github.com/ethereum/go-ethereum/pull/17116))

* p2p/discover: move bond logic from table to transport ([ethereum#17048](https://github.com/ethereum/go-ethereum/pull/17048))

* p2p/discover: move bond logic from table to transport

This commit moves node endpoint verification (bonding) from the table to
the UDP transport implementation. Previously, adding a node to the table
entailed pinging the node if needed. With this change, the ping-back
logic is embedded in the packet handler at a lower level.

It is easy to verify that the basic protocol is unchanged: we still
require a valid pong reply from the node before findnode is accepted.

The node database tracked the time of last ping sent to the node and
time of last valid pong received from the node. Node endpoints are
considered verified when a valid pong is received and the time of last
pong was called 'bond time'. The time of last ping sent was unused. In
this commit, the last ping database entry is repurposed to mean last
ping _received_. This entry is now used to track whether the node needs
to be pinged back.

The other big change is how nodes are added to the table. We used to add
nodes in Table.bond, which ran when a remote node pinged us or when we
encountered the node in a neighbors reply. The transport now adds to the
table directly after the endpoint is verified through ping. To ensure
that the Table can't be filled just by pinging the node repeatedly, we
retain the isInitDone check. During init, only nodes from neighbors
replies are added.

* p2p/discover: reduce findnode failure counter on success

* p2p/discover: remove unused parameter of loadSeedNodes

* p2p/discover: improve ping-back check and comments

* p2p/discover: add neighbors reply nodes always, not just during init

* consensus/ethash: fixed documentation typo ([ethereum#17121](https://github.com/ethereum/go-ethereum/pull/17121))

"proot-of-work" to "proof-of-work"

* light: new CHTs ([ethereum#17124](https://github.com/ethereum/go-ethereum/pull/17124))

* les: add announcement safety check to light fetcher ([ethereum#17034](https://github.com/ethereum/go-ethereum/pull/17034))

* params: v1.8.12 stable

* 1.8.12
```

[wgr523](/wgr523)
pushed a commit
to XinFinOrg/XDPoSChain
that referenced
this pull request
[Apr 18, 2023](#ref-commit-0876562)
[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&u=a44e4d9e7b8e5aa3a64a52dc4e14211f370c4ce2&v=4)](/zsfelfoldi) [![@wgr523](https://avatars.githubusercontent.com/u/18133088?s=40&v=4)](/wgr523)

`[les: add Skip overflow check to GetBlockHeadersMsg handler (](/XinFinOrg/XDPoSChain/commit/08765628fc2a16770378bf139c6298ce8dce4afc "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)")[ethereum#…](https://github.com/ethereum/go-ethereum/pull/16891)`
…

`[0876562](/XinFinOrg/XDPoSChain/commit/08765628fc2a16770378bf139c6298ce8dce4afc)`

```
[…16891](https://github.com/ethereum/go-ethereum/pull/16891))
```

[liam-lai](/liam-lai)
pushed a commit
to XinFinOrg/XDPoSChain
that referenced
this pull request
[May 25, 2023](#ref-commit-62de42d)
[![@wgr523](https://avatars.githubusercontent.com/u/18133088?s=40&u=1b7548731c7c0f702f49d81f6d4c1c6630cdfb85&v=4)](/wgr523) [![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=40&u=a44e4d9e7b8e5aa3a64a52dc4e14211f370c4ce2&v=4)](/zsfelfoldi)

`[les: add Skip overflow check to GetBlockHeadersMsg handler (](/XinFinOrg/XDPoSChain/commit/62de42db683860568c3a9b1866d27f46ec9b9ad8 "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891) (#250)

Co-authored-by: Felföldi Zsolt <zsfelfoldi@gmail.com>")[ethereum#…](https://github.com/ethereum/go-ethereum/pull/16891)`
…

`[62de42d](/XinFinOrg/XDPoSChain/commit/62de42db683860568c3a9b1866d27f46ec9b9ad8)`

```
[…16891](https://github.com/ethereum/go-ethereum/pull/16891)) ([#250](https://github.com/XinFinOrg/XDPoSChain/pull/250))

Co-authored-by: Felföldi Zsolt <zsfelfoldi@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fpull%2F16891)

Reviewers

[![@karalabe](https://avatars.githubusercontent.com/u/129561?s=40&v=4)](/karalabe) [karalabe](/karalabe)

karalabe approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**1.8.11**](/ethereum/go-ethereum/milestone/72 "1.8.11")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@zsfelfoldi](https://avatars.githubusercontent.com/u/9884311?s=52&v=4)](/zsfelfoldi) [![@holiman](https://avatars.githubusercontent.com/u/142290?s=52&v=4)](/holiman) [![@karalabe](https://avatars.githubusercontent.com/u/129561?s=52&v=4)](/karalabe)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


