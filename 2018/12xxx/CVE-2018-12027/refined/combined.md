=== Content from blog.phusion.nl_d05e0cfb_20250124_223054.html ===

Hamburger

* Phusion logo
* [Home](https://www.phusion.nl)
* [Passenger](https://www.phusionpassenger.com)
* [Blog](https://blog.phusion.nl)
* [About](https://www.phusion.nl/about)
* Contact

[Twitter](https://twitter.com/phusion_nl)
[Github](https://github.com/phusion)
[Video](https://vimeo.com/phusionnl)

[Privacy Policy & Disclaimer](https://www.phusion.nl/privacy)
[Trademark Notice](https://www.phusion.nl/trademarks)

[Passenger 5.3.2: various security fixes](/2018/06/12/passenger-5-3-2-various-security-fixes/)

![Camden Narzt](/content/images/2016/07/IMG_0673.jpg)

[Camden Narzt](/author/camden-narzt/)
Software Developer

June 12th, 2018

[Passenger](/tag/passenger/)

## About us

Founded in 2008, Phusion creates top of the line server software to power businesses like Apple and Intercom.

Version 5.3.2 of the [Passenger](https://www.phusionpassenger.com/) application server for Ruby, Node.js, Meteor and Python has been released. This release contains fixes for 4 CVEs and we urge you to upgrade.

## [CVE-2018-12029] CHMOD race vulnerability

The [Pulse Security](https://pulsesecurity.co.nz/) team discovered a vulnerability in Passenger.

The file system access race condition allows for local privilege escalation and affects the Nginx module for Passenger versions 5.3.1, all the way back to 3.0.0 (the chown command entered the code in 2010).

The vulnerability was exploitable only when running a non-standard

`passenger_instance_registry_dir`, via a race condition where after a file was created, there was a window in which it could be replaced with a symlink before it was chowned via the path and not the file descriptor.

If the symlink target was to a file which would be executed by root such as root's crontab file, then privilege escalation was possible.

This is now mitigated by using `fchmod()`.

### Improved security warnings for various directories

We recognized that CVE-2018-12029 could be an indication of a larger class of similar vulnerabilities, so we immediately started investigating our codebase for other vulnerabilities. We found that a lot of security properties depend on the security of various directories that the user configured Passenger to use. Therefore, we've introduced more security checks into Passenger.

We now check the permissions on the instance registry directory in the same way we [already check](https://blog.phusion.nl/2017/10/16/passenger-5-1-11/#newsecuritypitfallcheck) the Passenger root directory. If the instance registry directory is not secure, that can result in arbitrary file overwrites so it's good practice to fix these warnings if you see them.

## [CVE-2018-12026 - 12027 - 12028] SpawningKit exploits

Continuing our security investigation, we found a few vulnerabilities in SpawningKit, affecting Passenger versions 5.3.0 - 5.3.1. SpawningKit is subsystem in Passenger responsible for spawning application processes, and it has gotten a major overhaul in version 5.3.0. However this overhaul introduced new vulnerabilities, which allow a malicious app to cause:

1. a local DoS on the system, or
2. a local privilege escalation, or
3. a local information disclosure

Malicious users on the same system, other than the app's user, could use race conditions to make Passenger connect to (and forward traffic to) arbitrary sockets.

In the first case a malicious app could report its PID incorrectly, then fail to start at which point Passenger would kill the PID regardless of who owned it.

In the second and third case, reads and writes to arbitrary file paths could be induced by replacing specific path elements with symlinks.

In the last case if any of the parent directories of the app socket dir is writable by another user (Joe) that is not the app's user (Jane), then Joe can swap that directory with contents he controls. That way, Joe can cause Passenger to connect to (and forward Jane's traffic to) a process that does not actually belong to Jane.

We mitigate these issues with extra permission checks, by using symlink-resistant I/O operations, and by insisting that any sockets must be created inside the instance directory's app's subdirectory. As well as by not killing the PID returned by the preloader unless we have verified that it is indeed genuine (owned by the app user).

### Spawning Error Reporting

During the Handshake step of spawning an app, we ensure that more kinds of spawning exceptions contain environment variable information. This will help us detect bugs or security attacks in the future.

## Various improvements & fixes

* Fixes Meteor support in non-bundled mode (regression from 5.3.0). Closes [GH-2082](https://github.com/phusion/passenger/issues/2082).
* [Apache] Fixes PassengerMaxInstancesPerApp not being respected (regression from config refactor in 5.2.0). Closes [GH-2059](https://github.com/phusion/passenger/issues/2059).
* [Enterprise, Apache] Fixes PassengerMaxInstances not being respected (regression from config refactor in 5.2.0).
* [Enterprise] Fixes passenger-irb being unable to connect to an app process (regression from 5.3.0). Closes [GH-2087](https://github.com/phusion/passenger/issues/2087).

## Installing 5.3.2

Besides support for the latest software (Nginx stable, Ubuntu), the [5.3 series](https://blog.phusion.nl/2018/05/09/passenger-5-3-0/) of Passenger features per-application logfiles. There has been a lot of work on the internals to enable vastly [improved error reporting](https://blog.phusion.nl/2018/05/16/the-bfg-errorpage/).

The 5.x series of Passenger in general brings a plethora of [improvements](https://blog.phusion.nl/2017/01/10/passenger-5-1-1/) in uptime maximization, security and efficiency. Please see the [installation guide](https://www.phusionpassenger.com/library/install/).

## Upgrading to 5.3.2

We strongly advise staying up to date with the latest version.

Check out our upgrade guides for the different platforms:

* [OS X](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#osx)
* [Debian](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#debian_ubuntu)
* [Ubuntu](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#debian_ubuntu)
* [Heroku](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#heroku)
* [Red Hat](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#redhat_centos)
* [CentOS](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#redhat_centos)
* [Ruby gem](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#rubygems)
* [Tarball](https://www.phusionpassenger.com/docs/advanced_guides/install_and_upgrade/standalone/upgrade.html#source_tarball)
* [Docker](https://github.com/phusion/passenger-docker#upgrading_passenger)

If you are upgrading from 4.x, please read [the 5.0 upgrade notes](https://www.phusionpassenger.com/library/install/migrating/) to learn about potential upgrade caveats.

Please be aware that you can enjoy [enterprise features](https://www.phusionpassenger.com/enterprise) and sponsor the open source development directly by [buying Phusion Passenger Enterprise](https://www.phusionpassenger.com/get_it_now).

## Supercharge your Ruby, Node.js and Python apps

Over 650,000+ sites use **Passenger** as their app server to ensure that their web apps, microservices and APIs are served with outstanding reliability, performance and control.

[learn more](https://www.phusionpassenger.com)

[![](/assets/images/github.svg) Follow on Github](https://github.com/phusion/passenger)

[![](/assets/images/github.svg) Follow @phusion](https://github.com/phusion)

[### Passenger 6

Now supporting all languages](https://www.phusionpassenger.com/passenger6)
[### Discuss on HackerNews

Let us know your thoughts!](https://news.ycombinator.com/submitlink?u=https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/&t=Passenger 5.3.2: various security fixes)
[### Discuss on Twitter

And follow us on @phusion\_nl](https://twitter.com/share?text=Passenger%205.3.2%3A%20various%20security%20fixes&url=https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/)

# Stay in the event loop

Get news and tips on our products and/or programming in general.

## Related articles

* [Lower latencies during deploys in new releases of Phusion Passenger](/2024/12/10/changes-to-routing-in-passenger/)
* [Passenger 6.0.24](/2024/12/09/passenger-6-0-24/)
* [Passenger 6.0.23](/2024/07/29/passenger-6-0-23/)
* [Passenger 6.0.22](/2024/05/18/passenger-6-0-22/)
* [Passenger 6.0.21](/2024/05/17/passenger-6-0-21/)
* [Passenger 6.0.20](/2024/01/22/passenger-6-0-20/)
* [Passenger 6.0.19](/2023/11/20/passenger-6-0-19/)
* [Passenger 6.0.18](/2023/06/12/passenger-6-0-18/)
* [Passenger 6.0.17](/2023/01/25/passenger-6-0-17/)
* [Passenger 6.0.16](/2022/12/19/passenger-6-0-16/)

logo

### Products

* [Passenger](https://www.phusionpassenger.com)
* [Premium Support](https://www.phusionpassenger.com/support)

### About

* [Mission](https://www.phusion.nl/about#splash)

### Contact

* General
* [Security](https://www.phusionpassenger.com/contact)

[Twitter](https://twitter.com/phusion_nl)
[Github](https://github.com/phusion)
[Video](https://vimeo.com/phusionnl)

[Privacy Policy & Disclaimer](https://www.phusion.nl/privacy) | [Trademark Notice](https://www.phusion.nl/trademarks)
Copyright ©  Phusion® B.V. All rights reserved.



=== Content from security.gentoo.org_14871d02_20250124_223054.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Passenger: Multiple Vulnerabilities — GLSA **201807-02**

Multiple vulnerabilities have been found in Passenger, the worst of
which could result in the execution of arbitrary code.

### Affected packages

| Package | **www-apache/passenger** on all architectures |
| --- | --- |
| Affected versions | < **5.3.2** |
| Unaffected versions | >= **5.3.2** |

### Background

Passenger runs and manages your Ruby, Node.js, and Python apps.

### Description

Multiple vulnerabilities have been discovered in Passenger. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker could escalate privileges, execute arbitrary code,
cause a Denial of Service condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Passenger users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apache/passenger-5.3.2"

```
### References

* [CVE-2018-12026](https://nvd.nist.gov/vuln/detail/CVE-2018-12026)
* [CVE-2018-12027](https://nvd.nist.gov/vuln/detail/CVE-2018-12027)
* [CVE-2018-12028](https://nvd.nist.gov/vuln/detail/CVE-2018-12028)
* [CVE-2018-12029](https://nvd.nist.gov/vuln/detail/CVE-2018-12029)

**Release date**

July 22, 2018

**Latest revision**

July 22, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [658346](https://bugs.gentoo.org/show_bug.cgi?id=658346)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


