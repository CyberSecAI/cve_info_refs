=== Content from www.danieldent.com_87e63389_20250126_002931.html ===
[![](https://www.danieldent.com/wordpress/wp-content/uploads/2014/09/cropped-10682924_10154583007850483_1541874677_o-cropped.jpg)](https://www.danieldent.com/)

[Daniel Dent](https://www.danieldent.com/)

Entrepreneur. Developer. Product manager. Leader. Founder of [Digital Market Maker](http://www.digitalmarketmaker.com/) - technology that empowers.

[About Me](/about/) / [Contact Me](/contact/)

#### Follow me:

* [Facebook](https://www.facebook.com/DanielDent)
* [GitHub](https://github.com/DanielDent)
* [LinkedIn](https://www.linkedin.com/in/danieldent)
* [Twitter](https://www.twitter.com/DanielDent)

The contents of this site represent my personal opinion at the time of publishing, which may differ from the official views of organizations I am affiliated with. Technology changes quickly, and some content on this site may no longer reflect my current views.

Copyright © 2025 Daniel Dent.

[Privacy Policy & Terms of Use](/privacy-policy-tos/)
# The RESTLESS Vulnerability: Non-Browser Based Cross-Domain HTTP Request Attacks

June 26, 2018

Share This:[Facebook0](https://www.facebook.com/sharer.php?u=https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/)[LinkedIn0](https://www.linkedin.com/cws/share?url=https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/)[Twitter0](https://twitter.com/share?original_referer=https%3A%2F%2Fwww.danieldent.com%2F&source=tweetbutton&text=The+RESTLESS+Vulnerability%3A+Non-Browser+Based+Cross-Domain+HTTP+Request+Attacks&url=https%3A%2F%2Fwww.danieldent.com%2Fblog%2Frestless-vulnerability-non-browser-cross-domain-http-request-attacks%2F&via=DanielDent "Be the first one to tweet this article!")

I am the author of the advisory below. As of publication, no CVE number has been issued. This post will be updated when a CVE number is issued.

This advisory describes a class of security vulnerabilities which can manifest due to choices made during HTTP API design and implementation. These vulnerabilities may be used to bypass network security policies and enable data exflitration or unauthorized API use.

Due to it’s reliance on the Google Cloud Storage SDK, users of the current version of [rclone](https://rclone.org/) are at risk of being impacted by this attack. If a user uses the `rclone sync` command to migrate data between different Google Cloud Storage buckets, a situation is created where the full contents of any arbitrary URL chosen by the Google Cloud Storage API server will be silently sent to Google.

Implementation choices made by users of vulnerable API designs may exacerbate or mitigate these weaknesses. As this vulnerability represents a specific instance of the generalized [confused deputy problem](https://en.wikipedia.org/wiki/Confused_deputy_problem), environments relying on [ambient authority](https://en.wikipedia.org/wiki/Ambient_authority) for access control will be especially impacted.

This attack builds on the vulnerability discovered and disclosed by [Joey Hess](https://joeyh.name/) in [CVE-2018-10857](https://git-annex.branchable.com/security/CVE-2018-10857_and_CVE-2018-10859/) ([more information](https://joeyh.name/blog/entry/two_security_holes_and_a_new_library/)).

Application developers building non-browser applications do not benefit from the security domain isolation frameworks provided by modern web browsers; developers remain responsible for considering and mitigating the opportunities for unintended interaction across trust boundaries.

## Vulnerability Scenarios

1. API clients which perform actions on URLs chosen by an API server
2. API clients that follow URL redirects provided by an API server

API clients using network transports that are vulnerable to man-in-the-middle attacks will be vulnerable to attack not just by attackers who have gained control over the API server, but also by attackers capable of performing man-in-the-middle attacks.

## Known Affected APIs

Software implementing unmitigated approaches to using the following APIs:

* [Google Cloud Storage](https://cloud.google.com/storage/docs/json_api/v1/objects)
* [Backblaze B2](https://www.backblaze.com/b2/docs/b2_get_upload_url.html)
* [Yandex Disk](https://tech.yandex.com/disk/api/reference/content-docpage/)

Both the Python & Go SDKs provided by Google Cloud are vulnerable to variant 1 of this attack.

This advisory may also apply to other cloud storage APIs.

The Azure Blob Storage SDK examined by the author of this advisory uses a design which mitigates variant 1 of this attack.

## Example Attack Scenarios

In the context of a RESTful API implementation, an attacker with control of the API server returns to the client a URL from which they want the client to push or pull data. Alternatively, the API server uses an HTTP redirect to cause the client to interact with a URL of the API server’s choosing.

This allows the attacker to cause the client to request data from a URL of the attacker’s choosing, creating opportunities for data exflitration when that data is later made available to a different trust domain. In clients that PUT or POST data to arbitrary URLs, it allows the attacker to cause PUT or POST requests to be sent to URLs which system designers may assume are inaccessible.

Clients frequently have access to URLs which must remain private. Some software uses the ‘file://’ syntax to allow access to arbitrary system files. URLs hosted on local or private IP addresses are frequently accessible without authentication. In cloud environments, data available at 169.254.169.254 sometimes includes credentials which create significant privilege escalation opportunities. Any data that is authenticated through ambient authority is exposed.

## Attack Mitigations

The following system design choices will help mitigate the concerns described by this advisory:

* Create a whitelist of URLs or URL patterns which are safe to access
* Implement a ‘same-origin’ policy at the appropriate level of abstraction for the application. Choosing appropriate trust boundaries may require awareness of the application domain.
* Avoid following URL redirects. If choosing to follow URL redirects, carefully consider the implications of allowing redirects to cross trust boundaries.
* Do not accept any arbitrary URLs from remote servers. Generate all URLs on the client side. Use URL naming strategies which help clarify when a trust boundary is being crossed.
* Use only configurations which are not vulnerable to man-in-the-middle attacks. If using HTTPS, ensure that appropriate certificate verification occurs.
* Give special consideration to DNS rebinding attacks. Blacklist connections to IP space intended for internal use. Be mindful of IPv6, IPv4, and IPv6 mappings of IPv4 IP space.

Google has declined to fix the above vulnerability through their security vulnerability reporting program. As of publication, no expected fix date is available.

### Share this:

* [Facebook](https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/?share=linkedin "Click to share on LinkedIn")
* [Twitter](https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/?share=twitter "Click to share on Twitter")
* [Reddit](https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/?share=reddit "Click to share on Reddit")

#### Email Newsletter

Keep up to date and be notified when I update my blog.

Your privacy will be respected. Unsubscribe at any time.



=== Content from openwall.com_eea16db1_20250126_002929.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <a75f7cf8-c89a-b431-e7a7-58f43c2f6b2f@ddent.net>
Date: Tue, 26 Jun 2018 17:56:18 -0700
From: oss-security-list@...tactdaniel.net
To: oss-security@...ts.openwall.com
Subject: rclone data exflitration / unauthorized API use

Due to it's reliance on vulnerable upstream vendor SDKs & APIs, all
current versions of 'rclone' are subject to a variety of attacks.

This vulnerability is an instance of a class of security vulnerabilities
that affect a wide variety of software. Any API which has clients
perform actions on arbitrary URLs chosen by the API server will lead to
this class of attack becoming a concern.

Current Google Cloud Storage SDKs/APIs, Backblaze B2 APIs, and Yandex
Disk APIs are affected.

No CVE is presently assigned.

Further details at:
<https://www.danieldent.com/blog/restless-vulnerability-non-browser-cross-domain-http-request-attacks/>

--
Daniel Dent
<https://www.danieldent.com/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


