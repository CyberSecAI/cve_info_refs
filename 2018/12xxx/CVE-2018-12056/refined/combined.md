=== Content from medium.com_4bf7379e_20250124_161901.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1ab011163d40&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fcoinmonks%2Fto-be-a-winner-of-ethereum-gambling-game-all-for-one-by-breaking-prng-1ab011163d40&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fcoinmonks%2Fto-be-a-winner-of-ethereum-gambling-game-all-for-one-by-breaking-prng-1ab011163d40&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# To be a winner of Ethereum gambling game, All For One, by breaking PRNG (CVE-2018–12056)

[![Jonghyuk Song](https://miro.medium.com/v2/resize:fill:88:88/0*82g6owIHKpt2yAmc.)](/%40jonghyk.song?source=post_page---byline--1ab011163d40--------------------------------)[![Coinmonks](https://miro.medium.com/v2/resize:fill:48:48/1*-_aiJHzJPz655N7iSSrLrQ.png)](https://medium.com/coinmonks?source=post_page---byline--1ab011163d40--------------------------------)

[Jonghyuk Song](/%40jonghyk.song?source=post_page---byline--1ab011163d40--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F8218b7b42412&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fcoinmonks%2Fto-be-a-winner-of-ethereum-gambling-game-all-for-one-by-breaking-prng-1ab011163d40&user=Jonghyuk+Song&userId=8218b7b42412&source=post_page-8218b7b42412--byline--1ab011163d40---------------------post_header-----------)

Published in[Coinmonks](https://medium.com/coinmonks?source=post_page---byline--1ab011163d40--------------------------------)·2 min read·Aug 10, 2018

--

1

Listen

Share

# Abstract

I found a vulnerability in smart contract of ‘[**All For One**](https://all-for-one.club)’ which is a Ethereum gambling game. This game generates random numbers using `keccak256()` function with 4 parameters, such as a private variable `_seed`, `blockhash(block.number-1)`, `block.coinbase`, and `block.difficulty`. They are all publicly readable to anyone, so attackers can get rewards by predicting the random number.

# Details

![]()

Figure 1. play() function

‘**All For One**’ is a Ethereum gambling game. If you want to participate this game, you first bet 0.1 Ether on this contract through `play()` function(See Figure 1). Players who bet on the smart contract are pushed in the array. After an amount of time, a winner is decided by `draw()` function.

![]()

Figure 2. draw() function. A winner is decided by a random value.

In `draw()` function, a winner is decided by a random number. A red box in Figure 2 `produceRandom()` function generates a random number and return it. The random number is a index of a players array.

![]()

Figure 3. maxRandom() function generates a random value using keccak256() function with 4 parameters.

`produceRandom()` function calls `random()`function at line 80, so finally `maxRandom()` function is called(See Figure 3). In `maxRandom()` function, it generates random numbers using `keccak256()` function with 4 parameters. However, all the 4 parameters are publicly readable to anyone. Therefore, attackers can predict the random numbers and can be a winner.

# Exploit

I already explained several times how to exploit these vulnerability in my previous articles. If you want to know the way to exploit it, I recommend reading my articles, especially “[Attack on Pseudo-random number generator (PRNG) used in 1000 Guess, an Ethereum lottery game (CVE-2018–12454)](/%40jonghyk.song/attack-on-pseudo-random-number-generator-prng-used-in-1000-guess-an-ethereum-lottery-game-7b76655f953d)”.

![]()

Figure 4. exploit contract

Figure 4 shows the exploit contract. Attackers bet 0.1 Ether on All For One site and then can be a winner by using the exploit contract.

# Report

I reported it to admin and they patched it. They changed `draw()` function as `private` and generate random numbers by using [Oraclize](https://docs.oraclize.it/#ethereum) library.

# Conclusion

When you generate random numbers in the smart contract, you must not use private variables and variables of past and current blocks.

[Ethereum](/tag/ethereum?source=post_page-----1ab011163d40--------------------------------)[Smart Contracts](/tag/smart-contracts?source=post_page-----1ab011163d40--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----1ab011163d40--------------------------------)[Hacking](/tag/hacking?source=post_page-----1ab011163d40--------------------------------)[Blockchain](/tag/blockchain?source=post_page-----1ab011163d40--------------------------------)

--

--

1

[![Coinmonks](https://miro.medium.com/v2/resize:fill:96:96/1*-_aiJHzJPz655N7iSSrLrQ.png)](https://medium.com/coinmonks?source=post_page---post_publication_info--1ab011163d40--------------------------------)[![Coinmonks](https://miro.medium.com/v2/resize:fill:128:128/1*-_aiJHzJPz655N7iSSrLrQ.png)](https://medium.com/coinmonks?source=post_page---post_publication_info--1ab011163d40--------------------------------)[## Published in Coinmonks](https://medium.com/coinmonks?source=post_page---post_publication_info--1ab011163d40--------------------------------)[96K Followers](/coinmonks/followers?source=post_page---post_publication_info--1ab011163d40--------------------------------)·[Last published 1 hour ago](/coinmonks/trading-tip-of-the-day-9273aa9201af?source=post_page---post_publication_info--1ab011163d40--------------------------------)

Coinmonks is a non-profit Crypto Educational Publication. Other Project — <https://coincodecap.com/> & Email — gaurav@coincodecap.com

[![Jonghyuk Song](https://miro.medium.com/v2/resize:fill:96:96/0*82g6owIHKpt2yAmc.)](/%40jonghyk.song?source=post_page---post_author_info--1ab011163d40--------------------------------)[![Jonghyuk Song](https://miro.medium.com/v2/resize:fill:128:128/0*82g6owIHKpt2yAmc.)](/%40jonghyk.song?source=post_page---post_author_info--1ab011163d40--------------------------------)Follow[## Written by Jonghyuk Song](/%40jonghyk.song?source=post_page---post_author_info--1ab011163d40--------------------------------)[86 Followers](/%40jonghyk.song/followers?source=post_page---post_author_info--1ab011163d40--------------------------------)·[10 Following](/%40jonghyk.song/following?source=post_page---post_author_info--1ab011163d40--------------------------------)

Vehicle Threat Research Lab. at Autocrypt . (<https://freest4r.github.io/>)

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----1ab011163d40--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----1ab011163d40--------------------------------)[About](/about?autoplay=1&source=post_page-----1ab011163d40--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----1ab011163d40--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----1ab011163d40--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----1ab011163d40--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1ab011163d40--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1ab011163d40--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----1ab011163d40--------------------------------)[Teams](/business?source=post_page-----1ab011163d40--------------------------------)



=== Content from lists.apache.org_3d801ea9_20250124_161900.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.


