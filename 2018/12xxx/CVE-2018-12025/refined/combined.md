=== Content from medium.com_220d3044_20250125_143726.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd2251defd6ff&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fsecbit-media%2Fbugged-smart-contract-f-e-how-could-someone-mess-up-with-boolean-d2251defd6ff&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fsecbit-media%2Fbugged-smart-contract-f-e-how-could-someone-mess-up-with-boolean-d2251defd6ff&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)![]()
# Bugged Smart Contract FuturXE: How Could Someone Mess up with Boolean? (CVE-2018–12025)

[![p0n1](https://miro.medium.com/v2/resize:fill:88:88/1*R3fYNBQQVrsQEcwWDjUFAA.png)](/%40p0n1?source=post_page---byline--d2251defd6ff--------------------------------)[![SECBIT Media](https://miro.medium.com/v2/resize:fill:48:48/1*csu7wwkhJqAqZMmPGIjoaQ.png)](https://medium.com/secbit-media?source=post_page---byline--d2251defd6ff--------------------------------)

[p0n1](/%40p0n1?source=post_page---byline--d2251defd6ff--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F283dc972345c&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fsecbit-media%2Fbugged-smart-contract-f-e-how-could-someone-mess-up-with-boolean-d2251defd6ff&user=p0n1&userId=283dc972345c&source=post_page-283dc972345c--byline--d2251defd6ff---------------------post_header-----------)

Published in[SECBIT Media](https://medium.com/secbit-media?source=post_page---byline--d2251defd6ff--------------------------------)·3 min read·Jun 6, 2018

--

Listen

Share

Recently SECBIT team found a serious bug about the `if` condition in a deployed ERC20 smart contract called [FuturXE (FXE)](https://etherscan.io/address/0x9653cfd0865ad8313bea2f0c2ec0584bfd05115b#code) and here is the bugged part:

```
//Function for transer the coin from one address to another
function transferFrom(address from, address to, uint value) returns (bool success) {    //checking account is freeze or not
    if (frozenAccount[msg.sender]) return false;    //checking the from should have enough coins
    if(balances[from] < value) return false;    //checking for allowance
    if( allowed[from][msg.sender] >= value ) return false;    //checking for overflows
    if(balances[to] + value < balances[to]) return false;    balances[from] -= value;
    allowed[from][msg.sender] -= value;
    balances[to] += value;    // Notify anyone listening that this transfer took place
    Transfer(from, to, value);    return true;
}
```

Pay attention to this line: `if( allowed[from][msg.sender] >= value ) return false;` It has a serious bug: the developer messed up with the boolean judgment - if the input value is smaller than or equal to allowed value, the transfer session would stop execution by returning false. This makes no sense because the transferFrom() requires the transferring value not exceeding the allowed value in the first place. Suppose this function asks the allowed value to be smaller than the input, the attackers could easily ignore the allowance: after this condition, the `allowed[from][msg.sender] -= value;` would cause an underflow for that the allowed part is smaller than the value. The attacker could transfer any amount of tokens of any accounts to an appointed account (the `_to`address) because the allowed value is initialized to 0 and the attacker could bypass this restriction even without the victim's private key.

Comparing to this one, we could take the UET bug as a reference (see Reference 1, 2 and 4 for details):

```
function transferFrom(address _from, address _to, uint256 _value) returns (bool success) {
    // mitigates the ERC20 short address attack
    if(msg.data.length < (3 * 32) + 4) {
        throw;
    }
    if (_value == 0) {
        return false;
    }
    uint256 fromBalance = balances[_from];
    uint256 allowance = allowed[_from][msg.sender];
    bool sufficientFunds = fromBalance <= _value;
    bool sufficientAllowance = allowance <= _value;
    bool overflowed = balances[_to] + _value > balances[_to];
    if (sufficientFunds && sufficientAllowance && !overflowed) {
        balances[_to] += _value;
        balances[_from] -= _value;
        allowed[_from][msg.sender] -= _value;
        Transfer(_from, _to, _value);
        return true;
    } else {
        return false;
    }
}
```

With every necessary condition checked, the only problem here is that the programmer was so careless that every judging condition got set as the opposite, e.g. let `fromBalace <= _value` means the transferred money should be no less than the balance. If we just set this condition, there is no doubt that an underflow will occur.

Now some deployed contracts like RemiCoin(RMC) and RoyalClassicCoin(RCL) (see Reference 3 for details) have this kind of bug as well. SECBIT strongly suggest anyone in concern be extremely careful when trading. Sadly we SECBIT team have tried but could not get in touch with the developer team.

## Reference

1. CVE-2018–10468: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10468>
2. UselessEthereumToken(UET), ERC20 Token, allows attackers to steal all victim’s balances (CVE-2018–10468): [https://medium.com/@jonghyk.song/uselessethereumtoken-uet-erc20-token-allows-attackers-to-steal-all-victims-balances-543d42ac808e](/%40jonghyk.song/uselessethereumtoken-uet-erc20-token-allows-attackers-to-steal-all-victims-balances-543d42ac808e)
3. RemiCoin: <https://etherscan.io/address/0x7Dc4f41294697a7903C4027f6Ac528C5d14cd7eB#code>
4. UET: <https://etherscan.io/address/0x27f706edde3aD952EF647Dd67E24e38CD0803DD6#code>
5. FXE: <https://etherscan.io/address/0x9653cfd0865ad8313bea2f0c2ec0584bfd05115b#code>

S`ECBIT` ***was founded by a group of cryptocurrency-enthusiasts. We are doing research on smart contract security, smart contract formal verification, crypto-protocols, compilation, contract analysis, game theory and crypto-economics.***

[Blockchain](/tag/blockchain?source=post_page-----d2251defd6ff--------------------------------)[Smart Contracts](/tag/smart-contracts?source=post_page-----d2251defd6ff--------------------------------)[Security](/tag/security?source=post_page-----d2251defd6ff--------------------------------)[Token](/tag/token?source=post_page-----d2251defd6ff--------------------------------)[Ethereum](/tag/ethereum?source=post_page-----d2251defd6ff--------------------------------)

--

--

[![SECBIT Media](https://miro.medium.com/v2/resize:fill:96:96/1*csu7wwkhJqAqZMmPGIjoaQ.png)](https://medium.com/secbit-media?source=post_page---post_publication_info--d2251defd6ff--------------------------------)[![SECBIT Media](https://miro.medium.com/v2/resize:fill:128:128/1*csu7wwkhJqAqZMmPGIjoaQ.png)](https://medium.com/secbit-media?source=post_page---post_publication_info--d2251defd6ff--------------------------------)[## Published in SECBIT Media](https://medium.com/secbit-media?source=post_page---post_publication_info--d2251defd6ff--------------------------------)[87 Followers](/secbit-media/followers?source=post_page---post_publication_info--d2251defd6ff--------------------------------)·[Last published Jun 15, 2018](/secbit-media/redundant-check-in-erc20-smart-contracts-approve-5a675bb88261?source=post_page---post_publication_info--d2251defd6ff--------------------------------)

SECBIT was founded by a group of cryptocurrency-enthusiasts. We are doing research on smart contract security, smart contract formal verification, crypto-protocols, compilation, contract analysis, game theory and crypto-economics.

[![p0n1](https://miro.medium.com/v2/resize:fill:96:96/1*R3fYNBQQVrsQEcwWDjUFAA.png)](/%40p0n1?source=post_page---post_author_info--d2251defd6ff--------------------------------)[![p0n1](https://miro.medium.com/v2/resize:fill:128:128/1*R3fYNBQQVrsQEcwWDjUFAA.png)](/%40p0n1?source=post_page---post_author_info--d2251defd6ff--------------------------------)Follow[## Written by p0n1](/%40p0n1?source=post_page---post_author_info--d2251defd6ff--------------------------------)[81 Followers](/%40p0n1/followers?source=post_page---post_author_info--d2251defd6ff--------------------------------)·[98 Following](/%40p0n1/following?source=post_page---post_author_info--d2251defd6ff--------------------------------)

Security Researcher @ SECBIT Labs

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----d2251defd6ff--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d2251defd6ff--------------------------------)[About](/about?autoplay=1&source=post_page-----d2251defd6ff--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d2251defd6ff--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d2251defd6ff--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d2251defd6ff--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d2251defd6ff--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d2251defd6ff--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d2251defd6ff--------------------------------)[Teams](/business?source=post_page-----d2251defd6ff--------------------------------)


