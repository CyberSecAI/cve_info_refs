Based on the provided information, here's an analysis of CVE-2018-12247:

*   **Vulnerability:** Null pointer dereference in mrb\_class.
*   **Root Cause:** The `Object#clone` method was copying all flags from the original object, which could overwrite the clone's flags. This could lead to unexpected behavior, including a null pointer dereference.
*   **Affected Platforms:** The issue was reproducible on 32-bit Linux systems, but not on 64-bit Linux or 64-bit macOS.
*   **Attack Vector:** By crafting a specific Ruby script, an attacker could trigger the vulnerability. The provided script is:

```ruby
h = {}
a = []
200.times do |n|
  a[0] = n
  h[a] = 0
  puts h.to_a.clone
end
```

*   **Impact:** The vulnerability leads to a segmentation fault, potentially causing a denial of service.
*   **Fix:** The fix involves allowing `Object#clone` to only copy the frozen status, preventing the overwriting of other flags.

    ```c
    p->flags |= mrb_obj_ptr(self)->flags & MRB_FLAG_IS_FROZEN;
    ```