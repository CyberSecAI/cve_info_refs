The provided content relates to CVE-2018-12678.

**Root cause of vulnerability:**
The `/api/websocket` endpoint in Portainer was vulnerable due to a lack of an authenticated access policy. This allowed unauthorized users to execute requests.

**Weaknesses/vulnerabilities present:**
- **Missing Authentication:** The primary vulnerability was the absence of authentication checks on the `/api/websocket` endpoint.
- **SSRF Vulnerability:** The lack of proper authorization checks on the websocket endpoint also created a potential Server-Side Request Forgery (SSRF) vulnerability. This could potentially allow unauthorized access to the Docker API.

**Impact of exploitation:**
- Unauthorized users could execute requests on the `/api/websocket` endpoint, potentially leading to unauthorized access to sensitive data or actions.
- The SSRF vulnerability could grant unauthorized access to the Docker API, which could lead to further compromise.

**Attack vectors:**
-  A remote, unauthenticated attacker could send malicious requests to the vulnerable `/api/websocket` endpoint.

**Required attacker capabilities/position:**
- The attacker needs to be able to send network requests to the Portainer instance. No prior authentication or special privileges are required.

**Additional details:**
- The fix for this vulnerability was included in Portainer version 1.18.0.
- The vulnerability was addressed by adding an authenticated access policy to the `/api/websocket` endpoint.
- The fix also included validation of the 'id' query parameter for the `/websocket/exec` endpoint
- The commit messages indicate the fix involved centralizing EndpointAccess validation.