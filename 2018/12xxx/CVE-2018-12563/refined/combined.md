=== Content from git.linaro.org_dd248fd0_20250125_221343.html ===


| [cgit logo](/) | [index](/) : [lava.git](/lava/lava.git/ "lava.git") | master release staging |
| --- | --- | --- |
| This project has been moved to https://git.lavasoftware.org/lava/lava See: https://lists.linaro.org/pipermail/lava-announce/2018-September/000064.html |  |

| [about](/lava/lava.git/about/)[summary](/lava/lava.git/)[refs](/lava/lava.git/refs/?id=e24ec39599bc07562ad8bc2a581144b8448cb214)[log](/lava/lava.git/log/)[tree](/lava/lava.git/tree/?id=e24ec39599bc07562ad8bc2a581144b8448cb214)[commit](/lava/lava.git/commit/?id=e24ec39599bc07562ad8bc2a581144b8448cb214)[diff](/lava/lava.git/diff/?id=e24ec39599bc07562ad8bc2a581144b8448cb214) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | RÃ©mi Duraffort <remi.duraffort@linaro.org> | 2018-06-15 16:12:53 +0200 |
| --- | --- | --- |
| committer | Neil Williams <neil.williams@linaro.org> | 2018-06-15 16:21:02 +0100 |
| commit | [e24ec39599bc07562ad8bc2a581144b8448cb214](/lava/lava.git/commit/?id=e24ec39599bc07562ad8bc2a581144b8448cb214) ([patch](/lava/lava.git/patch/?id=e24ec39599bc07562ad8bc2a581144b8448cb214)) | |
| tree | [d3f16e12ed8f7b677be5c79c699f5e28dbdfcff8](/lava/lava.git/tree/?id=e24ec39599bc07562ad8bc2a581144b8448cb214) | |
| parent | [95a9a77b144ced24d7425d6544ab03ca7f6c75d3](/lava/lava.git/commit/?id=95a9a77b144ced24d7425d6544ab03ca7f6c75d3) ([diff](/lava/lava.git/diff/?id=e24ec39599bc07562ad8bc2a581144b8448cb214&id2=95a9a77b144ced24d7425d6544ab03ca7f6c75d3)) | |

Use requests instead of urlopenurllib.request.urlopen accepts every url schemes, including "file://" while
requests does not.
This commit fixes a security issue where a user can force lava-server-gunicorn
to download any file from the filesystem if it's:
\* readable by lavaserver
\* valid yaml
Change-Id: I9f43f16aef814f276f0a563bf6f31cfe9cf481df
[Diffstat](/lava/lava.git/diff/?id=e24ec39599bc07562ad8bc2a581144b8448cb214)

| -rw-r--r-- | [lava\_scheduler\_app/schema.py](/lava/lava.git/diff/lava_scheduler_app/schema.py?id=e24ec39599bc07562ad8bc2a581144b8448cb214) | 19 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 15 deletions

| diff --git a/lava\_scheduler\_app/schema.py b/lava\_scheduler\_app/schema.pyindex bdd7da4f1..3f03f6111 100644--- a/[lava\_scheduler\_app/schema.py](/lava/lava.git/tree/lava_scheduler_app/schema.py?id=95a9a77b144ced24d7425d6544ab03ca7f6c75d3)+++ b/[lava\_scheduler\_app/schema.py](/lava/lava.git/tree/lava_scheduler_app/schema.py?id=e24ec39599bc07562ad8bc2a581144b8448cb214)@@ -1,4 +1,5 @@ import re+import requests import sys import yaml from voluptuous import (@@ -14,16 +15,6 @@ from voluptuous import ( Schema ) -if sys.version\_info[0] == 2:- # Python 2.x- from urllib2 import urlopen- from urllib2 import URLError-elif sys.version\_info[0] == 3:- # For Python 3.0 and later- from urllib.request import urlopen- from urllib.error import URLError-- INVALID\_CHARACTER\_ERROR\_MSG = "Invalid character" INCLUDE\_URL\_TIMEOUT = 10 @@ -444,12 +435,10 @@ def \_validate\_vcs\_parameters(data\_objects):  def \_download\_raw\_yaml(url): try:- data = yaml.load(- urlopen(url, timeout=INCLUDE\_URL\_TIMEOUT).read())- return data- except URLError as e:+ return yaml.load(requests.get(url, timeout=INCLUDE\_URL\_TIMEOUT).content)+ except requests.RequestException as exc: raise SubmissionException(- "Section 'include' must contain valid URL: %s" % e)+ "Section 'include' must contain valid URL: %s" % exc) except yaml.YAMLError as e: raise SubmissionException("Section 'include' must contain URL to a raw file in valid YAML format: %s" % e) |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-25 22:13:42 +0000


