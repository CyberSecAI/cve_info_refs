=== Content from www.mozilla.org_d7623d97_20250125_095249.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-20

## Security vulnerabilities fixed in Firefox 62

Announced
September 5, 2018
Impact
critical
Products
Firefox
Fixed in

* Firefox 62

#### [#CVE-2018-12377: Use-after-free in refresh driver timers](#CVE-2018-12377)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur when refresh driver timers are refreshed in some circumstances during shutdown when the timer is deleted while still in use. This results in a potentially exploitable crash.

##### References

* [Bug 1470260](https://bugzilla.mozilla.org/show_bug.cgi?id=1470260)

#### [#CVE-2018-12378: Use-after-free in IndexedDB](#CVE-2018-12378)

Reporter
Zhanjia Song
Impact
high
##### Description

A use-after-free vulnerability can occur when an IndexedDB index is deleted while still in use by JavaScript code that is providing payload values to be stored. This results in a potentially exploitable crash.

##### References

* [Bug 1459383](https://bugzilla.mozilla.org/show_bug.cgi?id=1459383)

#### [#CVE-2018-18499: Same-origin policy violation using meta refresh and performance.getEntries to steal cross-origin URLs](#CVE-2018-18499)

Reporter
James Lee (@Windowsrcer) of Kryptos Logic
Impact
high
##### Description

A same-origin policy violation allowing the theft of cross-origin URL entries when using a `<meta> meta http-equiv="refresh"` on a page to cause a redirection to another site using `performance.getEntries()`. This is a same-origin policy violation and could allow for data theft.

##### References

* [Bug 1468523](https://bugzilla.mozilla.org/show_bug.cgi?id=1468523)

#### [#CVE-2018-12379: Out-of-bounds write with malicious MAR file](#CVE-2018-12379)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

When the Mozilla Updater opens a MAR format file which contains a very long item filename, an out-of-bounds write can be triggered, leading to a potentially exploitable crash. This requires running the Mozilla Updater manually on the local system with the malicious MAR file in order to occur.

##### References

* [Bug 1473113](https://bugzilla.mozilla.org/show_bug.cgi?id=1473113)

#### [#CVE-2017-16541: Proxy bypass using automount and autofs](#CVE-2017-16541)

Reporter
Filippo Cavallarin
Impact
moderate
##### Description

Browser proxy settings can be bypassed by using the automount feature with autofs to create a mount point on the local file system. Content can be loaded from this mounted file system directly using a `file:` URI, bypassing configured proxy settings.
*Note: this issue only affects OS X in default configurations. On Linux systems, autofs must be installed for the vulnerability to occur and Windows is not affected.*

##### References

* [Bug 1412081](https://bugzilla.mozilla.org/show_bug.cgi?id=1412081)

#### [#CVE-2018-12381: Dragging and dropping Outlook email message results in page navigation](#CVE-2018-12381)

Reporter
Jana Squires
Impact
low
##### Description

Manually dragging and dropping an Outlook email message into the browser will trigger a page navigation when the message's mail columns are incorrectly interpreted as a URL.
*Note: this issue only affects Windows operating systems with Outlook installed. Other operating systems are not affected.*

##### References

* [Bug 1435319](https://bugzilla.mozilla.org/show_bug.cgi?id=1435319)

#### [#CVE-2018-12382: Addressbar spoofing with javascript URI on Firefox for Android](#CVE-2018-12382)

Reporter
Jordi Chancel
Impact
low
##### Description

The displayed addressbar URL can be spoofed on Firefox for Android using a `javascript:` URI in concert with JavaScript to insert text before the loaded domain name, scrolling the loaded domain out of view to the right. This can lead to user confusion.
*This vulnerability only affects Firefox for Android.*

##### References

* [Bug 1479311](https://bugzilla.mozilla.org/show_bug.cgi?id=1479311)

#### [#CVE-2018-12383: Setting a master password post-Firefox 58 does not delete unencrypted previously stored passwords](#CVE-2018-12383)

Reporter
Jurgen Gaeremyn
Impact
low
##### Description

If a user saved passwords before Firefox 58 and then later set a master password, an unencrypted copy of these passwords is still accessible. This is because the older stored password file was not deleted when the data was copied to a new format starting in Firefox 58. The new master password is added only on the new file. This could allow the exposure of stored password data outside of user expectations.

##### References

* [Bug 1475775](https://bugzilla.mozilla.org/show_bug.cgi?id=1475775)

#### [#CVE-2018-12375: Memory safety bugs fixed in Firefox 62](#CVE-2018-12375)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Christian Holler, Looben Yang, Jesse Ruderman, Sebastian Hengst, Nicolas Grunbaum, and Gary Kwong reported memory safety bugs present in Firefox 61. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 62](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1478849%2C1433502%2C1480965%2C894215%2C1462693%2C1475431%2C1461027)

#### [#CVE-2018-12376: Memory safety bugs fixed in Firefox 62 and Firefox ESR 60.2](#CVE-2018-12376)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Alex Gaynor, Boris Zbarsky, Christoph Diehl, Christian Holler, Jason Kratzer, Jed Davis, Tyson Smith, Bogdan Tara, Karl Tomlinson, Mats Palmgren, Nika Layzell, Ted Campbell, and Andrei Cristian Petcu reported memory safety bugs present in Firefox 61 and Firefox ESR 60.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 62 and Firefox ESR 60.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1469309%2C1469914%2C1450989%2C1480092%2C1480517%2C1481093%2C1478575%2C1471953%2C1473161%2C1466991%2C1468738%2C1483120%2C1467363%2C1472925%2C1466577%2C1467889%2C1480521%2C1478849)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_04480c11_20250126_075348.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_075347.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_a5e437b3_20250126_075345.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1435319)
* [XML](/show_bug.cgi?ctype=xml&id=1435319)

Closed
[Bug 1435319](/show_bug.cgi?id=1435319)
(CVE-2018-12381)

Opened 7 years ago
Closed 7 years ago

# Dragging an email from Outlook into a Firefox tab redirects to malicious site

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Dragging an email from Outlook into a Firefox tab redirects to malicious site

## Categories

### (Core :: DOM: Navigation, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Navigation#DOM%3A%20Navigation)

DOM: Navigation
▾

Core :: DOM: Navigation
For bugs with HTML’s [navigate](https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate) algorithm and browsing contexts.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Navigation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

57 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla62

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix) |
| firefox-esr60 | [62+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=62%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) |
| firefox60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=wontfix) |
| firefox61 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=wontfix) |
| firefox62 | [+](/buglist.cgi?f1=cf_tracking_firefox62&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 |  | wontfix |
| firefox-esr60 | 62+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox60 |  | wontfix |
| firefox61 |  | wontfix |
| firefox62 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jana.squires, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/507ec89c0ac55e2729065638cf3caf17?d=mm&size=40)  [jana.squires](/user_profile?user_id=611252)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1467804](/show_bug.cgi?id=1467804 "RESOLVED DUPLICATE - Outlook drag and drop initiates redirect to malicious websites"), [1480734](/show_bug.cgi?id=1480734 "RESOLVED DUPLICATE - Dragging an email from Outlook and dropping it to Firefox results in an automated opening of a (malicious) web page")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low, Whiteboard: [post-critsmash-triage][adv-main62+][adv-esr60.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-12381

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main62+][adv-esr60.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c39 "7 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a13616895_488993 "7 years ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

```
There are two problems here:

1) dropping an email from the Outlook application on Windows gets interpreted as a URL of the outlook mail columns

2) fromsubjectreceivedsizecategories.com is a malicious site taking advantage of this and needs to get blocked.

Getting SafeBrowsing to block the site would mitigate this particular instance, but we're not having much success there. Besides there might be other apps (or a localized Outlook?) that result in different text that gets Firefox to open a different domain that bad people will then domain-squat on in a similar way.
```

## Attachments

### (6 files, 1 obsolete file)

| [Malicious site with Freifox.jpg](/attachment.cgi?id=8947914)  [7 years ago](#c0)  [Jana](/user_profile?user_id=611252)   1.72 MB, image/jpeg |  | [Details](/attachment.cgi?id=8947914&action=edit) |
| --- | --- | --- |
| [malicious site.png](/attachment.cgi?id=8953211)  [7 years ago](#c3)  [Jana](/user_profile?user_id=611252)   97.53 KB, image/png |  | [Details](/attachment.cgi?id=8953211&action=edit) |
| [HTML file to show dropped items](/attachment.cgi?id=8984726)  [7 years ago](#c13)  [Tooru Fujisawa [:arai]](/user_profile?user_id=310076)   2.11 KB, text/html |  | [Details](/attachment.cgi?id=8984726&action=edit) |
| [drag-drop-test results.png](/attachment.cgi?id=8985148)  [7 years ago](#c20)  [Richard Stewart](/user_profile?user_id=619054)   46.23 KB, image/png |  | [Details](/attachment.cgi?id=8985148&action=edit) |
| [Don't fix up protocols for tab-separated content](/attachment.cgi?id=8985175)  [7 years ago](#c24)  [:Gijs (he/him)](/user_profile?user_id=159069)   1.41 KB, patch | bzbarsky : [feedback+](#c31 "7 years ago")  arai : [feedback+](#c26 "7 years ago") | [Details](/attachment.cgi?id=8985175&action=edit) | [Diff](/attachment.cgi?id=8985175&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8985175) |
| [Patch](/attachment.cgi?id=8986141)  [7 years ago](#c33)  [:Gijs (he/him)](/user_profile?user_id=159069)   2.24 KB, patch | valentin : [review+](#a11816198_415378 "7 years ago")  RyanVM : [approval-mozilla-esr60+](#c44 "7 years ago") | [Details](/attachment.cgi?id=8986141&action=edit) | [Diff](/attachment.cgi?id=8986141&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141) |
| [Add tests](/attachment.cgi?id=8986142)  [7 years ago](#c34)  [:Gijs (he/him)](/user_profile?user_id=159069)   4.02 KB, patch | valentin : [review+](#c36 "7 years ago") | [Details](/attachment.cgi?id=8986142&action=edit) | [Diff](/attachment.cgi?id=8986142&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986142) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1435319#c0)• 7 years ago |
|  | |

Attached image
[Malicious site with Freifox.jpg](attachment.cgi?id=8947914)
— [Details](attachment.cgi?id=8947914&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_12\_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36
Steps to reproduce:
1. Open Outlook 2016 on a Windows device
2. Drag an email from Outlook, and drop it in a Firefox tab
Actual results:
1. Firefox then redirects to <http://www.fromsubjectreceivedsizecategories.com/>
2. That site in turns redirects to various malicious sites - an example is attached
3. The behaviour continues despite disabling the inline auto-complete option. See <http://kb.mozillazine.org/Inline_autocomplete>
Note that the first site is a combination of the column headers in Outlook.
Also note that I'm unable to reproduce this behaviour with Chrome or IE on Windows, or with Chrome, Firefox and Safari on Mac OSX.
Tested with only Firefox version 57.0.4
Expected results:
Firefox should not auto-complete the drag and drop from Outlook.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1435319#c1)• 7 years ago |
|  | |

Can't open your image, there are errors in it (at least on my system -- maybe it's a variant .jpg format?)
The autocomplete option (if it still works -- that's an old article) would only apply to typing in a URL. Drag and drop is a different mechanism. There's no autocomplete, you're dropping the actual content. If the content you drop is a link to a web page we'll open that page. That page can then do whatever a web page can do that you've browsed to on the web or opened by clicking on a link elsewhere. Redirecting is one of those things.
We can report malicious sites to the SafeBrowsing service, so they get blocked. Otherwise I'm not sure what else here is a Firefox security bug.Flags: needinfo?(jana.squires)

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1435319#c2)• 7 years ago |
|  | |

Hi Daniel,
Thanks for your feedback.
To clarify: This behaviour is reproduced with any email that's dragged from Outlook, and into a tab in Firefox.
The site that Firefox tries to navigate to is fromsubjectreceivedsizecategories[.]com/. This is based on the default column headings within Outlook.
I've been able to reproduce the behaviour today using Outlook 2016 (Windows) and Firefox 58.01 (Windows).
I drag any email onto a page of a Firefox tab, an invalid page loads using then drag and drop mechanism, then navigation to the malicious site begins in a second tab. Note it doesn't matter which email I use, the navigation to the aforementioned site is the same.
Are you able to test the behaviour as well?
Regards,
- JanaFlags: needinfo?(jana.squires)

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1435319#c3)• 7 years ago |
|  | |

Attached image
[malicious site.png](attachment.cgi?id=8953211)
— [Details](attachment.cgi?id=8953211&action=edit)

Example of what loaded when I was initially testing the behaviour.

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1435319#c4)• 7 years ago |
|  | |

Comment on [attachment 8953211](/attachment.cgi?id=8953211 "malicious site.png") [[details]](/attachment.cgi?id=8953211&action=edit "malicious site.png")
malicious site.png
Note that that the browser first attempts to connect to fromsubjectreceivedsizecategories[.]com and then may be redirected to another random site with a malicious payload - as per the attachment here.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1435319#c5)• 7 years ago |
|  | |

Francois: do we have any mechanism to block sites when tracking protection is OFF (the default)? I believe Firefox is correctly interpreting the outlook content, but some scammer has obtained this domain that must be a default embedded in the format.
I've reported it to safebrowsing as well.Status: UNCONFIRMED → NEWComponent: Untriaged → SecurityEver confirmed: trueFlags: needinfo?(francois)

|  | [François Marier [:francois]](/user_profile?user_id=303427) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1435319#c6)• 7 years ago |
|  | |

Yes, we have the plugin blocklist: <https://github.com/mozilla-services/shavar-plugin-blocklist/blob/master/mozplugin-block.txt>
This list actually applies to any network loads, not just Flash loads.
It's controlled by browser.safebrowsing.blockedURIs.enabled and is default ON.Flags: needinfo?(francois)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1435319#c7)• 7 years ago |
|  | |

I reported this site to the safebrowsing people and it's still not blocked. Can we add it to our own list? This site does nothing good. At best you end up on Amazon with a referral link so these jerks make money. Using a Mac I quite often get stuck on a "tech support" scam site that locks up the browser using various eviltraps and I have to kill the child process to escape.Flags: needinfo?(francois)

|  | [François Marier [:francois]](/user_profile?user_id=303427) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1435319#c8)• 7 years ago |
|  | |

You're talking about <http://www.fromsubjectreceivedsizecategories.com/>?
As you point out, it's not flagged by Google: <https://transparencyreport.google.com/safe-browsing/search?url=http:%2F%2Fwww.fromsubjectreceivedsizecategories.com%2F>
In terms of adding it to our own blacklist, I'll need to check with Marshall. We have never had our own malware/phishing blacklist, so I need to make sure we can actually do this from a policy/legal point of view.Flags: needinfo?(francois) → needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1435319#c9)• 7 years ago |
|  | |

Someone has gamed Google's system: "No unsafe content found". There's nothing there except a navigation to various \_other\_ sites that are unsafe or deceptive, but the bad stuff isn't on that site so it gets a pass? The sites it navigated to kept changing so it'd be hard to report all those and get them all.Flags: needinfo?(dveditz)

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1435319#c10)• 7 years ago |
|  | |

Thanks all for investigating this.
Just want a reminder that during my tests I wasn't able to replicate this on Chrome or IE - only on Firefox.
Admittedly I didn't test it with any other browsers. However it does relate to the way Firefox handles drag and drops into tabs. Is there a way to disable that process in the configuration?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1435319#c11)• 7 years ago |
|  | |

There are two problems here:
1) dropping an email from the Outlook application on Windows gets interpreted as a URL of the outlook mail columns. Why are we trying to interpret mail as anything? It's possible Outlook is tagging their drag content incorrectly, but other browsers seem to have made allowances for that if that's the case.
2) fromsubjectreceivedsizecategories.com is a malicious site taking advantage of this and needs to get blocked.
Getting SafeBrowsing to block the site would mitigate this particular instance, but we're not having much success there so we should look into #1. Besides there might be other apps (or a localized Outlook?) that result in different text that gets Firefox to open a different domain that bad people will then domain-squat on in a similar way.Group: firefox-core-security → dom-core-securityUser Story: (updated)Component: Security → Drag and DropFlags: needinfo?(haftandilian)OS: Unspecified → WindowsProduct: Firefox → Core

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1435319#c13)• 7 years ago |
|  | |

Attached file
[HTML file to show dropped items](attachment.cgi?id=8984726)
— [Details](attachment.cgi?id=8984726&action=edit)

unfortunately I don't have outlook 2016 right now.
can anyone perform the following operation to tell me what kind of data is dropped?
1. open the attached file in Firefox 60.0.2, or newer, (or maybe on 58.0.1 if there's any different behavior)
(the file listens to the drop event and shows dropped item's data)
2. drag and drop an email from outlook 2016 to "Drag and drop items here." text in the page
3. copy and paste the whole displayed text into a new text file
4. upload the text file here

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1435319#c14)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

> 1) dropping an email from the Outlook application on Windows gets
> interpreted as a URL of the outlook mail columns. Why are we trying to
> interpret mail as anything?
If the dropped item doesn't contain "text/uri-list" or "text/moz-list" flavor, but "text/plain" flavor, Firefox tries to interpret every line in the text as URI.
while intepreting, it performs fixup (just like when some word is entered in the location bar),
and it can make some possibly-non-URI to URI (which might explain the long domain).
[bug 1435910](/show_bug.cgi?id=1435910 "RESOLVED FIXED - Dragging multiple lines of text to the tab bar creates multiple tabs") changed this behavior a bit in Firefox 60, and now if there's any absolutely-non-URI line, entire text is treated as a single search term, so it won't open any URI interpreted from the text.
So, the behavior could be different between Firefox 58.0.1 and 60.0.2, and might already be \*fixed\* now.
but anyway I'd like to confirm how this happened, in term of the dropped text content, so the result for the [comment #13](/show_bug.cgi?id=1435319#c13 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site") is welcome.

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1435319#c15)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

(In reply to Tooru Fujisawa [:arai] from [comment #14](/show_bug.cgi?id=1435319#c14 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> If the dropped item doesn't contain "text/uri-list" or "text/moz-list"
"text/uri-list" or "text/x-moz-url"

|  | [Richard Stewart](/user_profile?user_id=619054) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1435319#c17)• 7 years ago |
|  | |

(In reply to François Marier [:francois] from [comment #8](/show_bug.cgi?id=1435319#c8 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> You're talking about <http://www.fromsubjectreceivedsizecategories.com/>?
>
> As you point out, it's not flagged by Google:
> <https://transparencyreport.google.com/safe-browsing/search?url=http>:
> %2F%2Fwww.fromsubjectreceivedsizecategories.com%2F
>
> In terms of adding it to our own blacklist, I'll need to check with
> Marshall. We have never had our own malware/phishing blacklist, so I need to
> make sure we can actually do this from a policy/legal point of view.
Did you ever check with Marshall on policy/legal aspects of adding this to the plugin blocklist? I nearly got caught out by this but luckily for me the corporate web content filtering saved me. Others aren't won't have such protections and I'm surprised issue has been hanging around for 4 months despite this being actively exploited. While it might not be the most elegant solution, adding the URL to the plugin blocklist may well mitigate the vulnerability for the vast majority of people.

|  | [Haik Aftandilian [:haik]](/user_profile?user_id=558190) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1435319#c18)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

(In reply to Daniel Veditz [:dveditz] from [comment #11](/show_bug.cgi?id=1435319#c11 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> There are two problems here:
>
> 1) dropping an email from the Outlook application on Windows gets
> interpreted as a URL of the outlook mail columns. Why are we trying to
> interpret mail as anything? It's possible Outlook is tagging their drag
> content incorrectly, but other browsers seem to have made allowances for
> that if that's the case.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1435319#c19)• 7 years ago |
|  | |

(In reply to Tooru Fujisawa [:arai] from [comment #13](/show_bug.cgi?id=1435319#c13 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> Created [attachment 8984726](/attachment.cgi?id=8984726 "HTML file to show dropped items") [[details]](/attachment.cgi?id=8984726&action=edit "HTML file to show dropped items")
> HTML file to show dropped items
>
> unfortunately I don't have outlook 2016 right now.
>
> can anyone perform the following operation to tell me what kind of data is
> dropped?
> 1. open the attached file in Firefox 60.0.2, or newer, (or maybe on 58.0.1
> if there's any different behavior)
> (the file listens to the drop event and shows dropped item's data)
> 2. drag and drop an email from outlook 2016 to "Drag and drop items here."
> text in the page
> 3. copy and paste the whole displayed text into a new text file
> 4. upload the text file here
Richard or Jana, given your comments - are you able to perform these steps?Flags: needinfo?(richard.j.stewart)Flags: needinfo?(jana.squires)

|  | [Richard Stewart](/user_profile?user_id=619054) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1435319#c20)• 7 years ago |
|  | |

Attached image
[drag-drop-test results.png](attachment.cgi?id=8985148)
— [Details](attachment.cgi?id=8985148&action=edit)

Here's a screenshot of the result of the drag and drop test as requestedFlags: needinfo?(richard.j.stewart)

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1435319#c21)• 7 years ago |
|  | |

Thank you for checking!
So, apparently those words are separated with TAB character, which is somehow removed while fixing up.
(so, it's considered to be an URI inside ContentAreaDropListener.prototype.\_addLinksFromItem, and actually fixed up while opening it)
let flags = Ci.nsIURIFixup.FIXUP\_FLAG\_FIX\_SCHEME\_TYPOS |
Ci.nsIURIFixup.FIXUP\_FLAG\_ALLOW\_KEYWORD\_LOOKUP;
let info = Services.uriFixup.getFixupURIInfo("From\tSubject", flags);
console.log(info.fixedURI.spec);
I'll look into the Services.uriFixup implementation.
(IMO, TAB should be treated in the same way as SPACE, which isn't get removed)
then, I misremembered about the current behavior:
<https://searchfox.org/mozilla-central/rev/d544b118e26422877108c42723b26e9bb4539721/dom/base/contentAreaDropListener.js#70-76>
so, the issue is still happening on nightly.Flags: needinfo?(jana.squires)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1435319#c22)• 7 years ago |
|  | |

(In reply to Tooru Fujisawa [:arai] from [comment #21](/show_bug.cgi?id=1435319#c21 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> Thank you for checking!
>
> So, apparently those words are separated with TAB character, which is
> somehow removed while fixing up.
> (so, it's considered to be an URI inside
> ContentAreaDropListener.prototype.\_addLinksFromItem, and actually fixed up
> while opening it)
>
> let flags = Ci.nsIURIFixup.FIXUP\_FLAG\_FIX\_SCHEME\_TYPOS |
> Ci.nsIURIFixup.FIXUP\_FLAG\_ALLOW\_KEYWORD\_LOOKUP;
> let info = Services.uriFixup.getFixupURIInfo("From\tSubject", flags);
> console.log(info.fixedURI.spec);
>
> I'll look into the Services.uriFixup implementation.
> (IMO, TAB should be treated in the same way as SPACE, which isn't get
> removed)
This is essentially a result of the URL specification, not fixup - `new URL("<http://foo\tbar>")` produces a URL object instead of null.
I guess when we prefix `http` ( inside <https://dxr.mozilla.org/mozilla-central/rev/75a32b57132f8cba42779555662a057a0416a313/docshell/base/nsDefaultURIFixup.cpp#366> ) then we could in principle check if there are tab characters in the input and bail out if so. That seems hacky though, also because they could be in the query string or similar (rather than the hostname) where the current behavior is probably correct.
(FWIW, this probably wants moving back to a frontend component, or maybe Core :: Document Navigation if we think we should indeed fix this inside the URI fixup code, which in any case should probably be moved to toolkit at some point...)

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11304353_310076)• 7 years ago |

Flags: needinfo?(arai.unmht)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1435319#c23)• 7 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1435319#c22 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> I guess when we prefix `http` ( inside
> <https://dxr.mozilla.org/mozilla-central/rev/>
> 75a32b57132f8cba42779555662a057a0416a313/docshell/base/nsDefaultURIFixup.
> cpp#366 ) then we could in principle check if there are tab characters in
> the input and bail out if so. That seems hacky though, also because they
> could be in the query string or similar (rather than the hostname) where the
> current behavior is probably correct.
>
> (FWIW, this probably wants moving back to a frontend component, or maybe
> Core :: Document Navigation if we think we should indeed fix this inside the
> URI fixup code, which in any case should probably be moved to toolkit at
> some point...)
I think that we should probably address this in nsDefaultURIFixup, although it's not easy.
Some strings like domain.tld resemble a URL a bit, so it's OK to fix them up, but From\tSubject really doesn't, so we should be a bit more strict in this regard. "Does it look like a URL" is more difficult for computers than humans, but I think we can do better.
Indeed, the URL code strips some whitespace characters, but that flexibility is mostly to improve webcompat and to make things easier for developers. When we get weird stuff from other sources, we should try to avoid surprises.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1435319#c24)• 7 years ago |
|  | |

Attached patch

[Don't fix up protocols for tab-separated content](attachment.cgi?id=8985175&action=diff) (obsolete)
— [Details](attachment.cgi?id=8985175&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8985175)

I'm not really convinced by this approach, but I assume it fixes the issue here.
I actually think that fixing up by ignoring tabs is probably the user-friendly thing to do in general. The combination with dnd to the result that we get here is unfortunate, but fixing only the dnd consumer would feel wrong because it would leave other issues with e.g. copy/paste (or "Paste and Go").
Arai, Boris, what do you think?Assignee: nobody → gijskruitbosch+bugs
[Attachment #8985175](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") -
Flags: feedback?(bzbarsky)
[Attachment #8985175](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") -
Flags: feedback?(arai.unmht)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11309696_159069)• 7 years ago |

Assignee: gijskruitbosch+bugs → nobody

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1435319#c25)• 7 years ago |
|  | |

(In reply to Valentin Gosu [:valentin] from [comment #23](/show_bug.cgi?id=1435319#c23 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> Indeed, the URL code strips some whitespace characters, but that flexibility
> is mostly to improve webcompat and to make things easier for developers.
I... continue to find this very strange. Anyway, this is not the best place to have that particular discussion.
> When we get weird stuff from other sources, we should try to avoid surprises.
I mean, we do the inverse (but also wrong) thing in e.g. [https://bugzilla.mozilla.org/show\_bug.cgi?id=1460097](/show_bug.cgi?id=1460097 "VERIFIED FIXED - Hidden character in pasted url gets wrongly interpreted") in that we don't remove enough whitespace when humans try to load content. Fixup is \*meant\* to take things that are barely URLs and make them into URLs. That's part of why I'm conflicted (see [comment #24](/show_bug.cgi?id=1435319#c24 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site") - fwiw, I hadn't seen your comment when I wrote/posted the patch...)

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1435319#c26)• 7 years ago |
|  | |

Comment on [attachment 8985175](/attachment.cgi?id=8985175 "Don't fix up protocols for tab-separated content") [[details]](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") [[diff]](/attachment.cgi?id=8985175&action=diff "Don't fix up protocols for tab-separated content") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8985175)
Don't fix up protocols for tab-separated content
Review of [attachment 8985175](/attachment.cgi?id=8985175 "Don't fix up protocols for tab-separated content") [[details]](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") [[diff]](/attachment.cgi?id=8985175&action=diff "Don't fix up protocols for tab-separated content") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8985175):
-----------------------------------------------------------------
Thanks!
So, this solves the case that there are at least 3 columns (so there are 2 TABs between them) in the mail listing,
which would match default case and most usecases, I think?
if there's no existing testcase that fails with this change (so, no known case that we should handle otherwise), I think this is reasonable fix for this bug.
the another solution would be, do not add prefix/suffix if there's at least one whitespaces in between non-whitespace characters of given text.
the possible case I can think of which there's whitespaces inside the input URL is, when the URL is copied from somewhere else that wrapped the URL with extra whitespaces. so at least suffix should already be there (let me know if there's another case).
this bug's case is troublesome because we add ".com" to non-hostname thing.
we could be more careful/strict when to treat the given text as possible partial hostname.
<https://searchfox.org/mozilla-central/rev/d544b118e26422877108c42723b26e9bb4539721/docshell/base/nsDefaultURIFixup.cpp#569-585>
::: docshell/base/nsDefaultURIFixup.cpp
@@ +365,5 @@
> + // or the flags passed might not let us).
> + rv = NS\_OK;
> + // Avoid fixing up content that looks like tab-separated values (more than 1 \t).
> + auto firstTab = uriString.FindChar('\t');
> + if (firstTab == kNotFound || uriString.RFindChar('\t') == firstTab) {
I guess it's better adding a static function with descriptive name (like, MaybeTabSeparatedValues, or something like that?),
also, it should be better handling leading/trailing TABs as well.
currently leading/trailing SPACEs are removed here, but TABs are kept:
<https://searchfox.org/mozilla-central/rev/d544b118e26422877108c42723b26e9bb4539721/docshell/base/nsDefaultURIFixup.cpp#150-151>
if there are only multiple leading/trailing TABs in the given text (like, "\t\tmozilla.com\t\t\t", it's now treated as non-URL.
So, this should test that there are at least 1 TAB sequence in the middle of non-TAB text.
[Attachment #8985175](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") -
Flags: feedback?(arai.unmht) → feedback+

|  | [Haik Aftandilian [:haik]](/user_profile?user_id=558190) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11356683_558190)• 7 years ago |

Flags: needinfo?(haftandilian)

|  | [Tooru Fujisawa [:arai]](/user_profile?user_id=310076) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11356911_310076)• 7 years ago |

Flags: needinfo?(arai.unmht)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1435319#c27)• 7 years ago |
|  | |

Jana/Richard, out of interest, what do you \*expect\* / \*want\* from dragging an email to the Firefox tab?Flags: needinfo?(richard.j.stewart)Flags: needinfo?(jana.squires)

|  | [Jana](/user_profile?user_id=611252)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1435319#c28)• 7 years ago |
|  | |

I don't want anything to happen per se. Instead, it was merely an observation stumbled upon when attempting to add attach an email to a Jira ticket. Instead of dropping it in the ticket, it was dropped in the tab area; which then created a connection to the malicious url.Flags: needinfo?(jana.squires)

|  | [Richard Stewart](/user_profile?user_id=619054) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1435319#c29)• 7 years ago |
|  | |

Same here. I intended to drop an email as a msg file but that's not what outlook gives Firefox. As long as people don't get redirected to a random malicious site I think that's acceptable.Flags: needinfo?(richard.j.stewart)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1435319#c30)• 7 years ago |
|  | |

For links in web pages, the reason we have to deal with tabs is stuff like this:
<a href="<http://foo.bar.com/foo/>
baz.html">Stuff</a>
Where the indent after the linebreak includes tabs.
It's not clear what should happen if we get a string like that sent to us from an external app...

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1435319#c31)• 7 years ago |
|  | |

Comment on [attachment 8985175](/attachment.cgi?id=8985175 "Don't fix up protocols for tab-separated content") [[details]](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") [[diff]](/attachment.cgi?id=8985175&action=diff "Don't fix up protocols for tab-separated content") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8985175)
Don't fix up protocols for tab-separated content
Seems reasonable to me....
[Attachment #8985175](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") -
Flags: feedback?(bzbarsky) → feedback+

|  | [François Marier [:francois]](/user_profile?user_id=303427) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1435319#c32)• 7 years ago |
|  | |

Dan, did you use one of the forms on <https://wiki.mozilla.org/Security/Safe_Browsing#Links> to report the malicious domain to Google? If so, which one?Flags: needinfo?(dveditz)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11813274_159069)• 7 years ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1435319#c33)• 7 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=8986141&action=diff)
— [Details](attachment.cgi?id=8986141&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141)

Valentin, bz is out, could you review this?
Dan, can you add a rating? For me the redirects point to a page that heavily suggests downloading some malware - but doesn't do anything to keep you there / stop you closing the tab. So I don't think this is severe enough to warrant sec-high/sec-crit and therefore sec-approval, but if you disagree I can fill out the form... :-)
[Attachment #8985175](/attachment.cgi?id=8985175&action=edit "Don't fix up protocols for tab-separated content") -
Attachment is obsolete: true
[Attachment #8986141](/attachment.cgi?id=8986141&action=edit "Patch") -
Flags: review?(valentin.gosu)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1435319#c34)• 7 years ago |
|  | |

Attached patch

[Add tests](attachment.cgi?id=8986142&action=diff)
— [Details](attachment.cgi?id=8986142&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986142)

Not sure if we want to land this separately, but just in case, separate patch for the tests.
I got a bit frustrated with the xpcshell lack of messaging about deciphering what:
0:01.62 FAIL do\_single\_test\_run - [do\_single\_test\_run : 619] false == true
actually meant, so I added some more messages to the tests to make them easier to read. Even without that though, this is enough of a not-a-bullseye that I think we could probably land them at the same time. It's pretty hard to go from this patch (change how we handle \t in URI fixup) to "you should drag emails or other tab-separated content to places to land on malicious pages".
[Attachment #8986142](/attachment.cgi?id=8986142&action=edit "Add tests") -
Flags: review?(valentin.gosu)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11814045_159069)• 7 years ago |

Component: Drag and Drop → Document Navigation

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1435319#c35)• 7 years ago |
|  | |

Comment on [attachment 8986141](/attachment.cgi?id=8986141 "Patch") [[details]](/attachment.cgi?id=8986141&action=edit "Patch") [[diff]](/attachment.cgi?id=8986141&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141)
Patch
Review of [attachment 8986141](/attachment.cgi?id=8986141 "Patch") [[details]](/attachment.cgi?id=8986141&action=edit "Patch") [[diff]](/attachment.cgi?id=8986141&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141):
-----------------------------------------------------------------
::: docshell/base/nsDefaultURIFixup.cpp
@@ +133,4 @@
> return false;
> }
>
> +// Assume that 1 tab is accidental, but more than 2 implies this is
Self-nit: more than 1
@@ +135,5 @@
>
> +// Assume that 1 tab is accidental, but more than 2 implies this is
> +// supposed to be tab-separated content.
> +static bool
> +MaybeTabSeparatedContent(const nsCString& aStringURI)
I would have used nsACString, but RFindChar doesn't exist there... :-(

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a11816198_415378)• 7 years ago |

[Attachment #8986141](/attachment.cgi?id=8986141&action=edit "Patch") -
Flags: review?(valentin.gosu) → review+

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1435319#c36)• 7 years ago |
|  | |

Comment on [attachment 8986142](/attachment.cgi?id=8986142 "Add tests") [[details]](/attachment.cgi?id=8986142&action=edit "Add tests") [[diff]](/attachment.cgi?id=8986142&action=diff "Add tests") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986142)
Add tests
Review of [attachment 8986142](/attachment.cgi?id=8986142 "Add tests") [[details]](/attachment.cgi?id=8986142&action=edit "Add tests") [[diff]](/attachment.cgi?id=8986142&action=diff "Add tests") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986142):
-----------------------------------------------------------------
::: docshell/test/unit/test\_nsDefaultURIFixup\_info.js
@@ +600,4 @@
> // Both APIs should then also be using the same spec.
> Assert.equal(!!fixupURIOnly, !!URIInfo.preferredURI);
> if (fixupURIOnly)
> + Assert.equal(fixupURIOnly.spec, URIInfo.preferredURI.spec, "Fixed and preferred URI should match");
Nit: also add braces since we're here :)
[Attachment #8986142](/attachment.cgi?id=8986142&action=edit "Add tests") -
Flags: review?(valentin.gosu) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1435319#c37)• 7 years ago |
|  | |

(In reply to François Marier [:francois] from [comment #32](/show_bug.cgi?id=1435319#c32 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> Dan, did you use one of the forms on <https://wiki.mozilla.org/Security/Safe_Browsing#Links>
I used the malware one, and I might have also used the phishing one just in case I guessed wrong about how Google would categorize it.
I'm guessing sec-low for the rating because Firefox ought to be robust in the face of a malicious site since there's any number of ways users can stumble into one. But depending on what site comes up and what users /thought/ they were doing by dragging the mail our behavior might contribute to social engineering attacks.Flags: needinfo?(dveditz)Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1435319#c38)• 7 years ago |
|  | |

remote: <https://hg.mozilla.org/integration/mozilla-inbound/rev/b58c103b639f29520c952137cd607148e2b01675>
remote: <https://hg.mozilla.org/integration/mozilla-inbound/rev/34fc2ff698c3796600e79073daa6011f24aecc06>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1435319#c39)• 7 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b58c103b639f>
<https://hg.mozilla.org/mozilla-central/rev/34fc2ff698c3>Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 7 years ago
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=wontfix)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=wontfix)
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)Flags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla62

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a13616895_488993)• 7 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1435319#c40)• 7 years ago |
|  | |

I'm kinda-sorta wondering if we want to take this on ESR60 or not given the attack vector involved. It grafts cleanly. Thoughts?Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1435319#c41)• 7 years ago |
|  | |

Comment on [attachment 8986141](/attachment.cgi?id=8986141 "Patch") [[details]](/attachment.cgi?id=8986141&action=edit "Patch") [[diff]](/attachment.cgi?id=8986141&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141)
Patch
(In reply to Ryan VanderMeulen [:RyanVM] from [comment #40](/show_bug.cgi?id=1435319#c40 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> I'm kinda-sorta wondering if we want to take this on ESR60 or not given the
> attack vector involved. It grafts cleanly. Thoughts?
Sounds reasonable to me. We have decent automated test coverage here, and this has been sitting on beta for a while now without (AFAIK) complaints.
[Approval Request Comment] (for both bugs)
If this is not a sec:{high,crit} bug, please state case for ESR consideration: workaround-ish fix for issue with workflows that may be particularly prevalent on ESR
User impact if declined: potential scam site access
Fix Landed on Version: 61
Risk to taking this patch (and alternatives if risky): low. Small patch on code that has decent unit tests.
String or UUID changes made by this patch: none.
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.Flags: needinfo?(gijskruitbosch+bugs)
[Attachment #8986141](/attachment.cgi?id=8986141&action=edit "Patch") -
Flags: approval-mozilla-esr60?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1435319#c42)• 7 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #41](/show_bug.cgi?id=1435319#c41 "RESOLVED FIXED - Dragging an email from Outlook into a Firefox tab redirects to malicious site"))
> [Approval Request Comment] (for both bugs)
both \*attachments\*. Sigh. Need my tea in the morning before commenting on bugs, clearly...

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1435319#c44)• 6 years ago |
|  | |

Comment on [attachment 8986141](/attachment.cgi?id=8986141 "Patch") [[details]](/attachment.cgi?id=8986141&action=edit "Patch") [[diff]](/attachment.cgi?id=8986141&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1435319&attachment=8986141)
Patch
Fixes a sec issue with links dragged from Outlook (which seems more likely in managed environments that are also more likely to be running an ESR), well baked on 62, and includes new tests. Approved for ESR 60.2.
[Attachment #8986141](/attachment.cgi?id=8986141&action=edit "Patch") -
Flags: approval-mozilla-esr60? → approval-mozilla-esr60+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1435319#c45)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/a77d0de5ad22>
<https://hg.mozilla.org/releases/mozilla-esr60/rev/e7a80ca1acc6>
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)
[tracking-firefox62](/buglist.cgi?f1=cf_tracking_firefox62&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox62&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [62+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=62%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a17195046_280903)• 6 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main62+][adv-esr60.2+]

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1435319#c46)• 6 years ago |
|  | |

(In reply to Robert Neumann from [bug 1480734 comment #1](/show_bug.cgi?id=1480734#c1 "RESOLVED DUPLICATE - Dragging an email from Outlook and dropping it to Firefox results in an automated opening of a (malicious) web page"))
> The exact same issue was discussed in this very old article:
>
> <https://www.silverspider.com/2007/from-subject-received-size-categories/>
Seems like this is already public, should we unhide the bug here? Dan?Flags: needinfo?(dveditz)

|  | [Robert Neumann](/user_profile?user_id=621993) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1435319#c47)• 6 years ago |
|  | |

We had a quick blog on it a few weeks back as well.
<https://www.forcepoint.com/blog/security-labs/subject-received%E2%80%A6what>
Better transparency at this point might be reasonable.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a17261117_1689)• 6 years ago |

Group: core-security-releaseFlags: needinfo?(dveditz)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1435319#a17300359_280903)• 6 years ago |

Alias: CVE-2018-12381
You need to [log in](/show_bug.cgi?id=1435319&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jana](/user_profile?user_id=611252)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.alternativ-testing.fr_64504247_20250126_075346.html ===
 oooo oooo
o$$"""$oo$$"""""$o
$" $$" $$$$
$" "" $$$$$o
$ $$$$$o
$ $$$$$$
$" "$$$$$
$ $$$$$$
$" $$$$$$
$ $$$$$
$ o$$$$$
$ $$$$$$
$ o$$$$$$
ooo o$$$$$$$
ooo$$$$"" $ oo$$$$$""""""oooo
oo"$$$$$$$ oo"" oooooooooooooooo$$""" o$$"oo
o" $$$$$$$ "$o oo$$$$$" $$$$o"$o
$ $$$$$$$ " ""oooooooooo$$$$" o$ $$$$$$o"$
o $$"" oo$$$" o$$ o$$$$$$$o$
"o $$ oo$$$$"" o$$$ o$$$$$$$$$$$
"$o $$$oo $$$$$$$ ooo$$$$$""
"$$oooo "" ooo$$$$ $$$$$$$$$$$$$$""
""""$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$""""""
""""""""""""""""""
\_\_ \_
(\_\_| | | (\_\_| \_\_ \_\_ \_|\_ \_|\_ \_\_ \_\_ \_\_|
| |\_\_| | | ) (\_\_) |\_, | (\_\_) (\_\_(\_ | ) (\_\_|

=== Content from bugzilla.mozilla.org_7a686e41_20250125_095248.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1479311)
* [XML](/show_bug.cgi?ctype=xml&id=1479311)

Closed
[Bug 1479311](/show_bug.cgi?id=1479311)
(CVE-2018-12382)

Opened 6 years ago
Closed 6 years ago

# Firefox for Android - AddressBar Spoofing using specially-crafted javascript: URL opened in a new tab

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox for Android - AddressBar Spoofing using specially-crafted javascript: URL opened in a new tab

## Categories

### (Firefox for Android Graveyard :: General, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard)

Firefox for Android Graveyard
▾

Firefox for Android Graveyard
Old, retired Fennec bugs. Fennec is the code name of the effort to build a mobile version of Firefox ([more info](http://wiki.mozilla.org/Mobile/FennecVision))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard&component=General#General)

General
▾

Firefox for Android Graveyard :: General
For bugs in Fennec which do not fit into other more specific Fennec components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 61

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (firefox61 wontfix, firefox62 verified, firefox63 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 63

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox61 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=wontfix) |
| firefox62 | --- | [verified](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=verified) |
| firefox63 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox61 |  | wontfix |
| firefox62 |  | verified |
| firefox63 |  | fixed |

## People

### (Reporter: jordi.chancel, Assigned: JanH)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a76cf64e8ccefd1206820f444e49bf54?d=mm&size=40)  [JanH](/user_profile?user_id=470713)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2f44e5e3d7f8be8131ae968ecb363bd?d=mm&size=40)  [jordi.chancel](/user_profile?user_id=356614)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### ( [URL](https://www.alternativ-testing.fr/Research/Mozilla/android/~JvaS49g6-Firefox-for-Android-Addressbar-Spoofing-h7J2r71~/testcase2-AddressBar-Spoofing-Risk-in-Firefox-for-Android.html "https://www.alternativ-testing.fr/Research/Mozilla/android/~JvaS49g6-Firefox-for-Android-Addressbar-Spoofing-h7J2r71~/testcase2-AddressBar-Spoofing-Risk-in-Firefox-for-Android.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1271998](/show_bug.cgi?id=1271998 "VERIFIED FIXED - Proposal: Scrollable URL in URL bar")

Dependency [tree](/showdependencytree.cgi?id=1479311&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1479311)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[alternativ-testing.fr/Research/Mozill...](https://www.alternativ-testing.fr/Research/Mozilla/android/~JvaS49g6-Firefox-for-Android-Addressbar-Spoofing-h7J2r71~/testcase2-AddressBar-Spoofing-Risk-in-Firefox-for-Android.html "https://www.alternativ-testing.fr/Research/Mozilla/android/~JvaS49g6-Firefox-for-Android-Addressbar-Spoofing-h7J2r71~/testcase2-AddressBar-Spoofing-Risk-in-Firefox-for-Android.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main62+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-12382

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main62+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c11 "6 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a57478787_578488 "5 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Video-demo.html](/attachment.cgi?id=8995831)  [6 years ago](#c1)  [Jordi Chancel](/user_profile?user_id=356614)   352 bytes, text/html |  | [Details](/attachment.cgi?id=8995831&action=edit) |
| --- | --- | --- |
| [Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.](/attachment.cgi?id=8997537)  [6 years ago](#c3)  [Jan Henning [:JanH]](/user_profile?user_id=470713)   59 bytes, text/x-review-board-request | snorp : [review+](#c4 "6 years ago")  lizzard : [approval-mozilla-beta+](#c8 "6 years ago") | [Details](/attachment.cgi?id=8997537&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jordi Chancel](/user_profile?user_id=356614)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1479311#c0)• 6 years ago |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:61.0) Gecko/20100101 Firefox/61.0
Build ID: 20180604143143
Steps to reproduce:
When a Malicious web-page on an Attacker Web-Site opens a javascript: URL containing the Attacker Domain
(Example: Attacker Domain = www.yyy.com ; javascript URL opened = javascript: [codes] + www.yyy.com + [codes] ) ,
the Attacker Domain is visible at the right into the AddressBar and covers the javascript: Protocol,
so at the left into the AddressBar it is possible to show another Domain (ex: www.google.com ; www.bankofamerica.com …).
This can lead to AddressBar Spoofing (The Video Demo in Attachments will show you how this vulnerability works).
STR:
-1) Go to the TestCase URL and Click on the « ClickMe » link (The specially-crafted javascript: URL is now opened in a new tab).
This javascript: URL opened in a new tab can lead to AddressBar Spoofing.
Actual results:
The specially-crafted javascript: URL can lead to AddressBar Spoofing (As demonstrated in the video-demo in Attachments).
Expected results:
A possibility to fix this vulnerability: the specially-crafted javascript URL should be visible like others javascript URL (The javascript protocol should be always visible into the Address Bar)

|  | [Jordi Chancel](/user_profile?user_id=356614)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1479311#c1)• 6 years ago |
|  | |

Attached file
[Video-demo.html](attachment.cgi?id=8995831)
— [Details](attachment.cgi?id=8995831&action=edit)

The Video-demo.

|  | [Jordi Chancel](/user_profile?user_id=356614)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a2552_356614)• 6 years ago |

URL: [https://www.alternativ-testing.fr/Res...](https://www.alternativ-testing.fr/Research/Google%20Chrome/ATVR-09-2017_g6k2d7l0f8s3/testcase-addressbar-spoofing-version1.php)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a181622_1689)• 6 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a339688_1689)• 6 years ago |

Group: firefox-core-securityKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Jan Henning [:JanH]](/user_profile?user_id=470713)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1479311#c2)• 6 years ago |
|  | |

I guess we shouldn't attempt to do domain highlighting (which is what drives the scrolling of the URL) for URLs starting with "javacript:" here: <https://dxr.mozilla.org/mozilla-central/rev/a2d65d03e46a9a42b5bee5c2a7864d3f987a8ca7/mobile/android/app/src/photon/java/org/mozilla/gecko/toolbar/ToolbarDisplayLayout.java#331>Assignee: nobody → jh+bugzillaStatus: UNCONFIRMED → NEWEver confirmed: trueOS: Unspecified → AndroidHardware: Unspecified → All

|  | [Jan Henning [:JanH]](/user_profile?user_id=470713)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1479311#c3)• 6 years ago |
| mozreview-request | |

| Comment hidden (mozreview-request) |  |
| --- | --- |

Attached file
[Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.](attachment.cgi?id=8997537)
— [Details](attachment.cgi?id=8997537&action=edit)

Review commit: <https://reviewboard.mozilla.org/r/261256/diff/#index_header>
See other reviews: <https://reviewboard.mozilla.org/r/261256/>
[Attachment #8997537](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") -
Flags: review?(snorp)

|  | [James Willcox (:snorp) (jwillcox@mozilla.com) (he/him)](/user_profile?user_id=227322) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1479311#c4)• 6 years ago |
| mozreview-review | |

Comment on [attachment 8997537](/attachment.cgi?id=8997537 "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") [[details]](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.")
[Bug 1479311](/show_bug.cgi?id=1479311 "VERIFIED FIXED - Firefox for Android - AddressBar Spoofing using specially-crafted javascript: URL opened in a new tab") - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.
<https://reviewboard.mozilla.org/r/261256/#review268954>
[Attachment #8997537](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") -
Flags: review?(snorp) → review+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1479311#c5)• 6 years ago |
|  | |

Pushed by mozilla@buttercookie.de:
<https://hg.mozilla.org/integration/autoland/rev/bf82b74a7db7>
Don't attempt finding and highlighting a tab's base domain within a javascript: URL. r=snorp

|  | [Andreea Pavel [:apavel]](/user_profile?user_id=600553) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1479311#c6)• 6 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/bf82b74a7db7>Status: NEW → RESOLVEDClosed: 6 years ago
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 63

|  | [Jan Henning [:JanH]](/user_profile?user_id=470713)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1479311#c7)• 6 years ago |
|  | |

Comment on [attachment 8997537](/attachment.cgi?id=8997537 "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") [[details]](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.")
[Bug 1479311](/show_bug.cgi?id=1479311 "VERIFIED FIXED - Firefox for Android - AddressBar Spoofing using specially-crafted javascript: URL opened in a new tab") - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.
Approval Request Comment
[Feature/Bug causing the regression]: URL bar domain highlighting in combination with [bug 1271998](/show_bug.cgi?id=1271998 "VERIFIED FIXED - Proposal: Scrollable URL in URL bar")
[User impact if declined]: A tab's base domain contained within a "javascript:" URL might incorrectly be highlighted and scrolled to, obscuring the fact that the URL is in fact a "javascript:" URL.
[Is this code covered by automated tests?]: No.
[Has the fix been verified in Nightly?]: Yes.
[Needs manual test from QE? If yes, steps to reproduce]: No.
[List of other uplifts needed for the feature/fix]: none
[Is the change risky?]: No.
[Why is the change risky/not risky?]: Just adding a check for the "javascript:" protocol in the domain highlighting code.
[String changes made/needed]: None.
[Attachment #8997537](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") -
Flags: approval-mozilla-beta?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a1379289_451704)• 6 years ago |

[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=wontfix)
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=affected)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1479311#c8)• 6 years ago |
|  | |

Comment on [attachment 8997537](/attachment.cgi?id=8997537 "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") [[details]](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.")
[Bug 1479311](/show_bug.cgi?id=1479311 "VERIFIED FIXED - Firefox for Android - AddressBar Spoofing using specially-crafted javascript: URL opened in a new tab") - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.
Adding a simple check for protocol; let's uplift for beta 18.
[Attachment #8997537](/attachment.cgi?id=8997537&action=edit "Bug 1479311 - Don't attempt finding and highlighting a tab's base domain within a javascript: URL.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Cristian Brindusan [:cbrindusan]](/user_profile?user_id=600663) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1479311#c9)• 6 years ago |
| bugherder uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/7456a854852b>
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a1895928_280903)• 6 years ago |

Whiteboard: [adv-main62+]

|  | [Oana Horvath [:ohorvath]](/user_profile?user_id=585566) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1479311#c10)• 6 years ago |
|  | |

Verified as fixed on Beta 62.0b19, javascript:setTimeout is visible in the URL bar.
Marking as verified since it won't fix 61.Status: RESOLVED → VERIFIED
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1479311#c11)• 6 years ago |
|  | |

Unfortunately does not qualify for our bug bounty programBlocks: [1271998](/show_bug.cgi?id=1271998 "VERIFIED FIXED - Proposal: Scrollable URL in URL bar")Flags: sec-bounty? → sec-bounty-Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a2001164_280903)• 6 years ago |

Alias: CVE-2018-12382

|  | [Jordi Chancel](/user_profile?user_id=356614)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a3309596_356614)• 6 years ago |

URL: [https://www.alternativ-testing.fr/Res...](https://www.alternativ-testing.fr/Research/Google%20Chrome/ATVR-09-2017_g6k2d7l0f8s3/testcase-addressbar-spoofing-version1.php) → [https://www.alternativ-testing.fr/Res...](https://www.alternativ-testing.fr/Research/Mozilla/android/~JvaS49g6-Firefox-for-Android-Addressbar-Spoofing-h7J2r71~/testcase2-AddressBar-Spoofing-Risk-in-Firefox-for-Android.html)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a57478787_578488)• 5 years ago |

Flags: sec-bounty-hof+

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a75683180_1)• 4 years ago |

Product: Firefox for Android → Firefox for Android Graveyard

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1479311#a184194898_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1479311&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jordi Chancel](/user_profile?user_id=356614)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


