=== Content from lists.debian.org_031e7e2e_20250124_210643.html ===


---

[[Date Prev](msg00034.html)][[Date Next](msg00036.html)]
[[Thread Prev](msg00034.html)][[Thread Next](msg00036.html)]
[[Date Index](maillist.html#00035)]
[[Thread Index](threads.html#00035)]

# [SECURITY] [DLA 1972-1] mosquitto security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1972-1] mosquitto security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sat, 26 Oct 2019 23:33:17 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.20.1910262330440.13905%40jupiter.server.alteholz.net)Â [alpine.DEB.2.20.1910262330440.13905@jupiter.server.alteholz.net](msg00035.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : mosquitto
Version        : 1.3.4-2+deb8u4
CVE ID         : CVE-2017-7655 CVE-2018-12550 CVE-2018-12551
                 CVE-2019-11779

```
Several issues have been found in mosquitto, a MQTT version 3.1/3.1.1
compatible message broker.
```

CVE-2017-7655

     A Null dereference vulnerability in the Mosquitto library could
     lead to crashes for those applications using the library.

CVE-2018-12550

     An ACL file with no statements was treated as having a default
     allow policy. The new behaviour of an empty ACL file is a default
     policy of access denied.
     (this is in compliance with all newer releases)

CVE-2018-12551

     Malformed authentication data in the password file could allow
     clients to circumvent authentication and get access to the broker.

CVE-2019-11779

     Fix for processing a crafted SUBSCRIBE packet containing a topic
     that consists of approximately 65400 or more '/' characters.
     (setting TOPIC_HIERARCHY_LIMIT to 200)

For Debian 8 "Jessie", these problems have been fixed in version
1.3.4-2+deb8u4.

We recommend that you upgrade your mosquitto packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAl20u51fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEcmwA//f1rJ+ufl6ko7o8BEs7yWKlJh5H2KcfRZ9gvUmyAG7WyPF61MzzJ9swXu
dPW+SPqj7ln7umXaoNH0y8ErnYdzTYADdTxrNKo1pwoyXP4r0iOu5xadVUMmRO22
KGTs9OvGv2eqdFi+u33Zo3zmICL7DVHM7bLkG6yoDX2HimOa8HX33PurUF/C44CB
T7ebvmvGhUkiwOScXAYOagTCHsHdrJ5Yd+olMLr0i1O7RbqPzRH/szkcn0GlUenJ
RRPt7lQN1MjjN37Q0NkbyIHkSap/CvQuH+bO4dgea/TGEZ8OdAdSAhx8lGXD8Re3
x9n2r+GR0SbAa8aqXvaZs5t8fIfGSwkIoJkjJKIYx/d+L95qv25aCCHcgR/FyOVR
36Ae2utjlv6bqQhCiov9dkdJVHhrvY07it26jofhZYpQ9sZ+18eIZLG4lqILNhbb
vyQG7jVV/Pui1CU6HPdFRuKr9IxiVA/hQg7qtJuMUxAEjrx2D/c3F9BtOTRtYECW
arDpDfyCG4hK5NpdDqhW2K68/w9J7iLcZ+oYyTg6OblllJ6EN4th+PnCrcurjJGS
WYU7LHIUhpRPmTmPqdFv/t8lL0VrIPW5Lgbuxj65z3bs7NmKUAHwkJNz/YDwdr/i
Q8oLPhBNmg2sS4HjJ4fTOYGrsY+osiMuQ6daVj+dC9nJ4A/+sdU=
=5fhd
-----END PGP SIGNATURE-----

```

---



=== Content from bugs.eclipse.org_57dbea4c_20250124_210643.html ===


[![logo]()](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla â€“ BugÂ 543401
Blank username allows Mosquitto Security Bypass
Last modified: 2019-02-08 16:45:00 EST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=543401&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**BugÂ 543401**](show_bug.cgi?id=543401)
(CVE-2018-12551)
- Blank username allows Mosquitto Security Bypass

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Blank username allows Mosquitto Security Bypass

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-12551 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Community | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Eclipse Foundation | | [Component:](describecomponents.cgi?product=Community "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerability Reports ([show other bugs](buglist.cgi?component=Vulnerability%20Reports&product=Community&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified Â  [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 critical ([vote](page.cgi?id=voting/user.html&bug_id=543401#vote_543401)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- Â  [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Security vulnerabilitied reported against Eclipse projects [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2019-01-14 00:19 EST by Charles Taylor [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2019-02-08 16:45 EST ([History](show_activity.cgi?id=543401)) | | CC List: | 3 users (show)  roger taylorc wayne.beaton | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=543401&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=543401&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=543401#c0)  Charles Taylor [CLA](https://wiki.eclipse.org/ECA)    2019-01-14 00:19:03 EST  ``` I have verified this vulnerability in the latest available build on GitHub (version 1.5.5) and the version shipping with Ubuntu 16.04 (1.4.8).  To reproduce:  1. Install Mosquitto utilizing your preferred technique (package manager, etc.). For this example, I installed it using Aptitude. 2. Edit '/etc/mosquitto.conf', adding these lines to enable access control:  password_file /etc/mosquitto/mosquitto.users acl_file /etc/mosquitto/mosquitto.acl allow_anonymous false  3. Create '/etc/mosquitto/mosquitto.acl' with this content:  user test readwrite #  4. Create '/etc/mosquitto/mosquitto.users' with this content:  test:$6$BHZEmbaA2YgNtNRI$qJ399QBKyrhnzEQCyoL3qU0N8VopPEGZwCjXb8fALz/cFP+ICnJi7cIIIdm3if08qc/0YbI3Ete0md2GqUjG7Q==  NOTE: This sets up a username of 'test' and a password of 'test'.  5. (Re)start the mosquitto service. 6. Confirm access control is enabled:  root@hydra:~# mosquitto_pub -d -t TestTopic -m Testmessage Client mosqpub/30229-hydra sending CONNECT Client mosqpub/30229-hydra received CONNACK Connection Refused: not authorised. Error: The connection was refused.  7. Confirm test/test username and password grants access:  root@hydra:~# mosquitto_pub -d -u 'test' -P 'test' -t TestTopic -m Testmessage Client mosqpub/30230-hydra sending CONNECT Client mosqpub/30230-hydra received CONNACK Client mosqpub/30230-hydra sending PUBLISH (d0, q0, r0, m1, 'TestTopic', ... (11 bytes)) Client mosqpub/30230-hydra sending DISCONNECT  8. Confirm an incorrect username or password denies access:  root@hydra:~# mosquitto_pub -d -u 'tes' -P 'test' -t TestTopic -m Testmessage Client mosqpub/30233-hydra sending CONNECT Client mosqpub/30233-hydra received CONNACK Connection Refused: not authorised. Error: The connection was refused.  root@hydra:~# mosquitto_pub -d -u 'test' -P 'tes' -t TestTopic -m Testmessage Client mosqpub/30276-hydra sending CONNECT Client mosqpub/30276-hydra received CONNACK Connection Refused: not authorised. Error: The connection was refused.  9. Confirm vulnerability. Publish an arbitrary message using a blank username:  root@hydra:~# mosquitto_pub -d -u '' -t DoorControl -m UNLOCK Client mosqpub/30279-hydra sending CONNECT Client mosqpub/30279-hydra received CONNACK Client mosqpub/30279-hydra sending PUBLISH (d0, q0, r0, m1, 'DoorControl', ... (6 bytes)) Client mosqpub/30279-hydra sending DISCONNECT  10. Assuming the appropriate firewall port has been opened, confirm the vulnerability remotely:  taylorc@iris:~$ mosquitto_pub -h hydra -d -u '' -t DoorControl -m UNLOCK Client mosqpub/12640-iris sending CONNECT Client mosqpub/12640-iris received CONNACK Client mosqpub/12640-iris sending PUBLISH (d0, q0, r0, m1, 'DoorControl', ... (6 bytes)) Client mosqpub/12640-iris sending DISCONNECT ```  [Comment 1](show_bug.cgi?id=543401#c1)  Charles Taylor [CLA](https://wiki.eclipse.org/ECA)    2019-01-14 01:52:03 EST  ``` Please assign a CVE. ```  [Comment 2](show_bug.cgi?id=543401#c2)  Charles Taylor [CLA](https://wiki.eclipse.org/ECA)    2019-01-14 02:30:50 EST  ``` This happens due to the way the username/password file is parsed.  If it contains a line that is just a newline (a very easy mistake to make), it triggers the bug.  A workaround is to make sure that one's username/password file contains no stray newlines.  The code should be modified to skip blank lines when loading the username/password file. ```  [Comment 3](show_bug.cgi?id=543401#c3)  Charles Taylor [CLA](https://wiki.eclipse.org/ECA)    2019-01-14 02:52:21 EST  ``` It's not limited to blank lines. Suppose someone maintains their own list of users for private IoT, and has a "comment" in the file like:  # Outdoor weather station test:$6$salt$hashedpassword$  In this case, no parse error occurs and "# Outdoor weather station" becomes a valid username, with no password required.  The chances of this occurring are compounded by mosquitto_passwd being unable to add an entry to a password file, or to be smart enough to not re-encrypt already-encrypted entries. This leads people to cut and paste together password files, easily triggering the bug by accident. ```  [Comment 4](show_bug.cgi?id=543401#c4)  Roger Light [CLA](https://wiki.eclipse.org/ECA)    2019-01-23 18:40:03 EST  ``` Could I have a CVE assigned for this please, I'll add CVSS and description details later. ```  [Comment 5](show_bug.cgi?id=543401#c5)  Roger Light [CLA](https://wiki.eclipse.org/ECA)    2019-01-23 18:47:10 EST  ``` Thanks for the clear walk through and analysis.  I am a bit confused by your final paragraph, which although minor in comparison is  the most likely way that this would happen. I can do:  # Create a password file mosquitto_passwd -c pwfile user1  # Add a new user mosquitto_passwd pwfile user2  # Update a user mosquitto_passwd pwfile user1  The new/updated user doesn't affect the other users in the file. Can you explain why you can't add new users? ```  [Comment 6](show_bug.cgi?id=543401#c6)  Charles Taylor [CLA](https://wiki.eclipse.org/ECA)    2019-01-24 14:48:45 EST  ``` It appears I can, thanks to your examples. I never considered this because the documentation (located here: <https://mosquitto.org/man/mosquitto_passwd-1.html>) shows this:  Add a user to a new password file:  mosquitto_passwd -c /etc/mosquitto/passwd ral  Which, according to the same page:  -c  Create a new password file. If the file already exists, it will be overwritten.  And this line at the beginning of the same page got short-circuited in the programmer section of my brain as "must use -c or -D"  mosquitto_passwd [ -c | -D ] passwordfile username  These components of the documentation lead me to believe that it wasn't possible to simply add a user and I never looked any further into the utility's other possible command line configurations. ```  [Comment 7](show_bug.cgi?id=543401#c7)  Roger Light [CLA](https://wiki.eclipse.org/ECA)    2019-01-30 08:49:28 EST  ``` Description:  If Mosquitto is configured to use a password file for authentication, any malformed data in the password file will be treated as valid. This typically means that the malformed data becomes a username and no password. If this occurs, clients can circumvent authentication and get access to the broker by using the malformed username. In particular, a blank line will be treated as a valid empty username. Other security measures are unaffected. Users who have only used the mosquitto_passwd utility to create and modify their password files are unaffected by this vulnerability.  Affects versions 1.0 to 1.5.5 inclusive.  CVSS v2: <https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector=(AV:N/AC:M/Au:N/C:P/I:P/A:N/E:ND/RL:OF/RC:C>)  CVSS v3: <https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N/E:X/RL:O/RC:C>  Could I have a CVE assigned please? ```  [Comment 8](show_bug.cgi?id=543401#c8)  Roger Light [CLA](https://wiki.eclipse.org/ECA)    2019-02-05 10:30:50 EST  ``` <https://cwe.mitre.org/data/definitions/703.html> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=543401)
* -Â [XML](show_bug.cgi?ctype=xml&id=543401)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=543401)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=543401&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)



=== Content from gitlab.eclipse.org_1cfefddc_20250126_033107.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

## Pages

17

[Home](/eclipsefdn/helpdesk/-/wikis/home)

[Webmaster FAQ](/eclipsefdn/helpdesk/-/wikis/Webmaster_FAQ)

[IT Infrastructure](/eclipsefdn/helpdesk/-/wikis/IT_Infrastructure_Doc)

[IT Service Level Objectives](/eclipsefdn/helpdesk/-/wikis/IT-Service-Level-Objectives)

[SSH Fingerprints](/eclipsefdn/helpdesk/-/wikis/SSH_Fingerprints)

[Mailing Lists](/eclipsefdn/helpdesk/-/wikis/Mailinglists)

[Sharing Secrets](/eclipsefdn/helpdesk/-/wikis/Sharing-secrets)

[FAQ (Frequently Asked Questions)](/eclipsefdn/helpdesk/-/wikis/FAQ)

[Service/Infrastructure Changes](/eclipsefdn/helpdesk/-/wikis/Eclipse-Service/Infrastructure-changes-Guide)

[Infrastructure changes Guide](/eclipsefdn/helpdesk/-/wikis/Eclipse-Service/Infrastructure-changes-Guide)

Copyright Â© Eclipse Foundation, Inc. All Rights Reserved. Â  Â  [Privacy Policy](https://www.eclipse.org/legal/privacy.php) | [Terms of Use](https://www.eclipse.org/legal/termsofuse.php) | [Copyright Agent](https://www.eclipse.org/legal/copyright.php)


