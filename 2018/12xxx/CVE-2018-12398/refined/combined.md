=== Content from bugzilla.mozilla.org_a36fbeb5_20250125_150059.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1488061)
* [XML](/show_bug.cgi?ctype=xml&id=1488061)

Closed
[Bug 1488061](/show_bug.cgi?id=1488061)

Opened 6 years ago
Closed 6 years ago

# Directory indices shouldn't just echo all URL input

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Directory indices shouldn't just echo all URL input

## Categories

### (Core :: Networking, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla64

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | [63+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=63%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified) |
| firefox62 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=wontfix) |
| firefox63 | [+](/buglist.cgi?f1=cf_tracking_firefox63&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=verified) |
| firefox64 | [+](/buglist.cgi?f1=cf_tracking_firefox64&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 | 63+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox62 |  | wontfix |
| firefox63 | + | verified |
| firefox64 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Gijs, Assigned: valentin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2022-31744](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken")

Dependency [tree](/showdependencytree.cgi?id=1488061&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1488061)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-other, sec-moderate, Whiteboard: [necko-triaged][post-critsmash-triage][adv-main63+][adv-esr60.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][post-critsmash-triage][adv-main63+][adv-esr60.3+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!](/attachment.cgi?id=9006071)  [6 years ago](#c1)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   46 bytes, text/x-phabricator-request | bagder : [review+](#c2 "6 years ago")  pascalc : [approval-mozilla-beta+](#c11 "6 years ago")  RyanVM : [approval-mozilla-esr60+](#c14 "6 years ago") | [Details](/attachment.cgi?id=9006071&action=edit) | [Review](/attachment.cgi?id=9006071) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1488061#c0)• 6 years ago |
|  | |

Follow-up from [bug 1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED"):
STR:
1. open:
chrome://browser/content/places/?%27\*{}\*{color:red}
as a toplevel URL
AR:
we show a directory index of the places folder, but we echo the query string into the resulting HTML as-is.
ER:
we shouldn't echo the query string or hash.
We may also want to consider enforcing other restrictions on chrome/resource URLs (e.g. has to match #^[.a-z0-9/\_-]\*$#, so only latin alphanumeric, forward slashes as path separators, '.', '\_' and '-', nothing else). We probably can't reliably enforce any restrictions on file:/// URIs, so sadly probably can't enforce such restrictions on all directory indices.

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a74792_415378)• 6 years ago |

Assignee: nobody → valentin.gosuWhiteboard: [necko-triaged]

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1488061#c1)• 6 years ago |
|  | |

Attached file
[Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!](attachment.cgi?id=9006071)
— [Details](attachment.cgi?id=9006071&action=edit)

|  | [Daniel Stenberg [:bagder]](/user_profile?user_id=16743) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1488061#c2)• 6 years ago |
|  | |

Comment on [attachment 9006071](/attachment.cgi?id=9006071 "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") [[details]](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!")
[Bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") - Remove Query/Ref from the directory listing URI r=bagder!
Daniel Stenberg [:bagder] has approved the revision.
[Attachment #9006071](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") -
Flags: review+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1488061#c3)• 6 years ago |
|  | |

Did you mean to land this?Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1488061#c4)• 6 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #3](/show_bug.cgi?id=1488061#c3 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input"))
> Did you mean to land this?
Yes, thanks for reminding me.Flags: needinfo?(valentin.gosu)Keywords: [csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Priority: -- → P2

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1488061#c5)• 6 years ago |
|  | |

I'm not able to land it with lando.Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1488061#c6)• 6 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/e414fcdabb7209d3ac6a0052f4c0c8c8c89ab35d>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1488061#c7)• 6 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e414fcdabb72>Group: network-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 6 years ago
[status-firefox64](/buglist.cgi?f1=cf_status_firefox64&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla64

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1488061#c8)• 6 years ago |
|  | |

Per the email thread, I believe this needs Beta/ESR60 approval requests?
[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=wontfix)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox63](/buglist.cgi?f1=cf_tracking_firefox63&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox63&o1=equals&v1=%2B)
[tracking-firefox64](/buglist.cgi?f1=cf_tracking_firefox64&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox64&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [63+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=63%2B)Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1488061#c9)• 6 years ago |
|  | |

Gijs, can you request approval for me? I'll be away for two weeks.Flags: needinfo?(valentin.gosu) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1488061#c10)• 6 years ago |
|  | |

Comment on [attachment 9006071](/attachment.cgi?id=9006071 "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") [[details]](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!")
[Bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") - Remove Query/Ref from the directory listing URI r=bagder!
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
Security issue that we've landed fixes for on trunk.
User impact if declined: potential for CSP bypass
Fix Landed on Version: 63 ([bug 1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED")) / 64 ([bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input"))
Risk to taking this patch (and alternatives if risky): very low - this reduces what parts of the URI we display in directory listings.
String or UUID changes made by this patch: n/a
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
Approval Request Comment
[Feature/Bug causing the regression]: security issue
[User impact if declined]: potential for security risk
[Is this code covered by automated tests?]: There are some tests that would have caught catastrophic breakage of chrome/resource directory lists, yes
[Has the fix been verified in Nightly?]: not yet
[Needs manual test from QE? If yes, steps to reproduce]: see [comment #0](/show_bug.cgi?id=1488061#c0 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input")
[List of other uplifts needed for the feature/fix]: n/a
[Is the change risky?]: no
[Why is the change risky/not risky?]: see above.
[String changes made/needed]: n/aFlags: needinfo?(gijskruitbosch+bugs)
[Attachment #9006071](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") -
Flags: approval-mozilla-esr60?
[Attachment #9006071](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1488061#c11)• 6 years ago |
|  | |

Comment on [attachment 9006071](/attachment.cgi?id=9006071 "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") [[details]](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!")
[Bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") - Remove Query/Ref from the directory listing URI r=bagder!
Approved for 63 beta 7, thanks.
[Attachment #9006071](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a1276601_24572)• 6 years ago |

Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1488061#c12)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/6965bf2d3c5a>
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a1393463_458188)• 6 years ago |

Whiteboard: [necko-triaged] → [necko-triaged][post-critsmash-triage]

|  | [Oana Botisan, Desktop QA](/user_profile?user_id=599255) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1488061#c13)• 6 years ago |
|  | |

I managed to reproduce the issue using an older version of Nightly (2018-09-02) on Ubuntu 16.04 x64. The tittle of the index was: Index of jar:file:///tmp/tmpGXTl8x/firefox/browser/omni.ja!/chrome/browser/content/browser/places/?'\*{}\*{color:red}.
I retested everything using latest Nightly 64.0a1 and beta 63.0b7 on Windows 10 x64, macOS 10.13 and Ubuntu 16.04 x64 and aftet the fix the tittle is: Index of jar:file:///home/oana.botisan/Desktop/latest Nightly/firefox/browser/omni.ja!/chrome/browser/content/browser/places/. The tittle contained only latin alphanumeric, forward slashes as path separators. I think this bug is fixed.Status: RESOLVED → VERIFIED
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=verified)
[status-firefox64](/buglist.cgi?f1=cf_status_firefox64&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=verified)Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1488061#c14)• 6 years ago |
|  | |

Comment on [attachment 9006071](/attachment.cgi?id=9006071 "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") [[details]](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!")
[Bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") - Remove Query/Ref from the directory listing URI r=bagder!
Fixes a networking sec issue. Approved for ESR 60.3.
[Attachment #9006071](/attachment.cgi?id=9006071&action=edit "Bug 1488061 - Remove Query/Ref from the directory listing URI r=bagder!") -
Flags: approval-mozilla-esr60? → approval-mozilla-esr60+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1488061#c15)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/050d0cfa8e3d>
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)Flags: qe-verify+

|  | [Stefan [:StefanG\_QA]](/user_profile?user_id=584294) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a2863355_584294)• 6 years ago |

QA Contact: jduell.mcbugs

|  | [Paul\_B](/user_profile?user_id=619063) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1488061#c16)• 6 years ago |
|  | |

I managed to reproduce the issue using version 60.2.0ESR (20180903060751). The tittle of the index was: Index of jar:file:///home/paul/Desktop/firefox/browser/omni.ja!/chrome/browser/content/browser/places/?'\*{}\*{color:red}.
I retested using 60.2.3ESR (2018100421210422) on Windows 10 x64, macOS 10.13.6 and Ubuntu 16.04 x64 and the tittle was: Index of jar:file:///home/paul/Desktop/firefox/firefox/browser/omni.ja!/chrome/browser/content/browser/places/. The issue is fixed -> verified on 60.2.3 ESR.
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified)Flags: qe-verify+

|  | [Stefan [:StefanG\_QA]](/user_profile?user_id=584294) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a2873413_584294)• 6 years ago |

QA Contact: jduell.mcbugs

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a3924333_280903)• 6 years ago |

Whiteboard: [necko-triaged][post-critsmash-triage] → [necko-triaged][post-critsmash-triage][adv-main63+][adv-esr60.3+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a46010478_1689)• 5 years ago |

Group: core-security-release

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1488061#a110263525_159069)• 3 years ago |

Blocks: [CVE-2022-31744](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken")
You need to [log in](/show_bug.cgi?id=1488061&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_ce188b54_20250125_150058.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

## Related documentation

* [Creating an account](https://bmo.readthedocs.io/en/latest/myaccount.html)
# Access Denied

| You are not authorized to access bug 1460538. To see this bug, you must first [log in to an account](/show_bug.cgi?id=1460538&GoAheadAndLogIn=1) with the appropriate permissions. |
| --- |

Please press **Back** and try again.



=== Content from www.mozilla.org_402764c6_20250125_150102.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-26

## Security vulnerabilities fixed in Firefox 63

Announced
October 23, 2018
Impact
critical
Products
Firefox
Fixed in

* Firefox 63

#### [#CVE-2018-12391: HTTP Live Stream audio data is accessible cross-origin](#CVE-2018-12391)

Reporter
Jun Kokatsu
Impact
high
##### Description

During HTTP Live Stream playback on Firefox for Android, audio data can be accessed across origins in violation of security policies. Because the problem is in the underlying Android service, this issue is addressed by treating all HLS streams as cross-origin and opaque to access.
*Note: this issue only affects Firefox for Android. Desktop versions of Firefox are unaffected.*

##### References

* [Bug 1478843](https://bugzilla.mozilla.org/show_bug.cgi?id=1478843)

#### [#CVE-2018-12392: Crash with nested event loops](#CVE-2018-12392)

Reporter
Nils
Impact
high
##### Description

When manipulating user events in nested loops while opening a document through script, it is possible to trigger a potentially exploitable crash due to poor event handling.

##### References

* [Bug 1492823](https://bugzilla.mozilla.org/show_bug.cgi?id=1492823)

#### [#CVE-2018-12393: Integer overflow during Unicode conversion while loading JavaScript](#CVE-2018-12393)

Reporter
R at Zero Day LLC
Impact
high
##### Description

A potential vulnerability was found in 32-bit builds where an integer overflow during the conversion of scripts to an internal UTF-16 representation could result in allocating a buffer too small for the conversion. This leads to a possible out-of-bounds write.
*Note: 64-bit builds are not vulnerable to this issue.*

##### References

* [Bug 1495011](https://bugzilla.mozilla.org/show_bug.cgi?id=1495011)

#### [#CVE-2018-12395: WebExtension bypass of domain restrictions through header rewriting](#CVE-2018-12395)

Reporter
Rob Wu, Andrew Swan
Impact
moderate
##### Description

By rewriting the `Host` request headers using the `webRequest` API, a WebExtension can bypass domain restrictions through domain fronting. This would allow access to domains that share a host that are otherwise restricted.

##### References

* [Bug 1467523](https://bugzilla.mozilla.org/show_bug.cgi?id=1467523)

#### [#CVE-2018-12396: WebExtension content scripts can execute in disallowed contexts](#CVE-2018-12396)

Reporter
Rob Wu
Impact
moderate
##### Description

A vulnerability where a WebExtension can run content scripts in disallowed contexts following navigation or other events. This allows for potential privilege escalation by the WebExtension on sites where content scripts should not be run.

##### References

* [Bug 1483602](https://bugzilla.mozilla.org/show_bug.cgi?id=1483602)

#### [#CVE-2018-12397: Missing warning prompt when WebExtension requests local file access](#CVE-2018-12397)

Reporter
Rob Wu
Impact
moderate
##### Description

A WebExtension can request access to local files without the warning prompt stating that the extension will "Access your data for all websites" being displayed to the user. This allows extensions to run content scripts in local pages without permission warnings when a local file is opened.

##### References

* [Bug 1487478](https://bugzilla.mozilla.org/show_bug.cgi?id=1487478)

#### [#CVE-2018-12398: CSP bypass through stylesheet injection in resource URIs](#CVE-2018-12398)

Reporter
cgvwzq
Impact
moderate
##### Description

By using the reflected URL in some special resource URIs, such as `chrome:`, it is possible to inject stylesheets and bypass Content Security Policy (CSP).

##### References

* [Bug 1460538](https://bugzilla.mozilla.org/show_bug.cgi?id=1460538)
* [Bug 1488061](https://bugzilla.mozilla.org/show_bug.cgi?id=1488061)

#### [#CVE-2018-12402: WebBrowserPersist uses incorrect origin information](#CVE-2018-12402)

Reporter
Björn Ruytenberg, 1lastBr3ath
Impact
moderate
##### Description

The internal `WebBrowserPersist` code does not use correct origin context for a resource being saved. This manifests when sub-resources are loaded as part of "Save Page As..." functionality. For example, a malicious page could recover a visitor's Windows username and NTLM hash by including resources otherwise unreachable to the malicious page, if they can convince the visitor to save the complete web page. Similarly, SameSite cookies are sent on cross-origin requests when the "Save Page As..." menu item is selected to save a page, which can result in saving the wrong version of resources based on those cookies.

##### References

* [Bug 1447087](https://bugzilla.mozilla.org/show_bug.cgi?id=1447087)
* [Bug 1469916](https://bugzilla.mozilla.org/show_bug.cgi?id=1469916)

#### [#CVE-2018-12399: Spoofing of protocol registration notification bar](#CVE-2018-12399)

Reporter
Mathias Wu
Impact
low
##### Description

When a new protocol handler is registered, the API accepts a title argument which can be used to mislead users about which domain is registering the new protocol. This may result in the user approving a protocol handler that they otherwise would not have.

##### References

* [Bug 1490276](https://bugzilla.mozilla.org/show_bug.cgi?id=1490276)

#### [#CVE-2018-12400: Favicons are cached in private browsing mode on Firefox for Android](#CVE-2018-12400)

Reporter
Konark Modi
Impact
low
##### Description

In private browsing mode on Firefox for Android, favicons are cached in the `cache/icons` folder as they are in non-private mode. This allows information leakage of sites visited during private browsing sessions.
*Note: this issue only affects Firefox for Android. Desktop versions of Firefox are unaffected.*

##### References

* [Bug 1448305](https://bugzilla.mozilla.org/show_bug.cgi?id=1448305)

#### [#CVE-2018-12401: DOS attack through special resource URI parsing](#CVE-2018-12401)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

Some special resource URIs will cause a non-exploitable crash if loaded with optional parameters following a '?' in the parsed string. This could lead to denial of service (DOS) attacks.

##### References

* [Bug 1422456](https://bugzilla.mozilla.org/show_bug.cgi?id=1422456)

#### [#CVE-2018-12403: Mixed content warning is not displayed when HTTPS page loads a favicon over HTTP](#CVE-2018-12403)

Reporter
Yiğit Can Yilmaz
Impact
low
##### Description

If a site is loaded over a HTTPS connection but loads a favicon resource over HTTP, the mixed content warning is not displayed to users.

##### References

* [Bug 1484753](https://bugzilla.mozilla.org/show_bug.cgi?id=1484753)

#### [#CVE-2018-12388: Memory safety bugs fixed in Firefox 63](#CVE-2018-12388)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Dana Keeler, Ronald Crane, Marcia Knous, Tyson Smith, Daniel Veditz, and Steve Fink reported memory safety bugs present in Firefox 62. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 63](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1472639%2C1485698%2C1301547%2C1471427%2C1379411%2C1482122%2C1486314%2C1487167)

#### [#CVE-2018-12390: Memory safety bugs fixed in Firefox 63 and Firefox ESR 60.3](#CVE-2018-12390)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Bob Owen, Boris Zbarsky, Calixte Denizet, Jason Kratzer, Jed Davis, Taegeon Lee, Philipp, Ronald Crane, Raul Gurzau, Gary Kwong, Tyson Smith, Raymond Forbes, and Bogdan Tara reported memory safety bugs present in Firefox 62 and Firefox ESR 60.2. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 63 and Firefox ESR 60.3](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1487098%2C1487660%2C1490234%2C1496159%2C1443748%2C1496340%2C1483905%2C1493347%2C1488803%2C1498701%2C1498482%2C1442010%2C1495245%2C1483699%2C1469486%2C1484905%2C1490561%2C1492524%2C1481844)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from usn.ubuntu.com_ee752030_20250125_150101.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3801-1: Firefox vulnerabilities

24 October 2018

Firefox could be made to crash or run programs as your login if it
opened a malicious website.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.10](/security/notices?release=cosmic)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [firefox](/security/cves?package=firefox) - Mozilla Open Source web browser

## Details

Multiple security issues were discovered in Firefox. If a user were

tricked in to opening a specially crafted website, an attacker could

potentially exploit these to cause a denial of service, bypass CSP

restrictions, spoof the protocol registration notification bar, leak

SameSite cookies, bypass mixed content warnings, or execute arbitrary

code. ([CVE-2018-12388](/security/CVE-2018-12388), [CVE-2018-12390](/security/CVE-2018-12390), [CVE-2018-12392](/security/CVE-2018-12392), [CVE-2018-12393](/security/CVE-2018-12393),

[CVE-2018-12398](/security/CVE-2018-12398), [CVE-2018-12399](/security/CVE-2018-12399), [CVE-2018-12401](/security/CVE-2018-12401), [CVE-2018-12402](/security/CVE-2018-12402),

[CVE-2018-12403](/security/CVE-2018-12403))

Multiple security issues were discovered with WebExtensions in Firefox.

If a user were tricked in to installing a specially crafted extension, an

attacker could potentially exploit these to bypass domain restrictions,

gain additional privileges, or run content scripts in local pages without

permission. ([CVE-2018-12395](/security/CVE-2018-12395), [CVE-2018-12396](/security/CVE-2018-12396), [CVE-2018-12397](/security/CVE-2018-12397))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [63.0+build2-0ubuntu0.18.10.2](https://launchpad.net/ubuntu/%2Bsource/firefox/63.0%2Bbuild2-0ubuntu0.18.10.2)

##### Ubuntu 18.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [63.0+build2-0ubuntu0.18.04.2](https://launchpad.net/ubuntu/%2Bsource/firefox/63.0%2Bbuild2-0ubuntu0.18.04.2)

##### Ubuntu 16.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [63.0+build2-0ubuntu0.16.04.2](https://launchpad.net/ubuntu/%2Bsource/firefox/63.0%2Bbuild2-0ubuntu0.16.04.2)

##### Ubuntu 14.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [63.0+build2-0ubuntu0.14.04.2](https://launchpad.net/ubuntu/%2Bsource/firefox/63.0%2Bbuild2-0ubuntu0.14.04.2)

After a standard system update you need to restart Firefox to make

all the necessary changes.

## References

* [CVE-2018-12388](/security/CVE-2018-12388)
* [CVE-2018-12390](/security/CVE-2018-12390)
* [CVE-2018-12392](/security/CVE-2018-12392)
* [CVE-2018-12393](/security/CVE-2018-12393)
* [CVE-2018-12395](/security/CVE-2018-12395)
* [CVE-2018-12396](/security/CVE-2018-12396)
* [CVE-2018-12397](/security/CVE-2018-12397)
* [CVE-2018-12398](/security/CVE-2018-12398)
* [CVE-2018-12399](/security/CVE-2018-12399)
* [CVE-2018-12401](/security/CVE-2018-12401)
* [CVE-2018-12402](/security/CVE-2018-12402)
* [CVE-2018-12403](/security/CVE-2018-12403)

## Related notices

* [USN-3868-1](/security/notices/USN-3868-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_af5758b6_20250126_094346.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1487478)
* [XML](/show_bug.cgi?ctype=xml&id=1487478)

Closed
[Bug 1487478](/show_bug.cgi?id=1487478)
(CVE-2018-12397)

Opened 6 years ago
Closed 6 years ago

# "file:///\*" extension permission has no warning

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"file:///\*" extension permission has no warning

## Categories

### (WebExtensions :: General, defect)

[Product:](/describecomponents.cgi?product=WebExtensions)

WebExtensions
▾

WebExtensions
File feature requests and bugs related to the WebExtension add-on API.
[See Open Bugs in This Product](/buglist.cgi?product=WebExtensions&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=WebExtensions)
Watch This Product

[Component:](/describecomponents.cgi?product=WebExtensions&component=General#General)

General
▾

WebExtensions :: General
All other bugs about WebExtensions
[See Open Bugs in This Component](/buglist.cgi?product=WebExtensions&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=WebExtensions&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=WebExtensions&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### (firefox-esr6063+ verified, firefox62 wontfix, firefox63+ verified, firefox64+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla64

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | [63+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=63%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified) |
| firefox62 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=wontfix) |
| firefox63 | [+](/buglist.cgi?f1=cf_tracking_firefox63&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=verified) |
| firefox64 | [+](/buglist.cgi?f1=cf_tracking_firefox64&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 | 63+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox62 |  | wontfix |
| firefox63 | + | verified |
| firefox64 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

[Blocking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Blocking_Flags)

| webextensions | --- |
| --- | --- |

## People

### (Reporter: robwu, Assigned: robwu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/5bd88cf3a23a91a5c0dd0d6dd5573f51?d=mm&size=40)  [ddurst](/user_profile?user_id=500559)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e2fa737f7938f690847d2f5eeea87025?d=mm&size=40)  [willdurand](/user_profile?user_id=603050)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1487353](/show_bug.cgi?id=1487353 "RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file")

## Details

### (Keywords: csectype-priv-escalation, csectype-spoof, sec-moderate, Whiteboard: [adv-main63+][adv-esr60.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-12397

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main63+][adv-esr60.3+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [file-perm-nowarning.xpi](/attachment.cgi?id=9005272)  [6 years ago](#c0)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   645 bytes, application/x-xpinstall |  | [Details](/attachment.cgi?id=9005272&action=edit) |
| --- | --- | --- |
| [no-warning.png](/attachment.cgi?id=9005274)  [6 years ago](#c1)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   21.25 KB, image/png |  | [Details](/attachment.cgi?id=9005274&action=edit) |
| [Bug 1487478 - Move MatchPattern normalization into classifyPermission](/attachment.cgi?id=9005277)  [6 years ago](#c3)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   46 bytes, text/x-phabricator-request | aswan : [review+](#c5 "6 years ago") | [Details](/attachment.cgi?id=9005277&action=edit) | [Review](/attachment.cgi?id=9005277) |
| [0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch](/attachment.cgi?id=9015713)  [6 years ago](#c15)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   6.31 KB, patch | pascalc : [approval-mozilla-beta+](#c17 "6 years ago")  RyanVM : [approval-mozilla-esr60+](#c19 "6 years ago") | [Details](/attachment.cgi?id=9015713&action=edit) | [Diff](/attachment.cgi?id=9015713&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1487478&attachment=9015713) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1487478#c0)• 6 years ago |
|  | |

Attached file
[file-perm-nowarning.xpi](attachment.cgi?id=9005272)
— [Details](attachment.cgi?id=9005272&action=edit)

When an extension requests the "file:///\*" permission, it gets access to local files, but there are no permission warnings (unlike "file://\*/\*", which has the "Access your data for all websites" warning).
1. Visit about:config and set xpinstall.signatures.required to false (requires Nightly or unbranded build).
2. Install the attached xpi file.
3. Visit a local file or directory in the browser.
Expected:
- At step 2, a warning should be displayed about the fact that extensions can access local files.
- At step 3, the local file should have a pink background (=extension ran script in the file).
(alternatively, depending on the resolution of [bug 1487353](/show_bug.cgi?id=1487353 "RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file"), the local file should not be pink, and the warning at step 2 is not relevant)
Actual:
- At step 2, no warnings are displayed.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1487478#c1)• 6 years ago |
|  | |

Attached image
[no-warning.png](attachment.cgi?id=9005274)
— [Details](attachment.cgi?id=9005274&action=edit)

Screenshot taken at step 2 in Firefox Nightly (63). I also confirmed this bug in stable (61).
Compare this with the screenshot from [bug 1487353](/show_bug.cgi?id=1487353 "RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file"), where the permission warning was actually displayed: <https://bug1487353.bmoattachments.org/attachment.cgi?id=9005150>

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a209_447061)• 6 years ago |

Assignee: nobody → robStatus: NEW → ASSIGNED

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1487478#c2)• 6 years ago |
|  | |

"Unparseable host permission file:///\*" appears in the global console when the installation doorhanger is shown. Reminds me of [bug 1426363](/show_bug.cgi?id=1426363 "VERIFIED FIXED - Host permissions with scheme wildcard (*://...) are not shown in permissions doorhangers") ...

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1487478#c3)• 6 years ago |
|  | |

Attached file
[Bug 1487478 - Move MatchPattern normalization into classifyPermission](attachment.cgi?id=9005277)
— [Details](attachment.cgi?id=9005277&action=edit)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1487478#c4)• 6 years ago |
|  | |

I scanned AMO and found:
- 164 extensions use "file:///" in permissions, optional\_permissions or content\_scripts[\*].matches.
- 7 extensions don't have "<all\_urls>", "[https://\*/](https://*/)\*", "[http://\*/](http://*/)\*" or "\*://\*/\*" in permissions or content\_scripts[\*].matches.
Fixing this bug would result in an additional "Access your data for all websites" warning for new installations of these 7 add-ons that are listed on AMO (AMO file IDs: 854766 866049 876007 872569 909653 940036 975288 ).

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a1023408_600971)• 6 years ago |

[Attachment #9005277](/attachment.cgi?id=9005277&action=edit "Bug 1487478 - Move MatchPattern normalization into classifyPermission") -
Attachment description: Bug 1487478 - Handle empty hosts in URL pattern → Bug 1487478 - Move MatchPattern normalization into classifyPermission

|  | [Andrew Swan [:aswan]](/user_profile?user_id=561655) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1487478#c5)• 6 years ago |
|  | |

Comment on [attachment 9005277](/attachment.cgi?id=9005277 "Bug 1487478 - Move MatchPattern normalization into classifyPermission") [[details]](/attachment.cgi?id=9005277&action=edit "Bug 1487478 - Move MatchPattern normalization into classifyPermission")
[Bug 1487478](/show_bug.cgi?id=1487478 "VERIFIED FIXED - \"file:///*\" extension permission has no warning") - Move MatchPattern normalization into classifyPermission
Andrew Swan [:aswan] has approved the revision.
[Attachment #9005277](/attachment.cgi?id=9005277&action=edit "Bug 1487478 - Move MatchPattern normalization into classifyPermission") -
Flags: review+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1487478#c6)• 6 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d2fa56922a47956d230e8e6581843fa1615282ff>
<https://hg.mozilla.org/mozilla-central/rev/d2fa56922a47>Group: toolkit-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 6 years ago
[status-firefox64](/buglist.cgi?f1=cf_status_firefox64&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla64

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1487478#c7)• 6 years ago |
|  | |

What branches are affected by this issue? Also, can you help assign this bug a severity?
<https://wiki.mozilla.org/Security_Severity_Ratings>Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1487478#c8)• 6 years ago |
|  | |

All branches are affected.
This allows extensions to run content scripts in local pages without permission warnings.
Extensions cannot navigate to file:-URLs themselves, so in order to exploit this, a user needs to:
- Install an extension that exploits this vulnerability.
- Open a local file in the browser.
The impact can be improved even more when combined with [bug 1487353](/show_bug.cgi?id=1487353 "RESOLVED FIXED - Extensions can run content scripts in local files and read any other local file").
I'd therefore rate this as follows:
csectype-priv-escalation,csectype-spoof,sec-moderateFlags: needinfo?(rob)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a2476036_75935)• 6 years ago |

[status-firefox62](/buglist.cgi?f1=cf_status_firefox62&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox62&o1=equals&v1=wontfix)
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)Flags: qe-verify+Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1487478#c9)• 6 years ago |
|  | |

Is this ready for Beta & ESR60 approval requests?Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1487478#c10)• 6 years ago |
|  | |

Andrew, in <https://phabricator.services.mozilla.com/D4707#156518> you said:
> This bug doesn't seem like it necessarily needs to be uplifted.
Do you still believe that it's true, given [comment 8](/show_bug.cgi?id=1487478#c8 "VERIFIED FIXED - \"file:///*\" extension permission has no warning") ?
If not, then I will prepare a new patch for Beta and ESR60.Flags: needinfo?(rob) → needinfo?(aswan)QA Contact: ddurst

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1487478#c11)• 6 years ago |
|  | |

(That "QA Contact" field was automatically populated for some reason unknown to me)

|  | [Andrew Swan [:aswan]](/user_profile?user_id=561655) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1487478#c12)• 6 years ago |
|  | |

(In reply to Rob Wu [:robwu] from [comment #10](/show_bug.cgi?id=1487478#c10 "VERIFIED FIXED - \"file:///*\" extension permission has no warning"))
> > This bug doesn't seem like it necessarily needs to be uplifted.
>
> Do you still believe that it's true, given [comment 8](/show_bug.cgi?id=1487478#c8 "VERIFIED FIXED - \"file:///*\" extension permission has no warning") ?
I think that's a question for abillings and/or dveditzFlags: needinfo?(aswan)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1487478#c13)• 6 years ago |
|  | |

Should this patch be uplifted to Beta and ESR? I believe so given the low risk of the patch and the impact (see [comment 8](/show_bug.cgi?id=1487478#c8 "VERIFIED FIXED - \"file:///*\" extension permission has no warning")), but I'd like a confirmation given [comment 12](/show_bug.cgi?id=1487478#c12 "VERIFIED FIXED - \"file:///*\" extension permission has no warning").Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1487478#c14)• 6 years ago |
|  | |

Seems reasonable, please request approval for those branches.Flags: needinfo?(dveditz)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1487478#c15)• 6 years ago |
|  | |

Attached patch

[0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch](attachment.cgi?id=9015713&action=diff)
— [Details](attachment.cgi?id=9015713&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1487478&attachment=9015713)

This patch is a clone of <https://hg.mozilla.org/mozilla-central/rev/d2fa56922a47> with one modification: the "throw new Error(...)" change was reverted to "Cu.reportError(...);" + "continue" to minimize the risk of causing regressions. This was approved in: <https://phabricator.services.mozilla.com/D4707?id=14415#inline-26619>

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1487478#c16)• 6 years ago |
|  | |

Comment on [attachment 9015713](/attachment.cgi?id=9015713 "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[details]](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[diff]](/attachment.cgi?id=9015713&action=diff "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1487478&attachment=9015713)
0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch
Automated tests are not checked in yet, but I added extensive test coverage in the patch at [bug 1484263](/show_bug.cgi?id=1484263 "RESOLVED FIXED - Clean up mozillaAddons permission parsing logic in _parseManifest").
The exact scenario that triggered this bug has not been added yet; I can either delay that other patch or add a test case later as a part of this bug.
[Beta/Release Uplift Approval Request]
Feature/Bug causing the regression: None
User impact if declined: Extensions can run content scripts in local pages without permission warnings.
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1487478#c8](/show_bug.cgi?id=1487478#c8 "VERIFIED FIXED - \"file:///*\" extension permission has no warning")
Is this code covered by automated tests?: Yes
Has the fix been verified in Nightly?: Yes
Needs manual test from QE?: No
If yes, steps to reproduce:
List of other uplifts needed: None
Risk to taking this patch: Low
Why is the change risky/not risky? (and alternatives if risky): The warning check is only activated for new extension installs. 7 extensions on AMO are affected: [https://bugzilla.mozilla.org/show\_bug.cgi?id=1487478#c4](/show_bug.cgi?id=1487478#c4 "VERIFIED FIXED - \"file:///*\" extension permission has no warning")
String changes made/needed: None
[ESR Uplift Approval Request]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: Fixes lack of permission warning (about local file access) upon extension install.
User impact if declined: Extensions can run content scripts in local pages without permission warnings.
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1487478#c8](/show_bug.cgi?id=1487478#c8 "VERIFIED FIXED - \"file:///*\" extension permission has no warning")
Fix Landed on Version: 64, pending uplift to 63
Risk to taking this patch: Low
Why is the change risky/not risky? (and alternatives if risky): The warning check is only activated for new extension installs. 7 extensions on AMO are affected: [https://bugzilla.mozilla.org/show\_bug.cgi?id=1487478#c4](/show_bug.cgi?id=1487478#c4 "VERIFIED FIXED - \"file:///*\" extension permission has no warning")
String or UUID changes made by this patch: None
[Attachment #9015713](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") -
Flags: approval-mozilla-esr60?
[Attachment #9015713](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1487478#c17)• 6 years ago |
|  | |

Comment on [attachment 9015713](/attachment.cgi?id=9015713 "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[details]](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[diff]](/attachment.cgi?id=9015713&action=diff "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1487478&attachment=9015713)
0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch
Baked on nightly for a week without any reported regression, approved for uplift to our last 63 beta. Thanks.
[Attachment #9015713](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1487478#c18)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3479e999805b>
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed)
[tracking-firefox63](/buglist.cgi?f1=cf_tracking_firefox63&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox63&o1=equals&v1=%2B)
[tracking-firefox64](/buglist.cgi?f1=cf_tracking_firefox64&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox64&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [63+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=63%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1487478#c19)• 6 years ago |
|  | |

Comment on [attachment 9015713](/attachment.cgi?id=9015713 "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[details]](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[diff]](/attachment.cgi?id=9015713&action=diff "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1487478&attachment=9015713)
0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch
Approved for ESR 60.3.
[Attachment #9015713](/attachment.cgi?id=9015713&action=edit "0001-Bug-1487478-Move-MatchPattern-normalization-into-cla.patch") -
Flags: approval-mozilla-esr60? → approval-mozilla-esr60+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1487478#c20)• 6 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr60/rev/cb73374a0e4e>
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed)

|  | [Gyula Palko[:gpalko]](/user_profile?user_id=615400) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1487478#c21)• 6 years ago |
|  | |

Verified as fixed on Nightly 64(20181010235834), latest Beta from <https://treeherder.mozilla.org/#/jobs?repo=mozilla-beta> and latest ESR60 from <https://tools.taskcluster.net/index/gecko.v2.mozilla-esr60.latest.firefox/win64-opt>
Permission warning about data access is displayed on the doorhanger when the attached extension is installed.Status: RESOLVED → VERIFIED
[status-firefox63](/buglist.cgi?f1=cf_status_firefox63&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox63&o1=equals&v1=verified)
[status-firefox64](/buglist.cgi?f1=cf_status_firefox64&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox64&o1=equals&v1=verified)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=verified)Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a4169042_280903)• 6 years ago |

Whiteboard: [adv-main63+][adv-esr60.3+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a4234603_280903)• 6 years ago |

Alias: CVE-2018-12397

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1487478#a46252235_1689)• 5 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1487478&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rob Wu [:robwu]](/user_profile?user_id=447061)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


