=== Content from bugs.winehq.org_9b6eec6a_20250124_141512.html ===


[![](https://dl.winehq.org/share/images/winehq_logo_glass_sm.png)](/)
[![WineHQ](https://dl.winehq.org/share/images/winehq_logo_text.png "WineHQ")](/)
Bug Tracking Database – Bug 45105

Search:

* [WineHQ](//www.winehq.org/)
* [Wiki](http://wiki.winehq.org/)
* [AppDB](//appdb.winehq.org/)
* [Bugzilla](//bugs.winehq.org/)
* [Forums](//forum.winehq.org/)

* Task Lists
* [Regressions](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=regression&columnlist=bug_severity,priority,bug_status,cf_regression_sha1sum,short_desc,changeddate&keywords_type=anywords)
* [With download](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=download&keywords_type=anywords)
* [With patch](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=NEEDINFO&bug_status=STAGED&product=Wine&keywords=patch&keywords_type=anywords)

* Bug Lists
* [Available](buglist.cgi?bug_status=UNCONFIRMED&bug_status=NEW&bug_status=REOPENED&cmdtype=doit&order=Bug+Number)
* [Assigned](buglist.cgi?bug_status=ASSIGNED)
* [NeedInfo](buglist.cgi?bug_status=NEEDINFO)
* [Staged](buglist.cgi?bug_status=STAGED)
* [Resolved](buglist.cgi?bug_status=RESOLVED)

| Bugzilla |  | Last modified: 2024-08-23 20:35:49 UTC |
| --- | --- | --- |

|  |
| --- |

* [Intro](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

   [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](http://www.bugzilla.org/docs/4.0/en/html/bug_page.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=45105&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=45105&GoAheadAndLogIn=1#forgot)
  Login:

  [x]
## heap-buffer overflow in gdi32 (CVE-2018-12932)

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

[**Bug 45105**](show_bug.cgi?id=45105) -
heap-buffer overflow in gdi32 (CVE-2018-12932)

|  | |
| --- | --- |
| [Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.") | heap-buffer overflow in gdi32 (CVE-2018-12932) |

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | **AppDB**: | [Show Apps affected by this bug](//appdb.winehq.org/viewbugs.php?iBugId=45105) | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Wine | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Wine "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | gdi32 | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 3.7 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone](page.cgi?id=fields.html#target_milestone): | --- | | [Assigned To](page.cgi?id=fields.html#assigned_to): | Mr. Bugs | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords](describekeywords.cgi): |  | | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=45105&hide_resolved=1) | | |  | | Reported: | 2018-05-01 09:29 UTC by Robert | | --- | --- | | Modified: | 2024-08-23 20:35 UTC ([History](show_activity.cgi?id=45105)) | | CC List: | 4 users (show)  fdsfgs jre.winesim madewokherd marcus | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Regression SHA1:](page.cgi?id=fields.html#cf_regression_sha1sum "SHA1 of the git commit that caused the regression.") |  | | | [Fixed by SHA1:](https://gitlab.winehq.org/wine/wine/-/commit/1f04c5c7dec21efd8771e1f4c32e24a18ce9847c "SHA1 of the git commit that fixed the bug.") | 1f04c5c7dec21efd8771e1f4c32e24a18ce9847c | | | [Distribution:](page.cgi?id=fields.html#cf_distribution "A custom Drop Down field in this installation of Bugzilla.") | --- | | | [Staged patchset:](page.cgi?id=fields.html#cf_staged_patchset "URL to patchset in staging") |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**affected source code**](attachment.cgi?id=61284 "View the content of the attachment") (1.75 KB, text/plain)  [2018-05-01 09:29 UTC](#attach_61284 "Go to the comment associated with the attachment"), Robert | [Details](attachment.cgi?id=61284&action=edit) | | [View All](attachment.cgi?bugid=45105&action=viewall)  [Add an attachment](attachment.cgi?bugid=45105&action=enter) (back traces, logs, proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=45105&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=45105#c0)  Robert    2018-05-01 09:29:19 UTC  ``` Created [attachment 61284](attachment.cgi?id=61284 "affected source code") [[details]](attachment.cgi?id=61284&action=edit "affected source code") affected source code  Original submitted report can be found here: [https://bugs.launchpad.net/ubuntu/+source/wine/+bug/1764719](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719)  The attachment also contains more details. If more info is needed, please let me know! ``` [Comment 1](show_bug.cgi?id=45105#c1)  Esme Povirk    2018-05-08 10:39:52 UTC  ``` Lack of bounds checking is a more general problem in PlayEnhMetaFileRecord. We don't check that the record itself is large enough for all its fields, or that other variable-length fields fit.  I think it might be better to do the bounds checking in EnumEnhMetaFile. It's unreasonable to expect individual applications to do exhaustive bounds checking in their own enum callbacks. ``` [Comment 2](show_bug.cgi?id=45105#c2)  Marcus Meissner    2018-07-02 08:58:36 UTC  ``` Vincent committed at least these two patches:  <https://source.winehq.org/git/wine.git/commit/b6da3547d8990c3c3affc3a5865aefd2a0946949> <https://source.winehq.org/git/wine.git/commit/8d2676fd14f130f9e8f06744743423168bf8d18d> ``` [Comment 3](show_bug.cgi?id=45105#c3)  Esme Povirk    2024-08-12 20:35:50 UTC  ``` Tested all sample files from the launchpad bug and got no crashes (previously, some of them logged access violations in unixlib code), so I think this is fixed. ``` [Comment 4](show_bug.cgi?id=45105#c4)  Alexandre Julliard    2024-08-23 20:35:49 UTC  ``` Closing bugs fixed in 9.16. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=45105)
* - [XML](show_bug.cgi?ctype=xml&id=45105)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=45105)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*This bug is not in your last
search results.*

* + [Intro](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

     [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](http://www.bugzilla.org/docs/4.0/en/html/bug_page.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=45105&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=45105&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[Privacy Policy](https://wiki.winehq.org/WineHQ_Wiki%3APrivacy_policy)

If you have a privacy inquiry regarding this site, please write to [[email protected]](/cdn-cgi/l/email-protection#a3d3d1cad5c2c0dae3d4cacdc6cbd28dccd1c4)

Hosted By
[![CodeWeavers](https://dl.winehq.org/share/images/cw_logo_sm.png "CodeWeavers - Run Windows applications and games on Mac and Linux")](http://www.codeweavers.com/)



=== Content from bugs.launchpad.net_3fcf3d1b_20250124_141509.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[wine package](https://launchpad.net/ubuntu/%2Bsource/wine)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/wine)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/wine)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/wine)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/wine)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/wine)

# Security vulnerabilities in Wine when handling EMF files

Bug #1764719 reported by
[Robert Gawlik](https://launchpad.net/~rh0)
on 2018-04-17

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [wine (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/wine "Latest release: 10.0~rc2~repack-2, uploaded to main on 2024-12-31 16:46:03.234053+00:00 by Debian Wine Team (debian-wine), maintained by Debian Wine Team (debian-wine)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

============================================================

# Security vulnerabilities in Wine when handling EMF files #

============================================================

Bug Description was moved to attachment advisory.txt

Thank you!!

Best regards,

Robert Gawlik

(Ruhr-Universität Bochum)

See [original description](comments/0)

Tags:

[community-security](/ubuntu/%2Bsource/wine/%2Bbugs?field.tag=community-security)

## CVE References

* [2018-12932](/bugs/cve/2018-12932 "PlayEnhMetaFileRecord in enhmetafile....")
* [2018-12933](/bugs/cve/2018-12933 "PlayEnhMetaFileRecord in enhmetafile....")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-17: |  |  | [#1](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/1) |
| --- | --- | --- | --- |

* [out\_of\_bounds\_write.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119292/%2Bfiles/out_of_bounds_write.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119292)
  (236 bytes,
  application/octet-stream)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-17: |  |  | [#2](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/2) |
| --- | --- | --- | --- |

* [out\_of\_bounds\_read.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119293/%2Bfiles/out_of_bounds_read.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119293)
  (148 bytes,
  application/octet-stream)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-17: |  |  | [#3](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/3) |
| --- | --- | --- | --- |

* [heap\_buffer\_overflow.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119294/%2Bfiles/heap_buffer_overflow.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119294)
  (476 bytes,
  application/octet-stream)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-17: |  |  | [#4](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/4) |
| --- | --- | --- | --- |

* [gdiplus\_trigger.cpp](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119295/%2Bfiles/gdiplus_trigger.cpp)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119295)
  (791 bytes,
  text/x-c++src)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-17: |  |  | [#5](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/5) |
| --- | --- | --- | --- |

* [advisory.txt](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119296/%2Bfiles/advisory.txt)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119296)
  (7.2 KiB,
  text/plain)

since there were newlines inserted into the bug description which made it less readable I attached it as advisory.txt

since there were newlines inserted into the bug description which made it less readable I attached it as advisory.txt

| **description**: | updated |
| --- | --- |

[Robert Gawlik (rh0)](https://launchpad.net/~rh0)
on 2018-04-17

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2018-04-18: |  |  | [#6](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/6) |
| --- | --- | --- | --- |

Hi Robert, thanks for the report. Has the upstream wine project been notified? As wine is in universe, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: <https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures> .

Thanks!

Hi Robert, thanks for the report. Has the upstream wine project been notified? As wine is in universe, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures .
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-04-18: |  |  | [#7](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/7) |
| --- | --- | --- | --- |

I informed <https://launchpad.net/~ubuntu-wine>. I can also file a bug report to <https://bugs.winehq.org>, but I didn't find an option to mark reports as private there, hence everybody would see it. If that's ok, I can still do it.

I informed https://launchpad.net/~ubuntu-wine. I can also file a bug report to https://bugs.winehq.org, but I didn't find an option to mark reports as private there, hence everybody would see it. If that's ok, I can still do it.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2018-04-19: |  |  | [#8](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/8) |
| --- | --- | --- | --- |

Hi Robert, for reports that should be kept embargoed, I believe you can contact Alexandre Julliard <email address hidden> (wine lead developer) and CC: Marcus Meissner <email address hidden> (wine developer and SuSE security contact). Thanks!

Hi Robert, for reports that should be kept embargoed, I believe you can contact Alexandre Julliard <julliard@winehq.org> (wine lead developer) and CC: Marcus Meissner <meissner@suse.de> (wine developer and SuSE security contact). Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Scott Ritchie (scottritchie)](https://launchpad.net/~scottritchie) wrote on 2018-04-20: |  |  | [#9](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/9) |
| --- | --- | --- | --- |

I already contacted julliard@ out of band, and he's fine with putting the reports public now.

I already contacted julliard@ out of band, and he's fine with putting the reports public now.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2018-05-01: |  |  | [#10](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/10) |
| --- | --- | --- | --- |

Hello Robert, Scott, do you know if CVE numbers have been assigned for these issues yet? Are patches available from upstream?

Thanks

Hello Robert, Scott, do you know if CVE numbers have been assigned for these issues yet? Are patches available from upstream?
Thanks

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Gawlik (rh0)](https://launchpad.net/~rh0) wrote on 2018-05-01: |  |  | [#11](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/11) |
| --- | --- | --- | --- |

Hello Seth,

afaik there are no CVEs assigned yet. I split the report and submitted three bugs finally today:

<https://bugs.winehq.org/show_bug.cgi?id=45104>

<https://bugs.winehq.org/show_bug.cgi?id=45105>

<https://bugs.winehq.org/show_bug.cgi?id=45106>

Best regards!

Hello Seth,
afaik there are no CVEs assigned yet. I split the report and submitted three bugs finally today:
https://bugs.winehq.org/show\_bug.cgi?id=45104
https://bugs.winehq.org/show\_bug.cgi?id=45105
https://bugs.winehq.org/show\_bug.cgi?id=45106
Best regards!

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2018-05-18

| Changed in wine (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |

[Simon Quigley (tsimonq2)](https://launchpad.net/~tsimonq2)
on 2018-06-30

| **tags**: | added: community-security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vincent Povirk (madewokherd)](https://launchpad.net/~madewokherd) wrote on 2024-08-13: |  |  | [#12](/ubuntu/%2Bsource/wine/%2Bbug/1764719/comments/12) |
| --- | --- | --- | --- |

I sent MRs for the remaining Wine bugs, which have been included in the 9.15 release. The attached .emf files no longer cause a page fault. Best I can tell, this is fixed.

I sent MRs for the remaining Wine bugs, which have been included in the 9.15 release. The attached .emf files no longer cause a page fault. Best I can tell, this is fixed.

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/wine/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [out\_of\_bounds\_write.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119292/%2Bfiles/out_of_bounds_write.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119292 "Change attachment details")
* [out\_of\_bounds\_read.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119293/%2Bfiles/out_of_bounds_read.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119293 "Change attachment details")
* [heap\_buffer\_overflow.emf](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119294/%2Bfiles/heap_buffer_overflow.emf)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119294 "Change attachment details")
* [gdiplus\_trigger.cpp](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119295/%2Bfiles/gdiplus_trigger.cpp)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119295 "Change attachment details")
* [advisory.txt](https://bugs.launchpad.net/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119296/%2Bfiles/advisory.txt)
  [Edit](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Battachment/5119296 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/wine/%2Bbug/1764719/%2Baddcomment)

## Remote bug watches

* [wine-bugs #45104](https://bugs.winehq.org/show_bug.cgi?id=45104)

  [UNCONFIRMED]
  [Edit](/bugs/1764719/%2Bwatch/128830 "Change watch details")
* [wine-bugs #45105](https://bugs.winehq.org/show_bug.cgi?id=45105)

  [UNCONFIRMED]
  [Edit](/bugs/1764719/%2Bwatch/128831 "Change watch details")
* [wine-bugs #45106](https://bugs.winehq.org/show_bug.cgi?id=45106)

  [NEW]
  [Edit](/bugs/1764719/%2Bwatch/128832 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from source.winehq.org_b2d83a81_20250124_141515.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
b6da3547**

authored
May 08, 2018
by
**![Esme Povirk's avatar](https://seccdn.libravatar.org/avatar/76c09286549f7e3ed0718b61217d918dce54d976e9b329b5eb5b0c8dc5aab472?s=48&d=identicon "Esme Povirk")
Esme Povirk**
Committed by
[Alexandre Julliard](/julliard)
May 09, 2018

[Browse files](/wine/wine/-/tree/b6da3547d8990c3c3affc3a5865aefd2a0946949)

### gdi32: Check that emf records are within the file.

```

Signed-off-by: ![default avatar](https://seccdn.libravatar.org/avatar/76c09286549f7e3ed0718b61217d918dce54d976e9b329b5eb5b0c8dc5aab472?s=32&d=identicon)Vincent Povirk <vincent@codeweavers.com>
Signed-off-by: ![default avatar](https://seccdn.libravatar.org/avatar/33def6b9cbd73155bbefb1d52b6db6a9e4c88086f3907e9219d2963c41098322?s=32&d=identicon)Huw Davies <huw@codeweavers.com>
Signed-off-by: [![Alexandre Julliard's avatar](https://gitlab.winehq.org/uploads/-/system/user/avatar/4/avatar.png?width=32 "Alexandre Julliard")](https://gitlab.winehq.org/julliard "julliard@winehq.org")[Alexandre Julliard](https://gitlab.winehq.org/julliard "julliard@winehq.org") <julliard@winehq.org>
```

parent
[8d2676fd](/wine/wine/-/commit/8d2676fd14f130f9e8f06744743423168bf8d18d)

Loading

Loading

Loading

* [Changes
  1](/wine/wine/-/commit/b6da3547d8990c3c3affc3a5865aefd2a0946949)

[Hide whitespace changes](/wine/wine/-/commit/b6da3547d8990c3c3affc3a5865aefd2a0946949?action=show&controller=projects%2Fcommit&id=b6da3547d8990c3c3affc3a5865aefd2a0946949&namespace_id=wine&project_id=wine&w=1)
[Inline](/wine/wine/-/commit/b6da3547d8990c3c3affc3a5865aefd2a0946949?view=inline)
[Side-by-side](/wine/wine/-/commit/b6da3547d8990c3c3affc3a5865aefd2a0946949?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from bugs.winehq.org_6da2e10e_20250124_141511.html ===
(\*) Heap-buffer overflow in dlls/gdi32/enhmetafile.c:1950 (last commit: dd2624a24fba400bf59b9396e496d16c43d399d9):
If the mr parameter points to a user controlled EMF record in an EMF file, then
the structure pAlphaBlend at line 1931 is completely user controlled. This
leads to a heap-buffer overflow due to a memcpy call in line 1950, after a
successfull bits buffer has been allocated in the function CreateDIBSection()
at line 1949. The allocation size of bits (coming from
pbi->bmiHeader.biSizeImage) is also user controlled.
749 BOOL WINAPI PlayEnhMetaFileRecord(
750 HDC hdc, /\* [in] device context in which to render EMF record \*/
751 LPHANDLETABLE handletable, /\* [in] array of handles to be used in rendering record \*/
752 const ENHMETARECORD \*mr, /\* [in] EMF record to render \*/
753 UINT handles /\* [in] size of handle array \*/
754 )
755 {
756 int type;
...
764 type = mr->iType;
...
767 switch(type)
768 {
...
1929 case EMR\_ALPHABLEND:
1930 {
1931 const EMRALPHABLEND \*pAlphaBlend = (const EMRALPHABLEND \*)mr; // <== mr is user controlled
....
1938 if(pAlphaBlend->offBmiSrc == 0) {
1939 FIXME("EMR\_ALPHABLEND: offBmiSrc == 0\n");
1940 } else {
....
1943 const BITMAPINFO \*pbi = (const BITMAPINFO \*)((const BYTE \*)mr + pAlphaBlend->offBmiSrc);
1944 void \*bits;
....
1949 hBmp = CreateDIBSection(hdc, pbi, pAlphaBlend->iUsageSrc, &bits, NULL, 0); // <= allocate bits buffer in CreateDIBSection
1950 memcpy(bits, (const BYTE \*)mr + pAlphaBlend->offBitsSrc, pAlphaBlend->cbBitsSrc); // <= heap buffer overflow: mr, offBitsSrc and cbBitsSrc fields are user controlled.


=== Content from source.winehq.org_62ebfcd2_20250124_141514.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

**Commit
8d2676fd**

authored
May 08, 2018
by
**![Esme Povirk's avatar](https://seccdn.libravatar.org/avatar/76c09286549f7e3ed0718b61217d918dce54d976e9b329b5eb5b0c8dc5aab472?s=48&d=identicon "Esme Povirk")
Esme Povirk**
Committed by
[Alexandre Julliard](/julliard)
May 09, 2018

[Browse files](/wine/wine/-/tree/8d2676fd14f130f9e8f06744743423168bf8d18d)

### gdi32: Check for truncated EMF files.

```

Signed-off-by: ![default avatar](https://seccdn.libravatar.org/avatar/76c09286549f7e3ed0718b61217d918dce54d976e9b329b5eb5b0c8dc5aab472?s=32&d=identicon)Vincent Povirk <vincent@codeweavers.com>
Signed-off-by: ![default avatar](https://seccdn.libravatar.org/avatar/33def6b9cbd73155bbefb1d52b6db6a9e4c88086f3907e9219d2963c41098322?s=32&d=identicon)Huw Davies <huw@codeweavers.com>
Signed-off-by: [![Alexandre Julliard's avatar](https://gitlab.winehq.org/uploads/-/system/user/avatar/4/avatar.png?width=32 "Alexandre Julliard")](https://gitlab.winehq.org/julliard "julliard@winehq.org")[Alexandre Julliard](https://gitlab.winehq.org/julliard "julliard@winehq.org") <julliard@winehq.org>
```

parent
[f4bcd95f](/wine/wine/-/commit/f4bcd95fa78172a3a07c5f065adf4287fe69af02)

Loading

Loading

Loading

* [Changes
  3](/wine/wine/-/commit/8d2676fd14f130f9e8f06744743423168bf8d18d)

[Hide whitespace changes](/wine/wine/-/commit/8d2676fd14f130f9e8f06744743423168bf8d18d?action=show&controller=projects%2Fcommit&id=8d2676fd14f130f9e8f06744743423168bf8d18d&namespace_id=wine&project_id=wine&w=1)
[Inline](/wine/wine/-/commit/8d2676fd14f130f9e8f06744743423168bf8d18d?view=inline)
[Side-by-side](/wine/wine/-/commit/8d2676fd14f130f9e8f06744743423168bf8d18d?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


