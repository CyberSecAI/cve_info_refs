=== Content from www.tripwire.com_c11ed498_20250124_142236.html ===


[Skip to main content](#main-content)

[![Fortra](https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg?l=2131009607)
![Data Classification](https://static.fortra.com/fortra-global-assets/fortra-logo-small.svg?l=1446283913)

![Tripwire Logo](/themes/custom/tripwire/images/tripwire-dark-bg.svg)](/ "Home")

English

[English](/state-of-security/googles-newest-feature-find-my-home)

English

[English](/state-of-security/googles-newest-feature-find-my-home)

Secondary Navigation

* [Customer Portal](https://customers.tripwire.com/customers)
* [Partner Portal](https://partners.tripwire.com/partners/)
* [GET A DEMO](/demo)

* Products
  Toggle Dropdown
  + [Tripwire Enterprise](/products/tripwire-enterprise)
  + [Tripwire ExpertOps](/products/tripwire-expertops)
  + [Tripwire IP360](/products/tripwire-ip360)
  + [Tripwire LogCenter](/products/tripwire-logcenter)
  + [View all products](/products)
* Solutions
  Toggle Dropdown
  + [Security Configuration Management](/solutions/security-configuration-management)
  + [File Integrity and Change Monitoring](/solutions/file-integrity-and-change-monitoring)
  + [Vulnerability Management](/solutions/vulnerability-and-risk-management)
  + [Cloud](/solutions/cloud-cybersecurity)
  + [Compliance](/solutions/compliance)
  + [Industries](/industries)
  + [View all solutions](/solutions)
* [Services](/services)
* Resources
  Toggle Dropdown
  + [Upcoming Events](/resources?f%5B0%5D=type%3A1333&f%5B1%5D=type%3A1340&f%5B2%5D=type%3A1341)
  + [On-Demand Webinars](/resources?f%5B1%5D=type%3A1339&f%5B2%5D=type%3A1342)
  + [Datasheets](/resources?f%5B0%5D=type%3A1335)
  + [Case Studies](/resources?f%5B0%5D=type%3A1334)
  + [Guides](/resources?f%5B0%5D=type%3A1337)
  + [Training](/services/training)
  + [View all resources](/resources)
* [Blog](/state-of-security)
* About
  Toggle Dropdown
  + [About](/about)
  + [Careers](https://www.fortra.com/about/careers)
  + [Leadership](https://www.fortra.com/about/our-leadership-team)
  + [Newsroom](https://www.fortra.com/about/newsroom)
  + [Partners](/about/partner)
  + [Contact Us](/contact-us)

Keywords

Sort
Best matchNewest firstOldest firstTitle A-ZTitle Z-A

1. [Home](/)
2. [Blog](/state-of-security)
3. Google’s Newest Feature: Find My Home

# Google’s Newest Feature: Find My Home

*Posted on June 18, 2018*

Image
 ![Google’s Newest Feature: Find My Home](/sites/default/files/shutterstock_74559973.jpg)

The commoditization of personal data in recent years has created huge opportunities for anyone with the skills to collect, catalogue and correlate every aspect of our lives. For many years now, there has been a war between browser vendors and unscrupulous advertisers looking for tricks to uniquely identify users and track their movements across websites. Mozilla, for example, has implemented [a long list of protections against browser fingerprinting within Firefox](https://support.mozilla.org/en-US/kb/firefox-protection-against-fingerprinting) and [EFF’s Privacy Badger](https://www.eff.org/privacybadger) anti-tracking browser plugin has more than one million installs across Firefox and Chrome. Despite all of these efforts to thwart unwanted online tracking, it turns out that our connected gadgets may not only uniquely identify us but, in some cases, they can reveal precise physical locations. In this blog post, I will reveal a new attack against Google Home and Chromecast devices that does exactly that. These problems stem from two fundamental design choices that are prevalent among IoT devices:

1. Devices rarely require authentication for connections received on a local network
2. HTTP is frequently used to configure or control embedded devices

The confluence of these properties means that web browsers and, therefore, websites can sometimes interact with network devices. This is something I’ve talked about before with regard to using [cross-site request forgery (CSRF)](/state-of-security/smart-cross-site-request-forgery-csrf "Smart Cross-Site Request Forgery (CSRF)") or [DNS rebinding](/state-of-security/practical-attacks-dns-rebinding) to achieve code execution.

## Analyzing Google Cast Devices

This research started with the simple goal of creating a lab exercise for my [Black Hat training](https://www.blackhat.com/us-18/training/a-guided-tour-of-embedded-software-hacks.html) demonstrating how a website can identify and commandeer screens or speakers on a local network to play Rick Astley’s “Never Gonna Give You Up.” (A ‘Drive-by Rick Roll’ if you will.) Using the IoT analysis techniques I’ve been teaching, I quickly realized a far more interesting attack surface. It turns out that although the *Home* app – which allows users to configure Google Home and Chromecast – performs most actions using Google’s cloud, some tasks are carried out using a local HTTP server. Commands to do things like setting the device name and WiFi connection are sent directly to the device without any form of authentication. Although Google’s app, which uses this functionality, implies that you must be logged into a Google account linked with the target device, there is, in fact, no authentication mechanism built into the protocol level. On my home network, with the aid of my [DNS rebinding server](/state-of-security/practical-attacks-dns-rebinding), I was not only able to hijack the screen attached to my Chromecast but I was actually able to use data extracted from the devices to determine their physical location with astonishing accuracy. If you’ve ever explored the HTML5 location API, you’ll probably agree that it’s nothing short of amazing. If you haven’t seen this before, open Google Maps in Chrome’s incognito mode, click the “My Location” icon, and enable location tracking if asked. (Using incognito mode is just to make sure Google can’t use location history data pulled from a phone.) Even without a GPS receiver, Maps has typically been able to locate my machine within 10 meters. This apparent magic trick is made possible by analyzing signal strengths for surrounding WiFi networks and then triangulating a position using WiFi access point maps collected by the millions of phones opted into Google’s enhanced location services.

## Exploitation and Impact

Using the [DNS rebinding software](/state-of-security/practical-attacks-dns-rebinding) from my IoT training, I was able to create a basic end-to-end attack that worked for me in Linux, Windows and macOS using Chrome or Firefox. Starting from a generic URL, my attack first identifies the local subnet and then scans it looking for the Google devices and registers a subdomain ID to initiate DNS rebinding on the victim. About a minute after the page had loaded, I was looking at my house on Google Maps.

Image
 ![demo.gif](/sites/default/files/demo.gif)

The implications of this are quite broad, including the possibility of more effective blackmail or extortion campaigns. Common scams like [fake FBI or IRS](https://www.fbi.gov/news/stories/new-internet-scam) warnings or threats to [release compromising photos or expose some secret to friends and family](https://www.smh.com.au/technology/latest-online-scam-aims-to-prick-porn-watchers-guilty-conscience-20170815-gxwvxl.html) could use this to lend credibility to the warnings and increase their odds of success. DNS rebinding is not the only way to exploit this, however. Browser extensions and mobile apps can use their unrestricted network access to directly query the devices without relying on or waiting for a DNS cache refresh. This gives advertisers a direct path to obtain location data without alerting the end-user. The location data can then be correlated with other tracked web activity and possibly tied to a specific real-world identity. These problems are not specific to Google devices. Over the years that I’ve been auditing embedded devices, it is not the first time that I’ve seen a device supplying WiFi survey data or other unique device details like serial numbers. Smart TV’s, for example, commonly identify themselves with a unique screen ID as part of the DIAL protocol used to support Cast-like functionality.

## Mitigating Exposure

The only way to completely mitigate the risk of being tracked by your devices is to disconnect them. Assuming, however, that you want to keep on binge-watching the latest Netflix series and asking your smart speaker to dim the lights, there are some less drastic steps you can take to minimize exposure. **Option #1: Professional Grade Network Segmentation** In my home, I have at least three distinct networks at any given time. One network serves as the main home network used for transferring files and general web browsing, another is used for connected devices, and the last one is a “wild-west” network where I sometimes configure devices for security audits. This means that if I am surfing the web on my main network, a rogue website or app would not be able to find or connect to my devices. When using Chromecast, I need to then either switch networks temporarily or else use the sometimes glitchy “Guest Mode.” **Option #2: The Easy Method of Network Segmentation** VLANs and firewall rules work for me because I’ve spent the past decade working on network security products, but it is not so suitable for most users. There are some consumer routers where this can be done with relative ease, but this is not always easy to configure or verify that it is working as intended. A much easier solution is to add another router on the network specifically for connected devices. By connecting the WAN port of the new router to an open LAN port on the existing router, attacker code running on the main network will not have a path to abuse those connected devices. Although this does not by default prevent attacks from the IoT devices to the main network, it is likely that most naïve attacks would fail to even recognize that there is another network to attack.

Image
 ![SimpleSegmentation.png](/sites/default/files/SimpleSegmentation.png)

**Option #3: DNS Rebind Protection** The DNS rebinding attacks rely on vulnerable default configurations of commonly used name servers. Although DNS servers can be configured to stop the rebinding attack, most public DNS resolvers do not enable such protections as they could possibly interfere with legitimate activities. It turns out, however, that the DNS software commonly used in consumer routers actually has DNS rebind protection as a feature even if most routers do not enable it by default or even have an option to enable it manually. OpenWRT and DD-WRT users can and should enable this protection. Advanced users may also consider deploying their own local DNS server (such as on a Raspberry Pi) with rebinding protections enabled.

## Conclusions

For many years now, device makers have focused to a large degree on a low-friction user experience that ultimately lends itself to abuse. In the face of DNS rebinding and mobile apps, though, all services running on the local network (and especially HTTP services) must be designed as if they were directly exposed to the Internet. We must assume that any data accessible on the local network without credentials is also accessible to hostile adversaries. This means that all requests must be authenticated and all unauthenticated responses should be as generic as possible. Until we reach that point, consumers should separate their devices as best as is possible and be mindful of what websites or apps are loaded while on the same network as their connected gadgets. This post was published in coordination with Brian Krebs, who wrote an article in which I discuss the data leak weakness and provide IoT security recommendations. You can view Krebs' article [here](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/).

### Meet Fortra™ Your Cybersecurity Ally™

Fortra is creating a simpler, stronger, and more straightforward future for cybersecurity by offering a portfolio of integrated and scalable solutions. Learn more about how Fortra’s portfolio of solutions can benefit your business.

[Learn More](https://www.fortra.com)

 [![Craig Young](/sites/default/files/styles/thumbnail/public/craig-young.jpg?itok=l_Pti4Ga)](/profile/craig-young)

#### [Craig Young](/profile/craig-young)

[View Profile](/profile/craig-young)

[Image
 ![Join over 20,000 IT security pros who get our top stories delivered to their inbox every week!](/sites/default/files/2024-04/state-of-security-sidebar-cta-2.png)](https://info.tripwire.com/state-of-security-subscription-center)

[![Fortra logo](/themes/custom/fortra_parent_2022/images/logo.svg)](https://www.fortra.com "Home")

* +1 800-328-1000
* [Email Us](/cdn-cgi/l/email-protection#f0999e969fb0969f82848291de939f9d)
* [Request Support](/support)

* [X Find us on
  X](https://twitter.com/tripwireinc)
* [LinkedIn Find us on
  LinkedIn](https://www.linkedin.com/company/tripwire/%20class%3D)
* [Youtube Find us on
  Youtube](https://www.youtube.com/user/tripwireinc)
* [Reddit Find us on Reddit](https://www.reddit.com/r/Fortra/)

Footer menu
### [Products & Services](/products)

* [Tripwire Enterprise](https://www.tripwire.com/products/tripwire-enterprise)
* [Tripwire IP360](/products/tripwire-ip360)
* [Tripwire LogCenter](/products/tripwire-logcenter)
* [Tripwire ExpertOps](/products/tripwire-expertops)
* [Services](/services)
* [View All Products](/products)
* [Fortra Products](/products/fortra)

### [Solutions](/solutions)

* [By Security Need](/solutions)
* [By Compliance Need](/solutions/compliance)
* [By Industry](/industries)

### [Resources](/resources)

* [Upcoming Events](/resources?f%5B0%5D=type%3A1333&f%5B1%5D=type%3A1340&f%5B2%5D=type%3A1341)
* [On-Demand Webinars](/resources?f%5B0%5D=type%3A1342)
* [Datasheets](/resources?f%5B0%5D=type%3A1335)
* [Training](/services/training)
* [Request a Quote](https://www.tripwire.com/pricing)
* [Start a Demo](https://www.tripwire.com/demo)

### [About](/about)

* [Fortra](https://www.fortra.com/)
* [Patents](/about/patents)
* [Customer Support](https://customers.tripwire.com/customers)
* [Report a Vulnerability](https://www.fortra.com/security/report)
* [[email protected]](/cdn-cgi/l/email-protection#7a13141c153a1c15080e081b5419151745090f18101f190e470e08130a0d13081f570d1f1809130e1f)

### [Contact Information](/contact-us)

### [Privacy Policy](https://www.fortra.com/privacy-policy)

### [Cookie Policy](https://www.fortra.com/cookie-policy)

###

### [Impressum](https://www.fortra.com/impressum)

Copyright © Fortra, LLC and its group of companies. Fortra®, the Fortra® logos, and other identified marks are proprietary trademarks of Fortra, LLC.



=== Content from www.wired.com_b8337cc4_20250124_142237.html ===
[Skip to main content](#main-content)Open Navigation MenuMenu[![WIRED](/verso/static/wired-us/assets/logo-header.svg)](/)Millions of Streaming Devices Are Vulnerable to a Retro Web Attack

* [Security](/category/security/)
* [Politics](https://www.wired.com/category/politics/)
* [Gear](/category/gear/)
* [The Big Story](/category/big-story/)
* [Business](/category/business/)
* [Science](/category/science/)
* [Culture](/category/culture/)
* [Ideas](/category/ideas/)
* [Merch](https://shop.wired.com/)
More*Chevron*[SearchSearch](/search/)

* [Security](/category/security/)
* [Politics](https://www.wired.com/category/politics/)
* [Gear](/category/gear/)
* [The Big Story](/category/big-story/)
* [Business](/category/business/)
* [Science](/category/science/)
* [Culture](/category/culture/)
* [Ideas](/category/ideas/)
* [Merch](https://shop.wired.com/)

* [Podcasts](/podcasts/)
* [Video](/video/)
* [Newsletters](https://www.wired.com/newsletter?sourceCode=navbar)
* [Magazine](https://www.wired.com/magazine)
* [Travel](http://wired.com/travel)
* [Steven Levy's Plaintext Column](https://www.wired.com/tag/plaintext/)
* [WIRED Classics from the Archive](https://www.wired.com/tag/wired-classic/)
* [Events](https://www.wired.com/tag/wired-events/)
* [WIRED Insider](/category/wiredinsider/)
* [WIRED Consulting](/tag/wired-consulting/%20)
* [Coupons](https://www.wired.com/coupons)
[Lily Hay Newman](/author/lily-hay-newman/)[Security](/category/security)Jun 19, 2018 4:51 PM
# Millions of Streaming Devices Are Vulnerable to a Retro Web Attack

Using a technique called DNS rebinding, one amateur hacker found vulnerabilities in devices from Google, Roku, Sonos, and more.![Image may contain Utility Pole and Plot](https://media.wired.com/photos/5b295efcc9906c0948a27130/master/w_2560%2Cc_limit/dns_rebinding-FINAL.jpg)HOTLITTLEPOTATOSave this storySaveSave this storySave

In March, artist and programmer Brannon Dorsey became interested in a retro web attack called DNS rebinding, teaching himself how to illicitly access controls and data by exploiting known browser weaknesses. It's a vulnerability that researchers have poked at on and off for years—which is one reason Dorsey couldn't believe what he found.

Sitting in his Chicago apartment, two blocks from Lake Michigan, Dorsey did what anyone with a newfound hacking skill would: He tried to attack devices he owned. Instead of being blocked at every turn, though, Dorsey quickly discovered that the media streaming and smart home gadgets he used every day were vulnerable to varying degrees to DNS rebinding attacks. He could gather all sorts of data from them that he never would have expected.

"I'm technical, but I'm not an information security professional," Dorsey says. "I didn’t reverse any binaries or do any intense digging. I just followed my curiosities and suddenly I found some sketchy shit. I was just sitting there thinking 'I cannot be the only person in the world who is seeing this.'"

Between his own gadgets and borrowing others from friends, Dorsey found DNS rebinding vulnerabilities in virtually every model of Google Home, Chromecast, Sonos Wi-Fi speakers, Roku streaming devices, and some smart thermostats. Dorsey's experimental attacks, which he outlined in [research published Tuesday](https://medium.com/%40brannondorsey/ea7098a2d325), didn't give him full keys to the kingdom, but in each case he could gain more control and extract more data than he should have been able to.

> 'I just followed my curiosities and suddenly I found some sketchy shit.'

Brannon Dorsey

For example, on Roku devices running Roku OS 8.0 or lower, Dorsey found that an attacker could use the streamer's External Control API to control buttons and key presses on the device, access the inputs for device sensors like the accelerometer, gyroscope, and magnetometer, search content on the device, and even launch apps. On Sonos Wi-Fi speakers, an attacker could access extensive information about the Wi-Fi network a speaker is connected to, useful for mapping out network attributes and broader recon. And by attacking the public API in Google's connected devices, an hacker could trigger Google Home and Chromecast restarts at will. That result in essentially a denial of service attack, keeping users from being able to interact with their device, or sending it offline at strategic times. Attackers could also get Google Home and Chromecast to cough up information about the Wi-Fi network they are connected to, and triangulate it with the list of nearby Wi-Fi networks to accurately geolocate the devices.

In a DNS rebinding attack, a hacker capitalizes on weaknesses in how browsers implement web protocols. They craft malicious websites that can game the trust protections meant to block unauthorized communication between web services. From there, an attacker uses methods like phishing or malvertising to trick victims into clicking a link to their site, and then moves to illicitly access whatever controls and data are exposed on their device or network. One wrong click or tap and and attacker could take over your smart device.

Though DNS rebinding stems from some fundamental issues with how browsers mediate trust relationships online, sites and services can also limit their exposures using relatively simple mechanisms like authentication protections or HTTPS encrypted connections. This may be why this class of attacks hasn't generated sustained interest or concern among security professionals.

But over past seven months, there has been a growing understanding in the security community that DNS rebinding bugs may represent a much larger group of vulnerabilities than people have previously acknowledged. Google Project Zero researcher Tavis Ormandy recently found DNS rebinding vulnerabilities in the [Transmission BitTorrent client](https://bugs.chromium.org/p/project-zero/issues/detail?id=1447) and the update mechanism for [Blizzard video games](https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&desc=2), and researchers have also discovered the bugs in various Ethereum wallets—potentially exposing people's cryptocurrency.

DNS rebinding bugs have a "history of being dismissed by developers, and many times it is left as an unaddressed issue," Ariel Zelivansky, a researcher at the security firm Twistlock, [wrote in a prescient February warning](https://www.twistlock.com/2018/02/28/dear-developers-beware-dns-rebinding/) about the rise of DNS rebinding vulnerabilities.

In the months that Dorsey was looking into the topic, another researcher from the security firm Tripwire, Craig Young, also discovered the bug in Google Home and Chromecast, and [published](https://www.tripwire.com/state-of-security/vert/googles-newest-feature-find-my-home/#.WyfDEMLoy-g.twitter) his [findings](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/) on Monday.

> 'This reflects an issue in a fundamental feature of the internet as it’s been designed.'

Joseph Pantoga, Red Balloon

One root cause of these vulnerabilities is that devices on the same Wi-Fi network generally trust each other, since they've all been admitted to the same club. But this assumption can lead to accidental exposures. Communication channels meant for use by other devices on a network can potentially also be maliciously accessed by remote websites with just a small amount of manipulation. Many of the bugs Dorsey found could be solved by adding basic authentication mechanisms to device APIs.

"This reflects an issue in a fundamental feature of the internet as it’s been designed," says Joseph Pantoga, a research scientist at the internet of things security firm Red Balloon. "DNS rebinding attacks have been brought up many times in the past, but new features in Internet of Things devices including geolocation and collection of personal data make it something people should really be aware of. The problem is exacerbated by IoT devices having APIs intended for communication with other, unauthenticated devices on the network."

Google, Roku, and Sonos have all patched or are in the process of patching their device operating systems to plug the vulnerabilities Dorsey described. “After recently becoming aware of the DNS Rebinding issue, we created a software patch which is now rolling out to customers," a Roku spokesperson told WIRED. Sonos similarly added that, "Upon learning about the DNS Rebinding Attack, we immediately began work on a fix that will roll out in a July software update.” Google said in a statement that, "We're aware of the report and will be rolling out a fix in the coming weeks."

Despite the positive response, experts note that lack of awareness about avoiding these bugs in the first place has led to a situation in which millions and millions of devices are known to be vulnerable to some degree, with millions more likely vulnerable as well. Dorsey says that he hopes his research raises awareness about the ubiquity of the problem. "DNS rebinding has become the elephant in the room," he says. "A ton of things are vulnerable to it and it's become a systemic problem. So ultimately approaching vendors one at a time isn't going to solve it. The whole industry needs to know to check for this and fix it."

---

More Great WIRED Stories

* The hustlers fueling cryptocurrency’s [marketing machine](https://www.wired.com/story/the-hustlers-fueling-cryptocurrencys-marketing-machine/?mbid=BottomRelatedStories_Sections_2)
* This elite Microsoft hacker team [keeps Windows PCs safe](https://www.wired.com/story/microsoft-windows-red-team/?mbid=BottomRelatedStories_Sections_2)
* The brilliant vigilance of Seattle's [gargantuan new tunnel](https://www.wired.com/story/seattle-sr-99-tunnel-tech-bertha/?mbid=BottomRelatedStories_Sections_2)
* A new [era of Frankensoftware](https://www.wired.com/story/frankensoftware/?mbid=BottomRelatedStories_Sections_2) is upon us
* PHOTO ESSAY: Inside the Arctic Circle, golden hour has nothing on [golden day](https://www.wired.com/story/golden-hour-arctic-photography/?mbid=BottomRelatedStories_Sections_2)
* Get even more of our inside scoops with our weekly [Backchannel newsletter](https://www.wired.com/newsletter/?name=backchannel&sourcecode=BottomStories)
[![](https://media.wired.com/photos/65e835799fa4c1a0001881a9/1:1/w_270%2Cc_limit/undefined)](/author/lily-hay-newman/)[Lily Hay Newman](/author/lily-hay-newman/) is a senior writer at WIRED focused on information security, digital privacy, and hacking. She previously worked as a technology reporter at Slate, and was the staff writer for Future Tense, a publication and partnership between Slate, the New America Foundation, and Arizona State University. Her work... [Read more](/author/lily-hay-newman/)Senior Writer

* [X](https://www.twitter.com/lilyhnewman)
Topics[hacks](/tag/hacks/)[DNS](/tag/dns/)[IoT](/tag/iot/)[Google](/tag/google/)[Sonos](/tag/sonos/)[roku](/tag/roku/)Read More[![10 More of the Coolest Things We’ve Seen at CES 2025](https://media.wired.com/photos/677c4c835c3b6bd576bf387a/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/ces-2025-photo-gallery-day-2/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[10 More of the Coolest Things We’ve Seen at CES 2025](https://www.wired.com/gallery/ces-2025-photo-gallery-day-2/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)More of the wild ideas and clever innovations we’re seeing this week at tech’s big show in Las Vegas.Gear Team[![Our Favorite Outdoor Security Cams for Your Home or Business](https://media.wired.com/photos/6776a6eef10e0f4158cf2ddb/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-outdoor-security-cameras/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[Our Favorite Outdoor Security Cams for Your Home or Business](https://www.wired.com/gallery/best-outdoor-security-cameras/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)These weatherproof outdoor security cams keep a watchful eye on your property while you get on with life. Our list includes battery-powered and LTE devices and options that need no subscription.Simon Hill[![The Best USB Flash Drives for Ultra-Portable Storage](https://media.wired.com/photos/676c618ff68c6835a33c7b54/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-usb-flash-drives/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best USB Flash Drives for Ultra-Portable Storage](https://www.wired.com/gallery/best-usb-flash-drives/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)These WIRED-tested memory sticks are a virtual filing cabinet in your pocket.Simon Hill[![The Best Beard Trimmers for Showing Your Face](https://media.wired.com/photos/6769976b07a86d8a19875d23/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-beard-trimmers/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Beard Trimmers for Showing Your Face](https://www.wired.com/gallery/best-beard-trimmers/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)These beard tools deliver a quality trim for all types of facial hair.Andrew Williams[![The Best Leggings for Gym Rats, Runners, and Professional Couch Potatoes](https://media.wired.com/photos/678836c68defb9fd8e1e504a/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/the-best-leggings/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Leggings for Gym Rats, Runners, and Professional Couch Potatoes](https://www.wired.com/gallery/the-best-leggings/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Whether you’re doing reps or pushing Play on the next episode, these leggings are built for every kind of marathon.Boutayna Chokrane [![The 10 Coolest Things We’ve Seen So Far at CES 2025](https://media.wired.com/photos/677b7cc6c38d37222054b0c9/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/ces-2025-photo-gallery-day-1/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The 10 Coolest Things We’ve Seen So Far at CES 2025](https://www.wired.com/gallery/ces-2025-photo-gallery-day-1/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Tech's big show isn’t fully underway yet, but the odd and wonderful gadgets are already here. These are the coolest things we saw at the event preview.Gear Team[![The Best 7 Space Heaters of 2025](https://media.wired.com/photos/677ab07444bfffc9819f9710/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/the-best-space-heaters/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best 7 Space Heaters of 2025](https://www.wired.com/gallery/the-best-space-heaters/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)These portable heaters will heat a room quickly, quietly, and safely.Matthew Korfhage[![The Best Wi-Fi Routers](https://media.wired.com/photos/6777fbb85eb94f14d31f7aee/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-wifi-routers/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Wi-Fi Routers](https://www.wired.com/gallery/best-wifi-routers/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Don’t suffer the buffer. These WIRED-tested systems will deliver reliable internet across your home whatever your needs or budget.Simon Hill[![The Best Mobile Controllers for Gaming on the Go](https://media.wired.com/photos/67802fe403f6b57dd22028a9/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-mobile-game-controllers-for-iphone-android/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Mobile Controllers for Gaming on the Go](https://www.wired.com/gallery/best-mobile-game-controllers-for-iphone-android/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Touchscreens don’t always get the job done. Try one of these WIRED-tested controllers for your iPhone or Android instead.Simon Hill[![The Best Electric Kick Scooters](https://media.wired.com/photos/677075ade58d29773908c64f/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-electric-scooters/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Electric Kick Scooters](https://www.wired.com/gallery/best-electric-scooters/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)These WIRED-tested two-wheelers will help you scoot scoot scoot around town.Julian Chokkattu[![The Best Fitness Trackers and Watches for Everyone](https://media.wired.com/photos/677310171d69990575f20094/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-fitness-tracker/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The Best Fitness Trackers and Watches for Everyone](https://www.wired.com/gallery/best-fitness-tracker/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Whether you’re skiing in the backcountry or trampolining in the backyard, we have an activity tracker for you.Adrienne So[![The 21 Best Portable Chargers for All of Your Devices](https://media.wired.com/photos/6777f67fe07d9012d0e4940c/16:9/w_800%2Ch_450%2Cc_limit/undefined)](https://www.wired.com/gallery/best-portable-chargers-power-banks/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)[The 21 Best Portable Chargers for All of Your Devices](https://www.wired.com/gallery/best-portable-chargers-power-banks/#intcid=_wired-article-bottom-recirc_8c2ba446-5a7d-4f94-868d-6466c65dd7de_roberta-similarity1_fallback_popular4-1)Keep your phone, tablet, laptop, and other electronics running with these handheld power banks.Simon Hill[![WIRED](/verso/static/wired-us/assets/logo-reverse.svg)](/)WIRED is where tomorrow is realized. It is the essential source of information and ideas that make sense of a world in constant transformation. The WIRED conversation illuminates how technology is changing every aspect of our lives—from culture to business, science to design. The breakthroughs and innovations that we uncover lead to new ways of thinking, new connections, and new industries.

More From WIRED

* [Subscribe](https://www.wired.com/subscribe/)
* [Newsletters](https://www.wired.com/newsletter?sourceCode=HeaderAndFooter)
* [FAQ](https://www.wired.com/about/faq/)
* [WIRED Staff](https://www.wired.com/about/wired-staff/)
* [WIRED Education](https://www.wirededucation.com/)
* [Editorial Standards](https://www.wired.com/about/wired-on-background-policy/)
* [Archive](https://archive.wired.com/t/storefront/storefront)
* [RSS](https://www.wired.com/about/rss-feeds/)
* [Accessibility Help](https://www.wired.com/about/accessibility-help/)

Reviews and Guides

* [Reviews](https://www.wired.com/category/gear/reviews/)
* [Buying Guides](https://www.wired.com/category/gear/buying-guides/)
* [Mattresses](https://www.wired.com/gallery/best-mattresses/)
* [Electric Bikes](https://www.wired.com/gallery/best-electric-bikes/)
* [Soundbars](https://www.wired.com/gallery/best-soundbars/)
* [Streaming Guides](https://www.wired.com/tag/culture-guides/)
* [Wearables](https://www.wired.com/tag/wearables/)
* [TVs](https://www.wired.com/gallery/best-tvs/)
* [Coupons](https://www.wired.com/tag/coupons/)
* [Code Guarantee](https://www.wired.com/coupons/info/code-guarantee.html)
* [Gift Guides](/tag/gift-guides/)

* [Advertise](https://www.condenast.com/brands/wired)
* [Contact Us](https://www.wired.com/about/feedback/)
* [Manage Account](https://www.wired.com/account/profile)
* [Jobs](https://www.wired.com/about/wired-jobs/)
* [Press Center](https://www.wired.com/about/press/)
* [Condé Nast Store](https://www.condenaststore.com/)
* [User Agreement](https://www.condenast.com/user-agreement/)
* [Privacy Policy](http://www.condenast.com/privacy-policy#privacypolicy)
* [Your California Privacy Rights](http://www.condenast.com/privacy-policy#privacypolicy-california)

© 2025 Condé Nast. All rights reserved. *WIRED* may earn a portion of sales from products that are purchased through our site as part of our Affiliate Partnerships with retailers. The material on this site may not be reproduced, distributed, transmitted, cached or otherwise used, except with the prior written permission of Condé Nast. [Ad Choices](http://www.aboutads.info)

###### Select international site

United StatesLargeChevron

* [Italia](https://www.wired.it/)
* [Japón](https://wired.jp/)
* [Czech Republic & Slovakia](https://www.wired.cz/)

* [Facebook](https://www.facebook.com/wired/)
* [X](https://twitter.com/wired/)
* [Pinterest](https://pinterest.com/wired/)
* [YouTube](https://www.youtube.com/user/wired/)
* [Instagram](https://instagram.com/wired/)
* [Tiktok](https://www.tiktok.com/%40wired?lang=en)


=== Content from medium.com_2e16682b_20250124_142235.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fea7098a2d325&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Attacking Private Networks from the Internet with DNS Rebinding

[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:88:88/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---byline--ea7098a2d325--------------------------------)

[Brannon Dorsey](/%40brannondorsey?source=post_page---byline--ea7098a2d325--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9242793add7d&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40brannondorsey%2Fattacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325&user=Brannon+Dorsey&userId=9242793add7d&source=post_page-9242793add7d--byline--ea7098a2d325---------------------post_header-----------)

20 min read·Jun 19, 2018

--

17

Listen

Share

> TL;DR Following the wrong link could allow remote attackers to control your WiFi router, Google Home, Roku, Sonos speakers, home thermostats and more.

The home WiFi network is a sacred place; your own local neighborhood of cyberspace. There we connect our phones, laptops, and “smart” devices to each other and to the Internet and in turn we *improve our lives*, or so we are told. By the late twenty teens, our local networks have become populated by a growing number of devices. From smart TVs and media players to home assistants, security cameras, refrigerators, door locks and thermostats, our home networks are a haven for trusted personal and domestic devices.

Many of these devices offer limited or non-existent authentication to access and control their services. They inherently trust other machines on the network in the same way that you would inherently trust someone you’ve allowed into your home. They use protocols like Universal Plug and Play (UPnP) and HTTP to communicate freely between one another but are inherently protected from inbound connections from the Internet by means of their router’s firewall. They operate in a sort of walled garden, safe from external threat. Or so their developers probably thought.

A few months ago, I began to follow a winding path of research into a 10 year-old network attack called [**DNS rebinding**](https://en.wikipedia.org/wiki/DNS_rebinding). Put simply, DNS rebinding allows a remote attacker to bypass a victim’s network firewall and use their web browser as a proxy to communicate directly with devices on their private home network. By following the wrong link, or being served a malicious banner advertisement, you could inadvertently provide an attacker with access to the thermostat that controls the temperature in your home.

```
NOTE: This research has been simultaneously released with a counterpart [WIRED article](https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/) on the subject by Lily Hay Newman.
```
# What is DNS Rebinding?

To better understand how DNS rebinding works it’s helpful to first understand the security mechanism that it evades; the web browser’s [*same-origin policy*](https://en.wikipedia.org/wiki/Same-origin_policy). Many moons ago, browser vendors decided it probably wouldn’t be a good idea for web pages served from one domain to be able to make arbitrary requests to another domain without explicit permission from that second domain. If you follow a malicious link on the web, the web page you arrive at shouldn’t be able to make an HTTP request to your bank website and leverage your logged in-session there to empty your account. Browsers restrict this behavior by limiting HTTP requests originating from a domain to access only other resources that are also located on that domain (or another domain that explicitly enables [*cross-origin resource sharing*](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)).

> DNS can be abused to trick web browsers into communicating with servers they don’t intend to.

The code at `http://malicious.website` can’t make a standard XMLHttpRequest to `http://bank.com/transfer-fund` because `malicious.website` and `bank.com` are different domains and therefor the browser treats them as **separate origins**. Browsers enforce this by requiring that the protocol, domain name, and port number of a URL being requested is identical to the URL of the page requesting it. Sounds good, right?

Not so fast. Behind every domain name lies an IP address. `malicious.website` may reside at `34.192.228.43` and `bank.com` may call `171.159.228.150` home. The *Domain Name System* (DNS) provides a useful mechanism of translating easy-to-remember domain names into the IP addresses that our computer’s actually use to talk to each other. The catch is that modern browsers use URLs to evaluate same-origin policy restrictions, not IP addresses. What would happen if the IP address of `malicious.website` were to quickly changed from `34.192.228.43` to the IP address of `171.159.228.150`? According to the browser, nothing would have changed. But now, instead of communicating with the server that originally hosted the website files at `malicious.website`, your browser would actually be talking to `bank.com`. See the problem? DNS can be abused to trick web browsers into communicating with servers they don’t intend to.

DNS rebinding has received a few brief moments of attention over the past year when vulnerabilities were found in a few popular pieces of software. Most notably, [Blizzard’s video games](https://www.bleepingcomputer.com/news/security/blizzard-fixes-dns-rebinding-flaw-that-put-all-the-companys-users-at-risk/), the [Transmission torrent client](https://www.exploit-db.com/exploits/43665/), and several [Ethereum cryptocurrency wallets](https://ret2got.wordpress.com/2018/01/19/how-your-ethereum-can-be-stolen-using-dns-rebinding/) were vulnerable to DNS rebinding attacks until recently. In just the wrong circumstance, the Ethereum Geth vulnerability could have given a remote attacker full-control of the victim’s Ethereum account, and with it, all of their coin.

> DNS rebinding allows a remote attacker to bypass a victim’s network firewall and use their web browser as a proxy to communicate directly with devices on their private home network.

# How DNS Rebinding works

1. An attacker controls a malicious DNS server that answers queries for a domain, say `rebind.network`.
2. The attacker tricks a user into loading `http://rebind.network` in their browser. There are many ways they could do this, from phishing to persistent XSS or by [buying an HTML banner ad](/%40brannondorsey/browser-as-botnet-or-the-coming-war-on-your-web-browser-be920c4f718).
3. Once the victim follows the link, their web browser makes a DNS request looking for the IP address of `rebind.network`. When it receives the victim’s DNS request, the attacker controlled DNS server responds with `rebind.network`’s real IP address, `34.192.228.43`. It also sets the [TTL value](https://en.wikipedia.org/wiki/Time_to_live) on the response the be 1 second so that the victim’s machine won’t cache it for long.
4. The victim loads the web page from `http://rebind.network` which contains malicious JavaScript code that begins executing on the victim’s web browser. The page begins repeatedly making some strange looking POST requests to `http://rebind.network/thermostat`with a JSON payload like `{“tmode”: 1, “a_heat”: 95}`.
5. At first, these requests are sent to the attacker’s web server running on `34.192.228.43`, but after a while ([browser DNS caching is weird](https://youtu.be/Q0JG_eKLcws?t=27m50s)) the browser’s resolver observes that the DNS entry for `rebind.network` is stale and so it makes another DNS lookup.
6. The attacker’s malicious DNS server receives the victim’s second DNS request, but this time it responds with the IP address `192.168.1.77`, which happens to be an IP address of a [smart thermostat](https://github.com/brannondorsey/radio-thermostat) on the victim’s local network.
7. The victim’s machine receives this malicious DNS response and begins to point to HTTP requests intended for `http://rebind.network` to `192.168.1.77`. As far as the browser is concerned nothing has changed and so it sends another POST to `http://rebind.network/thermostat`.
8. This time, that POST request gets sent to the small unprotected web server running on the victim’s WiFi-connected thermostat. The thermostat processes the request and the temperature in the victim’s home is set to 95 degrees 🔥.

This scenario is an actual exploit ([CVE-2018–11315](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11315%29)) that I’ve found and used against my Radio Thermostat CT50 “smart” thermostat. The implications and impact of an attack like this can have far reaching and devastating effects on devices or services running on a private network. By using a victim’s web browser as a sort of HTTP proxy, DNS rebinding attacks can bypass network firewalls and make every device on your protected intranet available to a remote attacker on the Internet.

# What’s Vulnerable?

After finding and exploiting this vulnerability in the very first device that I poked around with, I feared that there were likely many other IoT devices that could also be targeted. I began to collect and borrow some of the more popular smart home devices on the market today. Over the next few weeks every device that I got my hands on fell victim to DNS rebinding in one way or another, leading to information being leaked, or in some cases, full device control. Google Home, Chromecast, Roku, Sonos WiFi speakers, and certain smart thermostats could all be interfaced with in some way by an unauthorized remote attacker. Seems like a big problem huh?

> The idea that the local network is a safe haven is a fallacy. If we continue to believe it people are going to get hurt.

I’ve been in contact with the vendors of these products and all of them are working on or have already released security patches (more on that disclosure in [this essay](/%40brannondorsey/going-public-fast-thoughts-on-disclosure-policy-2d10ebc1f70d)). Those are just the companies whose devices I’ve personally tested in my spare time. If companies with such high profiles are failing to prevent against DNS rebinding attacks there must be countless other vendors that are as well.

![]()

Proof of concept DNS rebinding attack @ <http://rebind.network>

I’ve authored a proof-of-concept exploit that you can use to target these devices on your home network today. That demo is live at [http://rebind.network.](http://rebind.network)

## Google Home

![]()

Google Home Mini

The apps used to control Google Home products make use of an undocumented REST API running on port 8008 of these devices (e.g. `http://192.168.1.208:8008`). The first mention of this service that I’ve been able to find [surfaced back in 2013](http://fiquett.com/2013/07/chromecast-traffic-sniffing/) when Brandon Fiquett wrote about a Local API he found while sniffing the WiFi traffic to his Chromecast. Fast forward five years and it seems that Google has integrated that same mysterious API into all of its Google Home products, and as you can imagine, that undocumented API is fairly well documented by amateurs and hobbyists at this point. In fact, earlier this year Rithvik Vibhu published [detailed API docs](https://rithvikvibhu.github.io/GHLocalApi/) to the public.

This API provides extensive device control without any form of authentication. Some of the most interesting features include the ability to launch entertainment apps and play content, scan and join nearby WiFi networks, reboot, and even factory reset the device.

Imagine a scenario where you’re browsing the web and all of a sudden your Google Home factory resets. What if your roommate left their web browser open on their laptop and an HTML advertisement sends your Chromecast into reboot loops while you are trying to watch a movie? One of my favorite attack scenarios targeting this API is an abuse of the WiFi scanning capability. Attackers could pair this information with [publicly accessible wardriving](https://wigle.net/) data and get accurate geolocation using only your list of nearby WiFi networks. This attack would be successful even if you’ve disabled your web browser’s geolocation API and are using a VPN to tunnel your traffic through another country.

[Here is an example](https://pastebin.com/raw/U3tUqmRf) of some of the data that I’ve exfiltrated from my own Chromecast. Can you figure out where I might be writing this post from?

```
UPDATE (06/19/2018): [Craig Young's simultaneous and independent research](https://www.tripwire.com/state-of-security/vert/googles-newest-feature-find-my-home/#.WyfDEMLoy-g.twitter) on this vulnerability was disclosed yesterday, just ahead of this post. He actually created a PoC for the geolocation attack scenario that I described above, but never implemented! His work, and [Brian Kreb's commentary on it](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/) are both excellent 👏👏👏.I notified Google about this vulnerability when I discovered it in March and again in April after receiving no response. According to Kreb's post, Young reported the bug to Google in May and his ticket was closed with "Status: Won’t Fix (Intended Behavior)." It wasn't until Krebs himself contacted Google that they agreed to patch the vulnerability. Google is expected to release a patch in mid-July 2018.
```
## Sonos WiFi Speakers

![]()

Sonos Play:1

Like Google Home, Sonos WiFi speakers can also be controlled by a remote attacker (CVE-2018–11316). By following the wrong link you could find your pleasant evening jazz play list [interrupted by content of a very different sort](https://www.youtube.com/watch?v=dQw4w9WgXcQ). That’s fun for simple pranks, but ultimately pretty harmless, right?

After a bit of digging I found a few other interesting links to be followed on the Sonos UPnP web server that might not be so innocent. It appears that several hidden web pages are accessible on the device for debugging purposes. `http://192.168.1.76:1400/support/review` serves an [XML file](https://pastebin.com/raw/nPjhJQmk) that appears to contain the output of several Unix commands run on the Sonos device (which itself seems to run a distribution of Linux).

`http://192.168.1.76:1400/tools` provides a bare bones HTML form that lets you run a few of these Unix commands on the Sonos device yourself! The Sonos HTTP API allows a remote attacker to map internal and external networks using the `traceroute` command and probe hosts with ICMP requests with `ping` using simple POST requests. An attacker could use a Sonos device as a pivot point to gather useful network topology and connectivity information to be used in a follow up attack.

```
UPDATE (06/19/2018): Sonos has published a statement along with this public release; "Upon learning about the DNS Rebinding Attack, we immediately began work on a fix that will roll out in a July software update."
```
## Roku

![]()

RokuTV

While exploring the network in the lounge at my work building, I found an HTTP server running on port `8060` of a RokuTV. I soon found that Roku’s [External Control API](https://sdkdocs.roku.com/display/sdkdoc/External%2BControl%2BAPI) provides control over basic functionality of the device, like launching apps, searching, and playing content. Interestingly, it also allows direct control over button and key presses like a virtual remote, as well as input for several sensors including an accelerometer, orientation sensor, gyroscope and even a magnetometer (why?) As you’ve probably guessed, this local API requires no authentication and can be exploited via DNS rebinding (CVE-2018–11314).

I reported these findings to the Roku security team, who initially responded saying:

> There is no security risk to our customers’ accounts or the Roku platform with the use of this API… We are aware of web apps like <http://remoku.tv> that can be loaded into a browser and used to interact with the Roku on the same local network.

After [describing a detailed attack scenario](https://pastebin.com/raw/53HcBbmR), a security VP at the company clarified that their team does “consider this a valid threat and it is not mundane in the least.” To the team’s credit, they immediately halted the release roll out of Roku OS 8.1 and began to develop a patch, which they expected could take as long as 3–4 months if they couldn’t find a solution that worked in time for their upcoming release.

After some consideration, I informed the team that I was working with a reporter at WIRED and that we were likely going to publish the research quickly. The next morning I received an email from the team that a patch had been developed and was already in the process of being pushed to over 20 million devices through a firmware update!

```
UPDATE (06/19/2018): Roku has released a statement along with this public release; “After recently becoming aware of the DNS Rebinding issue, we created a software patch which is now rolling out to customers. Note that any potential exploitation of this vulnerability poses no security risk to our customers’ accounts, our channel partners’ content security or the Roku platform.”
```
## Radio Thermostat

![]()

Radio Thermostat CT50

The Radio Thermostat CT50 & CT80 devices have by far the most consequential IoT device vulnerabilities I’ve found so far. These devices are some of the cheapest “smart” thermostats available on the market today. I purchased one to play with after being tipped off to their lack of security by [CVE-2013–4860](https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2013-022/?fid=3870), which reported that the device had no form of authentication and could be controlled by anyone on the network. Daniel Crowley of Trustwave SpiderLabs had attempted to contact the vendor several times before ultimately publishing the vulnerability after hearing no response from the company. Unfortunately, this lack of response is a recurring theme of vulnerability disclosure over the years, especially with smaller manufacturers. I expected that the chances that the vulnerability had gone unpatched for five years was actually high, so I purchased a brand new CT50.

That assumption turned out to be correct and the thermostat’s control API left the door wide open for DNS rebinding shenanigans. It’s probably pretty obvious the kind of damage that can be done if your building’s thermostat can be controlled by remote attackers. The PoC at <http://rebind.network> exfiltrates some basic information from the thermostat before setting the target temperature to 95° F. That temperature can be dangerous, or even deadly in the summer months to an elderly or disabled occupant. Not to mention that if your device is targeted while you’re on vacation you could return home to a whopper of a utility bill.

The severity of this vulnerability, and the continued negligence by the Radio Thermostat Company of America who’ve had years to fix it, are perfect examples of why we need [security regulation for IoT devices](https://www.warner.senate.gov/public/index.cfm/2017/8/senators-introduce-bipartisan-legislation-to-improve-cybersecurity-of-internet-of-things-iot-devices).

## WiFi Routers

If you’ve been following all of this so far you may have already started to think of other devices on home networks that could be targeted. Would it surprise you to learn that, historically, network routers themselves are some of the most common targets to DNS rebinding attacks? Probably not.

That’s because network routers hold the keys to the kingdom. Own the router and you own the network. There are two common attack vectors that I’ve seen with DNS rebinding:

1. `POST`ing default credentials to a login page like `http://192.168.1.1/login`to own router admin. Once the attacker has authenticated they have full device control and can configure the network as they please.
2. Using a router’s [*Internet Gateway Device* (IGD) interface](https://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol) through UPnP to configure permanent port forwarding connections and expose arbitrary UDP & TCP ports on the network to the public Internet.

The first is pretty basic. Many routers ship with default login credentials and consumers never change them. Sure, maybe they will enable WPA2 and set a WiFi password, but I bet many of them don’t realize their router’s configuration panel is still accessible to anyone on the network using “admin:admin”.

The second attack is even worse, a downright travesty. Somehow, in this day and age, most brand-spanking-new home routers still ship with UPnP servers enabled by default. These UPnP servers provide admin-like control over router configuration to any unauthenticated machine on the network over HTTP. Any machine on the network, or the public Internet through DNS rebinding, can use IGD/UPnP to configure a router’s DNS server, add & remove NAT and WAN port mappings, view the # of bytes sent/received on the network, and access the router’s public IP address (check out [upnp-hacks.org](http://www.upnp-hacks.org/upnp.html) for more info).

A DNS rebinding attack that targets a router’s UPnP server can punch a hole in the victim’s firewall, leaving a permanent entry point to execute raw TCP & UDP attacks against devices on the network without being bound to the normal HTTP-only limitations of DNS rebinding attacks. They can even configure port forwarding rules that forward traffic to external IP addresses on the Internet, allowing an attacker to add a victim’s router as a node in a large network of infected routers that can be used to mask their traffic from authorities (see Akamai’s recent [UPnProxy research](https://www.akamai.com/us/en/multimedia/documents/white-paper/upnproxy-blackhat-proxies-via-nat-injections-white-paper.pdf)).

IGD also provides an interface to discover a router’s public IP address through a simple unauthenticated HTTP request. This functionality, combined with DNS rebinding, can be used to de-anonymize users who are otherwise attempting to mask their public IP address through a VPN or by using TOR.

In my experience router vulnerability to DNS rebinding is a mixed bag. I’ve seen routers that completely block DNS rebinding attacks, routers that randomize their UPnP server port to make discovery and attack more difficult, and I’ve seen routers that are completely wide-open to the attack. I should mention though that I’ve largely stayed away from applying my DNS rebinding research to routers so far... Mostly because I’m almost too afraid to look 😨.

# The Walled Garden Is a Lie

How is it that so many devices today could be vulnerable to an attack that was introduced [over ten years ago](https://crypto.stanford.edu/dns/)? There are likely more reasons for this than I can explain, but I’m willing to bet money on two of them.

The first is awareness. Best I can tell, DNS rebinding isn’t as popular of an attack as it should be. Sure, security nerds [*may* have heard of it](https://twitter.com/brannondorsey/status/1003394858931970048) but I’d wager that very few of them have actually ever tried it. It’s historically been a sort of cumbersome and difficult to pull off attack in practice. You have to spin up a malicious DNS server in the cloud, write some custom JavaScript payload targeting a specific service, serve that to a victim on a target network, and then figure out how to use their web browser to pivot to a target machine running that service, which you probably don’t know the IP address of. There’s overhead and it’s error prone. (I’ve written some tooling to ease some of that pain. More below…)

> We need developers to write software that treats local private networks as if they were hostile public networks.

Even if DNS rebinding becomes more popular in cybersecurity communities, that isn’t a guarantee that we’ll see a large drop in the number of vulnerable devices. That’s because security nerds aren’t the ones implementing these APIs, web developers are. Sure web developers *should* know that externally facing API endpoints need authorization of some kind, but there is a recurring general consensus that private networks themselves can be used to secure intranet facing APIs. Local APIs consistently offload trust and security to the private network itself. Why would your local REST API need authorization if your router has it? Entire protocols like UPnP are built around the idea that devices on the same network can trust each other. This is the root of the problem.

We need developers to write software that treats local private networks as if they were hostile public networks. The idea that the local network is a safe haven is a fallacy. If we continue to believe it people are going to get hurt.

# Protecting against DNS Rebinding

## Consumers

As the user of a product or service you are often at the mercy of the the people who built it. Fortunately, in the case of DNS rebinding, you have some control over protecting your network so long as you can make changes to your router’s configuration. [OpenDNS Home](https://www.opendns.com/home-internet-security/) is a free DNS service that can be configured to filter suspicious IP addresses like private IP ranges out of DNS responses. You should be able to change the DNS server your router uses from the default ISP’s DNS server to one of OpenDNS Home’s DNS servers in your router settings.

If you’d prefer to control this filtering on your router itself instead of trusting a public DNS server like OpenDNS to do it, you can use Dnsmasq or opt to install [libre router firmware like DD-RT](https://dd-wrt.com/) on the router itself. Either of these solutions are adequate if you have control over your router, but watch out, because you may still be a target of DNS rebinding attacks whenever you are on a network that hasn’t been explicitly configured to protect against them.

## Developers

If you’re a developer, or are involved in creating a product that has an HTTP API, there are several things you can do to protect it from DNS rebinding attacks. There are three simple solutions to choose from.

The first, and simplest to implement without side-effects to your existing system, is to add “Host” header validation to your HTTP server. This header is included in all HTTP requests sent from a modern browser and it contains the host (hostname:port) of the server it is expecting to communicate with. This value can be a domain name or an IP address, but either way, the server that receives the request should validate that it’s own host matches the host being requested. Because DNS rebinding relies on the change of an underlying IP address associated with a domain name, the Host header included in a malicious HTTP request that’s been rebound to a target service will maintain the original domain name as its Host header value. A malicious POST request to your router’s login page will have a Host header value that doesn’t match your router’s hostname or IP address on the network. It would instead look like `Host: malicious.website`. Web servers should validate that the requested Host header matches it’s expected value exactly and respond with a `403 Forbidden` HTTP status code if it doesn’t. I’ve written [an NPM module](https://github.com/brannondorsey/host-validation) that does this for Express.js web servers, but it should be pretty easy to implement in any web server or language.

Another effective method of spoiling DNS rebinding attacks is to use HTTPS instead of HTTP, even for local network connections. When rebinding occurs, the service being targeted will have an SSL certificate that isn’t valid for `malicious.website` and so a security warning will block the request from reaching your API endpoint. This solution has the added bonus of providing extra privacy and security for your users in general with the usual benefits that come with TLS/SSL. Vendors have historically shied away from shipping IoT devices with their own TLS/SSL certificates, but the Plex media server software has tackled this problem in an interesting way by actually [using DNS rebinding to issue certificates](https://blog.filippo.io/how-plex-is-doing-https-for-all-its-users/) and protect their customers!

Probably the best solution, albeit the one that involves the most potential disruption to your existing service, is to add some form of user authentication to your API. If your API controls real world functionality or provides access to sensitive information it should be accessible to select parties only. Period. It should not be accessible to the entire private network and therefore the public Internet as well through DNS rebinding. There is absolutely no reason that any device on the WiFi network should be able to arbitrarily control the heat in a building. People forget how easy it is to [crack WPA2 WiFi](https://github.com/brannondorsey/wifi-cracking).

# Tooling & Details

To help spread awareness of DNS rebinding attacks I’ve built tooling and libraries that others can use to author their own DNS rebinding attacks. Aside from the JavaScript payload written to target a specific device or service, the process of delivering that payload, interacting with the malicious DNS server, and enumerating hosts on the victim’s private network is pretty much the same between different attack targets. To lower the barrier to entry to learn about and perform DNS rebinding attacks, I’ve open sourced:

* A “malicious” DNS server called [whonow](https://github.com/brannondorsey/whonow)
* A front-end JavaScript library called [DNS rebind toolkit](https://github.com/brannondorsey/dns-rebind-toolkit)

## Whonow DNS Server

[Whonow](https://github.com/brannondorsey/whonow) is a custom DNS server that lets you specify DNS responses and rebind rules dynamically **using domain requests themselves**. Here’s an example of how it works:

```
# respond to DNS queries for this domain with 34.192.228.43 the first
# time it is requested and then 192.168.1.1 every time after that.
A.34.192.228.43.1time.192.168.1.1.forever.rebind.network# respond first with 34.192.228.43, then 192.168.1.1 the next five
# times, and then start all over again (1, then 5, forever…)
A.34.192.228.43.1time.192.168.1.1.5times.repeat.rebind.network
```

What’s great about dynamic DNS Rebinding rules is that you don’t have to spin up your own malicious DNS server to start exploiting the browser’s same-origin policy. Instead, everyone can share the same public whonow server running on port 53 of rebind.network.

You can try it now if you’d like, just use `dig` to query the public whonow instance. It responds to requests for `*rebind.network` domain names.

```
# dig is a unix command for making DNS requests
dig A.10.10.10.50.forever.rebind.network;; QUESTION SECTION:
;10.10.10.50.forever.rebind.network. IN A;; ANSWER SECTION:
10.10.10.50.forever.rebind.network. 1 IN A 10.10.10.50
```

Whonow always sets TTL values to one second so you can expect that it’s responses won’t stay in a DNS resolver’s cache for long.

![]()

Whonow public server output

## DNS Rebind Toolkit

[DNS Rebind Toolkit](http://github.com/brannondorsey/dns-rebind-toolkit) is a utility library that automates the process of executing DNS rebinding attacks. Once you’ve written a JavaScript payload to target a specific service, DNS Rebind Toolkit can help you deploy that attack on a victim’s network.

* It uses a [WebRTC IP address leak](https://github.com/diafygi/webrtc-ips) to discover the victim’s local IP address.
* It automates network subnet enumeration so that you can target devices even if you don’t know their IP addresses on the private network.
* It automates the DNS rebinding portion of the attack. You get a Promise that resolves once the rebind has finished.
* It uses whonow behind the scenes so that you don’t have to worry about the DNS server component of a DNS rebinding attack.
* It comes with several payloads for attacking common IoT devices and well-documented examples so that you learn to write your own exploits.

Launching an attack against a Google Home device on a 192.168.1.1/24 subnet is as easy as embedding a code snippet in and `index.html` page.

That `index.html` file will launch the attack, spawning one iframe for each IP address in the array passed to `rebind.attack(…)`. Each iframe embeds `payloads/google-home.html` with the following JavaScript snippet:

# 🌐🔗 Links & Thanks 👏

Thanks to Lily Hay Newman for three months of helpful conversations leading towards her [coverage of this research in WIRED](https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/). Mega-thanks to [William Robertson](https://medium.com/u/b6495f5d83eb?source=post_page---user_mention--ea7098a2d325--------------------------------) for his help with this work, especially for letting me pwn his home network + Sonos device 🤝. I’d also like to thank the security teams at both Roku and Sonos for their swift response in developing and deploying firmware updates to protect their users against DNS rebinding attacks.

Below are a collection of DNS rebinding resources I’ve found useful in my research. You might too!

* [Stanford’s Original DNS Rebinding Research](https://crypto.stanford.edu/dns/) (2007)
* [DNS Rebinding with Robert RSnake Hansen](https://www.youtube.com/watch?v=FIQGKIE3Fv0) (great video)
* [CORS, *the Frontendian*](https://frontendian.co/cors)
* [Luke Young’s DEFCON 25 “Achieving Reliable DNS Rebinding”](https://www.youtube.com/watch?v=Q0JG_eKLcws)
* [Ricky Lawshae’s DEFCON 19 SOAP & UPnP Talk](https://www.youtube.com/watch?v=dT0b5DWq9b8)
* [UPnP Hacks website](http://www.upnp-hacks.org/upnp.html)
* [Dear developers, beware of DNS Rebinding](https://www.twistlock.com/2018/02/28/dear-developers-beware-dns-rebinding/)
* [Practical Attacks with DNS Rebinding](https://www.tripwire.com/state-of-security/vert/practical-attacks-dns-rebinding/)
* [Original Blizzard Game’s DNS rebinding bug report by Tavis Ormandy](https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&desc=2)
[DNS](/tag/dns?source=post_page-----ea7098a2d325--------------------------------)[Security](/tag/security?source=post_page-----ea7098a2d325--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----ea7098a2d325--------------------------------)[Hacking](/tag/hacking?source=post_page-----ea7098a2d325--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----ea7098a2d325--------------------------------)

--

--

17

[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:96:96/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)[![Brannon Dorsey](https://miro.medium.com/v2/resize:fill:128:128/1*QMjh22BEhVWD2sQTJDkWpQ.jpeg)](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)Follow[## Written by Brannon Dorsey](/%40brannondorsey?source=post_page---post_author_info--ea7098a2d325--------------------------------)[894 Followers](/%40brannondorsey/followers?source=post_page---post_author_info--ea7098a2d325--------------------------------)·[111 Following](/%40brannondorsey/following?source=post_page---post_author_info--ea7098a2d325--------------------------------)

Artist | Programmer | Researcher

Follow
## Responses (17)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----ea7098a2d325--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----ea7098a2d325--------------------------------)[About](/about?autoplay=1&source=post_page-----ea7098a2d325--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ea7098a2d325--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----ea7098a2d325--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----ea7098a2d325--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ea7098a2d325--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ea7098a2d325--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----ea7098a2d325--------------------------------)[Teams](/business?source=post_page-----ea7098a2d325--------------------------------)



=== Content from krebsonsecurity.com_86c26b27_20250124_142235.html ===


Advertisement[![](/b-nyu/15.png)](https://cybersecurity-strategy-masters.nyu.edu/)
Advertisement[![](/b-knowbe4/23.jpg)](https://www.knowbe4.com/phisher-ai-osterman-6?utm_source=Krebs&utm_medium=display&utm_campaign=SATBrandAwareness&utm_content=AIEmail)

[![Krebs on Security](https://krebsonsecurity.com/wp-content/uploads/2021/03/kos-27-03-2021.jpg)](https://krebsonsecurity.com/ "Krebs on Security")

[Skip to content](#content "Skip to content")

* [Home](https://krebsonsecurity.com/)
* [About the Author](https://krebsonsecurity.com/about/)
* [Advertising/Speaking](https://krebsonsecurity.com/cpm/)

# Google to Fix Location Data Leak in Google Home, Chromecast

June 18, 2018

[40 Comments](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comments)

**Google** in the coming weeks is expected to fix a location privacy leak in two of its most popular consumer products. New research shows that Web sites can run a simple script in the background that collects precise location data on people who have a **Google Home** or **Chromecast** device installed anywhere on their local network.

![](https://krebsonsecurity.com/wp-content/uploads/2018/06/homecast.png)

**Craig Young**, a researcher with security firm **Tripwire**, said he discovered an authentication weakness that leaks incredibly accurate location information about users of both the smart speaker and home assistant [Google Home](https://store.google.com/us/product/google_home?hl=en-US), and [Chromecast](https://www.tomsguide.com/us/what-is-google-chromecast%2Cnews-17637.html), a small electronic device that makes it simple to stream TV shows, movies and games to a digital television or monitor.

Young said the attack works by asking the Google device for a list of nearby wireless networks and then sending that list to Google’s geolocation lookup services.

“An attacker can be completely remote as long as they can get the victim to open a link while connected to the same Wi-Fi or wired network as a Google Chromecast or Home device,” Young told KrebsOnSecurity. “The only real limitation is that the link needs to remain open for about a minute before the attacker has a location. The attack content could be contained within malicious advertisements or even a tweet.”

It is common for Web sites to keep a record of the numeric [Internet Protocol (IP) address](https://en.wikipedia.org/wiki/IP_address) of all visitors, and those addresses can be used in combination with online geolocation tools to glean information about each visitor’s hometown or region. But this type of location information is often quite imprecise. In many cases, IP geolocation offers only a general idea of where the IP address may be based geographically.

This is typically not the case with Google’s geolocation data, which includes [comprehensive maps of wireless network names around the world](https://www.maketecheasier.com/google-know-where-wifi-router/), linking each individual Wi-Fi network to a corresponding physical location. Armed with this data, Google can very often determine a user’s location to within a few feet (particularly in densely populated areas), by triangulating the user between several nearby mapped Wi-Fi access points. [Side note: Anyone who’d like to see this in action need only to turn off location data and remove the SIM card from a smart phone and see how well navigation apps like Google’s [Waze](https://www.waze.com/) can still figure out where you are].

“The difference between this and a basic IP geolocation is the level of precision,” Young said. “For example, if I geolocate my IP address right now, I get a location that is roughly 2 miles from my current location at work. For my home Internet connection, the IP geolocation is only accurate to about 3 miles. With my attack demo however, I’ve been consistently getting locations within about 10 meters of the device.”

Young said a demo he created (a video of which is below) is accurate enough that he can tell roughly how far apart his device in the kitchen is from another device in the basement.

“I’ve only tested this in three environments so far, but in each case the location corresponds to the right street address,” Young said. “The Wi-Fi based geolocation works by triangulating a position based on signal strengths to Wi-Fi access points with known locations based on reporting from people’s phones.”

Beyond leaking a Chromecast or Google Home user’s precise geographic location, this bug could help scammers make phishing and extortion attacks appear more realistic. Common scams like fake FBI or IRS warnings or threats to release compromising photos or expose some secret to friends and family could abuse Google’s location data to lend credibility to the fake warnings, Young notes.

“The implications of this are quite broad including the possibility for more effective blackmail or extortion campaigns,” he said. “Threats to release compromising photos or expose some secret to friends and family could use this to lend credibility to the warnings and increase their odds of success.”

When Young first reached out to Google in May about his findings, the company replied by closing his bug report with a “Status: Won’t Fix (Intended Behavior)” message. But after being contacted by KrebsOnSecurity, Google changed its tune, saying it planned to ship an update to address the privacy leak in both devices. Currently, that update is slated to be released in mid-July 2018.

According to Tripwire, the location data leak stems from poor authentication by Google Home and Chromecast devices, which rarely require authentication for connections received on a local network.

“We must assume that any data accessible on the local network without credentials is also accessible to hostile adversaries,” Young wrote in [a blog post](https://www.tripwire.com/state-of-security/vert/googles-newest-feature-find-my-home/#.WyfDEMLoy-g.twitter) about his findings. “This means that all requests must be authenticated and all unauthenticated responses should be as generic as possible. Until we reach that point, consumers should separate their devices as best as is possible and be mindful of what web sites or apps are loaded while on the same network as their connected gadgets.”

Earlier this year, KrebsOnSecurity posted [some basic rules for securing your various “Internet of Things” (IoT) devices](https://krebsonsecurity.com/2018/01/some-basic-rules-for-securing-your-iot-stuff/). That primer lacked one piece of advice that is a bit more technical but which can help mitigate security or privacy issues that come with using IoT systems: Creating your own “Intranet of Things,” by segregating IoT devices from the rest of your local network so that they reside on a completely different network from the devices you use to browse the Internet and store files.

“A much easier solution is to add another router on the network specifically for connected devices,” Young wrote. “By connecting the [WAN port](https://www.lnet.fi/en/moremachines) of the new router to an open [LAN port](https://www.lnet.fi/en/moremachines) on the existing router, attacker code running on the main network will not have a path to abuse those connected devices. Although this does not by default prevent attacks from the IoT devices to the main network, it is likely that most naïve attacks would fail to even recognize that there is another network to attack.”

For more on setting up a multi-router solution to mitigating threats from IoT devices, check out [this in-depth post](https://www.pcper.com/reviews/General-Tech/Steve-Gibsons-Three-Router-Solution-IOT-Insecurity) on the subject from security researcher and blogger **Steve Gibson**.

**Update, June 19, 6:24 p.m. ET:** The authentication problems that Tripwire found are hardly unique to Google’s products, according to extensive research released today by artist and programmer Brannon Dorsey. Check out **Wired.com**‘s story on Dorsey’s research [here](https://www.wired.com/story/chromecast-roku-sonos-dns-rebinding-vulnerability/).

*This entry was posted on Monday 18th of June 2018 10:04 AM*

[Latest Warnings](https://krebsonsecurity.com/category/latest-warnings/)
[Craig Young](https://krebsonsecurity.com/tag/craig-young/) [google](https://krebsonsecurity.com/tag/google/) [Google Chromecast](https://krebsonsecurity.com/tag/google-chromecast/) [Google Home](https://krebsonsecurity.com/tag/google-home/) [internet of things](https://krebsonsecurity.com/tag/internet-of-things/) [Intranet of Things](https://krebsonsecurity.com/tag/intranet-of-things/) [Tripwire](https://krebsonsecurity.com/tag/tripwire/)

Post navigation
[← Librarian Sues Equifax Over 2017 Data Breach, Wins $600](https://krebsonsecurity.com/2018/06/librarian-sues-equifax-over-2017-data-breach-wins-600/)
[AT&T, Sprint, Verizon to Stop Sharing Customer Location Data With Third Parties →](https://krebsonsecurity.com/2018/06/verizon-to-stop-sharing-customer-location-data-with-third-parties/)

## 40 thoughts on “Google to Fix Location Data Leak in Google Home, Chromecast”

1. The Sunshine State [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468802)

   Facebook and Google are “Skynet”
3. Jim [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468803)

   No surprise to me. Any device or service offered by Google, YouTube, Facebook, Twitter is always a privacy suspect. It is what they do.

   1. David [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468821)

      ^Amazon
5. Jeff [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468804)

   You could use a Guest Wifi network for IoT devices instead of 2 routers. Better still is to prevent guest devices from being able to see each other. Not sure which, if any, routers offer that as a feature. Netgear used to offer it. Found this,

   <https://www.routersecurity.org/vlan.php>

   about a router that definitely can keep devices on the LAN from seeing each other

   1. Daniel [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468805)

      Netgear still utilizes guest networks on their latest routers, but I’m just so tired of their ‘Netgear Genie’ GUI for router configuration, but I guess it fits the needs I require for my small home network.

      1. Jeff [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468807)

         Mis-understanding. I was referring to isolating guest users from each other. I found this discussion about how Netgear changed their software in this regard:

         “One complaint we’ll make about the guest network feature on the Nighthawk X6 that we also made about the original Nighthawk is that the guest network option for network isolation and local network access is the same toggle labeled “allow guests to see each other and access the local network.” Yet in older Netgear routers we’ve owned/tested the option was split into “allow guests to access my local network” and “enable wireless isolation.” There are numerous, and perfectly valid, reasons for wanting to enable one and not the other (e.g. your kids want to play network games with their friends on the guest network so network isolation must be disabled, but you don’t want them to access to your LAN) and there’s no good reason why the settings aren’t more granular on such a high-end router.”

         <https://www.howtogeek.com/211927/htg-reviews-the-netgear-nighthawk-x6-a-beefy-tri-band-router-for-a-busy-modern-home/>
7. G.Scott H. [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468806)

   The chromecast was designed to work primarily from the same network as the “controlling” device.

   It does have a guest mode for mobile devices not on the network where you use a direct wifi connection to control it, but not direct stream, and the mobile device has to have it’s own internet connection.

   Chromecast does not work with wifi port isolation or between a wifi guest segment and the main segment.

   The options for using a chromecast on an isolated IoT segment are extremely limited.

   The article made me think that the same could be done using a mobile device, or computer to obtain the wifi SSID list. The chomecast/home device having easy access to the nearby wifi is only part of the problem. The databases of locations to wifi SSIDs is big part of the problem.

   1. Jeff [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468808)

      Good points. But, why do you assume Chromecast has to be on the main network segment? The Chromecast and any other device needing to talk to it, could be on their own, hopefully isolated, SSID. No? Some Asus routers can create 8 SSIDs, 4 regular and 4 guest.

      1. Justin W [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468822)

         That is correct. The Chromecast must have internet access and must be on the same network as (and visible to) the controlling device. That doesn’t mean that the Chromecast has to be on the same network as the rest of the household. As long as you connect your device (phone, tablet, etc) to the same network as the Chromecast it should work.
9. Paul T [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468809)

   That Gibson thing is such a convoluted solution, it’s crazy.

   What we \_REALLY\_ need is for major SOHO/consumer router manufacturers like Cisco, Asus, Netgear, etc, to assign IoT devices to untrusted VLANs.

   Untrusted VLANs should have full internet access but no access to trusted VLANs. And trusted VLANs should have access to everything, including devices on the untrusted VLAN. This is essentially what I have setup in my home with PFsense.

   They need to make this configuration easy to do, too, using something like nmap to discover devices on the network, figure out what they are, and then automatically assign them to the right VLAN. If they can’t discover a device, it should go on the untrusted VLAN by default.

   IMO, this would be a killer app for a SOHO router. I would immediately buy them for all my relatives.

   1. vb [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468813)

      +1. Perfect! This is the best solution.
   3. EJ [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468833)

      That wouldn’t have stopped this attack though since it was browser -> device.

      1. Paul T [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468845)

         The device would have been on a separate VLAN, meaning it wouldn’t be in the same address block. While packets to the chromecast’s address would be routed, the malware would need to somehow know where it’s located. That is possible via some sort of multicast maybe, but unlikely to see that in the wild as it’s not a common target.

         1. RealityCheck [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468846)

            For everyone praising this comment please read: Security through obscurity is not security!

            The malware could just scan all of RFC1918 address space and it would not take much time. Nothing related to multicast… Shoving your IoT device into another subnet is not security!

            The real solution is multilayer – You could use something like a honeypot address (dummy host) that when scanned, trigger some blocking action. You could use a firewall to rate limit requests and block requests to specific hosts. You could use an IDS to detect scanning traffic.

            In this case it feels like application-level and OS-level firewalls are the best option. If I’m a typical home user, Javascript running on anything but maybe netflix.com and google.com should be allowed to access other local networks. Browser vendors need to implement some better tools for having more granular control over this type of behavior.

            1. Paul T [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468857)

               It’s all very clever to parrot the security through obscurity bit, and of course that is technically true. But lets put it this way.

               WordPress is a very attractive target, as it comprises a sizable portion of the internet. I admin two wordpress sites. One, an enthusiast site, has its admin directory in the /front/wp-admin rather than /wp-admin. The other, a corporate site, doesn’t. The corp site is attacked several hundred times more often.

               Same deal with a bunch of servers I run, where I move SSH from port 22 to 17022. Attacks drop by orders of magnitude.

               These things are the very definition of security through obscurity, and of course a determined attacker spear-fishing would immediately switch to the right directory or port. But that doesn’t make it worthless. All the worms and poorly designed automated attacks fail. I’m not a low-hanging fruit.

               All that said, I agree that a packet inspecting network IDS combined with host-based IDS on servers is a much better solution, but that’s a ton of overhead for consumer hardware. My VLAN solution could actually be done with reasonable effort.
            3. cthulhu [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468863)

               Of course security by obscurity doesn’t work. That’s why Russian tanks are painted day-glo orange.

               1. Reader [June 21, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468886)

                  Factory painted tanks are not orange. Russia never had orange tanks. The only ones that are orange are for parades, decommissioned units.

                  1. SeymourB [June 21, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468893)

                     Some day someone will invent a sarcasm tag for the internet. That person will become a billionaire overnight.
            5. anonymouse [June 20, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468871)

               Security through obscurity doesn’t work that’s why you’re using your real name “RealityCheck” to post on random internet forums right?

               You seem to have forgotten to leave your home address, phone number and email address.
11. pedro [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468812)

    thanks
13. Jgroves [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468814)

    I’ve attempted to implement IoT networks a number of times for Chromecast and Google Home by using mdns repeaters between networks to allow devices to use them and have had nothing but crappy results. IOT devices drop out and go unresponsive without warning or reproducible symptoms.

    It’s just not possible to use these Chromecast based devices as intended from a separate network for casual users like wives and kids.

    1. cthulhu [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468864)

       Many home wireless routers will grant an IP address using DHCP, and then drop it if they haven’t had a communication from that IP address in a certain amount of time. A lot of times, you can fix that by having the IoT device ping somebody on a cron so the router remembers it as still being attached.
15. Melissa Williams [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468815)

    I can’t get my Google Chrome cast to work in my home
17. Brafs [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468816)

    The grandt brother working
19. TedP [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468818)

    would adding \_nomap to your SSID take care of this?

    1. Paul T [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468819)

       Adding \_nomap would fix it if and only if no other wifi networks can be detected from your location, if you were out in a rural environment.
21. Andrew Jones [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468823)

    OK, while I understand the “severity” of the supposed issue, I would like to know how likely the researcher thinks it is that a website or malicious ad is going to be able to guess the IP address of a Chromecast or Google Home device on the network in order to direct the requests to it. It seems highly unlikely that this is ever going to be something that would ever be seen outside of lab conditions.

    1. [Craig Young](https://secur3.us) [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468825)

       I do not know how likely it is that advertisers or scammers will do this, only that they can.

       Chrome and Firefox reveal the client LAN IP as part of WebRTC. From there it is easy to try all 254 addresses that would be in that /24 and this is where IoT devices will probably be.

       There are also some ways of determining this in safari and or/edge

       1. [Craig Young](https://secur3.us) [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468826)

          Continuing that comment…

          On safari, ie, and edge, there are other techniques that will reveal active networks.

          Beyond that, it is trivial to get a strong educated guess that Google devices are on a particular IP.
    3. anon223 [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468829)

       Multicast packets my man… Multicast.

       No need to know Chromecast IP. That is how the system works, it is a promiscuous little thing, and like to communicate with anybody on the network.
23. anon223 [June 18, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468830)

    QUESTION:

    If I connect my Chromecast to Wired Ethernet using the optional adapter… is it smart enough not to map out SSIDs using the builtin Wifi? I don’t know if Wifi turns off when connected to Wired Ethernet.
25. thomm [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468834)

    What about Google’s mesh wifi product…
27. John S [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468836)

    A bug? right. No such thing as this being a bug. Google and many others are obsessed with knowing where you are at all times. I refrain from allowing too many IoT devices into my home.

    1. Paul T [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468858)

       This is absolutely a bug. Google wants to know your location and everything else about you, but they don’t want to give that information away to third-parties. They want them to pay for it, to target ads.
29. Joe [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468837)

    As someone who has multiple segregated WLAN networks, let me explain the s— show that is trying to isolate IOT/consumer type devices on different wifi network segments. It’s literally a nightmare when you attempt to use these devices on one WLAN from a different WLAN or LAN. You can thank the manufacturers for this as they don’t provide detailed documentation for what protocols/ports are required for communication. I’ve spent many hours packet sniffing in tandem with features like IP Helper to cram broadcast domain only packets into different broadcast domains to get things working. They can’t be bothered to create documentation because it’s far simpler to say “All devices must be on the same network segment”.
31. Jim [June 19, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468838)

    It’s not just a “Google” thing. Name a product, that accesses the internet, that does not want your information. Come on now, and don’t just blame Google or Facebook or maps applications. It’s a built in tracking mechanism. The phone call software, the ringer software, all depend on location data to send the call to the correct tower so that you receive the phone call, same with texts and map directions. And you didn’t know this? It’s not a feature, it’s a function. My only question is why is it added to so many devices?? Or why was security ignored? After all, in the 90’s we had wireless heart monitors,
33. [SomePerson](http://localhost.com) [June 20, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468884)

    Can’t you just adjust your wireless network SSID so that your Google and other IoF Kit uses has an SSID that ending in “\_nomap”
35. John [June 23, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468931)

    Probably for Craig Young. Would it be possible for some one to use this “bug” / IP information to target a house that has its front door locks, home lights and security cameras tied to their IoT? If so, this becomes more than just an inconvenience of unwanted eMails and ads.

    1. NotCraigYoung [June 25, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-468973)

       From my understanding of Brannon’s article ([https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325](https://medium.com/%40brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325)) Only if the IoT device has an unauthenticated or default authenticated http API, which honestly might not be as unlikely as it sounds if you buy cheap ones online somewhere (pure speculation on my part based on a couple of cheap IP cameras I’ve played with).

       And if the malicious javascript makes quick enough requests, you could theoretically execute a dictionary attack against the devices on a home network since people aren’t exactly known for secure passwords — especially if they think they’re safe in their home LAN.
37. G.Scott H. [June 27, 2018](https://krebsonsecurity.com/2018/06/google-to-fix-location-data-leak-in-google-home-chromecast/#comment-469071)

    I think the fix may have been released 2018-06-27 00:00:00 UTC. My chromecast device is not performing it’s primary function, It is not visible to all but the Google Home app. Oops.

Comments are closed.

Advertisement[![](/b-nyu/17.png)](https://cybersecurity-strategy-masters.nyu.edu/)

Advertisement

Mailing List

[Subscribe here](/subscribe/)

Search KrebsOnSecurity

Search for:

Recent Posts

* [MasterCard DNS Error Went Unnoticed for Years](https://krebsonsecurity.com/2025/01/mastercard-dns-error-went-unnoticed-for-years/)
* [Chinese Innovations Spawn Wave of Toll Phishing Via SMS](https://krebsonsecurity.com/2025/01/chinese-innovations-spawn-wave-of-toll-phishing-via-sms/)
* [Microsoft: Happy 2025. Here’s 161 Security Updates](https://krebsonsecurity.com/2025/01/microsoft-happy-2025-heres-161-security-updates/)
* [A Day in the Life of a Prolific Voice Phishing Crew](https://krebsonsecurity.com/2025/01/a-day-in-the-life-of-a-prolific-voice-phishing-crew/)
* [U.S. Army Soldier Arrested in AT&T, Verizon Extortions](https://krebsonsecurity.com/2024/12/u-s-army-soldier-arrested-in-att-verizon-extortions/)

Story Categories

* [A Little Sunshine](https://krebsonsecurity.com/category/sunshine/)
* [All About Skimmers](https://krebsonsecurity.com/category/all-about-skimmers/)
* [Ashley Madison breach](https://krebsonsecurity.com/category/ashley-madison-breach/)
* [Breadcrumbs](https://krebsonsecurity.com/category/breadcrumbs/)
* [Data Breaches](https://krebsonsecurity.com/category/data-breaches/)
* [DDoS-for-Hire](https://krebsonsecurity.com/category/ddos-for-hire/)
* [Employment Fraud](https://krebsonsecurity.com/category/employment-fraud/)
* [How to Break Into Security](https://krebsonsecurity.com/category/how-to-break-into-security/)
* [Internet of Things (IoT)](https://krebsonsecurity.com/category/internet-of-things-iot/)
* [Latest Warnings](https://krebsonsecurity.com/category/latest-warnings/)
* [Ne'er-Do-Well News](https://krebsonsecurity.com/category/neer-do-well-news/)
* [Other](https://krebsonsecurity.com/category/other/)
* [Pharma Wars](https://krebsonsecurity.com/category/pharma-wars/)
* [Ransomware](https://krebsonsecurity.com/category/ransomware/)
* [Russia's War on Ukraine](https://krebsonsecurity.com/category/russias-war-on-ukraine/)
* [Security Tools](https://krebsonsecurity.com/category/security-tools/)
* [SIM Swapping](https://krebsonsecurity.com/category/sim-swapping/)
* [Spam Nation](https://krebsonsecurity.com/category/spam-nation/)
* [Target: Small Businesses](https://krebsonsecurity.com/category/smallbizvictims/)
* [Tax Refund Fraud](https://krebsonsecurity.com/category/tax-refund-fraud/)
* [The Coming Storm](https://krebsonsecurity.com/category/comingstorm/)
* [Time to Patch](https://krebsonsecurity.com/category/patches/)
* [Web Fraud 2.0](https://krebsonsecurity.com/category/web-fraud-2-0/)

Why So Many Top Hackers Hail from Russia

[![](https://krebsonsecurity.com/wp-content/uploads/2017/06/computered-580x389.png)](https://krebsonsecurity.com/2017/06/why-so-many-top-hackers-hail-from-russia/)

© Krebs on Security - [Mastodon](https://infosec.exchange/%40briankrebs)


