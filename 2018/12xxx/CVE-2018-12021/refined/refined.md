Based on the provided information, here's an analysis of CVE-2018-12021:

**Root Cause of Vulnerability:**

- The vulnerability stems from an incorrect access control issue in Singularity versions 2.3.0 through 2.5.1 when using overlay file systems. Specifically, the `singularity mount` command did not properly restrict the use of overlay images which when coupled with persistent ext3 overlay could allow a malicious user to access sensitive information. Also, a race condition could be exploited to bypass directory image restrictions

**Weaknesses/Vulnerabilities Present:**

- **Incorrect Access Control:** Singularity failed to properly restrict access when using overlay images with the `singularity mount` command.
- **Race Condition:** A race condition existed that could allow a malicious user to bypass directory image restrictions, like mounting the host root filesystem as a container image.
- **Sensitive Information Disclosure:** The vulnerability allows a malicious user to access sensitive information on disk by exploiting overlay file systems.
- **Bypass of Directory Image Restrictions:** The vulnerability allows bypassing restrictions meant to prevent mounting of the host root filesystem into the container.

**Impact of Exploitation:**

- **Sensitive Data Exposure:** An attacker could gain access to sensitive information on the host system's disk.
- **Bypass Security Mechanisms:** Directory image restrictions, intended to isolate containers, can be bypassed, potentially allowing access to the entire host filesystem.
- **Privilege Escalation (Potentially):** While not explicitly stated as a direct privilege escalation, the ability to mount the host root filesystem as a container image could be leveraged for further malicious activity.

**Attack Vectors:**

- **Network Access:** A malicious user with network access to the host system (e.g., via SSH) could exploit this vulnerability.
- **Local Access:** The user needs to have some local access or shell access to the host system.

**Required Attacker Capabilities/Position:**

- **Network Access to Host:**  The attacker needs to be able to access the host system over the network.
- **Low Privileges:** The attacker only requires low privileges on the host system.
- **Knowledge of Singularity:** The attacker must have knowledge about how Singularity uses overlayfs and how to exploit the mentioned race condition.

**Additional Notes:**

-   The vulnerability is specific to systems using kernels that support overlay file systems.
-   The fix for this vulnerability was implemented in Singularity version 2.5.2.
-   As a workaround, users who cannot upgrade immediately were advised to disable the overlay feature by setting `enable overlay = no` in the `singularity.conf` configuration file.

This detailed information is extracted from the provided content, and it aligns with the core aspects of CVE-2018-12021 description.