```
{
  "cveId": "CVE-2018-12904",
  "description": "The KVM implementation in the Linux kernel did not properly perform permission checks in some situations when nested virtualization is used. An attacker in a guest VM could possibly use this to escape into an outer VM or the host OS.",
  "vulnerability": {
    "rootCause": "The KVM implementation in the Linux kernel failed to enforce that VMX instructions executed inside a L1 VM originated from ring 0, a privilege level that should be enforced by hardware but isn't in nested virtualization scenarios.",
    "weaknesses": [
      "Improper privilege check when emulating VMX instructions during nested virtualization.",
      "The hardware does not enforce CPL=0 for VMX instructions in nested virtualization, requiring the hypervisor (KVM) to do it in software."
    ],
    "impact": "An attacker inside a guest VM can potentially achieve a privilege escalation to the outer VM or the host OS by exploiting the missing privilege checks for VMX instructions.",
    "attackVectors": [
      "Exploiting the missing privilege check when handling nested virtualization.",
      "Crafting a malicious VM that uses privileged VMX instructions without being in ring 0."
    ],
     "requiredCapabilities": "An attacker needs to be running code within a guest VM, and the system must be configured for nested virtualization."
  }
}
```