=== Content from www.mercurial-scm.org_a6e337bb_20250124_233558.html ===

[![mercurial](/hg/static/hglogo.png)](https://mercurial-scm.org/)

* [log](/hg/shortlog/90a274965de7)
* [graph](/hg/graph/90a274965de7)
* [tags](/hg/tags)
* [bookmarks](/hg/bookmarks)
* [branches](/hg/branches)

* changeset
* [raw](/hg/raw-rev/90a274965de7)
* [browse](/hg/file/90a274965de7)

* [zip](/hg/archive/90a274965de7.zip)
* [gz](/hg/archive/90a274965de7.tar.gz)
* [bz2](/hg/archive/90a274965de7.tar.bz2)

* [help](/hg/help)

## [Mercurial](/) > [hg](/hg)

### changeset 38187:[90a274965de7](/hg/rev/90a274965de7) stable

Find changesets by keywords (author, files, the commit message), revision
number or hash, or [revset expression](/hg/help/revsets).

mpatch: be more careful about parsing binary patch data (SEC)
It appears to have been possible to trivially walk off the end of an
allocated region with a malformed patch. Oops.
Caught when writing an mpatch fuzzer for oss-fuzz.
This defect is OVE-[20180430](../rev/20180430)-0001. A CVE has not been obtained as of
this writing.

| author | Augie Fackler <augie@google.com> |
| --- | --- |
| date | Sat, 28 Apr 2018 00:42:16 -0400 |
| parents | [c0081d3e1598](/hg/rev/c0081d3e1598) |
| children | [1acfc35d478c](/hg/rev/1acfc35d478c) |
| files | [mercurial/mpatch.c](/hg/file/90a274965de7/mercurial/mpatch.c) |
| diffstat | 1 files changed, 3 insertions(+), 1 deletions(-) [+] [-]  | [mercurial/mpatch.c](#l1.1) | 4 |  | | --- | --- | --- | |

line wrap: on
 line diff
```

--- a/mercurial/mpatch.c	Wed Jun 06 09:14:33 2018 -0700
+++ b/mercurial/mpatch.c	Sat Apr 28 00:42:16 2018 -0400
@@ -197,7 +197,9 @@

 	lt = l->tail;

-	while (pos >= 0 && pos < len) {
+	/* We check against len-11 to ensure we have at least 12 bytes
+	   left in the patch so we can read our three be32s out of it. */
+	while (pos >= 0 && pos < (len - 11)) {
 		lt->start = getbe32(bin + pos);
 		lt->end = getbe32(bin + pos + 4);
 		lt->len = getbe32(bin + pos + 8);
```



=== Content from www.mercurial-scm.org_34200650_20250124_233611.html ===


Search:

[![Mercurial](https://www.mercurial-scm.org/logo-droplets-50.png)](/Mercurial)
[Login](/WhatsNew?action=login)
# [WhatsNew](/WhatsNew)

* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [WhatsNew](/WhatsNew)

---

* Immutable Page
* Comments
* [Info](/WhatsNew?action=info)
* [Attachments](/WhatsNew?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  Sync Pages
  ------------------------
  Load
  Save
  SlideShow

# Release Notes

Features and bugfixes in our latest releases. Please see the [Download](/Download) page for links to source and binaries.

Note that Mercurial follows a time-based release plan with major releases every three months and minor (bugfix) releases on the first of every month (see [TimeBasedReleasePlan](/TimeBasedReleasePlan)).

![{i}](/moin-static/modernized/img/icon-info.png "{i}")

WhatsNew (last edited 2025-01-16 16:19:31 by [RaphaelGomes](/RaphaelGomes "RaphaelGomes @ brc29-h03-89-89-147-228.dsl.sta.abo.bbox.fr[89.89.147.228]"))

* Immutable Page
* Comments
* [Info](/WhatsNew?action=info)
* [Attachments](/WhatsNew?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  Sync Pages
  ------------------------
  Load
  Save
  SlideShow

* [MoinMoin Powered](http://moinmo.in/ "This site uses the MoinMoin Wiki software.")
* [Python Powered](http://moinmo.in/Python "MoinMoin is written in Python.")
* [GPL licensed](http://moinmo.in/GPL "MoinMoin is GPL licensed.")
* [Valid HTML 4.01](http://validator.w3.org/check?uri=referer "Click here to validate this page.")



=== Content from lists.debian.org_b7976529_20250124_233555.html ===


---

[[Date Prev](msg00031.html)][[Date Next](msg00033.html)]
[[Thread Prev](msg00031.html)][[Thread Next](msg00033.html)]
[[Date Index](maillist.html#00032)]
[[Thread Index](threads.html#00032)]

# [SECURITY] [DLA 2293-1] mercurial security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2293-1] mercurial security update
* *From*: Roberto C. SÃ¡nchez <roberto@debian.org>
* *Date*: Fri, 31 Jul 2020 07:06:17 -0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20200731110617.GA11612%40connexer.com)Â [20200731110617.GA11612@connexer.com](msg00032.html)>
* *Mail-followup-to*: Roberto C. SÃ¡nchez <roberto@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2293-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>
July 27, 2020                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : mercurial
Version        : 4.0-1+deb9u2
CVE ID         : CVE-2017-17458 CVE-2018-13346 CVE-2018-13347 CVE-2018-13348
                 CVE-2018-1000132 CVE-2019-3902
Debian Bug     : 901050 892964 927674

Several vulnerabilities were discovered in mercurial, an easy-to-use,
scalable distributed version control system.

CVE-2017-17458

    In Mercurial before 4.4.1, it is possible that a specially
    malformed repository can cause Git subrepositories to run
    arbitrary code in the form of a .git/hooks/post-update script
    checked into the repository. Typical use of Mercurial prevents
    construction of such repositories, but they can be created
    programmatically.

CVE-2018-13346

    The mpatch_apply function in mpatch.c in Mercurial before 4.6.1
    incorrectly proceeds in cases where the fragment start is past the
    end of the original data.

CVE-2018-13347

    mpatch.c in Mercurial before 4.6.1 mishandles integer addition and
    subtraction.

CVE-2018-13348

    The mpatch_decode function in mpatch.c in Mercurial before 4.6.1
    mishandles certain situations where there should be at least 12
    bytes remaining after the current position in the patch data, but
    actually are not.

CVE-2018-1000132

    Mercurial version 4.5 and earlier contains a Incorrect Access
    Control (CWE-285) vulnerability in Protocol server that can result
    in Unauthorized data access. This attack appear to be exploitable
    via network connectivity. This vulnerability appears to have been
    fixed in 4.5.1.

CVE-2019-3902

    Symbolic links and subrepositories could be used defeat Mercurial's
    path-checking logic and write files outside the repository root.

For Debian 9 stretch, these problems have been fixed in version
4.0-1+deb9u2.

We recommend that you upgrade your mercurial packages.

For the detailed security status of mercurial please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mercurial>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpOdYQufLLtK.pgp)**

*Description:* PGP signature

---


