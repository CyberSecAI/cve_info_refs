- **Root cause of vulnerability**: The vulnerability is due to a lack of Cross-Site Request Forgery (CSRF) protection on the admin user creation/edit page. This allows an attacker to craft a malicious HTML page that, when visited by an authenticated administrator, will trigger the addition of a new user account with specified attributes including a high score.
- **Weaknesses/vulnerabilities present**: The primary weakness is the missing CSRF token or other proper CSRF mitigation mechanisms within the `Users::edit` function of the WSTMall admin panel. This allows for unauthenticated requests to perform user creation operations.
- **Impact of exploitation**: The exploitation results in the creation of a new user account with a predefined high score (999), which can be used by an attacker to gain advantages within the application or demonstrate a significant vulnerability. The attacker can potentially add numerous such accounts.
- **Attack vectors**: The attack vector is through a malicious HTML page (a.html) that contains a form with hidden fields pre-filled with user data (username, password, score, etc.) and automatically submits this form to the vulnerable admin endpoint. When an authenticated admin views the attacker-controlled HTML page, the form is automatically submitted in the background, creating a malicious user without the admin's direct knowledge or consent.
- **Required attacker capabilities/position**: The attacker needs to be able to get an authenticated administrator to visit the crafted HTML page. This could be achieved through a phishing attack, embedding the malicious code in a compromised website, or other social engineering methods. The attacker does not need to be authenticated on the WSTMall instance itself, but does require a currently authenticated administrator to be vulnerable.