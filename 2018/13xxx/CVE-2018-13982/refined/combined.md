=== Content from github.com_fb5773e1_20250125_002216.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581531)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581531)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  715](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/bcedfd6b58bed4a7366336979ebaa5a240581531)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Release version 3.1.32

[Browse files](/smarty-php/smarty/tree/bcedfd6b58bed4a7366336979ebaa5a240581531)
Browse the repository at this point in the history

* Loading branch information

Uwe Tews
committed
Apr 24, 2018

1 parent
[216ada9](/smarty-php/smarty/commit/216ada91f3c72114164329bd33dea4a882adf776)

commit bcedfd6

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**6 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* change\_log.txt
  [change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391)
* libs

  + libs/Smarty.class.php
    [Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391 "change_log.txt")

Show comments

[View file](/smarty-php/smarty/blob/bcedfd6b58bed4a7366336979ebaa5a240581531/change_log.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,4 @@ |
|  |  | ﻿===== 3.1.32 - dev === |
|  |  | ﻿===== 3.1.32 ===== (24.04.2018) |
|  |  | 24.04.2018 |
|  |  | - bugfix possible Security Vulnerability in Smarty\_Security class. |
|  |  |  |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[libs/Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54 "libs/Smarty.class.php")

Show comments

[View file](/smarty-php/smarty/blob/bcedfd6b58bed4a7366336979ebaa5a240581531/libs/Smarty.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,13 +21,13 @@ |
|  |  | \* smarty-discussion-subscribe@googlegroups.com |
|  |  | \* |
|  |  | \* @link http://www.smarty.net/ |
|  |  | \* @copyright 2017 New Digital Group, Inc. |
|  |  | \* @copyright 2017 Uwe Tews |
|  |  | \* @copyright 2018 New Digital Group, Inc. |
|  |  | \* @copyright 2018 Uwe Tews |
|  |  | \* @author Monte Ohrt <monte at ohrt dot com> |
|  |  | \* @author Uwe Tews |
|  |  | \* @author Uwe Tews <uwe dot tews at gmail dot com> |
|  |  | \* @author Rodney Rehm |
|  |  | \* @package Smarty |
|  |  | \* @version 3.1.32-dev |
|  |  | \* @version 3.1.32 |
|  |  | \*/ |
|  |  | /\*\* |
|  |  | \* set SMARTY\_DIR to absolute path to Smarty library files. |
| Expand Down  Expand Up | | @@ -112,7 +112,7 @@ class Smarty extends Smarty\_Internal\_TemplateBase |
|  |  | /\*\* |
|  |  | \* smarty version |
|  |  | \*/ |
|  |  | const SMARTY\_VERSION = '3.1.32-dev-46'; |
|  |  | const SMARTY\_VERSION = '3.1.32'; |
|  |  | /\*\* |
|  |  | \* define variable scopes |
|  |  | \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bcedfd6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581531) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_d9f7ef6a_20250125_002221.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 2618-3] smarty3 regression update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2618-3] smarty3 regression update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Wed, 20 Oct 2021 14:08:09 +0200
* *Message-id*: <[[🔎]](/msgid-search/16365e56d976f0a39f6a1fc40bfffe82dff7c968.camel%40debian.org) [16365e56d976f0a39f6a1fc40bfffe82dff7c968.camel@debian.org](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2618-3                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
October 20, 2021                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : smarty3
Version        : 3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u4
CVE ID	       : CVE-2018-13982
Debian Bug     : 989141

The security update of smarty3, the compiling PHP template engine, issued as
DLA 2618-1 introduced a regression in the smarty_security class when secure
directories are evaluated. Updated smarty3 packages are now available to
correct this issue.

For Debian 9 stretch, this problem has been fixed in version
3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u4.

We recommend that you upgrade your smarty3 packages.

For the detailed security status of smarty3 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/smarty3>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp6eFY7SVSky.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from github.com_7795f2cd_20250126_044552.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  716](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/bcedfd6b58bed4a7366336979ebaa5a240581531)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Release version 3.1.32

[Browse files](/smarty-php/smarty/tree/bcedfd6b58bed4a7366336979ebaa5a240581531)
Browse the repository at this point in the history

* Loading branch information

Uwe Tews
committed
Apr 24, 2018

1 parent
[216ada9](/smarty-php/smarty/commit/216ada91f3c72114164329bd33dea4a882adf776)

commit bcedfd6

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**6 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* change\_log.txt
  [change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391)
* libs

  + libs/Smarty.class.php
    [Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391 "change_log.txt")

Show comments

[View file](/smarty-php/smarty/blob/bcedfd6b58bed4a7366336979ebaa5a240581531/change_log.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,4 @@ |
|  |  | ﻿===== 3.1.32 - dev === |
|  |  | ﻿===== 3.1.32 ===== (24.04.2018) |
|  |  | 24.04.2018 |
|  |  | - bugfix possible Security Vulnerability in Smarty\_Security class. |
|  |  |  |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[libs/Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54 "libs/Smarty.class.php")

Show comments

[View file](/smarty-php/smarty/blob/bcedfd6b58bed4a7366336979ebaa5a240581531/libs/Smarty.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,13 +21,13 @@ |
|  |  | \* smarty-discussion-subscribe@googlegroups.com |
|  |  | \* |
|  |  | \* @link http://www.smarty.net/ |
|  |  | \* @copyright 2017 New Digital Group, Inc. |
|  |  | \* @copyright 2017 Uwe Tews |
|  |  | \* @copyright 2018 New Digital Group, Inc. |
|  |  | \* @copyright 2018 Uwe Tews |
|  |  | \* @author Monte Ohrt <monte at ohrt dot com> |
|  |  | \* @author Uwe Tews |
|  |  | \* @author Uwe Tews <uwe dot tews at gmail dot com> |
|  |  | \* @author Rodney Rehm |
|  |  | \* @package Smarty |
|  |  | \* @version 3.1.32-dev |
|  |  | \* @version 3.1.32 |
|  |  | \*/ |
|  |  | /\*\* |
|  |  | \* set SMARTY\_DIR to absolute path to Smarty library files. |
| Expand Down  Expand Up | | @@ -112,7 +112,7 @@ class Smarty extends Smarty\_Internal\_TemplateBase |
|  |  | /\*\* |
|  |  | \* smarty version |
|  |  | \*/ |
|  |  | const SMARTY\_VERSION = '3.1.32-dev-46'; |
|  |  | const SMARTY\_VERSION = '3.1.32'; |
|  |  | /\*\* |
|  |  | \* define variable scopes |
|  |  | \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bcedfd6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fbcedfd6b58bed4a7366336979ebaa5a240581) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f86c8642_20250125_002217.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fc9dbe1d08c081912d02bd851d1d1b6388f6133d1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fc9dbe1d08c081912d02bd851d1d1b6388f6133d1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  715](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/c9dbe1d08c081912d02bd851d1d1b6388f6133d1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

- bugfix regarding Security Vulnerability did not solve the problem u…

[Browse files](/smarty-php/smarty/tree/c9dbe1d08c081912d02bd851d1d1b6388f6133d1)
Browse the repository at this point in the history

```
…nder Linux
```

* Loading branch information

Uwe Tews
committed
Apr 26, 2018

1 parent
[2e081a5](/smarty-php/smarty/commit/2e081a51b1effddb23f87952959139ac62654d50)

commit c9dbe1d

Showing
**1 changed file**
with
**6 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[libs/sysplugins/smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb "libs/sysplugins/smarty_security.php")

Show comments

[View file](/smarty-php/smarty/blob/c9dbe1d08c081912d02bd851d1d1b6388f6133d1/libs/sysplugins/smarty_security.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -639,21 +639,25 @@ private function \_checkDir($filepath, $dirs) |
|  |  | { |
|  |  | $directory = dirname($this->smarty->\_realpath($filepath, true)) . DIRECTORY\_SEPARATOR; |
|  |  | $\_directory = array(); |
|  |  | while (true) { |
|  |  | if (!preg\_match('#[\\\\/][.][.][\\\\/]#',$directory)) { |
|  |  | while (true) { |
|  |  | // test if the directory is trusted |
|  |  | if (isset($dirs[ $directory ])) { |
|  |  | return $\_directory; |
|  |  | } |
|  |  | // abort if we've reached root |
|  |  | if (!preg\_match('#[\\\\/][^\\\\/]+[\\\\/]$#', $directory)) { |
|  |  | // give up |
|  |  | throw new SmartyException(sprintf('Smarty Security: not trusted file path \'%s\' ',$filepath)); |
|  |  | break; |
|  |  | } |
|  |  | // remember the directory to add it to \_resource\_dir in case we're successful |
|  |  | $\_directory[ $directory ] = true; |
|  |  | // bubble up one level |
|  |  | $directory = preg\_replace('#[\\\\/][^\\\\/]+[\\\\/]$#', DIRECTORY\_SEPARATOR, $directory); |
|  |  | } |
|  |  | } |
|  |  | // give up |
|  |  | throw new SmartyException(sprintf('Smarty Security: not trusted file path \'%s\' ',$filepath)); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c9dbe1d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Fc9dbe1d08c081912d02bd851d1d1b6388f6133d1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.smarty.net_6722a759_20250126_044551.html ===

[![Smarty Template Engine](/images/logo_print.gif)](/)

Smarty
[Home](/)

[What is Smarty?](/about_smarty)

[Why use it?](/why_use)

[Use Cases and Work Flow](/use_cases)

[Syntax Comparison](/syntax_comparison)

[Template Inheritance](/inheritance)

[Best Practices](/best_practices)

[Crash Course](/crash_course)

Resources
[Download](/download)

[Quick Install](/quick_install)

[Documentation](/documentation)

[Discussion](https://www.reddit.com/r/smarty)

[Mailing Lists](/mailinglists)

[Github](https://github.com/smarty-php/smarty)

[Example App](/sampleapp1)

Links
[www.php.net](http://www.php.net/)

[www.phpinsider.com](http://www.phpinsider.com/)

![](https://www.paypalobjects.com/en_US/i/scr/pixel.gif)

# Smarty Icon

You may use the Smarty logo according to the [trademark notice](/copyright).

![Smarty Template Engine](/images/icons/smarty_icon.gif)
![Smarty Template Engine](/images/icons/smarty-80x15.png)

For sponsorship, advertising, news or other inquiries, contact us at:

# Sites Using Smarty

[Japanese online casino.com known as JOC](https://xn--u9jxfraf9dygrh1cc8466k16c.com/)

[OnlineCasinosSpelen](https://nl.onlinecasinosspelen.com/)

[NonStopCasino.org](https://uk.nonstopcasino.org/non-gamstop-casinos/)

[UK CasinoGap.org](https://nongamstop.casinogap.org/)

[NonGamStopBets - Casinos for Brits](https://www.nongamstopbets.com/casinos-not-on-gamstop/)

[NZ Casino Deps](https://casinodeps.co.nz/)

# Advertisement

In 2020, you can expect countless new gambling sites to launch in Germany and the rest of Europe. Make sure to always read the [Online Casino Test](https://www.onlinecasinotest.com.de/) first before signing up with an operator.

The UK is expected to introduce additional measures to keep players safe when playing at online casinos for real money. [Casinostoplay.com](https://www.casinostoplay.com/) provides you with a complete overview as well as recommendations to the best British gambling sites.

In online gambling, a [casino bonus](https://www.toponlinecasinobonus.de/) is the be-all and end-all for good player experience. Make sure always to read the terms and choose a bonus with low wagering requirements and no payout restrictions.

Smarty 5.4.2, 4.5.5 Released! Nov 21, 2024

[5.4.2](https://github.com/smarty-php/smarty/releases/tag/v5.4.2)

[4.5.5](https://github.com/smarty-php/smarty/releases/tag/v4.5.5)

Smarty 5.4.1 Released! Aug 29, 2024

[5.4.1](https://github.com/smarty-php/smarty/releases/tag/v5.4.1)

v5.4.0, v4.5.4 released! Aug 14, 2024

[5.4.0](https://github.com/smarty-php/smarty/releases/tag/v5.4.0)

[4.5.4](https://github.com/smarty-php/smarty/releases/tag/v4.5.4)
PARTNERS

On [Casino.info](https://www.casino.info/) you can find the "best online casino usa" no deposit bonus codes. Try the leading online gaming software developers: Microgaming, Playtech, NetEnt and RTG Realtime Gaming software provider.

Compare Swedish casinos online on [casivo.se](https://www.casivo.se/)

Tired of bots and fake followers? Buy instagram followers from [Skweezer.net](https://skweezer.net/buy-instagram-followers).

Find a curated selection of the finest [casino non ADM/AAMS](https://nuovicasinoitalia.it/casino-non-aams) sites available to Italian players on NuoviCasinoItalia.it.

Are you looking to add a new twist to your online casino experience? Find your [new UK casino](https://newcasinouk.com/) on NewCasinoUK.com and enjoy tons of new offers, games and payment methods.

Discover all legit online casinos in Canada at [Casivo.ca](https://www.casivo.ca).

Find and compare every casino without Swedish license here at [Spelpressen](https://spelpressen.se/casino-reportage/casino-utan-svensk-licens). Read more!

Looking for the best online casino in New Zealand for real money? Find them at [Casinocrawlers.com](https://casinocrawlers.com/)

On NeueCasinos24.com the best [Free Spins gratis](https://neuecasinos24.com/casino-bonus/freispiele) offers can be found in 2022.

New payment methods as seen on Handycasinos24 enable [Online Casino sofort Auszahlung](https://handycasinos24.com/auszahlung) - an instant withdrawal regime for casinos online.

As for many things online, you wish not to take the next best thing, but scrutinize the offers thoroughly. MrCasinova.com does a proper [Online Casino](https://mrcasinova.com/de/) comparison to reveal the most valuable ones online.

No Limit play is very important for Online Casinos in Germany 2022. Test results of such [Online Casino ohne Limit](https://casinopilot24.com/casino-ohne-limit) can be seen at Casinopilot24.com.

Beim österreichischen [Casino Online](https://casinohex.at/online-casinos/) immer das tolle Spielen genießen!

[Casinopro offers boneses and freespins](https://casinopro.ca/) for Canadian players. Find out more about Canadian gambling scene, type of bonuses and casino games covered with top reviews from Casino experts.

Smarty 5.3.1 Released! Jun 16, 2024

[5.3.1](https://github.com/smarty-php/smarty/releases/tag/v5.3.1)

Smarty 4.5.3 released! May 30, 2024

Smarty 4.5.3 released!

[4.5.3](https://github.com/smarty-php/smarty/releases/tag/v4.5.3)

Smarty 5.3.0 released! May 30, 2024

Smarty 5.3.0 released!

[5.3.0](https://github.com/smarty-php/smarty/releases/tag/v5.3.0)

Smarty 5 Available! May 3, 2024

Smarty 5 is the latest major version, please see the [Releases](https://github.com/smarty-php/smarty/releases) on Github for details and downloads!

Smarty 4.5.2 released! Apr 5, 2024

Smarty 4.5.2 released!

[4.5.2](https://github.com/smarty-php/smarty/releases/tag/v4.5.2)

Smarty 5.0.2 released! Mar 28, 2024

Smarty 5.0.2 released!

[5.0.2](https://github.com/smarty-php/smarty/releases/tag/v5.0.2)

Smarty 4.3.2 released! Jul 19, 2023

Smarty 4.3.2 released!

[4.3.2](https://github.com/smarty-php/smarty/releases/tag/v4.3.2)

---

[older posts >>](/page2)

# Sponsors [[info]](/sponsors)

[pelisivut.com](https://www.pelisivut.com/)

[nettikasino.fi](https://www.nettikasino.fi/)

[nettikasinot.org](https://www.nettikasinot.org/)

[Buzzoid](https://buzzoid.com/buy-instagram-followers/)

[Twicsy](https://twicsy.com/buy-instagram-followers/)

[sure.bet](https://www.sure.bet/)

[Play online casino](https://EkstraPoint.com/)

[Bookmakers](https://www.voetbalgokken.nl/bookmakers/)

[BSV DevCon](https://tpow.app/4df1fd0c)

[Netticasinot](https://www.kasinohai.com/)

[Intetics - Software Development Company](https://Intetics.com)

[VPS Server](https://www.vpsserver.com/)

[credits](/credits)
[copyright](/copyright)

Smarty Copyright © 2002 – 2025 New Digital Group, Inc. All rights reserved.

This page generated in 0.00242 secs with [TinyMVC](http://www.tinymvc.com/) and Smarty 3.



=== Content from lists.debian.org_3a71ce45_20250125_002220.html ===


---

[[Date Prev](msg00013.html)][[Date Next](msg00015.html)]
[[Thread Prev](msg00013.html)][[Thread Next](msg00015.html)]
[[Date Index](maillist.html#00014)]
[[Thread Index](threads.html#00014)]

# [SECURITY] [DLA 2618-2] smarty3 regression update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2618-2] smarty3 regression update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Fri, 16 Apr 2021 13:24:10 +0530
* *Message-id*: <[[🔎]](/msgid-search/YHlCopzdsEDhCBF2%40disroot.org) [YHlCopzdsEDhCBF2@disroot.org](msg00014.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2618-2                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
April 16, 2021                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : smarty3
Version        : 3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u3
CVE ID         : CVE-2018-13982 CVE-2021-26119 CVE-2021-26120
Debian Bug     : 986691

The update of smarty3 released as DLA-2618-1 induced a regression due
to a syntax error in sysplugins/smarty_security.php.

For Debian 9 stretch, this problem has been fixed in version
3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u3.

We recommend that you upgrade your smarty3 packages.

For the detailed security status of smarty3 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/smarty3>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmB5QqEACgkQhj1N8u2c
KO8Shw//dIKkx32oaUPT/u1xkmIdE0rwC04CaSpY4Bp9XGueFieg1IJvpTPrHdAE
JM8DuFaQx5KymJtLBfVIdj4YFroTjID9Ke7GiYrJvSnRbH3lnFXXGl7uIOFKVXNT
nsTpG1LG8NSGvxNJSkU4lQJRerViXrmXPlGETH37cdcyNVIW5qowbuzj/gOE6xNZ
65idfCqdTKrfwebngxn4mteOF6lEiAoJouR3mo5BHsjUR/og8e2a4cRcPH9mTm/x
emn2QK9gqpB717Vfn2J/y5IYTP7x1n780eMrnJfmRzoOmH72Sl1GwQ67HO3EjrPH
hAUb30M6olN/J4CXWvR9NAue9jpBVyN/efKGn8JOYAYPfpzy+M6kq0RGRgICIGAN
HouVqXWL2WIYCeNfxTlpH2wUyZz3r7ah6iRiG/9/Sb51llL1rD0dI4mxgRXrQlNa
7fKgYVaJvIR6uC+beXTKZxjF0tdxoUiaQ43Ebwz5hMoDpcEBpnKsi9iuJ8LobCMD
3/On5fxk6dt6DOQbI1tu2+vVaI32gUJ8WcO/u6lTyK64bRmwUS780WUVom14Ukv8
P8v5M7rt2OFEpCxXoxrRUUD0nDxoZXv7BL+XHfjXXSpzHkvC6EhsHwrd0A+Zqnuv
ycMXt0JODjLayxjlE1txWfK5dCECkpPiMdjT/EYmFA7stka7S9g=
=6zg/
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_3645c648_20250125_002220.html ===


---

[[Date Prev](msg00003.html)][[Date Next](msg00005.html)]
[[Thread Prev](msg00003.html)][[Thread Next](msg00005.html)]
[[Date Index](maillist.html#00004)]
[[Thread Index](threads.html#00004)]

# [SECURITY] [DLA 2618-1] smarty3 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2618-1] smarty3 security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Mon, 5 Apr 2021 11:55:41 +0530
* *Message-id*: <YGqtZYpzxEY3WY0/@disroot.org>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2618-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
April 05, 2021                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : smarty3
Version        : 3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u2
CVE ID         : CVE-2018-13982 CVE-2021-26119 CVE-2021-26120

Several vulnerabilities were discovered in smarty3, a template engine
for PHP.

CVE-2018-13982

    path traversal vulnerability due to insufficient sanitization of
    code in Smarty templates. This allows attackers controlling the
    Smarty template to bypass the trusted directory security
    restriction and read arbitrary files.

CVE-2021-26119

    allows a Sandbox Escape because $smarty.template_object can be
    accessed in sandbox mode.

CVE-2021-26120

    allows code injection vulnerability via an unexpected function
    name after a {function name= substring.

For Debian 9 stretch, these problems have been fixed in version
3.1.31+20161214.1.c7d42e4+selfpack1-2+deb9u2.

We recommend that you upgrade your smarty3 packages.

For the detailed security status of smarty3 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/smarty3>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmBqrWUACgkQhj1N8u2c
KO/5WhAAgrJavMnnEpxHvZoj/4PQoAw4tPzOKPSGtMHHYTUaVkry29F83B6BlAgc
3mkchFwTqLICOBhUX08Ypj9YrVIvQt7dqw6n2sVq2MQNAVbaD04L7fiLFYXXSK5W
OwqO/itqDHD9vzYkeWvRHIfZJxdOI7psHt5gCvQaJ2d6z8SkXkQ2lhkCEYt3vro1
qDyNiWHiX61aoKsE9NQDQNG2BBn0CM8q9NTWjqaGEcp641yxI7QuUtUhY/EPYLYM
WQfQSoB0K/7VXfzo36WMofiI/yaVDaqR1HVoG2pKMQ1yDxJRDwWuuJk7wEOJwmbl
4aYmiyh/RR0G/LG5c0TKd7aXBQaT7h/H6XUxTs1em+whO2+DlJuvq4ruvFszDHzq
onapVtusfhfSOpBgZeplID0dLwTQZUD3bw8nqG+mzjnqhWlsfyLfUrj2qPzRbfIW
nyeGnRlCM9+5c9sKyQXjCvl1h+/MBhH60zIfTv2XQrB4Tq6siDd93zTMC4pULNZM
xOYRU8bxf1E5jF+YttDAV0vu4Bn2LKeNM5YIHTmhk/np+/69GSm7rBNtEqSCnnWQ
9ta1lhb9+k8W5gQ4A9oLQdpDFAgptArmYzYbSjM3Uglpt/nY+DvCfyb0qa69Ix8J
tZ8c5yruJQwguNz11C/8KDglDpMehYnWSWEWl3Loaj7DLA8hQa4=
=wDuK
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_411ba6ee_20250125_002219.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Ff9ca3c63d1250bb56b2bda609dcc9dd81f0065f8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Ff9ca3c63d1250bb56b2bda609dcc9dd81f0065f8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  715](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

- bugfix regarding Security Vulnerability did not solve the problem u…

[Browse files](/smarty-php/smarty/tree/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8)
Browse the repository at this point in the history

```
…nder Linux
```

* Loading branch information

Uwe Tews
committed
Apr 26, 2018

1 parent
[ac9d4b5](/smarty-php/smarty/commit/ac9d4b587e5bf53381e21881820a9830765cb459)

commit f9ca3c6

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**25 additions**
and
**36 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* change\_log.txt
  [change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391)
* libs

  + libs/Smarty.class.php
    [Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54)
  + sysplugins

    - libs/sysplugins/smarty\_security.php
      [smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391 "change_log.txt")

Show comments

[View file](/smarty-php/smarty/blob/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8/change_log.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,8 @@ |
|  |  | ﻿===== 3.1.32 ===== (24.04.2018) |
|  |  | ﻿===== 3.1.33-dev-1 ===== |
|  |  | 26.04.2018 |
|  |  | - bugfix regarding Security Vulnerability did not solve the problem under Linux. |
|  |  |  |
|  |  | ===== 3.1.32 ===== (24.04.2018) |
|  |  | 24.04.2018 |
|  |  | - bugfix possible Security Vulnerability in Smarty\_Security class. |
|  |  |  |
| Expand Down | |  |

21 changes: 8 additions & 13 deletions

21
[libs/Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54 "libs/Smarty.class.php")

Show comments

[View file](/smarty-php/smarty/blob/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8/libs/Smarty.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,7 +27,7 @@ |
|  |  | \* @author Uwe Tews <uwe dot tews at gmail dot com> |
|  |  | \* @author Rodney Rehm |
|  |  | \* @package Smarty |
|  |  | \* @version 3.1.32 |
|  |  | \* @version 3.1.33-dev |
|  |  | \*/ |
|  |  | /\*\* |
|  |  | \* set SMARTY\_DIR to absolute path to Smarty library files. |
| Expand Down  Expand Up | | @@ -112,7 +112,7 @@ class Smarty extends Smarty\_Internal\_TemplateBase |
|  |  | /\*\* |
|  |  | \* smarty version |
|  |  | \*/ |
|  |  | const SMARTY\_VERSION = '3.1.32'; |
|  |  | const SMARTY\_VERSION = '3.1.33-dev-1'; |
|  |  | /\*\* |
|  |  | \* define variable scopes |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -835,7 +835,7 @@ public function getPluginsDir() |
|  |  | $this->plugins\_dir = (array)$this->plugins\_dir; |
|  |  | } |
|  |  | foreach ($this->plugins\_dir as $k => $v) { |
|  |  | $this->plugins\_dir[ $k ] = $this->\_realpath(rtrim($v, "/\\") . DIRECTORY\_SEPARATOR, true); |
|  |  | $this->plugins\_dir[ $k ] = $this->\_realpath(rtrim($v, '/\\') . DIRECTORY\_SEPARATOR, true); |
|  |  | } |
|  |  | $this->\_cache[ 'plugin\_files' ] = array(); |
|  |  | $this->\_pluginsDirNormalized = true; |
| Expand Down  Expand Up | | @@ -1043,20 +1043,15 @@ public function \_getTemplateId($template\_name, |
|  |  | public function \_realpath($path, $realpath = null) |
|  |  | { |
|  |  | static $nds = null; |
|  |  | static $sepDotsep = null; |
|  |  | static $sepDot = null; |
|  |  | static $sepSep =null; |
|  |  | static $sepDotSep = null; |
|  |  | static $sepSep =null; |
|  |  | if (!isset($nds)) { |
|  |  | $nds = array('/' => '\\', '\\' => '/'); |
|  |  | $sepDotsep = DIRECTORY\_SEPARATOR . '.' . DIRECTORY\_SEPARATOR; |
|  |  | $sepDot = DIRECTORY\_SEPARATOR . '.'; |
|  |  | $sepDotSep = DIRECTORY\_SEPARATOR . '.' . DIRECTORY\_SEPARATOR; |
|  |  | $sepSep = DIRECTORY\_SEPARATOR . DIRECTORY\_SEPARATOR; |
|  |  | } |
|  |  | // normalize DIRECTORY\_SEPARATOR |
|  |  | $path = str\_replace(array($nds[DIRECTORY\_SEPARATOR], $sepDotsep), DIRECTORY\_SEPARATOR, $path); |
|  |  | if (strpos($path,$sepDot) === false && (($realpath === false && $path[0] === '.') || $realpath === null) && $path[0] !== '\\') { |
|  |  | return $path; |
|  |  | } |
|  |  | $path = str\_replace(array($nds[DIRECTORY\_SEPARATOR], $sepDotSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | preg\_match('%^(?<root>(?:[[:alpha:]]:[\\\\]|/|[\\\\]{2}[[:alpha:]]+|[[:print:]]{2,}:[/]{2}|[\\\\])?)(?<path>(.\*))$%u', |
|  |  | $path, |
|  |  | $parts); |
| Expand All | | @@ -1069,7 +1064,7 @@ public function \_realpath($path, $realpath = null) |
|  |  | } |
|  |  | } |
|  |  | // remove noop 'DIRECTORY\_SEPARATOR DIRECTORY\_SEPARATOR' and 'DIRECTORY\_SEPARATOR.DIRECTORY\_SEPARATOR' patterns |
|  |  | $path = str\_replace(array($sepDotsep,$sepSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | $path = str\_replace(array($sepDotSep,$sepSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | // resolve '..DIRECTORY\_SEPARATOR' pattern, smallest first |
|  |  | if (strpos($path, '..' . DIRECTORY\_SEPARATOR) !== false && |
|  |  | preg\_match\_all('#[\\\\/]([.][.][\\\\/])+#u', $path, $match) |
| Expand Down | |  |

34 changes: 12 additions & 22 deletions

34
[libs/sysplugins/smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb "libs/sysplugins/smarty_security.php")

Show comments

[View file](/smarty-php/smarty/blob/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8/libs/sysplugins/smarty_security.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -258,8 +258,6 @@ class Smarty\_Security |
|  |  | public function \_\_construct($smarty) |
|  |  | { |
|  |  | $this->smarty = $smarty; |
|  |  | $this->smarty->\_cache[ 'template\_dir\_new' ] = true; |
|  |  | $this->smarty->\_cache[ 'config\_dir\_new' ] = true; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -521,24 +519,23 @@ public function isTrustedResourceDir($filepath, $isConfig = null) |
|  |  | } |
|  |  | $this->\_include\_path\_status = $this->smarty->use\_include\_path; |
|  |  | } |
|  |  | if ($isConfig !== true) { |
|  |  |  |
|  |  | $\_dir = $this->smarty->getTemplateDir(); |
|  |  | if ($this->\_template\_dir !== $\_dir) { |
|  |  | $this->\_updateResourceDir($this->\_template\_dir, $\_dir); |
|  |  | $this->\_template\_dir = $\_dir; |
|  |  | } |
|  |  | } |
|  |  | if ($isConfig !== false) { |
|  |  |  |
|  |  | $\_dir = $this->smarty->getConfigDir(); |
|  |  | if ($this->\_config\_dir !== $\_dir) { |
|  |  | $this->\_updateResourceDir($this->\_config\_dir, $\_dir); |
|  |  | $this->\_config\_dir = $\_dir; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if ($this->\_secure\_dir !== $this->secure\_dir) { |
|  |  | $this->secure\_dir = (array)$this->secure\_dir; |
|  |  | foreach($this->secure\_dir as $k => $d) { |
|  |  | $this->secure\_dir[$k] = $this->smarty->\_realpath($d.DIRECTORY\_SEPARATOR,true); |
|  |  | $this->secure\_dir[$k] = $this->smarty->\_realpath($d. DIRECTORY\_SEPARATOR,true); |
|  |  | } |
|  |  | $this->\_updateResourceDir($this->\_secure\_dir, $this->secure\_dir); |
|  |  | $this->\_secure\_dir = $this->secure\_dir; |
| Expand Down  Expand Up | | @@ -597,7 +594,7 @@ public function isTrustedPHPDir($filepath) |
|  |  |  |
|  |  | $this->\_trusted\_dir = $this->trusted\_dir; |
|  |  | foreach ((array) $this->trusted\_dir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory . DIRECTORY\_SEPARATOR, true); |
|  |  | $directory = $this->smarty->\_realpath($directory . '/', true); |
|  |  | $this->\_php\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -616,7 +613,7 @@ public function isTrustedPHPDir($filepath) |
|  |  | \*/ |
|  |  | private function \_updateResourceDir($oldDir, $newDir) { |
|  |  | foreach ($oldDir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory, true); |
|  |  | // $directory = $this->smarty->\_realpath($directory, true); |
|  |  | $length = strlen($directory); |
|  |  | foreach ($this->\_resource\_dir as $dir) { |
|  |  | if (substr($dir, 0,$length) === $directory) { |
| Expand All | | @@ -625,7 +622,7 @@ private function \_updateResourceDir($oldDir, $newDir) { |
|  |  | } |
|  |  | } |
|  |  | foreach ($newDir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory, true); |
|  |  | // $directory = $this->smarty->\_realpath($directory, true); |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -640,30 +637,23 @@ private function \_updateResourceDir($oldDir, $newDir) { |
|  |  | \*/ |
|  |  | private function \_checkDir($filepath, $dirs) |
|  |  | { |
|  |  | $directory = dirname($filepath) . DIRECTORY\_SEPARATOR; |
|  |  | if (isset($dirs[ $directory ])) { |
|  |  | return false; |
|  |  | } |
|  |  | $filepath = $this->smarty->\_realpath($filepath, true); |
|  |  | $directory = dirname($filepath) . DIRECTORY\_SEPARATOR; |
|  |  | $directory = dirname($this->smarty->\_realpath($filepath, true)) . DIRECTORY\_SEPARATOR; |
|  |  | $\_directory = array(); |
|  |  | while (true) { |
|  |  | // test if the directory is trusted |
|  |  | if (isset($dirs[ $directory ])) { |
|  |  | return $\_directory; |
|  |  | } |
|  |  | // abort if we've reached root |
|  |  | if (!preg\_match('#[\\\/][^\\\/]+[\\\/]$#', $directory)) { |
|  |  | break; |
|  |  | if (!preg\_match('#[\\\\/][^\\\\/]+[\\\\/]$#', $directory)) { |
|  |  | // give up |
|  |  | throw new SmartyException(sprintf('Smarty Security: not trusted file path \'%s\' ',$filepath)); |
|  |  | } |
|  |  | // remember the directory to add it to \_resource\_dir in case we're successful |
|  |  | $\_directory[ $directory ] = true; |
|  |  | // bubble up one level |
|  |  | $directory = preg\_replace('#[\\\/][^\\\/]+[\\\/]$#', DIRECTORY\_SEPARATOR, $directory); |
|  |  | $directory = preg\_replace('#[\\\\/][^\\\\/]+[\\\\/]$#', '/', $directory); |
|  |  | } |
|  |  |  |
|  |  | // give up |
|  |  | throw new SmartyException("directory '{$filepath}' not allowed by security setting"); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f9ca3c6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2Ff9ca3c63d1250bb56b2bda609dcc9dd81f0065f8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e7b328a1_20250125_002215.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  715](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

- bugfix possible Security Vulnerability in Smarty\_Security class.

[Browse files](/smarty-php/smarty/tree/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe)
Browse the repository at this point in the history

* Loading branch information

Uwe Tews
committed
Apr 24, 2018

1 parent
[fbbb292](/smarty-php/smarty/commit/fbbb292ef051644dd6cd81231531249ca2c10d18)

commit 8d21f38

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**73 additions**
and
**61 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* change\_log.txt
  [change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391)
* libs

  + libs/Smarty.class.php
    [Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54)
  + sysplugins

    - libs/sysplugins/smarty\_security.php
      [smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[change\_log.txt](#diff-2588690fc69c5b318ab79a3495d58a999a81629d7e8ba4e08b8c0bcb7cb92391 "change_log.txt")

Show comments

[View file](/smarty-php/smarty/blob/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe/change_log.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,7 @@ |
|  |  | ﻿===== 3.1.32 - dev === |
|  |  | 24.04.2018 |
|  |  | - bugfix possible Security Vulnerability in Smarty\_Security class. |
|  |  |  |
|  |  | 26.03.2018 |
|  |  | - bugfix plugins may not be loaded if {function} or {block} tags are executed in nocache mode |
|  |  | https://github.com/smarty-php/smarty/issues/371 |
| Expand Down | |  |

24 changes: 15 additions & 9 deletions

24
[libs/Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54 "libs/Smarty.class.php")

Show comments

[View file](/smarty-php/smarty/blob/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe/libs/Smarty.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -112,7 +112,7 @@ class Smarty extends Smarty\_Internal\_TemplateBase |
|  |  | /\*\* |
|  |  | \* smarty version |
|  |  | \*/ |
|  |  | const SMARTY\_VERSION = '3.1.32-dev-45'; |
|  |  | const SMARTY\_VERSION = '3.1.32-dev-46'; |
|  |  | /\*\* |
|  |  | \* define variable scopes |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -1042,9 +1042,15 @@ public function \_getTemplateId($template\_name, |
|  |  | \*/ |
|  |  | public function \_realpath($path, $realpath = null) |
|  |  | { |
|  |  | $nds = DIRECTORY\_SEPARATOR === '/' ? '\\' : '/'; |
|  |  | static $nds = array('/' => '\\', '\\' => '/'); |
|  |  | static $sepDotsep = DIRECTORY\_SEPARATOR . '.' . DIRECTORY\_SEPARATOR; |
|  |  | static $sepDot = DIRECTORY\_SEPARATOR . '.'; |
|  |  | static $sepSep = DIRECTORY\_SEPARATOR . DIRECTORY\_SEPARATOR; |
|  |  | // normalize DIRECTORY\_SEPARATOR |
|  |  | $path = str\_replace($nds, DIRECTORY\_SEPARATOR, $path); |
|  |  | $path = str\_replace(array($nds[DIRECTORY\_SEPARATOR], $sepDotsep), DIRECTORY\_SEPARATOR, $path); |
|  |  | if (strpos($path,$sepDot) === false && (($realpath === false && $path[0] === '.') || $realpath === null) && $path[0] !== '\\') { |
|  |  | return $path; |
|  |  | } |
|  |  | preg\_match('%^(?<root>(?:[[:alpha:]]:[\\\\]|/|[\\\\]{2}[[:alpha:]]+|[[:print:]]{2,}:[/]{2}|[\\\\])?)(?<path>(.\*))$%u', |
|  |  | $path, |
|  |  | $parts); |
| Expand All | | @@ -1056,25 +1062,25 @@ public function \_realpath($path, $realpath = null) |
|  |  | $path = getcwd() . DIRECTORY\_SEPARATOR . $path; |
|  |  | } |
|  |  | } |
|  |  | // remove noop 'DIRECTORY\_SEPARATOR DIRECTORY\_SEPARATOR' and 'DIRECTORY\_SEPARATOR.DIRECTORY\_SEPARATOR' patterns |
|  |  | $path = preg\_replace('#([\\\\/]([.]?[\\\\/])+)#u', DIRECTORY\_SEPARATOR, $path); |
|  |  | // remove noop 'DIRECTORY\_SEPARATOR DIRECTORY\_SEPARATOR' and 'DIRECTORY\_SEPARATOR.DIRECTORY\_SEPARATOR' patterns |
|  |  | $path = str\_replace(array($sepDotsep,$sepSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | // resolve '..DIRECTORY\_SEPARATOR' pattern, smallest first |
|  |  | if (strpos($path, '..' . DIRECTORY\_SEPARATOR) !== false && |
|  |  | preg\_match\_all('#(([.]?[\\\\/])\*([.][.])[\\\\/]([.]?[\\\\/])\*)+#u', $path, $match) |
|  |  | preg\_match\_all('#[\\\\/]([.][.][\\\\/])+#u', $path, $match) |
|  |  | ) { |
|  |  | $counts = array(); |
|  |  | foreach ($match[ 0 ] as $m) { |
|  |  | $counts[] = (int)((strlen($m) - 1) / 3); |
|  |  | } |
|  |  | sort($counts); |
|  |  | foreach ($counts as $count) { |
|  |  | $path = preg\_replace('#(([\\\\/]([.]?[\\\\/])\*[^\\\\/.]+){' . $count . |
|  |  | '}[\\\\/]([.]?[\\\\/])\*([.][.][\\\\/]([.]?[\\\\/])\*){' . $count . '})(?=[^.])#u', |
|  |  | $path = preg\_replace('#([\\\\/]+[^\\\\/]+){' . $count . |
|  |  | '}[\\\\/]+([.][.][\\\\/]+){' . $count . '}#u', |
|  |  | DIRECTORY\_SEPARATOR, |
|  |  | $path); |
|  |  | } |
|  |  | } |
|  |  | return $parts[ 'root' ] . $path; |
|  |  | return $realpath !== false ? $parts[ 'root' ] . $path : str\_ireplace(getcwd(), '.', $parts[ 'root' ] . $path); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

107 changes: 55 additions & 52 deletions

107
[libs/sysplugins/smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb "libs/sysplugins/smarty_security.php")

Show comments

[View file](/smarty-php/smarty/blob/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe/libs/sysplugins/smarty_security.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -514,60 +514,39 @@ public function isTrustedStream($stream\_name) |
|  |  | public function isTrustedResourceDir($filepath, $isConfig = null) |
|  |  | { |
|  |  | if ($this->\_include\_path\_status !== $this->smarty->use\_include\_path) { |
|  |  | foreach ($this->\_include\_dir as $directory) { |
|  |  | unset($this->\_resource\_dir[ $directory ]); |
|  |  | } |
|  |  | if ($this->smarty->use\_include\_path) { |
|  |  | $this->\_include\_dir = array(); |
|  |  | $\_dirs = $this->smarty->ext->\_getIncludePath->getIncludePathDirs($this->smarty); |
|  |  | foreach ($\_dirs as $directory) { |
|  |  | $this->\_include\_dir[] = $directory; |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | $\_dir = $this->smarty->use\_include\_path ? $this->smarty->ext->\_getIncludePath->getIncludePathDirs($this->smarty) : array(); |
|  |  | if ($this->\_include\_dir !== $\_dir) { |
|  |  | $this->\_updateResourceDir($this->\_include\_dir, $\_dir); |
|  |  | $this->\_include\_dir = $\_dir; |
|  |  | } |
|  |  | $this->\_include\_path\_status = $this->smarty->use\_include\_path; |
|  |  | } |
|  |  | if ($isConfig !== true && |
|  |  | (!isset($this->smarty->\_cache[ 'template\_dir\_new' ]) || $this->smarty->\_cache[ 'template\_dir\_new' ]) |
|  |  | ) { |
|  |  | if ($isConfig !== true) { |
|  |  | $\_dir = $this->smarty->getTemplateDir(); |
|  |  | if ($this->\_template\_dir !== $\_dir) { |
|  |  | foreach ($this->\_template\_dir as $directory) { |
|  |  | unset($this->\_resource\_dir[ $directory ]); |
|  |  | } |
|  |  | foreach ($\_dir as $directory) { |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | $this->\_updateResourceDir($this->\_template\_dir, $\_dir); |
|  |  | $this->\_template\_dir = $\_dir; |
|  |  | } |
|  |  | $this->smarty->\_cache[ 'template\_dir\_new' ] = false; |
|  |  | } |
|  |  | if ($isConfig !== false && |
|  |  | (!isset($this->smarty->\_cache[ 'config\_dir\_new' ]) || $this->smarty->\_cache[ 'config\_dir\_new' ]) |
|  |  | ) { |
|  |  | if ($isConfig !== false) { |
|  |  | $\_dir = $this->smarty->getConfigDir(); |
|  |  | if ($this->\_config\_dir !== $\_dir) { |
|  |  | foreach ($this->\_config\_dir as $directory) { |
|  |  | unset($this->\_resource\_dir[ $directory ]); |
|  |  | } |
|  |  | foreach ($\_dir as $directory) { |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | $this->\_updateResourceDir($this->\_config\_dir, $\_dir); |
|  |  | $this->\_config\_dir = $\_dir; |
|  |  | } |
|  |  | $this->smarty->\_cache[ 'config\_dir\_new' ] = false; |
|  |  | } |
|  |  | if ($this->\_secure\_dir !== (array) $this->secure\_dir) { |
|  |  | foreach ($this->\_secure\_dir as $directory) { |
|  |  | unset($this->\_resource\_dir[ $directory ]); |
|  |  | if ($this->\_secure\_dir !== $this->secure\_dir) { |
|  |  | $this->secure\_dir = (array)$this->secure\_dir; |
|  |  | foreach($this->secure\_dir as $k => $d) { |
|  |  | $this->secure\_dir[$k] = $this->smarty->\_realpath($d.DIRECTORY\_SEPARATOR,true); |
|  |  | } |
|  |  | foreach ((array) $this->secure\_dir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory . DIRECTORY\_SEPARATOR, true); |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | $this->\_secure\_dir = (array) $this->secure\_dir; |
|  |  | $this->\_updateResourceDir($this->\_secure\_dir, $this->secure\_dir); |
|  |  | $this->\_secure\_dir = $this->secure\_dir; |
|  |  | } |
|  |  | $addPath = $this->\_checkDir($filepath, $this->\_resource\_dir); |
|  |  | if ($addPath !== false) { |
|  |  | $this->\_resource\_dir = array\_merge($this->\_resource\_dir, $addPath); |
|  |  | } |
|  |  | $this->\_resource\_dir = $this->\_checkDir($filepath, $this->\_resource\_dir); |
|  |  | return true; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -622,40 +601,64 @@ public function isTrustedPHPDir($filepath) |
|  |  | $this->\_php\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | $this->\_php\_resource\_dir = |
|  |  | $this->\_checkDir($this->smarty->\_realpath($filepath, true), $this->\_php\_resource\_dir); |
|  |  | return true; |
|  |  | $addPath = $this->\_checkDir($filepath, $this->\_php\_resource\_dir); |
|  |  | if ($addPath !== false) { |
|  |  | $this->\_php\_resource\_dir = array\_merge($this->\_php\_resource\_dir, $addPath); |
|  |  | } |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Remove old directories and its sub folders, add new directories |
|  |  | \* |
|  |  | \* @param array $oldDir |
|  |  | \* @param array $newDir |
|  |  | \*/ |
|  |  | private function \_updateResourceDir($oldDir, $newDir) { |
|  |  | foreach ($oldDir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory, true); |
|  |  | $length = strlen($directory); |
|  |  | foreach ($this->\_resource\_dir as $dir) { |
|  |  | if (substr($dir, 0,$length) === $directory) { |
|  |  | unset($this->\_resource\_dir[ $dir ]); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | foreach ($newDir as $directory) { |
|  |  | $directory = $this->smarty->\_realpath($directory, true); |
|  |  | $this->\_resource\_dir[ $directory ] = true; |
|  |  | } |
|  |  | } |
|  |  | /\*\* |
|  |  | \* Check if file is inside a valid directory |
|  |  | \* |
|  |  | \* @param string $filepath |
|  |  | \* @param array $dirs valid directories |
|  |  | \* |
|  |  | \* @return array |
|  |  | \* @return array|bool |
|  |  | \* @throws \SmartyException |
|  |  | \*/ |
|  |  | private function \_checkDir($filepath, $dirs) |
|  |  | { |
|  |  | $directory = dirname($filepath) . DIRECTORY\_SEPARATOR; |
|  |  | if (isset($dirs[ $directory ])) { |
|  |  | return false; |
|  |  | } |
|  |  | $filepath = $this->smarty->\_realpath($filepath, true); |
|  |  | $directory = dirname($filepath) . DIRECTORY\_SEPARATOR; |
|  |  | $\_directory = array(); |
|  |  | while (true) { |
|  |  | // remember the directory to add it to \_resource\_dir in case we're successful |
|  |  | $\_directory[ $directory ] = true; |
|  |  | // test if the directory is trusted |
|  |  | // test if the directory is trusted |
|  |  | if (isset($dirs[ $directory ])) { |
|  |  | // merge sub directories of current $directory into \_resource\_dir to speed up subsequent lookup |
|  |  | $dirs = array\_merge($dirs, $\_directory); |
|  |  |  |
|  |  | return $dirs; |
|  |  | return $\_directory; |
|  |  | } |
|  |  | // abort if we've reached root |
|  |  | if (!preg\_match('#[\\\/][^\\\/]+[\\\/]$#', $directory)) { |
|  |  | break; |
|  |  | } |
|  |  | // bubble up one level |
|  |  | // remember the directory to add it to \_resource\_dir in case we're successful |
|  |  | $\_directory[ $directory ] = true; |
|  |  | // bubble up one level |
|  |  | $directory = preg\_replace('#[\\\/][^\\\/]+[\\\/]$#', DIRECTORY\_SEPARATOR, $directory); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8d21f38`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_af7020dd_20250125_002212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsbaresearch%2Fadvisories%2Ftree%2Fpublic%2F2018%2FSBA-ADV-20180420-01_Smarty_Path_Traversal)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsbaresearch%2Fadvisories%2Ftree%2Fpublic%2F2018%2FSBA-ADV-20180420-01_Smarty_Path_Traversal)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=sbaresearch%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sbaresearch](/sbaresearch)
/
**[advisories](/sbaresearch/advisories)**
Public

* [Notifications](/login?return_to=%2Fsbaresearch%2Fadvisories) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fsbaresearch%2Fadvisories)
* [Star
   22](/login?return_to=%2Fsbaresearch%2Fadvisories)

* [Code](/sbaresearch/advisories)
* [Issues
  0](/sbaresearch/advisories/issues)
* [Pull requests
  0](/sbaresearch/advisories/pulls)
* [Actions](/sbaresearch/advisories/actions)
* [Projects
  0](/sbaresearch/advisories/projects)
* [Security](/sbaresearch/advisories/security)
* [Insights](/sbaresearch/advisories/pulse)

Additional navigation options

* [Code](/sbaresearch/advisories)
* [Issues](/sbaresearch/advisories/issues)
* [Pull requests](/sbaresearch/advisories/pulls)
* [Actions](/sbaresearch/advisories/actions)
* [Projects](/sbaresearch/advisories/projects)
* [Security](/sbaresearch/advisories/security)
* [Insights](/sbaresearch/advisories/pulse)

## Files

 public
## Breadcrumbs

1. [advisories](/sbaresearch/advisories/tree/public)
2. /[2018](/sbaresearch/advisories/tree/public/2018)
/
# SBA-ADV-20180420-01\_Smarty\_Path\_Traversal

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/sbaresearch/advisories/commits/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal) public
## Breadcrumbs

1. [advisories](/sbaresearch/advisories/tree/public)
2. /[2018](/sbaresearch/advisories/tree/public/2018)
/
# SBA-ADV-20180420-01\_Smarty\_Path\_Traversal

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/sbaresearch/advisories/tree/public/2018) | | |
| [README.md](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/README.md "README.md") | | [README.md](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/README.md "README.md") |  |  |
| [composer.json](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/composer.json "composer.json") | | [composer.json](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/composer.json "composer.json") |  |  |
| [poc.php](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/poc.php "poc.php") | | [poc.php](/sbaresearch/advisories/blob/public/2018/SBA-ADV-20180420-01_Smarty_Path_Traversal/poc.php "poc.php") |  |  |
| View all files | | |

## [README.md](#readme)

# Smarty Trusted-Directory Bypass via Path Traversal

## Vulnerability Overview

Smarty 3.1.32 or below is prone to a path traversal vulnerability due
to insufficient sanitization of code in Smarty templates. This allows
attackers controlling the Smarty template to bypass the trusted
directory security restriction and read arbitrary files.

* **Identifier** : SBA-ADV-20180420-01
* **Type of Vulnerability** : Path Traversal
* **Software/Product Name** : [Smarty](https://www.smarty.net/)
* **Vendor** : Smarty
* **Affected Versions** : 3.1.32 and probably prior
* **Fixed in Version** : 3.1.33
* **CVE ID** : CVE-2018-13982
* **CVSSv3 Vector** : CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
* **CVSSv3 Base Score** : 8.6 (High)

## Vendor Description

> Smarty is a template engine for PHP, facilitating the separation of
> presentation (HTML/CSS) from application logic. This implies that PHP
> code is application logic, and is separated from the presentation.

Source: <https://www.smarty.net/about_smarty>

## Impact

An attacker controlling the executed template code can read arbitrary
files accessible by the webserver by exploiting the vulnerability
documented in this advisory. Sensitive data such as database credentials
might get exposed through this attack.

We recommend upgrading to version 3.1.33 or newer.

## Vulnerability Description

Smarty allows restricting which paths are accessible paths during
template evaluation. This feature is implemented in the
`Smarty_Security` class and is enabled via the method `enableSecurity`.
However, the trusted directory check implemented in the method
`isTrustedResourceDir` of the `Smarty_Security` class is vulnerable to
path traversal.

The method `isTrustedResourceDir` first builds a list of allowed
directories in `$filepath` and then relies on the `_checkDir` method
to check if the requested resource dir is trusted. In version 0.3.31
neither `isTrustedResourceDir` nor `_checkDir` avoid path traversal:

```
public function isTrustedResourceDir($filepath, $isConfig = null)
{
    [...]
    $this->_resource_dir = $this->_checkDir($filepath, $this->_resource_dir);
    return true;
}

private function _checkDir($filepath, $dirs)
{
    $directory = dirname($filepath) . DIRECTORY_SEPARATOR;
    $_directory = array();
    while (true) {
        // remember the directory to add it to _resource_dir in case we're successful
        $_directory[ $directory ] = true;
        // test if the directory is trusted
        if (isset($dirs[ $directory ])) {
            // merge sub directories of current $directory into _resource_dir to speed up subsequent lookup
            $dirs = array_merge($dirs, $_directory);
            return $dirs;
        }
        // abort if we've reached root
        if (!preg_match('#[\\\/][^\\\/]+[\\\/]$#', $directory)) {
            break;
        }
        // bubble up one level
        $directory = preg_replace('#[\\\/][^\\\/]+[\\\/]$#', DIRECTORY_SEPARATOR, $directory);
    }
    // give up
    throw new SmartyException("directory '{$filepath}' not allowed by security setting");
}
```

In version 0.3.32 `_checkDir` calls `_realpath` before checking if the
requested resource is trusted. However, the custom realpath method is
broken and allows path traversal at least on Unix systems.

For example, the fetch tag uses the `isTrustedResourceDir` method to
check if a user-specified path is allowed to read.

## Proof-of-Concept

An attacker can exploit this vulnerability by using the fetch tag:

```
{fetch file="/var/www/templates/../../../../../etc/passwd"}
```

Full example:

```
<?php
require_once "vendor/autoload.php";

$smarty = new Smarty;
$smarty->enableSecurity();
// Fails
//$smarty->display('eval:{fetch file="/etc/passwd"}');
// Works
$smarty->display('eval:{fetch file="'.addslashes(getcwd()).'/templates/../../../../../etc/passwd"}');
```

## Timeline

* `2018-04-20`: identification of vulnerability in version 3.1.31
* `2018-04-23`: initial vendor contact
* `2018-04-23`: disclosed vulnerability to vendor
* `2018-04-24`: vendor acknowledged vulnerability and released version 3.1.32
* `2018-04-25`: notified vendor about incomplete fix
* `2018-04-26`: vendor fixed vulnerability
* `2018-07-10`: request CVE from MITRE
* `2018-07-11`: MITRE assigned CVE-2018-13982
* `2018-09-12`: vendor released fix in version 3.1.33
* `2018-09-17`: public disclosure

## References

* Changelog: <https://github.com/smarty-php/smarty/commit/bcedfd6b58bed4a7366336979ebaa5a240581531>
* Patches:
  + <https://github.com/smarty-php/smarty/commit/8d21f38dc35c4cd6b31c2f23fc9b8e5adbc56dfe>
  + <https://github.com/smarty-php/smarty/commit/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8>
  + <https://github.com/smarty-php/smarty/commit/2e081a51b1effddb23f87952959139ac62654d50>
  + <https://github.com/smarty-php/smarty/commit/c9dbe1d08c081912d02bd851d1d1b6388f6133d1>

## Credits

* David Gnedt ([SBA Research](https://www.sba-research.org/))
* Thomas Konrad ([SBA Research](https://www.sba-research.org/))

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_68df403f_20250125_002213.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F2e081a51b1effddb23f87952959139ac62654d50)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F2e081a51b1effddb23f87952959139ac62654d50)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=smarty-php%2Fsmarty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[smarty-php](/smarty-php)
/
**[smarty](/smarty-php/smarty)**
Public

* [Notifications](/login?return_to=%2Fsmarty-php%2Fsmarty) You must be signed in to change notification settings
* [Fork
  715](/login?return_to=%2Fsmarty-php%2Fsmarty)
* [Star
   2.3k](/login?return_to=%2Fsmarty-php%2Fsmarty)

* [Code](/smarty-php/smarty)
* [Issues
  66](/smarty-php/smarty/issues)
* [Pull requests
  18](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects
  0](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

Additional navigation options

* [Code](/smarty-php/smarty)
* [Issues](/smarty-php/smarty/issues)
* [Pull requests](/smarty-php/smarty/pulls)
* [Discussions](/smarty-php/smarty/discussions)
* [Actions](/smarty-php/smarty/actions)
* [Projects](/smarty-php/smarty/projects)
* [Wiki](/smarty-php/smarty/wiki)
* [Security](/smarty-php/smarty/security)
* [Insights](/smarty-php/smarty/pulse)

## Commit

[Permalink](/smarty-php/smarty/commit/2e081a51b1effddb23f87952959139ac62654d50)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

- bugfix regarding Security Vulnerability did not solve the problem u…

[Browse files](/smarty-php/smarty/tree/2e081a51b1effddb23f87952959139ac62654d50)
Browse the repository at this point in the history

```
…nder Linux
```

* Loading branch information

Uwe Tews
committed
Apr 26, 2018

1 parent
[f9ca3c6](/smarty-php/smarty/commit/f9ca3c63d1250bb56b2bda609dcc9dd81f0065f8)

commit 2e081a5

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**13 additions**
and
**33 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* libs

  + libs/Smarty.class.php
    [Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54)
  + sysplugins

    - libs/sysplugins/smarty\_security.php
      [smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb)

## There are no files selected for viewing

44 changes: 12 additions & 32 deletions

44
[libs/Smarty.class.php](#diff-73711bc25e31428fbcc062184ff58a2fc5a9042c18a0c739eb9381b1366bbb54 "libs/Smarty.class.php")

Show comments

[View file](/smarty-php/smarty/blob/2e081a51b1effddb23f87952959139ac62654d50/libs/Smarty.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1042,16 +1042,9 @@ public function \_getTemplateId($template\_name, |
|  |  | \*/ |
|  |  | public function \_realpath($path, $realpath = null) |
|  |  | { |
|  |  | static $nds = null; |
|  |  | static $sepDotSep = null; |
|  |  | static $sepSep =null; |
|  |  | if (!isset($nds)) { |
|  |  | $nds = array('/' => '\\', '\\' => '/'); |
|  |  | $sepDotSep = DIRECTORY\_SEPARATOR . '.' . DIRECTORY\_SEPARATOR; |
|  |  | $sepSep = DIRECTORY\_SEPARATOR . DIRECTORY\_SEPARATOR; |
|  |  | } |
|  |  | $nds = array('/' => '\\', '\\' => '/'); |
|  |  | // normalize DIRECTORY\_SEPARATOR |
|  |  | $path = str\_replace(array($nds[DIRECTORY\_SEPARATOR], $sepDotSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | $path = str\_replace(array($nds[DIRECTORY\_SEPARATOR], DIRECTORY\_SEPARATOR . '.' . DIRECTORY\_SEPARATOR), DIRECTORY\_SEPARATOR, $path); |
|  |  | preg\_match('%^(?<root>(?:[[:alpha:]]:[\\\\]|/|[\\\\]{2}[[:alpha:]]+|[[:print:]]{2,}:[/]{2}|[\\\\])?)(?<path>(.\*))$%u', |
|  |  | $path, |
|  |  | $parts); |
| Expand All | | @@ -1063,24 +1056,11 @@ public function \_realpath($path, $realpath = null) |
|  |  | $path = getcwd() . DIRECTORY\_SEPARATOR . $path; |
|  |  | } |
|  |  | } |
|  |  | // remove noop 'DIRECTORY\_SEPARATOR DIRECTORY\_SEPARATOR' and 'DIRECTORY\_SEPARATOR.DIRECTORY\_SEPARATOR' patterns |
|  |  | $path = str\_replace(array($sepDotSep,$sepSep), DIRECTORY\_SEPARATOR, $path); |
|  |  | // resolve '..DIRECTORY\_SEPARATOR' pattern, smallest first |
|  |  | if (strpos($path, '..' . DIRECTORY\_SEPARATOR) !== false && |
|  |  | preg\_match\_all('#[\\\\/]([.][.][\\\\/])+#u', $path, $match) |
|  |  | ) { |
|  |  | $counts = array(); |
|  |  | foreach ($match[ 0 ] as $m) { |
|  |  | $counts[] = (int)((strlen($m) - 1) / 3); |
|  |  | } |
|  |  | sort($counts); |
|  |  | foreach ($counts as $count) { |
|  |  | $path = preg\_replace('#([\\\\/]+[^\\\\/]+){' . $count . |
|  |  | '}[\\\\/]+([.][.][\\\\/]+){' . $count . '}#u', |
|  |  | DIRECTORY\_SEPARATOR, |
|  |  | $path); |
|  |  | } |
|  |  | } |
|  |  | do { |
|  |  | $path = preg\_replace( |
|  |  | array('#[\\\\/]{2}#', '#[\\\\/][.][\\\\/]#', '#[\\\\/]([^\\\\/.]+)[\\\\/][.][.][\\\\/]#'), |
|  |  | DIRECTORY\_SEPARATOR, $path, -1, $count); |
|  |  | } while($count > 0); |
|  |  | return $realpath !== false ? $parts[ 'root' ] . $path : str\_ireplace(getcwd(), '.', $parts[ 'root' ] . $path); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1284,13 +1264,13 @@ public function \_\_get($name) |
|  |  | if (isset($this->accessMap[ $name ])) { |
|  |  | $method = 'get' . $this->accessMap[ $name ]; |
|  |  | return $this->{$method}(); |
|  |  | } else if (isset($this->\_cache[ $name ])) { |
|  |  | } else {if (isset($this->\_cache[ $name ])) { |
|  |  | return $this->\_cache[ $name ]; |
|  |  | } else if (in\_array($name, $this->obsoleteProperties)) { |
|  |  | } else {if (in\_array($name, $this->obsoleteProperties)) { |
|  |  | return null; |
|  |  | } else { |
|  |  | trigger\_error('Undefined property: ' . get\_class($this) . '::$' . $name, E\_USER\_NOTICE); |
|  |  | } |
|  |  | }}} |
|  |  | return null; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -1309,15 +1289,15 @@ public function \_\_set($name, $value) |
|  |  | if (isset($this->accessMap[ $name ])) { |
|  |  | $method = 'set' . $this->accessMap[ $name ]; |
|  |  | $this->{$method}($value); |
|  |  | } else if (in\_array($name, $this->obsoleteProperties)) { |
|  |  | } else {if (in\_array($name, $this->obsoleteProperties)) { |
|  |  | return; |
|  |  | } else { |
|  |  | if (is\_object($value) && method\_exists($value, $name)) { |
|  |  | $this->$name = $value; |
|  |  | } else { |
|  |  | trigger\_error('Undefined property: ' . get\_class($this) . '::$' . $name, E\_USER\_NOTICE); |
|  |  | } |
|  |  | } |
|  |  | }} |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[libs/sysplugins/smarty\_security.php](#diff-48a911bb35e9ec7a02fe37179867298f9744bdefcf327646e63a61926aabceeb "libs/sysplugins/smarty_security.php")

Show comments

[View file](/smarty-php/smarty/blob/2e081a51b1effddb23f87952959139ac62654d50/libs/sysplugins/smarty_security.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -652,7 +652,7 @@ private function \_checkDir($filepath, $dirs) |
|  |  | // remember the directory to add it to \_resource\_dir in case we're successful |
|  |  | $\_directory[ $directory ] = true; |
|  |  | // bubble up one level |
|  |  | $directory = preg\_replace('#[\\\\/][^\\\\/]+[\\\\/]$#', '/', $directory); |
|  |  | $directory = preg\_replace('#[\\\\/][^\\\\/]+[\\\\/]$#', DIRECTORY\_SEPARATOR, $directory); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2e081a5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fcommit%2F2e081a51b1effddb23f87952959139ac62654d50) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


