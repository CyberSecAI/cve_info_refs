- **Root cause of vulnerability:** The TOTOLINK A3002RU router's web interface does not properly sanitize user-supplied input when setting the NTP server IP address. Specifically, the application does not prevent the inclusion of command injection characters (` `` `) within the NTP server IP address field.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability in the handling of the NTP server IP address.
- **Impact of exploitation:** Arbitrary system commands can be executed on the router, including commands that can lead to denial of service (e.g., rebooting the router) and potentially permanent device inoperability when `reboot now` is injected.
- **Attack vectors:** Sending a crafted HTTP POST request to the `/boafrm/formNtp` endpoint with a malicious payload injected into the `ntpServerIp2` parameter.
- **Required attacker capabilities/position:** An attacker needs to be able to send HTTP requests to the router's web interface. This could be achieved from the local network if the attacker has access to the network or remotely if the routerâ€™s web management interface is exposed to the internet. The attacker also needs to be authenticated (or within the 5 min session timeout window).