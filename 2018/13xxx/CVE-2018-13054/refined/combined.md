=== Content from github.com_5f70af17_20250126_030939.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6g5m-97v8-hh8j)

**CVE-2018-13054**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6g5m-97v8-hh8j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2018-13054](/advisories/GHSA-6g5m-97v8-hh8j)

## An issue was discovered in Cinnamon 1.9.2 through 3.8.6....

High severity

Unreviewed

Published
May 14, 2022
to the GitHub Advisory Database
•
Updated Feb 2, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-6g5m-97v8-hh8j/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An issue was discovered in Cinnamon 1.9.2 through 3.8.6. The cinnamon-settings-users.py GUI runs as root and allows configuration of (for example) other users' icon files in \_on\_face\_browse\_menuitem\_activated and \_on\_face\_menuitem\_activated. These icon files are written to the respective user's $HOME/.face location. If an unprivileged user prepares a symlink pointing to an arbitrary location, then this location will be overwritten with the icon content.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2018-13054>
* [linuxmint/cinnamon#7683](https://github.com/linuxmint/cinnamon/pull/7683)
* <https://bugzilla.suse.com/show_bug.cgi?id=1083067>
* <https://lists.debian.org/debian-lts-announce/2018/07/msg00011.html>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2018-13054)
Jul 2, 2018

Published to the GitHub Advisory Database
May 14, 2022

Last updated
Feb 2, 2023

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H

### EPSS score

0.217%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (60th percentile)

### Weaknesses

[CWE-59](/advisories?query=cwe%3A59)

### CVE ID

CVE-2018-13054

### GHSA ID

GHSA-6g5m-97v8-hh8j

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-6g5m-97v8-hh8j/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_2b24d8f7_20250124_194602.html ===


---

[[Date Prev](msg00010.html)][[Date Next](msg00012.html)]
[[Thread Prev](msg00010.html)][[Thread Next](msg00012.html)]
[[Date Index](maillist.html#00011)]
[[Thread Index](threads.html#00011)]

# [SECURITY] [DLA-1420-1] cinnamon security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA-1420-1] cinnamon security update
* *From*: Chris Lamb <lamby@debian.org>
* *Date*: Fri, 13 Jul 2018 09:51:50 +0100
* *Message-id*: <[[🔎]](/msgid-search/1531471910.943998.1439458800.34DA572A%40webmail.messagingengine.com) [1531471910.943998.1439458800.34DA572A@webmail.messagingengine.com](msg00011.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : cinnamon
Version        : 2.2.16-5+deb8u1
CVE ID         : CVE-2018-13054
Debian Bug     : #903201

It was discovered that there was a symlink attack in the Cinnamon
desktop environment.

An attacker could overwrite an arbitrary file on the filesystem via
a $HOME/.face icon file (as the cinnamon-settings-users.py GUI runs
as root).

For Debian 8 "Jessie", this issue has been fixed in cinnamon version
2.2.16-5+deb8u1.

We recommend that you upgrade your cinnamon packages.

Regards,

- --
      ,''`.
     : :'  :     Chris Lamb
     `. `'`      lamby@debian.org / chris-lamb.co.uk
       `-

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEwv5L0nHBObhsUz5GHpU+J9QxHlgFAltIaBsACgkQHpU+J9Qx
HlgISw//QzvO4+yb23ZbpZz9YiKtJxtJgwJmuw9xauh4mDpadvDZ+i6BBVlP72MZ
joVI9Xo+pwpq/1UzDcUJ2cndhUhpGzACT43SvGR3N/Rv01WtNP1VZzJsR4zzmMTO
jwBXDeFi8HGxj9V+F3YBpyrEAOXnpCCsuVMy3GD8fyaSvFWfRfIrQuwzjn4xWQQR
b86WUJgkuzOmG9F8Mizz8UVYICDRU92mwpJMY2sLnBjYLR+6d4GFPdnsOR3rYEql
p5oOMvIygV6dY5FI4HpwjrRkRqXlBJuygHBvjcuaU+Dipp7r0nw0ICJgpPleL37H
AsJ/9KjHrbPtK0S42r1XDMQc69MragQ1tMyrdxjOfBaN/ItGl4QSuEVAKRbSwTx/
6p8jxhV5aq7ZesY+vQRzPSj5CG48M+beUKbl8XfNQr0QEpXAtfEO74TlWTI6YNr5
rET/fjJtTWWJRTPO5JAmb51EHEW9SDi6sS0AB6dqTIc6UiTl2+IxSPIlnnVidMt6
WaNVCFq7gYSReHofn+tfhGf1cWtx7snrn0OWRnx9mvZS5JYOhYlVY9PyrwvgUkgH
7T3cHV0rv8HM3lV1Ii82iVOpAzveQy2iGUNPzKRPZDYQnQUqQCCqI2Ec8GgFK+Nk
Xqmyxb7pai5qVZf0t2L5LLLRgNr0YLr2EskcSLkCjgWXDX0k22E=
=oDiZ
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.suse.com_7364c38c_20250124_194600.html ===


| Bugzilla – Bug 1083067 | AUDIT-0: CVE-2018-13054: cinnamon: polkit-untracked-privilege: org.cinnamon.settings-users > possible symlink attack in cinnamon-settings-users.py | Last modified: 2023-04-06 15:55:02 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1083067)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1083067**](show_bug.cgi?id=1083067)
(CVE-2018-13054)
- AUDIT-0: CVE-2018-13054: cinnamon: polkit-untracked-privilege: org.cinnamon.settings-users > possible symlink attack in cinnamon-settings-users.py

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
AUDIT-0: CVE-2018-13054: cinnamon: polkit-untracked-privilege: org.cinnamon.s...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-13054 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Audits ([show other bugs](buglist.cgi?component=Audits&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P5 - None **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | unspecified | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Alexei Sorokin | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3:RedHat:CVE-2018-13054:5.3:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-02-27 12:36 UTC by Dominique Leuenberger | | --- | --- | | Modified: | 2023-04-06 15:55 UTC ([History](show_activity.cgi?id=1083067)) | | CC List: | 4 users (show)  astieger i security-team sor.alexei | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1083067) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1083067&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1083067&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1083067#c0)  Dominique Leuenberger   2018-02-27 12:36:56 UTC  ``` Since you want to change this Info to an error, the current set of untracked privileges needs to be added to the white list.  cinnamon will newly fail with this check enforced:  [  386s] cinnamon.x86_64: I: polkit-untracked-privilege org.cinnamon.settings-users (auth_admin:auth_admin:auth_admin) ``` [Comment 1](show_bug.cgi?id=1083067#c1)  Matthias Gerstner   2018-03-09 14:56:56 UTC  ``` The cinnamon settings daemon was already audited in [bug 951830](show_bug.cgi?id=951830 "RESOLVED FIXED - AUDIT-0: cinnamon-settings-daemon requires security audition"). So this is only an incremental extension. ``` [Comment 2](show_bug.cgi?id=1083067#c2)  Swamp Workflow Management   2018-03-12 13:40:23 UTC  ``` This is an autogenerated message for OBS integration: This bug (1083067) was mentioned in <https://build.opensuse.org/request/show/585867> Factory / polkit-default-privs ``` [Comment 3](show_bug.cgi?id=1083067#c3)  Matthias Gerstner   2018-06-26 15:39:01 UTC  ``` I will work on this now. This is actually for package cinnamon-settings-daemon. ``` [Comment 4](show_bug.cgi?id=1083067#c4)  Matthias Gerstner   2018-06-27 13:37:37 UTC  ``` This is in the cinnamon package after all. Obviously I confused something here.  It's an pkexec action that allows to run a GUI implemented in python as root. Since it's all auth_admin that fine so far. The GUI itself running as root is a different matter. Will look deeper into it. ``` [Comment 5](show_bug.cgi?id=1083067#c5)  Matthias Gerstner   2018-06-28 13:55:56 UTC  ``` Adding cinnamon maintainer to CC. Making this private/embargoed.  So we have something here. Actually unrelated to the polkit rule itself, but the GUI running as root opens up a symlink attack. The admin can change other user's icons via the GUI. Once that happens, the GUI writes the new icon file to the user's home directory into /home/<user>/.face.  If an unprivileged user puts a symlink there like:  rm $HOME/.face ln -s /etc/shadow $HOME/.face  then as soon as the admin changes the icon, /etc/shadow will be overwritten by an icon file. So this allows unprivileged users to prepare a DoS attack or have further impact like creation a file /etc/suid-debug which allows to weaked protection of setuid binaries.  It still requires admin interaction. Anyways still a serious bug.  I didn't report this to upstream yet, because they seemingly have no responsible disclosure policy. I've contacted one of the devs I just recently had to do with. Therefore this is currently still under embargoe. Please don't spread it. ``` [Comment 7](show_bug.cgi?id=1083067#c7)  Matthias Gerstner   2018-06-28 13:57:24 UTC  ``` In [attachment 775569](attachment.cgi?id=775569&action=diff) [[details]](attachment.cgi?id=775569&action=edit) I have put a suggested patch that drops privileges to the target user before touching that .face file. Let's see what upstream thinks about it. ``` [Comment 8](show_bug.cgi?id=1083067#c8)  Matthias Gerstner   2018-07-02 11:35:55 UTC  ``` Assigning this to the Cinnamon maintainer.  The upstream dev replied by now and they don't want an embargo. It is public now via an upstream PR I just made:  <https://github.com/linuxmint/Cinnamon/pull/7683>  Let's see if they accept the patch. It should work though, I tested it on Tumbleweed.  Please submit a fix to Factory and maintenance updates for Leap 15.0, Leap 42.3. Thank you! ``` [Comment 9](show_bug.cgi?id=1083067#c9)  Matthias Gerstner   2018-07-03 08:28:43 UTC  ``` Upstream has merged the PR, so now it's time for us to integrate the patch, too. ``` [Comment 10](show_bug.cgi?id=1083067#c10)  Swamp Workflow Management   2018-07-06 16:00:08 UTC  ``` This is an autogenerated message for OBS integration: This bug (1083067) was mentioned in <https://build.opensuse.org/request/show/621350> 15.0 / cinnamon ``` [Comment 11](show_bug.cgi?id=1083067#c11)  Andreas Stieger   2018-07-11 18:25:10 UTC  ``` Alexei, if 42.3 is affected do you plan to apply the same fix there? ``` [Comment 12](show_bug.cgi?id=1083067#c12)  Alexei Sorokin   2018-07-12 08:27:20 UTC  ``` Andreas Stieger, it is affected, yeah. A request is out. ``` [Comment 13](show_bug.cgi?id=1083067#c13)  Swamp Workflow Management   2018-07-12 09:00:07 UTC  ``` This is an autogenerated message for OBS integration: This bug (1083067) was mentioned in <https://build.opensuse.org/request/show/622258> 42.3 / cinnamon <https://build.opensuse.org/request/show/622260> 15.0 / cinnamon ``` [Comment 14](show_bug.cgi?id=1083067#c14)  Swamp Workflow Management   2018-07-28 14:00:30 UTC  ``` openSUSE-SU-2018:2121-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1083067 CVE References: CVE-2018-13054 Sources used: openSUSE Leap 15.0 (src):    cinnamon-3.6.7-lp150.3.3.1 ``` [Comment 15](show_bug.cgi?id=1083067#c15)  Swamp Workflow Management   2018-07-28 14:02:33 UTC  ``` openSUSE-SU-2018:2125-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1083067 CVE References: CVE-2018-13054 Sources used: openSUSE Leap 42.3 (src):    cinnamon-3.4.6-2.3.1 ``` [Comment 16](show_bug.cgi?id=1083067#c16)  Matthias Gerstner   2018-08-03 14:51:35 UTC  ``` Updates are all out. Closing this bug as FIXED. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1083067)
* - [XML](show_bug.cgi?ctype=xml&id=1083067)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1083067)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1083067)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from github.com_87913c7f_20250124_194601.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2FCinnamon%2Fpull%2F7683)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2FCinnamon%2Fpull%2F7683)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=linuxmint%2Fcinnamon)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[linuxmint](/linuxmint)
/
**[cinnamon](/linuxmint/cinnamon)**
Public

* [Notifications](/login?return_to=%2Flinuxmint%2Fcinnamon) You must be signed in to change notification settings
* [Fork
  757](/login?return_to=%2Flinuxmint%2Fcinnamon)
* [Star
   4.7k](/login?return_to=%2Flinuxmint%2Fcinnamon)

* [Code](/linuxmint/cinnamon)
* [Issues
  1.8k](/linuxmint/cinnamon/issues)
* [Pull requests
  29](/linuxmint/cinnamon/pulls)
* [Actions](/linuxmint/cinnamon/actions)
* [Wiki](/linuxmint/cinnamon/wiki)
* [Security](/linuxmint/cinnamon/security)
* [Insights](/linuxmint/cinnamon/pulse)

Additional navigation options

* [Code](/linuxmint/cinnamon)
* [Issues](/linuxmint/cinnamon/issues)
* [Pull requests](/linuxmint/cinnamon/pulls)
* [Actions](/linuxmint/cinnamon/actions)
* [Wiki](/linuxmint/cinnamon/wiki)
* [Security](/linuxmint/cinnamon/security)
* [Insights](/linuxmint/cinnamon/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flinuxmint%2FCinnamon%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flinuxmint%2FCinnamon%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# cinnamon-settings-users.py: fix symlink attack vulnerability #7683

 Merged

[mtwebster](/mtwebster)
merged 1 commit into
[linuxmint:master](/linuxmint/cinnamon/tree/master "linuxmint/cinnamon:master")
from
mgerstner:settings\_users

Jul 2, 2018

 Merged

# [cinnamon-settings-users.py: fix symlink attack vulnerability](#top) #7683

[mtwebster](/mtwebster)
merged 1 commit into
[linuxmint:master](/linuxmint/cinnamon/tree/master "linuxmint/cinnamon:master")
from
mgerstner:settings\_users

Jul 2, 2018

[Conversation
2](/linuxmint/cinnamon/pull/7683)
[Commits
1](/linuxmint/cinnamon/pull/7683/commits)
[Checks
0](/linuxmint/cinnamon/pull/7683/checks)
[Files changed](/linuxmint/cinnamon/pull/7683/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mgerstner](https://avatars.githubusercontent.com/u/24227799?s=60&v=4)](/mgerstner)

Copy link

Contributor

### @mgerstner **[mgerstner](/mgerstner)** commented [Jul 2, 2018](#issue-337476939)

This script runs as root and allows to configure e.g. other user's icon

files. These icon files are written to the respective user's $HOME/.face

location. If an unprivileged user prepares a symlink pointing to an

arbitrary location then this location will be overwritten with the icon

content. This vulnerability thus allows to corrupt the system or other

user's files. The content is not attacker controlled, luckily.

This change introduces temporary privilege drops to the target user's

privileges before attempting to write the respective .face files. This

way the kernel can decide if permissions are okay or not.

Sorry, something went wrong.

All reactions

[![@xenopeek](https://avatars.githubusercontent.com/u/21159972?s=40&v=4)](/xenopeek)
[xenopeek](/xenopeek)
added
the
[In Progress](/linuxmint/cinnamon/labels/In%20Progress)
label
[Jul 2, 2018](#event-1711378410)

[![@mgerstner](https://avatars.githubusercontent.com/u/24227799?s=40&v=4)](/mgerstner)

`[cinnamon-settings-users.py: fix symlink attack vulnerability](/linuxmint/cinnamon/pull/7683/commits/928ecc461a665c336bf029f187b3516f540fdfe5 "cinnamon-settings-users.py: fix symlink attack vulnerability

This script runs as root and allows to configure e.g. other user's icon
files. These icon files are written to the respective user's $HOME/.face
location. If an unprivileged user prepares a symlink pointing to an
arbitrary location then this location will be overwritten with the icon
content. This vulnerability thus allows to corrupt the system or other
user's files. The content is not attacker controlled, luckily.

This change introduces temporary privilege drops to the target user's
privileges before attempting to write the respective .face files. This
way the kernel can decide if permissions are okay or not.")`
 …

`[928ecc4](/linuxmint/cinnamon/pull/7683/commits/928ecc461a665c336bf029f187b3516f540fdfe5)`

```
This script runs as root and allows to configure e.g. other user's icon
files. These icon files are written to the respective user's $HOME/.face
location. If an unprivileged user prepares a symlink pointing to an
arbitrary location then this location will be overwritten with the icon
content. This vulnerability thus allows to corrupt the system or other
user's files. The content is not attacker controlled, luckily.

This change introduces temporary privilege drops to the target user's
privileges before attempting to write the respective .face files. This
way the kernel can decide if permissions are okay or not.
```

[![@mgerstner](https://avatars.githubusercontent.com/u/24227799?s=80&v=4)](/mgerstner)

Copy link

Contributor

Author

### **[mgerstner](/mgerstner)** commented [Jul 2, 2018](#issuecomment-401774084)

| I reported this privately to [@clefebvre](https://github.com/clefebvre) by mail and he asked me to publish it right away via a PR. So here it is.  I think this is the safest way to fix the issue, so we don't have to worry about race conditions and open flags, letting the kernel do the actual security checks. Even safer would be not even to write that file as root, of course ;-) |
| --- |

All reactions

Sorry, something went wrong.

[![@mgerstner](https://avatars.githubusercontent.com/u/24227799?s=80&v=4)](/mgerstner)

Copy link

Contributor

Author

### **[mgerstner](/mgerstner)** commented [Jul 2, 2018](#issuecomment-401807105)

| This was assigned [CVE-2018-13054](https://github.com/advisories/GHSA-6g5m-97v8-hh8j "CVE-2018-13054"). |
| --- |

All reactions

Sorry, something went wrong.

[![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=40&v=4)](/mtwebster)
[mtwebster](/mtwebster)
merged commit [`66e54f4`](/linuxmint/cinnamon/commit/66e54f43f179fdf041a3e5232178a9910963cfb5)
into
linuxmint:master

[Jul 2, 2018](https://github.com/linuxmint/cinnamon/pull/7683#event-1712461616)

[![@xenopeek](https://avatars.githubusercontent.com/u/21159972?s=40&v=4)](/xenopeek)
[xenopeek](/xenopeek)
removed
the
[In Progress](/linuxmint/cinnamon/labels/In%20Progress)
label
[Jul 2, 2018](#event-1712461763)

[![@dilinger](https://avatars.githubusercontent.com/u/11581730?s=40&v=4)](/dilinger)
[dilinger](/dilinger)
mentioned this pull request
[Jan 15, 2019](#ref-issue-399156980)

[Can't overwrite older .face file after security fix was applied
#8298](/linuxmint/cinnamon/issues/8298)

Closed

[dilinger](/dilinger)
added a commit
to dilinger/cinnamon
that referenced
this pull request
[Apr 15, 2019](#ref-commit-44a4acb)
[![@dilinger](https://avatars.githubusercontent.com/u/11581730?s=40&v=4)](/dilinger)

`[cinnamon-settings-users.py: update symlink vulnerability fix](/dilinger/cinnamon/commit/44a4acb299446efd8f32a9d191c0a96f8541c4ed "cinnamon-settings-users.py: update symlink vulnerability fix

A security hole was fixed in #7683, where a user's .face file being
modified with root privileges allowed a symlink attack to overwrite
root-owned data.

Unfortunately, this fix is incomplete - simply dropping privileges
means that users who previously had an older .face file would be
unable to overwrite it. The old code left .face owned by root.

This fix first removes the old .face file as root, then drops
privileges and writes the new .face file.")`
…

`[44a4acb](/dilinger/cinnamon/commit/44a4acb299446efd8f32a9d191c0a96f8541c4ed)`

```
A security hole was fixed in [linuxmint#7683](https://github.com/linuxmint/cinnamon/pull/7683), where a user's .face file being
modified with root privileges allowed a symlink attack to overwrite
root-owned data.

Unfortunately, this fix is incomplete - simply dropping privileges
means that users who previously had an older .face file would be
unable to overwrite it. The old code left .face owned by root.

This fix first removes the old .face file as root, then drops
privileges and writes the new .face file.
```

[![@dilinger](https://avatars.githubusercontent.com/u/11581730?s=40&v=4)](/dilinger)
[dilinger](/dilinger)
mentioned this pull request
[Apr 15, 2019](#ref-pullrequest-433073732)

[cinnamon-settings-users.py: update symlink vulnerability fix
#8515](/linuxmint/cinnamon/pull/8515)
 Merged

[clefebvre](/clefebvre)
pushed a commit
that referenced
this pull request
[Jun 7, 2019](#ref-commit-85b56bb)
[![@dilinger](https://avatars.githubusercontent.com/u/11581730?s=40&v=4)](/dilinger) [![@clefebvre](https://avatars.githubusercontent.com/u/1138515?s=40&v=4)](/clefebvre)

`[cinnamon-settings-users.py: update symlink vulnerability fix (](/linuxmint/cinnamon/commit/85b56bb4970ad9b3ab9754f41b08f35e15909b04 "cinnamon-settings-users.py: update symlink vulnerability fix (#8515)

* cinnamon-settings-users.py: update symlink vulnerability fix

A security hole was fixed in #7683, where a user's .face file being
modified with root privileges allowed a symlink attack to overwrite
root-owned data.

Unfortunately, this fix is incomplete - simply dropping privileges
means that users who previously had an older .face file would be
unable to overwrite it. The old code left .face owned by root.

This fix first removes the old .face file as root, then drops
privileges and writes the new .face file.

* cinnamon-settings-users.py: fix coding quality issue

Don't ignore all exceptions when trying to remove a file; just OSError
exceptions.")[#8515](https://github.com/linuxmint/cinnamon/pull/8515)[)](/linuxmint/cinnamon/commit/85b56bb4970ad9b3ab9754f41b08f35e15909b04 "cinnamon-settings-users.py: update symlink vulnerability fix (#8515)

* cinnamon-settings-users.py: update symlink vulnerability fix

A security hole was fixed in #7683, where a user's .face file being
modified with root privileges allowed a symlink attack to overwrite
root-owned data.

Unfortunately, this fix is incomplete - simply dropping privileges
means that users who previously had an older .face file would be
unable to overwrite it. The old code left .face owned by root.

This fix first removes the old .face file as root, then drops
privileges and writes the new .face file.

* cinnamon-settings-users.py: fix coding quality issue

Don't ignore all exceptions when trying to remove a file; just OSError
exceptions.")`
…

`[85b56bb](/linuxmint/cinnamon/commit/85b56bb4970ad9b3ab9754f41b08f35e15909b04)`

```
* cinnamon-settings-users.py: update symlink vulnerability fix

A security hole was fixed in [#7683](https://github.com/linuxmint/cinnamon/pull/7683), where a user's .face file being
modified with root privileges allowed a symlink attack to overwrite
root-owned data.

Unfortunately, this fix is incomplete - simply dropping privileges
means that users who previously had an older .face file would be
unable to overwrite it. The old code left .face owned by root.

This fix first removes the old .face file as root, then drops
privileges and writes the new .face file.

* cinnamon-settings-users.py: fix coding quality issue

Don't ignore all exceptions when trying to remove a file; just OSError
exceptions.
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flinuxmint%2FCinnamon%2Fpull%2F7683)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@mgerstner](https://avatars.githubusercontent.com/u/24227799?s=52&v=4)](/mgerstner) [![@mtwebster](https://avatars.githubusercontent.com/u/262776?s=52&v=4)](/mtwebster) [![@xenopeek](https://avatars.githubusercontent.com/u/21159972?s=52&v=4)](/xenopeek)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_77c78846_20250126_030939.html ===
���� JFIF  ` `  �� ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
�� C 



�� C  

��  ( (" ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ����;]>Y��'��F��e�A��h�G�5�~ԟ�k��~�u�xkGҧ��Y|-d�5�"�Z��Nc���� «q�����N���2��q���V��i��i4�w�+������1P�ONFN2~��i��;hݓ� �c�e҅i}V�<��4r�Ï0�����]�~/�~ʿ�N��^--[��u����Gou}:(MC�/qe�@%UWu��r�G�����W�C4�8ޣ��v���S���/��o�3������x�K�\*Ћ�x�Q�m�F� ��NH'�懍� �ڗ���xcF�Þӂ����i����U?(��y�.N�x�Y����~�~��J��>�~(�v����G�ҿmY�u���E
173���Q����F�m���g��(T�ʕ��v� ������1�b�ީ�?�V�'���� :u�k"�v��� A�n��?�?�&��|/h�}�We]�o���?{S^S�X��|9�����:Ciz�j��e���h�HYHs���n+��iL}������Y\)MJ5������ ��~�
O�0�>���]a�!U.0�$�����x�y� ��G�[������+� ��������.�:k����x��%VI���5��E϶[� �x��[����xR !�u�g���WR�����ϵWL��咺9b���˧��
�>#���pu����\*��~%�+���U־�m�cfE�Fx�?�T\*T���בn�I+9?����o� =�� ��Q[sX��

=== Content from idp-portal.suse.com_6b95d262_20250126_030939.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.


