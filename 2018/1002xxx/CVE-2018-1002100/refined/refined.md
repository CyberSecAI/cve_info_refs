```
{
  "vulnerability": {
    "CVE": "CVE-2018-1002100",
    "description": "The `kubectl cp` command in Kubernetes versions 1.5.x, 1.6.x, 1.7.x, 1.8.x, and prior to version 1.9.6, insecurely handles tar data returned from the container, and can be caused to overwrite arbitrary local files.",
    "affected_versions": ">= 1.5, < 1.9.6",
    "patched_versions": "1.9.6",
    "root_cause": "The `kubectl cp` command uses the `tar` program installed within a container to create an archive, which is then unpacked on the client. The client code uses unsanitized filenames from the tar headers as input to `filepath.Join` without proper validation.",
    "weaknesses": [
      "Path Traversal",
       "Improper Input Validation"
    ],
    "impact": "An attacker who can control the contents of a container can craft a malicious tar archive with path traversal sequences, causing the `kubectl cp` command to write files to arbitrary locations on the client system.",
      "attack_vectors": [
        "A malicious container returning a specially crafted tar archive during a `kubectl cp` operation."
    ],
    "required_capabilities": "The attacker needs control over a container running in the Kubernetes cluster and needs to entice a victim to copy files from the container using `kubectl cp`."
  },
    "additional_details": {
        "openshift_impact": "The vulnerability also affects OpenShift's `oc cp` and `oc rsync` commands, as well as the source-to-image (S2I) builder. Exploiting the S2I builder can lead to gaining root access on the host system.",
        "s2i_exploit_mechanism": "The S2I builder uses `filepath.Join` on unsanitized filenames from tar headers within a `save-artifacts` script. An attacker can craft a malicious tar archive, overwrite the kernel's `core_pattern` file, and trigger a core dump, leading to arbitrary command execution on the host system.",
        "redhat_fix": "Red Hat has addressed the issue in OpenShift Container Platform 3.9.25, 3.7.44, 3.6.173.0.113, and 3.5.5.31.67.  OpenShift Online 3.x and OpenShift Dedicated 3.x were also affected and patched.",
        "mitigation": "Upgrade Kubernetes to version 1.9.6 or later.  For OpenShift, apply the relevant errata releases. Avoid copying files from untrusted containers. "
    }
}
```