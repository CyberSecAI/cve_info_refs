```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by the lack of proper validation of file paths within a ZIP archive during extraction. Specifically, the extraction code concatenates the file name from the archive with the destination directory without verifying if the resulting path remains within the intended target directory.",
    "weaknesses": [
      "Directory Traversal",
      "Arbitrary File Overwrite"
    ],
    "impact": "An attacker can overwrite arbitrary files on the system, potentially leading to remote command execution, overwriting configuration files, or other sensitive resources. The vulnerability affects both client (user) machines and servers.",
    "attack_vectors": "The vulnerability is exploited through a specially crafted archive containing filenames that include directory traversal sequences (e.g., `../../evil.sh`).",
    "required_capabilities": "The attacker needs to create a malicious archive with directory traversal file paths and deliver this archive to a vulnerable application or user. The vulnerable application must then extract this archive without proper validation."
  },
  "additional_details": {
    "affected_ecosystems": [
      "JavaScript",
      "Ruby",
      ".NET",
      "Go",
      "Java",
      "Python",
       "C++",
       "PHP",
        "Perl",
        "Rust",
        "Clojure"
    ],
    "vulnerable_code_example": "```java\n  1   Enumeration<ZipEntry>entries = zip.getEntries();\n  2   while (entries.hasMoreElements()) {\n  3       ZipEntry e = entries.nextElement();\n  4       File f = new File(destinationDir, e.getName());\n  5       InputStream input = zip.getInputStream(e);\n  6       IOUtils.copy(input, write(f));\n  7   }\n```\n The vulnerability exists on line 4 where the file name is concatenated with the target directory without being validated.",
   "fix_details": "The fix involves validating the file path before writing it to the file system. This is often done by checking if the final path starts with the target directory after resolving both to their absolute path. Code example of fix from zt-zip:\n```java\nif (name.indexOf(\"..\") != -1 && !file.getCanonicalPath().startsWith(outputDir.getCanonicalPath())) {\n  throw new ZipException(\"The file \"+name+\" is trying to leave the target output directory of \"+outputDir+\". Ignoring this file.\");\n}\n```",
    "notable_affected_projects": [
      "Oracle",
      "Amazon",
      "Spring/Pivotal",
      "LinkedIn",
      "Twitter",
      "Alibaba",
       "Jenkinsci",
       "Eclipse",
       "OWASP",
       "SonarQube",
       "OpenTable",
       "Arduino",
       "ElasticSearch",
        "Selenium",
        "JetBrains",
        "Google"
    ]
  }
}
```