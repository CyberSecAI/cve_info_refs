=== Content from github.com_7fd84130_20250125_070330.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fingress-nginx%2Fpull%2F3125)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fingress-nginx%2Fpull%2F3125)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=kubernetes%2Fingress-nginx)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kubernetes](/kubernetes)
/
**[ingress-nginx](/kubernetes/ingress-nginx)**
Public

* [Notifications](/login?return_to=%2Fkubernetes%2Fingress-nginx) You must be signed in to change notification settings
* [Fork
  8.3k](/login?return_to=%2Fkubernetes%2Fingress-nginx)
* [Star
   17.8k](/login?return_to=%2Fkubernetes%2Fingress-nginx)

* [Code](/kubernetes/ingress-nginx)
* [Issues
  312](/kubernetes/ingress-nginx/issues)
* [Pull requests
  69](/kubernetes/ingress-nginx/pulls)
* [Actions](/kubernetes/ingress-nginx/actions)
* [Projects
  0](/kubernetes/ingress-nginx/projects)
* [Security](/kubernetes/ingress-nginx/security)
* [Insights](/kubernetes/ingress-nginx/pulse)

Additional navigation options

* [Code](/kubernetes/ingress-nginx)
* [Issues](/kubernetes/ingress-nginx/issues)
* [Pull requests](/kubernetes/ingress-nginx/pulls)
* [Actions](/kubernetes/ingress-nginx/actions)
* [Projects](/kubernetes/ingress-nginx/projects)
* [Security](/kubernetes/ingress-nginx/security)
* [Insights](/kubernetes/ingress-nginx/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkubernetes%2Fingress-nginx%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkubernetes%2Fingress-nginx%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [404-server] Conceal /metrics and /healthz behind port 10254 #3125

 Merged

[k8s-ci-robot](/k8s-ci-robot)
merged 1 commit into
[kubernetes:master](/kubernetes/ingress-nginx/tree/master "kubernetes/ingress-nginx:master")
from
jonpulsifer:change-default-backend-metrics-port

Sep 26, 2018

 Merged

# [[404-server] Conceal /metrics and /healthz behind port 10254](#top) #3125

[k8s-ci-robot](/k8s-ci-robot)
merged 1 commit into
[kubernetes:master](/kubernetes/ingress-nginx/tree/master "kubernetes/ingress-nginx:master")
from
jonpulsifer:change-default-backend-metrics-port

Sep 26, 2018

[Conversation
28](/kubernetes/ingress-nginx/pull/3125)
[Commits
1](/kubernetes/ingress-nginx/pull/3125/commits)
[Checks
0](/kubernetes/ingress-nginx/pull/3125/checks)
[Files changed](/kubernetes/ingress-nginx/pull/3125/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=60&v=4)](/jonpulsifer)

Copy link

Contributor

### @jonpulsifer **[jonpulsifer](/jonpulsifer)** commented [Sep 25, 2018](#issue-363385084) • edited Loading

**What this PR does / why we need it**:

* Implements an HTTP multiplexer for the `/metrics` and `/healthz` endpoints and exposes a command line flag to change the port (default `10254`)
* Implements a timeout (default `5s`) for the graceful shutdown

**Which issue this PR fixes**:

Fixes [#1733](https://github.com/kubernetes/ingress-nginx/issues/1733)

**Special notes for your reviewer**:

~~This PR is getting pretty big.. I don't know if we should cut a release yet, or wait until we bump the manifests?~~ code has been updated to maintain existing functionality, so i don't think i'm that worried anymore

The 404-server is supposed to be small, but it's getting bigger, I don't know what we want to do here

Sorry, something went wrong.

All reactions

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
added
the
[cncf-cla: yes](/kubernetes/ingress-nginx/labels/cncf-cla%3A%20yes)
Indicates the PR's author has signed the CNCF CLA.
label
[Sep 25, 2018](#event-1864584902)

 [![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
requested review from
[mikedanese](/mikedanese) and
[nicksardo](/nicksardo)
[September 25, 2018 02:18](#event-1864584920)

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
added
the
[size/M](/kubernetes/ingress-nginx/labels/size/M)
Denotes a PR that changes 30-99 lines, ignoring generated files.
label
[Sep 25, 2018](#event-1864584975)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 25, 2018](#issuecomment-424185443)

| /assign [@aledbf](https://github.com/aledbf) |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
assigned [aledbf](/aledbf)
[Sep 25, 2018](#event-1864586645)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 25, 2018](#issuecomment-424186737) • edited Loading

| I guess the real question is, does anyone use these metrics? This is supposed to just return `http.StatusNotFound` and the `default backend - 404` string.  I don't know why but I just feel wrong feature creeping this thing |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 25, 2018](#issuecomment-424187757)

| I don't know why but I just feel wrong feature creeping this thing  I am not sure this adds real value for two reasons, just a counter for 404 is not very helpful and if you add the host being requested could produce an explosion of metrics. Maybe this PR should be referenced as an example for those users that want this feature? (building a custom 404 image is easy). WDYT? |
| --- |

 👍
1
 jonpulsifer reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@ElvinEfendi](https://avatars.githubusercontent.com/u/1150042?s=80&u=769864782d6fe5869fc1d18b666e791c7be73f80&v=4)](/ElvinEfendi)

Copy link

Member

### **[ElvinEfendi](/ElvinEfendi)** commented [Sep 25, 2018](#issuecomment-424188070)

| IMO ingress-nginx should not be concerned about default backend service at all. By default we should not require `--default-backend-service` to be set and just return 404 from Nginx directly. And if a user wants to customize then they can deploy their custom default backend service and use `--default-backend-service` to configure it. |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 25, 2018](#issuecomment-424188850)

| By default we should not require --default-backend-service to be set and just return 404 from Nginx directly.  We cannot break this rule. |
| --- |

All reactions

Sorry, something went wrong.

[![@ElvinEfendi](https://avatars.githubusercontent.com/u/1150042?s=80&u=769864782d6fe5869fc1d18b666e791c7be73f80&v=4)](/ElvinEfendi)

Copy link

Member

### **[ElvinEfendi](/ElvinEfendi)** commented [Sep 25, 2018](#issuecomment-424189151)

| We cannot break this rule.  [@aledbf](https://github.com/aledbf) can you elaborate? Are you worried that it will introduce snowflake in controller.go logic? |
| --- |

All reactions

Sorry, something went wrong.

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 25, 2018](#issuecomment-424189796)

| Maybe this PR should be referenced as an example for those users that want this feature? (building a custom 404 image is easy). WDYT?  I'm totally comfortable with that, I kinda just want to 🔥 the metrics endpoint altogether? I'm okay with `/healthz` being public from a security perspective |
| --- |

All reactions

Sorry, something went wrong.

[![@ElvinEfendi](https://avatars.githubusercontent.com/u/1150042?s=80&u=769864782d6fe5869fc1d18b666e791c7be73f80&v=4)](/ElvinEfendi)

Copy link

Member

### **[ElvinEfendi](/ElvinEfendi)** commented [Sep 25, 2018](#issuecomment-424197340)

| I sketched something quickly for the idea I suggest at [#3125 (comment)](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424188070), it is simpler than I guessed: <https://github.com/kubernetes/ingress-nginx/pull/3126/files> |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 25, 2018](#issuecomment-424313987)

| I'm totally comfortable with that, I kinda just want to fire the metrics endpoint altogether?  Not sure about that because someone could be using what's being exposed right now. |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 25, 2018](#issuecomment-424314100)

| Closing |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)
[aledbf](/aledbf)
closed this
[Sep 25, 2018](#event-1865513398)

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)
[aledbf](/aledbf)
mentioned this pull request
[Sep 25, 2018](#ref-issue-275426158)

[[nginx] Metrics of the defaultbackend
#1733](/kubernetes/ingress-nginx/issues/1733)

Closed

 [![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
deleted the
change-default-backend-metrics-port

branch
[September 25, 2018 16:16](#event-1866218150)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
mentioned this pull request
[Sep 25, 2018](#ref-pullrequest-363398082)

[do not require --default-backend-service
#3126](/kubernetes/ingress-nginx/pull/3126)
 Merged

[![@ElvinEfendi](https://avatars.githubusercontent.com/u/1150042?s=80&u=769864782d6fe5869fc1d18b666e791c7be73f80&v=4)](/ElvinEfendi)

Copy link

Member

### **[ElvinEfendi](/ElvinEfendi)** commented [Sep 26, 2018](#issuecomment-424558506) • edited Loading

| [@aledbf](https://github.com/aledbf) what's the problem with this PR? It is making things better without breaking anything, no? After [#3126](https://github.com/kubernetes/ingress-nginx/pull/3126) gets merged <https://github.com/kubernetes/ingress-nginx/tree/master/images/404-server> will serve just as an example, and I don't see any issue with making that example custom 404 page more secure and configurable. |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424560148)

| [@ElvinEfendi](https://github.com/ElvinEfendi) this introduce the same issue than here [#3116 (comment)](https://github.com/kubernetes/ingress-nginx/issues/3116#issuecomment-423522723) but for all 404 handled by the default backend |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424560230)

| Also, the 404-server image is not used only by ingress-nginx |
| --- |

 👍
1
 jonpulsifer reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 26, 2018](#issuecomment-424761157)

| the 404-server aka `k8s.gcr.io/defaultbackend` is also the backend used by the <https://github.com/kubernetes/ingress-gce> on GKE, you can find it in the `kube-system` namespace as `deploy/l7-default-backend` |
| --- |

All reactions

Sorry, something went wrong.

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 26, 2018](#issuecomment-424829737)

| /reopen |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=80&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)

Copy link

Contributor

### **[k8s-ci-robot](/k8s-ci-robot)** commented [Sep 26, 2018](#issuecomment-424829766)

| [@jonpulsifer](https://github.com/jonpulsifer): Reopening this PR.  In response to [this](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424829737):  /reopen  Instructions for interacting with me using PR comments are available [here](https://git.k8s.io/community/contributors/guide/pull-requests.md). If you have questions or suggestions related to my behavior, please file an issue against the [kubernetes/test-infra](https://github.com/kubernetes/test-infra/issues/new?title=Prow%20issue:) repository. |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=80&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)

Copy link

Contributor

### **[k8s-ci-robot](/k8s-ci-robot)** commented [Sep 26, 2018](#issuecomment-424829775)

| [@jonpulsifer](https://github.com/jonpulsifer): failed to re-open PR: state cannot be changed. The change-default-backend-metrics-port branch has been deleted.  In response to [this](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424829737):  /reopen  Instructions for interacting with me using PR comments are available [here](https://git.k8s.io/community/contributors/guide/pull-requests.md). If you have questions or suggestions related to my behavior, please file an issue against the [kubernetes/test-infra](https://github.com/kubernetes/test-infra/issues/new?title=Prow%20issue:) repository. |
| --- |

All reactions

Sorry, something went wrong.

 [![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
restored the
change-default-backend-metrics-port

branch
[September 26, 2018 18:53](#event-1869237251)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 26, 2018](#issuecomment-424829848)

| /reopen |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=80&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)

Copy link

Contributor

### **[k8s-ci-robot](/k8s-ci-robot)** commented [Sep 26, 2018](#issuecomment-424829880)

| [@jonpulsifer](https://github.com/jonpulsifer): Reopening this PR.  In response to [this](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424829848):  /reopen  Instructions for interacting with me using PR comments are available [here](https://git.k8s.io/community/contributors/guide/pull-requests.md). If you have questions or suggestions related to my behavior, please file an issue against the [kubernetes/test-infra](https://github.com/kubernetes/test-infra/issues/new?title=Prow%20issue:) repository. |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
reopened this
[Sep 26, 2018](#event-1869237794)

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424832244)

| /lgtm /approve |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
added
[lgtm](/kubernetes/ingress-nginx/labels/lgtm)
"Looks good to me", indicates that a PR is ready to be merged.
[approved](/kubernetes/ingress-nginx/labels/approved)
Indicates a PR has been approved by an approver from all required OWNERS files.
labels
[Sep 26, 2018](#event-1869254838)

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424833765)

| /hold |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
added
the
[do-not-merge/hold](/kubernetes/ingress-nginx/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Sep 26, 2018](#event-1869266229)

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424833921)

| [@bowei](https://github.com/bowei) [@nicksardo](https://github.com/nicksardo) ping |
| --- |

All reactions

Sorry, something went wrong.

 [![@nicksardo](https://avatars.githubusercontent.com/u/184976?s=40&v=4)](/nicksardo)
[nicksardo](/nicksardo)
requested review from
[bowei](/bowei)
and removed request for
[nicksardo](/nicksardo)
[September 26, 2018 19:16](#event-1869288873)

`[[404-server] conceal /metrics behind port 10254](/kubernetes/ingress-nginx/pull/3125/commits/d487a50e399100ad8db12ed1d2f92271f311f676 "[404-server] conceal /metrics behind port 10254

This commit conceals the /metrics endpoint behind port 10254.

Thanks to @aledbf for all the help getting this through!

Signed-off-by: Jonathan Pulsifer <jonathan.pulsifer@shopify.com>")`
 …

`[d487a50](/kubernetes/ingress-nginx/pull/3125/commits/d487a50e399100ad8db12ed1d2f92271f311f676)`

```
This commit conceals the /metrics endpoint behind port 10254.

Thanks to [@aledbf](https://github.com/aledbf) for all the help getting this through!

Signed-off-by: Jonathan Pulsifer <jonathan.pulsifer@shopify.com>
```

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
removed
the
[lgtm](/kubernetes/ingress-nginx/labels/lgtm)
"Looks good to me", indicates that a PR is ready to be merged.
label
[Sep 26, 2018](#event-1869387355)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=80&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)

Copy link

Contributor

Author

### **[jonpulsifer](/jonpulsifer)** commented [Sep 26, 2018](#issuecomment-424851091) • edited Loading

| commits have been squashed, ready to go I think 😄  also super thanks for the incorporated adjustments to the code (retaining functionality on `:8080/healthz` and the rest of the golang stuff) |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)
[aledbf](/aledbf)
assigned [bowei](/bowei)
[Sep 26, 2018](#event-1869465189)

[![@bowei](https://avatars.githubusercontent.com/u/837034?s=80&u=ff5a95e729af535b4cc31bb7c84b2e4e40679f3f&v=4)](/bowei)

Copy link

Member

### **[bowei](/bowei)** commented [Sep 26, 2018](#issuecomment-424877113)

| /lgtm |
| --- |

All reactions

Sorry, something went wrong.

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
added
the
[lgtm](/kubernetes/ingress-nginx/labels/lgtm)
"Looks good to me", indicates that a PR is ready to be merged.
label
[Sep 26, 2018](#event-1869575548)

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=80&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)

Copy link

Contributor

### **[k8s-ci-robot](/k8s-ci-robot)** commented [Sep 26, 2018](#issuecomment-424877157)

| [APPROVALNOTIFIER] This PR is **APPROVED**  This pull-request has been approved by: *[aledbf](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424832244 "Approved")*, *[bowei](https://github.com/kubernetes/ingress-nginx/pull/3125#issuecomment-424877113 "LGTM")*, *[jonpulsifer](https://github.com/kubernetes/ingress-nginx/pull/3125 "Author self-approved")*  The full list of commands accepted by this bot can be found [here](https://go.k8s.io/bot-commands).  The pull request process is described [here](https://git.k8s.io/community/contributors/guide/owners.md#the-code-review-process)  Needs approval from an approver in each of these files:  * ~~[images/404-server/OWNERS](https://github.com/kubernetes/ingress-nginx/blob/master/images/404-server/OWNERS)~~ [aledbf,bowei]   Approvers can indicate their approval by writing `/approve` in a comment Approvers can cancel approval by writing `/approve cancel` in a comment |
| --- |

All reactions

Sorry, something went wrong.

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)
[aledbf](/aledbf)
removed
the
[do-not-merge/hold](/kubernetes/ingress-nginx/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Sep 26, 2018](#event-1869580421)

[![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=40&u=1098a3bebdff2ad8d1f45e208fa5b8ce76fac6b5&v=4)](/k8s-ci-robot)
[k8s-ci-robot](/k8s-ci-robot)
merged commit [`50bb789`](/kubernetes/ingress-nginx/commit/50bb7897cfe279f7454399705ec75cd22e045799)
into
kubernetes:master

[Sep 26, 2018](https://github.com/kubernetes/ingress-nginx/pull/3125#event-1869585689)

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=80&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)

Copy link

Member

### **[aledbf](/aledbf)** commented [Sep 26, 2018](#issuecomment-424878837)

| [@bowei](https://github.com/bowei) can you help with the publication of the image to gcr? |
| --- |

All reactions

Sorry, something went wrong.

 [![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
deleted the
change-default-backend-metrics-port

branch
[September 27, 2018 17:11](#event-1871654896)

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
mentioned this pull request
[Sep 27, 2018](#ref-issue-364591683)

[A new home for 404-server (defaultbackend)
kubernetes/ingress-gce#498](/kubernetes/ingress-gce/issues/498)

Closed

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&u=b4ab095656b3619fd4221d7fd94e2040757dade9&v=4)](/aledbf)
[aledbf](/aledbf)
mentioned this pull request
[Sep 27, 2018](#ref-pullrequest-364222663)

[Update default backend image
kubernetes/kubernetes#69120](/kubernetes/kubernetes/pull/69120)
 Merged

[![@bowei](https://avatars.githubusercontent.com/u/837034?s=80&u=ff5a95e729af535b4cc31bb7c84b2e4e40679f3f&v=4)](/bowei)

Copy link

Member

### **[bowei](/bowei)** commented [Sep 27, 2018](#issuecomment-425205470)

| ahhhh ok, doing it |
| --- |

 👍
1
 aledbf reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=40&u=3a76e440664c7080cb3019ad029815d5a8fe1785&v=4)](/jonpulsifer)
[jonpulsifer](/jonpulsifer)
mentioned this pull request
[Nov 19, 2018](#ref-pullrequest-366453100)

[Cherrypick: Update defaultbackend to v1.5
kubernetes/kubernetes#69381](/kubernetes/kubernetes/pull/69381)
 Merged

[![@NicoleG25](https://avatars.githubusercontent.com/u/50918335?s=80&u=c3406b4813cac2098db848ca294c34426efcc15d&v=4)](/NicoleG25)

Copy link

### **[NicoleG25](/NicoleG25)** commented [Jan 15, 2020](#issuecomment-574569829)

| It appears that [CVE-2018-1002104](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1002104) was assigned to this issue. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fingress-nginx%2Fpull%2F3125)

Reviewers

[![@mikedanese](https://avatars.githubusercontent.com/u/1787169?s=40&v=4)](/mikedanese) [mikedanese](/mikedanese)

 Awaiting requested review from mikedanese

[![@bowei](https://avatars.githubusercontent.com/u/837034?s=40&v=4)](/bowei) [bowei](/bowei)

 Awaiting requested review from bowei

Assignees

[![@aledbf](https://avatars.githubusercontent.com/u/161571?s=40&v=4)](/aledbf) [aledbf](/aledbf)

[![@bowei](https://avatars.githubusercontent.com/u/837034?s=40&v=4)](/bowei) [bowei](/bowei)

Labels

[approved](/kubernetes/ingress-nginx/labels/approved)
Indicates a PR has been approved by an approver from all required OWNERS files.
[cncf-cla: yes](/kubernetes/ingress-nginx/labels/cncf-cla%3A%20yes)
Indicates the PR's author has signed the CNCF CLA.
[lgtm](/kubernetes/ingress-nginx/labels/lgtm)
"Looks good to me", indicates that a PR is ready to be merged.
[size/M](/kubernetes/ingress-nginx/labels/size/M)
Denotes a PR that changes 30-99 lines, ignoring generated files.

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [[nginx] Metrics of the defaultbackend](https://github.com/kubernetes/ingress-nginx/issues/1733)

6 participants

[![@jonpulsifer](https://avatars.githubusercontent.com/u/5461940?s=52&v=4)](/jonpulsifer) [![@aledbf](https://avatars.githubusercontent.com/u/161571?s=52&v=4)](/aledbf) [![@ElvinEfendi](https://avatars.githubusercontent.com/u/1150042?s=52&v=4)](/ElvinEfendi) [![@k8s-ci-robot](https://avatars.githubusercontent.com/u/20407524?s=52&v=4)](/k8s-ci-robot) [![@bowei](https://avatars.githubusercontent.com/u/837034?s=52&v=4)](/bowei) [![@NicoleG25](https://avatars.githubusercontent.com/u/50918335?s=52&v=4)](/NicoleG25)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


