=== Content from github.com_bf1f4d13_20250125_061437.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElvin9%2FNotSecDrv%2Fblob%2Fmaster%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElvin9%2FNotSecDrv%2Fblob%2Fmaster%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Elvin9%2FNotSecDrv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Elvin9](/Elvin9)
/
**[NotSecDrv](/Elvin9/NotSecDrv)**
Public

* [Notifications](/login?return_to=%2FElvin9%2FNotSecDrv) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2FElvin9%2FNotSecDrv)
* [Star
   17](/login?return_to=%2FElvin9%2FNotSecDrv)

* [Code](/Elvin9/NotSecDrv)
* [Issues
  0](/Elvin9/NotSecDrv/issues)
* [Pull requests
  0](/Elvin9/NotSecDrv/pulls)
* [Actions](/Elvin9/NotSecDrv/actions)
* [Projects
  0](/Elvin9/NotSecDrv/projects)
* [Security](/Elvin9/NotSecDrv/security)
* [Insights](/Elvin9/NotSecDrv/pulse)

Additional navigation options

* [Code](/Elvin9/NotSecDrv)
* [Issues](/Elvin9/NotSecDrv/issues)
* [Pull requests](/Elvin9/NotSecDrv/pulls)
* [Actions](/Elvin9/NotSecDrv/actions)
* [Projects](/Elvin9/NotSecDrv/projects)
* [Security](/Elvin9/NotSecDrv/security)
* [Insights](/Elvin9/NotSecDrv/pulse)

## Files

 master
## Breadcrumbs

1. [NotSecDrv](/Elvin9/NotSecDrv/tree/master)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Elvin9/NotSecDrv/commits/master/README.md)48 lines (35 loc) · 5.04 KB master
## Breadcrumbs

1. [NotSecDrv](/Elvin9/NotSecDrv/tree/master)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

48 lines (35 loc) · 5.04 KB[Raw](https://github.com/Elvin9/NotSecDrv/raw/refs/heads/master/README.md)
# NotSecDrv - A PoC code for CVE-2018-7249

### General Description

An issue was discovered in secdrv.sys as shipped in Microsoft Windows Vista, Windows 7, Windows 8, and Windows 8.1 before KB3086255, and as shipped in Macrovision SafeDisc. Two carefully timed calls to IOCTL 0xCA002813 can cause a race condition that leads to a use-after-free. When exploited, an unprivileged attacker can run arbitrary code in the kernel.

The vulnerability was reported to Microsoft, and since it does not affect an up-to-date Windows machine (only version prior to KB3086255), they will not take any action. Was tested and exploited successfully on Windows 7 x86.

Also related to [CVE-2018-7250](https://github.com/Elvin9/SecDrvPoolLeak).

### Screenshot

[![Alt text](https://github.com/Elvin9/NotSecDrv/raw/master/VirtualBox_Testing_NotSecDrv.png)](https://github.com/Elvin9/NotSecDrv/raw/master/VirtualBox_Testing_NotSecDrv.png)

### Details

This documents my little research about the secdrv.sys driver. All the described behaviors of the driver were reversed engineered and might be incorrect / inaccurate.

Offset 0x4 of the input buffer to the IOCTL (0x0CA002813) contains a number that I will refer to as the TYPE.
The main handler function of this IOCTL (0x0CA002813), sub\_11A88 receives 3 different types: 0x96, 0x97 and 0x98.

* **0x96** allocates a PagedPool chunk, stores it in an array of size 0x64, initializes it (sort of :)), and copies a part of it to the user supplied buffer at offset 0x10.
* **0x97** uses a previously allocated chunk, that was allocated with 0x96 (it find the right chunk in the mentiones array by a tag),
  and uses it to encrypt the user input buffer with some sort of a modified xor encryption routine. It then calls a function that is stored in another structure, which is pointed by a field in the allocated chunk.
* **0x98** frees a chunk that was allocated with 0x96. It finds the right chunk by searching the tag given to it in the allocation process.

#### Info Leak (CVE-2018-7250)

After IOCTL type 0x96 allocated a new chunk and initialized it, but not fully, it copies the chunk to usermode. 16 bits in the newly allocated chunk were not initialized, and contain data from previous PagedPool allocations. The uninitialized bits are then copies to usermode at .text:00011BE9 by the REP MOVSD instruction. PoC code [here](https://github.com/Elvin9/SecDrvPoolLeak).

#### Arbitrary Code Execution (CVE-2018-7249)

When IOCTL type 0x97 is called, it finds the needed chunk, that was previously allocated with type 0x96, by its tag. If the allocation was already freed by IOCTL type 0x97, DeviceIoControl returns an error. The vulnerability here is, that the allocation used by type 0x97, can be freed DURING its operation (since no synchronization mechanisms are used) thus being used-after-freed if the race is won.
If an attacker manages to free the chunk during the operation of IOCTL type 0x97 (using type 0x98), and allocate a new chunk, controlled by him, in the exact same memory location, he can override a pointer to another structure, that contains a function pointer that can be used to finally hijack the driver's execution flow and execute arbitrary code in ring 0.
Because the encryption routine is done on a user supplied buffer, which can be huge in size, the encryption can take a long time to execute, thus providing a perfect time window for IOCTL type 0x98 to free the chunk while still in use. The time windows can be so long (more than 1 second!), that the race can be won reliably on the first attempt. The use-after-free starts at .text:00011B68, and the actual call, that will be hijacked to jump to the shellcode, happens at .text:00011B86.

The steps taken to successfully exploit this vulnerability are as following:

* Free all previous chunks with the tag we plan to use later, making sure all IOCTLs operate on the same PagedPool chunk.
* Spray the PagedPool and create holes that match the size of the allocations in IOCTL type 0x96 (0x30 bytes). This is necessary in order to later reliably allocate a fake replacement
  instead of the freed one.
* Allocate a chunk with IOCTL type 0x96. This chunk will be allocated in one of the holes created previously.
* Allocate large region of user space memory and call IOCTL type 0x97. The large memory region will ensure that the thread that frees the allocation, has enough time to win the race.
* Start a new thread that will call IOCTL type 0x98 and free the chunk that the other thread is operating on.
* Spray the pool again from the new thread (after the chunk was freed) in order to replace the freed chunk with an attacker controlled allocation. This fake chunk should contain valid pointers to the necessary structures.
* Put the shellcode's address at the correct offset of the function pointer in the fake structure we created, and wait for it to be called (it will be called from IOCTL type 0x97, after it finishes the encryption).
* Enjoy!

### Test Enviroment

**OS:** Windows 7 Kernel Version 7600 MP (1 procs) Free x86 compatible Built by: 7600.16385.x86fre.win7\_rtm.090713-1255
**VM:** 4GB RAM, 1 CPU
**Hardware:** Windows 10 Pro 64 bit, Motherboard Gigabyte Z370 HD3, 16GB RAM, Intel i5-8400 2.80GHz (6 CPUs)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e81b38ae_20250126_063732.html ===
# NotSecDrv - A PoC code for CVE-2018-7249
### General Description
An issue was discovered in secdrv.sys as shipped in Microsoft Windows Vista, Windows 7, Windows 8, and Windows 8.1 before KB3086255, and as shipped in Macrovision SafeDisc. Two carefully timed calls to IOCTL 0xCA002813 can cause a race condition that leads to a use-after-free. When exploited, an unprivileged attacker can run arbitrary code in the kernel.
The vulnerability was reported to Microsoft, and since it does not affect an up-to-date Windows machine (only version prior to KB3086255), they will not take any action. Was tested and exploited successfully on Windows 7 x86.
Also related to [CVE-2018-7250](https://github.com/Elvin9/SecDrvPoolLeak).
### Screenshot
![Alt text](https://github.com/Elvin9/NotSecDrv/raw/master/VirtualBox\_Testing\_NotSecDrv.png)
### Details
This documents my little research about the secdrv.sys driver. All the described behaviors of the driver were reversed engineered and might be incorrect / inaccurate.
Offset 0x4 of the input buffer to the IOCTL (0x0CA002813) contains a number that I will refer to as the TYPE.
The main handler function of this IOCTL (0x0CA002813), sub\_11A88 receives 3 different types: 0x96, 0x97 and 0x98.
\* \*\*0x96\*\* allocates a PagedPool chunk, stores it in an array of size 0x64, initializes it (sort of :)), and copies a part of it to the user supplied buffer at offset 0x10.
\* \*\*0x97\*\* uses a previously allocated chunk, that was allocated with 0x96 (it find the right chunk in the mentiones array by a tag),
and uses it to encrypt the user input buffer with some sort of a modified xor encryption routine. It then calls a function that is stored in another structure, which is pointed by a field in the allocated chunk.
\* \*\*0x98\*\* frees a chunk that was allocated with 0x96. It finds the right chunk by searching the tag given to it in the allocation process.
#### Info Leak (CVE-2018-7250)
After IOCTL type 0x96 allocated a new chunk and initialized it, but not fully, it copies the chunk to usermode. 16 bits in the newly allocated chunk were not initialized, and contain data from previous PagedPool allocations. The uninitialized bits are then copies to usermode at .text:00011BE9 by the REP MOVSD instruction. PoC code [here](https://github.com/Elvin9/SecDrvPoolLeak).
#### Arbitrary Code Execution (CVE-2018-7249)
When IOCTL type 0x97 is called, it finds the needed chunk, that was previously allocated with type 0x96, by its tag. If the allocation was already freed by IOCTL type 0x97, DeviceIoControl returns an error. The vulnerability here is, that the allocation used by type 0x97, can be freed DURING its operation (since no synchronization mechanisms are used) thus being used-after-freed if the race is won.
If an attacker manages to free the chunk during the operation of IOCTL type 0x97 (using type 0x98), and allocate a new chunk, controlled by him, in the exact same memory location, he can override a pointer to another structure, that contains a function pointer that can be used to finally hijack the driver's execution flow and execute arbitrary code in ring 0.
Because the encryption routine is done on a user supplied buffer, which can be huge in size, the encryption can take a long time to execute, thus providing a perfect time window for IOCTL type 0x98 to free the chunk while still in use. The time windows can be so long (more than 1 second!), that the race can be won reliably on the first attempt. The use-after-free starts at .text:00011B68, and the actual call, that will be hijacked to jump to the shellcode, happens at .text:00011B86.
The steps taken to successfully exploit this vulnerability are as following:
\* Free all previous chunks with the tag we plan to use later, making sure all IOCTLs operate on the same PagedPool chunk.
\* Spray the PagedPool and create holes that match the size of the allocations in IOCTL type 0x96 (0x30 bytes). This is necessary in order to later reliably allocate a fake replacement
instead of the freed one.
\* Allocate a chunk with IOCTL type 0x96. This chunk will be allocated in one of the holes created previously.
\* Allocate large region of user space memory and call IOCTL type 0x97. The large memory region will ensure that the thread that frees the allocation, has enough time to win the race.
\* Start a new thread that will call IOCTL type 0x98 and free the chunk that the other thread is operating on.
\* Spray the pool again from the new thread (after the chunk was freed) in order to replace the freed chunk with an attacker controlled allocation. This fake chunk should contain valid pointers to the necessary structures.
\* Put the shellcode's address at the correct offset of the function pointer in the fake structure we created, and wait for it to be called (it will be called from IOCTL type 0x97, after it finishes the encryption).
\* Enjoy!
### Test Enviroment
\*\*OS:\*\* Windows 7 Kernel Version 7600 MP (1 procs) Free x86 compatible Built by: 7600.16385.x86fre.win7\_rtm.090713-1255
\*\*VM:\*\* 4GB RAM, 1 CPU
\*\*Hardware:\*\* Windows 10 Pro 64 bit, Motherboard Gigabyte Z370 HD3, 16GB RAM, Intel i5-8400 2.80GHz (6 CPUs)


=== Content from github.com_efc2b190_20250126_063733.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElvin9%2FSecDrvPoolLeak)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElvin9%2FSecDrvPoolLeak)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Elvin9%2FSecDrvPoolLeak)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Elvin9](/Elvin9)
/
**[SecDrvPoolLeak](/Elvin9/SecDrvPoolLeak)**
Public

* [Notifications](/login?return_to=%2FElvin9%2FSecDrvPoolLeak) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2FElvin9%2FSecDrvPoolLeak)
* [Star
   7](/login?return_to=%2FElvin9%2FSecDrvPoolLeak)

A PoC for CVE-2018-7250

[7
stars](/Elvin9/SecDrvPoolLeak/stargazers) [4
forks](/Elvin9/SecDrvPoolLeak/forks) [Branches](/Elvin9/SecDrvPoolLeak/branches) [Tags](/Elvin9/SecDrvPoolLeak/tags) [Activity](/Elvin9/SecDrvPoolLeak/activity)
 [Star](/login?return_to=%2FElvin9%2FSecDrvPoolLeak)

 [Notifications](/login?return_to=%2FElvin9%2FSecDrvPoolLeak) You must be signed in to change notification settings

* [Code](/Elvin9/SecDrvPoolLeak)
* [Issues
  0](/Elvin9/SecDrvPoolLeak/issues)
* [Pull requests
  0](/Elvin9/SecDrvPoolLeak/pulls)
* [Actions](/Elvin9/SecDrvPoolLeak/actions)
* [Projects
  0](/Elvin9/SecDrvPoolLeak/projects)
* [Security](/Elvin9/SecDrvPoolLeak/security)
* [Insights](/Elvin9/SecDrvPoolLeak/pulse)

Additional navigation options

* [Code](/Elvin9/SecDrvPoolLeak)
* [Issues](/Elvin9/SecDrvPoolLeak/issues)
* [Pull requests](/Elvin9/SecDrvPoolLeak/pulls)
* [Actions](/Elvin9/SecDrvPoolLeak/actions)
* [Projects](/Elvin9/SecDrvPoolLeak/projects)
* [Security](/Elvin9/SecDrvPoolLeak/security)
* [Insights](/Elvin9/SecDrvPoolLeak/pulse)

# Elvin9/SecDrvPoolLeak

    master[Branches](/Elvin9/SecDrvPoolLeak/branches)[Tags](/Elvin9/SecDrvPoolLeak/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[11 Commits](/Elvin9/SecDrvPoolLeak/commits/master/) | | |
| [SecDrvPoolLeak](/Elvin9/SecDrvPoolLeak/tree/master/SecDrvPoolLeak "SecDrvPoolLeak") | | [SecDrvPoolLeak](/Elvin9/SecDrvPoolLeak/tree/master/SecDrvPoolLeak "SecDrvPoolLeak") |  |  |
| [.gitattributes](/Elvin9/SecDrvPoolLeak/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/Elvin9/SecDrvPoolLeak/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/Elvin9/SecDrvPoolLeak/blob/master/.gitignore ".gitignore") | | [.gitignore](/Elvin9/SecDrvPoolLeak/blob/master/.gitignore ".gitignore") |  |  |
| [README.md](/Elvin9/SecDrvPoolLeak/blob/master/README.md "README.md") | | [README.md](/Elvin9/SecDrvPoolLeak/blob/master/README.md "README.md") |  |  |
| [SecDrvPoolLeak.sln](/Elvin9/SecDrvPoolLeak/blob/master/SecDrvPoolLeak.sln "SecDrvPoolLeak.sln") | | [SecDrvPoolLeak.sln](/Elvin9/SecDrvPoolLeak/blob/master/SecDrvPoolLeak.sln "SecDrvPoolLeak.sln") |  |  |
| [allocation.png](/Elvin9/SecDrvPoolLeak/blob/master/allocation.png "allocation.png") | | [allocation.png](/Elvin9/SecDrvPoolLeak/blob/master/allocation.png "allocation.png") |  |  |
| [leak.png](/Elvin9/SecDrvPoolLeak/blob/master/leak.png "leak.png") | | [leak.png](/Elvin9/SecDrvPoolLeak/blob/master/leak.png "leak.png") |  |  |
| View all files | | |

## Repository files navigation

* README
# SecDrvPoolLeak - A PoC for CVE-2018-7250

### Description

An issue was discovered in secdrv.sys as shipped in Microsoft Windows Vista, Windows 7, Windows 8, and Windows 8.1 before KB3086255, and as shipped in Macrovision SafeDisc. An uninitialized kernel pool allocation in IOCTL 0xCA002813 allows a local unprivileged attacker to leak 16 bits of uninitialized kernel PagedPool data.

The vulnerability was reported to Microsoft, and since it does not affect an up-to-date Windows machine (only versions prior to KB3086255), they will not take any action. Was tested and exploited successfully on Windows 7 x86.

Also related to [CVE-2018-7249](https://github.com/Elvin9/NotSecDrv), the link contains details about both vulnerabilities.

### Screenshots

The allocated PagedPool chunk uninitialized:
[![Alt text](https://github.com/Elvin9/SecDrvPoolLeak/raw/master/allocation.png)](https://github.com/Elvin9/SecDrvPoolLeak/raw/master/allocation.png)

The uninitialized part copied to usermode:
[![Alt text](https://github.com/Elvin9/SecDrvPoolLeak/raw/master/leak.png)](https://github.com/Elvin9/SecDrvPoolLeak/raw/master/leak.png)

### Test Enviroment

**OS:** Windows 7 Kernel Version 7600 MP (1 procs) Free x86 compatible Built by: 7600.16385.x86fre.win7\_rtm.090713-1255
**VM:** 4GB RAM, 1 CPU
**Hardware:** Windows 10 Pro 64 bit, Motherboard Gigabyte Z370 HD3, 16GB RAM, Intel i5-8400 2.80GHz (6 CPUs)

## About

A PoC for CVE-2018-7250

### Resources

[Readme](#readme-ov-file)

[Activity](/Elvin9/SecDrvPoolLeak/activity)
### Stars

[**7**
stars](/Elvin9/SecDrvPoolLeak/stargazers)
### Watchers

[**3**
watching](/Elvin9/SecDrvPoolLeak/watchers)
### Forks

[**4**
forks](/Elvin9/SecDrvPoolLeak/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FElvin9%2FSecDrvPoolLeak&report=Elvin9+%28user%29)

## [Releases](/Elvin9/SecDrvPoolLeak/releases)

No releases published

## [Packages 0](/users/Elvin9/packages?repo_name=SecDrvPoolLeak)

No packages published

## Languages

* [C++
  76.4%](/Elvin9/SecDrvPoolLeak/search?l=c%2B%2B)
* [C
  23.6%](/Elvin9/SecDrvPoolLeak/search?l=c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


