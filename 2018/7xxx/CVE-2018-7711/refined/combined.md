=== Content from lists.debian.org_0e420b20_20250124_214415.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 1314-1] simplesamlphp security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 1314-1] simplesamlphp security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Fri, 23 Mar 2018 12:58:28 +0100
* *Message-id*: <[[üîé]](/msgid-search/f04e1c82-ac0d-f29c-8933-f82180dbce55%40debian.org)¬†[f04e1c82-ac0d-f29c-8933-f82180dbce55@debian.org](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Package        : simplesamlphp
Version        : 1.9.2-1+deb7u4
CVE ID         : CVE-2018-7711

Cure53 discovered that in SimpleSAMLphp, in rare circumstances an
invalid signature on the SAML 2.0 HTTP Redirect binding could be
considered valid.

Additionally this update fixes a regression introduced in DLA-1298
by the backported patch for SSA-201802-01/CVE-2018-7644.

For Debian 7 "Wheezy", these problems have been fixed in version
1.9.2-1+deb7u4.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQEuBAEBCAAYBQJatOvfERx0aGlqc0BkZWJpYW4ub3JnAAoJEFb2GnlAHawEa1gI
AKCdPxL7Wa99pCRftFLjb7ncjhJplXveO3jr3/DGVBTeKgfzTa340Qzbb4FgGGcB
/At78ekCJNcD36swfiGc53V6rf4kiQgnthYxTR3zJPLDvM4YrzxWWFcBS7QT+RJE
BFHFD+w8g6pVuhnZkrdJNRQ8FiWNNbf917WUQkcVLKOQx0M90cNWmhI96+Yd/xQz
dKT21X4r9xpXNcDaDOrmV9gWm2JiO0V+Sff4iiAD6/RhwOtWBICp8npnwowJ0RFl
iJJiDWxDDxNHRiQ/zuJGY3B7LvfvBfhrXjgP3N2jDYWrHMwJGjs+aQmOgBmRjTKQ
UAnTxxv2TEL4x2louqa30zk=
=lhxS
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_11f71754_20250124_214413.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsaml2%2Fcommit%2F4f6af7f69f29df8555a18b9bb7b646906b45924d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsaml2%2Fcommit%2F4f6af7f69f29df8555a18b9bb7b646906b45924d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=simplesamlphp%2Fsaml2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simplesamlphp](/simplesamlphp)
/
**[saml2](/simplesamlphp/saml2)**
Public

* [Notifications](/login?return_to=%2Fsimplesamlphp%2Fsaml2) You must be signed in to change notification settings
* [Fork
  135](/login?return_to=%2Fsimplesamlphp%2Fsaml2)
* [Star
   287](/login?return_to=%2Fsimplesamlphp%2Fsaml2)

* [Code](/simplesamlphp/saml2)
* [Issues
  10](/simplesamlphp/saml2/issues)
* [Pull requests
  2](/simplesamlphp/saml2/pulls)
* [Actions](/simplesamlphp/saml2/actions)
* [Projects
  1](/simplesamlphp/saml2/projects)
* [Wiki](/simplesamlphp/saml2/wiki)
* [Security](/simplesamlphp/saml2/security)
* [Insights](/simplesamlphp/saml2/pulse)

Additional navigation options

* [Code](/simplesamlphp/saml2)
* [Issues](/simplesamlphp/saml2/issues)
* [Pull requests](/simplesamlphp/saml2/pulls)
* [Actions](/simplesamlphp/saml2/actions)
* [Projects](/simplesamlphp/saml2/projects)
* [Wiki](/simplesamlphp/saml2/wiki)
* [Security](/simplesamlphp/saml2/security)
* [Insights](/simplesamlphp/saml2/pulse)

## Commit

[Permalink](/simplesamlphp/saml2/commit/4f6af7f69f29df8555a18b9bb7b646906b45924d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Be strict when checking return values.

[Browse files](/simplesamlphp/saml2/tree/4f6af7f69f29df8555a18b9bb7b646906b45924d)
Browse the repository at this point in the history

* Loading branch information

[![@jaimeperez](https://avatars.githubusercontent.com/u/1942728?s=40&v=4)](/jaimeperez)

[jaimeperez](/simplesamlphp/saml2/commits?author=jaimeperez "View all commits by jaimeperez")
committed
Mar 2, 2018

1 parent
[60b8d2b](/simplesamlphp/saml2/commit/60b8d2b5d3036b8ae38ba96d516f03a7dd66284b)

commit 4f6af7f

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/SAML2/HTTPRedirect.php](#diff-6a2c4640d940f28e0b49947ffbafd6d2726f92c9fba5fdad8202234083daff57 "src/SAML2/HTTPRedirect.php")

Show comments

[View file](/simplesamlphp/saml2/blob/4f6af7f69f29df8555a18b9bb7b646906b45924d/src/SAML2/HTTPRedirect.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -226,7 +226,7 @@ public static function validateSignature(array $data, XMLSecurityKey $key) |
|  |  | $key = Utils::castKey($key, $sigAlg); |
|  |  | } |
|  |  |  |
|  |  | if (!$key->verifySignature($query, $signature)) { |
|  |  | if ($key->verifySignature($query, $signature) !== 1) { |
|  |  | throw new \Exception('Unable to validate signature on query string.'); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `4f6af7f`

[![@jrchamp](https://avatars.githubusercontent.com/u/625298?s=80&v=4)](/jrchamp)

Copy link

### @jrchamp **[jrchamp](/jrchamp)** commented on `[4f6af7f](/simplesamlphp/saml2/commit/4f6af7f69f29df8555a18b9bb7b646906b45924d)` [Mar 6, 2018](#commitcomment-27959716)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please consider adding a comment here about the importance and meaning of the integer value `1`. It appears to depend heavily on the return codes from `openssl_verify()` and is directly mentioned in two published security advisories: <https://simplesamlphp.org/security/201802-01> and <https://simplesamlphp.org/security/201803-01>

Sorry, something went wrong.

All reactions

[![@thijskh](https://avatars.githubusercontent.com/u/3808792?s=80&v=4)](/thijskh)

Copy link

Member

### @thijskh **[thijskh](/thijskh)** commented on `[4f6af7f](/simplesamlphp/saml2/commit/4f6af7f69f29df8555a18b9bb7b646906b45924d)` [Mar 23, 2018](#commitcomment-28233997)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think the right place for that is the function's documentation in the library. I've created a PR for that. [robrichards/xmlseclibs#168](https://github.com/robrichards/xmlseclibs/pull/168)

Sorry, something went wrong.

 ‚ù§Ô∏è
1
 jrchamp reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fsaml2%2Fcommit%2F4f6af7f69f29df8555a18b9bb7b646906b45924d) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from simplesamlphp.org_07022e40_20250124_214416.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) ¬ª SSPSA 201803-01: Incorrect signature verification

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

March 2, 2018
## Affected versions

`simplesamlphp/saml2 < 3.1.4`
# 201803-01

**Incorrect signature verification**

### Background

An incorrect check of return values in the signature validation utilities allows an attacker to get invalid signatures
accepted as valid by forcing an error during validation.

### Description

The `HTTPRedirect` class of the SAML2 library has a method called `validateSignature()` that allows the verification of
the XML digital signature of a SAML 2 message with a given key. This method uses the `verifySignature()` method from
the `XMLSecurityKey` class to verify the signature with the given key, which in turn will
end up calling `openssl_verify()` depending on the signature algorithm used.

The `openssl_verify()` function returns `1` when the signature was successfully verified, `0` if it failed to verify
with the given key, and `-1` in case an error occurs. PHP allows translating numerical values to *boolean* implicitly,
with the following correspondences:

* `0` equals `false`.
* Non-zero equals `true`.

This means that an implicit conversion to boolean of the values returned by `openssl_verify()` will convert an error
state, signaled by the value `-1`, to a successful verification of the signature (represented by the boolean `true`).

The aforementioned method was performing an implicit conversion to boolean of the values returned
by the `verifySignature()` method, which subsequently will return the same output as `openssl_verify()` under most
circumstances. This means an error during signature verification is treated as a successful verification by the method.

### Affected versions

All **simplesamlphp/saml2** versions 0.x, 1.x, 2.x and 3.x are affected, up to (including) **1.10.5**, **2.3.7** and
**3.1.3**.

All SimpleSAMLphp versions are affected, up to (including) **1.15.3**.

### Impact

Upon successful exploitation, an invalid signature would be regarded as valid by an affected version of the software.
This allows attackers to modify or manually craft **SAML 2 messages** and, by triggering a signature validation
error in the affected party, get those messages accepted as valid and coming from a trusted entity. In practice, this
means full capabilities to impersonate any individual at a given service provider.

The issue can be exploited to get other invalid messages accepted as valid, though the security implications there are
minor.

In order to exploit the issue, **SAML 2 metadata must be registered by the vulnerable Service Provider for the
Identity Provider targeted by the attacker** (in `metadata/shib20-idp-remote.php`), and an incorrect context must be fed
to the signature validation routines, or an exceptional error must be triggered. So far, the following cases have been
identified:

* Using a DSA public key to validate an XML signature made with an RSA-related algorithm.
* Using an RSA public key to validate an XML signature made with a DSA-related algorithm.
* Exhausting available memory while verifying the signature.

SimpleSAMLphp supports **only RSA signatures and keys**. Therefore, it is not possible for an attacker to feed an
incorrect context by sending a signature with an incorrect algorithm. Upon reception of a DSA-SHA1 signature,
SimpleSAMLphp will refuse to perform the validation due to the algorithm not being supported. On the other hand, if an
attacker manages to trick a service provider operator to change the public key associated to a certain IdP to a DSA key,
signatures made with any combination of the RSA algorithm will be accepted, regardless of whether they are valid or not.
This means some serious misconfiguration or social engineering is needed in this case for a successful attack.

Regarding memory exhaustion, it is in theory possible to attack a service provider causing the consumption of all
available memory while a message with an invalid signature is being validated. However, memory exhaustion must happen
only during signature validation and not immediately before or after. This means exploitation of this case is extremely
difficult due to the small time window available for the attacker and the precise control that is needed over the
service provider.

All in all, the consequences of this issue are critical, so even though we consider it difficult to exploit, and
considering that other ways to trigger failures in signature validation could be possible but so far unidentified, we
recommend updating the affected software as soon as possible.

### Resolution

Upgrade to the latest versions of the SAML2 library.

For SimpleSAMLphp users, run `composer update` or upgrade to SimpleSAMLphp 1.15.4.Refer to the documentation for
instructions on how to [run composer](https://simplesamlphp.org/docs/stable/simplesamlphp-install-repo).

### Credit

This security issue was discovered during a security audit performed by Cure53 and reported on December 18, 2017. Later
on, after the release of version 1.15.3, John Maguire and Adam Goodman of Duo Security discovered and reported the
same issue.

![](/res/ssplogo-fish-2.svg)


