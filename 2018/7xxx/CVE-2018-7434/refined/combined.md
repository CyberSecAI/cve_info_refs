=== Content from kongxin.gitbook.io_19af4eb3_20250125_053751.html ===
[![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fzzcms-8-2-bug%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Dlight&width=32&dpr=4&quality=100&sign=8c0ea987&sv=2)![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fzzcms-8-2-bug%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Ddark&width=32&dpr=4&quality=100&sign=f075d927&sv=2)zzcms\_8.2\_Bug](/zzcms-8-2-bug)Search...Ctrl +â€†K

* [zzcms\_8.2\_Bug](/zzcms-8-2-bug)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-Mia1ploAHy9JUhDDceY)On this page

Was this helpful?

# zzcms\_8.2\_Bug

zzcms 8.2 bug

> [Suggested description]
> zzcms 8.2 allows remote attackers to discover the full path via a direct request to /3/qq\_connect2.0/API/class/ErrorCase.class.php or /3/ucenter\_api/code/friend.php.
>
> [Additional Information]
> The vulnerability was discovered by downloading the program's source code to local and online deployment tests.
>
> Location :
> domain/3/qq\_connect2.0/API/class/ErrorCase.class.php
>
> Code :
> require\_once(CLASS\_PATH."Recorder.class.php");
> Rows : 8
> Return error :
> Notice: Use of undefined constant CLASS\_PATH - assumed 'CLASS\_PATH' in /www/3/qq\_connect2.0/API/class/ErrorCase.class.php on line 8
> Warning: require\_once(CLASS\_PATHRecorder.class.php): failed to open stream: No such file or directory in /www/3/qq\_connect2.0/API/class/ErrorCase.class.php on line 8
> Fatal error: require\_once(): Failed opening required 'CLASS\_PATHRecorder.class.php' (include\_path='.;C:\php\pear') in /www/3/qq\_connect2.0/API/class/ErrorCase.class.php on line 8
>
> Harm:
> Web Site physical path leakage .
>
> Conditions for Execution :
> Normal access can
>
> Edition :
> zzcms 8.2
>
> Cause the cause :
> require\_once(): Failed opening required 'CLASS\_PATHRecorder.class.php' (include\_path='.;C:\php\pear') in /www/3/qq\_connect2.0/API/class/ErrorCase.class.php, cause path leakage.
>
> POC :
> <http://127.0.0.1/3/qq_connect2.0/API/class/ErrorCase.class.php>
>
> Location :
> domain/3/ucenter\_api/code/friend.php
>
> Code :
> $num = uc\_friend\_totalnum($Example\_uid);
>
> Rows : 14
>
> Return error :
> Fatal error: Call to undefined function uc\_friend\_totalnum() in /www/3/ucenter\_api/code/friend.php on line 14
>
> Harm :
> Web Site physical path leakage .
>
> Conditions for Execution :
> Normal access can
>
> Edition :
> zzcms 8.2
>
> Cause the cause :
> Call to undefined function uc\_friend\_totalnum() in /www/3/ucenter\_api/code/friend.php, cause path leakage.
>
> POC :
> <http://127.0.0.1/3/ucenter_api/code/friend.php>
>
> fix suggestions :
> Modify the application source code to avoid information leakage.
>
> [VulnerabilityType Other]
> Physical path leaked
>
> [Vendor of Product]
> ZZCMS
>
> [Affected Product Code Base]
> zzcms - 8.2
>
> [Affected Component]
> ErrorCase.class.php , Use of undefined constant CLASS\_PATH - assumed 'CLASS\_PATH' , require\_once(): Failed opening required 'CLASS\_PATHRecorder.class.php'
>
> [Attack Type]
> Remote
>
> [Impact Information Disclosure]
> true
>
> [Attack Vectors] The vulnerability is triggered by accessing the following URL : <http://127.0.0.1/3/qq_connect2.0/API/class/ErrorCase.class.php>
> <http://127.0.0.1/3/ucenter_api/code/friend.php>
>
> [Discoverer]
> kongxin

Last updated 3 years ago


