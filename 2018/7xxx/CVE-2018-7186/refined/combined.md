=== Content from security.gentoo.org_05c20dff_20250125_071046.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Leptonica: Multiple Vulnerabilities — GLSA **202312-01**

Several vulnerabilities have been found in Leptonice, the worst of which could lead to arbitrary code execution.

### Affected packages

| Package | **media-libs/leptonica** on all architectures |
| --- | --- |
| Affected versions | < **1.81.0** |
| Unaffected versions | >= **1.81.0** |

### Background

Leptonica is a C library for image processing and analysis.

### Description

Multiple vulnerabilities have been discovered in Leptonica. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Leptonica users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/leptonica-1.81.0"

```
### References

* [CVE-2017-18196](https://nvd.nist.gov/vuln/detail/CVE-2017-18196)
* [CVE-2018-7186](https://nvd.nist.gov/vuln/detail/CVE-2018-7186)
* [CVE-2018-7247](https://nvd.nist.gov/vuln/detail/CVE-2018-7247)
* [CVE-2018-7440](https://nvd.nist.gov/vuln/detail/CVE-2018-7440)
* [CVE-2018-7441](https://nvd.nist.gov/vuln/detail/CVE-2018-7441)
* [CVE-2018-7442](https://nvd.nist.gov/vuln/detail/CVE-2018-7442)
* [CVE-2022-38266](https://nvd.nist.gov/vuln/detail/CVE-2022-38266)

**Release date**

December 18, 2023

**Latest revision**

December 18, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [649752](https://bugs.gentoo.org/show_bug.cgi?id=649752)
* [869416](https://bugs.gentoo.org/show_bug.cgi?id=869416)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.debian.org_2bbb06a9_20250125_071043.html ===

# Debian Bug report logs - #890548 leptonlib: CVE-2018-7186: Stack buffer overflows

[![version graph](version.cgi?height=2;fixed=leptonlib%2F1.75.3-2;found=leptonlib%2F1.74.4-2;package=src%3Aleptonlib;width=2;absolute=0;collapse=1)](version.cgi?collapse=1;package=src%3Aleptonlib;absolute=0;found=leptonlib%2F1.74.4-2;info=1;fixed=leptonlib%2F1.75.3-2)

Package:
[src:leptonlib](pkgreport.cgi?src=leptonlib);
Maintainer for [src:leptonlib](pkgreport.cgi?src=leptonlib) is [Jeff Breidenbach <jab@debian.org>](pkgreport.cgi?maint=jab%40debian.org);

Reported by: [Ben Hutchings <ben@decadent.org.uk>](pkgreport.cgi?submitter=ben%40decadent.org.uk)

Date: Thu, 15 Feb 2018 20:39:02 UTC

Severity: *serious*

Tags: patch, security, upstream

Found in version leptonlib/1.74.4-2

Fixed in version leptonlib/1.75.3-2

**Done:** Jeff Breidenbach <jab@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=890548;mbox=yes), [status mbox](bugreport.cgi?bug=890548;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=890548;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Jeff Breidenbach <jab@debian.org>`:

`Bug#890548`; Package `src:leptonlib`.
(Thu, 15 Feb 2018 20:39:04 GMT) ([full text](bugreport.cgi?bug=890548;msg=2), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Jeff Breidenbach <jab@debian.org>`.
(Thu, 15 Feb 2018 20:39:04 GMT) ([full text](bugreport.cgi?bug=890548;msg=4), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=890548;msg=5), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: Stack buffer overflows
Date: Thu, 15 Feb 2018 20:37:06 +0000
```
Source: leptonlib
Version: 1.74.4-2
Severity: serious
Tags: security upstream

gplotRead() and ptaReadStream() read strings into stack buffers using
fscanf() without a length limit.

Ben.

-- System Information:
Debian Release: buster/sid
  APT prefers unstable-debug
  APT policy: (500, 'unstable-debug'), (500, 'stable-updates'), (500, 'stable'), (1, 'experimental')
Architecture: amd64 (x86_64)
Foreign Architectures: i386

Kernel: Linux 4.14.0-3-amd64 (SMP w/4 CPU cores)
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8), LANGUAGE=en_GB.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)
LSM: AppArmor: enabled

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jeff Breidenbach <jab@debian.org>`:

`Bug#890548`; Package `src:leptonlib`.
(Thu, 15 Feb 2018 21:36:03 GMT) ([full text](bugreport.cgi?bug=890548;msg=7), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Jeff Breidenbach <jeff@jab.org>`:

Extra info received and forwarded to list. Copy sent to `Jeff Breidenbach <jab@debian.org>`.
(Thu, 15 Feb 2018 21:36:03 GMT) ([full text](bugreport.cgi?bug=890548;msg=9), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 890548@bugs.debian.org ([full text](bugreport.cgi?bug=890548;msg=10), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=jeff%40jab.org)
From: Jeff Breidenbach <jeff@jab.org>
To: Ben Hutchings <ben@decadent.org.uk>, 890548@bugs.debian.org
Subject: Re: Bug#890548: Stack buffer overflows
Date: Thu, 15 Feb 2018 13:34:04 -0800
```
[[Message part 1](bugreport.cgi?att=0;bug=890548;msg=10) (text/plain, inline)]
```
```
This is just about strings, right? So something like this will fix the
problem
and resolve this bug? Or am I missing something?

char buf[L_BUF_SIZE];
-   fscanf(fp, "Rootname: %s\n", buf);
+   fscanf(fp, "Rootname: %L_BUF_SIZE_MINUS_ONEs%\n", buf);

```
```
[[Message part 2](bugreport.cgi?att=1;bug=890548;msg=10) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jeff Breidenbach <jab@debian.org>`:

`Bug#890548`; Package `src:leptonlib`.
(Fri, 16 Feb 2018 18:03:05 GMT) ([full text](bugreport.cgi?bug=890548;msg=12), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Jeff Breidenbach <jab@debian.org>`.
(Fri, 16 Feb 2018 18:03:05 GMT) ([full text](bugreport.cgi?bug=890548;msg=14), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 890548@bugs.debian.org ([full text](bugreport.cgi?bug=890548;msg=15), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Jeff Breidenbach <jeff@jab.org>, 890548@bugs.debian.org
Cc: Ben Hutchings <ben@decadent.org.uk>
Subject: Re: Bug#890548: Stack buffer overflows
Date: Fri, 16 Feb 2018 18:59:30 +0100
```
Control: retitle -1 leptonlib: [CVE-2018-7186](https://security-tracker.debian.org/tracker/CVE-2018-7186): Stack buffer overflows
Control: tags -1 + patch

Hi,

On Thu, Feb 15, 2018 at 01:34:04PM -0800, Jeff Breidenbach wrote:
> This is just about strings, right? So something like this will fix the
> problem
> and resolve this bug? Or am I missing something?
>
> char buf[L_BUF_SIZE];
> -   fscanf(fp, "Rootname: %s\n", buf);
> +   fscanf(fp, "Rootname: %L_BUF_SIZE_MINUS_ONEs%\n", buf);

Those seem to have been adressed upstream with commit
<https://github.com/DanBloomberg/leptonica/commit/ee301cb2029db8a6289c5295daa42bba7715e99a>

Regards,
Salvatore

```

---

**Changed Bug title to 'leptonlib: CVE-2018-7186: Stack buffer overflows' from 'Stack buffer overflows'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `890548-submit@bugs.debian.org`.
(Fri, 16 Feb 2018 18:03:05 GMT) ([full text](bugreport.cgi?bug=890548;msg=17), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=17), [link](#16)).

---

**Added tag(s) patch.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `890548-submit@bugs.debian.org`.
(Fri, 16 Feb 2018 18:03:06 GMT) ([full text](bugreport.cgi?bug=890548;msg=19), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=19), [link](#18)).

---

**Reply sent**
to `Jeff Breidenbach <jab@debian.org>`:

You have taken responsibility.
(Sat, 17 Feb 2018 00:09:03 GMT) ([full text](bugreport.cgi?bug=890548;msg=21), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=21), [link](#20)).

---

**Notification sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Bug acknowledged by developer.
(Sat, 17 Feb 2018 00:09:03 GMT) ([full text](bugreport.cgi?bug=890548;msg=23), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 890548-close@bugs.debian.org ([full text](bugreport.cgi?bug=890548;msg=24), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=jab%40debian.org)
From: Jeff Breidenbach <jab@debian.org>
To: 890548-close@bugs.debian.org
Subject: Bug#890548: fixed in leptonlib 1.75.3-2
Date: Sat, 17 Feb 2018 00:05:29 +0000
```
Source: leptonlib
Source-Version: 1.75.3-2

We believe that the bug you reported is fixed in the latest version of
leptonlib, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 890548@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Jeff Breidenbach <jab@debian.org> (supplier of updated leptonlib package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Fri, 16 Feb 2018 15:26:11 -0800
Source: leptonlib
Binary: libleptonica-dev liblept5 leptonica-progs
Architecture: source amd64
Version: 1.75.3-2
Distribution: unstable
Urgency: medium
Maintainer: Jeff Breidenbach <jab@debian.org>
Changed-By: Jeff Breidenbach <jab@debian.org>
Description:
 leptonica-progs - sample programs for Leptonica image processing library
 liblept5   - image processing library
 libleptonica-dev - image processing library
Closes: [890548](bugreport.cgi?bug=890548)
Changes:
 leptonlib (1.75.3-2) unstable; urgency=medium
 .
   * Fix fscanf buffer overflow (closes: #[890548](bugreport.cgi?bug=890548))
Checksums-Sha1:
 fd5683455eead027b875f8d695b9ebda92d1d775 1953 leptonlib_1.75.3-2.dsc
 e57babec0f89bdabc82e0445d28db351d1abcd6c 9652 leptonlib_1.75.3-2.debian.tar.xz
 de95eafb1ce33f31f4aa1f244ffa35f3c6b5eab7 32908 leptonica-progs-dbgsym_1.75.3-2_amd64.deb
 47ae72dadd341fa415a26c9ca4ac7cbb2c29a15a 17256 leptonica-progs_1.75.3-2_amd64.deb
 e0e19fbc6023e75c780fb2395fecd72586e95f16 7378 leptonlib_1.75.3-2_amd64.buildinfo
 3dda9a9420878ce5eb474920774fdc3d7f5098fc 2265884 liblept5-dbgsym_1.75.3-2_amd64.deb
 f77da6a98358e665767ede1dae047964b5488715 937076 liblept5_1.75.3-2_amd64.deb
 7ff27dab99646dec47dccf5392fdc9abb10c8827 1315132 libleptonica-dev_1.75.3-2_amd64.deb
Checksums-Sha256:
 f77da6e33fd633160b127195155039d2b6c5de59e68dd50f1b82248e5e63adb7 1953 leptonlib_1.75.3-2.dsc
 a212df5214c2c973de3cc548e21c3a8b419828baf35b6552174951cf406ad4f4 9652 leptonlib_1.75.3-2.debian.tar.xz
 7205e48ff78de2a94f0a78693e73e1cbc2dc4eaaf3ca0be0d723760fffa59484 32908 leptonica-progs-dbgsym_1.75.3-2_amd64.deb
 ed833619755a6cfb7b9cc62c0f4abe825483707270f83b55403d1ede79eb0f7a 17256 leptonica-progs_1.75.3-2_amd64.deb
 0efd73557a621cbacb3f78073114902a80f9cab022033bd49af62bc90c449aef 7378 leptonlib_1.75.3-2_amd64.buildinfo
 7ccdd044334d02d9b422af0ef06bfae2b191d01ced46053b05b8ab9f85dd62ff 2265884 liblept5-dbgsym_1.75.3-2_amd64.deb
 4a95356116cc7aba3982921085b0cb7caac0f6bee8f40365f13210e73260c8bf 937076 liblept5_1.75.3-2_amd64.deb
 9a5aab1812781dfe68ca2d6b8a35352a3ceaa26fbb1a638168b82c37f9ae5c00 1315132 libleptonica-dev_1.75.3-2_amd64.deb
Files:
 242a6b0011d64858c431ee104f3896fc 1953 graphics optional leptonlib_1.75.3-2.dsc
 1b85e954c32cfbbbe0e674a81a2d6126 9652 graphics optional leptonlib_1.75.3-2.debian.tar.xz
 73cfc755ff99b12dc16e80a6d3964cdb 32908 debug optional leptonica-progs-dbgsym_1.75.3-2_amd64.deb
 8f6e0bad3389f4d12a7929e522826693 17256 graphics optional leptonica-progs_1.75.3-2_amd64.deb
 a447c1d4fd82b97eae72580f980f1f39 7378 graphics optional leptonlib_1.75.3-2_amd64.buildinfo
 ca85f1f01a5964f31abb57b279b0435a 2265884 debug optional liblept5-dbgsym_1.75.3-2_amd64.deb
 0a9923690ab088fa05e5664674f7f879 937076 libs optional liblept5_1.75.3-2_amd64.deb
 6d1b4169f90db5a449daa38cd7d8a8bf 1315132 libdevel optional libleptonica-dev_1.75.3-2_amd64.deb

-----BEGIN PGP SIGNATURE-----

iQJDBAEBCAAtFiEEfzii+Ck3m3QwNJ0yqHaugwpJrNMFAlqHbnYPHGphYkBkZWJp
YW4ub3JnAAoJEKh2roMKSazT6F8P/3QOadUjx6kYXzLgp2e1+LU6FOq4UNAWZER3
vDaIWFwcTjo0aVuHJP45KmFhSuFN1rrAWVIhCSJTQbArS3pWJMU6L6fUicT0VvoB
e5or0nN3biwB1VR8ktzDGN2mmOLoSofpRcua7trXkZbqAH9qBktV9D7Kcxrgqw+X
2VdfhF8DLskp4MsLnan7D9fHvgSr7LKToYLqHQSC1paCyF2jLtdfORrvdCELloI3
2v4td5vRZfdZgxC9cOdJFCJFPcDJDOddp2ptUoiWSmIKztrfucBme7ukIVEdfwPP
4SEztAc9AGDJbZot9A4LnSA07/5cICWpSCC6NH9PyWtT4PqgO5VnYEg337MEFJFD
QSwJlbz7AGzvR9jviIx7hPK6Pk9zo33qXocgWGIB3kTNXqCrI7Ue+5ohmLHq3Pq0
M1mhjv36LMWMtSN7QLtqV9mta0bEstWjQLBpg4AXJJO5w8XgxBL+fwM2KpRZypNS
C/S878qENcWnobgiKVHmtjEmpEMUk5TL6s9nKxPq8lBg0X9Y7/87W2V2Y2c4ditX
fGUt23V4GuVBGGRO/JMJh4EJFCeGg2i63kCs7vLbsUy1i+qoq6ADQCwj4exzlkAR
+P2Bj6Rhg2jPOisWWLQ3rzmTVzNbSd6hyYrPCfxBdX2b26AJegzYAAAmpvZJXYMM
Bt2j6oIn
=TfRR
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 17 Mar 2018 07:27:49 GMT) ([full text](bugreport.cgi?bug=890548;msg=26), [mbox](bugreport.cgi?bug=890548;mbox=yes;msg=26), [link](#25)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=890548).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 07:10:43 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from lists.debian.org_617fe33d_20250125_071046.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DLA 1302-1] leptonlib security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1302-1] leptonlib security update
* *From*: "Santiago R.R." <santiagorr@riseup.net>
* *Date*: Wed, 7 Mar 2018 07:58:02 +0100
* *Message-id*: <[[🔎]](/msgid-search/20180307065802.is6kbw6iikmmwbpi%40fedora-23-dvm) [20180307065802.is6kbw6iikmmwbpi@fedora-23-dvm](msg00005.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : leptonlib
Version        : 1.69-3.1+deb7u2
CVE ID         : CVE-2018-7186 CVE-2018-7440
Debian Bug     : 890548 891932

Different flaws have been found in leptonlib, an image processing
library.

CVE-2018-7186

    Leptonica did not limit the number of characters in a %s format
    argument to fscanf or sscanf, that made it possible to remote
    attackers to cause a denial of service (stack-based buffer overflow)
    or possibly have unspecified other impact via a long string.

CVE-2018-7440

    The gplotMakeOutput function allowed command injection via a
    $(command) approach in the gplot rootname argument. This issue
    existed because of an incomplete fix for CVE-2018-3836.

For Debian 7 "Wheezy", these problems have been fixed in version
1.69-3.1+deb7u2.

We recommend that you upgrade your leptonlib packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpZEWh3HWO_k.pgp)**

*Description:* PGP signature

---



=== Content from github.com_03fa8593_20250126_070711.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DanBloomberg%2Fleptonica)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DanBloomberg](/DanBloomberg)
/
**[leptonica](/DanBloomberg/leptonica)**
Public

* [Notifications](/login?return_to=%2FDanBloomberg%2Fleptonica) You must be signed in to change notification settings
* [Fork
  397](/login?return_to=%2FDanBloomberg%2Fleptonica)
* [Star
   1.8k](/login?return_to=%2FDanBloomberg%2Fleptonica)

* [Code](/DanBloomberg/leptonica)
* [Issues
  62](/DanBloomberg/leptonica/issues)
* [Pull requests
  2](/DanBloomberg/leptonica/pulls)
* [Actions](/DanBloomberg/leptonica/actions)
* [Projects
  0](/DanBloomberg/leptonica/projects)
* [Wiki](/DanBloomberg/leptonica/wiki)
* [Security](/DanBloomberg/leptonica/security)
* [Insights](/DanBloomberg/leptonica/pulse)

Additional navigation options

* [Code](/DanBloomberg/leptonica)
* [Issues](/DanBloomberg/leptonica/issues)
* [Pull requests](/DanBloomberg/leptonica/pulls)
* [Actions](/DanBloomberg/leptonica/actions)
* [Projects](/DanBloomberg/leptonica/projects)
* [Wiki](/DanBloomberg/leptonica/wiki)
* [Security](/DanBloomberg/leptonica/security)
* [Insights](/DanBloomberg/leptonica/pulse)

## Commit

[Permalink](/DanBloomberg/leptonica/commit/ee301cb2029db8a6289c5295daa42bba7715e99a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security fixes: expect final changes for release 1.75.3.

[Browse files](/DanBloomberg/leptonica/tree/ee301cb2029db8a6289c5295daa42bba7715e99a)
Browse the repository at this point in the history

```
* Fixed a debian security issue with fscanf() reading a string with
  possible buffer overflow.
* There were also a few similar situations with sscanf().
```

* Loading branch information

[![@DanBloomberg](https://avatars.githubusercontent.com/u/16688684?s=40&v=4)](/DanBloomberg)

[DanBloomberg](/DanBloomberg/leptonica/commits?author=DanBloomberg "View all commits by DanBloomberg")
committed
Feb 15, 2018

1 parent
[24bfc6c](/DanBloomberg/leptonica/commit/24bfc6cbf608f56b90c33aa749c37cfa7dfb86fc)

commit ee301cb

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**56 additions**
and
**55 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* prog

  + prog/xtractprotos.c
    [xtractprotos.c](#diff-d4d23c15d5f3c4c2e85b2bd3505c06e186102e77d6230d06152bd3f37e142161)
* src

  + src/gplot.c
    [gplot.c](#diff-4df5c0e17556421003ba1160f1aeabd56b3cadfd16548f11f42442baafe1267c)
  + src/ptabasic.c
    [ptabasic.c](#diff-c6be46c50e00a786d6fde5e6eea070c0202394468e652ae11c3b41ee6356cad4)
  + src/sel1.c
    [sel1.c](#diff-6316d4f162fe1e441c9cbbcfa175bcdcc2ae5d02ea2a9222a370594109d4c0a1)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/DanBloomberg/leptonica/blob/ee301cb2029db8a6289c5295daa42bba7715e99a/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -63,9 +63,10 @@ www.leptonica.org |
|  |  |  |
|  |  |  |
|  |  | ## Open Source Projects that use Leptonica ## |
|  |  | \* [php](http://en.wikipedia.org/wiki/PHP) (scripting language for dynamic web pages) |
|  |  | \* [tesseract](https://github.com/tesseract-ocr/tesseract/) (optical character recognition) |
|  |  | \* [OpenCV](https://github.com/opencv/opencv) (computer vision library) |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)       Sorry, something went wrong.           Copy link    Quote reply     @egorpugin **[egorpugin](/egorpugin)** [Feb 17, 2018](#r27623217) Collaborator   By the way, where is leptonica used in opencv? In contrib.text or somewhere else?      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)       Sorry, something went wrong.           Copy link    Quote reply     @DanBloomberg **[DanBloomberg](/DanBloomberg)** via email [Feb 18, 2018](#r27634176) Author  Owner  It's indirect. About 6 months ago, OpenCV became dependent on tesseract. The debian popcon stats show the effect: <https://qa.debian.org/popcon.php?package=leptonlib>  … On Sat, Feb 17, 2018 at 1:17 AM, Egor Pugin \*\*\*@\*\*\*.\*\*\*> wrote: By the way, where is leptonica used in opencv? In contrib.text or somewhere else? — You are receiving this because you authored the thread. Reply to this email directly, view it on GitHub <[ee301cb#commitcomment-27623217](https://github.com/DanBloomberg/leptonica/commit/ee301cb2029db8a6289c5295daa42bba7715e99a#commitcomment-27623217)>, or mute the thread <<https://github.com/notifications/unsubscribe-auth/AP6mLLiwxzLngyO1LGqysEoSZArPCUGyks5tVpkSgaJpZM4SJL1o>> .        All reactions | | |
|  |  | \* [jbig2enc](http://www.imperialviolet.org/jbig2.html) (encodes multipage binary image documents with jbig2 compression) |
|  |  | \* [php](http://en.wikipedia.org/wiki/PHP) (scripting language for dynamic web pages) |
|  |  |  |
|  |  | ## Major contributors to Leptonica ## |
|  |  | \* Tom Powers: Tom has supported Leptonica on Windows for many years. He has made many contributions to code quality and documentation, including the beautiful "unofficial documentation" on the web site. Without his effort, Leptonica would not run today on Windows. |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[prog/xtractprotos.c](#diff-d4d23c15d5f3c4c2e85b2bd3505c06e186102e77d6230d06152bd3f37e142161 "prog/xtractprotos.c")

Show comments

[View file](/DanBloomberg/leptonica/blob/ee301cb2029db8a6289c5295daa42bba7715e99a/prog/xtractprotos.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -87,7 +87,7 @@ |
|  |  | #include <string.h> |
|  |  | #include "allheaders.h" |
|  |  |  |
|  |  | static const l\_int32 L\_BUF\_SIZE = 512; |
|  |  | static const l\_int32 L\_BUFSIZE = 512; /\* hardcoded below in sscanf() \*/ |
|  |  | static const char \*version = "1.5"; |
|  |  |  |
|  |  |  |
| Expand All | | @@ -96,7 +96,7 @@ int main(int argc, |
|  |  | { |
|  |  | char \*filein, \*str, \*tempfile, \*prestring, \*outprotos, \*protostr; |
|  |  | const char \*spacestr = " "; |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | l\_uint8 \*allheaders; |
|  |  | l\_int32 i, maxindex, in\_line, nflags, protos\_added, firstfile, len, ret; |
|  |  | size\_t nbytes; |
| Expand Down  Expand Up | | @@ -125,12 +125,12 @@ static char mainName[] = "xtractprotos"; |
|  |  | if (argv[i][0] == '-') { |
|  |  | if (!strncmp(argv[i], "-prestring", 10)) { |
|  |  | nflags++; |
|  |  | ret = sscanf(argv[i] + 1, "prestring=%s", buf); |
|  |  | ret = sscanf(argv[i] + 1, "prestring=%490s", buf); |
|  |  | if (ret != 1) { |
|  |  | fprintf(stderr, "parse failure for prestring\n"); |
|  |  | return 1; |
|  |  | } |
|  |  | if ((len = strlen(buf)) > L\_BUF\_SIZE - 3) { |
|  |  | if ((len = strlen(buf)) > L\_BUFSIZE - 3) { |
|  |  | L\_WARNING("prestring too large; omitting!\n", mainName); |
|  |  | } else { |
|  |  | buf[len] = ' '; |
| Expand All | | @@ -139,7 +139,7 @@ static char mainName[] = "xtractprotos"; |
|  |  | } |
|  |  | } else if (!strncmp(argv[i], "-protos", 7)) { |
|  |  | nflags++; |
|  |  | ret = sscanf(argv[i] + 1, "protos=%s", buf); |
|  |  | ret = sscanf(argv[i] + 1, "protos=%490s", buf); |
|  |  | if (ret != 1) { |
|  |  | fprintf(stderr, "parse failure for protos\n"); |
|  |  | return 1; |
| Expand All | | @@ -165,7 +165,7 @@ static char mainName[] = "xtractprotos"; |
|  |  | /\* First the extern C head \*/ |
|  |  | sa = sarrayCreate(0); |
|  |  | sarrayAddString(sa, (char \*)"/\*", L\_COPY); |
|  |  | snprintf(buf, L\_BUF\_SIZE, |
|  |  | snprintf(buf, L\_BUFSIZE, |
|  |  | " \* These prototypes were autogen'd by xtractprotos, v. %s", |
|  |  | version); |
|  |  | sarrayAddString(sa, buf, L\_COPY); |
| Expand All | | @@ -190,7 +190,7 @@ static char mainName[] = "xtractprotos"; |
|  |  | len = strlen(filein); |
|  |  | if (filein[len - 1] == 'h') /\* skip .h files \*/ |
|  |  | continue; |
|  |  | snprintf(buf, L\_BUF\_SIZE, "cpp -ansi -DNO\_PROTOS %s %s", |
|  |  | snprintf(buf, L\_BUFSIZE, "cpp -ansi -DNO\_PROTOS %s %s", |
|  |  | filein, tempfile); |
|  |  | ret = system(buf); /\* cpp \*/ |
|  |  | if (ret) { |
| Expand Down | |  |

72 changes: 36 additions & 36 deletions

72
[src/gplot.c](#diff-4df5c0e17556421003ba1160f1aeabd56b3cadfd16548f11f42442baafe1267c "src/gplot.c")

Show comments

[View file](/DanBloomberg/leptonica/blob/ee301cb2029db8a6289c5295daa42bba7715e99a/src/gplot.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -50,9 +50,9 @@ |
|  |  | \* l\_int32 gplotWrite() |
|  |  | \* |
|  |  | \* |
|  |  | \* Utility for programmatic plotting using gnuplot 7.3.2 or later |
|  |  | \* Utility for programmatic plotting using gnuplot 4.6 or later |
|  |  | \* Enabled: |
|  |  | \* ~ output to png (color), ps (mono), x11 (color), latex (mono) |
|  |  | \* ~ output to png (color), ps and eps (mono), latex (mono) |
|  |  | \* ~ optional title for graph |
|  |  | \* ~ optional x and y axis labels |
|  |  | \* ~ multiple plots on one frame |
| Expand Down  Expand Up | | @@ -100,7 +100,7 @@ |
|  |  | #include <string.h> |
|  |  | #include "allheaders.h" |
|  |  |  |
|  |  | static const l\_int32 L\_BUF\_SIZE = 512; |
|  |  | static const l\_int32 L\_BUFSIZE = 512; /\* hardcoded below in fscanf \*/ |
|  |  |  |
|  |  | const char \*gplotstylenames[] = {"with lines", |
|  |  | "with points", |
| Expand Down  Expand Up | | @@ -142,7 +142,7 @@ gplotCreate(const char \*rootname, |
|  |  | const char \*ylabel) |
|  |  | { |
|  |  | char \*newroot; |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | l\_int32 badchar; |
|  |  | GPLOT \*gplot; |
|  |  |  |
| Expand All | | @@ -169,16 +169,16 @@ GPLOT \*gplot; |
|  |  | newroot = genPathname(rootname, NULL); |
|  |  | gplot->rootname = newroot; |
|  |  | gplot->outformat = outformat; |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.cmd", rootname); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.cmd", rootname); |
|  |  | gplot->cmdname = stringNew(buf); |
|  |  | if (outformat == GPLOT\_PNG) |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.png", newroot); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.png", newroot); |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)       Sorry, something went wrong.           Copy link    Quote reply     @setharnold **[setharnold](/setharnold)** [Feb 17, 2018](#r27620773)  If `newroot` is 508 characters or more, the results of `buf` will not contain (some or all of) the `.png` contents. I always like to see the return value of `snprintf()` checked not just for less than zero (obvious failures) but also greater than the buf size, a kind of failure that may be every bit as catastrophic as a buffer overflow. None of these cases look that severe. But I'd like to encourage the habit of checking the error return value from `snprintf()`. Thanks.      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a)       Sorry, something went wrong.           Copy link    Quote reply     @DanBloomberg **[DanBloomberg](/DanBloomberg)** [Feb 17, 2018](#r27622339) Author  Owner   Thank you for the suggestion -- it makes sense.  I'll check this out next week and see what the failure modes with big strings look like.      All reactions | | |
|  |  | else if (outformat == GPLOT\_PS) |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.ps", newroot); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.ps", newroot); |
|  |  | else if (outformat == GPLOT\_EPS) |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.eps", newroot); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.eps", newroot); |
|  |  | else if (outformat == GPLOT\_LATEX) |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.tex", newroot); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.tex", newroot); |
|  |  | gplot->outname = stringNew(buf); |
|  |  | if (title) gplot->title = stringNew(title); |
|  |  | if (xlabel) gplot->xlabel = stringNew(xlabel); |
| Expand Down  Expand Up | | @@ -266,7 +266,7 @@ gplotAddPlot(GPLOT \*gplot, |
|  |  | l\_int32 plotstyle, |
|  |  | const char \*plottitle) |
|  |  | { |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | char emptystring[] = ""; |
|  |  | char \*datastr, \*title; |
|  |  | l\_int32 n, i; |
| Expand Down  Expand Up | | @@ -303,7 +303,7 @@ SARRAY \*sa; |
|  |  |  |
|  |  | /\* Generate and save data filename \*/ |
|  |  | gplot->nplots++; |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%s.data.%d", gplot->rootname, gplot->nplots); |
|  |  | snprintf(buf, L\_BUFSIZE, "%s.data.%d", gplot->rootname, gplot->nplots); |
|  |  | sarrayAddString(gplot->datanames, buf, L\_COPY); |
|  |  |  |
|  |  | /\* Generate data and save as a string \*/ |
| Expand All | | @@ -314,7 +314,7 @@ SARRAY \*sa; |
|  |  | else |
|  |  | valx = startx + i \* delx; |
|  |  | numaGetFValue(nay, i, &valy); |
|  |  | snprintf(buf, L\_BUF\_SIZE, "%f %f\n", valx, valy); |
|  |  | snprintf(buf, L\_BUFSIZE, "%f %f\n", valx, valy); |
|  |  | sarrayAddString(sa, buf, L\_COPY); |
|  |  | } |
|  |  | datastr = sarrayToString(sa, 0); |
| Expand Down  Expand Up | | @@ -378,7 +378,7 @@ gplotSetScaling(GPLOT \*gplot, |
|  |  | l\_int32 |
|  |  | gplotMakeOutput(GPLOT \*gplot) |
|  |  | { |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | char \*cmdname; |
|  |  | l\_int32 ignore; |
|  |  |  |
| Expand All | | @@ -392,9 +392,9 @@ l\_int32 ignore; |
|  |  | cmdname = genPathname(gplot->cmdname, NULL); |
|  |  |  |
|  |  | #ifndef \_WIN32 |
|  |  | snprintf(buf, L\_BUF\_SIZE, "gnuplot %s", cmdname); |
|  |  | snprintf(buf, L\_BUFSIZE, "gnuplot %s", cmdname); |
|  |  | #else |
|  |  | snprintf(buf, L\_BUF\_SIZE, "wgnuplot %s", cmdname); |
|  |  | snprintf(buf, L\_BUFSIZE, "wgnuplot %s", cmdname); |
|  |  | #endif /\* \_WIN32 \*/ |
|  |  |  |
|  |  | #ifndef OS\_IOS /\* iOS 11 does not support system() \*/ |
| Expand All | | @@ -415,7 +415,7 @@ l\_int32 ignore; |
|  |  | l\_int32 |
|  |  | gplotGenCommandFile(GPLOT \*gplot) |
|  |  | { |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | char \*cmdstr, \*plottitle, \*dataname; |
|  |  | l\_int32 i, plotstyle, nplots; |
|  |  | FILE \*fp; |
| Expand All | | @@ -430,43 +430,43 @@ FILE \*fp; |
|  |  |  |
|  |  | /\* Generate command data instructions \*/ |
|  |  | if (gplot->title) { /\* set title \*/ |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set title '%s'", gplot->title); |
|  |  | snprintf(buf, L\_BUFSIZE, "set title '%s'", gplot->title); |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  | } |
|  |  | if (gplot->xlabel) { /\* set xlabel \*/ |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set xlabel '%s'", gplot->xlabel); |
|  |  | snprintf(buf, L\_BUFSIZE, "set xlabel '%s'", gplot->xlabel); |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  | } |
|  |  | if (gplot->ylabel) { /\* set ylabel \*/ |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set ylabel '%s'", gplot->ylabel); |
|  |  | snprintf(buf, L\_BUFSIZE, "set ylabel '%s'", gplot->ylabel); |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  | } |
|  |  |  |
|  |  | /\* Set terminal type and output \*/ |
|  |  | if (gplot->outformat == GPLOT\_PNG) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set terminal png; set output '%s'", |
|  |  | snprintf(buf, L\_BUFSIZE, "set terminal png; set output '%s'", |
|  |  | gplot->outname); |
|  |  | } else if (gplot->outformat == GPLOT\_PS) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set terminal postscript; set output '%s'", |
|  |  | snprintf(buf, L\_BUFSIZE, "set terminal postscript; set output '%s'", |
|  |  | gplot->outname); |
|  |  | } else if (gplot->outformat == GPLOT\_EPS) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, |
|  |  | snprintf(buf, L\_BUFSIZE, |
|  |  | "set terminal postscript eps; set output '%s'", |
|  |  | gplot->outname); |
|  |  | } else if (gplot->outformat == GPLOT\_LATEX) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set terminal latex; set output '%s'", |
|  |  | snprintf(buf, L\_BUFSIZE, "set terminal latex; set output '%s'", |
|  |  | gplot->outname); |
|  |  | } |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  |  |
|  |  | if (gplot->scaling == GPLOT\_LOG\_SCALE\_X || |
|  |  | gplot->scaling == GPLOT\_LOG\_SCALE\_X\_Y) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set logscale x"); |
|  |  | snprintf(buf, L\_BUFSIZE, "set logscale x"); |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  | } |
|  |  | if (gplot->scaling == GPLOT\_LOG\_SCALE\_Y || |
|  |  | gplot->scaling == GPLOT\_LOG\_SCALE\_X\_Y) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "set logscale y"); |
|  |  | snprintf(buf, L\_BUFSIZE, "set logscale y"); |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -476,17 +476,17 @@ FILE \*fp; |
|  |  | dataname = sarrayGetString(gplot->datanames, i, L\_NOCOPY); |
|  |  | numaGetIValue(gplot->plotstyles, i, &plotstyle); |
|  |  | if (nplots == 1) { |
|  |  | snprintf(buf, L\_BUF\_SIZE, "plot '%s' title '%s' %s", |
|  |  | snprintf(buf, L\_BUFSIZE, "plot '%s' title '%s' %s", |
|  |  | dataname, plottitle, gplotstylenames[plotstyle]); |
|  |  | } else { |
|  |  | if (i == 0) |
|  |  | snprintf(buf, L\_BUF\_SIZE, "plot '%s' title '%s' %s, \\", |
|  |  | snprintf(buf, L\_BUFSIZE, "plot '%s' title '%s' %s, \\", |
|  |  | dataname, plottitle, gplotstylenames[plotstyle]); |
|  |  | else if (i < nplots - 1) |
|  |  | snprintf(buf, L\_BUF\_SIZE, " '%s' title '%s' %s, \\", |
|  |  | snprintf(buf, L\_BUFSIZE, " '%s' title '%s' %s, \\", |
|  |  | dataname, plottitle, gplotstylenames[plotstyle]); |
|  |  | else |
|  |  | snprintf(buf, L\_BUF\_SIZE, " '%s' title '%s' %s", |
|  |  | snprintf(buf, L\_BUFSIZE, " '%s' title '%s' %s", |
|  |  | dataname, plottitle, gplotstylenames[plotstyle]); |
|  |  | } |
|  |  | sarrayAddString(gplot->cmddata, buf, L\_COPY); |
| Expand Down  Expand Up | | @@ -820,7 +820,7 @@ NUMA \*nay; |
|  |  | GPLOT \* |
|  |  | gplotRead(const char \*filename) |
|  |  | { |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | char \*rootname, \*title, \*xlabel, \*ylabel, \*ignores; |
|  |  | l\_int32 outformat, ret, version, ignore; |
|  |  | FILE \*fp; |
| Expand All | | @@ -844,16 +844,16 @@ GPLOT \*gplot; |
|  |  | return (GPLOT \*)ERROR\_PTR("invalid gplot version", procName, NULL); |
|  |  | } |
|  |  |  |
|  |  | ignore = fscanf(fp, "Rootname: %s\n", buf); |
|  |  | ignore = fscanf(fp, "Rootname: %511s\n", buf); /\* L\_BUFSIZE - 1 \*/ |
|  |  | rootname = stringNew(buf); |
|  |  | ignore = fscanf(fp, "Output format: %d\n", &outformat); |
|  |  | ignores = fgets(buf, L\_BUF\_SIZE, fp); /\* Title: ... \*/ |
|  |  | ignores = fgets(buf, L\_BUFSIZE, fp); /\* Title: ... \*/ |
|  |  | title = stringNew(buf + 7); |
|  |  | title[strlen(title) - 1] = '\0'; |
|  |  | ignores = fgets(buf, L\_BUF\_SIZE, fp); /\* X axis label: ... \*/ |
|  |  | ignores = fgets(buf, L\_BUFSIZE, fp); /\* X axis label: ... \*/ |
|  |  | xlabel = stringNew(buf + 14); |
|  |  | xlabel[strlen(xlabel) - 1] = '\0'; |
|  |  | ignores = fgets(buf, L\_BUF\_SIZE, fp); /\* Y axis label: ... \*/ |
|  |  | ignores = fgets(buf, L\_BUFSIZE, fp); /\* Y axis label: ... \*/ |
|  |  | ylabel = stringNew(buf + 14); |
|  |  | ylabel[strlen(ylabel) - 1] = '\0'; |
|  |  |  |
| Expand All | | @@ -872,7 +872,7 @@ GPLOT \*gplot; |
|  |  | sarrayDestroy(&gplot->plottitles); |
|  |  | numaDestroy(&gplot->plotstyles); |
|  |  |  |
|  |  | ignore = fscanf(fp, "Commandfile name: %s\n", buf); |
|  |  | ignore = fscanf(fp, "Commandfile name: %511s\n", buf); /\* L\_BUFSIZE - 1 \*/ |
|  |  | stringReplace(&gplot->cmdname, buf); |
|  |  | ignore = fscanf(fp, "\nCommandfile data:"); |
|  |  | gplot->cmddata = sarrayReadStream(fp); |
| Expand All | | @@ -886,7 +886,7 @@ GPLOT \*gplot; |
|  |  | gplot->plotstyles = numaReadStream(fp); |
|  |  |  |
|  |  | ignore = fscanf(fp, "Number of plots: %d\n", &gplot->nplots); |
|  |  | ignore = fscanf(fp, "Output file name: %s\n", buf); |
|  |  | ignore = fscanf(fp, "Output file name: %511s\n", buf); |
|  |  | stringReplace(&gplot->outname, buf); |
|  |  | ignore = fscanf(fp, "Axis scaling: %d\n", &gplot->scaling); |
|  |  |  |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/ptabasic.c](#diff-c6be46c50e00a786d6fde5e6eea070c0202394468e652ae11c3b41ee6356cad4 "src/ptabasic.c")

Show comments

[View file](/DanBloomberg/leptonica/blob/ee301cb2029db8a6289c5295daa42bba7715e99a/src/ptabasic.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -689,7 +689,7 @@ PTA \*pta; |
|  |  | PTA \* |
|  |  | ptaReadStream(FILE \*fp) |
|  |  | { |
|  |  | char typestr[128]; |
|  |  | char typestr[128]; /\* hardcoded below in fscanf \*/ |
|  |  | l\_int32 i, n, ix, iy, type, version; |
|  |  | l\_float32 x, y; |
|  |  | PTA \*pta; |
| Expand All | | @@ -703,7 +703,7 @@ PTA \*pta; |
|  |  | return (PTA \*)ERROR\_PTR("not a pta file", procName, NULL); |
|  |  | if (version != PTA\_VERSION\_NUMBER) |
|  |  | return (PTA \*)ERROR\_PTR("invalid pta version", procName, NULL); |
|  |  | if (fscanf(fp, " Number of pts = %d; format = %s\n", &n, typestr) != 2) |
|  |  | if (fscanf(fp, " Number of pts = %d; format = %127s\n", &n, typestr) != 2) |
|  |  | return (PTA \*)ERROR\_PTR("not a pta file", procName, NULL); |
|  |  | if (!strcmp(typestr, "float")) |
|  |  | type = 0; |
| Expand Down | |  |

18 changes: 9 additions & 9 deletions

18
[src/sel1.c](#diff-6316d4f162fe1e441c9cbbcfa175bcdcc2ae5d02ea2a9222a370594109d4c0a1 "src/sel1.c")

Show comments

[View file](/DanBloomberg/leptonica/blob/ee301cb2029db8a6289c5295daa42bba7715e99a/src/sel1.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -141,7 +141,7 @@ |
|  |  | #include <string.h> |
|  |  | #include "allheaders.h" |
|  |  |  |
|  |  | static const l\_int32 L\_BUF\_SIZE = 256; |
|  |  | static const l\_int32 L\_BUFSIZE = 256; /\* hardcoded below in sscanf \*/ |
|  |  | static const l\_int32 INITIAL\_PTR\_ARRAYSIZE = 50; /\* n'import quoi \*/ |
|  |  | static const l\_int32 MANY\_SELS = 1000; |
|  |  |  |
| Expand Down  Expand Up | | @@ -978,7 +978,7 @@ selaGetCombName(SELA \*sela, |
|  |  | l\_int32 direction) |
|  |  | { |
|  |  | char \*selname; |
|  |  | char combname[L\_BUF\_SIZE]; |
|  |  | char combname[L\_BUFSIZE]; |
|  |  | l\_int32 i, nsels, sx, sy, found; |
|  |  | SEL \*sel; |
|  |  |  |
| Expand All | | @@ -991,9 +991,9 @@ SEL \*sel; |
|  |  |  |
|  |  | /\* Derive the comb name we're looking for \*/ |
|  |  | if (direction == L\_HORIZ) |
|  |  | snprintf(combname, L\_BUF\_SIZE, "sel\_comb\_%dh", size); |
|  |  | snprintf(combname, L\_BUFSIZE, "sel\_comb\_%dh", size); |
|  |  | else /\* direction == L\_VERT \*/ |
|  |  | snprintf(combname, L\_BUF\_SIZE, "sel\_comb\_%dv", size); |
|  |  | snprintf(combname, L\_BUFSIZE, "sel\_comb\_%dv", size); |
|  |  |  |
|  |  | found = FALSE; |
|  |  | nsels = selaGetCount(sela); |
| Expand Down  Expand Up | | @@ -1041,7 +1041,7 @@ static void |
|  |  | selaComputeCompositeParameters(const char \*fileout) |
|  |  | { |
|  |  | char \*str, \*nameh1, \*nameh2, \*namev1, \*namev2; |
|  |  | char buf[L\_BUF\_SIZE]; |
|  |  | char buf[L\_BUFSIZE]; |
|  |  | l\_int32 size, size1, size2, len; |
|  |  | SARRAY \*sa; |
|  |  | SELA \*selabasic, \*selacomb; |
| Expand All | | @@ -1060,7 +1060,7 @@ SELA \*selabasic, \*selacomb; |
|  |  | nameh2 = stringNew(""); |
|  |  | namev2 = stringNew(""); |
|  |  | } |
|  |  | snprintf(buf, L\_BUF\_SIZE, |
|  |  | snprintf(buf, L\_BUFSIZE, |
|  |  | " { %d, %d, %d, \"%s\", \"%s\", \"%s\", \"%s\" },", |
|  |  | size, size1, size2, nameh1, nameh2, namev1, namev2); |
|  |  | sarrayAddString(sa, buf, L\_COPY); |
| Expand Down  Expand Up | | @@ -1409,7 +1409,7 @@ SEL \* |
|  |  | selReadStream(FILE \*fp) |
|  |  | { |
|  |  | char \*selname; |
|  |  | char linebuf[L\_BUF\_SIZE]; |
|  |  | char linebuf[L\_BUFSIZE]; |
|  |  | l\_int32 sy, sx, cy, cx, i, j, version, ignore; |
|  |  | SEL \*sel; |
|  |  |  |
| Expand All | | @@ -1423,10 +1423,10 @@ SEL \*sel; |
|  |  | if (version != SEL\_VERSION\_NUMBER) |
|  |  | return (SEL \*)ERROR\_PTR("invalid sel version", procName, NULL); |
|  |  |  |
|  |  | if (fgets(linebuf, L\_BUF\_SIZE, fp) == NULL) |
|  |  | if (fgets(linebuf, L\_BUFSIZE, fp) == NULL) |
|  |  | return (SEL \*)ERROR\_PTR("error reading into linebuf", procName, NULL); |
|  |  | selname = stringNew(linebuf); |
|  |  | sscanf(linebuf, " ------ %s ------", selname); |
|  |  | sscanf(linebuf, " ------ %200s ------", selname); |
|  |  |  |
|  |  | if (fscanf(fp, " sy = %d, sx = %d, cy = %d, cx = %d\n", |
|  |  | &sy, &sx, &cy, &cx) != 4) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ee301cb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDanBloomberg%2Fleptonica%2Fcommit%2Fee301cb2029db8a6289c5295daa42bba7715e99a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security-tracker.debian.org_901d242d_20250126_070711.html ===

# CVE-2018-7186

| **Name** | CVE-2018-7186 |
| --- | --- |
| **Description** | Leptonica before 1.75.3 does not limit the number of characters in a %s format argument to fscanf or sscanf, which allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a long string, as demonstrated by the gplotRead and ptaReadStream functions. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2018-7186) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-7186); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2018-7186), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2018-7186), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2018-7186), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2018-7186), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-7186), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2018-7186), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2018-7186), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2018-7186)/[CVE](https://www.suse.com/security/cve/CVE-2018-7186/), GitHub [advisories](https://github.com/advisories?query=CVE-2018-7186)/[code](https://github.com/search?type=Code&q=%22CVE-2018-7186%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2018-7186%22), [web search](https://duckduckgo.com/html?q=%22CVE-2018-7186%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-1302-1](/tracker/DLA-1302-1) |
| **Debian Bugs** | [890548](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=890548) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [leptonlib](/tracker/source-package/leptonlib) ([PTS](https://tracker.debian.org/pkg/leptonlib)) | bullseye | 1.79.0-1.1+deb11u1 | fixed |
|  | bookworm | 1.82.0-3 | fixed |
|  | sid, trixie | 1.84.1-4 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [leptonlib](/tracker/source-package/leptonlib) | source | wheezy | 1.69-3.1+deb7u2 |  | [DLA-1302-1](/tracker/DLA-1302-1) |  |
| [leptonlib](/tracker/source-package/leptonlib) | source | (unstable) | 1.75.3-2 | low |  | [890548](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=890548) |

## Notes

```
<https://github.com/DanBloomberg/leptonica/commit/ee301cb2029db8a6289c5295daa42bba7715e99a>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from lists.debian.org_d5ff208b_20250125_071046.html ===


---

[[Date Prev](msg00053.html)][[Date Next](msg00055.html)]
[[Thread Prev](msg00050.html)][[Thread Next](msg00060.html)]
[[Date Index](maillist.html#00054)]
[[Thread Index](threads.html#00054)]

# Re: upload leptonlib

---

* *To*: "Roberto C." Sánchez <roberto@debian.org>, Abhijith PA <abhijith@disroot.org>
* *Cc*: Debian LTS <debian-lts@lists.debian.org>, leptonlib@packages.debian.org
* *Subject*: Re: upload leptonlib
* *From*: Ben Hutchings <ben@decadent.org.uk>
* *Date*: Thu, 15 Feb 2018 21:34:48 +0000
* *Message-id*: <[[🔎]](/msgid-search/1518730488.2617.129.camel%40decadent.org.uk) [1518730488.2617.129.camel@decadent.org.uk](msg00054.html)>
* *In-reply-to*: <[[🔎]](/msgid-search/20180215032335.xqgqbvkpr65ftj7b%40camaguey.connexer.com) [20180215032335.xqgqbvkpr65ftj7b@camaguey.connexer.com](msg00050.html)>
* *References*: <[[🔎]](/msgid-search/bc8204ac-f111-d069-5095-29dfb1becd63%40disroot.org) [bc8204ac-f111-d069-5095-29dfb1becd63@disroot.org](msg00049.html)> <[[🔎]](/msgid-search/20180215032335.xqgqbvkpr65ftj7b%40camaguey.connexer.com) [20180215032335.xqgqbvkpr65ftj7b@camaguey.connexer.com](msg00050.html)>

---

```
On Wed, 2018-02-14 at 22:23 -0500, Roberto C. Sánchez wrote:
> On Wed, Feb 14, 2018 at 02:56:24PM +0530, Abhijith PA wrote:
> > Hello.
> >
> > I prepared LTS security update for leptonlib. Please review and upload.
> > You can find debdiff along with the mail.
> > link:
> > [https://mentors.debian.net/debian/pool/main/l/leptonlib/leptonlib_1.69-3.1+deb7u1.dsc](https://mentors.debian.net/debian/pool/main/l/leptonlib/leptonlib_1.69-3.1%2Bdeb7u1.dsc)
> >
>
> Abhijith,
>
> I have reviewed and uploaded the package. While you backported the
> upstream fix, I feel like their approach falls under item #2 of "The Six
> Dumbest Ideas in Computer Security [0]": Enumerating Badness. I cannot
> help but wonder if another vulnerability will be uncovered later that
> uses different characters that are not being checked.

I found one already: it filters out `command` but not $(command).

I'm afraid this library appears to have been written without any regard
for security, or even the existence of multiuser systems.

Bug #890548 (stack buffer overflows) is probably exploitable in wheezy,
and I think there are more instances.

Bug #885704 (hardcoded paths in /tmp) has been closed in unstable but I
can still see:

$ strings /usr/bin/printsplitimage | grep ^/tmp/
/tmp/split
$ strings /usr/bin/splitimage2pdf | grep ^/tmp/
/tmp/junk_split_image.ps
$ strings /usr/lib/x86_64-linux-gnu/liblept.so.5 | grep ^/tmp/
/tmp/lept/baseline/diff
/tmp/lept/baseline/diff.png
/tmp/lept/baseline/loc
/tmp/lept/baseline/loc.png
/tmp/lept/baseline/skew
/tmp/lept/baseline/baselines.png
/tmp/threshroot
/tmp/lept/plots/sides.%s
/tmp/lept/plots/sides.%d
/tmp/lept/plots/size.%s
/tmp/lept/plots/size.%d
/tmp/linfit/boxalr.ba
/tmp/linfit/boxatb.ba
/tmp/linfit/ptal.pta
/tmp/linfit/ptar.pta
/tmp/linfit/ptat.pta
/tmp/linfit/ptab.pta
/tmp/smooth/boxae.ba
/tmp/smooth/boxao.ba
/tmp/smooth/boxalfe.ba
/tmp/smooth/boxalfo.ba
/tmp/smooth/boxame.ba
/tmp/smooth/boxamo.ba
/tmp/smooth/boxamede.ba
/tmp/smooth/boxamedo.ba
...

Ben.

> In any event, once you receive the ACCEPT notice from the archive
> software you should be able to publish the DLA.

--
Ben Hutchings
Everything should be made as simple as possible, but not simpler.
                                                      - Albert Einstein

```

**Attachment:
[signature.asc](pgpyNALSGEuxi.pgp)**

*Description:* This is a digitally signed message part

---


