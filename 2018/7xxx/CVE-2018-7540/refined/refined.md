Based on the provided information, here's an analysis of CVE-2018-7540:

**Root cause of vulnerability:**

- The vulnerability stems from missing preemption checks during the unpinning of higher-level page tables when a guest requests the removal of memory.
- Specifically, the unpinning operation can take a significant amount of time and lacks the necessary checks to allow the hypervisor to regain control of the CPU.

**Weaknesses/vulnerabilities present:**

- **Missing Preemption Checks:** The core issue is the absence of preemption checks in the code path responsible for unpinning high-level page tables during memory removal requests from guests.
- **Uninterruptible Operation:**  The unpinning process can become a non-preemptable operation if it is not interrupted for preemption checks allowing for long CPU occupation.

**Impact of exploitation:**

- **Denial of Service (DoS):** A malicious PV guest administrator can exploit this vulnerability to cause a DoS on the host system.
- **CPU Starvation:** The attack can lead to the CPU being occupied for an extended duration, preventing other processes or virtual machines from using the physical CPU.

**Attack vectors:**

- **Malicious Guest Administrator:** The vulnerability is exploitable by an attacker who has administrative privileges within a Paravirtualized (PV) guest.
- **Memory Removal Request:** The attack involves a guest requesting the removal of memory, specifically targeting higher-level page tables, triggering the vulnerable code path.

**Required attacker capabilities/position:**

- **PV Guest Access:** The attacker must have control over a PV guest.
- **Administrative privileges:** The attacker needs to be able to administer the PV guest.
- **Knowledge of the vulnerability:** The attacker needs to be able to trigger the vulnerable codepath.

**Additional Notes:**

- The vulnerability is specific to x86 systems and does not affect ARM systems.
- Only PV (Paravirtualized) guests are vulnerable; HVM (Hardware Virtual Machine) guests are not susceptible to this issue.
- Patches have been released for various Xen versions to address this vulnerability.
- The issue was discovered by Jann Horn of Google Project Zero.