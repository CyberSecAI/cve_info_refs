=== Content from twitter.com_fcfdf6eb_20250126_044413.html ===



=== Content from atomic111.github.io_54658a66_20250125_001719.html ===


Patrick Münch Blog

[Home](/)

---

# CVE-2018-7296: Directory Traversal / Arbitrary File Read in HomeMatic CCU2

[Patrick Münch](https://twitter.com/atomiczero111), in 21 February 2018

# Background

HomeMatic is a home automation system consisting of various components for automating several parts of a building, including different sensors and actuators. The HomeMatic CCU2 is a central control unit, which is responsible for integrating these components with each other.

From the vendor’s website ([eQ-3](http://www.eq-3.de/produkte/homematic/zentralen-und-gateways.html)):

“The Homematic Central Control Unit CCU2 is responsible for numerous control, signalling and supervision functions across all areas of the Homematic system. The device includes a browser based user interface to the up the system. It can be controlled in the local network as well as via Internet. The Homematic software offers various configuration and application possibilities, so that there are no limits to creativity for installing your individual smart home.”

# Issue Description

While analyzing the implementation of the CCU2’s web interface, one Directory Traversal vulnerabilities has been identified, which can be exploited in order to read files from the CCU2’s filesystem. This vulnerability can be exploited by unauthenticated attackers
with access to the web interface.

The system provides a JSON API, which exposes various methods. While some methods require the connecting user to be authenticated, a number of methods can also be used anonymously.

A code review of the file `api/methods/user/getlanguage.tcl` revealed that the User.getLanguage method allows unauthenticated attackers to read the first line of an arbitrary file on the CCU2’s filesystem.

Please consider the following excerpt from the file `api/methods/user/getlanguage.tcl`:

```
if {[catch {set fp [open "/etc/config/userprofiles/$args(userName).lang" r]}] == 0} {
  set data [read $fp]
  set lang [split $data "\n"]
  close $fp
} else {
  set lang "0"
}

jsonrpc_response [lindex $lang 0]

```

Please note that the web server is running as root, which means that this vulnerability can be exploited in order to disclose the first line of any file on the target’s filesystem.

One particular way to exploit this issue is to read the file /tmp/event/subscriber.list, which contains existing session IDs. These session IDs can subsequently be used to impersonate other users on the system.

# CVE

[CVE-2018-7296](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7296)

# CVSSv3 Base Score

CVSS Base Score: **7.5**

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

# Credit

Gregor Kopf of [Secfault Security GmbH](https://secfault-security.com)

Patrick Muench of [SVA System Vertrieb Alexander GmbH](https://www.sva.de)

# Disclaimer

The information provided is released “as is” without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information. In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2017 Secfault Security GmbH & SVA System Vertrieb Alexander GmbH and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.

Discuss on Hacker News

[Tweet](https://twitter.com/share)

### Read next

[# CVE-2018-7297: Remote Code Execution in HomeMatic CCU2

##](/article/homematic-ccu2-remote-code-execution)

©2020, [Patrick Münch](http://atomic111.github.io). All rights reserved.

We would like to use third party cookies and scripts to improve the functionality of this website.Approve[More info](/privacy)



=== Content from secfault-security.com_43747560_20250126_044412.html ===

![](./images/logo.png)

[Home](./index.html)
[Company](./company.html)
[Services](./services.html)
[Trainings](./trainings.html)
[Jobs](./jobs.html)
[Blog](./blog.html)
[Contact](./contact.html)

# Welcome

Todayâs world is heavily influenced by IT systems. Computers and software make our life easier, provide us with real-time communication all around the world, automate our production processes, manage our money. More and more companies and individuals rely on IT systems for their daily business, which implies that reliability and security of IT infrastructure becomes an increasingly important factor.

We support our clients in analyzing and evaluating their IT security risks by conducting design and/or code reviews in source and binary, by performing penetration tests and by providing individual solutions for custom IT security problems. We offer a broad spectrum of [services](services.html) - ranging from code reviews over penetration testing to our dedicated security services for agile software development.

Another element of our work is research. This includes both, theoretical and practical aspects in offense and defense: from improving the security of next-generation IT systems to building better reverse-engineering tools. If you are interested or would like to contribute, please feel free to contact us. Whatever the research outcome is - be it a conference talk, a paper or a tool - we believe that giving back something to the community is a good thing.

Please feel free to get in [touch](contact.html) with us!

Â© 2016 - 2024 Secfault Security GmbH | [Imprint](./imprint.html)


