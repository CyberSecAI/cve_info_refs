- **Root cause of vulnerability**: The application fails to properly sanitize user-supplied input when setting the document name. Specifically, it allows HTML encoded values to bypass protections, leading to stored XSS.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability. The application does not properly sanitize or encode user-provided document names.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of other users' browsers when they view the affected document. This could lead to session hijacking, data theft, phishing attacks, or other malicious actions.
- **Attack vectors**: The attacker must be authenticated and able to upload a document.  They then edit the document properties to include an HTML-encoded XSS payload in the document name field. When the document name is displayed to other users, the injected JavaScript executes.
- **Required attacker capabilities/position**: The attacker must have valid credentials to access the application and upload documents. They must have the ability to edit the document's properties.