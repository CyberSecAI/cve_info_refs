=== Content from gitlab.com_2e3402b6_20250125_141617.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

![cve-2018-7248](/uploads/-/system/project/avatar/5985720/ManageEngineLogo.png?width=48)
# cve-2018-7248

## Project information

CVE-2018-7248 - Local and Domain user enumeration via unsecured ManageEngine ServiceDesk Plus API Endpoint

Read more

[ManageEngine](/explore/projects/topics/ManageEngine)
[vulnerability](/explore/projects/topics/vulnerability)
[CVE](/explore/projects/topics/CVE)

* [**4** Commits](/e-sterling/cve-2018-7248/-/commits/master)
* [**1** Branch](/e-sterling/cve-2018-7248/-/branches)
* [**0** Tags](/e-sterling/cve-2018-7248/-/tags)

* [README](/e-sterling/cve-2018-7248/-/blob/master/README.md)
* [MIT License](/e-sterling/cve-2018-7248/-/blob/master/LICENSE)

Created on

April 05, 2018

Find file

Copy HTTPS clone URL

* [**Copy SSH clone URL**git@gitlab.com:e-sterling/cve-2018-7248.git](git%40gitlab.com%3Ae-sterling/cve-2018-7248.git)
* [**Copy HTTPS clone URL**https://gitlab.com/e-sterling/cve-2018-7248.git](https://gitlab.com/e-sterling/cve-2018-7248.git)

Loading



=== Content from medium.com_0b438dbe_20250125_141618.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa1eda2942eb0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2018-7248-enumerating-active-directory-users-via-unauthenticated-manageengine-servicedesk-a1eda2942eb0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2018-7248-enumerating-active-directory-users-via-unauthenticated-manageengine-servicedesk-a1eda2942eb0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2018–7248 — Enumerating Active Directory users via unauthenticated ManageEngine ServiceDesk Plus API

[![Ethan](https://miro.medium.com/v2/resize:fill:88:88/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---byline--a1eda2942eb0--------------------------------)

[Ethan](/%40esterling_?source=post_page---byline--a1eda2942eb0--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5f2d166a8dc6&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40esterling_%2Fcve-2018-7248-enumerating-active-directory-users-via-unauthenticated-manageengine-servicedesk-a1eda2942eb0&user=Ethan&userId=5f2d166a8dc6&source=post_page-5f2d166a8dc6--byline--a1eda2942eb0---------------------post_header-----------)

2 min read·May 8, 2018

--

Listen

Share

By default ManageEngine ServiceDesk Plus allows an “auto-complete” feature on the login page that will automatically select the correct login domain from a drop-down box. This uses an API endpoint exposed at /domainServlet/AJaxDomainServlet? that does not require authentication to access.

By sending a request like <http://server.name/domainServlet/AJaxDomainServlet?action=searchDomain&search=USERNAME>, the API will return either the user’s logon domain, or “null” if the user does not exist. This only effects users who have been imported into ManageEngine from the LDAP server.

A (very) short Python script using names (<https://github.com/treyhunner/names>) to brute-force Active Directory (or locally configured)) accounts using ManageEngine’s auto-completing login page

As a proof of concept I wrote a quick Python script using the *names* library to generate a series of random firstName.lastName combinations to try and brute-force a few valid usernames through the API. With a delay of two seconds between attempts it only took an hour to return a valid username and domain combo from my environment.

![]()

The script above was able to identify a user account within around an hour, with a 2 second delay between attempts and no seeding with word lists, etc.

To take advantage of this exploit I’ve written a more involved Python script that can ingest a list of usernames, along side the ability to generate them (as above) to allow you to load in a list of possible usernames in order to confirm if they exist.

This script will run through each supplied username in turn (or will generate up to the defined number of random usernames), and perform the same test as the original PoC, returning the username and their domain name if they exist, and “Not found” if they don’t.

If you’re using the brute force approach, the default method of generating usernames (FirstName.LastName) may not be appropriate for the target environment. If this is the case simply edit the genUserName to output the expected format.

You can find the script in the GitLab repository here: <https://gitlab.com/e-sterling/cve-2018-7248>

## Disclosure Timeline

**19/02/2018** — Initial report to vendor
**19/02/2018** — CVE assigned
**27/02/2018** — Vendor acknowledged report
**10/03/2018** — Request for update from vendor
**05/04/2018** — Vendor confirms wontfix
**08/05/2018** — Public disclosure

[Manageengine](/tag/manageengine?source=post_page-----a1eda2942eb0--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----a1eda2942eb0--------------------------------)[Unauthenticated Api](/tag/unauthenticated-api?source=post_page-----a1eda2942eb0--------------------------------)

--

--

[![Ethan](https://miro.medium.com/v2/resize:fill:96:96/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---post_author_info--a1eda2942eb0--------------------------------)[![Ethan](https://miro.medium.com/v2/resize:fill:128:128/0*_QoR1nv_sFVRxylS.jpg)](/%40esterling_?source=post_page---post_author_info--a1eda2942eb0--------------------------------)Follow[## Written by Ethan](/%40esterling_?source=post_page---post_author_info--a1eda2942eb0--------------------------------)[12 Followers](/%40esterling_/followers?source=post_page---post_author_info--a1eda2942eb0--------------------------------)·[23 Following](/%40esterling_/following?source=post_page---post_author_info--a1eda2942eb0--------------------------------)

IT man, Infrastructure Engineer, with a big interest in InfoSec and all the related good stuff

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----a1eda2942eb0--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----a1eda2942eb0--------------------------------)[About](/about?autoplay=1&source=post_page-----a1eda2942eb0--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a1eda2942eb0--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----a1eda2942eb0--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----a1eda2942eb0--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a1eda2942eb0--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a1eda2942eb0--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----a1eda2942eb0--------------------------------)[Teams](/business?source=post_page-----a1eda2942eb0--------------------------------)


