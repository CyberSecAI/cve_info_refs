- **Root cause of vulnerability:** The Joomla SIGE extension does not sanitize image metadata, specifically the `Caption-Abstract` header, before incorporating it into HTML. This allows an attacker to inject malicious code into the `image_description` variable.
- **Weaknesses/vulnerabilities present:** A persistent Cross-Site Scripting (XSS) vulnerability exists due to the lack of sanitization of image metadata. The `htmlImageAddTitleAttribute` function incorporates the unsanitized `image_description` into HTML, allowing for the injection of arbitrary HTML/JavaScript.
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of the user's browser. This can be leveraged for various malicious purposes, such as: browser exploits, capturing keystrokes via a JavaScript keylogger, or even running cryptocurrency miners. Furthermore, the XSS could target administrators, potentially leading to a full compromise of the Joomla site.
- **Attack vectors:** The attack vector involves embedding malicious code within the `Caption-Abstract` header of an image file. The attacker can then upload this image to a gallery managed by the vulnerable Joomla extension. When the image is displayed, the unsanitized metadata will be rendered as HTML, executing the injected JavaScript.
- **Required attacker capabilities/position:** The attacker needs to be able to either upload an image to the image gallery or have access to the image directory (via another vulnerability or insider access). This could involve a public upload functionality, a vulnerability allowing file uploads, or even a compromised administrator uploading a malicious image unknowingly.