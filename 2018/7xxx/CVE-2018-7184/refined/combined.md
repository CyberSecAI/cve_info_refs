=== Content from www.synology.com_b9141d1f_20250125_080353.html ===


* [Security Advisory](security/advisory)
# Synology-SA-18:13 NTP

Publish Time: 2018-03-27 15:57:38 UTC+8

Last Updated: 2018-04-10 16:29:05 UTC+8

Severity
Moderate

Status
Resolved

**Abstract**

These vulnerabilities allow remote attackers to conduct association attacks via a susceptible version of Synology DiskStation Manager (DSM), Synology Router Manager (SRM), Virtual DSM, SkyNAS or VS960HD.

**Affected Products**

| Product | Severity | Fixed Release Availability |
| --- | --- | --- |
| DSM 6.1 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 6.0 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 5.2 | Moderate | Upgrade to 6.1.6-15266 or above. |
| SRM 1.1 | Moderate | Upgrade to 1.1.6-6931-3 or above. |
| Virtual DSM | Moderate | Upgrade to 6.1.6-15266 or above. |
| SkyNAS | Moderate | Upgrade to 6.1.5-15254 or above. |
| VS960HD | Moderate | Upgrade to 2.2.3-1505 or above. |

**Mitigation**

None

**Detail**

* CVE-2018-7185

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + The protocol engine in ntp 4.2.6 before 4.2.8p11 allows a remote attackers to cause a denial of service (disruption) by continually sending a packet with a zero-origin timestamp and source IP address of the "other side" of an interleaved association causing the victim ntpd to reset its association.
* CVE-2018-7184

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + ntpd in ntp 4.2.8p4 before 4.2.8p11 drops bad packets before updating the "received" timestamp, which allows remote attackers to cause a denial of service (disruption) by sending a packet with a zero-origin timestamp causing the association to reset and setting the contents of the packet as the most recent timestamp. This issue is a result of an incomplete fix for CVE-2015-7704.
* CVE-2018-7170

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N)
  + ntpd in ntp 4.2.x before 4.2.8p7 and 4.3.x before 4.3.92 allows authenticated users that know the private symmetric key to create arbitrarily-many ephemeral associations in order to win the clock selection of ntpd and modify a victim's clock via a Sybil attack. This issue exists because of an incomplete fix for CVE-2016-1549.
* CVE-2018-7183

  + Severity: Moderate
  + CVSS3 Base Score: 5.0
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L)
  + Buffer overflow in the decodearr function in ntpq in ntp 4.2.8p6 through 4.2.8p10 allows remote attackers to execute arbitrary code by leveraging an ntpq query and sending a response with a crafted array.
* CVE-2018-7182

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
  + The ctl\_getitem method in ntpd in ntp-4.2.8p6 before 4.2.8p11 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted mode 6 packet with a ntpd instance from 4.2.8p6 through 4.2.8p10.
* CVE-2016-1549

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N)
  + A malicious authenticated peer can create arbitrarily-many ephemeral associations in order to win the clock selection algorithm in ntpd in NTP 4.2.8p4 and earlier and NTPsec 3e160db8dc248a0bcb053b56a80167dc742d2b74 and a5fb34b9cc89b92a8fef2f459004865c93bb7f92 and modify a victim's clock.

**Reference**

* [February 2018 ntp-4.2.8p11 NTP Security Vulnerability Announcement](https://support.ntp.org/bin/view/Main/SecurityNotice#February_2018_ntp_4_2_8p11_NTP_S)
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1549>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7170>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7182>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7183>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7184>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7185>

**Revision**

| Revision | Date | Description |
| --- | --- | --- |
| 1 | 2018-03-27 | Initial public release. |
| 2 | 2018-03-29 | Update for SkyNAS is now available in Affected Products. |
| 3 | 2018-04-10 | Update for VS960HD is now available in Affected Products. |

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)
* [ESG](company/esg)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue



=== Content from usn.ubuntu.com_83d794ac_20250125_080352.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3707-1: NTP vulnerabilities

9 July 2018

Several security issues were fixed in NTP.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 17.10](/security/notices?release=artful)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [ntp](/security/cves?package=ntp) - Network Time Protocol daemon and utility programs

## Details

Yihan Lian discovered that NTP incorrectly handled certain malformed mode 6

packets. A remote attacker could possibly use this issue to cause ntpd to

crash, resulting in a denial of service. This issue only affected Ubuntu

17.10 and Ubuntu 18.04 LTS. ([CVE-2018-7182](/security/CVE-2018-7182))

Michael Macnair discovered that NTP incorrectly handled certain responses.

A remote attacker could possibly use this issue to execute arbitrary code.

([CVE-2018-7183](/security/CVE-2018-7183))

Miroslav Lichvar discovered that NTP incorrectly handled certain

zero-origin timestamps. A remote attacker could possibly use this issue to

cause a denial of service. This issue only affected Ubuntu 17.10 and Ubuntu

18.04 LTS. ([CVE-2018-7184](/security/CVE-2018-7184))

Miroslav Lichvar discovered that NTP incorrectly handled certain

zero-origin timestamps. A remote attacker could possibly use this issue to

cause a denial of service. ([CVE-2018-7185](/security/CVE-2018-7185))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [ntp](https://launchpad.net/ubuntu/%2Bsource/ntp)
  -
  [1:4.2.8p10+dfsg-5ubuntu7.1](https://launchpad.net/ubuntu/%2Bsource/ntp/1%3A4.2.8p10%2Bdfsg-5ubuntu7.1)

##### Ubuntu 17.10

* [ntp](https://launchpad.net/ubuntu/%2Bsource/ntp)
  -
  [1:4.2.8p10+dfsg-5ubuntu3.3](https://launchpad.net/ubuntu/%2Bsource/ntp/1%3A4.2.8p10%2Bdfsg-5ubuntu3.3)

##### Ubuntu 16.04

* [ntp](https://launchpad.net/ubuntu/%2Bsource/ntp)
  -
  [1:4.2.8p4+dfsg-3ubuntu5.9](https://launchpad.net/ubuntu/%2Bsource/ntp/1%3A4.2.8p4%2Bdfsg-3ubuntu5.9)

##### Ubuntu 14.04

* [ntp](https://launchpad.net/ubuntu/%2Bsource/ntp)
  -
  [1:4.2.6.p5+dfsg-3ubuntu2.14.04.13](https://launchpad.net/ubuntu/%2Bsource/ntp/1%3A4.2.6.p5%2Bdfsg-3ubuntu2.14.04.13)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2018-7182](/security/CVE-2018-7182)
* [CVE-2018-7183](/security/CVE-2018-7183)
* [CVE-2018-7184](/security/CVE-2018-7184)
* [CVE-2018-7185](/security/CVE-2018-7185)

## Related notices

* [USN-3707-2](/security/notices/USN-3707-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from support.ntp.org_8bb24087_20250125_080348.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state](https://www.ntp.org/support/securitynotice/ntpbug3453/)

# NTP BUG 3453: Interleaved symmetric mode cannot recover from bad state

Last update: April 22, 2024 18:49 UTC ([7e7bd5857](https://git.nwtime.org/websites/ntpwww/commit/7e7bd5857f893277639b3765bf9347c4c6faa447))

---

#### Summary

| **Resolved** | [4.2.8p11](https://www.ntp.org/support/securitynotice/4_2_8p11-release-announcement/) | 27 Feb 2018 |
| --- | --- | --- |
| **References** | [Bug 3453](https://bugs.ntp.org/show_bug.cgi?id=3453) | [CVE-2018-7184](https://nvd.nist.gov/vuln/detail/CVE-2018-7184) |
| **Affects** | `ntpd` in ntp-4.2.8p4, up to but not including ntp-4.2.8p11. | Resolved in 4.2.8p11. |
| **CVSS2 Score** | MED 4.3 | [AV:N/AC:M/Au:N/C:P/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector=(AV:N/AC:M/Au:N/C:P/I:N/A:N)) Could score between 2.9 and 6.8. |
| **CVSS3 Score** | LOW 3.1 | [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L) Could score between 2.6 and 6.0. |

---

#### Description

The fix for [NTP Bug 2952](https://www.ntp.org/support/securitynotice/ntpbug2952/) was incomplete, and while it fixed one problem it created another. Specifically, it drops bad packets before updating the “received” timestamp. This means a third-party can inject a packet with a zero-origin timestamp, meaning the sender wants to reset the association, and the transmit timestamp in this bogus packet will be saved as the most recent “received” timestamp. The real remote peer does not know this value and this will disrupt the association until the association resets.

---

#### Mitigation

* Implement [BCP-38](http://www.bcp38.info/index.php/Main_Page).
* Upgrade to [4.2.8p11 or later](https://downloads.nwtime.org/ntp/4.2.8/).
* Use authentication with peer mode.
* Have enough sources of time.
* Properly monitor your `ntpd` instances.
* If `ntpd` stops running, auto-restart it without `-g`.

---

#### Credit

This weakness was discovered by Miroslav Lichvar of Red Hat.

---

#### Timeline

* 2018 Feb 27: Public release
* 2018 Feb 12: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2018 Jan 23: [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* : Notification from reporter

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from security.FreeBSD.org_b0c17d21_20250125_080349.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-18:02.ntp Security Advisory
The FreeBSD Project
Topic: Multiple vulnerabilities of ntp
Category: contrib
Module: ntp
Announced: 2018-03-07
Credits: Network Time Foundation
Affects: All supported versions of FreeBSD.
Corrected: 2018-02-28 09:01:03 UTC (stable/11, 11.1-STABLE)
2018-03-07 05:58:24 UTC (releng/11.1, 11.1-RELEASE-p7)
2018-03-01 04:06:49 UTC (stable/10, 10.4-STABLE)
2018-03-07 05:58:24 UTC (releng/10.4, 10.4-RELEASE-p6)
2018-03-07 05:58:24 UTC (releng/10.3, 10.3-RELEASE-p27)
CVE Name: CVE-2018-7182, CVE-2018-7170, CVE-2018-7184, CVE-2018-7185,
CVE-2018-7183
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The ntpd(8) daemon is an implementation of the Network Time Protocol (NTP)
used to synchronize the time of a computer system to a reference time
source.
II. Problem Description
The ctl\_getitem() function is used by ntpd(8) to process incoming "mode 6"
packets. A malicious "mode 6" packet can be sent to an ntpd instance, and
if the ntpd instance is from 4.2.8p6 through 4.2.8p10, ctl\_getitem() will
read past the end of its buffer. [CVE-2018-7182]
The ntpd(8) service can be vulnerable to Sybil attacks. If a system is
configured to use a trustedkey and if one is not using the feature introduced
in ntp-4.2.8p6 allowing an optional 4th field in the ntp.keys file to specify
which IPs can serve time, a malicious authenticated peer, i.e., one where the
attacker knows the private symmetric key, can create arbitrarily-many
ephemeral associations in order to win the clock selection of ntpd and modify
a victim's clock. [CVE-2018-7170]
The fix for NtpBug2952 was incomplete, and while it fixed one problem it
created another. Specifically, it drops bad packets before updating the
"received" timestamp. This means a third-party can inject a packet with
a zero-origin timestamp, meaning the sender wants to reset the association,
and the transmit timestamp in this bogus packet will be saved as the most
recent "received" timestamp. The real remote peer does not know this
value and this will disrupt the association until the association resets.
[CVE-2018-7184]
The NTP Protocol allows for both non-authenticated and authenticated
associations, in client/server, symmetric (peer), and several broadcast
modes. In addition to the basic NTP operational modes, symmetric mode and
broadcast servers can support an interleaved mode of operation. In
ntp-4.2.8p4, a bug was inadvertently introduced into the protocol engine that
allows a non-authenticated zero-origin (reset) packet to reset an
authenticated interleaved peer association. If an attacker can send a packet
with a zero-origin timestamp and the source IP address of the "other side" of
an interleaved association, the 'victim' ntpd will reset its association.
The attacker must continue sending these packets in order to maintain the
disruption of the association. [CVE-2018-7185]
The ntpq(8) utility is a monitoring and control program for ntpd. The
internal decodearr() function of ntpq(8) that is used to decode an array in
a response string when formatted data is being displayed. This is a problem
in affected versions of ntpq if a maliciously-altered ntpd returns an array
result that will trip this bug, or if a bad actor is able to read an ntpq(8)
request on its way to a remote ntpd server and forge and send a response
before the remote ntpd sends its response. It is potentially possible that
the malicious data could become injectable/executable code. [CVE-2017-7183]
III. Impact
Malicious remote attackers may be able to break time synchornization,
or cause the ntpq(8) utility to crash.
IV. Workaround
No workaround is available, but systems not running ntpd(8) or ntpq(8) are
not affected. Network administrators are advised to implement BCP-38 which
helps to reduce risk associated with the attacks.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
[FreeBSD 11.1]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-11.1.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-11.1.patch.asc
# gpg --verify ntp-11.1.patch.asc
[FreeBSD 10.4]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.4.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.4.patch.asc
# gpg --verify ntp-10.4.patch.asc
[FreeBSD 10.3]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.3.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.3.patch.asc
# gpg --verify ntp-10.3.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart the applicable daemons, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/10/ r330141
releng/10.3/ r330567
releng/10.4/ r330567
stable/11/ r330106
releng/11.1/ r330567
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQKTBAEBCgB9FiEE/A6HiuWv54gCjWNV05eS9J6n5cIFAlqfhYNfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEZD
MEU4NzhBRTVBRkU3ODgwMjhENjM1NUQzOTc5MkY0OUVBN0U1QzIACgkQ05eS9J6n
5cL9GQ/+PLffyegsvxKngL83XWG9UuHbcGG5aWbNwCecTEzNoCI72TI03aga0ge5
iLz5kW3SQvl8tsq778U4YbfFcCw6ifq2ws8asqNviv+u4AcJh7oD8CS3/kFuA9xM
zjAIrScdNR2taBJhBW3nwlb7RmDeKqydQ3OIxHVvs9Fj5Alc5ZEGezUjC2dueB+M
UdORg6GvHGMYQ+4AtBFRgZHAU3BFkwmgqsIICywYnUVH+AxKj34shs/pMMeJd/d9
a+BIu/tUjAIlQp23VunNAfq7r2eZik9LOV8Y5l1Ww7+K1IwlwezxI+Iw18BMFEVn
L9baBY9RFh8v/yrZCBqUc7Prhs3ExU/lnAb05Va7TYeD4RXVmSU0jNXi/przN3y2
PR7Z3JCm60mFKyp0/Hz2MmS1XPBVBrW4P6g9hH8TZmOHb2mZlK3zDXmil7HKp5DK
UhtMJpPEWV9k5rfP8iijHJnwkPr0ALntMUAAKUyw/6isVtHT6BZLaYsZvRYIm8YY
Mn2RUl74m+XoIhQ8R4mxRcaAHwKKXyeyP5nlAs6TQVb9QJukoRiNDr3g8TwbtT54
iTswVu+z/a89/YIwJoc6Ud7eCZSDYe6qfuC19TVuledayjjy/ZPMH0ZkNWFWJ3AE
VAvdyvoUuNbmsv42o4AUtpE/1CmDqOjwBRZZbtV4CONCDFpk26o=
=D2ov
-----END PGP SIGNATURE-----


=== Content from bugs.ntp.org_120d041c_20250126_072701.html ===

[join](https://www.nwtime.org/membership/)

[donate](https://www.nwtime.org/donate/)

Network Time Foundation:
[NTP](https://www.nwtime.org/projects/ntp/ "Network Time Protocol Project")
• [Linux PTP](https://www.nwtime.org/projects/linuxptp/ "Linux Precision Time Protocol Project")
• [RADclock](https://www.nwtime.org/projects/radclock/ "Robust Absolute and Difference Clock Project")
• [GT API](https://www.nwtime.org/projects/timestamp-api/ "General Timestamp API Project")
• [More](http://networktimefoundation.org/projects/ "Other Projects")

---

[Help Us Continue the Legacy of Father Time by Donating to the
Mills-Spring Fund](https://www.nwtime.org/mills-spring/)
![](https://www.nwtime.org/images/support.jpg)

Bugzilla – Bug 3453
Interleaved symmetric mode cannot recover from bad state
Last modified: 2018-03-14 17:10:04 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3453&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3453&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

NTP users are strongly urged to take immediate action to ensure that their NTP daemons are not susceptible to being used in distributed denial-of-service (DDoS) attacks. Please also take this opportunity to defeat denial-of-service attacks by [implementing Ingress and Egress filtering through BCP38](http://www.bcp38.info/index.php/Main_Page "BCP38 Ingress/Egress filtering").

`ntp-4.2.8p18` was released on 25 May 2024 and addresses 40 bugs and provides 40 improvements.

Please see the [NTP 4.2.8p18 Changelog](https://www.ntp.org/support/securitynotice/4_2_8-series-changelog/#428p18 "4.2.8p18 Changelog") for details.

[**Bug 3453**](show_bug.cgi?id=3453)
- Interleaved symmetric mode cannot recover from bad state

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Interleaved symmetric mode cannot recover from bad state

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | ntp | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=ntp "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntpd ([show other bugs](buglist.cgi?component=ntpd&product=ntp&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.2.8 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Harlan Stenn | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-01-26 04:25 UTC by Harlan Stenn | | --- | --- | | Modified: | 2018-03-14 17:10 UTC ([History](show_activity.cgi?id=3453)) | | CC List: | 5 users (show)  bugs contacto mayer mlichvar security | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | | Flags: | stenn: blocking4.2.8+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=3453&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=3453&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3453#c0)  Harlan Stenn    2018-01-26 04:25:16 UTC   [Comment 1](show_bug.cgi?id=3453#c1)  Harlan Stenn    2018-01-26 04:28:37 UTC  ``` Miroslav writes:  When a peer using the interleaved mode receives a packet with non-zero timestamps, it does not update its state unless the origin timestamp matches the receive timestamp of the previous packet. This prevents the protocol from recovering when the peers are sending packets with incorrect origin timestamps as they will both wait for a response that the other peer cannot send.  An off-path attacker can exploit this issue to permanently break an unauthenticated interleaved symmetric association by sending each peer a spoofed packet with a zero origin timestamp and a random non-zero receive timestamp. Off-path attackers are expected to be able to disrupt the protocol with spoofed packets, but the protocol should recover when the attack stops.  An attacker could potentially exploit it to permanently break an authenticated association if there was an old authenticated packet with zero origin timestamp and non-zero receive timestamp which could be replayed to the peers.  It seems the issue was introduced in 4.2.8p4 and affected both basic and interleaved modes in slightly different ways. The basic mode was already fixed (in [bug #2952](show_bug.cgi?id=2952 "VERIFIED FIXED - Symmetric active/passive mode is broken")?). The following patch fixes the interleaved mode by updating the state even if the origin timestamp is incorrect:  diff -up ntp-4.2.8p10/ntpd/ntp_proto.c.orig ntp-4.2.8p10/ntpd/ntp_proto.c --- ntp-4.2.8p10/ntpd/ntp_proto.c.orig	2018-01-24 13:35:16.611488502 +0100 +++ ntp-4.2.8p10/ntpd/ntp_proto.c	2018-01-24 13:35:24.113505866 +0100 @@ -1774,7 +1774,6 @@ receive(  		peer->bogusorg++;  		peer->flags |= FLAG_XBOGUS;  		peer->flash |= TEST2;		/* bogus */ -		return; /* Bogus packet, we are done */  	}    	/**/ ```  [Comment 2](show_bug.cgi?id=3453#c2)  Harlan Stenn    2018-01-27 11:42:06 UTC  ``` Miroslav,  Danny added that "return" as part of the fix to validate packets before KoD processing.  I've asked him about this, because if this 'return' was added to prevent a problem, removing it to fix interleave mode resets will break something else. ```  [Comment 3](show_bug.cgi?id=3453#c3)  Danny Mayer    2018-01-28 23:05:37 UTC  ``` The problem that I see here is that if this affects interleave mode then Test2 may be wrong. The comment before that code says if found, flip and resynchronize. Now we need to know where that happens because it's not here. It also requires a review of what a inteleaved packet looks like. The test itself may very well need to be changed.  Danny ```  [Comment 4](show_bug.cgi?id=3453#c4)  Harlan Stenn    2018-01-30 10:28:48 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=3453#c3)) > The problem that I see here is that if this affects interleave mode then Test2 > may be wrong. The comment before that code says if found, flip and > resynchronize. Now we need to know where that happens because it's not here. It > also requires a review of what a inteleaved packet looks like. The test itself > may very well need to be changed. >  > Danny  TEST2 means "origin timestamp problem", and XBOGUS means there's a slightly more general problem with an interleave packet.  Dave says it's reasonable to always stay in interleave mode if we get in to interleave mode, but in the past the intent was to flip back to basic mode if that's what the other side wants.  I'm still digging in to this. ```  [Comment 5](show_bug.cgi?id=3453#c5)  Miroslav Lichvar    2018-02-01 15:04:25 UTC  ``` The XBOGUS flag seems to be necessary to prevent the transmit timestamp from the following packet to be matched with an incorrect packet. It basically resets the state.  (In reply to [comment #2](show_bug.cgi?id=3453#c2)) > I've asked him about this, because if this 'return' was added to prevent a > problem, removing it to fix interleave mode resets will break something else.  As I understand it, there were two return statements added to prevent a spoofed KoD packet changing the poll interval ([bug #2901](show_bug.cgi?id=2901 "RESOLVED FIXED - Clients that receive a KoD should validate the origin timestamp field.")). This broke both basic symmetric mode ([bug #2952](show_bug.cgi?id=2952 "VERIFIED FIXED - Symmetric active/passive mode is broken")) and interleaved symmetric mode (this bug). The original fix for [bug #2901](show_bug.cgi?id=2901 "RESOLVED FIXED - Clients that receive a KoD should validate the origin timestamp field.") was reworked later and there is now a separate check for origin timestamp specific to KoD packets. The return statement specific to the basic mode was removed, but not the one specific to the interleaved mode.  In any case, couple lines above this code is a "Check for valid nonzero timestamp fields", which doesn't return. I don't think it makes sense to allow updating the state from packets that have a zero origin timestamp, but not from packets that have a non-zero origin timestamp. ```  [Comment 6](show_bug.cgi?id=3453#c6)  Harlan Stenn    2018-02-04 10:51:30 UTC  ``` Miroslav,  Thanks for the report and patch.  The fix for [bug #2952](show_bug.cgi?id=2952 "VERIFIED FIXED - Symmetric active/passive mode is broken") was committed at 20:26:17 on 11 Apr 2016, removing the 'return' at the end of the first "Basic mode checks" in the "else if (peer->flip == 0) block.  Your patch is STAGED for 4.2.8p11. ```  [Comment 7](show_bug.cgi?id=3453#c7)  contacto    2018-03-14 17:10:04 UTC  ``` Hello,  <http://support.ntp.org/bin/view/Main/NtpBug3453> says that the CVSS2: (AV:N/AC:M/Au:N/C:P/I:N/A:N) anyhow I understand that the attack is a DoS, hence the CVSS2 should be (AV:N/AC:M/Au:N/C:N/I:N/A:P) or (AV:N/AC:M/Au:N/C:N/I:N/A:C).  CVSS3 is correct.  Cheers, ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3453)
* - [XML](show_bug.cgi?ctype=xml&id=3453)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3453)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3453&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3453&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[© 2025 Network Time Foundation](https://www.nwtime.org/)



=== Content from www.ntp.org_8770b321_20250126_072702.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [4.2.8p11 Release Announcement](https://www.ntp.org/support/securitynotice/4_2_8p11-release-announcement/)

# 4.2.8p11 Release Announcement

Last update: June 28, 2022 21:06 UTC ([1f97faf40](https://git.nwtime.org/websites/ntpwww/commit/1f97faf40ebfcdfdee0201c3d607f8c2c9649d7b))

The NTP Project at Network Time Foundation is releasing ntp-4.2.8p11.

This release addresses five security issues in `ntpd`:

* **LOW/MEDIUM: [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012/)**
  + While fixed in ntp-4.2.8p7, there are significant additional protections for this issue in 4.2.8p11.
  + Reported by Matt Van Gundy of Cisco.
* **INFO/MEDIUM: [3412: ctl\_getitem(): buffer read overrun leads to undefined behavior and information leak](https://www.ntp.org/support/securitynotice/ntpbug3412/)**
  + Reported by Yihan Lian of Qihoo 360.
* **LOW: [3415: Multiple authenticated ephemeral associations](https://www.ntp.org/support/securitynotice/ntpbug3415/)**
  + Reported on the questions@ list.
* **LOW: [3453: Interleaved symmetric mode cannot recover from bad state](https://www.ntp.org/support/securitynotice/ntpbug3453/)**
  + Reported by Miroslav Lichvar of Red Hat.
* **LOW/MEDIUM: [3454: Unauthenticated packet can reset authenticated interleaved association](https://www.ntp.org/support/securitynotice/ntpbug3454/)**
  + Reported by Miroslav Lichvar of Red Hat.

one security issue in `ntpq`:

* **MEDIUM: [3414: ntpq:decodearr() can write beyond its buffer limit](https://www.ntp.org/support/securitynotice/ntpbug3414/)**
  + Reported by Michael Macnair of Thales-esecurity.com.

and provides over 33 bugfixes and 32 other improvements.

ENotification of these issues were delivered to our Institutional members on a rolling basis as they were reported and as progress was made.

---

**Timeline:**

* 2018 Feb 27: Public release
* 2018 Feb 20: CVE numbers assigned. NEWS file updated. Tarball updated. CERT notified.
* 2018 Feb 12: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2018 Feb 07: Regressions reported for FIPS and multicast mode.
* 2018 Feb 05: Bugs [3453](https://www.ntp.org/support/securitynotice/ntpbug3453/) and [3454](https://www.ntp.org/support/securitynotice/ntpbug3454/) reported.

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from support.hpe.com_589ab356_20250125_080351.html ===


[**Support Center**](/connect/s/)



=== Content from security.netapp.com_ab9de0d2_20250125_080350.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2018 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20180626-0001)

## March 2018 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20180626-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20180626-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20180626-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20180626-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20180626-0001
**Version:**
5.0

**Last updated:**
04/28/2021

**Status:**
Final.

**CVEs:** CVE-2018-7170, CVE-2018-7182, CVE-2018-7183, CVE-2018-7184, CVE-2018-7185

Overview
#### Summary

Multiple NetApp products contain Network Time Protocol Daemon (ntpd). NTP versions 4.2 before 4.2.8p11 and 4.3 before 4.3.92 are susceptible to vulnerabilities which when successfully exploited could lead to addition or modification of data, disclosure of sensitive information or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to addition or modification of data, disclosure of sensitive information or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2018-7170](https://nvd.nist.gov/vuln/detail/CVE-2018-7170) | 6.5 (MEDIUM) | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2018-7182](https://nvd.nist.gov/vuln/detail/CVE-2018-7182) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2018-7183](https://nvd.nist.gov/vuln/detail/CVE-2018-7183) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2018-7184](https://nvd.nist.gov/vuln/detail/CVE-2018-7184) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2018-7185](https://nvd.nist.gov/vuln/detail/CVE-2018-7185) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#Recent_Vulnerabilities>

Affected Products
#### Affected Products

* NetApp SolidFire & HCI Management Node
* NetApp SteelStore Cloud Integrated Storage

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge - 6500N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Brocade Fabric Operating System Firmware
* Cloud Manager
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.6 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Insight
* OnCommand Unified Manager Core Package
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.6 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 9.6 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/NOW/download/software/sf_elementos/11.0/> |

#### Workarounds

None

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20180626-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20180626 | Initial Public Release |
| 2.0 | 20181105 | NetApp SolidFire Element OS Management Node moved to Affected Products |
| 3.0 | 20190130 | Element Software Management Node added to Software Versions and Fixes |
| 4.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 5.0 | 20210428 | NetApp Cloud Backup (formerly AltaVault) moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.gentoo.org_6ed63b4f_20250125_080350.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NTP: Multiple vulnerabilities — GLSA **201805-12**

Multiple vulnerabilities have been found in NTP, the worst of which
could lead to remote code execution.

### Affected packages

| Package | **net-misc/ntp** on all architectures |
| --- | --- |
| Affected versions | < **4.2.8\_p11** |
| Unaffected versions | >= **4.2.8\_p11** |

### Background

NTP contains software for the Network Time Protocol.

### Description

Multiple vulnerabilities have been discovered in NTP. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly execute arbitrary code or cause a
Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All NTP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/ntp-4.2.8_p11"

```
### References

* [CVE-2018-7170](https://nvd.nist.gov/vuln/detail/CVE-2018-7170)
* [CVE-2018-7182](https://nvd.nist.gov/vuln/detail/CVE-2018-7182)
* [CVE-2018-7183](https://nvd.nist.gov/vuln/detail/CVE-2018-7183)
* [CVE-2018-7184](https://nvd.nist.gov/vuln/detail/CVE-2018-7184)
* [CVE-2018-7185](https://nvd.nist.gov/vuln/detail/CVE-2018-7185)

**Release date**

May 26, 2018

**Latest revision**

May 26, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [649612](https://bugs.gentoo.org/show_bug.cgi?id=649612)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from packetstormsecurity.com_3bf457e9_20250125_080340.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


