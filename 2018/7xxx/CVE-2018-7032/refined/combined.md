=== Content from bugs.debian.org_807a636b_20250124_184251.html ===

# Debian Bug report logs - #840014 webcheckout: CVE-2018-7032: missing URL sanitization

[![version graph](version.cgi?absolute=0;found=myrepos%2F1.20160123;collapse=1;height=2;package=myrepos;fixed=myrepos%2F1.20180726;width=2)](version.cgi?collapse=1;package=myrepos;fixed=myrepos%2F1.20180726;info=1;absolute=0;found=myrepos%2F1.20160123)

Package:
[myrepos](pkgreport.cgi?package=myrepos);
Maintainer for [myrepos](pkgreport.cgi?package=myrepos) is [Richard Hartmann <richih@debian.org>](pkgreport.cgi?maint=richih%40debian.org); Source for [myrepos](pkgreport.cgi?package=myrepos) is [src:myrepos](pkgreport.cgi?src=myrepos) ([PTS](https://tracker.debian.org/pkg/myrepos), [buildd](https://buildd.debian.org/myrepos), [popcon](https://qa.debian.org/popcon.php?package=myrepos)).

Reported by: [Jakub Wilk <jwilk@debian.org>](pkgreport.cgi?submitter=jwilk%40debian.org)

Date: Fri, 7 Oct 2016 16:36:04 UTC

Severity: normal

Tags: fixed-upstream, patch, security, upstream

Found in version myrepos/1.20160123

Fixed in version myrepos/1.20180726

**Done:** Paul Wise <pabs@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=40a3df21c73f1bb1b6915cc6fa503f50814664c8>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=840014;mbox=yes), [status mbox](bugreport.cgi?bug=840014;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=840014;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, jwilk@debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Fri, 07 Oct 2016 16:36:06 GMT) ([full text](bugreport.cgi?bug=840014;msg=2), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=2), [link](#1)).

---

[Message #3](#3) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=3), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=3), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: webcheckout: missing URL sanitization
Date: Fri, 7 Oct 2016 18:27:12 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=3) (text/plain, inline)]
```
```
Package: myrepos
Version: 1.20160123
Tags: security

webcheckout passes the extracted URL to "git clone", without any sanitization.
Malicious website operators or MitM attackers could exploit it for arbitrary
code execution.

PoC:

 $ webcheckout /path/to/badgit.html
 git clone ext::sh -c cowsay% pwned% >% /dev/tty
 Cloning into 'tty'...
  _______
 < pwned >
  -------
         \   ^__^
          \  (oo)\_______
             (__)\       )\/\
                 ||----w |
                 ||     ||
 fatal: Could not read from remote repository.

-- System Information:
Debian Release: stretch/sid
 APT prefers unstable
 APT policy: (990, 'unstable'), (500, 'experimental')
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 4.7.0-1-amd64 (SMP w/2 CPU cores)
Locale: LANG=C, LC_CTYPE=pl_PL.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: sysvinit (via /sbin/init)

myrepos depends on no packages.

Versions of packages myrepos recommends:
ii  libhtml-parser-perl  3.72-2+b1
ii  libio-pty-easy-perl  0.09-2
ii  libwww-perl          6.15-1
ii  perl                 5.24.1~rc3-3

Versions of packages myrepos suggests:
pn  ack-grep          <none>
ii  bzr               2.7.0+bzr6619-2
ii  curl              7.50.1-1
pn  cvs               <none>
pn  darcs             <none>
pn  fossil            <none>
ii  git [git-core]    1:2.9.3-1
pn  kdesdk-scripts    <none>
ii  liburi-perl       1.71-1
ii  mercurial         3.9.1-1
ii  subversion        1.9.4-3+b1
pn  subversion-tools  <none>
pn  vcsh              <none>

--
Jakub Wilk

```
```
[[badgit.html](bugreport.cgi?att=1;bug=840014;filename=badgit.html;msg=3) (text/html, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Wed, 07 Feb 2018 09:03:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=5), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=5), [link](#4)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Wed, 07 Feb 2018 09:03:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=7), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=8), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: 840014@bugs.debian.org, 840014-submitter@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: webcheckout: missing URL sanitization
Date: Wed, 07 Feb 2018 16:59:26 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=8) (text/plain, inline)]
```
```
On Fri, 7 Oct 2016 18:27:12 +0200 Jakub Wilk wrote:

>  $ webcheckout /path/to/badgit.html
>  git clone ext::sh -c cowsay% pwned% >% /dev/tty

I consider this particular attack to be a bug in git and the
git authors seem to agree with me because it is blocked in sid.

Do you think this should be fixed in git or in webcheckout or both?

$ webcheckout ./badgit.html
git clone -- ext::sh -c cowsay% pwned% >% /dev/tty
Cloning into 'tty'...
fatal: transport 'ext' not allowed
failed to checkout ext::sh -c cowsay% pwned% >% /dev/tty

$ grep -riA6 git-remote-ext /usr/share/doc/git/RelNotes/ | head -n6
/usr/share/doc/git/RelNotes/2.4.10.txt: * Some protocols (like git-remote-ext) can execute arbitrary code
/usr/share/doc/git/RelNotes/2.4.10.txt-   found in the URL.  The URLs that submodules use may come from
/usr/share/doc/git/RelNotes/2.4.10.txt-   arbitrary sources (e.g., .gitmodules files in a remote
/usr/share/doc/git/RelNotes/2.4.10.txt-   repository), and can hurt those who blindly enable recursive
/usr/share/doc/git/RelNotes/2.4.10.txt-   fetch.  Restrict the allowed protocols to well known and safe
/usr/share/doc/git/RelNotes/2.4.10.txt-   ones.

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=840014;filename=signature.asc;msg=8) (application/pgp-signature, inline)]
```

---

**Message sent on**
to `Jakub Wilk <jwilk@debian.org>`:

Bug#840014.
(Wed, 07 Feb 2018 09:03:06 GMT) ([full text](bugreport.cgi?bug=840014;msg=10), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=10), [link](#9)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Thu, 08 Feb 2018 20:48:02 GMT) ([full text](bugreport.cgi?bug=840014;msg=13), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=14), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: 840014@bugs.debian.org
Cc: Paul Wise <pabs@debian.org>, Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Thu, 8 Feb 2018 21:44:14 +0100
```
* Paul Wise <pabs@debian.org>, 2018-02-07, 16:59:
>>  $ webcheckout /path/to/badgit.html
>>  git clone ext::sh -c cowsay% pwned% >% /dev/tty
>
>I consider this particular attack to be a bug in git and the git
>authors seem to agree with me because it is blocked in sid.

It's hard to tell whether they agree, because disabling git-remote-ext
by default is not documented AFAICT. See bug #867699.

Users might need to re-enable git-remote-ext for their own purposes, so
this needs to be fixed in webcheckout.

webcheckout is also susceptible to option injection, but I couldn't find
a way to exploit it for anything nefarious.

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Fri, 09 Feb 2018 02:00:04 GMT) ([full text](bugreport.cgi?bug=840014;msg=16), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Fri, 09 Feb 2018 02:00:04 GMT) ([full text](bugreport.cgi?bug=840014;msg=18), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=19), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Fri, 09 Feb 2018 09:56:56 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=19) (text/plain, inline)]
```
```
On Thu, 2018-02-08 at 21:44 +0100, Jakub Wilk wrote:

> It's hard to tell whether they agree, because disabling git-remote-ext
> by default is not documented AFAICT. See bug #867699.

Thanks for the pointer.

> Users might need to re-enable git-remote-ext for their own purposes, so
> this needs to be fixed in webcheckout.

How would you suggest doing that?

 * Blacklist ext::
 * Whitelist good remote protocols

How should it handle the bad remotes?

* Fail with "potentially unsafe git remote"
* Fail with "potentially unsafe git URL, may execute code: ext::*"
* Fail with "potentially unsafe git URL, may execute code:
             git clone ext::*"

> webcheckout is also susceptible to option injection, but I couldn't find
> a way to exploit it for anything nefarious.

I made a patch for that locally, but I wanted the commit to link to the
canonical document about option injection but I cannot find a link.
IIRC it includes how to get RCE with tar/cpio/etc option injection.
Do you remember where that can be found?

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=840014;filename=signature.asc;msg=19) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sun, 11 Feb 2018 13:12:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=21), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=22), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: 840014@bugs.debian.org
Cc: Paul Wise <pabs@debian.org>, Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sun, 11 Feb 2018 14:09:01 +0100
```
* Paul Wise <pabs@debian.org>, 2018-02-09, 09:56:
>>Users might need to re-enable git-remote-ext for their own purposes,
>>so this needs to be fixed in webcheckout.
>How would you suggest doing that?
>
> * Blacklist ext::
> * Whitelist good remote protocols

For Git (>= 2.12), you can set GIT_PROTOCOL_FROM_USER=0 in environment.
Quoting git(1): "this is useful [...] for programs which feed
potentially-untrusted URLS to git commands".

If you want to support older versions of Git, I guess you should mimic
what GIT_PROTOCOL_FROM_USER=0 does by default, i.e. whitelist known-good
protocols.

>How should it handle the bad remotes?

I think printing the whole suspicious URL would make sense.

>>webcheckout is also susceptible to option injection, but I couldn't
>>find a way to exploit it for anything nefarious.
>I made a patch for that locally, but I wanted the commit to link to the
>canonical document about option injection but I cannot find a link.
>IIRC it includes how to get RCE with tar/cpio/etc option injection. Do
>you remember where that can be found?

I haven't heard about it.

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sun, 11 Feb 2018 14:06:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=24), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Sun, 11 Feb 2018 14:06:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=26), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=27), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sun, 11 Feb 2018 22:04:11 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=27) (text/plain, inline)]
```
```
On Sun, 2018-02-11 at 14:09 +0100, Jakub Wilk wrote:

> For Git (>= 2.12), you can set GIT_PROTOCOL_FROM_USER=0 in
> environment.
> Quoting git(1): "this is useful [...] for programs which feed
> potentially-untrusted URLS to git commands".

Ah, I missed that addition.

> If you want to support older versions of Git, I guess you should mimic
> what GIT_PROTOCOL_FROM_USER=0 does by default, i.e. whitelist known-good
> protocols.

I think I will check the git version and apply the manual whitelisting
only for versions of git older than 2.12.

> I think printing the whole suspicious URL would make sense.

OK.

> I haven't heard about it.

OK, pushed my patch for that.

<http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=f8b5baf18928544ce5c3575641fe852a86e93254>

I also made webcheckout prefer https:

<http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=57b5fa2b85c6285c2f88de242016fdbeb112b91e>

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=840014;filename=signature.asc;msg=27) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sun, 11 Feb 2018 14:57:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=29), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Sun, 11 Feb 2018 14:57:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=31), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=32), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sun, 11 Feb 2018 22:54:58 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=32) (text/plain, inline)]
```
```
On Sun, 2018-02-11 at 22:04 +0800, Paul Wise wrote:

> I think I will check the git version and apply the manual
> whitelisting only for versions of git older than 2.12.

Attached my proposed patch for the git issue.

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch](bugreport.cgi?att=1;bug=840014;filename=0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch;msg=32) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=840014;filename=signature.asc;msg=32) (application/pgp-signature, inline)]
```

---

**Changed Bug title to 'webcheckout: CVE-2018-7032: missing URL sanitization' from 'webcheckout: missing URL sanitization'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 14 Feb 2018 19:57:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=34), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=34), [link](#33)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sun, 18 Feb 2018 21:30:04 GMT) ([full text](bugreport.cgi?bug=840014;msg=36), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=37), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: 840014@bugs.debian.org
Cc: Paul Wise <pabs@debian.org>, Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sun, 18 Feb 2018 22:27:39 +0100
```
>+my ($major, $minor, undef) = split(/\./, $git_version);

You don't need trailing undef here. (The number of components is a git
version varies between 3 and 4, so you can't make the number of items of
the left side always match anyway.)

>+		if ($git_unsafe && $git_url !~ /^(?:https?|git|ssh|file):[^:]/) {

SSH protocol has an alternative (and I guess more popular) scp-like
syntax:

   [user@]example.org:path/to/repo

There are also two syntaxes for local repositories, although I think
neither should be allowed. It's *web*checkout after all...

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Mon, 19 Feb 2018 05:39:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=39), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Mon, 19 Feb 2018 05:39:04 GMT) ([full text](bugreport.cgi?bug=840014;msg=41), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=42), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Mon, 19 Feb 2018 13:37:05 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=42) (text/plain, inline)]
```
```
On Sun, 2018-02-18 at 22:27 +0100, Jakub Wilk wrote:

> You don't need trailing undef here.

Tested, removed

> SSH protocol has an alternative scp-like syntax:

Added, hope I got the regex right.

> There are also two syntaxes for local repositories, although I think
> neither should be allowed. It's *web*checkout after all...

Blocked those.

Updated patch attached.

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch](bugreport.cgi?att=1;bug=840014;filename=0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch;msg=42) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=840014;filename=signature.asc;msg=42) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Mon, 19 Feb 2018 05:39:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=44), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=44), [link](#43)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Mon, 19 Feb 2018 05:39:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=46), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=47), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Mon, 19 Feb 2018 13:37:38 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=47) (text/plain, inline)]
```
```
On Sun, 2018-02-18 at 22:27 +0100, Jakub Wilk wrote:

> You don't need trailing undef here.

Tested, removed.

> SSH protocol has an alternative scp-like syntax:

Added, hope I got the regex right.

> There are also two syntaxes for local repositories, although I think
> neither should be allowed. It's *web*checkout after all...

Blocked those.

Updated patch attached.

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch](bugreport.cgi?att=1;bug=840014;filename=0001-Mitigate-vulnerabilities-caused-by-some-git-remotes-.patch;msg=47) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=840014;filename=signature.asc;msg=47) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Thu, 22 Feb 2018 21:12:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=49), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=50), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: 840014@bugs.debian.org
Cc: Paul Wise <pabs@debian.org>, Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Thu, 22 Feb 2018 22:09:04 +0100
```
>$git_url !~ m{^(?:(?:https?|git|ssh):[^:]|(?:[-_.a-z0-9]+@)?[-_.a-z0-9]+:(?:[^:]|$))}) {

Uppercase letter should be allowed in usernames and domains, I guess?

This regexp matches "foo://bar"; but this URL would make git execute
remote helper "foo", which might be unsafe. I suggest replacing

  (?:[^:]|$)

with

  (?!:|//)

>qw(git clone -c protocol.file.allow=user --)

qw(git -c protocol.file.allow=user clone --) would be better here.
The difference is that the former unnecessarily puts
protocol.file.allow=user in the repo's .git/config.

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Fri, 23 Feb 2018 00:39:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=52), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=52), [link](#51)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Fri, 23 Feb 2018 00:39:05 GMT) ([full text](bugreport.cgi?bug=840014;msg=54), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=55), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Fri, 23 Feb 2018 08:38:21 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=55) (text/plain, inline)]
```
```
Control: tags -1 + fixed-upstream patch upstream
Control: forwarded -1 <http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=40a3df21c73f1bb1b6915cc6fa503f50814664c8>

On Thu, 2018-02-22 at 22:09 +0100, Jakub Wilk wrote:

> Uppercase letter should be allowed in usernames and domains, I guess?

Added.

> This regexp matches "foo://bar"; but this URL would make git execute
> remote helper "foo", which might be unsafe. I suggest replacing
>
>    (?:[^:]|$)
>
> with
>
>    (?!:|//)

Replaced.

> qw(git -c protocol.file.allow=user clone --) would be better here.
> The difference is that the former unnecessarily puts
> protocol.file.allow=user in the repo's .git/config.

Used that instead.

I've pushed the commit upstream to the URL above.

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=840014;filename=signature.asc;msg=55) (application/pgp-signature, inline)]
```

---

**Added tag(s) fixed-upstream, patch, and upstream.**
Request was from `Paul Wise <pabs@debian.org>`
to `840014-submit@bugs.debian.org`.
(Fri, 23 Feb 2018 00:39:06 GMT) ([full text](bugreport.cgi?bug=840014;msg=57), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=57), [link](#56)).

---

**Set Bug forwarded-to-address to '<http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=40a3df21c73f1bb1b6915cc6fa503f50814664c8>'.**
Request was from `Paul Wise <pabs@debian.org>`
to `840014-submit@bugs.debian.org`.
(Fri, 23 Feb 2018 00:39:06 GMT) ([full text](bugreport.cgi?bug=840014;msg=59), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=59), [link](#58)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sat, 24 Feb 2018 17:51:03 GMT) ([full text](bugreport.cgi?bug=840014;msg=61), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=61), [link](#60)).

---

[Message #62](#62) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=62), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=62), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40jwilk.net)
From: Jakub Wilk <jwilk@jwilk.net>
To: 840014@bugs.debian.org
Cc: Paul Wise <pabs@debian.org>, Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sat, 24 Feb 2018 18:46:36 +0100
```
>if (int($major) >= 2 && int($minor) >= 12) {

">=" compares numerically even when arguments are strings, so the int()
calls aren't needed here.

More importantly, this will break when Git 3.0 is released, because
int($minor) >= 12 will be no longer true.

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Richard Hartmann <richih@debian.org>`:

`Bug#840014`; Package `myrepos`.
(Sun, 25 Feb 2018 01:09:02 GMT) ([full text](bugreport.cgi?bug=840014;msg=64), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=64), [link](#63)).

---

**Acknowledgement sent**
to `Paul Wise <pabs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Richard Hartmann <richih@debian.org>`.
(Sun, 25 Feb 2018 01:09:02 GMT) ([full text](bugreport.cgi?bug=840014;msg=66), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=66), [link](#65)).

---

[Message #67](#67) received at 840014@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=67), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=67), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: Jakub Wilk <jwilk@jwilk.net>, 840014@bugs.debian.org
Cc: Debian Security Team <security@debian.org>
Subject: Re: Bug#840014: webcheckout: missing URL sanitization
Date: Sun, 25 Feb 2018 09:05:17 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=840014;msg=67) (text/plain, inline)]
```
```
On Sat, 2018-02-24 at 18:46 +0100, Jakub Wilk wrote:

> ">=" compares numerically even when arguments are strings, so the int()
> calls aren't needed here.
>
> More importantly, this will break when Git 3.0 is released, because
> int($minor) >= 12 will be no longer true.

Fixed in git:

<http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=6808ec71ba7ae13f3cf755561aa4165e4f623f0d>

--
bye,
pabs

<https://wiki.debian.org/PaulWise>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=840014;filename=signature.asc;msg=67) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Paul Wise <pabs@debian.org>`:

You have taken responsibility.
(Thu, 26 Jul 2018 06:39:09 GMT) ([full text](bugreport.cgi?bug=840014;msg=69), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=69), [link](#68)).

---

**Notification sent**
to `Jakub Wilk <jwilk@debian.org>`:

Bug acknowledged by developer.
(Thu, 26 Jul 2018 06:39:09 GMT) ([full text](bugreport.cgi?bug=840014;msg=71), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=71), [link](#70)).

---

[Message #72](#72) received at 840014-close@bugs.debian.org ([full text](bugreport.cgi?bug=840014;msg=72), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=72), reply):

![](/cgi-bin/libravatar.cgi?email=pabs%40debian.org)
From: Paul Wise <pabs@debian.org>
To: 840014-close@bugs.debian.org
Subject: Bug#840014: fixed in myrepos 1.20180726
Date: Thu, 26 Jul 2018 06:36:26 +0000
```
Source: myrepos
Source-Version: 1.20180726

We believe that the bug you reported is fixed in the latest version of
myrepos, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 840014@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Paul Wise <pabs@debian.org> (supplier of updated myrepos package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 26 Jul 2018 14:14:21 +0800
Source: myrepos
Binary: myrepos
Architecture: source
Version: 1.20180726
Distribution: unstable
Urgency: medium
Maintainer: Richard Hartmann <richih@debian.org>
Changed-By: Paul Wise <pabs@debian.org>
Description:
 myrepos    - tool to manage all your version control repos
Closes: [813738](bugreport.cgi?bug=813738) [828827](bugreport.cgi?bug=828827) [840014](bugreport.cgi?bug=840014) [849600](bugreport.cgi?bug=849600)
Changes:
 myrepos (1.20180726) unstable; urgency=medium
 .
   [ Andrew Bradford ]
   * Suggest perl-doc (Closes: #[813738](bugreport.cgi?bug=813738))
 .
   [ Mark Haber ]
   * Fix hours_since for git fake bare repos (Closes: #[828827](bugreport.cgi?bug=828827))
 .
   [ Tom Hoover ]
   * Fix 'no defined update command error' in example config
 .
   [ Pavel Nakonechnyi ]
   * More meaningful names for temporary files
 .
   [ Paul Wise ]
   * Mitigate vulns caused by git code execution (Closes: #[840014](bugreport.cgi?bug=840014), [CVE-2018-7032](https://security-tracker.debian.org/tracker/CVE-2018-7032))
   * Migrate from ack-grep to ack (Closes: #[849600](bugreport.cgi?bug=849600))
   * More reliable output supervision
   * Allow prepending commands to existing commands
   * Allow for fallback to default commands
   * Add support for caching command output
   * Add graph, remote, upgrade extensions
   * Improve the status output for CVS
   * Improve the git-cvs extension
   * Add shell extension to maintain a repo status cache
   * git registration improvements
   * webcheckout: prefer https transport
   * Suggest more tools that are used
   * Various packaging cleanups
Checksums-Sha1:
 2cb324a1b82512a055643b61888a5356505930bb 1650 myrepos_1.20180726.dsc
 179b646fceef652af959a31f819ca5e5e484d7cb 60388 myrepos_1.20180726.tar.xz
 f2e3ab43ce953ea75704b71ec862bb3fe9993b95 6223 myrepos_1.20180726_amd64.buildinfo
Checksums-Sha256:
 6ec574242cd45cbda0b60f82a75f7aa9550142a975a3ed019f13c923ee2a643e 1650 myrepos_1.20180726.dsc
 9e9e4c114aae22e0aac51ecbc8d84ae617a5e5dfa979fab0d3bc42945f603f1e 60388 myrepos_1.20180726.tar.xz
 6b1691d8b882aa4eacc7ec866b5b7cfabbb858e04f276415715a6668138f4014 6223 myrepos_1.20180726_amd64.buildinfo
Files:
 4d4ba1c413dead5cf1953e11712484d6 1650 vcs optional myrepos_1.20180726.dsc
 901589ef6535ab00584784e38126c6ab 60388 vcs optional myrepos_1.20180726.tar.xz
 7223ce17f3369d6983333dbb92fbbf19 6223 vcs optional myrepos_1.20180726_amd64.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEYQsotVz8/kXqG1Y7MRa6Xp/6aaMFAltZafcACgkQMRa6Xp/6
aaP+mRAApuFpSBasvDegxfFIL2iTq2YrbW8cLCk/6IuqXIWBSfio2YMvCaRp7Bz0
us09SZpYC6v+k56879g1gum0QvZ7bkJQT2wNf+lk0H2HDTB+pBSflsQrUp3YqyXv
yvuFoakXemya5z3NwUQJ+zsRaVV9Ja9QEI6SnYcKCyy+f2kFrIUi1urEugAe67tQ
x64u2KCTYkcrlr8CDiT+oJt+CHbElHNozsOgOC2K8UWe5ep7JhKxRxIPK9mVtiBb
lCN6Q5/zz+01DoXkrqq7v+PsB+UAu+ZipGzOQ1FNoich5XSXlnTMdb4zNwGH7EPD
dO+cVNiwzsKFbXWKAgZO9iSdv3LXn5aZRxAYKEGC5oaLTlB+Cj2h3u1Uito3KDJ8
jB5wtkW/W9fU7eOpbqVO0zz4vosBa+MC/6SDWFFy9imDeGabenfNbZ1jpZygaQs6
wOITuw9ENw2DCLuVEnVdGgA56rC330Sak9vNcAz1VgsDzdno5Pa6lzsxUmh5mkAn
MNok4Kb/AYNGiZsglD5OwT5ZYlFtuNyypun5zHht07Lat67IUhw34HrHUwhtVBLG
ZZi07u53np+Xw70piZ+gaHSl2JGWyXyP1ycXT8y7Bgaix/7iVOjKSBCcKbfi6/Sa
ewIw3zWIDV2CGSkyFdY11Tjy2Vl230jtA6beJTQ7iD28UzUzDMY=
=vksk
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 25 Aug 2018 07:25:58 GMT) ([full text](bugreport.cgi?bug=840014;msg=74), [mbox](bugreport.cgi?bug=840014;mbox=yes;msg=74), [link](#73)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=840014).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 18:42:51 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_ad39cb6f_20250126_025128.html ===

# CVE-2018-7032

| **Name** | CVE-2018-7032 |
| --- | --- |
| **Description** | webcheckout in myrepos through 1.20171231 does not sanitize URLs that are passed to git clone, allowing a malicious website operator or a MitM attacker to take advantage of it for arbitrary code execution, as demonstrated by an "ext::sh -c" attack or an option injection attack. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2018-7032) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-7032); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2018-7032), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2018-7032), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2018-7032), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2018-7032), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-7032), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2018-7032), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2018-7032), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2018-7032)/[CVE](https://www.suse.com/security/cve/CVE-2018-7032/), GitHub [advisories](https://github.com/advisories?query=CVE-2018-7032)/[code](https://github.com/search?type=Code&q=%22CVE-2018-7032%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2018-7032%22), [web search](https://duckduckgo.com/html?q=%22CVE-2018-7032%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [840014](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840014) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [myrepos](/tracker/source-package/myrepos) ([PTS](https://tracker.debian.org/pkg/myrepos)) | sid, trixie, bookworm, bullseye | 1.20180726 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [mr](/tracker/source-package/mr) | source | (unstable) | 1.16 |  |  |  |
| [myrepos](/tracker/source-package/myrepos) | source | (unstable) | 1.20180726 |  |  | [840014](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=840014) |

## Notes

```
[stretch] - myrepos <no-dsa> (Minor issue)
[jessie] - myrepos <no-dsa> (Minor issue)
[wheezy] - mr <no-dsa> (Minor issue)
1.16 was made a source-based transitional package to myrepos not containg
in particular webcheckout anymore.
<http://source.myrepos.branchable.com/?p=source.git;a=commitdiff;h=40a3df21c73f1bb1b6915cc6fa503f50814664c8>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


