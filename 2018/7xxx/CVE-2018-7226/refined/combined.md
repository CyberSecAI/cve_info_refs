=== Content from security.gentoo.org_772a9221_20250125_031133.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# LibVNCServer: Multiple vulnerabilities — GLSA **201908-05**

Multiple vulnerabilities have been found in LibVNCServer, the worst
of which could result in the arbitrary execution of code.

### Affected packages

| Package | **net-libs/libvncserver** on all architectures |
| --- | --- |
| Affected versions | < **0.9.12** |
| Unaffected versions | >= **0.9.12** |

### Background

LibVNCServer/LibVNCClient are cross-platform C libraries that allow you
to easily implement VNC server or client functionality in your program.

### Description

Multiple vulnerabilities have been discovered in LibVNCServer. Please
review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All LibVNCServer users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/libvncserver-0.9.12"

```
### References

* [CVE-2018-20019](https://nvd.nist.gov/vuln/detail/CVE-2018-20019)
* [CVE-2018-20020](https://nvd.nist.gov/vuln/detail/CVE-2018-20020)
* [CVE-2018-20021](https://nvd.nist.gov/vuln/detail/CVE-2018-20021)
* [CVE-2018-20022](https://nvd.nist.gov/vuln/detail/CVE-2018-20022)
* [CVE-2018-20023](https://nvd.nist.gov/vuln/detail/CVE-2018-20023)
* [CVE-2018-20024](https://nvd.nist.gov/vuln/detail/CVE-2018-20024)
* [CVE-2018-7225](https://nvd.nist.gov/vuln/detail/CVE-2018-7225)
* [CVE-2018-7226](https://nvd.nist.gov/vuln/detail/CVE-2018-7226)

**Release date**

August 09, 2019

**Latest revision**

August 09, 2019: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [659560](https://bugs.gentoo.org/show_bug.cgi?id=659560)
* [673508](https://bugs.gentoo.org/show_bug.cgi?id=673508)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_220395fb_20250126_053925.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 6
ReportLab-1.11.ebuild
Last modified: 2024-04-12 09:55:35 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=6&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=6&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 6**](show_bug.cgi?id=6)
- ReportLab-1.11.ebuild

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
ReportLab-1.11.ebuild

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] Development ([show other bugs](buglist.cgi?component=%5BOLD%5D%20Development&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Damon Conway (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | EBUILD | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [5](show_bug.cgi?id=5 "RESOLVED FIXED - Imaging-1.1.2.ebuild") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [7](show_bug.cgi?id=7 "RESOLVED FIXED - gramps-0.7.0.ebuild") | |  | Show dependency [tree](showdependencytree.cgi?id=6&hide_resolved=1) | |  | | Reported: | 2002-01-04 02:50 UTC by Tod M. Neidt | | --- | --- | | Modified: | 2024-04-12 09:55 UTC ([History](show_activity.cgi?id=6)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**ReportLab-1.11.ebuild**](attachment.cgi?id=5 "View the content of the attachment") (ReportLab-1.11.ebuild,995 bytes, text/plain)  [2002-01-04 02:51 UTC](#attach_5 "Go to the comment associated with the attachment"), Tod M. Neidt | [Details](attachment.cgi?id=5&action=edit) | | [**pg\_activity-3.5.0\_20240403-070656.log.txt.xz**](attachment.cgi?id=890480 "View the content of the attachment") (pg\_activity-3.5.0\_20240403-070656.log.txt.xz,6.09 KB, application/x-xz)  [2024-04-12 09:53 UTC](#attach_890480 "Go to the comment associated with the attachment"), Agostino Sarubbo | [Details](attachment.cgi?id=890480&action=edit) | | [**pg\_activity-3.5.0\_20240403-070656.log.txt.xz**](attachment.cgi?id=890481 "View the content of the attachment") (pg\_activity-3.5.0\_20240403-070656.log.txt.xz,6.09 KB, application/x-xz)  [2024-04-12 09:54 UTC](#attach_890481 "Go to the comment associated with the attachment"), Agostino Sarubbo | [Details](attachment.cgi?id=890481&action=edit) | | [Show Obsolete](#a0) (2) [View All](attachment.cgi?bugid=6&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=6&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=6&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Tod M. Neidt    2002-01-04 02:50:31 UTC  ``` Hi!  Please find attached ReportLab-1.11.ebuild.  ReportLab is a python tool set for the generation of pdf files.  It requires the Python Imaging Library submitted earlier.  I suggest dev-python/ReportLab  tod ```  [Comment 1](#c1)  Tod M. Neidt    2002-01-04 02:51:12 UTC  ``` Created [attachment 5](attachment.cgi?id=5 "ReportLab-1.11.ebuild") [[details](attachment.cgi?id=5&action=edit "ReportLab-1.11.ebuild")] ReportLab-1.11.ebuild ```  [Comment 2](#c2)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-04 21:05:00 UTC  ``` commited to dev-python/Imaging ```  [Comment 3](#c3)  Mikael Hallendal (hallski) (RETIRED)   gentoo-dev  2002-01-04 21:05:53 UTC  ``` That is dev-python/ReportLab ```  [Comment 4](#c4)  Agostino Sarubbo   gentoo-dev  2024-04-12 09:53:18 UTC  ``` Created [attachment 890480](attachment.cgi?id=890480 "pg_activity-3.5.0_20240403-070656.log.txt.xz") [[details](attachment.cgi?id=890480&action=edit "pg_activity-3.5.0_20240403-070656.log.txt.xz")] pg_activity-3.5.0_20240403-070656.log.txt.xz ```  [Comment 5](#c5)  Agostino Sarubbo   gentoo-dev  2024-04-12 09:54:06 UTC  ``` Created [attachment 890481](attachment.cgi?id=890481 "pg_activity-3.5.0_20240403-070656.log.txt.xz") [[details](attachment.cgi?id=890481&action=edit "pg_activity-3.5.0_20240403-070656.log.txt.xz")] pg_activity-3.5.0_20240403-070656.log.txt.xz ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=6)
* - [XML](show_bug.cgi?ctype=xml&id=6)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=6)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=6&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=6&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=6&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from openwall.com_995c1d53_20250125_031132.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20180218214431.GA23494@openwall.com>
Date: Sun, 18 Feb 2018 22:44:31 +0100
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: LibVNCServer rfbserver.c: rfbProcessClientNormalMessage() case rfbClientCutText doesn't sanitize msg.cct.length

On Sun, Feb 18, 2018 at 07:09:45PM +0100, Solar Designer wrote:
> vcSetXCutTextProc() came from LibVNCServer-0.9.9/vncterm/VNConsole.c, so its
> shortcomings also need to be reported to LibVNCServer upstream.

> vncterm exists as a separate repo,
> so I might report its issues in there: <https://github.com/LibVNC/vncterm>

Reported vncterm: VNConsole.c: vcSetXCutTextProc() integer overflow and
unchecked malloc():

<https://github.com/LibVNC/vncterm/issues/6>

vncterm's implementation of the callback is:

void vcSetXCutTextProc(char* str,int len, struct _rfbClientRec* cl)
{
  vncConsolePtr c=(vncConsolePtr)cl->screen->screenData;

  if(c->selection) free(c->selection);
  c->selection=(char*)malloc(len+1);
  memcpy(c->selection,str,len);
  c->selection[len]=0;
}

Besides the conversion to signed int during the call (a LibVNCServer API
issue), there's also len+1 in the implementation, which may cause an
integer overflow resulting in e.g. malloc(0) (which succeeds) followed
by memcpy(..., ..., -1) (which writes beyond the allocated memory).  And
there's no check for malloc() possibly returning NULL.

I did not request CVE ID(s) for this, and I don't intend to do so.  If
you need to, please feel free to track the vncterm vcSetXCutTextProc()
issues above as OVE-20180218-0002.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_cf81365e_20250125_031133.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibVNC%2Fvncterm%2Fissues%2F6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibVNC%2Fvncterm%2Fissues%2F6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=LibVNC%2Fvncterm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LibVNC](/LibVNC)
/
**[vncterm](/LibVNC/vncterm)**
Public

* [Notifications](/login?return_to=%2FLibVNC%2Fvncterm) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2FLibVNC%2Fvncterm)
* [Star
   36](/login?return_to=%2FLibVNC%2Fvncterm)

* [Code](/LibVNC/vncterm)
* [Issues
  3](/LibVNC/vncterm/issues)
* [Pull requests
  0](/LibVNC/vncterm/pulls)
* [Actions](/LibVNC/vncterm/actions)
* [Projects
  0](/LibVNC/vncterm/projects)
* [Wiki](/LibVNC/vncterm/wiki)
* [Security](/LibVNC/vncterm/security)
* [Insights](/LibVNC/vncterm/pulse)

Additional navigation options

* [Code](/LibVNC/vncterm)
* [Issues](/LibVNC/vncterm/issues)
* [Pull requests](/LibVNC/vncterm/pulls)
* [Actions](/LibVNC/vncterm/actions)
* [Projects](/LibVNC/vncterm/projects)
* [Wiki](/LibVNC/vncterm/wiki)
* [Security](/LibVNC/vncterm/security)
* [Insights](/LibVNC/vncterm/pulse)

# Security: VNConsole.c: vcSetXCutTextProc() integer overflow and unchecked malloc() #6

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Security: VNConsole.c: vcSetXCutTextProc() integer overflow and unchecked malloc()](#top)#6Copy linkLabels[bug](https://github.com/LibVNC/vncterm/issues?q=state%3Aopen%20label%3A%22bug%22)[![@solardiz](https://avatars.githubusercontent.com/u/18089797?u=3b130ac6cebae1efd12a9f46d20e619ae3a21e9a&v=4&size=80)](/solardiz)
## Description

[![@solardiz](https://avatars.githubusercontent.com/u/18089797?u=3b130ac6cebae1efd12a9f46d20e619ae3a21e9a&v=4&size=48)](/solardiz)[solardiz](https://github.com/solardiz)opened [on Feb 18, 2018](https://github.com/LibVNC/vncterm/issues/6#issue-298118098)

While I consider this a security-relevant issue, I feel there's no overall benefit from reporting it under an embargo, so here goes.

As I reported in [LibVNC/libvncserver#218](https://github.com/LibVNC/libvncserver/issues/218), LibVNCServer's `setXCutText()` callback API is poorly defined (with `int` instead of `size_t`) and poorly used by LibVNCServer (without sanitization of the length, and passing in the client-specified full length even if fewer bytes were actually read from the client). I also mentioned callback implementation side issues, as illustrated by prl-vzvncserver's callback, which was based off vncterm's (hence the report in here) and which has since been fixed in prl-vzvncserver.

vncterm's implementation of the callback was and still is:

```
void vcSetXCutTextProc(char* str,int len, struct _rfbClientRec* cl)
{
  vncConsolePtr c=(vncConsolePtr)cl->screen->screenData;

  if(c->selection) free(c->selection);
  c->selection=(char*)malloc(len+1);
  memcpy(c->selection,str,len);
  c->selection[len]=0;
}
```

Besides the conversion to signed int during the call, there's also `len+1` in the implementation, which may cause an integer overflow resulting in e.g. `malloc(0)` (which succeeds) followed by `memcpy(..., ..., -1)` (which writes beyond the allocated memory). And there's no check for `malloc()` possibly returning NULL.

I first found the issue during Openwall's security audit of the Virtuozzo 7 product, which reuses this code in its prl-vzvncserver component. A corresponding Virtuozzo 7 fix is:

<https://src.openvz.org/projects/OVZ/repos/prl-vzvncserver/commits/1204a8872d90c78a2be404dd4b025124bb01b2c5>

We would like to thank the Virtuozzo company for funding the effort.

Included below is the relevant excerpt from our Virtuozzo 7 report:

--- cut ---

01090, PSBM-58099: prl-vzvncserver and LibVNCServer integer overflows, unlimited memory allocations, and unchecked malloc()

Severity: medium

Thread: 20161226 "prl-vzvncserver"

A particular combination of these 3 problems is demonstrated by sending the output of `echo -e "RFB 003.003\n\001\006\0\0\0\xff\xff\xff\xff"` to prl-vzvncserver's TCP port, when prl-vzvncserver is running without password. (When running with password, authentication would be needed before the specific vulnerable code can be reached, and the string to send would accordingly be longer.) This first causes LibVNCServer to allocate 4 GiB of address space and then to hand out this uninitialized memory to the prl-vzvncserver/console.c: vcSetXCutTextProc() callback, which would attempt to make another similar allocation and make a copy of the data. Unfortunately, this LibVNCServer API, as well as many others, is defined to use "int" rather than "size\_t" for data sizes, and indeed prl-vzvncserver uses "int" too. For this particular request, this results in a zero byte allocation with malloc(), which succeeds, and then in a memcpy() of (size\_t)-1 bytes to it. With a range of other similar requests, malloc() may instead be made to fail (for trying to allocate a ridiculous amount of address space, sign-extended to 64-bit), in which case the memcpy() more reliably fails on a NULL pointer dereference. Either way, the service crashes. Finally, it is possible to have the process actually write to (and thus allocate for real) almost 4 GiB of memory with one request, by making the length field just below 2 GiB. If no data is sent, then 2 GiB would be written from the uninitialized memory (likely mostly read-as-zero) to the memory allocated by prl-vzvncserver's callback. If the data is actually sent, then first it is written to memory by LibVNCServer and then is copied by the callback, for 4 GiB total. Exploitability of this specific issue into something worse than these varying possibilities is highly doubtful (although exploitation of unlimited size memcpy() is not unheard of), but all 3 of these issues are prevalent in prl-vzvncserver and LibVNCServer code in general, so maybe the impact of another similar issue would more obviously be worse. We recommend that sanity checks be introduced into LibVNCServer so that it doesn't try to allocate unreasonable amounts of memory and pass unsafe sizes to callbacks. We also recommend prl-vzvncserver to sanity-check its inputs (including received from LibVNCServer) and in this way avoid integer overflows and unreasonably large allocations. Finally, it is good practice to check whether a malloc() succeeded before writing to the memory. The function vcSetXCutTextProc() came from LibVNCServer-0.9.9/vncterm/VNConsole.c, so its shortcomings also need to be reported to LibVNCServer upstream.

Fix: Some aspects of this issue, most importantly covering prl-vzvncserver's vcSetXCutTextProc() callback, have been addressed with commit 1204a8872d90c78a2be404dd4b025124bb01b2c5 on 20170130.

Related:

<https://googleprojectzero.blogspot.com/2015/03/taming-wild-copy-parallel-thread.html>

<http://www.giac.org/paper/gcih/361/port-80-apache-http-daemon-exploit/103818>

--- cut ---

## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/LibVNC/vncterm/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


