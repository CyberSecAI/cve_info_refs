=== Content from bugs.debian.org_89f68e25_20250125_123902.html ===

# Debian Bug report logs - #892252 python-bleach: CVE-2018-7753: URI values with character entities not properly sanitized

[![version graph](version.cgi?package=src%3Apython-bleach;fixed=python-bleach%2F2.1.3-1;collapse=1;found=python-bleach%2F2.1.2-1;width=2;height=2;absolute=0)](version.cgi?found=python-bleach%2F2.1.2-1;package=src%3Apython-bleach;collapse=1;fixed=python-bleach%2F2.1.3-1;absolute=0;info=1)

Package:
[src:python-bleach](pkgreport.cgi?src=python-bleach);
Maintainer for [src:python-bleach](pkgreport.cgi?src=python-bleach) is [Debian Python Team <team+python@tracker.debian.org>](pkgreport.cgi?maint=team%2Bpython%40tracker.debian.org);

Reported by: [Scott Kitterman <debian@kitterman.com>](pkgreport.cgi?submitter=debian%40kitterman.com)

Date: Wed, 7 Mar 2018 07:12:01 UTC

Severity: important

Tags: security, upstream

Found in version python-bleach/2.1.2-1

Fixed in version python-bleach/2.1.3-1

**Done:** Scott Kitterman <scott@kitterman.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=892252;mbox=yes), [status mbox](bugreport.cgi?bug=892252;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=892252;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Python Modules Team <python-modules-team@lists.alioth.debian.org>`:

`Bug#892252`; Package `src:python-bleach`.
(Wed, 07 Mar 2018 07:12:06 GMT) ([full text](bugreport.cgi?bug=892252;msg=2), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Scott Kitterman <debian@kitterman.com>`:

New Bug report received and forwarded. Copy sent to `Debian Python Modules Team <python-modules-team@lists.alioth.debian.org>`.
(Wed, 07 Mar 2018 07:12:06 GMT) ([full text](bugreport.cgi?bug=892252;msg=4), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=892252;msg=5), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40kitterman.com)
From: Scott Kitterman <debian@kitterman.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: src:python-bleach: URI values with character entities not properly sanitized
Date: Wed, 07 Mar 2018 02:09:14 -0500
```
Package: src:python-bleach
Version: 2.1.2-1
Severity: important
Tags: upstream, security

Version 2.1.3 (March 5th, 2018)
-------------------------------

**Security fixes**

* Attributes that have URI values weren't properly sanitized if the
  values contained character entities. Using character entities, it
  was possible to construct a URI value with a scheme that was not
  allowed that would slide through unsanitized.

  This security issue was introduced in Bleach 2.1. Anyone using
Bleach 2.1 is highly encouraged to upgrade.

```

---

**Message sent on**
to `Scott Kitterman <debian@kitterman.com>`:

Bug#892252.
(Wed, 07 Mar 2018 19:21:08 GMT) ([full text](bugreport.cgi?bug=892252;msg=7), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 892252-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=892252;msg=8), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=scott%40kitterman.com)
From: scott@kitterman.com
To: 892252-submitter@bugs.debian.org
Subject: Bug #892252 in python-bleach marked as pending
Date: Wed, 07 Mar 2018 19:18:46 +0000
```
Control: tag -1 pending

Hello,

Bug #892252 in python-bleach reported by you has been fixed in the
Git repository and is awaiting an upload. You can see the commit
message below, and you can check the diff of the fix at:

<https://salsa.debian.org/python-team/modules/python-bleach/commit/ae078dff09bf9524e08c836b817caf7846a5bc23>

------------------------------------------------------------------------
New upstream release (Closes: #[892252](bugreport.cgi?bug=892252))

------------------------------------------------------------------------

(this message was generated automatically)
--
Greetings

<https://bugs.debian.org/892252>

```

---

**Added tag(s) pending.**
Request was from `scott@kitterman.com`
to `892252-submitter@bugs.debian.org`.
(Wed, 07 Mar 2018 19:21:08 GMT) ([full text](bugreport.cgi?bug=892252;msg=10), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=10), [link](#9)).

---

**Reply sent**
to `Scott Kitterman <scott@kitterman.com>`:

You have taken responsibility.
(Wed, 07 Mar 2018 19:39:05 GMT) ([full text](bugreport.cgi?bug=892252;msg=12), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=12), [link](#11)).

---

**Notification sent**
to `Scott Kitterman <debian@kitterman.com>`:

Bug acknowledged by developer.
(Wed, 07 Mar 2018 19:39:05 GMT) ([full text](bugreport.cgi?bug=892252;msg=14), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 892252-close@bugs.debian.org ([full text](bugreport.cgi?bug=892252;msg=15), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=scott%40kitterman.com)
From: Scott Kitterman <scott@kitterman.com>
To: 892252-close@bugs.debian.org
Subject: Bug#892252: fixed in python-bleach 2.1.3-1
Date: Wed, 07 Mar 2018 19:37:42 +0000
```
Source: python-bleach
Source-Version: 2.1.3-1

We believe that the bug you reported is fixed in the latest version of
python-bleach, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 892252@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Scott Kitterman <scott@kitterman.com> (supplier of updated python-bleach package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Wed, 07 Mar 2018 14:07:14 -0500
Source: python-bleach
Binary: python-bleach python3-bleach python-bleach-doc
Architecture: source all
Version: 2.1.3-1
Distribution: unstable
Urgency: high
Maintainer: Debian Python Modules Team <python-modules-team@lists.alioth.debian.org>
Changed-By: Scott Kitterman <scott@kitterman.com>
Description:
 python-bleach - whitelist-based HTML-sanitizing library (Python 2)
 python-bleach-doc - whitelist-based HTML-sanitizing library (common documentation)
 python3-bleach - whitelist-based HTML-sanitizing library (Python 3)
Closes: [892252](bugreport.cgi?bug=892252)
Changes:
 python-bleach (2.1.3-1) unstable; urgency=high
 .
   [ Ondřej Nový ]
   * d/control: Set Vcs-* to salsa.debian.org
   * d/copyright: Use https protocol in Format field
 .
   [ Scott Kitterman ]
   * New upstream release (Closes: #[892252](bugreport.cgi?bug=892252))
Checksums-Sha1:
 1a60f9aa866bc1ef83406077036df428639bc18d 2624 python-bleach_2.1.3-1.dsc
 978e10156c57eb556f9b4c3cd5b1c213e9c41e2c 50496 python-bleach_2.1.3.orig.tar.gz
 747c726323e8cf60276980fb0e496954560311ff 3232 python-bleach_2.1.3-1.debian.tar.xz
 1fe59e78338bdf5df9c6673cf732b25ec2b4c8a1 56192 python-bleach-doc_2.1.3-1_all.deb
 bae2c40a0e49ba60b2e1ea7192b7aebd695e6134 22096 python-bleach_2.1.3-1_all.deb
 fecece504f502cae07ff1617129e624904947e13 7920 python-bleach_2.1.3-1_amd64.buildinfo
 792c79628b4fb102d10faeb963c7a2a7c270207d 22196 python3-bleach_2.1.3-1_all.deb
Checksums-Sha256:
 cd13b632d25f656bf7dc24cc043de88d9af255d00a1c31c3216d08ef3993fd79 2624 python-bleach_2.1.3-1.dsc
 2efa88ba7a17032436f1e1d337601a6b6551ed734da21a39a53f5bee543ea2de 50496 python-bleach_2.1.3.orig.tar.gz
 1fec610cffa64f6fbf680696d8a0a4b200847f552efc6b2d6262f6e2355474e3 3232 python-bleach_2.1.3-1.debian.tar.xz
 911abce1576cbb06899e3c175ad1c7a1b4bf455e14b3ba83355cf061be6a5e8a 56192 python-bleach-doc_2.1.3-1_all.deb
 fc7163758c3480333fd4dbd6d849e02c149c497c2605e643a1c71bfb4fc95fc8 22096 python-bleach_2.1.3-1_all.deb
 8e054d9218a0624dd1001ee86229f1005116ab6640786c829d6498752c7cad21 7920 python-bleach_2.1.3-1_amd64.buildinfo
 8e8f5e77108655d1b511687f50e589519a89943f81cd93cdea58fee3586bd90f 22196 python3-bleach_2.1.3-1_all.deb
Files:
 28af1f79c63f7bb399080e9453bb90cd 2624 python optional python-bleach_2.1.3-1.dsc
 16c3466551d3a5a369a563b5bca5ee44 50496 python optional python-bleach_2.1.3.orig.tar.gz
 abfb339412e9249a77b1fefb0c8e5ca2 3232 python optional python-bleach_2.1.3-1.debian.tar.xz
 d9383de580c49571bd56f5b57947e3a8 56192 doc optional python-bleach-doc_2.1.3-1_all.deb
 c4aba956290324467429200ee30c250b 22096 python optional python-bleach_2.1.3-1_all.deb
 676a843856bd9ca91a3a0b369385b98a 7920 python optional python-bleach_2.1.3-1_amd64.buildinfo
 381103e844afc32ddaada6310ec0c1cf 22196 python optional python3-bleach_2.1.3-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJaoDssAAoJEHjX3vua1ZrxkvQQAKsVwPIsLwlsyysQgOosqwEi
SLaYLC7TqJeDqf2hA61pHB4ys1gFmFQm2hprePMDFJBPcOdzfFaODKzzc3n71IRm
3my6QQSOAM/GPBDZ+O0nBfDkJQBobXNgcr/tf+xkBF7alQSMTs6Zk/syokJtplQq
QiWU3LoPa3mmR/CHU0rW9odUSycu/ROPCNAXzPDSpJ+dvxxgE/RfSEx7BithP2N7
/gkJQ8zzCv2O3SGXtBgj4agRnvfgLS1Q/bjVj8JUujknCB10+2sSouWLFRjcDlZ2
I2IGCciieGnL2rFT7Q4FEX8H88gnJT7l+HIqwW13BSScYw5c6WRzK7wFu2fgwBd8
5tmAhat1qfyh16nXlkrqkn1InvhXPRG2nD5HtiGFIu4+Fiqatequg3Z3PYkE9sv/
1PrfXYFoplnGZ3IHqaODsrikHMH7kppe8tXh5HG/wFMX7X2Jb92HinUlYz7ViOo9
KDrVGiGQ+2k7Brd9XqfEZujes91fgsliFQkl4iWdodagYPkZbX4mdoQS9EaHhLfA
F8DKtZvw8i7WPF0285WvtJzUEmPOm9aBGPJEOiuw6smTMueh62GMMh/r4s9wjEUN
g97RRyuqoxtQOiDIfFyvY1I45mcWpCUnYX+FaA+qMDD+JZYsc5iQNVVhKE2xKqDo
CjLGInegdh2fa/NSD2K7
=WxvH
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Python Modules Team <python-modules-team@lists.alioth.debian.org>`:

`Bug#892252`; Package `src:python-bleach`.
(Thu, 08 Mar 2018 05:39:03 GMT) ([full text](bugreport.cgi?bug=892252;msg=17), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Python Modules Team <python-modules-team@lists.alioth.debian.org>`.
(Thu, 08 Mar 2018 05:39:03 GMT) ([full text](bugreport.cgi?bug=892252;msg=19), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 892252@bugs.debian.org ([full text](bugreport.cgi?bug=892252;msg=20), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Scott Kitterman <debian@kitterman.com>, 892252@bugs.debian.org
Subject: Re: Bug#892252: src:python-bleach: URI values with character
entities not properly sanitized
Date: Thu, 8 Mar 2018 06:34:08 +0100
```
Control: retitle -1 python-bleach: [CVE-2018-7753](https://security-tracker.debian.org/tracker/CVE-2018-7753): URI values with character entities not properly sanitized

Hi Scott,

On Wed, Mar 07, 2018 at 02:09:14AM -0500, Scott Kitterman wrote:
> Package: src:python-bleach
> Version: 2.1.2-1
> Severity: important
> Tags: upstream, security
>
>
> Version 2.1.3 (March 5th, 2018)
> -------------------------------
>
> **Security fixes**
>
> * Attributes that have URI values weren't properly sanitized if the
>   values contained character entities. Using character entities, it
>   was possible to construct a URI value with a scheme that was not
>   allowed that would slide through unsanitized.
>
>   This security issue was introduced in Bleach 2.1. Anyone using
> Bleach 2.1 is highly encouraged to upgrade.

FTR, this issue was assigned [CVE-2018-7753](https://security-tracker.debian.org/tracker/CVE-2018-7753) by MITRE.

Regards,
Salvatore

```

---

**Changed Bug title to 'python-bleach: CVE-2018-7753: URI values with character entities not properly sanitized' from 'src:python-bleach: URI values with character entities not properly sanitized'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `892252-submit@bugs.debian.org`.
(Thu, 08 Mar 2018 05:39:03 GMT) ([full text](bugreport.cgi?bug=892252;msg=22), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 07 Apr 2018 07:28:01 GMT) ([full text](bugreport.cgi?bug=892252;msg=24), [mbox](bugreport.cgi?bug=892252;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=892252).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 12:39:02 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_cfa94a05_20250125_123904.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Fcommit%2Fc5df5789ec3471a31311f42c2d19fc2cf21b35ef)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Fcommit%2Fc5df5789ec3471a31311f42c2d19fc2cf21b35ef)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mozilla%2Fbleach)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mozilla](/mozilla)
/
**[bleach](/mozilla/bleach)**
Public

* [Notifications](/login?return_to=%2Fmozilla%2Fbleach) You must be signed in to change notification settings
* [Fork
  248](/login?return_to=%2Fmozilla%2Fbleach)
* [Star
   2.7k](/login?return_to=%2Fmozilla%2Fbleach)

* [Code](/mozilla/bleach)
* [Issues
  3](/mozilla/bleach/issues)
* [Pull requests
  1](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

Additional navigation options

* [Code](/mozilla/bleach)
* [Issues](/mozilla/bleach/issues)
* [Pull requests](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

## Commit

[Permalink](/mozilla/bleach/commit/c5df5789ec3471a31311f42c2d19fc2cf21b35ef)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#356](https://github.com/mozilla/bleach/pull/356) from willkg/fix-entities

[Browse files](/mozilla/bleach/tree/c5df5789ec3471a31311f42c2d19fc2cf21b35ef)
Browse the repository at this point in the history

```
Fix url sanitizing
```

* Loading branch information

[![@willkg](https://avatars.githubusercontent.com/u/820826?s=40&v=4)](/willkg)

[willkg](/mozilla/bleach/commits?author=willkg "View all commits by willkg")
authored
Mar 5, 2018

2 parents
[e7f83b8](/mozilla/bleach/commit/e7f83b82b023e4956f99e9316fc7a621f6f507af)
+
[61bf0e6](/mozilla/bleach/commit/61bf0e6db3bdce6294633555e08dd061af465c3c)

commit c5df578

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**210 additions**
and
**22 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* bleach

  + bleach/sanitizer.py
    [sanitizer.py](#diff-961169d4b22958d5c522943ac713d921ade9ba1ce236c44187444ed1835761b4)
* tests

  + tests/test\_clean.py
    [test\_clean.py](#diff-7b21237679ea4001fa7e8fb91a49c176320479f2a2c8358ed34d8249970c5d70)

## There are no files selected for viewing

134 changes: 116 additions & 18 deletions

134
[bleach/sanitizer.py](#diff-961169d4b22958d5c522943ac713d921ade9ba1ce236c44187444ed1835761b4 "bleach/sanitizer.py")

Show comments

[View file](/mozilla/bleach/blob/c5df5789ec3471a31311f42c2d19fc2cf21b35ef/bleach/sanitizer.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,6 +4,7 @@ |
|  |  | import string |
|  |  |  |
|  |  | import six |
|  |  | from six.moves.urllib.parse import urlparse |
|  |  | from xml.sax.saxutils import unescape |
|  |  |  |
|  |  | import html5lib |
| Expand All | | @@ -27,8 +28,11 @@ |
|  |  | from bleach.utils import alphabetize\_attributes, force\_unicode |
|  |  |  |
|  |  |  |
|  |  | #: Map of entity name to expanded entity |
|  |  | ENTITIES = entities |
|  |  |  |
|  |  | #: Trie of html entity string -> character representation |
|  |  | ENTITIES\_TRIE = Trie(entities) |
|  |  | ENTITIES\_TRIE = Trie(ENTITIES) |
|  |  |  |
|  |  | #: List of allowed tags |
|  |  | ALLOWED\_TAGS = [ |
| Expand Down  Expand Up | | @@ -79,13 +83,61 @@ |
|  |  | INVISIBLE\_REPLACEMENT\_CHAR = '?' |
|  |  |  |
|  |  |  |
|  |  | def convert\_entity(value): |
|  |  | """Convert an entity (minus the & and ; part) into what it represents |
|  |  |  |
|  |  | This handles numeric, hex, and text entities. |
|  |  |  |
|  |  | :arg value: the string (minus the ``&`` and ``;`` part) to convert |
|  |  |  |
|  |  | :returns: unicode character |
|  |  |  |
|  |  | """ |
|  |  | if value[0] == '#': |
|  |  | if value[1] in ('x', 'X'): |
|  |  | return six.unichr(int(value[2:], 16)) |
|  |  | return six.unichr(int(value[1:], 10)) |
|  |  |  |
|  |  | return ENTITIES[value] |
|  |  |  |
|  |  |  |
|  |  | def convert\_entities(text): |
|  |  | """Converts all found entities in the text |
|  |  |  |
|  |  | :arg text: the text to convert entities in |
|  |  |  |
|  |  | :returns: unicode text with converted entities |
|  |  |  |
|  |  | """ |
|  |  | if '&' not in text: |
|  |  | return text |
|  |  |  |
|  |  | new\_text = [] |
|  |  | for part in next\_possible\_entity(text): |
|  |  | if not part: |
|  |  | continue |
|  |  |  |
|  |  | if part.startswith('&'): |
|  |  | entity = match\_entity(part) |
|  |  | if entity is not None: |
|  |  | new\_text.append(convert\_entity(entity)) |
|  |  | remainder = part[len(entity) + 2:] |
|  |  | if part: |
|  |  | new\_text.append(remainder) |
|  |  | continue |
|  |  |  |
|  |  | new\_text.append(part) |
|  |  |  |
|  |  | return u''.join(new\_text) |
|  |  |  |
|  |  |  |
|  |  | class BleachHTMLTokenizer(HTMLTokenizer): |
|  |  | def consumeEntity(self, allowedChar=None, fromAttribute=False): |
|  |  | # We don't want to consume and convert entities, so this overrides the |
|  |  | # html5lib tokenizer's consumeEntity so that it's now a no-op. |
|  |  | # |
|  |  | # However, when that gets called, it's consumed an &, so we put that in |
|  |  | # the steam. |
|  |  | # the stream. |
|  |  | if fromAttribute: |
|  |  | self.currentToken['data'][-1][1] += '&' |
|  |  |  |
| Expand Down  Expand Up | | @@ -479,15 +531,69 @@ def sanitize\_characters(self, token): |
|  |  | new\_tokens.append({'type': 'Entity', 'name': entity}) |
|  |  | # Length of the entity plus 2--one for & at the beginning |
|  |  | # and and one for ; at the end |
|  |  | part = part[len(entity) + 2:] |
|  |  | if part: |
|  |  | new\_tokens.append({'type': 'Characters', 'data': part}) |
|  |  | remainder = part[len(entity) + 2:] |
|  |  | if remainder: |
|  |  | new\_tokens.append({'type': 'Characters', 'data': remainder}) |
|  |  | continue |
|  |  |  |
|  |  | new\_tokens.append({'type': 'Characters', 'data': part}) |
|  |  |  |
|  |  | return new\_tokens |
|  |  |  |
|  |  | def sanitize\_uri\_value(self, value, allowed\_protocols): |
|  |  | """Checks a uri value to see if it's allowed |
|  |  |  |
|  |  | :arg value: the uri value to sanitize |
|  |  | :arg allowed\_protocols: list of allowed protocols |
|  |  |  |
|  |  | :returns: allowed value or None |
|  |  |  |
|  |  | """ |
|  |  | # NOTE(willkg): This transforms the value into one that's easier to |
|  |  | # match and verify, but shouldn't get returned since it's vastly |
|  |  | # different than the original value. |
|  |  |  |
|  |  | # Convert all character entities in the value |
|  |  | new\_value = convert\_entities(value) |
|  |  |  |
|  |  | # Nix backtick, space characters, and control characters |
|  |  | new\_value = re.sub( |
|  |  | "[`\000-\040\177-\240\s]+", |
|  |  | '', |
|  |  | new\_value |
|  |  | ) |
|  |  |  |
|  |  | # Remove REPLACEMENT characters |
|  |  | new\_value = new\_value.replace('\ufffd', '') |
|  |  |  |
|  |  | # Lowercase it--this breaks the value, but makes it easier to match |
|  |  | # against |
|  |  | new\_value = new\_value.lower() |
|  |  |  |
|  |  | # Drop attributes with uri values that have protocols that aren't |
|  |  | # allowed |
|  |  | parsed = urlparse(new\_value) |
|  |  | if parsed.scheme: |
|  |  | # If urlparse found a scheme, check that |
|  |  | if parsed.scheme in allowed\_protocols: |
|  |  | return value |
|  |  |  |
|  |  | else: |
|  |  | # Allow uris that are just an anchor |
|  |  | if new\_value.startswith('#'): |
|  |  | return value |
|  |  |  |
|  |  | # Handle protocols that urlparse doesn't recognize like "myprotocol" |
|  |  | if ':' in new\_value and new\_value.split(':')[0] in allowed\_protocols: |
|  |  | return value |
|  |  |  |
|  |  | # If there's no protocol/scheme specified, then assume it's "http" |
|  |  | # and see if that's allowed |
|  |  | if 'http' in allowed\_protocols: |
|  |  | return value |
|  |  |  |
|  |  | return None |
|  |  |  |
|  |  | def allow\_token(self, token): |
|  |  | """Handles the case where we're allowing the tag""" |
|  |  | if 'data' in token: |
| Expand All | | @@ -508,21 +614,13 @@ def allow\_token(self, token): |
|  |  | if not self.attr\_filter(token['name'], name, val): |
|  |  | continue |
|  |  |  |
|  |  | # Look at attributes that have uri values |
|  |  | # Drop attributes with uri values that use a disallowed protocol |
|  |  | # Sanitize attributes with uri values |
|  |  | if namespaced\_name in self.attr\_val\_is\_uri: |
|  |  | val\_unescaped = re.sub( |
|  |  | "[`\000-\040\177-\240\s]+", |
|  |  | '', |
|  |  | unescape(val)).lower() |
|  |  |  |
|  |  | # Remove replacement characters from unescaped characters. |
|  |  | val\_unescaped = val\_unescaped.replace("\ufffd", "") |
|  |  |  |
|  |  | # Drop attributes with uri values that have protocols that |
|  |  | # aren't allowed |
|  |  | if (re.match(r'^[a-z0-9][-+.a-z0-9]\*:', val\_unescaped) and |
|  |  | (val\_unescaped.split(':')[0] not in self.allowed\_protocols)): |
|  |  | new\_value = self.sanitize\_uri\_value(val, self.allowed\_protocols) |
|  |  | if new\_value is None: |
|  |  | continue |
|  |  | val = new\_value |
|  |  |  |
|  |  | # Drop values in svg attrs with non-local IRIs |
|  |  | if namespaced\_name in self.svg\_attr\_val\_allows\_ref: |
| Expand Down | |  |

98 changes: 94 additions & 4 deletions

98
[tests/test\_clean.py](#diff-7b21237679ea4001fa7e8fb91a49c176320479f2a2c8358ed34d8249970c5d70 "tests/test_clean.py")

Show comments

[View file](/mozilla/bleach/blob/c5df5789ec3471a31311f42c2d19fc2cf21b35ef/tests/test_clean.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -213,7 +213,7 @@ def test\_nested\_script\_tag(): |
|  |  | ('an < entity', 'an &lt; entity'), |
|  |  | ('tag < <em>and</em> entity', 'tag &lt; <em>and</em> entity'), |
|  |  | ]) |
|  |  | def test\_bare\_entities(text, expected): |
|  |  | def test\_bare\_entities\_get\_escaped\_correctly(text, expected): |
|  |  | assert clean(text) == expected |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -277,7 +277,7 @@ def test\_bare\_entities(text, expected): |
|  |  | # Verify that clean() doesn't unescape entities. |
|  |  | ('&#39;&#34;', '&#39;&#34;'), |
|  |  | ]) |
|  |  | def test\_character\_entities(text, expected): |
|  |  | def test\_character\_entities\_handling(text, expected): |
|  |  | assert clean(text) == expected |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -534,10 +534,100 @@ def test\_attributes\_list(): |
|  |  |  |
|  |  | # Unspecified protocols are not allowed |
|  |  | ( |
|  |  | '<a href="http://xx.com">invalid href</a>', |
|  |  | '<a href="http://example.com">invalid href</a>', |
|  |  | {'protocols': ['myprotocol']}, |
|  |  | '<a>invalid href</a>' |
|  |  | ) |
|  |  | ), |
|  |  |  |
|  |  | # Anchors are ok |
|  |  | ( |
|  |  | '<a href="#example.com">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a href="#example.com">foo</a>' |
|  |  | ), |
|  |  |  |
|  |  | # Allow implicit http if allowed |
|  |  | ( |
|  |  | '<a href="example.com">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="example.com">valid</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="example.com:8000">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="example.com:8000">valid</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="localhost">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="localhost">valid</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="localhost:8000">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="localhost:8000">valid</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="192.168.100.100">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="192.168.100.100">valid</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="192.168.100.100:8000">valid</a>', |
|  |  | {'protocols': ['http']}, |
|  |  | '<a href="192.168.100.100:8000">valid</a>' |
|  |  | ), |
|  |  |  |
|  |  | # Disallow implicit http if disallowed |
|  |  | ( |
|  |  | '<a href="example.com">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="example.com:8000">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="localhost">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="localhost:8000">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="192.168.100.100">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="192.168.100.100:8000">foo</a>', |
|  |  | {'protocols': []}, |
|  |  | '<a>foo</a>' |
|  |  | ), |
|  |  |  |
|  |  | # Disallowed protocols with sneaky character entities |
|  |  | ( |
|  |  | '<a href="javas&#x09;cript:alert(1)">alert</a>', |
|  |  | {}, |
|  |  | '<a>alert</a>' |
|  |  | ), |
|  |  | ( |
|  |  | '<a href="&#14;javascript:alert(1)">alert</a>', |
|  |  | {}, |
|  |  | '<a>alert</a>' |
|  |  | ), |
|  |  |  |
|  |  | # Checking the uri should change it at all |
|  |  | ( |
|  |  | '<a href="http://example.com/?foo&nbsp;bar">foo</a>', |
|  |  | {}, |
|  |  | '<a href="http://example.com/?foo&nbsp;bar">foo</a>' |
|  |  | ), |
|  |  | ]) |
|  |  | def test\_uri\_value\_allowed\_protocols(data, kwargs, expected): |
|  |  | assert clean(data, \*\*kwargs) == expected |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c5df578`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Fcommit%2Fc5df5789ec3471a31311f42c2d19fc2cf21b35ef) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dc66b108_20250125_123905.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Freleases%2Ftag%2Fv2.1.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fbleach%2Freleases%2Ftag%2Fv2.1.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=mozilla%2Fbleach)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mozilla](/mozilla)
/
**[bleach](/mozilla/bleach)**
Public

* [Notifications](/login?return_to=%2Fmozilla%2Fbleach) You must be signed in to change notification settings
* [Fork
  248](/login?return_to=%2Fmozilla%2Fbleach)
* [Star
   2.7k](/login?return_to=%2Fmozilla%2Fbleach)

* [Code](/mozilla/bleach/tree/v2.1.3)
* [Issues
  3](/mozilla/bleach/issues)
* [Pull requests
  1](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

Additional navigation options

* [Code](/mozilla/bleach/tree/v2.1.3)
* [Issues](/mozilla/bleach/issues)
* [Pull requests](/mozilla/bleach/pulls)
* [Discussions](/mozilla/bleach/discussions)
* [Actions](/mozilla/bleach/actions)
* [Security](/mozilla/bleach/security)
* [Insights](/mozilla/bleach/pulse)

[Releases](/mozilla/bleach/releases)
[Tags](/mozilla/bleach/tags)

# v2.1.3

* [v2.1.3](/mozilla/bleach/tree/v2.1.3)
* [`9584f42`](/mozilla/bleach/commit/9584f42051c0039cb0f27a617e8ab3e945018cc6)
* Verified

  # Verified

  This tag was signed with the committer’s **verified signature**.

  [![](https://avatars.githubusercontent.com/u/820826?s=64&v=4)](/willkg)
  [willkg](/willkg)
  Will Kahn-Greene

  GPG key ID: 18BDD1A6F066EC11

  [Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/mozilla/bleach/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.1.3)

   Loading

  [View all tags](/mozilla/bleach/tags)

[v2.1.3: Version 2.1.3 (March 5th, 2018)](/mozilla/bleach/releases/tag/v2.1.3)

* [v2.1.3](/mozilla/bleach/tree/v2.1.3)
* [`9584f42`](/mozilla/bleach/commit/9584f42051c0039cb0f27a617e8ab3e945018cc6)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/mozilla/bleach/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.1.3)

   Loading

  [View all tags](/mozilla/bleach/tags)
* Verified

  # Verified

  This tag was signed with the committer’s **verified signature**.

  [![](https://avatars.githubusercontent.com/u/820826?s=64&v=4)](/willkg)
  [willkg](/willkg)
  Will Kahn-Greene

  GPG key ID: 18BDD1A6F066EC11

  [Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits)

![@willkg](https://avatars.githubusercontent.com/u/820826?s=40&v=4)

```
-------------------------------

**Security fixes**

* Attributes that have URI values weren't properly sanitized if the
  values contained character entities. Using character entities, it
  was possible to construct a URI value with a scheme that was not
  allowed that would slide through unsanitized.

  This security issue was introduced in Bleach 2.1. Anyone using
  Bleach 2.1 is highly encouraged to upgrade.

**Backwards incompatible changes**

None

**Features**

None

**Bug fixes**

* Fixed some other edge cases for attribute URI value sanitizing and
  improved testing of this code.
```

 Assets
2

 Loading

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security-tracker.debian.org_15df3d2e_20250126_083437.html ===

# CVE-2018-7753

| **Name** | CVE-2018-7753 |
| --- | --- |
| **Description** | An issue was discovered in Bleach 2.1.x before 2.1.3. Attributes that have URI values weren't properly sanitized if the values contained character entities. Using character entities, it was possible to construct a URI value with a scheme that was not allowed that would slide through unsanitized. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2018-7753) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-7753); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2018-7753), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2018-7753), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2018-7753), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2018-7753), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-7753), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2018-7753), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2018-7753), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2018-7753)/[CVE](https://www.suse.com/security/cve/CVE-2018-7753/), GitHub [advisories](https://github.com/advisories?query=CVE-2018-7753)/[code](https://github.com/search?type=Code&q=%22CVE-2018-7753%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2018-7753%22), [web search](https://duckduckgo.com/html?q=%22CVE-2018-7753%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [892252](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=892252) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [python-bleach](/tracker/source-package/python-bleach) ([PTS](https://tracker.debian.org/pkg/python-bleach)) | bullseye | 3.2.1-2.1 | fixed |
|  | bookworm | 5.0.1-2 | fixed |
|  | sid, trixie | 6.2.0-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [python-bleach](/tracker/source-package/python-bleach) | source | jessie | (not affected) |  |  |  |
| [python-bleach](/tracker/source-package/python-bleach) | source | stretch | (not affected) |  |  |  |
| [python-bleach](/tracker/source-package/python-bleach) | source | (unstable) | 2.1.3-1 |  |  | [892252](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=892252) |

## Notes

```
[stretch] - python-bleach <not-affected> (Vulnerable code introduced later)
[jessie] - python-bleach <not-affected> (Vulnerable code introduced later)
<https://github.com/mozilla/bleach/pull/356>
<https://github.com/mozilla/bleach/commit/c5df5789ec3471a31311f42c2d19fc2cf21b35ef>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


