=== Content from ics-cert.us-cert.gov_1df2fa0b_20250124_202505.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [ICS Advisory](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95)

Share:

ICS Advisory
# Beckhoff TwinCAT

Last RevisedMarch 22, 2018
Alert CodeICSA-18-081-02

### **CVSS v3 7.8**

**ATTENTION:** Low skill level to exploit.

**Vendor:** Beckhoff

**Equipment:** TwinCAT

**Vulnerability:** Untrusted Pointer Dereference

## AFFECTED PRODUCTS

Beckhoff reports that the vulnerability affects the following TwinCAT PLC products:

* TwinCAT 3.1 Build 4022.4 or prior,
* TwinCAT 2.11 R3 2259 or prior, and
* TwinCAT 3.1 C++ / Matlab (TC1210/TC1220/TC1300/TC1320).

## IMPACT

Successful exploitation of this vulnerability could allow local attackers to escalate privileges.

## MITIGATION

Beckhoff recommends users update to the newest version and recompile Matlab modules after updating.

Please see Beckhoff Security Advisory 2018-001 at the following location for more information:

<https://download.beckhoff.com/download/Document/product-security/Advisories/advisory-2018-001.pdf>

NCCIC recommends users take defensive measures to minimize the risk of exploitation of this vulnerability. Specifically, users should:

* Restrict machine access to only those who need it.
* Don’t share usernames or passwords.
* Monitor and respond to suspicious behavior.

NCCIC reminds organizations to perform proper impact analysis and risk assessment prior to deploying defensive measures.

NCCIC also provides a section for [control systems security recommended practices](/ics/content/recommended-practices) on the ICS-CERT web page. Several recommended practices are available for reading and download, including [Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies.](/sites/default/files/recommended_practices/NCCIC_ICS-CERT_Defense_in_Depth_2016_S508C.pdf)

Additional mitigation guidance and recommended practices are publicly available in the NCCIC Technical Information Paper, [ICS-TIP-12-146-01B--Targeted Cyber Intrusion Detection and Mitigation Strategies](/ics/tips/ICS-TIP-12-146-01B), that is available for download from the [ICS-CERT website](/ics/).

Organizations observing any suspected malicious activity should follow their established internal procedures and report their findings to NCCIC for tracking and correlation against other incidents.

No known public exploits specifically target this vulnerability. This vulnerability is not exploitable remotely.

## VULNERABILITY OVERVIEW

## [UNTRUSTED POINTER DEREFERENCE CWE-822](https://cwe.mitre.org/data/definitions/822.html)

Several kernel drivers lack proper validation of user-supplied pointer values. An attacker who is able to execute code on the target may be able to exploit this vulnerability to obtain SYSTEM privileges.

[CVE-2018-7502](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2018-7502) has been assigned to this vulnerability. A CVSS v3 base score of 7.8 has been calculated; the CVSS vector string is ([AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)).

## RESEARCHER

Steven Seeley of Source Incite reported this vulnerability to NCCIC.

## BACKGROUND

**Critical Infrastructure Sectors:** Critical Manufacturing, Energy, Water and Wastewater Systems

**Countries/Areas Deployed:** Worldwide

**Company Headquarters Location:** Germany

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Vendor

* Beckhoff

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/ics-advisories/icsa-18-081-02); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from srcincite.io_b13cf92d_20250124_202506.html ===

  [![Source Incite](/assets/si.png)](/)    [About](/about/) [Blog](/blog/) [Advisories](/advisories/) [Exploits](/exploits/) [Research](/research/)  [Training](/training/)  [Syllabus](/training/syllabus/) [Prerequisites](/training/prerequisites/) [Challenge](/training/challenge/) [Schedule/Signup](/training/schedule-signup/) [Testimonials](/training/testimonials/) [Faq](/training/faq/)   [Contact](/contact/)

#### **SRC-2018-0007 : Beckoff TwinCAT3 Multiple Kernel Drivers Untrusted Pointer Dereference Privilege Escalation Vulnerabilities**

**CVE ID:**

[CVE-2018-7502](https://nvd.nist.gov/vuln/detail/CVE-2018-7502)

**CVSS Score:**

6.9, [(AV:L/AC:H/Au:N/C:C/I:C/A:C)](https://nvd.nist.gov/cvss/v2-calculator?vector=(AV:L/AC:H/Au:N/C:C/I:C/A:C))

**Affected Vendors:**

Beckoff

**Affected Products:**

TwinCAT3

**Vulnerability Details:**

This vulnerability allows local attackers to execute arbitrary code on vulnerable installations of Beckoff TwinCAT3. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability.

The specific flaw exists when processing the 0x00222206 IOCTL in the following kernel drivers:

1. TcAnalytics.sys
2. TcCnc.sys
3. TcIoBACnetR9.sys
4. TcIoCCat.sys
5. TcIoDrivers.sys
6. TcIoECat.sys
7. TcIoECatSimu.sys
8. TcIoESlv.sys
9. TcIoEth.sys
10. TcIoEthIp.sys
11. TcIoPNet.sys
12. TcIotDrivers.sys
13. TcNcObjects.sys
14. TcPlc30.sys
15. TcRouter.sys
16. TcRtsObjects.sys
17. TcIo.sys
18. TcNc.sys
19. TcRTime.sys

The issue results from the lack of proper validation of a user-supplied value prior to dereferencing it as a pointer. An attacker could leverage this vulnerability to execute arbitrary code in the context of SYSTEM.

**Vendor Response:**

Beckoff has issued an update to correct these vulnerabilities. More details can be found at:

<https://download.beckhoff.com/download/Document/product-security/Advisories/advisory-2018-001.pdf>

**Disclosure Timeline:**

* 2017-09-27 – Verified and sent to Beckoff and ICS-CERT
* 2018-03-13 – Coordinated public release of advisory

**Proof of Concept:**

</pocs/src-2018-0007.py.txt>

**Credit:**

This vulnerability was discovered by Steven Seeley (mr\_me) of Source Incite

* [pgp key](/assets/5B1183EE04FD7FFE68BE48E264AE09A98432FB9B.asc.txt)

* [sourceincite](https://github.com/sourceincite)
* [sourceincite](https://twitter.com/sourceincite)

* [![The Creative Commons License](/assets/Creative-Commons-License.png)](https://creativecommons.org/licenses/by-nc/4.0/)
* copyright © 2014 - 2024 Source Incite

[![W3C Compliant](/assets/images/valid-html40.png)](http://validator.w3.org/check?uri=referer)

The content of this site is licensed under a [Creative Commons Attribution-Non‑Commercial 4.0 International License.](https://creativecommons.org/licenses/by-nc/4.0/)



=== Content from download.beckhoff.com_2f8ac1df_20250124_202503.html ===
Beckhoff Security Advisory

Advisory 2018-001: TwinCAT 2 and 3.1 Kernel Driver Privilege Escalation

Publication Date
Last Update
Current Version
Relevance
CVE

03/13/2018
04/06/2018
1.1
High
CVE-2018-7502

Summary

Several kernel drivers of TwinCAT 2 and 3.1 allow privilege escalation to SYSTEM level if an attacker is able
to execute low-privileged code on the target computer.

An update for TwinCAT 2 and 3.1 is available.

Appearance

  TwinCAT 3.1 Build 4022 <= 4022.4

  TwinCAT 2.11 R3 <= 2259

  TwinCAT 3.1 C++ / Matlab (TC1210/TC1220/TC1300/TC1320)

Description

Several kernel drivers lack proper validation of user-supplied pointer values. An attacker who is able to execute
code on the target can use this vulnerability to obtain SYSTEM privileges.

Solution

  Update TwinCAT 3.1 Build 4022 to version >= 4022.14

  Update TwinCAT 2.11 R3 to version >= 2300

  Recompile TwinCAT 3.1 C++/Matlab modules after update.

Acknowledgement

Beckhoff Automation thanks for his support and efforts:

  Steven Seeley of Source Incite for coordinated disclosure.

Reporting vulnerabilities

Beckhoff Automation welcomes responsibly coordinated reports of vulnerabilities and Beckhoff will collaborate
with reporting parties to fix vulnerabilities or mitigate threats.

Additional Resources

[1] A general guideline for Beckhoff IPC Security:

http://download.beckhoff.com/download/Document/product-security/ipc_security_en.pdf

[2] National Institute of Standards and Technology. CVE-2018-7502 in National Vulnerability Database,

2018. https://nvd.nist.gov/vuln/detail/CVE-2018-7502

History

V 1.0
V 1.1

03/13/2018
04/06/2018

Publication
Added Reference to CVE

Beckhoff Automation GmbH & Co. KG
Hülshorstweg 20, 33415 Verl, Germany
Phone: +49 (0) 52 46/9 63 - 0
E-Mail: product-securityincident@beckhoff.com
www.beckhoff.com

06.04.2018
Page 1 of 1


