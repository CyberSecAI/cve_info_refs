The provided content relates to CVE-2018-7648.

**Root cause of vulnerability:**
The vulnerability is caused by the use of `sprintf` in `opj_mj2_extract.c` to construct output filenames. The `sprintf` function does not perform bounds checking, and if the provided output prefix (`argv[2]`) is too long, it can cause a buffer overflow.

**Weaknesses/vulnerabilities present:**
- Buffer overflow due to the use of `sprintf` without proper length checks.

**Impact of exploitation:**
- The buffer overflow can lead to a crash or potentially arbitrary code execution if exploited.

**Attack vectors:**
- The vulnerability can be triggered by providing a long output prefix as a command-line argument (`argv[2]`) to the `opj_mj2_extract` tool.

**Required attacker capabilities/position:**
- The attacker needs to be able to execute the `opj_mj2_extract` tool with a crafted command-line argument.

**Additional details:**
- The vulnerability is located in `src/bin/mj2/opj_mj2_extract.c` at line 143.
- The fix replaces `sprintf` with `snprintf` which does perform bounds checking. The code also now exits with an error message if the provided output prefix is too long.