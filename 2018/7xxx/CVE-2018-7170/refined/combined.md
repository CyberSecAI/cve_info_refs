=== Content from support.ntp.org_b8d4590a_20250125_012643.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [NTP BUG 3415: Provide a way to prevent authenticated symmetric passive peering](https://www.ntp.org/support/securitynotice/ntpbug3415/)

# NTP BUG 3415: Provide a way to prevent authenticated symmetric passive peering

Last update: April 22, 2024 18:49 UTC ([7e7bd5857](https://git.nwtime.org/websites/ntpwww/commit/7e7bd5857f893277639b3765bf9347c4c6faa447))

---

#### Summary

| **Resolved** | [4.2.8p11](https://www.ntp.org/support/securitynotice/4_2_8p11-release-announcement/) | 27 Feb 2018 |
| --- | --- | --- |
| **References** | [Bug 3415](https://bugs.ntp.org/show_bug.cgi?id=3415) also see: [Bug 3012](https://bugs.ntp.org/show_bug.cgi?id=3012) | [CVE-2018-7170](https://nvd.nist.gov/vuln/detail/CVE-2018-7170) also see: [CVE-2016-1549](https://nvd.nist.gov/vuln/detail/CVE-2016-1549) |
| **Affects** | All ntp-4 releases up to, but not including 4.2.8p7, and 4.3.0 up to, but not including 4.3.92. | Resolved in 4.2.8p11. |
| **CVSS2 Score** | LOW 3.5 | [AV:N/AC:M/Au:S/C:N/I:P/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:N/AC:M/Au:S/C:N/I:P/A:N)) |
| **CVSS3 Score** | LOW 3.1 | [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N/E:F/RL:O/RC:C) |

---

#### Description

`ntpd` can be vulnerable to Sybil attacks. If a system is set up to use a trustedkey and if one is not using the feature introduced in ntp-4.2.8p6 allowing an optional 4th field in the `ntp.keys` file to specify which IPs can serve time, a malicious authenticated peer – i.e. one where the attacker knows the private symmetric key – can create arbitrarily-many ephemeral associations in order to win the clock selection of `ntpd` and modify a victim’s clock. Three additional protections are offered in ntp-4.2.8p11. One is the new `noepeer` directive, which disables symmetric passive ephemeral peering. Another is the new `ippeerlimit` directive, which limits the number of peers that can be created from an IP. The third extends the functionality of the 4th field in the `ntp.keys` file to include specifying a subnet range.

---

#### Mitigation

* Implement [BCP-38](http://www.bcp38.info/index.php/Main_Page).
* Upgrade to [ntp-4.2.8p11 or later](https://downloads.nwtime.org/ntp/4.2.8/).
* Use the `noepeer` directive to prohibit symmetric passive ephemeral associations.
* Use the `ippeerlimit` directive to limit the number of peers that can be created from an IP.
* Use the 4th argument in the `ntp.keys` file to limit the IPs and subnets that can be time servers.
* Have enough sources of time.
* Properly monitor your `ntpd` instances.
* If `ntpd` stops running, auto-restart it without `-g`.

---

#### Credit

This weakness was reported as [Bug 3012](https://bugs.ntp.org/show_bug.cgi?id=3012) by Matthew Van Gundy of Cisco ASIG, and separately by Stefan Moser as [Bug 3415](https://bugs.ntp.org/show_bug.cgi?id=3415).

---

#### Timeline

* 2018 Feb 27: Public release
* 2018 Feb 12: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2018 Jan 23: [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* : Notification from reporter

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from www.synology.com_b9141d1f_20250125_012650.html ===


* [Security Advisory](security/advisory)
# Synology-SA-18:13 NTP

Publish Time: 2018-03-27 15:57:38 UTC+8

Last Updated: 2018-04-10 16:29:05 UTC+8

Severity
Moderate

Status
Resolved

**Abstract**

These vulnerabilities allow remote attackers to conduct association attacks via a susceptible version of Synology DiskStation Manager (DSM), Synology Router Manager (SRM), Virtual DSM, SkyNAS or VS960HD.

**Affected Products**

| Product | Severity | Fixed Release Availability |
| --- | --- | --- |
| DSM 6.1 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 6.0 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 5.2 | Moderate | Upgrade to 6.1.6-15266 or above. |
| SRM 1.1 | Moderate | Upgrade to 1.1.6-6931-3 or above. |
| Virtual DSM | Moderate | Upgrade to 6.1.6-15266 or above. |
| SkyNAS | Moderate | Upgrade to 6.1.5-15254 or above. |
| VS960HD | Moderate | Upgrade to 2.2.3-1505 or above. |

**Mitigation**

None

**Detail**

* CVE-2018-7185

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + The protocol engine in ntp 4.2.6 before 4.2.8p11 allows a remote attackers to cause a denial of service (disruption) by continually sending a packet with a zero-origin timestamp and source IP address of the "other side" of an interleaved association causing the victim ntpd to reset its association.
* CVE-2018-7184

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + ntpd in ntp 4.2.8p4 before 4.2.8p11 drops bad packets before updating the "received" timestamp, which allows remote attackers to cause a denial of service (disruption) by sending a packet with a zero-origin timestamp causing the association to reset and setting the contents of the packet as the most recent timestamp. This issue is a result of an incomplete fix for CVE-2015-7704.
* CVE-2018-7170

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N)
  + ntpd in ntp 4.2.x before 4.2.8p7 and 4.3.x before 4.3.92 allows authenticated users that know the private symmetric key to create arbitrarily-many ephemeral associations in order to win the clock selection of ntpd and modify a victim's clock via a Sybil attack. This issue exists because of an incomplete fix for CVE-2016-1549.
* CVE-2018-7183

  + Severity: Moderate
  + CVSS3 Base Score: 5.0
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L)
  + Buffer overflow in the decodearr function in ntpq in ntp 4.2.8p6 through 4.2.8p10 allows remote attackers to execute arbitrary code by leveraging an ntpq query and sending a response with a crafted array.
* CVE-2018-7182

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
  + The ctl\_getitem method in ntpd in ntp-4.2.8p6 before 4.2.8p11 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted mode 6 packet with a ntpd instance from 4.2.8p6 through 4.2.8p10.
* CVE-2016-1549

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N)
  + A malicious authenticated peer can create arbitrarily-many ephemeral associations in order to win the clock selection algorithm in ntpd in NTP 4.2.8p4 and earlier and NTPsec 3e160db8dc248a0bcb053b56a80167dc742d2b74 and a5fb34b9cc89b92a8fef2f459004865c93bb7f92 and modify a victim's clock.

**Reference**

* [February 2018 ntp-4.2.8p11 NTP Security Vulnerability Announcement](https://support.ntp.org/bin/view/Main/SecurityNotice#February_2018_ntp_4_2_8p11_NTP_S)
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1549>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7170>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7182>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7183>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7184>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7185>

**Revision**

| Revision | Date | Description |
| --- | --- | --- |
| 1 | 2018-03-27 | Initial public release. |
| 2 | 2018-03-29 | Update for SkyNAS is now available in Affected Products. |
| 3 | 2018-04-10 | Update for VS960HD is now available in Affected Products. |

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)
* [ESG](company/esg)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue



=== Content from security.gentoo.org_6ed63b4f_20250125_012645.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NTP: Multiple vulnerabilities — GLSA **201805-12**

Multiple vulnerabilities have been found in NTP, the worst of which
could lead to remote code execution.

### Affected packages

| Package | **net-misc/ntp** on all architectures |
| --- | --- |
| Affected versions | < **4.2.8\_p11** |
| Unaffected versions | >= **4.2.8\_p11** |

### Background

NTP contains software for the Network Time Protocol.

### Description

Multiple vulnerabilities have been discovered in NTP. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly execute arbitrary code or cause a
Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All NTP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/ntp-4.2.8_p11"

```
### References

* [CVE-2018-7170](https://nvd.nist.gov/vuln/detail/CVE-2018-7170)
* [CVE-2018-7182](https://nvd.nist.gov/vuln/detail/CVE-2018-7182)
* [CVE-2018-7183](https://nvd.nist.gov/vuln/detail/CVE-2018-7183)
* [CVE-2018-7184](https://nvd.nist.gov/vuln/detail/CVE-2018-7184)
* [CVE-2018-7185](https://nvd.nist.gov/vuln/detail/CVE-2018-7185)

**Release date**

May 26, 2018

**Latest revision**

May 26, 2018: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [649612](https://bugs.gentoo.org/show_bug.cgi?id=649612)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.redhat.com_6119f144_20250125_012644.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1550214)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1550214)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1550214)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1550214

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1550214**](show_bug.cgi?id=1550214)
(CVE-2018-7170)
- [CVE-2018-7170](https://access.redhat.com/security/cve/CVE-2018-7170) ntp: Ephemeral association time spoofing additional protection

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2018-7170 ntp: Ephemeral association time spoofing additional protection

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-7170 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1550228](show_bug.cgi?id=1550228 "CLOSED ERRATA - CVE-2018-7170 CVE-2018-7182 CVE-2018-7183 CVE-2018-7184 CVE-2018-7185 ntp: various flaws [fedora-all]") [1550229](show_bug.cgi?id=1550229) [1561056](show_bug.cgi?id=1561056) [1582246](show_bug.cgi?id=1582246) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1550226](show_bug.cgi?id=1550226) [1658223](show_bug.cgi?id=1658223) | | TreeView+ | [depends on](buglist.cgi?bug_id=1550214&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1550214&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2018-02-28 19:37 UTC by Pedro Sampaio | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-12-10 15:44 UTC ([History](show_activity.cgi?id=1550214)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  linville mlichvar sardella slawomir yozone | | Fixed In Version: | ntp 4.2.8p11 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in ntpd making it vulnerable to Sybil attacks. An authenticated attacker could target systems configured to use a trusted key in certain configurations and to create an arbitrary number of associations and subsequently modify a victim's clock. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-10-21 19:56:49 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1550214#c0)  Pedro Sampaio    2018-02-28 19:37:48 UTC  ``` ntpd can be vulnerable to Sybil attacks. If a system is set up to use a trustedkey and if one is not using the feature introduced in ntp-4.2.8p6 allowing an optional 4th field in the ntp.keys file to specify which IPs can serve time, a malicious authenticated peer -- i.e. one where the attacker knows the private symmetric key -- can create arbitrarily-many ephemeral associations in order to win the clock selection of ntpd and modify a victim's clock.  Ps.: This is possibly a incomplete fix for [CVE-2016-1549](https://access.redhat.com/security/cve/CVE-2016-1549).  References:  <http://support.ntp.org/bin/view/Main/NtpBug3415>   ```  [Comment 1](show_bug.cgi?id=1550214#c1)  Pedro Sampaio    2018-02-28 19:51:45 UTC  ``` Created ntp tracking bugs for this issue:  Affects: fedora-all [[bug 1550228](show_bug.cgi?id=1550228 "CLOSED ERRATA - CVE-2018-7170 CVE-2018-7182 CVE-2018-7183 CVE-2018-7184 CVE-2018-7185 ntp: various flaws [fedora-all]")]   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1550214&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from security.netapp.com_ab9de0d2_20250125_012646.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2018 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20180626-0001)

## March 2018 Network Time Protocol Daemon (ntpd) Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20180626-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20180626-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20180626-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20180626-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20180626-0001
**Version:**
5.0

**Last updated:**
04/28/2021

**Status:**
Final.

**CVEs:** CVE-2018-7170, CVE-2018-7182, CVE-2018-7183, CVE-2018-7184, CVE-2018-7185

Overview
#### Summary

Multiple NetApp products contain Network Time Protocol Daemon (ntpd). NTP versions 4.2 before 4.2.8p11 and 4.3 before 4.3.92 are susceptible to vulnerabilities which when successfully exploited could lead to addition or modification of data, disclosure of sensitive information or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to addition or modification of data, disclosure of sensitive information or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2018-7170](https://nvd.nist.gov/vuln/detail/CVE-2018-7170) | 6.5 (MEDIUM) | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2018-7182](https://nvd.nist.gov/vuln/detail/CVE-2018-7182) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2018-7183](https://nvd.nist.gov/vuln/detail/CVE-2018-7183) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2018-7184](https://nvd.nist.gov/vuln/detail/CVE-2018-7184) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2018-7185](https://nvd.nist.gov/vuln/detail/CVE-2018-7185) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#Recent_Vulnerabilities>

Affected Products
#### Affected Products

* NetApp SolidFire & HCI Management Node
* NetApp SteelStore Cloud Integrated Storage

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge - 6500N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Brocade Fabric Operating System Firmware
* Cloud Manager
* Clustered Data ONTAP
* Clustered Data ONTAP Antivirus Connector
* Data ONTAP operating in 7-Mode
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Storage Nodes
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp SANtricity Cloud Connector
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 9.6 and above
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Insight
* OnCommand Unified Manager Core Package
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.6 and above
* Storage Replication Adapter for Clustered Data ONTAP for Windows 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 9.6 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/NOW/download/software/sf_elementos/11.0/> |

#### Workarounds

None

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20180626-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20180626 | Initial Public Release |
| 2.0 | 20181105 | NetApp SolidFire Element OS Management Node moved to Affected Products |
| 3.0 | 20190130 | Element Software Management Node added to Software Versions and Fixes |
| 4.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 5.0 | 20210428 | NetApp Cloud Backup (formerly AltaVault) moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from bugs.ntp.org_2b021970_20250126_050240.html ===

[join](https://www.nwtime.org/membership/)

[donate](https://www.nwtime.org/donate/)

Network Time Foundation:
[NTP](https://www.nwtime.org/projects/ntp/ "Network Time Protocol Project")
• [Linux PTP](https://www.nwtime.org/projects/linuxptp/ "Linux Precision Time Protocol Project")
• [RADclock](https://www.nwtime.org/projects/radclock/ "Robust Absolute and Difference Clock Project")
• [GT API](https://www.nwtime.org/projects/timestamp-api/ "General Timestamp API Project")
• [More](http://networktimefoundation.org/projects/ "Other Projects")

---

[Help Us Continue the Legacy of Father Time by Donating to the
Mills-Spring Fund](https://www.nwtime.org/mills-spring/)
![](https://www.nwtime.org/images/support.jpg)

Bugzilla – Bug 3012
Sybil vulnerability: ephemeral association attack
Last modified: 2018-09-10 10:39:13 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3012&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3012&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

NTP users are strongly urged to take immediate action to ensure that their NTP daemons are not susceptible to being used in distributed denial-of-service (DDoS) attacks. Please also take this opportunity to defeat denial-of-service attacks by [implementing Ingress and Egress filtering through BCP38](http://www.bcp38.info/index.php/Main_Page "BCP38 Ingress/Egress filtering").

`ntp-4.2.8p18` was released on 25 May 2024 and addresses 40 bugs and provides 40 improvements.

Please see the [NTP 4.2.8p18 Changelog](https://www.ntp.org/support/securitynotice/4_2_8-series-changelog/#428p18 "4.2.8p18 Changelog") for details.

[**Bug 3012**](show_bug.cgi?id=3012)
- Sybil vulnerability: ephemeral association attack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Sybil vulnerability: ephemeral association attack

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | ntp | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=ntp "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntpd ([show other bugs](buglist.cgi?component=ntpd&product=ntp&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.2.8 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Harlan Stenn | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | Duplicates (1): | [3504](show_bug.cgi?id=3504 "RESOLVED DUPLICATE - \"noepeer\" option doesn't work as expected")  ([view as bug list](buglist.cgi?bug_id=3504)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-02-04 07:56 UTC by Harlan Stenn | | --- | --- | | Modified: | 2018-09-10 10:39 UTC ([History](show_activity.cgi?id=3012)) | | CC List: | 9 users (show)  bugs burnicki contacto matt-ntp mlichvar mnordhoff security shouta.takakura stevos | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | | Flags: | stenn: blocking4.2.8+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=3012&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=3012&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3012#c0)  Harlan Stenn    2016-02-04 07:56:57 UTC   [Comment 1](show_bug.cgi?id=3012#c1)  Harlan Stenn    2016-02-04 08:09:41 UTC  ``` ntpd can be vulnerable to Sybil attacks.  A malicious authenticated peer can create arbitrarily-many ephemeral associations in order to win ntpd's clock selection algorithm and modify a victim's clock.  ntpd has the ability to create ephemeral peer associations on the fly in response to certain kinds of incoming requests.  In most common configurations, if an incoming request will cause a new ephemeral association to be mobilized, ntpd requires the request to be authenticated under a trusted symmetric key.  However, ntpd does not enforce any limit on the number of active ephemeral associations that may be created under a single key making ntpd vulnerable to Sybil attacks.  A malicious authenticated peer can use its knowledge of the trusted key that it shares with a victim ntpd process in order to create multiple ephemeral associations with the victim from different source IP addresses.  Each of these malicious associations can advertise false time to the victim.  If the malicious associations providing consistent false time advertisements outweigh the number of legitimate peer associations, the victim will sync to the time advertised by the attacker. ```  [Comment 2](show_bug.cgi?id=3012#c2)  Martin Burnicki    2016-04-28 15:16:12 UTC  ``` This page <http://support.ntp.org/bin/view/Main/NtpBug3012>  mentions that this bug is fixed in 4.2.8p7, and says:  "Use the 4th argument in the ntp.keys file to limit the IPs that can be time servers."  Where is documented how the 4th parameter is to be used?  BTW, the state of this bug is still "Confirmed", not "Resolved". Which is correct? ```  [Comment 3](show_bug.cgi?id=3012#c3)  Harlan Stenn    2016-04-29 06:36:12 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=3012#c2)) > This page > <http://support.ntp.org/bin/view/Main/NtpBug3012> >  > mentions that this bug is fixed in 4.2.8p7, and says: >  > "Use the 4th argument in the ntp.keys file to limit the IPs that can be time > servers." >  > Where is documented how the 4th parameter is to be used?  We publish a mitigation or work-around, not a fix.  The 4th parameter is documented in the man page for the ntp.keys file.  > BTW, the state of this bug is still "Confirmed", not "Resolved". Which is > correct?  It is Confirmed because we're working on code changes that will provide a way to specifically limit the number of ephemeral associations. ```  [Comment 4](show_bug.cgi?id=3012#c4)  Miroslav Lichvar    2016-05-02 14:50:38 UTC  ``` As a possible fix for configurations that don't need any ephemeral associations, I'd propose to modify the nopeer option to apply to both authenticated and unauthenticated packets. The auth option, which is enabled by default, already requires authenticated packets for mobilizing ephemeral associations, so nopeer would be orthogonal to that and could be used on the "default" restrict line. I think that's what most users expect from ntpd, not accept time from any sources unless they are specified in ntp.conf.  Alternatively, a new restrict option (e.g. noauthpeer) could be added to not allow ephemeral associations mobilized specifically by authenticated packets. If it was used together with the nopeer option, ephemeral associations would be disabled completely and this would be useful for the default restrict line.   I can prepare a patch if there is any interest. ```  [Comment 5](show_bug.cgi?id=3012#c5)  contacto    2018-03-13 22:41:02 UTC  ``` Could you confirm the versions where this has been patched (and the affected versions)?  NVD says "NTP 4.2.8p4 and earlier and NTPsec 3e160db8dc248a0bcb053b56a80167dc742d2b74 and a5fb34b9cc89b92a8fef2f459004865c93bb7f92"  <http://support.ntp.org/bin/view/Main/NtpBug3012> says: Affects: All ntp-4 releases up to, but not including 4.2.8p7, and 4.3.0 up to, but not including 4.3.92  Thanks! ```  [Comment 6](show_bug.cgi?id=3012#c6)  Harlan Stenn    2018-07-20 10:07:02 UTC  ``` *** [Bug 3504](show_bug.cgi?id=3504 "RESOLVED DUPLICATE - \"noepeer\" option doesn't work as expected") has been marked as a duplicate of this bug. *** ```  [Comment 7](show_bug.cgi?id=3012#c7)  Steve    2018-08-31 21:02:31 UTC  ``` New CVE issued for this p12 instance. See <https://nvd.nist.gov/vuln/detail/CVE-2018-7170> for more detail. VU#961909 was not published by cert. ```  [Comment 8](show_bug.cgi?id=3012#c8)  Harlan Stenn    2018-09-10 10:39:13 UTC  ``` Fixed in ntp-4.2.8p12. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3012)
* - [XML](show_bug.cgi?ctype=xml&id=3012)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3012)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3012&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3012&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[© 2025 Network Time Foundation](https://www.nwtime.org/)



=== Content from access.redhat.com_19f205a1_20250126_050240.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from packetstormsecurity.com_3bf457e9_20250125_012641.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from support.hpe.com_589ab356_20250125_012647.html ===


[**Support Center**](/connect/s/)



=== Content from security.FreeBSD.org_b0c17d21_20250125_012645.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-18:02.ntp Security Advisory
The FreeBSD Project
Topic: Multiple vulnerabilities of ntp
Category: contrib
Module: ntp
Announced: 2018-03-07
Credits: Network Time Foundation
Affects: All supported versions of FreeBSD.
Corrected: 2018-02-28 09:01:03 UTC (stable/11, 11.1-STABLE)
2018-03-07 05:58:24 UTC (releng/11.1, 11.1-RELEASE-p7)
2018-03-01 04:06:49 UTC (stable/10, 10.4-STABLE)
2018-03-07 05:58:24 UTC (releng/10.4, 10.4-RELEASE-p6)
2018-03-07 05:58:24 UTC (releng/10.3, 10.3-RELEASE-p27)
CVE Name: CVE-2018-7182, CVE-2018-7170, CVE-2018-7184, CVE-2018-7185,
CVE-2018-7183
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The ntpd(8) daemon is an implementation of the Network Time Protocol (NTP)
used to synchronize the time of a computer system to a reference time
source.
II. Problem Description
The ctl\_getitem() function is used by ntpd(8) to process incoming "mode 6"
packets. A malicious "mode 6" packet can be sent to an ntpd instance, and
if the ntpd instance is from 4.2.8p6 through 4.2.8p10, ctl\_getitem() will
read past the end of its buffer. [CVE-2018-7182]
The ntpd(8) service can be vulnerable to Sybil attacks. If a system is
configured to use a trustedkey and if one is not using the feature introduced
in ntp-4.2.8p6 allowing an optional 4th field in the ntp.keys file to specify
which IPs can serve time, a malicious authenticated peer, i.e., one where the
attacker knows the private symmetric key, can create arbitrarily-many
ephemeral associations in order to win the clock selection of ntpd and modify
a victim's clock. [CVE-2018-7170]
The fix for NtpBug2952 was incomplete, and while it fixed one problem it
created another. Specifically, it drops bad packets before updating the
"received" timestamp. This means a third-party can inject a packet with
a zero-origin timestamp, meaning the sender wants to reset the association,
and the transmit timestamp in this bogus packet will be saved as the most
recent "received" timestamp. The real remote peer does not know this
value and this will disrupt the association until the association resets.
[CVE-2018-7184]
The NTP Protocol allows for both non-authenticated and authenticated
associations, in client/server, symmetric (peer), and several broadcast
modes. In addition to the basic NTP operational modes, symmetric mode and
broadcast servers can support an interleaved mode of operation. In
ntp-4.2.8p4, a bug was inadvertently introduced into the protocol engine that
allows a non-authenticated zero-origin (reset) packet to reset an
authenticated interleaved peer association. If an attacker can send a packet
with a zero-origin timestamp and the source IP address of the "other side" of
an interleaved association, the 'victim' ntpd will reset its association.
The attacker must continue sending these packets in order to maintain the
disruption of the association. [CVE-2018-7185]
The ntpq(8) utility is a monitoring and control program for ntpd. The
internal decodearr() function of ntpq(8) that is used to decode an array in
a response string when formatted data is being displayed. This is a problem
in affected versions of ntpq if a maliciously-altered ntpd returns an array
result that will trip this bug, or if a bad actor is able to read an ntpq(8)
request on its way to a remote ntpd server and forge and send a response
before the remote ntpd sends its response. It is potentially possible that
the malicious data could become injectable/executable code. [CVE-2017-7183]
III. Impact
Malicious remote attackers may be able to break time synchornization,
or cause the ntpq(8) utility to crash.
IV. Workaround
No workaround is available, but systems not running ntpd(8) or ntpq(8) are
not affected. Network administrators are advised to implement BCP-38 which
helps to reduce risk associated with the attacks.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
[FreeBSD 11.1]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-11.1.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-11.1.patch.asc
# gpg --verify ntp-11.1.patch.asc
[FreeBSD 10.4]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.4.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.4.patch.asc
# gpg --verify ntp-10.4.patch.asc
[FreeBSD 10.3]
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.3.patch
# fetch https://security.FreeBSD.org/patches/SA-18:02/ntp-10.3.patch.asc
# gpg --verify ntp-10.3.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart the applicable daemons, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/10/ r330141
releng/10.3/ r330567
releng/10.4/ r330567
stable/11/ r330106
releng/11.1/ r330567
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQKTBAEBCgB9FiEE/A6HiuWv54gCjWNV05eS9J6n5cIFAlqfhYNfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEZD
MEU4NzhBRTVBRkU3ODgwMjhENjM1NUQzOTc5MkY0OUVBN0U1QzIACgkQ05eS9J6n
5cL9GQ/+PLffyegsvxKngL83XWG9UuHbcGG5aWbNwCecTEzNoCI72TI03aga0ge5
iLz5kW3SQvl8tsq778U4YbfFcCw6ifq2ws8asqNviv+u4AcJh7oD8CS3/kFuA9xM
zjAIrScdNR2taBJhBW3nwlb7RmDeKqydQ3OIxHVvs9Fj5Alc5ZEGezUjC2dueB+M
UdORg6GvHGMYQ+4AtBFRgZHAU3BFkwmgqsIICywYnUVH+AxKj34shs/pMMeJd/d9
a+BIu/tUjAIlQp23VunNAfq7r2eZik9LOV8Y5l1Ww7+K1IwlwezxI+Iw18BMFEVn
L9baBY9RFh8v/yrZCBqUc7Prhs3ExU/lnAb05Va7TYeD4RXVmSU0jNXi/przN3y2
PR7Z3JCm60mFKyp0/Hz2MmS1XPBVBrW4P6g9hH8TZmOHb2mZlK3zDXmil7HKp5DK
UhtMJpPEWV9k5rfP8iijHJnwkPr0ALntMUAAKUyw/6isVtHT6BZLaYsZvRYIm8YY
Mn2RUl74m+XoIhQ8R4mxRcaAHwKKXyeyP5nlAs6TQVb9QJukoRiNDr3g8TwbtT54
iTswVu+z/a89/YIwJoc6Ud7eCZSDYe6qfuC19TVuledayjjy/ZPMH0ZkNWFWJ3AE
VAvdyvoUuNbmsv42o4AUtpE/1CmDqOjwBRZZbtV4CONCDFpk26o=
=D2ov
-----END PGP SIGNATURE-----


=== Content from bugs.ntp.org_98c4662f_20250126_050237.html ===

[join](https://www.nwtime.org/membership/)

[donate](https://www.nwtime.org/donate/)

Network Time Foundation:
[NTP](https://www.nwtime.org/projects/ntp/ "Network Time Protocol Project")
• [Linux PTP](https://www.nwtime.org/projects/linuxptp/ "Linux Precision Time Protocol Project")
• [RADclock](https://www.nwtime.org/projects/radclock/ "Robust Absolute and Difference Clock Project")
• [GT API](https://www.nwtime.org/projects/timestamp-api/ "General Timestamp API Project")
• [More](http://networktimefoundation.org/projects/ "Other Projects")

---

[Help Us Continue the Legacy of Father Time by Donating to the
Mills-Spring Fund](https://www.nwtime.org/mills-spring/)
![](https://www.nwtime.org/images/support.jpg)

Bugzilla – Bug 3415
Provide a way to prevent authenticated symmetric passive peering
Last modified: 2018-08-15 08:06:27 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3415&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3415&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

NTP users are strongly urged to take immediate action to ensure that their NTP daemons are not susceptible to being used in distributed denial-of-service (DDoS) attacks. Please also take this opportunity to defeat denial-of-service attacks by [implementing Ingress and Egress filtering through BCP38](http://www.bcp38.info/index.php/Main_Page "BCP38 Ingress/Egress filtering").

`ntp-4.2.8p18` was released on 25 May 2024 and addresses 40 bugs and provides 40 improvements.

Please see the [NTP 4.2.8p18 Changelog](https://www.ntp.org/support/securitynotice/4_2_8-series-changelog/#428p18 "4.2.8p18 Changelog") for details.

[**Bug 3415**](show_bug.cgi?id=3415)
- Provide a way to prevent authenticated symmetric passive peering

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Provide a way to prevent authenticated symmetric passive peering

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | ntp | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=ntp "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntpd ([show other bugs](buglist.cgi?component=ntpd&product=ntp&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.2.8 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Harlan Stenn | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2017-07-06 10:37 UTC by Harlan Stenn | | --- | --- | | Modified: | 2018-08-15 08:06 UTC ([History](show_activity.cgi?id=3415)) | | CC List: | 5 users (show)  bugs contacto mlichvar perlinger security | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | | Flags: | stenn: blocking4.2.8+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=3415&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=3415&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3415#c0)  Harlan Stenn    2017-07-06 10:37:42 UTC   [Comment 1](show_bug.cgi?id=3415#c1)  Harlan Stenn    2017-07-06 10:44:26 UTC  ``` on 13 Mar 2017 Miroslav emailed us, writing:  there was a security issue reported on the ntp questions list recently. It allows clients that have a key to create symmetric associations with the server. The problem is that the nopeer restriction applies only to unauthenticated packets, i.e. it's effective only when authentication is disabled with "disable auth". This works as documented, but it is a major problem for services that give keys to untrusted clients, like NIST does for instance.  <http://lists.ntp.org/pipermail/questions/2017-March/041002.html>  I replied, asking:  > Is this issue solved by using the optional IP list in the ntp.keys file?  No, not really. Even if the server restricted each key to one IP address, the attacker could ask for multiple keys and still create multiple symmetric associations, which would outvote the good time sources.  > Or was that something else?  I think that was a different issue, where an attacker could create spoofed responses using a different key than the peer/client was expecting.  In this case it's about preventing clients from creating a symmetric association with the key they got. I think the best fix would be to change the nopeer option to apply to all packets. I think that's what most people expect it to be doing. Would you agree?  H: I'll talk with Dave Mills about this.  While I agree with you, Dave expressly implemented and documented this behavior and I'd like to understand why, with costs/benefits.  M: Thanks, Harlan. The other possibilities include a new restrict option, allowing clients (and only clients) to use keys that are not marked as trusted, or a global flag that would disable all ephemeral associations.  and then:  On Tue, Jun 06, 2017 at 02:44:19AM -0700, Harlan Stenn wrote: > On 6/6/17 1:21 AM, Miroslav Lichvar wrote: >> I think it's a serious security issue, which is already public. It >> seems not even the extended key file format, allowing only one IP >> address per key, can prevent the attack. With one IP address it's >> still possible to create a large number of passive associations with >> the server and take control of its clock. >> >> Should we assign a CVE? > > Maybe.  But before we do this: > > - Do you have suggestions on how to fix this?  I think there are two separate issues.  One is that there is no way for an admin of an NTP server to give someone a key for authenticating server responses and at the same time not allow peering with that server. One possible fix is to change the the nopeer restrict option to apply to all packets, not just unauthenticated. Another fix would be to allow marking keys in the key file as "client only". Such keys could be used for authentication, but they couldn't create a new associations.  The other issue is that when someone has a key and is allowed to make a symmetric association, they can create multiple associations (even from a single IP address) in order to outvote other time sources and effectively take control of the server's clock. This could be fixed with a new option that would limit the number of associations per key. If set to one association per key, a single key can create only one association, which is not enough to outvote other sources. ```  [Comment 2](show_bug.cgi?id=3415#c2)  Harlan Stenn    2018-01-12 06:01:26 UTC  ``` The new 'noepeer' directive for the 'restrict'  directive will prevent all symmetric passive ephemeral peering.  STAGED for ntp-4.2.8p11. ```  [Comment 3](show_bug.cgi?id=3415#c3)  Harlan Stenn    2018-01-12 11:24:33 UTC  ``` This bug report seems to be a duplicate of [Bug 3012](show_bug.cgi?id=3012 "RESOLVED FIXED - Sybil vulnerability: ephemeral association attack"). ```  [Comment 4](show_bug.cgi?id=3415#c4)  Miroslav Lichvar    2018-01-12 11:47:34 UTC  ``` The [bug #3012](show_bug.cgi?id=3012 "RESOLVED FIXED - Sybil vulnerability: ephemeral association attack") is different. It's the second issue described in the [comment #1](show_bug.cgi?id=3415#c1). If I understand it correctly, the noepeer restriction will allow us to block all ephemeral associations from a given IP address/network, but not limit the number of associations per key. ```  [Comment 5](show_bug.cgi?id=3415#c5)  contacto    2018-03-13 23:24:10 UTC  ``` If I understand correctly, this is fixed in ntp-4.2.8p11, anyhow <http://support.ntp.org/bin/view/Main/NtpBug3415> is not very clear: "Affects: All ntp-4 releases up to, but not including 4.2.8p7, and 4.3.0 up to, but not including 4.3.92. Resolved in 4.2.8p11."  Does that means that 4.2.8p7-4.2.8p10 are not affected? And the patch was released in version 4.2.8p11? How so? It's confusing for me.  Thanks! ```  [Comment 6](show_bug.cgi?id=3415#c6)  Miroslav Lichvar    2018-08-15 08:06:27 UTC  ``` It seems there was a bug in the implementation of the noepeer option, which was fixed in ntp-4.2.8p12. The release notes refer to the [bug #3012](show_bug.cgi?id=3012 "RESOLVED FIXED - Sybil vulnerability: ephemeral association attack") (CVE-2016-1549), although it might be this [bug #3415](show_bug.cgi?id=3415 "RESOLVED FIXED - Provide a way to prevent authenticated symmetric passive peering") (CVE-2018-7182). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3415)
* - [XML](show_bug.cgi?ctype=xml&id=3415)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3415)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3415&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3415&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[© 2025 Network Time Foundation](https://www.nwtime.org/)


