=== Content from launchpad.net_2bf755ab_20250126_082005.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/cimg/1.7.9%2Bdfsg-2ubuntu0.18.04.1/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[cimg package](https://launchpad.net/ubuntu/%2Bsource/cimg)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/cimg)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/cimg)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/cimg)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/cimg)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/cimg)

# cimg 1.7.9+dfsg-2ubuntu0.18.04.1 source package in Ubuntu

## Changelog

```
cimg (1.7.9+dfsg-2ubuntu0.18.04.1) bionic-security; urgency=medium

  * SECURITY UPDATE: a double free in load_bmp in CImg.h can occur when
    loading a crafted bmp image
    - debian/patches/CVE-2018-7589_7588_7587.patch: add additional checks
      for malformed input in load_bmp()
    - CVE-2018-7589
    - CVE-2018-7588
    - CVE-2018-7587

 -- Daniel Wang <email address hidden>  Tue, 18 Jun 2019 12:21:31 -0700
```

## Upload details

Uploaded by:
[Daniel Wang](/~danielwang88)
on 2019-06-18

Uploaded to:
[Bionic](/ubuntu/bionic)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
all

Section:
math

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Bionic](/ubuntu/bionic):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/17168078)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [cimg\_1.7.9+dfsg.orig.tar.xz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cimg/1.7.9%2Bdfsg-2ubuntu0.18.04.1/cimg_1.7.9%2Bdfsg.orig.tar.xz) | 8.5 MiB | e8f49f4c30a9bc6fb21c9c06b2f8fc403b71098df7add29f1a6fa34b423fe8ff |
| [cimg\_1.7.9+dfsg-2ubuntu0.18.04.1.debian.tar.xz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cimg/1.7.9%2Bdfsg-2ubuntu0.18.04.1/cimg_1.7.9%2Bdfsg-2ubuntu0.18.04.1.debian.tar.xz) | 17.7 KiB | b2d13b77f6332a3c9609882063a242e1ba4def396038334541346119ba234de1 |
| [cimg\_1.7.9+dfsg-2ubuntu0.18.04.1.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/cimg/1.7.9%2Bdfsg-2ubuntu0.18.04.1/cimg_1.7.9%2Bdfsg-2ubuntu0.18.04.1.dsc) | 2.5 KiB | 9ec12b719541c2e754d3d19dc5e93f6f9a02c6627e05a90188d6b68f31cab100 |

### Available diffs

* [diff from 1.7.9+dfsg-2ubuntu0.1 to 1.7.9+dfsg-2ubuntu0.18.04.1](http://launchpadlibrarian.net/429279273/cimg_1.7.9%2Bdfsg-2ubuntu0.1_1.7.9%2Bdfsg-2ubuntu0.18.04.1.diff.gz) (1.8 KiB)

[View changes file](http://launchpadlibrarian.net/429279060/cimg_1.7.9%2Bdfsg-2ubuntu0.18.04.1_source.changes)

## Binary packages built by this source

[cimg-dev](/ubuntu/bionic/%2Bpackage/cimg-dev):
powerful image processing library

The CImg Library is a C++ toolkit providing simple classes and functions

 to load, save, process and display images in your own C++ code. It consists

 only of a single header file CImg.h that must be included in your program

 source. It contains useful image processing algorithms for loading/saving,

 resizing/rotating, filtering, object drawing (text, lines, faces,

 ellipses, ...), etc.

 .

 Images are instantiated by a class able to represent images up to 4-dimension

 wide (from 1-D scalar signals to 3-D volumes of vector-valued pixels), with

 template pixel types. It depends on a minimal number of libraries : you can

 compile it with only standard C libraries. No need for exotic libraries and

 complex dependencies.

[cimg-doc](/ubuntu/bionic/%2Bpackage/cimg-doc):
documentation of cimg-dev imaging library

The CImg Library is a C++ toolkit providing simple classes and functions

 to load, save, process and display images in your own C++ code. It consists

 only of a single header file CImg.h that must be included in your program

 source. It contains useful image processing algorithms for loading/saving,

 resizing/rotating, filtering, object drawing (text, lines, faces,

 ellipses, ...), etc.

 .

 Images are instantiated by a class able to represent images up to 4-dimension

 wide (from 1-D scalar signals to 3-D volumes of vector-valued pixels), with

 template pixel types. It depends on a minimal number of libraries : you can

 compile it with only standard C libraries. No need for exotic libraries and

 complex dependencies.

 .

 This package contains the documentation.

[cimg-examples](/ubuntu/bionic/%2Bpackage/cimg-examples):
examples for cimg-dev imaging library

The CImg Library is a C++ toolkit providing simple classes and functions

 to load, save, process and display images in your own C++ code. It consists

 only of a single header file CImg.h that must be included in your program

 source. It contains useful image processing algorithms for loading/saving,

 resizing/rotating, filtering, object drawing (text, lines, faces,

 ellipses, ...), etc.

 .

 Images are instantiated by a class able to represent images up to 4-dimension

 wide (from 1-D scalar signals to 3-D volumes of vector-valued pixels), with

 template pixel types. It depends on a minimal number of libraries : you can

 compile it with only standard C libraries. No need for exotic libraries and

 complex dependencies.

 .

 This package contains examples for the usage of the library.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from usn.ubuntu.com_74851938_20250125_115541.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4039-1: CImg vulnerabilities

26 June 2019

Several security issues were fixed in CImg.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.10](/security/notices?release=cosmic)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [cimg](/security/cves?package=cimg) - C++ template image processing toolkit

## Details

It was discovered that allocation failures could occur in CImg when loading

crafted bmp images. An attacker could possibly use this issue to cause a

denial of service. ([CVE-2018-7587](/security/CVE-2018-7587))

It was discovered that a heap-based buffer over-read existed in CImg when

loading crafted bmp images. An attacker could possibly use this issue to

execute arbitrary code. ([CVE-2018-7588](/security/CVE-2018-7588))

It was discovered that a double free existed in CImg when loading crafted

bmp images. An attacker could possibly use this issue to execute arbitrary

code. ([CVE-2018-7589](/security/CVE-2018-7589))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.10

* [cimg-dev](https://launchpad.net/ubuntu/%2Bsource/cimg)
  -
  [1.7.9+dfsg-2ubuntu0.18.10.1](https://launchpad.net/ubuntu/%2Bsource/cimg/1.7.9%2Bdfsg-2ubuntu0.18.10.1)

##### Ubuntu 18.04

* [cimg-dev](https://launchpad.net/ubuntu/%2Bsource/cimg)
  -
  [1.7.9+dfsg-2ubuntu0.18.04.1](https://launchpad.net/ubuntu/%2Bsource/cimg/1.7.9%2Bdfsg-2ubuntu0.18.04.1)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2018-7587](/security/CVE-2018-7587)
* [CVE-2018-7588](/security/CVE-2018-7588)
* [CVE-2018-7589](/security/CVE-2018-7589)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_1e979fce_20250125_115540.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxiaoqx%2Fpocs%2Ftree%2Fmaster%2Fcimg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxiaoqx%2Fpocs%2Ftree%2Fmaster%2Fcimg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=xiaoqx%2Fpocs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xiaoqx](/xiaoqx)
/
**[pocs](/xiaoqx/pocs)**
Public

* [Notifications](/login?return_to=%2Fxiaoqx%2Fpocs) You must be signed in to change notification settings
* [Fork
  8](/login?return_to=%2Fxiaoqx%2Fpocs)
* [Star
   20](/login?return_to=%2Fxiaoqx%2Fpocs)

* [Code](/xiaoqx/pocs)
* [Issues
  3](/xiaoqx/pocs/issues)
* [Pull requests
  0](/xiaoqx/pocs/pulls)
* [Actions](/xiaoqx/pocs/actions)
* [Projects
  0](/xiaoqx/pocs/projects)
* [Security](/xiaoqx/pocs/security)
* [Insights](/xiaoqx/pocs/pulse)

Additional navigation options

* [Code](/xiaoqx/pocs)
* [Issues](/xiaoqx/pocs/issues)
* [Pull requests](/xiaoqx/pocs/pulls)
* [Actions](/xiaoqx/pocs/actions)
* [Projects](/xiaoqx/pocs/projects)
* [Security](/xiaoqx/pocs/security)
* [Insights](/xiaoqx/pocs/pulse)

## Files

 master
## Breadcrumbs

1. [pocs](/xiaoqx/pocs/tree/master)
/
# cimg

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/xiaoqx/pocs/commits/master/cimg) master
## Breadcrumbs

1. [pocs](/xiaoqx/pocs/tree/master)
/
# cimg

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/xiaoqx/pocs/tree/master) | | |
| [cimg-crash-1](/xiaoqx/pocs/blob/master/cimg/cimg-crash-1 "cimg-crash-1") | | [cimg-crash-1](/xiaoqx/pocs/blob/master/cimg/cimg-crash-1 "cimg-crash-1") |  |  |
| [cimg-dos-load\_bmp-1](/xiaoqx/pocs/blob/master/cimg/cimg-dos-load_bmp-1 "cimg-dos-load_bmp-1") | | [cimg-dos-load\_bmp-1](/xiaoqx/pocs/blob/master/cimg/cimg-dos-load_bmp-1 "cimg-dos-load_bmp-1") |  |  |
| [cimg-double-free-1](/xiaoqx/pocs/blob/master/cimg/cimg-double-free-1 "cimg-double-free-1") | | [cimg-double-free-1](/xiaoqx/pocs/blob/master/cimg/cimg-double-free-1 "cimg-double-free-1") |  |  |
| [cimg-heap-overflow-1](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-1 "cimg-heap-overflow-1") | | [cimg-heap-overflow-1](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-1 "cimg-heap-overflow-1") |  |  |
| [cimg-heap-overflow-load\_bmp-48378](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48378 "cimg-heap-overflow-load_bmp-48378") | | [cimg-heap-overflow-load\_bmp-48378](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48378 "cimg-heap-overflow-load_bmp-48378") |  |  |
| [cimg-heap-overflow-load\_bmp-48397](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48397 "cimg-heap-overflow-load_bmp-48397") | | [cimg-heap-overflow-load\_bmp-48397](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48397 "cimg-heap-overflow-load_bmp-48397") |  |  |
| [cimg-heap-overflow-load\_bmp-48413](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48413 "cimg-heap-overflow-load_bmp-48413") | | [cimg-heap-overflow-load\_bmp-48413](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48413 "cimg-heap-overflow-load_bmp-48413") |  |  |
| [cimg-heap-overflow-load\_bmp-48427](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48427 "cimg-heap-overflow-load_bmp-48427") | | [cimg-heap-overflow-load\_bmp-48427](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48427 "cimg-heap-overflow-load_bmp-48427") |  |  |
| [cimg-heap-overflow-load\_bmp-48457](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48457 "cimg-heap-overflow-load_bmp-48457") | | [cimg-heap-overflow-load\_bmp-48457](/xiaoqx/pocs/blob/master/cimg/cimg-heap-overflow-load_bmp-48457 "cimg-heap-overflow-load_bmp-48457") |  |  |
| [readme.md](/xiaoqx/pocs/blob/master/cimg/readme.md "readme.md") | | [readme.md](/xiaoqx/pocs/blob/master/cimg/readme.md "readme.md") |  |  |
| View all files | | |

## [readme.md](#readme)

# cimg crashes

code:
<http://cimg.eu/>
<https://github.com/dtschump/CImg>

## 1. cimg-heap-overflow-1

$cimgload cimg-heap-overflow-1

```
=================================================================
==6193==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f91792ff800 at pc 0x00000049dd13 bp 0x7ffee7a8e890 sp 0x7ffee7a8e880
READ of size 1 at 0x7f91792ff800 thread T0
    #0 0x49dd12 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48457
    #1 0x4b84a4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4b84a4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x4022fa in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x4022fa in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x4022fa in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7f917bb8f82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)

0x7f91792ff800 is located 0 bytes to the right of 6287360-byte region [0x7f9178d00800,0x7f91792ff800)
allocated by thread T0 here:
    #0 0x7f917ca906b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x433fb6 in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #2 0x49a75d in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int, unsigned char const&) ../CImg.h:11399
    #3 0x49a75d in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48348
    #4 0x4b84a4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #5 0x4b84a4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #6 0x4022fa in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #7 0x4022fa in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #8 0x4022fa in main /src/CImg/fuzz-test/bmp-test.cpp:25

SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48457 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0ff2af257eb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff2af257ec0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff2af257ed0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff2af257ee0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff2af257ef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0ff2af257f00:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff2af257f10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff2af257f20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff2af257f30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff2af257f40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff2af257f50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==6193==ABORTING

```

## 2. cimg-double-free-1

```
=================================================================
==6191==ERROR: AddressSanitizer: attempting double-free on 0x62100001a500 in thread T0:
    #0 0x7f1be4f702ca in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x982ca)
    #1 0x7f1be40cbc55 in _IO_default_finish (/lib/x86_64-linux-gnu/libc.so.6+0x7bc55)
    #2 0x7f1be40bd29e in fclose (/lib/x86_64-linux-gnu/libc.so.6+0x6d29e)
    #3 0x7f1be4f6f7cd in fclose (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x977cd)
    #4 0x40a518 in cimg_library::cimg::fclose(_IO_FILE*) ../CImg.h:6187
    #5 0x49b051 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48467
    #6 0x4b84a4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #7 0x4b84a4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #8 0x4022fa in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #9 0x4022fa in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #10 0x4022fa in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #11 0x7f1be407082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)

0x62100001a500 is located 0 bytes inside of 4096-byte region [0x62100001a500,0x62100001b500)
freed by thread T0 here:
    #0 0x7f1be4f702ca in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x982ca)
    #1 0x7f1be40cbe3c in _IO_default_finish (/lib/x86_64-linux-gnu/libc.so.6+0x7be3c)

previously allocated by thread T0 here:
    #0 0x7f1be4f70602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)
    #1 0x7f1be40bd1d4 in _IO_file_doallocate (/lib/x86_64-linux-gnu/libc.so.6+0x6d1d4)

SUMMARY: AddressSanitizer: double-free ??:0 __interceptor_free
==6191==ABORTING

```

## 3. cimg-crash-1

segmentfault for allocate failed.

```
==6194==WARNING: AddressSanitizer failed to allocate 0x001800000c00 bytes
==6194==AddressSanitizer's allocator is terminating the process instead of returning 0
==6194==If you don't like this behavior set allocator_may_return_null=1
==6194==AddressSanitizer CHECK failed: ../../../../src/libsanitizer/sanitizer_common/sanitizer_allocator.cc:147 "((0)) != (0)" (0x0, 0x0)
    #0 0x7f88deb49631  (/usr/lib/x86_64-linux-gnu/libasan.so.2+0xa0631)
    #1 0x7f88deb4e5e3 in __sanitizer::CheckFailed(char const*, int, char const*, unsigned long long, unsigned long long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0xa55e3)
    #2 0x7f88deac6425  (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x1d425)
    #3 0x7f88deb4c865  (/usr/lib/x86_64-linux-gnu/libasan.so.2+0xa3865)
    #4 0x7f88deacbb4d  (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x22b4d)
    #5 0x7f88deb4267e in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x9967e)
    #6 0x433fb6 in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #7 0x49a9d5 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48366
    #8 0x4b84a4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #9 0x4b84a4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #10 0x4022fa in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #11 0x4022fa in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #12 0x4022fa in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #13 0x7f88ddc4182f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)

```

## 4. cimg-load\_bmp-dos-1

Loading the crafted bmp file by cimg.h will lead to cpu exhaust.

## 5. cimg-heap-overflow-load\_bmp-48397

A heap overflow occurs in line 48397 in CImg.h when loading the crafted bmp file .
the tested code commit is 8447076ef22322a14a0ce130837e44c5ba8095f4.

```
=================================================================
==4030==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000ef9c at pc 0x000000494724 bp 0x7ffc58d04270 sp 0x7ffc58d04260
READ of size 1 at 0x60600000ef9c thread T0
    #0 0x494723 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48397
    #1 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x40215f injjj main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7ff32e56282f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x4022f8 in _start (/src/CImg/fuzz-test/bmp-test+0x4022f8)

0x60600000ef9c is located 0 bytes to the right of 60-byte region [0x60600000ef60,0x60600000ef9c)
allocated by thread T0 here:
    #0 0x7ff32f15a6b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x40562f in cimg_library::CImg<int>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #2 0x4907f4 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48342
    #3 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #4 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #5 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #6 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #7 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25

SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48397 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0c0c7fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa 00 00 00 00
=>0x0c0c7fff9df0: 00 00 00[04]fa fa fa fa 00 00 00 00 00 00 06 fa
  0x0c0c7fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==4030==ABORTING

```

## 6. cimg-heap-overflow-load\_bmp-48413

A heap overflow occurs in line 48413 in CImg.h when loading the crafted bmp file .
the tested code commit is 8447076ef22322a14a0ce130837e44c5ba8095f4.

```
=================================================================
==4037==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000f034 at pc 0x000000493848 bp 0x7ffd46b9bc90 sp 0x7ffd46b9bc80
READ of size 1 at 0x60200000f034 thread T0
    #0 0x493847 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48413
    #1 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7f0ca927b82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x4022f8 in _start (/src/CImg/fuzz-test/bmp-test+0x4022f8)

AddressSanitizer can not describe address in more detail (wild memory access suspected).
SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48413 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9df0: fa fa fa fa fa fa fa fa fa fa 00 fa fa fa 00 00
=>0x0c047fff9e00: fa fa fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa
  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==4037==ABORTING

```

## 6. cimg-heap-overflow-load\_bmp-48457

A heap overflow occurs in line 48457 in CImg.h when loading the crafted bmp file .
the tested code commit is 8447076ef22322a14a0ce130837e44c5ba8095f4.

```
=================================================================
==4040==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62600000ed3c at pc 0x0000004941b2 bp 0x7ffe59105df0 sp 0x7ffe59105de0
READ of size 1 at 0x62600000ed3c thread T0
    #0 0x4941b1 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48457
    #1 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7f3fdcc1982f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x4022f8 in _start (/src/CImg/fuzz-test/bmp-test+0x4022f8)

0x62600000ed3c is located 0 bytes to the right of 11324-byte region [0x62600000c100,0x62600000ed3c)
allocated by thread T0 here:
    #0 0x7f3fdd8116b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x4074fe in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #2 0x49090a in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int, unsigned char const&) ../CImg.h:11399
    #3 0x49090a in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48348
    #4 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #5 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #6 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #7 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #8 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25

SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48457 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0c4c7fff9d50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4c7fff9d60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4c7fff9d70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4c7fff9d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c4c7fff9d90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c4c7fff9da0: 00 00 00 00 00 00 00[04]fa fa fa fa fa fa fa fa
  0x0c4c7fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c7fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c7fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c7fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c7fff9df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==4040==ABORTING

```

## 7. cimg-heap-overflow-load\_bmp-48427

A heap overflow occurs in line 48427 in CImg.h when loading the crafted bmp file .
the tested code commit is 8447076ef22322a14a0ce130837e44c5ba8095f4.

```
=================================================================
==4043==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000eff8 at pc 0x00000049418f bp 0x7ffeb2a68590 sp 0x7ffeb2a68580
READ of size 1 at 0x60200000eff8 thread T0
    #0 0x49418e in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48427
    #1 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7f9a6f20a82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x4022f8 in _start (/src/CImg/fuzz-test/bmp-test+0x4022f8)

0x60200000eff8 is located 0 bytes to the right of 8-byte region [0x60200000eff0,0x60200000eff8)
allocated by thread T0 here:
    #0 0x7f9a6fe026b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x4074fe in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #2 0x49090a in cimg_library::CImg<unsigned char>::assign(unsigned int, unsigned int, unsigned int, unsigned int, unsigned char const&) ../CImg.h:11399
    #3 0x49090a in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48348
    #4 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #5 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #6 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #7 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #8 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25

SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48427 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c047fff9df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa 00[fa]
  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==4043==ABORTING

```

## 8. cimg-heap-overflow-load\_bmp-48378

A heap overflow occurs in line 48378 in CImg.h when loading the crafted bmp file .
the tested code commit is 8447076ef22322a14a0ce130837e44c5ba8095f4.

```
=================================================================
==4044==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000eff4 at pc 0x0000004945d0 bp 0x7ffc62183410 sp 0x7ffc62183400
READ of size 1 at 0x60200000eff4 thread T0
    #0 0x4945cf in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48378
    #1 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #2 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #3 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #4 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #5 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25
    #6 0x7f628195382f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #7 0x4022f8 in _start (/src/CImg/fuzz-test/bmp-test+0x4022f8)

0x60200000eff4 is located 0 bytes to the right of 4-byte region [0x60200000eff0,0x60200000eff4)
allocated by thread T0 here:
    #0 0x7f628254b6b2 in operator new[](unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x996b2)
    #1 0x40562f in cimg_library::CImg<int>::assign(unsigned int, unsigned int, unsigned int, unsigned int) ../CImg.h:11379
    #2 0x4907f4 in cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*) ../CImg.h:48342
    #3 0x4addc4 in cimg_library::CImg<unsigned char>::load_bmp(char const*) ../CImg.h:48280
    #4 0x4addc4 in cimg_library::CImg<unsigned char>::load(char const*) ../CImg.h:48122
    #5 0x40215f in cimg_library::CImg<unsigned char>::assign(char const*) ../CImg.h:11514
    #6 0x40215f in cimg_library::CImg<unsigned char>::CImg(char const*) ../CImg.h:11161
    #7 0x40215f in main /src/CImg/fuzz-test/bmp-test.cpp:25

SUMMARY: AddressSanitizer: heap-buffer-overflow ../CImg.h:48378 cimg_library::CImg<unsigned char>::_load_bmp(_IO_FILE*, char const*)
Shadow bytes around the buggy address:
  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c047fff9df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa[04]fa
  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==4044==ABORTING

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


