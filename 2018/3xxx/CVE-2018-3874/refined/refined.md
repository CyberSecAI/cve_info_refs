This document provides details for CVE-2018-3874, along with other related CVEs (CVE-2018-3873, CVE-2018-3875, CVE-2018-3876, CVE-2018-3877, CVE-2018-3878)

**Root cause of vulnerability:**
The `video-core` process on Samsung SmartThings Hub has multiple stack-based buffer overflow vulnerabilities in the `credentials` handler of its HTTP server. These occur because the process copies data from a user-controlled JSON payload into fixed-size stack buffers using `strncpy` without proper bounds checking. The length of the source string is determined by `strlen` and used as the size parameter for `strncpy`.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflows in the `credentials` handler of the `video-core` process.
- Lack of input sanitization or length validation on user-supplied data in the JSON payload.
- Usage of `strncpy` with a user-controlled size based on `strlen` output, creating an overflow if the JSON string is larger than the destination buffer.

**Impact of exploitation:**
Successful exploitation can lead to arbitrary code execution on the `video-core` process, which runs as root. This could allow an attacker to take control of the device and potentially other connected devices on the network.

**Attack vectors:**
1.  **Impersonating Remote Servers:** An attacker who can impersonate the remote SmartThings servers can send malicious HTTP requests to the `hubCore` process, which will then relay them to the vulnerable `video-core` process.
2.  **Malicious SmartApps:** A SmartThings SmartApp (either published directly on the device or on the public marketplace) can make localhost connections, allowing it to send malicious HTTP requests directly to the `video-core` process.
3.  **Malicious Mobile App:** A malicious request sent from the SmartThings mobile application to the remote SmartThings servers might be relayed back to the device, depending on the available remote APIs. This requires a valid OAuth bearer token.

**Required attacker capabilities/position:**
- Ability to send HTTP requests to the `/credentials` endpoint of the `video-core` process on the SmartThings Hub.
- For the first vector, the ability to impersonate the remote SmartThings servers is required, or for the third vector, a valid OAuth token or credentials
- For the second vector, the ability to install and execute a malicious SmartApp on the hub.

**Specifics for CVE-2018-3874:**

This CVE specifically refers to the buffer overflow when handling the `"accessKey"` parameter. The vulnerability lies in the `strncpy` call at address `0x0003E69C` in the provided assembly code. The destination buffer for `accessKey` has a size of 32 bytes on the stack. By sending an `accessKey` value larger than 32 bytes in the JSON payload, an attacker can overwrite other parts of the stack.