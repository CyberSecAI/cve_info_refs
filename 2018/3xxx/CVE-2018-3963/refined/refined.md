- **Root cause of vulnerability:** The CUJO Smart Firewall's DHCP daemon configuration is vulnerable to command injection. The hostname from a DHCP request is inserted into the `dhcpd.conf` file without sanitization when a static DHCP entry is created. This allows an attacker to inject arbitrary commands through a crafted hostname.
- **Weaknesses/vulnerabilities present:** Command injection due to lack of input sanitization. Specifically, the hostname field of a DHCP request is used to construct the dhcpd.conf file without proper escaping or validation.
- **Impact of exploitation:** An attacker can execute arbitrary system commands with root privileges on the CUJO Smart Firewall device. This can lead to complete compromise of the device.
- **Attack vectors:** The attack vector is through a crafted DHCP request sent to the CUJO Smart Firewall device. The malicious hostname is injected when a static DHCP entry is configured by the user, which then triggers the vulnerable dhcpd.conf generation.
- **Required attacker capabilities/position:** The attacker needs to be on the network monitored by the CUJO firewall, capable of sending DHCP requests to the device. They also need valid credentials to log into the CUJO account associated with the device to set the static DHCP entry.