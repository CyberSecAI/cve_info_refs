- **Root cause of vulnerability:** A heap-based buffer overflow occurs due to a miscalculation of the loop counter when parsing a tiled TIFF image with the PlanarConfiguration tag set to the default chunky version. The application uses an incorrect value to calculate the loop counter, leading to an out-of-bounds write during planar unpacking.

- **Weaknesses/vulnerabilities present:**
    - Heap-Based Buffer Overflow (CWE-122): The application allocates a buffer on the heap based on the raster size of the image. However, during the unpacking process, a miscalculated loop counter leads to writing data outside the allocated buffer.

- **Impact of exploitation:** An attacker can overwrite arbitrary data in the heap, leading to potential code execution.

- **Attack vectors:** A specially crafted TIFF image with the PlanarConfiguration tag set to the default chunky version is processed by the application.

- **Required attacker capabilities/position:** The attacker needs to be able to provide a malicious TIFF file to the application. User interaction is required for the victim to open the malicious file in Canvas Draw.