The provided content is a vulnerability report for CVE-2018-3922.

**Root cause of vulnerability:**
The vulnerability is due to a memory corruption issue in the ANI-parsing functionality of Computerinsel Photoline. Specifically, the program does not properly validate the size value in the ANI file header.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflow (CWE-122): The program uses a length value from the ANI header to allocate a buffer on the stack. When an attacker provides an overly large length, the program reads beyond the bounds of the allocated buffer, resulting in a stack overflow.

**Impact of exploitation:**
- Code execution: An attacker can overwrite arbitrary data on the stack using this out-of-bounds write, potentially leading to code execution.

**Attack vectors:**
- An attacker must deliver a specially crafted ANI image to the application. When the application processes this image, it triggers the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide a malicious ANI file to the target application. This could be achieved through various methods, such as:
  - Tricking a user into opening a malicious file.
  - Delivering the file as an attachment or via a vulnerable web service.

**Additional details:**
- The vulnerability occurs when the application is processing the `INAM` chunk.
- The program copies image data using a length extracted from the header.
- The value `0x600000FF` was used in the proof of concept to trigger the overflow.
- The `memcpy_wrapper` function copies an amount of data based on the size value provided in the header.
- The crash occurs within `__stack_chk_fail`, suggesting a stack-based overflow was detected by the system.