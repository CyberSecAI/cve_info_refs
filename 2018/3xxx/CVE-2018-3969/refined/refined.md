- **Root cause of vulnerability:** The vulnerability stems from the ability to inject arbitrary shell commands into the `dhcpd.conf` file, which is used by the CUJO Smart Firewall's DHCP server. The `dhcpd` daemon executes commands specified in the configuration file on specific events, such as when a new IP address is leased. This allows an attacker to execute arbitrary code with root privileges.
- **Weaknesses/vulnerabilities present:**
    - Lack of input validation/sanitization on the `dhcpd.conf` file allows for the injection of shell commands.
    - The DHCP server configuration allows for the execution of arbitrary commands upon DHCP events.
    - The configuration file persists across reboots and firmware updates by default allowing for persistence.
- **Impact of exploitation:** Successful exploitation allows an attacker to achieve persistent root access on the CUJO Smart Firewall. This enables the attacker to perform a wide range of malicious activities, including data exfiltration, network manipulation, and further compromise of connected devices.
- **Attack vectors:** The primary attack vector involves modifying the `/config/dhcpd.conf` file. This requires local access to the device with the ability to write to this file.
- **Required attacker capabilities/position:** An attacker requires local access to the CUJO Smart Firewall with sufficient privileges to write to the `/config/dhcpd.conf` file. This can be achieved through a previously established exploit, or through physical access to the device allowing access to a shell.