- **Root cause of vulnerability**: The vulnerability is a stack-based buffer overflow in the `802dot1xclientcert.cgi` endpoint of Sony IPELA E Series Camera. The `memcpy` function copies data from the POST request, using the length from `strlen` without checking against the destination buffer size, allowing for an overflow.
- **Weaknesses/vulnerabilities present**: The code has a classic buffer overflow vulnerability (CWE-120). The vulnerability exists in the `802dot1xclientcert.cgi` endpoint that handles certificate management for 802.1x. The weakness is the lack of bounds checking before using the `memcpy` function, specifically the size of the input data coming from the POST request's `boundary=` parameter against the size of the destination buffer.
- **Impact of exploitation**: Successful exploitation of the buffer overflow can allow an attacker to execute arbitrary code remotely on the affected device.
- **Attack vectors**: An attacker can send a specially crafted POST request to the `802dot1xclientcert.cgi` endpoint, with a `boundary=` parameter that includes a large amount of data to cause a buffer overflow.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP POST requests to the device, and have knowledge of the vulnerable endpoint (`802dot1xclientcert.cgi`). The CVSSv3 score suggests the attacker requires high privileges, but this could also mean the endpoint is accessible by a user with high privileges.