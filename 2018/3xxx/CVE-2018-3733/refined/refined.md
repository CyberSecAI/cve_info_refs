The provided content is related to a commit that addresses a directory traversal vulnerability.

**Root cause of vulnerability:**
The original code had an insufficient sanitization method to prevent directory traversal using ".." in the URL.

**Weaknesses/vulnerabilities present:**
- Directory traversal vulnerability: The `cleanUrl` function only replaced the first occurrence of `..` instead of all of them. This allowed for bypassing the sanitization by chaining `..` multiple times such as `a/../../../c/d`.

**Impact of exploitation:**
- Attackers could access files or directories outside the intended scope of the application by traversing directories.

**Attack vectors:**
- Manipulating the URL to include `..` sequences to traverse up the directory structure.

**Required attacker capabilities/position:**
- The attacker must be able to send HTTP requests to the vulnerable server and manipulate the URL.

The commit `4fc3b40` fixes this vulnerability by modifying the `cleanUrl` function to repeatedly remove all occurrences of ".." from the URL using a while loop. This change prevents the directory traversal by ensuring that no ".." sequences remain in the URL after sanitization.