=== Content from talosintelligence.com_31522936_20250124_160542.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0642

## ACD Systems Canvas Draw 5 IO metadata out-of-bounds write code execution vulnerability

##### January 30, 2019

##### CVE Number

CVE-2018-3976

### Summary

An exploitable out-of-bounds write exists in the CALS Raster file format-parsing functionality of Canvas Draw version 5.0.0.28. A specially crafted CAL image processed via the application can lead to an out-of-bounds write, overwriting arbitrary data. An attacker can deliver a CAL image to trigger this vulnerability and gain code execution.

### Tested Versions

ACDSystems Canvas Draw 5.0.0.28

### Product URLs

<https://www.canvasgfx.com/en/products/canvas-draw>

### CVSSv3 Score

8.8 - CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CWE

CWE-787: Out-of-bounds Write

### Details

Canvas Draw 5 is a graphics editing tool used to create and edit images, as well as other graphics-related tasks. This product has a sizable user base and is popular in its specific field.

The vulnerability arises in the parsing of the CALS Raster file format, specifically dealing with the column and row sizes of an image. Inside of the CALS header, values are set to determine the location of image data and the size of the image itself. By passing in incorrect values, the application will write out of bounds attempting to access the image data. The crash is shown below:

```
->  0x114e2290d <+71>: not    dword ptr [rcx]               [1]
    0x114e2290f <+73>: add    rcx, 0x4
    0x114e22913 <+77>: dec    ebx
    0x114e22915 <+79>: jne    0x114e2290d               ; <+71>

```

At location 1, RCX is user-controlled, determined by the sizes processed in the file header. This creates an exploitable condition and could be used to gain code execution.

### Crash Information

```
Crashed thread log =
: Dispatch queue: com.apple.main-thread
0   com.acdsystem.canvastool.ImageIO    0x000000017765b156 invert_map(int, int, unsigned char*, int) + 71
1   com.acdsystem.canvastool.ImageIO    0x000000017765bc1c MySetRasterData(void*, unsigned char*, long long, unsigned int) + 1295
2   ImageGear18                     0x000000010f5296af LoadG4_ProGold + 1916
3   ImageGear18                     0x000000010f64b630 CAL_read + 338
4   ImageGear18                     0x000000010f59bdfd GPb_fltrm_READ_call_param + 178
5   ImageGear18                     0x000000010f59bd45 GPb_fltrm_READ_call + 21
6   ImageGear18                     0x000000010f572923 iIG_load_FD_CB + 400
7   ImageGear18                     0x000000010f6e42db IG_load_FD_CB + 91
8   com.acdsystem.canvastool.ImageIO    0x00000001776cbd79 0x177648000 + 540025
9   com.acdsystem.canvastool.ImageIO    0x00000001776c9c5a ImageGearAcquireProc(short, AcquireRecord*, int*, short*) + 978
10  com.acdsystem.canvastool.ImageIO    0x00000001776ca104 ImageIORunAcquireProc(_ImageIOAcquireState*) + 744
11  com.acdsystem.canvastool.ImageIO    0x00000001776c797b 0x177648000 + 522619
12  com.acdsystem.canvastool.ImageIO    0x00000001776c949d DoImportFile(ImportFileMsg*) + 1121
13  com.acdsystem.canvastool.ImageIO    0x000000017767cab3 toolmain() + 970
14  com.acdsystem.canvastool.ImageIO    0x00000001776a88d7 stdtool(TToolCallBlock*) + 119
15  com.acdsystem.canvastool.ImageIO    0x00000001776a8859 cvtool_main(TToolCallBlock*) + 9
16  com.canvasgfx.Canvas-Draw5      0x000000010d722138 0x10d5b9000 + 1478968
17  com.canvasgfx.Canvas-Draw5      0x000000010e2bdf9a 0x10d5b9000 + 13651866
18  com.canvasgfx.Canvas-Draw5      0x000000010e2bd748 0x10d5b9000 + 13649736
19  com.canvasgfx.Canvas-Draw5      0x000000010e43c18d 0x10d5b9000 + 15217037
20  com.apple.AppKit                0x00007fff36306214 -[NSApplication _doOpenFile:ok:tryTemp:] + 376
21  com.apple.AppKit                0x00007fff35ee5337 -[NSApplication finishLaunching] + 2438
22  com.apple.AppKit                0x00007fff35ee4683 -[NSApplication run] + 250
23  com.apple.AppKit                0x00007fff35eb3a72 NSApplicationMain + 804
24  libdyld.dylib                   0x00007fff60761015 start + 1

log name is: ./crashlogs/1.crashlog.txt
---
exception=EXC_BAD_ACCESS:signal=11:is_exploitable=yes:instruction_disassembly=notl  (%rcx):instruction_address=0x000000017765b156:access_type=unknown:access_address=0x00000003c8272000:
Crash accessing invalid address.  Consider running it again with libgmalloc(3) to see if the log changes.

```
### Timeline

2018-08-06 - Vendor Disclosure

2019-01-18 - Vendor Patched

2019-01-30 - Public Release

##### Credit

Discovered by Tyler Bohan of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0648](/vulnerability_reports/TALOS-2018-0648) [Previous Report

TALOS-2019-0758](/vulnerability_reports/TALOS-2019-0758)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


