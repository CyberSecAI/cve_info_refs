This document describes multiple vulnerabilities, including CVE-2018-3875, affecting the Samsung SmartThings Hub.

**Root Cause:** The `video-core` process on the Samsung SmartThings Hub contains multiple stack-based buffer overflow vulnerabilities in the `credentials` handler of its HTTP server. These vulnerabilities are caused by the improper handling of user-controlled JSON payloads, where fields are extracted without proper size checks before being copied into stack buffers using `strncpy`.

**Vulnerabilities:**
*   **CWE-120:** Buffer Copy without Checking Size of Input ('Classic Buffer Overflow'). Specifically, the `strncpy` function is used to copy data from the JSON payload to a fixed-size buffer on the stack, without validating if the size of the input exceeds the buffer's capacity.

*  CVE-2018-3875 specifically relates to the "sessionToken" key within the JSON payload. The `strncpy` call associated with this parameter uses a stack buffer of 2000 bytes, but since the copy size comes from the user controlled parameter, an overflow is possible.

**Impact of Exploitation:** Successful exploitation of these buffer overflow vulnerabilities can lead to arbitrary code execution with root privileges on the `video-core` process.

**Attack Vectors:**
*   **Impersonating Remote SmartThings Servers:** An attacker capable of impersonating the remote SmartThings servers can send malicious HTTP requests to `hubCore` which will be relayed to `video-core`.

*   **Malicious SmartApps:** An attacker can create a malicious SmartApp which, running inside the `hubCore` process, can directly send HTTP requests to the vulnerable `video-core` process.

*   **Potentially Malicious Mobile App Request:** A malicious request from the SmartThings mobile application, relayed through the remote SmartThings servers, could also be used as an attack vector. (Note: this is not tested but is a potential vector)

**Required Attacker Capabilities/Position:**
*   For the first vector, the attacker needs to be able to impersonate a remote SmartThings server.
*   For the SmartApp vector, the attacker needs to be able to install a malicious SmartApp on the Hub.
*   For the potential mobile app vector, the attacker would need a valid OAuth bearer token or the username/password pair to obtain it.